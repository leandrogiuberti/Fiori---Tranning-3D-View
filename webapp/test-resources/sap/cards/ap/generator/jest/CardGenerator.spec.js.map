{"version":3,"file":"CardGenerator.spec.js","names":["sap","ui","define","CardGenerator","sap_cards_ap_generator_pages_Application","Component","Fragment","Application","jest","mock","resolvePath","CardGeneratorDialogController","initialize","fn","setValueStateForAdvancedPanel","requireActual","getCardGeneratorDialogModel","mockReturnValue","Promise","resolve","getProperty","getObjectPageCardManifestForPreview","createPathWithEntityContext","createInitialManifest","renderCardPreview","addQueryParametersToManifest","createCardManifest","updateCardGroups","describe","afterEach","clearAllMocks","getInstance","_resetInstance","it","appComponent","setModelMock","getModelMock","getModel","isA","sServiceUrl","getManifestEntry","originalHasher","window","hasher","getHash","setHash","load","mockResolvedValue","setBindingContext","setModel","open","initializeAsync","then","expect","toHaveBeenCalledTimes","e","reject","toHaveBeenCalledWith"],"sources":["CardGenerator.spec.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport * as CardGenerator from \"sap/cards/ap/generator/CardGenerator\";\nimport { Application } from \"sap/cards/ap/generator/pages/Application\";\nimport Component from \"sap/ui/core/Component\";\nimport Fragment from \"sap/ui/core/Fragment\";\n\ndeclare namespace sap {\n\texport namespace jest {\n\t\tfunction resolvePath(path: string): string;\n\t}\n}\n\njest.mock(sap.jest.resolvePath(\"sap/cards/ap/generator/app/CardGeneratorDialogController\"), () => {\n\treturn {\n\t\tCardGeneratorDialogController: {\n\t\t\tinitialize: jest.fn()\n\t\t},\n\t\tsetValueStateForAdvancedPanel: jest.fn()\n\t};\n});\n\njest.mock(sap.jest.resolvePath(\"sap/cards/ap/generator/helpers/CardGeneratorModel\"), () => {\n\treturn {\n\t\t...jest.requireActual(sap.jest.resolvePath(\"sap/cards/ap/generator/helpers/CardGeneratorModel\")),\n\t\tgetCardGeneratorDialogModel: jest.fn().mockReturnValue(\n\t\t\tPromise.resolve({\n\t\t\t\tgetProperty: jest.fn().mockReturnValue({})\n\t\t\t}) as any\n\t\t)\n\t};\n});\njest.mock(sap.jest.resolvePath(\"sap/cards/ap/common/services/RetrieveCard\"), () => {\n\treturn {\n\t\t...jest.requireActual(sap.jest.resolvePath(\"sap/cards/ap/common/services/RetrieveCard\")),\n\t\tgetObjectPageCardManifestForPreview: jest.fn().mockReturnValue(Promise.resolve({}) as any)\n\t};\n});\njest.mock(sap.jest.resolvePath(\"sap/cards/ap/generator/odata/ODataUtils\"), () => {\n\treturn {\n\t\t...jest.requireActual(sap.jest.resolvePath(\"sap/cards/ap/generator/odata/ODataUtils\")),\n\t\tcreatePathWithEntityContext: jest\n\t\t\t.fn()\n\t\t\t.mockReturnValue(Promise.resolve(\"salesOrderManage(salesOrder=1234,IsActiveEntity=true)\") as any)\n\t};\n});\njest.mock(sap.jest.resolvePath(\"sap/cards/ap/generator/helpers/IntegrationCardHelper\"), () => {\n\treturn {\n\t\t...jest.requireActual(sap.jest.resolvePath(\"sap/cards/ap/generator/helpers/IntegrationCardHelper\")),\n\t\tcreateInitialManifest: jest.fn(),\n\t\trenderCardPreview: jest.fn(),\n\t\taddQueryParametersToManifest: jest.fn(),\n\t\tcreateCardManifest: jest.fn().mockReturnValue(Promise.resolve({}) as any),\n\t\tupdateCardGroups: jest.fn()\n\t};\n});\n\ndescribe(\"cardGenerator - initializeAsync\", () => {\n\tafterEach(() => {\n\t\tjest.clearAllMocks();\n\t\tApplication.getInstance()._resetInstance();\n\t});\n\n\tit(\"should not create the cardGeneratorDialog instance if entityset and object context are missing\", async () => {\n\t\tlet appComponent = new Component() as jest.Mocked<Component>;\n\t\tlet setModelMock: jest.Mock = jest.fn();\n\t\tlet getModelMock: jest.Mock = jest.fn().mockReturnValue(false);\n\t\tappComponent.getModel = jest.fn().mockReturnValue({\n\t\t\tisA: jest.fn().mockReturnValue(false),\n\t\t\tsServiceUrl: \"/sap/opu/odata\"\n\t\t});\n\t\tappComponent.getManifestEntry = jest.fn().mockReturnValue({});\n\t\tconst originalHasher = window.hasher;\n\t\twindow.hasher = {\n\t\t\tgetHash: jest.fn().mockReturnValue(\"\"),\n\t\t\tsetHash: jest.fn()\n\t\t} as any;\n\n\t\tFragment.load = jest.fn().mockResolvedValue(\n\t\t\tPromise.resolve({\n\t\t\t\tsetBindingContext: jest.fn(),\n\t\t\t\tsetModel: setModelMock,\n\t\t\t\tgetModel: getModelMock,\n\t\t\t\topen: jest.fn()\n\t\t\t})\n\t\t);\n\t\tawait CardGenerator.initializeAsync(appComponent);\n\t\texpect(Fragment.load).toHaveBeenCalledTimes(0);\n\t\texpect(setModelMock).toHaveBeenCalledTimes(0);\n\t\texpect(getModelMock).toHaveBeenCalledTimes(0);\n\t\twindow.hasher = originalHasher;\n\t});\n\n\tit(\"should create cardGeneratorDialog instance for ObjectPage application\", async () => {\n\t\tlet setModelMock: jest.Mock = jest.fn();\n\t\tlet getModelMock: jest.Mock = jest.fn().mockReturnValue(false);\n\t\tlet appComponent = new Component() as jest.Mocked<Component>;\n\t\tappComponent.getModel = jest.fn().mockReturnValue({\n\t\t\tisA: jest.fn().mockReturnValue(false),\n\t\t\tsServiceUrl: \"/sap/opu/odata\"\n\t\t});\n\t\tappComponent.getManifestEntry = jest.fn().mockReturnValue(\"sap.ui.generic.app\");\n\t\tconst originalHasher = window.hasher;\n\t\twindow.hasher = {\n\t\t\tgetHash: jest.fn().mockReturnValue(\"Cards-generator&/salesOrderManage(salesOrder=1234,IsActiveEntity=true)\"),\n\t\t\tsetHash: jest.fn()\n\t\t} as any;\n\n\t\tFragment.load = jest.fn().mockResolvedValue(\n\t\t\tPromise.resolve({\n\t\t\t\tsetBindingContext: jest.fn(),\n\t\t\t\tsetModel: setModelMock,\n\t\t\t\tgetModel: getModelMock,\n\t\t\t\topen: jest.fn()\n\t\t\t})\n\t\t);\n\t\tawait CardGenerator.initializeAsync(appComponent);\n\t\texpect(Fragment.load).toHaveBeenCalledTimes(1);\n\t\texpect(setModelMock).toHaveBeenCalledTimes(4);\n\t\texpect(getModelMock).toHaveBeenCalledTimes(2);\n\t\texpect(getModelMock).toHaveBeenCalledWith(\"i18n\");\n\t\twindow.hasher = originalHasher;\n\t});\n});\n"],"mappings":"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","ignoreList":[]}