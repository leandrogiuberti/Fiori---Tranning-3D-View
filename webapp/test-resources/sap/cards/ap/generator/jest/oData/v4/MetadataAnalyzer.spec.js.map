{"version":3,"file":"MetadataAnalyzer.spec.js","names":["sap","ui","define","__path","sap_cards_ap_generator_odata_v4_MetadataAnalyzer","sap_cards_ap_test_JestHelper","_interopRequireDefault","obj","__esModule","default","path","getEntityNames","getNavigationPropertyInfoFromEntity","getPropertyInfoFromEntity","getPropertyReferenceKey","compileCDS","getMetaModel","describe","mockMetaData","metaModel","beforeAll","sMetadataUrl","join","__dirname","odataFormat","Promise","resolve","then","_getMetaModel","e","reject","beforeEach","afterEach","jest","clearAllMocks","test","keyReferenceProperties","expect","toMatchSnapshot","toStrictEqual","properties","resourceBundle","getText","fn","mockImplementation","key","mockAnnotations","$NavigationPropertyBinding","referencedTestEntities","_RootPaymentTerms","DraftAdministrativeData","SiblingEntity","$kind","$Type","$ReferentialConstraint","RootPaymentTerms","getObject","sParam","includes"],"sources":["MetadataAnalyzer.spec.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport path from \"path\";\nimport ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport {\n\tgetEntityNames,\n\tgetNavigationPropertyInfoFromEntity,\n\tgetPropertyInfoFromEntity,\n\tgetPropertyReferenceKey\n} from \"sap/cards/ap/generator/odata/v4/MetadataAnalyzer\";\nimport { compileCDS, getMetaModel } from \"sap/cards/ap/test/JestHelper\";\nimport ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\ndescribe(\"Card CardGenerator\", () => {\n\tlet mockMetaData: any;\n\tlet metaModel: ODataMetaModel;\n\tbeforeAll(async () => {\n\t\tconst sMetadataUrl = compileCDS(path.join(`${__dirname}`, \"../../fixtures/Sample.cds\"), { odataFormat: \"structured\" });\n\t\tmetaModel = await getMetaModel(sMetadataUrl);\n\t});\n\tbeforeEach(() => {\n\t\tmockMetaData = {\n\t\t\tgetMetaModel: () => {\n\t\t\t\treturn metaModel;\n\t\t\t}\n\t\t};\n\t});\n\tafterEach(() => {\n\t\tjest.clearAllMocks();\n\t});\n\n\ttest(\"validate function getPropertyReferenceKey\", () => {\n\t\tconst keyReferenceProperties = getPropertyReferenceKey(mockMetaData, \"CashBank\");\n\t\texpect(keyReferenceProperties).toMatchSnapshot();\n\t});\n\n\ttest(\"validate function getEntityNames\", () => {\n\t\tconst keyReferenceProperties = getEntityNames(mockMetaData);\n\t\texpect(keyReferenceProperties).toStrictEqual([\"CashBank\"]);\n\t});\n\n\ttest(\"validate function getPropertyInfoFromEntity\", () => {\n\t\tconst properties = getPropertyInfoFromEntity(mockMetaData, \"CashBank\", false);\n\t\texpect(properties).toMatchSnapshot();\n\t});\n\n\ttest(\"validate function getPropertyInfoFromEntity with navigation\", () => {\n\t\tconst resourceBundle = {\n\t\t\tgetText: jest.fn().mockImplementation((key) => {\n\t\t\t\tif (key === \"GENERATOR_CARD_SELECT_NAV_PROP\") return \"Select a Navigational Property:\";\n\t\t\t\tif (key === \"CRITICALITY_CONTROL_SELECT_PROP\") return \"Select a Property:\";\n\t\t\t})\n\t\t} as unknown as ResourceBundle;\n\t\tconst properties = getPropertyInfoFromEntity(mockMetaData, \"CashBank\", true, resourceBundle);\n\t\texpect(properties).toMatchSnapshot();\n\t});\n\n\ttest(\"validate function getNavigationPropertyInfoFromEntity\", () => {\n\t\tconst mockAnnotations: Record<string, any> = {\n\t\t\t$NavigationPropertyBinding: {\n\t\t\t\treferencedTestEntities: \"RootElement\",\n\t\t\t\t_RootPaymentTerms: \"RootPaymentTerms\",\n\t\t\t\tDraftAdministrativeData: \"RootPaymentTerms\",\n\t\t\t\tSiblingEntity: \"RootElement\"\n\t\t\t},\n\t\t\t_RootPaymentTerms: {\n\t\t\t\t$kind: \"NavigationProperty\",\n\t\t\t\t$Type: \"com.sap.gateway.srvd.ui_cashbank_manage.v0001.CashBankType\",\n\t\t\t\t$ReferentialConstraint: {\n\t\t\t\t\tRootPaymentTerms: \"RootPaymentTerms\"\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\tmockMetaData.getMetaModel = jest.fn(() => ({\n\t\t\tgetObject: jest.fn((sParam: string) => {\n\t\t\t\tif (sParam.includes(\"/\")) {\n\t\t\t\t\treturn mockAnnotations;\n\t\t\t\t}\n\t\t\t})\n\t\t}));\n\n\t\tconst properties = getNavigationPropertyInfoFromEntity(mockMetaData, \"CashBank\");\n\t\texpect(properties).toMatchSnapshot();\n\t});\n});\n"],"mappings":"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","ignoreList":[]}