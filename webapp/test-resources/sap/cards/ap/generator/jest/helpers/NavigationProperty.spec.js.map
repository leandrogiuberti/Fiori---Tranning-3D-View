{"version":3,"file":"NavigationProperty.spec.js","names":["sap","ui","define","sap_cards_ap_generator_helpers_NavigationProperty","sap_cards_ap_generator_pages_Application","sap_cards_ap_generator_pages_ObjectPage","UIComponent","getNavigationPropertiesWithLabel","updateNavigationPropertiesWithLabel","Application","ObjectPage","jest","mock","resolvePath","requireActual","fetchDataAsync","fn","mockResolvedValue","someNavigationProperty","Status","Status_Text","getNavigationPropertyInfoFromEntity","mockReturnValue","name","properties","label","type","sId","oManifest","id","Component","extend","metadata","manifest","createContent","rootComponent","spyOn","mockImplementation","sServiceUrl","isA","describe","windowSpy","beforeAll","window","createInstance","afterAll","mockRestore","getInstance","_resetInstance","test","hasher","getHash","navigationProperty","path","Promise","resolve","then","result","expect","toMatchSnapshot","e","reject","navigationProperties","propertiesWithLabel","toEqual"],"sources":["NavigationProperty.spec.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport { getNavigationPropertiesWithLabel, updateNavigationPropertiesWithLabel } from \"sap/cards/ap/generator/helpers/NavigationProperty\";\nimport { Application } from \"sap/cards/ap/generator/pages/Application\";\nimport { ObjectPage } from \"sap/cards/ap/generator/pages/ObjectPage\";\nimport UIComponent from \"sap/ui/core/UIComponent\";\n\ndeclare namespace sap {\n\texport namespace jest {\n\t\tfunction resolvePath(path: string): string;\n\t}\n}\n\njest.mock(sap.jest.resolvePath(\"sap/cards/ap/generator/odata/ODataUtils\"), () => {\n\treturn {\n\t\t...jest.requireActual(sap.jest.resolvePath(\"sap/cards/ap/generator/odata/ODataUtils\")),\n\t\tfetchDataAsync: jest.fn().mockResolvedValue({\n\t\t\tsomeNavigationProperty: {\n\t\t\t\tStatus: \"O\",\n\t\t\t\tStatus_Text: \"Open\"\n\t\t\t}\n\t\t}),\n\t\tgetNavigationPropertyInfoFromEntity: jest.fn().mockReturnValue([\n\t\t\t{\n\t\t\t\tname: \"someNavigationProperty\",\n\t\t\t\tproperties: [\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"Lower Value\",\n\t\t\t\t\t\ttype: \"Edm.String\",\n\t\t\t\t\t\tname: \"Status\"\n\t\t\t\t\t},\n\t\t\t\t\t{\n\t\t\t\t\t\tlabel: \"Confirmation\",\n\t\t\t\t\t\ttype: \"Edm.String\",\n\t\t\t\t\t\tname: \"Status_Text\"\n\t\t\t\t\t}\n\t\t\t\t]\n\t\t\t}\n\t\t])\n\t};\n});\n\nconst sId = \"testComponent\";\nconst oManifest = {\n\t\"sap.app\": {\n\t\tid: sId,\n\t\ttype: \"application\"\n\t}\n};\nconst Component = UIComponent.extend(\"component\", {\n\tmetadata: {\n\t\tmanifest: oManifest\n\t},\n\tcreateContent() {\n\t\treturn null;\n\t}\n});\n\nconst rootComponent = new Component(sId);\njest.spyOn(rootComponent, \"getModel\").mockImplementation(() => {\n\treturn {\n\t\tsServiceUrl: \"/sap/opu/odata\",\n\t\tisA: () => false\n\t};\n});\n\ndescribe(\"getNavigationPropertiesWithLabel\", () => {\n\tlet windowSpy: jest.SpyInstance;\n\n\tbeforeAll(() => {\n\t\twindowSpy = jest.spyOn(window, \"window\", \"get\");\n\t\tObjectPage.createInstance(rootComponent);\n\t});\n\n\tafterAll(() => {\n\t\twindowSpy.mockRestore();\n\t\tApplication.getInstance()._resetInstance();\n\t});\n\n\ttest(\"should return properties with label and navigation property data\", async () => {\n\t\twindowSpy.mockImplementation(() => ({\n\t\t\thasher: {\n\t\t\t\tgetHash: () => \"test-intent&/testEntity(12345)\"\n\t\t\t}\n\t\t}));\n\n\t\tconst navigationProperty = \"someNavigationProperty\";\n\t\tconst path = \"/sap/opu/odata4/sap/c_salesordermanage_srv/srvd/sap/c_salesordermanage_sd/0001/\";\n\t\tconst result = await getNavigationPropertiesWithLabel(rootComponent, navigationProperty, path);\n\t\texpect(result).toMatchSnapshot();\n\t});\n});\n\ndescribe(\"updateNavigationPropertiesWithLabel\", () => {\n\ttest(\"should update navigation properties with label\", () => {\n\t\tconst navigationProperties = [\n\t\t\t{ name: \"SalesOrderManage\", properties: [] },\n\t\t\t{ name: \"SalesOrderItem\", properties: [] }\n\t\t];\n\t\tconst propertiesWithLabel = [\n\t\t\t{ name: \"created_at\", label: \"created at\" },\n\t\t\t{ name: \"netamount\", label: \"Net Amount\" }\n\t\t];\n\n\t\texpect(navigationProperties[0].properties).toEqual([]);\n\t\tupdateNavigationPropertiesWithLabel(navigationProperties, \"SalesOrderManage\", propertiesWithLabel);\n\t\texpect(navigationProperties[0].properties).toEqual(propertiesWithLabel);\n\t\texpect(navigationProperties[1].properties).toEqual([]);\n\t\tupdateNavigationPropertiesWithLabel(navigationProperties, \"SalesOrderItem\", propertiesWithLabel);\n\t\texpect(navigationProperties[1].properties).toEqual(propertiesWithLabel);\n\t});\n\n\ttest(\"should not update navigation properties if entity name does not match\", () => {\n\t\tconst navigationProperties = [\n\t\t\t{ name: \"SalesOrderManage\", properties: [] },\n\t\t\t{ name: \"SalesOrderItem\", properties: [] }\n\t\t];\n\t\tconst propertiesWithLabel = [\n\t\t\t{ name: \"created_at\", label: \"created at\" },\n\t\t\t{ name: \"netamount\", label: \"Net Amount\" }\n\t\t];\n\t\tupdateNavigationPropertiesWithLabel(navigationProperties, \"entity3\", propertiesWithLabel);\n\t\texpect(navigationProperties[0].properties).toEqual([]);\n\t\texpect(navigationProperties[1].properties).toEqual([]);\n\t});\n\n\ttest(\"should not update navigation properties if propertiesWithLabel is empty\", () => {\n\t\tconst navigationProperties = [\n\t\t\t{ name: \"SalesOrderManage\", properties: [] },\n\t\t\t{ name: \"SalesOrderItem\", properties: [] }\n\t\t];\n\n\t\tupdateNavigationPropertiesWithLabel(navigationProperties, \"SalesOrderManage\", []);\n\t\texpect(navigationProperties[0].properties).toEqual([]);\n\t\texpect(navigationProperties[1].properties).toEqual([]);\n\t});\n\n\ttest(\"should not update navigation properties if navigationProperties is empty\", () => {\n\t\tconst navigationProperties = [];\n\t\tconst propertiesWithLabel = [\n\t\t\t{ name: \"created_at\", label: \"created at\" },\n\t\t\t{ name: \"netamount\", label: \"Net Amount\" }\n\t\t];\n\t\tupdateNavigationPropertiesWithLabel(navigationProperties, \"SalesOrderManage\", propertiesWithLabel);\n\t\texpect(navigationProperties).toEqual([]);\n\t});\n});\n"],"mappings":"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","ignoreList":[]}