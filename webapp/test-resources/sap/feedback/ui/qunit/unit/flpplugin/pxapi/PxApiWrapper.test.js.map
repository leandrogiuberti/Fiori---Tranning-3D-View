{"version":3,"file":"PxApiWrapper.test.js","names":["PxApi","___sap_px_pxapi","__exports","pluginInfo","id","version","QUnit","module","test","assert","pxApi","PxApiFactory","createPxApi","ok","createPxApiStub","sinon","stub","globalThis","sap","qtx","info","pxclient","pxApiWrapper","PxApiWrapper","called","restore","undefined","localPluginInfo","expectedResult","Constants","PXCLIENT_INFO_NAME_FALLBACK","PXCLIENT_INFO_VERSION_FALLBACK","tenantInfo","configIdentifier","pxApiInstance","pxApiInitializeStub","returns","Promise","resolve","initialize","then","calledWith","e","reject","appContextData","pxApiOpenSurveyStub","openSurvey","equal","currentThemeId","updateThemeId","requestPushStub","pushFeedbackRequestData","areaId","triggerName","requestPush","dummyInvitationDialog","InvitationDialog","createStubInstance","ResourceBundle","invitationDialog"],"sourceRoot":".","sources":["PxApiWrapper.test.ts"],"sourcesContent":["import { PxApi } from '@sap-px/pxapi';\nimport { AppContextData, ConfigIdentifier, TenantInfo } from '@sap-px/pxapi/dist/api/common/Types';\nimport ResourceBundle from 'sap/base/i18n/ResourceBundle';\nimport Constants from 'sap/feedback/ui/flpplugin/common/Constants';\nimport PxApiFactory from 'sap/feedback/ui/flpplugin/pxapi/PxApiFactory';\nimport PxApiWrapper from 'sap/feedback/ui/flpplugin/pxapi/PxApiWrapper';\nimport InvitationDialog from 'sap/feedback/ui/flpplugin/ui/InvitationDialog';\n// eslint-disable-next-line import/no-unresolved\nimport * as sinon from 'sinon';\n\nexport default () => {\n\tconst pluginInfo = {\n\t\tid: 'pluginId',\n\t\tversion: 'pluginVersion'\n\t};\n\n\tQUnit.module('PxApiWrapper unit tests', {});\n\n\tQUnit.test('createPxApi - shall create the instance of PxApi', (assert) => {\n\t\tconst pxApi = PxApiFactory.createPxApi();\n\t\tassert.ok(pxApi instanceof PxApi);\n\t});\n\n\tQUnit.test('constructor - shall call the createPxApi of PxApiFactory with pxclient info', (assert) => {\n\t\tconst createPxApiStub = sinon.stub(PxApiFactory, 'createPxApi');\n\t\t(globalThis.sap as any).qtx.info.pxclient = 'existingClientInfo/version';\n\n\t\tconst pxApiWrapper = new PxApiWrapper(pluginInfo);\n\n\t\tassert.ok(pxApiWrapper);\n\t\tassert.ok(createPxApiStub.called);\n\t\tassert.ok((globalThis.sap as any).qtx.info.pxclient, 'existingClientInfo/version pluginId/pluginVersion');\n\n\t\tcreatePxApiStub.restore();\n\t\t(globalThis.sap as any).qtx.info.pxclient = undefined;\n\t});\n\n\tQUnit.test('constructor - shall return default version for pxclient info when local build running', (assert) => {\n\t\tconst createPxApiStub = sinon.stub(PxApiFactory, 'createPxApi');\n\t\t(globalThis.sap as any).qtx.info.pxclient = 'existingClientInfo/version';\n\t\tconst localPluginInfo = {\n\t\t\tid: 'pluginId',\n\t\t\tversion: '1.141.0'\n\t\t};\n\n\t\tconst pxApiWrapper = new PxApiWrapper(localPluginInfo);\n\n\t\tassert.ok(pxApiWrapper);\n\t\tassert.ok(createPxApiStub.called);\n\t\tassert.ok((globalThis.sap as any).qtx.info.pxclient, 'existingClientInfo/version pluginId/dev-build');\n\n\t\tcreatePxApiStub.restore();\n\t\t(globalThis.sap as any).qtx.info.pxclient = undefined;\n\t});\n\n\tQUnit.test('constructor - shall return fallback infos for pxclient info when no data provided/found.', (assert) => {\n\t\tconst createPxApiStub = sinon.stub(PxApiFactory, 'createPxApi');\n\t\t(globalThis.sap as any).qtx.info.pxclient = 'existingClientInfo/version';\n\t\tconst expectedResult = 'existingClientInfo/version ' + Constants.PXCLIENT_INFO_NAME_FALLBACK + '/' + Constants.PXCLIENT_INFO_VERSION_FALLBACK;\n\n\t\tconst pxApiWrapper = new PxApiWrapper({ id: '', version: '' });\n\n\t\tassert.ok(pxApiWrapper);\n\t\tassert.ok(createPxApiStub.called);\n\t\tassert.ok((globalThis.sap as any).qtx.info.pxclient, expectedResult);\n\n\t\tcreatePxApiStub.restore();\n\t\t(globalThis.sap as any).qtx.info.pxclient = undefined;\n\t});\n\n\tQUnit.test('initialize - shall call the initialize of PX-API Library', async (assert) => {\n\t\tconst tenantInfo = {} as TenantInfo;\n\t\tconst configIdentifier = {} as ConfigIdentifier;\n\t\tconst pxApiInstance = new PxApi();\n\t\tconst pxApiInitializeStub = sinon.stub(pxApiInstance, 'initialize');\n\t\tconst createPxApiStub = sinon.stub(PxApiFactory, 'createPxApi').returns(pxApiInstance);\n\n\t\tconst pxApiWrapper = new PxApiWrapper(pluginInfo);\n\t\tawait pxApiWrapper.initialize(tenantInfo, configIdentifier);\n\t\tassert.ok(pxApiInitializeStub.calledWith(tenantInfo, configIdentifier));\n\n\t\tpxApiInitializeStub.restore();\n\t\tcreatePxApiStub.restore();\n\t});\n\n\tQUnit.test('openSurvey - shall call the openSurvey of PX-API Library', (assert) => {\n\t\tconst appContextData = {};\n\t\tconst pxApiInstance = new PxApi();\n\t\tconst pxApiOpenSurveyStub = sinon.stub(pxApiInstance, 'openSurvey');\n\t\tconst createPxApiStub = sinon.stub(PxApiFactory, 'createPxApi').returns(pxApiInstance);\n\n\t\tconst pxApiWrapper = new PxApiWrapper(pluginInfo);\n\t\tpxApiWrapper.openSurvey(appContextData as AppContextData);\n\n\t\tassert.ok(pxApiOpenSurveyStub.calledWith(appContextData));\n\n\t\tpxApiOpenSurveyStub.restore();\n\t\tcreatePxApiStub.restore();\n\t});\n\n\tQUnit.test('updateThemeId - shall set current theme to PX-API Library', (assert) => {\n\t\tconst pxApiWrapper = new PxApiWrapper(pluginInfo);\n\t\tassert.equal(pxApiWrapper.pxApi.currentThemeId, 'none');\n\t\tpxApiWrapper.updateThemeId('sap_horizon');\n\n\t\tassert.equal(pxApiWrapper.pxApi.currentThemeId, 'sap_horizon');\n\t});\n\n\tQUnit.test('requestPush - shall invoke the \"requestPush\" of the PX-API Library', (assert) => {\n\t\tconst pxApiWrapper = new PxApiWrapper(pluginInfo);\n\t\tconst requestPushStub = sinon.stub(pxApiWrapper.pxApi, 'requestPush');\n\t\tconst pushFeedbackRequestData = {\n\t\t\tareaId: '123',\n\t\t\ttriggerName: 'myTrigger'\n\t\t};\n\n\t\tpxApiWrapper.requestPush(pushFeedbackRequestData);\n\n\t\tassert.ok(requestPushStub.calledWith(pushFeedbackRequestData));\n\n\t\trequestPushStub.restore();\n\t});\n\n\tQUnit.test('set/get invitationDialog - shall set and get the invitationDialog', (assert) => {\n\t\tconst pxApiWrapper = new PxApiWrapper(pluginInfo);\n\t\tconst dummyInvitationDialog = new InvitationDialog(sinon.createStubInstance(ResourceBundle));\n\n\t\tpxApiWrapper.invitationDialog = dummyInvitationDialog;\n\n\t\tassert.equal(pxApiWrapper.invitationDialog, dummyInvitationDialog);\n\t});\n};\n"],"mappings":"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","ignoreList":[]}