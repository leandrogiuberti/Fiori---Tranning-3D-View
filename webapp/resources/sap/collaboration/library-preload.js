//@ui5-bundle sap/collaboration/library-preload.js
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/controls/FeedEntryEmbedded", ["sap/ui/thirdparty/jquery","sap/base/util/isEmptyObject","sap/ui/dom/includeStylesheet","sap/ui/core/Control","sap/collaboration/components/utils/LanguageBundle","sap/collaboration/components/controls/FeedEntryEmbeddedRenderer","sap/collaboration/components/controls/PlaceholderUtility","sap/collaboration/components/utils/MediaTypeToSAPIcon","sap/m/Link","sap/ui/model/json/JSONModel","sap/m/VBox","sap/m/Image","sap/ui/core/Icon","sap/m/HBox"],function(jQuery,e,t,n,i,r,s,o,a,l,d,c,p,h){"use strict";var u=n.extend("sap.collaboration.components.controls.FeedEntryEmbedded",{metadata:{interfaces:[],library:"sap.collaboration",properties:{feedEntry:{type:"object",group:"data"},serviceUrl:{type:"string",group:"data"}},events:{atMentionClick:{parameters:{link:{type:"object"}}},expandCollapseClick:{},previewLoad:{}}},renderer:r});u.prototype.init=function(){this.nMaxCollapsedLength=200;this.CONTENT_MAX_HEIGHT=128;this._oLangBundle=new i;this._oTimelineItemContent;t(sap.ui.require.toUrl("sap/collaboration/components/resources/css/EmbeddedControl.css"))};u.prototype.onBeforeRendering=function(){};u.prototype.onAfterRendering=function(){this._$ExpandedTextDiv=this.$("expanded-text");var e=this._$ExpandedTextDiv.html();if(e!=undefined){this._$ExpandedTextDiv.html(this._renderLinks(e))}if(this.oExpandLink&&this.oCollapseLink){this._$FeedEntryDiv=this.$();this._$CollapsedTextDiv=this.$("collapsed-text");var t=this._$CollapsedTextDiv.html();if(t!=undefined){this._$CollapsedTextDiv.html(this._renderLinks(t))}jQuery(this._$ExpandedTextDiv).detach()}if(this._oTimelineItemContent.getItems()[0]&&this._oTimelineItemContent.getItems()[0].getMetadata().getName()==="sap.m.Image"){var n=this._oTimelineItemContent.getItems()[0];n.getDomRef().addEventListener("load",function(){var e=this._oTimelineItemContent.getDomRef().clientWidth;var t=this.CONTENT_MAX_HEIGHT;var i=n.getDomRef().width;var r=n.getDomRef().height;var s=i/r;if(!(r<=t&&i<=e)){if(r>t){i=s*t;r=t}if(i>e){r=e/s;i=e}n.setWidth(i+"px");n.setHeight(r+"px");n.rerender()}this.firePreviewLoad()}.bind(this))}};u.prototype.exit=function(){this._destroyAtMentionLinks();if(this.oExpandLink){this.oExpandLink.destroy()}if(this.oCollapseLink){this.oCollapseLink.destroy()}if(this._oTimelineItemContent){this._oTimelineItemContent.destroy()}};u.prototype.setFeedEntry=function(e){this.setProperty("feedEntry",e);this._sText=e.Text;this._sTextWithPlaceholders=e.TextWithPlaceholders;this._destroyAtMentionLinks();this._mAtMentionsLinks={};var t=s.getAtMentionsValues(this._sText,this._sTextWithPlaceholders);for(var n=0;n<t.length;n++){this._mAtMentionsLinks[t[n].placeholder]=this._createAtMentionLink(t[n],e)}this._oTimelineItemContent=this._createTimelineItemContent();return this};u.prototype.getCollapsedText=function(){this.oExpandLink;this.oCollapseLink;var e=0;var t=0;var n=0;var i="";var r=/@@.\{\d+\}/;var o=this._splitByPlaceholders(this._sTextWithPlaceholders);var a=s.getAtMentionsValues(this._sText,this._sTextWithPlaceholders);do{if(r.test(o[n])){if(a[t].placeholder===o[n]){e+=a[t].value.length;i+=a[t].placeholder;t++}}else{e+=o[n].length;i+=o[n]}n++}while(e<=this.nMaxCollapsedLength);i=i.substring(0,this.nMaxCollapsedLength);var l=i.lastIndexOf(" ");if(l>0){this._sCollapsedTextWithPlaceholders=i.substr(0,l)}else{this._sCollapsedTextWithPlaceholders=i}};u.prototype.createExpandCollapseLink=function(e){var t=new a({id:this.getId()+"-"+e,text:this._oLangBundle.getText(e),press:[function(e){var t=e.getSource().getId();if(t.indexOf("-TE_MORE")>-1){jQuery(this._$CollapsedTextDiv).detach();jQuery(this._$ExpandedTextDiv).prependTo(this._$FeedEntryDiv)}else{jQuery(this._$ExpandedTextDiv).detach();jQuery(this._$CollapsedTextDiv).prependTo(this._$FeedEntryDiv)}this.fireExpandCollapseClick()},this]}).addStyleClass("alignMiddle");return t};u.prototype._shouldTextBeRendered=function(){var t=this.getFeedEntry();if(t.Text==undefined||t.Text==""||t.ConsolidatedCount>1||!e(t.TargetObjectReference)&&(t.TargetObjectReference.Type=="Task"||t.TargetObjectReference.Type=="ForumItem"||t.TargetObjectReference.Type=="Event"||t.TargetObjectReference.FullPath=="ContentItem/BlogEntry"||t.TargetObjectReference.FullPath=="ContentItem/Page"||t.TargetObjectReference.FullPath=="ContentItem/Poll")){return false}else{return true}};u.prototype._shouldContentBeRendered=function(){return this._oTimelineItemContent.getItems().length>0};u.prototype._splitByPlaceholders=function(e){return s.splitByPlaceholders(e)};u.prototype._renderLinks=function(e){var t=/(^|[\s\n]|<br\/?>)((?:https?|ftp):\/\/[\-A-Z0-9+\u0026\u2019@#\/%?=()~_|!:,.;]*[\-A-Z0-9+\u0026@#\/%=~()_|])/gi;return e.replace(t,"$1<a href='$2' target='_blank'>$2</a>")};u.prototype._createAtMentionLink=function(e,t){var n=e.value.slice(1);var i=e.placeholder.replace(/[@a-z{}]/g,"");var r=new l({feedId:t.Id,placeholderIndex:i,placeholderValue:e.value});var s=new a({id:"at_mention_link-"+this.getId()+"-"+i,text:"{/placeholderValue}",press:[function(e){this.fireAtMentionClick({link:e.getSource()})},this]}).addStyleClass("sapCollaborationAtMentionLink");s.setModel(r);return s};u.prototype._destroyAtMentionLinks=function(){if(this._mAtMentionsLinks){for(var e in this._mAtMentionsLinks){if(this._mAtMentionsLinks.hasOwnProperty(e)){this._mAtMentionsLinks[e].destroy()}}this._mAtMentionsLinks=undefined}};u.prototype._createTimelineItemContent=function(){var t=new d(this.getId()+"-content",{}).addStyleClass("sapUiTinyMarginTopBottom");var n=this.getFeedEntry();if(!e(n.TargetObjectReference)&&n.TargetObjectReference.Type!==undefined&&n.TargetObjectReference.Type!=="FeedEntry"||n.ConsolidatedCount>1){t.addItem(this._createFeedEntryContent(n))}return t};u.prototype._createFeedEntryContent=function(e){var t="";var n="";var i="";if(e.ConsolidatedCount>1){t="sap-icon://documents";n=this._oLangBundle.getText("TE_CONSOLIDATED_FEED_TEXT");i=e.WebURL}else{i=e.TargetObjectReference.WebURL;switch(e.TargetObjectReference.Type){case"ContentItem":if(e.TargetObjectReference.ContentType){if(e.TargetObjectReference.ContentType.indexOf("image")>-1){var r=new c(this.getId()+"-preview",{src:this.getServiceUrl()+"/FeedEntries('"+e.Id+"')/PreviewImage/$value",press:[function(e){window.open(i,"_blank")},this]});return r}t=o.getSAPIconForMediaType(e.TargetObjectReference.ContentType);n=s.getContentItemName(e.Action,e.ActionWithPlaceholders)}else{switch(e.TargetObjectReference.FullPath){case"ContentItem/Poll":t="sap-icon://horizontal-bar-chart";break;case"ContentItem/Page":t="sap-icon://e-learning";break;case"ContentItem/BlogEntry":t="sap-icon://request";break;default:t="";break}n=e.TargetObjectReference.Title}break;case"ForumItem":t=this._getForumItemIconSrc(e.TargetObjectReference);n=e.TargetObjectReference.Title;break;case"Task":t="sap-icon://task";n=e.TargetObjectReference.Title;break;case"Event":t="sap-icon://calendar";n=e.TargetObjectReference.Title;break;default:t="sap-icon://action";n=e.TargetObjectReference.Title;break}}var l="2.5em";var u=new p({src:t,size:l}).addStyleClass("sapUiTinyMarginBeginEnd");var m=new a({text:n,target:"_blank",href:i,tooltip:n,wrapping:true,width:"95%"}).addStyleClass("RightToLeftParenthesisStyling");var T=new h({});T.addItem(u);var f=new d({width:"100%"}).addStyleClass("sapUiTinyMarginBeginEnd");f.addItem(m);T.addItem(f);return T};u.prototype._getForumItemIconSrc=function(e){var t=e.FullPath;switch(t){case"ForumItem/Inquiry":case"ForumItem/Question":return"sap-icon://question-mark";case"ForumItem/Idea":return"sap-icon://lightbulb";case"ForumItem/Discussion":return"sap-icon://discussion";default:return""}};return u});
/**
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/controls/FeedEntryEmbeddedRenderer", ["sap/ui/core/HTML","sap/ui/thirdparty/jquery"],function(e,jQuery){"use strict";var n={apiVersion:2};n.render=function(e,n){e.openStart("div",n).openEnd();if(n._shouldTextBeRendered()){var t=n.getId();e.openStart("div").openEnd();if(n._sText.length>n.nMaxCollapsedLength){n.getCollapsedText();e.openStart("div",t+"-collapsed-text");e.class("sapUiTinyMarginBottom").class("sapCollaborationEmbeddedText");e.openEnd();this._renderText(e,n,n._sCollapsedTextWithPlaceholders);e.openStart("span");e.class("sapCollaborationEmbeddedTextSpace");e.openEnd();e.close("span");if(n.oExpandLink===undefined){n.oExpandLink=n.createExpandCollapseLink("TE_MORE");e.renderControl(n.oExpandLink)}else{e.renderControl(n.oExpandLink)}e.close("div");e.openStart("div",t+"-expanded-text");e.class("sapUiTinyMarginBottom").class("sapCollaborationEmbeddedText");e.openEnd();this._renderText(e,n,n._sTextWithPlaceholders);e.openStart("span");e.class("sapCollaborationEmbeddedTextSpace");e.openEnd();e.close("span");if(n.oCollapseLink===undefined){n.oCollapseLink=n.createExpandCollapseLink("TE_LESS");e.renderControl(n.oCollapseLink)}else{e.renderControl(n.oCollapseLink)}e.close("div")}else{e.openStart("div",t+"-expanded-text");e.class("sapUiTinyMarginBottom").class("sapCollaborationEmbeddedText");e.openEnd();this._renderText(e,n,n._sTextWithPlaceholders);e.close("div")}e.close("div")}if(n._shouldContentBeRendered()){e.renderControl(n._oTimelineItemContent)}e.close("div")};n._renderText=function(n,t,o){var a=t._splitByPlaceholders(o);for(var r=0;r<a.length;r++){var d=/@@.\{\d+\}/;if(d.test(a[r])){n.renderControl(t._mAtMentionsLinks[a[r]])}else if(t.getProperty("feedEntry").ContentType==="text/html"){var s="<span>"+a[r]+"</span>";var l=jQuery.parseHTML(s)[0];var i=jQuery(l).find("a");if(i.length!==0){i.attr("target","_blank");s=l.outerHTML}n.renderControl(new e({content:s,sanitizeContent:true}))}else{a[r].split("\n").forEach(function(e,t){if(t>0){n.voidStart("br").voidEnd()}n.text(e)})}}};return n},true);
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/controls/FilterPopover", ["sap/ui/core/Control","sap/m/List","sap/m/library","sap/m/ResponsivePopover","sap/ui/base/ManagedObject"],function(t,e,o,n,i){"use strict";var r=o.PlacementType;var s=o.ListMode;var a=t.extend("sap.collaboration.components.controls.FilterPopover",{metadata:{interfaces:[],library:"sap.collaboration",properties:{title:{type:"string",group:"Appearance",defaultValue:null},noDataText:{type:"string",group:"Appearance",defaultValue:null}},events:{selectionChange:{parameters:{listItem:{type:"sap.m.ListItemBase"}}}},defaultAggregation:"items",aggregations:{items:{type:"sap.m.ListItemBase",multiple:true,singularName:"item",bindable:"bindable"}}},renderer:null});a.prototype.init=function(){this._oList=new e(this.getId()+"-list",{mode:s.SingleSelectMaster,includeItemInSelection:true,selectionChange:[this._selectionChange,this]});this._oResponsivePop=new n(this.getId()+"-popover",{placement:r.Auto,contentWidth:"15rem",content:[this._oList]})};a.prototype.exit=function(){this._oList=null;if(this._oResponsivePop){this._oResponsivePop.destroy();this._oResponsivePop=null}};a.prototype.openBy=function(t){this._oResponsivePop.openBy(t);return this};a.prototype.setTitle=function(t){this.setProperty("title",t,true);this._oResponsivePop.setTitle(t);return this};a.prototype.setNoDataText=function(t){this.setProperty("noDataText",t,true);this._oList.setNoDataText(t);return this};a.prototype.setSelectedItem=function(t){this._oList.setSelectedItem(t);return this};a.prototype.getSelectedItem=function(){return this._oList.getSelectedItem()};a.prototype._setModel=a.prototype.setModel;a.prototype.setModel=function(t,e){var o=Array.prototype.slice.call(arguments);this._oResponsivePop.setModel(t,e);a.prototype._setModel.apply(this,o);return this};a.prototype.bindAggregation=function(){var t=Array.prototype.slice.call(arguments);this._callMethodInManagedObject.apply(this,["bindAggregation"].concat(t));return this};a.prototype.validateAggregation=function(t,e,o){return this._callMethodInManagedObject("validateAggregation",t,e,o)};a.prototype.setAggregation=function(t,e,o){this._callMethodInManagedObject("setAggregation",t,e,o);return this};a.prototype.getAggregation=function(t,e){return this._callMethodInManagedObject("getAggregation",t,e)};a.prototype.indexOfAggregation=function(t,e){return this._callMethodInManagedObject("indexOfAggregation",t,e)};a.prototype.insertAggregation=function(t,e,o,n){this._callMethodInManagedObject("insertAggregation",t,e,o,n);return this};a.prototype.addAggregation=function(t,e,o){this._callMethodInManagedObject("addAggregation",t,e,o);return this};a.prototype.removeAggregation=function(t,e,o){this._callMethodInManagedObject("removeAggregation",t,e,o);return this};a.prototype.removeAllAggregation=function(t,e){return this._callMethodInManagedObject("removeAllAggregation",t,e)};a.prototype.destroyAggregation=function(t,e){this._callMethodInManagedObject("destroyAggregation",t,e);return this};a.prototype._callMethodInManagedObject=function(t,e){var o=Array.prototype.slice.call(arguments);if(e==="items"){return this._oList[t].apply(this._oList,o.slice(1))}else{return i.prototype[t].apply(this,o.slice(1))}};a.prototype._selectionChange=function(t){this._oResponsivePop.close();var e=t.getParameter("listItem");this.fireSelectionChange({listItem:e})};return a});
/**
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/controls/PlaceholderUtility", ["sap/ui/base/Object"],function(e){"use strict";var r="sap.collaboration.components.controls.PlaceholderUtility";var t=/@@.\{\d+\}/;var a=/@@[o]\{\d+\}/;var l=e.extend(r,{});l.getAtMentionsValues=function(e,r){var a=new RegExp(t);var l=this.splitByPlaceholders(r);var i=e;var n=[];var s=0;for(var f=0;f<l.length;f++){var c=l[f];if(a.test(c)==true){var o=l[f+1];var v="";if(o==""){var u=l[f+2];if(u==undefined){v=i;i=i.slice(i.indexOf(o))}else if(a.test(u)==true){v=this._findFirstPlaceholderValueInText(i);i=i.slice(v.length)}}else if(o==" "){v=this._findFirstPlaceholderValueInText(i);i=i.slice(v.length)}else{v=i.slice(0,i.indexOf(o));i=i.slice(i.indexOf(o))}if(!a.test(v)){n.push({placeholder:"@@m{"+s+"}",value:v});s++}}else{i=i.slice(c.length)}}return n};l.getContentItemName=function(e,r){var t=e;var l=r.split(a);for(var i=0;i<l.length;i++){t=t.replace(l[i],"")}var n=t.trim();return n};l.splitByPlaceholders=function(e){var r=[];if(e){var t=/@@.\{\d+\}/g;var a=e.split(t);var l=e.match(t);var i=l==null?0:l.length;for(var n=0;n<a.length+i;n++){if(n%2==0){r.push(a[n/2])}else{r.push(l[Math.floor(n/2)])}}}return r};l._findFirstPlaceholderValueInText=function(e){var r;if(e.search(t)==0){r=e.match(t)[0]}else{r=e[0]+e[1];for(var a=2;a<e.length;a++){if(e[a]==="‎"||e[a]==="‏"||e[a]==="@"){break}r+=e[a]}}r=r.trim();return r};Object.freeze(l);return l},true);
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/controls/ReplyPopover", ["sap/ui/thirdparty/jquery","sap/base/util/isEmptyObject","../utils/LanguageBundle","sap/ui/Device","sap/ui/core/Control","sap/ui/core/library","sap/ui/core/mvc/View","sap/ui/dom/includeStylesheet","sap/ui/model/json/JSONModel","sap/m/App","sap/m/Bar","sap/m/Button","sap/m/FeedListItem","sap/m/Label","sap/m/library","sap/m/Link","sap/m/List","sap/m/Page","sap/m/ResponsivePopover"],function(jQuery,e,t,o,s,i,r,a,l,p,n,h,_,y,u,c,R,d,f){"use strict";var T=i.mvc.ViewType;var g=u.ListSeparators;var P=u.PlacementType;a(sap.ui.require.toUrl("sap/collaboration/components/resources/css/SocialProfile.css"));a(sap.ui.require.toUrl("sap/collaboration/components/resources/css/ReplyPopover.css"));var v=s.extend("sap.collaboration.components.controls.ReplyPopover",{metadata:{library:"sap.collaboration",events:{postReplyPress:{parameters:{value:{type:"string"}}},moreRepliesPress:{},afterClose:{}},aggregations:{socialTextArea:{type:"sap.collaboration.components.controls.SocialTextArea",multiple:false}}},renderer:null});v.prototype.init=function(){this._oLangBundle=new t;this._oJSONModelData=[];this._oJSONModel=new l(this._oJSONModelData);this._oControlToReceiveFocus;this._oSocialProfileView;this._oReplyApp;this._oReplyPage;this._oReplyTextArea;this._oReplyList;this._oReplyButton;this._oReplyHeaderBar;this._pReplyPopover=this._createReplyPopover();this._pReplyPopover.then(e=>{this._oReplyPopover=e})};v.prototype.fullyCreated=function(){return this._pReplyPopover};v.prototype.exit=function(){if(this._oReplyPopover){this._oReplyPopover.destroy()}else if(this._pReplyPopover){this._pReplyPopover.then(()=>{this._oReplyPopover.destroy()})}};v.prototype.addReply=function(t){if(!e(t)){if(t.Text){t.Text=this._replaceCarriageReturnWithBRTag(t.Text)}this._oJSONModelData.push(t);this._oJSONModel.setData(this._oJSONModelData,true)}else{this._oReplyTextArea.focus()}};v.prototype.addReplies=function(e){var t=e&&e.data;if(t&&t.length!==0){var o=this._oReplyList.getItems().length;var s=t.length;for(var i=0;i<t.length;i++){if(t[i].Text){t[i].Text=this._replaceCarriageReturnWithBRTag(t[i].Text);t[i].Text="‎"+t[i].Text+"‎"}}this._oJSONModelData=t.concat(this._oJSONModelData);this._oJSONModel.setData(this._oJSONModelData,true);if(o!==0){this._oControlToReceiveFocus=this._oReplyList.getItems()[s]}if(e.more){this._oShowMoreBar.setVisible(true)}else{this._oShowMoreBar.setVisible(false)}}};v.prototype.openBy=function(e){if(!this._oReplyTextArea){this._oReplyTextArea=this.getSocialTextArea();this._oReplyTextArea.addStyleClass("replyTextAreaToBottom").addStyleClass("replyTextArea");this._oControlToReceiveFocus=this._oReplyTextArea;this._oReplyPage.addContent(this._oShowMoreBar).addContent(this._addList()).addContent(this._oReplyTextArea);this._oReplyPopover.setInitialFocus(this._oReplyTextArea)}this._oReplyPopover.openBy(e);return this};v.prototype.setBusyIndicatorDelay=function(e){this._oReplyPage.setBusyIndicatorDelay(e);return this};v.prototype.setBusy=function(e){this._oReplyPage.setBusy(e);return this};v.prototype.getTextArea=function(){return this._oReplyTextArea};v.prototype._createReplyPopover=async function(){var e=new f({showHeader:false,placement:P.Vertical,contentWidth:"25rem",contentHeight:"455px",content:await this._addApp(),afterClose:[function(){this._oReplyApp.backToTop();this._oReplyList.destroyItems();this._oJSONModelData=[];this._oJSONModel.setData(this._oJSONModelData);this._oShowMoreBar.setVisible(false);this._oControlToReceiveFocus=this._oReplyTextArea;this.fireAfterClose()},this]});return e};v.prototype._addList=function(){var e=this;var t=new _({text:"{Text}",icon:"{Creator/ThumbnailImage}",sender:"{Creator/FullName}",timestamp:"{CreatedAt}",iconActive:false,senderPress:function(t){var o=t.getSource().getBindingContext().getObject();var s=o.Creator.Email;e._oSocialProfileView.getViewData().memberId=s;e._oSocialProfileView.rerender();e._oReplyApp.to(e._oSocialProfilePage)}}).addStyleClass("replyFeedListItem");if(!this._oReplyList){this._oReplyList=new R({width:"100%",items:[],noDataText:this._oLangBundle.getText("ST_REPLY_LIST_AREA"),showNoData:true,showSeparators:g.None,updateFinished:function(t){var o=e._oReplyList.getItems().length;if(o!==0&&e._oControlToReceiveFocus===e._oReplyTextArea){e._oReplyList.getItems()[o-1].focus()}if(e._oReplyList.getItems().length===0){e._oReplyTextArea.addStyleClass("replyTextAreaToBottom");e._oReplyTextArea._oPop.setOffsetX(0)}else{var s=jQuery(e._oReplyList.getDomRef()).height();var i=jQuery(e._oReplyPopover.getDomRef("cont")).height();var r=jQuery(e._oReplyPage.getCustomHeader().getDomRef()).height();var a=parseInt(e._oReplyTextArea.getHeight());var l=jQuery(e._oReplyPage.getFooter().getDomRef()).height();if(s>i-r-a-l){e._oReplyTextArea.removeStyleClass("replyTextAreaToBottom");e._oReplyTextArea._oPop.setOffsetX(9)}else{e._oReplyTextArea.addStyleClass("replyTextAreaToBottom");e._oReplyTextArea._oPop.setOffsetX(0)}}e._oControlToReceiveFocus.focus()}})}this._oReplyList.setModel(this._oJSONModel);this._oReplyList.bindItems({path:"/",template:t});return this._oReplyList};v.prototype.enableButton=function(e){this._oReplyButton.setEnabled(e)};v.prototype._addApp=async function(){var e=this;if(this._oReplyApp){return this._oReplyApp}this._oReplyButton=new h({text:this._oLangBundle.getText("ST_REPLY_POST"),enabled:false,press:this._postReply.bind(e)});this._oShowMoreLink=new c({text:this._oLangBundle.getText("ST_SHOW_MORE_REPLIES"),press:this._showMoreReplies.bind(e)});this._oShowMoreBar=new n({contentMiddle:[this._oShowMoreLink],visible:false}).addStyleClass("showMoreReplies");this._oReplyPage=new d({showHeader:true,showSubHeader:false,showFooter:true,customHeader:new n({contentMiddle:[new y({text:this._oLangBundle.getText("ST_REPLY_TITLE")})]}),footer:new n({contentRight:[this._createMentionButton(),this._oReplyButton]})});this._oSocialProfileButton=new h({text:this._oLangBundle.getText("SP_OPEN_JAM_BUTTON"),press:function(){window.open(e._sUserProfileURL,"_blank")}});this._oSocialProfileView=await r.create({viewData:{langBundle:this._oLangBundle,popoverPrefix:this.getId(),afterUserInfoRetrieved:function(e){if(e){this._sUserProfileURL=e.WebURL}}},viewName:"module:sap/collaboration/components/socialprofile/SocialProfileView"});this._oSocialProfilePage=new d({title:this._oLangBundle.getText("SP_TITLE"),showNavButton:true,showHeader:true,showSubHeader:false,showFooter:true,navButtonPress:function(t){e._oReplyApp.back()},footer:new n({contentRight:[this._oSocialProfileButton]}),content:[this._oSocialProfileView]});this._oReplyApp=new p({backgroundColor:"#ffffff",pages:[this._oReplyPage,this._oSocialProfilePage]});return this._oReplyApp};v.prototype._createMentionButton=function(){if(o.system.phone){return}var e=new h({text:"@",tooltip:this._oLangBundle.getText("ST_MENTION_TOOLTIP"),press:[function(){this._oReplyTextArea.atMentionsButtonPressed()},this]});return e};v.prototype._replaceCarriageReturnWithBRTag=function(e){var t;if(typeof e==="string"){t=e.replace(/[\n\r]/g,"<br>")}return t};v.prototype._postReply=function(){var e=this._oReplyTextArea.convertTextWithFullNamesToEmailAliases();this.firePostReplyPress({value:e});this._oControlToReceiveFocus=this._oReplyTextArea};v.prototype._showMoreReplies=function(){this.fireMoreRepliesPress()};return v});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/controls/SocialTextArea", ["sap/ui/thirdparty/jquery","sap/ui/dom/includeStylesheet","sap/ui/model/json/JSONModel","sap/m/TextArea","sap/m/Popover","sap/m/List","sap/m/StandardListItem","./SuggestionUtility","../utils/LanguageBundle","sap/m/library","sap/ui/Device"],function(jQuery,e,t,i,n,s,r,o,a,u,h){"use strict";var l=u.ListSeparators;var f=u.ListMode;var g=u.PlacementType;e(sap.ui.require.toUrl("sap/collaboration/components/resources/css/SocialTextArea.css"));var d=i.extend("sap.collaboration.components.controls.SocialTextArea",{metadata:{library:"sap.collaboration",properties:{initialValue:{type:"string",group:"Data",defaultValue:null},enableNotifyAll:{type:"boolean",group:"Behavior",defaultValue:true},suggestionPlacement:{type:"sap.m.PlacementType",group:"Misc",defaultValue:g.VerticalPreferredBottom},suggestionHeight:{type:"sap.ui.core.CSSSize",group:"Appearance"}},events:{suggest:{parameters:{value:{type:"string"}}},afterSuggestionClose:{}}},renderer:{apiVersion:2}});d.prototype.init=function(){i.prototype.init.apply(this);this.addStyleClass("sapCollaborationSocialTextArea");this._sTextAreaOldValue="";this._sTextAreaCurrentValue="";this._aAtMentionBuffer=[];this._mCurrentAtMention=undefined;this._oModel=new t;var e=new r({title:"{fullName}",description:"{email}",icon:"{userImage}"});this._oList=new s(this.getId()+"-list",{mode:f.SingleSelectMaster,rememberSelections:false,showSeparators:l.None}).setModel(this._oModel).bindItems("/",e);this._oPop=new n(this.getId()+"-pop",{showHeader:false,showArrow:false,content:[this._oList]}).setInitialFocus(this);this._oSuggestionUtil=o;this._oLangBundle=new a;this._oList.attachSelectionChange(this.onSelectionChange.bind(this))};d.prototype.exit=function(){this._oPop.destroy();this._oPop=undefined;this._oSuggestionUtil=undefined};d.prototype.onBeforeRendering=function(){this._oPop.setPlacement(this.getSuggestionPlacement());this.getEnableNotifyAll()?this._oList.setProperty("noDataText",this._oLangBundle.getText("ST_NO_SUGGESTIONS",["@@notify"])):this._oList.setProperty("noDataText",this._oLangBundle.getText("ST_ADD_POST_NO_SUGGESTIONS"))};d.prototype.onAfterRendering=function(){i.prototype.onAfterRendering.apply(this);this._oPop.setContentWidth(this.$().width()+"px");var e=this.$().children()[0];if(e){jQuery("#"+e.id).css({height:"100%"})}this.$().css({"padding-top":"0","padding-bottom":"0"})};d.prototype.oninput=function(e){i.prototype.oninput.apply(this,[e]);if(e.isMarked("invalid")){return}this._sTextAreaCurrentValue=this.getValue();if(this._sTextAreaCurrentValue.trim()===""){this._aAtMentionBuffer=[];this.closeSuggestionPopover()}else{this._triggerSuggestions(this._sTextAreaCurrentValue,this._sTextAreaOldValue)}this._sTextAreaOldValue=this._sTextAreaCurrentValue};d.prototype.onSelectionChange=function(e){var t=e.getParameter("listItem");var i=t.getProperty("title");var n=t.getProperty("description");this._sTextAreaCurrentValue=this._oSuggestionUtil.getTextAreaValueAfterSuggestionSelected(i,n,this._mCurrentAtMention,this._aAtMentionBuffer,this._sTextAreaCurrentValue,i==="@@notify");this.setValue(this._sTextAreaCurrentValue);this._sTextAreaOldValue=this._sTextAreaCurrentValue;this.closeSuggestionPopover();this.selectText(this._mCurrentAtMention.endIndex+2,this._mCurrentAtMention.endIndex+2);this._oList.removeSelections()};d.prototype.showSuggestions=function(e){if(e.length!==0&&e[e.length-1].fullName!=="@@notify"&&this.getEnableNotifyAll()){e.push({fullName:"@@notify",email:this._oLangBundle.getText("ST_ATATNOTIFY_DESCRIPTION"),userImage:"sap-icon://world"})}if(e.length!==0){this._oPop.close()}this._oModel.setData(e);this._oPop.openBy(this);return this};d.prototype.setInitialValue=function(e){this.setProperty("initialValue",e,true);this.setValue(e);this._aAtMentionBuffer=[];this._sTextAreaCurrentValue=e;this._sTextAreaOldValue=e;return this};d.prototype.setSuggestionHeight=function(e){this.setProperty("suggestionHeight",e,true);this._oPop.setContentHeight(e);return this};d.prototype.closeSuggestionPopover=function(){this._oPop.close();this.fireAfterSuggestionClose();return this};d.prototype.clearText=function(){this._sTextAreaCurrentValue="";this._sTextAreaOldValue="";this._aAtMentionBuffer=[];this.setValue("");return this};d.prototype.convertTextWithFullNamesToEmailAliases=function(){return this._oSuggestionUtil.convertTextWithFullNamesToEmailAliases(this.getValue(),this._aAtMentionBuffer)};d.prototype.atMentionsButtonPressed=function(){var e=this.getDomRef("inner").selectionStart;var t=this._oSuggestionUtil.atMentionsButtonPressed(this.getValue(),e);this.setValue(t.newValue);this._sTextAreaCurrentValue=this.getValue();this.focus();this.selectText(t.cursorPosition,t.cursorPosition);this._triggerSuggestions(this._sTextAreaCurrentValue,this._sTextAreaOldValue);this._sTextAreaOldValue=this._sTextAreaCurrentValue;return this};d.prototype._triggerSuggestions=function(e,t){if(!h.system.phone){var i=this._oSuggestionUtil.getChangesInTextArea(e,t);if(i.operation==="addChar"){this._handleAddedCharacters(i,e)}else if(i.operation==="deleteChar"){this._handleDeletedCharacters(i,e,this._aAtMentionBuffer)}}};d.prototype._handleAddedCharacters=function(e,t){var i=e.changeIndex;var n=e.charactersChanged;var s=this._aAtMentionBuffer.length;var r=this.getEnableNotifyAll();if(r&&n[0]==="@"&&t[i-1]==="@"&&(t[i-2]===" "||t[i-2]==="\n"||t[i-2]===undefined)){this.showSuggestions([{fullName:"@@notify",email:this._oLangBundle.getText("ST_ATATNOTIFY_DESCRIPTION"),userImage:"sap-icon://world"}]);for(var o=0;o<s;o++){if(this._aAtMentionBuffer[o].startIndex===i-1){this._aAtMentionBuffer[o].endIndex+=n.length}else if(i<this._aAtMentionBuffer[o].startIndex){this._oSuggestionUtil.maintainAtMentionIndices(this._aAtMentionBuffer[o],n.length)}}}else if(n[0]==="@"||n[0]===" "&&n[1]==="@"){if(n[1]==="@"){i+=1}var a=this._oSuggestionUtil.addToAtMentionBuffer(this._aAtMentionBuffer,i,n);this._mCurrentAtMention=this._aAtMentionBuffer[a];if(n==="@ "){this._mCurrentAtMention.endIndex-=1}var u=t[this._mCurrentAtMention.startIndex-1];var h=this._mCurrentAtMention.endIndex+1;if(u===" "||u===undefined||u==="\n"){var l=t[h];while(l!==" "&&l!==undefined&&l!=="\n"){h+=1;l=t[h]}this._mCurrentAtMention.endIndex=h-1;this.fireSuggest({value:t.substring(i+1,h)})}else{this.closeSuggestionPopover()}}else{for(var o=s-1;o>=0;o--){if(i>this._aAtMentionBuffer[o].startIndex){var f=this._oSuggestionUtil.getStringAfterAtMention(i+n.length-1,t,this._aAtMentionBuffer[o]);var g=this._oSuggestionUtil.getStringBeforeAtMention(this._aAtMentionBuffer[o],t,i);var d=g+n+f;var _=new RegExp("^"+d);if(r&&_.test("@notify")){this._aAtMentionBuffer[o].endIndex=this._aAtMentionBuffer[o].endIndex+n.length;this._mCurrentAtMention=this._aAtMentionBuffer[o];this.showSuggestions([{fullName:"@@notify",email:this._oLangBundle.getText("ST_ATATNOTIFY_DESCRIPTION"),userImage:"sap-icon://world"}])}else if(!d.match(/ /g)||d.match(/ /g)&&d.match(/ /g).length===1){if((this._aAtMentionBuffer[o].atMentioned===true||this._aAtMentionBuffer[o].notifyAll===true)&&i<=this._aAtMentionBuffer[o].endIndex){var p=this._aAtMentionBuffer[o].startIndex;var A=t.slice(0,p)+" "+t.slice(p+1,t.length);this.setValue(A);this._sTextAreaCurrentValue=A;this._aAtMentionBuffer.splice(o,1);this.selectText(i+1,i+1);this.closeSuggestionPopover()}else if(d.search("\n")===-1&&d.search("@")===-1){this._aAtMentionBuffer[o].endIndex=this._aAtMentionBuffer[o].startIndex+d.length;this._mCurrentAtMention=this._aAtMentionBuffer[o];var u=t[this._mCurrentAtMention.startIndex-1];if(u===" "||u===undefined||u==="\n"){this.fireSuggest({value:d})}}else{this.closeSuggestionPopover()}}else{this.closeSuggestionPopover()}break}this._oSuggestionUtil.maintainAtMentionIndices(this._aAtMentionBuffer[o],n.length);if(o===0){this.closeSuggestionPopover()}}}};d.prototype._handleDeletedCharacters=function(e,t){var i=e.changeIndex;var n=e.charactersChanged;var s=undefined;var r=this._oSuggestionUtil.isDeletedCharPartOfAtMentioned(this._aAtMentionBuffer,i);if(r!==undefined){if(this._aAtMentionBuffer[r].atMentioned===true||this._aAtMentionBuffer[r].notifyAll===true){this.closeSuggestionPopover();this._sTextAreaCurrentValue=this._sTextAreaCurrentValue.substr(0,this._aAtMentionBuffer[r].startIndex)+this._sTextAreaCurrentValue.substr(this._aAtMentionBuffer[r].endIndex-e.numberOfCharsChanged+1);this.setValue(this._sTextAreaCurrentValue);this.selectText(this._aAtMentionBuffer[r].startIndex,this._aAtMentionBuffer[r].startIndex);this._sTextAreaOldValue=this._sTextAreaCurrentValue;s=1+this._aAtMentionBuffer[r].endIndex-this._aAtMentionBuffer[r].startIndex;this._aAtMentionBuffer.splice(r,1)}else{s=e.numberOfCharsChanged;var o=t[this._aAtMentionBuffer[r].startIndex-1];if(n.search("@")!==-1&&t[e.changeIndex-1]!=="@"){this.closeSuggestionPopover();this._aAtMentionBuffer.splice(r,1)}else if(o===" "||o===undefined||o==="\n"){this._aAtMentionBuffer[r].endIndex-=s;var a=t.substring(this._aAtMentionBuffer[r].startIndex+1,this._aAtMentionBuffer[r].endIndex+1);var u=new RegExp("^"+a);if(a!==""&&u.test("@notify")){this.showSuggestions([{fullName:"@@notify",email:this._oLangBundle.getText("ST_ATATNOTIFY_DESCRIPTION"),userImage:"sap-icon://world"}])}else{this.fireSuggest({value:a})}}}}r=r||0;s=s||e.numberOfCharsChanged;for(var h=r;h<this._aAtMentionBuffer.length;h++){if(i<this._aAtMentionBuffer[h].startIndex){this._oSuggestionUtil.maintainAtMentionIndices(this._aAtMentionBuffer[h],-s)}}};return d});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/controls/SuggestionUtility", ["sap/ui/base/Object"],function(e){"use strict";var n=e.extend("sap.collaboration.components.controls.SuggestionUtility",{});n.maintainAtMentionIndices=function(e,n){e.startIndex=e.startIndex+n;e.endIndex=e.endIndex+n};n.getChangesInTextArea=function(e,n){if(n!==""){var t=e.length>n.length?e.length:n.length;var r=Math.abs(e.length-n.length);var a=function(n,t){return e.substring(t,t+n)};var i=function(e,t){return n.substring(t,t+e)};for(var s=0;s<t;s++){if(e[s]!==n[s]){return e.length>n.length?{operation:"addChar",charactersChanged:a(r,s),changeIndex:s,numberOfCharsChanged:r}:{operation:"deleteChar",charactersChanged:i(r,s),changeIndex:s,numberOfCharsChanged:r}}}}else{return{operation:"addChar",charactersChanged:e,changeIndex:0}}};n.convertTextWithFullNamesToEmailAliases=function(e,n){var t="";var r=n.length;var a=0;if(r!==0){for(var i=0;i<r;i++){if(n[i].atMentioned){var s="@"+n[i].email.split("@")[0];t=t+e.substring(a,n[i].startIndex)+s}else{t=t+e.substring(a,n[i].endIndex+1)}a=n[i].endIndex+1}t=t+e.substring(n[r-1].endIndex+1,e.length);return t}return e};n.getStringAfterAtMention=function(e,n,t){var r="";var a=e;function i(){while(n[a+1]!==" "&&n[a+1]!==undefined&&n[a+1]!=="\n"){r=r.concat(n[a+1]);a+=1}}i();if(t.atMentioned&&n[a+1]===" "&&n[a+1]<=t.endIndex){r=r.concat(n[a+1]);a+=1;i()}return r};n.getStringBeforeAtMention=function(e,n,t){var r=n.substring(e.startIndex+1,t);return r};n.addToAtMentionBuffer=function(e,n,t){var r=0;var a=e.length;if(a===0){e.push({startIndex:n,endIndex:n+t.length-1,atMentioned:false});r=0}else{for(var i=0;i<a;i++){if(n<=e[i].startIndex){this.maintainAtMentionIndices(e[i],t.length)}}for(var i=a-1;i>=0;i--){if(n>e[i].startIndex){e.splice(i+1,0,{startIndex:n,endIndex:n+t.length-1,atMentioned:false});r=i+1;break}else if(i===0){e.splice(0,0,{startIndex:n,endIndex:n+t.length-1,atMentioned:false});r=0}}}return r};n.isDeletedCharPartOfAtMentioned=function(e,n){var t=e.length;for(var r=0;r<t;r++){if(n>=e[r].startIndex&&n<=e[r].endIndex){return r}}};n.getTextAreaValueAfterSuggestionSelected=function(e,n,t,r,a,i){var s=t.startIndex;var d=t.endIndex;var o=a.length;var l;var u="@notify";if(i){l=a.substr(0,s+1)+u+" "+a.substr(d+1);t.endIndex=s+u.length;t.notifyAll=true}else{l=a.substr(0,s+1)+e+" "+a.substr(d+1);t.endIndex=s+e.length;t.atMentioned=true;t.email=n}var f=l.length;var g=f-o;var h=r.indexOf(t);for(var c=h+1;c<r.length;c++){this.maintainAtMentionIndices(r[c],g)}return l};n.atMentionsButtonPressed=function(e,n){var t;var r=e.slice(0,n);var a=e.slice(n,e.length);var i="";if(e[n-1]===" "||e[n-1]==="\n"||e[n-1]===undefined){i="@";t=n+1}else{i=" @";t=n+2}var s=r+i+a;return{newValue:s,cursorPosition:t}};return n});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/controls/TimelineEntryEmbedded", ["sap/ui/core/Control","sap/ui/dom/includeStylesheet","sap/collaboration/components/utils/LanguageBundle","sap/collaboration/components/controls/TimelineEntryEmbeddedRenderer","sap/m/Text","sap/m/Link","sap/m/List","sap/m/FeedListItem","sap/m/Popover","sap/m/library"],function(e,t,i,n,a,r,s,o,l,p){"use strict";var m=p.PlacementType;var T=e.extend("sap.collaboration.components.controls.TimelineEntryEmbedded",{metadata:{interfaces:[],library:"sap.collaboration",properties:{timelineEntry:{type:"object",group:"data"}},events:{},aggregations:{}},renderer:n});T.prototype.init=function(){this._oLangBundle=new i;t(sap.ui.require.toUrl("sap/collaboration/components/resources/css/EmbeddedControl.css"));this._aTimelineItemTextDisplay};T.prototype.onBeforeRendering=function(){if(!this._aTimelineItemTextDisplay){this._createTimelineItemText()}};T.prototype.exit=function(){if(this._aTimelineItemTextDisplay){this._aTimelineItemTextDisplay.forEach(function(e){e.destroy()})}if(this._oPopover){this._oPopover.destroy()}};T.prototype._getTimelineItemTextControls=function(){return this._aTimelineItemTextDisplay};T.prototype._createTimelineItemText=function(){var e=this.getTimelineEntry();this._aTimelineItemTextDisplay=[];if(e.timelineEntryDetails!=undefined&&e.timelineEntryDetails.length>0){var t=this._parseTimelineEntryDetail(e.timelineEntryDetails[0]);this._aTimelineItemTextDisplay.push(new a({text:t+" "}).addStyleClass("alignMiddle"));if(e.timelineEntryDetails.length>1){var i=this._createTLEntryDetailsLink(e.timelineEntryDetails).addStyleClass("alignMiddle");this._aTimelineItemTextDisplay.push(i)}}else{this._aTimelineItemTextDisplay.push(new a({text:e.text}).addStyleClass("alignMiddle"))}};T.prototype._renderTimelineItemText=function(e){var t=" ";if(this._aTimelineItemTextDisplay.length>0){e.openStart("div",this).openEnd();for(var i=0;i<this._aTimelineItemTextDisplay.length;i++){var n=this._aTimelineItemTextDisplay[i].getMetadata().getName();switch(n){case"sap.m.Text":var a=this._aTimelineItemTextDisplay[i].getText();if(a.search(/\s/)==0){var r=a.search(/\S/);do{e.text(t);r--}while(r>0)}e.renderControl(this._aTimelineItemTextDisplay[i]);if(a[a.length-1]==" "){var s=a.length-1;var o=a[s];do{e.text(t);o=a[--s]}while(o==" "&&o!=undefined)}break;case"sap.m.Link":case"sap.ui.core.HTML":default:e.renderControl(this._aTimelineItemTextDisplay[i])}}e.close("div")}};T.prototype._createTLEntryDetailsLink=function(e){var t=this;var i=e.length-1;var n=this._oLangBundle.getText("TE_LINK_TEXT",[i]);var a=new r(this.getId()+"_PopoverLink",{text:n});a.attachPress(function(){if(!t._oPopover){t._oPopover=t._createTLEntryDetailsPopover(e)}t._oPopover.openBy(a)});return a};T.prototype._createTLEntryDetailsPopover=function(e){var t=new s(this.getId()+"_ChangeList",{inset:false});for(var i in e){var n=this._parseTimelineEntryDetail(e[i]);var a=new o({text:n,showIcon:false});t.addItem(a)}var r="20em";var p=new l(this.getId()+"_Popover",{contentWidth:r,placement:m.Auto,title:this._oLangBundle.getText("TE_DETAILS_POPOVER_HEADER")+"("+e.length+")",content:[t]});return p};T.prototype._parseTimelineEntryDetail=function(e){var t="";switch(e.changeType){case"U":t=this._oLangBundle.getText("TE_DETAILS_CHANGED",[e.propertyLabel,e.beforeValue,e.afterValue]);break;case"I":t=this._oLangBundle.getText("TE_DETAILS_SET",[e.propertyLabel,e.afterValue]);break;case"D":t=this._oLangBundle.getText("TE_DETAILS_CLEARED",[e.propertyLabel,e.beforeValue]);break}return t};return T});
/**
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/controls/TimelineEntryEmbeddedRenderer", [],function(){"use strict";var e={apiVersion:2};e.render=function(e,n){var t=n._getTimelineItemTextControls().length;if(t>0){n._renderTimelineItemText(e)}};return e},true);
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/feed/BOMode", ["./Mode","sap/collaboration/components/utils/PendingRequestsUtil","sap/ui/model/odata/v2/ODataModel","sap/ui/thirdparty/jquery"],function(e,t,o,jQuery){"use strict";var i=e.extend("sap.collaboration.components.feed.BOMode",{constructor:function(o){e.apply(this,[o]);this._sJamBOId=undefined;this._oPendingRequestsUtil=new t;this._oSMIModel=this._oFeedController.getModel("smi");this._oLanguageBundle=this._oFeedController.getLanguageBundle();this.groupSelectorLoaded.then(e=>{this._oList.setModel(this._oJamModel)});this.FILTER_CONSTANTS={GROUP_WALL:"Group Wall",GROUP_OBJECT_WALL:"Group Object Wall"};o.getTimelineReady()?.then(()=>{o.byId("filter_popover").attachSelectionChange(this.onFilterSelection,this)})}});i._sSMIv2ServiceUrl="/sap/opu/odata/sap/SM_INTEGRATION_V2_SRV";i.prototype.start=function(e){if(!(this._oCommonUtil.isObject(e)&&this._oCommonUtil.isString(e.appContext)&&this._oCommonUtil.isString(e.odataServicePath)&&this._oCommonUtil.isString(e.collection)&&this._oCommonUtil.isString(e.key)&&this._oCommonUtil.isString(e.name))){var t="The feedSources' data object is invalid.";this._oFeedController.logError(t);throw new Error(t)}this._sendRequestMapInternalBOToExternalBO(e.appContext,e.collection,e.key,e.odataServicePath).then(function(e,t){return this._sendRequestExternalObjects_FindByExidAndObjectType(e.MapInternalBOToExternalBO.Exid,e.MapInternalBOToExternalBO.ObjectType)}.bind(this),function(e){this._oFeedController.logError("The internal to external mapping for the business object could not be performed.");this._oFeedController.displayErrorMessage(this._oLanguageBundle.getText("SMIV2_INTERNAL_TO_EXTERNAL_BO_MAPPING_COULD_NOT_BE_PERFORMED"));return null}.bind(this)).then(function(e,t){this._sJamBOId=this._oCommonUtil.getODataResult(e).Id;this._oList.attachUpdateFinished(this.onGroupSelectorUpdateFinished,this);this._oList.bindItems({path:"/ExternalObjects('"+this._oCommonUtil.getODataResult(e).Id+"')/Groups",template:this._oListItemTemplate})}.bind(this),function(e){if(e!==null){this._oFeedController.logError("An external object associated with the given Exid and ObjectType could not be found.");this._oFeedController.displayErrorMessage(this._oLanguageBundle.getText("JAM_EXTERNAL_OBJECT_COULD_NOT_BE_FOUND"))}}.bind(this));this._oFeedController.enableGroupFeed();this._oViewDataModel.setProperty("/filterEnabled",true);this._setFilterOptions(e.name);this.groupSelectorLoaded.then(()=>{this._oList.attachUpdateFinished(this.onUpdateFinished,this)})};i.prototype.stop=function(){this._oPendingRequestsUtil.abortAll();this._oViewDataModel.setProperty("/filterEnabled",false);this.groupSelectorLoaded.then(()=>{this._oList.detachUpdateFinished(this.onUpdateFinished,this)})};i.prototype._sendFunctionImportODataRequest=function(e,t,o){var i=jQuery.Deferred();var n=e.callFunction(t,{urlParameters:o,success:function(e,t){i.resolve(e,t)},error:function(e){i.reject(e)}});var r=i.promise(n);this._oPendingRequestsUtil.add(r);i.always(function(){this._oPendingRequestsUtil.remove(r)}.bind(this));return r};i.prototype._sendRequestMapInternalBOToExternalBO=function(e,t,o,i){return this._sendFunctionImportODataRequest(this._oSMIModel,"/MapInternalBOToExternalBO",{ApplicationContext:e,ODataCollection:t,ODataKeyPredicate:o,ODataServicePath:i})};i.prototype._sendRequestExternalObjects_FindByExidAndObjectType=function(e,t){return this._sendFunctionImportODataRequest(this._oJamModel,"/ExternalObjects_FindByExidAndObjectType",{Exid:e,ObjectType:t})};i.prototype._setFilterOptions=function(e){var t;e?t=this._oLanguageBundle.getText("GF_FILTER_OBJECT",[e]):t=this._oLanguageBundle.getText("GF_FILTER_OBJECT_DEFAULT");var o=[{Name:this._oLanguageBundle.getText("GF_FILTER_GROUP"),key:this.FILTER_CONSTANTS.GROUP_WALL},{Name:t,key:this.FILTER_CONSTANTS.GROUP_OBJECT_WALL}];this._oViewDataModel.setProperty("/filter",o);this._oFeedController.getTimelineReady()?.then(()=>{var e=this._oFeedController.byId("filter_popover");e.setSelectedItem(e.getItems()[0])})};i.prototype.getAddPostPath=function(){var e=this._oViewDataModel.getProperty("/groupSelected/Id");return"/GroupExternalObjects(GroupId='"+e+"',ExternalObjectId='"+this._sJamBOId+"')/FeedEntries"};i.prototype.displayFeedSourceSelectorPopover=function(e){this._oList.setBusy(true);this._oJamModel.refresh(true);this._oGroupSelectPopover.openBy(e)};i.prototype.onGroupSelected=function(e){var t=e.getSource().getSelectedItem().getBindingContext().getObject();this._oViewDataModel.setProperty("/groupSelected",{Id:t.Id,Name:t.Name,WebURL:t.WebURL});this._oViewDataModel.setProperty("/feedEndpoint","/Groups('"+t.Id+"')/FeedEntries");this._oViewDataModel.setProperty("/filterMessage","");this._oFeedController.getTimelineReady()?.then(()=>{var e=this._oFeedController.byId("filter_popover");e.setSelectedItem(e.getItems()[0])});this._oGroupSelectPopover.close()};i.prototype.onBatchCompleted=function(e){};i.prototype.onGroupSelectorUpdateFinished=function(){var e=this._oList.getItems();var t;var o;if(e.length>0){t=e[0];this._oList.setSelectedItem(t);o=t.getBindingContext().getObject();this._oViewDataModel.setProperty("/groupSelected",o);this._oViewDataModel.setProperty("/feedEndpoint","/Groups('"+o.Id+"')/FeedEntries")}this._oList.detachUpdateFinished(this.onGroupSelectorUpdateFinished,this)};i.prototype.onUpdateFinished=function(){this._oList.setBusy(false)};i.prototype.onFilterSelection=function(e){var t=e.getParameter("listItem");var o=t.getBindingContext().getObject();var i=this._oViewDataModel.getProperty("/groupSelected/Id");switch(o.key){case this.FILTER_CONSTANTS.GROUP_WALL:this._oViewDataModel.setProperty("/filterMessage","");this._oViewDataModel.setProperty("/feedEndpoint","/Groups('"+i+"')/FeedEntries");break;case this.FILTER_CONSTANTS.GROUP_OBJECT_WALL:this._oViewDataModel.setProperty("/filterMessage",this._oLanguageBundle.getText("ST_FILTER_TEXT")+" "+o.Name);this._oViewDataModel.setProperty("/feedEndpoint","/GroupExternalObjects(GroupId='"+i+"',ExternalObjectId='"+this._sJamBOId+"')/FeedEntries");break}};i.prototype.getFeedUpdatesLatestCount=function(){var e=this._oFeedController.byId("timeline").getContent()[0];var t=e?e.getModel().getProperty("/TopLevelId"):"";var o=this._oViewDataModel.getProperty("/groupSelected/Id");if(this._oViewDataModel.getProperty("/filterMessage")===""){return this._sendRequestGroup_SinceLatestCount(t,o)}else{var i=this._sJamBOId;return this._sendRequestGroupExternalObject_SinceLatestCount(t,o,i)}};i.prototype._sendRequestGroup_SinceLatestCount=function(e,t){return this._sendFunctionImportODataRequest(this._oJamModel,"/Group_FeedLatestCount",{LatestTopLevelId:e,Id:t})};i.prototype._sendRequestGroupExternalObject_SinceLatestCount=function(e,t,o){return this._sendFunctionImportODataRequest(this._oJamModel,"/GroupExternalObject_FeedLatestCount",{LatestTopLevelId:e,GroupId:t,ExternalObjectId:o})};i.prototype._initializeModels=function(){e.prototype._initializeModels.apply(this);var t=new o(i._sSMIv2ServiceUrl,true);this._oFeedController.setSmiModel(t)};i.prototype.getSMIv2ServiceUrl=function(){return i._sSMIv2ServiceUrl};return i});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/feed/Component", ["sap/base/Log","sap/ui/core/UIComponent","sap/suite/ui/commons/library","sap/ui/core/mvc/View","sap/ui/core/mvc/ViewType"],function(e,t,i,o,n){"use strict";var r=i.TimelineAxisOrientation;var s="sap.collaboration.components.feed.Component";var a=t.extend("sap.collaboration.components.feed.Component",{metadata:{stereotype:"component",version:"1.0",includes:["../resources/css/MorePopover.css"],dependencies:{libs:[],components:[],ui5version:""},properties:{axisOrientation:{type:"sap.suite.ui.commons.TimelineAxisOrientation",group:"Misc",defaultValue:r.Vertical},feedSources:{type:"any"},enableScroll:{type:"boolean",defaultValue:true}},rootView:null,publicMethods:["setSettings","getSelectedGroup"],aggregations:{},routing:{},config:{},customizing:{},interfaces:["sap.ui.core.IAsyncContentCreation"]},init:function(){this._logger=e.getLogger(s);t.prototype.init.apply(this)},exit:function(){},onBeforeRendering:function(){},onAfterRendering:function(){},createContent:async function(){this.viewPromise=o.create({id:this.createId("group_feed_view"),height:"100%",type:n.XML,viewName:"sap.collaboration.components.feed.views.GroupFeed"});this._view=await this.viewPromise;return this._view},setSettings:function(e){for(var t in e){if(e.hasOwnProperty(t)){this._setProperty(t,e[t])}}},getSelectedGroup:function(){return this._view.getModel().getProperty("/groupSelected")},_setProperty:function(e,t){this._logger.info(e+": "+t);if(this._view){this._view.getModel().setProperty("/"+e,t);this.setProperty(e,t)}else{this.viewPromise.then(i=>{i.getModel().setProperty("/"+e,t);this.setProperty(e,t)})}},setAxisOrientation:function(e){this._setProperty("axisOrientation",e);return this},setFeedSources:function(e){this._setProperty("feedSources",e)},setEnableScroll:function(e){this._setProperty("enableScroll",e);return this}});return a});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/feed/GroupIDsMode", ["sap/base/Log","sap/base/util/isEmptyObject","sap/ui/thirdparty/jquery","./Mode","sap/collaboration/components/utils/PendingRequestsUtil"],function(e,t,jQuery,o,r){"use strict";var i=o.extend("sap.collaboration.components.feed.GroupIDsMode",{constructor:function(e){o.apply(this,[e]);this._oPendingRequestsUtil=new r;this._iOpenGroupRequests;this._aGroupsToLoad;this.oResult;this.groupSelectorLoaded.then(e=>{this._oList.setModel(this._oViewDataModel)})}});i.prototype.start=function(e){if(!this._oCommonUtil.isArrayOfStrings(e)){var t="The feedSources' data object is invalid.";this._oFeedController.logError(t);throw new Error(t)}if(e.length===0){this._oFeedController.disableGroupFeed();return}e=e.filter(function(t,o){return e.indexOf(t)===o&&t.trim()!==""});this._oViewDataModel.setProperty("/groups",[]);this._oViewDataModel.setProperty("/groupSelected/Id",undefined);this._iOpenGroupRequests=0;this._aGroupsToLoad=jQuery.merge([],e);this.groupSelectorLoaded.then(e=>{this._oGroupSelectPopover.setBusyIndicatorDelay(0).setBusy(true);this._fillGroupInfo();this._oListItemTemplate.then(e=>{this._oList.bindItems({path:"/groups",template:e})})})};i.prototype.onBatchCompleted=function(e){this._oJamModel.setUseBatch(false);if(this._iOpenGroupRequests===0){if(this._oGroupSelectPopover!==undefined){this._oGroupSelectPopover.setBusy(false)}}};i.prototype.stop=function(){this._oPendingRequestsUtil.abortAll()};i.prototype.getAddPostPath=function(){var e=this._oViewDataModel.getProperty("/groupSelected/Id");return"/Groups('"+e+"')/FeedEntries"};i.prototype.displayFeedSourceSelectorPopover=function(e){this._oGroupSelectPopover.openBy(e)};i.prototype.onGroupSelected=function(e){var t=e.getSource().getSelectedItem().getBindingContext().getObject();this._oViewDataModel.setProperty("/groupSelected",t);this._oViewDataModel.setProperty("/feedEndpoint","/Groups('"+t.Id+"')/FeedEntries");this._oGroupSelectPopover.close()};i.prototype._fillGroupInfo=function(){var o=10;var r=0;var i=0;var s=0;var a=20;this._oJamModel.setUseBatch(true);var n="$filter=Id eq '";for(var p=0,u=this._aGroupsToLoad.length;p<u;p++){if(!(p%a==0)){n=n.concat(" or Id eq '"+this._aGroupsToLoad[p].replace(/'/g,"''")+"'")}else{n=n.concat(this._aGroupsToLoad[p].replace(/'/g,"''")+"'")}s++;if(s===a||p+1===u){this._iOpenGroupRequests++;var d;this._loadGroups(n,r).done(function(o,r){d=this._oCommonUtil.getODataResult(o);if(!t(d)){if(d.length!=undefined){var i=this._aGroupsToLoad.indexOf(d[0].Id);for(var s=0,a=d.length;s<a;s++){this._oViewDataModel.setProperty("/groups/"+i,d[s]);i++}}else{this._oViewDataModel.setProperty("/groups/"+this._aGroupsToLoad.indexOf(d.Id),d)}}this._iOpenGroupRequests--;if(this._iOpenGroupRequests===0){if(this._oViewDataModel.getProperty("/groups/").length===0){this._oFeedController.disableGroupFeed();e.warning("No group information was retrieved for the current user.")}else{this._oFeedController.enableGroupFeed();var n=this._oViewDataModel.getProperty("/groups/");n=n.filter(function(e){return e!==undefined&&e!==null});this._oViewDataModel.setProperty("/groups/",n);this._oViewDataModel.setProperty("/groupSelected",n[0]);this._oViewDataModel.setProperty("/feedEndpoint","/Groups('"+n[0].Id+"')/FeedEntries")}}}.bind(this));i++;s=0;n="$filter=Id eq '"}if(i==o){r++;i=0}}};i.prototype._loadGroups=function(e,t){if(!this.isJamServiceAvailable()){return}var o=this;var r=jQuery.Deferred();var i="/Groups/";var s={urlParameters:e+"&$select=Id,Name,WebURL",success:function(e,t){r.resolveWith(o,[e,t])},error:function(e){r.rejectWith(o,[e]);o._oFeedController.logError("The group information was not retrieved.")},batchGroupId:t};var a=this._oJamModel.read(i,s);this._oPendingRequestsUtil.add(a);var n=r.promise(a);n.always(function(){this._oPendingRequestsUtil.remove(a)});return n};return i});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/feed/Mode", ["sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/Fragment","sap/collaboration/components/utils/CommonUtil","sap/ui/model/odata/v2/ODataModel","sap/ui/thirdparty/jquery"],function(e,t,o,r,a,i,jQuery){"use strict";var n=e.extend("sap.collaboration.components.feed.Mode",{constructor:function(e){this._oCommonUtil=new a;this._oFeedController=e;this._initializeModels();this._oViewDataModel=this._oFeedController.getModel();this._oJamModel=this._oFeedController.getModel("jam");var t=this._getGroupSelectorFragmentId();this.groupSelectorLoaded=r.load({id:t,name:"sap.collaboration.components.feed.fragments.GroupSelector",controller:this}).then(e=>{this._oGroupSelectPopover=r.byId(t,"responsivePopover");this._oGroupSelectPopover.setModel(this._oFeedController.getModel("i18n"),"i18n");this._oList=r.byId(t,"list");this._oList.addStyleClass("RightToLeftParenthesisStyling");this._oList.setBusyIndicatorDelay(0)});this._oListItemTemplate=r.load({name:"sap.collaboration.components.feed.fragments.CustomListItem",controller:this})}});n._bJamServiceAvailable=true;n._sJamServiceUrl="/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData";n._nextGroupSelectorFragmentIdIndex=0;n.prototype._getGroupSelectorFragmentId=function(){return this._oFeedController.createId("groupSelectorFragment")+n._nextGroupSelectorFragmentIdIndex++};n.prototype.getFeedEntries=function(e,t){var o=jQuery.Deferred();var r={urlParameters:{$expand:"Creator,TargetObjectReference"},success:function(e,t){o.resolve(e,t)},error:function(e){o.reject(e)}};if(t){r.urlParameters.$skiptoken=t}return o.promise(this._oJamModel.read(e,r))};n.prototype.onGroupSearch=function(e){var r=new t("Name",o.Contains,e.getParameter("newValue"));this._oList.getBinding("items").filter([r])};n.prototype.addPost=function(e){var t=jQuery.Deferred();var o=this.getAddPostPath();var r={Text:e};var a={success:function(e,o){t.resolve(e,o)},error:function(e){t.reject(e)}};return{path:o,payload:r,promise:t.promise(this._oJamModel.create(o,r,a))}};n.prototype.getFeedUpdatesLatestCount=function(){var e=jQuery.Deferred();var t=this._oFeedController.byId("timeline").getContent()[0];var o=t?t.getModel().getProperty("/TopLevelId"):"";var r=this._oViewDataModel.getProperty("/groupSelected/Id");var a="/Group_FeedLatestCount";var i={urlParameters:{LatestTopLevelId:o,Id:r},success:function(t,o){e.resolve(t,o)},error:function(t){e.reject(t)}};return e.promise(this._oJamModel.callFunction(a,i))};n.prototype._initializeModels=function(){var e=new i(n._sJamServiceUrl);e.attachMetadataFailed(this._oFeedController._onMetadataFailed,this._oFeedController);e.attachRequestCompleted(this._oFeedController._onJamRequestCompleted,this._oFeedController);e.attachRequestFailed(this._oFeedController._onJamRequestFailed,this._oFeedController);e.attachRequestSent(this._oFeedController._onJamRequestSent,this._oFeedController);e.attachBatchRequestCompleted(this._oFeedController._onBatchCompleted,this._oFeedController);e.attachBatchRequestFailed(this._oFeedController._onBatchFailed,this._oFeedController);e.attachBatchRequestSent(this._oFeedController._onBatchSent,this._oFeedController);this._oFeedController.setJamModel(e)};n.prototype.getJamServiceUrl=function(){return n._sJamServiceUrl};n.prototype.isJamServiceAvailable=function(){return n._bJamServiceAvailable};n.prototype.setJamServiceAvailable=function(e){n._bJamServiceAvailable=e};return n});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/feed/ModeFactory", ["./GroupIDsMode","./BOMode","./UserMode","sap/collaboration/library"],function(e,o,s,n){"use strict";var r=n.FeedType;var t=function(){this._oFeedTypeToModeClass={};this._oFeedTypeToModeClass[r.GroupIds]=e;this._oFeedTypeToModeClass[r.BusinessObjectGroups]=o;this._oFeedTypeToModeClass[r.UserGroups]=s};t._instance=null;t.getInstance=function(){if(t._instance===null){t._instance=new t}return t._instance};t.prototype.createMode=function(e,o){var s=this._oFeedTypeToModeClass[e];if(s===undefined){var n=e+" is not a valid value for the feedSources mode property.\n";n+="It must be equal to the value of either one of the following:\n";n+="sap.collaboration.FeedType.GroupIds\n";n+="sap.collaboration.FeedType.BusinessObjectGroups\n";n+="sap.collaboration.FeedType.UserGroups";o.logError(n);o.byId("timeline").destroy();throw new Error(n)}return new s(o)};return t},true);
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/feed/UserMode", ["./Mode"],function(e){"use strict";var t=e.extend("sap.collaboration.components.feed.UserMode",{constructor:function(t){e.apply(this,[t]);this.groupSelectorLoaded.then(e=>{this._oList.setModel(this._oJamModel)})}});t.prototype.start=function(){this.groupSelectorLoaded.then(e=>{this._oList.attachUpdateFinished(this.onGroupSelectorUpdateFinished,this);this._oList.attachUpdateFinished(this.onUpdateFinished,this);this._oListItemTemplate.then(e=>{this._oList.bindItems({path:"/Groups",template:e})});this._oFeedController.enableGroupFeed()})};t.prototype.stop=function(){this.groupSelectorLoaded.then(e=>{this._oList.detachUpdateFinished(this.onUpdateFinished,this)})};t.prototype._updateSelectedGroupInViewDataModel=function(e){this._oViewDataModel.setProperty("/groupSelected",{Id:e.Id,Name:e.Name,WebURL:e.WebURL});this._oViewDataModel.setProperty("/feedEndpoint","/Groups('"+e.Id+"')/FeedEntries")};t.prototype.getAddPostPath=function(){return"/Groups('"+this._oViewDataModel.getProperty("/groupSelected/Id")+"')/FeedEntries"};t.prototype.displayFeedSourceSelectorPopover=function(e){this.groupSelectorLoaded.then(t=>{this._oList.setBusy(true);this._oJamModel.refresh(true);this._oGroupSelectPopover.openBy(e)})};t.prototype.onGroupSelected=function(e){this.groupSelectorLoaded.then(t=>{var o=e.getSource().getSelectedItem().getBindingContext().getObject();this._updateSelectedGroupInViewDataModel(o);this._oGroupSelectPopover.close()})};t.prototype.onBatchCompleted=function(){};t.prototype.onGroupSelectorUpdateFinished=function(){this.groupSelectorLoaded.then(e=>{var t=this._oList.getItems();var o;var i;if(t.length>0){o=t[0];this._oList.setSelectedItem(o);i=o.getBindingContext().getObject();this._updateSelectedGroupInViewDataModel(i)}this._oList.detachUpdateFinished(this.onGroupSelectorUpdateFinished,this)})};t.prototype.onUpdateFinished=function(){this.groupSelectorLoaded.then(e=>{this._oList.setBusy(false)})};return t});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/feed/views/GroupFeed.controller", ["sap/ui/thirdparty/jquery","sap/base/Log","sap/base/security/encodeURL","sap/base/util/isEmptyObject","sap/ui/core/mvc/Controller","sap/suite/ui/commons/TimelineItem","sap/m/MessageBox","sap/collaboration/components/utils/LanguageBundle","sap/collaboration/components/utils/DateUtil","sap/collaboration/components/controls/FeedEntryEmbedded","sap/collaboration/components/controls/ReplyPopover","sap/collaboration/components/controls/SocialTextArea","sap/collaboration/components/controls/FilterPopover","sap/collaboration/components/utils/CommonUtil","sap/collaboration/components/feed/ModeFactory","sap/ui/model/json/JSONModel","sap/m/ToolbarSpacer","sap/m/Button","sap/m/library","sap/ui/core/Fragment","sap/m/ResponsivePopover","sap/ui/Device","sap/ui/core/CustomData","sap/m/Link","sap/ui/core/message/MessageType","sap/m/List","sap/m/CustomListItem","sap/collaboration/library","sap/ui/core/Component"],function(jQuery,e,t,i,s,o,n,a,r,d,l,u,h,c,g,_,p,f,m,y,v,b,M,P,T,S,R,I,C){"use strict";var E=I.FeedType;var w=m.PlacementType;var F=m.ButtonType;var L="sap.collaboration.components.feed.views.GroupFeed";let A=null;var B=s.extend(L,{onInit:function(){this._initializeUtilities();this._initializeRequestStateData();this._initializeSystemData();this._initializeModels();A=this._initializeTimeline()},onBeforeRendering:function(){if(!this._oMode.isJamServiceAvailable()){this.displayErrorMessage()}},onAfterRendering:function(){},onExit:function(){this._abortAllPendingRequests();this.byId("filter_popover").destroy();this.byId("addPost_popover").destroy();this._stopAutoCheckingForNewUpdates()},_initializeUtilities:function(){this._oCommonUtil=new c;this._oLogger=e.getLogger(L);this._oLanguageBundle=new a;this._oDateUtil=new r},_initializeSystemData:function(){this._oModes={};this._mCurrentUser},_initializeRequestStateData:function(){this._oNextLinks={feedEntriesNextLink:"",repliesNextLink:""};this._oPendingRequests={loadingFeedEntriesRequest:undefined,loadingRepliesRequest:undefined,loadingSuggestionsRequest:undefined,loadingFeedAtMentions:undefined,refreshingSecurityToken:undefined};this._oPostRequestData={path:undefined,payload:undefined,parameters:undefined}},_initializeModels:function(){var e=this._oLanguageBundle.createResourceModel();this.getView().setModel(e,"i18n");this._i18nModel=e;var t=new _;t.setData({feedSources:undefined,axisOrientation:undefined,enableSocial:true,enableScroll:undefined,forceGrowing:false,growingThreshold:20,groupSelectorEnabled:false,groupSelected:{},groups:[],filterEnabled:false,filter:[],filterMessage:"",feedEndpoint:undefined,addPostButtonEnabled:false});t.bindProperty("/feedSources").attachChange(this._onFeedSourcesChange,this);t.bindProperty("/feedEndpoint").attachChange(this._onFeedEndpointChange,this);t.bindProperty("/filterMessage").attachChange(this._onFilterMessageChange,this);this.getView().setModel(t);this._oViewDataModel=t},_initializeTimeline:async function(){var e=this.byId("timeline");e.setContent([]);await this._modifyHeaderBar();await this._createSocialProfile()},_modifyHeaderBar:async function(){var e=this.byId("timeline").getHeaderBar();e.removeAllContent();var t=this._createGroupSelector();e.insertContent(t,0);var i=new p(this.createId("header_spacer"));e.insertContent(i,1);if(!this.byId("filter_popover")){var s=await y.load({name:"sap.collaboration.components.feed.fragments.CustomListItem",controller:this});new h(this.createId("filter_popover"),{title:this._oLanguageBundle.getText("ST_FILTER_HEADER")}).setModel(this._oViewDataModel).bindItems("/filter",s);var o=new f(this.createId("filter_button"),{enabled:"{/filterEnabled}",visible:"{/filterEnabled}",icon:"sap-icon://filter",type:F.Transparent,press:[function(){this.byId("filter_popover").openBy(this.byId("filter_button"))},this]}).setModel(this._oViewDataModel);e.insertContent(o,2);var n=this._createAddPostButton();e.insertContent(n,3)}else{var o=new f(this.createId("filter_button"),{enabled:"{/filterEnabled}",visible:"{/filterEnabled}",icon:"sap-icon://filter",type:F.Transparent,press:[function(){this.byId("filter_popover").openBy(this.byId("filter_button"))},this]}).setModel(this._oViewDataModel);e.insertContent(o,2);var n=this._createAddPostButton();e.insertContent(n,3)}},_createGroupSelector:function(){var e=new f(this.createId("groupSelect_button"),{icon:"sap-icon://slim-arrow-down",iconFirst:false,text:"{/groupSelected/Name}",width:"20em",enabled:"{/groupSelectorEnabled}",type:F.Transparent,press:[this.onGroupSelectorButtonPress,this]});e.setModel(this._oViewDataModel);return e},_createAddPostButton:function(){if(this.byId("addPost_popover")===undefined){new v(this.createId("addPost_popover"),{placement:w.Auto,title:this._oLanguageBundle.getText("ST_ADD_POST_TITLE"),contentWidth:"25rem",contentHeight:"10rem",content:new u(this.createId("social_TextArea"),{height:"10rem",width:"100%",liveChange:[function(e){e.getParameter("value").trim()!==""?this.byId("addPost_postButton").setEnabled(true):this.byId("addPost_postButton").setEnabled(false)},this],suggest:[this.onSuggest,this],afterSuggestionClose:[function(){this._oPendingRequests.loadingSuggestionsRequest&&this._oPendingRequests.loadingSuggestionsRequest.abort()},this]}),endButton:new f(this.createId("addPost_postButton"),{text:this._oLanguageBundle.getText("ST_ADD_POST_BUTTON"),enabled:false,press:[this.onAddPost,this]})}).setInitialFocus(this.byId("social_TextArea"));if(!b.system.phone){this.byId("addPost_popover").setBeginButton(new f(this.createId("addPost_atMentionButton"),{text:"@",press:[function(){this.byId("social_TextArea").atMentionsButtonPressed()},this]}))}}var e=new f(this.createId("addPost_button"),{enabled:"{/addPostButtonEnabled}",icon:"sap-icon://add",type:F.Transparent,press:[function(){this.byId("addPost_popover").openBy(this.byId("addPost_button"))},this]});e.setModel(this._oViewDataModel);return e},_clearTimeline:function(){var e=this.byId("timeline");e.destroyContent()},_createTimelineItem:async function(e){var t=new _(e);var i=new d(this.createId(e.Id+"_embedded"),{feedEntry:"{/}",serviceUrl:this._oMode.getJamServiceUrl(),expandCollapseClick:[function(){this.byId("timeline").adjustUI()},this],atMentionClick:[this.onAtMentionClicked,this],previewLoad:[function(e){this.byId("timeline").adjustUI()},this]});var s=new l(this.createId("replyPostPopover_"+e.Id),{socialTextArea:new u({height:"80px",width:"100%",suggestionPlacement:w.Top,suggest:[this.onSuggest,this],afterSuggestionClose:[function(){this._oPendingRequests.loadingSuggestionsRequest&&this._oPendingRequests.loadingSuggestionsRequest.abort()},this]}),postReplyPress:[this.onPostReplyPress,this],moreRepliesPress:[function(e){var t=e.getSource().getParent();this._getReplies(undefined,t.getModel().getData().Replies.__next,t)},this],afterClose:[function(){if(this._oPendingRequests.loadingRepliesRequest){this._oPendingRequests.loadingRepliesRequest.abort()}this._bReplyPopoverIsOpen=false},this]});await s.fullyCreated();s.getSocialTextArea().attachLiveChange(function(e){e.getParameter("value").trim()!==""?this.enableButton(true):this.enableButton(false)}.bind(s));var n=new M({key:"1",value:this._oLanguageBundle.getText("ST_MORE_CUSTOM_ACTION")});var a=new o(this.createId(e.Id),{dateTime:"{/CreatedAt}",userName:"{/Creator/FullName}",title:"{/Action}",text:"{/Text}",icon:"sap-icon://post",userNameClickable:this._oViewDataModel.getProperty("/enableSocial"),userNameClicked:[this.onUserNameClicked,this],userPicture:{path:"/Creator/Id",formatter:this._buildThumbnailImageURL.bind(this)},replyCount:"{/RepliesCount}",embeddedControl:i,customReply:s,replyListOpen:[this.onReplyListOpen,this],customAction:n,customActionClicked:[this.onMoreClicked,this]});a.setModel(t);a.setTitle("‎"+a.getTitle()+"‎");return a},_addFeedEntriesToTimeline:async function(e){var t=this.byId("timeline");for(const s of e){var i=await this._createTimelineItem(s);t.addContent(i)}},_processFeedEntries:async function(e){if(e.length>0){await this._addFeedEntriesToTimeline(e)}else{this._oViewDataModel.setProperty("/forceGrowing",false)}this._setTimelineToNotBusy()},_processAtMentions:function(){if(this._oPendingRequests.loadingFeedAtMentions&&this._oPendingRequests.loadingFeedAtMentions.state("pending")){this._oPendingRequests.loadingFeedAtMentions.abort()}var e=this;var i;var s={async:true,success:function(t,i){o.resolveWith(e,[t,i])},error:function(t){e._oLogger.error("Failed to retrieve the @mentions.");o.rejectWith(e,[t])}};if(this._oAtMention.atMentionsNextLink){i="/"+this._oAtMention.atMentionsNextLink;s.urlParameters=this._extractUrlParams(decodeURIComponent(this._oAtMention.atMentionsNextLink))}else{i="/FeedEntries("+t("'"+this._oAtMention.feedId+"'")+")/AtMentions"}var o=jQuery.Deferred();o.done(function(t,i){e._oAtMention.atMentionsNextLink=t.__next;e._oAtMention.aAtMentions=e._oCommonUtil.getODataResult(t).concat(e._oAtMention.aAtMentions);if(e._oAtMention.atMentionsNextLink){e._processAtMentions()}else{var s={openingControl:e._oAtMention.oUserNameLink,memberId:e._oAtMention.aAtMentions[e._oAtMention.placeholderIndex].Email};e._pSocialProfile.then(()=>{e._oSocialProfile.setSettings(s);e._oSocialProfile.open()})}});this._oPendingRequests.loadingFeedAtMentions=o.promise(this._oJamModel.read(i,s))},_createSocialProfile:async function(){this._pSocialProfile=C.create({name:"sap.collaboration.components.socialprofile"});this._oSocialProfile=await this._pSocialProfile;return this._oSocialProfile},_setTimelineToBusy:function(){var e=this.byId("timeline");e.setBusyIndicatorDelay(0).setBusy(true)},_setTimelineToNotBusy:function(){var e=this.byId("timeline");e.setBusyIndicatorDelay(0).setBusy(false)},_showFeedUpdatesInTimeline:function(e){var t=this.byId("timeline");var i=t.getMessageStrip();if(e>0){if(!this.byId("refreshLink")){var s=new P(this.createId("refreshLink"),{text:this._oLanguageBundle.getText("GF_REFRESH_FEED"),press:[function(){var e=this._oViewDataModel.getProperty("/feedEndpoint");this._initialLoadFeedEntries(e)},this]});i.setLink(s);i.setType(T.Information);i.setShowIcon(true)}e==1?t.setCustomMessage(this._oLanguageBundle.getText("GF_NEW_FEED_UPDATE")):t.setCustomMessage(this._oLanguageBundle.getText("GF_NEW_FEED_UPDATES",[e]));i.setVisible(true);t.rerender()}},_hideFeedUpdatesInTimeline:function(){var e=this.byId("timeline").getMessageStrip();e.close()},onGrow:function(e){if(!this._oPendingRequests.loadingFeedEntriesRequest||!this._oPendingRequests.loadingFeedEntriesRequest.state()!="pending"){var t=this._oViewDataModel.getProperty("/feedEndpoint");this._loadFeedEntries(t).done(this._loadFeedEntriesSuccess.bind(this))}},onGroupSelectorButtonPress:function(e){this._oMode.displayFeedSourceSelectorPopover(e.getSource())},onAddPost:function(e){this.byId("addPost_popover").close();var t=this.byId("social_TextArea").convertTextWithFullNamesToEmailAliases();if(t&&t.trim()!==""){this._getLoggedInUser().done(function(){this._setTimelineToBusy();var e=async function(e,t){this.byId("social_TextArea").clearText();this.byId("addPost_postButton").setEnabled(false);this._setTimelineToNotBusy();var i=this._oCommonUtil.getODataResult(e);i.Creator=this._mCurrentUser;var s=await this._createTimelineItem(i);this.byId("timeline").insertContent(s,0)};var i=function(e){this._oLogger.error("Error occured when adding a post.",e.stack)};var s=this._oMode.addPost(t);this._oPostRequestData={path:s.path,payload:s.payload};this._oPostRequestData.parameters={success:e,error:i};var o=s.promise;o.then(e.bind(this),i.bind(this))}.bind(this))}else{this._oLogger.info("Posting an empty comment is not allowed, no feed entry will be created.")}},onReplyListOpen:function(e){var t=e.getSource().getCustomReply();t.getTextArea().focus();if(!this._bReplyPopoverIsOpen){this._bReplyPopoverIsOpen=true;var i=e.getSource();var s=i.getModel().getProperty("/Id");this._getReplies(s,undefined,i)}},onPostReplyPress:function(e){var i=this;var s=e.getParameter("value");var o=e.getSource().getParent();var n=o.getCustomReply();var a=o.getModel().getData().Id;var r="/FeedEntries('"+t(a)+"')/Replies";var d={Text:s};this._getLoggedInUser();this._getLoggedInUser().done(function(){var e={async:true,success:function(e,t){n.getTextArea().clearText();n.enableButton(false);n.setBusy(false);var s=i._oCommonUtil.getODataResult(e);var a={CreatedAt:i._oDateUtil.formatDateToString(s.CreatedAt),Text:s.Text,Creator:i._mCurrentUser};a.Creator.ThumbnailImage=i._buildThumbnailImageURL(i._mCurrentUser.Id);n.addReply(a);o.getModel().setProperty("/RepliesCount",o.getModel().getProperty("/RepliesCount")+1)},error:function(e){i._oLogger.error("Failed to post reply: "+e.statusText,e.stack)}};n.getTextArea().focus();n.setBusyIndicatorDelay(0).setBusy(true);this._oPostRequestData={path:r,payload:d,parameters:e};this._oJamModel.create(r,d,e)}.bind(this))},onSuggest:function(e){var t=this;if(this._oPendingRequests.loadingSuggestionsRequest){this._oPendingRequests.loadingSuggestionsRequest.abort()}var i=e.getSource();var s=e.getParameter("value");if(s.trim()===""){i.showSuggestions([])}else{var o="/Members_Autocomplete";var n=this._oViewDataModel.getProperty("/groupSelected/Id");var a={async:true,urlParameters:{Query:"'"+s+"'",GroupId:"'"+n+"'",$top:"4"},success:function(e,i){r.resolveWith(t,[e,i])},error:function(e){t._oLogger.error("Failed to get suggestions: "+e.statusText);r.rejectWith(t,[e])}};var r=jQuery.Deferred();r.done(function(e,s){var o=t._oCommonUtil.getODataResult(e);if(o.length===0){i.closeSuggestionPopover()}else{var n=[];var a=o.length;for(var r=0;r<a;r++){n.push({fullName:o[r].FullName,email:o[r].Email,userImage:t._buildThumbnailImageURL(o[r].Id)})}i.showSuggestions(n)}});this._oPendingRequests.loadingSuggestionsRequest=r.promise(this._oJamModel.read(o,a))}},onUserNameClicked:function(e){var t=e.getParameter("uiElement");var i=e.getSource().getModel();var s=i.getProperty("/Creator/Email");this._pSocialProfile.then(()=>{this._oSocialProfile.setSettings({openingControl:t,memberId:s});this._oSocialProfile.open()})},onMoreClicked:function(e){var t=e.getSource().getModel().getProperty("/WebURL");var i=e.getSource().getModel().getProperty("/Id");var s=e.getSource().getParent().getModel().getProperty("/groupSelected/Name");var o=e.getSource().getParent().getModel().getProperty("/groupSelected/WebURL");var n=this.byId(this.createId("moreListPopover_"+i));if(n===undefined){var a=new S(this.createId("moreList_"+i),{});var r=new P(this.createId("groupNameLink_"+i),{text:this._oLanguageBundle.getText("ST_GROUP_NAME_LINK",[s]),target:"_blank",href:o,width:"15em"}).addStyleClass("sapCollaborationCustomLinkPadding");var d=new R(this.createId(i+"_groupNameLinkListItem"),{content:r});a.addItem(d);var l=new P(this.createId("feedEntryLink_"+i),{text:this._oLanguageBundle.getText("ST_FEED_ENTRY_LINK"),target:"_blank",href:t,width:"15em"}).addStyleClass("sapCollaborationCustomLinkPadding");var u=new R(this.createId("feedEntryLinkListItem_"+i),{content:l});a.addItem(u);var h=false;if(b.system.phone){h=true}n=new v(this.createId("moreListPopover_"+i),{content:a,showHeader:h,title:this._oLanguageBundle.getText("ST_MORE_CUSTOM_ACTION"),showCloseButton:true,placement:w.VerticalPreferredBottom,contentWidth:"15em"});var c=function(){this.close()};r.attachPress(c.bind(n));l.attachPress(c.bind(n))}n.openBy(e.getParameter("linkObj"))},onAtMentionClicked:function(e){var t=e.getSource().getModel().getProperty("/Id");var i=e.getParameter("link");var s=i.getModel().getProperty("/placeholderIndex");this._oAtMention={feedId:t,oUserNameLink:i,placeholderIndex:s,aAtMentions:[],atMentionsNextLink:undefined};this._processAtMentions()},_onFeedEndpointChange:function(e){var t=e.getSource().getValue();this._initialLoadFeedEntries(t)},_onFeedSourcesChange:async function(e){var t;var i=e.getSource().getValue();if(Array.isArray(i)){i={mode:E.GroupIds,data:i}}if(this._oMode){this._oMode.stop()}if(this._oCommonUtil.isString(i.mode)){if(this._oModes[i.mode]===undefined){var s=await g.getInstance().createMode(i.mode,this);this._oModes[i.mode]=s;this._oMode=this._oModes[i.mode];this._oMode.start(i.data)}}else{t="The mode must be a string.";this.logError(t);this.byId("timeline").destroy();throw new Error(t)}this._oMode=this._oModes[i.mode];this._oMode.start(i.data)},_onFilterMessageChange:function(e){var t=e.getSource().getValue();this.byId("timeline").setCustomMessage(t);this.byId("timeline").rerender()},_onMetadataFailed:function(e){switch(e.oSource.sServiceUrl){case this._oMode.getJamServiceUrl():this._oLogger.error("Failed to load Jam metadata. Service unavailable or possible missing JAM configuration.");this._displayJamConnectionErrorMessage();this._oMode.setJamServiceAvailable(false);break;case this._oMode.getSMIv2ServiceUrl():this._oLogger.error("Failed to load SMIv2 metadata.");this.displayErrorMessage();break}this.disableGroupFeed()},_onJamRequestCompleted:function(e){var t=e.getParameter("method");if(e.success&&t==="POST"){this._oPendingRequests.refreshingSecurityToken=undefined}},_onJamRequestFailed:function(e){this._setTimelineToNotBusy();var t=e.getParameter("method");var i=parseInt(e.getParameter("response").statusCode);var s=e.getParameter("feedEndpoint");if(!s){s=e.getParameter("url")}if(/ExternalObjects_FindByExidAndObjectType/.test(s)){this.disableGroupFeed();return}switch(i){case 403:if(t==="POST"){if(this._oPendingRequests.refreshingSecurityToken===undefined){this._refreshSecurityToken().done(function(e,t){this._oJamModel.create(this._oPostRequestData.path,this._oPostRequestData.payload,this._oPostRequestData.parameters)})}else{this._oPendingRequests.refreshingSecurityToken=undefined;this.displayErrorMessage(this._oLanguageBundle.getText("JAM_NO_ACCESS_TO_POST_TO_GROUP"))}}else{this.displayErrorMessage(this._oLanguageBundle.getText("JAM_FORBIDDEN_ACCESS"))}break;case 404:if(/Groups\(.*\)\/FeedEntries/.test(s)){this.displayErrorMessage(this._oLanguageBundle.getText("JAM_NO_ACCESS_TO_GROUP"));this.disableGroupFeed()}else if(/Groups\(.*\)/.test(s)){this.displayErrorMessage(this._oLanguageBundle.getText("JAM_NO_ACCESS_TO_GROUP"));this.disableGroupFeed()}else if(/GroupExternalObject_FeedLatestCount|Group_FeedLatestCount/.test(s)){this._stopAutoCheckingForNewUpdates()}else{this.displayErrorMessage()}break;case 500:case 503:this._displayJamConnectionErrorMessage();break;default:this.displayErrorMessage()}},_onJamRequestSent:function(e){},_onBatchCompleted:function(e){this._oJamModel.setUseBatch(false);this._oMode.onBatchCompleted(e)},_onBatchFailed:function(e){},_onBatchSent:function(e){},_abortAllPendingRequests:function(){if(this._oPendingRequests.loadingFeedEntriesRequest){this._oPendingRequests.loadingFeedEntriesRequest.abort()}if(this._oPendingRequests.loadingRepliesRequest){this._oPendingRequests.loadingRepliesRequest.abort()}if(this._oPendingRequests.loadingSuggestionsRequest){this._oPendingRequests.loadingSuggestionsRequest.abort()}},_refreshSecurityToken:function(){var e=this;var t=jQuery.Deferred();return this._oPendingRequests.refreshingSecurityToken=t.promise(this._oJamModel.refreshSecurityToken(function(i,s){e._oLogger.info("Security token refreshed");t.resolveWith(e,[i,s])},function(i){e._oLogger.error("Security token error: "+i.statusText);t.rejectWith([i],e)}))},_getLoggedInUser:function(){var e=jQuery.Deferred();if(!this._mCurrentUser){var t="/Self";var i={success:function(t,i){this._mCurrentUser=this._oCommonUtil.getODataResult(t);e.resolve(t,i)}.bind(this),error:function(t){this._oLogger.error("Failed to get the logged in user",t.stack);e.reject(t)}.bind(this)};return e.promise(this._oJamModel.read(t,i))}return e.resolve()},_loadFeedEntries:function(e){var t=undefined;if(!this._oMode.isJamServiceAvailable()){return}this._setTimelineToBusy();var i=this._oNextLinks.feedEntriesNextLink;if(i!==""){i=decodeURIComponent(i);t=this._extractUrlParams(i).$skiptoken}return this._oPendingRequests.loadingFeedEntriesRequest=this._oMode.getFeedEntries(e,t)},_loadFeedEntriesSuccess:function(e,t){this._oNextLinks.feedEntriesNextLink=e.__next;var i=this._oCommonUtil.getODataResult(e);return this._processFeedEntries(i)},_initialLoadFeedEntries:function(e){if(this._oPendingRequests.loadingFeedEntriesRequest){this._oPendingRequests.loadingFeedEntriesRequest.abort()}this._initializeRequestStateData();this._oViewDataModel.setProperty("/forceGrowing",true);this._hideFeedUpdatesInTimeline();this._stopAutoCheckingForNewUpdates();this._loadFeedEntries(e).done([this._clearTimeline.bind(this),this._loadFeedEntriesSuccess.bind(this),this._startAutoCheckingForNewUpdates.bind(this)])},_getReplies:function(e,i,s){var o=this;var n;var a={async:true,urlParameters:{$orderby:"CreatedAt desc",$expand:"Creator"},success:function(e,t){o._oLogger.info("Replies were successfully retrieved.");d.resolveWith(o,[e,t])},error:function(e){o._oLogger.error("Failed to retrieve replies: "+e.statusText);d.rejectWith(o,[e])}};var r=s.getCustomReply();if(i){n="/"+i;a.urlParameters=this._extractUrlParams(decodeURIComponent(i));a.urlParameters.$orderby=a.urlParameters.$orderby.replace("+"," ")}else{n="/FeedEntries('"+t(e)+"')/Replies"}var d=jQuery.Deferred();d.done(function(e,t){var i=o._oCommonUtil.getODataResult(e).reverse();i.forEach(function(e){e.Creator.ThumbnailImage=o._buildThumbnailImageURL(e.Creator.Id);e.CreatedAt=o._oDateUtil.formatDateToString(e.CreatedAt)});r.addReplies({data:i,more:e.__next?true:false});s.getModel().getData().Replies.__next=e.__next}).always(function(){r.setBusy(false)}).fail(function(){r._oReplyPopover.close()});r.setBusyIndicatorDelay(0).setBusy(true);this._oPendingRequests.loadingRepliesRequest=d.promise(this._oJamModel.read(n,a))},logError:function(e){this._oLogger.error(e)},getModel:function(e){return this.getView().getModel(e)},setModel:function(e,t){this.getView().setModel(e,t)},getLanguageBundle:function(){return this._oLanguageBundle},setJamModel:function(e){this._oJamModel=e;this.setModel(e,"jam")},setSmiModel:function(e){this._oSMIModel=e;this.setModel(e,"smi")},displayErrorMessage:function(e){var t=e||this._oLanguageBundle.getText("SYSTEM_ERROR_MESSAGEBOX_GENERAL_TEXT");n.error(t)},_displayJamConnectionErrorMessage:function(){var e=this._oLanguageBundle.getText("JAM_CONNECTION_ERROR_MESSAGEBOX_TEXT");n.error(e)},disableGroupFeed:function(){this._abortAllPendingRequests();var e=this.byId("timeline");if(!i(e)){e.setBusyIndicatorDelay(0).setBusy(false);this._clearTimeline();this._oViewDataModel.setProperty("/groupSelectorEnabled",false);this._oViewDataModel.setProperty("/addPostButtonEnabled",false);this._oViewDataModel.setProperty("/forceGrowing",false)}},enableGroupFeed:function(){var e=this.byId("timeline");if(!i(e)){e.setBusyIndicatorDelay(0).setBusy(false);this._oViewDataModel.setProperty("/groupSelectorEnabled",true);this._oViewDataModel.setProperty("/addPostButtonEnabled",true);this._oViewDataModel.setProperty("/forceGrowing",true)}},_startAutoCheckingForNewUpdates:function(){this._iNewFeedUpdatesCheckerTimeDelay=12e4;this._sNewFeedUpdatesCheckerTimeoutId=setTimeout(this._checkForNewFeedUpdates.bind(this),this._iNewFeedUpdatesCheckerTimeDelay)},_stopAutoCheckingForNewUpdates:function(){clearTimeout(this._sNewFeedUpdatesCheckerTimeoutId)},_checkForNewFeedUpdates:function(){var e=function(e,t){this._showFeedUpdatesInTimeline(e);this._sNewFeedUpdatesCheckerTimeoutId=setTimeout(this._checkForNewFeedUpdates.bind(this),this._iNewFeedUpdatesCheckerTimeDelay)};var t=function(e){this._oLogger.error("Failed to check for new feed updates.");this._sNewFeedUpdatesCheckerTimeoutId=setTimeout(this._checkForNewFeedUpdates.bind(this),this._iNewFeedUpdatesCheckerTimeDelay)};this._oMode.getFeedUpdatesLatestCount().done(e.bind(this)).fail(t.bind(this))},_extractUrlParams:function(e){var t=e.slice(e.indexOf("?")+1);var i=t.split("&");var s={};i.forEach(function(e){var t=e.indexOf("=");s[e.slice(0,t)]=e.slice(t+1)});return s},_buildThumbnailImageURL:function(e){return this._oJamModel.sServiceUrl+"/Members('"+t(e)+"')/ThumbnailImage/$value"}});B.prototype.getTimelineReady=function(){return A};return B},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/Component", ["sap/base/Log","sap/collaboration/components/utils/CommonUtil","sap/collaboration/library","sap/ui/core/UIComponent","sap/ui/model/odata/ODataModel","sap/ui/core/mvc/View","sap/ui/core/library"],function(e,t,i,o,a,s,r){"use strict";var n=i.FeedType;var p=r.mvc.ViewType;var d=i.AppType;var l=o.extend("sap.collaboration.components.fiori.feed.Component",{metadata:{properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:""},height:{type:"sap.ui.core.CSSSize",defaultValue:""},oDataServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/opu/odata/sap/SM_INTEGRATION_SRV"},feedType:{type:"string"},groupIds:{type:"string"},object:{type:"object"}},aggregations:{},events:{},interfaces:["sap.ui.core.IAsyncContentCreation"]},init:function(){this.CollaborationFeedConstants={defaultWidth:"100%",defaultHeight:"100%"};this.setWidth(this.CollaborationFeedConstants.defaultWidth);this.setHeight(this.CollaborationFeedConstants.defaultHeight);this.mode=d.widget;this.oCommonUtil=new t;this.oLangBundle=this.oCommonUtil.getLanguageBundle();o.prototype.init.apply(this)},setSettings:function(e){this.setODataServiceUrl(e.oDataServiceUrl);this.setFeedType(e.feedType);this.setGroupIds(e.groupIds);this.setObject(e.object)},onBeforeRendering:function(){var t=true;try{this.bStopRendering=false;this.validateInputParameters();this.sODataServiceUrl=this.getODataServiceUrl();if(!this.oOdataModel){this.oOdataModel=new a(this.sODataServiceUrl,t)}}catch(t){e.error(t,"","sap.collaboration.components.fiori.feed.Component.onBeforeRendering()");this.bStopRendering=true;this.oCommonUtil.displayError(t)}if(sap.ui.getCore().byId(this.getId()+"_oAppView")){sap.ui.getCore().byId(this.getId()+"_oAppView").destroy()}if(sap.ui.getCore().byId(this.getId()+"_oSplitAppView")){sap.ui.getCore().byId(this.getId()+"_oSplitAppView").destroy()}},onAfterRendering:function(){if(!this.bStopRendering){e.debug("Feed Component properties:","","sap.collaboration.components.fiori.feed.Component.onAfterRendering()");e.debug("width: "+this.getWidth());e.debug("height: "+this.getHeight());e.debug("oDataServiceUrl: "+this.getODataServiceUrl());e.debug("feedType: "+this.getFeedType());e.debug("groupIds: "+this.getGroupIds());e.debug("object: "+JSON.stringify(this.getObject()));try{if(this.getMode()===d.widget){var t=sap.ui.view({id:this.getId()+"_oAppView",viewData:{controlId:this.getId(),odataModel:this.oOdataModel,appType:this.getMode(),feedType:this.getFeedType(),groupIds:this.getGroupIds(),object:this.getObject(),langBundle:this.oLangBundle},viewName:"module:sap/collaboration/components/fiori/feed/app/AppView"});t.placeAt(this.getId())}else if(this.getMode()===d.split){var i=sap.ui.view({id:this.getId()+"_oSplitAppView",viewData:{controlId:this.getId(),odataModel:this.oOdataModel,appType:this.getMode(),object:this.getObject(),langBundle:this.oLangBundle},viewName:"module:sap/collaboration/components/fiori/feed/splitApp/SplitAppView"});i.placeAt(this.getId())}}catch(t){e.error(t,"","sap.collaboration.components.fiori.feed.Component.onAfterRendering()");this.oCommonUtil.displayError(t)}}},render:function(e){e.openStart("div",this.getId());e.style("width",this.getWidth());e.style("height",this.getHeight());e.openEnd();e.close("div")},getMode:function(){return this.mode},validateInputParameters:function(){var t;if(this.getFeedType()==n.object||this.getFeedType()==n.objectGroup){if(!this.getObject()){t=new Error("Object is undefined or null");e.error(t,"","sap.collaboration.components.fiori.feed.Component.validateInputParameters()");throw t}else if(!this.getObject().id){t=new Error("Missing Object ID");e.error(t,"","sap.collaboration.components.fiori.feed.Component.validateInputParameters()");throw t}}if(this.getFeedType()==n.object){if(!this.getObject().type){t=new Error("Missing Object Type");e.error(t,"","sap.collaboration.components.fiori.feed.Component.validateInputParameters()");throw t}}}});return l});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/app/App.controller", ["sap/base/Log","sap/ui/core/mvc/Controller","sap/collaboration/components/utils/OdataUtil","sap/collaboration/components/utils/CommonUtil","sap/ui/core/mvc/View","sap/ui/core/library","sap/collaboration/library"],function(t,e,a,o,s,i,r){"use strict";var n=r.FeedType;var p=i.mvc.ViewType;return e.extend("sap.collaboration.components.fiori.feed.app.App",{onInit:function(){this.oApp=this.getView().oApp;this.oOdataModel=this.getView().getViewData().odataModel;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId;this.sAppType=this.getView().getViewData().appType;this.sFeedType=this.getView().getViewData().feedType;this.sGroupIds=this.getView().getViewData().groupIds;this.oBusinessObject=this.getView().getViewData().object},onBeforeRendering:function(){try{this.initializeUtils();this.createDetailPage()}catch(e){t.error(e,"","sap.collaboration.components.fiori.feed.app.App.controller.onBeforeRendering()");this.oCommonUtil.displayError()}},initializeUtils:function(){if(!this.oODataUtil){this.oODataUtil=new a}if(!this.oCommonUtil){this.oCommonUtil=this.oCommonUtil=new o}},createDetailPage:async function(){try{var e=this.sPrefixId+"detailView";if(!this.oApp.getPage(e)){this.initOData();var a=await s.create({id:e,viewData:{controlId:this.sPrefixId,jamURL:this.sJamUrl,jamToken:this.sJamToken,appType:this.sAppType,feedType:this.sFeedType,groupIds:this.sGroupIds,object:this.oBusinessObject,langBundle:this.oLangBundle},viewName:"module:sap/collaboration/components/fiori/feed/commons/DetailView"});this.oApp.addPage(a);this.oApp.setInitialPage(a)}}catch(e){t.error(e,"","sap.collaboration.components.fiori.feed.app.App.controller.createDetailPage()");throw e}},getGroupIds:function(){var t;if(this.sFeedType===n.group&&(this.sGroupIds===undefined||this.sGroupIds==="")){t=this.oODataUtil.getGroupsData(this.oOdataModel,"/Groups");this.sGroupIds=this.oODataUtil.getGroupIds(t)}else if(this.sFeedType===n.objectGroup&&(this.sGroupIds===undefined||this.sGroupIds==="")){t=this.oODataUtil.getGroupsData(this.oOdataModel,"/BusinessObjects('"+this.oBusinessObject.id+"')/AssignedGroups");this.sGroupIds=this.oODataUtil.getGroupIds(t)}else if(this.sFeedType===n.objectGroup&&!(this.sGroupIds===undefined||this.sGroupIds==="")){t=this.oODataUtil.getGroupsData(this.oOdataModel,"/BusinessObjects('"+this.oBusinessObject.id+"')/AssignedGroups");var e=this.oODataUtil.getGroupIds(t);this.sGroupIds=this.filterGroupIds(e)}},filterGroupIds:function(t){var e;var a=t.split(",");var o=this.sGroupIds.split(",");for(var s=0;s<o.length;s++){if(a.indexOf(o[s])===-1){o.splice(s,1);s=s-1}}if(o.length!==0){e=o.join()}else{e=""}return e},initOData:function(){var e=this;var a=[];var o=false;var s=function(t){e.parseBatchResults(t)};var i=function(e){t.error(e,"","sap.collaboration.components.fiori.feed.dialog.Component.initOdata(), fnBatchErrorCallback()");throw e};try{a=this.createBatchRequests();this.oODataUtil.executeODataBatchRequest(this.oOdataModel,a,s,o,i)}catch(e){t.error(e,"","sap.collaboration.components.fiori.feed.app.App.controller.initOdata()");throw e}},createBatchRequests:function(){var e=this;var a=[];try{if(!e.sJamUrl){a.push(e.oODataUtil.createJamUrlBatchOperation(e.oOdataModel))}a.push(e.oODataUtil.createJamTokenBatchOperation(e.oOdataModel));switch(e.sFeedType){case n.object:a=a.concat(e.createExternalUrlBatchRequest(e.oODataUtil,e.oBusinessObject));break;case n.group:a.push(e.oODataUtil.createGetGroupsDataBatchOperation(e.oOdataModel));break;case n.objectGroup:a.push(e.createObjectGroupBatchRequest(e.oODataUtil,e.oBusinessObject));break}}catch(e){t.error(e,"","sap.collaboration.components.fiori.feed.app.App.controller.createBatchRequests()");throw e}return a},createExternalUrlBatchRequest:function(t,e){var a=this;var o=[];if(t&&e){if(e.id){o.push(t.createExternalOdataUrlBatchOperation(a.oOdataModel,e.id))}if(e.type){o.push(t.createExternalOdataUrlBatchOperation(a.oOdataModel,e.type))}}return o},createObjectGroupBatchRequest:function(e,a){var o=this;var s;if(e&&a&&a.id){s=e.createGetObjectGroupsBatchOperation(o.oOdataModel,a.id)}else{var i=new Error("Missing parameters. Cannot create a batch request for Object Group.");t.error(i,"","sap.collaboration.components.fiori.feed.app.App.controller.createObjectGroupBatchRequest()");throw i}return s},parseBatchResults:function(t){var e=this;var a=0;if(!e.sJamUrl){if(t[a].error){throw new Error(t[a].error)}else{e.sJamUrl=t[a][e.oODataUtil.OdataUtilConstants.EndPoint.GetCollaborationHostUrl].Url}a++}if(t[a].error){throw new Error(t[a].error)}else{e.sJamToken=t[a][e.oODataUtil.OdataUtilConstants.EndPoint.GetSingleUseToken].Id}a++;if(e.sFeedType==n.object){if(t[a].error){throw new Error(t[a].error)}else{e.oBusinessObject.id=t[a][e.oODataUtil.OdataUtilConstants.EndPoint.GetExternalODataURL].URL;e.oBusinessObject.odata_url=e.oBusinessObject.id}a++;if(t[a].error){throw new Error(t[a].error)}else{e.oBusinessObject.type=t[a][e.oODataUtil.OdataUtilConstants.EndPoint.GetExternalODataURL].URL;e.oBusinessObject.metadata_url=e.oBusinessObject.type}}else if(e.sFeedType==n.group||e.sFeedType==n.objectGroup){if(t[a].error){throw new Error(t[a].error)}else{var o=e.oODataUtil.getGroupIds(t[a].results);if(!e.sGroupIds){e.sGroupIds=o}else{e.sGroupIds=e.filterGroupIds(o)}}}}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/app/AppView", ["sap/ui/core/mvc/View","sap/m/App"],function(e,t){"use strict";return e.extend("sap.collaboration.components.fiori.feed.app.AppView",{getControllerName:function(){return"sap.collaboration.components.fiori.feed.app.App"},createContent:function(e){this.sPrefixId=this.getViewData().controlId;this.oApp=new t(this.sPrefixId+"app");return this.oApp}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/commons/Detail.controller", ["sap/base/Log","sap/collaboration/components/utils/JamUtil","sap/ui/core/mvc/Controller","sap/collaboration/library"],function(e,t,i,a){"use strict";var o=a.AppType;return i.extend("sap.collaboration.components.fiori.feed.commons.Detail",{onInit:function(){this.sJamToken=this.getView().getViewData().jamToken;this.sJamURL=this.getView().getViewData().jamURL;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId;this.oBusinessObject=this.getView().getViewData().businessObject;this.bJamWidgetInitialized=false;if(this.getView().getViewData().appType===o.split){}else{this.sFeedType=this.getView().getViewData().feedType;this.getView().oDetailPage.setShowHeader(false)}this.oJamUtil=new t},onBeforeRendering:function(){},onAfterRendering:function(){try{this.loadFeedWidget(this.sJamURL)}catch(t){e.error(t,"","sap.collaboration.components.fiori.feed.commons.Detail.onInit()");throw t}},loadFeedWidget:function(t){var i=this;try{var a=i.getView().getViewData().groupIds;var o=this.oJamUtil.prepareWidgetData(i.sJamToken,i.sFeedType,a,i.oBusinessObject);var s=function(t){e.info("Jam Feed Widget Loaded Successfully","sap.collaboration.components.fiori.feed.commons.Detail.onInit()");i.oJamUtil.initializeJamWidget(i.sJamURL);i.bJamWidgetInitialized=true;i.oJamUtil.createJamWidget(i.sPrefixId+"widgetContainer",o)};var n=function(t){e.error(t,"","sap.collaboration.components.fiori.feed.commons.Detail.loadFeedWidgetScript()");throw t};if(this.bJamWidgetInitialized===false){this.oJamUtil.loadFeedWidgetScript(t,s,n)}else{this.oJamUtil.createJamWidget(i.sPrefixId+"widgetContainer",o)}}catch(t){e.error(t,"","sap.collaboration.components.fiori.feed.commons.Detail.loadFeedWidgetScript()");throw t}}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/commons/DetailView", ["sap/ui/core/mvc/View","sap/m/Page","sap/m/ScrollContainer"],function(e,t,i){"use strict";return e.extend("sap.collaboration.components.fiori.feed.commons.DetailView",{getControllerName:function(){return"sap.collaboration.components.fiori.feed.commons.Detail"},createContent:function(e){var n=this.getViewData().langBundle;this.sPrefixId=this.getViewData().controlId;this.oDetailPage=new t(this.sPrefixId+"feedDetailsPage",{title:n.getText("FRV_DOMAIN_DATA_FEED_TYPES_FOLLOWS"),enableScrolling:false,content:[new i(this.sPrefixId+"widgetContainer",{width:"100%",height:"100%",horizontal:false,vertical:false})]});return this.oDetailPage}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/dialog/Component", ["sap/base/Log","sap/base/util/isEmptyObject","sap/collaboration/components/utils/CommonUtil","sap/collaboration/components/utils/JamUtil","sap/collaboration/components/utils/OdataUtil","sap/collaboration/library","sap/ui/core/UIComponent","sap/ui/thirdparty/jquery","sap/ui/model/odata/ODataModel","sap/ui/core/mvc/View","sap/ui/core/library","sap/m/Dialog","sap/m/Button","sap/ui/Device"],function(e,t,i,o,s,a,r,jQuery,n,l,d,c,u,p){"use strict";var h=d.mvc.ViewType;var g=a.AppType;var f=a.FeedType;var O=r.extend("sap.collaboration.components.fiori.feed.dialog.Component",{metadata:{includes:["../../../resources/css/Sharing.css"],properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:"575px"},height:{type:"sap.ui.core.CSSSize",defaultValue:"605px"},feedType:{type:"string",defaultValue:f.object},groupIds:{type:"string"},object:{type:"object"},businessObject:{type:"object"}},aggregations:{},events:{}},systemSettings:{oDataServiceUrl:"/sap/opu/odata/sap/SM_INTEGRATION_V2_SRV",oCollaborationHostRestService:"/sap/bc/ui2/smi/rest_tunnel/Jam//v1",oCollaborationHostODataService:"/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData"},init:function(){this.oCommonUtil=new i;this.oJamUtil=new o;this.oLangBundle=this.oCommonUtil.getLanguageBundle();this.sJamUrl=undefined;this.sJamToken=undefined;this.oOdataModel=undefined;this.oODataUtil=undefined;this.oBusinessObject={};r.prototype.init.apply(this)},setSettings:function(t){if(t){this.setFeedType(t.feedType);this.setGroupIds(t.groupIds);this.setObject(t.object);this.setBusinessObject(t.businessObject)}else{var i=new Error("Settings object is undefined");e.error(i.stack)}},open:function(){this._logComponentProperties();try{this._validateInputParameters(this.mProperties);this._createFeedDialog();this._requestWidgetData();this.oFeedDialog.open()}catch(t){e.error(t.stack);this.oCommonUtil.displayError()}},onBeforeRendering:function(){},onAfterRendering:function(){},render:function(e){},_requestWidgetData:function(){var t=this._getCSRFToken();var i=this;var o=true;var s=this.systemSettings.oCollaborationHostRestService;this._initOData();if(this.getObject()){this._getObjectWithoutMapping()}else if(this.getBusinessObject()){this._getObjectWithMapping()}var a=function(){if(this.readyState==4){if(this.status==201){i.sJamToken=this.responseXML.getElementsByTagName("single_use_token")[0].attributes[0].value;if(i.sJamUrl&&i.oBusinessObject.odata_url&&i.oBusinessObject.metadata_url){i._createFeedView();i.oFeedDialog.addContent(i.oFeedView);setTimeout(function(){i.oFeedDialog.setBusy(false)},3e3)}}else{var t="The single use token from SAP Jam was not returned successfully";e.error(t,"","sap.collaboration.components.utils.JamUtil.getJamSinglelUseTokens()");if(i.oFeedDialog.isOpen()===true){i.oFeedDialog.close()}i.oCommonUtil.displayError()}}};this.oJamUtil.getJamSinglelUseTokens(s,a,o,t)},_getObjectWithoutMapping:function(){var t=this;var i=true;var o=[];var s=function(e){t._parseBatchResults(e);if(t.sJamToken){t._createFeedView();t.oFeedDialog.addContent(t.oFeedView);setTimeout(function(){t.oFeedDialog.setBusy(false)},3e3)}};var a=function(t){e.error(t,"","sap.collaboration.components.fiori.feed.dialog.Component._getObjectWithoutMapping(), fnBatchErrorCallback()");throw t};o=this._createBatchRequests();this.oODataUtil.executeODataBatchRequest(this.oOdataModel,o,s,i,a)},_getObjectWithMapping:function(){var e=this;var t=new jQuery.Deferred;t.done(function(t){e.sJamUrl=t});var i=new jQuery.Deferred;i.done(function(t){e._setMappedObject(t)});jQuery.when(t,i).fail(function(t){if(e.oFeedDialog&&e.oFeedDialog.isOpen()){e.oFeedDialog.close()}e.oCommonUtil.displayError()});this.oODataUtil.getJamUrl(this.oOdataModel,t);this.oODataUtil.getExternalObjectMapping(this.oOdataModel,this.getBusinessObject(),i)},_setMappedObject:function(e){var t=this;this.oBusinessObject.id=e.Exid;this.oBusinessObject.type=e.ObjectType;this.oBusinessObject.odata_url=this.oBusinessObject.id;this.oBusinessObject.metadata_url=this.oBusinessObject.type;if(this.sJamToken){this._createFeedView();this.oFeedDialog.addContent(this.oFeedView);setTimeout(function(){t.oFeedDialog.setBusy(false)},3e3)}},_initOData:function(){var t=true;var i=this.systemSettings.oDataServiceUrl;if(!this.oOdataModel){this.oOdataModel=new n(i,t)}if(!this.oOdataModel.oMetadata.oMetadata){var o=new Error("Metadata is undefined");e.error(o,"","sap.collaboration.components.fiori.feed.dialog.Component._requestWidgetData()");throw o}if(!this.oODataUtil){this.oODataUtil=new s}},_getCSRFToken:function(){var e="";var t=this.systemSettings.oCollaborationHostODataService;var i=function(t){if(this.readyState==4){if(this.status==200){e=this.getResponseHeader("x-csrf-token")}}};this.oJamUtil.getCSRFToken(t,i,false);return e},_createBatchRequests:function(){var e=this;var t=[];if(!e.sJamUrl){t.push(e.oODataUtil.createJamUrlBatchOperation(e.oOdataModel))}t=t.concat(e._createExternalUrlBatchRequest(e.oODataUtil,e.getObject()));return t},_createExternalUrlBatchRequest:function(e,t){var i=this;var o=[];if(e&&t){if(t.id){o.push(e.createExternalOdataUrlBatchOperation(i.oOdataModel,t.id))}if(t.type){o.push(e.createExternalOdataUrlBatchOperation(i.oOdataModel,t.type))}}return o},_parseBatchResults:function(e){var t=this;var i=0;if(!t.sJamUrl){if(e[i].error){throw new Error(e[i].error)}else{t.sJamUrl=e[i][t.oODataUtil.OdataUtilConstants.EndPoint.GetCollaborationHostUrl].URL}i++}if(e[i].error){throw new Error(e[i].error)}else{t.oBusinessObject.id=e[i][t.oODataUtil.OdataUtilConstants.EndPoint.GetExternalODataURL].URL;t.oBusinessObject.odata_url=t.oBusinessObject.id}i++;if(e[i].error){throw new Error(e[i].error)}else{t.oBusinessObject.type=e[i][t.oODataUtil.OdataUtilConstants.EndPoint.GetExternalODataURL].URL;t.oBusinessObject.metadata_url=t.oBusinessObject.type}},_createFeedView:function(){var e=this;if(!e.oFeedView){e.oFeedView=sap.ui.view({id:e.getId()+"_FeedView",height:"100%",viewData:{controlId:e.getId(),jamURL:e.sJamUrl,jamToken:e.sJamToken,appType:g.widget,feedType:e.getFeedType(),groupIds:e.getGroupIds(),businessObject:e.oBusinessObject,langBundle:e.oLangBundle},viewName:"module:sap/collaboration/components/fiori/feed/commons/DetailView"})}else{e.oFeedView.getController().sFeedType=e.getFeedType();e.oFeedView.getViewData().groupIds=e.getGroupIds();e.oFeedView.getController().oBusinessObject=e.oBusinessObject}},_createFeedDialog:function(){var e=this;if(!this.oFeedDialog){this.oFeedDialog=new c(this.getId()+"FeedDialog",{title:this.oLangBundle.getText("FEED_DIALOG_TITLE"),stretch:false,contentWidth:this.getWidth(),contentHeight:this.getHeight(),content:[],endButton:new u({text:this.oLangBundle.getText("CLOSE_BUTTON_TEXT"),press:function(){e.oFeedDialog.close()}})});if(p.system.phone){this.oFeedDialog.setStretch(true)}}this.oFeedDialog.setBusy(true)},_validateInputParameters:function(i){var o;if(!i){o=new Error("Input paremeters are undefined");e.error(o.stack);throw o}else if(i.businessObject){var s=i.businessObject;if(t(s)){o=new Error("Business Object is empty");e.error(o.stack);throw o}if(!s.appContext){o=new Error("Application context is undefined");e.error(o.stack);throw o}if(!s.odataServicePath){o=new Error("OData Service Path is undefined");e.error(o.stack);throw o}if(!s.collection){o=new Error("Collection is undefined");e.error(o.stack);throw o}if(!s.key){o=new Error("Key is undefined");e.error(o.stack);throw o}if(!s.name){o=new Error("Name is undefined");e.error(o.stack);throw o}}else if(i.object){var a=i.object;if(t(a)){o=new Error("Business Object is empty");e.error(o.stack);throw o}if(!a.id){o=new Error("Object is undefined");e.error(o.stack);throw o}if(!a.type){o=new Error("Missing Object Type");e.error(o.stack);throw o}}else{o=new Error("Neither an Object nor a Business Object was passed");throw o}},_logComponentProperties:function(){e.debug("Share Component properties:","","sap.collaboration.components.fiori.dialog.Component._logComponentProperties()");e.debug("width: "+this.getWidth());e.debug("height: "+this.getHeight());e.debug("oDataServiceUrl: "+this.systemSettings.oDataServiceUrl);e.debug("feedType: "+this.getFeedType());e.debug("groupIds: "+this.getGroupIds());e.debug("object: "+JSON.stringify(this.getObject()));e.debug("businessObject: "+JSON.stringify(this.getBusinessObject()))}});return O});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/splitApp/FeedTypeMaster.controller", ["sap/ui/core/mvc/Controller","sap/collaboration/library","sap/collaboration/components/utils/JamUtil"],function(e,t,i){"use strict";var a=t.FeedType;return e.extend("sap.collaboration.components.fiori.feed.splitApp.FeedTypeMaster",{onInit:function(){this.sJamToken=this.getView().getViewData().jamToken;this.sPrefixId=this.getView().getViewData().controlId;this.oBusinessObject=this.getView().getViewData().object},listItemPress:function(e){if(e===a.follows||e===a.company){this.getJamWidget(e);this.setDetailPageTitle(e)}else{this.navigateToGroupMaster(e)}},getJamWidget:function(e){var t=new i;var a=t.prepareWidgetData(this.sJamToken,e,"",this.oBusinessObject);t.createJamWidget(this.sPrefixId+"widgetContainer",a)},setDetailPageTitle:function(e){var t;e===a.follows?t=this.getView().oLangBundle.getText("FRV_DOMAIN_DATA_FEED_TYPES_FOLLOWS"):t=this.getView().oLangBundle.getText("FRV_DOMAIN_DATA_FEED_TYPES_COMPANY");sap.ui.getCore().byId(this.sPrefixId+"feedDetailsPage").setTitle(t)},navigateToGroupMaster:function(e){var t=this.createNavigationData(e);sap.ui.getCore().getEventBus().publish("nav","to",t)},createNavigationData:function(e){var t;e===a.group?t={viewName:"module:sap/collaboration/components/fiori/feed/splitApp/GroupMasterView",viewId:this.sPrefixId+"groupMasterView",data:{feedType:a.group,lanBundle:this.getView().oLangBundle,groupMasterPageTitle:this.getView().oLangBundle.getText("GROUP_MASTER_PAGE_GROUP_TITLE")}}:t={viewName:"module:sap/collaboration/components/fiori/feed/splitApp/GroupMasterView",viewId:this.sPrefixId+"groupMasterView",data:{feedType:a.object,lanBundle:this.getView().oLangBundle,groupMasterPageTitle:this.getView().oLangBundle.getText("GROUP_MASTER_PAGE_BO_TITLE")}};return t}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/splitApp/FeedTypeMasterView", ["sap/ui/core/mvc/View","sap/m/Page","sap/m/List","sap/m/StandardListItem","sap/m/library"],function(e,t,s,i,n){"use strict";var o=n.ListType;e.extend("sap.collaboration.components.fiori.feed.splitApp.FeedTypeMasterView",{getControllerName:function(){return"sap.collaboration.components.fiori.feed.splitApp.FeedTypeMaster"},createContent:function(e){this.oLangBundle=this.getViewData().langBundle;this.sPrefixId=this.getViewData().controlId;return new t(this.sPrefixId+"feedTypePage",{title:this.oLangBundle.getText("FEED_MASTER_PAGE_TITLE"),content:[new s(this.sPrefixId+"FeedTypes",{inset:true,items:[new i({title:this.oLangBundle.getText("FRV_DOMAIN_DATA_FEED_TYPES_FOLLOWS"),type:o.Active,selected:true,press:function(){e.listItemPress("follows")}}),new i({title:this.oLangBundle.getText("FRV_DOMAIN_DATA_FEED_TYPES_COMPANY"),type:o.Active,press:function(){e.listItemPress("company")}}),new i({title:this.oLangBundle.getText("FRV_DOMAIN_DATA_FEED_TYPES_GROUP"),type:o.Active,press:function(){e.listItemPress("group")}}),new i({title:this.oLangBundle.getText("FRV_DOMAIN_DATA_FEED_TYPES_BO"),type:o.Active,press:function(){e.listItemPress("context")}})]})]})}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/splitApp/GroupMaster.controller", ["sap/ui/core/mvc/Controller","sap/m/StandardListItem","sap/m/library","sap/collaboration/components/utils/OdataUtil","sap/collaboration/components/utils/JamUtil","sap/collaboration/library","sap/ui/model/json/JSONModel"],function(t,e,i,a,s,o,n){"use strict";var r=o.FeedType;var g=i.ListType;return t.extend("sap.collaboration.components.fiori.feed.splitApp.GroupMaster",{onInit:function(){this.oOdataModel=this.getView().getViewData().odataModel;this.oBusinessObject=this.getView().getViewData().object;this.sFeedType=this.getView().getViewData().feedType;this.sPageTitle=this.getView().getViewData().pageTitle;this.sJamToken=this.getView().getViewData().jamToken;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId},onBeforeRendering:function(){var t=this;this.getView().groupMasterPage.setTitle(this.sPageTitle);this.initializeUtils();this.setViewModel();var i=new e;i.bindProperty("title","Name");i.setType(g.Active);i.attachPress(function(){var e=this.getBindingContext().getProperty(this.getBindingContext().getPath()).Id;var i=this.getBindingContext().getProperty(this.getBindingContext().getPath()).Name;var a=t.oJamUtil.prepareWidgetData(t.sJamToken,t.sFeedType,e);t.oJamUtil.createJamWidget(t.sPrefixId+"widgetContainer",a);sap.ui.getCore().byId(t.sPrefixId+"feedDetailsPage").setTitle(i)});sap.ui.getCore().byId(this.sPrefixId+"groupsList").bindItems("/groupsData",i);var a=new e({title:this.oLangBundle.getText("GROUP_MASTER_LIST_All_GROUPS")});a.setType(g.Active);a.attachPress(function(){var e=t.oODataUtil.getGroupIds(t.aGroupData);var i=t.oJamUtil.prepareWidgetData(t.sJamToken,t.sFeedType,e);t.oJamUtil.createJamWidget(t.sPrefixId+"widgetContainer",i);sap.ui.getCore().byId(t.sPrefixId+"feedDetailsPage").setTitle(t.oLangBundle.getText("GROUP_MASTER_LIST_All_GROUPS"))});sap.ui.getCore().byId(this.sPrefixId+"groupsList").insertItem(a,0)},onAfterRendering:function(){},initializeUtils:function(){this.oODataUtil=new a;this.oJamUtil=new s},setViewModel:function(){this.aGroupData;this.sFeedType===r.group?this.aGroupData=this.oODataUtil.getGroupsData(this.oOdataModel,"/Groups"):this.aGroupData=this.oODataUtil.getGroupsData(this.oOdataModel,"/BusinessObjects('"+this.oBusinessObject.id+"')/AssignedGroups");this.oViewData={groupsData:this.aGroupData};this.oViewModel=new n(this.oViewData);this.getView().setModel(this.oViewModel)},onNavButtonTap:function(){sap.ui.getCore().getEventBus().publish("nav","back")}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/splitApp/GroupMasterView", ["sap/ui/core/mvc/View","sap/m/Page","sap/m/List"],function(t,e,i){"use strict";return t.extend("sap.collaboration.components.fiori.feed.splitApp.GroupMasterView",{getControllerName:function(){return"sap.collaboration.components.fiori.feed.splitApp.GroupMaster"},createContent:function(t){this.sPrefixId=this.getViewData().controlId;this.groupMasterPage=new e(this.sPrefixId+"groupPage",{title:this.getViewData().groupMasterpageTitle,showNavButton:true,navButtonPress:t.onNavButtonTap,content:[new i(this.sPrefixId+"groupsList",{inset:true})]});return this.groupMasterPage}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/splitApp/SplitApp.controller", ["sap/base/Log","sap/ui/core/mvc/Controller","sap/collaboration/components/utils/OdataUtil","sap/ui/core/mvc/View","sap/ui/core/library"],function(e,t,i,a,s){"use strict";var o=s.mvc.ViewType;return t.extend("sap.collaboration.components.fiori.feed.splitApp.SplitApp",{onInit:function(){this.oSplitApp=this.getView().oSplitApp;this.sAppType=this.getView().getViewData().appType;this.oOdataModel=this.getView().getViewData().odataModel;this.oBusinessObject=this.getView().getViewData().object;this.oLangBundle=this.getView().getViewData().langBundle;this.sPrefixId=this.getView().getViewData().controlId;this.oEventBus=sap.ui.getCore().getEventBus();this.oEventBus.subscribe("nav","to",this.navToHandler,this);this.oEventBus.subscribe("nav","back",this.navBackHandler,this)},onBeforeRendering:function(){},createMasterDetail:function(){var e=new i;var t=e.getJamUrl(this.oOdataModel);this.sJamToken=e.getJamToken(this.oOdataModel);a.create({id:this.sPrefixId+"masterView",viewData:{controlId:this.sPrefixId,jamToken:this.sJamToken,langBundle:this.oLangBundle,object:this.oBusinessObject},viewName:"module:sap/collaboration/components/fiori/feed/splitApp/FeedTypeMasterView"}).then(e=>{this.oSplitApp.addMasterPage(e);this.oSplitApp.setInitialMaster(e)});a.create({id:this.sPrefixId+"detailView",viewData:{controlId:this.sPrefixId,appType:this.sAppType,jamURL:t,jamToken:this.sJamToken,langBundle:this.oLangBundle,object:this.oBusinessObject},viewName:"module:sap/collaboration/components/fiori/feed/commons/DetailView"}).then(e=>{this.oSplitApp.addMasterPage(e);this.oSplitApp.setInitialMaster(e)})},navToHandler:function(t,i,s){if(s&&s.viewId===this.sPrefixId+"groupMasterView"){if(!sap.ui.getCore().byId(s.viewId)){a.create({id:s.viewId,viewData:{controlId:this.sPrefixId,odataModel:this.oOdataModel,object:this.oBusinessObject,feedType:s.data.feedType,pageTitle:s.data.groupMasterPageTitle,jamToken:this.sJamToken,langBundle:this.oLangBundle},viewName:s.viewName}).then(e=>{this.oSplitApp.addMasterPage(e)})}else{sap.ui.getCore().byId(s.viewId).getController().sFeedType=s.data.feedType;sap.ui.getCore().byId(s.viewId).getController().sPageTitle=s.data.groupMasterPageTitle;sap.ui.getCore().byId(s.viewId).rerender()}this.oSplitApp.to(s.viewId)}else{e.error("nav-to event cannot be processed. Invalid data: "+s)}},navBackHandler:function(){this.oSplitApp.backMaster()}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/feed/splitApp/SplitAppView", ["sap/ui/core/mvc/View","sap/m/SplitApp"],function(t,e){"use strict";return t.extend("sap.collaboration.components.fiori.feed.splitApp.SplitAppView",{getControllerName:function(){return"sap.collaboration.components.fiori.feed.splitApp.SplitApp"},createContent:async function(t){t.createMasterDetail();this.sPrefixId=this.getViewData().controlId;this.oSplitApp=new e(this.sPrefixId+"splitApp");return this.oSplitApp}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/notification/Component", ["sap/base/Log","sap/collaboration/components/utils/CommonUtil","sap/collaboration/library","sap/ui/core/UIComponent","sap/ui/core/mvc/View","sap/ui/core/library"],function(i,t,e,o,n,a){"use strict";var s=a.mvc.ViewType;var r=o.extend("sap.collaboration.components.fiori.notification.Component",{metadata:{properties:{oDataServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/opu/odata/sap/SM_INTEGRATION_SRV"},numberOfNotifications:{type:"int",defaultValue:10},transitionInterval:{type:"int",defaultValue:10},refreshInterval:{type:"int",defaultValue:300},notificationsTargetUrl:{type:"sap.ui.core.URI"}}},init:function(){this.iMillisecondsPerSecond=1e3;this.oCommonUtil=new t;this.oLangBundle=this.oCommonUtil.getLanguageBundle();this.sStyleClassPrefix="sapClbNotif"},onBeforeRendering:function(){},onAfterRendering:function(){i.debug("Notification Component properties:",this.mProperties.toString(),"sap.collaboration.components.fiori.notification.Component.onAfterRendering()");i.debug("oDataServiceUrl: "+this.getODataServiceUrl());i.debug("numberOfNotifications: "+this.getNumberOfNotifications());i.debug("transitionInterval: "+this.getTransitionInterval());i.debug("refreshInterval: "+this.getRefreshInterval());i.debug("notificationsTargetUrl: "+this.getNotificationsTargetUrl());if(!this.oNotificationView){this.oNotificationView=sap.ui.view({id:this.getId()+"_NotificationView",viewData:{controlId:this.getId(),langBundle:this.oLangBundle,oDataServiceUrl:this.getODataServiceUrl(),numberOfNotifications:this.getNumberOfNotifications(),transitionInterval:this.getTransitionInterval()*this.iMillisecondsPerSecond,refreshInterval:this.getRefreshInterval()*this.iMillisecondsPerSecond,notificationsTargetUrl:this.getNotificationsTargetUrl(),styleClassPrefix:this.sStyleClassPrefix},viewName:"module:sap/collaboration/components/fiori/notification/NotificationView"})}this.oNotificationView.placeAt(this.getId())},exit:function(){this.deactivateNotificationRefreshAndTransition();this.oNotificationView.destroy()},render:function(i){i.openStart("div",this.getId());i.class(this.sStyleClassPrefix+"Component");i.class(this.sStyleClassPrefix+"CursorPointer");i.openEnd();i.close("div")},deactivateNotificationRefreshAndTransition:function(){this.oNotificationView.getController().deactivateNotificationTransition();this.oNotificationView.getController().deactivateNotificationRefresh()}});return r});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/notification/Notification.controller", ["sap/collaboration/components/utils/CommonUtil","sap/collaboration/components/utils/NotificationTypeUtil","sap/collaboration/components/utils/OdataUtil","sap/ui/core/mvc/Controller","sap/ui/model/odata/ODataModel","sap/ui/Global"],function(t,i,e,o,a,s){"use strict";return o.extend("sap.collaboration.components.fiori.notification.Notification",{onInit:function(){this.initializeRefreshAndTransitionState();this.sPrefixId=this.getView().getViewData().controlId;this.oView=this.getView();this.oLangBundle=this.oView.oLangBundle;this.sOdataServiceUrl=this.getView().getViewData().oDataServiceUrl;this.iTransitionInterval=this.getView().getViewData().transitionInterval;this.iRefreshInterval=this.getView().getViewData().refreshInterval;this.sProfilePhotoHiddenStyleClass=this.oView.sStyleClassPrefix+"ProfileImageHidden";this.sLoadingAnimationDummyTextStyleClass=this.oView.sStyleClassPrefix+"LoadingText";this.sNewNotificationTextStyleClass=this.oView.sStyleClassPrefix+"NewNotificationText";this.sErrorTextStyleClass=this.oView.sStyleClassPrefix+"ErrorText";this.oView.oNotificationNewNotificationOrErrorText.addStyleClass(this.sLoadingAnimationDummyTextStyleClass);this.oView.oNotificationNewNotificationOrErrorText.setText(". . . . . . . . . . . .");this.oView.oNotificationNewNotificationOrErrorText.setBusy(true);this.oNotificationTypeUtil=new i},initializeRefreshAndTransitionState:function(){this.bErrorInUnreadCountODataResponse=true;this.bErrorInNoticesODataResponse=true;this.bErrorInODataResponse=true;this.iNotificationCurrentIndex=undefined;this.iNotificationPreviousIndex=undefined;this.aNotifications=undefined;this.bIsTransitionActive=false;this.iNotificationsTransitionCallbackRegistrationId=undefined;this.bIsRefreshActive=false;this.iNotificationsRefreshCallbackRegistrationId=undefined;this.iNotificationUnreadCount=undefined;this.iMaxNotificationsToDisplay=this.getView().getViewData().numberOfNotifications;this.aImageControls=this.getView().getViewData().aProfilePhotos;this.iNotificationsToDisplay=undefined;this.aUsedImageControls=[]},onBeforeRendering:function(){this.initializeCommonUtil();this.initializeOdataModel();this.initializeOdataUtils()},onAfterRendering:function(){this.fetchNotificationData()},initializeOdataModel:function(){var t=true;this.oOdataModel=new a(this.sOdataServiceUrl,t)},initializeOdataUtils:function(){this.oODataUtil=new e},initializeCommonUtil:function(){this.oCommonUtil=new t},fetchNotificationData:function(){var t=[];var i=this.oODataUtil.createNotificationUnreadCountBatchOperation(this.oOdataModel);var e=this.oODataUtil.createNotificationBatchOperation(this.oOdataModel,this.iMaxNotificationsToDisplay);t.push(i);t.push(e);var o=this.getFunctionParseResult();var a=this.getFunctionErrorCallBack();this.oODataUtil.executeODataBatchRequest(this.oOdataModel,t,o,true,a)},getFunctionParseResult:function(){var t=this;return function(i){t.oView.oNotificationNewNotificationOrErrorText.setBusy(false);t.oView.oNotificationNewNotificationOrErrorText.setText("");t.oView.oNotificationNewNotificationOrErrorText.removeStyleClass(t.sLoadingAnimationDummyTextStyleClass);t.initializeRefreshAndTransitionState();if(i[0].error&&!i[1].error){t.bErrorInNoticesODataResponse=false;t.aNotifications=i[1].results;t.clearAllUiTexts();t.hideAllProfilePhotoControls();t.setUiContent();t.activateNotificationRefresh()}else if(!i[0].error&&i[1].error){t.bErrorInUnreadCountODataResponse=false;t.iNotificationUnreadCount=i[0].GetNoticeUnreadCount.UnreadCount;t.clearAllUiTexts();t.hideAllProfilePhotoControls();t.setUiContent();t.activateNotificationRefresh()}else if(i[0].error&&i[1].error){t.clearAllUiTexts();t.hideAllProfilePhotoControls();t.setUiContent();t.activateNotificationRefresh()}else{t.bErrorInUnreadCountODataResponse=false;t.bErrorInNoticesODataResponse=false;t.bErrorInODataResponse=false;t.aNotifications=i[1].results;t.iNotificationUnreadCount=i[0].GetNoticeUnreadCount.UnreadCount;if(t.iMaxNotificationsToDisplay>0){if(t.aNotifications.length>0){if(t.iNotificationUnreadCount>0){t.iNotificationsToDisplay=Math.min(t.iMaxNotificationsToDisplay,t.aNotifications.length,t.iNotificationUnreadCount);t.iNotificationCurrentIndex=0;t.iNotificationPreviousIndex=t.iNotificationsToDisplay-1;t.clearAllUiTexts();t.hideAllProfilePhotoControls();t.setProfilePhotosSrc();t.setUiContent();t.activateNotificationTransition();t.activateNotificationRefresh()}else{t.iNotificationsToDisplay=1;t.iNotificationCurrentIndex=0;t.iNotificationPreviousIndex=t.iNotificationsToDisplay-1;t.clearAllUiTexts();t.hideAllProfilePhotoControls();t.setProfilePhotosSrc();t.setUiContent();t.activateNotificationRefresh()}}else{t.iNotificationsToDisplay=0;t.clearAllUiTexts();t.hideAllProfilePhotoControls();t.activateNotificationRefresh()}}else{t.iNotificationsToDisplay=0;t.clearAllUiTexts();t.hideAllProfilePhotoControls()}}}},getFunctionErrorCallBack:function(){var t=this;return function(i){t.initializeRefreshAndTransitionState();t.clearAllUiTexts();t.hideAllProfilePhotoControls();t.setUiContent();t.activateNotificationRefresh()}},setProfilePhotosSrc:function(){var t;var i;var e;for(var o=0;o<this.iNotificationsToDisplay;++o){t=this.aNotifications[o].SenderId;i=this.aNotifications[o].SenderFullName;e=this.getProfilePhotoURL(i,t);this.oView.aProfilePhotos[o].addStyleClass(this.sProfilePhotoHiddenStyleClass);this.oView.aProfilePhotos[o].setSrc(e)}},getProfilePhotoURL:function(t,i){if(t!==""){return this.sOdataServiceUrl+"/Members("+i+")/ProfilePhoto/$value"}else{return sap.ui.require.toUrl("images/Anonymous.png")}},hideAllProfilePhotoControls:function(){for(var t=0;t<this.oView.aProfilePhotos.length;++t){this.oView.aProfilePhotos[t].addStyleClass(this.sProfilePhotoHiddenStyleClass)}},clearAllUiTexts:function(){this.oView.oNotificationTypeText.setText("");this.oView.oNotificationMessageText.setText("");this.oView.oNotificationUnreadCountText.setText("");this.oView.oNotificationNewNotificationOrErrorText.setText("");this.oView.oNotificationAgeText.setText("");this.oView.oNotificationGroupText.setText("")},setUiContent:function(){if(this.bErrorInODataResponse){this.oView.oNotificationNewNotificationOrErrorText.removeStyleClass(this.sNewNotificationTextStyleClass);this.oView.oNotificationNewNotificationOrErrorText.addStyleClass(this.sErrorTextStyleClass);this.oView.oNotificationNewNotificationOrErrorText.setText(this.oLangBundle.getText("NOTIF_ERROR_MESSAGE"))}else{var t=this.aNotifications[this.iNotificationCurrentIndex];var i="NOTIF_"+t.EventType.toUpperCase();var e=t.Message;var o;if(this.iNotificationUnreadCount>999){o=this.oLangBundle.getText("NOTIF_MORE_THAN_999_NEW_NOTIFICATIONS")}else{o=this.iNotificationUnreadCount}var a=t.CreatedAt;var s=t.GroupName;var n=this.oNotificationTypeUtil.getRequiredNotificationPropertyNames(t.EventType);var r=this.getNotificationPropertyValues(n,t);this.oView.oNotificationTypeText.setText(this.oLangBundle.getText(i,r));this.oView.oNotificationMessageText.setText(e);this.oView.aProfilePhotos[this.iNotificationPreviousIndex].addStyleClass(this.sProfilePhotoHiddenStyleClass);this.oView.aProfilePhotos[this.iNotificationCurrentIndex].removeStyleClass(this.sProfilePhotoHiddenStyleClass);this.oView.oNotificationUnreadCountText.setText(o);this.oView.oNotificationNewNotificationOrErrorText.removeStyleClass(this.sErrorTextStyleClass);this.oView.oNotificationNewNotificationOrErrorText.addStyleClass(this.sNewNotificationTextStyleClass);this.oView.oNotificationNewNotificationOrErrorText.setText(this.oLangBundle.getText("NOTIF_NEW_NOTIFICATIONS"));var l=this.calculateNotificationAge(a,s).split("\n");var f=l[0];var h="";if(l.length>1){h=l[1]}this.oView.oNotificationAgeText.setText(f);this.oView.oNotificationGroupText.setText(h);this.iNotificationPreviousIndex=this.iNotificationCurrentIndex;this.iNotificationCurrentIndex=(this.iNotificationCurrentIndex+1)%this.iNotificationsToDisplay}},getNotificationPropertyValues:function(t,i){var e=[];for(var o=0;o<t.length;o++){e.push(i[t[o]])}return e},calculateNotificationAge:function(t,i){if(!this.oCommonUtil.isValidDate(t)){return""}var e=new Date;t.setMilliseconds(0);e.setMilliseconds(0);var o=6e4;var a=o*60;var s=a*24;var n=e.getTime()-t.getTime();if(n>=s){var r=Math.round(parseFloat(n/s,10));if(r===1){if(i!==""){return this.oLangBundle.getText("NOTIF_DAY_AGO_GRP",[r.toString(),i])}else{return this.oLangBundle.getText("NOTIF_DAY_AGO_NO_GRP",[r.toString()])}}else{if(i!==""){return this.oLangBundle.getText("NOTIF_DAYS_AGO_GRP",[r.toString(),i])}else{return this.oLangBundle.getText("NOTIF_DAYS_AGO_NO_GRP",[r.toString()])}}}else if(n>=a){var l=Math.round(parseFloat(n/a,10));if(l===1){if(i!==""){return this.oLangBundle.getText("NOTIF_HOUR_AGO_GRP",[l.toString(),i])}else{return this.oLangBundle.getText("NOTIF_HOUR_AGO_NO_GRP",[l.toString()])}}else{if(i!==""){return this.oLangBundle.getText("NOTIF_HOURS_AGO_GRP",[l.toString(),i])}else{return this.oLangBundle.getText("NOTIF_HOURS_AGO_NO_GRP",[l.toString()])}}}else{var f=Math.round(parseFloat(n/o,10));if(f===1){if(i!==""){return this.oLangBundle.getText("NOTIF_MINUTE_AGO_GRP",[f.toString(),i])}else{return this.oLangBundle.getText("NOTIF_MINUTE_AGO_NO_GRP",[f.toString()])}}else{if(i!==""){return this.oLangBundle.getText("NOTIF_MINUTES_AGO_GRP",[f.toString(),i])}else{return this.oLangBundle.getText("NOTIF_MINUTES_AGO_NO_GRP",[f.toString()])}}}},activateNotificationTransition:function(){if(!this.bIsTransitionActive){this.iNotificationsTransitionCallbackRegistrationId=this.getTransitionRegistrationId();this.bIsTransitionActive=true}},getTransitionRegistrationId:function(){return setInterval(this.setUiContent.bind(this),this.iTransitionInterval)},deactivateNotificationTransition:function(){if(this.bIsTransitionActive){clearInterval(this.iNotificationsTransitionCallbackRegistrationId);this.bIsTransitionActive=false}},activateNotificationRefresh:function(){if(!this.bIsRefreshActive){this.iNotificationsRefreshCallbackRegistrationId=this.getRefreshRegistrationId();this.bIsRefreshActive=true}},getRefreshRegistrationId:function(){return setInterval(this.refreshNotification.bind(this),this.iRefreshInterval)},deactivateNotificationRefresh:function(){if(this.bIsRefreshActive){clearInterval(this.iNotificationsRefreshCallbackRegistrationId);this.bIsRefreshActive=false}},refreshNotification:function(){this.deactivateNotificationTransition();this.deactivateNotificationRefresh();this.fetchNotificationData()}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/notification/NotificationContainer", ["sap/ui/core/Control"],function(n){"use strict";var t=n.extend("sap.collaboration.components.fiori.notification.NotificationContainer",{metadata:{aggregations:{content:{singularName:"content"}}},renderer:function(n,t){n.openStart("div",t);n.class("sapClbNotifContainerBox");n.openEnd();var o=t.getContent();for(var e=0,a=o.length;e<a;e++){n.renderControl(o[e])}n.close("div")}});return t});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/notification/NotificationView", ["./NotificationContainer","sap/collaboration/library","sap/ui/core/mvc/View","sap/m/Image","sap/m/Text","sap/m/VBox","sap/ui/core/library"],function(t,i,e,o,s,a,n){"use strict";var r=n.TextAlign;return e.extend("sap.collaboration.components.fiori.notification.NotificationView",{getControllerName:function(){return"sap.collaboration.components.fiori.notification.Notification"},createContent:function(t){this.sPrefixId=this.getViewData().controlId;this.oLangBundle=this.getViewData().langBundle;this.sStyleClassPrefix=this.getViewData().styleClassPrefix;this.iNumberOfNotifications=this.getViewData().numberOfNotifications;this.sNotificationsTargetURL=this.getViewData().notificationsTargetUrl;var i=this.createContainerBox();return i},createContainerBox:function(){this.aProfilePhotos=this.createProfilePhotos();this.oNotificationTypeText=this.createNotificationTypeText();this.oNotificationMessageText=this.createNotificationMessageText();var i=this.createNotificationUnreadCountVBox();var e=this.createNotificationAgeAndGroupVBox();var o=new t(this.sPrefixId+"_ContainerBox");for(var s=0;s<this.aProfilePhotos.length;++s){o.addContent(this.aProfilePhotos[s])}o.addContent(this.oNotificationTypeText);o.addContent(this.oNotificationMessageText);o.addContent(i);o.addContent(e);return o},createProfilePhotos:function(){var t=[];for(var i=0;i<this.iNumberOfNotifications;++i){t.push(new o(this.sPrefixId+"_ProfileImage"+i,{densityAware:false,decorative:true}).addStyleClass(this.sStyleClassPrefix+"ProfileImage").addStyleClass(this.sStyleClassPrefix+"ProfileImageHidden").addStyleClass(this.sStyleClassPrefix+"CursorPointer"))}return t},createNotificationTypeText:function(){return new s(this.sPrefixId+"_NotificationType").addStyleClass(this.sStyleClassPrefix+"NotificationTypeText").addStyleClass(this.sStyleClassPrefix+"CursorPointer")},createNotificationMessageText:function(){return new s(this.sPrefixId+"_NotificationMessage").addStyleClass(this.sStyleClassPrefix+"NotificationMessageText").addStyleClass(this.sStyleClassPrefix+"CursorPointer")},createNotificationUnreadCountText:function(){return new s(this.sPrefixId+"_NotificationUnreadCount").addStyleClass(this.sStyleClassPrefix+"NotificationUnreadCountText").addStyleClass(this.sStyleClassPrefix+"CursorPointer")},createNotificationNewNotificationOrErrorText:function(){return new s(this.sPrefixId+"_NewNotificationOrErrorText").addStyleClass(this.sStyleClassPrefix+"CursorPointer")},createNotificationUnreadCountVBox:function(){this.oNotificationUnreadCountText=this.createNotificationUnreadCountText();this.oNotificationNewNotificationOrErrorText=this.createNotificationNewNotificationOrErrorText();var t=new a(this.sPrefixId+"_UnreadCountVBox",{items:[this.oNotificationUnreadCountText,this.oNotificationNewNotificationOrErrorText]}).addStyleClass(this.sStyleClassPrefix+"NotificationUnreadContainer");return t},createNotificationAgeAndGroupVBox:function(){this.oNotificationAgeText=new s(this.sPrefixId+"_NotificationAge",{textAlign:r.Right}).addStyleClass(this.sStyleClassPrefix+"NotificationAgeAndGroupText").addStyleClass(this.sStyleClassPrefix+"CursorPointer");this.oNotificationGroupText=new s(this.sPrefixId+"_NotificationGroup",{textAlign:r.Right}).addStyleClass(this.sStyleClassPrefix+"NotificationAgeAndGroupText").addStyleClass(this.sStyleClassPrefix+"CursorPointer");var t=new a(this.sPrefixId+"_AgeAndGroupVBox",{items:[this.oNotificationAgeText,this.oNotificationGroupText]}).addStyleClass(this.sStyleClassPrefix+"NotificationAgeAndGroupContainer");return t},ontap:function(){window.open(this.sNotificationsTargetURL,window.name)}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/Component", ["sap/base/Log","sap/collaboration/components/utils/CommonUtil","sap/collaboration/library","sap/ui/core/UIComponent","sap/ui/core/mvc/View","sap/ui/core/library"],function(e,t,i,a,o,n){"use strict";var s=n.mvc.ViewType;var r=a.extend("sap.collaboration.components.fiori.sharing.Component",{metadata:{includes:["../../resources/css/Sharing.css"],properties:{width:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},height:{type:"sap.ui.core.CSSSize",defaultValue:"100%"},oDataServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/opu/odata/sap/SM_INTEGRATION_V2_SRV"},collaborationHostODataServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData"},tunnelServiceUrl:{type:"sap.ui.core.URI",defaultValue:"/sap/bc/z_sail_httproxy/Jam/api/v1/OData"},object:{type:"object"},attachments:{type:"object"},externalObject:{type:"object"}}},init:function(){this.oCommonUtil=new t;this.oLangBundle=this.oCommonUtil.getLanguageBundle();this.sODataServiceUrl=undefined;this.sTunnelServiceUrl=undefined;this.sJamUrl=undefined;this.oODataUtil=undefined;this.oSharingView=undefined;this.oView=undefined;this.aJamGroups=[];this.bOdataOn=true},onBeforeRendering:function(){},onAfterRendering:function(){this.logComponentProperties();if(this.bStopRendering===undefined||this.bStopRendering===false){this.oSharingView=this.getSharingView();this.oSharingView.placeAt(this.getId())}},exit:function(){this.oSharingView.destroy()},setSettings:function(e){this.setODataServiceUrl(e.oDataServiceUrl);this.setTunnelServiceUrl(e.tunnelServiceUrl);this.setObject(e.object);this.setAttachments(e.attachments);this.setExternalObject(e.externalObject)},render:function(e){e.openStart("div",this.getId());e.style("width",this.getWidth());e.style("height",this.getHeight());e.openEnd();e.close("div")},getSharingView:function(){var e;var t;var i;var a=this.getObject();if(a){i=a.id;e=a.display;t=a.share}var o=this.getComponentData();if(o){this.oDialogComponent=o.dialogComponent}var n=this;var s=function(){if(!n.oNoGroupsView){n.oNoGroupsView=sap.ui.view({id:n.getId()+"_NoGroupsView",viewData:{controlId:n.getId(),langBundle:n.oLangBundle,jamUrl:n.oSharingView.getController().sJamUrl},viewName:"module:sap/collaboration/components/fiori/sharing/NoGroupsView"})}n.oSharingView.destroy();n.oSharingView=undefined;n.oNoGroupsView.placeAt(n.getId())};if(!this.oSharingView){this.oSharingView=sap.ui.view({id:this.getId()+"_SharingView",viewData:{controlId:this.getId(),odataServiceUrl:this.systemSettings.oDataServiceUrl,collaborationHostODataServiceUrl:this.systemSettings.collaborationHostODataServiceUrl,collaborationHostRestService:this.systemSettings.collaborationHostRestService,langBundle:this.oLangBundle,jamGroups:this.aJamGroups,sharingDialog:undefined,noGroupsCallBack:s,objectDisplay:e,objectShare:t,objectId:i,attachments:this.getAttachments(),externalObject:this.getExternalObject()},viewName:"module:sap/collaboration/components/fiori/sharing/SharingView"})}else{this.oSharingView.getViewData().objectId=i;this.oSharingView.getViewData().objectShare=t;this.oSharingView.getViewData().objectDisplay=e;this.oSharingView.getViewData().externalObject=this.getExternalObject()}if(this.oNoGroupsView){this.oNoGroupsView.destroy();this.oNoGroupsView=undefined}return this.oSharingView},shareToJam:function(){this.oSharingView.getController().shareToJam()},logComponentProperties:function(){e.debug("Share Component properties:","","sap.collaboration.components.fiori.sharing.Component.logComponentProperties()");e.debug("width: "+this.getWidth());e.debug("height: "+this.getHeight());e.debug("oDataServiceUrl: "+this.getODataServiceUrl());e.debug("tunnelServiceUrl: "+this.getTunnelServiceUrl());if(this.getObject()){e.debug("object->id: "+this.getObject().id);e.debug("object->display: "+this.getObject().display);e.debug("object->share: "+this.getObject().share)}else{e.debug("object: undefined")}if(this.getAttachments()&&this.getAttachments().attachmentsArray){e.debug("Attachments:");var t=this.getAttachments().attachmentsArray;for(var i=0;i<t.length;i++){e.debug("Attachments"+(i+1)+":");e.debug(t[i].mimeType);e.debug(t[i].name);e.debug(t[i].url)}}else{e.debug("attachments: undefined")}if(this.getExternalObject()){e.debug("externalObject->appContext: "+this.getObject().appContext);e.debug("externalObject->odataServicePath: "+this.getObject().odataServicePath);e.debug("externalObject->collection: "+this.getObject().collection);e.debug("externalObject->key: "+this.getObject().key);e.debug("object->name: "+this.getObject().name);e.debug("object->summary: "+this.getObject().summary)}else{e.debug("externalObject: undefined")}}});return r});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/FolderSelection.controller", ["sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/m/StandardListItem","sap/m/library"],function(e,t,o,r){"use strict";var i=r.ListType;return e.extend("sap.collaboration.components.fiori.sharing.FolderSelection",{constants:{top:20},onInit:function(){this.oLangBundle=this.getView().getViewData().languageBundle;this.oODataModel=this.getView().getViewData().oDataModel;this.oODataUtil=this.getView().getViewData().oDataUtil;this.sGroupId=this.getView().getViewData().groupId;this.oFolderSelectionDialog=this.getView().getViewData().folderSelectionDialog;this.sCurrentFolderId="";this.aFolderBuffer=[]},onBeforeRendering:function(){this.refreshFolderSelection(this.sCurrentFolderId)},onAfterRendering:function(){},refreshFolderSelection:function(e){var t=this.buildFolderList(e);this.setViewModel(t);this.bindFoldersList();this.refreshHeaderBar(e)},buildFolderList:function(e){var t=[];var o=this.getFolder(e);t=this.getSubFolders(o);if(o.subFolderCount>t.length){var r=o.subFolderCount-t.length;for(var i=0;i<r;i++){t.push({})}}return t},setViewModel:function(e){this.oViewData={folders:e};this.oViewModel=new t(this.oViewData);this.getView().setModel(this.oViewModel)},bindFoldersList:function(){var e=this;var t=new o({title:"{name}",icon:"{icon}",type:i.Navigation,press:e.selectFolder()});this.getView().oFoldersList.bindAggregation("items","/folders",t)},refreshHeaderBar:function(e){if(!e==""){var t=this.getFolder(e);this.setFolderSelectionDialogTitle(t.name);this.setFolderSelectionDialogBackButtonVisibility(true)}else{this.setFolderSelectionDialogTitle(this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT"));this.setFolderSelectionDialogBackButtonVisibility(false)}},selectFolder:function(e){var t=this;return function(e){var o=e.oSource.getBindingContext().getObject().id;t.refreshFolderSelection(o);t.sCurrentFolderId=o}},navigateBack:function(e){var t=this.getFolder(this.sCurrentFolderId);var o=t.parent;this.refreshFolderSelection(o);this.sCurrentFolderId=o},setFolderSelectionDialogTitle:function(e){var t=this.oFolderSelectionDialog.getCustomHeader();var o=t.getContentMiddle()[0];o.setText(e)},setFolderSelectionDialogBackButtonVisibility:function(e){var t=this.oFolderSelectionDialog.getCustomHeader();var o=t.getContentLeft()[0];o.setVisible(e)},getCurrentFolder:function(){if(this.sCurrentFolderId===""){return{name:this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT"),id:""}}return this.getFolder(this.sCurrentFolderId)},updateStarted:function(e){if(e.mParameters.reason=="Growing"){var t=[];var o=this.getFolderFromBuffer(this.sCurrentFolderId);var r=this.getSubFoldersFromBuffer(this.sCurrentFolderId).length;if(o.subFolderCount!=r){t=this.fetchSubFolders(this.sCurrentFolderId,r)}if(t.length>0){this.addFoldersToBuffer(t);for(var i=0;i<t.length;i++){this.oViewData.folders[i+r]=t[i]}}}},addFoldersToBuffer:function(e){if(!this.aFolderBuffer){this.aFolderBuffer=[]}for(var t=0;t<e.length;t++){this.aFolderBuffer.push(e[t])}},getSubFoldersFromBuffer:function(e){var t="";if(e){t=e}var o=function(e){return e.parent==t};return this.aFolderBuffer.filter(o)},getFolderFromBuffer:function(e){var t=function(t){return t.id==e};var o=this.aFolderBuffer.filter(t);return o[0]},getFolder:function(e){var t=this.getFolderFromBuffer(e);if(!t&&e==""){var o=this.oODataUtil.getSubFolders(this.oODataModel,this.sGroupId,null,"0",this.constants.top);t={name:this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT"),id:"",parent:"0",subFolderCount:o.count,icon:"sap-icon://folder"};this.addFoldersToBuffer([t]);var r=this.convertFolderEntities(o.folders,"");this.addFoldersToBuffer(r)}if(t.subFolderCount==undefined){var o=this.oODataUtil.getSubFolders(this.oODataModel,null,e,"0",this.constants.top);t.subFolderCount=o.count;var r=this.convertFolderEntities(o.folders,e);this.addFoldersToBuffer(r)}return t},getSubFolders:function(e){var t=[];if(e.subFolderCount>0){t=this.getSubFoldersFromBuffer(e.id)}return t},convertFolderEntities:function(e,t){var o=[];for(var r=0;r<e.length;r++){o.push({name:e[r].Name,id:e[r].Id,parent:t,icon:"sap-icon://folder"})}return o},fetchSubFolders:function(e,t){var o=[];if(!e||e==""){o=this.oODataUtil.getSubFolders(this.oODataModel,this.sGroupId,null,t,this.constants.top).folders;o=this.convertFolderEntities(o,"")}else{o=this.oODataUtil.getSubFolders(this.oODataModel,null,e,t,this.constants.top).folders;o=this.convertFolderEntities(o,e)}return o},clearFolderBuffer:function(){this.oFolderSelectionDialog.getContent()[0].getController().clearFolderBuffer()}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/FolderSelectionView", ["sap/ui/core/mvc/View","sap/m/List","sap/m/VBox"],function(t,e,o){"use strict";return t.extend("sap.collaboration.components.fiori.sharing.FolderSelectionView",{getControllerName:function(){return"sap.collaboration.components.fiori.sharing.FolderSelection"},createContent:function(t){var i=this.getViewData().controlId;this.oFoldersList=new e(i+"_FoldersList",{inset:false,showNoData:true,noDataText:this.getViewData().languageBundle.getText("FOLDER_EMPTY"),growing:true,growingThreshold:t.constants.top,updateStarted:function(e){t.updateStarted(e)}});var n=new o(i+"_DisplayFoldersLayout",{width:"100%",height:"100%",items:[this.oFoldersList]});return n}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/NoGroups.controller", ["sap/ui/core/mvc/Controller"],function(n){"use strict";return n.extend("sap.collaboration.components.fiori.sharing.NoGroups",{onInit:function(){},onBeforeRendering:function(){},onAfterRendering:function(){},onExit:function(){this.getView().destroyContent()}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/NoGroupsView", ["sap/ui/core/mvc/View","sap/m/VBox","sap/ui/layout/VerticalLayout","sap/ui/core/HTML","sap/m/library","sap/m/Link"],function(t,o,a,e,i,n){"use strict";var r=i.FlexAlignItems;return t.extend("sap.collaboration.components.fiori.sharing.NoGroupsView",{getControllerName:function(){return"sap.collaboration.components.fiori.sharing.NoGroups"},createContent:function(t){var a=this.getViewData().controlId;this.oNoGroupsVBox=new o(a+"_NoGroupsVbox");this.oNoGroupsVBox.addItem(this.createNoDataLayout());return this.oNoGroupsVBox},createNoDataLayout:function(t){var i=this.getViewData().controlId;var s=this.getViewData().langBundle;var u=this.getViewData().jamUrl;this.oNoDataLayout=new a(i+"_NoDataLayout",{width:"100%",content:[new e(i+"_NoDataDiv",{content:"<div>"+s.getText("NO_GROUPS_ERROR")+"</div>"}),new o(i+"_LinkVbox",{alignItems:r.End,items:[new n(i+"_JamLink",{text:s.getText("JAM_URL_TEXT"),target:"_blank",href:u})]}).addStyleClass("linkVBox")]});return this.oNoDataLayout}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/Sharing.controller", ["sap/base/Log","sap/base/security/encodeURL","./helper/AttachmentsUtil","./helper/ShareUtil","sap/collaboration/components/utils/CommonUtil","sap/collaboration/components/utils/OdataUtil","sap/ui/core/mvc/Controller","sap/ui/thirdparty/jquery","sap/ui/model/odata/ODataModel","sap/ui/model/odata/CountMode","sap/m/StandardListItem","sap/m/library"],function(e,t,i,o,s,a,n,jQuery,l,r,h,c){"use strict";var d=c.ListType;return n.extend("sap.collaboration.components.fiori.sharing.Sharing",{onInit:function(){this.oNoteTextArea=this.getView().oNoteTextArea;this.oAttachmentsInput=this.getView().oAttachmentsInput;this.oTargetFolderInput=this.getView().oTargetFolderInput;this.oODataUtil=undefined;this.sPrefixId=this.getView().getViewData().controlId;this.oLangBundle=this.getView().getViewData().langBundle;this.iJamGroupsCount=0;this.sObjectId=this.getView().getViewData().objectId;this.sObjectShare=this.getView().getViewData().objectShare;this.oObjectDisplay=this.getView().getViewData().objectDisplay;this.oExternalObject=undefined;this.oMappedExternalObject=undefined;this.sMemberEmail=undefined;this.oSharingDialog=this.getView().getViewData().sharingDialog;this.fNoGroupsCallBack=this.getView().getViewData().noGroupsCallBack;this.oCommonUtil=new s;this.oAttachments=this.getView().getViewData().attachments;this.bAttachmentsCB=false;this.aFiles=[];this.aSelectedFiles=[];this.sSelectedFolderId="";this.oItemTemplate=undefined;this.oSelectedGroup=undefined;this.gettingSuggestions=undefined},onBeforeRendering:function(){try{this.sSelectedGroupId="";this.sSelectedGroupName="";if(!this.oSMIODataModel){this.initializeOdataModel()}if(!this.oODataUtil){this.initializeOdataUtils()}if(!this.oAttachmentsUtil){this.initializeAttachmentsUtil()}this.initializeShareUtil();this.preRenderSetup();this.fetchData();this.clearAttachmentsData();this.oAttachments=this.getView().getViewData().attachments;if(this.oAttachments&&this.oAttachments.attachmentsArray){this.aFiles=this.oAttachments.attachmentsArray;if(this.aFiles.length>0){this.getView().oAttachmentsInput.setEnabled(true)}else{this.getView().oAttachmentsInput.setEnabled(false)}if(this.oFileSelectionDialog){var e=this.oAttachmentsUtil.createAttachmentsModel(this.aFiles);this.oFileSelectionDialog.setModel(e)}this.showAttachmentsFields(true)}else{this.showAttachmentsFields(false)}if(this.sObjectId!=this.getView().getViewData().objectId){this.sObjectId=this.getView().getViewData().objectId}if(this.sObjectShare!=this.getView().getViewData().objectShare||sap.ui.getCore().byId(this.sPrefixId+"_NoteTextArea").setValue!==this.getView().getViewData().objectShare){this.sObjectShare=this.getView().getViewData().objectShare;sap.ui.getCore().byId(this.sPrefixId+"_NoteTextArea").setInitialValue(this.sObjectShare)}if(this.oObjectDisplay!=this.getView().getViewData().objectDisplay){if(this.oObjectDisplay!=undefined){this.getView().oSharingVBox.removeItem(0)}this.oObjectDisplay=this.getView().getViewData().objectDisplay;this.getView().oSharingVBox.insertItem(this.oObjectDisplay,0)}}catch(e){if(this.oSharingDialog){throw e}this.oCommonUtil.displayError(e)}},onAfterRendering:function(){setTimeout(function(){sap.ui.getCore().byId(this.sPrefixId+"_GroupSelect").focus()}.bind(this),1)},onExit:function(){this.getView().destroyContent()},preRenderSetup:function(){this.getView().oGroupSelect.setEnabled(false);this.setGroupSelectionText("");if(this.oAttachments&&this.oAttachments.attachmentsArray){this.getView().oTargetFolderInput.setEnabled(false)}this.getView().oNoteTextArea.setEnabled(false);if(this.oSharingDialog){this.oSharingDialog.getButtons()[0].setEnabled(false);this.oSharingDialog.getButtons()[1].setEnabled(false)}},fetchData:function(){var t=this;var i=new jQuery.Deferred;i.done(function(e){t.iJamGroupsCount=e;if(t.iJamGroupsCount>0){t.postFetchSetup();setTimeout(function(){t.getView().getContent()[0].getItems()[1].getContent()[1].focus()},50)}else{if(t.fNoGroupsCallBack){t.fNoGroupsCallBack()}}});var o=new jQuery.Deferred;o.done(function(e){if(!t.sJamUrl){t.sJamUrl=e}});var s=new jQuery.Deferred;s.done(function(e){t.oMappedExternalObject=e});s.fail(function(){t.oMappedExternalObject=undefined;e.debug("Mapping Internal BO to External BO failed")});var a=new jQuery.Deferred;a.done(function(e){if(!t.sMemberEmail){t.sMemberEmail=e}});jQuery.when(i,o,s).fail(function(e){if(t.oSharingDialog){t.oSharingDialog.close()}if(e.statusCode===401||e.statusCode===403){t.oCommonUtil.displayError(t.oLangBundle.getText("SHARE_AUTHORIZATION_FAILURE_MSG"))}else{t.oCommonUtil.displayError()}});this.oJamODataModel.read("/Groups/$count",{success:function(e,t){i.resolve(parseInt(t.body))},error:function(e){i.reject(e.response)}});this.oJamODataModel.read("/Self",{success:function(e,t){a.resolve(this.oCommonUtil.getODataResult(e).Email)}.bind(this),error:function(e){a.reject(e.response)}});if(!this.sJamUrl){this.oSMIODataModel.read("/GetCollaborationHostURL",{success:function(e,t){o.resolve(e.GetCollaborationHostURL.URL)},error:function(e){o.reject(e.response)}})}else{o.resolve()}this.oExternalObject=this.getView().getViewData().externalObject;if(this.oExternalObject){this.oSMIODataModel.read("/MapInternalBOToExternalBO",{urlParameters:{ApplicationContext:"'"+t.oExternalObject.appContext+"'",ODataCollection:"'"+t.oExternalObject.collection+"'",ODataKeyPredicate:"'"+t.oExternalObject.key+"'",ODataServicePath:"'"+t.oExternalObject.odataServicePath+"'"},success:function(e,t){s.resolve(e.MapInternalBOToExternalBO)},error:function(e){s.reject(e.response)}})}},postFetchSetup:function(){this.setGroupSelectionEnabled(true)},initializeOdataModel:function(){var e=true;this.sSMIODataServiceUrl=this.getView().getViewData().odataServiceUrl;this.oSMIODataModel=new l(this.sSMIODataServiceUrl,e);this.sJamODataServiceUrl=this.getView().getViewData().collaborationHostODataServiceUrl;this.oJamODataModel=new l(this.sJamODataServiceUrl,e);this.oJamODataModel.setDefaultCountMode(r.Inline)},initializeOdataUtils:function(){this.oODataUtil=new a},initializeAttachmentsUtil:function(){this.oAttachmentsUtil=new i(this.oLangBundle,this.oODataUtil,this.oJamODataModel)},initializeShareUtil:function(){this.oShareUtil=new o(this.oLangBundle,this.oODataUtil,this.oSMIODataModel,this.oCommonUtil,this.oJamODataModel,this.getView().getViewData().collaborationHostRestService)},setGroupSelectionText:function(e){var t=sap.ui.getCore().byId(this.sPrefixId+"_GroupSelect");t.setValue(e)},setGroupSelectionEnabled:function(e){var t=sap.ui.getCore().byId(this.sPrefixId+"_GroupSelect");t.setEnabled(e)},setFolderSelectionEnabled:function(e){this.oTargetFolderInput.setEnabled(e)},showAttachmentsFields:function(e){this.getView().AttachmentsInputLayout.setVisible(e);this.getView().oTargetFolderInputLayout.setVisible(e);this.getView().oAttachmentCB.setVisible(e)},clearAttachmentsData:function(){this.aFiles=[];this.aSelectedFiles=[];this.sSelectedFolderId="";this.bAttachmentsCB=false;this.oAttachmentsInput.setValue("");this.getView().oAttachmentCB.setSelected(this.bAttachmentsCB);this.getView().oAttachmentCB.setEnabled(false);this.oTargetFolderInput.setValue("");if(this.oFolderSelectionDialog){this.oAttachmentsUtil.resetFolderSelection(this.getSelectedGroupId())}},onAttachmentsValueHelpPress:function(e){if(this.oSharingDialog){var t=this.oSharingDialog.getContent()[0].getDomRef().offsetHeight;var i=this.oSharingDialog.getContent()[0].getDomRef().offsetWidth}if(!this.oFileSelectionDialog){var o=this.oAttachmentsUtil.createAttachmentsModel(this.aFiles);this.oFileSelectionDialog=this.oAttachmentsUtil.createFileSelectionDialog(this.sPrefixId,o,this.onFileSelectionDialogConfirm(),i,t)}var s=this.oFileSelectionDialog.getBinding("items");s.filter([]);this.oFileSelectionDialog.open()},onFileSelectionDialogConfirm:function(){var e=this;return function(t){e.aSelectedFiles=[];var i=t.getParameter("selectedContexts");for(var o=0;o<i.length;o++){e.aSelectedFiles.push(i[o].getObject())}if(e.aSelectedFiles&&e.aSelectedFiles.length>0){e.postFileSelectionSetup(true)}else{e.postFileSelectionSetup(false)}}},postFileSelectionSetup:function(e){if(e===true){if(this.aSelectedFiles.length==1){this.oAttachmentsInput.setValue(this.oLangBundle.getText("SELECTED_ATTACHMENT_FIELD_TEXT",[this.aSelectedFiles.length]))}else{this.oAttachmentsInput.setValue(this.oLangBundle.getText("SELECTED_ATTACHMENTS_FIELD_TEXT",[this.aSelectedFiles.length]))}this.getView().oAttachmentCB.setEnabled(true);if(this.sSelectedGroupId!==""){this.setFolderSelectionEnabled(true)}}else{this.oAttachmentsInput.setValue("");this.bAttachmentsCB=false;this.getView().oAttachmentCB.setSelected(this.bAttachmentsCB);this.postAttachmentCheckBoxSelection();this.getView().oAttachmentCB.setEnabled(false);this.setFolderSelectionEnabled(false)}},onGroupSelectValueHelpPress:function(e){if(!this.oItemTemplate){this.oItemTemplate=new h({title:{parts:["Name","GroupType"],formatter:function(e,t){return e+" ("+t+")"}},type:d.Active,tooltip:"{Name}"})}if(this.oSharingDialog){var t=this.oSharingDialog.getContent()[0].getDomRef().offsetHeight;var i=this.oSharingDialog.getContent()[0].getDomRef().offsetWidth}if(!this.oGroupSelectionDialog){this.oGroupSelectionDialog=this.oShareUtil.createGroupSelectionDialog(this.sPrefixId,this.oItemTemplate,this._onGroupSelectionDialogConfirm(),i,t,this.oJamODataModel)}else{this.oGroupSelectionDialog.setModel(this.oJamODataModel);this.oGroupSelectionDialog.bindAggregation("items","/Groups",this.oItemTemplate)}this.oGroupSelectionDialog.open()},_onGroupSelectionDialogConfirm:function(){var e=this;return function(t){var i=t.getParameter("selectedContexts");for(var o=0;o<i.length;o++){e.oSelectedGroup=i[o].getObject()}if(e.oSelectedGroup){e.postGroupSelectionSetup(true)}else{e.postGroupSelectionSetup(false)}}},postGroupSelectionSetup:function(e){if(e===true){if(this.oSelectedGroup!==undefined){this.sSelectedGroupId=this.oSelectedGroup.Id.toString();this.sSelectedGroupName=this.oSelectedGroup.Name.toString();this.setGroupSelectionText(this.sSelectedGroupName)}if(this.oAttachments&&this.oAttachments.attachmentsArray){this.sSelectedFolderId="";this.oAttachmentsUtil.resetFolderSelection(this.getSelectedGroupId());var t=this.oAttachmentsUtil.getCurrentFolder();this.oTargetFolderInput.setValue(t.name)}if(this.aSelectedFiles&&this.aSelectedFiles.length>0){this.setFolderSelectionEnabled(true)}if(this.bAttachmentsCB===false){this.getView().oNoteTextArea.setEnabled(true)}if(this.oSharingDialog){this.oSharingDialog.getButtons()[0].setEnabled(true);this.oSharingDialog.getButtons()[1].setEnabled(true)}}else{this.setFolderSelectionEnabled(false);this.getView().oNoteTextArea.setEnabled(false)}},onTargetFolderValueHelpPress:function(e){if(this.oSharingDialog){var t=this.oSharingDialog.getContent()[0].getDomRef().offsetHeight;var i=this.oSharingDialog.getContent()[0].getDomRef().offsetWidth}if(!this.oFolderSelectionDialog){this.oFolderSelectionDialog=this.oAttachmentsUtil.createFolderSelectionDialog(this.sPrefixId,this.getSelectedGroupId(),this.onFolderSelectionDialogConfirm(),this.onFolderSelectionDialogCancel(),i,t);this.sSelectedFolderId=""}this.oFolderSelectionDialog.getContent()[0].oController.setFolderSelectionDialogTitle(this.oTargetFolderInput.getValue());this.oFolderSelectionDialog.open()},onFolderSelectionDialogConfirm:function(e){var t=this;return function(){var e=t.oAttachmentsUtil.getCurrentFolder();t.sSelectedFolderId=e.id;t.oTargetFolderInput.setValue(e.name)}},onFolderSelectionDialogCancel:function(e){var t=this;return function(e){t.oAttachmentsUtil.setCurrentFolderId(t.sSelectedFolderId)}},onAttachmentCheckBoxSelected:function(){this.bAttachmentsCB=this.getView().oAttachmentCB.getSelected();this.postAttachmentCheckBoxSelection()},atMentionsButtonPressed:function(){this.getView().oNoteTextArea.atMentionsButtonPressed()},onSuggestion:function(t){if(this.gettingSuggestions){this.gettingSuggestions.abort()}var i=this;var o=t.getParameter("value");var s=this.getView().oNoteTextArea;if(o.trim()===""){s.showSuggestions([]);s.setSuggestionHeight(undefined);return}var a=this.getSelectedGroupId();var n="/Members_Autocomplete";var l={async:true,urlParameters:{Query:"'"+o+"'",GroupId:"'"+a+"'",$top:"4"},success:function(e,t){var o=i.oCommonUtil.getODataResult(e);if(o.length===0){s.closeSuggestionPopover();s.setSuggestionHeight(undefined)}else{var a=[];var n=o.length;for(var l=0;l<n;l++){a.push({fullName:o[l].FullName,email:o[l].Email,userImage:i._buildThumbnailImageURL(o[l].Id)})}s.showSuggestions(a);n>=3?s.setSuggestionHeight("12rem"):s.setSuggestionHeight(undefined)}},error:function(t){e.error("Failed to get suggestions: "+t.statusText)}};this.gettingSuggestions=this.oJamODataModel.read(n,l)},postAttachmentCheckBoxSelection:function(){if(this.bAttachmentsCB===true){this.getView().oNoteTextArea.setEnabled(false)}else{if(this.sSelectedGroupId!==""){this.getView().oNoteTextArea.setEnabled(true)}}},getSharingData:function(){var e;if(this.oNoteTextArea.getValue()!==undefined&&this.oNoteTextArea.getValue()!==""||this.sObjectId!==undefined&&this.sObjectId!==""){e={note:this.oNoteTextArea.convertTextWithFullNamesToEmailAliases(),uiUrl:this.sObjectId}}if(JSON.stringify(this.oExternalObject)==="{}"){this.oExternalObject=undefined}return{feedContent:e,groupId:this.getSelectedGroupId(),folderId:this.getSelectedFolderId(),aFilesToUpload:this.aSelectedFiles,externalObject:this.oExternalObject,mappedExternalObject:this.oMappedExternalObject,groupName:this.getSelectedGroupName(),memberEmail:this.sMemberEmail}},getSelectedGroupId:function(){return this.sSelectedGroupId},getSelectedGroupName:function(){return this.sSelectedGroupName},getSelectedFolderId:function(){return this.sSelectedFolderId},shareToJam:function(){var e=this.getSharingData();var t=this;if(e.aFilesToUpload.length===0&&(!e.feedContent||!e.feedContent.uiUrl&&e.feedContent.note.trim()==="")&&!e.externalObject){var i=t.oLangBundle.getText("SHARING_NOTHING_TO_SHARE_MSG");this.oCommonUtil.showMessage(i,{duration:3e3,autoclose:false})}else{if(!this.bAttachmentsCB){this.oShareUtil.shareBusinessObject(e)}if(e.aFilesToUpload.length>0){this.oShareUtil.uploadAttachments(e);var i=this.oLangBundle.getText("SHARING_ACKNOWLEDGMENT_MSG");setTimeout(function(){t.oCommonUtil.showMessage(i,{duration:3e3,width:"30em",autoClose:false})},500)}}},_buildThumbnailImageURL:function(e){return this.oJamODataModel.sServiceUrl+"/Members('"+t(e)+"')/ThumbnailImage/$value"}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/SharingView", ["sap/ui/core/mvc/View","sap/m/VBox","sap/m/Label","sap/m/Input","sap/m/library","sap/ui/layout/VerticalLayout","sap/m/FlexItemData","sap/collaboration/components/controls/SocialTextArea","sap/m/CheckBox"],function(t,e,a,o,n,r,i,l,s){"use strict";var h=n.PlacementType;var u=n.InputType;return t.extend("sap.collaboration.components.fiori.sharing.SharingView",{getControllerName:function(){return"sap.collaboration.components.fiori.sharing.Sharing"},createContent:function(t){var a=this.getViewData().controlId;this.oSharingVBox=new e(a+"_SharingVbox");this.createSharingVBoxContent(t);return this.oSharingVBox},createSharingVBoxContent:function(t){var e=this.getViewData().controlId;var n=this.getViewData().langBundle;var c=this.getViewData().jamUrl;this.oObjectDisplay=this.getViewData().objectDisplay;if(this.oObjectDisplay){this.oSharingVBox.addItem(this.oObjectDisplay)}var d=new a(e+"_GroupLabel",{text:n.getText("GRP_SELECT_LABEL"),required:true,width:"100%"});this.oGroupSelect=new o(e+"_GroupSelect",{width:"100%",type:u.Text,placeholder:n.getText("GRP_SELECT_BUTTON_TEXT"),showValueHelp:true,enabled:true,editable:true,valueHelpRequest:function(e){t.onGroupSelectValueHelpPress(e)},ariaLabelledBy:e+"_GroupLabel"});var g=new r(e+"_GroupSelectionLayout",{width:"100%",layoutData:new i({growFactor:1}),content:[d,this.oGroupSelect]}).addStyleClass("sharingVBox");this.oSharingVBox.addItem(g);var p=new a(e+"_AttachmentsLabel",{text:n.getText("ATTACHMENTS_LABEL"),required:false,width:"100%"});this.oAttachmentsInput=new o(e+"_AttachmentsInput",{width:"100%",type:u.Text,placeholder:n.getText("ATTACHMENTS_FIELD_TEXT",[""]),showValueHelp:true,enabled:true,editable:true,valueHelpRequest:function(e){t.onAttachmentsValueHelpPress(e)},ariaLabelledBy:e+"_AttachmentsLabel"});this.AttachmentsInputLayout=new r(e+"_AttachmentsInputLayout",{width:"100%",layoutData:new i({growFactor:1}),content:[p,this.oAttachmentsInput]}).addStyleClass("sharingVBox");this.oSharingVBox.addItem(this.AttachmentsInputLayout);var T=new a(e+"_TargetFolderLabel",{text:n.getText("TARGET_FOLDER_LABEL"),required:false,width:"100%"});this.oTargetFolderInput=new o(e+"_TargetFolderInput",{width:"100%",type:u.Text,placeholder:n.getText("TARGET_FOLDER_FIELD_TEXT"),showValueHelp:true,enabled:true,editable:true,valueHelpRequest:function(e){t.onTargetFolderValueHelpPress(e)},ariaLabelledBy:e+"_TargetFolderLabel"});this.oTargetFolderInputLayout=new r(e+"_TargetFolderInputLayout",{width:"100%",layoutData:new i({growFactor:1}),content:[T,this.oTargetFolderInput]}).addStyleClass("sharingVBox");this.oSharingVBox.addItem(this.oTargetFolderInputLayout);var w=new a(e+"_NoteLabel",{text:n.getText("ADD_NOTE_LABEL"),width:"100%"});var x;this.getViewData().objectId?x=this.getViewData().objectId.length:x=0;var L=1e3-x-1;this.oNoteTextArea=new l(e+"_NoteTextArea",{initialValue:this.getViewData().objectShare,rows:6,width:"100%",suggestionPlacement:h.Top,maxLength:L,suggest:t.onSuggestion.bind(t),ariaLabelledBy:e+"_NoteLabel"});var _=new r(e+"_NoteLayout",{width:"100%",layoutData:new i({growFactor:2}),content:[w,this.oNoteTextArea]}).addStyleClass("sharingVBox");this.oSharingVBox.addItem(_);this.oAttachmentCB=new s(e+"_AttchmentCB",{text:n.getText("SHARE_ATTACHMENTS_ONLY_LABEL"),enabled:false,select:function(){t.onAttachmentCheckBoxSelected()},ariaLabelledBy:e+"_AttchmentCB"});this.oSharingVBox.addItem(this.oAttachmentCB)}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/attachment/Attachment", ["./InvalidAttachmentConstructorArgumentsException","./InvalidAttachmentParameterException","sap/ui/base/Object"],function(t,e,n){"use strict";var i=n.extend("sap.collaboration.components.fiori.sharing.attachment.Attachment",{constructor:function(e,n,i){if(arguments.length===3&&Object.prototype.toString.call(e)==="[object String]"&&Object.prototype.toString.call(n)==="[object String]"&&Object.prototype.toString.call(i)==="[object String]"){this.name=e;this.mimeType=n;this.url=i}else{throw new t}},getName:function(){return this.name},getMimeType:function(){return this.mimeType},getUrl:function(){return this.url},setName:function(t){if(arguments.length===1&&Object.prototype.toString.call(t)==="[object String]"){this.name=t}else{throw new e("name")}},setMimeType:function(t){if(arguments.length===1&&Object.prototype.toString.call(t)==="[object String]"){this.mimeType=t}else{throw new e("mimeType")}},setUrl:function(t){if(arguments.length===1&&Object.prototype.toString.call(t)==="[object String]"){this.url=t}else{throw new e("url")}}});return i});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/attachment/InvalidAttachmentConstructorArgumentsException", ["sap/ui/base/Object"],function(t){"use strict";var n=t.extend("sap.collaboration.components.fiori.sharing.attachment.InvalidAttachmentConstructorArgumentsException",{constructor:function(){this.exceptionName="InvalidAttachmentConstructorArgumentsException"}});return n});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/attachment/InvalidAttachmentParameterException", ["sap/ui/base/Object"],function(t){"use strict";var e=t.extend("sap.collaboration.components.fiori.sharing.attachment.InvalidAttachmentParameterException",{constructor:function(t){this.exceptionName="InvalidAttachmentParameterException: "+t}});return e});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/dialog/Component", ["sap/base/Log","sap/collaboration/components/utils/CommonUtil","sap/ui/core/UIComponent","sap/ui/core/mvc/View","sap/ui/core/library","sap/m/Dialog","sap/m/Button","sap/ui/Device"],function(t,e,i,o,a,s,n,r){"use strict";var h=a.mvc.ViewType;var g=i.extend("sap.collaboration.components.fiori.sharing.dialog.Component",{metadata:{includes:["../../../resources/css/Sharing.css"],properties:{attachments:{type:"object"},object:{type:"object"},externalObject:{type:"object"}},aggregations:{},events:{}},systemSettings:{width:"400px",height:"",oDataServiceUrl:"/sap/opu/odata/sap/SM_INTEGRATION_V2_SRV",collaborationHostODataServiceUrl:"/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData",collaborationHostRestService:{url:"/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1",urlParams:""}},init:function(){i.prototype.init.call(this);this.oCommonUtil=new e;this.oLangBundle=this.oCommonUtil.getLanguageBundle()},setSettings:function(t){this.setObject(t.object);this.setAttachments(t.attachments);if(JSON.stringify(t.externalObject)==="{}"){this.setExternalObject(undefined)}else{this.setExternalObject(t.externalObject)}},_createSharingView:async function(){var t=this;var e;var i;var a;var s=this.getObject();if(s){a=t._handleObjectId(s.id);e=s.display;i=s.share}var n=function(){t.close();t.openoNoGroupsDialog(t.oSharingView.getController().sJamUrl)};if(!this.oSharingView){this.oSharingView=await o.create({id:this.getId()+"_SharingView",viewData:{controlId:this.getId(),odataServiceUrl:this.systemSettings.oDataServiceUrl,collaborationHostODataServiceUrl:this.systemSettings.collaborationHostODataServiceUrl,collaborationHostRestService:this.systemSettings.collaborationHostRestService,langBundle:this.oLangBundle,jamGroups:this.aJamGroups,sharingDialog:this._oSharingDialog,noGroupsCallBack:n,objectDisplay:e,objectShare:i,objectId:a,attachments:this.getAttachments(),externalObject:this.getExternalObject()},viewName:"module:sap/collaboration/components/fiori/sharing/SharingView"})}else{this.oSharingView.getViewData().objectId=a;this.oSharingView.getViewData().objectShare=i;this.oSharingView.getViewData().objectDisplay=e;this.oSharingView.getViewData().externalObject=this.getExternalObject();this.oSharingView.getViewData().attachments=this.getAttachments()}},_createSharingDialog:function(){var t=new s(this.getId()+"_SharingDialog",{title:this.oLangBundle.getText("SHARING_PAGE_TITLE"),contentWidth:this.systemSettings.width,stretch:false,afterClose:function(){}}).addStyleClass("sapUiPopupWithPadding");return t},createNoGroupsDialog:async function(t){if(!this.oNoGroupsView){this.oNoGroupsView=await o.create({id:this.getId()+"_NoGroupsView",viewData:{controlId:this.getId(),langBundle:this.oLangBundle,jamUrl:t},viewName:"module:sap/collaboration/components/fiori/sharing/NoGroupsView"})}var e=new s(this.getId()+"_NoGroupsDialog",{title:this.oLangBundle.getText("SHARING_PAGE_TITLE"),stretch:false,content:this.oNoGroupsView,beginButton:new n(this.getId()+"_CloseButton",{text:this.oLangBundle.getText("CLOSE_BUTTON_TEXT"),press:function(){e.close()}})}).addStyleClass("sapUiPopupWithPadding");return e},open:async function(){if(this.bStopRendering===undefined||this.bStopRendering===false){if(!this._oSharingDialog){this._logComponentProperties();this._oSharingDialog=this._createSharingDialog()}try{await this._createSharingView();this._oSharingDialog.addAriaLabelledBy(this.getId()+"_SharingView");this._oSharingDialog.addContent(this.oSharingView);this._oSharingDialog.setInitialFocus(this.oSharingView);this._createDialogButtons();if(r.system.phone){this._oSharingDialog.setStretch(true)}this._oSharingDialog.open()}catch(e){t.error(e);this.oCommonUtil.displayError()}}},close:function(){if(this._oSharingDialog){this._oSharingDialog.close()}},openoNoGroupsDialog:async function(t){this._oSharingDialog.removeAllContent();if(!this.oNoGroupsDialog){this.oNoGroupsDialog=await this.createNoGroupsDialog(t)}this.oNoGroupsDialog.open()},_createDialogButtons:function(){if(!this.oMentionButton){this.oMentionButton=new n(this.getId()+"_mentionButton",{text:"@",enabled:false,press:[function(){this.oSharingView.getController().atMentionsButtonPressed()},this]});this._oSharingDialog.addButton(this.oMentionButton)}if(r.system.phone){this.oMentionButton.setVisible(false)}if(!this.oLeftButton){this.oLeftButton=new n(this.getId()+"_LeftButton",{text:this.oLangBundle.getText("OK_BUTTON_TEXT"),enabled:false,press:[function(){this.oSharingView.getController().shareToJam();this._oSharingDialog.close()},this]});this._oSharingDialog.addButton(this.oLeftButton)}if(!this.oRightButton){this.oRightButton=new n(this.getId()+"_RightButton",{text:this.oLangBundle.getText("CANCEL_BUTTON_TEXT"),press:[function(){this._oSharingDialog.close()},this]});this._oSharingDialog.addButton(this.oRightButton)}},setDialogButtons:function(){},setCloseButton:function(){this._oSharingDialog.destroyBeginButton();this._oSharingDialog.setEndButton(this.oCloseButton)},_handleObjectId:function(e){var i=typeof e;var o;switch(i){case"undefined":case"":case"string":o=e;break;case"function":o=e();if(typeof o=="string"){break}default:t.error("object->id is not a sting or callback function that returns a string");throw new Error}return o},_logComponentProperties:function(){t.debug("Share Component properties:","","sap.collaboration.components.fiori.sharing.Component._logComponentProperties()");t.debug("width: "+this.systemSettings.width);t.debug("height: "+this.systemSettings.height);t.debug("oDataServiceUrl: "+this.systemSettings.oDataServiceUrl);t.debug("collaborationHostODataServiceUrl: "+this.systemSettings.collaborationHostODataServiceUrl);t.debug("collaborationHostRestService: "+this.systemSettings.collaborationHostRestService.url+this.systemSettings.collaborationHostRestService.urlParams);if(this.getObject()){t.debug("object->id: "+this.getObject().id);t.debug("object->display: "+this.getObject().display);t.debug("object->share: "+this.getObject().share)}else{t.debug("object: undefined")}if(this.getAttachments()&&this.getAttachments().attachmentsArray){t.debug("Attachments:");var e=this.getAttachments().attachmentsArray;for(var i=0;i<e.length;i++){t.debug("Attachments"+(i+1)+":");t.debug(e[i].mimeType);t.debug(e[i].name);t.debug(e[i].url)}}else{t.debug("attachments: undefined")}if(this.getExternalObject()){t.debug("externalObject->appContext: "+this.getExternalObject().appContext);t.debug("externalObject->odataServicePath: "+this.getExternalObject().odataServicePath);t.debug("externalObject->collection: "+this.getExternalObject().collection);t.debug("externalObject->key: "+this.getExternalObject().key);t.debug("object->name: "+this.getExternalObject().name);t.debug("object->summary: "+this.getExternalObject().summary)}else{t.debug("externalObject: undefined")}}});return g});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/helper/AttachmentsUtil", ["sap/collaboration/components/utils/CommonUtil","sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/SelectDialog","sap/m/StandardListItem","sap/m/library","sap/ui/model/json/JSONModel","sap/m/Bar","sap/m/Button","sap/m/Label","sap/m/Dialog","sap/ui/Device","sap/ui/core/mvc/View","sap/ui/core/library"],function(e,t,o,i,n,l,a,r,s,c,g,d,u,h,m){"use strict";var p=m.mvc.ViewType;var D=a.ButtonType;var F=a.ListType;var S=t.extend("sap.collaboration.components.fiori.sharing.helper.AttachmentsUtil",{constructor:function(t,o,i){this.oCommonUtil=new e;this.oLangBundle=t;this.oODataUtil=o;this.oJamODataModel=i},createFileSelectionDialog:function(e,t,a,r,s){var c=function(e){var t=e.getParameter("value");var n=new o("name",i.Contains,t);var l=e.getSource().getBinding("items");l.filter([n])};this.oFileSelectionDialog=new n(e+"_FileSelectionDialog",{multiSelect:true,rememberSelections:true,title:this.oLangBundle.getText("ATTACHMENTS_FIELD_TEXT",[""]),confirm:a,search:c,liveChange:c});if(r){this.oFileSelectionDialog.setContentWidth(r.toString()+"px")}if(s){this.oFileSelectionDialog.setContentHeight(s.toString()+"px")}var g=new l({title:"{name}",icon:"{icon}",iconDensityAware:false,iconInset:true,type:F.Active});this.oFileSelectionDialog.setModel(t);this.oFileSelectionDialog.bindAggregation("items","/attachments",g);return this.oFileSelectionDialog},createAttachmentsModel:function(e){var t=[];for(var o=0;o<e.length;o++){t.push({name:e[o].getName(),mimeType:e[o].getMimeType(),url:e[o].getUrl(),icon:this.oCommonUtil.getIconFromMimeType(e[o].getMimeType())})}var i=new r({attachments:t});return i},createFolderSelectionDialog:async function(e,t,o,i,n,l){var a=this;var r=function(e){a.oFolderSelectionDialog.getContent()[0].getController().navigateBack()};var m=new s(e+"_FolderSelectionDialogHeaderBar",{contentLeft:[new c(e+"_FolderSelectionDialogHeaderBarBackButton",{type:D.Back,visible:false,press:r})],contentMiddle:[new g(e+"_FolderSelectionDialogHeaderBarTitle",{text:this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT")})]});var p=new c(e+"_FolderSelectionDialogOKButton",{text:this.oLangBundle.getText("OK_BUTTON_TEXT"),press:function(e){o(e);a.oFolderSelectionDialog.close()}});var F=new c(e+"_FolderSelectionDialogCancelButton",{text:this.oLangBundle.getText("CANCEL_BUTTON_TEXT"),press:function(e){i(e);a.oFolderSelectionDialog.close()}});this.oFolderSelectionDialog=new d(e+"_FolderSelectionDialog",{beginButton:p,endButton:F,customHeader:m}).addStyleClass("sapUiPopupWithPadding");var S=await h.create({id:e+"_FolderSelectionView",viewData:{controlId:e,groupId:t,languageBundle:this.oLangBundle,oDataUtil:this.oODataUtil,oDataModel:this.oJamODataModel,folderSelectionDialog:this.oFolderSelectionDialog},viewName:"module:sap/collaboration/components/fiori/sharing/FolderSelectionView"});if(n){S.setWidth(n.toString()+"px")}if(l){S.setHeight(l.toString()+"px")}this.oFolderSelectionDialog.addContent(S);if(u.system.phone){this.oFolderSelectionDialog.setStretch(true)}return this.oFolderSelectionDialog},getCurrentFolder:function(){if(this.oFolderSelectionDialog){return this.oFolderSelectionDialog.getContent()[0].getController().getCurrentFolder()}return{name:this.oLangBundle.getText("TARGET_FOLDER_FIELD_TEXT"),id:""}},getCurrentGroupId:function(){return this.oFolderSelectionDialog.getContent()[0].getController().sGroupId},resetFolderSelection:function(e){if(this.oFolderSelectionDialog){this.oFolderSelectionDialog.getContent()[0].getController().sGroupId=e;this.oFolderSelectionDialog.getContent()[0].getController().sCurrentFolderId="";this.oFolderSelectionDialog.getContent()[0].getController().aFolderBuffer=[]}},setCurrentFolderId:function(e){this.oFolderSelectionDialog.getContent()[0].getController().sCurrentFolderId=e}});return S});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/fiori/sharing/helper/ShareUtil", ["sap/base/Log","sap/base/security/encodeXML","sap/ui/base/Object","sap/m/SelectDialog"],function(e,t,a,r){"use strict";var i=a.extend("sap.collaboration.components.fiori.sharing.helper.ShareUtil",{constructor:function(e,t,a,r,i,s){this._bIsOkToRefreshSecurityToken=true;this.iGrowingThreshold=10;this.oLangBundle=e;this.oODataUtil=t;this.oSMIODataModel=a;this.oJamODataModel=i;this.oCollaborationHostRestService=s;this.oCommonUtil=r;this.bShareError=false;this.bShareBusinessObjShared;this.bFileUploaded;this.aUploadAttachmentsUploaded=[];this.IdisplaySuccessMessageIntervalId},shareBusinessObject:function(t){var a=this;if(t.mappedExternalObject){if(t.feedContent!==undefined&&t.feedContent.uiUrl!==undefined){var r=t.mappedExternalObject;r.Name=t.externalObject.name;r.Groups=[{__metadata:{uri:"Groups('"+t.groupId+"')"}}];r.Permalink=t.feedContent.uiUrl;var i={async:true,success:function(e,r){a._bIsOkToRefreshSecurityToken=true;a._createGroupFeedEntry_SharedExternalObject(t)},error:function(e){if(e.response.statusCode===409){a._createGroupFeedEntry_SharedExternalObject(t)}else if(e.response.statusCode===403&&a._bIsOkToRefreshSecurityToken){a.oJamODataModel.refreshSecurityToken(function(){a._bIsOkToRefreshSecurityToken=false;a.shareBusinessObject(t)},function(e){a._checkAuthorizationAndDisplayErrorMessage(e.response.statusCode)},true)}else{a._bIsOkToRefreshSecurityToken=true;a._checkAuthorizationAndDisplayErrorMessage(e.response.statusCode)}}};this.oJamODataModel.create("/ExternalObjects",r,i)}else{e.error("feedContent.uiUrl parameter should not be undefined when sharing an external object","sap.collaboration.components.fiori.sharing.helper.ShareUtil.shareBusinessObject()");this.displayErrorMessage()}}else{this._createFeedEntry_ShareObjectLink(t)}},_createGroupFeedEntry_SharedExternalObject:function(e){var a='<?xml version="1.0" encoding="UTF-8"?>'+'<feed xmlns="http://www.w3.org/2005/Atom" xmlns:activity="http://activitystrea.ms/spec/1.0/">'+"<entry>"+"<title> </title>"+'<content type="html">'+t(e.feedContent.note)+"</content>"+"<author>"+"<email>"+t(e.memberEmail)+"</email>"+"<activity:object-type>http://activitystrea.ms/schema/1.0/person</activity:object-type>"+"</author>"+"<activity:verb>http://activitystrea.ms/schema/1.0/share</activity:verb>"+"<activity:object>"+"<id>"+t(e.mappedExternalObject.Exid)+"</id>"+'<title type="html">'+t(e.externalObject.name)+"</title>"+"<activity:object-type>"+t(e.mappedExternalObject.ObjectType)+"</activity:object-type>"+'<link type="text/html" rel="alternate" href="'+t(e.feedContent.uiUrl)+'"/>'+'<link rel="http://www.odata.org" href="'+t(e.mappedExternalObject.ODataLink)+'"/>'+'<link rel="http://www.odata.org/metadata" href="'+t(e.mappedExternalObject.ODataMetadata)+'"/>'+'<link rel="http://www.odata.org/annotation" href="'+t(e.mappedExternalObject.ODataAnnotations)+'"/>'+"<source>"+"<id>tag:www.cubetree.com,2013:/groups/"+t(e.groupId)+"</id>"+"</source>"+"</activity:object>"+"</entry>"+"</feed>";var r=this;var i=function(){if(this.readyState==4){if(this.status==200){r.bShareBusinessObjShared=true;r.displaySuccessMessage(e.groupName)}else{r._checkAuthorizationAndDisplayErrorMessage(this.status)}}};this._createFeedEntryViaRestAPI(a,i)},_createFeedEntry_ShareObjectLink:function(a){this.bShareBusinessObjShared=false;if(a.feedContent){if(a.feedContent.note!==undefined){var r=a.feedContent.note;if(a.feedContent.uiUrl){r=r+"<br/><a href='"+a.feedContent.uiUrl.replace(/'/g,"&apos;")+"'>"+this.oLangBundle.getText("SHARE_OBJECT_LINK")+"</a>"}var i='<?xml version="1.0" encoding="UTF-8"?>'+'<feed xmlns="http://www.w3.org/2005/Atom" xmlns:activity="http://activitystrea.ms/spec/1.0/">'+"<entry>"+"<title>"+t(this.oLangBundle.getText("SHARE_OBJECT_LINK_TITLE"))+"</title>"+'<content type="html">'+t(r)+"</content>"+"<author>"+"<email>"+t(a.memberEmail)+"</email>"+"<activity:object-type>http://activitystrea.ms/schema/1.0/person</activity:object-type>"+"</author>"+"<activity:verb>http://activitystrea.ms/schema/1.0/share</activity:verb>"+"<activity:object>"+"<source>"+"<id>tag:www.cubetree.com,2013:/groups/"+t(a.groupId)+"</id>"+"</source>"+"</activity:object>"+"</entry>"+"</feed>";var s=this;var o=function(){if(this.readyState==4){if(this.status==200){s.bShareBusinessObjShared=true;s._bIsOkToRefreshSecurityToken=true;s.displaySuccessMessage(a.groupName)}else{if(this.status==403&&s._bIsOkToRefreshSecurityToken){s.oJamODataModel.refreshSecurityToken(function(){s._bIsOkToRefreshSecurityToken=false;s._createFeedEntry_ShareObjectLink(a)},function(e){s._checkAuthorizationAndDisplayErrorMessage(e.response.statusCode)},true)}else{s._bIsOkToRefreshSecurityToken=true;s._checkAuthorizationAndDisplayErrorMessage(this.status)}}}};this._createFeedEntryViaRestAPI(i,o)}else{e.error("feedContent.note parameter should not be undefined","sap.collaboration.components.fiori.sharing.helper.ShareUtil._createFeedEntry_ShareObjectLink()");this.displayErrorMessage()}}else{e.error("feedContent parameter should not be undefined","sap.collaboration.components.fiori.sharing.helper.ShareUtil._createFeedEntry_ShareObjectLink()");this.displayErrorMessage()}},_createFeedEntryViaRestAPI:function(e,t){var a={Accept:"application/atom+xml","Content-Type":"application/atom+xml","x-csrf-token":this.oJamODataModel.getSecurityToken()};var r=this.oCollaborationHostRestService.url+"/feed/post";if(this.oCollaborationHostRestService.urlParams!=undefined&&this.oCollaborationHostRestService.urlParams!=""){r=r+"?"+this.oCollaborationHostRestService.urlParams}var i=new window.XMLHttpRequest;i.open("POST",r,true);for(var s in a){i.setRequestHeader(s,a[s])}i.onreadystatechange=t;i.send(e)},uploadAttachments:function(t){for(var a in t.aFilesToUpload){this.oSMIODataModel.create("/UploadTargetFile",null,{async:true,success:function(t,a){e.debug("File was uploaded","sap.collaboration.components.fiori.sharing.helper.ShareUtil.uploadAttachments()")},error:function(t){e.error("Error, file was not uploaded","sap.collaboration.components.fiori.sharing.helper.ShareUtil.uploadAttachments()")},urlParameters:{FileMimeType:"'"+t.aFilesToUpload[a].mimeType+"'",FileName:"'"+t.aFilesToUpload[a].name+"'",FileURL:"'"+t.aFilesToUpload[a].url+"'",FolderId:"'"+t.folderId+"'",GroupId:"'"+t.groupId+"'"}})}},createGroupSelectionDialog:function(e,t,a,i,s,o){var n=this;var l=function(e){var a=e.getParameter("value");n.oGroupSelectionDialog.bindAggregation("items","/Groups/?$filter=substringof('"+a.replace(/'/g,"''")+"',Name)",t)};this.oGroupSelectionDialog=new r(e+"_GroupSelectionDialog",{multiSelect:false,noDataText:this.oLangBundle.getText("GRP_NO_GROUPS_FOUND_TEXT"),rememberSelections:false,growingThreshold:this.iGrowingThreshold,title:this.oLangBundle.getText("GROUP_SELECTION_DIALOG_TITLE"),confirm:a,search:l,liveChange:l}).addStyleClass("sapUiPopupWithPadding");if(i){this.oGroupSelectionDialog.setContentWidth(i.toString()+"px")}if(s){this.oGroupSelectionDialog.setContentHeight(s.toString()+"px")}this.oGroupSelectionDialog.setModel(o);this.oGroupSelectionDialog.bindAggregation("items","/Groups",t);return this.oGroupSelectionDialog},displaySuccessMessage:function(e){var t=true;if(!(this.bShareBusinessObjShared===true||this.bShareBusinessObjShared===undefined)){t=false}var a=true;if(!(this.bFileUploaded===true||this.bFileUploaded===undefined)){t=false}if(this.bShareError===false){if(t===true&&a===true){this.oCommonUtil.showMessage(this.oLangBundle.getText("SHARING_SUCCESS_MSG",[e]),{width:"20em",autoClose:false});clearInterval(this.IdisplaySuccessMessageIntervalId)}}else{clearInterval(this.IdisplaySuccessMessageIntervalId)}},displayErrorMessage:function(){if(!this.bShareError){var e=this.oLangBundle.getText("SHARING_FAILURE_MSG");this.oCommonUtil.displayError(e)}this.bShareError=true},_checkAuthorizationAndDisplayErrorMessage:function(e){var t=this;if(e==401||e==403){t.oCommonUtil.displayError(t.oLangBundle.getText("SHARE_AUTHORIZATION_FAILURE_MSG"))}else{t.displayErrorMessage()}}});return i});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialprofile/Component", ["sap/base/Log","sap/collaboration/components/utils/CommonUtil","sap/ui/core/UIComponent","sap/m/library","sap/ui/core/mvc/View","sap/ui/core/library","sap/m/Bar","sap/m/Text","sap/m/ResponsivePopover","sap/m/Button"],function(e,t,o,i,n,r,s,a,p,l){"use strict";var h=r.mvc.ViewType;var c=i.PlacementType;var g=o.extend("sap.collaboration.components.socialprofile.Component",{metadata:{version:"1.0",includes:["../resources/css/SocialProfile.css"],aggregations:{},properties:{placement:{type:"sap.m.PlacementType",group:"Misc",defaultValue:c.Auto},memberId:{type:"string",group:"Misc"},memberInfo:{type:"object",group:"Misc"},openingControl:{type:"object",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"380px"},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"300px"}}},_defaultAttributes:{collaborationHostServiceUrl:"/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData",smiServiceUrl:"/sap/opu/odata/sap/SM_INTEGRATION_V2_SRV"},init:function(){o.prototype.init.call(this);this._oCommonUtil=new t;this._oLangBundle=this._oCommonUtil.getLanguageBundle();this._sUserProfileURL;this._sCurrentUserEmail},exit:function(){o.prototype.exit?.call(this)},onBeforeRendering:function(){},onAfterRendering:function(){},open:async function(){try{this._logComponentProperties();this._validateInputParameters();await this._createView();this._createSocialPopover();this._oPopover.openBy(this.getOpeningControl())}catch(t){e.error(t.stack);this._oCommonUtil.displayError()}},setSettings:function(t){try{if(t){this.setPlacement(t.placement);this.setMemberId(t.memberId);this.setMemberInfo(t.memberInfo);this.setOpeningControl(t.openingControl);this.setHeight(t.height);this.setWidth(t.width)}else{throw new Error("Settings object is undefined")}}catch(t){e.error(t.stack);this._oCommonUtil.displayError()}},_createView:async function(){var e=this;if(!this._oPopoverView){this._oPopoverView=await n.create({id:this.getId()+"_PopoverView",viewData:{collaborationHostServiceUrl:this._defaultAttributes.collaborationHostServiceUrl,smiServiceUrl:this._defaultAttributes.smiServiceUrl,langBundle:this._oLangBundle,memberId:this.getMemberId(),memberInfo:this.getMemberInfo(),popoverPrefix:this.getId(),afterUserInfoRetrieved:function(t){if(t){e._sUserProfileURL=t.WebURL;var o=sap.ui.getCore().byId(e.getId()+"_JamButton");o.setEnabled(true);o.rerender();o.focus()}}},viewName:"module:sap/collaboration/components/socialprofile/SocialProfileView"})}else{this._oPopoverView.getViewData().memberId=this.getMemberId();this._oPopoverView.getViewData().memberInfo=this.getMemberInfo()}return this._oPopoverView},_createSocialPopover:function(){var e=this;if(!this._oPopover){var t=new s(this.getId()+"_HeaderBar",{contentMiddle:new a({text:this._oLangBundle.getText("SP_TITLE")}).addStyleClass("popoverheader")});this._oPopover=new p(this.getId()+"_Popover",{placement:this.getPlacement(),showCloseButton:true,contentHeight:this.getHeight(),contentWidth:this.getWidth(),content:[this._oPopoverView],customHeader:t,beginButton:new l(this.getId()+"_JamButton",{text:this._oLangBundle.getText("SP_OPEN_JAM_BUTTON"),enabled:false,press:function(){window.open(e._sUserProfileURL,"_blank")}}),beforeOpen:function(){if(e._sCurrentUserEmail!==e.getMemberId()){sap.ui.getCore().byId(e.getId()+"_JamButton").setEnabled(false)}e._sCurrentUserEmail=e.getMemberId()}}).addStyleClass("popover")}if(this._oPopover.getPlacement()!==this.getPlacement()){this._oPopover.setPlacement(this.getPlacement())}if(this._oPopover.getContentHeight()!==this.getHeight()){this._oPopover.setContentHeight(this.getHeight())}if(this._oPopover.getContentWidth()!==this.getWidth()){this._oPopover.setContentWidth(this.getWidth())}},_logComponentProperties:function(){e.debug("Social Profile Component properties:","","sap.collaboration.components.socialprofile.Component._logComponentProperties()");e.debug("placement: "+this.getPlacement());e.debug("memberId: "+this.getMemberId());e.debug("openingControl: "+this.getOpeningControl());e.debug("height: "+this.getHeight());e.debug("width: "+this.getWidth())},_validateInputParameters:function(){if(!this.getMemberId()){throw new Error("MemberId is undefined")}if(!this.getOpeningControl()){throw new Error("Opening control is undefined")}}});return g});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialprofile/SocialProfile.controller", ["sap/base/Log","sap/base/security/encodeURL","sap/base/util/isEmptyObject","sap/collaboration/components/utils/CommonUtil","sap/ui/core/mvc/Controller","sap/ui/model/odata/v2/ODataModel","sap/ui/model/json/JSONModel"],function(e,t,i,a,s,r,o){"use strict";return s.extend("sap.collaboration.components.socialprofile.SocialProfile",{onInit:function(){this.getView().getViewData().collaborationHostServiceUrl?this._sJamODataServiceUrl=this.getView().getViewData().collaborationHostServiceUrl:this._sJamODataServiceUrl="/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData";this.getView().getViewData().smiServiceUrl?this._sSMIODataServiceUrl=this.getView().getViewData().smiServiceUrl:this._sSMIODataServiceUrl="/sap/opu/odata/sap/SM_INTEGRATION_V2_SRV";this._oCommonUtil=new a;this._sPrefixId=this.getView().getId();this._sJamURL="";this._sJamUserId="";this._sPopoverPrefix=this.getView().getViewData().popoverPrefix;this._fnUserInfoFetchedCallback=this.getView().getViewData().afterUserInfoRetrieved;this._initializeModels()},onBeforeRendering:function(){if(this._memberId!==this.getView().getViewData().memberId){this.getView().resetHeader();this._clearViewData();this._memberId=this.getView().getViewData().memberId;var e=this.getView().getViewData().memberInfo;if(i(e)){this._getMember()}else{this._setMember(e);if(this._fnUserInfoFetchedCallback){this._fnUserInfoFetchedCallback(e)}}}},_initializeModels:function(){var e=true;this._oJamODataModel=new r(this._sJamODataServiceUrl,e);this._oJSONModel=new o({});this.getView().setModel(this._oJSONModel)},_getMember:function(){var t=this;this._oJamODataModel.metadataLoaded().then(()=>{if(this._oSocialProfileRequest){this._oSocialProfileRequest.abort()}var a="Members_FindByEmail";var s={};s.urlParameters={Email:"'"+t._memberId+"'",$expand:"MemberProfile/PhoneNumbers",$select:"Id,FullName,Title,Email,WebURL,MemberProfile"};s.success=function(e,a){var s=t._oCommonUtil.getODataResult(e);if(!i(s)){var r=s.MemberProfile.PhoneNumbers.results;var o=r.length;for(var l=0;l<o;l++){if(r[l]["PhoneNumberType"]==="Work"){s.MemberProfile.WorkPhoneNumber=r[l]["PhoneNumber"]}if(r[l]["PhoneNumberType"]==="Mobile"){s.MemberProfile.MobilePhoneNumber=r[l]["PhoneNumber"]}}t._oJSONModel.setData(s);t._sJamUserId=s.Id;var m=t._buildThumbnailImageURL(t._sJamUserId);sap.ui.getCore().byId(t._sPrefixId+"_HeaderUserImage").setSrc(m);if(t._fnUserInfoFetchedCallback){t._fnUserInfoFetchedCallback(s)}}};s.error=function(i){if(i.response&&i.response.statusCode){e.error("SAP Jam request failed at sap.collaboration.components.socialprofile.SocialProfileController._getMember()");t.getView().setHeaderNoUser()}};this._oSocialProfileRequest=this._oJamODataModel.read(a,s)})},_setMember:function(e){var t={UserImage:e.picture,Id:e.id,FullName:e.fullname,Title:e.title,Email:e.email,MemberProfile:{Address:e.address,WorkPhoneNumber:e.workPhoneNumber,MobilePhoneNumber:e.mobilePhoneNumber}};this._sJamUserId=e.id;this._oJSONModel.setData(t)},_clearViewData:function(){sap.ui.getCore().byId(this._sPrefixId+"_HeaderUserImage").setSrc();sap.ui.getCore().byId(this._sPrefixId+"_FullName").setText();sap.ui.getCore().byId(this._sPrefixId+"_Role").setText();sap.ui.getCore().byId(this._sPrefixId+"_MobileNumber").setText();sap.ui.getCore().byId(this._sPrefixId+"_WorkNumber").setText();sap.ui.getCore().byId(this._sPrefixId+"_Email").setText();sap.ui.getCore().byId(this._sPrefixId+"_CompanyAddress").setText()},_buildThumbnailImageURL:function(e){return this._sJamODataServiceUrl+"/Members('"+t(e)+"')/ThumbnailImage/$value"}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialprofile/SocialProfileView", ["sap/ui/core/mvc/View","sap/m/VBox","sap/m/Label","sap/m/Text","sap/m/Link","sap/m/HBox","sap/m/Image","sap/m/ObjectStatus"],function(e,t,a,s,i,r,d,l){"use strict";return e.extend("sap.collaboration.components.socialprofile.SocialProfileView",{getControllerName:function(){return"sap.collaboration.components.socialprofile.SocialProfile"},createContent:function(e){this._sPrefixId=this.getId();this._oVBox=new t(this._sPrefixId+"_VBox").addStyleClass("vbox");this._createVBoxContent();return this._oVBox},_createVBoxContent:function(){this._oVBox.addItem(this._createHBoxHeader());var e=new a(this._sPrefixId+"_ContactDetailsLabel",{text:this.getViewData().langBundle.getText("SP_CONTACT_DETAILS_LABEL")}).addStyleClass("heading");var t=new s(this._sPrefixId+"_MobileNumber",{text:"{/MemberProfile/MobilePhoneNumber}"});var r=new a(this._sPrefixId+"_MobileLabel",{text:this.getViewData().langBundle.getText("SP_MOBILE_LABEL"),labelFor:t.getId()}).addStyleClass("label");var d=new s(this._sPrefixId+"_WorkNumber",{text:"{/MemberProfile/WorkPhoneNumber}"});var l=new a(this._sPrefixId+"_WorkLabel",{text:this.getViewData().langBundle.getText("SP_WORK_LABEL"),labelFor:d.getId()}).addStyleClass("label");var o=new i(this._sPrefixId+"_Email",{text:"{/Email}",press:function(){this.setHref("mailto:"+this.getText())}});var n=new a(this._sPrefixId+"_EmailLabel",{text:this.getViewData().langBundle.getText("SP_EMAIL_LABEL"),labelFor:o.getId()}).addStyleClass("label");var _=new a(this._sPrefixId+"_CompanyDetailsLabel",{text:this.getViewData().langBundle.getText("SP_COMPANY_DETAILS_LABEL")}).addStyleClass("heading");var x=new s(this._sPrefixId+"_CompanyAddress",{text:"{/MemberProfile/Address}"});var I=new a(this._sPrefixId+"_CompanyAddressLabel",{text:this.getViewData().langBundle.getText("SP_COMPANY_ADDRESS_LABEL"),labelFor:x.getId()}).addStyleClass("label");this._oVBox.addItem(e).addItem(r).addItem(t).addItem(l).addItem(d).addItem(n).addItem(o).addItem(_).addItem(I).addItem(x)},_createHBoxHeader:function(){var e=new t(this._sPrefixId+"_HeaderVBox").addStyleClass("headervbox");var a=new s(this._sPrefixId+"_FullName",{text:"{/FullName}",width:"200px",maxLines:1}).addStyleClass("fullname");var i=new s(this._sPrefixId+"_Role",{text:"{/Title}",width:"200px",maxLines:1}).addStyleClass("role");e.addItem(a).addItem(i);var o=new r(this._sPrefixId+"_HeaderHBox",{height:"48px"});var n=new d(this._sPrefixId+"_HeaderUserImage",{src:"{/UserImage}",alt:"{/FullName}",width:"48px",height:"48px"}).addStyleClass("image");var _=new l(this._sPrefixId+"_NoUserHeader",{text:this.getViewData().langBundle.getText("SP_NO_USER"),state:"Warning",icon:"sap-icon://alert",visible:false});o.addItem(n).addItem(e).addItem(_);return o},resetHeader:function(){var e=sap.ui.getCore().byId(this._sPrefixId+"_NoUserHeader");if(e.getVisible()===true){e.setVisible(false);sap.ui.getCore().byId(this._sPrefixId+"_HeaderVBox").setVisible(true);sap.ui.getCore().byId(this._sPrefixId+"_HeaderUserImage").setVisible(true)}},setHeaderNoUser:function(){var e=sap.ui.getCore().byId(this._sPrefixId+"_HeaderUserImage");if(e.getVisible()===true){e.setVisible(false);sap.ui.getCore().byId(this._sPrefixId+"_HeaderVBox").setVisible(false);sap.ui.getCore().byId(this._sPrefixId+"_NoUserHeader").setVisible(true)}}})});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP AG. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/Component", ["sap/base/Log","sap/base/util/isEmptyObject","../controls/FilterPopover","../controls/ReplyPopover","../controls/SocialTextArea","./controls/TimelineItemEmbedded","./datahandlers/JamDataHandler","./datahandlers/SMIntegrationDataHandler","./datahandlers/ServiceDataHandler","./datahandlers/TimelineDataHandler","./filter/FilterType","./validation/InputValidator","../utils/CommonUtil","../utils/DateUtil","sap/suite/ui/commons/library","sap/suite/ui/commons/Timeline","sap/suite/ui/commons/TimelineItem","sap/ui/core/CustomData","sap/ui/core/library","sap/ui/core/Item","sap/ui/core/UIComponent","sap/ui/model/json/JSONModel","sap/ui/model/odata/ODataModel","sap/m/Button","sap/m/library","sap/m/Link","sap/m/Popover","sap/m/ResponsivePopover","sap/m/SelectList","sap/m/StandardListItem"],function(e,t,i,o,s,n,a,r,l,d,u,_,h,c,m,g,p,f,T,b,y,v,I,C,P,S,D,E,B,F){"use strict";var x=T.MessageType;var A=P.ButtonType;var O=P.PlacementType;var M=m.TimelineAxisOrientation;var w=m.TimelineAlignment;var L=y.extend("sap.collaboration.components.socialtimeline.Component",{metadata:{version:"1.0",includes:["../resources/css/SocialTimeline.css"],dependencies:{libs:["sap.collaboration"],components:[],ui5version:""},config:{},customizing:{},rootView:null,publicMethods:["setBusinessObject","setBusinessObjectKey","setBusinessObjectMap","updateTimelineEntry","deleteTimelineEntry"],aggregations:{},properties:{enableSocial:{type:"boolean",group:"Social",defaultValue:true},alignment:{type:"sap.suite.ui.commons.TimelineAlignment",group:"Misc",defaultValue:w.Right},axisOrientation:{type:"sap.suite.ui.commons.TimelineAxisOrientation",group:"Misc",defaultValue:M.Vertical},noDataText:{type:"string",group:"Misc",defaultValue:null},showIcons:{type:"boolean",group:"Misc",defaultValue:true},visible:{type:"boolean",group:"Appearance",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},customFilter:{type:"object[]",group:"Social"}},events:{customActionPress:{}}},_defaultAttributes:{collaborationHostServiceUrl:"/sap/bc/ui2/smi/rest_tunnel/Jam/api/v1/OData",smiServiceUrl:"/sap/opu/odata/sap/SM_INTEGRATION_V2_SRV",pageSize:10,jamOnly:false},init:function(){this._oLogger=e.getLogger("sap.collaboration.components.socialtimeline.Component");this._oCollaborationHostModel;this._oSMIntegrationModel;this._oTimeline;this._oTimelineModelData={enableSocial:true,alignment:w.Right,axisOrientation:M.Vertical,enableBackendFilter:true,enableScroll:true,forceGrowing:true,noDataText:null,showIcons:true,sort:true,visible:true,width:"100%",timelineData:[],suggestions:[]};this._oTimelineModel=new v(this._oTimelineModelData);this._oTimelineModel.setSizeLimit(1e4);this._oTimelineModel.bindProperty("/enableSocial").attachChange(this._onEnableSocialChange,this);this._iGrowingThreshold=this._defaultAttributes.pageSize;this._oFilterIcon;this._oContextSelect;this._oAddPostButton;this._oBusinessObjectMap={};this._oBusinessObject={};this._oCommonUtil=new h;this._oDateUtil=new c;this._oLanguageBundle=this._oCommonUtil.getLanguageBundle();this._oTimelineDataHandler;this._oJamDataHandler;this._oSMIntegrationDataHandler;this._oFilterPopover;this._oFilterConstants=new u;this._oFilter={};this._oRepliesData;this._oReplyPopover;this._oAddPostPopover;this._oSocialProfile;this._oTimelineUser={};this._oInputValidator;this._oGettingTimelineData;this._initialize();this._oInputValidator=new _(this);y.prototype.init.apply(this)},exit:function(){if(this._oTimeline){this._oTimeline.destroy()}if(this._oAddPostPopover){this._oAddPostPopover.destroy()}if(this._oReplyPopover){this._oReplyPopover.destroy()}if(this._oFilterPopover){this._oFilterPopover.destroy()}if(this._oSocialProfile){this._oSocialProfile.destroy()}if(this._oInputValidator){this._oInputValidator.destroy()}if(this._oFilterIcon){this._oFilterIcon.destroy()}if(this._oContextSelect){this._oContextSelect.destroy()}if(this._oAddPostButton){this._oAddPostButton.destroy()}},onBeforeRendering:function(){if(this._oInputValidator.areSocialFeaturesEnabled()===true){if(!this._oBusinessObject.key||this._oBusinessObject.key===""){this._oTimeline._filterIcon.setEnabled(false);this._oContextSelect.setEnabled(false)}}else{if(!this._oBusinessObject.key||this._oBusinessObject.key===""){this._oTimeline._filterIcon.setEnabled(false)}this._oContextSelect.setVisible(false);this._oAddPostButton.setVisible(false)}this._getLoggedInUser();this._bindTemplates()},onAfterRendering:function(){},createContent:function(){return this._createTimeline()},setProperty:function(e,t){y.prototype.setProperty.call(this,e,t);this._oLogger.info(e+": "+t);switch(e){case"enableSocial":var i=t;if(i===true){i=this._oInputValidator.validateEnableSocial()}this._oTimelineModel.setProperty("/"+e,i);break;case"customFilter":var o=t;this._oInputValidator.validateCustomFilter();if(o&&o.length!==0){this._oTimeline.setCustomFilter(this._getFilter());this._oTimeline._filterIcon.setEnabled(true)}else{this._oTimeline._filterIcon.setEnabled(false)}break;default:this._oTimelineModel.setProperty("/"+e,t);break}},setSettings:function(e){for(var t in e){if(e.hasOwnProperty(t)){this.setProperty(t,e[t])}}},setBusinessObjectMap:function(e){this._oLogger.info("servicePath: "+e.servicePath);this._oLogger.info("collection: "+e.collection);this._oLogger.info("applicationContext: "+e.applicationContext);this._oBusinessObjectMap=e;this._validateBusinessObjectMap();this._defaultAttributes.jamOnly=t(this._oBusinessObjectMap.serviceModel);var i;var o;if(this._defaultAttributes.jamOnly){this._oFilter={type:this._oFilterConstants.FILTER_TYPE.feedUpdates};this._oContextSelect.setVisible(false);this._oTimeline._filterIcon.setVisible(false)}else{this._oContextSelect.setVisible(true);this._oTimeline._filterIcon.setVisible(true);i=this._oInputValidator.createTermsUtilityForBackend(this._oBusinessObjectMap.serviceModel);o=new l(this._oBusinessObjectMap.serviceModel,i)}this._oTimelineDataHandler=new d(this._oBusinessObjectMap,this._oJamDataHandler,this._oSMIntegrationDataHandler,o,i,this._iGrowingThreshold,this._oInputValidator.areSocialFeaturesEnabled(),this._oInputValidator.areBackendFeaturesEnabled())},setBusinessObjectKey:function(e){this._oLogger.info("Business Object Key: "+e);if(!this._oTimelineDataHandler){this._oLogger.error("Function setBusinessObjectMap must be called before calling setBusinessObjectKey for the first time.")}this._oTimeline._filterIcon.setEnabled(true);this._oAddPostButton.setEnabled(false);this._oContextSelect.setEnabled(true);this._oBusinessObject={key:e,name:e};this._oTimelineDataHandler.setBusinessObject(this._oBusinessObject);if(!this._defaultAttributes.jamOnly){this._resetFilterAndContextSelector()}this._refreshTimelineModel()},setBusinessObject:function(e){this._oBusinessObject=e;this._oLogger.info("Business Object Key: "+this._oBusinessObject.key);this._oLogger.info("Business Object Name: "+this._oBusinessObject.name);if(!this._oTimelineDataHandler){this._oLogger.error("Function setBusinessObjectMap must be called before calling setBusinessObject for the first time.")}this._validateBusinessObject();if(this._defaultAttributes.jamOnly){this._oAddPostButton.setEnabled(true)}else{this._oTimeline._filterIcon.setEnabled(true);this._oAddPostButton.setEnabled(false);this._oContextSelect.setEnabled(true);this._oTimelineDataHandler.setBusinessObject(this._oBusinessObject)}if(!this._defaultAttributes.jamOnly){this._resetFilterAndContextSelector()}this._refreshTimelineModel()},updateTimelineEntry:function(e,t){var i=sap.ui.getCore().byId(t);var o=i.getAggregation("embeddedControl");var s=o._oFlexbox.getItems();s[0].setText(e);if(s.length>1){for(var n=1;n<s.length;n++){s[n].destroy()}}var a=i.getModel();var r=this._oTimeline.getContent().indexOf(i);a.getData().timelineData[r].timelineItemData.text=e;a.getData().timelineData[r].timelineItemData.timelineEntryDetails=[]},deleteTimelineEntry:function(e){var t=sap.ui.getCore().byId(e);var i=t.getModel();var o=this._oTimeline.getContent().indexOf(t);i.getData().timelineData.splice(o,1);t.destroy()},_initialize:function(){var e=true;if(!this._oCollaborationHostModel){this._oCollaborationHostModel=new I(this._defaultAttributes.collaborationHostServiceUrl,e)}if(!this._oSMIntegrationModel){this._oSMIntegrationModel=new I(this._defaultAttributes.smiServiceUrl,e)}if(!this._oJamDataHandler){this._oJamDataHandler=new a(this._oCollaborationHostModel)}if(!this._oSMIntegrationDataHandler){this._oSMIntegrationDataHandler=new r(this._oSMIntegrationModel)}},_createTimeline:function(){this._oTimeline=new g(this.getId()+"_timeline",{enableSocial:"{/enableSocial}",alignment:"{/alignment}",axisOrientation:"{/axisOrientation}",enableBackendFilter:"{/enableBackendFilter}",enableScroll:"{/enableScroll}",forceGrowing:"{/forceGrowing}",noDataText:"{/noDataText}",showIcons:"{/showIcons}",visible:"{/visible}",width:"{/width}",sort:"{/sort}",data:[],grow:this._onGrow.bind(this)});this._modifyHeaderBar();this._oTimeline.setModel(this._oTimelineModel);return this._oTimeline},_modifyHeaderBar:function(){var e=this._oTimeline.getHeaderBar();var t=e.getContent();this._oFilterIcon=t[t.length-1];this._oContextSelect=this._createContextSelector();e.insertContent(this._oContextSelect,0);this._oAddPostButton=this._createAddPostButton();e.insertContent(this._oAddPostButton,3)},_createContextSelector:function(){var e=function(e){var t=sap.ui.getCore().byId(this.getId()+"_context_select");var i=sap.ui.getCore().byId(this.getId()+"_context_select_popover");if(i==undefined){var o=[];o.push({context_type:this._oFilterConstants.FILTER_TYPE.systemUpdates,context_text:this._oLanguageBundle.getText("ST_CONTEXT_SYSTEM_UPDATES")});o.push({context_type:this._oFilterConstants.FILTER_TYPE.feedUpdates,context_text:this._oLanguageBundle.getText("ST_CONTEXT_DISCUSSION_POSTS")});var s=new v(o);this.setModel(s,"timeline_context");var n=new b({key:"{context_type}",text:"{context_text}"});var a=new B(this.getId()+"_context_select_list",{selectedKey:this._oFilterConstants.FILTER_TYPE.systemUpdates,selectionChange:[this._onContextSelect,this],width:"15rem"});a.bindAggregation("items",{path:"/",template:n});a.setModel(s);i=new D(this.getId()+"_context_select_popover",{placement:O.VerticalPreferedBottom,title:this._oLanguageBundle.getText("ST_CONTEXT_SELECT_HEADER")});i.addContent(a)}i.getContent()[0].setSelectedKey(this._oFilter.type);i.openBy(t)};var t=new C(this.getId()+"_context_select",{icon:"sap-icon://navigation-down-arrow",iconFirst:false,text:this._oLanguageBundle.getText("ST_CONTEXT_SYSTEM_UPDATES"),type:A.Transparent,press:[e,this]});return t},_createAddPostButton:function(){if(this._oAddPostPopover===undefined){this._oAddPostPopover=new E(this.createId("_addPostPopover"),{placement:O.Auto,title:this._oLanguageBundle.getText("ST_ADD_POST_TITLE"),contentWidth:"25rem",contentHeight:"10rem",content:new s(this.createId("social_TextArea"),{height:"10rem",width:"100%",enableNotifyAll:false,liveChange:[function(e){e.getParameter("value").trim()!==""?this.byId("addPost_postButton").setEnabled(true):this.byId("addPost_postButton").setEnabled(false)},this],suggest:[this._onSuggest,this],afterSuggestionClose:[function(){if(this.gettingSuggestions){this.gettingSuggestions.request.abort()}},this]}),endButton:new C(this.createId("addPost_postButton"),{text:this._oLanguageBundle.getText("ST_ADD_POST_BUTTON"),enabled:false,press:[this._onAddPost,this]}),beginButton:new C(this.createId("addPost_atMentionButton"),{text:"@",press:[function(){this.byId("social_TextArea").atMentionsButtonPressed()},this]})}).setInitialFocus(this.byId("social_TextArea"))}var e=new C(this.createId("_addPostButton"),{icon:"sap-icon://add",type:A.Transparent,enabled:false,press:[function(){this._oAddPostPopover.openBy(this.byId("_addPostButton"))},this]});return e},_refreshTimelineModel:function(){var e=this;this._oTimeline.setBusyIndicatorDelay(0).setBusy(true);this._oGettingTimelineData=this._oTimelineDataHandler.getTimelineData(this._oFilter,this._defaultAttributes.jamOnly?this._oBusinessObject:null).then(async function(t){e._oTimeline.setBusy(false);e._oFilter.text===undefined||e._oFilter.text===e._oLanguageBundle.getText("ST_FILTER_ALL")?e._oTimeline.setCustomMessage(""):e._oTimeline.setCustomMessage(e._oLanguageBundle.getText("ST_FILTER_TEXT")+" "+e._oFilter.text);e._oTimeline.destroyContent();e._oTimelineModelData.timelineData=t;e._oTimelineModel.setData(e._oTimelineModelData);await e._setReplies()},function(t){e._oCommonUtil.displayError();e._oTimeline.setBusy(false)})},_bindTemplates:function(){if(this._oTimeline.getBinding("content").getPath()!=="/timelineData"){var e=new f({key:"{key}",value:"{value}"});var t=new p({dateTime:"{timelineItemData/dateTime}",userName:"{timelineItemData/userName}",title:"{timelineItemData/title}",icon:"{timelineItemData/icon}",filterValue:"{timelineItemData/filterValue}",userNameClickable:"{/enableSocial}",userNameClicked:this._onUserNameClicked,userPicture:"{timelineItemData/userPicture}",embeddedControl:this._createEmbeddedControl(),customAction:{template:e,path:"timelineItemData/customActionData"},customActionClicked:this._onCustomActionClicked.bind(this),replyCount:"{timelineItemData/replyCount}",replyListOpen:this._onReplyListOpen.bind(this)});this._oTimeline.bindAggregation("content",{path:"/timelineData",template:t})}},_createEmbeddedControl:function(e){var t=e===undefined?"{}":e;var i=new n({timelineItem:t,expandCollapseClick:[function(){this._oTimeline.adjustUI()},this],atMentionClick:[this._getAtMentionClicked,this]});return i},_getFilter:function(){var e=this.getCustomFilter();var t=e.length;for(var o=0;o<t;o++){e[o].type=this._oFilterConstants.FILTER_TYPE.custom}var s=[{text:this._oLanguageBundle.getText("ST_FILTER_ALL"),type:this._oFilterConstants.FILTER_TYPE.systemUpdates}].concat(e);if(!this._oFilterPopover){var n=new v({filter:s});var a=new F({title:"{text}"});this._oFilterPopover=new i(this.getId()+"_filterPopover",{title:this._oLanguageBundle.getText("ST_FILTER_HEADER"),selectionChange:[function(e){this._oFilter=e.getParameter("listItem").getBindingContext().getObject();this._oTimelineDataHandler.reset();this._refreshTimelineModel()},this]}).setModel(n).bindItems("/filter",a);this._oFilterPopover.setSelectedItem(this._oFilterPopover.getItems()[0])}else{this._oFilterPopover.getModel().setProperty("/filter",s)}return this._oFilterPopover},_resetFilterAndContextSelector:function(){this._resetFilter();this._oContextSelect.setText(this._oLanguageBundle.getText("ST_CONTEXT_SYSTEM_UPDATES"))},_resetFilter:function(){this._oTimelineModel.setProperty("/sort",true);this._oFilter={type:this._oFilterConstants.FILTER_TYPE.systemUpdates};if(this._oFilterPopover){this._oFilterPopover.setSelectedItem(this._oFilterPopover.getItems()[0])}},_setReplies:async function(){var e=this;var t=this._oTimeline.getContent();for(const o of t){var i=o.getBindingContext().getObject();if(!i._feedEntryData){e._hideReply(o)}else{const t=await e._createReplyPopover();o.setCustomReply(t)}}},_hideReply:function(e){e._replyLink.setVisible(false)},_showSocialProfile:function(e,t,i){if(e){var o=e.getParent().getParent().getParent();if(!o._oSocialProfile){o._oSocialProfile=sap.ui.getCore().createComponent({name:"sap.collaboration.components.socialprofile",id:this.getId()+"_socialProfile"});o._oSocialProfile._defaultAttributes=o._defaultAttributes}var s={openingControl:t,memberId:i};o._oSocialProfile.setSettings(s);o._oSocialProfile.open()}},_getFeedId:function(e){var t=e.getBindingContext().getPath();var i=t.split("/");var o=i[i.length-1];var s=e.getModel().getData().timelineData[o]._feedEntryData.Id;return s},_getLoggedInUser:function(){var e=this;var t=this._oJamDataHandler.getSender();t.promise.done(function(t,i){e._oTimelineUser=t});t.promise.fail(function(t){e._oLogger.error("Failed to get the sender",t.stack)})},_addTimelineItemToTimeline:async function(e){var t=this._oTimeline.getModel().getData();t.timelineData.push(e);var i=new p({dateTime:e.timelineItemData.dateTime,userName:e.timelineItemData.userName,title:e.timelineItemData.title,text:e.timelineItemData.text,icon:e.timelineItemData.icon,userNameClickable:true,userNameClicked:this._onUserNameClicked,userPicture:e.timelineItemData.userPicture,embeddedControl:this._createEmbeddedControl(e),replyCount:e.timelineItemData.replyCount,replyListOpen:this._onReplyListOpen.bind(this),customReply:this._createReplyPopover()});await this._oReplyPopover.fullyCreated();this._oTimeline.insertContent(i,0);var o=t.timelineData.indexOf(e);var s=i.getParent().getModel().createBindingContext("/timelineData/"+o);i.setBindingContext(s)},_validateInputParameters:function(){this._oInputValidator=new _(this);if(!this._oInputValidator.areCustomFiltersValid()){this.destroy()}return this._oInputValidator},_validateBusinessObjectMap:function(){if(!this._oInputValidator){this._validateInputParameters()}if(!this._oInputValidator.isBusinessObjectMapValid(this._oBusinessObjectMap)){this.destroy()}},_validateBusinessObject:function(){if(!this._oInputValidator){this._validateInputParameters()}if(!this._oInputValidator.isBusinessObjectValid(this._oBusinessObject)){this.destroy()}},_onContextSelect:function(e){var t=e.getParameter("selectedItem");this._oFilter={type:t.getKey()};if(t.getKey()==this._oFilterConstants.FILTER_TYPE.feedUpdates){this._oTimelineModel.setProperty("/sort",false);this._oFilterIcon.setEnabled(false);this._oAddPostButton.setEnabled(true)}else{if(!this._defaultAttributes.jamOnly){this._resetFilter()}this._oFilterIcon.setEnabled(true);this._oAddPostButton.setEnabled(false)}this._oTimelineDataHandler.reset();this._refreshTimelineModel();var i=sap.ui.getCore().byId(this.getId()+"_context_select_popover");i.close();this._oContextSelect.setText(t.getText())},_onGrow:function(){var e=this;if(!this._oGettingTimelineData||this._oGettingTimelineData.state()!="pending"){this._oGettingTimelineData=this._oTimelineDataHandler.getTimelineData(this._oFilter).then(async function(t){var i=e._oTimelineModel.getData();i.timelineData=i.timelineData.concat(t);e._oTimelineModel.setData(i);await e._setReplies()},function(t){e._oCommonUtil.displayError()})}else{this._oLogger.info("A previous request is still pending.")}},_onUserNameClicked:function(e){var t=e.getSource().getParent().getParent();var i=e.getSource().getParent();var o=e.getSource();if(!t._oSocialProfile){t._oSocialProfile=sap.ui.getCore().createComponent({name:"sap.collaboration.components.socialprofile",id:this.getId()+"_socialProfile"});t._oSocialProfile._defaultAttributes=t._defaultAttributes}var s=i.getContent().indexOf(o);var n={openingControl:o._userNameLink,memberId:i.getModel().getData().timelineData[s].timelineItemData.userEmail};t._oSocialProfile.setSettings(n);t._oSocialProfile.open()},_onAddPost:function(e){var t=this;var i=this.byId("social_TextArea").convertTextWithFullNamesToEmailAliases();this.byId("_addPostPopover").close();if(i&&i.trim()!==""){this._oTimeline.setBusyIndicatorDelay(0).setBusy(true);this._oJamDataHandler.addPostToExternalObject(i,this._oTimelineDataHandler.getCurrentExternalBO()).then(async function(e){t.byId("social_TextArea").clearText();t.byId("addPost_postButton").setEnabled(false);if(t._oFilter.type!==t._oFilterConstants.FILTER_TYPE.systemUpdates&&t._oFilter.type!==t._oFilterConstants.FILTER_TYPE.custom){var i=t._oTimelineDataHandler._mapFeedEntriesToTimelineItems([e])[0];await t._addTimelineItemToTimeline(i);if(!t._oTimelineDataHandler.getUserInfoFromBuffer(e.Creator.Email)){t._oTimelineDataHandler.addUserInfoToBuffer(e.Creator)}}}).always(function(){t._oTimeline.setBusy(false)}).fail(function(){t._oCommonUtil.displayError(t._oLanguageBundle.getText("ST_POST_TO_JAM_FAILED"))})}else{this._oLogger.info("Posting an empty comment is not allowed, no feed entry will be created.")}},_onSuggest:function(e){var t=this;if(this.gettingSuggestions){this.gettingSuggestions.request.abort()}var i=e.getSource();var o=e.getParameter("value");if(o.trim()===""){i.showSuggestions([])}else{this.gettingSuggestions=this._oJamDataHandler.getSuggestions(o);this.gettingSuggestions.promise.done(function(e,o){var s=e.results;if(s.length===0){i.closeSuggestionPopover()}else{var n=[];for(var a=0;a<s.length;a++){n.push({fullName:s[a].FullName,email:s[a].Email,userImage:t._buildThumbnailImageURL(s[a].Id)})}i.showSuggestions(n)}});this.gettingSuggestions.promise.fail(function(e){if(e.response&&e.response.statusCode){t._oCommonUtil.displayError(t._oLanguageBundle.getText("ST_GET_SUGGESTIONS_FAILED"))}})}},_onCustomActionClicked:function(e){var t={};var i=e.getSource().getBindingContext();var o=i.getPath();var s=e.getSource().getModel().getProperty(o+"/timelineItemData/customActionData/oDataEntry");t.oDataEntry=s;t.timelineEntryId=e.getParameters().id;t.key=e.getParameters().key;this.fireCustomActionPress(t)},_getAtMentionClicked:function(e){var t=this;var i=[];var o=e.getSource();var s=e.getParameter("link");var n=this._oJamDataHandler.getAtMentions(s.getModel().getData().feedId);n.promise.done(function(e,n){var a=s.getModel().getProperty("/placeholderIndex");i=e.results;t._showSocialProfile(o,s,i[a].Email)});n.promise.fail(function(){t._oLogger.error("Failed to retrieve the @mentions.");t._oCommonUtil.displayError(t._oCommonUtil.getLanguageBundle().getText("ST_GET_ATMENTIONS_FAILED"))})},_onReplyListOpen:function(e){if(!this._bReplyPopoverIsOpen){this._bReplyPopoverIsOpen=true;var t=e.getSource();try{var i=this._getFeedId(t);if(!i){throw new Error("Failed to get the feed entry ID.")}}catch(e){this._oLogger.error("Failed to get the feed entry ID");this._oCommonUtil.displayError(this._oLanguageBundle.getText("ST_GET_REPLIES_FAILED"));return}this._getReplies(i,undefined,t)}},_getReplies:function(e,t,i){var o=this;i.getCustomReply().setBusyIndicatorDelay(0).setBusy(true);this.gettingReplies=this._oJamDataHandler.getReplies(e,t);this.gettingReplies.promise.done(function(e,t){o._oRepliesData=e;var s=e.results.reverse();s.forEach(function(e){e.Creator.ThumbnailImage=o._oTimelineDataHandler.buildImageUrl(e.Creator);e.CreatedAt=o._oDateUtil.formatDateToString(e.CreatedAt)});i.getCustomReply().addReplies({data:s,more:o._oRepliesData.__next?true:false});i.getCustomReply().setBusy(false)});this.gettingReplies.promise.fail(function(e){if(e.response&&e.response.statusCode){o._oCommonUtil.displayError(o._oCommonUtil.getLanguageBundle().getText("ST_GET_REPLIES_FAILED"))}})},_createReplyPopover:async function(){this._oReplyPopover=new o({socialTextArea:new s({height:"80px",width:"100%",enableNotifyAll:false,suggestionPlacement:O.Top,suggest:[this._onSuggest,this],afterSuggestionClose:[function(){if(this.gettingSuggestions){this.gettingSuggestions.request.abort()}},this]}),postReplyPress:[this._onPostReplyPress,this],moreRepliesPress:[function(e){var t=e.getSource().getParent();if(this._oRepliesData.__next){this._getReplies(undefined,this._oRepliesData.__next,t)}},this],afterClose:[function(e){if(this.gettingReplies){this.gettingReplies.request.abort()}this._bReplyPopoverIsOpen=false},this]});await this.oReplyPopover.fullyCreated();this._oReplyPopover.getSocialTextArea().attachLiveChange(function(e){e.getParameter("value").trim()!==""?this.enableButton(true):this.enableButton(false)}.bind(this._oReplyPopover));return this._oReplyPopover},_onPostReplyPress:function(e){var t=this;var i=e.getParameter("value");var o=e.getSource().getParent();var s=o.getBindingContext().getObject();var n=s.timelineItemData.feedId;var a=o.getCustomReply();a.setBusyIndicatorDelay(0).setBusy(true);var r=this._oJamDataHandler.postReply(n,i);a._oReplyTextArea.focus();r.promise.done(function(e,i){a.getTextArea().clearText();a.enableButton(false);var s={Text:e.results.Text,Creator:{Email:t._oTimelineUser.Email,FullName:t._oTimelineUser.FullName},CreatedAt:t._oDateUtil.formatDateToString(e.results.CreatedAt)};var n=t._oTimelineDataHandler.getUserPicture(t._oTimelineUser.Email);n?s.Creator.ThumbnailImage=n:s.Creator.ThumbnailImage=t._oTimelineDataHandler.buildImageUrl(e.results);a.addReply(s);a.setBusy(false);o.setReplyCount(o.getReplyCount()+1)});r.promise.fail(function(e){a.setBusy(false);t._oCommonUtil.displayError(t._oLanguageBundle.getText("ST_POST_REPLY_FAILED"))})},_onEnableSocialChange:function(e){var t=e.getSource().getValue();t===true?this._oAddPostButton.setVisible(true):this._oAddPostButton.setVisible(false)},_showFeedUpdatesInTimeline:function(e){var t=this._oTimeline.getMessageStrip();if(e>0){if(!this.byId("refreshLink")){var i=new S(this.createId("refreshLink"),{text:this._oLanguageBundle.getText("GF_REFRESH_FEED"),press:[function(){this._hideFeedUpdatesInTimeline();this._oTimelineDataHandler.reset();this._refreshTimelineModel()},this]});t.setLink(i);t.setType(x.Information);t.setShowIcon(true)}e==1?t.setText(this._oLanguageBundle.getText("GF_NEW_FEED_UPDATE")):t.setText(this._oLanguageBundle.getText("GF_NEW_FEED_UPDATES",[e]));t.setVisible(true);this._oTimeline.rerender()}},_hideFeedUpdatesInTimeline:function(){var e=this._oTimeline.getMessageStrip();e.close()},_startAutoCheckingForNewUpdates:function(){this._iNewFeedUpdatesCheckerTimeDelay=12e4;this._sNewFeedUpdatesCheckerTimeoutId=setTimeout(this._checkForNewFeedUpdates.bind(this),this._iNewFeedUpdatesCheckerTimeDelay)},_stopAutoCheckingForNewUpdates:function(){clearTimeout(this._sNewFeedUpdatesCheckerTimeoutId)},_checkForNewFeedUpdates:function(){var e=function(e,t){this._showFeedUpdatesInTimeline(e);this._sNewFeedUpdatesCheckerTimeoutId=setTimeout(this._checkForNewFeedUpdates.bind(this),this._iNewFeedUpdatesCheckerTimeDelay)};var t=function(e){this._oLogger.error("Failed to check for new feed updates.");this._sNewFeedUpdatesCheckerTimeoutId=setTimeout(this._checkForNewFeedUpdates.bind(this),this._iNewFeedUpdatesCheckerTimeDelay)};var i=this._oTimeline.getContent()[0];var o=i?i.getBindingContext().getObject()._feedEntryData.TopLevelId:"";var s=this._oTimelineDataHandler.getCurrentExternalBO().Id;this._oJamDataHandler.getFeedUpdatesLatestCount(o,s).done(e.bind(this)).fail(t.bind(this))},_buildThumbnailImageURL:function(e){return this._defaultAttributes.collaborationHostServiceUrl+"/Members('"+e+"')/ThumbnailImage/$value"}});return L});
/*
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/annotations/Metadata", ["sap/ui/base/Object"],function(e){"use strict";var a=e.extend("sap.collaboration.components.socialtimeline.annotations.Metadata",{constructor:function(e){this._oIncludedSchemaAliasMap={};this._oSchemaAliasMap={};this._oODataMetadata=e;this._parseODataMetadata()},_parseODataMetadata:function(){this._parseReferenceElements(this._oODataMetadata.extensions);this._parseDataServicesElement(this._oODataMetadata.dataServices)},_parseReferenceElements:function(e){for(var a in e){this._parseReferenceElement(e[a])}},_parseReferenceElement:function(e){for(var a in e.children){this._parseReferenceElementChild(e.children[a])}},_parseReferenceElementChild:function(e){if(e.name==="Include"){this._parseIncludeElement(e)}else{return}},_parseIncludeElement:function(e){var a=null;var t=null;for(var n in e.attributes){if(e.attributes[n].name==="Namespace"){a=e.attributes[n].value}else{t=e.attributes[n].value}}this._oIncludedSchemaAliasMap[a]=t},_parseDataServicesElement:function(e){this._parseSchemaElements(e.schema)},_parseSchemaElements:function(e){for(var a in e){this._parseSchemaElement(e[a])}},_parseSchemaElement:function(e){if(e.alias===undefined){this._oSchemaAliasMap[e.namespace]=null}else{this._oSchemaAliasMap[e.namespace]=e.alias}this._parseEntityTypeElements(e.entityType)},_parseEntityTypeElements:function(e){for(var a in e){this._parseEntityTypeElement(e[a])}},_parseEntityTypeElement:function(){},isSchemaIncluded:function(e){return this._oIncludedSchemaAliasMap[e]!==undefined}});return a});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/annotations/MetadataException", ["sap/ui/base/Object"],function(t){"use strict";var a=t.extend("sap.collaboration.components.socialtimeline.annotations.MetadataException",{constructor:function(t){this._sClassName="sap.collaboration.components.socialtimeline.annotations.MetadataException";this._sExceptionMessage=t}});return a});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP AG. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/annotations/TimelineTermsUtility", ["sap/base/Log","./MetadataException","sap/ui/base/Object"],function(t,i,e){"use strict";var n=e.extend("sap.collaboration.components.socialtimeline.annotations.TimelineTermsUtility",{constructor:function(e,n){this._oLogger=t.getLogger("sap.collaboration.components.socialtimeline.annotations.TimelineTermsUtility");this._oServiceMetadata=e;this._oServiceAnnotations=n;this._oEntityMappings={};this.sSchemaNamespace="com.sap.vocabularies.Timeline.v1";var a=this._getIncludedSchema(this.sSchemaNamespace);if(!(a&&a.schemaNamespace===this.sSchemaNamespace)){var s="Schema with namespace "+this.sSchemaNamespace+" wasn't in an Include in the service's metadata document.";this._oLogger.error(s);throw new i(s)}},getTimelineEntryNavigationPath:function(t){if(!t){var i=new Error("Parameter sEntityCollection is undefined");this._oLogger.error(i.message);throw i}var e=this._oEntityMappings[t];if(!e){e=this._buildMapping(t)}return e.timelineEntryNavigationPath},getTimelineEntryFields:function(t){if(!t){var i=new Error("Parameter sEntityCollection is undefined");this._oLogger.error(i.message);throw i}var e=this._oEntityMappings[t];if(!e){e=this._buildMapping(t)}var n=this._oEntityMappings[t].timelineEntryFields;if(!n){var a=this._oServiceAnnotations[e.timelineEntryEntityTypeFull][this.sSchemaNamespace+".TimelineEntry"];if(!a){a=this._oServiceAnnotations[e.timelineEntryEntityTypeFull][this._getCollaborationAlias()+".TimelineEntry"]}n=this._mapEntityFields(a);this._oEntityMappings[t].timelineEntryFields=n}return n},getTimelineEntryDetailFields:function(t){if(!t){var i=new Error("Parameter sEntityCollection is undefined");this._oLogger.error(i.message);throw i}var e=this._oEntityMappings[t];if(!e){e=this._buildMapping(t)}var n=this._oEntityMappings[t].timelineEntryDetailFields;if(!n){var a=this._oServiceAnnotations[e.timelineEntryDetailEntityTypeFull][this.sSchemaNamespace+".TimelineDetailPropertyValueChange"];if(!a){a=this._oServiceAnnotations[e.timelineEntryDetailEntityTypeFull][this._getCollaborationAlias()+".TimelineDetailPropertyValueChange"]}n=this._mapEntityFields(a);this._oEntityMappings[t].timelineEntryDetailFields=n}return n},_buildMapping:function(t){this._oEntityMappings[t]={};this._oEntityMappings[t].entityCollection=t;this._oEntityMappings[t].entityTypeFull=this._getEntityTypeFull(t);this._oEntityMappings[t].namespace=this._oEntityMappings[t].entityTypeFull.split(".")[0];this._oEntityMappings[t].entityType=this._oEntityMappings[t].entityTypeFull.split(".")[1];var i=this._oServiceAnnotations[this._oEntityMappings[t].entityTypeFull][this.sSchemaNamespace+".TimelineNavigationPath"];if(!i){i=this._oServiceAnnotations[this._oEntityMappings[t].entityTypeFull][this._getCollaborationAlias()+".TimelineNavigationPath"]}this._oEntityMappings[t].timelineEntryNavigationPath=i.NavigationPropertyPath;this._oEntityMappings[t].timelineEntryEntityTypeFull=this._getChildEntityTypeFull(this._oEntityMappings[t].entityType,this._oEntityMappings[t].timelineEntryNavigationPath);this._oEntityMappings[t].timelineEntryEntityType=this._oEntityMappings[t].timelineEntryEntityTypeFull.split(".")[1];this._oEntityMappings[t].timelineEntryFields=undefined;var e=this._oServiceAnnotations[this._oEntityMappings[t].timelineEntryEntityTypeFull][this.sSchemaNamespace+".TimelineEntry"];if(!e){e=this._oServiceAnnotations[this._oEntityMappings[t].timelineEntryEntityTypeFull][this._getCollaborationAlias()+".TimelineEntry"]}this._oEntityMappings[t].timelineEntryDetailNavigationPath=e.TimelineDetailNavigationPath.NavigationPropertyPath;this._oEntityMappings[t].timelineEntryDetailEntityTypeFull=this._getChildEntityTypeFull(this._oEntityMappings[t].timelineEntryEntityType,this._oEntityMappings[t].timelineEntryDetailNavigationPath);this._oEntityMappings[t].timelineEntryDetailFields=undefined;return this._oEntityMappings[t]},_getEntityTypeFull:function(t){for(var i=this._oServiceMetadata.dataServices.schema.length-1;i>=0;i--){var e=this._oServiceMetadata.dataServices.schema[i];if(e.entityContainer){var n=e.entityContainer[0].entitySet;for(var a=n.length-1;a>=0;a--){if(n[a].name===t){return n[a].entityType}}}}throw new Error("Entity collection '"+t+"' could not be found in service")},_getChildEntityTypeFull:function(t,i){var e=this._getEntityTypeObject(t);var n=this._getNavigationProperty(e,i);var a=this._getAssociationEnd(n.toRole);return a.type},_getEntityTypeObject:function(t){for(var i=this._oServiceMetadata.dataServices.schema.length-1;i>=0;i--){var e=this._oServiceMetadata.dataServices.schema[i];if(e.entityType){var n=e.entityType;for(var a=n.length-1;a>=0;a--){if(n[a].name===t){return n[a]}}}}throw new Error("Entity Type '"+t+"' could not be found in service")},_getNavigationProperty:function(t,i){if(t.navigationProperty){for(var e=t.navigationProperty.length-1;e>=0;e--){if(t.navigationProperty[e].name===i){return t.navigationProperty[e]}}}throw new Error("Navigation property '"+i+"' could not be found for entity '"+t.name+"'.")},_getAssociationEnd:function(t){for(var i=this._oServiceMetadata.dataServices.schema.length-1;i>=0;i--){var e=this._oServiceMetadata.dataServices.schema[i];if(e.association){for(var n=e.association.length-1;n>=0;n--){for(var a=e.association[n].end.length-1;a>=0;a--){if(e.association[n].end[a].role===t){return e.association[n].end[a]}}}}}throw new Error("Association with role '"+t+"' could not be found in service.")},_mapEntityFields:function(t){var i={};for(var e in t){if(t.hasOwnProperty(e)){if(t[e].Path){i[e]=t[e].Path}else if(t[e].PropertyPath){i[e]=t[e].PropertyPath}else if(t[e].EnumMember){i[e]=t[e].EnumMember}else if(t[e].NavigationPropertyPath){i[e]=t[e].NavigationPropertyPath}}}return i},_getCollaborationAlias:function(){var t=this._oServiceAnnotations.aliasDefinitions;for(var i in t){if(t[i].indexOf("com.sap.vocabularies.Timeline.v1")>-1){return i}}},_getIncludedSchema:function(t){var i=0;var e=0;var n=0;var a;var s;var o;var r={schemaNamespace:undefined,schemaAlias:undefined};if(this._oServiceMetadata&&this._oServiceMetadata.extensions){for(i=0;i<this._oServiceMetadata.extensions.length;++i){a=this._oServiceMetadata.extensions[i];for(e=0;e<a.children.length;++e){s=a.children[e];if(s.name=="Include"){for(n=0;n<s.attributes.length;++n){o=s.attributes[n];if(o.name=="Namespace"){r.schemaNamespace=o.value}if(o.name=="Alias"){r.schemaAlias=o.value}}if(r.schemaNamespace==t){return r}}}}return undefined}return undefined}});return n});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/socialtimeline/controls/TimelineItemEmbedded", ["sap/ui/core/Control","sap/collaboration/components/controls/TimelineEntryEmbedded","sap/collaboration/components/controls/FeedEntryEmbedded","sap/collaboration/components/socialtimeline/controls/TimelineItemEmbeddedRenderer"],function(e,t,o,n){"use strict";var i=e.extend("sap.collaboration.components.socialtimeline.controls.TimelineItemEmbedded",{metadata:{interfaces:[],library:"sap.collaboration",properties:{timelineItem:{type:"object",group:"data"}},events:{atMentionClick:{parameters:{link:{type:"object"}}},expandCollapseClick:{}}},renderer:n});i.prototype.init=function(){this._oEmbeddedControl};i.prototype.onBeforeRendering=function(){var e=this.getTimelineItem();if(e._feedEntryData!==undefined){this._oEmbeddedControl=new o({feedEntry:e._feedEntryData,atMentionClick:[this.onAtMentionClicked,this],expandCollapseClick:[this.onExpandCollapseClick,this]})}else{this._oEmbeddedControl=new t({timelineEntry:e.timelineItemData})}};i.prototype.exit=function(){};i.prototype.getEmbeddedControl=function(){return this._oEmbeddedControl};i.prototype.onExpandCollapseClick=function(){this.fireExpandCollapseClick()};i.prototype.onAtMentionClicked=function(e){this.fireAtMentionClick(e.getParameters())};return i});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/socialtimeline/controls/TimelineItemEmbeddedRenderer", [],function(){"use strict";var e={apiVersion:2};e.render=function(e,r){e.renderControl(r.getEmbeddedControl())};return e},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP AG. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/datahandlers/JamDataHandler", ["sap/base/Log","sap/base/security/encodeURL","sap/ui/base/Object","sap/collaboration/components/utils/OdataUtil","sap/ui/thirdparty/jquery"],function(e,r,t,o,jQuery){"use strict";var s=t.extend("sap.collaboration.components.socialtimeline.datahandlers.JamDataHandler",{constructor:function(r){this._oLogger=e.getLogger("sap.collaboration.components.socialtimeline.datahandlers.JamDataHandler");this._oOdataUtil=new o;this._oCollabModel=r;this._oExternalBObuffer={}},_requestsData:{getGroups:{url:function(e){return"/ExternalObjects('"+r(e)+"')/Groups"},urlParameters:function(){return{}},successLog:function(e,r){return"Groups were successfully retrieved."},errorLog:function(e){this._oLogger.error("Failed to retrieve groups: "+e.response.statusText)}},getExternalObjectByExidAndObjectType:{url:function(e,r,t){return t?t:"/ExternalObjects_FindByExidAndObjectType"},urlParameters:function(e,r){return{Exid:"'"+e.replace(/'/g,"''")+"'",ObjectType:"'"+r.replace(/'/g,"''")+"'",$expand:"FeedEntries/Creator"}},successLog:function(e,r){return"External object found: "+e.results.Name},errorLog:function(e){this._oLogger.error(e.response.statusText)}},getFeedEntries:{url:function(e,t){return t?t:"/ExternalObjects"+"('"+r(e)+"')/FeedEntries"},urlParameters:function(){return{$expand:"Creator/MemberProfile"}},successLog:function(e,r){return"Feed entries were successfully retrieved."},errorLog:function(e){this._oLogger.error("Failed to retrieve feed entries: "+e.response.statusText)}},getSuggestions:{url:function(){return"/Members_Autocomplete"},urlParameters:function(e,r){var t={Query:"'"+e+"'",$top:"4"};if(r){t.GroupId="'"+r+"'"}return t},successLog:function(e,r){return""},errorLog:function(e){this._oLogger.error("")}},getAtMentions:{url:function(e){return"/FeedEntries('"+r(e)+"')/AtMentions"},urlParameters:function(){return{}},successLog:function(e,r){return"@mentions were successfully retrieved."},errorLog:function(e){this._oLogger.error("Failed to retrieve the @mentions: "+e.response.statusText,e.stack)}},getReplies:{url:function(e,t){return t?t:"/FeedEntries('"+r(e)+"')/Replies"},urlParameters:function(){return{$orderby:"CreatedAt desc",$expand:"Creator"}},successLog:function(e,r){return"Replies were successfully retrieved."},errorLog:function(e){if(e.response){this._oLogger.error("Failed to retrieve replies: "+e.response.statusText,e.stack)}}}},_doAllTheThings:function(e,r){var t=this;var o=this._requestsData[e];var s=Array.prototype.slice.apply(arguments);s.shift();s.shift();var n=new jQuery.Deferred;var a=function(e,r){t._oLogger.info(o.successLog.apply(t,[e,r]));n.resolve(e,r)};var i=function(e){o.errorLog.apply(t,[e]);n.reject(e)};var u=o.urlParameters.apply(t,s);if(Object.prototype.toString.apply(r)==="[object Object]"){for(var l in r){u[l]=r[l]}}var c={context:null,urlParameters:u,async:true,filters:[],sorters:[],success:a,error:i};return{request:this._oCollabModel.read(o.url.apply(t,s),c),promise:n.promise()}},getGroups:function(e,r,t){return this._doAllTheThings("getGroups",t,e,r)},getExternalObjectByExidAndObjectType:function(e,r){var t=e.ObjectType+e.Exid;this._oExternalBObuffer[t]=e;return this._doAllTheThings("getExternalObjectByExidAndObjectType",null,e.Exid,e.ObjectType,r)},getFeedEntries:function(e,r){return this._doAllTheThings("getFeedEntries",null,e,r)},getSuggestions:function(e,r){return this._doAllTheThings("getSuggestions",null,e,r)},getAtMentions:function(e){return this._doAllTheThings("getAtMentions",null,e)},getReplies:function(e,r){return this._doAllTheThings("getReplies",null,e,r)},getExternalObject:function(e){var r=this;var t=e.ObjectType+e.Exid;var o=jQuery.Deferred();if(!this._oExternalBObuffer[t]){var s=this.postExternalObject(e);s.promise.done(function(e,s){var n=e.results;r._oExternalBObuffer[t]=n;o.resolve(n)});s.promise.fail(function(e){o.reject(e)})}else{o.resolve(this._oExternalBObuffer[t])}return o.promise()},getFeedEntryFromActivity:function(e){var t=this;var o="/Activities('"+r(e)+"')/FeedEntry";var s=jQuery.Deferred();var n=function(e,r){s.resolve(e,r)};var a=function(e){t._oLogger.error("Failed to get the feed entry: "+e.response.statusText);s.reject(e)};var i={urlParameters:{$expand:"Creator"},async:true,success:n,error:a};this._oCollabModel.read(o,i);return s.promise()},getUserInfoBatch:function(e){var t=this;var o=[];e.forEach(function(e){var s="/Members_Autocomplete?Query='"+r(e)+"'&$expand=MemberProfile";var n="GET";var a=null;var i=null;o.push(t._oCollabModel.createBatchOperation(s,n,a,i))});this._oCollabModel.addBatchReadOperations(o);var s=true;var n=true;var a=jQuery.Deferred();var i=function(e,r){var o=t._oOdataUtil.parseBatchResponse(e.__batchResponses);a.resolve(o,r)};var u=function(e){if(e.response.statusCode===403&&n){t._oCollabModel.refreshSecurityToken(function(){n=false;t._oCollabModel.addBatchReadOperations(o);t._oCollabModel.submitBatch(i,u,s)},function(e){t._oLogger.error("Failed to get member information: "+e.response.statusText);a.reject(e)},true)}else{t._oLogger.error("Failed to get member information: "+e.response.statusText);a.reject(e)}};return{request:this._oCollabModel.submitBatch(i,u,s),promise:a.promise()}},getAtMentionsBatch:function(e){var t=this;var o=10;var s=[];e.forEach(function(e,n){if(n<o){var a="/FeedEntries('"+r(e)+"')/AtMentions";var i="GET";var u=null;var l=null;s.push(t._oCollabModel.createBatchOperation(a,i,u,l))}});this._oCollabModel.addBatchReadOperations(s);var n=true;var a=true;var i=new jQuery.Deferred;var u=function(e,r){var o=t._oOdataUtil.parseBatchResponse(e.__batchResponses);i.resolve(o,r)};var l=function(e){if(e.response.statusCode===403&&a){t._oCollabModel.refreshSecurityToken(function(){a=false;t._oCollabModel.addBatchReadOperations(s);t._oCollabModel.submitBatch(u,l,n)},function(e){t._oLogger.error("Failed to get the feeds @mentions: "+e.response.statusText);i.reject(e)},true)}else{t._oLogger.error("Failed to get the feeds @mentions: "+e.response.statusText);i.reject(e)}};return{request:this._oCollabModel.submitBatch(u,l,n),promise:i}},getSender:function(){var e=this;var r="/Self";var t=jQuery.Deferred();var o=function(r,o){e._oLogger.info("The reply was successfully posted.");t.resolve(r.results)};var s=function(r){e._oLogger.error("Failed to retrieve the sender: "+r.response.statusText,r.stack);t.reject(r)};var n={urlParameters:null,async:true,success:o,error:s};return{request:this._oCollabModel.read(r,n),promise:t.promise()}},getGroupFeedEntries:function(e,t){var o=this;var s="";if(t){s=t}else{s="/Groups('"+r(e)+"')/FeedEntries"}var n=jQuery.Deferred();var a=function(r,t){o._oLogger.info("The feed entries for the group '"+e+"' were retrieved.");n.resolve(r,t)};var i=function(r){o._oLogger.error("Failed to get feed entries for the group '"+e+"'.");n.reject(r)};var u={context:null,urlParameters:{$expand:"Group,Creator,TargetObjectReference"},async:true,success:a,error:i};return{request:this._oCollabModel.read(s,u),promise:n.promise()}},getGroupExternalObjectFeedEntries:function(e,t,o){var s=this;var n="";var a=jQuery.Deferred();if(o){n=o}else{n="/GroupExternalObjects(GroupId='"+r(e)+"',ExternalObjectId='"+r(t)+"')/FeedEntries"}var i=function(r,o){s._oLogger.info("The feed entries for the group object wall was retrieved. Group Id is:'"+e+"', External Object Id is:"+t+".");a.resolve(r,o)};var u=function(r){s._oLogger.error("Failed to get feed entries for the group object wall. Group Id is:'"+e+"', External Object Id is:"+t+".");a.reject(r)};var l={context:null,urlParameters:{$expand:"Group,Creator,TargetObjectReference"},async:true,success:i,error:u};return{request:this._oCollabModel.read(n,l),promise:a.promise()}},addPostToExternalObject:function(e,r){var t=this;var o=this.postFeedEntryToObject(r,e).promise.then(function(e,r){var o=e.results;return t.getFeedEntryFromActivity(o.Id)}).then(function(e,r){var t=e.results;return t}).fail(function(e){return e});return o.promise()},postExternalObject:function(e){var r=this;var t="/ExternalObjects";var o=e;var s=jQuery.Deferred();var n=function(e,t){r._oLogger.info("External object created. "+e.results.Name);s.resolve(e,t)};var a=function(e){r._oLogger.error("Failed to create external object: "+e.response.statusText);s.reject(e)};var i={context:null,urlParameters:null,async:true,success:n,error:a};return{request:this._oCollabModel.create(t,o,i),promise:s.promise()}},postFeedEntryToObject:function(e,r){var t=this;var o="/Activities";var s={};s.__metadata=e.__metadata;var n={Content:r,Object:s,Verb:"comment"};var a=true;var i=jQuery.Deferred();var u=function(e,r){i.resolve(e,r)};var l=function(e){if(e.response.statusCode===403&&a){t._oCollabModel.refreshSecurityToken(function(){a=false;t._oCollabModel.create(o,n,c)},function(e){t._oLogger.error("Failed to get the activity: "+e.response.statusText);i.reject(e)},true)}else{t._oLogger.error("Failed to get the activity: "+e.response.statusText);i.reject(e)}};var c={context:null,urlParameters:null,async:true,success:u,error:l};return{request:this._oCollabModel.create(o,n,c),promise:i.promise()}},postReply:function(e,t){var o=this;var s="/FeedEntries('"+r(e)+"')/Replies";var n={Text:t};var a=true;var i=jQuery.Deferred();var u=function(e,r){o._oLogger.info("The reply was successfully posted.");i.resolve(e)};var l=function(e){if(e.response.statusCode===403&&a){o._oCollabModel.refreshSecurityToken(function(){a=false;o._oCollabModel.create(s,n,c)},function(e){o._oLogger.error("Failed to post reply: "+e.response.statusText,e.stack);i.reject(e)},true)}else{o._oLogger.error("Failed to post reply: "+e.response.statusText,e.stack);i.reject(e)}};var c={context:null,urlParameters:null,async:true,success:u,error:l};return{request:this._oCollabModel.create(s,n,c),promise:i.promise()}},postGroupFeedEntry:function(e,t){var o=this;var s="/Groups('"+r(e)+"')/FeedEntries";var n={Text:t};var a=jQuery.Deferred();var i=function(r,t){o._oLogger.info("Feed entry was successfully posted to Group '"+e+"'.");a.resolve(r,t)};var u=function(r){o._oLogger.error("Failed to post feed entry to group '"+e+"'.");a.reject(r)};var l={context:null,urlParameters:null,async:true,success:i,error:u};return{request:this._oCollabModel.create(s,n,l),promise:a.promise()}},postGroupExternalObjectFeedEntry:function(e,t,o){var s=this;var n="/GroupExternalObjects(GroupId='"+r(e)+"',ExternalObjectId='"+r(t)+"')/FeedEntries";var a={Text:o};var i=jQuery.Deferred();var u=function(r,o){s._oLogger.info("Feed entry was successfully posted to group object wall. Group Id is:'"+e+"', External Object Id is:"+t+".");i.resolve(r,o)};var l=function(r){s._oLogger.error("Failed to post feed entry to group object wall. Group Id is:'"+e+"', External Object Id is:"+t+".");i.reject(r)};var c={context:null,urlParameters:null,async:true,success:u,error:l};return{request:this._oCollabModel.create(n,a,c),promise:i.promise()}},getFeedUpdatesLatestCount:function(e,r){var t=jQuery.Deferred();var o="/ExternalObject_FeedLatestCount";var s={urlParameters:{LatestTopLevelId:"'"+e+"'",Id:"'"+r+"'"},success:function(e,r){t.resolve(e,r)},error:function(e){t.reject(e)}};return t.promise(this._oCollabModel.read(o,s))}});return s});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP AG. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/datahandlers/SMIntegrationDataHandler", ["sap/base/Log","sap/ui/base/Object","sap/collaboration/components/utils/OdataUtil","sap/ui/thirdparty/jquery"],function(t,a,e,jQuery){"use strict";var n=a.extend("sap.collaboration.components.socialtimeline.datahandlers.SMIntegrationDataHandler",{constructor:function(a){this._oLogger=t.getLogger("sap.collaboration.components.socialtimeline.datahandlers.SMIntegrationDataHandler");this._oSMIntegrationModel=a;this._oOdataUtil=new e;this.oJamConfigurationStatusMap={configurationOk:0,configuartionError:1}},mapInternalBOToExternalBO:function(t){var a=this.getExternalObjectMapping(t).promise.then(function(t){this._oLogger.info("External business object mapping was found.");return t.MapInternalBOToExternalBO}.bind(this));return a.promise()},getJamConfigurationStatus:function(t,a){var e="/GetJamConfigurationStatus";var n=this;var o={async:false,success:function(a,e){if(a.GetJamConfigurationStatus.StatusCode===n.oJamConfigurationStatusMap.configurationOk){t(true)}else{t(false)}},error:function(t){n._oLogger.error(JSON.stringify(t));a()}};this._oSMIntegrationModel.read(e,o)},getExternalObjectMapping:function(t){var a=this;var e="/MapInternalBOToExternalBO";var n=jQuery.Deferred();var o={};o["ApplicationContext"]="'"+t.appContext+"'";o["ODataCollection"]="'"+t.collection+"'";o["ODataKeyPredicate"]="'"+t.key+"'";o["ODataServicePath"]="'"+t.odataServicePath+"'";var r=function(t,e){a._oLogger.info("External object mapping found");n.resolve(t,e)};var i=function(t){a._oLogger.error(t.response.statusText);n.reject(t)};var s={context:null,urlParameters:o,async:true,filters:[],sorters:[],success:r,error:i};return{request:this._oSMIntegrationModel.read(e,s),promise:n.promise()}}});return n});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP AG. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/datahandlers/ServiceDataHandler", ["sap/base/Log","sap/base/security/encodeURL","sap/ui/base/Object","sap/ui/thirdparty/jquery"],function(e,i,t,jQuery){"use strict";var n=t.extend("sap.collaboration.components.socialtimeline.datahandlers.ServiceDataHandler",{constructor:function(i,t){this._oLogger=e.getLogger("sap.collaboration.components.socialtimeline.datahandlers.ServiceDataHandler");this._oBOModel=i;this._oTimelineTermsUtility=t},readTimelineEntries:function(e,i,t,n,r){var s=this;var o=jQuery.Deferred();var a=this._buildTimelineEntriesEndpoint(e,i,t,n,r);var l={context:null,urlParameters:null,async:true,filters:[],sorters:[],success:function(e,i){o.resolve(e)},error:function(e){if(e.response&&e.response.statusCode){s._oLogger.error(e.body);o.reject(e)}}};return{request:this._oBOModel.read(a,l),promise:o.promise()}},_buildTimelineEntriesEndpoint:function(e,t,n,r,s){var o="/"+e+"("+i(t)+")"+"/"+this._oTimelineTermsUtility.getTimelineEntryNavigationPath(e)+"?$expand="+this._oTimelineTermsUtility.getTimelineEntryFields(e).TimelineDetailNavigationPath;if(r!=undefined){o+="&$skip="+r}if(s!=undefined){o+="&$top="+s}if(n!=undefined){o+="&$filter="+n}this._oLogger.info("Timeline Entries Endpoint: "+o);return o}});return n});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP AG. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/datahandlers/TimelineDataHandler", ["sap/base/Log","sap/ui/base/Object","sap/ui/thirdparty/jquery","sap/collaboration/components/socialtimeline/filter/FilterType"],function(e,t,jQuery,i){"use strict";var n=t.extend("sap.collaboration.components.socialtimeline.datahandlers.TimelineDataHandler",{constructor:function(t,n,r,s,a,o,l,u){this._oLogger=e.getLogger("sap.collaboration.components.socialtimeline.datahandlers.TimelineDataHandler");this._oFilterConstants=new i;this._oBusinessObjectMap=t;this._oJamDataHandler=n;this._oServiceDataHandler=s;this._oTimelineTermsUtility=a;this._oSMIntegrationDataHandler=r;this._bSocialFeaturesEnabled=l;this._bBackendFeaturesEnabled=u;this._iPageSize=o;this._iPageSize=o;this._iTimelineEntriesPageSize=o;this._iTimelineEntriesSkip=0;this._iFeedEntriesPageSize=o*2;this._sBusinessObjectKey="";this._sFeedEntriesNextLink="";this._fCustomActionCallBack=t.customActionCallback;this._aTimelineEntries=[];this._aFeedEntries=[];this._oExternalBO={};this._oMemberDataBuffer={};this._oExternalBOMapping={}},setBusinessObject:function(e){this._setBusinessObjectValues(e);this._resetBusinessObjectData();this.getExternalBOMapping()},reset:function(){this._iTimelineEntriesSkip=0;this._iTimelineEntriesPageSize=this._iPageSize;this._sFeedEntriesNextLink="";this._aTimelineEntries=[];this._aFeedEntries=[]},getTimelineData:function(e,t){var i=jQuery.Deferred();var n=this;if(e.type===this._oFilterConstants.FILTER_TYPE.feedUpdates){if(t){this._setBusinessObjectValues(t);this._resetBusinessObjectData();i=this.getExternalBOMapping().then(function(){return n._getExternalObjectJamOnlyFeedEntries()})}else{i=this._getExternalObjectFeedEntries()}}else if(e.type===this._oFilterConstants.FILTER_TYPE.systemUpdates||e.type===this._oFilterConstants.FILTER_TYPE.custom){i=this._getTimelineEntries(e)}else{this._oLogger.error("The filter type is invalid.");i.resolve([])}return i.promise()},getExternalBOMapping:function(){var e={appContext:this._oBusinessObjectMap.applicationContext,collection:this._oBusinessObjectMap.collection,name:this._sBusinessObjectName,key:this._sBusinessObjectKey,odataServicePath:this._oBusinessObjectMap.servicePath};var t=this._oSMIntegrationDataHandler.mapInternalBOToExternalBO(e).then(function(e){this._oExternalBOMapping=e;this._oExternalBOMapping.Name=this._sBusinessObjectName}.bind(this));return t.promise()},_setBusinessObjectValues:function(e){this._sBusinessObjectKey=e.key;this._sBusinessObjectName=e.name},_resetBusinessObjectData:function(){this.reset();if(this._oTimelineEntriesReadRequest){this._oTimelineEntriesReadRequest.abort()}if(this._oFeedEntriesReadRequest){this._oFeedEntriesReadRequest.abort()}},_getExternalObjectFeedEntries:function(){var e=this;var t=this._oJamDataHandler.getExternalObject(this._oExternalBOMapping).then(function(t){e._oExternalBO=t;if(e._sFeedEntriesNextLink==undefined){var i=jQuery.Deferred();i.resolve({results:[]},null);return{request:null,promise:i}}else if(e._sFeedEntriesNextLink==""){return e._oJamDataHandler.getFeedEntries(t.Id)}else{return e._oJamDataHandler.getFeedEntries(null,e._sFeedEntriesNextLink)}}).then(function(t){e._oFeedEntriesReadRequest=t.request;return t.promise}).then(function(t){e._sFeedEntriesNextLink=t.__next;return t.results}).then(function(t){return e._mapFeedEntriesToTimelineItems(t)});return t.promise()},_getExternalObjectJamOnlyFeedEntries:function(){var e=function(){var e=jQuery.Deferred();if(this._sFeedEntriesNextLink===undefined){var t=jQuery.Deferred();t.resolve({results:[]},null);e={request:null,promise:t}}else if(this._sFeedEntriesNextLink===""){e=this._oJamDataHandler.getExternalObjectByExidAndObjectType(this._oExternalBOMapping)}else{e=this._oJamDataHandler.getExternalObjectByExidAndObjectType(null,this._sFeedEntriesNextLink)}return e.promise}.bind(this);var t=e().then(function(e){this._oExternalBO=e.results;var t=e.results.FeedEntries;this._sFeedEntriesNextLink=t.__next;return this._mapFeedEntriesToTimelineItems(t.results)}.bind(this));return t.promise()},_getTimelineEntries:function(e){var t=this;var i=e.type;if(i!==this._oFilterConstants.FILTER_TYPE.custom){i=undefined}else{i=e.value}var n=this._oServiceDataHandler.readTimelineEntries(this._oBusinessObjectMap.collection,this._sBusinessObjectKey,i,this._iTimelineEntriesSkip,this._iTimelineEntriesPageSize);this._oTimelineEntriesReadRequest=n.request;var r=n.promise.then(function(e){var i=e.results;t._iTimelineEntriesPageSize=i.length;t._iTimelineEntriesSkip+=t._iTimelineEntriesPageSize;return t._mapTimelineEntriesToTimelineItems(i)}).then(function(e){if(t._bSocialFeaturesEnabled===true){return t._fillPicturesForTimelineItems(e)}return e});return r.promise()},_fillPicturesForTimelineItems:function(e){var t=this;var i=jQuery.Deferred();var n=[];e.forEach(function(e){if(!e.timelineItemData.userPicture){n.push(e.timelineItemData.userEmail)}});var r=n.filter(function(e,t){return n.indexOf(e)==t});if(r.length>0){var s=this._oJamDataHandler.getUserInfoBatch(r);s.promise.done(function(n){var r=jQuery.grep(n,function(e){return e.results.length>0});r.forEach(function(e){t.addUserInfoToBuffer(e.results[0])});e.forEach(function(e){if(!e.timelineItemData.userPicture){e.timelineItemData.userPicture=t.getUserPicture(e.timelineItemData.userEmail)}});i.resolve(e)});s.promise.fail(function(t){i.resolve(e)})}else{i.resolve(e)}return i.promise()},_getAtMentions:function(e){var t={};var i=this._oJamDataHandler.getAtMentions(e.Id);i.promise.done(function(e,i){var n=e.results;for(var r=0;r<n.length;r++){if(n[r]){t[r]=n[r]}}});i.promise.fail(function(){this._oLogger.error("Failed to get the @mentions.")});return t},_mapFeedEntriesToTimelineItems:function(e){var t=this;var i=[];e.forEach(function(e){var n={};n.timelineItemData=t._mapFeedEntryToTimelineItem(e);n._feedEntryData=e;if(e.ConsolidatedCount>1){n._feedEntryData._consolidatedUrl="<collaboration_host_url>"+e.Id}i.push(n)});return i},_mapFeedEntryToTimelineItem:function(e){var t="sap-icon://post";if(!this.getUserInfoFromBuffer(e.Creator.Email)){this.addUserInfoToBuffer(e.Creator)}var i={feedId:e.Id,dateTime:e.CreatedAt,userName:e.Creator.FullName,userEmail:e.Creator.Email,title:e.Action,text:e.Text,textWithPlaceholders:e.TextWithPlaceholders,replyCount:e.RepliesCount,icon:t};i.userPicture=this.getUserPicture(i.userEmail);return i},_mapTimelineEntriesToTimelineItems:function(e){var t=this;var i=[];e.forEach(function(e){var n={};n.timelineItemData=t._mapTimelineEntryToTimelineItem(e);var r=undefined;if(t._fCustomActionCallBack){r=t._fCustomActionCallBack(e);if(r){var s=true;if(!Array.isArray(r)){t._oLogger.error("The type defined for the return statement of the function 'customActionCallback' is "+typeof r+", expected type is array. Custom actions have been removed.");s=false}else{for(var a=0;a<r.length;a++){if(typeof r[a]!=="object"){t._oLogger.error("The function 'customActionCallback' returned the item "+JSON.stringify(r[a])+" of type "+typeof r[a]+", expected type is object. Custom actions have been removed.");s=false;break}else if(!r[a].key||!r[a].value){t._oLogger.error("The function 'customActionCallback' returned the item "+JSON.stringify(r[a])+" with the property 'key' or 'value' as undefined. Custom actions have been removed.");s=false;break}else if(typeof r[a].value!=="string"){t._oLogger.error("The function 'customActionCallback' returned the item "+JSON.stringify(r[a])+" with the property 'value' as type "+typeof r[a].value+", expected type is string. Custom actions have been removed.");s=false;break}}}if(s){r.oDataEntry=e;n.timelineItemData.customActionData=r}}}i.push(n)});return i},_mapTimelineEntryToTimelineItem:function(e){var t=this._oTimelineTermsUtility.getTimelineEntryFields(this._oBusinessObjectMap.collection);var i={dateTime:e[t.TimeStamp],userName:e[t.ActorName],userEmail:e[t.ActorExtID].toLowerCase(),title:e[t.ActionText],text:e[t.SummaryText],icon:e[t.Icon],timelineEntryDetails:this._processTimelineEntryDetails(e[t.TimelineDetailNavigationPath].results,this._oBusinessObjectMap.collection)};i.userPicture=this.getUserPicture(i.userEmail);return i},_processTimelineEntryDetails:function(e,t){var i=this;var n=[];var r=i._oTimelineTermsUtility.getTimelineEntryDetailFields(t);e.forEach(function(e){var t={};t.afterValue=e[r.AfterValue];t.beforeValue=e[r.BeforeValue];t.changeType=e[r.ChangeType];t.propertyLabel=e[r.PropertyLabel];n.push(t)});return n},getUserPicture:function(e){var t=this.getUserInfoFromBuffer(e);if(!t){return""}return t.picture},buildImageUrl:function(e){return this._oJamDataHandler._oCollabModel.sServiceUrl+"/"+e.__metadata.uri+"/ThumbnailImage/$value"},addUserInfoToBuffer:function(e){var t=this.buildImageUrl(e);var i=e.Email.toLowerCase();this._oMemberDataBuffer[i]={email:i,fullname:e.FullName,id:e.Id,address:e.MemberProfile.Address,title:e.Title,role:e.Role,picture:t}},getUserInfoFromBuffer:function(e){var t=e.toLowerCase();return this._oMemberDataBuffer[t]},getCurrentExternalBO:function(){return this._oExternalBO}});return n});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2015 SAP AG. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/filter/FilterType", ["sap/ui/base/Object"],function(e){"use strict";var t=e.extend("sap.collaboration.components.socialtimeline.filter.FilterType",{constructor:function(){if(Object.freeze){Object.freeze(this)}},FILTER_TYPE:{feedUpdates:"FeedUpdates",systemUpdates:"SystemUpdates",custom:"Custom"}});return t});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2015 SAP AG. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/socialtimeline/validation/InputValidator", ["sap/base/Log","sap/base/util/isEmptyObject","sap/collaboration/library","sap/ui/base/Object","sap/collaboration/components/socialtimeline/annotations/TimelineTermsUtility"],function(e,t,i,o,s){"use strict";var r=o.extend("sap.collaboration.components.socialtimeline.validation.InputValidator",{constructor:function(t){this._oLogger=e.getLogger("sap.collaboration.components.socialtimeline.validation.InputValidator");this._bCustomFilterValid=true;this._bSocialFeaturesEnabled=true;this._bBackendFeaturesEnabled=true;this._oSocialTimeline=t},areCustomFiltersValid:function(){return this._bCustomFilterValid},areSocialFeaturesEnabled:function(){return this._bSocialFeaturesEnabled},areBackendFeaturesEnabled:function(){return this._bBackendFeaturesEnabled},isBusinessObjectMapValid:function(e){var t=true;if(typeof e!=="object"){this._oLogger.error("The argument passed to the function 'setBusinessObjectMap' is of type "+typeof e+", expected type is object.");t=false}else if(!e.collection||!e.applicationContext||!e.servicePath){this._oLogger.error("The object passed to the method setBusinessObjectMap has property 'collection', 'applicationContext', or 'servicePath' as undefined.");t=false}else if(typeof e.collection!=="string"||typeof e.applicationContext!=="string"||typeof e.servicePath!=="string"){this._oLogger.error("The property 'collection', 'applicationContext', or 'servicePath' in the object passed to the method setBusinessObjectMap is not a string.");t=false}else if(e.customActionCallback&&typeof e.customActionCallback!=="function"){this._oLogger.error("The type defined for the property 'customActionCallback' is "+typeof e.customActionCallback+", expected type is function.");t=false}return t},isBusinessObjectValid:function(e){var t=true;if(!e.key){this._oLogger.error("The key in the object passed to the function 'setBusinessObject' is undefined.");t=false}else if(typeof e.key!=="string"){this._oLogger.error("The key in the object passed to the function 'setBusinessObject' is not of type string.");t=false}if(!e.name){this._oLogger.error("The name in the object passed to the function 'setBusinessObject' is undefined.");t=false}else if(typeof e.name!=="string"){this._oLogger.error("The name in the object passed to the function 'setBusinessObject' is not of type string.");t=false}return t},createTermsUtilityForBackend:function(e){var t;try{t=new s(e.getServiceMetadata(),e.getServiceAnnotations());this._bBackendFeaturesEnabled=true}catch(e){t=undefined;this._bBackendFeaturesEnabled=false;this._oLogger.error("The Business Object Service is not configured properly.");this._oSocialTimeline._oCommonUtil.displayError()}return t},validateEnableSocial:function(){if(this._oSocialTimeline.getEnableSocial()===true){return this._bSocialFeaturesEnabled=this._checkJamConfiguration()}else{return this._bSocialFeaturesEnabled=false}},validateCustomFilter:function(){var e=this._oSocialTimeline.getCustomFilter();this._bCustomFilterValid=true;if(!t(e)){if(!Array.isArray(e)){this._oLogger.error("The type defined for the property 'customFilter' is "+typeof e+", expected type is array.");this._bCustomFilterValid=false}else{for(var i=0;i<e.length;i++){if(!e[i].value||!e[i].text||typeof e[i].value!=="string"||typeof e[i].text!=="string"){this._oLogger.error("The type defined for the property 'text' or 'value' for the filter "+JSON.stringify(e[i])+" is undefined or not of type 'string'.");this._bCustomFilterValid=false}}}}return this._bCustomFilterValid},_checkJamConfiguration:function(){var e=true;var t=this;var i=function(t){if(t===false){e=false}};var o=function(e){t._oSocialTimeline._oCommonUtil.displayError()};this._oSocialTimeline._oSMIntegrationDataHandler.getJamConfigurationStatus(i,o);return e}});return r});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/utils/CommonUtil", ["sap/base/Log","./MessageQueueUtil","sap/m/MessageBox","sap/ui/base/Object","sap/ui/core/Lib"],function(e,t,a,n,i){"use strict";var o=n.extend("sap.collaboration.components.utils.CommonUtil",{constructor:function(){this.MessageQueueUtil=new t},getLanguageBundle:function(){if(!this.oLangBundle){this.oLangBundle=i.getResourceBundleFor("sap.collaboration")}return this.oLangBundle},displayError:function(e){var t=this;var n="";var i={icon:a.Icon.ERROR,title:t.getLanguageBundle().getText("SYSTEM_ERROR_MESSAGEBOX_TITLE")};if(!e||e===""){n=t.getLanguageBundle().getText("SYSTEM_ERROR_MESSAGEBOX_GENERAL_TEXT")}else{n=e}this.MessageQueueUtil.displayMessage(n,i,"MBox")},showMessage:function(e,t){this.MessageQueueUtil.displayMessage(e,t,"MToast")},isValidDate:function(t){if(Object.prototype.toString.call(t)!=="[object Date]"||isNaN(t.getTime())){e.error("DateUtils invalid date="+t);return false}return true},isString:function(e){return Object.prototype.toString.call(e)==="[object String]"},isObject:function(e){return Object.prototype.toString.call(e)==="[object Object]"},isFunction:function(e){return Object.prototype.toString.call(e)==="[object Function]"},isArrayOfStrings:function(e){var t;if(Array.isArray(e)){for(t in e){if(!this.isString(e[t])){return false}}return true}else{return false}},getIconFromMimeType:function(e){var t="";if(!e){return"sap-icon://document"}if(e.indexOf("image")===0){t="sap-icon://attachment-photo"}else if(e.indexOf("video")===0){t="sap-icon://attachment-video"}else if(e.indexOf("text")===0){t="sap-icon://attachment-text-file"}else if(e.indexOf("audio")===0){t="sap-icon://attachment-audio"}else if(e.indexOf("application")===0){switch(e){case"application/vnd.openxmlformats-officedocument.presentationml.presentation":case"application/vnd.ms-powerpoint":case"application/vnd.openxmlformats-officedocument.presentationml.template":t="sap-icon://ppt-attachment";break;case"application/msword":case"application/vnd.openxmlformats-officedocument.wordprocessingml.document":case"application/vnd.openxmlformats-officedocument.wordprocessingml.template":t="sap-icon://doc-attachment";break;case"application/vnd.ms-excel":case"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"application/vnd.openxmlformats-officedocument.spreadsheetml.template":t="sap-icon://excel-attachment";break;case"application/pdf":t="sap-icon://pdf-attachment";break;case"application/xhtml+xml":t="sap-icon://attachment-html";break;case"application/zip":case"application/gzip":t="sap-icon://attachment-zip-file";break;default:t="sap-icon://document"}}else{t="sap-icon://document"}return t},areArraysEqual:function(e,t){var a=function(e,t){var a=true;for(var n in e){if(e[n]!==t[n]){a=false;break}}return a};if(e.length!==t.length){return false}for(var n=0;n<e.length;n++){if(!a(e[n],t[n])){return false}}return true},b64toBlob:function(e,t,a){t=t||"";a=a||512;var n=window.atob(e);var i=[];for(var o=0;o<n.length;o+=a){var r=n.slice(o,o+a);var s=new Array(r.length);for(var c=0;c<r.length;c++){s[c]=r.charCodeAt(c)}var l=new window.Uint8Array(s);i.push(l)}var p=new window.Blob(i,{type:t});return p},getODataResult:function(e){return e.results?e.results:e}});return o});
/**
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/utils/DateUtil", ["sap/ui/base/Object","sap/collaboration/components/utils/LanguageBundle","sap/ui/core/format/DateFormat"],function(t,e,a){"use strict";var o=t.extend("sap.collaboration.components.util.DateUtil",{constructor:function(){this._oLanguageBundle=new e},formatDateToString:function(t){var e=a.getDateInstance({style:"short",relative:true},sap.ui.getCore().getConfiguration().getLocale());var o=a.getTimeInstance({style:"short"},sap.ui.getCore().getConfiguration().getLocale());var n=e.format(t)+" "+this._oLanguageBundle.getText("ST_GROUP_SELECT_AT")+" "+o.format(t);var r=/[A-Za-z]/;if(n.charAt(0).match(r)){n=n.charAt(0).toUpperCase()+n.slice(1)}return n}});return o});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/utils/JamUtil", ["sap/base/Log","sap/ui/base/Object","sap/ui/dom/includeScript","sap/collaboration/library"],function(e,t,a,o){"use strict";var r=o.FeedType;var i=t.extend("sap.collaboration.components.utils.JamUtil",{FeedRenderedControllerConstants:{jamWidgetCSS:{avatar:false,skin:"gr",post_mode:"inline",reply_mode:"inline",mobile_mode:true,live_update:true}},JamFeedType:{Follows:"follows",Company:"company",Group:"group",ObjectGroup:"context",Object:"external"},JamCallback:{autocomplete:"autocomplete",post_status:"post_status",link:"link"},JamEventType:{mouseover:"mouseover",mouseout:"mouseout",click:"click"},loadFeedWidgetScript:function(t,o,r){var i=t+"/assets/feed_widget_v1.js";a(i,"sap.collaboration.feed.JamFeedWidget",o,r);e.info("Jam Feed Widget Script Loading Asynchronously","sap.collaboration.components.utils.JamUtil.loadFeedWidgetScript()")},initializeJamWidget:function(t){try{this.sapjam="sapjam";this.sapjam.feedWidget.init(t+"/widget/v1/feed","single_use_token");e.info("Jam Feed Widget Initialized","sap.collaboration.components.utils.JamUtil.initializeJamWidget()")}catch(t){e.error(t,"","sap.collaboration.components.utils.JamUtil.initializeJamWidget()");throw t}},createJamWidget:function(t,a){try{e.debug("Jam Feed Widget Properties:","","sap.collaboration.components.utils.JamUtil.createJamWidget()");e.debug("type: "+JSON.stringify(a.type));e.debug("group_id: "+JSON.stringify(a.group_id));e.debug("external_id: "+JSON.stringify(a.external_id));e.debug("external_type: "+JSON.stringify(a.external_type));e.debug("external_object: "+JSON.stringify(a.external_object));this.sapjam="sapjam";this.sapjam.feedWidget.create(t,a)}catch(t){e.error(t,"","sap.collaboration.components.utils.JamUtil.createJamWidget()");throw t}},prepareWidgetData:function(t,a,o,i){var n;n={type:a,avatar:this.FeedRenderedControllerConstants.jamWidgetCSS.avatar,live_update:this.FeedRenderedControllerConstants.jamWidgetCSS.live_update,post_mode:this.FeedRenderedControllerConstants.jamWidgetCSS.post_mode,reply_mode:this.FeedRenderedControllerConstants.jamWidgetCSS.reply_mode,mobile_mode:this.FeedRenderedControllerConstants.jamWidgetCSS.mobile_mode,hide_bookmark:true,single_use_token:t};switch(a){case r.follows:case r.company:n.type=a;break;case r.group:case r.objectGroup:n.type=this.JamFeedType.Group;n.group_id=o;break;case r.object:n.type=this.JamFeedType.Object;if(!i){var s=new Error("Object is undefined");e.error(s,"","sap.collaboration.components.utils.JamUtil.prepareWidgetData()");throw s}if(!i.id){var d=new Error("Property 'id' is undefined");e.error(d,"","sap.collaboration.components.utils.JamUtil.prepareWidgetData()");throw d}if(!i.type){var l=new Error("Property 'type' is undefined");e.error(l,"","sap.collaboration.components.utils.JamUtil.prepareWidgetData()");throw l}try{n.external_id=i.id;n.external_type=i.type;n.external_object=i}catch(t){e.error(t,"","sap.collaboration.components.utils.JamUtil.prepareWidgetData()");throw t}break;default:var p="Feed Type not supported";e.error(p,"","sap.collaboration.components.utils.JamUtil.prepareWidgetData()");throw new Error(p)}return n},getJamSinglelUseTokens:function(e,t,a,o){var r=new window.XMLHttpRequest;var i=e+"/single_use_tokens";r.open("POST",i,a);r.onreadystatechange=t;r.setRequestHeader("x-csrf-token",o);r.send()},getCSRFToken:function(e,t,a){var o=new window.XMLHttpRequest;o.open("GET",e,a);o.onreadystatechange=t;o.setRequestHeader("x-csrf-token","fetch");o.send()}});return i});
/**
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/utils/LanguageBundle", ["sap/ui/base/Object","sap/ui/model/resource/ResourceModel"],function(e,n){"use strict";var o=sap.ui.require.toUrl("sap/collaboration/components/resources/i18n/messagebundle.properties");var t=e.extend("sap.collaboration.components.util.LanguageBundle",{constructor:function(){this.i18nModel=new n({bundleUrl:o});this.oLangBundle=this.i18nModel.getResourceBundle()},getText:function(e,n){return this.oLangBundle.getText(e,n)},createResourceModel:function(){return this.i18nModel}});return t});
/**
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/utils/MediaTypeToSAPIcon", ["sap/ui/base/Object"],function(e){"use strict";var a=e.extend("sap.collaboration.components.utils.MediaTypeToSAPIcon",{});a.getSAPIconForMediaType=function(e){var a="sap-icon://document";var n=e.split("/");var t=n[0];var o=n[1];switch(t){case"audio":return"sap-icon://attachment-audio";case"video":return"sap-icon://attachment-video";case"image":return"sap-icon://attachment-photo";case"text":return"sap-icon://document";case"application":switch(o){case"msword":case"vnd.openxmlformats-officedocument.wordprocessingml.document":case"vnd.openxmlformats-officedocument.wordprocessingml.template":case"vnd.ms-word.document.macroEnabled.12":case"vnd.ms-word.template.macroEnabled.12":return"sap-icon://doc-attachment";case"vnd.ms-excel":case"vnd.openxmlformats-officedocument.spreadsheetml.sheet":case"vnd.openxmlformats-officedocument.spreadsheetml.template":case"vnd.ms-excel.sheet.macroEnabled.12":case"vnd.ms-excel.template.macroEnabled.12":case"vnd.ms-excel.addin.macroEnabled.12":case"vnd.ms-excel.sheet.binary.macroEnabled.12":return"sap-icon://excel-attachment";case"vnd.ms-powerpoint":case"vnd.openxmlformats-officedocument.presentationml.presentation":case"vnd.openxmlformats-officedocument.presentationml.template":case"vnd.openxmlformats-officedocument.presentationml.slideshow":case"vnd.ms-powerpoint.addin.macroEnabled.12":case"vnd.ms-powerpoint.presentation.macroEnabled.12":case"vnd.ms-powerpoint.template.macroEnabled.12":case"vnd.ms-powerpoint.slideshow.macroEnabled.12":return"sap-icon://ppt-attachment";case"pdf":return"sap-icon://pdf-attachment";case"mp4":return"sap-icon://attachment-video";default:return a}default:return a}};return a});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/utils/MessageQueueUtil", ["sap/m/MessageBox","sap/m/MessageToast","sap/ui/base/Object"],function(e,s,a){"use strict";var u=a.extend("sap.collaboration.components.utils.MessageQueueUtil",{messageTypes:{messageToast:"MToast",messageBox:"MBox"},aMessageQueue:[],displayMessage:function(a,u,t){var g=u;g.onClose=this.afterMessageClose();this.addMessageToQueue(a,g,t);if(this.aMessageQueue.length==1){if(this.aMessageQueue[0].type==this.messageTypes.messageBox){e.show(this.aMessageQueue[0].message,this.aMessageQueue[0].options)}else if(this.aMessageQueue[0].type==this.messageTypes.messageToast){s.show(this.aMessageQueue[0].message,this.aMessageQueue[0].options)}}},addMessageToQueue:function(e,s,a){this.aMessageQueue.push({message:e,options:s,type:a})},afterMessageClose:function(){var a=this;return function(){a.aMessageQueue.shift();if(a.aMessageQueue.length!=0){if(a.aMessageQueue[0].type==a.messageTypes.messageBox){e.show(a.aMessageQueue[0].message,a.aMessageQueue[0].options)}else if(a.aMessageQueue[0].type==a.messageTypes.messageToast){s.show(a.aMessageQueue[0].message,a.aMessageQueue[0].options)}}}}});return u});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/utils/NotificationTypeUtil", ["sap/ui/base/Object"],function(e){"use strict";var d=e.extend("sap.collaboration.components.utils.NotificationTypeUtil",{map:{AbuseReported:[],AcceptAddedAsAssistant:["SenderFullName"],AcceptAddedAsMgr:["SenderFullName"],AcceptAddedAsReport:["SenderFullName"],AddedAsAssistant:["SenderFullName"],AddedAsMgr:["SenderFullName"],AddedAsReport:["SenderFullName"],AutoGroupAdmin:["SenderFullName"],AutoGroupMember:["SenderFullName"],CommentInDiscussion:["SenderFullName"],CrossCompanyInviteToGroup:["SenderFullName","ObjName"],FeatureInGroup:["SenderFullName"],GoalMigrated:[],GroupContentPendingApproval:[],GroupAccessRequest:["ObjName"],InviteToFollow:["SenderFullName"],InviteToInactiveGroup:["SenderFullName"],InviteToGroup:["SenderFullName"],Like:["SenderFullName"],MarkComment:["SenderFullName"],MarkCommentSimple:["SenderFullName"],MentionInFeed:["SenderFullName"],ReceiveKudoType:["SenderFullName","ObjName"],ReceivedKudo:["SenderFullName","ObjName"],ReceiveKudo:["SenderFullName","ObjName"],RejectAddedAsAssistant:["SenderFullName"],RejectAddedAsMgr:["SenderFullName"],RejectAddedAsReport:["SenderFullName"],ReplyInFeed:["SenderFullName"],RemovedAsAssistant:["SenderFullName"],RemovedAsMgr:["SenderFullName"],RemovedAsReport:["SenderFullName"],RejectPendingContent:["ObjName"],RequestToBeGroupAdmin:["SenderFullName"],SkillNudge:["SenderFullName"],SubscribedToFeed:["SenderFullName"],SuggestTopic:["SenderFullName","ObjName"],send_nudge:["custom_brand_name"],TaskAssigned:["SenderFullName"],TaskNudge:["SenderFullName"],user_new_features:["custom_brand_name"]},getRequiredNotificationPropertyNames:function(e){return this.map[e]?this.map[e]:[]}});return d});
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/components/utils/OdataUtil", ["sap/base/Log","sap/base/security/encodeURL","sap/base/util/each","./CommonUtil","sap/ui/base/Object"],function(t,a,e,n,o){"use strict";var r=o.extend("sap.collaboration.components.utils.OdataUtil",{OdataUtilConstants:{HttpStatusCode:{success:200,created:201},EndPoint:{AssignedGroups:"AssignedGroups",BusinessObjects:"BusinessObjects",ContentItems:"ContentItems",PostContentItem:"PostContentItem",Feed:"Feed",Folders:"Folders",GetCollaborationHostUrl:"GetCollaborationHostURL",MapInternalBOToExternalBO:"MapInternalBOToExternalBO",GetExternalODataURL:"GetExternalODataURL",GetSingleUseToken:"GetSingleUseToken",Groups:"Groups",GroupsCount:"Groups/$count",GetNotificationUnreadCount:"GetNoticeUnreadCount",Notifications:"Notices",FeaturedExternalObjects:"FeaturedExternalObjects",GroupsAsFeatured:"GroupsAsFeatured",ExternalObjects:"ExternalObjects",Activities:"Activities",ExternalObjects_FindByExidAndObjectType:"ExternalObjects_FindByExidAndObjectType"},HttpMethod:{GET:"GET",POST:"POST"},ResponseType:{blob:"blob",arraybuffer:"arraybuffer"}},constructor:function(){this.oCommonUtil=new n;this.bError=false},getJamUrl:function(a,e,n){var o="";var r="";var s=function(t,a){if(e){e.resolve(t.GetCollaborationHostURL.URL)}else{r=t.GetCollaborationHostURL.URL}};var i=function(a){t.error(JSON.stringify(a));o=a.response.statusCode;if(e){e.reject(o)}};a.read("/"+this.OdataUtilConstants.EndPoint.GetCollaborationHostUrl,{success:s,error:i,async:n});if(!e){return r}},createJamUrlBatchOperation:function(a){var e=null;var n=null;var o;try{o=a.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.GetCollaborationHostUrl,this.OdataUtilConstants.HttpMethod.GET,e,n)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createJamUrlBatchOperation()");throw a}return o},getJamToken:function(a){var e="";var n="";var o=function(t,a){e=t.GetSingleUseToken.Id};var r=function(a){t.error(JSON.stringify(a));n=a.response.statusCode};a.read("/"+this.OdataUtilConstants.EndPoint.GetSingleUseToken,null,null,false,o,r);if(n){throw new Error(n)}return e},createJamTokenBatchOperation:function(a){var e=null;var n=null;var o;try{o=a.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.GetSingleUseToken,this.OdataUtilConstants.HttpMethod.GET,e,n)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createJamTokenBatchOperation()");throw a}return o},getGroupsData:function(a,e){var n;var o="";var r=function(t,a){n=this.oCommonUtil.getODataResult(t)}.bind(this);var s=function(a){t.error(JSON.stringify(a));o=a.response.statusCode};a.read(e,null,null,false,r,s);if(o){throw new Error(o)}return n},createGetGroupsDataBatchOperation:function(a){var e=null;var n=null;var o;try{o=a.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.Groups,this.OdataUtilConstants.HttpMethod.GET,e,n)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createGetGroupsDataBatchOperation()");throw a}return o},createGetGroupsCountBatchOperation:function(a){var e=null;var n=null;var o;try{o=a.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.GroupsCount,this.OdataUtilConstants.HttpMethod.GET,e,n)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createGetGroupsCountDataBatchOperation()");throw a}return o},createGetGroupsLinkedToBOBatchOperation:function(t,e){var n=null;var o=null;var r;var s="/"+this.OdataUtilConstants.EndPoint.ExternalObjects+"(ApplicationContext='"+a(e.appContext.replace(/'/g,"''"))+"',"+"OdataServicePath='"+a(e.odataServicePath.replace(/'/g,"''"))+"',"+"OdataCollection='"+a(e.collection.replace(/'/g,"''"))+"',"+"OdataKey='"+a(e.key.replace(/'/g,"''"))+"')/"+this.OdataUtilConstants.EndPoint.GroupsAsFeatured;r=t.createBatchOperation(s,this.OdataUtilConstants.HttpMethod.GET,n,o);return r},createGetObjectGroupsBatchOperation:function(e,n){var o=null;var r=null;var s;try{s=e.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.BusinessObjects+"('"+a(n)+"')/"+this.OdataUtilConstants.EndPoint.AssignedGroups,this.OdataUtilConstants.HttpMethod.GET,o,r)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createGetObjectGroupsBatchOperation()");throw a}return s},getGroupIds:function(t){var a="";for(var e=0;e<t.length;e++){if(e==0){a+=t[e].Id}else{a+=","+t[e].Id}}return a},createGroupFeed:function(e,n,o){var r="/"+this.OdataUtilConstants.EndPoint.Groups+"("+a(n)+")/"+this.OdataUtilConstants.EndPoint.Feed;var s={Text:o};var i=undefined;var l=function(){i=true};var c=function(a){t.error(JSON.stringify(a.response.body));i=false};e.create(r,s,null,l,c);return i},executeODataBatchRequest:function(a,e,n,o,r){var s=this;var i;var l=function(t){i=s.parseBatchResponse(t.__batchResponses);n(i)};var c=function(a){if(a.response){t.error(JSON.stringify(a.response.body))}else{t.error(JSON.stringify(a.message))}r(a)};var u=[];var d=[];for(var p in e){if(e[p].method==this.OdataUtilConstants.HttpMethod.GET){u.push(e[p])}else if(e[p].method==this.OdataUtilConstants.HttpMethod.POST){d.push(e[p])}}if(u.length>0){a.addBatchReadOperations(u)}for(var p=0;p<d.length;p++){a.addBatchChangeOperations([d[p]])}if(o===true){a.submitBatch(l,c,true)}else{a.submitBatch(l,c,false)}},parseBatchResponse:function(a){var n=this;var o=[];e(a,function(a,e){if(e.statusCode&&e.statusCode.match(n.OdataUtilConstants.HttpStatusCode.success)){o.push(e.data)}else if(e.__changeResponses){for(var a=0;a<e.__changeResponses.length;a++){if(e.__changeResponses[a].statusCode&&(e.__changeResponses[a].statusCode.match(n.OdataUtilConstants.HttpStatusCode.created)||e.__changeResponses[a].statusCode.match(n.OdataUtilConstants.HttpStatusCode.success))){o.push(e.__changeResponses[a].data)}else{o.push({error:e.__changeResponses[a].response.body});t.error(JSON.stringify(e.__changeResponses[a].response.body),"sap.collaboration.components.utils.OdataUtil.parseBatchResponse()")}}}else{o.push({error:e.response.body});t.error(JSON.stringify(e.response.body),"sap.collaboration.components.utils.OdataUtil.parseBatchResponse()")}});return o},createExternalOdataUrlBatchOperation:function(e,n){var o=null;var r=null;var s;try{s=e.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.GetExternalODataURL+"/?RelativePath='"+a(n)+"'",this.OdataUtilConstants.HttpMethod.GET,r,o)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createExternalOdataUrlBatchOperation()");throw a}return s},getExternalOdataUrl:function(a,e){var n="";var o="";var r={};r["RelativePath"]="'"+e+"'";var s=function(t,a){n=t.GetExternalODataURL.URL};var i=function(a){t.error(JSON.stringify(a));o=a.response.statusCode};a.read("/"+this.OdataUtilConstants.EndPoint.GetExternalODataURL,null,r,false,s,i);if(o){throw new Error(o)}return n},createNotificationUnreadCountBatchOperation:function(a){var e=null;var n=null;var o;try{o=a.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.GetNotificationUnreadCount,this.OdataUtilConstants.HttpMethod.GET,e,n)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createNotificationUnreadCountBatchOperation()");throw a}return o},createNotificationBatchOperation:function(e,n){var o=null;var r=null;var s;try{s=e.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.Notifications+"?$top="+a(n.toString()),this.OdataUtilConstants.HttpMethod.GET,o,r)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createNotificationBatchOperation()");throw a}return s},createGroupFeedBatchOperation:function(e,n,o){var r="/"+this.OdataUtilConstants.EndPoint.Groups+"("+a(n)+")/"+this.OdataUtilConstants.EndPoint.Feed;var s={Text:o.note,UiUrl:o.uiUrl};var i=null;var l;try{l=e.createBatchOperation(r,this.OdataUtilConstants.HttpMethod.POST,s,i)}catch(a){t.error(a,"","sap.collaboration.components.utils.OdataUtil.createGroupFeedBatchOperation()");throw a}return l},createUploadFileBatchOperation:function(t,e,n,o){var r=null;var s=null;var i;i=t.createBatchOperation("/"+this.OdataUtilConstants.EndPoint.PostContentItem+"/?name='"+a(e.name)+"'&"+"groupId='"+a(n)+"'&"+"mimeType='"+a(e.mimeType)+"'&"+"folderId='"+a(o)+"'&"+"url='"+a(e.url)+"'",this.OdataUtilConstants.HttpMethod.POST,r,s);return i},uploadFile:function(a,e,n,o,r,s,i){var l=this.OdataUtilConstants.EndPoint.PostContentItem;var c=function(){r()};var u=function(){t.error(e.name+" was not uploaded","","sap.collaboration.components.utils.OdataUtil.uploadFile()");s()};a.callFunction(l,"POST",{name:e.name,groupId:n,mimeType:e.mimeType,url:e.url,folderId:o},null,c,u,i)},getSubFolders:function(e,n,o,r,s){var i;if(!o&&n){i="/"+this.OdataUtilConstants.EndPoint.Groups+"('"+a(n)+"')/"+this.OdataUtilConstants.EndPoint.Folders}else{i="/"+this.OdataUtilConstants.EndPoint.Folders+"(Id='"+a(o)+"',FolderType='Folder')/"+this.OdataUtilConstants.EndPoint.Folders}i=i+"?$skip="+r+"&$top="+s+"&$inlinecount=allpages";var l=[];var c=0;var u="";var d=function(t,a){if(t){l=this.oCommonUtil.getODataResult(t);c=parseInt(JSON.parse(a.body).d.__count)}}.bind(this);var p=function(a){t.error(JSON.stringify(a));u=a.response.statusCode};e.read(i,null,null,false,d,p);if(u){throw new Error(u)}return{folders:l,count:c}},createShareFeaturedObjectBatchOperation:function(t,e,n){var o="/"+this.OdataUtilConstants.EndPoint.Groups+"("+a(n)+")/"+this.OdataUtilConstants.EndPoint.FeaturedExternalObjects;var r={ApplicationContext:e.appContext,OdataServicePath:e.odataServicePath,OdataCollection:e.collection,OdataKey:e.key,Name:e.name,Summary:e.summary,UiUrl:e.uiUrl,Comment:e.note};var s=null;var i;i=t.createBatchOperation(o,this.OdataUtilConstants.HttpMethod.POST,r,s);return i},getExternalObjectMapping:function(a,e,n){var o="/"+this.OdataUtilConstants.EndPoint.MapInternalBOToExternalBO;var r={};r["ApplicationContext"]="'"+e.appContext+"'";r["ODataCollection"]="'"+e.collection+"'";r["ODataKeyPredicate"]="'"+e.key+"'";r["ODataServicePath"]="'"+e.odataServicePath+"'";var s="";var i=function(t,a){n.resolve(t.MapInternalBOToExternalBO)};var l=function(a){t.error(JSON.stringify(a));s=a.response.statusCode;n.reject(s)};a.read(o,null,r,true,i,l)},_GetJamExternalObject:function(e,n,o,r,s){var i="/"+this.OdataUtilConstants.EndPoint.ExternalObjects_FindByExidAndObjectType+"/?Exid='"+a(n)+"'&"+"ObjectType='"+a(o);var l=function(){r()};var c=function(a){t.error(JSON.stringify(a.response.body));s()};e.read(i,null,null,false,l,c)}});return r});
/*
* ! SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
*/
sap.ui.predefine("sap/collaboration/components/utils/PendingRequestsUtil", function(){"use strict";var e=function(){this._aPendingRequests=[]};e.prototype.contains=function(e){for(var t=0;t<this._aPendingRequests.length;++t){if(this._aPendingRequests[t]===e){return true}return false}};e.prototype.add=function(e){if(this.contains(e)){return false}else{this._aPendingRequests.push(e);return true}};e.prototype.remove=function(e){for(var t=0;t<this._aPendingRequests.length;++t){if(this._aPendingRequests[t]===e){this._aPendingRequests.splice(t,1);return true}}return false};e.prototype.abortAll=function(){var e;while((e=this._aPendingRequests.pop())!==undefined){e.abort()}};return e},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

(c) Copyright 2009-2017 SAP SE. All rights reserved
 */
sap.ui.predefine("sap/collaboration/library", ["sap/ui/base/DataType","sap/ui/core/Lib","sap/ui/core/library","sap/suite/ui/commons/library"],function(e,o){"use strict";var s=o.init({name:"sap.collaboration",apiVersion:2,dependencies:["sap.ui.core","sap.suite.ui.commons"],types:["sap.collaboration.AppType","sap.collaboration.DisplayFeedType","sap.collaboration.FeedType"],interfaces:[],controls:["sap.collaboration.components.controls.FeedEntryEmbedded","sap.collaboration.components.controls.FilterPopover","sap.collaboration.components.controls.ReplyPopover","sap.collaboration.components.controls.SocialTextArea","sap.collaboration.components.controls.TimelineEntryEmbedded","sap.collaboration.components.socialtimeline.controls.TimelineItemEmbedded"],elements:[],version:"1.141.0"});s.AppType={split:"split",widget:"widget"};e.registerEnum("sap.collaboration.AppType",s.AppType);s.DisplayFeedType={BusinessRecordFeed:"BusinessRecordFeed",GroupFeedsWhereBusinessRecordIsLinked:"GroupFeedsWhereBusinessRecordIsLinked"};e.registerEnum("sap.collaboration.DisplayFeedType",s.DisplayFeedType);s.FeedType={follows:"follows",company:"company",group:"group",objectGroup:"objectGroup",object:"object",GroupIds:"GroupIds",BusinessObjectGroups:"BusinessObjectGroups",UserGroups:"UserGroups"};e.registerEnum("sap.collaboration.FeedType",s.FeedType);return s});
sap.ui.require.preload({
	"sap/collaboration/components/feed/fragments/CustomListItem.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core"><CustomListItem><content><Label\n\t\t\t\ttext="{Name}"\n\t\t\t\twidth="20em"\n\t\t\t\tclass="sapUiTinyMarginBeginEnd sapUiTinyMarginTopBottom"\n\t\t\t/></content></CustomListItem></core:FragmentDefinition>',
	"sap/collaboration/components/feed/fragments/GroupSelector.fragment.xml":'<core:FragmentDefinition xmlns="sap.m" xmlns:core="sap.ui.core"><ResponsivePopover\n\t\tid="responsivePopover"\n\t\tplacement="Vertical"\n\t\tcontentWidth="20em"\n\t\ttitle="{i18n>ST_GROUP_SELECT_HEADER}"\n\t\t><content><SearchField\n\t\t\t\tliveChange=".onGroupSearch"\n\t\t\t\twidth="100%"/><List\n\t\t\t\tid="list"\n\t\t\t\tmode="SingleSelectMaster"\n\t\t\t\tnoDataText="{i18n>GRP_NO_GROUPS_FOUND_TEXT}"\n\t\t\t\tgrowing="true"\n\t\t\t\tgrowingThreshold="5"\n\t\t\t\tgrowingScrollToLoad="false"\n\t\t\t\tselectionChange=".onGroupSelected"></List></content></ResponsivePopover></core:FragmentDefinition>',
	"sap/collaboration/components/feed/views/GroupFeed.view.xml":'<mvc:View xmlns:core="sap.ui.core" xmlns:mvc="sap.ui.core.mvc" xmlns:m="sap.m" xmlns:commons="sap.suite.ui.commons" xmlns:collaboration="sap.collaboration"\n\t\tcontrollerName="sap.collaboration.components.feed.views.GroupFeed" xmlns:html="http://www.w3.org/1999/xhtml"><commons:Timeline\n\t   id="timeline"\n\t   enableSocial="{/enableSocial}"\n\t   axisOrientation="{/axisOrientation}"\n\t   enableScroll="{/enableScroll}"\n\t   forceGrowing="{/forceGrowing}"\n\t   growingThreshold="{/growingThreshold}"\n\t   sort="false"\n\t   grow=".onGrow"\n\t   ></commons:Timeline></mvc:View>',
	"sap/collaboration/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.collaboration","type":"library","embeds":[],"applicationVersion":{"version":"1.141.0"},"title":"SAP UI library: SAP Collaboration for Social Media Integration.","description":"SAP UI library: SAP Collaboration for Social Media Integration.","ach":"CA-UI5-BS-SM","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_base","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_bluecrystal_base","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.141","libs":{"sap.ui.core":{"minVersion":"1.141.0"},"sap.suite.ui.commons":{"minVersion":"1.141.0"}}},"library":{"i18n":{"bundleUrl":"components/resources/i18n/messagebundle.properties","supportedLocales":["","ar","bg","ca","cnr","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","mk","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":["sap.collaboration.components.controls.FeedEntryEmbedded","sap.collaboration.components.controls.FilterPopover","sap.collaboration.components.controls.ReplyPopover","sap.collaboration.components.controls.SocialTextArea","sap.collaboration.components.controls.TimelineEntryEmbedded","sap.collaboration.components.socialtimeline.controls.TimelineItemEmbedded"],"elements":[],"types":["sap.collaboration.AppType","sap.collaboration.DisplayFeedType","sap.collaboration.FeedType"],"interfaces":[]}}}}'
});
//# sourceMappingURL=library-preload.js.map
