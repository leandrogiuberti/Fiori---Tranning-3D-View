// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["./abap.bootstrap.utils","sap/ushell/bootstrap/common/common.util","sap/ui/thirdparty/jquery","sap/ushell_abap/pbServices/ui2/Utils","sap/base/Log"],(e,a,jQuery,s,t)=>{"use strict";const i={};const r="/sap/opu/odata/UI2/PAGE_BUILDER_PERS";const n="Pages/PageChipInstances/Chip/ChipBags/ChipProperties,"+"Pages/PageChipInstances/RemoteCatalog,"+"Pages/PageChipInstances/ChipInstanceBags/ChipInstanceProperties,"+"AssignedPages,DefaultPage";const c="PageSets('%2FUI2%2FFiori2LaunchpadHome')";let l=a.isSapStatisticsSet();function o(e,a,s,i,r){let n;let c;let l=false;if(e.services){if(e.services[a]){c=e.services[a]}else{c={};e.services[a]=c;l=true}}else{c={};e.services={};e.services[a]=c;l=true}if(!c.baseUrl||!c.relativeUrl){c.baseUrl=s;c.relativeUrl=i;l=true}if(l){t.warning(`URL for ${a} service not found in startup service result; fallback to default; cache invalidation might fail`,null,"sap.ushell_abap.bootstrap")}if(c.baseUrl.lastIndexOf("/")!==c.baseUrl.length-1){c.baseUrl+="/"}if(c.relativeUrl[0]==="/"){c.relativeUrl=c.relativeUrl.slice(1)}n=c.baseUrl+c.relativeUrl;if(!/\$expand=/.test(n)&&r){n+=`${n.indexOf("?")<0?"?":"&"}$expand=${r}`}if(c.cacheId){n+=`${n.indexOf("?")<0?"?":"&"}sap-cache-id=${c.cacheId}`}if(c["sap-ui2-cache-disable"]){n+=`${n.indexOf("?")<0?"?":"&"}sap-ui2-cache-disable=${c["sap-ui2-cache-disable"]}`}return n}function u(e,a,s,t){if(a===200){e.resolve(JSON.parse(t).d,s)}else{e.reject(new Error(`PageSet request failed: ${t}`))}}function p(a){const s=e.getUrlParameterValue("sap-ui2-cache-disable");if(s&&a&&a.services&&a.services.pbFioriHome){a.services.pbFioriHome["sap-ui2-cache-disable"]=s}return o(a,"pbFioriHome",r,c,n)}function d(e){const a=new jQuery.Deferred;sap.ui.require(["sap/ui/thirdparty/datajs"],t=>{OData.read.$cache=OData.read.$cache||new s.Map;OData.read.$cache.put(e,a.promise())});return a}function f(a,s,t){const i=e.createAndOpenXHR(a,s);if(l){i.setRequestHeader("sap-statistics","true")}i.onreadystatechange=function(){if(this.readyState!==4){return}t(i.status,undefined,i.responseText)};i.send()}function h(e){const a=p(e);const s=d(a);f(a,e,(e,a,t)=>{u(s,e,a,t)})}i.requestPageSet=h;i._getAndAdjustServiceURL=o;i._getAndAdjustPageSetServiceURL=p;i._setSapStatistics=function(e){l=e};return i});
//# sourceMappingURL=abap.request.pageset.js.map