// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/util/isPlainObject","sap/ushell/components/pages/controller/PagesAndSpaceId","sap/ushell/Config","sap/ushell/library","sap/ushell/utils"],(e,t,n,i,s,o)=>{"use strict";const a=s.ContentNodeType;function r(){}r.prototype.isMenuEnabled=function(){const e=i.last("/core/menu/enabled");const t=this._getAssignedSpaces().length;return Promise.resolve(e&&t>0)};r.prototype.isSideNavigationEnabled=async function(){if(!i.last("/core/sideNavigation/enabled")){return false}const e=await this.getMenuEntries();return e.length>0};r.prototype.getMenuEntries=function(){return n.getUserMyHomeEnablement().then(e=>{const t=i.last("/core/homeApp/enabled");const n=i.last("/core/spaces/myHome/enabled");const s=i.last("/core/spaces/myHome/myHomeSpaceId");let o=this._getAssignedSpaces();if(t&&n||n&&!e){for(let e=0;e<o.length;e++){if(o[e].id===s){o=o.slice(1);break}}}const a=this._buildMenuEntries(o);return a})};r.prototype.getMenuPersonalization=function(){const e=document.querySelector("meta[name='sap.ushell.menuPersonalization']");if(!e){return null}const t=JSON.parse(e.getAttribute("content"));return t};r.prototype.getContentNodeEntries=function(){const e=this._getAssignedSpaces();this._removeMyHomeForContentNodes(e);const t=this._buildMenuEntries(e);return Promise.resolve(t)};r.prototype.getContentNodes=function(){const e=this._getAssignedSpaces();this._removeMyHomeForContentNodes(e);const t=this._buildContentNodes(e);return Promise.resolve(t)};r.prototype._buildMenuEntries=function(e){const t=e.filter(this._isSpaceNotEmpty.bind(null,"FLP menu")).map((e,t)=>{const n={id:e.id,title:e.title||e.id,"help-id":`Space-${e.id}`,description:e.description,icon:undefined,type:"IBN",target:{semanticObject:"Launchpad",action:"openFLPPage",parameters:[{name:"spaceId",value:e.id},{name:"pageId",value:e.pages[0].id}],innerAppRoute:undefined},isHomeEntry:t===0&&e.id===i.last("/core/spaces/myHome/myHomeSpaceId"),menuEntries:[]};const s=e.pages.map(t=>({id:t.id,title:t.title||t.id,"help-id":`Page-${t.id}`,description:t.description,icon:undefined,type:"IBN",target:{semanticObject:"Launchpad",action:"openFLPPage",parameters:[{name:"spaceId",value:e.id},{name:"pageId",value:t.id}],innerAppRoute:undefined},menuEntries:[]}));if(s.length>1){n.menuEntries=s}return n});return t};r.prototype._buildContentNodes=function(e){const t=e.filter(this._isSpaceNotEmpty.bind(null,"content nodes")).map(e=>({id:e.id,label:e.title||e.id,type:a.Space,isContainer:false,children:e.pages.map(e=>({id:e.id,label:e.title||e.id,type:a.Page,isContainer:true}))}));return t};r.prototype._isSpaceNotEmpty=function(t,n){if(!n.pages||n.pages.length===0){e.warning(`FLP space ${n.id} without page omitted in ${t}.`,"","sap.ushell_abap.adapters.abap.MenuAdapter");return false}return true};r.prototype._removeMyHomeForContentNodes=function(e){const t=i.last("/core/homeApp/enabled");const n=i.last("/core/spaces/myHome/enabled");const s=i.last("/core/spaces/myHome/userEnabled");const o=i.last("/core/spaces/myHome/myHomeSpaceId");if(t){return}if(n&&!s){if(e[0]&&e[0].id===o){e.shift()}}};r.prototype._getAssignedSpaces=function(){const e=document.querySelector("meta[name='sap.ushell.assignedSpaces']");if(!e){return[]}const n=o.getFormFactor();const i=JSON.parse(e.getAttribute("content"));return i.filter(e=>{if(!t(e.visibility)){return true}return e.visibility[n]}).map(e=>{e.pages=e.pages.filter(e=>{if(!t(e.visibility)){return true}return e.visibility[n]});return e})};return r});
//# sourceMappingURL=MenuAdapter.js.map