// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell_abap/pbServices/ui2/Utils","sap/ushell_abap/pbServices/ui2/Page","sap/ushell_abap/pbServices/ui2/Error","sap/base/Log"],(e,t,i,s)=>{"use strict";const n={assigned:1,userCreated:2,personalized:3,defaultPage:4};function a(a,g){let u;let r;let o=[];let l;let f=true;const c=this;const d=g;if(!d){throw new i("Missing page set ID","PageSet")}s.debug(`Created: ${this}`,null,"PageSet");function p(){if(f){throw new i(`${c}: page set is just a stub`,"sap.ushell_abap.pbServices.ui2.PageSet")}}this.getPageType=function(e){const t=e.getId();let s;p();if(!l.containsKey(t)){throw new i(`Unknown page ${t}`,"sap.ushell_abap.pbServices.ui2.PageSet")}s=l.get(t);if(s===n.assigned&&e.isPersonalized()){s=n.personalized}return s};function h(i){const g=i.DefaultPage.id;const d=i.AssignedPages&&i.AssignedPages.results||[];u=i;l=new e.Map;d.forEach(e=>{l.put(e.id,n.assigned)});u.Pages.results.forEach(e=>{const i=new t(a,e);const s=i.getId();o.push(i);if(g===s){r=i;l.put(s,n.defaultPage)}else if(!l.containsKey(s)){l.put(s,n.userCreated)}});delete u.AssignedPages;delete u.DefaultPage;delete u.Pages;f=false;s.debug(`Initialized: ${c}`,null,"PageSet")}this.appendPage=function(e,g,u,r){p();if(typeof u!=="function"){throw new i("Missing success handler","PageSet")}a.getPageBuildingService().createPageInPageSet(d,e,g,e=>{const i=new t(a,e);o.push(i);l.put(i.getId(),n.userCreated);s.debug(`Appended new page with ID ${i.getId()} to pageset ${c}`,null,"PageSet");u(i)},r)};this.isPageRemovable=function(e){return this.getPageType(e)===n.userCreated};this.isPageResettable=function(e){return this.getPageType(e)===n.personalized};this.removePage=function(e,t,s){if(!this.isPageRemovable(e)){throw new i(`Cannot remove page ${e.getId()}`,"PageSet")}e.remove(()=>{o.splice(o.indexOf(e),1);l.remove(e.getId());if(t){t()}},s)};this.resetPage=function(e,t,s){if(!this.isPageResettable(e)){throw new i(`Cannot reset page ${e.getId()}`,"sap.ushell_abap.pbServices.ui2.PageSet")}e.remove(()=>{e.load(t,s,true)},s)};this.filter=function(e,t){let i;const s=[];let n;p();e=e||[];t=t||[];for(i=0;i<o.length;i+=1){n=o[i];if(e.indexOf(n.getId())!==-1){s.push(n)}else if(n.getCatalog()&&t.indexOf(n.getCatalog().getId())!==-1){s.push(n)}}o=s};this.getConfiguration=function(){p();return u.configuration};this.setConfiguration=function(t,s,n){p();if(typeof s!=="function"){throw new i("Missing success handler","PageSet")}if(u.configuration===t){e.callHandler(s,n,true);return}u.configuration=t;a.getPageBuildingService().updatePageSet(u,e=>{s()},n)};this.getDefaultPage=function(){p();return r};this.getId=function(){return d};this.getPages=function(){p();return o.slice()};this.isStub=function(){return f};this.load=function(e,t){if(!f){throw new i("Page set is not a stub anymore","PageSet")}a.getPageBuildingService().readPageSet(d,t=>{s.debug(`Loaded: ${c}`,null,"PageSet");h(t);e()},t,true)};this.toString=function(e){const t=['PageSet({sId:"',d,'",bIsStub:',f];if(e){t.push(",oAlterEgo:",JSON.stringify(u),",oFactory:",a.toString(e),",aPages:",JSON.stringify(o))}t.push("})");return t.join("")}}return a});
//# sourceMappingURL=PageSet.js.map