// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["./WorkPageService","sap/ushell/Config","sap/ushell/utils/LaunchpadError"],(e,t,r)=>{"use strict";const i={NO_DESTINATION_FOUND:"NO_DESTINATION_FOUND",COULD_NOT_RETRIEVE_DESTINATIONS:"COULD_NOT_RETRIEVE_DESTINATIONS",NO_CARD_OR_DESTINATION_NAME:"NO_CARD_OR_DESTINATION_NAME",RESOLVED_URL_EMPTY:"RESOLVED_URL_EMPTY"};class s{#e;#t=new Map;constructor(){const e=new URLSearchParams(window.location.search);this._sSiteId=e.get("siteId")||t.last("/core/site/siteId");this.fetchData()}_getContentProviderDestinationMappings(){if(!this._providerPromise){this._providerPromise=new Promise((e,t)=>{this.fetchData().then(t=>{t.forEach(e=>{const t=new Map;e.logicalDataDestinationMappings.forEach(e=>{t.set(e.logicalDestinationName,e.resolvedUrl)});this.#t.set(e.id,t)});return e(this.#t)}).catch(e=>{t(e)})})}return this._providerPromise}async fetchData(){if(!this._dataPromise){try{this._dataPromise=new Promise(async(t,i)=>{this.#e=await new e;try{const e=await this.#e.loadSiteAndDataDestinationMappings();const n=e?.data?.site?.providers?.nodes;if(n&&Object.keys(n[0]).length){return t(n)}return i(new r("Failed to fetch destinations",{reason:s.ERROR_CODES.COULD_NOT_RETRIEVE_DESTINATIONS}))}catch(e){return i(new r("Failed to fetch destinations",{reason:s.ERROR_CODES.COULD_NOT_RETRIEVE_DESTINATIONS},e))}})}catch(e){throw new Error("DestinationResolver: Failed to Initialize the WorkPageService",e)}}return this._dataPromise}resolveCardDestination(e,t){return new Promise((n,a)=>{if(!e||!t){return a(new r("Could not resolver card destination",{reason:i.NO_CARD_OR_DESTINATION_NAME}))}this._getContentProviderDestinationMappings().then(o=>{const _=o.get(t.getReferenceId())?.get(e);if(_){return n(_)}else if(_===""){return a(new r("Could not resolver card destination",{reason:i.RESOLVED_URL_EMPTY}))}return a(new r("Could not resolver card destination",{reason:s.ERROR_CODES.NO_DESTINATION_FOUND}))}).catch(t=>{if(!this._sSiteId){return n(`${location.origin}/dynamic_dest/${e}`)}a(t)})})}}s.ERROR_CODES=i;return s},true);
//# sourceMappingURL=DestinationResolver.js.map