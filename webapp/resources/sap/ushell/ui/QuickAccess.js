// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Element","sap/ui/core/Fragment","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/thirdparty/hasher","sap/ushell/library","sap/ushell/Config","sap/ushell/Container","sap/ushell/resources","sap/ushell/utils","sap/ushell/utils/WindowUtils","sap/ushell/utils/AppType","sap/ushell/EventHub","sap/ushell/api/performance/Extension","sap/ushell/api/performance/NavigationSource"],(e,t,s,i,n,c,o,a,l,r,u,p,h,g,d)=>{"use strict";const f=c.AppType;const A={oExtension:new g,oModel:new i({recentActivities:[],frequentActivities:[]}),oQuickAccessDialog:null,_createQuickAccessDialog:async function(s){const i=await t.load({name:"sap.ushell.ui.QuickAccess",type:"XML",controller:this});i.setModel(this.oModel);i.attachAfterClose(this._onAfterClose.bind(this,s));e.getElementById("mainShell").addDependent(i);this.oQuickAccessDialog=i;return i},_onAfterClose:function(t){this.oQuickAccessDialog.destroy();if(s.system.desktop){const s=e.getElementById(t);if(s){s.focus()}else{sap.ui.require(["sap/ushell/components/ComponentKeysHandler"],e=>{e.getInstance().then(e=>{e.goToLastVisitedTile()})})}}},_updateQuickAccessDialog:async function(e){const t=e.getContent()[0];t.setBusy(true);const s=await a.getServiceAsync("UserRecents");const i=await new Promise(e=>{s.getRecentActivity().then(t=>{e(t.map(e=>{e.timestamp=r.formatDate(e.timestamp);return e}))}).catch(()=>{e([])})});const n=await new Promise(e=>{s.getFrequentActivity().then(t=>{e(t)}).catch(()=>{e([])})});this.oModel.setData({recentActivities:i,frequentActivities:n});this._setDialogContentHeight(e,Math.max(i.length,n.length));t.setBusy(false)},_setDialogContentHeight:function(e,t){let s=(t+.5)*4+2.75;if(s<18){s=18}else if(s>42){s=42}e.setContentHeight(`${s}rem`)},_closeDialog:function(){this.oQuickAccessDialog.close()},_titleFormatter:function(e,t){if(t===f.SEARCH){e=`"${e}"`}return e},_descriptionFormatter:function(e){if(e===f.SEARCH){return l.i18n.getText("recentActivitiesSearchDescription")}return p.getDisplayName(e)},_itemPress:function(e){const t=e.getParameter("listItem").getBindingContextPath();const s=this.oModel.getProperty(t);this.oExtension.addNavigationSource(/recentActivities/.test(t)?d.RecentlyUsed:d.FrequentlyUsed);h.emit("UITracer.trace",{reason:"LaunchApp",source:"Link",data:{targetUrl:s.url}});if(s.url[0]==="#"){n.setHash(s.url);this._closeDialog()}else{const e=o.last("/core/shell/enableRecentActivity")&&o.last("/core/shell/enableRecentActivityLogging");if(e){const e={title:s.title,appType:f.URL,url:s.url,appId:s.url};a.getRendererInternal("fiori2").logRecentActivity(e)}u.openURL(s.url,"_blank")}}};return{openQuickAccessDialog:async function(e,t){const s=await A._createQuickAccessDialog(t);const i=s.getContent()[0];A._updateQuickAccessDialog(s);i.setSelectedKey(e);s.setInitialFocus(e);s.open()},_getQuickAccess:function(){return A}}});
//# sourceMappingURL=QuickAccess.js.map