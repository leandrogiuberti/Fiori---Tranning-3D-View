// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/ushell/UserActivityLog","sap/ushell/resources","sap/ushell/Container","sap/ushell/state/StateManager"],(t,e,o,a,n,i,s)=>{"use strict";const c=s.LaunchpadState;const r="contactSupportDialogFragment";return t.extend("sap.ushell.ui.footerbar.ContactSupportDialog.controller",{onBeforeOpen:function(){this._setupModel()},onAfterClose:function(){this._getDialog().destroy();const t=window.document.activeElement;const e=window.document.getElementById("userActionsMenuHeaderButton");if(t&&t.tagName==="BODY"&&e){e.focus()}delete this.oSupportDialog},_getDialog:function(){if(!this.oSupportDialog){this.oSupportDialog=e.byId(r,"ContactSupportDialog")}return this.oSupportDialog},_setupModel:function(){const t=a.getMessageInfo();const e=t.userDetails;const i={showTechInfo:false,showAppData:s.getLaunchpadState()===c.App,subject:"",description:"",userName:e.fullName||"",host:window.location.host,email:e.eMail||"",language:e.Language||"",navigationHash:t.navigationData.navigationHash||"",applicationType:"",url:"",additionalInformation:""};if(t.navigationData.applicationInformation){i.applicationType=t.navigationData.applicationInformation.applicationType;i.url=t.navigationData.applicationInformation.url;i.additionalInformation=t.navigationData.applicationInformation.additionalInformation}const r=this._getDialog();const l=new o(i);r.setModel(n.i18nModel,"i18n");r.setModel(l);this.oClientContext=t},showTechnicalData:function(){this._getDialog().getModel().setProperty("/showTechInfo",true);e.byId(r,"subjectInput").focus()},_checkErrorState:function(t){if(!t.getValue()){t.setValueState("Error")}else{t.setValueState("None")}},onInputChange:function(t){this._checkErrorState(t.getSource())},closeDialog:function(){this._getDialog().close()},onSend:async function(){const t=e.byId(r,"subjectInput");const o=e.byId(r,"textArea");const a=t.getValue();const s=o.getValue();this._checkErrorState(t);this._checkErrorState(o);if(a&&s){const t=await i.getServiceAsync("SupportTicket");const e=await i.getServiceAsync("MessageInternal");try{await t.createTicket({subject:a,text:s,clientContext:this.oClientContext});e.info(n.i18n.getText("supportTicketCreationSuccess"))}catch(t){e.error(n.i18n.getText("supportTicketCreationFailed"))}this.closeDialog()}}})});
//# sourceMappingURL=ContactSupportDialog.controller.js.map