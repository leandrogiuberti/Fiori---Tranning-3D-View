// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/integration/Extension","sap/ushell/utils/UrlParsing","sap/ushell/utils/AppType","sap/ushell/library","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/Container"],(e,t,s,i,n,r,a,o)=>{"use strict";const c=i.AppType;function p(e,t){if(t===c.SEARCH){return`"${e}"`}return e}function l(e){if(e===c.SEARCH){return a.i18n.getText("recentActivitiesSearchDescription")}return s.getDisplayName(e)}return e.extend("sap.ushell.ui.cards.FrequentActivitiesExtension",{init:function(){e.prototype.init.apply(this,arguments);this.oUserRecentsPromise=o.getServiceAsync("UserRecents");this.oCrossAppNavPromise=o.getServiceAsync("CrossApplicationNavigation")},exit:function(){e.prototype.exit.apply(this,arguments);r.on("newUserRecentsItem").off();r.on("userRecentsCleared").off()},onCardReady:function(){r.on("newUserRecentsItem").do(()=>{this.getCard().refreshData()});r.on("userRecentsCleared").do(()=>{this.getCard().refreshData()})},getData:function(){if(this._sortedData){return Promise.resolve(this._resolvedData)}return this.oUserRecentsPromise.then(e=>e.getFrequentActivity()).then(this._getActivitiesAsCardItems.bind(this)).then(this._checkEnabled.bind(this))},_getActivitiesAsCardItems:function(e){const s=[];for(let i=0;i<e.length;i++){if(e[i].url&&e[i].url!==""){const n=t.parseShellHash(e[i].url);const r={Name:p(e[i].title,e[i].appType),Description:l(e[i].appType),Icon:e[i].icon||"sap-icon://product",Url:e[i].url};if(n){r.Intent={SemanticObject:n.semanticObject,Action:n.action,Parameters:n.params,AppSpecificRoute:n.appSpecificRoute}}else{r.Url=e[i].url}s.push(r)}}return s},_checkEnabled:function(e){const t=e.map(e=>this._isActionEnabled(e).then(t=>{e.Enabled=t;return e}));return Promise.all(t)},_isActionEnabled:function(e){const s=t.parseShellHash(e.Url);if(!s){return Promise.resolve(true)}const i=s.params;const n={target:{semanticObject:s.semanticObject,action:s.action},params:i};return this.oCrossAppNavPromise.then(e=>new Promise(t=>{e.isNavigationSupported([n]).done(e=>{t(e[0].supported)}).fail(()=>{t(false)})}))}})});
//# sourceMappingURL=FrequentActivitiesExtension.js.map