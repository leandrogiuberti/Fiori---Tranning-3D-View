// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/integration/Extension","sap/ushell/utils/UrlParsing","sap/ushell/utils/AppType","sap/ushell/library","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/Container"],(e,t,s,n,i,r,a,o)=>{"use strict";const c=n.AppType;function p(e,t){if(t===c.SEARCH){return`"${e}"`}return e}function l(e){if(e===c.SEARCH){return a.i18n.getText("recentActivitiesSearchDescription")}return s.getDisplayName(e)}return e.extend("sap.ushell.ui.cards.RecentActivitiesExtension",{init:function(){e.prototype.init.apply(this,arguments);this.oUserRecentsPromise=o.getServiceAsync("UserRecents");this.oCrossAppNavPromise=o.getServiceAsync("CrossApplicationNavigation")},exit:function(){e.prototype.exit.apply(this,arguments);r.on("newUserRecentsItem").off();r.on("userRecentsCleared").off()},onCardReady:function(){r.on("newUserRecentsItem").do(()=>{this.getCard().refreshData()});r.on("userRecentsCleared").do(()=>{this.getCard().refreshData()})},getData:function(){return this.oUserRecentsPromise.then(e=>e.getRecentActivity()).then(this._getActivitiesAsCardItems.bind(this)).then(this._checkEnabled.bind(this))},_getActivitiesAsCardItems:function(e){const s=[];for(let n=0;n<e.length;n++){if(e[n].url&&e[n].url!==""){const i=t.parseShellHash(e[n].url);const r={Name:p(e[n].title,e[n].appType),Description:l(e[n].appType),Icon:e[n].icon||"sap-icon://product",Url:e[n].url};if(i){r.Intent={SemanticObject:i.semanticObject,Action:i.action,Parameters:i.params,AppSpecificRoute:i.appSpecificRoute}}else{r.Url=e[n].url}s.push(r)}}return s},_checkEnabled:function(e){const t=e.map(e=>this._isActionEnabled(e).then(t=>{e.Enabled=t;return e}));return Promise.all(t)},_isActionEnabled:function(e){const s=t.parseShellHash(e.Url);if(!s){return Promise.resolve(true)}const n=s.params;const i={target:{semanticObject:s.semanticObject,action:s.action},params:n};return this.oCrossAppNavPromise.then(e=>new Promise(t=>{e.isNavigationSupported([i]).done(e=>{t(e[0].supported)}).fail(()=>{t(false)})}))}})});
//# sourceMappingURL=RecentActivitiesExtension.js.map