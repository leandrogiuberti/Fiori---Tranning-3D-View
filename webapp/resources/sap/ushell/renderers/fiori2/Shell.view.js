// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/m/Avatar","sap/m/library","sap/ushell/renderer/shellHeader/ShellHeader.controller","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/utils","sap/ui/core/mvc/XMLView","sap/ui/core/Core","sap/ui/core/Component","sap/ushell/Container","sap/ushell/renderer/ShellLayout","sap/ushell/state/ShellModel","sap/ushell/state/StateManager","sap/ushell/state/BindingHelper"],(e,t,n,i,o,l,a,r,s,d,h,c,g,u,p,f)=>{"use strict";const y=n.AvatarSize;const A=p.Operation;const M=g.ShellArea;const m={Property:"Property",List:"List"};sap.ui.jsview("sap.ushell.renderers.fiori2.Shell",{getControllerName:function(){return"sap.ushell.renderers.fiori2.Shell"},waitForShellLayout:function(){if(!this._oShellLayoutPromise){this._oShellLayoutPromise=new Promise(e=>{this.getController().addDoable(l.once("ShellLayoutApplied").do(e))})}return this._oShellLayoutPromise},getViewDataConfig:function(){const e=this.getViewData()||{};const t=e.config||{};return t},createContent:function(){this._createUserActionsMenuButton(u.getConfigModel());this._allowUpToThreeActionInShellHeader();p.init(this.getViewDataConfig());this.initBackgroundImage();this.createShellHeaderSync();this.setNavigationBarMinHeight();const e=this.createRendererRootViewSync();this.setDisplayBlock(true);r.setPerformanceMark("FLP - Shell.view rendering started!");return e},initBackgroundImage:function(){this.waitForShellLayout().then(()=>{const e=document.getElementById(M.BackgroundImage);const t=["<div class='sapUiShellBackgroundImage sapUiGlobalBackgroundImageForce sapContrastPlus'></div>","<div class='sapMShellBG sapUiGlobalBackgroundImage'></div>"].join("\n");e.insertAdjacentHTML("afterbegin",t)})},createRendererRootViewSync:function(){const e=this.getController();const t=sap.ui.xmlfragment("sap.ushell.renderer.RendererRootView",e);f.overrideUpdateAggregation(t);return t},createRendererRootViewSyncFallback:function(){const e=this.getController();const t=sap.ui.xmlfragment("sap.ushell.renderer.RendererRootViewFallback",e);f.overrideUpdateAggregation(t);return t},createShellHeaderSync:function(){const e=new i;const t=sap.ui.xmlfragment("sap.ushell.renderer.shellHeader.ShellHeader",e);f.overrideUpdateAggregation(t);t.setModel(u.getModel(),"shellModel");t.setModel(a.i18nModel,"i18n");this.addDanglingControl(t);this._oShellHeader=t;this.waitForShellLayout().then(()=>{t.placeAt(M.ShellHeader,"only");e.onInit()});return t},setNavigationBarMinHeight:function(){return sap.ushell.Container.getServiceAsync("Menu").then(e=>e.isMenuEnabled()).then(e=>{if(!e){return}this.waitForShellLayout().then(()=>{const e=document.getElementById(M.NavigationBar);e.classList.add("sapUshellMenuBarHeight")})}).catch(t=>{e.info("Could not apply min-height of the navigationBar",t)})},createRightFloatingContainer:function(){sap.ui.require(["sap/ushell/ui/shell/RightFloatingContainer"],e=>{const t=new e({id:"right-floating-container",top:"2",right:"2",hideItemsAfterPresentation:true,visible:"{shellModel>/rightFloatingContainer/visible}",floatingContainerItems:{path:"shellModel>/rightFloatingContainer/items",factory:f.factory}});f.overrideUpdateAggregation(t);t.setModel(u.getModel(),"shellModel");this.addDanglingControl(t);this._oRightFloatingContainer=t;this.waitForShellLayout().then(()=>{t.placeAt(M.RightFloatingContainer,"only")})})},createSubHeader:function(){sap.ui.require(["sap/ushell/ui/shell/SubHeader"],e=>{const t=new e({id:"subhdr",content:{path:"shellModel>/subHeader/items",factory:f.factory}});f.overrideUpdateAggregation(t);t.setModel(u.getModel(),"shellModel");this.addDanglingControl(t);this.waitForShellLayout().then(()=>{t.placeAt(M.SubHeader,"only")})})},createFloatingContainer:function(){return h.create({name:"sap.ushell.components.shell.FloatingContainer"})},createSidePane:function(){sap.ui.require(["sap/ushell/ui/shell/SidePane"],e=>{const t=new e({id:"shell-sidePane",visible:"{shellModel>/sidePane/visible}",content:{path:"shellModel>/sidePane/items",factory:f.factory}});f.overrideUpdateAggregation(t);t.setModel(u.getModel(),"shellModel");this.addDanglingControl(t);this.waitForShellLayout().then(()=>{t.placeAt(M.SidePane,"only")})})},createToolArea:function(){sap.ui.require(["sap/ushell/ui/shell/ToolArea"],e=>{const t=new e({id:"shell-toolArea",visible:"{shellModel>/toolArea/visible}",toolAreaItems:{path:"shellModel>/toolArea/items",factory:f.factory}});f.overrideUpdateAggregation(t);t.setModel(u.getModel(),"shellModel");this.addDanglingControl(t);this.waitForShellLayout().then(()=>{t.placeAt(M.ToolArea,"only")})})},createFloatingActions:function(){sap.ui.require(["sap/ushell/ui/shell/ShellFloatingActions"],e=>{const t=new e({id:"shell-floatingActions",floatingActions:{path:"shellModel>/floatingActions/items",factory:f.factory}});f.overrideUpdateAggregation(t);t.setModel(u.getModel(),"shellModel");this.addDanglingControl(t);this.waitForShellLayout().then(()=>{t.placeAt(M.FloatingActions,"only")})})},initAllMyAppsView:function(){return sap.ushell.Container.getServiceAsync("AllMyApps").then(e=>{if(e.isEnabled()){return this.createAllMyAppsView()}})},createAllMyAppsView:function(){return s.create({id:"allMyAppsView",viewName:"sap.ushell.renderer.allMyApps.AllMyApps"}).then(e=>{e.setModel(u.getConfigModel(),"configModel");e.setModel(a.i18nModel,"i18n");e.addCustomData(new o({key:"aria-label",value:a.i18n.getText("allMyApps_headerTitle"),writeToDom:true}));this.addDanglingControl(e);this.getShellHeader().getAppTitle().setAllMyApps(e)})},createPostCoreExtControls:function(){const e=u.getModel();sap.ui.require(["sap/ui/core/Popup"],e=>{e.setInitialZIndex(11)});this.bindFactory({model:e,factory:this.createFloatingContainer.bind(this),bindingPath:"/floatingContainer/items",bindingType:m.List,valueCheck:function(e){return!!e.length}});this.bindFactory({model:e,factory:this.createRightFloatingContainer.bind(this),bindingPath:"/rightFloatingContainer/visible",bindingType:m.Property,valueCheck:function(e){return!!e}});this.bindFactory({model:e,factory:this.createSubHeader.bind(this),bindingPath:"/subHeader/items",bindingType:m.List,valueCheck:function(e){return!!e.length}});this.bindFactory({model:e,factory:this.createToolArea.bind(this),bindingPath:"/toolArea/visible",bindingType:m.Property,valueCheck:function(e){return!!e}});this.bindFactory({model:e,factory:this.createSidePane.bind(this),bindingPath:"/sidePane/visible",bindingType:m.Property,valueCheck:function(e){return!!e}});this.bindFactory({model:e,factory:this.createFloatingActions.bind(this),bindingPath:"/floatingActions/items",bindingType:m.List,valueCheck:function(e){return!!e.length}});this.addPendingInitialization(this.initAllMyAppsView())},_allowUpToThreeActionInShellHeader:function(){const e=["moveAppFinderActionToShellHeader","moveUserSettingsActionToShellHeader","moveContactSupportActionToShellHeader","moveEditHomePageActionToShellHeader"];const t=this.getViewDataConfig();e.reduce((e,n)=>{if(t[n]){e++}else{t[n]=false}return e},0)},_createUserActionsMenuButton:function(e){const n=c.getUser();const i=a.i18n.getText("UserActionsMenuToggleButtonAria",[n.getFullName()||n.getId()]);const o=new t({id:"userActionsMenuHeaderButton",src:"{configModel>/userImage/personPlaceHolder}",initials:n.getInitials(),ariaHasPopup:"Menu",displaySize:y.XS,tooltip:i,press:function(){l.emit("showUserActionsMenu",Date.now())}});o.setModel(e,"configModel");this.addDanglingControl(o);p.updateAllBaseStates("header.headEndItems",A.Add,"userActionsMenuHeaderButton")},getShellHeader:function(){return this._oShellHeader},getRightFloatingContainer:function(){return this._oRightFloatingContainer},bindFactory:function(e){const t=e.model;const n=e.factory;const i=e.bindingPath;const o=e.bindingType;const l=e.valueCheck;let a=t.getProperty(i);if(l(a)){n()}else{let e;switch(o){case m.List:e=t.bindList(i);break;default:e=t.bindProperty(i)}this.addDanglingBinding(e);e.attachChange(function(){a=e.getModel().getProperty(e.getPath());if(l(a)){this.removeDanglingBinding(e);e.destroy();n()}},this)}},addDanglingBinding:function(e){this.getController().addDanglingBinding(e)},removeDanglingBinding:function(e){this.getController().removeDanglingBinding(e)},addDanglingControl:function(e){this.getController().addDanglingControl(e)},addPendingInitialization:function(e){return this.getController().addPendingInitialization(e)}})});
//# sourceMappingURL=Shell.view.js.map