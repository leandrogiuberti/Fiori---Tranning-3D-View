// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/ui/performance/trace/Interaction","sap/ushell/api/performance/Extension"],(t,i,e)=>{"use strict";const r="StatisticalRecord";const s="[FesrFlp]";const o={OPEN:"OPEN",CLOSED:"CLOSED",ERROR:"ERROR"};const a=new e;class n{#t=null;#i=null;#e=false;#r=o.OPEN;#s=null;#o=null;#a=null;#n=null;#l=null;#c=null;#p=null;#h=null;#d=null;#u={};#g=null;constructor(){t.debug(`${s} ======================================`,"‾‾‾ OPEN ‾‾‾",r);t.debug(`${s} Opening Record`,null,r);this.#A()}setNavigationMode(t){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}this.#i=t}setHomepageLoading(t){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}this.#e=t}getSourceApplication(){return this.#l}#A(){if(!this.#g){t.debug(`${s} Interaction Start`,null,r);this.#g=i.notifyAsyncStep()}}#E(){if(this.#g){t.debug(`${s} Interaction End`,null,r);this.#g();this.#g=null}}#m(){t.debug(`${s} Calculating Step`,null,r);const i=a.getNavigationSource();const e=i?`:${i.id}`:"";const o=this.#h||this.#S(this.#p);const n=this.#c||this.#S(this.#l);if(!this.#p&&!this.#l){return""}if(!this.#l&&o){return"FLP@DURING_LOAD"}if(!this.#l&&!o){return"FLP@DEEP_LINK"}if(!o&&!n){return`A2A@${this.#l}${e}`}if(this.#l&&o&&!n){return`FLP_BACK@${this.#l}${e}`}if(n&&o){if(["FLP_FINDER","FLP_HOME"].includes(this.#p)){return`${this.#p}@H2H${e}`}if(this.#h){return`${this.#p}@H2H${e}`}return`${this.#u.pageId}@H2H${e}`}if(this.#S(this.#l)){return`FLP@HOMEPAGE_TILE${e}`}if(this.#c){return`APPSTART@CUSTOMHOME${e}`}return""}isEqual(t){return this.#a===t.getTimeStart()}closeRecord(){this.#s=this.#m();this.#r=o.CLOSED;this.#n=performance.now();if(this.#a){this.#t=this.#n-this.#a}this.#E();t.debug(`${s} Closing Record`,`${this.#s} - ${this.getTargetAppNameShort()||this.#p}`,r);t.debug(`${s} ======================================`,"___ CLOSE ___",r)}closeRecordWithError(){this.#r=o.ERROR;this.#n=performance.now();this.#t=this.#n-this.#a;this.#E();t.debug(`${s} Closing Record with Error`,`${this.getTargetAppNameShort()||this.#p}`,r);t.debug(`${s} ======================================`,"___ CLOSE ___",r)}isClosed(){return this.#r===o.CLOSED}isClosedWithError(){return this.#r===o.ERROR}getStep(){if(!this.isClosed()&&!this.isClosedWithError()){throw new Error("Statistical record is still open no step can be determined!")}return this.#s}getTimeStart(){return this.#a}setTimeStart(t){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}this.#a=t}getTimeEnd(){return this.#n}setSourceApplication(i){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}t.debug(`${s} Record setSource: ${i}`,null,r);this.#l=i}getTargetApplication(){return this.#p}setTargetApplication(i){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}t.debug(`${s} Record setTarget: ${i}`,null,r);this.#p=i}getTargetAppNameShort(){if(this.#p==="FLP_PAGE"){const{pageId:t}=this.#u;if(t){return"FLP_PAGE"}}return null}getTargetApplicationType(){return this.#d}setTargetApplicationType(t){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}this.#d=t}setTargetIsHomeApp(t){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}this.#h=!!t}getTargetIsHomeApp(){return!!this.#h}setTargetHash(t){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}this.#o=t}getTargetHash(){return this.#o}setSourceIsHomeApp(t){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}this.#c=!!t}getSourceIsHomeApp(){return!!this.#c}#S(t){return t&&["FLP_HOME","FLP_PAGE","FLP_FINDER"].includes(t)}enhanceTargetApplicationData(t){if(this.isClosed()||this.isClosedWithError()){throw new Error("Statistical record is already closed!")}this.#u={...this.#u,...t}}}return n},false);
//# sourceMappingURL=StatisticalRecord.js.map