// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/Device","sap/m/MessageBox","sap/m/MessageToast","sap/ui/core/Element","sap/ushell/resources","sap/ushell/EventHub","sap/base/Log","sap/ushell/Container"],(e,t,n,o,i,s,c,r)=>{"use strict";const a={};a.start=function(t,n){this.oController=t;const c=t.getView().getModel("viewSettings");const r=c.getProperty("/addToMyHomeOnly");if(!r){t.getView().getModel("viewSettings").setProperty("/actionModeEditActive",true)}t.getView().getModel("viewSettings").setProperty("/actionModeActive",true);t.handleMyHomeActionMode(true).catch(t.navigateToErrorPage.bind(t));s.emit("enableMenuBarNavigation",false);const a=o.getElementById("ActionModeBtn");this.sActionButtonActivateText=a.getText();n=n||i.i18n.getText("PageRuntime.EditMode.Exit");a.setTooltip(n);a.setText(n);if(e.system.desktop){sap.ui.require(["sap/ushell/renderer/AccessKeysHandler"],e=>{e.attachEvent("editModeDone",this.save,this)})}};a.cancel=function(){this._cleanup()};a.save=function(){c.info("store actions in pages service");this._cleanup()};a._cleanup=function(){this.oController.getView().getModel("viewSettings").setProperty("/actionModeActive",false);this.oController.getView().getModel("viewSettings").setProperty("/actionModeEditActive",false);this.oController.handleMyHomeActionMode(false).catch(this.oController.navigateToErrorPage.bind(this.oController));s.emit("enableMenuBarNavigation",true);const t=o.getElementById("ActionModeBtn");t.setTooltip(this.sActionButtonActivateText);t.setText(this.sActionButtonActivateText);if(e.system.desktop){sap.ui.require(["sap/ushell/renderer/AccessKeysHandler"],e=>{e.detachEvent("editModeDone",this.save,this)})}};a.addVisualization=function(e,t){const n=t.getBindingContext().getModel();const o=t.getBindingContext().getPath();const i=o.split("/");const s=parseInt(i[2],10);const c=n.getProperty(`/pages/${s}/id`);const a=n.getProperty(`${o}/id`);r.getServiceAsync("Navigation").then(e=>{const t=`Shell-appfinder?&/catalog/${JSON.stringify({pageID:encodeURIComponent(c),sectionID:encodeURIComponent(a)})}`;e.navigate({target:{shellHash:t}})})};a.addSection=function(e,t,n){const o=n.index;const i=t.getBindingContext().getPath();const s=i.split("/");const c=parseInt(s[2],10);return this.oController.getOwnerComponent().getPagesService().then(e=>{e.addSection(c,o);const n={onAfterRendering:function(){setTimeout(()=>{t.getSections()[o].getTitleInput().focus()},0);t.removeEventDelegate(n)}};t.addEventDelegate(n)})};a.deleteSection=function(e,o){return r.getServiceAsync("MessageInternal").then(e=>{const s=o.getTitle();const c=s?i.i18n.getText("PageRuntime.Message.Section.Delete",[s]):i.i18n.getText("PageRuntime.Message.Section.DeleteNoTitle");const r=i.i18n.getText("PageRuntime.Dialog.Title.Delete");function a(e){if(e===t.Action.DELETE){this.oController.getOwnerComponent().getPagesService().then(e=>{const t=o.getBindingContext().getPath();const s=o.getParent();const c=t.split("/");const r=parseInt(c[2],10);const a=parseInt(c[4],10);e.deleteSection(r,a);n.show(i.i18n.getText("PageRuntime.Message.SectionDeleted"));const g=s.getSections();if(g.length){const e=g[a!==0?a-1:a];e.focus();const t={onAfterRendering:function(){e.focus();e.removeEventDelegate(t)}};e.addEventDelegate(t)}else{const e={onAfterRendering:function(){s.focus();s.removeEventDelegate(e)}};s.addEventDelegate(e)}})}}e.confirm(c,a.bind(this),r,[t.Action.DELETE,t.Action.CANCEL])})};a.resetSection=function(e,t){const o=t.getBindingContext().getPath();const s=o.split("/");const c=parseInt(s[2],10);const r=parseInt(s[4],10);return this.oController.getOwnerComponent().getPagesService().then(e=>{e.resetSection(c,r);n.show(i.i18n.getText("PageRuntime.Message.SectionReset"))})};a.changeSectionTitle=function(e,t,n){const o=t.getBindingContext().getPath();const i=t.getProperty("title");const s=o.split("/");const c=parseInt(s[2],10);const r=parseInt(s[4],10);return this.oController.getOwnerComponent().getPagesService().then(e=>{e.renameSection(c,r,i)})};a.moveSection=function(e,t,n){const o=n.draggedControl.getBindingContext().getPath();const i=n.droppedControl.getBindingContext().getPath();const s=n.dropPosition;const c=i.split("/");const r=o.split("/");const a=parseInt(r[2],10);const g=parseInt(r[4],10);let l=parseInt(c[4],10);if(g===l-1&&s==="Before"||g===l+1&&s==="After"){return Promise.resolve()}if(s==="After"){l=l+1}const d=this.oController.getOwnerComponent();return d.getPagesService().then(e=>e.moveSection(a,g,l)).then(()=>{t.announceMove();t.getSections()[l!==0&&l>g?l-1:l].focus()})};a.changeSectionVisibility=function(e,t,n){if(this.oController===undefined||n.visible===undefined){return Promise.resolve()}const o=t.getBindingContext().getPath();const i=n.visible;const s=o.split("/");const c=parseInt(s[2],10);const r=parseInt(s[4],10);return this.oController.getOwnerComponent().getPagesService().then(e=>{e.setSectionVisibility(c,r,i)})};return a});
//# sourceMappingURL=ActionMode.js.map