// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/i18n/Localization","sap/ushell/EventHub","sap/ushell/Config","sap/ushell/utils/HttpClient","sap/base/util/ObjectPath","sap/ushell/Container"],(e,t,s,n,r,o)=>{"use strict";const a={};const i="/UI2/Fiori2LaunchpadHome";a.getData=function(){if(!this.oPageSetPromise){this.oPageSetPromise=new Promise((t,s)=>{const a="PageSets('%2FUI2%2FFiori2LaunchpadHome')"+"?$expand=Pages/PageChipInstances/ChipInstanceBags/ChipInstanceProperties,"+"Pages/PageChipInstances/Chip"+"&$format=json";const i={"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0","Accept-Language":e.getLanguage()||"",Accept:"application/json, text/plain"};const c=o.getUser().getLanguage();if(c){i["sap-language"]=c}const l=o.getLogonSystem();const u=l&&l.getClient();if(u){i["sap-client"]=u}const p=window["sap-ushell-config"].services&&window["sap-ushell-config"].services.PageBuilding||{};const d=(r.get("config.services.pageBuilding.baseUrl",p.adapter)||"").replace(/\/?$/,"/");const g=new n(d,{headers:i});g.get(a).then(e=>{t(this.parseData.bind(this)(e))}).catch(s)})}return this.oPageSetPromise};a.isImportEnabled=function(){return o.getServiceAsync("UserInfo").then(e=>{const t=e.getUser();const s=t.getImportBookmarksFlag();switch(s){case"done":case"dismissed":case"not_required":return false;case null:return this.getData().then(s=>{const n=!!s.length;const r=n?"pending":"not_required";t.setImportBookmarksFlag(r);e.updateUserPreferences();t.resetChangedProperty("importBookmarks");return n});default:return true}})};a.parseData=function(e){try{let t=JSON.parse(e.responseText);if(t&&t.d){t=t.d}const n=t.configuration&&JSON.parse(t.configuration)||{};const r=n.hiddenGroups||[];const o=t.Pages.results.filter(e=>{const t=e.scope==="PERSONALIZATION";const s=e.PageChipInstances.results.length>0;const n=r.indexOf(e.id)===-1;return t&&s&&n});const a=n.order||[];o.sort((e,t)=>{if(a.indexOf(e.id)>a.indexOf(t.id)){return 1}if(a.indexOf(e.id)<a.indexOf(t.id)){return-1}return 0});let c=[];let l;const u=[];o.forEach(e=>{let t;if(e.layout){t=JSON.parse(e.layout)}const s={id:e.id,title:e.title,isLocked:e.isPersLocked==="X",isDefault:e.id===i,tileOrder:t&&t.order||[],linkOrder:t&&t.linkOrder||[],chips:e.PageChipInstances.results};if(s.isLocked){c.push(s)}else if(s.isDefault){l=s}else{u.push(s)}});if(!s.last("/core/home/disableSortedLockedGroups")){c.sort((e,t)=>e.title.toLowerCase()<t.title.toLowerCase()?-1:1)}if(l){c=c.concat(l)}return c.concat(u)}catch{return null}};a.setImportEnabled=function(e){t.emit("importBookmarksFlag",!!e);o.getServiceAsync("UserInfo").then(t=>{const s=t.getUser();const n=e?null:"dismissed";s.setImportBookmarksFlag(n);t.updateUserPreferences();s.resetChangedProperty("importBookmarks")})};return a});
//# sourceMappingURL=MyHomeImport.js.map