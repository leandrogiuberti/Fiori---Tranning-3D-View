// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/EventBus","sap/ui/thirdparty/hasher","sap/ushell/utils","sap/ushell/EventHub"],(i,t,e,s)=>{"use strict";const a={};a.init=function(t,e){this.aRefreshVisualizations=[];this.oPagesVisibility={};this.oPagesRuntimeNavContainer=t;this.oPagesNavContainer=e;this.oPagesRuntimeNavContainer.attachNavigate(this._onOuterNavContainerNavigated,this);this.oPagesNavContainer.attachNavigate(this._onPageNavigated,this);this._onTabNavigatedBind=this._onTabNavigated.bind(this);document.addEventListener("visibilitychange",this._onTabNavigatedBind);this.oEventBus=i.getInstance();this.oEventBus.subscribe("launchpad","setConnectionToServer",this._onEnableRequests,this);this.oEventBus.subscribe("sap.ushell","navigated",this._onShellNavigated,this);this.oEventHubListener=s.once("PagesRuntimeRendered").do(()=>{this._setCurrentPageVisibility(true)})};a._onEnableRequests=function(i,t,e){if(!e||e.active===undefined){return}this._setCurrentPageVisibility(e.active)};a._setCurrentPageVisibility=function(i){const t=this.oPagesNavContainer.getCurrentPage();if(t){this._setPageVisibility(t,i,false)}};a._setPageVisibility=function(i,t,e){if(!i){return}if(i.getContent()[0].isA("sap.ushell.ui.launchpad.Page")){const s=i.getBindingContext().getPath();if(this.oPagesVisibility[s]===t){return}this.oPagesVisibility[s]=t;this._visitVisualizations(i,i=>{i.setActive(t,e)})}};a._isPagesNavContainerVisible=function(){return this.oPagesRuntimeNavContainer.getCurrentPage()===this.oPagesNavContainer};a._visitVisualizations=function(i,t){if(!t){return}i.getContent()[0].getSections().forEach(i=>{i.getVisualizations().forEach(t)})};a._onShellNavigated=function(){const i=t.getHash();if(e.isFlpHomeIntent(i)&&this._isPagesNavContainerVisible()){this._setCurrentPageVisibility(true);this._refreshVisualizations()}else{this._setCurrentPageVisibility(false)}return Promise.resolve()};a.addVisualizationForRefresh=function(i){this.aRefreshVisualizations.push(i)};a._refreshVisualizations=function(){this.aRefreshVisualizations.forEach(i=>{i.setActive(i.getActive(),true)});this.aRefreshVisualizations=[]};a._onTabNavigated=function(){const i=t.getHash();if(e.isFlpHomeIntent(i)&&this._isPagesNavContainerVisible()){this._setCurrentPageVisibility(!document.hidden)}return Promise.resolve()};a._onPageNavigated=function(i){if(this._isPagesNavContainerVisible()){const t=i.getParameters();this._setPageVisibility(t.from,false,false);this._setPageVisibility(t.to,true,false)}};a._onOuterNavContainerNavigated=function(i){const t=i.getParameter("to");const e=t===this.oPagesNavContainer;this._setCurrentPageVisibility(e)};a.getPageVisibility=function(i){return this.oPagesVisibility[i]};a.exit=function(){this.oEventBus.unsubscribe("sap.ushell","navigated",this._onShellNavigated,this);document.removeEventListener("visibilitychange",this._onTabNavigatedBind);this.oPagesNavContainer.detachNavigate(this._onPageNavigated,this);this.oPagesRuntimeNavContainer.detachNavigate(this._onOuterNavContainerNavigated,this);this.oEventBus.unsubscribe("launchpad","setConnectionToServer",this._onEnableRequests,this);this.oEventHubListener.off()};return a});
//# sourceMappingURL=StateManager.js.map