// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/Device"],(jQuery,e)=>{"use strict";const t={};t.initialized=[];t.parse=function(t,n){let l={};const o={};const i={};const s={};const a={};let r="";let d;let f;let p;let c;let u;let h;let g;let N;let m;let x;let y;let A;let T;let b;let P;let $;let S;let v;let O;let R;let V;let D;let E;let C;let w;let U;let I;let L;let X;let _;let z;let F;if(e.browser.internet_explorer){l={setNameSpace:function(e){e.setProperty("SelectionNamespaces",'xmlns:edmx="http://docs.oasis-open.org/odata/ns/edmx" xmlns:d="http://docs.oasis-open.org/odata/ns/edm"');e.setProperty("SelectionLanguage","XPath");return e},selectNodes:function(e,t,n){return n.selectNodes(t)},nextNode:function(e){return e.nextNode()},getNodeText:function(e){return e.text}}}else{l={setNameSpace:function(e){return e},nsResolver:function(e){const t={edmx:"http://docs.oasis-open.org/odata/ns/edmx",d:"http://docs.oasis-open.org/odata/ns/edm"};return t[e]||null},selectNodes:function(e,t,n){const l=e.evaluate(t,n,this.nsResolver,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);l.length=l.snapshotLength;return l},nextNode:function(e,t){return e.snapshotItem(t)},getNodeText:function(e){return e.textContent}}}function j(t){let n;if(e.browser.internet_explorer){n=new ActiveXObject("Microsoft.XMLHTTP");n.open("GET",t,false);n.send(null);return n.responseXML}n=jQuery.sap.sjax({url:t,dataType:"xml"});if(n.success){return n.data}}function k(e){let t={};const n={};const l={};let o=false;let i;let s;let a;let r;let d={};let f;let p={};let c={};let u=false;let h;let g;let N;let m;let x;let y;let A;let T;let b;for(i=e.dataServices.schema.length-1;i>=0;i-=1){t=e.dataServices.schema[i];if(t.entityType){s=t.namespace;a=t.entityType;r=t.complexType;for(f in a){if(a.hasOwnProperty(f)){d=a[f];c={};if(d.hasStream&&d.hasStream==="true"){continue}p={};for(N in d.property){h=d.property[N];if(h.type.substring(0,s.length)===s){for(g in r){if(r[g].name===h.type.substring(s.length+1)){for(N in r[g].property){m=r[g].property[N];p[`${r[g].name}/${m.name}`]=m.type}}}}else{x=h.name;y=h.type;for(T in h.extensions){A=h.extensions[T];if(A.name==="display-format"&&A.value==="Date"){y="Edm.Date"}else{u=true;if(!c[x]){c[x]={}}if(A.namespace&&!c[x][A.namespace]){c[x][A.namespace]={}}c[x][A.namespace][A.name]=A.value}}p[x]=y}}if(!n[`${s}.${d.name}`]){n[`${s}.${d.name}`]={}}n[`${s}.${d.name}`]=p;if(u){if(!l[`${s}.${d.name}`]){o=true}l[`${s}.${d.name}`]={};l[`${s}.${d.name}`]=c}}}}}if(o){b={types:n,extensions:l}}else{b={types:n}}return b}function M(e,t,n,l){let o;if(e.charAt(0)==="@"&&e.indexOf(l.Alias)===1){e=e.slice(l.Alias.length+2)}if(e.indexOf("/")>=0){if(t[e.slice(0,e.indexOf("/"))]){n=e.slice(0,e.indexOf("/"));e=e.slice(e.indexOf("/")+1)}}for(o in t[n]){if(t[n].hasOwnProperty(o)){if(e===o){return t[n][o]}}}}function H(e,t,n,l){let o;let i;let s="";for(o in e){if(e.hasOwnProperty(o)){if(e[o]){i=e[o];if(i.Value&&i.Value.Path){s=M(i.Value.Path,t,n,l);if(s){e[o].EdmType=s}continue}if(i.Path){s=M(i.Path,t,n,l);if(s){e[o].EdmType=s}continue}if(i.Facets){e[o].Facets=H(i.Facets,t,n,l);continue}if(i.Data){e[o].Data=H(i.Data,t,n,l);continue}if(o==="Data"){e.Data=H(i,t,n,l);continue}if(i.Value&&i.Value.Apply){e[o].Value.Apply.Parameters=H(i.Value.Apply.Parameters,t,n,l);continue}if(i.Value&&i.Type&&i.Type==="Path"){s=M(i.Value,t,n,l);if(s){e[o].EdmType=s}}}}}return e}function q(e){for(c in o){if(o.hasOwnProperty(c)){if(e.indexOf(`${c}.`)>=0){e=e.replace(`${c}.`,`${o[c]}.`);return e}}}return e}function G(e){let t="";let n="";let l;const o={};for(l=0;l<e.attributes.length;l+=1){if(e.attributes[l].name!=="Property"&&e.attributes[l].name!=="Term"){t=e.attributes[l].name;n=e.attributes[l].value}}if(t.length>0){o[t]=q(n)}return o}function Q(e,t){const n={};let o=null;const i=[];let s;const a=l.selectNodes(e,"./d:*",t);for(s=0;s<a.length;s+=1){o=l.nextNode(a,s);switch(o.nodeName){case"Apply":i.push({Type:"Apply",Value:Q(e,o)});break;case"LabeledElement":i.push({Name:o.getAttribute("Name"),Value:Y(e,o)});break;default:i.push({Type:o.nodeName,Value:l.getNodeText(o)});break}}n.Name=t.getAttribute("Function");n.Parameters=i;return n}function Y(e,t){const n={};let o;let i;let s;let a;let r;let d;if(t.hasChildNodes()){o=l.selectNodes(e,"./d:String",t);if(o.length>0){i=l.nextNode(o,0);n.String=l.getNodeText(i)}else{s=l.selectNodes(e,"./d:Path",t);if(s.length>0){a=l.nextNode(s,0);n.Path=l.getNodeText(a)}else{r=l.selectNodes(e,"./d:Apply",t);if(r.length>0){d=l.nextNode(r,0);n.Apply=Q(e,d)}}}}return n}function B(e,t,n){let o={};let i;let s;let a;let r;let d;let f;let p;let c;let u={};let h;let g;let N;let m;let x;if(t.hasChildNodes()){i=l.selectNodes(e,"./d:Record | ./d:Collection/d:Record | ./d:Collection/d:If/d:Record",t);if(i.length){s=0;for(a=0;a<i.length;a+=1){r=l.nextNode(i,a);d=J(e,r,n);if(r.getAttribute("Type")){d.RecordType=q(r.getAttribute("Type"))}if(s===0){if(r.nextElementSibling||r.parentNode.nodeName==="Collection"||r.parentNode.nodeName==="If"){o=[];o.push(d)}else{o=d}}else{o.push(d)}s+=1}}else{f=l.selectNodes(e,"./d:UrlRef",t);if(f.length>0){for(a=0;a<f.length;a+=1){p=l.nextNode(f,a);o.UrlRef=Y(e,p)}}else{f=l.selectNodes(e,"./d:Url",t);if(f.length>0){for(a=0;a<f.length;a+=1){p=l.nextNode(f,a);o.Url=Y(e,p)}}else{x=l.selectNodes(e,"./d:Collection/d:AnnotationPath | ./d:Collection/d:PropertyPath",t);if(x.length>0){o=[];for(a=0;a<x.length;a+=1){c=l.nextNode(x,a);u={};u[c.nodeName]=l.getNodeText(c);o.push(u)}}else{o=G(t);h=l.selectNodes(e,"./d:Annotation",t);g={};for(N=0;N<h.length;N+=1){g=l.nextNode(h,N);if(g.hasChildNodes()===false){m=q(g.getAttribute("Term"));o[m]=G(g)}}}}}}}else{o=G(t)}return o}function J(e,t,n){let o={};let i={};let s;let a;let r;let d;let f;let p;let c;let u;const h=l.selectNodes(e,"./d:Annotation",t);for(s=0;s<h.length;s+=1){i=l.nextNode(h,s);if(i.hasChildNodes()===false){a=q(i.getAttribute("Term"));o[a]=G(i)}}const g=l.selectNodes(e,"./d:PropertyValue",t);if(g.length>0){for(r=0;r<g.length;r+=1){d=l.nextNode(g,r);f=d.getAttribute("Property");o[f]=B(e,d,n);p=l.selectNodes(e,"./d:Apply",d);c=null;for(u=0;u<p.length;u+=1){c=l.nextNode(p,u);if(c){o[f]={};o[f].Apply=Q(e,c)}}}}else{o=B(e,t,n)}return o}function K(e,n){let l;let o;let i;let s;let a;let r;for(o=t.dataServices.schema.length-1;o>=0;o-=1){l=t.dataServices.schema[o];if(l.entityType){i=`${l.namespace}.`;s=l.entityType;for(r=s.length-1;r>=0;r-=1){if(i+s[r].name===e&&s[r].navigationProperty){for(a=0;a<s[r].navigationProperty.length;a+=1){if(s[r].navigationProperty[a].name===n){return true}}}}}}return false}if(this.initialized[n]){return this.initialized[n]}p=j(n);p=l.setNameSpace(p);const W=l.selectNodes(p,"//d:Schema",p);for(d=0;d<W.length;d+=1){u=l.nextNode(W,d);i.Alias=u.getAttribute("Alias");i.Namespace=u.getAttribute("Namespace")}const Z=l.selectNodes(p,"//edmx:Reference",p);for(d=0;d<Z.length;d+=1){h=l.nextNode(Z,d);N=l.selectNodes(p,"./edmx:Include",h);if(N&&N.length>0){g=l.nextNode(N,0);if(g.getAttribute("Alias")){o[g.getAttribute("Alias")]=g.getAttribute("Namespace")}else{o[g.getAttribute("Namespace")]=g.getAttribute("Namespace")}}const e=l.selectNodes(p,"./edmx:IncludeAnnotations",h);if(e.length>0){for(f=0;f<e.length;f+=1){m=l.nextNode(e,f);if(m.getAttribute("TargetNamespace")){r=m.getAttribute("TargetNamespace");if(!s[r]){s[r]={}}s[r][m.getAttribute("TermNamespace")]=h.getAttribute("Uri")}else{s[m.getAttribute("TermNamespace")]=h.getAttribute("Uri")}}}}if(s){a.annotationReferences=s}a.aliasDefinitions=o;const ee=l.selectNodes(p,"//d:Term",p);if(ee.length>0){y={};for(A=0;A<ee.length;A+=1){x=l.nextNode(ee,A);T=q(x.getAttribute("Type"));y[`@${i.Alias}.${x.getAttribute("Name")}`]=T}a.termDefinitions=y}const te=k(t);if(te.extensions){a.propertyExtensions=te.extensions}const ne=l.selectNodes(p,"//d:Annotations ",p);for(A=0;A<ne.length;A+=1){b=l.nextNode(ne,A);if(b.hasChildNodes()===false){continue}P=b.getAttribute("Target");$=P.split(".")[0];if($&&o[$]){P=P.replace(new RegExp($,""),o[$])}S=P;v=null;if(P.indexOf("/")>0){S=P.split("/")[0];v=P.replace(`${S}/`,"")}if(!a[S]){a[S]={}}if(v){if(!a.propertyAnnotations){a.propertyAnnotations={}}if(!a.propertyAnnotations[S]){a.propertyAnnotations[S]={}}a.propertyAnnotations[S][v]={};O=l.selectNodes(p,"./d:Annotation",b);for(R=0;R<O.length;R+=1){V=l.nextNode(O,R);if(V.hasChildNodes()===false){D=q(V.getAttribute("Term"));a.propertyAnnotations[S][v][D]=G(V)}}}else{E=S.replace(o[$],$);O=l.selectNodes(p,"./d:Annotation",b);for(C=0;C<O.length;C+=1){V=l.nextNode(O,C);w=V.getAttribute("Qualifier");U=q(V.getAttribute("Term"));if(w){U+=`#${w}`}I=B(p,V,E);I=H(I,te.types,S,i);a[S][U]=I}X=l.selectNodes(p,`//d:Annotations[contains(@Target, '${E}')]//d:PropertyValue[contains(@Path, '/')]//@Path`,p);for(d=0;d<X.length;d+=1){L=l.nextNode(X,d);z=L.value;if(a.propertyAnnotations){if(a.propertyAnnotations[S]){if(a.propertyAnnotations[S][z]){continue}}}_=z.split("/");if(K(S,_[0],t)){if(!a.expand){a.expand={}}if(!a.expand[S]){a.expand[S]={}}a.expand[S][_[0]]=_[0]}}F=l.selectNodes(p,`//d:Annotations[contains(@Target, '${E}')]//d:Path[contains(., '/')]`,p);for(d=0;d<F.length;d+=1){L=l.nextNode(F,d);z=l.getNodeText(L);if(a.propertyAnnotations[S]){if(a.propertyAnnotations[S][z]){continue}}if(!a.expand){a.expand={}}if(!a.expand[S]){a.expand[S]={}}_=z.split("/");if(K(S,_[0],t)){if(!a.expand){a.expand={}}if(!a.expand[S]){a.expand[S]={}}a.expand[S][_[0]]=_[0]}}}this.initialized[n]=a}return a};return t},true);
//# sourceMappingURL=Mapping.js.map