// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/base/Object","sap/ushell/Config","sap/ushell/resources","sap/ushell/components/MessagingHelper","sap/m/GenericTile","sap/m/ImageContent","sap/m/TileContent","sap/base/util/uid","sap/base/Log","sap/m/library"],(jQuery,e,t,i,o,n,r,l,s,a,u)=>{"use strict";const c=u.GenericTileMode;const g=u.LoadState;const d=e.extend("sap.ushell.components._HomepageManager.TransientPageOperationAdapter.js",{constructor:function(t){e.call(this);this.oPageBuilderService=t;this._createCatalogMap()},_createCatalogMap:function(){if(this.mCatalogTiles){return}const e=this.oPageBuilderService;const t=this;this.mCatalogTiles={};this._getAllCatalogTiles().then(i=>{for(let o=0;o<i.length;o++){for(let n=0;n<i[o].length;n++){t.mCatalogTiles[e.getCatalogTileId(i[o][n])]=i[o][n]}}})},getCurrentHiddenGroupIds:function(){return[]},getTileActions:function(e){e.isStub=function(){return true};const t=this.oPageBuilderService.getTileActions(e);delete e.isStub;return t},getPreparedTileModel:function(e,i,o){const r=s();let l=[];o=o||e.type;if(o==="link"){l=[new n({mode:c.LineMode})]}const a={isCustomTile:false,object:e,originalTileId:r,uuid:r,tileCatalogId:"",content:l,long:false,target:"",debugInfo:null,isTileIntentSupported:true,rgba:"",isLocked:i,showActionsIcon:t.last("/core/home/enableTileActionsIcon"),isLinkPersonalizationSupported:true,navigationMode:undefined};if(o==="card"){a.isCard=true;a.manifest={}}return a},getPreparedGroupModel:function(e,t,i,n){const r=s();const l=e&&e.tiles||[];const u=[];const c=[];for(let e=0;e<l.length;++e){const t=l[e];const i=t.type.toLowerCase();if(i==="tile"||i==="card"){u.push(this.getPreparedTileModel(l[e],false,i))}else if(i==="link"){c.push(this.getPreparedTileModel(l[e],false,i))}else{a.error(`Unknown tile type: '${i}'`,undefined,"sap.ushell.components.HomepageManager")}}return{title:t&&o.getLocalizedText("my_group")||e&&e.title||n&&n.title||"",object:e,groupId:r,links:c,pendingLinks:[],tiles:u,isDefaultGroup:!!t,editMode:!e,isGroupLocked:false,isFeatured:false,visibilityModes:[true,true],removable:true,sortable:true,isGroupVisible:true,isEnabled:!t,isLastGroup:i||false,isRendered:!!(n&&n.isRendered),isGroupSelected:false}},getPage:function(){return Promise.resolve([this.getPreparedGroupModel(null,false,true)])},addGroupAt:function(e,t,i){const o={title:e.title};return Promise.resolve(this.getPreparedGroupModel({},i,e.isLastGroup,o))},renameGroup:function(){return Promise.resolve()},deleteGroup:function(){return Promise.resolve()},moveGroup:function(){return Promise.resolve()},resetGroup:async function(){throw new Error("Reset group not supported in transient mode")},refreshGroup:async function(){throw new Error("Refresh group not supported in transient mode")},getIndexOfGroup:function(){return Promise.resolve(-1)},getOriginalGroupIndex:function(e,t){let i;for(let o=0;o<t.length;o++){if(t[o].groupId===e.groupId){i=o;break}}return Promise.resolve(i)},moveTile:function(e,t,i,o,n){const r=this._findCatalogTile(e.tileCatalogId);return Promise.resolve({content:this._getTileView(r,n),originalTileId:e.uuid,object:{id:e.uuid,type:n,title:this.oPageBuilderService.getCatalogTileTitle(r)}})},removeTile:function(){return Promise.resolve()},_getTileView:function(e,t){if(t==="link"){return new n({mode:c.LineMode,header:this.oPageBuilderService.getCatalogTileTitle(e),subheader:this.oPageBuilderService.getCatalogTilePreviewSubtitle(e)})}return new n({header:this.oPageBuilderService.getCatalogTileTitle(e),subheader:this.oPageBuilderService.getCatalogTilePreviewSubtitle(e),tileContent:new l({content:new r({src:this.oPageBuilderService.getCatalogTilePreviewIcon(e)})})})},refreshTile:function(){return},setTileVisible:function(){return},getTileType:function(e){return e.type},getTileSize:function(){return"1x1"},getTileId:function(e){return e.id},isLinkPersonalizationSupported:function(){return true},getTileTarget:function(e){const t=this._findCatalogTile(e.tileCatalogId);return this.oPageBuilderService.getCatalogTileTargetURL(t)},getTileTitle:function(e){return e.object.title},_getAllCatalogTiles:function(){const e=this.oPageBuilderService;function t(t){t.map(t=>{const i=e.getCatalogId(t)||"";return e.getCatalogTitle(t)||i.split(":").slice(1).join(":")});return Promise.all(t.map(t=>e.getCatalogTiles(t)))}return Promise.resolve(e.getCatalogs()).then(t)},_findCatalogTile:function(e){return this.mCatalogTiles[e]},getTileView:function(e){const t=this._findCatalogTile(e.tileCatalogId);const i=this._getTileView(t,e.object.type);const o=new jQuery.Deferred;o.resolve(i);return o.promise()},getFailedLinkView:function(e){const t=e.object.title||i.i18n.getText("cannotLoadLinkInformation");const o="";return new n({mode:c.LineMode,state:g.Failed,header:t,subheader:o})},getTileModelByCatalogTileId:function(e,t){t=t||"tile";const i=this._findCatalogTile(e);const o=this.getPreparedTileModel({},false,t);o.tileCatalogId=e;o.object={id:o.uuid,type:t,title:this.oPageBuilderService.getCatalogTileTitle(i)};const n=this._getTileView(i,t);o.content=[n];return o},transformGroupModel:function(e){const t=this;for(let i=0;i<e.length;i++){const o=e[i];o.object={};o.tiles.forEach(e=>{const i=e.object;e.tileCatalogId=t.oPageBuilderService.getCatalogTileId(i);e.object={id:e.uuid,type:"tile",title:t.oPageBuilderService.getTileTitle(i)}});o.links.forEach(e=>{const i=e.object;e.tileCatalogId=t.oPageBuilderService.getCatalogTileId(i);e.object={id:e.uuid,type:"link",title:t.oPageBuilderService.getTileTitle(i)}})}return e}});let p;return{getInstance:function(e){if(!p){p=new d(e)}return p},destroy:function(){p=null}}});
//# sourceMappingURL=TransientPageOperationAdapter.js.map