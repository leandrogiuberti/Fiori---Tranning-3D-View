// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/m/BusyIndicator","sap/m/library","sap/m/List","sap/m/IllustratedMessage","sap/m/Page","sap/m/PageAccessibleLandmarkInfo","sap/m/SplitApp","sap/m/StandardListItem","sap/ui/core/Element","sap/ui/core/EventBus","sap/ui/core/mvc/View","sap/ui/core/library","sap/ui/Device","sap/ui/performance/Measurement","sap/ushell/components/appfinder/VisualizationOrganizerHelper","sap/ushell/ui/appfinder/AppBoxInternal","sap/ushell/ui/appfinder/PinButton","sap/ushell/ui/launchpad/AccessibilityCustomData","sap/ushell/ui/launchpad/CatalogEntryContainer","sap/ushell/ui/launchpad/CatalogsContainer","sap/ushell/ui/launchpad/Tile","sap/ushell/resources"],(e,t,a,o,s,n,i,l,r,p,c,u,g,d,h,f,m,C,y,b,P,T)=>{"use strict";const S=t.ListSeparators;const B=t.ListMode;const I=u.AccessibleLandmarkRole;return c.extend("sap.ushell.components.appfinder.CatalogView",{oController:null,oVisualizationOrganizerHelper:h.getInstance(),formatPinButtonTooltip:function(e,t){let a;if(t.path){const o=e?Array.prototype.indexOf.call(e,t.id):-1;a=o!==-1?"removeAssociatedTileFromContextGroup":"addAssociatedTileToContextGroup";return T.i18n.getText(a,[t.title])}a=e&&e.length?"EasyAccessMenu_PinButton_Toggled_Tooltip":"EasyAccessMenu_PinButton_UnToggled_Tooltip";return T.i18n.getText(a)},formatPinButtonSelectState:function(e,t,a,o){if(a){const t=e?Array.prototype.indexOf.call(e,o):-1;return t!==-1}return!!t},createContent:function(t){const c=this;this.oViewData=this.getViewData();this.parentComponent=this.oViewData.parentComponent;const u=this.parentComponent.getModel();this.setModel(u);this.setModel(this.oViewData.subHeaderModel,"subHeaderModel");this.oVisualizationOrganizerHelper.setModel(u);this.oController=t;function h(e){return e!==null&&(e==="1x2"||e==="2x2")||false}const A=new m({icon:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonIcon},type:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonType},selected:{parts:["associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonSelectState.bind(this)},tooltip:{parts:["associatedGroups","/groupContext","id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonTooltip.bind(this)},press:[this.oVisualizationOrganizerHelper.onTilePinButtonClick,this],visible:false});const w=new m({icon:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonIcon},type:{path:"id",formatter:this.oVisualizationOrganizerHelper.formatPinButtonType},selected:{parts:["associatedGroups","associatedGroups/length","/groupContext/path","/groupContext/id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonSelectState.bind(this)},tooltip:{parts:["associatedGroups","/groupContext","id"],formatter:this.oVisualizationOrganizerHelper.formatPinButtonTooltip.bind(this)},press:[this.oVisualizationOrganizerHelper.onTilePinButtonClick,this],visible:false});this.oAppBoxesTemplate=new f({title:"{title}",icon:"{icon}",subtitle:"{subtitle}",url:"{url}",navigationMode:"{navigationMode}",pinButton:w,contentProviderLabel:"{contentProviderLabel}",press:[t.onAppBoxPressed,t]});this.oVisualizationOrganizerHelper.shouldPinButtonBeVisible().then(e=>{w.setVisible(e);A.setVisible(e)});w.addCustomData(new C({key:"tabindex",value:"-1",writeToDom:true}));w.addStyleClass("sapUshellPinButton");A.addCustomData(new C({key:"tabindex",value:"-1",writeToDom:true}));A.addStyleClass("sapUshellPinButton");this.oTileTemplate=new P({tileViews:{path:"content",factory:function(e,t){return t.getObject()}},long:{path:"size",formatter:h},tileCatalogId:"{id}",tileCatalogIdStable:"{tileCatalogIdStable}",pinButton:A,press:[t.catalogTilePress,t],afterRendering:t.onTileAfterRendering});this.oCatalogSelect=new a("catalogSelect",{visible:"{/enableCatalogSelection}",rememberSelections:true,showSeparators:S.None,mode:B.SingleSelectMaster,items:{path:"/masterCatalogs",template:new l({type:"Active",title:"{title}"})},showNoData:false,itemPress:[t._handleCatalogListItemPress,t],selectionChange:[t._handleCatalogListItemPress,t]});this.getCatalogSelect=function(){return this.oCatalogSelect};const M=this.oCatalogSelect.onAfterRendering;if(g.system.desktop){sap.ui.require(["sap/ushell/components/ComponentKeysHandler","sap/ushell/renderer/AccessKeysHandler"],(e,t)=>{e.getInstance().then(e=>{this.oCatalogSelect.addEventDelegate({onsaptabnext:function(a){try{a.preventDefault();t.setIsFocusHandledByAnotherHandler(true);e.setFocusOnCatalogTile()}catch{}},onsapskipforward:function(a){try{a.preventDefault();t.setIsFocusHandledByAnotherHandler(true);e.setFocusOnCatalogTile()}catch{}},onsapskipback:function(a){try{a.preventDefault();t.setIsFocusHandledByAnotherHandler(true);const o=r.getElementById("openCloseButtonAppFinderSubheader");if(o.getVisible()){o.focus()}else{e.appFinderFocusMenuButtons(a)}}catch{}}})})})}if(u.getProperty("/enableHelp")){this.oCatalogSelect.addStyleClass("help-id-catalogCategorySelect")}this.setCategoryFilterSelection=function(e,t){const a=c.getCatalogSelect();const o=a.getItems();let s=e;let n=0;if(!s||s===""){s=T.i18n.getText("all")}o.forEach((e,t)=>{if(e.getTitle()===s){n=t;a.setSelectedItem(e)}});if(o.length!==0&&t){o[n].focus()}};this.oCatalogSelect.onAfterRendering=function(){const e=c.oController.categoryFilter||T.i18n.getText("all");c.setCategoryFilterSelection(e);if(M){M.apply(this,arguments)}if(!this.getSelectedItem()){this.setSelectedItem(this.getItems()[0])}setTimeout(()=>{const e=r.getElementById("appFinderSegmentedButtons");if(e){e.focus()}},0)};const D=this.oCatalogSelect._onAfterRenderingPopover;this.oCatalogSelect._onAfterRenderingPopover=function(){if(this._oPopover){this._oPopover.setFollowOf(false)}if(D){D.apply(this,arguments)}};const x=p.getInstance();let v;const H=function(){this.splitApp.toMaster("catalogSelect","show");if(!g.system.phone){v=this._calculateDetailPageId();if(v!==this.splitApp.getCurrentDetailPage().getId()){this.splitApp.toDetail(v)}}}.bind(this);x.subscribe("launchpad","catalogContentLoaded",()=>{setTimeout(H,500)},this);x.subscribe("launchpad","afterCatalogSegment",H,this);const z=new y({header:"{title}",customTilesContainer:{path:"customTiles",template:this.oTileTemplate,templateShareable:true},appBoxesContainer:{path:"appBoxes",template:this.oAppBoxesTemplate,templateShareable:true}});this.oIllustratedMessage=new o({visible:true,title:T.i18n.getText("EasyAccessMenu_NoAppsToDisplayMessagePage_Text"),description:" "}).addEventDelegate({onAfterRendering:function(){const e=this.oIllustratedMessage.getDomRef();if(e){const t=e.getElementsByClassName("sapMTitle");if(t.length){t[0].setAttribute("tabindex","0")}}}.bind(this),onBeforeRendering:function(){const e=this.oIllustratedMessage.getDomRef();if(e){const t=e.getElementsByClassName("sapMTitle");if(t.length){t[0].removeAttribute("tabindex")}}}.bind(this)});this.oCatalogsContainer=new b("catalogTiles",{categoryFilter:"{/categoryFilter}",catalogs:{path:"/catalogs",templateShareable:true,template:z},busy:true}).addStyleClass("sapUiTinyMarginTop");this.oCatalogsContainer.addStyleClass("sapUshellCatalogTileContainer");this.oCatalogsContainer.addEventDelegate({onsaptabprevious:function(e){const t=r.getElementById("openCloseButtonAppFinderSubheader");const a=e.srcControl.getDomRef();if(t.getVisible()&&!t.getPressed()&&!a.classList.contains("sapUshellPinButton")){e.preventDefault();const t=r.getElementById("appFinderSearch");t.focus()}},onsapskipback:function(e){const t=r.getElementById("openCloseButtonAppFinderSubheader");if(t.getVisible()&&!t.getPressed()){e.preventDefault();t.focus()}}});this.oCatalogsContainer.onAfterRendering=function(){const e=r.getElementById("catalogTilesDetailedPage");if(!this.getBusy()){e.setBusy(false);d.end("FLP:AppFinderLoadingStartToEnd")}else{e.setBusy(true)}document.getElementById("catalogTilesDetailedPage-cont").addEventListener("scroll",()=>{const e=r.getElementById("catalogTilesDetailedPage");const t=e.getScrollDelegate();const a=t.getScrollTop();const o=t.getMaxScrollTop();if(o-a<=30+3*c.oController.PagingManager.getTileHeight()&&c.oController.bIsInProcess===false){c.oController.bIsInProcess=true;c.oController.allocateNextPage();setTimeout(()=>{c.oController.bIsInProcess=false},0)}})};const V=new s("catalogTilesDetailedPage",{showHeader:false,showFooter:false,showNavButton:false,content:[this.oCatalogsContainer.addStyleClass("sapUshellCatalogPage")],landmarkInfo:new n({contentLabel:T.i18n.getText("appFinderCatalogTitle"),contentRole:I.None,rootRole:I.None})});const F=new s("catalogMessagePage",{showHeader:false,showFooter:false,showNavButton:false,content:[this.oIllustratedMessage]});const E=new e("catalogSelectBusyIndicator",{size:"1rem"});this.splitApp=new i("catalogViewMasterDetail",{masterPages:[E,this.oCatalogSelect],detailPages:[V,F],mode:"{= ${/isPhoneWidth} ? 'HideMode' : 'ShowHideMode'}"});return this.splitApp},_calculateDetailPageId:function(){const e=this.getModel("subHeaderModel");const t=e.getProperty("/search/searchMode");const a=e.getProperty("/tag/tagMode");const o=!!this.getModel().getProperty("/catalogsNoDataText");let s;if(t||a){s=this.getController().bSearchResults?"catalogTilesDetailedPage":"catalogMessagePage"}else if(o){s="catalogMessagePage"}else{s="catalogTilesDetailedPage"}return s},getControllerName:function(){return"sap.ushell.components.appfinder.Catalog"}})});
//# sourceMappingURL=CatalogView.js.map