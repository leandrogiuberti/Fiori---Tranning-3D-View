//@ui5-bundle sap/ushell/components/shell/UserActionsMenu/Component-preload.js
// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.predefine("sap/ushell/components/shell/UserActionsMenu/Component", ["sap/ui/core/EventBus","sap/ui/core/UIComponent","sap/ushell/components/shell/UserActionsMenu/UserActionsMenu.controller"],(e,n,s)=>{"use strict";return n.extend("sap.ushell.components.shell.UserActionsMenu.Component",{metadata:{version:"1.141.0",library:"sap.ushell",dependencies:{libs:["sap.m"]}},createContent:function(){this._bIsUserActionsMenuCreated=false;this.oUserActionsMenuController=new s;this.oUserActionsMenuController.onInit();e.getInstance().publish("shell","userActionsMenuCompLoaded",{delay:0})},exit:function(){this.oUserActionsMenuController.onExit()}})});
// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.predefine("sap/ushell/components/shell/UserActionsMenu/UserActionsMenu.controller", ["sap/base/Log","sap/m/library","sap/m/StandardListItem","sap/ui/core/Element","sap/ui/core/ElementMetadata","sap/ui/core/Fragment","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/performance/Measurement","sap/ushell/Config","sap/ushell/Container","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/ui/footerbar/AboutButton","sap/ushell/ui/footerbar/ContactSupportButton","sap/ushell/ui/launchpad/ActionItem","sap/ushell/ui/QuickAccess","sap/ushell/state/ShellModel","sap/ushell/state/StateManager"],(e,t,n,o,i,s,r,a,l,c,u,g,p,d,h,f,A,m,v)=>{"use strict";const B=t.ListType;const y=t.ButtonType;const I=v.Operation;return r.extend("sap.ushell.components.shell.UserActionsMenu.UserActionsMenu",{_aDanglingControl:[],_aDoables:[],onInit:function(){const e=this.getShellConfig();this._createActionButtons(e);this.oModel=new a(this.getInitialModelData());this._aDoables.push(g.on("showUserActionsMenu").do(e=>{if(this.getPopoverIsOpen()||!e){this._toggleUserActionsMenuPopover(false)}else{this._toggleUserActionsMenuPopover(true)}}))},onExit:function(){this._destroyDanglingControls();this._aDoables.forEach(e=>{e.off()});this._aDanglingControl=[];this._aDoables=[];const e=o.getElementById("sapUshellUserActionsMenuPopover");if(e){e.destroy()}},getInitialModelData:function(){const e=u.getUser();const t=c.last("/core/userActionsMenu/displayUserId");const n={userName:e.getFullName()||"",identifier:t?e.getId():e.getEmail()||e.getId(),initials:e.getInitials(),userEmail:t?e.getEmail():""};return n},filterUserActions:function(t){if(!o.getElementById(t)){e.debug(`Could not render ActionItem because it was not created: ${t}`);return false}else if(t==="logoutBtn"){return!this.getDisplayAvatar()}return true},getModel:function(){return this.oModel},_createActionButtons:function(e){const t=c.last("/core/extension/enableHelp");const n=c.last("/core/shell/enableAbout");if(n){this._createAboutButton(t)}if(!e.moveAppFinderActionToShellHeader&&c.last("/core/catalog/enabled")){this._createAppFinderButton(e,t)}if(!e.moveUserSettingsActionToShellHeader){this._createSettingsButton(t)}if(!e.moveContactSupportActionToShellHeader){this._createSupportTicketButton(t)}if(e.enableRecentActivity&&c.last("/core/shell/model/showRecentActivity")){this._createRecentActivitiesButton();this._createFrequentActivitiesButton()}if(!e.disableSignOut){this._createLogoutButton()}},_createAppFinderButton:function(e,t){if(o.getElementById("openCatalogBtn")){return}const n=new f("openCatalogBtn",{text:p.i18n.getText("open_appFinderBtn"),icon:"sap-icon://sys-find",visible:!e.disableAppFinder,actionType:"action",press:function(){l.start("FLP:AppFinderLoadingStartToEnd","AppFinderLoadingStartToEnd","FLP");u.getServiceAsync("Navigation").then(e=>{e.navigate({target:{semanticObject:"Shell",action:"appfinder"}})})}});if(t){n.addStyleClass("help-id-openCatalogActionItem")}this._addDanglingControl(n);v.updateAllBaseStates("userActions.items",I.Add,n.getId())},_createAboutButton:function(e){const t="aboutBtn";if(!o.getElementById(t)){const n=new d(t);if(e){n.addStyleClass(`help-id-${t}`)}this._addDanglingControl(n);this.getRenderer().showActionButton(t,false)}},_createSettingsButton:function(e){const t="userSettingsBtn";if(!o.getElementById(t)){const n=new f(t,{tooltip:`${p.i18n.getText("ControlKey")} + ${p.i18n.getText("CommaKey")}`,text:p.i18n.getText("userSettings"),icon:"sap-icon://action-settings",press:function(){g.emit("openUserSettings",Date.now())}});if(e){n.addStyleClass("help-id-loginDetails")}this._addDanglingControl(n)}v.updateAllBaseStates("userActions.items",I.Add,t)},_createSupportTicketButton:function(e){c.on("/core/extension/SupportTicket").do(t=>{const n="ContactSupportBtn";let i=o.getElementById(n);if(t&&!i){i=new h(n);this._addDanglingControl(i);if(e){i.addStyleClass("help-id-contactSupportBtn")}}if(t){this.getRenderer().showActionButton(n)}else{this.getRenderer().hideActionButton(n)}})},_createRecentActivitiesButton:function(){const e="recentActivitiesBtn";c.on("/core/shell/model/enableTrackingActivity").do(t=>{if(t){let t=o.getElementById(e);if(!t){t=new f(e,{text:p.i18n.getText("recentActivities"),icon:"sap-icon://customer-history",press:function(){A.openQuickAccessDialog("recentActivityFilter","userActionsMenuHeaderButton")}});this._addDanglingControl(t)}this.getRenderer().showActionButton(e,false)}else{this.getRenderer().hideActionButton(e,false)}})},_createFrequentActivitiesButton:function(){const e="frequentActivitiesBtn";c.on("/core/shell/model/enableTrackingActivity").do(t=>{if(t){let t=o.getElementById(e);if(!t){t=new f(e,{text:p.i18n.getText("frequentActivities"),icon:"sap-icon://activity-individual",tooltip:p.i18n.getText("frequentActivitiesTooltip"),press:function(){A.openQuickAccessDialog("frequentlyUsedFilter","userActionsMenuHeaderButton")}});this._addDanglingControl(t)}this.getRenderer().showActionButton(e,false)}else{this.getRenderer().hideActionButton(e,false)}})},_createLogoutButton:function(){const e="logoutBtn";if(o.getElementById(e)){return}const t=new f(e,{visible:true,type:y.Transparent,icon:"sap-icon://log",text:p.i18n.getText("signoutBtn_title"),press:this.logout});this._addDanglingControl(t);this.getRenderer().showActionButton(e,false)},logout:function(){sap.ui.require(["sap/m/MessageBox","sap/ushell/ui/launchpad/LoadingDialog"],(e,t)=>{let n=new t({text:""});let o=true;let s=false;u.getGlobalDirty().done(r=>{o=false;if(s===true){n.exit();n=new t({text:""})}const a={};const l=p.i18n;if(r===u.DirtyState.DIRTY){a.message=l.getText("unsaved_data_warning_popup_message");a.icon=e.Icon.WARNING;a.messageTitle=l.getText("unsaved_data_warning_popup_title")}else{a.message=l.getText("signoutConfirmationMsg");a.icon=e.Icon.QUESTION;a.messageTitle=l.getText("signoutMsgTitle")}e.show(a.message,a.icon,a.messageTitle,[e.Action.OK,e.Action.CANCEL],t=>{if(t===e.Action.OK){n.openLoadingScreen();n.showAppInfo(p.i18n.getText("beforeLogoutMsg"),null);u.defaultLogout()}},i.uid("confirm"))});if(o===true){n.openLoadingScreen();s=true}})},_addDanglingControl:function(e){this._aDanglingControl.push(e)},_destroyDanglingControls:function(){if(this._aDanglingControl){this._aDanglingControl.forEach(e=>{if(e.destroyContent){e.destroyContent()}e.destroy()})}},_toggleUserActionsMenuPopover:async function(e){let t;const n=new Promise(e=>{if(this.getDisplayAvatar()){t="sap.ushell.components.shell.UserActionsMenu.UserActionsMenu";sap.ui.require(["sap/ushell/gen/ui5/webcomponents-fiori/dist/UserMenuItem"],()=>{e()})}else{t="sap.ushell.components.shell.UserActionsMenu.UserActionsMenuPopover";e()}});if(!this.oPopover){await Promise.all([n,s.load({name:t,type:"XML",controller:this})]).then(t=>{this.oPopover=t[1];this.oPopover.setModel(this.getModel());this.oPopover.setModel(m.getConfigModel(),"configModel");this.oPopover.setModel(m.getModel(),"shellModel");if(this.getDisplayAvatar()){this.oPopover.placeAt("WebComponents-shellArea","last");this.oPopover.attachClose(()=>{this.popoverClose()})}return this._toggleUserActionsMenuPopover(e)})}else if(e){v.refreshState("userActions.items");this.popoverOpen()}else{this.popoverClose();if(window.document.activeElement&&window.document.activeElement.id!=="userActionsMenuHeaderButton"){window.document.getElementById("userActionsMenuHeaderButton")?.focus()}}},onItemPress:function(e){const t=e.getParameter("item").data("actionItemId");const n=o.getElementById(t);if(n){n.firePress();g.emit("showUserActionsMenu",false)}},userActionsMenuItemFactory:function(e,t){const n=o.getElementById(t.getObject());const i=sap.ui.require("sap/ushell/gen/ui5/webcomponents-fiori/dist/UserMenuItem");return new i({id:`${e}-${n.getId()}`,icon:n.getIcon(),text:n.getText(),tooltip:n.getTooltip(),visible:n.getVisible(),customData:[{key:"actionItemId",value:n.getId()}]})},userActionsMenuPopoverItemFactory:function(e,t){const i=o.getElementById(t.getObject());return new n({id:`${e}-${i.getId()}`,icon:i.getIcon(),tooltip:i.getTooltip(),iconInset:true,title:i.getText(),visible:i.getVisible(),type:B.Active,customData:[{key:"actionItemId",value:i.getId()}],press:function(){if(i){i.firePress();g.emit("showUserActionsMenu",false)}}}).addStyleClass("sapUshellUserActionsMenuActionItem")},getRenderer:function(){if(!this._oRenderer){this._oRenderer=u.getRendererInternal("fiori2")}return this._oRenderer},getShellConfig:function(){return this.getRenderer().getShellConfig()},getDisplayAvatar:function(){return!!c.last("/core/userActionsMenu/displayAvatar")},getPopoverIsOpen:function(){if(this.getDisplayAvatar()){return this.bPopoverOpen||this.oPopover?.getOpen()}return this.oPopover?.isOpen()},popoverOpen:function(){if(this.getDisplayAvatar()){this.bPopoverOpen=true;return this.oPopover.setOpen(true)}return this.oPopover.openBy(o.getElementById("userActionsMenuHeaderButton"))},popoverClose:function(){if(this.getDisplayAvatar()){window.setTimeout(()=>{this.bPopoverOpen=false},400);return this.oPopover.setOpen(false)}return this.oPopover.close()}})});
sap.ui.require.preload({
	"sap/ushell/components/shell/UserActionsMenu/UserActionsMenu.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:thirdparty="sap.ushell.gen.ui5.webcomponents-fiori.dist"\n    core:require="{\n        iconSettings: \'sap/ushell/thirdparty/ui5/webcomponents-icons/AllIcons\'\n    }"\n><thirdparty:UserMenu\n        opener="userActionsMenuHeaderButton"\n        id="sapUshellUserActionsMenuPopover"\n        menuItems="{\n            path: \'shellModel>/userActions/items\',\n            factory: \'.userActionsMenuItemFactory\',\n            filters: [{\n                path: \'\',\n                caseSensitive: true,\n                test: \'.filterUserActions\'\n            }]}"\n        signOutClick=".logout"\n        itemClick=".onItemPress"\n    ><thirdparty:accounts><thirdparty:UserMenuAccount\n                titleText="{/userName}"\n                avatarSrc="{configModel>/userImage/personPlaceHolder}"\n                avatarInitials="{/initials}"\n                subtitleText="{/identifier}"\n                description="{/userEmail}"\n                selected="true"\n            /></thirdparty:accounts></thirdparty:UserMenu></core:FragmentDefinition>\n',
	"sap/ushell/components/shell/UserActionsMenu/UserActionsMenuPopover.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n><Popover\n        id="sapUshellUserActionsMenuPopover"\n        placement="Bottom"\n        showArrow="true"\n        showHeader="false"\n        class="sapUshellPopupContainer sapContrastPlus"\n    ><content><List\n                class="sapUshellPopoverList"\n                showSeparators="None"\n                includeItemInSelection="true"\n                items="{\n                    path: \'shellModel>/userActions/items\',\n                    factory: \'.userActionsMenuPopoverItemFactory\',\n                    filters: [{\n                        path: \'\',\n                        caseSensitive: true,\n                        test: \'.filterUserActions\'\n                    }]\n                }"\n            ><headerToolbar><Toolbar style="Clear"><Title\n                            titleStyle="H4"\n                            level="H1"\n                            text="{/userName}"\n                        ><customData><core:CustomData\n                                    xmlns:core="sap.ui.core"\n                                    key="help-id"\n                                    value="UserActionsMenu-UserName"\n                                    writeToDom="true"\n                                /></customData></Title></Toolbar></headerToolbar><infoToolbar><Toolbar\n                        class="sapUiTinyMarginBegin"\n                        style="Standard"\n                        design="Transparent"\n                    ><Title\n                            titleStyle="H5"\n                            level="H2"\n                            text="{/identifier}"\n                        ><customData><core:CustomData\n                                    xmlns:core="sap.ui.core"\n                                    key="help-id"\n                                    value="UserActionsMenu-UserIdentifier"\n                                    writeToDom="true"\n                                /></customData></Title></Toolbar></infoToolbar></List></content></Popover></core:FragmentDefinition>\n'
});
//# sourceMappingURL=Component-preload.js.map
