// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/i18n/Localization","sap/ui/Device","sap/ui/core/Component","sap/ui/core/CustomData","sap/ui/core/Element","sap/ui/core/IconPool","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/library","sap/ushell/resources","sap/ushell/ui/shell/ShellHeadItem","sap/ushell/state/ShellModel","sap/ushell/state/StateManager","sap/ushell/Container","sap/ushell/utils","sap/ushell/utils/UrlParsing"],(e,t,n,i,a,s,o,l,r,c,p,u,h,d,g,f)=>{"use strict";const m=r.AppTitleState;const b=r.FloatingNumberType;const B=h.LaunchpadState;const S=h.Operation;const y=h.ShellMode;const{Default:A,Standalone:v,Embedded:w,Lean:I,Merged:_}=y;let M=[];return n.extend("sap.ushell.components.shell.PostLoadingHeaderEnhancement.Component",{metadata:{library:"sap.ushell"},init:function(){this._aInitPromises=[];const e=d.getRendererInternal("fiori2").getShellConfig();this._aInitPromises.push(this._createBackButton().then(e=>{M.push(e)}));M.push(this._createOverflowButton());if(e.moveAppFinderActionToShellHeader&&o.last("/core/catalog/enabled")&&!e.disableAppFinder){this._aInitPromises.push(this._createAppFinderButton().then(e=>{M.push(e)}))}if(e.moveContactSupportActionToShellHeader){this._aInitPromises.push(this._createSupportButton().then(e=>{M.push(e)}))}this._createShellNavigationMenu();const t=a.getElementById("shell-header");t.updateAggregation("headItems");t.updateAggregation("headEndItems");this._pInitPromise=Promise.all(this._aInitPromises)},_createBackButton:async function(){const t=e.getRTL()?"feeder-arrow":"nav-back";const n=h.getShellMode();let i;if(o.last("/core/shellBar/enabled")){const[e]=await g.requireAsync(["sap/ushell/gen/ui5/webcomponents/dist/Button"]);i=new e({id:"backBtn",tooltip:c.i18n.getText("backBtn_tooltip"),accessibleDescription:c.i18n.getText("backBtn_tooltip"),icon:s.getIconURI(t),click:function(){l.emit("navigateBack",Date.now())}})}else{i=new p({id:"backBtn",tooltip:c.i18n.getText("backBtn_tooltip"),ariaLabel:c.i18n.getText("backBtn_tooltip"),icon:s.getIconURI(t),press:function(){l.emit("navigateBack",Date.now())}})}if([A,v,w,_].includes(n)){h.updateBaseStates([B.App],"header.headItems",S.Add,i.getId())}else if(n===I){this._boundSetBackButtonVisibilityAfterHashChanged=this._setBackButtonVisibilityAfterHashChanged.bind(this);window.addEventListener("hashchange",this._boundSetBackButtonVisibilityAfterHashChanged)}return i.getId()},_setBackButtonVisibilityAfterHashChanged:function(e){const{oldURL:t,newURL:n}=e;const i=f.getHash(t);const a=f.getHash(n);const s=f.parseShellHash(i).appSpecificRoute;const o=f.parseShellHash(a).appSpecificRoute;const l=s!==o;if(l){h.updateBaseStates([B.App],"header.headItems",S.Add,"backBtn");window.removeEventListener("hashchange",this._boundSetBackButtonVisibilityAfterHashChanged);delete this._boundSetBackButtonVisibilityAfterHashChanged}},_createOverflowButton:function(){if(o.last("/core/shellBar/enabled")){return}const e=new p({id:"endItemsOverflowBtn",tooltip:{path:"configModel>/notificationsCount",formatter:function(e){return this.tooltipFormatter(e)}},ariaLabel:c.i18n.getText("shellHeaderOverflowBtn_tooltip"),ariaHaspopup:"dialog",icon:"sap-icon://overflow",floatingNumber:"{configModel>/notificationsCount}",floatingNumberMaxValue:t.system.phone?99:999,floatingNumberType:b.OverflowButton,press:function(e){l.emit("showEndItemOverflow",e.getSource().getId(),true)}});e.setModel(u.getConfigModel(),"configModel");return e.getId()},_createHeaderItem:async function(e){if(o.last("/core/shellBar/enabled")){const[t]=await g.requireAsync(["sap/ushell/gen/ui5/webcomponents-fiori/dist/ShellBarItem"]);e.click=e.press;delete e.press;e.accessibilityAttributes=e.accessibilityAttributes||{};e.accessibilityAttributes.hasPopup=e.accessibilityAttributes.hasPopup??e.ariaHaspopup;delete e.ariaHaspopup;delete e.ariaLabel;return new t(e)}return new p(e)},_createAppFinderButton:async function(){const e=await this._createHeaderItem({id:"openCatalogBtn",text:c.i18n.getText("open_appFinderBtn"),ariaLabel:c.i18n.getText("open_appFinderBtn"),tooltip:c.i18n.getText("open_appFinderBtn"),icon:"sap-icon://sys-find",press:function(){d.getServiceAsync("Navigation").then(e=>{e.navigate({target:{semanticObject:"Shell",action:"appfinder"}})})}});if(o.last("/core/extension/enableHelp")){e.addStyleClass("help-id-openCatalogActionItem")}h.updateAllBaseStates("userActions.items",S.Add,e.getId());return e.getId()},_createSupportButton:function(){return new Promise(e=>{sap.ui.require(["sap/ushell/ui/footerbar/ContactSupportButton"],async t=>{const n="ContactSupportBtn";let i=a.getElementById(n);if(!i){const e=new t("tempContactSupportBtn",{visible:true});const a=e.getIcon();const s=e.getText();i=await this._createHeaderItem({id:n,icon:a,tooltip:s,text:s,ariaHaspopup:"dialog",press:function(){e.firePress()}})}h.updateAllBaseStates("userActions.items",S.Add,n);e(n)})})},_createShellNavigationMenu:function(){return new Promise(function(e){sap.ui.require(["sap/m/StandardListItem","sap/ushell/ui/shell/NavigationMiniTile","sap/ushell/ui/shell/ShellNavigationMenu"],(t,n,s)=>{const o="shellNavigationMenu";function r(e,n){const a=n.getProperty("icon")||"sap-icon://circle-task-2";const s=n.getProperty("title");const o=n.getProperty("subtitle");const r=n.getProperty("intent");const c=new t({type:"Active",title:s,description:o,icon:a,wrapping:true,customData:[new i({key:"intent",value:r})],press:function(){if(r&&r[0]==="#"){l.emit("navigateFromShellApplicationNavigationMenu",r,true)}}}).addStyleClass("sapUshellNavigationMenuListItems");return c}function c(e,t){const i=t.getProperty("icon");const a=t.getProperty("title");const s=t.getProperty("subtitle");const o=t.getProperty("intent");return new n({title:a,subtitle:s,icon:i,intent:o,press:function(){const e=this.getIntent();if(e&&e[0]==="#"){l.emit("navigateFromShellApplicationNavigationMenu",e,true)}}})}const p=new s(o,{showRelatedApps:h.getShellMode()!==I,items:{path:"shellModel>/application/hierarchy",factory:r.bind(this)},miniTiles:{path:"shellModel>/application/relatedApps",factory:c.bind(this)},visible:{path:"configModel>/shellAppTitleState",formatter:function(e){return e===m.ShellNavMenu}}});p.setModel(u.getModel(),"shellModel");p.setModel(u.getConfigModel(),"configModel");const d=a.getElementById("shellAppTitle");if(d){d.setNavigationMenu(p)}M.push(o);e(p)})})},exit:function(){M.forEach(e=>{const t=a.getElementById(e);if(t){t.destroy()}});M=[];if(this._boundSetBackButtonVisibilityAfterHashChanged){window.removeEventListener("hashchange",this._boundSetBackButtonVisibilityAfterHashChanged)}}})});
//# sourceMappingURL=Component.js.map