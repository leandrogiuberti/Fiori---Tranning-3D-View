//@ui5-bundle sap/ushell/components/shell/UserImage/Component-preload.js
// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.predefine("sap/ushell/components/shell/UserImage/Component", ["sap/base/Log","sap/base/i18n/Localization","sap/base/util/isEmptyObject","sap/m/Button","sap/m/library","sap/ui/core/IconPool","sap/ui/core/UIComponent","sap/ui/Device","sap/ui/thirdparty/jquery","sap/ushell/resources","sap/ushell/Container","sap/ushell/state/ShellModel"],(e,s,t,n,o,a,l,r,jQuery,i,g,u)=>{"use strict";const c=o.ButtonType;return l.extend("sap.ushell.components.shell.UserImage.Component",{metadata:{version:"1.141.0",library:"sap.ushell.components.shell.UserImage",dependencies:{libs:{"sap.m":{},"sap.ui.layout":{lazy:true}}}},createContent:function(){const e=g.getRendererInternal("fiori2").getShellConfig();this.loadUserImage();const s=g.getUser();if(e.enableUserImgConsent===true&&s.getImageConsent()===undefined){this._showUserConsentPopup()}},_showUserConsentPopup:function(){const e=this;const t=s.getRTL()?"Right":"Left";let o;let a;let l;let g;const u=new n("yesButton",{text:i.i18n.getText("DisplayImg"),type:c.Emphasized,press:function(){e.updateUserImage(true);o.close()}});const p=new n("noButton",{text:i.i18n.getText("DontDisplayImg"),press:function(){e.updateUserImage(false);o.close()}});sap.ui.require(["sap/ui/layout/form/VerticalLayout","sap/m/Dialog","sap/m/Text","sap/m/Link","sap/m/FlexBox"],(e,s,n,c,m)=>{o=new s("userConsentDialog",{title:i.i18n.getText("userImageConsentDialogTitle"),modal:true,stretch:r.system.phone,buttons:[u,p],afterClose:function(){o.destroy()}}).addStyleClass("sapUshellUserConsentDialog").addStyleClass("sapContrastPlus");const d=new n({text:i.i18n.getText("userImageConsentDialogTermsOfUse")}).addStyleClass("sapUshellUserConsentDialogTerms");const C=new n({text:i.i18n.getText("userImageConsentText"),textAlign:t}).addStyleClass("sapUshellUserConsentDialogText");const f=new c({text:i.i18n.getText("userImageConsentDialogShowTermsOfUse"),textAlign:t,press:function(){const e=g.getVisible();if(e){g.setVisible(false);f.setText(i.i18n.getText("userImageConsentDialogShowTermsOfUse"))}else{f.setText(i.i18n.getText("userImageConsentDialogHideTermsOfUse"));g.setVisible(true)}}}).addAriaLabelledBy(C);a=new m({alignItems:"Center",direction:"Row",items:[C]}).addStyleClass("sapUshellUserConsentDialogBox");l=new m({alignItems:"Center",direction:"Row",items:[f]}).addStyleClass("sapUshellUserConsentDialogBox").addStyleClass("sapUshellUserConsentDialogLink");g=new m({alignItems:"Center",direction:"Row",items:[d]}).addStyleClass("ushellUserImgConsentTermsOfUseFlexBox");g.setVisible(false);const h=new e("userConsentDialogLayout",{content:[a,l,g]});o.addContent(h);o.open()})},loadUserImage:function(){const e=g.getUser();const s=e.getImage();if(s){this._setUserImage(s)}e.attachOnSetImage(this._setUserImage.bind(this))},_setUserImage:function(s){const n=typeof s==="string"?s:s.mParameters;if(n&&typeof n==="string"||!t(n)){jQuery.ajax({url:n,headers:{"Cache-Control":"no-cache, no-store, must-revalidate",Pragma:"no-cache",Expires:"0"},success:function(){u.getConfigModel().setProperty("/userImage/personPlaceHolder",n);u.getConfigModel().setProperty("/userImage/account",n)},error:function(){e.error(`Could not load user image from: ${n}`,"","sap.ushell.renderer.Shell.view");g.getUser().setImage("")}})}else{u.getConfigModel().setProperty("/userImage/personPlaceHolder",null);u.getConfigModel().setProperty("/userImage/account",a.getIconURI("account"))}},updateUserImage:function(e){const s=g.getUser();let t;g.getServiceAsync("UserInfo").then(n=>{if(e!==undefined){s.setImageConsent(e);t=n.updateUserPreferences(s);t.done(()=>{s.resetChangedProperty("isImageConsent")})}})}})});
//# sourceMappingURL=Component-preload.js.map
