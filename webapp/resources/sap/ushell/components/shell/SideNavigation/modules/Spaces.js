// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/ObjectPath","sap/tnt/NavigationListGroup","sap/tnt/NavigationListItem","sap/ui/core/CustomData","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/thirdparty/hasher","sap/ushell/Config","sap/ushell/Container","sap/ushell/components/shell/SideNavigation/modules/NavigationHelper","sap/ushell/services/AppConfiguration","sap/ushell/utils/UrlParsing"],(e,t,i,a,s,o,n,p,r,l,d,c,m,u)=>{"use strict";class g{#e;#t;#i;#a;#s;#o;#n;constructor(e){this.#e=e;this.#a=this.#e.getConfigValue("spaces.defaultIcon");this.#s=new c;const i=l.last("/core/menu/personalization/enabled");const r=l.last("/core/spaces/myHome/myHomeSpaceId");const d=[new s("type",o.NE,"separator")];if(i){d.push(new s("pinned",o.EQ,true))}if(r){d.push(new s("id",o.NE,r))}this.#o=new p({});this.#o.attachPropertyChange(()=>{this.#e.updateSelectedKey()});this.#i=new t({text:"{i18n>SideNavigation.Item.Spaces.Title}",enabled:"{viewConfiguration>/enableSideNavigation}",customData:[new a({key:"help-id",value:"MenuEntry-My-Spaces",writeToDom:true})],items:{path:"spaces>/",factory:this._spacesModelItemFactory.bind(this),filters:new s({filters:d,and:true}),sorter:i?new n({path:"pinnedSortOrder"}):null}});this.#i.setModel(this.#o,"navigationListItemModel");this.#t=new Promise(e=>{this.#n=this.#p(e)})}async getRootItem(){return this.#t}async#p(e){const t=await d.getServiceAsync("Menu");const i=await t.getMenuModel();this.#i.setModel(i,"spaces");e(this.#i);return i}async findSelectedKey(t){const i=r.getHash();const a=u.parseShellHash(i);const s=e.get("params.spaceId.0",a);const o=e.get("params.pageId.0",a);const n=e.get("params.sap-ui-app-id-hint.0",a)||m.getCurrentApplication()?.appId;t=t||await this.getRootItem();if(a.semanticObject==="Shell"&&a.action==="home"){return t.getItems()[0]?.getKey()}const p=this.#r(t.getItems(),s,o,n);return p?.getKey()}#r(e,t,i,a){for(let s=0;s<e.length;s++){const o=e[s];const n=o.getItems();const p=this.#r(n,t,i,a);if(p&&!o.getExpanded()){return o}else if(p){return p}const r=this.#l(o.getBindingContext("spaces").getObject(),t,i,a);if(r){return o}}}#l(t,i,a,s){const o=e.get("target.parameters",t)||[];const n=o.some(e=>e.name==="spaceId"&&e.value===i);const p=o.some(e=>e.name==="pageId"&&e.value===a);const r=o.some(e=>e.name==="sap-ui-app-id-hint"&&e.value===s);if(!i){return p||r}const l=!a&&!s;return n&&(p||r||l)}_spacesModelItemFactory(e,t){const s=t.getProperty("menuEntries");const o=t.getProperty("uid");this.#o.setProperty(`/${o}`,false);return new i(e,{key:"{spaces>uid}",text:"{spaces>title}",enabled:"{viewConfiguration>/enableSideNavigation}",selectable:this.#e.getConfigValue("spaces.selectable")||!s||s.length===0,expanded:`{navigationListItemModel>/${o}}`,customData:[new a({key:"help-id",value:"{= 'MenuEntry-' + ${spaces>help-id}}",writeToDom:"{= !!${spaces>help-id}}"})],icon:{path:"spaces>icon",formatter:e=>e||this.#a},select:this._onSideNavigationItemSelection.bind(this),items:{path:"spaces>menuEntries",template:new i({key:"{spaces>uid}",text:"{spaces>title}",enabled:"{viewConfiguration>/enableSideNavigation}",expanded:false,customData:[new a({key:"help-id",value:"{= 'MenuEntry-' + ${spaces>help-id}}",writeToDom:"{= !!${spaces>help-id}}"})],select:this._onSideNavigationItemSelection.bind(this),icon:"{spaces>icon}"})}})}_onSideNavigationItemSelection(e){this.#e.updateSelectedKey();const t=e.getParameter("item").getBindingContext("spaces").getProperty();this.#e.closeSideNavigation();this.#s.navigate(t)}}return g},false);
//# sourceMappingURL=Spaces.js.map