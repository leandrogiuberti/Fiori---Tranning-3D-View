// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/CustomData","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/thirdparty/hasher","sap/base/util/ObjectPath","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/utils/WindowUtils","sap/m/IconTabFilter","sap/m/IconTabSeparator","sap/ushell/Config","sap/ushell/Container"],(e,t,n,i,a,s,o,r,u,c,h,g)=>{"use strict";return t.extend("sap.ushell.components.shell.MenuBar.controller.MenuBar",{onInit:function(){this.oContainerRouter=g.getRendererInternal().getRouter();this.oContainerRouter.getRoute("home").attachMatched(this._selectIndexAfterRouteChange,this);this.oContainerRouter.getRoute("openFLPPage").attachMatched(this._selectIndexAfterRouteChange,this);this.oContainerRouter.getRoute("openWorkPage").attachMatched(this._selectIndexAfterRouteChange,this);this.oEventHubListener=s.on("enableMenuBarNavigation").do(e=>{this.getView().getModel("viewConfiguration").setProperty("/enableMenuBarNavigation",e)});const e=new n({selectedKey:"None Existing Key",enableMenuBarNavigation:true,ariaTexts:{headerLabel:o.i18n.getText("SpacePageNavgiationRegion")}});this.getView().setModel(e,"viewConfiguration");this.oURLParsingService=g.getServiceAsync("URLParsing");this.oGetDefaultSpacePromise=g.getServiceAsync("Menu").then(e=>e.getDefaultSpace());this._selectIndexAfterRouteChange();const t=this.byId("navigationBar");if(t){t.removeStyleClass("sapContrast")}},onMenuItemSelection:function(e){const t=e.getParameter("key");const n=this.getView().getModel("menu");const i=n.getProperty("/");const a=this._getNestedMenuEntryByUid(i,t);if(a.type==="IBN"){this._performNavigation(a.target)}if(a.type==="URL"){this._openURL(a.target)}},_getNestedMenuEntry:function(e,t){return e.reduce((e,n)=>{if(e){return e}if(t(n)){return n}if(n.menuEntries){return this._getNestedMenuEntry(n.menuEntries,t)}},undefined)},_getNestedMenuEntryByUid:function(e,t){function n(e){return e.uid===t}return this._getNestedMenuEntry(e,n)},_performNavigation:async function(e){const t=await g.getServiceAsync("Navigation");const n={};e.parameters.forEach(e=>{if(e.name&&e.value){n[e.name]=[e.value]}});t.navigate({target:{semanticObject:e.semanticObject,action:e.action},params:n})},_openURL:function(e){r.openURL(e.url,"_blank")},_selectIndexAfterRouteChange:async function(){const e=this.getView().getModel("viewConfiguration");const t=await this.oURLParsingService;const n=await this.oGetDefaultSpacePromise;await this.getOwnerComponent().oMenuModelPromise;let s;const o=i.getHash();const r=t.parseShellHash(o);const u=this.getView().getModel("menu").getProperty("/");if(r.semanticObject==="Shell"&&r.action==="home"){if(h.last("/core/homeApp/enabled")){s=this._getHomeAppUID(u)||""}else{const e=n&&n.children&&n.children[0];s=e?this._getMenuUID(u,n.id,e.id)||"":""}e.setProperty("/selectedKey",s)}else{const t=a.get("params.spaceId.0",r);const n=a.get("params.pageId.0",r);const i=e.getProperty("/selectedKey");const o=this._getNestedMenuEntryByUid(u,i);if(this._hasSpaceIdAndPageId(o,t,n)){s=o.uid}else{s=this._getMenuUID(u,t,n)}if(s){e.setProperty("/selectedKey",s)}else{e.setProperty("/selectedKey","None Existing Key")}}},_getMenuUID:function(e,t,n){function i(e){return this._hasSpaceIdAndPageId(e,t,n)}const a=this._getNestedMenuEntry(e,i.bind(this));return a&&a.uid},_getHomeAppUID:function(e){function t(e){return e.target.semanticObject==="Shell"&&e.target.action==="home"}const n=this._getNestedMenuEntry(e,t.bind(this));return n&&n.uid},_hasSpaceIdAndPageId:function(e,t,n){const i=a.get("target.parameters",e)||[];const s=i.find(e=>e.name==="spaceId"&&e.value===t);const o=i.find(e=>e.name==="pageId"&&e.value===n);return s!==undefined&&o!==undefined},_menuFactory:function(t,n){const i=n.getModel();if(i.getProperty(n.sPath).type==="separator"){return new c}const a=n.getObject();return new u(t,{key:a.uid,text:"{menu>title}",enabled:"{viewConfiguration>/enableMenuBarNavigation}",items:{path:"menu>menuEntries",factory:this._menuFactory.bind(this)}}).addCustomData(new e({key:"help-id",value:"{= 'MenuEntry-' + ${menu>help-id}}",writeToDom:"{= !!${menu>help-id}}"}))},onExit:function(){this.oEventHubListener.off()}})});
//# sourceMappingURL=MenuBar.controller.js.map