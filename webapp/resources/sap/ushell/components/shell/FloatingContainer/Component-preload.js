//@ui5-bundle sap/ushell/components/shell/FloatingContainer/Component-preload.js
// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.predefine("sap/ushell/components/shell/FloatingContainer/Component", ["sap/base/i18n/Localization","sap/base/Log","sap/base/util/restricted/_debounce","sap/base/util/restricted/_throttle","sap/ui/core/Component","sap/ui/core/EventBus","sap/ui/core/Fragment","sap/ui/Device","sap/ui/model/json/JSONModel","sap/ui/util/Storage","sap/ushell/renderer/ShellLayout","sap/ushell/state/BindingHelper","sap/ushell/state/ShellModel","sap/ushell/state/StateManager","sap/ushell/UIActions"],(e,t,i,o,n,s,r,l,a,c,d,h,p,g,f)=>{"use strict";const u=d.ShellArea;const _=g.Operation;const y={start:"start",end:"end"};const k={floating:"floating",dockedRight:"docked:right",dockedLeft:"docked:left"};return n.extend("sap.ushell.components.shell.FloatingContainer.Component",{metadata:{manifest:"json",library:"sap.ushell"},init:function(){this._bFirstTimeControlRender=true;this._oStorage=new c(c.Type.local,"com.sap.ushell.adapters.local.FloatingContainer");this._oWrapperDomRef=document.getElementById(u.FloatingContainer);this._fnDebouncedHandleUIActionActivation=i(this._handleUIActionActivation.bind(this),300);this._fnThrottledHandleDockingPreview=o(this._handleDockingPreview.bind(this),250);this.oModel=new a({docked:false,dockPosition:y.start,floatingContainer:{visible:false},containerStyles:{initialized:false,top:0,left:0,fullHeight:false,position:"absolute",display:"block"},dockingPreview:{open:false,dockPosition:y.start}});l.resize.attachHandler(this._handleResize,this);this.oDragSelectorBinding=p.getModel().bindProperty("/floatingContainer/dragSelector");this.oDragSelectorBinding.attachChange(this._handleDragSelectorUpdate,this);this.oVisibleBinding=p.getModel().bindProperty("/floatingContainer/visible");this.oVisibleBinding.attachChange(this._handleVisibilityUpdate,this);this.oDockedBinding=this.oModel.bindProperty("/docked");this.oDockedBinding.attachChange(this._storeState,this);this.oDockPositionBinding=this.oModel.bindProperty("/dockPosition");this.oDockPositionBinding.attachChange(this._storeState,this);this._restoreState();const e=this._createControl();this._initWrapper();this.oInitPromise=Promise.all([e])},_createControl:async function(){this.oFloatingContainer=await r.load({name:"sap.ushell.components.shell.FloatingContainer.FloatingContainer",controller:this});h.overrideUpdateAggregation(this.oFloatingContainer);this.oFloatingContainer.addEventDelegate({onAfterRendering:this._handleOnAfterRendering},this);this.oFloatingContainer.attachRerenderingPrevented(this._handleOnAfterRendering,this);this.oFloatingContainer.setModel(p.getModel(),"shellModel");this.oFloatingContainer.setModel(this.oModel);this.oFloatingContainer.placeAt(u.FloatingContainer,"only");if(this._getVisibility()){return new Promise(e=>{setTimeout(()=>{this._handleVisibilityUpdate();e()},0)})}},_initWrapper:function(){const e=this._getWrapperDomRef();const t=this._restoreWrapperStyles();if(!t){if(!this._isDocked()){const e=l.resize.height;const t=document.getElementById(u.ShellHeader).offsetHeight;const i=t/e*100;const o=60;this.oModel.setProperty("/containerStyles/left",o);this.oModel.setProperty("/containerStyles/top",i)}else{if(this.oModel.getProperty("/dockPosition")===y.end){this.oModel.setProperty("/containerStyles/left",100)}else{this.oModel.setProperty("/containerStyles/left",0)}this.oModel.setProperty("/containerStyles/top",0)}}e.classList.add("sapUshellFloatingContainerWrapper");this._renderWrapperStyles()},_renderWrapperStyles:function(){const e=this._getWrapperDomRef();const t=this.oModel.getProperty("/containerStyles");e.style.left=`${t.left}%`;e.style.top=`${t.top}%`;if(t.fullHeight){e.style.height="100%"}else{e.style.height=""}e.style.position=t.position;e.style.display=t.display;if(this.oModel.getProperty("/docked")){e.classList.add("sapUshellContainerDocked");if(this.oModel.getProperty("/dockPosition")===y.start){e.classList.add("sapUshellContainerDockedStart");e.classList.remove("sapUshellContainerDockedEnd")}else{e.classList.add("sapUshellContainerDockedEnd");e.classList.remove("sapUshellContainerDockedStart")}}else{e.classList.remove("sapUshellContainerDocked");e.classList.remove("sapUshellContainerDockedStart");e.classList.remove("sapUshellContainerDockedEnd")}this._storeWrapperStyles()},_getControl:function(){return this.oFloatingContainer},_getCloneDomRef:function(){return document.querySelector(".sapUshellFloatingContainer-clone")},_getWrapperDomRef:function(){return this._oWrapperDomRef},_getVisibility:function(){return p.getModel().getProperty("/floatingContainer/visible")},_restoreWrapperStyles:function(){if(this._isDocked()){return false}const e=this._oStorage.get("floatingContainerStyle");if(!e){return false}const i=e.split(";");i.forEach(e=>{if(!e.includes(":")){t.warning(`Cannot restore and parse property: '${e}'`);return}const[i,o]=e.split(":").map(e=>e.trim());switch(i){case"left":case"top":const e=parseFloat(o.replace("%",""));this.oModel.setProperty(`/containerStyles/${i}`,e);break;case"position":this.oModel.setProperty(`/containerStyles/${i}`,o);break;case"display":break;default:t.warning(`Cannot restore unknown property: '${i}'`)}});return true},_storeWrapperStyles:function(){const e=this._getWrapperDomRef();this._oStorage.put("floatingContainerStyle",e.style.cssText)},_storeState:function(){const e=this._getState();this._oStorage.put("lastState",e);g.updateAllBaseStates("floatingContainer.state",_.Set,e)},_getState:function(){const t=this._isDocked();if(!t){return k.floating}const i=e.getRTL();const o=this.oModel.getProperty("/dockPosition");let n;if(i){n=o===y.start?"right":"left"}else{n=o===y.end?"right":"left"}if(n==="left"){return k.dockedLeft}return k.dockedRight},_restoreState:function(){const t=this._oStorage.get("lastState");if(t){const i=t.includes("docked");const o=this._isDockSupported();this.oModel.setProperty("/docked",i&&o);if(i&&o){const i=e.getRTL();const o=t.includes("left")?"left":"right";let n;if(i){n=o==="right"?y.start:y.end}else{n=o==="left"?y.start:y.end}this.oModel.setProperty("/dockPosition",n)}}},_getBoundingClientRect(e){return e.getBoundingClientRect()},_storeCurrentWrapperPosition:function(){const t=e.getRTL();const i=this._getWrapperDomRef();const o=this._getBoundingClientRect(i);const n=l.resize.width;const s=o.left;let r;if(t){const e=i.offsetWidth;r=(s+e)/n*100}else{r=s/n*100}const a=l.resize.height;const c=o.top;const d=c/a*100;this.oModel.setProperty("/containerStyles/left",r);this.oModel.setProperty("/containerStyles/top",d)},_isDocked:function(){return this.oModel.getProperty("/docked")},_isFullScreen:function(){return window.matchMedia?window.matchMedia("(max-width: 417px)").matches:false},_isDockingAreaOpen:function(){return!!this._getDockingPreview()},_isDockSupported:function(){const e=l.media.getCurrentRange(l.media.RANGESETS.SAP_STANDARD);return e.name==="Desktop"},_adjustPosition:function(){const t=this._getControl().getDomRef();const i=this._getWrapperDomRef();const o=this._isFullScreen();if(!t||!i||o){return}const n=l.resize.width;const s=l.resize.height;const r=t.offsetWidth;const a=t.offsetHeight;const c=e.getRTL();const d=this.oModel.getProperty("/containerStyles/left");let h=n*d/100;const p=this.oModel.getProperty("/containerStyles/top");let g=s*p/100;if(isNaN(h)||isNaN(g)){return}if(c){const e=h<r||h>n;if(e){h=h<r?r:n}}else{const e=h<0||n<h+r;if(e){h=h<0?0:n-r}}if(s<g+a){g=s-a}if(g<0){g=0}this.oModel.setProperty("/containerStyles/left",h/n*100);this.oModel.setProperty("/containerStyles/top",g/s*100);this.oModel.setProperty("/containerStyles/position","absolute");this._renderWrapperStyles()},_handleOnAfterRendering:function(){this._adjustPosition();this._handleDragSelectorUpdate()},_handleResize:function(){this._fnDebouncedHandleUIActionActivation();const e=this._getWrapperDomRef();const t=!!e;const i=this._isDocked();if(t&&!i){this._adjustPosition()}if(i){this._emitResizeWhileDockedEvent();this._emitAppFinderResizeEvent()}if(!this._isDockSupported()&&i){this._removeFromDock();this._adjustPosition();this._emitUndockedOnResizeEvent()}},_handleVisibilityUpdate:async function(){const e=this._getVisibility();if(!this._isDocked()){this.oModel.setProperty("/floatingContainer/visible",e);return}if(e){if(this._isDockSupported()){const e=this.oModel.getProperty("/dockPosition");this._moveIntoDock(e)}else{this.oModel.setProperty("/docked",false)}}else{await this._startAnimation(false)}this.oModel.setProperty("/floatingContainer/visible",e);this._emitAppFinderResizeEvent()},_handleUIActionActivation:function(){if(!this.oUIActions){return}if(this._isFullScreen()){this.oUIActions.disable()}else{this.oUIActions.enable()}},_handleDragSelectorUpdate:function(){const e=p.getModel().getProperty("/floatingContainer/dragSelector");if(!e){if(this.oUIActions){this.oUIActions.disable()}return}const i=this._getControl().getDomRef();const o=i.querySelectorAll(e);if(o.length){o.forEach(e=>e.classList.add("sapUshellFloatingContainerSelector"))}else{t.error("_handleDragSelectorUpdate could not find the element","sap.ushell.renderer.Shell.controller");if(this.oUIActions){this.oUIActions.disable()}return}if(!this.oUIActions){this.oUIActions=new f({containerSelector:".sapUiBody",wrapperSelector:".sapUshellFloatingContainerWrapper",draggableSelector:".sapUshellFloatingContainerWrapper",rootSelector:".sapUiBody",cloneClass:"sapUshellFloatingContainer-clone",dragCallback:this._handleDrag.bind(this),endCallback:this._handleDrop.bind(this),moveTolerance:3,onDragStartUIHandler:this._onDragStart.bind(this),dragAndScrollCallback:this._onDrag.bind(this),switchModeDelay:1e3,isLayoutEngine:false,isTouch:false,elementToCapture:e,defaultMouseMoveHandler:function(){},debug:t.getLevel()>=t.Level.DEBUG})}else{this.oUIActions.setElementsToCapture(o)}this._handleUIActionActivation()},_onDrag:function(t){if(!this._isDockSupported()){return}const i=l.resize.width;const o=e.getRTL();if(t.moveX>=i-64){const e=o?y.start:y.end;this.oModel.setProperty("/dockingPreview/open",true);this.oModel.setProperty("/dockingPreview/dockPosition",e)}else if(t.moveX<64){const e=o?y.end:y.start;this.oModel.setProperty("/dockingPreview/open",true);this.oModel.setProperty("/dockingPreview/dockPosition",e)}else{this.oModel.setProperty("/dockingPreview/open",false)}this._fnThrottledHandleDockingPreview()},_expandToDock:function(){this.oModel.setProperty("/containerStyles/fullHeight",true);this._renderWrapperStyles()},_shrinkToDragUI:function(){this.oModel.setProperty("/docked",false);this.oModel.setProperty("/containerStyles/fullHeight",false);this._renderWrapperStyles()},_removeFromDock:function(){if(!this._isDocked()){return}const e=this._getWrapperDomRef();const t=document.getElementById(u.RootDomRef);t.appendChild(e);this.oModel.setProperty("/docked",false);this._renderWrapperStyles();this._emitUndockedEvent();this._shrinkToDragUI();this._emitAppFinderResizeEvent()},_onDragStart:function(){this._storeCurrentWrapperPosition();this._removeFromDock()},_startAnimation:function(e){this._clearAnimation();const t=this._getWrapperDomRef();return new Promise(i=>{if(e){t.classList.add("sapUshellContainerDockedExtendCoPilot")}else{t.classList.add("sapUshellContainerDockedMinimizeCoPilot")}this._attachAnimationEnd(t,()=>{this._clearAnimation();i()})})},_attachAnimationEnd:function(e,t){["webkitAnimationEnd","onanimationend","msAnimationEnd","animationend"].forEach(i=>{e.addEventListener(i,t,{once:true})})},_clearAnimation:function(){const e=this._getWrapperDomRef();e.classList.remove("sapUshellContainerDockedExtendCoPilot");e.classList.remove("sapUshellContainerDockedMinimizeCoPilot")},_getDockingPreview:function(){return document.getElementById("DockingAreaDiv")},_createDockingPreview:function(){const e=document.createElement("div");e.id="DockingAreaDiv";return e},_handleDockingPreview:function(){const e=this._getCloneDomRef();const t=this.oModel.getProperty("/dockingPreview/open");const i=this.oModel.getProperty("/dockingPreview/dockPosition");if(t&&e&&!this._getDockingPreview()){const t=this._createDockingPreview();if(i===y.start){t.classList.add("sapUshellShellDisplayDockingAreaLeft")}else{t.classList.add("sapUshellShellDisplayDockingAreaRight")}e.parentElement.appendChild(t)}else if(!t){window.setTimeout(()=>{const e=this._getDockingPreview();e?.remove?.()},150)}},_moveIntoDock:function(e){const t=this._getWrapperDomRef();let i;if(e===y.start){i=document.getElementById(u.FloatingContainerDockStart)}else{i=document.getElementById(u.FloatingContainerDockEnd)}i.appendChild(t);this.oModel.setProperty("/docked",true);this.oModel.setProperty("/dockPosition",e);this._renderWrapperStyles();this._emitDockedEvent();this._expandToDock();this._startAnimation(true);this._emitAppFinderResizeEvent()},_handleDrop:function(e,t,i){const o=l.resize.width;const n=l.resize.height;let s=i.deltaX/o;let r=-i.deltaY/n;const a=this.oModel.getProperty("/containerStyles/left");const c=this.oModel.getProperty("/containerStyles/top");if(typeof a==="number"){s=a+100*i.deltaX/o}if(typeof c==="number"){r=c+100*i.deltaY/n}if(this._isDockingAreaOpen()){r=0}this.oModel.setProperty("/containerStyles/left",s);this.oModel.setProperty("/containerStyles/top",r);this.oModel.setProperty("/containerStyles/position","absolute");this.oModel.setProperty("/containerStyles/display","block");this._renderWrapperStyles();this._adjustPosition();if(this._isDockingAreaOpen()){this.oModel.setProperty("/dockingPreview/open",false);this._handleDockingPreview();const e=this.oModel.getProperty("/dockingPreview/dockPosition");this._moveIntoDock(e)}},_handleDrag:function(){this.oModel.setProperty("/containerStyles/display","none");this._renderWrapperStyles();if(window.getSelection){const e=window.getSelection();try{e.removeAllRanges()}catch{}}const e=this._getCloneDomRef();const t=e?.querySelector?.(".sapUshellFloatingContainer");if(t){t.classList.remove("sapUshellShellFloatingContainerFullHeight");const e=this._getControl().getContent()[0];if(e&&e.getHeight){t.children[0].style.height=e.getHeight()}}},_emitAppFinderResizeEvent:function(){window.setTimeout(()=>{s.getInstance().publish("launchpad","appFinderWithDocking")},300)},_emitResizeWhileDockedEvent:function(){s.getInstance().publish("launchpad","shellFloatingContainerDockedIsResize")},_emitDockedEvent:function(){const e={visible:this._getVisibility()};s.getInstance().publish("launchpad","shellFloatingContainerIsDocked",e)},_emitUndockedEvent:function(){const e={visible:this._getVisibility()};s.getInstance().publish("launchpad","shellFloatingContainerIsUnDocked",e)},_emitUndockedOnResizeEvent:function(){const e={visible:this._getVisibility()};s.getInstance().publish("launchpad","shellFloatingContainerIsUnDockedOnResize",e)},exit:function(){this._getControl().destroy();this.oModel.destroy();l.resize.detachHandler(this._handleResize,this);this.oDragSelectorBinding.destroy();this.oVisibleBinding.destroy();this.oDockedBinding.destroy();this.oDockPositionBinding.destroy();if(this.oUIActions){this.oUIActions.disable()}}})});
// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.predefine("sap/ushell/components/shell/FloatingContainer/controls/FloatingContainer", ["sap/ui/core/Control","sap/ui/Device","sap/ushell/library"],(e,t,l)=>{"use strict";const i=e.extend("sap.ushell.components.shell.FloatingContainer.controls.FloatingContainer",{metadata:{library:"sap.ushell",properties:{visible:{type:"boolean",defaultValue:true},fullHeight:{type:"boolean",defaultValue:false}},aggregations:{content:{type:"sap.ui.core.Control",multiple:true}},events:{rerenderingPrevented:{}}},renderer:{apiVersion:2,render:function(e,l){e.openStart("div",l);e.class("sapUshellFloatingContainer");if(t.system.desktop){e.attr("tabindex","-1")}e.openEnd();if(l.getContent()&&l.getContent().length){e.renderControl(l.getContent()[0])}e.close("div")}}});i.prototype.setFullHeight=function(e){const t=this.getProperty("fullHeight")!==e&&this.getDomRef();if(e){this.addStyleClass("sapUshellShellFloatingContainerFullHeight")}else{this.removeStyleClass("sapUshellShellFloatingContainerFullHeight")}this.setProperty("fullHeight",e,true);if(t){this.fireRerenderingPrevented()}return this};i.prototype.setVisible=function(e){const t=this.getProperty("visible")!==e&&this.getDomRef();if(e){this.removeStyleClass("sapUshellShellHidden")}else{this.addStyleClass("sapUshellShellHidden")}this.setProperty("visible",e,true);if(t){this.fireRerenderingPrevented()}return this};return i});
sap.ui.require.preload({
	"sap/ushell/components/shell/FloatingContainer/FloatingContainer.fragment.xml":'<core:FragmentDefinition\n    xmlns="sap.m"\n    xmlns:core="sap.ui.core"\n    xmlns:floatingContainer="sap.ushell.components.shell.FloatingContainer.controls"\n    core:require="{\n        BindingHelper: \'sap/ushell/state/BindingHelper\'\n    }"><floatingContainer:FloatingContainer\n        id="shell-floatingContainer"\n        visible="{/floatingContainer/visible}"\n        fullHeight="{/containerStyles/fullHeight}"\n        content="{\n            path: \'shellModel>/floatingContainer/items\',\n            factory: \'BindingHelper.factory\'\n        }"></floatingContainer:FloatingContainer></core:FragmentDefinition>\n',
	"sap/ushell/components/shell/FloatingContainer/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ushell.components.shell.FloatingContainer","applicationVersion":{"version":"1.141.1"},"i18n":{"bundleUrl":"../../../renderer/resources/resources.properties","supportedLocales":["","ar","bg","ca","cs","da","de","el","en","en_US","en_US_sappsd","en_US_saptrc","es","et","fi","fr","hi","hr","hu","it","iw","ja","kk","ko","lt","lv","ms","nl","no","pl","pt","ro","ru","sh","sk","sl","sv","th","tr","uk","vi","zh_CN","zh_TW"],"fallbackLocale":"en"},"type":"component","title":"","resources":"resources.json"},"sap.ui":{"technology":"UI5","deviceTypes":{"desktop":true,"tablet":true,"phone":true}},"sap.ui5":{"dependencies":{"minUI5Version":"1.127","libs":{"sap.ui.core":{},"sap.m":{},"sap.tnt":{}}},"models":{},"contentDensities":{"compact":true,"cozy":true}}}'
});
//# sourceMappingURL=Component-preload.js.map
