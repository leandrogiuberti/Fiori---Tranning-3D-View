// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/Device","sap/ui/core/Element","sap/ui/core/EventBus","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel","sap/ui/thirdparty/hasher","sap/ushell/Config","sap/ushell/Container","sap/ushell/EventHub","sap/ushell/api/NewExperience","sap/ushell/gen/ui5/webcomponents-fiori/dist/ShellBarItem","sap/ushell/gen/ui5/webcomponents-fiori/dist/ShellBarSpacer","sap/ushell/gen/ui5/webcomponents/dist/Button","sap/ushell/state/BindingHelper","sap/ushell/state/modules/BackNavigation","sap/ushell/state/ShellModel","sap/ushell/ui/shell/ShellAppTitle","sap/ushell/utils"],(e,t,i,n,o,s,l,a,r,c,h,u,d,p,f,g,m,C)=>{"use strict";const T=["NOTIFICATIONSCOUNTBUTTON","PRODUCTSWITCHBTN","USERACTIONSMENUHEADERBUTTON","SF"];return n.extend("sap.ushell.components.shell.ShellBar.controller.ShellBar",{_aDoables:[],onInit:function(){p.overrideUpdateAggregation(this.byId("shellBar"));this._aDoables.push(l.on("/core/shellHeader/homeUri").do(this._updateHomeUri.bind(this)));this._updateHomeUri(l.last("/core/shellHeader/homeUri"));this.getView().setModel(this.getConfigurationModel(),"config");this.getView().setModel(g.getConfigModel(),"shellConfig");this.prepareShellAppTitle();this._aDoables.push(r.on("navigateBack").do(this.pressNavBackButton.bind(this)));this._aDoables.push(r.on("navigateFromShellApplicationNavigationMenu").do(this.navigateFromShellApplicationNavigationMenu.bind(this)));e.resize.attachHandler(this.handleResize.bind(this))},handleResize:function(e){if(this._iDebounceTimerHandleResize){clearTimeout(this._iDebounceTimerHandleResize)}this._iDebounceTimerHandleResize=setTimeout(()=>{const e=this.byId("shellBar");e.getBinding("content").refresh(true)},400)},getConfigurationModel:function(){const e=new o({windowTitleExtension:l.last("/core/shell/windowTitleExtension")||""});return e},onContentItemVisibilityChange:function(e){if(this._iDebounceTimerContentItemVisibilityChange){clearTimeout(this._iDebounceTimerContentItemVisibilityChange)}this._iDebounceTimerContentItemVisibilityChange=setTimeout(()=>{const i=e.getParameter("items");const n=c.getShellHeaderControl()?.getId();const o=i.reduce((e,t)=>{const i=t.getId();if(["shellAppTitle",n].includes(i)){e[i]=t}return e},{});if(o.shellAppTitle){o.shellAppTitle.setShowAppTitle(false)}const s=t.getElementById(this.getOwnerComponent().getAppTitle());const l=o[n];if(l){s.setNewExperienceControl(l)}else if(c.getShellHeaderControl()?.getParent()===this.byId("shellBar")){s.setNewExperienceControl(null)}},400)},onSearchButtonClick:function(e){i.getInstance().subscribeOnce("shell","searchCompLoaded",()=>{this.getOwnerComponent().fireSearchButtonPress(e)});this.getOwnerComponent().fireSearchButtonPress(e);t.getElementById("newCEPShellBarSearch")?.fireSearch()},_delegateHeadEndItemClick:function(e){const i=g.getModel().getProperty("/header/headEndItems");const n=e.toUpperCase();const o=i.find(e=>e.toUpperCase()===n);if(!o){return}const s=t.getElementById(o);if(!s){return}if(typeof s.firePress==="function"){s.firePress()}else if(typeof s.fireClick==="function"){s.fireClick()}},onProfileClick:function(){return this._delegateHeadEndItemClick("USERACTIONSMENUHEADERBUTTON")},isHeadEndItem:function(e){const i=e.toUpperCase();if(T.includes(i)){return false}const n=t.getElementById(e);return n instanceof h},isContentItem:function(e){const i=e.toUpperCase();if(T.includes(i)){return false}const n=t.getElementById(e);return!(n instanceof h)},isProfileMenu:function(e){return e==="USERACTIONSMENUHEADERBUTTON"},hasNotifications:function(e){const i=e.some(e=>e.toUpperCase()==="NOTIFICATIONSCOUNTBUTTON");if(i){const e=t.getElementById("NotificationsCountButton").getModel("configModel");this.getView().setModel(e,"configModel")}return i},onNotificationsClick:function(){return this._delegateHeadEndItemClick("NOTIFICATIONSCOUNTBUTTON")},hasProducts:function(e){return e.some(e=>e.toUpperCase()==="PRODUCTSWITCHBTN")},onProductSwitchClick:function(){return this._delegateHeadEndItemClick("PRODUCTSWITCHBTN")},prepareShellAppTitle:function(){const e=new u({id:"shellBarSpacer"});const t=new m({id:"shellAppTitle",text:"{shellModel>/application/title}",title:"{shellModel>/application/title}",icon:"{shellModel>/application/icon}",subTitle:"{shellModel>/application/subTitle}"});t.data("hide-order","9999",true);this.getOwnerComponent().setAppTitle(t);a.getRendererInternal("fiori2").addHeaderEndItem({id:t.getId()},true,false);a.getRendererInternal("fiori2").addHeaderEndItem({id:e.getId()},true,false)},_updateHomeUri:function(e){const t=this.getOwnerComponent().getModel();t.setProperty("/logo/homeUri",e);t.setProperty("/logo/isRootIntent",C.isRootIntent(e))},pressNavBackButton:async function(){r.emit("showUserActionsMenu",false);f.navigateBack()},navigateFromShellApplicationNavigationMenu:function(e){if(s.getHash()!==e.substr(1)){r.emit("centerViewPort",Date.now());s.setHash(e)}const i=t.getElementById("shellAppTitle");if(i){i.close()}},onSearchFieldToggle:function(){const e=t.getElementById("newCEPShellBarSearch");if(e){const t=this.getOwnerComponent().getModel().getProperty("/searchField/show");if(!t&&e.getValue()){e.setValue("")}}},onExit:function(){this._aDoables.forEach(e=>{e.off()});this._aDoables=[]}})});
//# sourceMappingURL=ShellBar.controller.js.map