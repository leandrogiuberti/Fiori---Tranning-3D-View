// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Element","sap/ui/core/mvc/XMLView","sap/ui/core/UIComponent","sap/ushell/Config","sap/ushell/EventHub","sap/ushell/resources","sap/ushell/components/shell/Settings/userAccount/UserAccountEntry","sap/ushell/components/shell/Settings/appearance/AppearanceEntry","sap/ushell/components/shell/Settings/homepage/HomepageEntry","sap/ushell/components/shell/Settings/spaces/SpacesEntry","sap/ushell/components/shell/Settings/userActivities/UserActivitiesEntry","sap/ushell/components/shell/Settings/notifications/NotificationsEntry","sap/ushell/components/shell/Settings/userDefaults/UserDefaultsEntry","sap/ushell/ui/shell/ShellHeadItem","sap/ushell/utils","sap/ushell/Container","sap/ushell/state/StateManager"],(e,t,s,n,i,r,o,a,l,c,h,u,g,p,d,f,S)=>{"use strict";const m=S.Operation;const y=[];return s.extend("sap.ushell.components.shell.Settings.Component",{metadata:{version:"1.141.0",library:"sap.ushell",dependencies:{libs:{"sap.m":{},"sap.ui.layout":{lazy:true}}}},init:function(){s.prototype.init.apply(this,arguments);this._aInitPromises=[];const e=f.getRendererInternal("fiori2").getShellConfig();if(e.moveUserSettingsActionToShellHeader){this._aInitPromises.push(this._addUserSettingsButton().then(e=>{this.oSettingsBtn=e}))}this._addStandardEntityToConfig();this._addUserLanguageAndRegionSettings();if(n.last("/core/shell/model/enableNotifications")){this._addNotificationSettings()}y.push(i.on("openUserSettings").do(this._openUserSettings.bind(this)));this._pInitPromise=Promise.all(this._aInitPromises)},_updateUserPreferencesEntries:function(e){if(e){e=f.getRendererInternal("fiori2").reorderUserPrefEntries(e);n.emit("/core/userPreferences/entries",e)}},_addUserLanguageAndRegionSettings:function(){const e=f.getUser();e.getLanguageAndRegionSettingsEntry().then(e=>{const t=n.last("/core/userPreferences/entries");t.push(e.getEntry());this._updateUserPreferencesEntries(t)})},_addStandardEntityToConfig:function(){let e=n.last("/core/userPreferences/entries");e.push(o.getEntry());e.push(a.getEntry());if(c.isRelevant()){e.push(c.getEntry())}if(n.last("/core/shell/enableRecentActivity")){e.push(h.getEntry())}if(n.last("/core/shell/model/searchAvailable")){f.getFLPPlatform().then(t=>{if(t!=="MYHOME"){sap.ui.require(["sap/ushell/components/shell/Settings/search/SearchEntry"],t=>{t.getEntry().then(t=>{t.isActive().then(s=>{if(!s){return}d.setPerformanceMark("FLP -- search setting entry is set active");e=n.last("/core/userPreferences/entries");e.push(t);this._updateUserPreferencesEntries(e)})})})}})}if(n.last("/core/home/enableHomePageSettings")&&!n.last("/core/spaces/enabled")){e.push(l.getEntry())}if(n.last("/core/shell/model/userDefaultParameters")){e.push(g.getEntry())}e=f.getRendererInternal("fiori2").reorderUserPrefEntries(e);this._updateUserPreferencesEntries(e)},_addNotificationSettings:function(){f.getServiceAsync("NotificationsV2").then(e=>{e._userSettingInitialization();e._getNotificationSettingsAvailability().then(e=>{if(e.settingsAvailable){const e=n.last("/core/userPreferences/entries");e.push(u.getEntry());this._updateUserPreferencesEntries(e)}})}).catch(()=>{})},_openUserSettings:function(s){if(!this.oDialogPromise){this.oDialogPromise=t.create({id:"settingsView",viewName:"sap.ushell.components.shell.Settings.UserSettings"}).then(t=>{this.oSettingsView=t;const n=s.controlId||"shell-header";e.getElementById(n).addDependent(t);return t})}return this.oDialogPromise.then(e=>{e.getController().open(s?.targetEntryId)})},_addUserSettingsButton:async function(){let e;if(n.last("/core/shellBar/enabled")){const[t]=await d.requireAsync(["sap/ushell/gen/ui5/webcomponents-fiori/dist/ShellBarItem"]);e=new t({id:"userSettingsBtn",icon:"sap-icon://action-settings",text:r.i18n.getText("userSettings"),accessibilityAttributes:{hasPopup:"dialog"},click:this._openUserSettings.bind(this)})}else{e=new p({id:"userSettingsBtn",icon:"sap-icon://action-settings",text:r.i18n.getText("userSettings"),ariaHaspopup:"dialog",press:this._openUserSettings.bind(this)})}S.updateAllBaseStates("userActions.items",m.Add,e.getId());return e},exit:function(){for(let e=0;e<y.length;e++){y[e].off()}if(this.oSettingsView){this.oSettingsView.destroy();this.oSettingsView=null;this.oDialogPromise=null}if(this.oSettingsBtn){this.oSettingsBtn.destroy();this.oSettingsBtn=null}}})});
//# sourceMappingURL=Component.js.map