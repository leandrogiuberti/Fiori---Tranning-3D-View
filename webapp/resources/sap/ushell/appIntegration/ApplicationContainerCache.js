// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log"],e=>{"use strict";class t{#e=[];#t={};constructor(){this.init()}init(){this.#e=[];this.#t=[]}setContainerActive(t){if(!t){return}if(this.#e.includes(t)){e.warning("The container is already active");return}this.removeByContainer(t);this.#e.push(t)}setContainerReadyForReuse(t,n){if(!t){return}if(!this.#e.includes(t)&&this.getById(t.getId())){e.warning("The container is already in pool");return}this.removeByContainer(t);this.#t.push({url:n,key:this.#n(n),container:t})}findFreeContainerByUrl(e){const t=this.#n(e);const n=this.#t.reverse().find(e=>e.key===t);if(n){return n.container}}canBeReused(e,t){if(!e){return false}if(this.#e.includes(e)){return false}const n=this.#n(t);const i=this.#t.find(t=>t.container===e);return!!i&&i.key===n}getLength(){return this.#e.length}getPoolLength(){return this.#t.length}removeByContainer(e){if(!e){return}this.#e=this.#e.filter(t=>t!==e);this.#t=this.#t.filter(t=>t.container!==e)}getById(e){let t;this.forEach(n=>{if(n.getId()===e){t=n}});return t}getAll(){return[...this.#e,...this.#t.map(e=>e.container)]}forEach(e){const t=[];for(const n of this.#e){t.push(e(n))}for(const n of this.#t){t.push(e(n.container))}return Promise.allSettled(t)}#n(e){let t;let n="";let i="";let s="";let a="";let r="";const o=new URL(e,this._getWindowLocationHref());t=o.origin;if(o.port===""){if(o.protocol==="https:"){t=`${t}:443`}else if(o.protocol==="http:"){t=`${t}:80`}}const l=o.searchParams;if(l.has("sap-iframe-hint")){n=`@hint:${l.get("sap-iframe-hint")}`}if(l.has("sap-ui-version")){i=`@uiver:${l.get("sap-ui-version")}`}if(l.has("sap-async-loading")&&l.get("sap-async-loading")!=="true"){s=`@async:${l.get("sap-async-loading")}`}if(l.has("sap-enable-fesr")&&l.get("sap-enable-fesr")!=="false"){a=`@fesr:${l.get("sap-enable-fesr")}`}if(l.has("sap-testcflp-iframeid")){r=`@testid:${l.get("sap-testcflp-iframeid")}`}return t.toLowerCase()+n+i+s+a+r}_getWindowLocationHref(){return window.location.href}_getStorageForDebug(){return{activeContainers:this.#e,reusableContainers:this.#t}}destroyAllContainers(){this.forEach(e=>{this.removeByContainer(e);e.destroy()})}}return new t});
//# sourceMappingURL=ApplicationContainerCache.js.map