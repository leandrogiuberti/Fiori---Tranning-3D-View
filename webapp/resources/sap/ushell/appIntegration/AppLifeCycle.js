// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/Deferred","sap/ui/Device","sap/ui/core/Element","sap/ui/core/EventBus","sap/ushell/appIntegration/KeepAliveApps","sap/ushell/state/modules/BackNavigation","sap/ushell/state/modules/ContentDensity","sap/ushell/state/modules/Favicon","sap/ushell/state/modules/HeaderLogo","sap/ushell/appIntegration/contracts/EmbeddedUI5Handler","sap/ushell/appIntegration/contracts/StatefulContainerV1Handler","sap/ushell/appIntegration/contracts/StatefulContainerV2Handler","sap/ushell/appIntegration/ApplicationContainerCache","sap/ushell/appIntegration/ApplicationHandle","sap/ushell/appIntegration/AppLifeCycle/KeepAliveMode","sap/ushell/appIntegration/PostMessageHandler","sap/ushell/appIntegration/PostMessageManager","sap/ushell/appIntegration/PostMessagePluginInterface","sap/ushell/appIntegration/IframeApplicationContainer","sap/ushell/appIntegration/UI5ApplicationContainer","sap/ushell/services/AppConfiguration","sap/ushell/utils","sap/ushell/Config","sap/ushell/ApplicationType","sap/ushell/utils/UriParameters","sap/base/Log","sap/ushell/EventHub","sap/ushell/utils/UrlParsing","sap/ui/thirdparty/hasher","sap/ushell/renderer/utils","sap/m/library","sap/ushell/AppInfoParameters","sap/ushell/Container","sap/ushell/resources","sap/ushell/state/ShellModel","sap/ushell/state/StateManager","sap/ushell/state/KeepAlive","sap/ushell/ui5service/ShellUIServiceFactory","sap/ui/core/service/ServiceFactoryRegistry","sap/ushell/library","sap/ushell/renderer/RendererManagedComponents"],(e,t,i,n,a,o,s,p,r,l,c,u,h,d,f,g,A,y,C,I,m,v,_,S,w,b,F,R,N,H,P,T,L,U,M,E,D,x,B,W,k)=>{"use strict";const K=W.appIntegration.contracts.StatefulType;const $=E.ShellMode;const O=E.LaunchpadState;const V=E.Operation;const G=P.URLHelper;function q(){this._bDisableHomeAppCache=false;this._bUseLegacyRestoreFlowForNextApp=false;this._oCurrentApplication={};this._oGlobalShellUIService=null;this._oNavContainer=null;this._oInitDeferred=new e;this._pLastApplicationStart=this._oInitDeferred.promise;this._oStorageAppIdMap={};this._oStorageAppIdNextIndex={};this._aDoables=[]}q.prototype.KeepAliveMode=f;q.prototype.init=function(e,t){const i=[];if(_.last("/core/shell/enablePersistantAppstateWhenSharing")){L.getServiceAsync("AppState").then(e=>{const t=G.triggerEmail.bind(G);G.triggerEmail=function(i,n,a,o,s){const p=document.URL;e.setAppStateToPublic(p).done((e,p,r,l,c)=>{n=n&&p&&l&&n.includes(p)?n.replace(p,l):n;n=n&&r&&c&&n.includes(r)?n.replace(r,c):n;a=a&&p&&l&&a.includes(p)?a.replace(p,l):a;a=a&&r&&c&&a.includes(r)?a.replace(r,c):a;t(i,n,a,o,s)}).fail(t)}})}this._startPostMessageHandling();i.push(x.init().then(()=>{B.register("sap.ushell.ui5service.ShellUIService",x)}));i.push(this._createGlobalShellUIService());this._oNavContainer=e;this._bDisableHomeAppCache=t;n.getInstance().subscribe("sap.ushell","getAppLifeCycle",this._onGetAppLifeCycle,this);this._addEvents();i.push(s.init());p.init();r.init();d.init(this,this._oNavContainer);this._oNavContainer.attachAfterNavigate(this.onAfterNavigate.bind(this));this._oNavContainer.attachBeforeNavigate(this.onBeforeNavigate.bind(this));return Promise.allSettled(i).then(()=>{this._oInitDeferred.resolve()})};q.prototype._onGetAppLifeCycle=function(e,t,i){b.error("the EventBus channel 'sap.ushell.getAppLifeCycle' is private and was discontinued.")};q.prototype._addEvents=function(){this._aDoables.push(F.on("disableKeepAliveRestoreRouterRetrigger").do(this._useLegacyRestoreFlowForCurrentApplication.bind(this)));this._aDoables.push(F.on("setApplicationFullWidth").do(e=>{this._setApplicationFullWidth(e.bValue)}));this._aDoables.push(F.on("reloadCurrentApp").do(e=>{this._reloadCurrentApp(e)}))};q.prototype._startPostMessageHandling=function(){A.init({getCurrentApplication:()=>this.getCurrentApplication()?.container,getAllApplications:()=>h.getAll()});g.register();this._waitForPluginsAndReplayPostMessages();y.init(async(e,t)=>{const i=await A.sendRequestToAllApplications(e,t,true);return i[0]?.result},A.setRequestHandler.bind(A),A.setDistributionPolicy.bind(A),true)};q.prototype._waitForPluginsAndReplayPostMessages=async function(){const e=await L.getServiceAsync("PluginManager");const t=e.getPluginLoadingPromise("RendererExtensions");await v.promisify(t);A.replayStoredMessages()};q.prototype.registerHandleHashChange=function(e){e.hashChanger.attachEvent("hashChanged",t=>{if(N.disableBlueBoxHashChangeTrigger){return}const i=t.getParameters();if(i&&e.hashChanger.isInnerAppNavigation(i.newHash,i.oldHash)){A.sendRequestToAllApplications("sap.ushell.appRuntime.innerAppRouteChange",{oHash:i},false)}A.sendRequestToAllApplications("sap.ushell.appRuntime.hashChange",{sHash:i.fullHash},false)})};q.prototype.getCurrentApplication=function(){return this._oCurrentApplication};q.prototype._useLegacyRestoreFlowForCurrentApplication=function(){if(!this.getCurrentApplication()?.appId){this._bUseLegacyRestoreFlowForNextApp=true;return}const e=this.getCurrentApplication().appId;const t=a.get(e);if(t){t.useLegacyRestoreFlow=true}};q.prototype._setApplicationFullWidth=function(e){const t=this.getCurrentApplication();if(t.container){t.container.toggleStyleClass("sapUShellApplicationContainerLimitedWidth",!e)}};q.prototype.getShellUIService=function(){return this._oGlobalShellUIService};q.prototype.resetGlobalShellUIService=function(){if(this._oGlobalShellUIService){this._oGlobalShellUIService.resetService()}};q.prototype._createGlobalShellUIService=async function(){this._oGlobalShellUIService=await x.createInstanceInternal()};q.prototype.onBeforeNavigate=function(e){const t=e.getParameter("fromId")||"";const i=e.getParameter("from");const n=e.getParameter("toId")||"";if(n===t){return}if(t&&i&&i.isA("sap.ushell.appIntegration.IframeApplicationContainer")){const e=i;const t=e.getCurrentAppId();const n=e.getStatefulType()!==K.NotSupported;const o=!!a.get(t);if(o||n){e.sendRequest("sap.ushell.sessionHandler.beforeApplicationHide",{},false)}}};q.prototype.onAfterNavigate=async function(e){const t=e.getParameter("fromId")||"";const i=e.getParameter("from");const o=e.getParameter("toId")||"";const s=e.getParameter("to");const p=t===o;const r=k.isManagedComponentInstance(s);if(t&&i){if(i.isA("sap.ushell.appIntegration.ApplicationContainer")){const e=i;if(!p){await this._handleExitApplication(e,r)}}else{const e=t;const a=i;if(p){return}if(o.indexOf("Shell-appfinder-component")>0){n.getInstance().publish("sap.ushell","appFinderAfterNavigate")}if(this._bDisableHomeAppCache){try{this._removeApplicationContainerFromNavContainer(a);a.destroy()}catch(t){b.error(`Error when trying to destroy the home component: '${e}'`,t)}}}}if(o&&s){if(s.isA("sap.ushell.appIntegration.ApplicationContainer")){const e=s;const t=e.getCurrentAppId();const i=e.getIsFetchedFromCache();if(i&&e.isA("sap.ushell.appIntegration.IframeApplicationContainer")){e.sendRequest("sap.ushell.sessionHandler.afterApplicationShow",{},false)}if(a.get(t)){await this._restoreApplication(t)}}else{if(r){await this._destroyKeepAliveApps(e=>e.keepAliveMode===f.Restricted)}T.flush()}}};q.prototype._storeApplication=async function(e){const t=a.get(e);if(t){const e=t.container;const i=e.getIsKeepAlive();if(!i){b.error("Application should be kept alive but the flag is not set",null,"sap.ushell.appIntegration.AppLifeCycle");return}if(e.isA("sap.ushell.appIntegration.IframeApplicationContainer")){e.setDataHelpId("");if(e.getStatefulType()===K.ContractV2){const t=u.isStatefulContainerSupportingKeepAlive(e);if(t){const t=e.getCurrentAppId();if(!t){return}this._setContainerReadyForReuse(e);await u.storeAppWithinSameFrame(e,t)}}await e.sendRequest("sap.ushell.appRuntime.keepAliveAppHide",{},false)}else if(e.isA("sap.ushell.appIntegration.UI5ApplicationContainer")){await l.storeApp(e,t)}t.stateStored=true;const n=e.getCurrentAppTargetResolution();this._publishAppClosedEvent(n)}};q.prototype.destroyApplication=async function(e,t,i){if(typeof e!=="string"&&i){e="dummy-id"}if(typeof e!=="string"||!t){return}const n=a.get(e);const o=!!n;if(!t.getCurrentAppId()&&!i&&!o){return}const s=t.getCurrentAppTargetResolution();a.removeById(e);D.destroy(n);const p=t.getStatefulType()!==K.NotSupported;if(!i&&p){t.setDataHelpId("");this._setContainerReadyForReuse(t);if(t.getStatefulType()===K.ContractV2){await u.destroyApp(t,e)}else if(t.getStatefulType()===K.ContractV1){await c.destroyApp(t,e)}this._publishAppClosedEvent(s);return}if(t.getStatefulType()===K.ContractV2){await u.destroyApp(t,e)}else if(t.getStatefulType()===K.ContractV1){await c.destroyApp(t,e)}a.removeByContainer(t,e=>{D.destroy(e)});try{const e=t.sendBeforeAppCloseEvent();await v.promisify(e)}catch(e){b.error("FLP got a failed response from the iframe for the 'sap.ushell.services.CrossApplicationNavigation.beforeAppCloseEvent' message sent",e,"sap.ushell.appIntegration.AppLifeCycle.js")}h.removeByContainer(t);this._removeApplicationContainerFromNavContainer(t);try{t.destroy()}catch(e){b.error(`Exception when trying to close application with id '${t.getId()}'. This error must be fixed in order for FLP to operate properly.`,e,"sap.ushell.appIntegration.AppLifeCycle")}this._publishAppClosedEvent(s)};q.prototype._restoreApplication=async function(e){const t=a.get(e);if(t?.stateStored){o.restore(t.service);x.restore(t);const e=t.container;if(e.isA("sap.ushell.appIntegration.IframeApplicationContainer")){await e.sendRequest("sap.ushell.appRuntime.keepAliveAppShow",{},false)}else if(e.isA("sap.ushell.appIntegration.UI5ApplicationContainer")){await l.restoreAppAfterNavigate(e,t)}}};q.prototype._handleExitApplication=async function(e,t){if(!e){return}const i=e.getCurrentAppId();if(!i){return}const n=o.isBackNavigation()&&!t;if(n){await this.destroyApplication(i,e)}else{if(e.getIsKeepAlive()){return this._storeApplication(i)}return this.destroyApplication(i,e)}};q.prototype._destroyKeepAliveApps=async function(e,t){try{const i=[];a.forEach(t=>{if(e(t)){i.push(t)}});const n=i.map(e=>this.destroyApplication(e.appId,e.container,t));await Promise.allSettled(n)}catch(e){b.error("_destroyKeepAliveApps call failed",e)}};q.prototype._addStorageEntry=function(e,t,i,n,o){const s=a.get(e);if(s){return s}const p={service:{},shellHash:`#${R.constructShellHash(n)}`,appId:e,stt:"loading",currentState:null,controlManager:null,container:t,meta:undefined,app:undefined,keepAliveMode:o,appTarget:i,ui5ComponentName:i.ui5ComponentName,useLegacyRestoreFlow:this._bUseLegacyRestoreFlowForNextApp??false,stateStored:false};a.set(e,p);return p};q.prototype.storeAppExtensions=async function(){const e=this.getCurrentApplication();if(!e){return}const t=e.appId;const i=a.get(t);if(!i){return}o.store(i.service);D.store(i);T.store(i)};q.prototype._calculateKeepAliveMode=function(e,t,i){const n=Object.values(f);if(e.startsWith("application-Shell-startIntent")||e.startsWith("application-Shell-startGUI")||e.startsWith("application-Shell-startWDA")){return f.False}let a=new URLSearchParams(window.location.search).get("sap-keep-alive");if(n.includes(a)){return a}a=i.params?.["sap-keep-alive"];if(n.includes(a)){return a}if(t.url){a=w.fromURL(t.url).get("sap-keep-alive");if(n.includes(a)){return a}}const o=R.constructShellHash(i);if(o&&v.isRootIntent(o)){return f.True}return f.False};q.prototype._calculateAppType=function(e){if(e.applicationType==="URL"&&e.additionalInformation?.startsWith?.("SAPUI5.Component=")){return"SAPUI5"}return e.applicationType};q.prototype._reloadCurrentApp=async function(e){const t=h.getById(e.sAppContainerId);if(t){await this.destroyApplication(t.getCurrentAppId(),t)}const i=await L.getServiceAsync("ShellNavigationInternal");try{i.hashChanger.treatHashChanged(e.sCurrentHash)}catch(e){b.error("Error when trying to re-load the current displayed application",e,"sap.ushell.services.AppLifeCycle")}};q.prototype._createOrReuseApplicationContainer=function(e,t,i,n){let o;const s=a.get(e);if(s&&s.container){o=s.container}if(!o){const e=h.findFreeContainerByUrl(i.url);const t=e?.getStatefulType()!==K.NotSupported;if(t){o=e}}if(!o){i.shellUIService=this._oGlobalShellUIService.getInterface();const n=i?.ui5ComponentName;const a=!!n;const s={dataHelpId:t,initialAppId:e,currentAppId:e,currentAppUrl:i.url,shellUIService:i.shellUIService,currentAppTargetResolution:i,applicationType:i.applicationType,openWithPostByAppParam:i.openWithPostByAppParam,reservedParameters:i.reservedParameters,systemAlias:i.systemAlias,targetNavigationMode:i.targetNavigationMode,url:i.url,frameworkId:i.appCapabilities?.appFrameworkId};if(a){o=new I({...s,ui5ComponentName:i.ui5ComponentName})}else{o=new C({...s})}this._oNavContainer.addPage(o)}else{o.setIsFetchedFromCache(true);o.setDataHelpId(t)}h.setContainerActive(o);o.setIsKeepAlive(n);return o};q.prototype._removeApplicationContainerFromNavContainer=function(e){this._oNavContainer.removePage(e.getId(),true)};q.prototype._setApplicationContainerActive=async function(e){h.forEach(t=>{if(t&&t!==e){try{b.info(`Deactivating container ${t.getId()}`);t.setActive(false)}catch{}}});if(e){b.info(`Activating container "${e.getId()}"`);e.setActive(true)}};q.prototype._openApp=async function(e,t,i,n,o){const s=t.getIsFetchedFromCache();if(o&&s&&u.isStatefulContainerSupportingKeepAlive(t)){return u.restoreAppWithinSameFrame(t,e,i)}if(t.getStatefulType()===K.ContractV2){if(s&&t.getCurrentAppId()===e){return}const n=await u.createApp(t,e,i);if(n?.deletedKeepAliveId){const e=a.get(n.deletedKeepAliveId);if(e){a.removeById(n.deletedKeepAliveId);D.destroy(e)}}return}if(t.getStatefulType()===K.ContractV1){if(s&&t.getCurrentAppId()===e){return}await c.createApp(t,e,i);return}const p=i?.ui5ComponentName;const r=!!p;if(r&&!o){const a=!!i?.componentHandle;if(!a){m.setApplicationInInitMode();await l.createApp(t,i,n)}const o=i.componentHandle;const s=o.getInstance();t.setUi5ComponentId(i.ui5ComponentId);t.setComponentHandle(o);this._oCurrentApplication.app=s;const p=await l.getNavigationRedirectHash(t);if(typeof p==="string"){await this.destroyApplication(e,t);return p}if(typeof s.active==="function"){s.active()}}};q.prototype._announceAppOpening=function(e){window.setTimeout(()=>{const e=document.getElementById("sapUshellLoadingAccessibilityHelper-loadingComplete");if(e){e.setAttribute("aria-live","polite");e.innerHTML=U.i18n.getText("loadingComplete");window.setTimeout(()=>{e.setAttribute("aria-live","off");e.innerHTML=""},0)}},600)};q.prototype.publishAppOpeningEvent=function(e){window.setTimeout(()=>{n.getInstance().publish("launchpad","appOpening",e)},0)};q.prototype.publishAppOpenedEvent=function(e){v.setPerformanceMark("FLP.appOpened");window.setTimeout(()=>{n.getInstance().publish("sap.ushell","appOpened",e)},0);const t=this._publicEventDataFromResolutionResult(e);F.emit("AppRendered",t,true);H.publishExternalEvent("appOpened",t)};q.prototype._publishAppClosedEvent=function(e){window.setTimeout(()=>{n.getInstance().publish("sap.ushell","appClosed",e)},0);const t=this._publicEventDataFromResolutionResult(e);H.publishExternalEvent("appClosed",t)};q.prototype._publicEventDataFromResolutionResult=function(e){const t={};if(!e){return e}["applicationType","ui5ComponentName","url","additionalInformation","text"].forEach(i=>{t[i]=e[i]});Object.freeze(t);return t};q.prototype._isFullWidth=function(e,t){let i;const n=this._calculateAppType(e);const a=S.getDefaultFullWidthSetting(n);const o=e.appCapabilities?.fullWidth;if(a){if(e.fullWidth===false||e.fullWidth==="false"||t.fullWidth===false||t.fullWidth==="false"||o===false){i=false}}else if(e.fullWidth||e.fullWidth==="true"||t.fullWidth||t.fullWidth==="true"){i=true}if(i===undefined){i=a}return i};q.prototype._getBaseAppId=function(e){const t=R.getStableIntent(e);const i=R.getBasicHash(t);const n=`application-${i}`;return n};q.prototype._getStorageAppId=function(e,t){const i=R.getStableIntent(e);if(this._oStorageAppIdMap[i]){return this._oStorageAppIdMap[i]}let n;if(!this._oStorageAppIdNextIndex[t]){this._oStorageAppIdNextIndex[t]=0;n=t}if(!n){n=`${t}-${this._oStorageAppIdNextIndex[t]}`}this._oStorageAppIdMap[i]=n;this._oStorageAppIdNextIndex[t]++;return n};q.prototype._awaitLastApplicationStart=async function(){const t=new e;const i=this._pLastApplicationStart;this._pLastApplicationStart=this._pLastApplicationStart.then(()=>t.promise);await i;return t};q.prototype._startApplication=async function(e,t,i,n){const o=this._getBaseAppId(t.sFixedShellHash);const s=this._getStorageAppId(t.sFixedShellHash,o);await this._cleanupBeforeNewApp(s,e,t,i,n);this._sendFocusBackToShell();this.publishAppOpeningEvent(t);this._announceAppOpening(t);const p=this._calculateKeepAliveMode(s,t,e);const r=p!==f.False;const l=this._createOrReuseApplicationContainer(s,o,t,r);const c=!!a.get(s);if(r){this._oCurrentApplication=this._addStorageEntry(s,l,t,e,p)}else{this._oCurrentApplication={appId:s,stt:"loading",container:l,meta:undefined,app:undefined}}this._bUseLegacyRestoreFlowForNextApp=false;v.setPerformanceMark("FLP - addAppContainer");const u=a.get(s);if(u){T.restore(u)}else{T.flush()}this._setApplicationContainerActive(l);const h=await this._openApp(s,l,t,e,c);const g=new d(s,t,l,h);if(typeof h==="string"){return g}this._initializeAppWithMetadata(l,t);l.setReadyForRendering(true);v.setPerformanceMark("FLP -- centerViewPort");this.publishAppOpenedEvent(t);return g};q.prototype.startApplication=async function(e,t,i,n){const a=await this._awaitLastApplicationStart();const o=this._oCurrentApplication;this._oNavContainer.setBusy(true);try{const o=await this._startApplication(e,t,i,n);a.resolve();return o}catch(e){const t=!!this._oCurrentApplication?.appId;const i=t&&this._oCurrentApplication.appId!==o?.appId;if(i){const e=this._oCurrentApplication.container;if(e){await this.destroyApplication(e.getCurrentAppId(),e,true)}const t=o?.container?.isDestroyed()??true;if(t){this._oCurrentApplication={}}else{this._oCurrentApplication=o}}this._oNavContainer.setBusy(false);a.resolve();throw e}};q.prototype.switchViewState=function(e,t,i,n){const o=a.get(this._oCurrentApplication.appId);if(!o){E.destroyManagedControls()}const s=E.getShellMode();const p={TR:{headerless:$.Minimal}};let r;if(!n){r=p[i]?.[s]}E.switchState(e,r);const l=a.get(t);if(l){D.restore(l)}else{D.flush()}E.applyStalledChanges()};q.prototype._isFloatingContainerDocked=function(){const e=M.getModel().getProperty("/floatingContainer/state").includes("docked");const t=M.getModel().getProperty("/floatingContainer/visible");return e&&t};q.prototype._sendFocusBackToShell=function(){if(!t.system.desktop){return}sap.ui.require(["sap/ushell/renderer/AccessKeysHandler"],e=>{const t=E.getLaunchpadState();const n=E.getShellMode()===$.Default;const a=i.getElementById("shellAppTitle");if(a&&t===O.App&&n){const t=a.getFocusDomRef();if(t){e.sendFocusBackToShell(t.getAttribute("id"))}}})};q.prototype._initializeAppWithMetadata=function(e,t){const i=m.getMetadata(t,t?.sFixedShellHash);this._oCurrentApplication.meta=i;if(!e.getIsFetchedFromCache()){e.toggleStyleClass("sapUshellDefaultBackground",!i.hideLightBackground);const n=this._isFullWidth(t,i);if(!n){e.addStyleClass("sapUShellApplicationContainerLimitedWidth")}if(this._isFloatingContainerDocked()&&window.matchMedia("(min-width: 106.4rem)").matches){e.addStyleClass("sapUShellDockingContainer");e.removeStyleClass("sapUShellApplicationContainerLimitedWidth")}else if(this._isFloatingContainerDocked()){e.removeStyleClass("sapUShellApplicationContainerLimitedWidth")}}let n="sap-icon://folder";if(i&&i.icon){n=i.icon}E.updateCurrentState("application.icon",V.Set,n)};q.prototype._cleanupBeforeNewApp=async function(e,t,i,n,o){const s=this.getCurrentApplication()?.container;const p=s&&s.getStatefulType()!==K.NotSupported;if(p){await this._handleExitApplication(s,false)}const r=a.get(e);const l=!!r;const c=r?.container;const u=!!i?.ui5ComponentName;if(l){const i=`#${R.constructShellHash(t)}`;const a=R.compareHashes(i,r.shellHash);const s=a.sameIntent&&a.sameParameters;const p=!!n;if(!s){b.warning(`The keepAlive app '${e}' has to be destroyed because of id clashes.`);await this.destroyApplication(e,c)}else if(o&&p){b.warning(`The keepAlive app '${e}' has to be destroyed because of a bookmark start.`);await this.destroyApplication(e,c)}}if(u&&!l){const t=R.getBasicHash(i.sFixedShellHash);const n=`application-${t}-component`;if(s&&s.isA("sap.ushell.appIntegration.UI5ApplicationContainer")){if(s.getUi5ComponentName()===i.ui5ComponentName){b.warning(`The app '${s.getCurrentAppId()}' has to be destroyed because of component name clashes.`);await this.destroyApplication(s.getCurrentAppId(),s,true)}else if(s.getUi5ComponentId()===n){b.warning(`The app '${s.getCurrentAppId()}' has to be destroyed because of component id clashes.`);await this.destroyApplication(s.getCurrentAppId(),s,true)}}await this._destroyKeepAliveApps(t=>{if(t.appId===e){return false}if(t.ui5ComponentName===i.ui5ComponentName){b.warning(`The app '${t.appId}' has to be destroyed because of component name clashes.`);return true}if(t.appTarget?.ui5ComponentId===n){b.warning(`The app '${t.appId}' has to be destroyed because of component id clashes.`);return true}return false},true)}await h.forEach(async t=>{if(t.getStatefulType()!==K.ContractV2){return}try{t.isValid();return}catch(i){b.warning(`Destroying stateful container iframe due to unresponsiveness (${t.getId()})`,`reason: ${i.message}`,"sap.ushell.appIntegration.AppLifeCycle");return this.destroyApplication(e,t,true)}})};q.prototype.setNavContainer=function(e){this._oNavContainer=e};q.prototype._setContainerReadyForReuse=function(e){if(!e){return}h.setContainerReadyForReuse(e,e.getCurrentAppUrl());e.setIsKeepAlive(false);e.setCurrentAppUrl("");e.setIsFetchedFromCache(false)};q.prototype.reset=function(){this._aDoables.forEach(e=>{e.off()});this._aDoables=[];a.reset();h.destroyAllContainers();A.reset();this._oStorageAppIdMap={};this._oStorageAppIdNextIndex={};this._bDisableHomeAppCache=false;this._bUseLegacyRestoreFlowForNextApp=false;this._oCurrentApplication={};this._oNavContainer=null;this._oInitDeferred=new e;this._pLastApplicationStart=this._oInitDeferred.promise;this._oStorageAppIdMap={};this._oStorageAppIdNextIndex={}};return new q});
//# sourceMappingURL=AppLifeCycle.js.map