// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/UIComponent","sap/ui/thirdparty/hasher","sap/ushell/appIntegration/PostMessageManager","sap/ushell/Container","sap/ushell/services/Navigation/compatibility","sap/ushell/utils"],(e,t,s,a,n,i)=>{"use strict";const p=new e;const c={};const r={"sap.ushell.services.AppState.getAppState":{async handler(e,t){const{sKey:s}=e;const n=await a.getServiceAsync("AppState");const p=n.getAppState(s);const c=await i.promisify(p);delete c._oServiceInstance;return c}},"sap.ushell.services.AppState._saveAppState":{async handler(e,t){const{sKey:s,sData:n,sAppName:p,sComponent:c,bTransient:r,iPersistencyMethod:o,oPersistencySettings:l}=e;const S=await a.getServiceAsync("AppState");const y=S._saveAppState(s,n,p,c,r,o,l);await i.promisify(y)}},"sap.ushell.services.AppState.deleteAppState":{async handler(e,t){const{sKey:s}=e;const n=await a.getServiceAsync("AppState");const p=n.deleteAppState(s);await i.promisify(p)}},"sap.ushell.services.AppState.makeStatePersistent":{async handler(e,t){const{sKey:s,iPersistencyMethod:n,oPersistencySettings:p}=e;const c=await a.getServiceAsync("AppState");const r=c.makeStatePersistent(s,n,p);return i.promisify(r)}},"sap.ushell.services.Navigation.getAppState":{async handler(e,t){const{sAppStateKey:s}=e;const n=await a.getServiceAsync("Navigation");const i=await n.getAppState(p,s);delete i._oServiceInstance;return i}},"sap.ushell.services.CrossApplicationNavigation.getAppState":{async handler(e,t){const{sAppStateKey:s}=e;const n=await a.getServiceAsync("Navigation");const i=await n.getAppState(p,s);delete i._oServiceInstance;return i}},"sap.ushell.services.CrossApplicationNavigation.getAppStateData":{async handler(e,t){const{sAppStateKey:s}=e;return n.getAppStateData(s)}},"sap.ushell.services.CrossApplicationNavigation.setInnerAppStateData":{handler:async e=>{const{sData:s}=e;let n;if(s!==undefined){try{n=JSON.parse(s)}catch{n=s}}else{n={}}const p=await a.getServiceAsync("AppState");const c=p.createEmptyAppState();c.setData(n);await i.promisify(c.save());const r=c.getKey();let o=t.getHash();if(o.indexOf("&/")>0){if(o.indexOf("sap-iapp-state=")>0){const e=/(?:sap-iapp-state=)([^&/]+)/.exec(o)[1];o=o.replace(e,r)}else{o=`${o}/sap-iapp-state=${r}`}}else{o=`${o}&/sap-iapp-state=${r}`}t.disableBlueBoxHashChangeTrigger=true;t.replaceHash(o);t.disableBlueBoxHashChangeTrigger=false;return r}}};return{register(){Object.keys(c).forEach(e=>{const t=c[e];s.setDistributionPolicy(e,t)});Object.keys(r).forEach(e=>{const t=r[e];s.setRequestHandler(e,t.handler,t.options)})}}});
//# sourceMappingURL=AppStateHandler.js.map