// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/m/library","sap/ushell/appIntegration/PostMessageManager","sap/ushell/Container","sap/ushell/library","sap/ushell/resources","sap/ushell/state/ShellModel","sap/ushell/utils"],(e,t,o,a,s,r,n,c)=>{"use strict";const i=t.URLHelper;const l=s.ContentNodeType;function k(t,o){if(!t||!t.serviceUrl||!o){return}if(o.id===""||o.id==="saas_approuter"){t.serviceUrl=undefined;e.warning("Dynamic data bookmarks tiles are not supported for local content providers")}}async function d(t="",o="",s="",r="",n="",l,k){let d=c.getDocumentUrl();function p(e,t,a,r,n,c){o=o.includes(e)?o.replace(e,t):o;s=s.includes(e)?s.replace(e,t):s;if(a&&n){o=o.includes(a)?o.replaceAll(a,n):o;s=s.includes(a)?s.replaceAll(a,n):s}if(r&&c){o=o.includes(r)?o.replaceAll(r,c):o;s=s.includes(r)?s.replaceAll(r,c):s}}if(k){const c=await a.getServiceAsync("AppState");c.setAppStateToPublic(l).then((e,a,c,k="",u="")=>{if(k){d=d.replace(a,k)}if(u){d=d.replace(c,u)}p(l,d,a,c,k,u);i.triggerEmail(t,o,s,r,n)}).catch(t=>{e.error("Failed to set app state to public:",t)})}else{p(l,d);i.triggerEmail(t,o,s,r,n)}}const p={};const u={"sap.ushell.services.Bookmark.addBookmarkUI5":{async handler(e,t){const{oParameters:o,vContainer:s}=e;const r=await a.getServiceAsync("AppLifeCycle");const n=await r.getCurrentApplication().getSystemContext();k(o,n);const c=await a.getServiceAsync("BookmarkV2");await c.addBookmark(o,s,n.id)}},"sap.ushell.services.Bookmark.addBookmark":{async handler(e,t){if(true){const{oParameters:t,groupId:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();const n=await a.getServiceAsync("BookmarkV2");await n.addBookmarkByGroupId(t,o,r.id);return}throw new Error("Bookmark.addBookmarkByGroupId is deprecated. Please use BookmarkV2.addBookmark instead.")}},"sap.ushell.services.Bookmark.getShellGroupIDs":{async handler(e,t){if(true){const e=await a.getServiceAsync("BookmarkV2");return e.getShellGroupIDs()}throw new Error("Bookmark.getShellGroupIDs is deprecated. Please use BookmarkV2.getContentNodes instead.")}},"sap.ushell.services.Bookmark.addCatalogTileToGroup":{async handler(t,o){e.error("Bookmark.addCatalogTileToGroup is deprecated. Please use BookmarkV2.addBookmark instead.");if(true){const{sCatalogTileId:e,sGroupId:o,oCatalogData:s}=t;const r=await a.getServiceAsync("Bookmark");const n=r.addCatalogTileToGroup(e,o,s);await c.promisify(n);return}throw new Error("Bookmark.addCatalogTileToGroup is deprecated. Please use BookmarkV2.addBookmark instead.")}},"sap.ushell.services.Bookmark.countBookmarks":{async handler(e,t){const{sUrl:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();const n=await a.getServiceAsync("BookmarkV2");return n.countBookmarks(o,r.id)}},"sap.ushell.services.Bookmark.deleteBookmarks":{async handler(e,t){const{sUrl:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();const n=await a.getServiceAsync("BookmarkV2");return n.deleteBookmarks(o,r.id)}},"sap.ushell.services.Bookmark.updateBookmarks":{async handler(e,t){const{sUrl:o,oParameters:s}=e;const r=await a.getServiceAsync("AppLifeCycle");const n=await r.getCurrentApplication().getSystemContext();const c=await a.getServiceAsync("BookmarkV2");return c.updateBookmarks(o,s,n.id)}},"sap.ushell.services.Bookmark.getContentNodes":{async handler(e,t){const o=await a.getServiceAsync("BookmarkV2");return o.getContentNodes()}},"sap.ushell.services.Bookmark.addCustomBookmark":{async handler(e,t){const{sVizType:o,oConfig:s,vContentNodes:r}=e;const n=await a.getServiceAsync("AppLifeCycle");const c=await n.getCurrentApplication().getSystemContext();const i=await a.getServiceAsync("BookmarkV2");await i.addCustomBookmark(o,s,r,c.id)}},"sap.ushell.services.Bookmark.countCustomBookmarks":{async handler(e,t){const{oIdentifier:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();o.contentProviderId=r.id;const n=await a.getServiceAsync("BookmarkV2");return n.countCustomBookmarks(o)}},"sap.ushell.services.Bookmark.updateCustomBookmarks":{async handler(e,t){const{oIdentifier:o,oConfig:s}=e;const r=await a.getServiceAsync("AppLifeCycle");const n=await r.getCurrentApplication().getSystemContext();o.contentProviderId=n.id;const c=await a.getServiceAsync("BookmarkV2");return c.updateCustomBookmarks(o,s)}},"sap.ushell.services.Bookmark.deleteCustomBookmarks":{async handler(e,t){const{oIdentifier:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();o.contentProviderId=r.id;const n=await a.getServiceAsync("BookmarkV2");return n.deleteCustomBookmarks(o)}},"sap.ushell.services.Bookmark.addBookmarkToPage":{async handler(e,t){const{oParameters:o,sPageId:s}=e;const r=await a.getServiceAsync("AppLifeCycle");const n=await r.getCurrentApplication().getSystemContext();const c=await a.getServiceAsync("BookmarkV2");await c.addBookmarkToPage(o,s,n.id)}},"sap.ushell.services.BookmarkV2.addBookmarkUI5":{async handler(e,t){const{oParameters:o,vContainer:s}=e;const r=await a.getServiceAsync("AppLifeCycle");const n=await r.getCurrentApplication().getSystemContext();k(o,n);const c=await a.getServiceAsync("BookmarkV2");return c.addBookmark(o,s,n.id)}},"sap.ushell.services.BookmarkV2.addBookmark":{async handler(e,t){if(true){const{oParameters:t,groupId:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();const n=await a.getServiceAsync("BookmarkV2");await n.addBookmarkByGroupId(t,o,r.id);return}throw new Error("BookmarkV2.addBookmarkByGroupId is deprecated. Please use BookmarkV2.addBookmark instead.")}},"sap.ushell.services.BookmarkV2.getShellGroupIDs":{async handler(e,t){if(true){const e=await a.getServiceAsync("BookmarkV2");return e.getShellGroupIDs()}throw new Error("BookmarkV2.getShellGroupIDs is deprecated. Please use BookmarkV2.getContentNodes instead.")}},"sap.ushell.services.BookmarkV2.countBookmarks":{async handler(e,t){const{sUrl:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();const n=await a.getServiceAsync("BookmarkV2");return n.countBookmarks(o,r.id)}},"sap.ushell.services.BookmarkV2.deleteBookmarks":{async handler(e,t){const{sUrl:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();const n=await a.getServiceAsync("BookmarkV2");return n.deleteBookmarks(o,r.id)}},"sap.ushell.services.BookmarkV2.updateBookmarks":{async handler(e,t){const{sUrl:o,oParameters:s}=e;const r=await a.getServiceAsync("AppLifeCycle");const n=await r.getCurrentApplication().getSystemContext();const c=await a.getServiceAsync("BookmarkV2");return c.updateBookmarks(o,s,n.id)}},"sap.ushell.services.BookmarkV2.getContentNodes":{async handler(e,t){const o=await a.getServiceAsync("BookmarkV2");return o.getContentNodes()}},"sap.ushell.services.BookmarkV2.addCustomBookmark":{async handler(e,t){const{sVizType:o,oConfig:s,vContentNodes:r}=e;const n=await a.getServiceAsync("AppLifeCycle");const c=await n.getCurrentApplication().getSystemContext();const i=await a.getServiceAsync("BookmarkV2");await i.addCustomBookmark(o,s,r,c.id)}},"sap.ushell.services.BookmarkV2.countCustomBookmarks":{async handler(e,t){const{oIdentifier:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();o.contentProviderId=r.id;const n=await a.getServiceAsync("BookmarkV2");return n.countCustomBookmarks(o)}},"sap.ushell.services.BookmarkV2.updateCustomBookmarks":{async handler(e,t){const{oIdentifier:o,oConfig:s}=e;const r=await a.getServiceAsync("AppLifeCycle");const n=await r.getCurrentApplication().getSystemContext();o.contentProviderId=n.id;const c=await a.getServiceAsync("BookmarkV2");return c.updateCustomBookmarks(o,s)}},"sap.ushell.services.BookmarkV2.deleteCustomBookmarks":{async handler(e,t){const{oIdentifier:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();o.contentProviderId=r.id;const n=await a.getServiceAsync("BookmarkV2");return n.deleteCustomBookmarks(o)}},"sap.ushell.services.BookmarkV2.addBookmarkToPage":{async handler(e,t){const{oParameters:o,sPageId:s}=e;const r=await a.getServiceAsync("AppLifeCycle");const n=await r.getCurrentApplication().getSystemContext();const c=await a.getServiceAsync("BookmarkV2");await c.addBookmarkToPage(o,s,n.id)}},"sap.ushell.services.LaunchPage.getGroupsForBookmarks":{async handler(e,t){if(true){const e=await a.getServiceAsync("FlpLaunchPage");const t=e.getGroupsForBookmarks();return c.promisify(t)}throw new Error("LaunchPage.getGroupsForBookmarks is deprecated. Please use BookmarkV2.getContentNodes instead.")}},"sap.ushell.services.Menu.getSpacesPagesHierarchy":{async handler(e,t){const o=await a.getServiceAsync("Menu");const s=await o.getContentNodes([l.Space,l.Page]);return s.map(({id:e,label:t,children:o})=>({id:e,title:t,pages:(o||[]).map(({id:e,label:t})=>({id:e,title:t}))}))}},"sap.ushell.services.CommonDataModel.getAllPages":{async handler(e,t){const o=await a.getServiceAsync("CommonDataModel");return o.getAllPages()}},"sap.ushell.services.ShellUIService.getShellGroupIDs":{async handler(e,t){if(true){const{bGetAll:t}=e;const o=await a.getServiceAsync("BookmarkV2");return o.getShellGroupIDs(t)}throw new Error("Bookmark.getShellGroupIDs is deprecated. Use BookmarkV2.getContentNodes instead.")}},"sap.ushell.services.ShellUIService.addBookmark":{async handler(e,t){if(true){const{oParameters:t,groupId:o}=e;const s=await a.getServiceAsync("AppLifeCycle");const r=await s.getCurrentApplication().getSystemContext();const n=await a.getServiceAsync("BookmarkV2");return n.addBookmarkByGroupId(t,o,r.id)}throw new Error("Bookmark.addBookmarkByGroupId is deprecated. Use BookmarkV2.addBookmark instead.")}},"sap.ushell.services.ShellUIService.addBookmarkDialog":{async handler(e,t){const[o]=await c.requireAsync(["sap/ushell/ui/footerbar/AddBookmarkButton"]);const a=new o;a.firePress({})}},"sap.ushell.services.ShellUIService.getShellGroupTiles":{async handler(e,t){if(true){const{groupId:t}=e;const o=await a.getServiceAsync("FlpLaunchPage");const s=o.getTilesByGroupId(t);return c.promisify(s)}throw new Error("Classic homepage is deprecated.")}},"sap.ushell.services.ShellUIService.sendUrlAsEmail":{async handler(e,t){const o=n.getModel().getProperty("/application/title");let a;if(o===undefined){a=r.i18n.getText("linkToApplication")}else{a=`${r.i18n.getText("linkTo")} '${o}'`}d("",a,document.URL,"","",document.URL,true)}},"sap.ushell.services.ShellUIService.sendEmailWithFLPButton":{async handler(e,t){const{bSetAppStateToPublic:o}=e;const a=n.getModel().getProperty("/application/title");let s;if(a===undefined){s=r.i18n.getText("linkToApplication")}else{s=`${r.i18n.getText("linkTo")} '${a}'`}d("",s,document.URL,"","",document.URL,o)}},"sap.ushell.services.ShellUIService.sendEmail":{async handler(e,t){const{sTo:o,sSubject:a,sBody:s,sCc:r,sBcc:n,sIFrameURL:c,bSetAppStateToPublic:i}=e;d(o,a,s,r,n,c,i)}}};return{register(){Object.keys(p).forEach(e=>{const t=p[e];o.setDistributionPolicy(e,t)});Object.keys(u).forEach(e=>{const t=u[e];o.setRequestHandler(e,t.handler,t.options)})},stripBookmarkServiceUrlForLocalContentProvider:k,sendEmail:d}});
//# sourceMappingURL=BookmarkHandler.js.map