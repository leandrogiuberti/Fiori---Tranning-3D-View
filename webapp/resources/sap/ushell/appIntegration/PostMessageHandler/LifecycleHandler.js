// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/hasher","sap/ushell/appIntegration/PostMessageManager","sap/ushell/EventHub","sap/ushell/library","sap/ushell/utils"],(e,s,t,a,p)=>{"use strict";const i=a.appIntegration.contracts.StatefulType;const r={"sap.ushell.services.appLifeCycle.create":{preventBroadcast:true},"sap.ushell.services.appLifeCycle.destroy":{preventBroadcast:true},"sap.ushell.services.appLifeCycle.store":{preventBroadcast:true},"sap.ushell.services.appLifeCycle.restore":{preventBroadcast:true},"sap.ushell.appRuntime.keepAliveAppHide":{preventBroadcast:true,ignoreCapabilities:true},"sap.ushell.appRuntime.keepAliveAppShow":{preventBroadcast:true,ignoreCapabilities:true},"sap.ushell.sessionHandler.beforeApplicationHide":{preventBroadcast:true,ignoreCapabilities:true},"sap.ushell.sessionHandler.afterApplicationShow":{preventBroadcast:true,ignoreCapabilities:true}};const l={"sap.gui.loadFinished":{async handler(e,s,t){s.setStatefulType(i.ContractV1);s.addCapabilities(["sap.its.startService","sap.gui.triggerCloseSession"])},options:{provideApplicationContext:true,allowInactive:true}},"sap.ushell.services.AppLifeCycle.setup":{async handler(e,s,t){const a=e;const r=[];if(a){if(a.isStateful){s.setStatefulType(i.ContractV2);r.push("sap.ushell.services.appLifeCycle.create");r.push("sap.ushell.services.appLifeCycle.destroy");const e=!p.isSAPLegacyApplicationType(s.getApplicationType(),s.getFrameworkId());if(e){r.push("sap.ushell.services.appLifeCycle.store");r.push("sap.ushell.services.appLifeCycle.restore")}}if(a.isIframeValid){s.setIframeIsValidSupport(true)}if(a.session?.bLogoutSupport){r.push("sap.ushell.sessionHandler.logout")}s.addCapabilities(r)}},options:{provideApplicationContext:true,allowInactive:true}},"sap.ushell.services.CrossApplicationNavigation.registerBeforeAppCloseEvent":{async handler(e,s,t){const a=e;s.addCapabilities(["sap.ushell.services.CrossApplicationNavigation.beforeAppCloseEvent"]);s.setBeforeAppCloseEvent({enabled:true,params:a})},options:{provideApplicationContext:true,allowInactive:true}},"sap.ushell.services.AppLifeCycle.reloadCurrentApp":{async handler(s,a){t.emit("reloadCurrentApp",{sCurrentHash:e.getHash(),date:Date.now()})}},"sap.ushell.services.AppLifeCycle.destroy":{async handler(e,s,t){const[a]=await p.requireAsync(["sap/ushell/appIntegration/AppLifeCycle"]);const i=s.getCurrentAppId();await a.destroyApplication(i,s)},options:{provideApplicationContext:true,allowInactive:true}}};return{register(){Object.keys(r).forEach(e=>{const t=r[e];s.setDistributionPolicy(e,t)});Object.keys(l).forEach(e=>{const t=l[e];s.setRequestHandler(e,t.handler,t.options)})}}});
//# sourceMappingURL=LifecycleHandler.js.map