// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/ui/core/Element","sap/ushell/appIntegration/PostMessageManager","sap/ushell/Container","sap/ushell/appIntegration/PostMessageHandler/ExtensionItems","sap/ushell/utils"],(e,t,s,n,i,r)=>{"use strict";let o;function a(e){o.removeItem(e);const s=t.getElementById(e);if(s?.destroy){s.destroy()}}const c={};const l={"sap.ushell.services.Renderer.addHeaderItem":{async handler(e,t,i){const{sId:r,sTooltip:a,sIcon:c,iFloatingNumber:l,bVisible:d}=e;const p=await n.getServiceAsync("FrameBoundExtension");const u=await p.createHeaderItem({id:r,tooltip:a,icon:c,floatingNumber:l,press:function(){s.sendRequest("sap.ushell.appRuntime.buttonClick",{buttonId:r},t.getPostMessageTarget(),t.getPostMessageTargetOrigin(),false)}},{position:"begin"});o.storeItem(r,u);o.applyItemVisibility(u,d)},options:{provideApplicationContext:true}},"sap.ushell.services.Renderer.showHeaderItem":{async handler(e,t){const{aIds:s}=e;const n=Array.isArray(s)?s:[s];o.visitItems(n,e=>{o.applyItemVisibility(e,true)})}},"sap.ushell.services.Renderer.hideHeaderItem":{async handler(e,t){const{aIds:s}=e;const n=Array.isArray(s)?s:[s];o.visitItems(n,e=>{o.applyItemVisibility(e,false)})}},"sap.ushell.services.Renderer.updateHeaderItem":{async handler(e,t){const{sId:s,oControlProperties:n}=e;if(!Object.hasOwn(n,"floatingNumber")){return}const i=o.getItem(s);if(i?.getControl){const e=await i.getControl();e?.setFloatingNumber?.(n.floatingNumber)}}},"sap.ushell.services.Renderer.addHeaderEndItem":{async handler(e,t,i){const{sId:r,sTooltip:a,sIcon:c,iFloatingNumber:l,bVisible:d}=e;const p=await n.getServiceAsync("FrameBoundExtension");const u=await p.createHeaderItem({id:r,tooltip:a,icon:c,floatingNumber:l,press:function(){s.sendRequest("sap.ushell.appRuntime.buttonClick",{buttonId:r},t.getPostMessageTarget(),t.getPostMessageTargetOrigin(),false)}},{position:"end"});o.storeItem(r,u);o.applyItemVisibility(u,d)},options:{provideApplicationContext:true}},"sap.ushell.services.Renderer.showHeaderEndItem":{async handler(e,t){const{aIds:s}=e;const n=Array.isArray(s)?s:[s];o.visitItems(n,e=>{o.applyItemVisibility(e,true)})}},"sap.ushell.services.Renderer.hideHeaderEndItem":{async handler(e,t){const{aIds:s}=e;const n=Array.isArray(s)?s:[s];o.visitItems(n,e=>{o.applyItemVisibility(e,false)})}},"sap.ushell.services.Renderer.addUserAction":{async handler(e,t,i){const{controlType:r,oControlProperties:a,bIsVisible:c}=e.oParameters;const l=await n.getServiceAsync("FrameBoundExtension");a.press=async function(){s.sendRequest("sap.ushell.appRuntime.buttonClick",{buttonId:a.id},t.getPostMessageTarget(),t.getPostMessageTargetOrigin(),false)};const d=await l.createUserAction(a,{controlType:r});o.storeItem(a.id,d);o.applyItemVisibility(d,c)},options:{provideApplicationContext:true}},"sap.ushell.services.Renderer.showActionButton":{async handler(e,t){const{aIds:s}=e;const n=Array.isArray(s)?s:[s];o.visitItems(n,e=>{o.applyItemVisibility(e,true)})}},"sap.ushell.services.Renderer.hideActionButton":{async handler(e,t){const{aIds:s}=e;const n=Array.isArray(s)?s:[s];o.visitItems(n,e=>{o.applyItemVisibility(e,false)})}},"sap.ushell.services.Renderer.addOptionsActionSheetButton":{async handler(e,t,i){const c=e;const[l]=await r.requireAsync(["sap/m/Button"]);const d=await n.getServiceAsync("FrameBoundExtension");const p=Array.isArray(c)?c:[c];p.forEach(async e=>{a(e.id);new l({id:e.id,text:e.text,icon:e.icon,tooltip:e.tooltip,press:async function(){s.sendRequest("sap.ushell.appRuntime.buttonClick",{buttonId:e.id},t.getPostMessageTarget(),t.getPostMessageTargetOrigin(),false)}});const n=await d.createUserAction({id:e.id});o.storeItem(e.id,n);o.applyItemVisibility(n,true)})},options:{provideApplicationContext:true}},"sap.ushell.services.Renderer.removeOptionsActionSheetButton":{async handler(t,s){const n=t;const i=Array.isArray(n)?n:[n];i.forEach(t=>{const s=o.getItem(t.id);if(!s){e.warning(`User action with id ${t.id} not found`);return}o.applyItemVisibility(s,false);return a(t.id)})}},"sap.ushell.services.Renderer.destroyButton":{async handler(e,t){const{aIds:s}=e;const n=Array.isArray(s)?s:[s];n.forEach(e=>{a(e)})}},"sap.ushell.services.Renderer.createShellHeadItem":{async handler(e,t,n){const{params:i}=e;i.press=async function(){s.sendRequest("sap.ushell.appRuntime.buttonClick",{buttonId:i.id},t.getPostMessageTarget(),t.getPostMessageTargetOrigin(),false)};const[o]=await r.requireAsync(["sap/ushell/ui/shell/ShellHeadItem"]);new o(i)},options:{provideApplicationContext:true}},"sap.ushell.services.Renderer.setHeaderVisibility":{async handler(e,t){const{bVisible:s,bCurrentState:i,aStates:r}=e;const o=n.getRendererInternal("fiori2");o.setHeaderVisibility(s,!!i,r)}},"sap.ushell.services.Extension.createHeaderItem":{async handler(e,t,i){const{controlProperties:r,events:a,parameters:c}=e;const l=o.generateItemId();a.forEach(e=>{r[e]=async function(){s.sendRequest("sap.ushell.services.Extension.handleControlEvent",{eventName:e,itemId:l},t.getPostMessageTarget(),t.getPostMessageTargetOrigin(),false)}});const d=await n.getServiceAsync("Extension");const p=await d.createHeaderItem(r,c);o.storeItem(l,p);return{itemId:l}},options:{provideApplicationContext:true}},"sap.ushell.services.Extension.createUserAction":{async handler(e,t,i){const{controlProperties:r,events:a,parameters:c}=e;const l=o.generateItemId();a.forEach(e=>{r[e]=async function(){s.sendRequest("sap.ushell.services.Extension.handleControlEvent",{eventName:e,itemId:l},t.getPostMessageTarget(),t.getPostMessageTargetOrigin(),false)}});const d=await n.getServiceAsync("Extension");const p=await d.createUserAction(r,c);o.storeItem(l,p);return{itemId:l}},options:{provideApplicationContext:true}},"sap.ushell.services.Extension.Item.destroy":{async handler(t,s){const{itemId:n}=t;const i=o.getItem(n);if(!i){e.error(`Extension item with id ${n} not found - cannot destroy it.`);return}o.removeItem(n);i.destroy()}},"sap.ushell.services.Extension.Item.showForCurrentApp":{async handler(t,s){const{itemId:n}=t;const i=o.getItem(n);if(!i){e.error(`Extension item with id ${n} not found - cannot update its visibility.`);return}i.showForCurrentApp()}},"sap.ushell.services.Extension.Item.hideForCurrentApp":{async handler(t,s){const{itemId:n}=t;const i=o.getItem(n);if(!i){e.error(`Extension item with id ${n} not found - cannot update its visibility.`);return}i.hideForCurrentApp()}},"sap.ushell.services.Extension.Item.showForAllApps":{async handler(t,s){const{itemId:n}=t;const i=o.getItem(n);if(!i){e.error(`Extension item with id ${n} not found - cannot update its visibility.`);return}i.showForAllApps()}},"sap.ushell.services.Extension.Item.hideForAllApps":{async handler(t,s){const{itemId:n}=t;const i=o.getItem(n);if(!i){e.error(`Extension item with id ${n} not found - cannot update its visibility.`);return}i.hideForAllApps()}},"sap.ushell.services.Extension.Item.showOnHome":{async handler(t,s){const{itemId:n}=t;const i=o.getItem(n);if(!i){e.error(`Extension item with id ${n} not found - cannot update its visibility.`);return}i.showOnHome()}},"sap.ushell.services.Extension.Item.hideOnHome":{async handler(t,s){const{itemId:n}=t;const i=o.getItem(n);if(!i){e.error(`Extension item with id ${n} not found - cannot update its visibility.`);return}i.hideOnHome()}}};return{register(){o=new i;Object.keys(c).forEach(e=>{const t=c[e];s.setDistributionPolicy(e,t)});Object.keys(l).forEach(e=>{const t=l[e];s.setRequestHandler(e,t.handler,t.options)})},getExtensionItems(){return o}}});
//# sourceMappingURL=ExtensionHandler.js.map