// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/thirdparty/URI","sap/ui/model/resource/ResourceModel","sap/m/Dialog","sap/m/DialogType","sap/m/Button","sap/m/ButtonType","sap/m/Text","sap/ushell/Container","sap/ui/core/library"],(jQuery,e,t,r,s,i,a,n,o,p)=>{"use strict";const c=p.ValueState;const l=(new e).search(true);const u="/sap/fiori";const f="sap-ui-app-id";const g="/sap/bc";const d=/sv\/.+\/manifest/;let m;function h(e){return`${g}/ui2/app_index/ui5_app_info_json?id=${e}`}function y(t){const r={};const s=t||document.URL;const i=new e(s);const a=i.query(true)["sap-startup-params"];const n=new e(`?${a}`).query(true);let o;Object.keys(n).forEach(e=>{r[e.toLowerCase()]=n[e]});if(r["sap-app-uri"]&&r["sap-app-name"]){const e=r["sap-app-uri"].replace(/\/$/,"");const t=r["sap-app-name"];m=`${u}/${t}/`;o=`${u}/${t}${e}`}if(o){o=o.replace(".webapp","/webapp")}return o}function E(e,t,r){if(m){const s=sap.ushell.cloudServices.interceptor.FilterManager.getInstance();const i=e.getFilter("sap.ushell.cloudServices.interceptor.filter.DoorWayMappingFilter");if(!s.isRegistered("sap.ushell.cloudServices.interceptor.filter.DoorWayMappingFilter")){s.register("sap.ushell.cloudServices.interceptor.filter.DoorWayMappingFilter")}i.addAppToStack(r,m);t.addAppToStack(r,m)}}function w(e,p){const g=new jQuery.Deferred;e=e||l[f];jQuery.ajax(h(e)).then(async l=>{if(l&&!(Object.keys(l).length===0)){l=e in l?l[e]:l;const f=l?.asyncHints?.libs||[];f.forEach(e=>{if(e?.url?.final){e.url.url=u+e.url.url}});const h=l?.asyncHints?.components||[];h.forEach(e=>{if(e?.url?.final){e.url.url=u+e.url.url}});if("url"in l){l.url=u+l.url;m=l.url}else{l.url=y(p)}if(!l.url){if(!this.oErrorMessageDialog){const e=new t({async:true,bundleUrl:"/sap/fiori/appruntime/i18n/i18nApp.properties"});const p=await e.getResourceBundle();this.oErrorMessageDialog=new r({type:s.Message,title:p.getText("ERROR_DIALOG_TITLE"),state:c.Error,content:new n({text:p.getText("MISSING_PARAMETERS_ERROR")}),contentWidth:"30%",beginButton:new i({type:a.Emphasized,text:p.getText("OK_BUTTON"),press:async()=>{this.oErrorMessageDialog.close();const e=await o.getServiceAsync("Navigation");e.toExternal({target:{semanticObject:"Shell",action:"home"}})}})})}this.oErrorMessageDialog.open();return g.reject(new Error("sap-app-uri & sap-app-name parameters were not provided"))}let w;const S=sap.ushell.cloudServices.interceptor.FilterFactory.getInstance();const T=S.getFilter("sap.ushell.cloudServices.interceptor.filter.CacheBusterFilter");if("manifestUrl"in l){if(d.test(l.manifestUrl)){const e=d.exec(l.manifestUrl);const t=e[0].split("/");w=t[1]}}if(w){T.setTimestamp(w)}else{T.setTimestamp()}E(S,T,e);return g.resolve(l)}return g.reject(new Error("AppInfo from AppIndex is empty"))}).fail(g.reject);return g.promise()}sap.ui.define("appInfoService",[],()=>({getAppInfo:w}))});
//# sourceMappingURL=AppInfoService.js.map