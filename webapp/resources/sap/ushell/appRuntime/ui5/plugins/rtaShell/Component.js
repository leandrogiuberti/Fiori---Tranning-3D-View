// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Component","sap/ui/thirdparty/jquery","sap/ushell/api/RTA","sap/ushell/appRuntime/ui5/plugins/baseRta/AppLifeCycleUtils","sap/ushell/appRuntime/ui5/plugins/baseRta/Renderer"],(e,jQuery,t,i,s)=>{"use strict";let n;function a(){return{sComponentName:"sap.ushell.appRuntime.ui5.plugins.rtaShell",layer:"CUSTOMER",id:"RTA_AppRuntime_Plugin_ActionButton",text:"RTA_BUTTON_TEXT",icon:"sap-icon://wrench",visible:false}}function o(e){t.setShellHeaderVisibility(e,false)}function u(){return new Promise((e,t)=>{o(false);n.postMessageToApp("user.postapi.rtaPlugin","startUIAdaptation").done(t=>{if(t==="stopped"){o(true)}e(t)}).fail(()=>{o(true);t()})})}return e.extend("sap.ushell.appRuntime.ui5.plugins.rtaShell.Component",{metadata:{manifest:"json",library:"sap.ushell"},init:function(){this.mConfig=a();n=this.getComponentData().oPostMessageInterface;this._registerPostMessages()},_registerPostMessages:function(){n.registerPostMessageAPIs({"user.postapi.rtaPlugin":{inCalls:{activatePlugin:{executeServiceCallFn:function(){return n.createPostMessageResult(this._initPlugin())}.bind(this)},showAdaptUI:{executeServiceCallFn:async function(){await this._changeActionButtonVisibility(true);return n.createPostMessageResult()}.bind(this)},hideAdaptUI:{executeServiceCallFn:async function(){await this._changeActionButtonVisibility(false);return n.createPostMessageResult()}.bind(this)},switchToolbarVisibility:{executeServiceCallFn:function(e){const t=e.oMessageData.body.visible;o(t);return n.createPostMessageResult()}}},outCalls:{startUIAdaptation:{}}}})},_initPlugin:function(){if(this.bIsInitialized){return(new jQuery.Deferred).resolve()}this.bIsInitialized=true;this.mConfig.i18n=this.getModel("i18n").getResourceBundle();return new jQuery.Deferred(e=>{s.createActionButton(this,u.bind(undefined),this.mConfig.visible).then(e=>{this.oActionButton=e}).catch(e=>{this.bIsInitialized=false;return Promise.reject(e)}).then(e.resolve).catch(e.reject)}).promise()},_changeActionButtonVisibility:async function(e){if(!this.oActionButton){return}const t=await i.getAppLifeCycleService();if(e&&t.getCurrentApplication().applicationType==="URL"){this.oActionButton.showForAllApps()}else{this.oActionButton.hideForAllApps()}},exit:function(){o(false)}})});
//# sourceMappingURL=Component.js.map