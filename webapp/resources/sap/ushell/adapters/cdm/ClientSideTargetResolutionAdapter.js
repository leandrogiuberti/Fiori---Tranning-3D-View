// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/Version","sap/ui/thirdparty/jquery","sap/base/util/deepExtend","sap/base/Log","sap/ushell/Container"],(e,jQuery,t,s,r)=>{"use strict";function i(i,o,n){this._oAdapterConfig=n&&n.config;let a="";if(r.isInitialized()){a=r.getLogonSystem().getProductName()||""}this._oLocalSystemAlias={http:{host:"",port:0,pathPrefix:"/sap/bc/"},https:{host:"",port:0,pathPrefix:"/sap/bc/"},rfc:{systemId:"",host:"",service:0,loginGroup:"",sncNameR3:"",sncQoPR3:""},id:"",label:"local",client:"",language:"",properties:{productName:a}};this.getInbounds=function(){const t=this;if(!this._getInboundsDeferred){this._getInboundsDeferred=new jQuery.Deferred;r.getServiceAsync("CommonDataModel").then(e=>e.getSiteWithoutPersonalization()).then(s=>{const r=s._version&&e(s._version).getMajor()===3?"sap/ushell/adapters/cdm/v3/utilsCdm":"sap/ushell/utils/utilsCdm";sap.ui.require([r],e=>{const r=e.formatSite(s)||[];t._getInboundsDeferred.resolve(r)})}).catch(e=>{t._getInboundsDeferred.reject(e)})}return this._getInboundsDeferred.promise()};this._createSIDMap=function(e){return Object.keys(e).sort().reduce((t,s)=>{const r=e[s];const i=`SID(${r.systemId}.${r.client})`;if(!t.hasOwnProperty(i)&&r.hasOwnProperty("systemId")&&r.hasOwnProperty("client")){t[i]=s}return t},{})};this._getSystemAliases=function(){const e=this;if(!this.oSystemAliasesDeferred){this.oSystemAliasesDeferred=new jQuery.Deferred;r.getServiceAsync("CommonDataModel").then(e=>e.getSiteWithoutPersonalization()).then(s=>{const r=t({},s.systemAliases||{});Object.keys(r).forEach(e=>{r[e].id=e});e.oSystemAliasesDeferred.resolve(r)}).catch(t=>{e.oSystemAliasesDeferred.reject(t)})}return this.oSystemAliasesDeferred.promise()};this.resolveSystemAlias=function(e){const r=new jQuery.Deferred;const i=this;this._getSystemAliases().done(o=>{let n;if(o.hasOwnProperty(e)){n=o[e];if(e===""){n.properties=t({},i._oLocalSystemAlias.properties,n.properties||{})}r.resolve(n);return}if(e===""){r.resolve(i._oLocalSystemAlias);return}e=e.toUpperCase(e);if(!i._oSIDMap){i._oSIDMap=i._createSIDMap(o)}if(i._oSIDMap.hasOwnProperty(e)){const t=o[i._oSIDMap[e]];r.resolve(t);return}const a=`Cannot resolve system alias ${e}`;s.warning(a,"The system alias cannot be found in the site response","sap.ushell.adapters.cdm.ClientSideTargetResolutionAdapter");r.reject(new Error(a))}).fail(e=>{r.reject(e)});return r.promise()};this.getContentProviderDataOriginsLookup=function(){const e=this;if(!this.oContentProviderDataOriginsDeferred){this.oContentProviderDataOriginsDeferred=new jQuery.Deferred;r.getServiceAsync("CommonDataModel").then(e=>e.getSiteWithoutPersonalization()).then(s=>{let r=null;if(s.contentProviderDataOrigins){r=t({},s.contentProviderDataOrigins)}e.oContentProviderDataOriginsDeferred.resolve(r)}).catch(t=>{e.oContentProviderDataOriginsDeferred.reject(t)})}return this.oContentProviderDataOriginsDeferred.promise()}}return i},false);
//# sourceMappingURL=ClientSideTargetResolutionAdapter.js.map