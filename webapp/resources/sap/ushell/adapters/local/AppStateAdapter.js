// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/services/appstate/AppStatePersistencyMethod","sap/ui/thirdparty/jquery","sap/base/Log","sap/ushell/Container"],(e,jQuery,t,r)=>{"use strict";function n(e,t,r){this._oConfig=r&&r.config}n.prototype._getPersonalizationService=function(){return r.getServiceAsync("PersonalizationV2")};n.prototype.saveAppState=function(e,n,o,s,a,i,c){const p=new jQuery.Deferred;this._getPersonalizationService().then(n=>{n.createEmptyContainer(e,{keyCategory:n.KeyCategory.GENERATED_KEY,writeFrequency:n.WriteFrequency.HIGH,clientStorageAllowed:false}).then(e=>{e.setItemValue("appStateData",o);e.setItemValue("persistencyMethod",i);e.setItemValue("persistencySettings",c);e.setItemValue("createdBy",r&&r.getUser&&r.getUser().getId());e.save().then(()=>{p.resolve()}).catch(e=>{t.error("AppState save failed",e);p.reject(e)})}).catch(e=>{t.error("AppState save failed",e);p.reject(e)})});return p.promise()};n.prototype.loadAppState=function(r){const n=new jQuery.Deferred;const o=this;this._getPersonalizationService().then(s=>{s.getContainer(r,{keyCategory:s.KeyCategory.GENERATED_KEY,writeFrequency:s.WriteFrequency.HIGH,clientStorageAllowed:false}).then(t=>{const s=t.getItemValue("appStateData");const a=t.getItemValue("persistencyMethod");const i=t.getItemValue("persistencySettings");const c=t.getItemValue("createdBy");if(a===undefined){n.resolve(r,s)}else if(a===e.PersonalState){if(o.getCurrentUserForTesting()===""||o.getCurrentUserForTesting()===c){n.resolve(r,s,a,i)}else{n.reject(new Error("Unauthorized User ID"))}}}).catch(e=>{t.error("AppState load failed",e);n.reject(e)})});return n.promise()};n.prototype.deleteAppState=function(e){const r=new jQuery.Deferred;this._getPersonalizationService().then(n=>{n.deleteContainer(e).then(()=>{r.resolve()}).catch(e=>{t.error("AppState delete failed",e);r.reject(e)})});return r.promise()};n.prototype.getCurrentUserForTesting=function(){return""};n.prototype.getSupportedPersistencyMethods=function(){return[]};return n},false);
//# sourceMappingURL=AppStateAdapter.js.map