// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ui/core/Lib","sap/ui/model/json/JSONModel","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ushell/Container"],(e,t,i,r,o)=>{"use strict";function n(e,t,i){}n.prototype.search=function(e){return this._searchWithSearchableContentAndJsSearch(e)};n.prototype._searchWithSearchableContentAndJsSearch=function(e){return Promise.all([this._getNormalizedSearchableContentApps(e),this._loadJsSearchModule()]).then(t=>{const i=t[0];const r=t[1];const o=new r({objects:i,fields:["title","label","contentProviderLabel","description","keywords","fioriAppId"],shouldNormalize:!String.prototype.normalize,algorithm:{id:"contains-ranked",options:[50,49,40,39,5,4,51]}});const n={searchFor:e?.searchTerm||"*",top:Number.MAX_SAFE_INTEGER,skip:0};const s=o.search(n);const a=s.results.map(e=>e.object);return this._getPaginatedResult(this._applyFiltersAndSorter(a,e.filter,e.sort),e.skip||0,e.top||10)})};n.prototype._getPaginatedResult=function(e,t,i){return{data:e.slice(t,t+i),count:e.length}};n.prototype._getSearchableContent=function(e){const t=e&&{includeAppsWithoutVisualizations:!!e.includeAppsWithoutVisualizations,enableVisualizationPreview:e.enableVisualizationPreview!==false};return o.getServiceAsync("SearchableContent").then(e=>e.getApps(t))};n.prototype._getNormalizedSearchableContentApps=function(e){return this._getSearchableContent(e).then(e=>this._normalizeSearchableContentServiceResult(e))};n.prototype._normalizeSearchableContentServiceResult=function(e){if(!Array.isArray(e)){e=[]}const t=[];let i;let r;let o;let n;let s;e.forEach(e=>{if(e.visualizations&&e.visualizations.length>0){e.visualizations.forEach(a=>{i=a.vizConfig&&a.vizConfig["sap.app"]&&a.vizConfig["sap.app"].title||a.title||e.title;r=a.vizConfig&&a.vizConfig["sap.app"]&&a.vizConfig["sap.app"].subTitle||a.subtitle||e.subtitle;o=a.vizConfig&&a.vizConfig["sap.app"]&&a.vizConfig["sap.app"].description||a.description||e.description;s=a?.vizConfig?.["sap.fiori"]?.registrationIds||[];n=r?`${i} - ${r}`:i;t.push({fioriAppId:s.join(" "),title:i,description:r,longDescription:o||"",keywords:Array.isArray(a.keywords)?a.keywords.join(" "):"",icon:a.icon||"",label:n,contentProviderLabel:a.contentProviderLabel||"",visualization:a,url:a.targetURL,technicalAttributes:Array.isArray(e.technicalAttributes)?e.technicalAttributes.join(" "):""})})}else{i=e.title;r=e.subtitle;n=r?`${i} - ${r}`:i;t.push({title:i,description:r,longDescription:e.description||"",keywords:Array.isArray(e.keywords)?e.keywords.join(" "):"",icon:e.icon||"",label:n,url:e.targetURL,technicalAttributes:Array.isArray(e.technicalAttributes)?e.technicalAttributes.join(" "):""})}});return t};n.prototype._loadJsSearchModule=function(){this._loadJsSearchModulePromise=new Promise(t=>{e.load("sap.esh.search.ui").then(()=>{sap.ui.require(["sap/esh/search/ui/appsearch/JsSearch"],e=>{t(e)})})});return this._loadJsSearchModulePromise};n.prototype._createFilters=function(e){let t=null;if(e){if(typeof e==="object"){if(Array.isArray(e.filters)){e.filters=e.filters.map(e=>e instanceof i?e:new i(e))}t=[e instanceof i?e:new i(e)]}}return t};n.prototype._createSorters=function(e){let t=null;if(e){if(typeof e==="object"&&!Array.isArray(e)){e=[e]}if(Array.isArray(e)){t=e.map(e=>e instanceof r?e:new r(e))}}return t};n.prototype._applyFiltersAndSorter=function(e,i,r){if(!i&&!r){return e}const o=this._createFilters(i);const n=this._createSorters(r);const s=new t;s.setSizeLimit(Number.MAX_SAFE_INTEGER);s.setData(e);return s.bindList("/",null,n,o).getContexts().map(e=>e.getObject())};return n},false);
//# sourceMappingURL=SearchCEPAdapter.js.map