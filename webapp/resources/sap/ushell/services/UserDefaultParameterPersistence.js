// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/util/deepExtend","sap/base/util/ObjectPath","sap/ushell/Container","sap/ushell/utils"],(e,t,a,s,i)=>{"use strict";const r=["value","extendedValue","noEdit","alwaysAskPlugin","_shellData","pluginData"];function n(e,t,a,s){this._oAdapter=e;this._oData={}}n.prototype._cleanseValue=function(e){const a=t({},e);for(const e in a){if(a.hasOwnProperty(e)&&r.indexOf(e)<0){delete a[e]}}return a};n.prototype._getSystemContextFallback=async function(){e.warning("UserDefaultParameterPersistence: The systemContext was not provided, using defaultSystemContext as fallback");const t=await s.getServiceAsync("ClientSideTargetResolution");return t.getSystemContext()};n.prototype.loadParameterValue=async function(t,s){if(!s){s=await this._getSystemContextFallback()}const r=a.get([s.id,t],this._oData);if(r!==undefined){return r}const n=await i.promisify(this._oAdapter.loadParameterValue(t,s));const o=this._cleanseValue(n);a.set([s.id,t],o,this._oData);e.debug(`[UserDefaults] Fetched "${t}" for SystemContext=${s.id} from Persistence`,JSON.stringify(o,null,2));return o};n.prototype.saveParameterValue=async function(t,s,r){if(!r){r=await this._getSystemContextFallback()}if(!s){return i.promisify(this.deleteParameter(t,r))}const n=this._cleanseValue(s);if(s&&s.noStore===true){e.debug(`[UserDefaults] Skipped Save "${t}" for SystemContext=${r.id}`,"noStore=true");return}e.debug(`[UserDefaults] Saving "${t}" for SystemContext=${r.id} to Persistence`,JSON.stringify(n,null,2));a.set([r.id,t],n,this._oData);return i.promisify(this._oAdapter.saveParameterValue(t,n,r))};n.prototype.deleteParameter=async function(t,a){if(!a){a=await this._getSystemContextFallback()}if(this._oData[a.id]){e.debug(`[UserDefaults] Deleting "${t}" for SystemContext=${a.id} from Persistence`);delete this._oData[a.id][t]}return i.promisify(this._oAdapter.deleteParameter(t,a))};n.prototype.getStoredParameterNames=async function(e){if(!e){e=await this._getSystemContextFallback()}const t=await i.promisify(this._oAdapter.getStoredParameterNames(e));return t.sort()};n.hasNoAdapter=false;return n},true);
//# sourceMappingURL=UserDefaultParameterPersistence.js.map