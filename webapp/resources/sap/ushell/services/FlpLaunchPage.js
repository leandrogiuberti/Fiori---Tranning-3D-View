// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/util/extend","sap/ushell/services/ContentExtensionAdapterFactory","sap/ui/thirdparty/jquery","sap/ushell/resources","sap/ushell/Config","sap/m/library","sap/m/GenericTile","sap/ushell/Container"],(e,t,r,jQuery,o,i,n,s,a)=>{"use strict";const l=n.LoadState;function u(n){const u=this;const d=[];this.oAdapters={default:n};const g=r.getAdapters();g.then(e=>{t(this.oAdapters,e)});this.getGroups=function(){if(i.last("/core/spaces/enabled")){return(new jQuery.Deferred).resolve([]).promise()}const t=new jQuery.Deferred;g.then(()=>{const r=Object.keys(u.oAdapters).map(e=>u._getAdapter(e).getGroups());jQuery.when.apply(jQuery,r).done(function(){t.resolve([].concat.apply([],arguments))}).fail(()=>{e.error("getGroups failed")})});return t.promise()};this.getGroupsForBookmarks=function(t){const r=new jQuery.Deferred;this.getGroups().then(i=>{this.getDefaultGroup().then(e=>{if(i.length>0){i=i.filter(e=>{if(t===true){return this.isGroupVisible(e)}return!this.isGroupLocked(e)&&this.isGroupVisible(e)});i=i.map(t=>({title:t===e&&o.i18n.getText("my_group")||this.getGroupTitle(t),object:t}))}r.resolve(i)}).catch(t=>{e.error(`getGroupsForBookmarks - getDefaultGroup - failed: ${t.message}`);r.reject(t)})}).catch(t=>{e.error(`getGroupsForBookmarks - getGroups - failed: ${t.message}`);r.reject(t)});return r.promise()};this.getGroupTilesForSearch=function(e){const t=this._getAdapter(e.contentProvider);if(t.getGroupTileClones){return t.getGroupTileClones(e)}return Promise.resolve(this.getGroupTiles(e))};this.getDefaultGroup=function(){const t=this._getAdapter().getDefaultGroup();t.fail(()=>{e.error("getDefaultGroup failed")});return t};this.getGroupTitle=function(e){return this._getAdapter(e.contentProvider).getGroupTitle(e)};this.getGroupId=function(e){return this._getAdapter(e.contentProvider).getGroupId(e)};this.getGroupById=function(e){const t=new jQuery.Deferred;this.getGroups().then(r=>{t.resolve(r.find(t=>this.getGroupId(t)===e))});return t.promise()};this.getGroupTiles=function(e){return this._getAdapter(e.contentProvider).getGroupTiles(e)};this.getTilesByGroupId=function(e){const t=new jQuery.Deferred;this.getGroupById(e).then(r=>{if(r){let o=this._getAdapter(r.contentProvider).getGroupTiles(r);if(o){o=o.map(t=>({id:this.getTileId(t),title:this.getTileTitle(t),subtitle:this.getCatalogTilePreviewSubtitle(t),url:this.getCatalogTileTargetURL(t),icon:this.getCatalogTilePreviewIcon(t),groupId:e}))}else{o=[]}t.resolve(o)}else{t.resolve([])}});return t.promise()};this.getLinkTiles=function(e){return this._getAdapter(e.contentProvider).getLinkTiles(e)};this.addGroupAt=function(t,r){let o;const i=r;const n=this._getAdapter();if(n.addGroupAt){o=n.addGroupAt(t,r);o.fail(()=>{e.error(`addGroup ${t} failed`)})}else{const r=new jQuery.Deferred;o=n.addGroup(t);o.done(e=>{const t=this.moveGroup(e,i);const o=e;t.done(()=>{r.resolve(o)});t.fail(r.reject)});o.fail(o=>{e.error(`addGroup ${t} failed`,o);r.reject(o)});return r.promise()}return o};this.addGroup=function(t){const r=this._getAdapter().addGroup(t);r.fail(()=>{e.error(`addGroup ${t} failed`)});return r};this.removeGroup=function(t,r){const o=this._getAdapter(t.contentProvider).removeGroup(t,r);o.fail(()=>{e.error(`Fail to removeGroup ${u.getGroupTitle(t)}`)});return o};this.resetGroup=function(t,r){const o=this._getAdapter(t.contentProvider).resetGroup(t,r);o.fail(()=>{e.error(`Fail to resetGroup ${u.getGroupTitle(t)}`)});return o};this.isGroupRemovable=function(e){return this._getAdapter(e.contentProvider).isGroupRemovable(e)};this.isGroupLocked=function(e){const t=this._getAdapter(e.contentProvider);if(typeof t.isGroupLocked==="function"){return t.isGroupLocked(e)}return false};this.isGroupFeatured=function(e){const t=this._getAdapter(e.contentProvider);if(typeof t.isGroupFeatured==="function"){return t.isGroupFeatured(e)}return false};this.moveGroup=function(t,r){const o=this._getAdapter(t.contentProvider).moveGroup(t,r);o.fail(()=>{e.error(`Fail to moveGroup ${u.getGroupTitle(t)}`)});return o};this.setGroupTitle=function(t,r){const o=this._getAdapter(t.contentProvider).setGroupTitle(t,r);o.fail(()=>{e.error(`Fail to set Group title: ${u.getGroupTitle(t)}`)});return o};this.hideGroups=function(t){const r=new jQuery.Deferred;const o=this._getAdapter();if(typeof o.hideGroups!=="function"){r.reject(new Error("hideGroups() is not implemented in the Adapter."))}else{o.hideGroups(t).done(()=>{r.resolve()}).fail(t=>{e.error("Fail to store groups visibility",t);r.reject(t)})}return r.promise()};this.isGroupVisible=function(e){const t=this._getAdapter(e.contentProvider);if(typeof t.isGroupVisible==="function"){return t.isGroupVisible(e)}return true};this.addTile=function(t,r){return this._getAdapter(r.contentProvider).addTile(t,r).fail((r,o)=>{e.error(`Fail to add Tile: ${u.getCatalogTileId(t)}`,o,"sap.ushell.services.LaunchPage")})};this.removeTile=function(t,r,o){const i=new jQuery.Deferred;a.getServiceAsync("AppState").then(n=>{this._getAdapter(t.contentProvider).removeTile(t,r,o).done(()=>{const e=this.getCatalogTileTargetURL(r);this.deleteURLStatesPersistentData(e,n);i.resolve()}).fail(t=>{e.error(`Fail to remove Tile: ${this.getTileId(r)}`,t);i.reject(t)})}).catch(i.reject);return i.promise()};this.moveTile=function(t,r,o,i,n,s){const a=this._getAdapter().moveTile(t,r,o,i,n,s);a.fail(()=>{e.error(`Fail to move Tile: ${u.getTileId(t)}`)});return a};this.isLinkPersonalizationSupported=function(e){const t=e&&e.contentProvider;const r=this._getAdapter(t);if(typeof r.isLinkPersonalizationSupported==="function"){return r.isLinkPersonalizationSupported(e)}return false};this.getTileId=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getTileId(e)};this.getTileTitle=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getTileTitle(e)};this.getTileType=function(e){const t=e&&e.contentProvider;const r=this._getAdapter(t);if(r.getTileType){return r.getTileType(e)}return"tile"};this.getTileView=function(e){const t=e&&e.contentProvider;let r=this._getAdapter(t).getTileView(e);if(typeof r.promise!=="function"){r=(new jQuery.Deferred).resolve(r).promise()}return r};this.getCardManifest=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getCardManifest(e)};this.getAppBoxPressHandler=function(e){const t=e&&e.contentProvider;const r=this._getAdapter(t);if(r.getAppBoxPressHandler){return r.getAppBoxPressHandler(e)}return undefined};this.getTileSize=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getTileSize(e)};this.getTileTarget=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getTileTarget(e)};this.getTileDebugInfo=function(e){const t=e&&e.contentProvider;const r=this._getAdapter(t);if(typeof r.getTileDebugInfo==="function"){return r.getTileDebugInfo(e)}return undefined};this.isTileIntentSupported=function(e){const t=e&&e.contentProvider;const r=this._getAdapter(t);if(typeof r.isTileIntentSupported==="function"){return r.isTileIntentSupported(e)}return true};this.refreshTile=function(e){const t=e&&e.contentProvider;this._getAdapter(t).refreshTile(e)};this.setTileVisible=function(e,t){const r=e&&e.contentProvider;this._getAdapter(r).setTileVisible(e,t)};this.registerTileActionsProvider=function(e){if(typeof e!=="function"){throw new Error("Tile actions Provider is not a function")}d.push(e)};this.getTileActions=function(e){const t=[];let r;const o=e&&e.contentProvider;const i=this._getAdapter(o);if(typeof i.getTileActions==="function"){r=i.getTileActions(e);if(r&&r.length){t.push.apply(t,r)}}for(let o=0;o<d.length;o++){r=d[o](e);if(r&&r.length){t.push.apply(t,r)}}return t};this.getCatalogs=function(){return this._getAdapter().getCatalogs()};this.isCatalogsValid=function(){return this._getAdapter().isCatalogsValid()};this.getCatalogData=function(t){const r=this._getAdapter();if(typeof r.getCatalogData!=="function"){e.warning("getCatalogData not implemented in adapter",null,"sap.ushell.services.LaunchPage");return{id:this.getCatalogId(t)}}return r.getCatalogData(t)};this.getCatalogError=function(e){return this._getAdapter().getCatalogError(e)};this.getCatalogId=function(e){return this._getAdapter().getCatalogId(e)};this.getCatalogTitle=function(e){return this._getAdapter().getCatalogTitle(e)};this.getCatalogTiles=function(t){const r=this._getAdapter().getCatalogTiles(t);r.fail(()=>{e.error(`Fail to get Tiles of Catalog: ${u.getCatalogTitle(t)}`)});return r};this.getCatalogTileId=function(e){return this._getAdapter(e.contentProvider).getCatalogTileId(e)};this.getCatalogTileContentProviderId=function(e){if(this._getAdapter(e.contentProvider).getCatalogTileContentProviderId){return this._getAdapter(e.contentProvider).getCatalogTileContentProviderId(e)}return""};this.getStableCatalogTileId=function(e){const t=this._getAdapter(e.contentProvider);if(t&&!t.getStableCatalogTileId){return null}return t.getStableCatalogTileId(e)};this.getCatalogTileTitle=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getCatalogTileTitle(e)};this.getCatalogTileSize=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getCatalogTileSize(e)};this.getCatalogTileViewControl=function(e,t){const r=e&&e.contentProvider;const o=this._getAdapter(r);if(typeof o.getCatalogTileViewControl==="function"){return o.getCatalogTileViewControl(e,t)}const i=new jQuery.Deferred;const n=this.getCatalogTileView(e,t);i.resolve(n);return i.promise()};this.getCatalogTileView=function(t,r){e.error("Deprecated API call of 'sap.ushell.LaunchPage.getCatalogTileView'. Please use 'getCatalogTileViewControl' instead",null,"sap.ushell.services.LaunchPage");const o=t&&t.contentProvider;const i=this._getAdapter(o);if(i.getCatalogTileView){return i.getCatalogTileView(t,r)}const n=this.getTileTitle(t)||this.getCatalogTileTitle(t);return this._createErrorTile(n,"The LaunchPageAdapter does not support getCatalogTileView")};this._createErrorTile=function(e,t){const r=new s({state:l.Failed,header:e,subheader:t||""}).addStyleClass("sapUshellTileError");return r};this.getCatalogTileTargetURL=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getCatalogTileTargetURL(e)};this.getCatalogTileTags=function(e){const t=e&&e.contentProvider;const r=this._getAdapter(t);if(typeof r.getCatalogTileTags==="function"){return r.getCatalogTileTags(e)}return[]};this.getCatalogTileKeywords=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getCatalogTileKeywords(e)};this.getCatalogTileTechnicalAttributes=function(e){const t=e&&e.contentProvider;const r=this._getAdapter(t);if(typeof r.getCatalogTileTechnicalAttributes==="function"){return r.getCatalogTileTechnicalAttributes(e)}return[]};this.getCatalogTilePreviewTitle=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getCatalogTilePreviewTitle(e)};this.getCatalogTilePreviewInfo=function(e){const t=e&&e.contentProvider;if(this._getAdapter(t).getCatalogTilePreviewInfo){return this._getAdapter(t).getCatalogTilePreviewInfo(e)}return""};this.getCatalogTilePreviewSubtitle=function(e){const t=e&&e.contentProvider;const r=this._getAdapter(t);if(r.getCatalogTilePreviewSubtitle){return r.getCatalogTilePreviewSubtitle(e)}return undefined};this.getCatalogTilePreviewIcon=function(e){const t=e&&e.contentProvider;return this._getAdapter(t).getCatalogTilePreviewIcon(e)};this.addBookmark=function(t,r,o){const i=new jQuery.Deferred;if(this._hasRequiredBookmarkParameters(t)){if(r&&this.isGroupLocked(r)){const t=`Tile cannot be added, target group (${this.getGroupTitle(r)})is locked!`;e.error(t);return i.reject(new Error(t))}const n=r&&r.contentProvider;this._getAdapter(n).addBookmark(t,r,o).done(i.resolve).fail(r=>{e.error(`Fail to add bookmark for URL: ${t.url} and Title: ${t.title}`,r);i.reject(r)})}return i.promise()};this.addCustomBookmark=function(t,r,o){const i=new jQuery.Deferred;if(this._hasRequiredBookmarkParameters(t)){if(r&&this.isGroupLocked(r)){const t=`Tile cannot be added, target group (${this.getGroupTitle(r)})is locked!`;e.error(t);return i.reject(new Error(t))}const n=r&&r.contentProvider;this._getAdapter(n).addCustomBookmark(t,r,o).done(i.resolve).fail(r=>{e.error(`Fail to add bookmark for URL: ${t.url} and Title: ${t.title}`,r);i.reject(r)})}return i.promise()};this._hasRequiredBookmarkParameters=function(t){if(!t.title){e.error("Add Bookmark - Missing title");throw new Error("Title missing in bookmark configuration")}if(!t.url){e.error("Add Bookmark - Missing URL");throw new Error("URL missing in bookmark configuration")}return true};this.countBookmarks=function(t,r){if(!t||typeof t!=="string"){e.error("Fail to count bookmarks. No valid URL");throw new Error("Missing URL")}const o=this._getAdapter().countBookmarks(t,r);o.fail(()=>{e.error("Fail to count bookmarks")});return o};this.countCustomBookmarks=async function(e){if(!e.url||!e.vizType){throw new Error("countCustomBookmarks: Some required parameters are missing.")}return this._getAdapter().countCustomBookmarks(e)};this.deleteBookmarks=function(t,r){const o=new jQuery.Deferred;if(!t||typeof t!=="string"){return o.reject(new Error("Missing URL")).promise()}a.getServiceAsync("AppState").then(i=>{this._getAdapter().deleteBookmarks(t,undefined,r).done(e=>{this.deleteURLStatesPersistentData(t,i);o.resolve(e)}).fail(r=>{e.error(`Fail to delete bookmark for: ${t}`,r);o.reject(r)})}).catch(o.reject);return o.promise()};this.deleteCustomBookmarks=async function(e){if(!e.url||!e.vizType){throw new Error("deleteCustomBookmarks: Some required parameters are missing.")}return this._getAdapter().deleteCustomBookmarks(e)};this.updateBookmarks=function(t,r,o){if(!t||typeof t!=="string"){e.error("Fail to update bookmark. No valid URL");throw new Error("Missing URL")}if(!r||typeof r!=="object"){e.error(`Fail to update bookmark. No valid parameters, URL is: ${t}`);throw new Error("Missing parameters")}const i=new jQuery.Deferred;this._getAdapter().updateBookmarks(t,r,undefined,o).done(i.resolve).fail(r=>{e.error(`Fail to update bookmark for: ${t}`,r);i.reject(r)});return i.promise()};this.updateCustomBookmarks=async function(e,t){if(!e.url||!e.vizType||!t){throw new Error("updateCustomBookmarks: Some required parameters are missing.")}return this._getAdapter().updateCustomBookmarks(e,t)};this.onCatalogTileAdded=function(e){this._getAdapter().onCatalogTileAdded(e)};function c(e,t){const r=new RegExp(`(?:${t}=)([^&/]+)`);const o=r.exec(e);let i;if(o&&o.length===2){i=o[1]}return i}this.deleteURLStatesPersistentData=function(t,r){if(r.getSupportedPersistencyMethods().length===0){return}if(t&&t.length>0){try{const e=c(t,"sap-xapp-state");const o=c(t,"sap-iapp-state");if(e!==undefined||o!==undefined){this.countBookmarks(t).done(t=>{if(t===0){if(e!==undefined){r.deleteAppState(e)}if(o!==undefined){r.deleteAppState(o)}}})}}catch(t){e.error("error in deleting persistent state when bookmark is deleted",t,"sap.ushell.services.LaunchPage")}}}}u.prototype._getAdapter=function(e){return this.oAdapters[e]||this.oAdapters.default};u.hasNoAdapter=false;return u},true);
//# sourceMappingURL=FlpLaunchPage.js.map