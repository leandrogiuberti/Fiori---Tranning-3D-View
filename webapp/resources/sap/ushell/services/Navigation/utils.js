// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/isPlainObject","sap/base/util/ObjectPath","sap/base/Log","sap/ushell/Container","sap/ushell/utils/UrlParsing"],(t,e,r,n,a)=>{"use strict";const s={};s.extractGetLinksParameterOptions=function(t){return s._parseGetLinksParameters(t).filter(t=>Object.keys(t.options).length>0).map(t=>({name:t.name,options:t.options}))};s.extractGetLinksParameterDefinition=function(t){return s._parseGetLinksParameters(t).reduce((t,e)=>{t[e.name]=e.value;return t},{})};s._parseGetLinksParameters=function(t){if(Object.prototype.toString.apply(t)!=="[object Object]"){return[]}const e=JSON.parse(JSON.stringify(t));return Object.keys(e).map(t=>{let r=e[t];let n={};if(Object.prototype.toString.apply(r)==="[object Object]"){r=r.value;delete e[t].value;n=e[t]}return{name:t,value:r,options:n}})};s._safeParseToObject=function(t){try{return JSON.parse(t)}catch(t){r.error("Cannot parse the given string to object",t)}return null};s._createAppStateFromData=function(t){return n.getServiceAsync("AppState").then(e=>{const r=e.createEmptyAppState(null);r.setData(t);r.save();return r.getKey()})};s._extractParameter=function(n,c){let i;let o=null;if(typeof n==="string"){if(n.indexOf(`${c}=`)===-1){return{intent:n,data:null}}const t=a.parseShellHash(n);if(!t){return{intent:n,data:null}}o=t.params[c];delete t.params[c];i=a.constructShellHash(t);return{intent:i,data:o}}if(t(n)){const t=e.get("target.shellHash",n);if(typeof t==="string"){const e=s._extractParameter(t,c);n.target.shellHash=e.intent;return{intent:n,data:e.data}}const r=n.params;if(r&&r[c]){const t=r[c];o=typeof t==="string"?[t]:t;delete r[c]}return{intent:n,data:o}}r.error("Invalid input parameter","expected string or object");return{intent:n}};s.addXAppStateFromParameter=function(t,e){const r=s._extractParameter(t,e);const n=r.intent;const a=r.data&&r.data[0];if(!a){return Promise.resolve()}const c=s._safeParseToObject(a);if(!c){return Promise.resolve()}return s._createAppStateFromData(c).then(t=>{s._injectParameter(n,"sap-xapp-state",t)})};s._injectParameter=function(t,r,n){if(typeof t==="string"){const e=a.parseShellHash(t);e.params[r]=n;return a.constructShellHash(e)}if(Object.prototype.toString.apply(t)==="[object Object]"){const a=e.get("target.shellHash",t);if(typeof a==="string"){t.target.shellHash=s._injectParameter(a,r,n);return t}if(!t.params){t.params={}}t.params[r]=n}return t};s.injectParameters=function(t){const e=t.inject;const r=t.injectEmptyString||{};const n=t.type;const a=t.args;function c(t,e){return t||t===""&&e}if(n.isPlainObject(a)){if(a.target&&a.target.shellHash){if(typeof a.target.shellHash==="string"){a.target.shellHash=s.injectParameters({inject:e,injectEmptyString:r,type:t.type,args:a.target.shellHash})}return a}const n=Object.keys(e).reduce((t,n)=>{const a=e[n];const s=r[n]===true;if(c(a,s)&&typeof t==="string"){const e=new RegExp(`[&]${n}`);const r=!e.test(t);if(r){const e=t?"&":"";t+=`${e+n}=${a}`}}else if(c(a,s)&&!t.hasOwnProperty(n)){t[n]=a}return t},a.params||{});if(n&&Object.keys(n).length>0){a.params=n}return a}let i=a;if(i){Object.keys(e).forEach(t=>{const n=e[t];const a=r[t]===true;const s=new RegExp(`[?&]${t}`);const o=!s.test(i);if(c(n,a)&&o){const e=i.indexOf("?")>-1?"&":"?";i+=`${e+t}=${n}`}})}return i};s.injectStickyParameters=function(t){return n.getServiceAsync("AppLifeCycle").then(e=>s._injectStickyParameters(t,e))};s._injectStickyParameters=function(t,e){if(!e||Object.keys(e).length<=0){return t.args}const r=e.getCurrentApplication();if(!r||Object.keys(r).length<=0){return t.args}const n=t.appLifeCycle;const a=t.technicalParameters;const c=a.getParameters({sticky:true}).reduce((t,e)=>{const s=e.name;const c=r.componentInstance;const i=r.applicationType;let o;if(i==="UI5"){o={}}else{o=n.getCurrentApplication().container}const p=a.getParameterValueSync(s,c,o,i);const l=e.stickyName||s;t[l]=p;return t},{});const i={type:t.type,inject:c,args:t.args};return s.injectParameters(i)};return s});
//# sourceMappingURL=utils.js.map