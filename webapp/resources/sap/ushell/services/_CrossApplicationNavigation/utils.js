// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/util/isPlainObject","sap/base/util/ObjectPath","sap/base/Log","sap/ushell/utils/UrlParsing"],(t,e,r,a)=>{"use strict";const n={};n.extractGetLinksParameterOptions=function(t){return n.parseGetLinksParameters(t).filter(t=>Object.keys(t.options).length>0).map(t=>({name:t.name,options:t.options}))};n.extractGetLinksParameterDefinition=function(t){return n.parseGetLinksParameters(t).reduce((t,e)=>{t[e.name]=e.value;return t},{})};n.parseGetLinksParameters=function(t){if(Object.prototype.toString.apply(t)!=="[object Object]"){return[]}const e=JSON.parse(JSON.stringify(t));return Object.keys(e).map(t=>{let r=e[t];let a={};if(Object.prototype.toString.apply(r)==="[object Object]"){r=r.value;delete e[t].value;a=e[t]}return{name:t,value:r,options:a}})};n.safeParseToObject=function(t){try{return JSON.parse(t)}catch(t){r.error("Cannot parse the given string to object",t)}return null};n.createAppStateFromData=function(t){r.error("Deprecated API call of '_CrossApplicationNavigation.utils.createAppStateFromData'. Please use 'createAppStateFromDataAsync' instead",null,"sap.ushell.services._CrossApplicationNavigation.utils");const e=sap.ushell.Container.getService("AppState");const a=e.createEmptyAppState(null);a.setData(t);a.save();return a.getKey()};n.createAppStateFromDataAsync=function(t){return sap.ushell.Container.getServiceAsync("AppState").then(e=>{const r=e.createEmptyAppState(null);r.setData(t);r.save();return r.getKey()})};n.extractParameter=function(s,c){let i;let o=null;if(typeof s==="string"){if(s.indexOf(`${c}=`)===-1){return{intent:s,data:null}}const t=a.parseShellHash(s);if(!t){return{intent:s,data:null}}o=t.params[c];delete t.params[c];i=a.constructShellHash(t);return{intent:i,data:o}}if(t(s)){const t=e.get("target.shellHash",s);if(typeof t==="string"){const e=n.extractParameter(t,c);s.target.shellHash=e.intent;return{intent:s,data:e.data}}const r=s.params;if(r&&r[c]){const t=r[c];o=typeof t==="string"?[t]:t;delete r[c]}return{intent:s,data:o}}r.error("Invalid input parameter","expected string or object");return{intent:s}};n.addXAppStateFromParameter=function(t,e){const r=n.extractParameter(t,e);const a=r.intent;const s=r.data&&r.data[0];if(!s){return}const c=n.safeParseToObject(s);if(!c){return}const i=n.createAppStateFromData(c);n.injectParameter(a,"sap-xapp-state",i)};n.addXAppStateFromParameterAsync=function(t,e){const r=n.extractParameter(t,e);const a=r.intent;const s=r.data&&r.data[0];if(!s){return Promise.resolve()}const c=n.safeParseToObject(s);if(!c){return Promise.resolve()}return n.createAppStateFromDataAsync(c).then(t=>{n.injectParameter(a,"sap-xapp-state",t)})};n.injectParameter=function(t,r,s){if(typeof t==="string"){const e=a.parseShellHash(t);e.params[r]=s;return a.constructShellHash(e)}if(Object.prototype.toString.apply(t)==="[object Object]"){const a=e.get("target.shellHash",t);if(typeof a==="string"){t.target.shellHash=n.injectParameter(a,r,s);return t}if(!t.params){t.params={}}t.params[r]=s}return t};n._injectParameters=function(t){const e=t.inject;const r=t.injectEmptyString||{};const a=t.type;const s=t.args;function c(t,e){return t||t===""&&e}if(a.isPlainObject(s)){if(s.target&&s.target.shellHash){if(typeof s.target.shellHash==="string"){s.target.shellHash=n._injectParameters({inject:e,injectEmptyString:r,type:t.type,args:s.target.shellHash})}return s}const a=Object.keys(e).reduce((t,a)=>{const n=e[a];const s=r[a]===true;if(c(n,s)&&typeof t==="string"){const e=new RegExp(`[&]${a}`);const r=!e.test(t);if(r){const e=t?"&":"";t+=`${e+a}=${n}`}}else if(c(n,s)&&!t.hasOwnProperty(a)){t[a]=n}return t},s.params||{});if(a&&Object.keys(a).length>0){s.params=a}return s}let i=s;if(i){Object.keys(e).forEach(t=>{const a=e[t];const n=r[t]===true;const s=new RegExp(`[?&]${t}`);const o=!s.test(i);if(c(a,n)&&o){const e=i.indexOf("?")>-1?"&":"?";i+=`${e+t}=${a}`}})}return i};n.injectStickyParameters=function(t){r.error("Deprecated API call of '_CrossApplicationNavigation.utils.injectStickyParameters'. Please use 'injectStickyParametersAsync' instead",null,"sap.ushell.services._CrossApplicationNavigation.utils");const e=sap.ushell.Container.getService("AppLifeCycle");return n._injectStickyParameters(t,e)};n.injectStickyParametersAsync=function(t){return sap.ushell.Container.getServiceAsync("AppLifeCycle").then(e=>n._injectStickyParameters(t,e))};n._injectStickyParameters=function(t,e){if(!e||Object.keys(e).length<=0){return t.args}const r=e.getCurrentApplication();if(!r||Object.keys(r).length<=0){return t.args}const a=t.appLifeCycle;const s=t.technicalParameters;const c=s.getParameters({sticky:true}).reduce((t,e)=>{const n=e.name;const c=r.componentInstance;const i=r.applicationType;let o;if(i==="UI5"){o={}}else{o=a.getCurrentApplication().container}const p=s.getParameterValueSync(n,c,o,i);const l=e.stickyName||n;t[l]=p;return t},{});const i={type:t.type,inject:c,args:t.args};return n._injectParameters(i)};return n});
//# sourceMappingURL=utils.js.map