// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/ushell/URLTemplateProcessor/Functions"],t=>{"use strict";function n(){const n="[a-zA-Z0-9]+?:";const e=`((&(${n})?)?[.a-zA-Z0-9_-]+?)`;const r="('(.*?)')";const s="([^' ]*?)";const o=`{(${e})}`;const c="("+`[.]?([/](${e}|${o}))+`+")";const i=`(${c}|${r}|${e}|${o})`;const u=`(${i}(,${i})*)`;const a=`(${s}|${o})`;const l=`(${a}(,${a})*)`;const p="("+`[(]${l}[)]`+")?";const f=t.getPossibleFunctionsRegExpString();const h="("+`(${f})`+`(${p})`+")";const $=`([*]([|]${h})*)`;const d=`^{(${$}|`+`((${h})([ ](${u}))?)`+"|"+`(${i})`+")}$";const g=new RegExp(d);return g}function e(t){const n=t.split("");n.shift();n.pop();return n.join("")}function r(t,n,e){if(!n){return[]}const r=n.split(e).reduce((t,n,r)=>{if(r===0){t.push(n);return t}const s=t.length-1;const o=t[s];const c=o.length>0&&o.charAt(o.length-1)==="\\";let i="";if(c){i=t.pop();i=i.substr(0,i.length-1)+e}t.push(i+n);return t},[]);return r}function s(t,n){if(t.indexOf(n)===0){return t.substr(n.length)}throw new Error(`Given string does not start with prefix '${n}'`)}function o(t){return{type:"literal",value:t}}function c(t,n){if(n.charAt(0)==="{"&&n.charAt(n.length-1)==="}"){return a(t,e(n))}return{type:"literal",value:n}}function i(t,n){const e=n.split("/");let r="relative";if(e[0]===""){r="absolute";e.shift()}if(e[0]==="."){e.shift()}return{type:"path",pathType:r,value:e.map(c.bind(null,t))}}function u(t){let n=t.substr(1);let e;if(n.indexOf(":")>=0){const t=n.split(":");e=t[0];n=t[1]}const r={type:"reference",value:n};if(e){r.namespace=e}return r}function a(t,n){if(n.charAt(0)==="{"&&n.charAt(n.length-1)==="}"){return a(t,e(n))}if(n.indexOf(".")===0||n.indexOf("/")===0){return i(t,n)}if(n.charAt(0)==="'"&&n.charAt(n.length-1)==="'"){return o(e(n))}if(n.charAt(0)==="&"){return u(n)}return{type:"reference",value:n,namespace:t}}function l(t,n){const o=n.split(/[(\s]/)[0];let c=s(n,o);c=c.replace(/^\s+/,"");let i="";if(c.charAt(0)==="("){const t=c.search(/([)]\s)|([)]$)/);if(t===-1){throw new Error(`Cannot find termination of function '${c}' in '${n}'`)}i=c.substr(1,t-1);c=s(c,`(${i})`);c=c.replace(/^\s+/,"")}const u=c;return{type:"function",name:o,args:r(t,i,",").map(t=>t.charAt(0)==="{"?e(t):`'${t}'`).map(a.bind(null,t)),params:r(t,u,",").map(a.bind(null,t))}}function p(t,n){const e=r(t,n,"|");const s=e.shift();return{type:"pipe",value:[{type:"wildcard",value:s}].concat(e.map(l.bind(null,t)))}}function f(r,s){const o=n();const c=o.exec(s);if(c===null){throw new Error(`Cannot parse expression: '${s}'`)}const i=e(s);if(i.indexOf("*")===0){return p(r,i)}const u=`^(${t.getPossibleFunctionsRegExpString()})[^a-z]`;const f=new RegExp(u);if(f.exec(i)){return l(r,i)}return a(r,i)}function h(t){const e=t.indexOf("{")===0;const r=n();const s=r.exec(t);if(!s){if(e){throw new Error(`Expression was expected. But ${t} does not look like a valid expression`)}return null}return s[1]}function $(t){return h(t)!==null}function d(t){return typeof t==="string"&&!$(t)}function g(t,n){let e=n;let r=null;if(Object.prototype.toString.apply(n)==="[object Object]"){e=n.value;r=n.renameTo}const s=d(e);if(s){return o(e)}const c="expression";const i=f(t,e);const u={type:c,value:i};if(r){i.renameTo=r}return u}function x(t,n){return Object.keys(t).reduce((e,r)=>{const s=t[r];e[r]=g(n,s);return e},{})}function m(t,n){return Object.keys(t).reduce((n,e)=>{const r=t[e];n[e]=o(r);return n},{})}return{parseTemplateParameterSet:x,parseTemplateParameterSetAsLiterals:m,parsePath:i,_isExpression:$,_parseList:r,_parseParameterValue:g}});
//# sourceMappingURL=TemplateParameterParser.js.map