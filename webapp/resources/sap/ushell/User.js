// Copyright (c) 2009-2025 SAP SE, All Rights Reserved
sap.ui.define(["sap/base/Log","sap/base/i18n/Localization","sap/base/util/deepExtend","sap/ui/base/EventProvider","sap/ui/core/Locale","sap/ui/core/LocaleData","sap/ui/thirdparty/URI","sap/ushell/utils","sap/ui/core/Theming"],(e,t,n,i,o,r,s,a,h)=>{"use strict";function m(e){if(e===undefined){return undefined}return n({},e)}function u(e){let t;if(e.host&&typeof e.host==="function"&&e.host()){t=e.host();if(typeof e.protocol==="function"&&e.protocol()){t=`${e.protocol()}://${t}`}return t}return""}function c(e){return e.indexOf("sap_")===0}function g(m={}){let l=[];let p;let f;const d=new i;const T={};m.userProfile?.forEach?.(e=>{if(e.id&&e.editState){T[e.id]=e.editState}});let y=m.userProfile?.find?.(e=>e.id==="THEME_SET")?.value||"";this.getEditState=function(e){return T[e]};this.getEmail=function(){return m.email};this.getFirstName=function(){return m.firstName};this.getFullName=function(){return m.fullName};this.getTimeZone=function(){return m.timeZone};this.getLanguageAndRegionSettingsEntry=async()=>{if(m.getLanguageAndRegionSettingsEntry){const e=await m.getLanguageAndRegionSettingsEntry();return e}const[e]=await a.requireAsync(["sap/ushell/components/shell/Settings/userLanguageRegion/UserLanguageRegionEntry"]);return e};this.getInitials=function(){const e=m.fullName||"";let t="";let n=true;for(let i=0,o=e.length;i<o;++i){if(e[i]===" "){n=true}else if(n){n=false;t+=e[i]}}return t};this.getId=function(){return m.id};this.getLanguage=function(){return m.language};this.getLanguageBcp47=function(){return m.languageBcp47};this.getLanguageText=function(){const e=new o(t.getLanguageTag());const n=new r(e);const i=t.getLanguageTag().toString();return n.getLanguageName(i)||this.getLanguage()};this.getLastName=function(){return m.lastName};this.getImage=function(){return m.image};this.getCalendarWeekNumbering=function(){return m.calendarWeekNumbering||"Default"};this.setImage=function(e){m.image=e;d.fireEvent("onSetImage",e)};this.attachOnSetImage=function(e,t){d.attachEvent("onSetImage",e,t)};this.isJamActive=function(){return m.isJamActive===true};this.isLanguagePersonalized=function(){return m.isLanguagePersonalized===true};this.getTheme=function(e){if(e===g.prototype.constants.themeFormat.ORIGINAL_THEME){return f.originalTheme.theme}if(e===g.prototype.constants.themeFormat.THEME_NAME_PLUS_URL){return p.theme+(p.locationPath?`@${p.locationOrigin}${p.locationPath}`:"")}if(e===g.prototype.constants.themeFormat.NWBC){if(c(p.theme)){return p.theme}return this.getTheme(g.prototype.constants.themeFormat.THEME_NAME_PLUS_URL)}return p.theme};this.getThemeSet=function(){return y};this.getThemeRoot=function(e){if(m.ranges&&m.ranges.theme&&m.ranges.theme[e]&&m.ranges.theme[e].themeRoot){return m.ranges.theme[e].themeRoot}return""};this.addThemeRootForTheme=function(e){if(m.ranges.theme[e.id]){m.ranges.theme[e.id].themeRoot=e.root}else{m.ranges.theme[e.id].displayName="";m.ranges.theme[e.id].themeRoot=e.root}};this.setThemeSet=function(t){if(this.isSetThemePermitted()===false){const t="setThemeSet is not permitted";e.error(t);throw new Error(t)}if(t!==y){this.setChangedProperties({propertyName:"themeSet",name:"THEME_SET"},y,t);y=t}};this.setLanguage=function(e){if(e){this.setChangedProperties({propertyName:"language",name:"LANGUAGE"},m.language,e);m.language=e}};this.getAccessibilityMode=function(){return m.accessibility};this.setAccessibilityMode=function(t){if(this.isSetAccessibilityPermitted()===false){const t="setAccessibilityMode not permitted";e.error(t);throw new Error(t)}m.accessibility=t};this.isAdminUser=function(){return m.isAdminUser===true};this.isSetAccessibilityPermitted=function(){return m.setAccessibilityPermitted};this.isSetThemePermitted=function(){return m.setThemePermitted};this.getContentDensity=function(){return m.contentDensity};this.setContentDensity=function(t){if(this.isSetContentDensityPermitted()===false){const t="setContentDensity not permitted";e.error(t);throw new Error(t)}e.debug("[000] setContentDensity",t,"User");this.setChangedProperties({propertyName:"contentDensity",name:"CONTENT_DENSITY"},m.contentDensity,t);m.contentDensity=t};this.isSetContentDensityPermitted=function(){return m.setContentDensityPermitted};this.getChangedProperties=function(){e.debug("[000] user: getChangedProperties: aChangedProperties",JSON.stringify(l),"User");return n([],l)};this.setChangedProperties=function(t,n,i){e.debug("[000] setChangedProperties",[t.name,n,i],"User");l.push({propertyName:t.propertyName,name:t.name,oldValue:n,newValue:i})};this.resetChangedProperties=function(){e.debug("[000] resetChangedProperties","User");l=[]};this.resetChangedProperty=function(t){e.debug("[000] resetChangedProperty: sPropertyName:",t,"User");l=l.filter(e=>!(t===e.propertyName))};this.getTrackUsageAnalytics=function(){return m.trackUsageAnalytics};this.setTrackUsageAnalytics=function(e){this.setChangedProperties({propertyName:"trackUsageAnalytics",name:"TRACKING_USAGE_ANALYTICS"},m.trackUsageAnalytics,e);m.trackUsageAnalytics=e};this.setImageConsent=function(e){this.setChangedProperties({propertyName:"isImageConsent",name:"ISIMAGECONSENT"},m.isImageConsent,e);m.isImageConsent=e};this.getImageConsent=function(){return m.isImageConsent};this.getImportBookmarksFlag=function(){return m.importBookmarks||null};this.setImportBookmarksFlag=function(e){this.setChangedProperties({propertyName:"importBookmarks",name:"MYHOME_IMPORT_FROM_CLASSIC"},this.getImportBookmarksFlag()||"",e);m.importBookmarks=e};this.getShowMyHome=function(){return m.showMyHome!==false};this.setShowMyHome=function(e){e=!!e;this.setChangedProperties({propertyName:"showMyHome",name:"MYHOME_ENABLEMENT"},m.showMyHome,e);m.showMyHome=e};this.getDetectDarkMode=function(){return m.detectDarkMode!==false};this.setDetectDarkMode=function(e){e=!!e;this.setChangedProperties({propertyName:"detectDarkMode",name:"THEME_DARKMODE_AUTO_DETECTION"},m.detectDarkMode,e);m.detectDarkMode=e};const P={locationPathUi5:new s(sap.ui.require.toUrl("")).absoluteTo(document.location).pathname(),locationPathCustom:m.themeRoot||"",locationOrigin:u(new s(document.location))};if(!P.locationPathUi5){e.warning("User: Could not set UI5 location path")}if(!P.locationPathCustom){e.warning("User: Could not set location path for custom themes")}if(!P.locationOrigin){e.warning("User: Could not set front-end server location origin")}const E=m.bootTheme||{theme:"",root:""};p=this._amendTheme(E,P);f=p;this.setTheme=function(t){if(this.isSetThemePermitted()===false){const t="setTheme not permitted";e.error(t);throw new Error(t)}p=this._amendTheme({theme:t,root:this.getThemeRoot(t)},P);if(t!==f.originalTheme.theme){this.setChangedProperties({propertyName:"theme",name:"THEME"},f.originalTheme.theme,t);f=p}this.applyTheme(t)};this.applyTheme=function(e){const t=this._amendTheme({theme:e,root:this.getThemeRoot(e)},P);p=t;if(t.suppliedRoot){h.setThemeRoot(t.theme,`${t.suppliedRoot}/UI5/`)}else if(t.path){h.setThemeRoot(t.theme,`${t.path}/UI5/`)}h.setTheme(t.theme);sap.ui.require(["sap/ushell/appIntegration/PostMessageManager"],e=>{e.sendRequestToAllApplications("sap.ushell.appRuntime.themeChange",{currentThemeId:this.getTheme(g.prototype.constants.themeFormat.NWBC),themeServiceRoute:`${window.location.protocol}//${window.location.host}/comsapuitheming.runtime/themeroot/v1`},false)})}}g.prototype._amendTheme=function(e,t){if(!e||!e.theme||!t){return{originalTheme:{theme:"",root:""},theme:"",suppliedRoot:"",path:"",locationPath:"",locationOrigin:""}}function n(e,t){const n=new s(e);const i=u(n);return{locationOrigin:i||t.locationOrigin,locationPath:i?n.path():e}}const i={originalTheme:m(e)};let o;if(i.originalTheme.theme.indexOf("@")>0){const e=i.originalTheme.theme.split("@",2);i.theme=e[0];i.suppliedRoot=e[1];o=n(e[1],t);i.locationPath=o.locationPath;i.path=i.locationPath;i.locationOrigin=o.locationOrigin;return i}i.theme=i.originalTheme.theme;if(i.originalTheme.root){i.suppliedRoot=i.originalTheme.root;o=n(i.originalTheme.root,t);i.locationPath=o.locationPath;i.path=i.locationPath;i.locationOrigin=o.locationOrigin;return i}i.suppliedRoot="";if(c(i.theme)){i.locationOrigin=t.locationOrigin;i.locationPath=t.locationPathUi5;i.path="";return i}i.locationOrigin=t.locationOrigin;i.locationPath=t.locationPathCustom;i.path=i.locationPath;return i};g.prototype.constants={themeFormat:{ORIGINAL_THEME:"O",THEME_NAME_PLUS_URL:"N+U",NWBC:"NWBC"}};return g},true);
//# sourceMappingURL=User.js.map