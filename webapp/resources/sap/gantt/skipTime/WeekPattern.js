/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/skipTime/SkipPattern","./WeeklyDiscontinuousProvider","sap/gantt/misc/Utility","sap/base/i18n/date/TimezoneUtils"],function(e,t,n,o){"use strict";var a=e.extend("sap.gantt.skipTime.WeekPattern",{metadata:{library:"sap.gantt",defaultAggregation:"dailyIntervals",properties:{enabled:{type:"boolean",defaultValue:true}},aggregations:{dailyIntervals:{type:"sap.gantt.skipTime.DayInterval",multiple:true,singularName:"dailyInterval"},weeklyIntervals:{type:"sap.gantt.skipTime.SkipInterval",multiple:true,singularName:"weeklyInterval"}}}});var r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];function i(e,t){const[n,o,a]=[e.getHours(),e.getMinutes(),e.getSeconds()];if(t==="SOD"&&n===0&&o===0&&a===0){return"SOD"}if(t==="EOD"&&n===23&&o===59&&a===59){return"EOD"}return`${String(n).padStart(2,"0")}:${String(o).padStart(2,"0")}:${String(a).padStart(2,"0")}`}function s(e,t){const n=e.getTime()+t;return new Date(n)}function l(e,t){const n=new Date(e.getTime());if(t==="SOD"){n.setHours(0,0,0,0);return n}if(t==="EOD"){n.setHours(23,59,59,999);return n}const[o,a,r]=t.split(":").map(Number);n.setHours(o,a,r,0);return n}function u(e){return e.getHours()*36e5+e.getMinutes()*6e4+e.getSeconds()*1e3}a.prototype._getPatternConfig=function(){var e=this._getWeekPattern();var t=null;var a=this._getTimezone();if(a&&a!==o.getLocalTimezone()){const o=[];t={};r.forEach((e,n)=>{o[n]=[];t[e]=[]});const g=(e,n,o)=>{t[r[e]].push([i(n,"SOD"),i(o,"EOD")])};let c=new Date;const p=n.getNonDSTOffsetInfo(a,c);c=new Date(c.getFullYear(),p.month,2,0,0,0,0);for(let t=0;t<r.length;t++){const a=n.getNextWeekday(c,t);for(const[n,i]of e[r[t]]??[]){const e=s(l(a,n),p.offset);const t=s(l(a,i),p.offset);const r=e.getDay();const u=t.getDay();if(r!==u){o[r].push(e,l(e,"EOD"));o[u].push(l(t,"SOD"),t)}else{o[r].push(e,t)}}}for(let e=0;e<r.length;e++){const t=o[e].sort((e,t)=>u(e)-u(t));for(let n=0;n<t.length;n+=2){const o=t[n+1];const a=t[n+2];const r=u(o);if(a&&u(a)-r<=1e3){g(e,t[n],t[n+3]);n+=2}else if(r-u(t[n])>=1e3){g(e,t[n],o)}}}}return{pattern:t||e,localPattern:e}};a.prototype._getWeekPattern=function(){var e={};var t=this.getDailyIntervals();var n=this.getWeeklyIntervals();if(n&&n.length>0){var o=[];n.forEach(function(e){o.push(e._getFormattedTime())});r.forEach(function(t){e[t]=o})}t.forEach(function(t){var n=t._getFormattedSkipIntervals();if(n.length){e[t.getDay()]=t._getFormattedSkipIntervals()}});return e};a.prototype.getDiscontinuityProvider=function(){if(this.getEnabled()){var e=this._getPatternConfig();return Object.keys(e.pattern).length===0?null:t.providers.weeklyPattern(e)}return null};a.prototype.setEnabled=function(e){this.setProperty("enabled",e,true);this.updateDiscontinuousProvider(this.getDiscontinuityProvider())};a.prototype.setLocale=function(t){if(this._oLocale!==t){this._setTimezone(t.getTimeZone());if(!this._oLocaleDelegate){this._oLocaleDelegate={onTimezoneChanged:()=>{this._setTimezone(t.getTimeZone())}}}t.addDelegate(this._oLocaleDelegate)}e.prototype.setLocale.apply(this,arguments)};a.prototype.exit=function(){const t=this.getLocale();if(this._oLocaleDelegate&&t){t.removeDelegate(this._oLocaleDelegate)}e.prototype.exit.apply(this,arguments)};a.prototype.clone=function(){const t=this.getLocale();if(this._oLocaleDelegate&&t){t.removeDelegate(this._oLocaleDelegate)}const n=e.prototype.clone.apply(this,arguments);if(t){n.setLocale(t)}return n};return a});
//# sourceMappingURL=WeekPattern.js.map