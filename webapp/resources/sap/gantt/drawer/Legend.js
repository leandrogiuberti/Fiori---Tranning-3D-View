/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/drawer/Drawer","sap/gantt/misc/Format","../library","sap/ui/thirdparty/d3"],function(t,e,r){"use strict";var n=t.extend("sap.gantt.drawer.Legend");n.prototype._recursiveDraw=function(t,e){var r=t.selectAll("."+e.getId()).data(function(t){var e=[];return e.concat(t)});this._drawPerTag(r,e)};n.prototype._drawPerTag=function(t,e){var r=e.mChartInstance;if(e.getIsDuration()){e.getTime=function(){return r.TIME_RANGE[0]};e.getEndTime=function(){return r.TIME_RANGE[1]}}else{e.getTime=function(){return r.TIME}}e.setRowYCenter(r.getScaledLegendHeight()/2);switch(e.getTag()){case"g":this._drawGroup(t,e);break;case"line":this._drawLine(t,e);break;case"rect":this._drawRect(t,e);break;case"text":this._drawText(t,e);break;case"path":this._drawPath(t,e);break;case"image":this._drawImage(t,e);break;case"polygon":this._drawPolygon(t,e);break;case"polyline":this._drawPolyline(t,e);break;case"circle":this._drawCircle(t,e);break;default:break}this._insertTitle(t,e)};n.prototype._insertTitle=function(t,e){t.select("title").remove();t.insert("title",":first-child").text(function(t){if(!e.getParent()){return e.getTitle(t)}})};n.prototype._drawGroup=function(t,e){t.enter().append("g").classed(e.getId(),true).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("tabindex",function(t){if(!e.getParent()){return 0}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove();var r=e.getShapes();if(r&&r.length>0){for(var n=0;n<r.length;n++){this._recursiveDraw(t,r[n])}}};n.prototype._drawLine=function(t,e){var r=this;t.enter().append("line").attr("x1",function(t){return e.getX1(t)}).attr("y1",function(t){return e.getY1(t)}).attr("x2",function(t){return e.getX2(t)}).attr("y2",function(t){return e.getY2(t)}).attr("filter",function(t){return e.getFilter(t)}).attr("aria-label",function(t){return e.getAriaLabel(t)}).attr("stroke",function(t){return r.determineValue("stroke",e,t)}).attr("stroke-width",function(t){return e.getStrokeWidth(t)}).attr("stroke-dasharray",function(t){return e.getStrokeDasharray(t)}).attr("fill-Opacity",function(t){return e.getFillOpacity(t)}).attr("transform",function(t){return e.getTransform(t)}).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("tabindex",function(t){if(!e.getParent()){return 0}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove()};n.prototype._drawRect=function(t,e){var r=e.mChartInstance,n=this;t.enter().append("rect").classed(e.getId(),true);t.attr("x",function(t){if(r.getLegendSpace!==undefined){if(sap.ui.getCore().getConfiguration().getRTL()){var n=r.getXDomain(),a=n.length;return r.getScaledLegendWidth()*(a-t.xIndex-1)+r.getLegendSpace()*(a-t.xIndex)}return r.getScaledLegendWidth()*t.xIndex+r.getLegendSpace()*(t.xIndex+1)}return e.getX(t)}).attr("y",function(t){if(r.getLegendSpace!==undefined){return r.getScaledLegendHeight()*t.yIndex+r.getLegendSpace()*(t.yIndex+1)}return e.getY(t)}).attr("width",function(t){return e.getWidth(t)}).attr("height",function(t){return e.getHeight(t)}).attr("fill",function(t){return n.determineValue("fill",e,t)}).attr("rx",function(t){return e.getRx(t)}).attr("ry",function(t){return e.getRy(t)}).attr("filter",function(t){return e.getFilter(t)}).attr("stroke",function(t){return n.determineValue("stroke",e,t)}).attr("stroke-width",function(t){return e.getStrokeWidth(t)}).attr("stroke-dasharray",function(t){return e.getStrokeDasharray(t)}).attr("opacity",function(t){return e.getFillOpacity(t)}).attr("aria-label",function(t){return e.getAriaLabel(t)}).attr("transform",function(t){return e.getTransform(t)}).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove()};n.prototype._drawText=function(t,e){var r=e.mChartInstance,n=this;t.enter().append("text").attr("x",function(t){if(r.getLegendSpace!==undefined){return r.getScaledLegendWidth()*t.xIndex+r.getLegendSpace()*(t.xIndex+1)}return e.getX(t)}).attr("y",function(t){if(r.getLegendSpace!==undefined){return r.getScaledLegendHeight()*t.yIndex+r.getLegendSpace()*(t.yIndex+1)}return e.getRowYCenter(t)}).attr("text-anchor","middle").attr("font-size",function(t){return e.getFontSize(t)}).attr("fill",function(t){return n.determineValue("fill",e,t)}).attr("filter",function(t){return e.getFilter(t)}).attr("stroke",function(t){return n.determineValue("stroke",e,t)}).attr("stroke-width",function(t){return e.getStrokeWidth(t)}).attr("alignment-baseline","central").attr("font-family",function(t){return e.getFontFamily(t)}).text(e.getText()).attr("transform",function(t){return e.getTransform(t)}).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("tabindex",function(t){if(!e.getParent()){return 0}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove()};n.prototype._drawPath=function(t,e){var r=this;t.enter().append("path").attr("d",function(t){return e.getD(t)}).attr("fill",function(t){return r.determineValue("fill",e,t)}).attr("stroke",function(t){return r.determineValue("stroke",e,t)}).attr("stroke-width",function(t){return e.getStrokeWidth(t)}).attr("stroke-dasharray",function(t){return e.getStrokeDasharray(t)}).attr("opacity",function(t){if(e.getIsClosed()){return e.getFillOpacity(t)}}).attr("filter",function(t){return e.getFilter(t)}).attr("aria-label",function(t){return e.getAriaLabel(t)}).attr("transform",function(t){return e.getTransform(t)}).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("tabindex",function(t){if(!e.getParent()){return 0}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove()};n.prototype._drawImage=function(t,e){var r=e.mChartInstance;t.enter().append("image").attr("xlink:href",function(t){return e.getImage(t)}).attr("x",function(t){if(r.getLegendSpace!==undefined){return r.getScaledLegendWidth()*t.xIndex+r.getLegendSpace()*(t.xIndex+1)}return e.getX(t)}).attr("y",function(t){if(r.getLegendSpace!==undefined){return r.getScaledLegendHeight()*t.yIndex+r.getLegendSpace()*(t.yIndex+1)}return e.getY(t)}).attr("width",function(t){return e.getWidth(t)}).attr("height",function(t){return e.getHeight(t)}).attr("filter",function(t){return e.getFilter(t)}).attr("aria-label",function(t){return e.getAriaLabel(t)}).attr("transform",function(t){return e.getTransform(t)}).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("tabindex",function(t){if(!e.getParent()){return 0}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove()};n.prototype._drawPolygon=function(t,e){var r=this;t.enter().append("polygon").attr("fill",function(t){return r.determineValue("fill",e,t)}).attr("points",function(t){return e.getPoints(t)}).attr("stroke-width",function(t){return e.getStrokeWidth(t)}).attr("stroke",function(t){return r.determineValue("stroke",e,t)}).attr("filter",function(t){return e.getFilter(t)}).attr("aria-label",function(t){return e.getAriaLabel(t)}).attr("transform",function(t){return e.getTransform(t)}).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("tabindex",function(t){if(!e.getParent()){return 0}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove()};n.prototype._drawPolyline=function(t,e){var r=this;t.enter().append("polyline").attr("fill",function(t){return r.determineValue("fill",e,t)}).attr("points",function(t){return e.getPoints(t)}).attr("stroke-width",function(t){return e.getStrokeWidth(t)}).attr("stroke",function(t){return r.determineValue("stroke",e,t)}).attr("filter",function(t){return e.getFilter(t)}).attr("aria-label",function(t){return e.getAriaLabel(t)}).attr("transform",function(t){return e.getTransform(t)}).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("tabindex",function(t){if(!e.getParent()){return 0}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove()};n.prototype._drawCircle=function(t,e){var r=e.mChartInstance,n=this;t.enter().append("circle").attr("fill",function(t){return n.determineValue("fill",e,t)}).attr("stroke-width",function(t){return e.getStrokeWidth(t)}).attr("stroke",function(t){return n.determineValue("stroke",e,t)}).attr("filter",function(t){return e.getFilter(t)}).attr("aria-label",function(t){return e.getAriaLabel(t)}).attr("cx",function(t){if(r.getLegendSpace!==undefined){return r.getScaledLegendWidth()*(t.xIndex+.5)+r.getLegendSpace()*(t.xIndex+1)}return e.getCx(t)}).attr("cy",function(t){if(r.getLegendSpace!==undefined){return r.getScaledLegendHeight()*(t.yIndex+.5)+r.getLegendSpace()*(t.yIndex+1)}return e.getCy(t)}).attr("r",function(t){return e.getR(t)}).attr("transform",function(t){return e.getTransform(t)}).attr("role",function(t){if(!e.getParent()){return"tooltip"}}).attr("focusable",function(t){if(!e.getParent()){return true}}).attr("tabindex",function(t){if(!e.getParent()){return 0}}).attr("aria-label",function(t){if(!e.getParent()){return e.getAriaLabel(t)}});t.exit().remove()};n.prototype.determineValue=function(t,e,n){var a=null;if(t==="fill"){a=e.getFill(n)}else if(t==="stroke"){a=e.getStroke(n)}return r.ValueSVGPaintServer.normalize(a)};return n},true);
//# sourceMappingURL=Legend.js.map