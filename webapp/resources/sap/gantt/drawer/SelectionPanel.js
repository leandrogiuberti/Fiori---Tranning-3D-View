/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/drawer/Drawer","sap/ui/core/Lib","sap/ui/core/IconPool","sap/ui/Device","sap/gantt/utils/GanttChartConfigurationUtils","sap/ui/thirdparty/d3"],function(t,e,n,a,r){"use strict";var i=t.extend("sap.gantt.drawer.SelectionPanel");i.prototype.drawSvg=function(t,e,n,a){if(!e){return}this._oGanttChartWithTable=a;var r=[];for(var i=0;i<e.length;i++){if(e[i].index&&e[i].index!==0){r.push(e[i])}}var o=t.selectAll(".sapGanttSelectionPanel");if(o.empty()){o=t.append("g").classed("sapGanttSelectionPanel",true)}if(!o.empty()){var d=jQuery(t.node()).width();var c=a._oGanttChart._composeChartSchemeBackgroundConfig();this._drawExpandedBackground(o,d,n,r,c);this._drawExpandedContent(o,d,n,r)}};i.prototype._drawExpandedBackground=function(t,e,n,a,i){var o=t.selectAll(".sapGanttExpandChartHeader").data(a);o.enter().append("rect").classed("sapGanttExpandChartHeader",true);o.attr("x",function(){return r.getRTL()?e-n+1:2}).attr("y",function(t){return t.y}).attr("height",function(t){return t.rowHeight-1}).attr("width",n-2).attr("class",function(t){var e=i?i[t.chartScheme]:undefined;if(e&&e!==""){return"sapGanttExpandChartHeader "+e}else{return"sapGanttExpandChartHeader sapGanttExpandChartHeaderBG"}});o.exit().remove();var d=t.selectAll(".sapGanttExpandChartCnt").data(a);d.enter().append("rect").classed("sapGanttExpandChartCnt",true);d.attr("x",function(){return r.getRTL()?2:n+1}).attr("y",function(t){return t.y}).attr("height",function(t){return t.rowHeight-1}).attr("width",e-n-3).attr("class",function(t){var e=i?i[t.chartScheme]:undefined;if(e&&e!==""){return"sapGanttExpandChartCnt "+e}else{return"sapGanttExpandChartCnt sapGanttExpandChartCntBG"}});d.exit().remove();var c=t.selectAll("path.sapGanttExpandChartLine").data(a);c.enter().append("path").classed("sapGanttExpandChartLine",true);c.attr("d",function(t){return"M0 "+(t.y-1)+" H"+(e-1)});c.exit().remove()};i.prototype._drawExpandedContent=function(t,i,o,d){var c=this._getLevelIndentByShape;var u=[];for(var s=0;s<d.length;s++){if(d[s].index===1){var p=[];p.push(d[s]);u.push(p)}}t.selectAll("g").remove();var l=t.selectAll("g").data(u);l.enter().append("g").classed("sapGanttExpandChartContent",true);l.exit().remove();var f=l.selectAll(".sapGanttExpandChartIcon").data(function(t){return t});f.enter().append(function(t){if(n.isIconURI(t.icon)){return document.createElementNS(d3.ns.prefix.svg,"text")}return document.createElementNS(d3.ns.prefix.svg,"image")}).classed("sapGanttExpandChartIcon",true).classed("iconFont",function(t){return n.isIconURI(t.icon)}).classed("iconImage",function(t){return!n.isIconURI(t.icon)});l.selectAll(".iconImage").attr("xlink:href",function(t){return t.icon}).attr("x",function(t){return r.getRTL()?i-o-c(t)-17:c(t)+o}).attr("y",function(t){return t.y+4.25}).attr("width",16).attr("height",16);l.selectAll(".iconFont").attr("x",function(t){return r.getRTL()?i-o-c(t):c(t)+o}).attr("y",function(t){return t.y+19}).text(function(t){var e=n.getIconInfo(t.icon);if(e){return e.content}}).attr("font-family",function(t){var e=n.getIconInfo(t.icon);if(e){return e.fontFamily}}).attr("font-size","16px");f.exit().remove();var h=l.selectAll("sapGanttExpandChartText").data(function(t){return t});h.enter().append("text").classed("sapGanttExpandChartText",true);h.attr("x",function(t){return r.getRTL()?i-o-c(t)-26:c(t)+o+27}).attr("y",function(t){return t.y+16.5}).attr("font-size",function(t){return"0.75em"}).text(function(t){return t.name}).attr("text-anchor",a.browser.edge&&r.getRTL()?"end":"start");h.exit().remove();var x=this;var g=l.selectAll(".sapGanttExpandChartCloseButton").data(function(t){return t});g.enter().append("text").classed("sapGanttExpandChartCloseButton",true);g.attr("x",function(t){var e,n=jQuery(this).prev("text");if(n&&n.length>0){var a=n[0].getBoundingClientRect();if(a&&a.width>0){e=a.width}else{e=n[0].clientWidth}}if(isNaN(e)||e==null||e==0){e=60}var d=r.getRTL()?i-o-c(t)-e-37:c(t)+o+e+35;return d}).attr("y",function(t){return t.y+19}).text(function(t){var e=n.getIconInfo("decline",undefined);if(e){return e.content}}).attr("font-family",function(t){var e=n.getIconInfo("decline",undefined);if(e){return e.fontFamily}}).attr("font-size","14px").attr("font-weight","bolder").on("click",function(t){var e=x._oGanttChartWithTable._oTT.getBinding("rows");var n=e.getContexts(0,e.getLength());var a=x._oGanttChartWithTable.getRowIdName();for(var r=0;r<n.length;r++){var i=n[r].getProperty();if(i&&t.id&&i[a]===t.id){x._oGanttChartWithTable.handleExpandChartChange(false,[t.chartScheme],[r])}}});g.select("title").remove();g.insert("title",":first-child").text(function(t){var n=e.getResourceBundleFor("sap.gantt");return n.getText("TLTP_CLOSE")});g.exit().remove()};i.prototype._getLevelIndentByShape=function(t){var e=13;var n=17;var a=25;var r=0;if(t&&t.bindingObj&&t.bindingObj._aRowIndexMap&&t.rowIndex&&t.rowIndex<t.bindingObj._aRowIndexMap.length){r=t.bindingObj._aRowIndexMap[t.rowIndex].level}if(isNaN(r)||r==null){r=0}return n*r+a+e};return i},true);
//# sourceMappingURL=SelectionPanel.js.map