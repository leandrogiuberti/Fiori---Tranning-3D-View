/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/base/assert","sap/base/util/array/uniqueSort","sap/base/util/uid","sap/gantt/misc/Format","sap/gantt/library","sap/gantt/config/TimeHorizon","sap/base/Log","sap/base/i18n/date/TimezoneUtils","sap/gantt/utils/GanttChartConfigurationUtils"],function(e,t,a,n,i,r,o,u,s){"use strict";var f={};f.assign=function(e,t){if(typeof e!==typeof t){return t}else if(typeof e==="undefined"||e===null){return t}else{return e}};f.assignDeep=function(e,t){if(!e&&!t){return null}else if(e&&!t){return e}else if(!e&&t){return t}else if(typeof e==="object"&&typeof t==="object"){var a=e;for(var n in t){if(typeof a[n]!=="boolean"&&!a[n]){a[n]=t[n]}else if(typeof t[n]==="object"&&typeof a[n]==="object"){a[n]=this.assignDeep(a[n],t[n])}}return a}else{return e}};f.generateRowUid=function(e,t,n,i,r){jQuery.each(e,function(e,t){t.uid=t.id;if(i){t.uid=i+"|"+t.uid}else if(t.bindingObj&&t.bindingObj.findNode){var o=t.bindingObj.findNode(t.rowIndex);while(o.parent&&o.level>0){o=o.parent;t.uid=o.context.getObject()[r]+"|"+t.uid}}var u=t.index===undefined?-1:t.index;var s=t.chartScheme===undefined?"":t.chartScheme;t.uid="PATH:"+t.uid+"|SCHEME:"+s+"["+u+"]";t.data.uid=t.uid;for(var f=0;f<n.length;f++){var d,c;if(typeof n[f]==="string"){d=n[f];c="id"}else{d=n[f].name;c=n[f].idName?n[f].idName:"id"}if(d in t.data){for(var g=0;g<t.data[d].length;g++){var l=t.data[d][g];if(l[c]===undefined){l[c]=a()}l.uid=t.uid+"|DATA:"+d+"["+l[c]+"]";l.__id__=l[c]}}}})};f.getChartSchemeByShapeUid=function(e){return f.parseUid(e).chartScheme||""};f.generateUidForRelationship=function(e,t){var n="relationship";var i="PATH:DUMMY|SCHEME:DUMMY[0]";for(var r=0;r<e.length;r++){if(e[r][t]===undefined){e[r][t]=a()}e[r].uid=i+"|DATA:"+n+"["+e[r][t]+"]";e[r].__id__=e[r][t]}};f.generateObjectPathToObjectMap=function(e,t,a){var n;for(var i in e){var r=e[i],o,u;if(r.objectInfoRef){o=r.objectInfoRef.id;r=r.objectInfoRef}else{o=r.id}if(a&&a!=""){o=a.concat(".").concat(o)}u=o.concat("-").concat(f.parseUid(r.uid).rowIndex);t[u]=r;if(r.children&&r.children.length>0){n=this.generateObjectPathToObjectMap(r.children,t,o)}}return n};f.getShapeDataNameByUid=function(e){return f.parseUid(e).shapeDataName};f.getIdByUid=function(e,t){return t?f.parseUid(e).rowId:f.parseUid(e).shapeId};f.parseUid=function(e){var t=/(PATH:(.+)\|SCHEME:(.*?\[-?\d+\]))(?:\|DATA:(.+)\[(.*)\])?$/g;var a=t.exec(e);var n={};if(a){var i=a[3];if(i){var r=i.match(/\[-?\d+\]/)[0].slice(1,-1);i=i.replace(/\[-?\d+\]/,"")}var u=a[1],s=a[2],f=s.split("|"),d=f[f.length-1];n={rowId:d,rowPath:s,rowUid:u,chartScheme:i,shapeDataName:a[4],shapeId:a[5],rowIndex:r}}else{o.warning("UID "+e+" does not match regular expression.")}return n};f.scaleBySapUiSize=function(e,t){switch(e){case"sapUiSizeCozy":return t*1.5;case"sapUiSizeCondensed":return t*.78;default:return t}};f.findSapUiSizeClass=function(){if(document.body.classList.contains("sapUiSizeCondensed")){return"sapUiSizeCondensed"}else if(document.body.classList.contains("sapUiSizeCompact")){return"sapUiSizeCompact"}else if(document.body.classList.contains("sapUiSizeCozy")){return"sapUiSizeCozy"}else{return"sapUiSizeCozy"}};f.floatEqual=function(e,t){return Math.abs(e-t)<1e-4};f.calculateStringLength=function(e){var t=0;if(e.match("[一-鿿]")===null){t=e.length}else{t=e.length+e.match(/[\u4E00-\u9FFF]/g).length}return t};f.judgeTimeHorizonValidity=function(e,t){if(!e||!e.getStartTime()||!e.getEndTime()){return false}var a=n.abapTimestampToDate(e.getStartTime()).getTime(),i=n.abapTimestampToDate(e.getEndTime()).getTime(),r=n.abapTimestampToDate(t.getStartTime()).getTime(),o=n.abapTimestampToDate(t.getEndTime()).getTime();return a-r>=0&&o-i>=0};f.getShapeDatumById=function(e,t){return f.getDatumById(e,"sap-gantt-shape-id",t)};f.getRowDatumById=function(e,t){return f.getDatumById(e,"sap-gantt-row-id",t)||[]};f.getRowDatumRefById=function(e,t){return f.getRowDatumById(e,t).map(function(e){return e.objectInfoRef})};f.getRowDatumByShapeUid=function(e,t){var a=this.parseUid(e),n=a.rowUid,i=a.rowId;var r=null;var o=this.getRowDatumById(i,t);var u=o.filter(function(e){return e.objectInfoRef.uid.indexOf(n)>=0});if(u.length>0){r=u[0].objectInfoRef}return r};f.getShapeDatumByShapeUid=function(e,t){var a=this.parseUid(e),n=a.shapeId,i=a.rowUid;var r=this.getShapeDatumById(n,t);var o=r.filter(function(e){return e.uid.indexOf(i)>=0});return o[0]};f.getRowDatumByEventTarget=function(e){var t=null;var a=jQuery(e).closest("g[data-sap-gantt-row-id]");if(a.length){t=d3.select(a.get(0)).datum()}return t};f.getDatumById=function(a,n,i){e(typeof a==="string"||a instanceof Array,"vId must be string or array");e(i,"sContainer must specify");var r=a?a:"";var o=r;if(typeof r==="string"){o=[r]}var u=[];o.forEach(function(e){var t=["[id='",i,"']"," [data-",n,"='",e,"']"].join("");jQuery(t).each(function(e,t){var a=d3.select(t),n=a.datum();var i=u.some(function(e){var t=e.uid||e.objectInfoRef.uid,a=n.uid||n.objectInfoRef.uid;if(t!==a){return false}else{var i=e.shapeData?e.shapeData.length:0;var r=n.shapeData?n.shapeData.length:0;return i===r}});if(!i){u.push(n)}})});return t(u)};f.attributeEqualSelector=function(e,t){return"["+e+"="+"'"+t+"'"+"]"};f.calculateHorizonByWidth=function(e,t,a,i){var o=n.abapTimestampToDate(e.getStartTime());var u=n.abapTimestampToDate(e.getEndTime());var s=Math.abs(o.getTime()-u.getTime())/t;var f;if(i){f=i}else{f=o}var d=new Date;if(isFinite(s)&&typeof s==="number"&&isFinite(a)&&typeof a==="number"){d.setTime(f.getTime()+a*s)}else{d=u}return new r({startTime:f,endTime:d})};f.safeCall=function(e,t,a,n){var i=e;for(var r=0;r<t.length;r++){var o=t[r];if(!i||typeof i[o]!=="function"){return a}else if(r<t.length-1){i=i[o]()}else{i=i[o].apply(i,n)}}return i};f.getShapeBias=function(e){var t=s.getRTL(),a=t?-e.getXBias():e.getXBias(),n=e.getYBias();return{x:a,y:n}};f.getLowerCaseLabel=function(e){if(i.config.TIME_PATTERN_LOWERCASE){var t=e.replaceAll("AM","am");return t.replaceAll("PM","pm")}else{return e}};f.getFormattedDate=function(e,t){var a=u.getLocalTimezone();return e.format(t,a)};f.isNumeric=function(e){var t=typeof e;return(t==="number"||t==="string")&&e-parseFloat(e)+1>=0};f.getNonDSTOffsetInfo=function(e,t){var a=t.getFullYear();var n=new Date(a,0,1);var i=new Date(a,6,1);var r=n;var o=f.getTimezoneOffset(e,new Date(a,0,1));var u=f.getTimezoneOffset(e,new Date(a,6,1));if(o>u){r=i}return{utcOffset:Math.min(o,u)*6e4,offset:r.getTime()-new Date(r.toLocaleString("en-US",{timeZone:e})).getTime(),month:o<u?0:6}};f.getTimezoneOffset=function(e,t){var a=new Date(t.toLocaleString("en-US",{timeZone:e}));var n=new Date(t.toLocaleString("en-US",{timeZone:"UTC"}));return Math.round((a.getTime()-n.getTime())/(60*1e3))};f.getNextWeekday=function(e,t){const a=new Date(e.getTime());const n=a.getDay();const i=(t+7-n)%7;a.setDate(a.getDate()+i);return a};return f},true);
//# sourceMappingURL=Utility.js.map