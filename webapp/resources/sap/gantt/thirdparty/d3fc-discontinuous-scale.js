/*
 * d3fc-discontinuous-scale 4.1.0 <https://www.npmjs.com/package/@d3fc/d3fc-discontinuous-scale>
 * Copyright (c) 2015-2019 Scott Logic Ltd.
 * Released under MIT License
 */
(function(t,e){typeof exports==="object"&&typeof module!=="undefined"?e(exports,require("d3-scale"),require("@d3fc/d3fc-rebind"),require("d3-time")):typeof define==="function"&&define.amd?define(["exports","d3-scale","@d3fc/d3fc-rebind","d3-time"],e):(t=typeof globalThis!=="undefined"?globalThis:t||self,e(t.fc=t.fc||{},t.d3,t.fc,sap.ui.require("sap/gantt/polyfills/lib").time))})(this,function(t,e,n,r){"use strict";function a(){var t={};t.distance=function(t,e){return e-t};t.offset=function(t,e){return t instanceof Date?new Date(t.getTime()+e):t+e};t.clampUp=function(t){return t};t.clampDown=function(t){return t};t.copy=function(){return t};return t}function i(t,e){if("tickFilter"in e){return e.tickFilter(t)}var n=t.map(e.clampUp);if(n.length!==new Set(n.map(function(t){return t===null||t===void 0?void 0:t.valueOf()})).size){console.warn("There are multiple ticks that fall within a discontinuity, which has led to them being rendered on top of each other. Consider using scale.ticks to explicitly specify the ticks for the scale.")}return n}function o(t){var r=this;if(!arguments.length){t=e.scaleIdentity()}var u=a();var f=function e(n){var r=t.domain();var a=t.range();var i=u.distance(r[0],r[1]);var o=u.distance(r[0],n);var f=o/i;var c=f*(a[1]-a[0])+a[0];return c};f.invert=function(e){var n=t.domain();var r=t.range();var a=(e-r[0])/(r[1]-r[0]);var i=u.distance(n[0],n[1]);var o=a*i;return u.offset(n[0],o)};f.domain=function(){if(!arguments.length){return t.domain()}var e=arguments.length<=0?undefined:arguments[0];var n=u.clampUp(e[0]);var r=u.clampDown(e[1]);t.domain([n,r]);return f};f.nice=function(){t.nice();var e=t.domain();var n=u.clampUp(e[0]);var r=u.clampDown(e[1]);t.domain([n,r]);return f};f.ticks=function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++){n[a]=arguments[a]}var o=t.ticks.apply(r,n);return i(o,u)};f.copy=function(){return o(t.copy()).discontinuityProvider(u.copy())};f.discontinuityProvider=function(){if(!arguments.length){return u}u=arguments.length<=0?undefined:arguments[0];return f};n.rebindAll(f,t,n.include("range","rangeRound","interpolate","clamp","tickFormat"));return f}var u=function t(e,n,r,a){var i={sunday:0,monday:1,saturday:6};var o=24*3600*1e3;var u=o*5;var f=o*7;var c={};var s=function t(n){return e(n)===0||e(n)===6};c.clampDown=function(t){if(t&&s(t)){var r=n.ceil(t);if(e(r)===i.sunday){return n.offset(r,-1)}else if(e(r)===i.monday){return n.offset(r,-2)}else{return r}}else{return t}};c.clampUp=function(t){if(t&&s(t)){var r=n.floor(t);if(e(r)===i.saturday){return n.offset(r,2)}else if(e(r)===i.sunday){return n.offset(r,1)}else{return r}}else{return t}};c.distance=function(t,e){t=c.clampUp(t);e=c.clampDown(e);var n=r.ceil(t);if(e<n){return e.getTime()-t.getTime()}var a=n.getTime()-t.getTime();var i=r.ceil(e);var o=i.getTime()-e.getTime();var s=Math.round((i.getTime()-n.getTime())/f);return s*u+a-o};c.offset=function(t,e){var i=s(t)?c.clampUp(t):t;if(e===0){return i}var o=e<0;var f=e>0;var l=e;var d=o?a.floor(i):r.ceil(i);l-=d.getTime()-i.getTime();if(o&&l>0||f&&l<0){return new Date(i.getTime()+e)}i=o?d:n.offset(d,2);var v=Math.floor(l/u);i=n.offset(i,v*7);l-=v*u;i=new Date(i.getTime()+l);return i};c.copy=function(){return c};return c};var f=function(){return u(function(t){return t.getDay()},r.timeDay,r.timeSaturday,r.timeMonday)};var c=function(){return u(function(t){return t.getUTCDay()},r.utcDay,r.utcSaturday,r.utcMonday)};function s(t){"@babel/helpers - typeof";if(typeof Symbol==="function"&&typeof Symbol.iterator==="symbol"){s=function(t){return typeof t}}else{s=function(t){return t&&typeof Symbol==="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t}}return s(t)}function l(t,e){return d(t)||v(t,e)||m(t,e)||g()}function d(t){if(Array.isArray(t))return t}function v(t,e){if(typeof Symbol==="undefined"||!(Symbol.iterator in Object(t)))return;var n=[];var r=true;var a=false;var i=undefined;try{for(var o=t[Symbol.iterator](),u;!(r=(u=o.next()).done);r=true){n.push(u.value);if(e&&n.length===e)break}}catch(t){a=true;i=t}finally{try{if(!r&&o["return"]!=null)o["return"]()}finally{if(a)throw i}}return n}function m(t,e){if(!t)return;if(typeof t==="string")return y(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor)n=t.constructor.name;if(n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return y(t,e)}function y(t,e){if(e==null||e>t.length)e=t.length;for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function g(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function p(t,e){var n;if(typeof Symbol==="undefined"||t[Symbol.iterator]==null){if(Array.isArray(t)||(n=m(t))||e&&t&&typeof t.length==="number"){if(n)t=n;var r=0;var a=function(){};return{s:a,n:function(){if(r>=t.length)return{done:true};return{done:false,value:t[r++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i=true,o=false,u;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();i=t.done;return t},e:function(t){o=true;u=t},f:function(){try{if(!i&&n.return!=null)n.return()}finally{if(o)throw u}}}}var T=function t(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++){n[r]=arguments[r]}var a=function t(e,n){return e>n[0]&&e<n[1]};var i=function t(e,n){return e[0]>=n[0]&&e[1]<=n[1]};var o={};o.distance=function(t,e){t=o.clampUp(t);e=o.clampDown(e);var r=n.filter(function(n){return i(n,[t,e])});var a=r.map(function(t){return t[1]-t[0]});return e-t-a.reduce(function(t,e){return t+e},0)};var u=function t(e,n){return e instanceof Date?new Date(e.getTime()+n):e+n};o.offset=function(t,e){if(e>0){var r=function(){var r=o.clampUp(t);var a=e;while(a>0){var i=n.filter(function(t){return t[0]>r}).sort(function(t,e){return t[0]-e[0]});if(i.length){var f=i[0];var c=f[0]-r;if(c>a){r=u(r,a);a=0}else{r=f[1];a-=c}}else{r=u(r,a);a=0}}return{v:r}}();if(s(r)==="object")return r.v}else{var a=function(){var r=o.clampDown(t);var a=e;while(a<0){var i=n.filter(function(t){return t[1]<r}).sort(function(t,e){return e[0]-t[0]});if(i.length){var f=i[0];var c=f[1]-r;if(c<a){r=u(r,a);a=0}else{r=f[0];a-=c}}else{r=u(r,a);a=0}}return{v:r}}();if(s(a)==="object")return a.v}};o.clampUp=function(t){return n.reduce(function(t,e){return a(t,e)?e[1]:t},t)};o.clampDown=function(t){return n.reduce(function(t,e){return a(t,e)?e[0]:t},t)};o.copy=function(){return o};return o};var h=24*3600*1e3;var w="00:00:00.000";var D="SOD";var b="EOD";function I(t){if(arguments.length!==1||typeof t!=="string"){throw"Expected single argument of type string"}var e=function t(e,n){if(!Number.isInteger(e))return false;return e>=0&&e<=n};var n=[0,0,0,0];var r=t.split(":");if(r.length<2||r.length>3){throw"Expected an argument wiht 2 or 3 colon delimited parts."}n[0]=e(parseInt(r[0],10),23)?parseInt(r[0],10):function(){throw"'Hours' component must be an int between 0 and 23, but was '".concat(r[0],"'")}();n[1]=e(parseInt(r[1],10),59)?parseInt(r[1],10):function(){throw"'Minutes' component must be an int between 0 and 59, but was '".concat(r[1],"'")}();if(r.length===3){var a=r[2].split(".").map(function(t){return parseInt(t,10)});n[2]=e(a[0],59)?a[0]:function(){throw"'Seconds' component must be an int between 0 and 59, but was '".concat(a[0],"'")}();if(a.length===2){n[3]=e(a[1],999)?a[1]:function(){throw"'Miliseconds' component must be an int between 0 and 999, but was '".concat(a[1],"'")}()}}return"".concat(n[0].toString(10).padStart(2,"0"),":").concat(n[1].toString(10).padStart(2,"0"),":").concat(n[2].toString(10).padStart(2,"0"),".").concat(n[3].toString(10).padStart(3,"0"))}function S(t,e){if(arguments.length!=2||!Array.isArray(t)||t.length!==2||typeof t[0]!=="string"||typeof t[1]!=="string"){throw"Expected argument is a single string[] of length 2."}if(t[0]===D){t[0]=w}if(t[1]===b){t[1]=w}var n=I(t[0]);var r=I(t[1]);if(r!==w&&n>r){throw"Time range start time '".concat(n,"' must be before end time '").concat(r,"' or both must equal ").concat(w)}var a=e.setTime(new Date(r===w?h:0),r)-e.setTime(new Date(0),n);var i={startTime:n,endTime:r,lenghtInMs:a};i.isInRange=function(t){var n=e.getTimeString(t);if(i.startTime<=n&&(i.endTime===w||i.endTime>n)){return true}return false};return i}var M=function t(e,n){var r=e.map(function(t){return S(t,n)}).sort(function(t,e){return t.startTime<e.startTime?-1:t.startTime>e.startTime?1:0});var a=h-r.reduce(function(t,e){return t+e.lenghtInMs},0);var i=function t(e,a){if(e.getTime()===a.getTime()){return 0}if(n.dayInterval(e).getTime()!==n.dayInterval(a).getTime()&&n.getStartOfNextDay(e).getTime()!==a.getTime()){throw"tradingDay.totalTradingMillisecondsBetween arguments must be on the same day or intervalEnd must be the start of the next day instead: intervalStart: '".concat(e,"'; intervalEnd: '").concat(a,"'")}var i=0;var o=r.filter(function(t){return t.endTime===w||n.setTime(e,t.endTime)>=e});var u=p(o),f;try{for(u.s();!(f=u.n()).done;){var c=f.value;var s=n.setTime(e,c.startTime);var l=c.endTime===w?n.getStartOfNextDay(e):n.setTime(e,c.endTime);if(e<s&&a<s){return i+n.msInterval.count(e,a)}if(e<s){i+=n.msInterval.count(e,s)}if(a<l){return i}e=l}}catch(t){u.e(t)}finally{u.f()}return i+n.msInterval.count(e,a)};var o=function t(e,a){if(a===0){return[e,a]}var i=n.msInterval.offset(e,a);var o=a>0?r.filter(function(t){return n.setTime(e,t.startTime)>=e}):r.filter(function(t){return n.setTime(e,t.startTime)<e}).reverse();if(o.length===0){return[n.msInterval.offset(e,a),0]}if(a>0){var u=p(o),f;try{for(u.s();!(f=u.n()).done;){var c=f.value;var s=n.setTime(e,c.startTime);if(s<=i){a-=n.msInterval.count(e,s);e=c.endTime===w?n.getStartOfNextDay(e):n.setTime(e,c.endTime);i=n.msInterval.offset(e,a)}}}catch(t){u.e(t)}finally{u.f()}a-=n.msInterval.count(e,i)}else{var l=p(o),d;try{for(l.s();!(d=l.n()).done;){var v=d.value;var m=v.endTime===w?n.getStartOfNextDay(e):n.setTime(e,v.endTime);if(i<m){a+=n.msInterval.count(m,e)+1;e=n.msInterval.offset(n.setTime(e,v.startTime),-1);i=n.msInterval.offset(e,a)}}}catch(t){l.e(t)}finally{l.f()}a+=n.msInterval.count(i,e)}if(a!==0){throw"tradingDay.offset was called with an offset that spans more than a day"}return[i,a]};return{totalTradingTimeInMiliseconds:a,nonTradingTimeRanges:r,totalTradingMillisecondsBetween:i,offset:o}};var U=function t(e,n,r,a,i){var o={};o.getTimeComponentArrayFromString=function(t){return[t.slice(0,2),t.slice(3,5),t.slice(6,8),t.slice(9,12)]};o.getTimeString=function(t){var e=r(t).map(function(t){return t.toString(10).padStart(2,"0")}),n=l(e,4),a=n[0],i=n[1],o=n[2],u=n[3];return"".concat(a,":").concat(i,":").concat(o,".").concat(u.padStart(3,"0"))};o.setTime=function(t,n){var r=arguments.length>2&&arguments[2]!==undefined?arguments[2]:0;var a=o.getTimeComponentArrayFromString(n),u=l(a,4),f=u[0],c=u[1],s=u[2],d=u[3];return i.offset(e(t,f,c,s,d),r)};o.getStartOfNextDay=function(t){return a.offset(a.floor(t),1)};o.getEndOfPreviousDay=function(t){return i.offset(a.floor(t),-1)};o.dayInterval=a;o.msInterval=i;o.getDay=n;return o};var k=U(function(t,e,n,r,a){return new Date(t.getFullYear(),t.getMonth(),t.getDate(),e,n,r,a)},function(t){return t.getDay()},function(t){return[t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()]},r.timeDay,r.timeMillisecond);var x=function t(e,n){var a=function t(n){return e[n]===undefined?[]:e[n]};var i=[M(a("Sunday"),n),M(a("Monday"),n),M(a("Tuesday"),n),M(a("Wednesday"),n),M(a("Thursday"),n),M(a("Friday"),n),M(a("Saturday"),n)];var o=i.reduce(function(t,e){return t+e.totalTradingTimeInMiliseconds},0);if(o===0){throw"Trading pattern must yield at least 1 ms of trading time"}var u={tradingDays:i,totalTradingWeekMilliseconds:o};u.clampUp=function(t){var e=i[n.getDay(t)];var r=p(e.nonTradingTimeRanges),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;if(o.isInRange(t)){return o.endTime===w?u.clampUp(n.getStartOfNextDay(t)):n.setTime(t,o.endTime)}}}catch(t){r.e(t)}finally{r.f()}return t};u.clampDown=function(t){var e=i[n.getDay(t)];var r=p(e.nonTradingTimeRanges),a;try{for(r.s();!(a=r.n()).done;){var o=a.value;if(o.isInRange(t)){return o.startTime===w?u.clampDown(n.getEndOfPreviousDay(t)):n.setTime(t,o.startTime,-1)}}}catch(t){r.e(t)}finally{r.f()}return t};u.distance=function(t,e){if(t.getTime()===e.getTime()){return 0}var a=t<=e?[t,e,1]:[e,t,-1],i=l(a,3),o=i[0],f=i[1],c=i[2];if(n.dayInterval(o).getTime()===n.dayInterval(f).getTime()){return c*u.tradingDays[n.getDay(o)].totalTradingMillisecondsBetween(o,f)}var s=u.tradingDays[n.getDay(o)].totalTradingMillisecondsBetween(o,n.dayInterval.offset(n.dayInterval(o),1))+u.tradingDays[n.getDay(f)].totalTradingMillisecondsBetween(n.dayInterval(f),f);if(r.dayCount(o,f)===1){return c*s}o=n.dayInterval.offset(n.dayInterval(o),1);f=n.dayInterval(f);return c*n.dayInterval.range(o,f).reduce(function(t,e,r,a){var i=r<a.length-1?a[r+1]:n.dayInterval.offset(e,1);var o=i-e!==h;var f=u.tradingDays[n.getDay(e)];return t+=o?f.totalTradingMillisecondsBetween(e,i):f.totalTradingTimeInMiliseconds},s)};u.offset=function(t,e){e=Math.floor(e);t=e>=0?u.clampUp(t):u.clampDown(t);var r=function t(e){return n.dayInterval.offset(e)-n.dayInterval(e)!==h};var a=function t(e,r,a){if(a<0){var i=n.dayInterval(r);var o=e.totalTradingMillisecondsBetween(i,r);return Math.abs(a)<=o?e.offset(r,a):[u.clampDown(n.msInterval.offset(i,-1)),a+o+1]}else{var f=n.getStartOfNextDay(r);var c=e.totalTradingMillisecondsBetween(r,f);return a<c?e.offset(r,a):[u.clampUp(f),a-c]}};if(e===0)return t;var i=e<0?function(t,e,r){return[u.clampDown(n.dayInterval.offset(t,-1)),e+r]}:function(t,e,r){return[u.clampUp(n.dayInterval.offset(t)),e-r]};var o=u.tradingDays[n.getDay(t)];var f=a(o,t,e);var c=l(f,2);t=c[0];e=c[1];while(e!==0){o=u.tradingDays[n.getDay(t)];if(r(t)){var s=a(o,t,e);var d=l(s,2);t=d[0];e=d[1]}else{var v=Math.abs(e)>=o.totalTradingTimeInMiliseconds?i(t,e,o.totalTradingTimeInMiliseconds):a(o,t,e);var m=l(v,2);t=m[0];e=m[1]}}return t};u.copy=function(){return u};return u};var O=function(t){return x(t,k)};var A=U(function(t,e,n,r,a){return new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),e,n,r,a))},function(t){return t.getUTCDay()},function(t){return[t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()]},r.utcDay,r.utcMillisecond);var C=function(t){return x(t,A)};t.discontinuityIdentity=a;t.discontinuityRange=T;t.discontinuitySkipUtcWeekends=c;t.discontinuitySkipUtcWeeklyPattern=C;t.discontinuitySkipWeekends=f;t.discontinuitySkipWeeklyPattern=O;t.scaleDiscontinuous=o;Object.defineProperty(t,"__esModule",{value:true})});
//# sourceMappingURL=d3fc-discontinuous-scale.js.map