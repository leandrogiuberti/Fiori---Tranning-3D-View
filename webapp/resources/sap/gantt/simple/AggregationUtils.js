/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery"],function(jQuery){"use strict";var e=function(e,t){if(!e||!t){return false}return e.isA(t)};var t={isParentRowSetting:function(e){return e.getParent().isA("sap.gantt.simple.GanttRowSettings")},getParentControlOf:function(t,a){if(e(a,t)){return a}var n=a.getParent(),r;while(n&&e(n,t)===false){n=n.getParent()}r=n;return r},isDeltaLine:function(e){return e.getParent().isA("sap.gantt.simple.DeltaLine")},isLazyAggregation:function(e){var t=e.getParent();if(!t){return false}var a=t.getMetadata().getAggregation(e.sParentAggregationName);return this._hasLazyConfiguration(a)},isAdhocLine:function(e){return e.getParent().isA("sap.gantt.simple.AdhocLine")},isLazy:function(e,t){return Object.keys(this.getLazyAggregations(e)).indexOf(t)!==-1},getLazyAggregations:function(e){return this._filterAggregationBy(e,function(e){return t._hasLazyConfiguration(e)})},getLazyElementsByScheme:function(e,t){var a=this.getLazyAggregations(e);var n=[];Object.keys(a).forEach(function(a){var r=e.getAggregation(a);if(r&&!Array.isArray(r)){r=[r]}if(r&&r.length>0&&t.indexOf(r[0].getScheme())>-1){n.push(r)}});return[].concat.apply([],n)},getNonLazyElementsByScheme:function(e,t){var a=this.getNonLazyAggregations(e);var n=[];Object.keys(a).forEach(function(r){var i=a[r];var g=e.getAggregation(r);if(g&&!Array.isArray(g)){g=[g]}if(g&&g.length>0&&(t.indexOf(g[0].getScheme())>-1||!t.length&&i.appData!==null&&i.appData.sapGanttOrder===1)){n.push(g)}});return[].concat.apply([],n)},_hasLazyConfiguration:function(e){return e.appData&&e.appData.sapGanttLazy===true},getNonLazyAggregations:function(e){return this._filterAggregationBy(e,function(e){return e.appData===null||!e.appData.sapGanttLazy})},getAllNonLazyAggregations:function(e){return this._filterAggregationBy(e,function(e){return e.appData===null||!e.appData.sapGanttLazy},true)},_filterAggregationBy:function(e,t,a){var n=e.getMetadata(),r;if(a||e.isPseudoShape){r=n.getAllAggregations()}else{r=n.getAggregations()}if(e.isPseudoShape&&!r["button"]){r["button"]=n.getAllPrivateAggregations()["button"]}if(e.isA("sap.gantt.simple.GanttRowSettings")&&!r["pseudoShapes"]){r["pseudoShapes"]=n.getAllPrivateAggregations()["pseudoShapes"]}var i={};for(var g in r){if(r.hasOwnProperty(g)){var s=r[g];if(s.type!="sap.ui.core.dnd.DragDropBase"&&t(s)){i[g]=s}}}return i},_isLabelText:function(e){return e.isA("sap.gantt.simple.BaseText")&&e.getIsLabel()?true:false},_isLabelEnabled:function(){return this.oGantt&&this.oGantt.getSelectOnlyGraphicalShape()?true:false},eachNonLazyAggregation:function(e,t){var a=[],n=[];this.oGantt=e.getGanttChartBase();var r=this.getNonLazyAggregations(e);var i=Object.keys(r).sort(function(e,t){var a=r[e].appData?r[e].appData.sapGanttOrder||0:0;var n=r[t].appData?r[t].appData.sapGanttOrder||0:0;return a-n});i.forEach(function(i){var g=r[i];var s=e[g._sGetter]();if(Array.isArray(s)){s.forEach(function(e){if(this._isLabelEnabled()){if(e.getVisible()&&e.renderElement){if(this._isLabelText(e)){n.push(e)}else{a.push(e)}}}else{t(e)}}.bind(this))}else if(s){if(this._isLabelEnabled()){if(s.getVisible()&&s.renderElement){if(this._isLabelText(s)){n.push(s)}else{a.push(s)}}}else{t(s)}}}.bind(this));if(a.length>0||n.length>0){t(n,a)}},_fetchOverlayAggregation:function(e,t,a,n){if(!e._overlayShapeIdList){e._overlayShapeIdList={}}var r=[],i=[],g=e.getMetadata().getAllAggregations();Object.keys(g).forEach(function(t){var g=e.getAggregation(t);r=a?[]:r;if(t.indexOf("overlay")!==-1&&g&&g[0]){var s=g[0].getActiveOverlays()||[];s.forEach(function(t){var a=t.getShape();var i=t.getOverlayShapeId();if(i){e._overlayShapeIdList[i]=i}if(!n.length||n.indexOf(a.getScheme())>-1){r.push(a)}});i.push(r)}});return a?i:r},_addLevelAndUpdateMaxLength:function(e,t,a,n){var r=t;e.forEach(function(e){var i=e.getParent();var g=i.getOverlayShapeId();e._level=g&&!isNaN(a._overlayShapeIdList[g])?a._overlayShapeIdList[g]:Number(i.getOverlayLevel())+r;var s=n["level"+(e._level-1)],o=this.oGantt.schemeRowSpanMap&&this.oGantt.schemeRowSpanMap[i.getShape().getScheme()];n["level"+(e._level-1)]=s>o?s:o;t=Math.max(e._level,t)}.bind(this));return{iMaxLength:t,oInternalRowWithSpan:n}}};return t},true);
//# sourceMappingURL=AggregationUtils.js.map