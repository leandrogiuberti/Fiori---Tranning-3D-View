/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/core/Control","sap/ui/table/library","sap/ui/table/utils/TableUtils","sap/gantt/simple/GanttExtension","sap/ui/table/rowmodes/Fixed","./GanttUtils","sap/ui/core/RenderManager","sap/gantt/simple/InnerGanttChartRenderer"],function(e,t,n,a,r,o,i,s){"use strict";var d=t.extend("sap.gantt.simple.InnerGanttChart",{metadata:{library:"sap.gantt",events:{ganttReady:{parameters:{hasRenderedShapes:{type:"boolean"},totalRenderedShapes:{type:"int"},supressEvent:{type:"boolean"}}},_afterGanttRendered:{}}}});d.prototype.getDomRef=function(e){var t=this.getParent(),n;if(e){n="-"+e}else{n="-cnt"}if(t){return window.document.getElementById(t.getId()+n)}return null};d.prototype.invalidate=function(){var e=this.getParent();e._oInnerGanttRenderPromise.then(function(){e._bInnerGanttRenderPromiseResolved=true;var t=this.getUIArea();if(t){t.addInvalidatedControl(this)}}.bind(this))};d.prototype.hasRenderedShapes=function(){return this.$("svg").find(".sapGanttChartShapes").children().length>0};d.prototype.getTotalRenderedShapes=function(){return this.$("svg").find(".sapGanttChartShapes").children().length};d.prototype.resolveWhenReady=function(e){return new Promise(function(t){var r=function s(d){var g=this.getParent(),h=g.getTable();i.setTableRowMode(h);if(g._enableOptimisation&&!g.getTable().getRowMode().isA("sap.ui.table.rowmodes.Fixed")){if(g.getTable().getRowMode()&&g.getTable().getRowMode().getRowContentHeight()){g.getTable().setRowMode(new o({rowContentHeight:g.getTable().getRowMode().getRowContentHeight()}))}else{g.getTable().setRowMode(new o)}}var l;if(h.getRowMode()){l=g.getTable().getRowMode().isA("sap.ui.table.rowmodes.Auto")&&g.getSyncedControl().getRowStates().length<g.getTable().getRows().length-1+a.getHeaderRowCount(g.getTable())}else{l=g.getTable().getVisibleRowCountMode()===n.VisibleRowCountMode.Auto&&g.getSyncedControl().getRowStates().length<g.getTable().getVisibleRowCount()+a.getHeaderRowCount(g.getTable())}if(e&&!d.getParameter("hasRenderedShapes")||l){this.attachEventOnce("ganttReady",r)}else{t()}}.bind(this);var s=Object.keys(this.getUIArea().mInvalidatedControls);if(s.indexOf(this.getParent().getId())>-1||s.indexOf(this.getParent().getTable().getId())>-1){this.attachEventOnce("ganttReady",r)}else if(!e&&this.getDomRef("svg")||e&&this.hasRenderedShapes()){t()}else{this.attachEventOnce("ganttReady",r)}}.bind(this))};d.prototype._updateRowsHoverState=function(){var e=this.getParent();setTimeout(function(){e.$("svg").find("rect.sapGanttBackgroundSVGRow:hover").each(function(){var t=e._getPointerExtension(),n=t._getRowIndexFromElement(this);e.getSyncedControl().syncRowHover(n,true)});e.$("svg").find("rect.sapGanttBackgroundSVGRow:not(:hover)").each(function(){var t=e._getPointerExtension(),n=t._getRowIndexFromElement(this);e.getSyncedControl().syncRowHover(n,false)})},0)};d.prototype.onBeforeRendering=function(e){performance.mark("InnerGanttChart--start");if(!this.getParent()._bPreventInitialRender||this.getParent()._bRenderGanttClone||this.getParent()._bRenderFullScreenGantt){this.getParent()._bRenderFullScreenGantt=false;this.getParent()._getScrollExtension().jumpToVisibleHorizon("initialRender")}};d.prototype.onAfterRendering=function(e){var t=this.getParent();t._updateVsbContainers();t._syncContainerGanttCharts("initialRender",e);var n=new s;this.getRenderer().renderRelationships(n,t);n.destroy();this.fireEvent("_afterGanttRendered");t._updateShapeSelections(t.getSelectedShapeUid(),[]);t.updateShapeHighlights(t.getHighlightedShapeUid(),[]);t._getConnectExtension().updateShapeConnectEffect(t);this._updateRowsHoverState();r.attachEvents(t);this.fireGanttReady({hasRenderedShapes:this.hasRenderedShapes(),totalRenderedShapes:this.getTotalRenderedShapes()});performance.mark("InnerGanttChart--end")};return d},true);
//# sourceMappingURL=InnerGanttChart.js.map