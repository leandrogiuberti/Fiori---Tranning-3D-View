/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["./Shape","sap/gantt/library","sap/gantt/simple/InnerGanttChartRenderer","sap/gantt/simple/RenderUtils"],function(t,e,r,a){"use strict";var i=e.simple.shapes.TaskType;var n=e.simple.shapes.ShapeAlignment;var s=10;function o(t){var e=Object.assign({},t);e.iStartX-=1;e.iEndX+=1;e.iHeight+=2;return e}var l=t.extend("sap.gantt.simple.shapes.Task",{metadata:{library:"sap.gantt",properties:{type:{type:"sap.gantt.simple.shapes.TaskType",defaultValue:i.Normal},utilizationDown:{type:"boolean",defaultValue:true},title:{type:"string",defaultValue:null},alignShape:{type:"sap.gantt.simple.shapes.ShapeAlignment",defaultValue:n.Middle}}},renderer:{apiVersion:2}});l.prototype._generateRectD=function(t){var e="";e+="M "+t.iStartX+" "+t.iAlignShapeY;var r=t.iHeight/2,a=t.iEndX-t.iStartX,i=this.generateArcRadius(r,a);e+=" l 0 "+(-r+i);e+=" a "+i+" "+i+" 0 0 1 "+i+" "+-i;a-=i;var n=this.generateArcRadius(a-i,r);a-=n;e+=" l "+a+" 0";e+=" a "+n+" "+n+" 0 0 1 "+n+" "+n;e+=" l 0 "+(2*r-n-i);e+=" a "+n+" "+n+" 0 0 1 "+-n+" "+n;e+=" l "+-a+" 0";e+=" a "+i+" "+i+" 0 0 1 "+-i+" "+-i;e+=" Z";return e};l.prototype._renderOverlappingRectangle=function(t,e){var r=this._generateRectD(o(e));t.openStart("path");t.class("sapGanttShapeOverlappingBorder");t.attr("d",r);t.openEnd().close("path")};l.prototype.renderNoramlTask=function(t,e){this._renderOverlappingRectangle(t,e);var r=this._generateRectD(e);t.openStart("path");t.attr("d",r);if(this.getHoverState()){t.attr("fill",this.getHoverBackgroundColor());t.attr("stroke-width",1);t.attr("stroke",this.getHoverColor())}else if(this.getSelected()){t.attr("fill",this.getSelectedColor())}else{t.attr("fill",this.getTranslatedColor())}t.openEnd();a.renderTooltip(t,this);if(this.getShowAnimation()){a.renderElementAnimation(t,this)}t.close("path")};l.prototype._generateSummaryD=function(t,e){var r="",a=e?7:5;r+="M "+t.iStartX+" "+t.iAlignShapeY;var i=t.iHeight/2,n=t.iEndX-t.iStartX,s=this.generateArcRadius(i,n);r+=" l 0 "+(-i+s);r+=" a "+s+" "+s+" 0 0 1 "+s+" "+-s;n-=s;var o=this.generateArcRadius(n-s,i);n-=o;r+=" l "+n+" 0";r+=" a "+o+" "+o+" 0 0 1 "+o+" "+o;r+=" l 0 "+(2*i-o-3);r+=" a 3 5 0 0 1 -"+a+" 0";r+=" l 0 "+(-2*i+o+a);r+=" l "+(-n+2*a-s-o)+" 0";r+=" l 0 "+(2*i-s-a);r+=" a 3 5 0 0 1 -"+a+" 0";r+=" Z";return r};l.prototype.renderSummaryTaskExpanded=function(t,e){if(Math.abs(e.iEndX-e.iStartX)<=s){this.renderNoramlTask(t,e)}else{var r;if(!e.bFromCollapsed){r=this._generateSummaryD(o(e),true);t.openStart("path");t.class("sapGanttShapeOverlappingBorder");t.attr("d",r);t.openEnd().close("path")}r=this._generateSummaryD(e);t.openStart("path");t.attr("d",r);if(this.getHoverState()){t.attr("fill",this.getHoverBackgroundColor());t.attr("stroke-width",1);t.attr("stroke",this.getHoverColor())}else if(this.getSelected()){t.attr("fill",this.getSelectedColor());if(e.bFromCollapsed){t.attr("stroke-width",1.0001);t.attr("stroke","white");t.attr("shape-rendering","crispEdges")}}else{t.attr("fill",this.getTranslatedColor())}t.openEnd();a.renderTooltip(t,this);if(this.getShowAnimation()){a.renderElementAnimation(t,this)}t.close("path")}};l.prototype.renderSummaryTaskCollapsed=function(t,e){if(Math.abs(e.iEndX-e.iStartX)<=s){this.renderNoramlTask(t,e)}else{this._renderOverlappingRectangle(t,e);var r=this._generateRectD(e);t.openStart("path");t.attr("d",r);if(this.getHoverState()){t.attr("fill",this.getHoverBackgroundColor());t.attr("stroke-width",1);t.attr("stroke",this.getHoverColor())}else if(this.getSelected()){t.attr("fill",this.getSelectedColor())}else{t.attr("fill",this.getTranslatedColor());t.attr("fill-opacity",.7)}t.openEnd();a.renderTooltip(t,this);if(this.getShowAnimation()){a.renderElementAnimation(t,this)}t.close("path");this.renderSummaryTaskExpanded(t,Object.assign({},e,{bFromCollapsed:true}))}};l.prototype.renderErrorTask=function(t,e){this._renderOverlappingRectangle(t,e);var i=this.getId()+"-mask",n=this._generateRectD(e),s,o,l;if(this.getGanttChartBase()){l=this.getGanttChartBase().getId()+"-helperDef-linePattern"}else{r.renderHelperDefs(t,this.getId());l=this.getId()+"-helperDef-linePattern"}if(this.getHoverState()){s=this.getHoverColor();o=this.getHoverBackgroundColor()}else if(this.getSelected()){s=o=this.getSelectedColor()}else{s=o=this.getTranslatedColor()}t.openStart("mask",i);t.openEnd();t.openStart("path");t.attr("d",n);t.attr("stroke","white");t.attr("stroke-width",1);t.attr("fill","url(#"+l+")");t.openEnd().close("path");t.close("mask");t.openStart("path");t.attr("d",n);t.attr("stroke",s);t.attr("stroke-width",1);t.attr("fill",o);t.attr("mask","url(#"+i+")");t.openEnd();a.renderTooltip(t,this);if(this.getShowAnimation()){a.renderElementAnimation(t,this)}t.close("path")};l.prototype.renderContent=function(t){var e={iHeight:this.getPixelHeight()-this.getRowPadding(),iStartX:this.getXStart(),iEndX:this.getXEnd(),iAlignShapeY:this.getRowYCenter()};switch(this.getType()){case i.Normal:this.renderNoramlTask(t,e);break;case i.Error:this.renderErrorTask(t,e);break;case i.SummaryCollapsed:this._generateAlignShapeX(e);this.renderSummaryTaskCollapsed(t,e);break;case i.SummaryExpanded:this._generateAlignShapeX(e);this.renderSummaryTaskExpanded(t,e);break;default:throw new Error("Unknown type of Task: "+this.getType())}};l.prototype.renderElement=function(t){this.writeElementData(t,"g",true);t.attr("pointer-events","bounding-box");t.openEnd();this.renderContent(t);t.close("g")};l.prototype._generateAlignShapeX=function(t){if(this._iBaseRowHeight!=undefined){if(this.getAlignShape()==n.Top){t.iAlignShapeY=this.getRowYCenter()-this._iBaseRowHeight/2+t.iHeight/2}else if(this.getAlignShape()==n.Bottom){t.iAlignShapeY=this.getRowYCenter()+this._iBaseRowHeight/2-t.iHeight/2}}};return l});
//# sourceMappingURL=Task.js.map