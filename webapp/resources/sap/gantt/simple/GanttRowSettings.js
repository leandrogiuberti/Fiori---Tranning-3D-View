/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/base/util/uid","sap/ui/table/RowSettings","./AggregationUtils","./RenderUtils","sap/gantt/misc/Utility"],function(e,t,a,n,p){"use strict";var r=t.extend("sap.gantt.simple.GanttRowSettings",{metadata:{library:"sap.gantt",properties:{rowId:{type:"string"}},defaultAggregation:"shapes1",aggregations:{calendars:{type:"sap.gantt.simple.BaseCalendar",multiple:true,singularName:"calendars"},calendars1:{type:"sap.gantt.simple.BaseCalendar",multiple:true,singularName:"calendar1"},calendars2:{type:"sap.gantt.simple.BaseCalendar",multiple:true,singularName:"calendar2"},calendars3:{type:"sap.gantt.simple.BaseCalendar",multiple:true,singularName:"calendar3"},calendars4:{type:"sap.gantt.simple.BaseCalendar",multiple:true,singularName:"calendar4"},calendars5:{type:"sap.gantt.simple.BaseCalendar",multiple:true,singularName:"calendar5"},relationships:{type:"sap.gantt.simple.Relationship",multiple:true,singularName:"relationship"},shapes1:{type:"sap.gantt.simple.BaseShape",multiple:true,singularName:"shape1"},shapes2:{type:"sap.gantt.simple.BaseShape",multiple:true,singularName:"shape2"},shapes3:{type:"sap.gantt.simple.BaseShape",multiple:true,singularName:"shape3"},shapes4:{type:"sap.gantt.simple.BaseShape",multiple:true,singularName:"shape4"},shapes5:{type:"sap.gantt.simple.BaseShape",multiple:true,singularName:"shape5"},pseudoShapes:{type:"sap.gantt.simple.BasePseudoShape",multiple:true,singularName:"pseudoShape",visibility:"hidden"},pseudoShapeTemplate:{type:"sap.gantt.simple.MultiActivityGroup",multiple:false,visibility:"hidden"},overlays1:{type:"sap.gantt.overlays.GanttRowOverlay",sapGanttLazy:true},overlays2:{type:"sap.gantt.overlays.GanttRowOverlay",sapGanttLazy:true},overlays3:{type:"sap.gantt.overlays.GanttRowOverlay",sapGanttLazy:true},overlays4:{type:"sap.gantt.overlays.GanttRowOverlay",sapGanttLazy:true},overlays5:{type:"sap.gantt.overlays.GanttRowOverlay",sapGanttLazy:true}},designtime:"sap/ui/dt/designtime/notAdaptable.designtime"}});r.prototype.getPseudoShapes=function(){return this.getAggregation("pseudoShapes")?this.getAggregation("pseudoShapes"):[]};r.prototype.getPseudoShapeTemplate=function(){return this.getAggregation("pseudoShapeTemplate")};r.prototype.getAllExpandableShapes=function(e){var t=this.getParent()&&this.getParent().getIndex();var a=[],n=e&&e.oOverlapShapeIds&&e.oOverlapShapeIds[t]&&e.oOverlapShapeIds[t].length>0;this._mapAllShapes(function(p){if(n){if(p!=null&&p.length>0){p.forEach(function(n){if(e.oOverlapShapeIds[t].indexOf(n.getShapeId())>-1&&n.getExpandable()){a.push(n)}})}}else if(p!=null&&p.length>0&&p[0].getExpandable()){a.push(p)}},e);return[].concat.apply([],a)};r.prototype._mapAllShapes=function(e,t){var n=a.getAllNonLazyAggregations(this);var p=t&&t._aShapeRenderOrder?t._aShapeRenderOrder:Object.keys(n);p.map(function(t){if(n.hasOwnProperty(t)){var a=n[t];e(this[a._sGetter]())}}.bind(this))};r.prototype.getParentGantt=function(){return a.getParentControlOf("sap.gantt.simple.GanttChartWithTable",this)};r.prototype.getParentRow=function(){return a.getParentControlOf("sap.ui.table.Row",this)};r.prototype.getShapeUid=function(t){var a=t.getShapeId();if(!a){a=e();t.setProperty("shapeId",a,true)}var n=t.getScheme(),p=this.getRowUid(n);var r=this.getShapeBindingContextPath(t);var s=p+"|DATA:"+r+"["+a+"]";return s};r.prototype.getShapeBindingContextPath=function(e){var t=this.getBindingModelName();var a=e.getBindingContext(t);if(a==null){a=this.getBindingContextFromParent(e)}if(a){return a.getPath()}return""};r.prototype.getBindingModelName=function(){var e=this._getRow().getParent().getBindingInfo("rows");return e.model};r.prototype.getBindingContextFromParent=function(e,t){var a=e.getParent();var n;while(a){n=a.getBindingContext(t);if(n){return n}else{a=a.getParent()}}return n};r.prototype.getRowUid=function(e,t){var a=this.getRowId();if(a==null){return null}if(!e){e=this.getParentGantt().getPrimaryShapeScheme().getKey()}if(t===undefined){t=this.getParentRow()?this.getParentRow().getIndex():0}return"PATH:"+a+"|SCHEME:"+e+"["+t+"]"};r.prototype.renderElement=function(e,t){n.renderInlineShapes(e,this,t)};r.prototype.invalidate=function(e){return this._invalidateInnerGanttIfNeeded()};r.prototype._invalidateInnerGanttIfNeeded=function(){var e=this._getRow();p.safeCall(e,["getParent","getParent","getInnerGantt","invalidate"]);return this};r.prototype._onRowExpandToggle=function(e){if(!e){return}if(this._oRowExpandInfo&&(this._oRowExpandInfo.expanded===e.expanded&&this._oRowExpandInfo.pseudoShapeExpand===e.pseudoShapeExpand)){return}this._oRowExpandInfo=e;if(this._isExpanded()){this._handleEvent(new jQuery.Event("RowExpanded"))}else{this._handleEvent(new jQuery.Event("RowCollapsed"))}};r.prototype._isExpanded=function(){return this._oRowExpandInfo&&(this._oRowExpandInfo.expanded&&!this._oRowExpandInfo.pseudoShapeExpand)};r.prototype.clone=function(){var e=t.prototype.clone.call(this);e._oRowExpandInfo=this._oRowExpandInfo;return e};return r});
//# sourceMappingURL=GanttRowSettings.js.map