/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["../DefBase","sap/gantt/misc/Format","sap/gantt/simple/AggregationUtils","sap/gantt/library"],function(t,e,a,r){"use strict";var n=t.extend("sap.gantt.def.cal.Calendar",{metadata:{library:"sap.gantt",properties:{key:{type:"string",defaultValue:"calendar"},backgroundColor:{type:"sap.gantt.ValueSVGPaintServer",defaultValue:"sapChart_Sequence_Neutral_Plus2"}},defaultAggregation:"timeIntervals",aggregations:{timeIntervals:{type:"sap.gantt.def.cal.TimeInterval",multiple:true,singularName:"timeInterval",bindable:"bindable"}}}});n.prototype.getDefNode=function(){var t=this.getParent()&&this.getParent().getParent()?this.getParent().getParent():null;var r=this.getTimeIntervals();var n=t?t._oStatusSet:null;var i=n?n.aViewBoundary:null;var l=n?n.aTimeBoundary:null;var g=r;if(l&&n){g=r.filter(function(t){var a=e.abapTimestampToDate(t.getStartTime());var r=e.abapTimestampToDate(t.getEndTime());var i=n.bRTL?l[1]:l[0],g=n.bRTL?l[0]:l[1];return r>i&&a<g})}var s=i&&i.length>1?i[1]-i[0]:1;var o={id:this.generateRefId(),x:0,y:0,width:s,timeIntervals:[]};var u=t&&t.getAggregation("table")?t.getTable().getRows():null;if(u&&u.length>0){u.forEach(function(t){if(!o.title||o.title===""){var e=t.getAggregation("_settings");if(e){var r=a.getAllNonLazyAggregations(e);var n=Object.keys(r).filter(function(t){return t.indexOf("calendars")===0}).map(function(t){return e.getAggregation(t)||[]});n.forEach(function(t){if(t&&t.length>0){var e=t.filter(function(t){return this.getKey()===t.getCalendarName()}.bind(this));var a=e&&e.length>0?e[0].getTitle():null;var r=e&&e.length>0?e[0]:null;o["title"]=a;o["baseCalender"]=r}}.bind(this))}}}.bind(this))}if(t&&t.isA("sap.gantt.simple.GanttChartWithTable")){g=r.filter(function(e){return t.isCalendarTimeIntervalVisible(e)})}for(var f=0;f<g.length;f++){var d=g[f].getDefNode();d.fill=this.getBackgroundColor();o.timeIntervals.push(d)}return o};n.prototype.generateRefId=function(){var t=this.getParent()&&this.getParent().getParent()?this.getParent().getParent().getId():"";return t+"_"+this.getKey()};n.prototype.getBackgroundColor=function(){return r.ValueSVGPaintServer.normalize(this.getProperty("backgroundColor"))};return n},true);
//# sourceMappingURL=Calendar.js.map