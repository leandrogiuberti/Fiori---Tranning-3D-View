/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/gantt/library","sap/ui/core/Element","sap/gantt/misc/Utility","sap/gantt/misc/Format","sap/ui/core/Core","sap/ui/core/format/NumberFormat"],function(t,e,r,i,n,a){"use strict";var o=e.extend("sap.gantt.shape.Shape",{metadata:{abstract:true,properties:{tag:{type:"string"},category:{type:"string",defaultValue:t.shape.ShapeCategory.InRowShape},htmlClass:{type:"string"},isDuration:{type:"boolean",defaultValue:false},time:{type:"string"},endTime:{type:"string"},title:{type:"string"},ariaLabel:{type:"string"},xBias:{type:"float",defaultValue:0},yBias:{type:"float",defaultValue:0},fill:{type:"sap.gantt.ValueSVGPaintServer"},strokeOpacity:{type:"float",defaultValue:1},fillOpacity:{type:"float",defaultValue:1},stroke:{type:"sap.gantt.ValueSVGPaintServer"},strokeWidth:{type:"float",defaultValue:0},strokeDasharray:{type:"string"},clipPath:{type:"string"},transform:{type:"string"},filter:{type:"string"},enableHover:{type:"boolean",defaultValue:false},enableDnD:{type:"boolean",defaultValue:false},enableSelection:{type:"boolean",defaultValue:true},enableResize:{type:"boolean",defaultValue:false},rowYCenter:{type:"float",defaultValue:7.5},rotationCenter:{type:"float[]"},rotationAngle:{type:"float"},isBulk:{type:"boolean",defaultValue:false},arrayAttribute:{type:"string"},timeFilterAttribute:{type:"string"},endTimeFilterAttribute:{type:"string"},legend:{type:"string"}},aggregations:{selectedShape:{type:"sap.gantt.shape.SelectedShape",multiple:false},resizeShadowShape:{type:"sap.gantt.shape.ResizeShadowShape",multiple:false}}}});o.prototype.init=function(){var t=sap.ui.getCore().getLibraryResourceBundle("sap.gantt");this.setProperty("ariaLabel",t.getText("ARIA_SHAPE"));this.mShapeConfig=null;this.mChartInstance=null};var s={};sap.ui.getCore().attachThemeChanged(function(){s={}});o.prototype.getTag=function(t){return this._configFirst("tag",t)};o.prototype.getCategory=function(t){return this._configFirst("category",t)};o.prototype.getHtmlClass=function(t){return this._configFirst("htmlClass",t)};o.prototype.getIsDuration=function(t){return this._configFirst("isDuration",t)};o.prototype.getTime=function(t){return this._configFirst("time",t)};o.prototype.getEndTime=function(t){return this._configFirst("endTime",t)};o.prototype.getTitle=function(t){return this._configFirst("title",t)};o.prototype.getAriaLabel=function(t){return this._configFirst("ariaLabel",t)};o.prototype.getXBias=function(t){if(n.getConfiguration().getRTL()===true){return 0-this._configFirst("xBias",t)}else{return this._configFirst("xBias",t)}};o.prototype.getYBias=function(t){return this._configFirst("yBias",t,true)};o.prototype.getFill=function(t,e){return this._configFirst("fill",t)};o.prototype.getStrokeOpacity=function(t){return this._configFirst("strokeOpacity",t)};o.prototype.getFillOpacity=function(t){return this._configFirst("fillOpacity",t)};o.prototype.getStroke=function(t){return this._configFirst("stroke",t)};o.prototype.getStrokeWidth=function(t){return this._configFirst("strokeWidth",t,true)};o.prototype.getStrokeDasharray=function(t){return this._configFirst("strokeDasharray",t)};o.prototype.getClipPath=function(t){return this._configFirst("clipPath",t)};o.prototype.getTransform=function(t,e){if(this.mShapeConfig.hasShapeProperty("transform")){return this._configFirst("transform",t)}var r=[];this._translate(t,e,r);this._rotate(t,e,r);if(r.length>0){return r.join(" ")}};o.prototype._rotate=function(t,e,r){var i=this.getRotationCenter(t,e),n=this.getRotationAngle(t,e);if(i&&i.length===2&&n){r.push("rotate("+n+" "+i[0]+" "+i[1]+")")}};o.prototype._translate=function(t,e,r){var i=this.getXBias(t,e),n=this.getYBias(t,e);if(i||n){i=i?i:0;n=n?n:0;r.push("translate("+i+" "+n+")")}};o.prototype.getFilter=function(t){return this._configFirst("filter",t)};o.prototype.getEnableDnD=function(t){return this._configFirst("enableDnD",t)};o.prototype.getEnableSelection=function(t){return this._configFirst("enableSelection",t)};o.prototype.getEnableResize=function(t){return this._configFirst("enableResize",t)};o.prototype.getEnableHover=function(t){return this._configFirst("enableHover",t)};o.prototype.getRotationAngle=function(t){return this._rtlRotation(this._configFirst("rotationAngle",t))};o.prototype._rtlRotation=function(t){if(t>0||t<0){if(n.getConfiguration().getRTL()){return 360-t}else{return t}}};o.prototype.getRowYCenter=function(t,e){if(this.mShapeConfig.hasShapeProperty("rowYCenter")){return this._configFirst("rowYCenter",t)}if(e){return e.y+e.rowHeight/2}else{return this.getProperty("rowYCenter")}};o.prototype.getRotationCenter=function(t,e){if(this.mShapeConfig.hasShapeProperty("rotationCenter")){return this._configFirst("rotationCenter",t)}return this._getCenter(t,e)};o.prototype._getCenter=function(t,e,r){var n=this.getAxisTime();var a=r?this.getEndTime(t,e):this.getTime(t,e);if(!a){return undefined}var o=n.timeToView(i.abapTimestampToDate(a));if(!o&&!o==0){o=n.timeToView(0)}var s=this.getRowYCenter(t,e);return[o,s]};o.prototype.getIsBulk=function(t){return this._configFirst("isBulk",t)};o.prototype.getArrayAttribute=function(t){return this._configFirst("arrayAttribute",t)};o.prototype.getTimeFilterAttribute=function(t){return this._configFirst("timeFilterAttribute",t)};o.prototype.getEndTimeFilterAttribute=function(t){return this._configFirst("endTimeFilterAttribute",t)};o.prototype.getLegend=function(t){return this._configFirst("legend",t)};o.prototype._configFirst=function(t,e,i){var n=null;if(this.mShapeConfig.hasShapeProperty(t)){var a=this.mShapeConfig.getShapeProperty(t);if(typeof a==="string"){n=this._formatting(e,t,a)}else{n=a}}else{n=this.getProperty(t)}if(i&&this.mChartInstance){var o=this.mChartInstance.getSapUiSizeClass();n=r.scaleBySapUiSize(o,n)}return n};o.prototype.getStyle=function(t,e){var r={stroke:this.determineValueColor(this.getStroke(t,e)),"stroke-width":this.getStrokeWidth(t,e)};return r};o.prototype.getAxisTime=function(){var t=null;if(this.mChartInstance){t=this.mChartInstance.getAxisTime()}return t};o.prototype.getInlineStyle=function(t){return Object.keys(t).reduce(function(e,r){if(t[r]!==undefined&&t[r]!==null&&t[r]!==""){e+=r+":"+t[r]+"; "}return e},"")};o.prototype.determineValueColor=function(t){var e=s[t];if(!e&&t){e=sap.gantt.ValueSVGPaintServer.normalize(t);s[t]=e}return e};o.prototype.getShapeViewBoundary=function(){var t=this.mChartInstance._oStatusSet;if(t&&t.aViewBoundary){return t.aViewBoundary}return null};o.prototype._formatting=function(t,e,r){if(!r){return""}this._attributeNameBindingMap=this._attributeNameBindingMap||{};if(!this._attributeNameBindingMap[e]){this._attributeNameBindingMap[e]=this._resolveAttributeMap(r)}return this._formatFromResolvedAttributeMap(t,e)};o.prototype._resolveAttributeMap=function(t){var e=[];var r=t.match(/[^\{\}]*(\{.*?\})?/g);r.pop();r.forEach(function(t,r,i){var n={},a=t.split("{");if(a[0].length>0){n.leadingText=a[0]}if(a[1]){a=a[1].split("}")[0].split(":");if(a[0].length>0){n.attributeName=a[0].trim().split("/")}if(a[1]){n.attributeType=a[1].trim()}}e.push(n)});return e};o.prototype._formatFromResolvedAttributeMap=function(t,e){var r=this._attributeNameBindingMap[e],i=[],n,a;if(r){r.forEach(function(e,r){n=e.leadingText;if(e.attributeName){a=t;e.attributeName.forEach(function(t,e){a=a[t]});if(n){n=n+this._formatValue(a,e.attributeType)}else{n=this._formatValue(a,e.attributeType)}}i.push(n)}.bind(this))}if(i.length===1){return i[0]}return i.join("")};o.prototype._formatValue=function(t,e){var r=t;switch(e){case"Number":r=this._formatNumber(t);break;case"Timestamp":var n=this.mChartInstance.getLocale();if(n){r=i.abapTimestampToTimeLabel(t,n)}break;default:if(r===undefined||r===null){r=""}break}return r};o.prototype._formatNumber=function(t,e){var r="";if(e!==undefined){r=a.getFloatInstance({minFractionDigits:e,maxFractionDigits:e}).format(t)}else{r=a.getFloatInstance().format(t)}return r};o.prototype.getParentReferenceId=function(t,e){if(this.mShapeConfig.hasShapeProperty("referenceId")){return this._configFirst("referenceId",t)}if(this.getParent()&&this.getParent().genReferenceId){return this.getParent().genReferenceId(t,e)}};return o},true);
//# sourceMappingURL=Shape.js.map