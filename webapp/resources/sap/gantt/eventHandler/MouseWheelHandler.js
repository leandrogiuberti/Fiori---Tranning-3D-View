/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","sap/ui/Device","sap/ui/base/Object"],function(jQuery,e,t){"use strict";var o=t.extend("sap.gantt.eventHandler.MouseWheelHandler",{constructor:function(e){t.call(this);this._oSourceChart=e;this._lastCalledMouseWheelZoom=0;this._iMouseWheelZoomTimer=undefined}});o.prototype.handleEvent=function(e,t){var o=e.originalEvent;var r=o.shiftKey;var i=o.ctrlKey;var a=this._getScrollDelta(o);var l=false;if(r){if(i){l=this._handleZoom(e,a,t)}else{this._handleHScroll(e,a)}}else{this._handleVScroll(e,a)}return l};o.prototype._getScrollDelta=function(t){var o=0;if(e.browser.firefox){o=t.detail}else{o=t.deltaY||t.deltaX}return o};o.prototype._handleZoom=function(e,t,o){var r=this._oSourceChart.getAxisTimeStrategy();var i=false;if(r.getMouseWheelZoomType()!==sap.gantt.MouseWheelZoomType.None){var a=t<0;if(!a&&r.getZoomLevel()>0||a&&r.getZoomLevel()<r.getZoomLevels()-1){if(this._oSourceChart._destroyCursorLine){this._oSourceChart._destroyCursorLine()}var l=!this._iMouseWheelZoomTimer&&Date.now()-this._lastCalledMouseWheelZoom>100?0:700;if(l===0){this._updateVisibleHorizon(e,t,o)}else{this._iMouseWheelZoomTimer=this._iMouseWheelZoomTimer||window.setTimeout(this._updateVisibleHorizon.bind(this),l,e,t,o)}i=true}this._preventBubbleAndDefault(e)}return i};o.prototype._updateVisibleHorizon=function(t,o,r){this._lastCalledMouseWheelZoom=Date.now();var i=this._oSourceChart.getAxisTimeStrategy();var a=t.originalEvent;var l=jQuery(this._oSourceChart.getDomSelectorById("svg"));if(l){var s=(e.browser.edge?a.clientX:a.pageX)-l.offset().left||a.offsetX;var n=i.getAxisTime().viewToTime(s);i.updateVisibleHorizonOnMouseWheelZoom(n,o,t,r)}this._iMouseWheelZoomTimer=undefined};o.prototype._handleHScroll=function(e,t){var o=this._oSourceChart.getTTHsbDom();var r=false;var i=t>0;if(o){if(i){r=Math.round(o.scrollLeft)===o.scrollWidth-o.clientWidth}else{r=o.scrollLeft===0}if(!r){this._preventBubbleAndDefault(e);o.scrollLeft+=t}}};o.prototype._handleVScroll=function(e,t){var o=this._oSourceChart.getTTVsbDom();var r=false;var i=t>0;if(o){if(i){r=Math.round(o.scrollTop)===o.scrollHeight-o.clientHeight}else{r=o.scrollTop===0}if(!r){this._preventBubbleAndDefault(e);var a=t/this._oSourceChart.getBaseRowHeight();if(a>1){a=Math.floor(a)}o.scrollTop+=a*this._getScrollingPixelsForRow()}}};o.prototype._getScrollingPixelsForRow=function(){var e=this._oSourceChart._oTT;if(e){var t=e.getVisibleRowCount();var o=Math.max(1,t-e.getFixedRowCount()-e.getFixedBottomRowCount());var r=this._oSourceChart.getBaseRowHeight();var i=o*r;var a=e.getBinding("rows").getLength();var l=Math.max(a,t+1);var s=l*r;var n=Math.max(1,s-i-this._getRowHeightsDelta());var h;if(t>a){h=a}else{h=Math.max(0,a-t-1)}return Math.ceil(n/Math.max(1,h))}return 0};o.prototype._getRowHeightsDelta=function(){var e=this._oSourceChart._oTT;if(e){var t=e.getBinding("rows").getLength();var o=e.getVisibleRowCount();var r=this._oSourceChart.getBaseRowHeight()*o;var i=this._oSourceChart._getRowHeights();if(o>t){i=i.slice(0,t)}var a=i.reduce(function(e,t){return e+t},0)-r;if(a>0){a=Math.ceil(a)}return Math.max(0,a)}return 0};o.prototype._preventBubbleAndDefault=function(e){e.preventDefault();e.stopPropagation()};return o},true);
//# sourceMappingURL=MouseWheelHandler.js.map