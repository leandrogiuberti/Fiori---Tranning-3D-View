/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/base/Object","sap/gantt/misc/Format","sap/gantt/config/TimeHorizon"],function(t,e,a){"use strict";var i=t.extend("sap.gantt.eventHandler.BirdEyeHandler",{constructor:function(e){t.call(this);this._oSourceChart=e;this._sStartTimeStamp=0;this._sEndTimeStamp=0}});i.prototype.calculateLargestVisibleHorizon=function(t,i){if(!t||t.length===0){return null}var r=this;for(var n=0;n<t.length;n++){var s=t[n];var m=s.dataSet;if(m&&m.length>0){for(var o=0;o<m.length;o++){r._collectShapeTimeRange(s,m[o])}}}if(!this._sStartTimeStamp&&!this._sEndTimeStamp){return null}var p=e.abapTimestampToDate(this._sStartTimeStamp).getTime();var S=e.abapTimestampToDate(this._sEndTimeStamp).getTime();var T=e.abapTimestampToDate(this._sStartTimeStamp);var h=e.abapTimestampToDate(this._sEndTimeStamp);if(!i){var l=this._oSourceChart.getVisibleWidth();var f=(S-p)/l;T=new Date(p-f*5);h=new Date(S+f*5)}var g=new a({startTime:T,endTime:h});this._sStartTimeStamp=0;this._sEndTimeStamp=0;return g};i.prototype._collectShapeTimeRange=function(t,e,a,i){var r=this;if(e){var n=[];if(e.shapeData){i=e.objectInfoRef;n=n.concat(e.shapeData)}else if(a&&e[a]){n=n.concat(e[a])}else if(e){n=n.concat(e)}if(t.filterValidData&&n.length>0){n=t.filterValidData(n,i)}if(t.getTag()=="g"&&n.length>0){var s=t.getShapes();if(s&&s.length>0){for(var m=0;m<s.length;m++){for(var o=0;o<n.length;o++){r._collectShapeTimeRange(s[m],n[o],s[m].mShapeConfig.getShapeDataName(),i)}}}}else if(t.mShapeConfig.getCountInBirdEye()){var p=t.getTime||t.getEndTime?true:false;if(n.length>0&&p){n.forEach(function(e){var a=t.getTime(e,i);var n=t.getEndTime(e,i);r._sStartTimeStamp=a&&(!r._sStartTimeStamp||a<r._sStartTimeStamp)?a:r._sStartTimeStamp;if(n){r._sEndTimeStamp=n&&(!r._sEndTimeStamp||n>r._sEndTimeStamp)?n:r._sEndTimeStamp}else{r._sEndTimeStamp=a&&(!r._sEndTimeStamp||a>r._sEndTimeStamp)?a:r._sEndTimeStamp}})}}}};i.prototype.doBirdEye=function(t,e){if(this._oSourceChart){var a=this._oSourceChart;var i=a.getLargestHorizonByDataRange(t,e);if(i){var r=a.getAxisTimeStrategy();if(typeof r.setVisibleHorizon==="function"){r.setVisibleHorizon(i)}else{r._setVisibleHorizon(i)}}}};return i},true);
//# sourceMappingURL=BirdEyeHandler.js.map