/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/helpers/TypeGuards"],function(t){"use strict";var e={};var i=t.isPathAnnotationExpression;var n=t.isAnnotationPath;function a(t){return t&&t.hasOwnProperty("_type")}function r(t,e){if(e){if(e.startsWith("/")){return e}else if(e.startsWith("@")){return t+e}else if(!t.endsWith("/")){return t+"/"+e}else{return t+e}}return t}let o=function(){function t(t,e,i){this.convertedMetadata=t;this.metaPath=e;this.contextPath=i;this.navigationProperties=[];this.contextNavigationProperties=[];this.absolutePath=r(i,e);this.relativePath=this.absolutePath.replace(i,"");if(this.relativePath.startsWith("/")){this.relativePath=this.relativePath.substring(1)}const n=this.convertedMetadata.resolvePath(this.absolutePath);const o=this.convertedMetadata.resolvePath(i);if(n.target===undefined||n.target===null){throw new Error(`No annotation target found for ${e}`)}this.targetObject=n.target;let s;let h;let u;let c=[];n.objectPath.forEach(t=>{if(a(t)){switch(t._type){case"NavigationProperty":c.push(t.name);this.navigationProperties.push(t);u=t.targetType;if(h&&h.navigationPropertyBinding.hasOwnProperty(c.join("/"))){h=h.navigationPropertyBinding[c.join("/")];c=[]}break;case"Singleton":case"EntitySet":if(s===undefined){s=t}h=t;u=h.entityType;break;case"EntityType":if(u===undefined){u=t}break;default:break}}});o.objectPath.forEach(t=>{s=this.getResolvedContextPath(t,u,s)});if(s===undefined||u===undefined){throw new Error("MetaPath doesn't contain an entitySet -> Should never happen")}this.serviceObjectPath=this.contextPath;if(this.navigationProperties.length){this.serviceObjectPath+="/"+this.navigationProperties.map(t=>t.name).join("/")}this.rootEntitySet=s;this.currentEntitySet=h;this.currentEntityType=u}e=t;var o=t.prototype;o.getResolvedContextPath=function t(e,i,n){if(a(e)){switch(e._type){case"NavigationProperty":this.contextNavigationProperties.push(e);break;case"EntitySet":if(this.contextRootEntitySet===undefined){this.contextRootEntitySet=e}if(n===undefined&&e.entityType===i){n=e}break;default:break}}return n};o.getContextPath=function t(){return this.contextPath};o.getPath=function t(e){return r(this.absolutePath,e)};o.getRelativePath=function t(e){return r(this.relativePath,e)};o.getTarget=function t(){return this.targetObject};o.getClosestEntitySet=function t(){let e=this.rootEntitySet;for(const t of this.navigationProperties){if(e.navigationPropertyBinding[t.name]){e=e.navigationPropertyBinding[t.name]}}return e};o.getClosestEntityType=function t(){let e=this.rootEntitySet.entityType;for(const t of this.navigationProperties){e=t.targetType}return e};o.getContextClosestEntitySet=function t(){let e=this.contextRootEntitySet;if(e){for(const t of this.contextNavigationProperties){if(e.navigationPropertyBinding[t.name]){e=e.navigationPropertyBinding[t.name]}}}return e};o.getNavigationProperties=function t(){return this.navigationProperties};o.getMetaPathForPath=function e(i){try{return new t(this.convertedMetadata,r(this.serviceObjectPath,i),this.contextPath)}catch{return undefined}};o.getMetaPathForObject=function e(a){if(n(a)){return this.getMetaPathForPath(a.value)}else if(i(a)){return this.getMetaPathForPath(a.path)}else{let e=a?.fullyQualifiedName?.replace(this.rootEntitySet?.entityType.fullyQualifiedName,this.contextPath);if(e===a?.fullyQualifiedName){e=a.fullyQualifiedName?.replace(this.targetObject?.fullyQualifiedName,this.relativePath)}return new t(this.convertedMetadata,e,this.contextPath)}};o.getConvertedMetadata=function t(){return this.convertedMetadata};o.getDataModelObjectPath=function t(){return{targetObject:this.targetObject,startingEntitySet:this.rootEntitySet,targetEntitySet:this.getClosestEntitySet(),targetEntityType:this.getClosestEntityType(),navigationProperties:this.getNavigationProperties(),convertedTypes:this.convertedMetadata}};return t}();e=o;return e},false);
//# sourceMappingURL=MetaPath.js.map