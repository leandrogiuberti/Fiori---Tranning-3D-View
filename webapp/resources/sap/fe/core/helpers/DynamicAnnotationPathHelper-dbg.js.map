{"version":3,"names":["getObject","oObject","sPath","sPathSplit","split","length","splice","join","resolveDynamicExpression","sAnnotationPath","oMetaModel","includes","firstBracket","indexOf","sStableBracket","substring","sRest","lastBracket","aValue","oExpression","BindingParser","parseExpression","Array","isArray","result","parts","path","i","bFound","oObjectValue","bResult","formatter","_exports"],"sourceRoot":".","sources":["DynamicAnnotationPathHelper.ts"],"sourcesContent":["import BindingParser from \"sap/ui/base/BindingParser\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\nfunction getObject(oObject: Record<string, unknown>, sPath: string): unknown {\n\tif (!oObject) {\n\t\treturn null;\n\t}\n\tconst sPathSplit = sPath.split(\"/\");\n\tif (sPathSplit.length === 1) {\n\t\treturn oObject[sPath];\n\t} else {\n\t\treturn getObject(oObject[sPathSplit[0]] as Record<string, unknown>, sPathSplit.splice(1).join(\"/\"));\n\t}\n}\n/**\n * Resolve a dynamic annotation path down to a standard annotation path.\n * @param sAnnotationPath\n * @param oMetaModel\n * @returns The non dynamic version of the annotation path\n */\nexport function resolveDynamicExpression(sAnnotationPath: string, oMetaModel: ODataMetaModel): string {\n\tif (sAnnotationPath.includes(\"[\")) {\n\t\tconst firstBracket = sAnnotationPath.indexOf(\"[\");\n\t\tconst sStableBracket = sAnnotationPath.substring(0, firstBracket);\n\t\tconst sRest = sAnnotationPath.substring(firstBracket + 1);\n\t\tconst lastBracket = sRest.indexOf(\"]\");\n\t\tconst aValue = oMetaModel.getObject(sStableBracket);\n\t\tconst oExpression = BindingParser.parseExpression(sRest.substring(0, lastBracket));\n\t\tif (\n\t\t\tArray.isArray(aValue) &&\n\t\t\toExpression &&\n\t\t\toExpression.result &&\n\t\t\toExpression.result.parts &&\n\t\t\toExpression.result.parts[0] &&\n\t\t\toExpression.result.parts[0].path\n\t\t) {\n\t\t\tlet i;\n\t\t\tlet bFound = false;\n\t\t\tfor (i = 0; i < aValue.length && !bFound; i++) {\n\t\t\t\tconst oObjectValue = getObject(aValue[i], oExpression.result.parts[0].path);\n\t\t\t\tconst bResult = oExpression.result.formatter(oObjectValue);\n\t\t\t\tif (bResult) {\n\t\t\t\t\tbFound = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (bFound) {\n\t\t\t\tsAnnotationPath = resolveDynamicExpression(sStableBracket + (i - 1) + sRest.substring(lastBracket + 1), oMetaModel);\n\t\t\t}\n\t\t}\n\t}\n\treturn sAnnotationPath;\n}\n"],"mappings":";;;;;;;;EAGA,SAASA,SAASA,CAACC,OAAgC,EAAEC,KAAa,EAAW;IAC5E,IAAI,CAACD,OAAO,EAAE;MACb,OAAO,IAAI;IACZ;IACA,MAAME,UAAU,GAAGD,KAAK,CAACE,KAAK,CAAC,GAAG,CAAC;IACnC,IAAID,UAAU,CAACE,MAAM,KAAK,CAAC,EAAE;MAC5B,OAAOJ,OAAO,CAACC,KAAK,CAAC;IACtB,CAAC,MAAM;MACN,OAAOF,SAAS,CAACC,OAAO,CAACE,UAAU,CAAC,CAAC,CAAC,CAAC,EAA6BA,UAAU,CAACG,MAAM,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,GAAG,CAAC,CAAC;IACpG;EACD;EACA;AACA;AACA;AACA;AACA;AACA;EACO,SAASC,wBAAwBA,CAACC,eAAuB,EAAEC,UAA0B,EAAU;IACrG,IAAID,eAAe,CAACE,QAAQ,CAAC,GAAG,CAAC,EAAE;MAClC,MAAMC,YAAY,GAAGH,eAAe,CAACI,OAAO,CAAC,GAAG,CAAC;MACjD,MAAMC,cAAc,GAAGL,eAAe,CAACM,SAAS,CAAC,CAAC,EAAEH,YAAY,CAAC;MACjE,MAAMI,KAAK,GAAGP,eAAe,CAACM,SAAS,CAACH,YAAY,GAAG,CAAC,CAAC;MACzD,MAAMK,WAAW,GAAGD,KAAK,CAACH,OAAO,CAAC,GAAG,CAAC;MACtC,MAAMK,MAAM,GAAGR,UAAU,CAACV,SAAS,CAACc,cAAc,CAAC;MACnD,MAAMK,WAAW,GAAGC,aAAa,CAACC,eAAe,CAACL,KAAK,CAACD,SAAS,CAAC,CAAC,EAAEE,WAAW,CAAC,CAAC;MAClF,IACCK,KAAK,CAACC,OAAO,CAACL,MAAM,CAAC,IACrBC,WAAW,IACXA,WAAW,CAACK,MAAM,IAClBL,WAAW,CAACK,MAAM,CAACC,KAAK,IACxBN,WAAW,CAACK,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,IAC3BN,WAAW,CAACK,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,EAC/B;QACD,IAAIC,CAAC;QACL,IAAIC,MAAM,GAAG,KAAK;QAClB,KAAKD,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGT,MAAM,CAACb,MAAM,IAAI,CAACuB,MAAM,EAAED,CAAC,EAAE,EAAE;UAC9C,MAAME,YAAY,GAAG7B,SAAS,CAACkB,MAAM,CAACS,CAAC,CAAC,EAAER,WAAW,CAACK,MAAM,CAACC,KAAK,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC;UAC3E,MAAMI,OAAO,GAAGX,WAAW,CAACK,MAAM,CAACO,SAAS,CAACF,YAAY,CAAC;UAC1D,IAAIC,OAAO,EAAE;YACZF,MAAM,GAAG,IAAI;UACd;QACD;QACA,IAAIA,MAAM,EAAE;UACXnB,eAAe,GAAGD,wBAAwB,CAACM,cAAc,IAAIa,CAAC,GAAG,CAAC,CAAC,GAAGX,KAAK,CAACD,SAAS,CAACE,WAAW,GAAG,CAAC,CAAC,EAAEP,UAAU,CAAC;QACpH;MACD;IACD;IACA,OAAOD,eAAe;EACvB;EAACuB,QAAA,CAAAxB,wBAAA,GAAAA,wBAAA;EAAA,OAAAwB,QAAA;AAAA","ignoreList":[],"file":"DynamicAnnotationPathHelper-dbg.js"}