{"version":3,"names":["ModelHelper","disableCollaborationDraft","isStickySessionSupported","metaModel","entityContainer","getObject","entitySetName","$kind","isDraftSupported","path","metaContext","getMetaContext","objectPath","getInvolvedDataModelObjects","isObjectPathDraftSupported","dataModelObjectPath","currentEntitySet","targetEntitySet","bIsDraftRoot","isDraftRoot","bIsDraftNode","isDraftNode","bIsDraftParentEntityForContainment","isNavigationProperty","targetObject","containsTarget","startingEntitySet","annotations","Common","DraftRoot","DraftNode","hasIsActiveEntityKey","targetEntityType","keys","some","key","name","isMetaPathDraftSupported","getClosestEntitySet","isCollaborationDraftSupportedFromConverterContext","converterContext","getConvertedTypes","entitySets","entitySet","ShareAction","undefined","isCollaborationDraftSupported","metaObject","templateInterface","oMetaModel","context","getModel","__$feIsCollaborationDraftEnabled","oEntityContainer","sEntitySet","getDraftRootPath","oContext","getMetaModel","getRootPath","sPath","model","firstIteration","arguments","length","sIterationPath","RegExp","exec","sEntityPath","getMetaPath","mDataModel","MetaModelConverter","getContext","getPath","getStickyRootPath","Session","StickySessionSupported","getTargetEntitySet","sEntitySetPath","getEntitySetPath","odataMetaModel","entitySetPath","split","filter","filterOutNavPropBinding","join","pathParts","initialPathObject","growingPath","pendingNavPropBinding","pathObject","reduce","pathUnderConstruction","pathPart","idx","delimiter","tempPath","navPropBindings","navPropBindingToCheck","Object","hasOwnProperty","replace","getActionParameterItemsModelPath","oParameter","$Name","sPathPart","enhanceInternalJSONModel","oInternalModel","fnBindContext","bindContext","mParameters","oEvents","contextBinding","apply","fnGetBoundContext","getBoundContext","oBoundContext","setProperty","propertyPath","value","propertyPathSplit","i","getProperty","enhanceUiJSONModel","uiModel","library","fnSetProperty","asyncUpdate","EditMode","Editable","Display","enhanceViewJSONModel","viewModel","fnGetObject","_getObject","isFilteringCaseSensitive","filterFunctions","_filterFunctions","indexOf","getMetaPathForContext","oModel","getRootEntitySetPath","contextPath","rootEntitySetPath","aPaths","getAbsoluteMetaPathForListBinding","oView","vListBinding","sMetaPath","startsWith","oBindingContext","getBindingContext","sRootContextPath","oBinding","oRootBinding","getRootBinding","sRootBindingPath","sRelativePath","getRelativeMetaPathForListBinding","parentContext","listBinding","listBindingContext","parentContextPath","viewBindingMetaPath","getDraftRoot","getDraftNode","isSticky","getStickySession","isUpdateHidden","entityType","isEntitySet","UI","UpdateHidden","getDeleteHidden","DeleteHidden","getAbsolutePathFromListBinding","metamodel","metaPath","rootBinding","rootBindingPath","relativePath","enhanceODataModel","odataModel","appComponent","virtualPropertyBindingRegistry","Array","fnMessage","setMessages","localAnnotationModel","JSONModel","setDefaultBindingMode","BindingMode","OneWay","baseSetProperty","baseGetProperty","propertyName","annotationType","isTransient","contextObject","MetaPath","convertTypes","externalIdProperty","getMetaPathForPath","getTarget","ExternalID","isPathAnnotationExpression","fullPath","_refreshLocalModel","refresh","externalIdPropPath","propertiesToRequest","substring","lastIndexOf","textProperty","Text","textPropPath","includes","push","requestSideEffects","then","catch","err","Log","error","pathFromRoot","clearAnnotationType","annotationTypes","dataSet","isContext","isA","endsWith","_localAnnotationModel","getLocalAnnotationModel","messages","cleanedData","getData","setData","messageTarget","getType","getMessage","fnBindProperty","bindProperty","bind","parameters","recommendationFeatureDisabled","getEnvironmentCapabilities","getCapabilities","DisableInputAssistance","recommendationPropertyBinding","setUpRecommendationLocalModelBinding","internalIdPropertyName","internalIdBinding","externalIDBinding","externalIdTextProperty","externalIDTextBinding","externalIdBinding","attachChange","requestValue","propBinding","updateRequired","expression","viewId","getVirtualBindingExpression","owner","UI5Element","getElementById","ghostControl","Any","any","compileExpression","bindBackProperty","getController","jsx","getFormatterContext","fnDestroyPropertyBinding","destroy","fnSetContext","setContext","newContext","setBindingContext","setModel","ghostBinding","getBindingInfo","binding","fnCheckUpdate","checkUpdate","forceUpdate","isContextLoaded","getBindBackProperty","valueInLocalAnnotation","getExternalValue","fnDestroy","vpBinding","evaluateVirtualExpression","promiseKeeper","PromiseKeeper","DataWatcher","valueChanged","event","resolve","getParameter","getSource","propertyBinding","promise","fetchTextFromMetaModel","text","metaModelPath","getEntityTypeAnnotation","annotation","toString","e","info","getMessagesPath","Messages","recommendationbinding","setContextOnRecommendationBinding","odataPropertyBinding","recommendationComplexProperty","isRecommendedProperty","validateRecommendationBindingPath","alreadyBound","existingBinding","setType","Raw","setBindingMode","currentContext","contextRecommendations","getValue","setRecommendationsOnLocalAnnotationModel","bindingPath","contextMetaPath","Recommendations","entityProperties","entityProperty","targetType","properties","property","recommendationObj","rejectedRecommendations","recommendedProperty","propertyRecommendations","localModelPath","placeholderValueKey","placeholderDescriptionKey","typeAheadValuesKey","propertyRecommendation","RecommendedFieldIsSuggestion","RecommendedFieldValue","RecommendedFieldDescription","_compareRecommendations","forEach","recommendations","recommendationKeys","rejectedRecommendationKeys","recommendationTypeAheadValues","rejectedRecommendationTypeAheadValues","isArray","val","getAlternateAndSecondaryKeys","alternateKeys","_fetchAlternateKeys","entityTypeOrSet","Core","AlternateKeys","alternateKey","Key","Name","_fetchSecondaryKeys","eT","SecondaryKey","secondaryKey"],"sourceRoot":".","sources":["ModelHelper.ts"],"sourcesContent":["/* This class contains helpers to be used at runtime to retrieve further information on the model */\nimport type { ComplexType, EntitySet, EntityType, Property, PropertyPath, Singleton } from \"@sap-ux/vocabularies-types\";\nimport type { FilterFunctions } from \"@sap-ux/vocabularies-types/vocabularies/Capabilities\";\nimport type { DraftNode, DraftRoot } from \"@sap-ux/vocabularies-types/vocabularies/Common\";\nimport type { AlternateKey, PropertyRef } from \"@sap-ux/vocabularies-types/vocabularies/Core\";\nimport type { StickySessionSupported } from \"@sap-ux/vocabularies-types/vocabularies/Session\";\nimport type { DeleteHidden, UpdateHidden } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport type { EntityTypeAnnotations_UI } from \"@sap-ux/vocabularies-types/vocabularies/UI_Edm\";\nimport Log from \"sap/base/Log\";\nimport { compileExpression } from \"sap/fe/base/BindingToolkit\";\nimport type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport jsx from \"sap/fe/base/jsx-runtime/jsx\";\nimport type { FEView } from \"sap/fe/core/BaseController\";\nimport Any from \"sap/fe/core/controls/Any\";\nimport DataWatcher from \"sap/fe/core/controls/DataWatcher\";\nimport type ConverterContext from \"sap/fe/core/converters/ConverterContext\";\nimport type { MetaModelActionParameter } from \"sap/fe/core/converters/MetaModelConverter\";\nimport * as MetaModelConverter from \"sap/fe/core/converters/MetaModelConverter\";\nimport { convertTypes, getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type { PageContextPathTarget } from \"sap/fe/core/converters/TemplateConverter\";\nimport MetaPath from \"sap/fe/core/helpers/MetaPath\";\nimport PromiseKeeper from \"sap/fe/core/helpers/PromiseKeeper\";\nimport { isEntitySet, isNavigationProperty, isPathAnnotationExpression } from \"sap/fe/core/helpers/TypeGuards\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport UI5Element from \"sap/ui/core/Element\";\nimport type Message from \"sap/ui/core/message/Message\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport BindingMode from \"sap/ui/model/BindingMode\";\nimport type BaseContext from \"sap/ui/model/Context\";\nimport type ContextBinding from \"sap/ui/model/ContextBinding\";\nimport type MetaModel from \"sap/ui/model/MetaModel\";\nimport type PropertyBinding from \"sap/ui/model/PropertyBinding\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport Raw from \"sap/ui/model/odata/type/Raw\";\nimport type { default as Context, default as ODataV4Context } from \"sap/ui/model/odata/v4/Context\";\nimport type { default as ODataListBinding } from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport type ODataPropertyBinding from \"sap/ui/model/odata/v4/ODataPropertyBinding\";\nimport type { ODataPropertyBinding$ChangeEvent } from \"sap/ui/model/odata/v4/ODataPropertyBinding\";\nimport type AppComponent from \"../AppComponent\";\n\n// TODO: Right now recommendations is not part of the UI vocabulary.\n// hence we are adding it to the type.\n// once this becomes part of the UI vocabulary then we can remove this.\nexport type EntityTypeAnnotations_UI_With_Recommendations = EntityTypeAnnotations_UI & {\n\tRecommendations?: {\n\t\tpath: string;\n\t};\n};\n\nconst ModelHelper = {\n\t// global switch to disable the collaboration draft by a private manifest flag\n\t// this allows customers to disable the collaboration draft in case we run into issues with the first delivery\n\t// this will be removed with the next S/4 release\n\tdisableCollaborationDraft: false,\n\t/**\n\t * Method to determine if the programming model is sticky.\n\t * @param metaModel ODataModelMetaModel to check for sticky enabled entity\n\t * @returns Returns true if sticky, else false\n\t */\n\tisStickySessionSupported: function (metaModel: ODataMetaModel): boolean {\n\t\tconst entityContainer = metaModel.getObject(\"/\");\n\t\tfor (const entitySetName in entityContainer) {\n\t\t\tif (\n\t\t\t\tentityContainer[entitySetName].$kind === \"EntitySet\" &&\n\t\t\t\tmetaModel.getObject(`/${entitySetName}@com.sap.vocabularies.Session.v1.StickySessionSupported`)\n\t\t\t) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t * Method to determine if the programming model is draft.\n\t * @param metaModel ODataModelMetaModel of the context for which draft support shall be checked\n\t * @param path Path for which draft support shall be checked\n\t * @returns Returns true if draft, else false\n\t */\n\tisDraftSupported: function (metaModel: ODataMetaModel, path: string): boolean {\n\t\tconst metaContext = metaModel.getMetaContext(path);\n\t\tconst objectPath = getInvolvedDataModelObjects<PageContextPathTarget>(metaContext);\n\t\treturn this.isObjectPathDraftSupported(objectPath);\n\t},\n\n\t/**\n\t * Checks if draft is supported for the data model object path.\n\t * @param dataModelObjectPath\n\t * @returns `true` if it is supported\n\t */\n\tisObjectPathDraftSupported: function (dataModelObjectPath: DataModelObjectPath<unknown>): boolean {\n\t\tconst currentEntitySet = dataModelObjectPath.targetEntitySet as EntitySet;\n\t\tconst bIsDraftRoot = ModelHelper.isDraftRoot(currentEntitySet);\n\t\tconst bIsDraftNode = ModelHelper.isDraftNode(currentEntitySet);\n\t\tconst bIsDraftParentEntityForContainment =\n\t\t\tisNavigationProperty(dataModelObjectPath.targetObject) &&\n\t\t\tdataModelObjectPath.targetObject?.containsTarget &&\n\t\t\t((dataModelObjectPath.startingEntitySet as EntitySet)?.annotations?.Common?.DraftRoot ||\n\t\t\t\t(dataModelObjectPath.startingEntitySet as EntitySet)?.annotations?.Common?.DraftNode)\n\t\t\t\t? true\n\t\t\t\t: false;\n\t\tconst hasIsActiveEntityKey = dataModelObjectPath.targetEntityType.keys?.some((key) => key.name === \"IsActiveEntity\");\n\t\treturn bIsDraftRoot || bIsDraftNode || (!currentEntitySet && bIsDraftParentEntityForContainment && hasIsActiveEntityKey);\n\t},\n\n\tisMetaPathDraftSupported: function (dataModelObjectPath: MetaPath<unknown>): boolean {\n\t\tconst currentEntitySet = dataModelObjectPath.getClosestEntitySet() as EntitySet;\n\t\tconst bIsDraftRoot = ModelHelper.isDraftRoot(currentEntitySet);\n\t\tconst bIsDraftNode = ModelHelper.isDraftNode(currentEntitySet);\n\t\treturn bIsDraftRoot || bIsDraftNode;\n\t},\n\n\t/**\n\t * Returns whether or not we have a ShareAction in any EntitySet of the application.\n\t * @param converterContext The instance of the converter context\n\t * @returns True if the annotation exists. False otherwise.\n\t */\n\tisCollaborationDraftSupportedFromConverterContext(converterContext: ConverterContext): boolean {\n\t\treturn converterContext.getConvertedTypes().entitySets.some((entitySet) => {\n\t\t\treturn entitySet.annotations?.Common?.DraftRoot?.ShareAction !== undefined;\n\t\t});\n\t},\n\n\t/**\n\t * Method to determine if the service, supports collaboration draft.\n\t * @param metaObject MetaObject to be used for determination\n\t * @param templateInterface API provided by UI5 templating if used\n\t * @param templateInterface.context Context of the template\n\t * @returns Returns true if the service supports collaboration draft, else false\n\t */\n\tisCollaborationDraftSupported: function (metaObject: unknown, templateInterface?: { context: Context }): boolean {\n\t\tif (!ModelHelper.disableCollaborationDraft) {\n\t\t\tconst oMetaModel = (templateInterface?.context?.getModel() || metaObject) as ODataMetaModel & {\n\t\t\t\t__$feIsCollaborationDraftEnabled?: boolean;\n\t\t\t};\n\t\t\tif (oMetaModel.__$feIsCollaborationDraftEnabled !== undefined) {\n\t\t\t\treturn oMetaModel.__$feIsCollaborationDraftEnabled;\n\t\t\t}\n\t\t\tconst oEntityContainer = oMetaModel.getObject(\"/\");\n\t\t\tfor (const sEntitySet in oEntityContainer) {\n\t\t\t\tif (\n\t\t\t\t\toEntityContainer[sEntitySet].$kind === \"EntitySet\" &&\n\t\t\t\t\toMetaModel.getObject(`/${sEntitySet}@com.sap.vocabularies.Common.v1.DraftRoot/ShareAction`)\n\t\t\t\t) {\n\t\t\t\t\toMetaModel.__$feIsCollaborationDraftEnabled = true;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t\toMetaModel.__$feIsCollaborationDraftEnabled = false;\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t * Method to get the path of the DraftRoot path according to the provided context.\n\t * @param oContext OdataModel context\n\t * @returns Returns the path of the draftRoot entity, or undefined if no draftRoot is found\n\t */\n\tgetDraftRootPath: function (oContext: Context): string | undefined {\n\t\tconst oMetaModel = oContext.getModel().getMetaModel();\n\t\tconst getRootPath = function (sPath: string, model: ODataModel, firstIteration = true): string | undefined {\n\t\t\tconst sIterationPath = firstIteration ? sPath : new RegExp(/.*(?=\\/)/).exec(sPath)?.[0]; // *Regex to get the ancestor\n\t\t\tif (sIterationPath && sIterationPath !== \"/\") {\n\t\t\t\tconst sEntityPath = oMetaModel.getMetaPath(sIterationPath);\n\t\t\t\tconst mDataModel = MetaModelConverter.getInvolvedDataModelObjects(oMetaModel.getContext(sEntityPath));\n\t\t\t\tif ((mDataModel.targetEntitySet as EntitySet)?.annotations.Common?.DraftRoot) {\n\t\t\t\t\treturn sIterationPath;\n\t\t\t\t}\n\t\t\t\treturn getRootPath(sIterationPath, model, false);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t};\n\t\treturn getRootPath(oContext.getPath(), oContext.getModel());\n\t},\n\n\t/**\n\t * Method to get the path of the StickyRoot path according to the provided context.\n\t * @param oContext OdataModel context\n\t * @returns Returns the path of the StickyRoot entity, or undefined if no StickyRoot is found\n\t */\n\tgetStickyRootPath: function (oContext: Context): string | undefined {\n\t\tconst oMetaModel = oContext.getModel().getMetaModel();\n\t\tconst getRootPath = function (sPath: string, model: ODataModel, firstIteration = true): string | undefined {\n\t\t\tconst sIterationPath = firstIteration ? sPath : new RegExp(/.*(?=\\/)/).exec(sPath)?.[0]; // *Regex to get the ancestor\n\t\t\tif (sIterationPath && sIterationPath !== \"/\") {\n\t\t\t\tconst sEntityPath = oMetaModel.getMetaPath(sIterationPath);\n\t\t\t\tconst mDataModel = MetaModelConverter.getInvolvedDataModelObjects(oMetaModel.getContext(sEntityPath));\n\t\t\t\tif (\n\t\t\t\t\tmDataModel.startingEntitySet === mDataModel.targetEntitySet &&\n\t\t\t\t\t(mDataModel.targetEntitySet as EntitySet)?.annotations?.Session?.StickySessionSupported\n\t\t\t\t) {\n\t\t\t\t\treturn sIterationPath;\n\t\t\t\t}\n\t\t\t\treturn getRootPath(sIterationPath, model, false);\n\t\t\t}\n\t\t\treturn undefined;\n\t\t};\n\t\treturn getRootPath(oContext.getPath(), oContext.getModel());\n\t},\n\t/**\n\t * Returns the path to the target entity set with navigation property binding.\n\t * @param oContext Context for which the target entity set will be determined\n\t * @returns Returns the path to the target entity set\n\t */\n\tgetTargetEntitySet: function (oContext: BaseContext): string {\n\t\tconst sPath = oContext.getPath();\n\t\tif (\n\t\t\toContext.getObject(\"$kind\") === \"EntitySet\" ||\n\t\t\toContext.getObject(\"$kind\") === \"Action\" ||\n\t\t\toContext.getObject(\"0/$kind\") === \"Action\"\n\t\t) {\n\t\t\treturn sPath;\n\t\t}\n\t\tconst sEntitySetPath = ModelHelper.getEntitySetPath(sPath);\n\t\treturn `/${oContext.getObject(sEntitySetPath)}`;\n\t},\n\n\t/**\n\t * Returns complete path to the entity set via using navigation property binding. Note: To be used only after the metamodel has loaded.\n\t * @param path Path for which complete entitySet path needs to be determined from entityType path\n\t * @param odataMetaModel Metamodel to be used.(Optional in normal scenarios, but needed for parameterized service scenarios)\n\t * @returns Returns complete path to the entity set\n\t */\n\tgetEntitySetPath: function (path: string, odataMetaModel?: ODataMetaModel): string {\n\t\tlet entitySetPath = \"\";\n\t\tif (!odataMetaModel) {\n\t\t\t// Previous implementation for getting entitySetPath from entityTypePath\n\t\t\tentitySetPath = `/${path.split(\"/\").filter(ModelHelper.filterOutNavPropBinding).join(\"/$NavigationPropertyBinding/\")}`;\n\t\t} else {\n\t\t\t// Calculating the entitySetPath from MetaModel.\n\t\t\tconst pathParts = path.split(\"/\").filter(ModelHelper.filterOutNavPropBinding);\n\t\t\tif (pathParts.length > 1) {\n\t\t\t\tconst initialPathObject = {\n\t\t\t\t\tgrowingPath: \"/\",\n\t\t\t\t\tpendingNavPropBinding: \"\"\n\t\t\t\t};\n\n\t\t\t\tconst pathObject = pathParts.reduce(\n\t\t\t\t\t(pathUnderConstruction: { growingPath: string; pendingNavPropBinding: string }, pathPart: string, idx: number) => {\n\t\t\t\t\t\tconst delimiter = (!!idx && \"/$NavigationPropertyBinding/\") || \"\";\n\t\t\t\t\t\tlet { growingPath, pendingNavPropBinding } = pathUnderConstruction;\n\t\t\t\t\t\tconst tempPath = growingPath + delimiter;\n\t\t\t\t\t\tconst navPropBindings = odataMetaModel.getObject(tempPath);\n\t\t\t\t\t\tconst navPropBindingToCheck = pendingNavPropBinding ? `${pendingNavPropBinding}/${pathPart}` : pathPart;\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tnavPropBindings &&\n\t\t\t\t\t\t\tObject.keys(navPropBindings).length > 0 &&\n\t\t\t\t\t\t\tnavPropBindings.hasOwnProperty(navPropBindingToCheck)\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\tgrowingPath = tempPath + navPropBindingToCheck.replace(\"/\", \"%2F\");\n\t\t\t\t\t\t\tpendingNavPropBinding = \"\";\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpendingNavPropBinding += pendingNavPropBinding ? `/${pathPart}` : pathPart;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn { growingPath, pendingNavPropBinding };\n\t\t\t\t\t},\n\t\t\t\t\tinitialPathObject\n\t\t\t\t);\n\n\t\t\t\tentitySetPath = pathObject.growingPath;\n\t\t\t} else {\n\t\t\t\tentitySetPath = `/${pathParts[0]}`;\n\t\t\t}\n\t\t}\n\n\t\treturn entitySetPath;\n\t},\n\n\t/**\n\t * Gets the path for the items property of MultiValueField parameters.\n\t * @param oParameter Action Parameter\n\t * @returns Returns the complete model path for the items property of MultiValueField parameters\n\t */\n\tgetActionParameterItemsModelPath: function (oParameter: MetaModelActionParameter): string | undefined {\n\t\treturn oParameter && oParameter.$Name ? `{path: 'mvfview>/${oParameter.$Name}'}` : undefined;\n\t},\n\n\tfilterOutNavPropBinding: function (sPathPart: string): boolean {\n\t\treturn sPathPart !== \"\" && sPathPart !== \"$NavigationPropertyBinding\";\n\t},\n\n\t/**\n\t * Adds a setProperty to the created binding contexts of the internal JSON model.\n\t * @param Internal JSON Model which is enhanced\n\t */\n\n\tenhanceInternalJSONModel: function (oInternalModel: JSONModel): void {\n\t\tconst fnBindContext = oInternalModel.bindContext;\n\t\toInternalModel.bindContext = function (\n\t\t\tsPath: string,\n\t\t\tcontext: BaseContext,\n\t\t\tmParameters: object | undefined,\n\t\t\toEvents: object | undefined\n\t\t): ContextBinding {\n\t\t\tconst contextBinding = fnBindContext.apply(this, [sPath, context, mParameters, oEvents]);\n\t\t\tconst fnGetBoundContext = contextBinding.getBoundContext;\n\n\t\t\tcontextBinding.getBoundContext = function (): BaseContext | null {\n\t\t\t\tconst oBoundContext = fnGetBoundContext.apply(this);\n\t\t\t\tif (oBoundContext) {\n\t\t\t\t\toBoundContext.setProperty = function (propertyPath: string, value: unknown): void {\n\t\t\t\t\t\tif (this.getObject() === undefined) {\n\t\t\t\t\t\t\t// initialize\n\t\t\t\t\t\t\tthis.getModel().setProperty(this.getPath(), {});\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst propertyPathSplit = propertyPath.split(\"/\");\n\t\t\t\t\t\tlet path = this.getPath().replace(/\\/$/, \"\"); // Remove slash if it is at the end\n\t\t\t\t\t\t// let's ensure that sub objects are initialized\n\t\t\t\t\t\tfor (let i = 0; i < propertyPathSplit.length - 1; i++) {\n\t\t\t\t\t\t\tpath = `${path}/${propertyPathSplit[i]}`;\n\t\t\t\t\t\t\tif (this.getModel().getProperty(path) === undefined) {\n\t\t\t\t\t\t\t\t// initialize\n\t\t\t\t\t\t\t\tthis.getModel().setProperty(path, {});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.getModel().setProperty(propertyPath, value, this);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\treturn oBoundContext;\n\t\t\t};\n\t\t\treturn contextBinding;\n\t\t};\n\t},\n\n\t/**\n\t * Adds an handler on propertyChange.\n\t * The property \"/editMode\" is changed according to property '/isEditable' when this last one is set\n\t * in order to be compliant with former versions where building blocks use the property \"/editMode\"\n\t * @param uiModel JSON Model which is enhanced\n\t * @param library Core library of SAP Fiori elements\n\t */\n\n\tenhanceUiJSONModel: function (uiModel: JSONModel, library: { EditMode: { Editable: string; Display: string } }): void {\n\t\tconst fnSetProperty = uiModel.setProperty;\n\t\tuiModel.setProperty = function (\n\t\t\tpath: string,\n\t\t\tvalue: unknown,\n\t\t\tcontext: BaseContext | undefined,\n\t\t\tasyncUpdate: boolean | undefined\n\t\t): boolean {\n\t\t\tif (path === \"/isEditable\") {\n\t\t\t\tuiModel.setProperty(\"/editMode\", value ? library.EditMode.Editable : library.EditMode.Display, context, asyncUpdate);\n\t\t\t}\n\t\t\treturn fnSetProperty.apply(this, [path, value, context, asyncUpdate]);\n\t\t};\n\t},\n\n\tenhanceViewJSONModel: function (viewModel: JSONModel & { _getObject: Function }): void {\n\t\tconst fnGetObject = viewModel._getObject;\n\t\tviewModel._getObject = function (sPath: string, oContext?: Context): unknown {\n\t\t\tif (sPath === undefined || sPath === \"\") {\n\t\t\t\tsPath = \"/\";\n\t\t\t}\n\t\t\treturn fnGetObject.apply(this, [sPath, oContext]);\n\t\t};\n\t},\n\t/**\n\t * Returns whether filtering on the table is case sensitive.\n\t * @param oMetaModel The instance of the meta model\n\t * @param filterFunctions Filter functions supported by the service\n\t * @returns Returns 'false' if the service supports 'tolower', else 'true'\n\t */\n\tisFilteringCaseSensitive: function (oMetaModel?: ODataMetaModel, filterFunctions?: FilterFunctions | string[]): boolean {\n\t\tconst _filterFunctions = filterFunctions ?? oMetaModel?.getObject(\"/@Org.OData.Capabilities.V1.FilterFunctions\");\n\n\t\tif (!_filterFunctions) {\n\t\t\t// if no filters function defined in service, we assume that the service is case sensitive\n\t\t\treturn true;\n\t\t}\n\n\t\treturn _filterFunctions.indexOf(\"tolower\") === -1;\n\t},\n\n\t/**\n\t * Get MetaPath for the context.\n\t * @param oContext Context to be used\n\t * @returns Returns the metapath for the context.\n\t */\n\tgetMetaPathForContext: function (oContext: Context): string {\n\t\tconst oModel = oContext.getModel(),\n\t\t\toMetaModel = oModel.getMetaModel(),\n\t\t\tsPath = oContext.getPath();\n\t\treturn oMetaModel && sPath && oMetaModel.getMetaPath(sPath);\n\t},\n\n\t/**\n\t * Get MetaPath for the context.\n\t * @param contextPath MetaPath to be used\n\t * @returns Returns the root entity set path.\n\t */\n\tgetRootEntitySetPath: function (contextPath: string): string {\n\t\tlet rootEntitySetPath = \"\";\n\t\tconst aPaths = contextPath ? contextPath.split(\"/\") : [];\n\t\tif (aPaths.length > 1) {\n\t\t\trootEntitySetPath = aPaths[1];\n\t\t}\n\t\treturn rootEntitySetPath;\n\t},\n\t/**\n\t * Get MetaPath for the listBinding.\n\t * @param oView View of the control using listBinding\n\t * @param vListBinding ODataListBinding object or the binding path for a temporary list binding\n\t * @returns Returns the metapath for the listbinding.\n\t */\n\tgetAbsoluteMetaPathForListBinding: function (oView: FEView, vListBinding: ODataListBinding | string): string {\n\t\tconst oMetaModel = oView.getModel().getMetaModel();\n\t\tlet sMetaPath;\n\n\t\tif (typeof vListBinding === \"string\") {\n\t\t\tif (vListBinding.startsWith(\"/\")) {\n\t\t\t\t// absolute path\n\t\t\t\tsMetaPath = oMetaModel.getMetaPath(vListBinding);\n\t\t\t} else {\n\t\t\t\t// relative path\n\t\t\t\tconst oBindingContext = oView.getBindingContext();\n\t\t\t\tconst sRootContextPath = oBindingContext.getPath();\n\t\t\t\tsMetaPath = oMetaModel.getMetaPath(`${sRootContextPath}/${vListBinding}`);\n\t\t\t}\n\t\t} else {\n\t\t\t// we already get a list binding use this one\n\t\t\tconst oBinding = vListBinding;\n\t\t\tconst oRootBinding = oBinding.getRootBinding();\n\t\t\tif (oBinding === oRootBinding) {\n\t\t\t\t// absolute path\n\t\t\t\tsMetaPath = oMetaModel.getMetaPath(oBinding.getPath());\n\t\t\t} else {\n\t\t\t\t// relative path\n\t\t\t\tconst sRootBindingPath = oRootBinding!.getPath();\n\t\t\t\tconst sRelativePath = oBinding.getPath();\n\t\t\t\tif (vListBinding.getContext() === oView.getBindingContext()) {\n\t\t\t\t\tsMetaPath = oMetaModel.getMetaPath(`${sRootBindingPath}/${sRelativePath}`);\n\t\t\t\t} else {\n\t\t\t\t\t//On the case of a multi value field, the context of the list binding is not the same as the view binding context.\n\t\t\t\t\t// we have to get the meta path from the context of the list binding\n\t\t\t\t\tsMetaPath = `${oMetaModel.getMetaPath(vListBinding.getContext().getPath())}/${sRelativePath}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn sMetaPath;\n\t},\n\n\t/**\n\t * Get the relative metaPath from the view for the listBinding.\n\t * @param parentContext Context of the view or the parent control\n\t * @param listBinding ODataListBinding object or the binding path for a temporary list binding\n\t * @returns Returns the metaPath for the ODataListBinding.\n\t */\n\tgetRelativeMetaPathForListBinding(parentContext: Context, listBinding: ODataListBinding): string | undefined {\n\t\tconst listBindingContext = listBinding.getContext();\n\t\tconst parentContextPath = parentContext.getPath();\n\n\t\t//For absolute path we return undefined\n\t\tif (!listBindingContext) {\n\t\t\treturn;\n\t\t}\n\t\t// if the list binding context is the parent context, we return the list binding path\n\t\tif (listBindingContext.getPath() === parentContextPath) {\n\t\t\treturn listBinding.getPath();\n\t\t}\n\t\t// if the list binding context is not the parent context, we try to find the relative path\n\t\tif (listBindingContext.getPath().startsWith(parentContextPath)) {\n\t\t\tconst metaModel = listBinding.getModel().getMetaModel();\n\t\t\tconst viewBindingMetaPath = metaModel.getMetaPath(parentContextPath);\n\t\t\treturn `${metaModel.getMetaPath(listBindingContext.getPath())}/${listBinding.getPath()}`.replace(`${viewBindingMetaPath}/`, \"\");\n\t\t}\n\t\t// otherwise, we return undefined since the list binding is not relative to the view binding context\n\t\treturn;\n\t},\n\n\t/**\n\t * Method to determine whether the argument is a draft root.\n\t * @param entitySet EntitySet | Singleton | undefined\n\t * @returns Whether the argument is a draft root\n\t */\n\tisDraftRoot: function (entitySet: EntitySet | Singleton | unknown | undefined): boolean {\n\t\treturn this.getDraftRoot(entitySet) !== undefined;\n\t},\n\n\t/**\n\t * Method to determine whether the argument is a draft node.\n\t * @param entitySet EntitySet | Singleton | undefined\n\t * @returns Whether the argument is a draft node\n\t */\n\tisDraftNode: function (entitySet: EntitySet | Singleton | unknown | undefined): boolean {\n\t\treturn this.getDraftNode(entitySet) !== undefined;\n\t},\n\n\t/**\n\t * Method to determine whether the argument is a sticky session root.\n\t * @param entitySet EntitySet | Singleton | undefined\n\t * @returns Whether the argument is a sticky session root\n\t */\n\tisSticky: function (entitySet: EntitySet | Singleton | undefined): boolean {\n\t\treturn this.getStickySession(entitySet) !== undefined;\n\t},\n\n\t/**\n\t * Method to determine if entity is updatable or not.\n\t * @param entitySet EntitySet | Singleton | undefined\n\t * @param entityType EntityType\n\t * @returns True if updatable else false\n\t */\n\tisUpdateHidden: function (entitySet: EntitySet | Singleton | undefined, entityType: EntityType): UpdateHidden | undefined {\n\t\tif (isEntitySet(entitySet)) {\n\t\t\treturn entitySet.annotations.UI?.UpdateHidden ?? entityType?.annotations.UI?.UpdateHidden;\n\t\t}\n\t},\n\t/**\n\t * Gets the @Common.DraftRoot annotation if the argument is an EntitySet.\n\t * @param entitySet EntitySet | Singleton | undefined\n\t * @returns DraftRoot\n\t */\n\tgetDraftRoot: function (entitySet: EntitySet | Singleton | unknown | undefined): DraftRoot | undefined {\n\t\treturn isEntitySet(entitySet) ? entitySet.annotations.Common?.DraftRoot : undefined;\n\t},\n\n\t/**\n\t * Gets the @Common.DraftNode annotation if the argument is an EntitySet.\n\t * @param entitySet EntitySet | Singleton | undefined\n\t * @returns DraftRoot\n\t */\n\tgetDraftNode: function (entitySet: EntitySet | Singleton | unknown | undefined): DraftNode | undefined {\n\t\treturn isEntitySet(entitySet) ? entitySet.annotations.Common?.DraftNode : undefined;\n\t},\n\n\t/**\n\t * Helper method to get sticky session.\n\t * @param entitySet EntitySet | Singleton | undefined\n\t * @returns Session StickySessionSupported\n\t */\n\tgetStickySession: function (entitySet: EntitySet | Singleton | unknown | undefined): StickySessionSupported | undefined {\n\t\treturn isEntitySet(entitySet) ? entitySet.annotations.Session?.StickySessionSupported : undefined;\n\t},\n\n\t/**\n\t * Method to get the visibility state of delete button.\n\t * @param entitySet EntitySet | Singleton | undefined\n\t * @param entityType EntityType\n\t * @returns True if delete button is hidden\n\t */\n\tgetDeleteHidden: function (entitySet: EntitySet | Singleton | undefined, entityType: EntityType): DeleteHidden | undefined {\n\t\tif (isEntitySet(entitySet)) {\n\t\t\treturn entitySet.annotations.UI?.DeleteHidden ?? entityType.annotations.UI?.DeleteHidden;\n\t\t}\n\t},\n\t/**\n\t * This function will return metapath for the given list binding.\n\t * @param listBinding ListBinding.\n\t * @returns MetaPath\n\t */\n\tgetAbsolutePathFromListBinding(listBinding: ODataListBinding): string {\n\t\tconst metamodel = listBinding.getModel().getMetaModel();\n\t\tlet metaPath;\n\t\tconst rootBinding = listBinding.getRootBinding();\n\t\tif (listBinding === rootBinding) {\n\t\t\tmetaPath = metamodel.getMetaPath(listBinding.getPath());\n\t\t} else {\n\t\t\tconst rootBindingPath = rootBinding?.getPath();\n\t\t\tconst relativePath = listBinding.getPath();\n\t\t\tmetaPath = metamodel.getMetaPath(`${rootBindingPath}/${relativePath}`);\n\t\t}\n\t\treturn metaPath;\n\t},\n\n\tenhanceODataModel(odataModel: ODataModel, appComponent: AppComponent): void {\n\t\todataModel.virtualPropertyBindingRegistry = new Array<ODataPropertyBinding>();\n\t\tconst fnMessage = odataModel.setMessages;\n\t\tconst localAnnotationModel = new JSONModel({});\n\t\tlocalAnnotationModel.setDefaultBindingMode(BindingMode.OneWay);\n\t\tconst baseSetProperty = localAnnotationModel.setProperty;\n\t\tconst baseGetProperty = localAnnotationModel.getProperty;\n\t\tlocalAnnotationModel.getProperty = function (path, context: ODataV4Context): unknown {\n\t\t\tconst [propertyName, annotationType] = path.split(\"@$ui5.fe.\");\n\n\t\t\tif (context && context.isTransient() !== true && annotationType === \"@Common/ExternalID\") {\n\t\t\t\tconst contextObject = context.getObject();\n\t\t\t\tif (contextObject) {\n\t\t\t\t\tconst metaPath = new MetaPath<EntitySet>(\n\t\t\t\t\t\tconvertTypes(odataModel.getMetaModel()),\n\t\t\t\t\t\todataModel.getMetaModel().getMetaPath(context.getPath()),\n\t\t\t\t\t\todataModel.getMetaModel().getMetaPath(context.getPath())\n\t\t\t\t\t);\n\t\t\t\t\tconst externalIdProperty = metaPath.getMetaPathForPath<Property>(metaPath.getPath() + \"/\" + propertyName)?.getTarget()\n\t\t\t\t\t\t.annotations.Common?.ExternalID;\n\n\t\t\t\t\tif (isPathAnnotationExpression(externalIdProperty)) {\n\t\t\t\t\t\treturn context.getObject(externalIdProperty.path);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn context.getObject(propertyName);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn undefined;\n\t\t\t\t}\n\t\t\t} else if (context && annotationType === \"contextPath\") {\n\t\t\t\treturn context.getPath();\n\t\t\t}\n\n\t\t\treturn baseGetProperty.apply(this, [path, context]);\n\t\t};\n\n\t\tlocalAnnotationModel.setProperty = function (path, value, context, asyncUpdate): boolean {\n\t\t\tlet fullPath = path;\n\t\t\tif (context) {\n\t\t\t\tfullPath = context.getPath(path);\n\t\t\t}\n\t\t\tconst _refreshLocalModel = (): void => {\n\t\t\t\tthis.refresh();\n\t\t\t};\n\t\t\tconst [propertyName, annotationType] = path.split(\"@$ui5.fe.\");\n\t\t\tif (context && annotationType === \"@Common/ExternalID\") {\n\t\t\t\tcontext.setProperty(propertyName, value);\n\t\t\t\t// refreshing ExternalID and text properties (paths need to be determined generically)\n\t\t\t\tconst metaPath = new MetaPath<EntitySet>(\n\t\t\t\t\tconvertTypes(odataModel.getMetaModel()),\n\t\t\t\t\todataModel.getMetaModel().getMetaPath(context.getPath()),\n\t\t\t\t\todataModel.getMetaModel().getMetaPath(context.getPath())\n\t\t\t\t);\n\t\t\t\tconst externalIdProperty = metaPath.getMetaPathForPath<Property>(metaPath.getPath() + \"/\" + propertyName)?.getTarget()\n\t\t\t\t\t.annotations.Common?.ExternalID;\n\n\t\t\t\tif (isPathAnnotationExpression(externalIdProperty)) {\n\t\t\t\t\tconst externalIdPropPath = externalIdProperty.path;\n\t\t\t\t\tconst propertiesToRequest = [externalIdPropPath.substring(0, externalIdPropPath.lastIndexOf(\"/\"))];\n\t\t\t\t\tconst textProperty = metaPath.getMetaPathForPath<Property>(metaPath.getPath() + \"/\" + externalIdPropPath)?.getTarget()\n\t\t\t\t\t\t.annotations.Common?.Text;\n\t\t\t\t\tif (isPathAnnotationExpression(textProperty)) {\n\t\t\t\t\t\tconst textPropPath = textProperty.path;\n\t\t\t\t\t\tif (textPropPath.includes(\"/\")) {\n\t\t\t\t\t\t\tpropertiesToRequest.push(textPropPath);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t(context as ODataV4Context)\n\t\t\t\t\t\t.requestSideEffects(propertiesToRequest)\n\t\t\t\t\t\t.then(_refreshLocalModel)\n\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\tLog.error(err as string);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst propertyPathSplit = fullPath.split(\"/\");\n\t\t\t// let's ensure that sub objects are initialized\n\t\t\tlet pathFromRoot = \"\";\n\t\t\tfor (let i = 0; i < propertyPathSplit.length - 1; i++) {\n\t\t\t\tif (i > 0) {\n\t\t\t\t\tpathFromRoot += \"/\";\n\t\t\t\t}\n\t\t\t\tpathFromRoot += propertyPathSplit[i];\n\t\t\t\tif (this.getObject(pathFromRoot) === undefined) {\n\t\t\t\t\t// initialize\n\t\t\t\t\tthis.setProperty(pathFromRoot, {});\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn baseSetProperty.apply(this, [path, value, context, asyncUpdate]);\n\t\t};\n\t\tfunction clearAnnotationType(annotationTypes: string[], dataSet: Record<string, unknown>): object {\n\t\t\tfor (const contextPath in dataSet) {\n\t\t\t\t// we added a context for accepting recommendations eventually.\n\t\t\t\t// the context is a deeply nested object iterating over it cause the code the break\n\t\t\t\t// hence we are skipping it here.\n\t\t\t\tconst context = dataSet?.[contextPath] as ODataV4Context;\n\t\t\t\tconst isContext = context?.isA?.(\"sap.ui.model.odata.v4.Context\");\n\t\t\t\tif (typeof context === \"object\" && !isContext) {\n\t\t\t\t\tdataSet[contextPath] = clearAnnotationType(annotationTypes, dataSet[contextPath] as Record<string, unknown>);\n\t\t\t\t\tif (dataSet[contextPath] && Object.keys(dataSet[contextPath] as object).length === 0) {\n\t\t\t\t\t\tdelete dataSet[contextPath];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor (const annotationType of annotationTypes) {\n\t\t\t\t\tif (contextPath.endsWith(annotationType)) {\n\t\t\t\t\t\tdelete dataSet[contextPath];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn dataSet;\n\t\t}\n\t\todataModel._localAnnotationModel = localAnnotationModel;\n\t\todataModel.getLocalAnnotationModel = function (): JSONModel {\n\t\t\treturn this._localAnnotationModel;\n\t\t};\n\t\todataModel.setMessages = function (messages: Record<string, Message[]>): void {\n\t\t\tconst cleanedData = clearAnnotationType([\"@$ui5.fe.messageType\", \"@$ui5.fe.messageText\"], this._localAnnotationModel.getData());\n\t\t\tthis._localAnnotationModel.setData(cleanedData);\n\t\t\tfor (const messageTarget in messages) {\n\t\t\t\tthis._localAnnotationModel.setProperty(`${messageTarget}@$ui5.fe.messageType`, messages[messageTarget][0].getType());\n\t\t\t\tthis._localAnnotationModel.setProperty(`${messageTarget}@$ui5.fe.messageText`, messages[messageTarget][0].getMessage());\n\t\t\t}\n\t\t\tfnMessage.apply(this, [messages]);\n\t\t};\n\t\tconst fnBindProperty = odataModel.bindProperty.bind(odataModel);\n\t\todataModel.bindProperty = function (path: string, context: ODataV4Context, parameters): ODataPropertyBinding {\n\t\t\tconst recommendationFeatureDisabled = appComponent.getEnvironmentCapabilities()?.getCapabilities?.().DisableInputAssistance;\n\t\t\tconst recommendationPropertyBinding = ModelHelper.setUpRecommendationLocalModelBinding(\n\t\t\t\tthis,\n\t\t\t\tfnBindProperty,\n\t\t\t\tpath,\n\t\t\t\tcontext,\n\t\t\t\trecommendationFeatureDisabled\n\t\t\t);\n\t\t\tif (recommendationPropertyBinding) {\n\t\t\t\treturn recommendationPropertyBinding as ODataPropertyBinding;\n\t\t\t}\n\t\t\tif (path.endsWith(\"@$ui5.fe.@Common/ExternalID\") && context) {\n\t\t\t\tconst internalIdPropertyName = path.split(\"@$ui5.fe.\")[0];\n\t\t\t\tconst internalIdBinding = fnBindProperty(internalIdPropertyName, context);\n\t\t\t\tconst metaPath = new MetaPath<EntitySet>(\n\t\t\t\t\tconvertTypes(odataModel.getMetaModel()),\n\t\t\t\t\todataModel.getMetaModel().getMetaPath(context.getPath()),\n\t\t\t\t\todataModel.getMetaModel().getMetaPath(context.getPath())\n\t\t\t\t);\n\n\t\t\t\tconst externalIdProperty = metaPath\n\t\t\t\t\t.getMetaPathForPath<Property>(metaPath.getPath() + \"/\" + internalIdPropertyName)\n\t\t\t\t\t?.getTarget().annotations.Common?.ExternalID;\n\n\t\t\t\tif (isPathAnnotationExpression(externalIdProperty)) {\n\t\t\t\t\tconst externalIDBinding = fnBindProperty(externalIdProperty.path, context);\n\t\t\t\t\todataModel.virtualPropertyBindingRegistry.push(externalIDBinding);\n\t\t\t\t\tconst externalIdTextProperty = metaPath\n\t\t\t\t\t\t.getMetaPathForPath<Property>(externalIDBinding.getContext()?.getPath() + \"/\" + externalIdProperty.path)\n\t\t\t\t\t\t?.getTarget().annotations.Common?.Text;\n\t\t\t\t\tif (isPathAnnotationExpression(externalIdTextProperty)) {\n\t\t\t\t\t\tconst externalIDTextBinding = fnBindProperty(externalIdTextProperty.path, context);\n\t\t\t\t\t\todataModel.virtualPropertyBindingRegistry.push(externalIDTextBinding);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconst externalIdBinding = this._localAnnotationModel.bindProperty(path, context) as unknown as ODataPropertyBinding;\n\n\t\t\t\tinternalIdBinding.attachChange(() => {\n\t\t\t\t\texternalIdBinding.refresh();\n\t\t\t\t});\n\t\t\t\tinternalIdBinding\n\t\t\t\t\t.requestValue()\n\t\t\t\t\t.then(() => {\n\t\t\t\t\t\texternalIdBinding.refresh();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t})\n\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\tLog.error(err as string);\n\t\t\t\t\t});\n\t\t\t\treturn externalIdBinding;\n\t\t\t}\n\t\t\tif (path.includes(\"@$ui5.fe.\")) {\n\t\t\t\tconst propBinding = this._localAnnotationModel.bindProperty(path, context) as ODataPropertyBinding & {\n\t\t\t\t\tsetContext?: Function;\n\t\t\t\t};\n\t\t\t\tif (path.endsWith(\"@$ui5.fe.@Common/ExternalID\")) {\n\t\t\t\t\treturn propBinding;\n\t\t\t\t}\n\t\t\t\tpropBinding.updateRequired = function (model: object): boolean {\n\t\t\t\t\treturn model && model === odataModel;\n\t\t\t\t};\n\t\t\t\tif (path.includes(\"@$ui5.fe.virtual.\")) {\n\t\t\t\t\tconst { expression, viewId } = MetaModelConverter.getVirtualBindingExpression(\n\t\t\t\t\t\tpath,\n\t\t\t\t\t\tMetaModelConverter.convertTypes(this.getMetaModel())\n\t\t\t\t\t);\n\t\t\t\t\tconst owner = viewId ? (UI5Element.getElementById(viewId) as View) : undefined;\n\t\t\t\t\tconst ghostControl = new Any(\n\t\t\t\t\t\t{ any: compileExpression(expression), bindBackProperty: path },\n\t\t\t\t\t\towner?.getController() ?? jsx.getFormatterContext()\n\t\t\t\t\t);\n\t\t\t\t\tconst fnDestroyPropertyBinding = propBinding.destroy.bind(propBinding);\n\t\t\t\t\tpropBinding.destroy = (): void => {\n\t\t\t\t\t\tghostControl?.destroy();\n\t\t\t\t\t\treturn fnDestroyPropertyBinding();\n\t\t\t\t\t};\n\t\t\t\t\tconst fnSetContext = propBinding.setContext;\n\t\t\t\t\tif (fnSetContext) {\n\t\t\t\t\t\tpropBinding.setContext = (newContext: Context): void => {\n\t\t\t\t\t\t\tghostControl?.setBindingContext(newContext);\n\t\t\t\t\t\t\treturn fnSetContext.bind(propBinding)(newContext);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\n\t\t\t\t\tghostControl.setModel(this);\n\t\t\t\t\tconst ghostBinding = ghostControl.getBindingInfo(\"any\")?.binding;\n\t\t\t\t\tconst fnCheckUpdate = ghostBinding?.checkUpdate;\n\t\t\t\t\tif (fnCheckUpdate) {\n\t\t\t\t\t\tghostControl.getBindingInfo(\"any\").binding.checkUpdate = (forceUpdate: boolean): void => {\n\t\t\t\t\t\t\t// We need to force the update only if the ghost control is bound to a context\n\t\t\t\t\t\t\t// and the value in the local annotation model is different from the external value.\n\t\t\t\t\t\t\t// This is to ensure that the ghost control is updated only when necessary.\n\t\t\t\t\t\t\tconst isContextLoaded = ghostControl.getBindingContext()?.getObject() !== undefined;\n\t\t\t\t\t\t\tconst bindBackProperty = ghostControl.getBindBackProperty();\n\t\t\t\t\t\t\tconst valueInLocalAnnotation = isContextLoaded\n\t\t\t\t\t\t\t\t? localAnnotationModel.getProperty(ghostControl.getBindingContext()!.getPath(bindBackProperty))\n\t\t\t\t\t\t\t\t: undefined;\n\t\t\t\t\t\t\treturn fnCheckUpdate.bind(ghostBinding)(\n\t\t\t\t\t\t\t\tforceUpdate ||\n\t\t\t\t\t\t\t\t\t(bindBackProperty && isContextLoaded && ghostBinding.getExternalValue() !== valueInLocalAnnotation)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tghostControl.setBindingContext(context);\n\t\t\t\t}\n\t\t\t\treturn propBinding;\n\t\t\t}\n\t\t\treturn fnBindProperty(path, context, parameters);\n\t\t};\n\t\tconst fnDestroy = odataModel.destroy.bind(odataModel);\n\t\todataModel.destroy = function (): void {\n\t\t\tfor (const vpBinding of odataModel.virtualPropertyBindingRegistry) {\n\t\t\t\tvpBinding.destroy();\n\t\t\t}\n\t\t\tthis._localAnnotationModel.destroy();\n\t\t\treturn fnDestroy.apply(this);\n\t\t};\n\t},\n\n\t/**\n\t * Evaluates a virtual binding expression and returns the result as a promise.\n\t * @param path The path to the virtual property\n\t * @param context The binding context to be used for evaluation\n\t * @returns A promise that resolves with the evaluated value\n\t */\n\tasync evaluateVirtualExpression<T>(path: string, context: ODataV4Context): Promise<T> {\n\t\tconst promiseKeeper = new PromiseKeeper<T>();\n\t\tconst { expression, viewId } = MetaModelConverter.getVirtualBindingExpression(\n\t\t\tpath,\n\t\t\tMetaModelConverter.convertTypes(context.getModel().getMetaModel())\n\t\t);\n\t\tconst owner = viewId ? (UI5Element.getElementById(viewId) as View) : undefined;\n\t\tconst ghostControl = new DataWatcher(\n\t\t\t{\n\t\t\t\tvalueChanged: function (event): void {\n\t\t\t\t\tpromiseKeeper.resolve(event.getParameter(\"value\") as T);\n\t\t\t\t\tevent.getSource().destroy();\n\t\t\t\t},\n\t\t\t\tpropertyBinding: compileExpression(expression)\n\t\t\t},\n\t\t\t(owner?.getController() ?? jsx.getFormatterContext()) as PropertiesOf<DataWatcher>\n\t\t);\n\t\tghostControl.setBindingContext(context);\n\t\tghostControl.setModel(context.getModel());\n\n\t\treturn promiseKeeper.promise;\n\t},\n\n\t/**\n\t * Resolves a metadata binding to its text, either using the converterContext or the metaModel directly.\n\t * @param path\n\t * @param converterContext\n\t * @param metaModel\n\t * @returns The resolved text if possible, else the input value or an empty string if the path was undefined\n\t */\n\tfetchTextFromMetaModel(path: string | undefined, converterContext?: ConverterContext<unknown>, metaModel?: MetaModel): string {\n\t\tlet text = path !== undefined ? path : \"\";\n\t\tif (path?.startsWith(\"{metaModel>\")) {\n\t\t\tconst metaModelPath = path.substring(11, path.length - 1);\n\t\t\ttry {\n\t\t\t\tif (converterContext) {\n\t\t\t\t\ttext = converterContext.getEntityTypeAnnotation(metaModelPath).annotation?.toString() ?? \"\";\n\t\t\t\t} else {\n\t\t\t\t\ttext = metaModel?.getObject(metaModelPath);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\tLog.info(`Unable to retrieve text from meta model using path ${metaModelPath}`);\n\t\t\t}\n\t\t}\n\t\treturn text;\n\t},\n\n\t/**\n\t * Method to retrieve the property path corresponding to state messages.\n\t * @param metaModel The metamodel\n\t * @param contextPath Path for the context on which we what to retreive the message path\n\t * @returns Returns the property path, or undefined if no Messages annotation is defined\n\t */\n\tgetMessagesPath: function (metaModel: ODataMetaModel, contextPath: string): string | undefined {\n\t\tconst metaContext = metaModel.getMetaContext(contextPath);\n\t\tconst objectPath = getInvolvedDataModelObjects(metaContext);\n\t\tconst messages = objectPath.targetEntityType.annotations.Common?.Messages;\n\t\treturn isPathAnnotationExpression(messages) ? messages.path : undefined;\n\t},\n\t/**\n\t * Setup recommendation local binding to make recommendations accessible via client side instance annotations.\n\t *\n\t * Recommendations is a complex property.\n\t * Model does not provide an easy way to bind to complex properties. It has 2 major limitations.\n\t *\n\t * It only supports one time binding to complex properties. This is needed to show updated recommendations on the UI.\n\t * It does not support bindings to properties inside a complex property which is needed for recommendations.\n\t *\n\t * This function provides a workaround to overcome the above two short comings and\n\t * to support client side instance annotations for recommendations.\n\t * @param odataModel The odata model instance.\n\t * @param fnBindProperty Original bind property of the oDataModel\n\t * @param path Binding path for which recommendation is being requested\n\t * @param context Context where recommendation is being requested\n\t * @param recommendationFeatureDisabled Flag which toggles the recommendation feature\n\t * @returns Recommendation property path for the entity related to the context and whether the bindingPath is relevant or not based on metadata.\n\t */\n\tsetUpRecommendationLocalModelBinding: function (\n\t\todataModel: ODataModel,\n\t\tfnBindProperty: Function,\n\t\tpath: string,\n\t\tcontext: ODataV4Context,\n\t\trecommendationFeatureDisabled: boolean\n\t): PropertyBinding | undefined {\n\t\tif (path.includes(\"ui5.fe.recommendations\")) {\n\t\t\tconst recommendationbinding = odataModel.getLocalAnnotationModel().bindProperty(path, context) as ODataPropertyBinding & {\n\t\t\t\tsetContext: Function;\n\t\t\t};\n\t\t\tconst setContextOnRecommendationBinding = (odataPropertyBinding: ODataPropertyBinding & { setContext: Function }): void => {\n\t\t\t\t//we make sure the parent context is set to the propertybinding\n\t\t\t\tconst fnSetContext = recommendationbinding.setContext;\n\t\t\t\tif (fnSetContext) {\n\t\t\t\t\trecommendationbinding.setContext = (newContext: Context): void => {\n\t\t\t\t\t\todataPropertyBinding?.setContext(newContext);\n\t\t\t\t\t\tfnSetContext.bind(odataPropertyBinding)(newContext);\n\t\t\t\t\t\treturn fnSetContext.bind(recommendationbinding)(newContext);\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t};\n\t\t\tif (context) {\n\t\t\t\tconst { recommendationComplexProperty, isRecommendedProperty } = ModelHelper.validateRecommendationBindingPath(\n\t\t\t\t\tcontext,\n\t\t\t\t\tpath\n\t\t\t\t);\n\t\t\t\tif (recommendationComplexProperty && isRecommendedProperty && !recommendationFeatureDisabled) {\n\t\t\t\t\tconst alreadyBound = odataModel.virtualPropertyBindingRegistry.some((existingBinding) => {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t// We do not want the binding to the complex property to be created too many times\n\t\t\t\t\t\t\t// hence we rely on checking whether the contexts are same or not before creating a binding.\n\t\t\t\t\t\t\tcontext === existingBinding.getContext() && recommendationComplexProperty === existingBinding.getPath()\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t\tif (!alreadyBound) {\n\t\t\t\t\t\tconst odataPropertyBinding = fnBindProperty(recommendationComplexProperty, context) as ODataPropertyBinding & {\n\t\t\t\t\t\t\tsetContext: Function;\n\t\t\t\t\t\t};\n\t\t\t\t\t\t// Becuase recommendations is a complex property and not a primitive type hence use a raw type.\n\t\t\t\t\t\todataPropertyBinding.setType(new Raw(), \"any\");\n\t\t\t\t\t\todataPropertyBinding.setBindingMode(BindingMode.OneWay);\n\t\t\t\t\t\todataModel.virtualPropertyBindingRegistry.push(odataPropertyBinding);\n\t\t\t\t\t\todataPropertyBinding.attachChange((event: ODataPropertyBinding$ChangeEvent) => {\n\t\t\t\t\t\t\t// refresh the local annotation binding once recommendation binding is updated.\n\t\t\t\t\t\t\tconst propertyBinding = event.getSource();\n\t\t\t\t\t\t\tconst currentContext = event.getSource().getContext() as ODataV4Context;\n\t\t\t\t\t\t\tif (currentContext) {\n\t\t\t\t\t\t\t\tconst contextRecommendations = propertyBinding.getValue();\n\t\t\t\t\t\t\t\tModelHelper.setRecommendationsOnLocalAnnotationModel(contextRecommendations, currentContext);\n\t\t\t\t\t\t\t\trecommendationbinding.refresh();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t\t// reuestValue will add the recommendation property to the $select\n\t\t\t\t\t\t// hence we do not need to add it to the $select when constructing the binding at various places (forms, table etc.)\n\t\t\t\t\t\todataPropertyBinding.requestValue().catch((error) => {\n\t\t\t\t\t\t\tLog.error(\"Recommendations could not be resolved\", error);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tsetContextOnRecommendationBinding(odataPropertyBinding);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// We need to ensure that the binding becomes invalid and a new binding is created so the recommendation property binding can be created.\n\t\t\t//\n\t\t\t// For this we need to override updateRequired so that the binding is updated until it has not received a context\n\t\t\t// post that we do not need the binding to be updated.\n\t\t\t// If we remove the updateRequired override then recommendations work fine by during save of a newly created document\n\t\t\t// we get binding related issues.\n\t\t\t//\n\t\t\t// Updating the binding to recommendations will be done by setProperty on the localAnnotationModel\n\t\t\t// when the recommendation property is actually updated.\n\t\t\trecommendationbinding.updateRequired = function (model: object): boolean {\n\t\t\t\treturn this.getContext() ? model && model === odataModel : model && this.getModel() === model;\n\t\t\t};\n\t\t\treturn recommendationbinding;\n\t\t}\n\t},\n\t/**\n\t * Validates based on metadata whether a given binding should deal with recommendations or not.\n\t * @param context Context where recommendation is being requested.\n\t * @param bindingPath Binding path for which recommendation is being requested.\n\t * @returns Recommendation property path for the entity related to the context and whether the bindingPath is relevant or not based on metadata.\n\t */\n\tvalidateRecommendationBindingPath: function (\n\t\tcontext: ODataV4Context,\n\t\tbindingPath: string\n\t): { recommendationComplexProperty: string | undefined; isRecommendedProperty: boolean } {\n\t\tconst metaModel = context.getModel().getMetaModel();\n\t\tconst contextMetaPath = metaModel.getMetaPath(context.getPath());\n\t\tconst metaContext = metaModel.getMetaContext(contextMetaPath);\n\t\tconst targetEntityType = getInvolvedDataModelObjects(metaContext).targetEntityType;\n\t\tconst recommendationComplexProperty = (targetEntityType?.annotations?.UI as EntityTypeAnnotations_UI_With_Recommendations)\n\t\t\t?.Recommendations?.path;\n\t\t// sample binding - ShippingCondition@$ui5.fe.recommendations.placeholderValue\n\t\tconst propertyPath = bindingPath.split(\"@$ui5.fe.recommendations\")[0];\n\t\tconst isRecommendedProperty = targetEntityType.entityProperties.some((entityProperty) => {\n\t\t\tif (entityProperty.name === recommendationComplexProperty) {\n\t\t\t\treturn (entityProperty?.targetType as ComplexType)?.properties.some((property) => {\n\t\t\t\t\treturn propertyPath === property.name;\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t\treturn {\n\t\t\trecommendationComplexProperty,\n\t\t\tisRecommendedProperty\n\t\t};\n\t},\n\t/**\n\t * Update recommendation client side instance annotations.\n\t * @param contextRecommendations Updated recommendations.\n\t * @param currentContext Context where recommendation was updated.\n\t */\n\tsetRecommendationsOnLocalAnnotationModel: function (contextRecommendations: Recommendations, currentContext: ODataV4Context): void {\n\t\tif (contextRecommendations) {\n\t\t\tconst localAnnotationModel = currentContext.getModel().getLocalAnnotationModel();\n\t\t\tconst recommendationObj: Record<string, unknown> = {};\n\t\t\tconst rejectedRecommendations = localAnnotationModel.getProperty(\"/rejectedRecommendations\") || {};\n\t\t\tfor (const recommendedProperty in contextRecommendations) {\n\t\t\t\tconst propertyRecommendations = contextRecommendations[recommendedProperty];\n\t\t\t\tconst localModelPath = recommendedProperty;\n\t\t\t\tconst placeholderValueKey = localModelPath + \"@$ui5.fe.recommendations.placeholderValue\";\n\t\t\t\tconst placeholderDescriptionKey = localModelPath + \"@$ui5.fe.recommendations.placeholderDescription\";\n\t\t\t\tconst typeAheadValuesKey = localModelPath + \"@$ui5.fe.recommendations.typeAheadValues\";\n\n\t\t\t\trecommendationObj[typeAheadValuesKey] = [];\n\n\t\t\t\tfor (const propertyRecommendation of propertyRecommendations) {\n\t\t\t\t\tif (propertyRecommendation.RecommendedFieldIsSuggestion) {\n\t\t\t\t\t\trecommendationObj[placeholderValueKey] = propertyRecommendation.RecommendedFieldValue;\n\t\t\t\t\t\trecommendationObj[placeholderDescriptionKey] = propertyRecommendation.RecommendedFieldDescription;\n\t\t\t\t\t}\n\t\t\t\t\tif (propertyRecommendation.RecommendedFieldValue) {\n\t\t\t\t\t\t(recommendationObj[typeAheadValuesKey] as string[]).push(propertyRecommendation.RecommendedFieldValue);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (!propertyRecommendations || !propertyRecommendations.length) {\n\t\t\t\t\trecommendationObj[placeholderValueKey] = null;\n\t\t\t\t\trecommendationObj[placeholderDescriptionKey] = \"\";\n\t\t\t\t}\n\t\t\t}\n\t\t\trecommendationObj[\"recommendationContext\"] = currentContext;\n\t\t\tif (!this._compareRecommendations(recommendationObj, rejectedRecommendations[currentContext.getPath()] || {})) {\n\t\t\t\tObject.keys(recommendationObj).forEach((key) => {\n\t\t\t\t\tconst fullPath = currentContext.getPath(key);\n\t\t\t\t\t// Set the final value at the last path\n\t\t\t\t\tlocalAnnotationModel.setProperty(fullPath, recommendationObj[key], currentContext, false);\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t},\n\n\t_compareRecommendations: function (\n\t\trecommendations: Record<string, unknown>,\n\t\trejectedRecommendations: Record<string, unknown>\n\t): boolean {\n\t\tconst recommendationKeys = Object.keys(recommendations).filter((key) => key !== \"recommendationContext\");\n\t\tconst rejectedRecommendationKeys = Object.keys(rejectedRecommendations).filter((key) => key !== \"recommendationContext\");\n\t\tif (recommendationKeys.length !== rejectedRecommendationKeys.length) {\n\t\t\treturn false;\n\t\t}\n\t\tfor (const key of recommendationKeys) {\n\t\t\tif (!rejectedRecommendationKeys.includes(key)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tif (key.includes(\"ui5.fe.recommendations.typeAheadValues\")) {\n\t\t\t\tconst recommendationTypeAheadValues = recommendations[key] as unknown[];\n\t\t\t\tconst rejectedRecommendationTypeAheadValues = rejectedRecommendations[key] as unknown[];\n\t\t\t\tif (\n\t\t\t\t\t!Array.isArray(recommendationTypeAheadValues) ||\n\t\t\t\t\t!Array.isArray(rejectedRecommendationTypeAheadValues) ||\n\t\t\t\t\trecommendationTypeAheadValues.length !== rejectedRecommendationTypeAheadValues.length ||\n\t\t\t\t\trecommendationTypeAheadValues.some((val, idx) => val !== rejectedRecommendationTypeAheadValues[idx])\n\t\t\t\t) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t} else if (recommendations[key] !== rejectedRecommendations[key]) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t},\n\t/**\n\t * Fetches the SecondaryKeys from entitytype.\n\t * @param entityType Datamodel object of entityType\n\t * @param entitySet Datamodel object of entitySet\n\t * @returns An array of alternate keys\n\t */\n\tgetAlternateAndSecondaryKeys: (entityType: EntityType, entitySet: EntitySet): string[] => {\n\t\tconst alternateKeys: string[] = [];\n\t\tconst _fetchAlternateKeys = (entityTypeOrSet: EntitySet | EntityType): void => {\n\t\t\tentityTypeOrSet?.annotations?.Core?.AlternateKeys?.forEach((alternateKey: AlternateKey) => {\n\t\t\t\talternateKey.Key.forEach((key: PropertyRef) => {\n\t\t\t\t\talternateKeys.push(key.Name.value);\n\t\t\t\t});\n\t\t\t});\n\t\t};\n\t\tconst _fetchSecondaryKeys = (eT: EntityType): void => {\n\t\t\teT?.annotations?.Common?.SecondaryKey?.forEach((secondaryKey: PropertyPath) => {\n\t\t\t\tif (!alternateKeys.includes(secondaryKey.value)) {\n\t\t\t\t\talternateKeys.push(secondaryKey.value);\n\t\t\t\t}\n\t\t\t});\n\t\t};\n\t\t_fetchAlternateKeys(entitySet);\n\t\tif (!alternateKeys.length) {\n\t\t\t_fetchAlternateKeys(entityType);\n\t\t}\n\t\t_fetchSecondaryKeys(entityType);\n\t\treturn alternateKeys;\n\t}\n};\n\ntype Recommendations = Record<string, RecommendationDetails[]>;\ntype RecommendationDetails = {\n\tRecommendedFieldValue: string;\n\tRecommendedFieldIsSuggestion: boolean;\n\tRecommendedFieldDescription: string;\n};\n\nexport type InternalModelContext = { getModel(): JSONModel } & BaseContext & {\n\t\tsetProperty(sPath: string, vValue: unknown): void;\n\t};\n\nexport default ModelHelper;\n"],"mappings":"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","ignoreList":[],"file":"ModelHelper-dbg.js"}