{"version":3,"file":"DynamicAnnotationPathHelper.js","names":["getObject","oObject","sPath","sPathSplit","split","length","splice","join","resolveDynamicExpression","sAnnotationPath","oMetaModel","includes","firstBracket","indexOf","sStableBracket","substring","sRest","lastBracket","aValue","oExpression","BindingParser","parseExpression","Array","isArray","result","parts","path","i","bFound","oObjectValue","bResult","formatter","_exports"],"sources":["./DynamicAnnotationPathHelper.ts"],"sourcesContent":["import BindingParser from \"sap/ui/base/BindingParser\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\nfunction getObject(oObject: Record<string, unknown>, sPath: string): unknown {\n\tif (!oObject) {\n\t\treturn null;\n\t}\n\tconst sPathSplit = sPath.split(\"/\");\n\tif (sPathSplit.length === 1) {\n\t\treturn oObject[sPath];\n\t} else {\n\t\treturn getObject(oObject[sPathSplit[0]] as Record<string, unknown>, sPathSplit.splice(1).join(\"/\"));\n\t}\n}\n/**\n * Resolve a dynamic annotation path down to a standard annotation path.\n * @param sAnnotationPath\n * @param oMetaModel\n * @returns The non dynamic version of the annotation path\n */\nexport function resolveDynamicExpression(sAnnotationPath: string, oMetaModel: ODataMetaModel): string {\n\tif (sAnnotationPath.includes(\"[\")) {\n\t\tconst firstBracket = sAnnotationPath.indexOf(\"[\");\n\t\tconst sStableBracket = sAnnotationPath.substring(0, firstBracket);\n\t\tconst sRest = sAnnotationPath.substring(firstBracket + 1);\n\t\tconst lastBracket = sRest.indexOf(\"]\");\n\t\tconst aValue = oMetaModel.getObject(sStableBracket);\n\t\tconst oExpression = BindingParser.parseExpression(sRest.substring(0, lastBracket));\n\t\tif (\n\t\t\tArray.isArray(aValue) &&\n\t\t\toExpression &&\n\t\t\toExpression.result &&\n\t\t\toExpression.result.parts &&\n\t\t\toExpression.result.parts[0] &&\n\t\t\toExpression.result.parts[0].path\n\t\t) {\n\t\t\tlet i;\n\t\t\tlet bFound = false;\n\t\t\tfor (i = 0; i < aValue.length && !bFound; i++) {\n\t\t\t\tconst oObjectValue = getObject(aValue[i], oExpression.result.parts[0].path);\n\t\t\t\tconst bResult = oExpression.result.formatter(oObjectValue);\n\t\t\t\tif (bResult) {\n\t\t\t\t\tbFound = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (bFound) {\n\t\t\t\tsAnnotationPath = resolveDynamicExpression(sStableBracket + (i - 1) + sRest.substring(lastBracket + 1), oMetaModel);\n\t\t\t}\n\t\t}\n\t}\n\treturn sAnnotationPath;\n}\n"],"mappings":";;;;8EAGA,SAASA,EAAUC,EAAkCC,GACpD,IAAKD,EAAS,CACb,OAAO,IACR,CACA,MAAME,EAAaD,EAAME,MAAM,KAC/B,GAAID,EAAWE,SAAW,EAAG,CAC5B,OAAOJ,EAAQC,EAChB,KAAO,CACN,OAAOF,EAAUC,EAAQE,EAAW,IAAgCA,EAAWG,OAAO,GAAGC,KAAK,KAC/F,CACD,CAOO,SAASC,EAAyBC,EAAyBC,GACjE,GAAID,EAAgBE,SAAS,KAAM,CAClC,MAAMC,EAAeH,EAAgBI,QAAQ,KAC7C,MAAMC,EAAiBL,EAAgBM,UAAU,EAAGH,GACpD,MAAMI,EAAQP,EAAgBM,UAAUH,EAAe,GACvD,MAAMK,EAAcD,EAAMH,QAAQ,KAClC,MAAMK,EAASR,EAAWV,UAAUc,GACpC,MAAMK,EAAcC,EAAcC,gBAAgBL,EAAMD,UAAU,EAAGE,IACrE,GACCK,MAAMC,QAAQL,IACdC,GACAA,EAAYK,QACZL,EAAYK,OAAOC,OACnBN,EAAYK,OAAOC,MAAM,IACzBN,EAAYK,OAAOC,MAAM,GAAGC,KAC3B,CACD,IAAIC,EACJ,IAAIC,EAAS,MACb,IAAKD,EAAI,EAAGA,EAAIT,EAAOb,SAAWuB,EAAQD,IAAK,CAC9C,MAAME,EAAe7B,EAAUkB,EAAOS,GAAIR,EAAYK,OAAOC,MAAM,GAAGC,MACtE,MAAMI,EAAUX,EAAYK,OAAOO,UAAUF,GAC7C,GAAIC,EAAS,CACZF,EAAS,IACV,CACD,CACA,GAAIA,EAAQ,CACXnB,EAAkBD,EAAyBM,GAAkBa,EAAI,GAAKX,EAAMD,UAAUE,EAAc,GAAIP,EACzG,CACD,CACD,CACA,OAAOD,CACR,CAACuB,EAAAxB,2BAAA,OAAAwB,CAAA","ignoreList":[]}