/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/controllerextensions/BusyLocker","sap/fe/core/helpers/PromiseKeeper","sap/m/Button","sap/m/Dialog","sap/m/ProgressIndicator","sap/m/Text","sap/m/VBox"],function(e,t,n,r,s,a,o){"use strict";const l={createDialog(e){return new r(e)},async _handleDelayBusy(t,n){e.lock(n);return new Promise(r=>{setTimeout(()=>{e.unlock(n);r(undefined)},t)})},async _handleDelayProgressBar(e,r,l){const c=new t;const i=new a;const u=new s({displayOnly:true,percentValue:0,showValue:false});const f=new o({items:[new a({text:l.getText("C_MESSAGE_HANDLING_SAPFE_503_TITLE")})]});if(r.message){f.addItem(new a({text:r.message.replaceAll(/[\n\r]/g," ")}))}f.addItem(i);f.addItem(u);function d(){const t=r.retryAfter.getTime()-Date.now();if(t<=0){return false}else{const n=100-t/e*100;u.setPercentValue(n);const r=Math.ceil(t/1e3);const s=Math.floor(r/60);const a=r%60;if(s>0){i.setText(l.getText("C_UNAVAILABLE_SERVER_MESSAGE_MINUTES_SECONDS",[s,a]))}else{i.setText(l.getText("C_UNAVAILABLE_SERVER_MESSAGE_SECONDS",[a]))}return true}}const _=setInterval(()=>{if(!d()){clearInterval(_);A.close();c.resolve(undefined)}},100);const m=()=>{clearInterval(_);A.close();delete r.retryAfter;c.reject(r)};const A=this.createDialog({type:"Message",title:l.getText("WARNING"),content:[f],endButton:new n({text:l.getText("C_COMMON_DIALOG_CANCEL"),press:m}),state:"Warning"});d();A.open();return c.promise},async handle503Delay(e,t,n){if(e.retryAfter===undefined){return Promise.reject(e)}const r=e.retryAfter.getTime()-Date.now();if(r<5e3){return this._handleDelayBusy(r,t)}else if(r<6e5){return this._handleDelayProgressBar(r,e,n)}else{return Promise.reject(e)}}};return l},false);
//# sourceMappingURL=HTTP503Handler.js.map