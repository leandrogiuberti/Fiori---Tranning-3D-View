{"version":3,"names":["TemplateModel","_dec","defineUI5Class","_class","_BaseObject","pageConfig","oMetaModel","_this","call","oConfigModel","JSONModel","setSizeLimit","Number","MAX_VALUE","bConfigLoaded","that","fnGetObject","_getObject","bind","sPath","oContext","setData","fnCreateMetaBindingContext","createBindingContext","fnCreateConfigBindingContext","fnSetData","_assertThisInitialized","_inheritsLoose","_proto","prototype","dataToSet","mParameters","fnCallBack","oBindingContext","bNoResolve","noResolve","sResolvedPath","getObject","destroy","apply","BaseObject"],"sourceRoot":".","sources":["TemplateModel.ts"],"sourcesContent":["import { defineUI5Class } from \"sap/fe/base/ClassSupport\";\nimport BaseObject from \"sap/ui/base/Object\";\nimport type Context from \"sap/ui/model/Context\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\n// We are overriding internal from the JSONModel so this makes sense\ntype InternalJSONModel = JSONModel & {\n\t_getObject(sPath: string, oContext?: Context): object;\n};\n@defineUI5Class(\"sap.fe.core.TemplateModel\")\nclass TemplateModel extends BaseObject {\n\tpublic oMetaModel: ODataMetaModel;\n\n\tpublic oConfigModel: JSONModel;\n\n\tpublic bConfigLoaded: boolean;\n\n\tpublic fnCreateMetaBindingContext: Function;\n\n\tpublic fnCreateConfigBindingContext: Function;\n\n\tpublic fnSetData: Function;\n\n\tconstructor(pageConfig: Function | object, oMetaModel: ODataMetaModel) {\n\t\tsuper();\n\t\tthis.oMetaModel = oMetaModel;\n\t\tthis.oConfigModel = new JSONModel();\n\t\t// don't limit aggregation bindings\n\t\tthis.oConfigModel.setSizeLimit(Number.MAX_VALUE);\n\t\tthis.bConfigLoaded = false;\n\t\t// eslint-disable-next-line @typescript-eslint/no-this-alias\n\t\tconst that = this;\n\n\t\tif (typeof pageConfig === \"function\") {\n\t\t\tconst fnGetObject = (this.oConfigModel as InternalJSONModel)._getObject.bind(this.oConfigModel);\n\t\t\t(this.oConfigModel as InternalJSONModel)._getObject = function (sPath: string, oContext: Context): Object {\n\t\t\t\tif (!that.bConfigLoaded) {\n\t\t\t\t\tthis.setData(pageConfig());\n\t\t\t\t}\n\t\t\t\treturn fnGetObject(sPath, oContext);\n\t\t\t};\n\t\t} else {\n\t\t\tthis.oConfigModel.setData(pageConfig);\n\t\t}\n\n\t\tthis.fnCreateMetaBindingContext = this.oMetaModel.createBindingContext.bind(this.oMetaModel);\n\t\tthis.fnCreateConfigBindingContext = this.oConfigModel.createBindingContext.bind(this.oConfigModel);\n\t\tthis.fnSetData = this.oConfigModel.setData.bind(this.oConfigModel);\n\n\t\tthis.oConfigModel.createBindingContext = this.createBindingContext.bind(this);\n\t\tthis.oConfigModel.setData = this.setData.bind(this);\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\treturn this.oConfigModel;\n\t}\n\n\t/**\n\t * Overwrite the standard setData to keep track whether the external configuration has been loaded or not.\n\t * @param dataToSet The data to set to the json model containing the configuration\n\t */\n\tsetData(dataToSet: object): void {\n\t\tthis.fnSetData(dataToSet);\n\t\tthis.bConfigLoaded = true;\n\t}\n\n\tcreateBindingContext(sPath: string, oContext?: Context, mParameters?: { noResolve?: boolean }, fnCallBack?: Function): Context {\n\t\tlet oBindingContext;\n\t\tconst bNoResolve = mParameters && mParameters.noResolve;\n\n\t\toBindingContext = this.fnCreateConfigBindingContext(sPath, oContext, mParameters, fnCallBack);\n\t\tconst sResolvedPath = !bNoResolve && oBindingContext?.getObject();\n\t\tif (sResolvedPath && typeof sResolvedPath === \"string\") {\n\t\t\toBindingContext = this.fnCreateMetaBindingContext(sResolvedPath, oContext, mParameters, fnCallBack);\n\t\t}\n\n\t\treturn oBindingContext;\n\t}\n\n\tdestroy(): void {\n\t\tthis.oConfigModel.destroy();\n\t\tJSONModel.prototype.destroy.apply(this);\n\t}\n}\n\nexport default TemplateModel;\n"],"mappings":"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","ignoreList":[],"file":"TemplateModel-dbg.js"}