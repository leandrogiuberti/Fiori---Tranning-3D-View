{"version":3,"names":["aTraceInfo","traceNamespace","xmlns","traceIsOn","location","search","includes","aNamespaces","oCallbacks","fnClone","oObject","JSON","parse","stringify","collectContextInfo","sValue","oContexts","oVisitor","oNode","aContexts","aPromises","BindingInfo","e","Array","isArray","filter","oContext","path","parts","forEach","aParts","oPartContext","oModel","model","sSimplePath","oRealContext","aInnerParts","split","getContext","visitorResult","getResult","push","then","oResult","getModel","getMetadata","getName","getPath","data","catch","bindingFor","exc","Promise","all","fillAttributes","oResults","oAttributes","sName","result","originalValue","resolvedValue","error","stack","toString","collectInfo","i","attributes","length","oAttribute","nodeName","getAttribute","properties","contexts","resolve","sControlName","bIsControl","test","oTraceMetadataContext","isError","control","namespaceURI","metaDataContexts","firstChild","ownerDocument","children","find","node","startsWith","setAttributeNS","bRelevant","Object","keys","assign","viewInfo","getViewInfo","macroInfo","getSettings","traceID","visitAttributes","visitChildNodes","exception","XMLSerializer","serializeToString","Log","message","namespace","XMLPreprocessor","plugIn","bind","traceMacroCalls","oMetadata","mContexts","aMetadataContextKeys","metadataContexts","aProperties","macro","name","sKey","oMetaDataContext","oProperty","this","getObject","parentMacroID","macroID","contextPath","getTraceInfo","id","aErrors","traceInfo","isTraceInfoActive"],"sourceRoot":".","sources":["TraceInfo.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport type {\n\tIVisitorCallback,\n\tTransformedBuildingBlockMetadata\n} from \"sap/fe/core/buildingBlocks/templating/BuildingBlockTemplateProcessor\";\nimport BindingInfo from \"sap/ui/base/BindingInfo\";\nimport XMLPreprocessor from \"sap/ui/core/util/XMLPreprocessor\";\nimport type Context from \"sap/ui/model/Context\";\n//Trace information\nconst aTraceInfo: TraceMetadataContext[] = [\n\t/* Structure for a macro\n\t\t\t{\n\t\t\t\tmacro: '', //name of macro\n\t\t\t\tmetaDataContexts: [ //Properties of type sap.ui.model.Context\n\t\t\t\t\t{\n\t\t\t\t\t\tname: '', //context property name / key\n\t\t\t\t\t\tpath: '', //from oContext.getPath()\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tproperties: { // Other properties which become part of {this>}\n\t\t\t\t\tproperty1: value,\n\t\t\t\t\tproperty2: value\n\t\t\t\t}\n\t\t\t\tviewInfo: {\n\t\t\t\t\tviewInfo: {} // As specified in view or fragment creation\n\t\t\t\t},\n\t\t\t\ttraceID: this.index, //ID for this trace information,\n\t\t\t\tmacroInfo: {\n\t\t\t\t\tmacroID: index, // traceID of this macro (redundant for macros)\n\t\t\t\t\tparentMacroID, index // traceID of the parent macro (if it has a parent)\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Structure for a control\n\t\t\t{\n\t\t\t\tcontrol: '', //control class\n\t\t\t\tproperties: { // Other properties which become part of {this>}\n\t\t\t\t\tproperty1: {\n\t\t\t\t\t\toriginalValue: '', //Value before templating\n\t\t\t\t\t\tresolvedValue: '' //Value after templating\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcontexts: { //Models and Contexts used during templating\n\t\t\t\t\t// Model or context name used for this control\n\t\t\t\t\tmodelName1: { // For ODataMetaModel\n\t\t\t\t\t\tpath1: {\n\t\t\t\t\t\t\tpath: '', //absolut path within metamodel\n\t\t\t\t\t\t\tdata: '', //data of path unless type Object\n\t\t\t\t\t\t}\n\t\t\t\t\tmodelName2: {\n\t\t\t\t\t\t// for other model types\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tproperty1: value,\n\t\t\t\t\t\t\tproperty2: value\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// In case binding cannot be resolved -> mark as runtime binding\n\t\t\t\t\t\t// This is not always true, e.g. in case the path is metamodelpath\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\"bindingFor\": \"Runtime\"\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tviewInfo: {\n\t\t\t\t\tviewInfo: {} // As specified in view or fragment creation\n\t\t\t\t},\n\t\t\t\tmacroInfo: {\n\t\t\t\t\tmacroID: index, // traceID of the macro that created this control\n\t\t\t\t\tparentMacroID, index // traceID of the macro's parent macro\n\t\t\t\t},\n\t\t\t\ttraceID: this.index //ID for this trace information\n\t\t\t}\n\t\t\t*/\n];\nconst traceNamespace = \"http://schemas.sap.com/sapui5/extension/sap.fe.info/1\",\n\txmlns = \"http://www.w3.org/2000/xmlns/\",\n\t/**\n\t * Switch is currently based on url parameter\n\t */\n\ttraceIsOn = location.search.includes(\"sap-ui-xx-feTraceInfo=true\"),\n\t/**\n\t * Specify all namespaces that shall be traced during templating\n\t */\n\taNamespaces = [\n\t\t\"sap.m\",\n\t\t\"sap.uxap\",\n\t\t\"sap.ui.unified\",\n\t\t\"sap.f\",\n\t\t\"sap.ui.table\",\n\t\t\"sap.suite.ui.microchart\",\n\t\t\"sap.ui.layout.form\",\n\t\t\"sap.ui.mdc\",\n\t\t\"sap.ui.mdc.link\",\n\t\t\"sap.ui.mdc.field\",\n\t\t\"sap.fe.fpm\"\n\t],\n\toCallbacks: Record<string, unknown> = {};\n\nfunction fnClone(oObject: object): unknown {\n\treturn JSON.parse(JSON.stringify(oObject));\n}\ntype TraceContext = {\n\tpath: string;\n\tmodel: string;\n\tparts: TraceContext[];\n};\nasync function collectContextInfo(\n\tsValue: string | null,\n\toContexts: Record<string, TraceContext>,\n\toVisitor: IVisitorCallback,\n\toNode: Element\n): Promise<unknown[]> {\n\tlet aContexts: TraceContext[];\n\tconst aPromises: Promise<unknown>[] = [];\n\ttry {\n\t\taContexts = BindingInfo.parse(sValue) || [];\n\t} catch (e) {\n\t\taContexts = [];\n\t}\n\taContexts = Array.isArray(aContexts) ? aContexts : [aContexts];\n\taContexts\n\t\t.filter(function (oContext) {\n\t\t\treturn oContext.path || oContext.parts;\n\t\t})\n\t\t.forEach(function (oContext: TraceContext) {\n\t\t\tconst aParts = oContext.parts || [oContext];\n\t\t\taParts\n\t\t\t\t.filter(function (oPartContext: TraceContext) {\n\t\t\t\t\treturn oPartContext.path;\n\t\t\t\t})\n\t\t\t\t.forEach(function (oPartContext: TraceContext) {\n\t\t\t\t\tconst oModel: Record<string, unknown> = (oContexts[oPartContext.model] = oContexts[oPartContext.model] || {});\n\t\t\t\t\tconst sSimplePath = !oPartContext.path.includes(\">\")\n\t\t\t\t\t\t? (oPartContext.model && `${oPartContext.model}>`) + oPartContext.path\n\t\t\t\t\t\t: oPartContext.path;\n\t\t\t\t\tlet oRealContext: Context | undefined;\n\t\t\t\t\tlet aInnerParts;\n\n\t\t\t\t\tif (typeof oPartContext.model === \"undefined\" && sSimplePath.includes(\">\")) {\n\t\t\t\t\t\taInnerParts = sSimplePath.split(\">\");\n\t\t\t\t\t\toPartContext.model = aInnerParts[0];\n\t\t\t\t\t\toPartContext.path = aInnerParts[1];\n\t\t\t\t\t}\n\t\t\t\t\ttry {\n\t\t\t\t\t\toRealContext = oVisitor.getContext(sSimplePath);\n\n\t\t\t\t\t\tconst visitorResult = oVisitor.getResult(`{${sSimplePath}}`, oNode)!;\n\t\t\t\t\t\taPromises.push(\n\t\t\t\t\t\t\tvisitorResult\n\t\t\t\t\t\t\t\t.then(function (oResult: Context) {\n\t\t\t\t\t\t\t\t\tif (oRealContext?.getModel().getMetadata().getName() === \"sap.ui.model.json.JSONModel\") {\n\t\t\t\t\t\t\t\t\t\tif (!oResult.getModel()) {\n\t\t\t\t\t\t\t\t\t\t\toModel[oPartContext.path] = oResult;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\toModel[oPartContext.path] = `Context from ${oResult.getPath()}`;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\toModel[oPartContext.path] = {\n\t\t\t\t\t\t\t\t\t\t\tpath: oRealContext!.getPath(),\n\t\t\t\t\t\t\t\t\t\t\tdata: typeof oResult === \"object\" ? \"[ctrl/cmd-click] on path to see data\" : oResult\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(function () {\n\t\t\t\t\t\t\t\t\toModel[oPartContext.path] = {\n\t\t\t\t\t\t\t\t\t\tbindingFor: \"Runtime\"\n\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (exc) {\n\t\t\t\t\t\toModel[oPartContext.path] = {\n\t\t\t\t\t\t\tbindingFor: \"Runtime\"\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t});\n\treturn Promise.all(aPromises);\n}\nasync function fillAttributes(\n\toResults: Promise<unknown>,\n\toAttributes: Record<string, unknown>,\n\tsName: string,\n\tsValue: unknown\n): Promise<void> {\n\treturn oResults\n\t\t.then(function (result: unknown) {\n\t\t\toAttributes[sName] =\n\t\t\t\tsValue !== result\n\t\t\t\t\t? {\n\t\t\t\t\t\t\toriginalValue: sValue,\n\t\t\t\t\t\t\tresolvedValue: result\n\t\t\t\t\t  }\n\t\t\t\t\t: sValue;\n\t\t\treturn;\n\t\t})\n\t\t.catch(function (e: unknown) {\n\t\t\tconst error = e as Error;\n\t\t\toAttributes[sName] = {\n\t\t\t\toriginalValue: sValue,\n\t\t\t\terror: (error.stack && error.stack.toString()) || e\n\t\t\t};\n\t\t});\n}\nasync function collectInfo(oNode: Element, oVisitor: IVisitorCallback): Promise<{ properties: {}; contexts: {} }> {\n\tconst oAttributes = {};\n\tconst aPromises = [];\n\tconst oContexts = {};\n\tlet oResults;\n\tfor (let i = oNode.attributes.length >>> 0; i--; ) {\n\t\tconst oAttribute = oNode.attributes[i],\n\t\t\tsName = oAttribute.nodeName,\n\t\t\tsValue = oNode.getAttribute(sName)!;\n\t\tif (![\"core:require\"].includes(sName)) {\n\t\t\taPromises.push(collectContextInfo(sValue, oContexts, oVisitor, oNode));\n\t\t\toResults = oVisitor.getResult(sValue, oNode);\n\t\t\tif (oResults) {\n\t\t\t\taPromises.push(fillAttributes(oResults, oAttributes, sName, sValue));\n\t\t\t} else {\n\t\t\t\t//What\n\t\t\t}\n\t\t}\n\t}\n\treturn Promise.all(aPromises).then(function () {\n\t\treturn { properties: oAttributes, contexts: oContexts };\n\t});\n}\nexport type TraceMetadataContext = {\n\tisError: boolean;\n\tmacro?: string;\n\tcontrol?: string;\n\tname?: string;\n\tcontextPath?: string;\n\tviewInfo?: unknown;\n\tmacroInfo?: MacroInfo;\n\ttraceID?: number;\n\terror?: {\n\t\texception: Error;\n\t\tnode: string;\n\t};\n\tmetaDataContexts: { name: string; path: string }[];\n\tproperties: Record<string, unknown>;\n};\nasync function resolve(oNode: Element, oVisitor: IVisitorCallback): Promise<void> {\n\ttry {\n\t\tconst sControlName = oNode.nodeName.split(\":\")[1] || oNode.nodeName,\n\t\t\tbIsControl = /^[A-Z]/.test(sControlName),\n\t\t\toTraceMetadataContext: TraceMetadataContext = {\n\t\t\t\tisError: false,\n\t\t\t\tcontrol: `${oNode.namespaceURI}.${oNode.nodeName.split(\":\")[1] || oNode.nodeName}`,\n\t\t\t\tmetaDataContexts: [],\n\t\t\t\tproperties: {}\n\t\t\t};\n\n\t\tif (bIsControl) {\n\t\t\tconst firstChild = [...(oNode.ownerDocument.children as unknown as Element[])].find((node) => !node.nodeName.startsWith(\"#\"));\n\t\t\tif (firstChild && !firstChild.getAttribute(\"xmlns:trace\")) {\n\t\t\t\tfirstChild.setAttributeNS(xmlns, \"xmlns:trace\", traceNamespace);\n\t\t\t\tfirstChild.setAttributeNS(traceNamespace, \"trace:is\", \"on\");\n\t\t\t}\n\t\t\treturn await collectInfo(oNode, oVisitor)\n\t\t\t\t.then(async function (result: { properties: {}; contexts: {} }): Promise<void> {\n\t\t\t\t\tconst bRelevant = Object.keys(result.contexts).length > 0; //If no context was used it is not relevant so we ignore Object.keys(result.properties).length\n\t\t\t\t\tif (bRelevant) {\n\t\t\t\t\t\tObject.assign(oTraceMetadataContext, result);\n\t\t\t\t\t\toTraceMetadataContext.viewInfo = oVisitor.getViewInfo();\n\t\t\t\t\t\toTraceMetadataContext.macroInfo = oVisitor.getSettings()[\"_macroInfo\"];\n\t\t\t\t\t\toTraceMetadataContext.traceID = aTraceInfo.length;\n\t\t\t\t\t\toNode.setAttributeNS(traceNamespace, \"trace:traceID\", oTraceMetadataContext.traceID.toString());\n\t\t\t\t\t\taTraceInfo.push(oTraceMetadataContext);\n\t\t\t\t\t}\n\t\t\t\t\treturn oVisitor.visitAttributes(oNode);\n\t\t\t\t})\n\t\t\t\t.then(async function () {\n\t\t\t\t\treturn oVisitor.visitChildNodes(oNode);\n\t\t\t\t})\n\t\t\t\t.catch(function (exc: unknown) {\n\t\t\t\t\toTraceMetadataContext.error = {\n\t\t\t\t\t\texception: exc as Error,\n\t\t\t\t\t\tnode: new XMLSerializer().serializeToString(oNode)\n\t\t\t\t\t};\n\t\t\t\t});\n\t\t} else {\n\t\t\tawait oVisitor.visitAttributes(oNode);\n\t\t\tawait oVisitor.visitChildNodes(oNode);\n\t\t}\n\t} catch (exc: unknown) {\n\t\tLog.error(`Error while tracing '${oNode?.nodeName}': ${(exc as Error).message}`, \"TraceInfo\");\n\t\treturn oVisitor.visitAttributes(oNode).then(async function () {\n\t\t\treturn oVisitor.visitChildNodes(oNode);\n\t\t});\n\t}\n}\n/**\n * Register path-through XMLPreprocessor plugin for all namespaces\n * given above in aNamespaces\n */\nif (traceIsOn) {\n\taNamespaces.forEach(function (namespace: string) {\n\t\toCallbacks[namespace] = XMLPreprocessor.plugIn(resolve.bind(namespace), namespace);\n\t});\n}\n\n/**\n * Adds information about the processing of one macro to the collection.\n * @param sName Macro class name\n * @param oMetadata Definition from macro\n * @param mContexts Available named contexts\n * @param oNode\n * @param oVisitor\n * @returns The traced metadata context\n */\nexport type MacroInfo = {\n\tparentMacroID: string;\n\tmacroID: string;\n};\nfunction traceMacroCalls(\n\tsName: string,\n\toMetadata: TransformedBuildingBlockMetadata,\n\tmContexts: Record<string, Context>,\n\toNode: Element,\n\toVisitor: IVisitorCallback\n): TraceMetadataContext {\n\ttry {\n\t\tlet aMetadataContextKeys = (oMetadata.metadataContexts && Object.keys(oMetadata.metadataContexts)) || [];\n\t\tconst aProperties = (oMetadata.properties && Object.keys(oMetadata.properties)) || [];\n\t\tconst macroInfo: MacroInfo = fnClone(oVisitor.getSettings()[\"_macroInfo\"] || {}) as MacroInfo;\n\t\tconst oTraceMetadataContext: TraceMetadataContext = {\n\t\t\tisError: false,\n\t\t\tmacro: sName,\n\t\t\tmetaDataContexts: [],\n\t\t\tproperties: {}\n\t\t};\n\n\t\tif (aMetadataContextKeys.length === 0) {\n\t\t\t//In case the macro has no metadata.js we take all metadataContexts except this\n\t\t\taMetadataContextKeys = Object.keys(mContexts).filter(function (name: string) {\n\t\t\t\treturn name !== \"this\";\n\t\t\t});\n\t\t}\n\n\t\tif (!oNode.getAttribute(\"xmlns:trace\")) {\n\t\t\toNode.setAttributeNS(xmlns, \"xmlns:trace\", traceNamespace);\n\t\t}\n\n\t\tif (aMetadataContextKeys.length > 0) {\n\t\t\taMetadataContextKeys.forEach(function (sKey: string) {\n\t\t\t\tconst oContext = mContexts[sKey],\n\t\t\t\t\toMetaDataContext = oContext && {\n\t\t\t\t\t\tname: sKey,\n\t\t\t\t\t\tpath: oContext.getPath()\n\t\t\t\t\t\t//data: JSON.stringify(oContext.getObject(),null,2)\n\t\t\t\t\t};\n\n\t\t\t\tif (oMetaDataContext) {\n\t\t\t\t\toTraceMetadataContext.metaDataContexts.push(oMetaDataContext);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\taProperties.forEach(function (sKey: string) {\n\t\t\t\tconst oProperty = mContexts.this.getObject(sKey);\n\n\t\t\t\tif (oProperty) {\n\t\t\t\t\toTraceMetadataContext.properties[sKey] = oProperty;\n\t\t\t\t}\n\t\t\t});\n\t\t\toTraceMetadataContext.viewInfo = oVisitor.getViewInfo();\n\t\t\toTraceMetadataContext.traceID = aTraceInfo.length;\n\t\t\tmacroInfo.parentMacroID = macroInfo.macroID;\n\t\t\tmacroInfo.macroID = oTraceMetadataContext.traceID.toString();\n\t\t\toTraceMetadataContext.macroInfo = macroInfo;\n\t\t\toNode.setAttributeNS(traceNamespace, \"trace:macroID\", oTraceMetadataContext.traceID.toString());\n\t\t\taTraceInfo.push(oTraceMetadataContext);\n\t\t}\n\t\treturn oTraceMetadataContext;\n\t} catch (exc) {\n\t\treturn {\n\t\t\tisError: true,\n\t\t\terror: {\n\t\t\t\texception: exc as Error,\n\t\t\t\tnode: new XMLSerializer().serializeToString(oNode)\n\t\t\t},\n\t\t\tname: sName,\n\t\t\tcontextPath: oVisitor?.getContext()?.getPath(),\n\t\t\tmetaDataContexts: [],\n\t\t\tproperties: {}\n\t\t};\n\t}\n}\n/**\n * Returns the globally stored trace information for the macro or\n * control marked with the given id.\n *\n * Returns all trace information if no id is specified\n *\n *\n * <pre>Structure for a macro\n * {\n * macro: '', //name of macro\n * metaDataContexts: [ //Properties of type sap.ui.model.Context\n * {\n * name: '', //context property name / key\n * path: '', //from oContext.getPath()\n * }\n * ],\n * properties: { // Other properties which become part of {this>}\n * property1: value,\n * property2: value\n * }\n * viewInfo: {\n * viewInfo: {} // As specified in view or fragment creation\n * },\n * traceID: this.index, //ID for this trace information,\n * macroInfo: {\n * macroID: index, // traceID of this macro (redundant for macros)\n * parentMacroID, index // traceID of the parent macro (if it has a parent)\n * }\n * }\n * Structure for a control\n * {\n * control: '', //control class\n * properties: { // Other properties which become part of {this>}\n * property1: {\n * originalValue: '', //Value before templating\n * resolvedValue: '' //Value after templating\n * }\n * }\n * contexts: { //Models and Contexts used during templating\n * // Model or context name used for this control\n * modelName1: { // For ODataMetaModel\n * path1: {\n * path: '', //absolut path within metamodel\n * data: '', //data of path unless type Object\n * }\n * modelName2: {\n * // for other model types\n * {\n * property1: value,\n * property2: value\n * }\n * // In case binding cannot be resolved -> mark as runtime binding\n * // This is not always true, e.g. in case the path is metamodelpath\n * {\n * \"bindingFor\": \"Runtime\"\n * }\n * }\n * },\n * viewInfo: {\n * viewInfo: {} // As specified in view or fragment creation\n * },\n * macroInfo: {\n * macroID: index, // traceID of the macro that created this control\n * parentMacroID, index // traceID of the macro's parent macro\n * },\n * traceID: this.index //ID for this trace information\n * }</pre>.\n * @param id TraceInfo id\n * @returns Object / Array for TraceInfo\n */\nfunction getTraceInfo(id: number): TraceMetadataContext | TraceMetadataContext[] {\n\tif (id) {\n\t\treturn aTraceInfo[id];\n\t}\n\tconst aErrors = aTraceInfo.filter(function (traceInfo: TraceMetadataContext) {\n\t\treturn traceInfo.error;\n\t});\n\treturn (aErrors.length > 0 && aErrors) || aTraceInfo;\n}\n/**\n * Returns true if TraceInfo is active.\n * @returns `true` when active\n */\nfunction isTraceInfoActive(): boolean {\n\treturn traceIsOn;\n}\n/**\n * @typedef sap.fe.macros.TraceInfo\n * TraceInfo for SAP Fiori elements\n *\n * Once traces is switched, information about macros and controls\n * that are processed during xml preprocessing ( @see {@link sap.ui.core.util.XMLPreprocessor})\n * will be collected within this singleton\n * @namespace\n * @global\n * @since 1.74.0\n */\nexport default {\n\tisTraceInfoActive: isTraceInfoActive,\n\ttraceMacroCalls: traceMacroCalls,\n\tgetTraceInfo: getTraceInfo\n};\n"],"mappings":"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","ignoreList":[],"file":"TraceInfo-dbg.js"}