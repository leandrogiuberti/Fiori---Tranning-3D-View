{"version":3,"names":["LOGGER_SCOPE","XMLTEMPLATING_NS","DOMParserInstance","DOMParser","validateMacroMetadataContext","sName","mContexts","oContextSettings","sKey","oContext","oContextObject","getObject","required","Error","hasOwnProperty","$kind","undefined","expectedTypes","includes","getPath","$Type","expectedAnnotationTypes","validateMacroSignature","oMetadata","oNode","aMetadataContextKeys","metadataContexts","Object","keys","aProperties","properties","oAttributeNames","attributeNames","getAttributeNames","attributeName","forEach","oPropertySettings","hasAttribute","startsWith","Log","warning","_exports","SAP_UI_CORE_ELEMENT","SAP_UI_MODEL_CONTEXT","transformMetadata","buildingBlockMetadata","class","type","isPublic","aggregations","dependents","slot","customData","layoutData","propertyName","propertyType","_checkAbsoluteAndContextPaths","oSettings","sAttributeValue","sMetaPath","sContextPath","currentContextPath","endsWith","model","path","_createInitialMetadataContext","sAttributeName","returnContext","models","converterContext","getProperty","data","unstoreObjectValue","setProperty","bindingContexts","entitySet","_getMetadataContext","oVisitor","bDoNotResolve","isOpen","oMetadataContext","getAttribute","BindingInfo","parse","metaContextPath","context","getContext","getModel","isA","e","processProperties","definitionProperties","aDefinitionPropertiesKeys","propertyValues","sKeyValue","defaultValue","deepClone","error","visitAttribute","attributes","getNamedItem","value","Number","processContexts","contextPath","mMissingContext","oDefinitionContexts","aDefinitionContextsKeys","contextPathIndex","indexOf","contextPathDefinition","splice","propertyValue","length","name","addSingleContext","parseAggregation","oAggregation","definition","oOutObjects","children","firstElementChild","namespaceURI","oParent","parentNode","visitNode","childIdx","childDefinition","childKey","skipKey","multiple","uid","setAttribute","aggregationObject","key","position","placement","Placement","After","anchor","processAggregations","tagName","nodeName","processObject","element","myArray","myObject","childNodeNames","map","localName","childIsArray","Set","size","push","processChildren","oAggregations","oFirstElementChild","iChildIndex","Array","from","nextElementSibling","sChildName","sAggregationName","toUpperCase","defaultAggregation","aggregationDefinition","parsedAggregation","parsedAggregationKey","oNextChild","nextChild","hasVirtualNode","childWrapper","document","createElementNS","appendChild","removeAttribute","oNewChild","cloneNode","aggregationPropertyValues","myChild","processSlots","oMetadataAggregations","processCustomData","arguments","oAggregationElement","oElementChild","sSlotName","oTargetElement","querySelector","prepareAggregationElement","replaceWith","replace","processBuildingBlock","BuildingBlockClass","metadata","sFragmentName","fragment","namespace","publicNamespace","xmlTag","getSettings","JSONModel","initialKeys","oControlConfig","viewData","processedPropertyValues","propName","oData","originalDefinition","validate","oInstance","getProperties","sContextName","targetObject","isContext","attributeValue","storeObjectValue","newContext","createBindingContext","oAttributesModel","AttributeModel","oPreviousMacroInfo","coreRequire","TraceInfo","isTraceInfoActive","oTraceInfo","traceMacroCalls","macroInfo","oContextVisitor","with","oPromise","insertFragment","oldKeys","temporaryObjectStore","templateString","jsx","renderAsXML","getTemplate","isRuntime","storeKey","hasError","hasParseError","parsedTemplate","parseXMLString","iter","createNodeIterator","NodeFilter","SHOW_TEXT","textnode","nextNode","textContent","trim","processXmlInTrace","initialTemplate","oErrorText","createErrorXML","template","outerHTML","join","visitedNodes","internalNode","Promise","all","remove","resolve","oMacroElement","oRemainingSlots","querySelectorAll","oSlotElement","requireOnMacro","getAttributeNS","substring","setAttributeNS","classList","add","traceDetails","initialProperties","resolvedProperties","missingContexts","oError","stack","oTemplate","oCtx","mSetting","ex","registerBuildingBlock","XMLPreprocessor","plugIn","unregisterBuildingBlock","errorMessages","xmlFragment","additionalData","errorLabels","errorMessage","xml","escapeXMLAttributeValue","errorStack","stackFormatted","btoa","additionalText","jsonValue","JSON","stringify","replaceAll","propertyUID","processNextXmlInTrace","method","returnValue","xmlString","addDefaultNamespaces","xmlDocument","parseFromString","output","parentElement","renderInTraceMode","outStr","xmlResult","innerText","innerHTML","split","strings","i","_len","values","_key","isArray","flat","isFunctionArray","valuefn","isBindingToolkitExpression","compiledExpression","compileExpression","propertyUId","addConditionallyToXML","condition","partToAdd","addAttributeToXML","isUndefinedExpression"],"sourceRoot":".","sources":["BuildingBlockTemplateProcessor.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport deepClone from \"sap/base/util/deepClone\";\nimport uid from \"sap/base/util/uid\";\nimport type { BindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport { compileExpression, isBindingToolkitExpression, isUndefinedExpression } from \"sap/fe/base/BindingToolkit\";\nimport jsx from \"sap/fe/base/jsx-runtime/jsx\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type ResourceModel from \"sap/fe/core/ResourceModel\";\nimport AttributeModel from \"sap/fe/core/buildingBlocks/templating/AttributeModel\";\nimport type {\n\tBuildingBlockAggregationDefinition,\n\tBuildingBlockMetadata,\n\tBuildingBlockMetadataContextDefinition,\n\tBuildingBlockPropertyDefinition,\n\tObjectValue,\n\tObjectValue2\n} from \"sap/fe/core/buildingBlocks/templating/BuildingBlockSupport\";\nimport type BuildingBlockTemplatingBase from \"sap/fe/core/buildingBlocks/templating/BuildingBlockTemplatingBase\";\nimport type { Position } from \"sap/fe/core/converters/helpers/ConfigurableObject\";\nimport { Placement } from \"sap/fe/core/converters/helpers/ConfigurableObject\";\nimport type { DefinitionContext, DefinitionPage } from \"sap/fe/core/definition/FEDefinition\";\nimport { isContext, isFunctionArray } from \"sap/fe/core/helpers/TypeGuards\";\nimport BindingInfo from \"sap/ui/base/BindingInfo\";\nimport type Control from \"sap/ui/core/Control\";\nimport XMLPreprocessor from \"sap/ui/core/util/XMLPreprocessor\";\nimport type Context from \"sap/ui/model/Context\";\nimport type Model from \"sap/ui/model/Model\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type { MacroInfo } from \"../TraceInfo\";\nimport TraceInfo from \"../TraceInfo\";\n\nconst LOGGER_SCOPE = \"sap.fe.core.buildingBlocks.templating.BuildingBlockTemplateProcessor\";\nconst XMLTEMPLATING_NS = \"http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1\";\nconst DOMParserInstance = new DOMParser();\n\nexport type TransformedBuildingBlockMetadata = BuildingBlockMetadata & {\n\tmetadataContexts: Record<string, BuildingBlockMetadataContextDefinition>;\n};\n\n/**\n * Definition of a meta data context\n */\ntype MetaDataContext = {\n\tname?: string;\n\tmodel: string;\n\tpath: string;\n};\n\nexport type TemplateProcessorSettings = {\n\tcurrentContextPath: Context;\n\tisPublic: boolean;\n\tappComponent: AppComponent;\n\tisRuntimeInstantiation?: boolean;\n\tmodels: Record<string, Model> & {\n\t\tconverterContext: JSONModel;\n\t\tviewData: JSONModel;\n\t\tinternal: JSONModel;\n\t\tmetaModel: ODataMetaModel;\n\t\t\"sap.fe.i18n\"?: ResourceModel;\n\t};\n\tgetDefinitionContext(): DefinitionContext;\n\tgetDefinitionForPage(): DefinitionPage;\n\tbindingContexts: Record<string, Context>;\n\t_macroInfo?: MacroInfo;\n\t[k: string]: unknown;\n};\n\nexport type IVisitorCallback = {\n\tgetSettings(): TemplateProcessorSettings;\n\t/**\n\t * Visits the given node and either processes a template instruction, calls\n\t * a visitor, or simply calls both {@link\n\t * sap.ui.core.util.XMLPreprocessor.ICallback.visitAttributes visitAttributes}\n\t * and {@link sap.ui.core.util.XMLPreprocessor.ICallback.visitChildNodes\n\t * visitChildNodes}.\n\t * @param oNode\n\t *   The XML DOM node\n\t * @returns\n\t *   A thenable which resolves with <code>undefined</code> as soon as visiting\n\t *   is done, or is rejected with a corresponding error if visiting fails\n\t */\n\tvisitNode(oNode: Node): Promise<void>;\n\n\t/**\n\t * Inserts the fragment with the given name in place of the given element. Loads the\n\t * fragment, takes care of caching (for the current pre-processor run) and visits the\n\t * fragment's content once it has been imported into the element's owner document and\n\t * put into place. Loading of fragments is asynchronous if the template view is\n\t * asynchronous.\n\t * @param sFragment\n\t *   the fragment's resolved name\n\t * @param oElement\n\t *   the XML DOM element, e.g. <sap.ui.core:Fragment> or <core:ExtensionPoint>\n\t * @param oWith\n\t *   the parent's \"with\" control\n\t * @returns\n\t * A sync promise which resolves with <code>undefined</code> as soon as the fragment\n\t *   has been inserted, or is rejected with a corresponding error if loading or visiting\n\t *   fails.\n\t */\n\tinsertFragment(sFragment: string, oElement: Element, oWith?: Control): Promise<void>;\n\tvisitAttribute(oNode: Element, oAttribute: Attr): Promise<void>;\n\tvisitAttributes(oNode: Element): Promise<void>;\n\tgetViewInfo(): Promise<unknown>;\n\tvisitChildNodes(oNode: Node): Promise<void>;\n\t/**\n\t * Interprets the given XML DOM attribute value as a binding and returns the\n\t * resulting value.\n\t * @param sValue\n\t *   An XML DOM attribute value\n\t * @param [element]\n\t *   The XML DOM element the attribute value belongs to (needed only for\n\t *   warnings which are logged to the console)\n\t * @returns\n\t *   A thenable which resolves with the resulting value, or is rejected with a\n\t *   corresponding error (for example, an error thrown by a formatter) or\n\t *   <code>null</code> in case the binding is not ready (because it refers to a\n\t *   model which is not available) (since 1.57.0)\n\t */\n\tgetResult(sValue: string, element?: Element): Promise<Context> | null;\n\tgetContext(sPath?: string): Context | undefined;\n\t/**\n\t * Returns a callback interface instance for the given map of variables which\n\t * override currently known variables of the same name in <code>this</code>\n\t * parent interface or replace them altogether. Each variable name becomes a\n\t * named model with a corresponding object binding and can be used inside the\n\t * XML template in the usual way, that is, with a binding expression like\n\t * <code>\"{var>some/relative/path}\"</code> (see example).\n\t * @param [mVariables={}]\n\t *   Map from variable name (string) to value\n\t * @param [bReplace]\n\t *   Whether only the given variables are known in the new callback interface\n\t *   instance, no inherited ones\n\t * @returns\n\t *   A callback interface instance\n\t * @param mVariables\n\t * @param bReplace\n\t */\n\t\"with\"(mVariables?: Record<string, Context>, bReplace?: boolean): IVisitorCallback;\n};\n\nfunction validateMacroMetadataContext(\n\tsName: string,\n\tmContexts: Record<string, Context>,\n\toContextSettings: BuildingBlockMetadataContextDefinition,\n\tsKey: string\n): void {\n\tconst oContext = mContexts[sKey];\n\tconst oContextObject = oContext?.getObject() as {\n\t\t$Type?: string;\n\t\t$kind?: string;\n\t};\n\n\tif (oContextSettings.required === true && (!oContext || oContextObject === null)) {\n\t\tthrow new Error(`${sName}: Required metadataContext '${sKey}' is missing`);\n\t} else if (oContextObject) {\n\t\t// If context object has $kind property, $Type should not be checked\n\t\t// Therefore remove from context settings\n\t\tif (oContextObject.hasOwnProperty(\"$kind\") && oContextObject.$kind !== undefined && oContextSettings.expectedTypes !== undefined) {\n\t\t\t// Check if the $kind is part of the allowed ones\n\t\t\tif (!oContextSettings.expectedTypes.includes(oContextObject.$kind)) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`${sName}: '${sKey}' must be '$kind' '${oContextSettings.expectedTypes}' but is '${\n\t\t\t\t\t\toContextObject.$kind\n\t\t\t\t\t}': ${oContext.getPath()}`\n\t\t\t\t);\n\t\t\t}\n\t\t} else if (\n\t\t\toContextObject.hasOwnProperty(\"$Type\") &&\n\t\t\toContextObject.$Type !== undefined &&\n\t\t\toContextSettings.expectedAnnotationTypes\n\t\t) {\n\t\t\t// Check only $Type\n\t\t\tif (!oContextSettings.expectedAnnotationTypes.includes(oContextObject.$Type)) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`${sName}: '${sKey}' must be '$Type' '${oContextSettings.expectedAnnotationTypes}' but is '${\n\t\t\t\t\t\toContextObject.$Type\n\t\t\t\t\t}': ${oContext.getPath()}`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\nexport function validateMacroSignature(\n\tsName: string,\n\toMetadata: TransformedBuildingBlockMetadata,\n\tmContexts: Record<string, Context>,\n\toNode: Element\n): void {\n\tconst aMetadataContextKeys = (oMetadata.metadataContexts && Object.keys(oMetadata.metadataContexts)) || [],\n\t\taProperties = (oMetadata.properties && Object.keys(oMetadata.properties)) || [],\n\t\toAttributeNames: Record<string, boolean> = {};\n\n\t// collect all attributes to find unchecked properties\n\tconst attributeNames = oNode.getAttributeNames();\n\tfor (const attributeName of attributeNames) {\n\t\toAttributeNames[attributeName] = true;\n\t}\n\n\t//Check metadataContexts\n\taMetadataContextKeys.forEach(function (sKey) {\n\t\tconst oContextSettings = oMetadata.metadataContexts[sKey];\n\n\t\tvalidateMacroMetadataContext(sName, mContexts, oContextSettings, sKey);\n\t\tdelete oAttributeNames[sKey];\n\t});\n\t//Check properties\n\taProperties.forEach(function (sKey) {\n\t\tconst oPropertySettings = oMetadata.properties[sKey];\n\t\tif (!oNode.hasAttribute(sKey)) {\n\t\t\tif (oPropertySettings.required && !oPropertySettings.hasOwnProperty(\"defaultValue\")) {\n\t\t\t\tthrow new Error(`${sName}: ` + `Required property '${sKey}' is missing`);\n\t\t\t}\n\t\t} else {\n\t\t\tdelete oAttributeNames[sKey];\n\t\t}\n\t});\n\n\t// Unchecked properties\n\tObject.keys(oAttributeNames).forEach(function (sKey: string) {\n\t\t// no check for properties which contain a colon \":\" (different namespace), e.g. xmlns:trace, trace:macroID, unittest:id\n\t\tif (!sKey.includes(\":\") && !sKey.startsWith(\"xmlns\")) {\n\t\t\tLog.warning(`Unchecked parameter: ${sName}: ${sKey}`, undefined, LOGGER_SCOPE);\n\t\t}\n\t});\n}\n\nconst SAP_UI_CORE_ELEMENT = \"sap.ui.core.Element\";\n\nexport const SAP_UI_MODEL_CONTEXT = \"sap.ui.model.Context\";\n\n/**\n * Transforms the metadata of a building block by adding additional aggregations,\n * and splitting properties into actual properties and metadata contexts.\n * @param buildingBlockMetadata The metadata received from the input\n * @returns The transformed metadata\n */\nfunction transformMetadata(buildingBlockMetadata: BuildingBlockMetadata): TransformedBuildingBlockMetadata {\n\tconst properties: Record<string, BuildingBlockPropertyDefinition> = {\n\t\tclass: {\n\t\t\ttype: \"string\",\n\t\t\tisPublic: true\n\t\t}\n\t};\n\tconst aggregations: Record<string, BuildingBlockAggregationDefinition> = {\n\t\tdependents: {\n\t\t\ttype: SAP_UI_CORE_ELEMENT,\n\t\t\tslot: \"dependents\",\n\t\t\tisPublic: true\n\t\t},\n\t\tcustomData: {\n\t\t\ttype: SAP_UI_CORE_ELEMENT,\n\t\t\tslot: \"customData\",\n\t\t\tisPublic: true\n\t\t},\n\t\tlayoutData: {\n\t\t\ttype: SAP_UI_CORE_ELEMENT,\n\t\t\tslot: \"layoutData\",\n\t\t\tisPublic: true\n\t\t},\n\t\t...buildingBlockMetadata.aggregations\n\t};\n\tconst metadataContexts: Record<string, BuildingBlockMetadataContextDefinition> = {};\n\n\tfor (const propertyName of Object.keys(buildingBlockMetadata.properties)) {\n\t\tconst propertyType = buildingBlockMetadata.properties[propertyName].type;\n\n\t\tif (propertyType !== SAP_UI_MODEL_CONTEXT) {\n\t\t\tproperties[propertyName] = buildingBlockMetadata.properties[propertyName];\n\t\t}\n\n\t\tif ([SAP_UI_MODEL_CONTEXT, \"object\", \"array\"].includes(propertyType)) {\n\t\t\t// Explicitly defined contexts, objects, and arrays may come from the metadataContext\n\t\t\tmetadataContexts[propertyName] = buildingBlockMetadata.properties[propertyName] as BuildingBlockMetadataContextDefinition;\n\t\t}\n\t}\n\n\treturn {\n\t\t...buildingBlockMetadata,\n\t\tproperties,\n\t\tmetadataContexts,\n\t\taggregations\n\t};\n}\n\n/**\n * Checks the absolute or context paths and returns an appropriate MetaContext.\n * @param oSettings Additional settings\n * @param sAttributeValue The attribute value\n * @returns The meta data context object\n */\nfunction _checkAbsoluteAndContextPaths(oSettings: TemplateProcessorSettings, sAttributeValue: string): MetaDataContext {\n\tlet sMetaPath: string;\n\tif (sAttributeValue && sAttributeValue.startsWith(\"/\")) {\n\t\t// absolute path - we just use this one\n\t\tsMetaPath = sAttributeValue;\n\t} else {\n\t\tlet sContextPath = oSettings.currentContextPath.getPath();\n\t\tif (!sContextPath.endsWith(\"/\")) {\n\t\t\tsContextPath += \"/\";\n\t\t}\n\t\tsMetaPath = sContextPath + sAttributeValue;\n\t}\n\treturn {\n\t\tmodel: \"metaModel\",\n\t\tpath: sMetaPath\n\t};\n}\n\n/**\n * This method helps to create the metadata context in case it is not yet available in the store.\n * @param oSettings Additional settings\n * @param sAttributeName The attribute name\n * @param sAttributeValue The attribute value\n * @returns The meta data context object\n */\nfunction _createInitialMetadataContext(\n\toSettings: TemplateProcessorSettings,\n\tsAttributeName: string,\n\tsAttributeValue: string\n): MetaDataContext {\n\tlet returnContext: MetaDataContext;\n\tif (sAttributeValue.startsWith(\"/uid--\") && !oSettings.models.converterContext.getProperty(sAttributeValue)) {\n\t\tconst data = unstoreObjectValue(sAttributeValue);\n\t\toSettings.models.converterContext.setProperty(sAttributeValue, data);\n\t\treturnContext = {\n\t\t\tmodel: \"converterContext\",\n\t\t\tpath: sAttributeValue\n\t\t};\n\t} else if ((sAttributeName === \"metaPath\" && oSettings.currentContextPath) || sAttributeName === \"contextPath\") {\n\t\treturnContext = _checkAbsoluteAndContextPaths(oSettings, sAttributeValue);\n\t} else if (sAttributeValue && sAttributeValue.startsWith(\"/\")) {\n\t\t// absolute path - we just use this one\n\t\treturnContext = {\n\t\t\tmodel: \"metaModel\",\n\t\t\tpath: sAttributeValue\n\t\t};\n\t} else {\n\t\treturnContext = {\n\t\t\tmodel: \"metaModel\",\n\t\t\tpath: oSettings.bindingContexts.entitySet ? oSettings.bindingContexts.entitySet.getPath(sAttributeValue) : sAttributeValue\n\t\t};\n\t}\n\treturn returnContext;\n}\n\nfunction _getMetadataContext(\n\toSettings: TemplateProcessorSettings,\n\toNode: Element,\n\tsAttributeName: string,\n\toVisitor: IVisitorCallback,\n\tbDoNotResolve: boolean,\n\tisOpen: boolean\n): MetaDataContext | undefined {\n\tlet oMetadataContext: MetaDataContext | undefined;\n\tif (!bDoNotResolve && oNode.hasAttribute(sAttributeName)) {\n\t\tlet sAttributeValue = oNode.getAttribute(sAttributeName) as string;\n\t\toMetadataContext = BindingInfo.parse(sAttributeValue);\n\t\tif (oMetadataContext && sAttributeName === \"metaPath\" && oMetadataContext.model && oMetadataContext.path) {\n\t\t\t// if the metaPath is filled through a JSON model, we can't use this context as the metadataContext,\n\t\t\t// but instead we have to create a new one with the actual value\n\t\t\tconst metaContextPath = `${oMetadataContext.model}>${oMetadataContext.path}`;\n\t\t\tconst context = oVisitor.getContext(metaContextPath);\n\t\t\tif (context?.getModel()?.isA(\"sap.ui.model.json.JSONModel\")) {\n\t\t\t\tsAttributeValue = context.getObject();\n\t\t\t\toMetadataContext = undefined;\n\t\t\t}\n\t\t}\n\n\t\tif (!oMetadataContext) {\n\t\t\toMetadataContext = _createInitialMetadataContext(oSettings, sAttributeName, sAttributeValue);\n\t\t}\n\t} else if (oSettings.bindingContexts.hasOwnProperty(sAttributeName)) {\n\t\toMetadataContext = {\n\t\t\tmodel: sAttributeName,\n\t\t\tpath: \"\"\n\t\t};\n\t} else if (isOpen) {\n\t\ttry {\n\t\t\tif (oVisitor.getContext(`${sAttributeName}>`)) {\n\t\t\t\toMetadataContext = {\n\t\t\t\t\tmodel: sAttributeName,\n\t\t\t\t\tpath: \"\"\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (e) {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\treturn oMetadataContext;\n}\n\n/**\n * Parse the incoming XML node and try to resolve the properties defined there.\n * @param oMetadata The metadata for the building block\n * @param oNode The XML node to parse\n * @param isPublic Whether the building block is used in a public context or not\n * @param oVisitor The visitor instance\n * @returns The processed properties\n */\nasync function processProperties(\n\toMetadata: TransformedBuildingBlockMetadata,\n\toNode: Element,\n\tisPublic: boolean,\n\toVisitor: IVisitorCallback\n): Promise<Record<string, ObjectValue>> {\n\tconst definitionProperties = oMetadata.properties;\n\n\t// Retrieve properties values\n\tconst aDefinitionPropertiesKeys = Object.keys(definitionProperties);\n\n\tconst propertyValues: Record<string, ObjectValue> = {};\n\tfor (const sKeyValue of aDefinitionPropertiesKeys) {\n\t\tif (definitionProperties[sKeyValue].type === \"object\") {\n\t\t\tpropertyValues[sKeyValue] =\n\t\t\t\tdefinitionProperties[sKeyValue].defaultValue && deepClone(definitionProperties[sKeyValue].defaultValue); // To avoid values being reused across macros\n\t\t} else {\n\t\t\tpropertyValues[sKeyValue] = definitionProperties[sKeyValue].defaultValue as string | boolean | number;\n\t\t}\n\n\t\tif (oNode.hasAttribute(sKeyValue) && isPublic && definitionProperties[sKeyValue].isPublic !== true) {\n\t\t\tLog.error(`Property ${sKeyValue} was ignored as it is not intended for public usage`);\n\t\t} else if (oNode.hasAttribute(sKeyValue)) {\n\t\t\tawait oVisitor.visitAttribute(oNode, oNode.attributes.getNamedItem(sKeyValue) as Attr);\n\t\t\tlet value: string | boolean | number | null | undefined = oNode.getAttribute(sKeyValue);\n\t\t\tif (value !== undefined && value !== null) {\n\t\t\t\tif (typeof value === \"string\" && !value.startsWith(\"{\")) {\n\t\t\t\t\tswitch (definitionProperties[sKeyValue].type) {\n\t\t\t\t\t\tcase \"boolean\":\n\t\t\t\t\t\t\tvalue = value === \"true\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"number\":\n\t\t\t\t\t\t\tvalue = Number(value);\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvalue = value === null ? undefined : value;\n\t\t\t\tpropertyValues[sKeyValue] = value;\n\t\t\t}\n\t\t}\n\t}\n\treturn propertyValues;\n}\n\n/**\n * Parse the incoming XML node and try to resolve the binding contexts defined inside.\n * @param oMetadata The metadata for the building block\n * @param oSettings The settings object\n * @param oNode The XML node to parse\n * @param isPublic Whether the building block is used in a public context or not\n * @param oVisitor The visitor instance\n * @param mContexts The contexts to be used\n * @param propertyValues The current property values\n * @returns The processed and missing contexts\n */\nfunction processContexts(\n\toMetadata: TransformedBuildingBlockMetadata,\n\toSettings: TemplateProcessorSettings,\n\toNode: Element,\n\tisPublic: boolean,\n\toVisitor: IVisitorCallback,\n\tmContexts: Record<string, Context>,\n\tpropertyValues: Record<string, ObjectValue>\n): Record<string, boolean> {\n\toSettings.currentContextPath = oSettings.bindingContexts.contextPath;\n\tconst mMissingContext: Record<string, boolean> = {};\n\tconst oDefinitionContexts = oMetadata.metadataContexts;\n\tconst aDefinitionContextsKeys = Object.keys(oDefinitionContexts);\n\t// Since the metaPath and other property can be relative to the contextPath we need to evaluate the current contextPath first\n\tconst contextPathIndex = aDefinitionContextsKeys.indexOf(\"contextPath\");\n\tif (contextPathIndex !== -1) {\n\t\t// If it is defined we extract it and reinsert it in the first position of the array\n\t\tconst contextPathDefinition = aDefinitionContextsKeys.splice(contextPathIndex, 1);\n\t\taDefinitionContextsKeys.splice(0, 0, contextPathDefinition[0]);\n\t}\n\tfor (const sAttributeName of aDefinitionContextsKeys) {\n\t\t// If the context was resolved as a property (binding / xml aggregation) then we don't need to resolve it here.\n\t\tconst propertyValue = propertyValues[sAttributeName];\n\t\tif (propertyValue !== undefined && typeof propertyValue === \"object\" && Object.keys(propertyValue as object).length > 0) {\n\t\t\tdelete oMetadata.metadataContexts[sAttributeName];\n\t\t\tcontinue;\n\t\t}\n\t\tconst bDoNotResolve = isPublic && oDefinitionContexts[sAttributeName].isPublic === false && oNode.hasAttribute(sAttributeName);\n\t\tconst oMetadataContext = _getMetadataContext(oSettings, oNode, sAttributeName, oVisitor, bDoNotResolve, oMetadata.isOpen ?? false);\n\t\tif (oMetadataContext) {\n\t\t\toMetadataContext.name = sAttributeName;\n\t\t\taddSingleContext(mContexts, oVisitor, oMetadataContext);\n\t\t\tif (\n\t\t\t\t(sAttributeName === \"entitySet\" || sAttributeName === \"contextPath\") &&\n\t\t\t\t!oSettings.bindingContexts.hasOwnProperty(sAttributeName)\n\t\t\t) {\n\t\t\t\toSettings.bindingContexts[sAttributeName] = mContexts[sAttributeName];\n\t\t\t}\n\t\t\tif (sAttributeName === \"contextPath\") {\n\t\t\t\toSettings.currentContextPath = mContexts[sAttributeName];\n\t\t\t}\n\t\t\tif (mContexts[sAttributeName] !== undefined) {\n\t\t\t\tpropertyValues[sAttributeName] = mContexts[sAttributeName];\n\t\t\t} else if (typeof propertyValues[sAttributeName] === \"string\") {\n\t\t\t\t// If the binding couldn't be resolved consider that there was no value here\n\t\t\t\tdelete oMetadata.metadataContexts[sAttributeName];\n\t\t\t}\n\t\t} else {\n\t\t\tmMissingContext[sAttributeName] = true;\n\t\t}\n\t}\n\treturn mMissingContext;\n}\n\nexport type BuildingBlockAggregation = {\n\tkey: string;\n\tposition: Position;\n\ttype: \"Slot\";\n};\nasync function parseAggregation(\n\toVisitor: IVisitorCallback,\n\toAggregation?: Element,\n\tdefinition?: BuildingBlockAggregationDefinition\n): Promise<Record<string, BuildingBlockAggregation>> {\n\tconst oOutObjects: Record<string, BuildingBlockAggregation> = {};\n\tif (oAggregation && oAggregation.children.length > 0) {\n\t\tconst firstElementChild = oAggregation.firstElementChild;\n\t\tif (firstElementChild?.namespaceURI === XMLTEMPLATING_NS) {\n\t\t\t// In case we encounter a templating tag, run the visitor on it and continue with the resulting child\n\t\t\tconst oParent = firstElementChild.parentNode;\n\t\t\tif (oParent) {\n\t\t\t\tawait oVisitor.visitNode(firstElementChild);\n\t\t\t}\n\t\t}\n\t\tconst children = oAggregation.children;\n\t\tfor (let childIdx = 0; childIdx < children.length; childIdx++) {\n\t\t\tconst childDefinition = children[childIdx];\n\t\t\tlet childKey =\n\t\t\t\tchildDefinition.getAttribute(\"key\") ||\n\t\t\t\tchildDefinition.getAttribute(\"id\") ||\n\t\t\t\t(definition?.skipKey && definition.multiple === false && uid());\n\t\t\tif (childKey) {\n\t\t\t\tchildKey = `InlineXML_${childKey}`;\n\t\t\t\tchildDefinition.setAttribute(\"key\", childKey);\n\t\t\t\tlet aggregationObject: BuildingBlockAggregation = {\n\t\t\t\t\tkey: childKey,\n\t\t\t\t\tposition: {\n\t\t\t\t\t\tplacement: (childDefinition.getAttribute(\"placement\") as Placement) || Placement.After,\n\t\t\t\t\t\tanchor: childDefinition.getAttribute(\"anchor\") || undefined\n\t\t\t\t\t},\n\t\t\t\t\ttype: \"Slot\"\n\t\t\t\t};\n\t\t\t\tif (definition?.processAggregations) {\n\t\t\t\t\taggregationObject = definition.processAggregations(childDefinition, aggregationObject);\n\t\t\t\t}\n\t\t\t\toOutObjects[aggregationObject.key] = aggregationObject;\n\t\t\t} else if (childDefinition.tagName !== \"slot\") {\n\t\t\t\tLog.error(`The aggregation ${childDefinition.nodeName} is missing a Key attribute. It is not displayed`);\n\t\t\t}\n\t\t}\n\t}\n\treturn oOutObjects;\n}\n\n/**\n * Processes the child nodes of the building block properties when the type is an object.\n * @param element The XML element to parse\n * @returns The processed object\n */\nfunction processObject(element: Element): object {\n\tconst children = element.children;\n\tconst myArray: Array<unknown> = [];\n\tconst myObject: Record<string, unknown> = {};\n\tfor (const attributeName of element.getAttributeNames()) {\n\t\tmyObject[attributeName] = element.getAttribute(attributeName);\n\t}\n\tif (children.length > 0) {\n\t\tconst childNodeNames = Object.keys(children).map((key) => children[key as unknown as number].localName);\n\t\tconst childIsArray = childNodeNames.length !== new Set(childNodeNames).size;\n\t\tfor (const childDefinition of children as unknown as Array<Element>) {\n\t\t\tif (childIsArray) {\n\t\t\t\tmyArray.push(processObject(childDefinition));\n\t\t\t} else {\n\t\t\t\tmyObject[childDefinition.localName] = processObject(childDefinition);\n\t\t\t}\n\t\t}\n\t\tif (childIsArray) {\n\t\t\treturn myArray;\n\t\t}\n\t}\n\treturn myObject;\n}\n\n/**\n * Processes the child nodes of the building block and parses them as either aggregations or object-/array-based values.\n * @param oNode The XML node for which to process the children\n * @param oVisitor The visitor instance\n * @param oMetadata The metadata for the building block\n * @param isPublic Whether the building block is used in a public context or not\n * @param propertyValues The values of already parsed property\n * @returns The processed children\n */\nasync function processChildren(\n\toNode: Element,\n\toVisitor: IVisitorCallback,\n\toMetadata: TransformedBuildingBlockMetadata,\n\tisPublic: boolean,\n\tpropertyValues: Record<string, ObjectValue>\n): Promise<Record<string, Element>> {\n\tconst oAggregations: Record<string, Element> = {};\n\tif (oNode.firstElementChild !== null) {\n\t\tlet oFirstElementChild: Element | null = oNode.firstElementChild as Element | null;\n\n\t\twhile (oFirstElementChild !== null) {\n\t\t\tif (oFirstElementChild.namespaceURI === XMLTEMPLATING_NS) {\n\t\t\t\t// In case we encounter a templating tag, run the visitor on it and continue with the resulting child\n\t\t\t\tconst oParent = oFirstElementChild.parentNode;\n\t\t\t\tif (oParent) {\n\t\t\t\t\tconst iChildIndex = Array.from(oParent.children).indexOf(oFirstElementChild);\n\t\t\t\t\tawait oVisitor.visitNode(oFirstElementChild);\n\t\t\t\t\toFirstElementChild = oParent.children[iChildIndex] ? oParent.children[iChildIndex] : null;\n\t\t\t\t} else {\n\t\t\t\t\t// Not sure how this could happen but I also don't want to create infinite loops\n\t\t\t\t\toFirstElementChild = oFirstElementChild.nextElementSibling;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst sChildName = oFirstElementChild.localName;\n\t\t\t\tlet sAggregationName = sChildName;\n\t\t\t\tif (sAggregationName[0].toUpperCase() === sAggregationName[0]) {\n\t\t\t\t\t// not a sub aggregation, go back to default Aggregation\n\t\t\t\t\tsAggregationName = oMetadata.defaultAggregation || \"\";\n\t\t\t\t}\n\t\t\t\tconst aggregationDefinition = oMetadata.aggregations[sAggregationName];\n\t\t\t\tif (aggregationDefinition !== undefined && !aggregationDefinition.slot) {\n\t\t\t\t\tconst parsedAggregation = await parseAggregation(oVisitor, oFirstElementChild, aggregationDefinition);\n\t\t\t\t\tpropertyValues[sAggregationName] = parsedAggregation;\n\t\t\t\t\tfor (const parsedAggregationKey in parsedAggregation) {\n\t\t\t\t\t\toMetadata.aggregations[parsedAggregationKey] = parsedAggregation[parsedAggregationKey];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toFirstElementChild = oFirstElementChild.nextElementSibling;\n\t\t\t}\n\t\t}\n\n\t\toFirstElementChild = oNode.firstElementChild;\n\t\twhile (oFirstElementChild !== null) {\n\t\t\tconst oNextChild: Element | null = oFirstElementChild.nextElementSibling;\n\t\t\tconst sChildName = oFirstElementChild.localName;\n\t\t\tlet sAggregationName = sChildName;\n\t\t\tif (sAggregationName[0].toUpperCase() === sAggregationName[0]) {\n\t\t\t\t// not a sub aggregation, go back to default Aggregation\n\t\t\t\tsAggregationName = oMetadata.defaultAggregation || \"\";\n\t\t\t}\n\t\t\tif (\n\t\t\t\tObject.keys(oMetadata.aggregations).includes(sAggregationName) &&\n\t\t\t\t(!isPublic || oMetadata.aggregations[sAggregationName].isPublic === true)\n\t\t\t) {\n\t\t\t\tconst aggregationDefinition = oMetadata.aggregations[sAggregationName];\n\t\t\t\tif (!aggregationDefinition.slot && oFirstElementChild !== null && oFirstElementChild.children.length > 0) {\n\t\t\t\t\tawait oVisitor.visitNode(oFirstElementChild);\n\t\t\t\t\tlet childDefinition = oFirstElementChild.firstElementChild;\n\t\t\t\t\twhile (childDefinition) {\n\t\t\t\t\t\tconst nextChild = childDefinition.nextElementSibling;\n\t\t\t\t\t\tif (!aggregationDefinition.hasVirtualNode) {\n\t\t\t\t\t\t\tconst childWrapper = document.createElementNS(oNode.namespaceURI, childDefinition.getAttribute(\"key\")!);\n\t\t\t\t\t\t\tchildWrapper.appendChild(childDefinition);\n\t\t\t\t\t\t\toAggregations[childDefinition.getAttribute(\"key\")!] = childWrapper;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toAggregations[childDefinition.getAttribute(\"key\")!] = childDefinition;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tchildDefinition.removeAttribute(\"key\");\n\t\t\t\t\t\tchildDefinition = nextChild;\n\t\t\t\t\t}\n\t\t\t\t} else if (aggregationDefinition.slot) {\n\t\t\t\t\tawait oVisitor.visitNode(oFirstElementChild);\n\t\t\t\t\tif (sAggregationName !== sChildName) {\n\t\t\t\t\t\tif (!oAggregations[sAggregationName]) {\n\t\t\t\t\t\t\tconst oNewChild = document.createElementNS(oNode.namespaceURI, sAggregationName);\n\t\t\t\t\t\t\toAggregations[sAggregationName] = oNewChild;\n\t\t\t\t\t\t}\n\t\t\t\t\t\toAggregations[sAggregationName].appendChild(oFirstElementChild.cloneNode(true) as Element);\n\t\t\t\t\t} else {\n\t\t\t\t\t\toAggregations[sAggregationName] = oFirstElementChild.cloneNode(true) as Element;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else if (Object.keys(oMetadata.properties).includes(sAggregationName)) {\n\t\t\t\tawait oVisitor.visitNode(oFirstElementChild);\n\t\t\t\tif (oMetadata.properties[sAggregationName].type === \"object\") {\n\t\t\t\t\tconst aggregationPropertyValues = processObject(oFirstElementChild);\n\t\t\t\t\tpropertyValues[sAggregationName] = aggregationPropertyValues;\n\t\t\t\t} else if (oMetadata.properties[sAggregationName].type === \"array\") {\n\t\t\t\t\tif (oFirstElementChild !== null && oFirstElementChild.children.length > 0) {\n\t\t\t\t\t\tconst children = oFirstElementChild.children;\n\t\t\t\t\t\tconst oOutObjects: Record<string, ObjectValue2>[] = [];\n\t\t\t\t\t\tfor (let childIdx = 0; childIdx < children.length; childIdx++) {\n\t\t\t\t\t\t\tconst childDefinition = children[childIdx];\n\t\t\t\t\t\t\t// non keyed child, just add it to the aggregation\n\t\t\t\t\t\t\tconst myChild: Record<string, ObjectValue2> = {};\n\t\t\t\t\t\t\tconst attributeNames = childDefinition.getAttributeNames();\n\t\t\t\t\t\t\tfor (const attributeName of attributeNames) {\n\t\t\t\t\t\t\t\tmyChild[attributeName] = childDefinition.getAttribute(attributeName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\toOutObjects.push(myChild);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tpropertyValues[sAggregationName] = oOutObjects;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\toFirstElementChild = oNextChild;\n\t\t}\n\t}\n\treturn oAggregations;\n}\n\nfunction processSlots(\n\toAggregations: Record<string, Element>,\n\toMetadataAggregations: Record<string, BuildingBlockAggregationDefinition>,\n\toNode: Element,\n\tprocessCustomData = false\n): void {\n\tif (Object.keys(oAggregations).length > 0) {\n\t\tObject.keys(oAggregations).forEach(function (sAggregationName: string) {\n\t\t\tconst oAggregationElement = oAggregations[sAggregationName];\n\t\t\tif (oNode !== null && oNode !== undefined && oAggregationElement) {\n\t\t\t\t// slots can have :: as keys which is not a valid aggregation name therefore replacing them\n\t\t\t\tconst oElementChild = oAggregationElement.firstElementChild;\n\t\t\t\tif (![\"dependents\", \"customData\", \"layoutData\"].includes(sAggregationName)) {\n\t\t\t\t\tconst sSlotName =\n\t\t\t\t\t\t(oMetadataAggregations[sAggregationName] !== undefined && oMetadataAggregations[sAggregationName].slot) ||\n\t\t\t\t\t\tsAggregationName;\n\t\t\t\t\tconst oTargetElement = oNode.querySelector(`slot[name='${sSlotName}']`);\n\t\t\t\t\tif (oTargetElement !== null) {\n\t\t\t\t\t\tconst oNewChild = prepareAggregationElement(oNode, sAggregationName, oElementChild);\n\t\t\t\t\t\toTargetElement.replaceWith(...(oNewChild.children as unknown as Node[])); // Somehow TS doesn't like this but the documentation says is should work\n\t\t\t\t\t}\n\t\t\t\t} else if (processCustomData && oElementChild !== null) {\n\t\t\t\t\tconst sSlotName =\n\t\t\t\t\t\t(oMetadataAggregations[sAggregationName] !== undefined && oMetadataAggregations[sAggregationName].slot) ||\n\t\t\t\t\t\tsAggregationName;\n\t\t\t\t\tconst oTargetElement = oNode.querySelector(`slot[name='${sSlotName}']`);\n\t\t\t\t\tconst oNewChild = prepareAggregationElement(oNode, sAggregationName, oElementChild);\n\t\t\t\t\tif (oTargetElement !== null) {\n\t\t\t\t\t\toTargetElement.replaceWith(...(oNewChild.children as unknown as Node[])); // Somehow TS doesn't like this but the documentation says is should work\n\t\t\t\t\t} else {\n\t\t\t\t\t\toNode.appendChild(oNewChild);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n\nfunction prepareAggregationElement(oNode: Element, sAggregationName: string, oElementChild: Element | null): Element {\n\tconst oNewChild = document.createElementNS(oNode.namespaceURI, sAggregationName.replace(/:/gi, \"_\"));\n\twhile (oElementChild) {\n\t\tconst oNextChild = oElementChild.nextElementSibling;\n\t\toNewChild.appendChild(oElementChild);\n\t\toElementChild = oNextChild;\n\t}\n\treturn oNewChild;\n}\n\nasync function processBuildingBlock(\n\tBuildingBlockClass: typeof BuildingBlockTemplatingBase,\n\toNode: Element,\n\toVisitor: IVisitorCallback,\n\tisPublic = false\n): Promise<void> {\n\tconst oMetadata = transformMetadata(BuildingBlockClass.metadata);\n\n\tconst sFragmentName = oMetadata.fragment ?? `${oMetadata.namespace ?? oMetadata.publicNamespace}.${oMetadata.xmlTag ?? oMetadata.name}`;\n\n\tconst mContexts: Record<string, Context> = {};\n\tconst oSettings = oVisitor.getSettings();\n\n\t// Add an empty converter context if there is none in order to have a place to store object values\n\toSettings.models.converterContext ??= new JSONModel();\n\n\t//Inject storage for macros\n\tif (!oSettings[sFragmentName]) {\n\t\toSettings[sFragmentName] = {};\n\t}\n\n\t// First of all we need to visit the attributes to resolve the properties and the metadata contexts\n\tconst propertyValues = await processProperties(oMetadata, oNode, isPublic, oVisitor);\n\tconst initialKeys = Object.keys(propertyValues);\n\tconst mMissingContext = processContexts(oMetadata, oSettings, oNode, isPublic, oVisitor, mContexts, propertyValues);\n\n\ttry {\n\t\t// Aggregation and complex type support\n\t\tconst oAggregations = await processChildren(oNode, oVisitor, oMetadata, isPublic, propertyValues);\n\t\tlet oControlConfig = {};\n\n\t\tif (oSettings.models.viewData) {\n\t\t\t// Only used in the Field macro and even then maybe not really useful\n\t\t\toControlConfig = oSettings.models.viewData.getProperty(\"/controlConfiguration\");\n\t\t}\n\t\tlet processedPropertyValues = propertyValues;\n\n\t\tObject.keys(propertyValues).forEach((propName) => {\n\t\t\tlet oData = propertyValues[propName] as unknown as Context;\n\t\t\t//check for additional processing function to validate / overwrite parameters\n\t\t\tconst originalDefinition = BuildingBlockClass?.metadata?.properties[propName];\n\t\t\tif (originalDefinition?.validate) {\n\t\t\t\toData = originalDefinition.validate(oData) || oData;\n\t\t\t}\n\t\t\tif (oData?.isA?.(SAP_UI_MODEL_CONTEXT) && !oData.getModel().isA(\"sap.ui.model.odata.v4.ODataMetaModel\")) {\n\t\t\t\tpropertyValues[propName] = oData.getObject();\n\t\t\t}\n\t\t});\n\t\tpropertyValues.isPublic = isPublic;\n\n\t\tconst oInstance = new BuildingBlockClass({ ...propertyValues, ...oAggregations }, oControlConfig, oSettings);\n\t\tprocessedPropertyValues = oInstance.getProperties();\n\t\tObject.keys(oMetadata.metadataContexts).forEach(function (sContextName: string) {\n\t\t\tif (processedPropertyValues.hasOwnProperty(sContextName)) {\n\t\t\t\tconst targetObject = processedPropertyValues[sContextName];\n\t\t\t\tif (isContext(targetObject)) {\n\t\t\t\t\tmContexts[sContextName] = targetObject as Context;\n\t\t\t\t} else if (typeof targetObject === \"object\") {\n\t\t\t\t\tconst attributeValue = storeObjectValue(targetObject);\n\t\t\t\t\toSettings.models.converterContext.setProperty(attributeValue, targetObject);\n\t\t\t\t\tconst newContext = oSettings.models.converterContext.createBindingContext(attributeValue)!;\n\t\t\t\t\tunstoreObjectValue(attributeValue);\n\t\t\t\t\tmContexts[sContextName] = newContext;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst oAttributesModel: JSONModel = new AttributeModel(oNode, processedPropertyValues, BuildingBlockClass);\n\t\tmContexts[\"this\"] = oAttributesModel.createBindingContext(\"/\");\n\t\tlet oPreviousMacroInfo: MacroInfo | undefined;\n\t\t// core:require need to be defined on the node itself to be picked up due to the templating step\n\t\tconst coreRequire = oNode?.getAttribute(\"core:require\") || undefined;\n\n\t\t// Keep track\n\t\tif (TraceInfo.isTraceInfoActive()) {\n\t\t\tconst oTraceInfo = TraceInfo.traceMacroCalls(sFragmentName, oMetadata, mContexts, oNode, oVisitor);\n\t\t\tif (oTraceInfo?.macroInfo) {\n\t\t\t\toPreviousMacroInfo = oSettings[\"_macroInfo\"];\n\t\t\t\toSettings[\"_macroInfo\"] = oTraceInfo.macroInfo;\n\t\t\t}\n\t\t}\n\t\tvalidateMacroSignature(sFragmentName, oMetadata, mContexts, oNode);\n\n\t\tconst oContextVisitor = oVisitor.with(mContexts, oMetadata.isOpen !== undefined ? !oMetadata.isOpen : true);\n\t\tconst oParent = oNode.parentNode;\n\n\t\tlet iChildIndex: number;\n\t\tlet oPromise;\n\t\tif (oParent) {\n\t\t\tiChildIndex = Array.from(oParent.children).indexOf(oNode);\n\n\t\t\tif (oMetadata.fragment) {\n\t\t\t\toPromise = oContextVisitor.insertFragment(sFragmentName, oNode);\n\t\t\t} else {\n\t\t\t\tconst oldKeys = Object.keys(temporaryObjectStore);\n\t\t\t\tconst templateString = await jsx.renderAsXML(async () => oInstance.getTemplate!(oNode));\n\n\t\t\t\tif (BuildingBlockClass.isRuntime) {\n\t\t\t\t\t// For runtime building blocks, we need to attach all objects to the converterContext directly, as the actual rendering takes place at runtime\n\t\t\t\t\tfor (const storeKey in temporaryObjectStore) {\n\t\t\t\t\t\tif (!oldKeys.includes(storeKey)) {\n\t\t\t\t\t\t\tconst data = unstoreObjectValue(storeKey);\n\t\t\t\t\t\t\toSettings.models.converterContext.setProperty(storeKey, data);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tlet hasError = \"\";\n\t\t\t\tif (templateString) {\n\t\t\t\t\tlet hasParseError = false;\n\t\t\t\t\tlet parsedTemplate = parseXMLString(templateString, true);\n\t\t\t\t\t// For safety purpose we try to detect trailing text in between XML Tags\n\t\t\t\t\tfor (const element of parsedTemplate) {\n\t\t\t\t\t\tconst iter = document.createNodeIterator(element, NodeFilter.SHOW_TEXT);\n\t\t\t\t\t\tlet textnode = iter.nextNode();\n\t\t\t\t\t\tif (element.localName === \"parsererror\") {\n\t\t\t\t\t\t\thasParseError = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twhile (textnode) {\n\t\t\t\t\t\t\tif (textnode.textContent && textnode.textContent.trim().length > 0) {\n\t\t\t\t\t\t\t\thasError = textnode.textContent;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ttextnode = iter.nextNode();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tif (hasParseError) {\n\t\t\t\t\t\t// If there is a parseerror while processing the XML it means the XML itself is malformed, as such we rerun the template process\n\t\t\t\t\t\t// Setting isTraceMode true will make it so that each xml` expression is checked for validity from XML perspective\n\t\t\t\t\t\t// If an error is found it's returned instead of the normal fragment\n\t\t\t\t\t\tLog.error(`Error while processing building block ${oMetadata.xmlTag || oMetadata.name}`, hasError);\n\t\t\t\t\t\tparsedTemplate = (await processXmlInTrace(async () => {\n\t\t\t\t\t\t\tconst initialTemplate = await jsx.renderAsXML(async () => oInstance.getTemplate!(oNode));\n\n\t\t\t\t\t\t\treturn parseXMLString(initialTemplate ?? \"\", true);\n\t\t\t\t\t\t})) as Element[];\n\t\t\t\t\t} else if (hasError.length > 0) {\n\t\t\t\t\t\t// If there is trailing text we create a standard error and display it.\n\t\t\t\t\t\tLog.error(`Error while processing building block ${oMetadata.xmlTag || oMetadata.name}`);\n\t\t\t\t\t\tconst oErrorText = createErrorXML(\n\t\t\t\t\t\t\t[\n\t\t\t\t\t\t\t\t`Error while processing building block ${oMetadata.xmlTag || oMetadata.name}`,\n\t\t\t\t\t\t\t\t`Trailing text was found in the XML: ${hasError}`\n\t\t\t\t\t\t\t],\n\t\t\t\t\t\t\tparsedTemplate.map((template) => template.outerHTML).join(\"\\n\")\n\t\t\t\t\t\t);\n\t\t\t\t\t\tparsedTemplate = parseXMLString(oErrorText, true);\n\t\t\t\t\t}\n\t\t\t\t\toNode.replaceWith(...parsedTemplate);\n\n\t\t\t\t\tconst visitedNodes = parsedTemplate.map(async (internalNode) => {\n\t\t\t\t\t\tprocessSlots(oAggregations, oMetadata.aggregations, internalNode, false);\n\t\t\t\t\t\treturn oContextVisitor.visitNode(internalNode);\n\t\t\t\t\t});\n\t\t\t\t\toPromise = Promise.all(visitedNodes);\n\t\t\t\t} else {\n\t\t\t\t\toNode.remove();\n\t\t\t\t\toPromise = Promise.resolve();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tawait oPromise;\n\t\t\tconst oMacroElement = oParent.children[iChildIndex];\n\t\t\tprocessSlots(oAggregations, oMetadata.aggregations, oMacroElement, true);\n\t\t\tif (oMacroElement !== undefined) {\n\t\t\t\tconst oRemainingSlots = oMacroElement.querySelectorAll(\"slot\");\n\t\t\t\toRemainingSlots.forEach(function (oSlotElement) {\n\t\t\t\t\toSlotElement.remove();\n\t\t\t\t});\n\t\t\t\tif (coreRequire) {\n\t\t\t\t\tlet requireOnMacro = oMacroElement.getAttributeNS(\"sap.ui.core\", \"require\");\n\t\t\t\t\tif (requireOnMacro) {\n\t\t\t\t\t\trequireOnMacro = requireOnMacro.substring(0, requireOnMacro.length - 1) + \",\" + coreRequire.substring(1); // Remove last } and first {\n\t\t\t\t\t} else {\n\t\t\t\t\t\trequireOnMacro = coreRequire;\n\t\t\t\t\t}\n\t\t\t\t\toMacroElement.setAttributeNS(\"sap.ui.core\", \"core:require\", requireOnMacro);\n\t\t\t\t}\n\t\t\t\tif (propertyValues.class && !BuildingBlockClass.isRuntime) {\n\t\t\t\t\toMacroElement.classList.add(propertyValues.class as string);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif (oPreviousMacroInfo) {\n\t\t\t//restore macro info if available\n\t\t\toSettings[\"_macroInfo\"] = oPreviousMacroInfo;\n\t\t} else {\n\t\t\tdelete oSettings[\"_macroInfo\"];\n\t\t}\n\t} catch (e: unknown) {\n\t\t// In case there is a generic error (usually code error), we retrieve the current context information and create a dedicated error message\n\n\t\tconst traceDetails = {\n\t\t\tinitialProperties: {} as Record<string, unknown>,\n\t\t\tresolvedProperties: {} as Record<string, unknown>,\n\t\t\tmissingContexts: mMissingContext\n\t\t};\n\t\tfor (const propertyName of initialKeys) {\n\t\t\tconst propertyValue = propertyValues[propertyName];\n\t\t\tif (isContext(propertyValue)) {\n\t\t\t\ttraceDetails.initialProperties[propertyName] = {\n\t\t\t\t\tpath: propertyValue.getPath(),\n\t\t\t\t\tvalue: propertyValue.getObject()\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\ttraceDetails.initialProperties[propertyName] = propertyValue;\n\t\t\t}\n\t\t}\n\t\tfor (const propertyName in propertyValues) {\n\t\t\tconst propertyValue = propertyValues[propertyName];\n\t\t\tif (!initialKeys.includes(propertyName)) {\n\t\t\t\tif (isContext(propertyValue)) {\n\t\t\t\t\ttraceDetails.resolvedProperties[propertyName] = {\n\t\t\t\t\t\tpath: propertyValue.getPath(),\n\t\t\t\t\t\tvalue: propertyValue.getObject()\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\ttraceDetails.resolvedProperties[propertyName] = propertyValue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tLog.error(e as string);\n\t\tconst oError = createErrorXML(\n\t\t\t[`Error while processing building block ${oMetadata.name}`],\n\t\t\toNode.outerHTML,\n\t\t\ttraceDetails,\n\t\t\t(e as Error).stack\n\t\t);\n\t\tconst oTemplate = parseXMLString(oError, true);\n\t\toNode.replaceWith(...oTemplate);\n\t}\n}\nfunction addSingleContext(\n\tmContexts: Record<string, Context | undefined>,\n\toVisitor: IVisitorCallback,\n\toCtx: {\n\t\tname?: string;\n\t\tpath: string;\n\t\tmodel?: string;\n\t}\n): void {\n\tconst sKey = (oCtx.name || oCtx.model || undefined) as string;\n\tif (mContexts[sKey]) {\n\t\treturn; // do not add twice\n\t}\n\ttry {\n\t\tlet sContextPath = oCtx.path;\n\t\tif (oCtx.model !== null) {\n\t\t\tsContextPath = `${oCtx.model}>${sContextPath}`;\n\t\t}\n\t\tconst mSetting = oVisitor.getSettings();\n\t\tif (oCtx.model === \"converterContext\" && oCtx.path.length > 0) {\n\t\t\tmContexts[sKey] = mSetting.models[oCtx.model].getContext(oCtx.path /*, mSetting.bindingContexts[oCtx.model]*/); // add the context to the visitor\n\t\t} else if (!mSetting.bindingContexts[oCtx.model!] && mSetting.models[oCtx.model!]) {\n\t\t\tmContexts[sKey] = mSetting.models[oCtx.model!].getContext(oCtx.path); // add the context to the visitor\n\t\t} else {\n\t\t\tmContexts[sKey] = oVisitor.getContext(sContextPath); // add the context to the visitor\n\t\t}\n\t} catch (ex) {\n\t\t// ignore the context as this can only be the case if the model is not ready,\n\t\t// i.e. not a preprocessing model but maybe a model for providing afterwards\n\t}\n}\n\n/**\n * Register a building block definition to be used inside the xml template processor.\n * @param BuildingBlockClass The building block definition\n */\nexport function registerBuildingBlock(BuildingBlockClass: typeof BuildingBlockTemplatingBase): void {\n\tif (BuildingBlockClass.metadata.namespace !== undefined) {\n\t\tXMLPreprocessor.plugIn(\n\t\t\tasync (oNode: Element, oVisitor: IVisitorCallback) => processBuildingBlock(BuildingBlockClass, oNode, oVisitor),\n\t\t\tBuildingBlockClass.metadata.namespace,\n\t\t\tBuildingBlockClass.metadata.xmlTag || BuildingBlockClass.metadata.name\n\t\t);\n\t}\n\tif (BuildingBlockClass.metadata.publicNamespace !== undefined) {\n\t\tXMLPreprocessor.plugIn(\n\t\t\tasync (oNode: Element, oVisitor: IVisitorCallback) => processBuildingBlock(BuildingBlockClass, oNode, oVisitor, true),\n\t\t\tBuildingBlockClass.metadata.publicNamespace,\n\t\t\tBuildingBlockClass.metadata.xmlTag || BuildingBlockClass.metadata.name\n\t\t);\n\t}\n}\n\n/**\n * UnRegister a building block definition so that it is no longer used inside the xml template processor.\n * @param BuildingBlockClass The building block definition\n */\nexport function unregisterBuildingBlock(BuildingBlockClass: typeof BuildingBlockTemplatingBase): void {\n\tif (BuildingBlockClass.metadata.namespace !== undefined) {\n\t\tXMLPreprocessor.plugIn(\n\t\t\tnull,\n\t\t\tBuildingBlockClass.metadata.namespace,\n\t\t\tBuildingBlockClass.metadata.xmlTag || BuildingBlockClass.metadata.name\n\t\t);\n\t}\n\tif (BuildingBlockClass.metadata.publicNamespace !== undefined) {\n\t\tXMLPreprocessor.plugIn(\n\t\t\tnull,\n\t\t\tBuildingBlockClass.metadata.publicNamespace,\n\t\t\tBuildingBlockClass.metadata.xmlTag || BuildingBlockClass.metadata.name\n\t\t);\n\t}\n}\n\nfunction createErrorXML(errorMessages: string[], xmlFragment: string, additionalData?: object, stack?: string): string {\n\tconst errorLabels = errorMessages.map((errorMessage) => xml`<m:Label text=\"${escapeXMLAttributeValue(errorMessage)}\"/>`);\n\tlet errorStack = \"\";\n\tif (stack) {\n\t\tconst stackFormatted = btoa(`<pre>${stack}</pre>`);\n\t\terrorStack = xml`<m:FormattedText htmlText=\"{= BBF.base64Decode('${stackFormatted}') }\" />`;\n\t}\n\tlet additionalText = \"\";\n\tif (additionalData) {\n\t\tlet jsonValue = \"\";\n\t\ttry {\n\t\t\tjsonValue = btoa(JSON.stringify(additionalData, null, 4));\n\t\t} catch (e) {\n\t\t\tjsonValue = btoa(JSON.stringify({ error: \"Could not stringify additionalData due to circular structure.\" }, null, 4));\n\t\t}\n\n\t\tadditionalText = xml`<m:VBox>\n\t\t\t<m:Label text=\"Trace Info\"/>\n\t\t\t<code:CodeEditor type=\"json\"  value=\"${`{= BBF.base64Decode('${jsonValue}') }`}\" height=\"300px\" />\n\t\t</m:VBox>`;\n\t}\n\treturn xml`<controls:FormElementWrapper xmlns:controls=\"sap.fe.core.controls\">\n\t\t\t\t\t<m:VBox xmlns:m=\"sap.m\" xmlns:code=\"sap.ui.codeeditor\" core:require=\"{BBF:'sap/fe/core/buildingBlocks/templating/BuildingBlockFormatter'}\">\n\t\t\t\t\t${errorLabels}\n\t\t\t\t\t${errorStack}\n\t\t\t\t\t\t<grid:CSSGrid gridTemplateRows=\"fr\" gridTemplateColumns=\"repeat(2,1fr)\" gridGap=\"1rem\" xmlns:grid=\"sap.ui.layout.cssgrid\" >\n\t\t\t\t\t\t\t<m:VBox>\n\t\t\t\t\t\t\t\t<m:Label text=\"How the building block was called\"/>\n\t\t\t\t\t\t\t\t<code:CodeEditor type=\"xml\" value=\"${`{= BBF.base64Decode('${btoa(xmlFragment.replaceAll(\"&gt;\", \">\"))}') }`}\" height=\"300px\" />\n\t\t\t\t\t\t\t</m:VBox>\n\t\t\t\t\t\t\t${additionalText}\n\t\t\t\t\t\t</grid:CSSGrid>\n\t\t\t\t\t</m:VBox>\n\t\t\t\t</controls:FormElementWrapper>`;\n}\n\nconst temporaryObjectStore: Record<string, unknown> = {};\n\n/**\n * Stores an object value in a temporary storage and returns an ID used to retrieve this value at a later point in time.\n *\n * Required as there is functionality like the xml` function, which might take objects as parameters but needs to return a serialized string.\n * @param value Value to store\n * @returns ID to retrieve this value\n */\nexport function storeObjectValue(value: unknown): string {\n\tconst propertyUID = `/uid--${uid()}`;\n\ttemporaryObjectStore[propertyUID] = value;\n\treturn propertyUID;\n}\n\n/**\n * Unstores an object from a temporary store by removing it and returning its object value.\n * @param propertyUID ID to retrieve this value\n * @returns Object value\n */\nfunction unstoreObjectValue(propertyUID: string): unknown {\n\tconst value = temporaryObjectStore[propertyUID];\n\tdelete temporaryObjectStore[propertyUID];\n\treturn value;\n}\n\nlet processNextXmlInTrace = false;\n/**\n * Makes sure that all xml` calls inside the given method are processed in trace mode.\n * @param method The method to execute\n * @returns The return value of the given method\n */\nconst processXmlInTrace = async function (method: (...args: unknown[]) => Promise<unknown>): Promise<unknown> {\n\tprocessNextXmlInTrace = true;\n\tlet returnValue;\n\ttry {\n\t\treturnValue = method();\n\t} finally {\n\t\tprocessNextXmlInTrace = false;\n\t}\n\treturn returnValue;\n};\n\n/**\n * Parse an XML string and return the associated document.\n * @param xmlString The xml string\n * @param [addDefaultNamespaces] Whether or not default namespaces should be added\n * @returns The XML document.\n */\nexport function parseXMLString(xmlString: string, addDefaultNamespaces = false): Element[] {\n\tif (addDefaultNamespaces) {\n\t\txmlString = `<template\n\t\t\t\t\t\txmlns:template=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.template/1\"\n\t\t\t\t\t\txmlns:m=\"sap.m\"\n\t\t\t\t\t\txmlns:macros=\"sap.fe.macros\"\n\t\t\t\t\t\txmlns:core=\"sap.ui.core\"\n\t\t\t\t\t\txmlns:mdc=\"sap.ui.mdc\"\n\t\t\t\t\t\txmlns:customData=\"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\">${xmlString}</template>`;\n\t}\n\tconst xmlDocument = DOMParserInstance.parseFromString(xmlString, \"text/xml\");\n\tlet output = xmlDocument.firstElementChild;\n\twhile (output?.localName === \"template\") {\n\t\toutput = output.firstElementChild;\n\t}\n\tconst children = output?.parentElement ? output?.parentElement.children : [output as Element];\n\treturn Array.from(children);\n}\n\n/**\n * Escape an XML attribute value.\n * @param value The attribute value to escape.\n * @returns The escaped string.\n */\nexport function escapeXMLAttributeValue(value?: string): string | undefined {\n\treturn value?.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&apos;\");\n}\n\nfunction renderInTraceMode(outStr: string): string {\n\tconst xmlResult = parseXMLString(outStr, true);\n\tif (xmlResult?.length > 0 && xmlResult[0]?.localName === \"parsererror\") {\n\t\tconst errorMessage = (xmlResult[0] as HTMLElement).innerText || (xmlResult[0] as HTMLElement).innerHTML;\n\t\treturn createErrorXML([errorMessage.split(\"\\n\")[0]], outStr);\n\t} else {\n\t\treturn outStr;\n\t}\n}\n\nexport type XMLProcessorTypeValue =\n\t| string\n\t| boolean\n\t| number\n\t| undefined\n\t| null\n\t| object\n\t| Record<string, unknown>\n\t| BindingToolkitExpression<string | boolean | number>\n\t| Array<string>\n\t| Array<Function>\n\t| Function\n\t| Context;\n/**\n * Create a string representation of the template literal while handling special object case.\n * @param strings The string parts of the template literal\n * @param values The values part of the template literal\n * @returns The XML string document representing the string that was used.\n */\nexport const xml = (strings: TemplateStringsArray, ...values: XMLProcessorTypeValue[]): string => {\n\tlet outStr = \"\";\n\tlet i;\n\tfor (i = 0; i < values.length; i++) {\n\t\toutStr += strings[i];\n\n\t\t// Handle the different case of object, if it's an array we join them, if it's a binding expression then we compile it.\n\t\tconst value = values[i];\n\n\t\tif (Array.isArray(value) && value.length > 0 && typeof value[0] === \"string\") {\n\t\t\toutStr += value.flat(5).join(\"\\n\").trim();\n\t\t} else if (isFunctionArray(value)) {\n\t\t\toutStr += value.map((valuefn) => valuefn()).join(\"\\n\");\n\t\t} else if (isBindingToolkitExpression(value)) {\n\t\t\tconst compiledExpression = compileExpression(value);\n\t\t\toutStr += escapeXMLAttributeValue(compiledExpression);\n\t\t} else if (typeof value === \"undefined\") {\n\t\t\toutStr += \"{this>undefinedValue}\";\n\t\t} else if (typeof value === \"function\") {\n\t\t\toutStr += value();\n\t\t} else if (typeof value === \"object\" && value !== null) {\n\t\t\tif (isContext(value)) {\n\t\t\t\toutStr += value.getPath();\n\t\t\t} else {\n\t\t\t\tconst propertyUId = storeObjectValue(value);\n\t\t\t\toutStr += `${propertyUId}`;\n\t\t\t}\n\t\t} else if (value && typeof value === \"string\" && !value.startsWith(\"<\") && !value.startsWith(\"&lt;\")) {\n\t\t\toutStr += escapeXMLAttributeValue(value);\n\t\t} else {\n\t\t\toutStr += value;\n\t\t}\n\t}\n\toutStr += strings[i];\n\toutStr = outStr.trim();\n\tif (processNextXmlInTrace) {\n\t\treturn renderInTraceMode(outStr);\n\t}\n\treturn outStr;\n};\n\nexport const addConditionallyToXML = function (condition: boolean, partToAdd: string): string {\n\tif (condition) {\n\t\treturn partToAdd;\n\t} else {\n\t\treturn \"\";\n\t}\n};\n\n/**\n * Add an attribute depending on the current value of the property.\n * If it's undefined the attribute is not added.\n * @param attributeName\n * @param value\n * @returns The attribute to add if the value is not undefined, otherwise an empty string\n */\nexport const addAttributeToXML = function (attributeName: string, value?: XMLProcessorTypeValue): () => string {\n\tif (value !== undefined && !isUndefinedExpression(value)) {\n\t\treturn () => xml`${attributeName}=\"${value}\"`;\n\t} else {\n\t\treturn () => \"\";\n\t}\n};\n"],"mappings":"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","ignoreList":[],"file":"BuildingBlockTemplateProcessor-dbg.js"}