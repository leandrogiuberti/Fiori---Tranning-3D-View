{"version":3,"file":"DataWatcher.js","names":["DataWatcher","_dec","defineUI5Class","_dec2","property","type","_dec3","event","_class","_class2","_UI5Element","idOrProps","props","scope","_this","call","this","_initializerDefineProperty","_descriptor","_descriptor2","isInitial","isSingleton","propertyBinding","startsWith","_exports","_inheritsLoose","_proto","prototype","setPropertyBinding","oldValue","getProperty","_previousContextPath","getBindingContext","getPath","_initialValue","setProperty","fireEvent","value","context","UI5Element","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./DataWatcher.tsx"],"sourcesContent":["import type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { defineUI5Class, event, property } from \"sap/fe/base/ClassSupport\";\nimport type UI5Event from \"sap/ui/base/Event\";\nimport UI5Element from \"sap/ui/core/Element\";\nimport type Context from \"sap/ui/model/Context\";\nimport type { EventHandler } from \"types/extension_types\";\n\n/**\n * A callback function that is called when the value of the watched property changes.\n * @param value The new value of the watched property\n * @param oldValue The old value of the watched property\n * @param isInitial Whether the value change is the initial value\n * @param context The binding context of the watched property\n * @typedef\n * @public\n */\nexport type WatcherCallback = (value: unknown, oldValue: unknown, isInitial: boolean, context: Context) => void;\n\n/**\n * The DataWatcher is an element you can use to watch a property binding and get notified when the value changes.\n *\n */\n@defineUI5Class(\"sap.fe.core.controls.DataWatcher\")\nexport default class DataWatcher extends UI5Element {\n\t@property({ type: \"any\" })\n\tpropertyBinding?: unknown;\n\n\t@event()\n\tvalueChanged?: EventHandler<UI5Event<{ value: unknown; oldValue: unknown; isInitial: boolean; context: Context }, DataWatcher>>;\n\n\tprivate _initialValue?: unknown;\n\n\tprivate isInitial: boolean;\n\n\tprivate _previousContextPath?: string;\n\n\tprivate isSingleton?: boolean;\n\n\tconstructor(idOrProps?: string | PropertiesOf<DataWatcher>, props?: PropertiesOf<DataWatcher>, scope?: unknown) {\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tsuper(idOrProps as string | undefined, props, scope); // need to pass scope here\n\t\tthis.isInitial = true;\n\t\tthis.isSingleton = ((typeof idOrProps !== \"string\" ? idOrProps : props)?.propertyBinding as string).startsWith(\"{/\");\n\t}\n\n\tsetPropertyBinding(propertyBinding: string): void {\n\t\tconst oldValue = this.getProperty(\"propertyBinding\");\n\t\t// for singleton it doesn't matter if the context of the view changes\n\t\tif (this.isInitial || (!this.isSingleton && this._previousContextPath !== this.getBindingContext()?.getPath())) {\n\t\t\tthis.isInitial = false;\n\t\t\tthis._initialValue = propertyBinding;\n\t\t\tthis._previousContextPath = this.getBindingContext()?.getPath();\n\t\t}\n\t\tsuper.setProperty(\"propertyBinding\", propertyBinding, true);\n\t\tthis.fireEvent(\"valueChanged\", {\n\t\t\tvalue: propertyBinding,\n\t\t\toldValue: oldValue,\n\t\t\tisInitial: propertyBinding === this._initialValue,\n\t\t\tcontext: this.getBindingContext()\n\t\t});\n\t}\n}\n"],"mappings":";;;;inCAkBA,IAKqBA,GAAWC,EAD/BC,EAAe,oCAAmCC,EAEjDC,EAAS,CAAEC,KAAM,QAAQC,EAGzBC,IAAON,EAAAO,GAAAC,EAAA,SAAAC,GAWR,SAAAV,EAAYW,EAAgDC,EAAmCC,GAAiB,IAAAC,EAG/GA,EAAAJ,EAAAK,KAAAC,KAAML,EAAiCC,EAAOC,IAAMG,KAAEC,EAAAH,EAAA,kBAAAI,EAAAJ,GAAAG,EAAAH,EAAA,eAAAK,EAAAL,GACtDA,EAAKM,UAAY,KACjBN,EAAKO,qBAAuBV,IAAc,SAAWA,EAAYC,IAAQU,iBAA2BC,WAAW,MAAM,OAAAT,CACtH,CAACU,EAAAxB,EAAAyB,EAAAzB,EAAAU,GAAA,IAAAgB,EAAA1B,EAAA2B,UAAAD,EAEDE,mBAAA,SAAAA,EAAmBN,GAClB,MAAMO,EAAWb,KAAKc,YAAY,mBAElC,GAAId,KAAKI,YAAeJ,KAAKK,aAAeL,KAAKe,uBAAyBf,KAAKgB,qBAAqBC,UAAY,CAC/GjB,KAAKI,UAAY,MACjBJ,KAAKkB,cAAgBZ,EACrBN,KAAKe,qBAAuBf,KAAKgB,qBAAqBC,SACvD,CACAvB,EAAAiB,UAAMQ,YAAWpB,KAAAC,KAAC,kBAAmBM,EAAiB,MACtDN,KAAKoB,UAAU,eAAgB,CAC9BC,MAAOf,EACPO,SAAUA,EACVT,UAAWE,IAAoBN,KAAKkB,cACpCI,QAAStB,KAAKgB,qBAEhB,EAAC,OAAAhC,CAAA,CAlCO,CAJgCuC,GAAUrB,EAAAsB,EAAA/B,EAAAkB,UAAA,mBAAAxB,GAAA,CAAAsC,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAAzB,EAAAqB,EAAA/B,EAAAkB,UAAA,gBAAArB,GAAA,CAAAmC,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAAnC,KAAAD,GAAAgB,EAAAxB,EAAA,OAAAwB,CAAA","ignoreList":[]}