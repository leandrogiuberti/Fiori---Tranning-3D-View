/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/core/CommonUtils","sap/fe/core/controls/DataWatcher","sap/fe/core/formatters/CollaborationFormatter","sap/fe/core/formatters/CriticalityFormatter","sap/fe/core/formatters/FPMFormatter","sap/fe/core/formatters/KPIFormatter","sap/fe/core/formatters/StandardFormatter","sap/fe/core/formatters/ValueFormatter","sap/ui/base/Object","sap/ui/core/Component","sap/ui/model/json/JSONModel"],function(e,t,r,n,o,i,a,l,s,c,u,p,d,f){"use strict";var g,m,v,b,w,h,y,_,x,P,C;var F=r.property;var A=r.defineUI5Class;var I=t.pathInModel;var D=t.compileExpression;function M(e,t,r,n){r&&Object.defineProperty(e,t,{enumerable:r.enumerable,configurable:r.configurable,writable:r.writable,value:r.initializer?r.initializer.call(n):void 0})}function B(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,O(e,t)}function O(e,t){return O=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},O(e,t)}function z(e,t,r,n,o){var i={};return Object.keys(n).forEach(function(e){i[e]=n[e]}),i.enumerable=!!i.enumerable,i.configurable=!!i.configurable,("value"in i||i.initializer)&&(i.writable=!0),i=r.slice().reverse().reduce(function(r,n){return n(e,t,r)||r},i),o&&void 0!==i.initializer&&(i.value=i.initializer?i.initializer.call(o):void 0,i.initializer=void 0),void 0===i.initializer?(Object.defineProperty(e,t,i),null):i}function S(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let E=(g=A("sap.fe.core.ExtensionAPI"),m=F({type:"sap.fe.core.controllerextensions.EditFlow"}),v=F({type:"sap.fe.core.controllerextensions.Routing"}),b=F({type:"sap.fe.core.controllerextensions.IntentBasedNavigation"}),w=F({type:"sap.fe.core.controllerextensions.CollaborativeDraft"}),g(h=(y=function(t){function r(e,r){var n;n=t.call(this)||this;M(n,"editFlow",_,n);M(n,"routing",x,n);M(n,"intentBasedNavigation",P,n);M(n,"collaborativeDraft",C,n);n._formatters={ValueFormatter:u,StandardFormatter:c,CriticalityFormatter:a,FPMFormatter:l,KPIFormatter:s,CollaborationFormatter:i};n._controller=e;n._view=e.getView();n.extension=n._controller.extension;n.editFlow=n._controller.editFlow;n.routing=n._controller.routing;n.intentBasedNavigation=n._controller.intentBasedNavigation;n.collaborativeDraft=n._controller.collaborativeDraft;n._routing=n._controller._routing;n._intentBasedNavigation=n._controller._intentBasedNavigation;n._prefix=r;return n}B(r,t);var p=r.prototype;p.getEditFlow=function e(){return this.editFlow};p.getRouting=function e(){return this.routing};p.getIntentBasedNavigation=function e(){return this.intentBasedNavigation};p.byId=function e(t){let r=this._view.byId(t);if(!r&&this._prefix){r=this._view.byId(`${this._prefix}--${t}`)}if(!r){return undefined}if(!r.isA("sap.fe.macros.MacroAPI")){let e=r.getParent();while(e){if(e.isA("sap.fe.macros.form.FormAPI")){break}if(e.isA("sap.fe.macros.MacroAPI")){throw new Error(`You attempted to access an internal control. This is risky and might change later. Instead access its stable API by using ID ${e.getId()}`)}e=e.getParent()}}return r};p.getModel=function e(t){let r;if(t&&t!=="ui"){r=n.getAppComponent(this._view);if(!r.getManifestEntry("sap.ui5").models[t]){return undefined}}return this._view.getModel(t)};p.addDependent=function e(t){this._view.addDependent(t)};p.removeDependent=function e(t){this._view.removeDependent(t)};p.navigateToTarget=function e(t,r){this._controller._routing.navigateToTarget(r,t)};p.loadFragment=async function t(r){var o=this;const i=d.getOwnerComponentFor(this._view);await i.getService("templatedViewService");const a=this._view.getModel("_pageModel");const l=this._view.getModel("sap.fe.i18n");const s=i.getMetaModel();const c=i.getViewData();const u=i.getEntitySet()?`/${i.getEntitySet()}`:i.getContextPath();const p=new f(c),g={bindingContexts:{contextPath:s?.createBindingContext(r.contextPath||u),converterContext:a.createBindingContext("/",undefined,{noResolve:true}),viewData:c?p.createBindingContext("/"):null},models:{contextPath:s,converterContext:a,metaModel:s,viewData:p,"sap.fe.i18n":l},appComponent:n.getAppComponent(this._view)};let m;if(r.controller&&!r.controller?.isA?.("sap.fe.core.ExtensionAPI")){const e=this.getMetadata().getClass().extend(r.id+"-controller",{});for(const t in r.controller){const n=r.controller[t];if(n?.bind){const a=n.bind(r.controller);if(i){e.prototype[t]=function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++){t[r]=arguments[r]}return i.runAsOwner(()=>a.apply(o,t))}}else{e.prototype[t]=a}}else{Object.defineProperty(e.prototype,t,{get(){return r.controller?.[t]},set(e){if(r.controller){r.controller[t]=e}}})}}m=new e(this._controller);const t=m.isA;m.isA=e=>t.bind(m)(e)||this.isA(e)}else{m=r.controller??this}return i.runAsOwner(async()=>{const t=n.templateControlFragment(r.name,g,{controller:m,isXML:false,id:r.id,containingView:this._view,contextPath:r.contextPath??u});try{const e=await t;if(r.initialBindingContext!==undefined){e.setBindingContext(r.initialBindingContext)}this.addDependent(e);return e}catch(t){e.error(t)}})};p.updateAppState=async function e(){const t=this._controller.getView();const r=this._controller.getAppComponent();const n=await r.getAppStateHandler().createAppState({viewId:t.getId()});return n?.appStateData};p.runWithFPMContext=function e(t){const r=d.getOwnerComponentFor(this._view);return r.runAsOwner(t)};p.watchProperty=function e(t,r){this._view.addDependent(new o({propertyBinding:D(I(t)),valueChanged:e=>{r(e.getParameter("value"),e.getParameter("oldValue"),e.getParameter("isInitial"),e.getParameter("context"))}}))};return r}(p),_=z(y.prototype,"editFlow",[m],{configurable:true,enumerable:true,writable:true,initializer:null}),x=z(y.prototype,"routing",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),P=z(y.prototype,"intentBasedNavigation",[b],{configurable:true,enumerable:true,writable:true,initializer:null}),C=z(y.prototype,"collaborativeDraft",[w],{configurable:true,enumerable:true,writable:true,initializer:null}),y))||h);return E},false);
//# sourceMappingURL=ExtensionAPI.js.map