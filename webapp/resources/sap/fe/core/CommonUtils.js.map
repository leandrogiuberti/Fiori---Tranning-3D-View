{"version":3,"file":"CommonUtils.js","names":["normalizeSearchTerm","sSearchTerm","undefined","convertedSearchTerm","replace","async","waitForContextRequested","bindingContext","model","getModel","metaModel","getMetaModel","entityPath","getMetaPath","getPath","dataModel","MetaModelConverter","getInvolvedDataModelObjects","getContext","requestProperty","targetEntityType","keys","name","fnHasTransientContexts","oListBinding","bHasTransientContexts","getCurrentContexts","forEach","oContext","isTransient","_getSOIntents","oShellServiceHelper","oObjectPageLayout","oSemanticObject","oParam","getLinks","semanticObject","params","_createMappings","oMapping","aSOMappings","aMappingKeys","Object","oSemanticMapping","element","LocalProperty","$PropertyPath","SemanticObjectProperty","push","_getRelatedAppsMenuItems","linkGroup","aExcludedActions","oTargetParams","aItems","aAllowedActions","links","oLink","sIntent","intent","sAction","split","includes","text","targetSemObject","targetAction","targetParams","_getRelatedIntents","oAdditionalSemanticObjects","oBindingContext","aManifestSOItems","aLinks","length","allowedActions","unavailableActions","mapping","navigationContexts","semanticObjectMapping","_getRelatedIntentsWithSemanticObjectsAndAction","semanticObjectAndAction","appComponentSOItems","actions","action","excludedActions","soMappings","updateRelateAppsModel","oEntry","aSemKeys","oMetaModel","oMetaPath","appComponent","getShellServices","sCurrentSemObj","sCurrentAction","oSemanticObjectAnnotations","aRelatedAppsMenuItems","aManifestSOKeys","fnGetParseShellHashAndGetLinks","oParsedUrl","parseShellHash","document","location","hash","sSemKey","value","aTechnicalKeys","getObject","key","sObjKey","oManifestData","getTargetView","getViewData","semanticObjectIntents","additionalSemanticObjects","Promise","resolve","componentData","getComponentData","feEnvironment","getIntent","internalModelContext","getBindingContext","isSemanticObjectHasSameTargetInManifest","aAnnotationsSOItems","sEntitySetPath","sEntityTypePath","oEntitySetAnnotations","CommonUtils","getSemanticObjectAnnotations","bHasEntitySetSO","oEntityTypeAnnotations","aUnavailableActions","aMappings","_ref","soItems","concat","setProperty","error","Log","_getSemanticObjectAnnotations","oEntityAnnotations","sAnnotationMappingTerm","sAnnotationActionTerm","sQualifier","fnUpdateRelatedAppsDetails","path","sSemanticKeyVocabulary","requestObject","then","requestedObject","catch","oError","fnFireButtonPress","oButton","isA","getVisible","getEnabled","firePress","getAppComponent","oControl","oOwner","Component","getOwnerComponentFor","Error","getCurrentPageView","oAppComponent","rootViewController","getRootViewController","isFclEnabled","getRightmostView","getRootContainer","getCurrentPage","oComponent","getComponentInstance","getRootControl","getParent","_fnCheckIsMatch","oObject","oKeysToCheck","sKey","fnGetContextPathProperties","metaModelContext","sContextPath","oFilter","oEntityType","oProperties","hasOwnProperty","test","$kind","fnGetIBNActions","aIBNActions","aActions","getActions","oAction","getAction","oMenu","getMenu","getItems","oItem","data","fnUpdateDataFieldForIBNButtonsVisibility","oView","oParams","isSticky","ModelHelper","isStickySessionSupported","fnGetLinks","oData","aKeys","indexOf","oIBNAction","sSemanticObject","aLink","setVisible","getId","shellNavigationNotAvailable","updateMenuButtonVisiblity","IBNActions","menuButtonWithIBNAction","IBNAction","menuAction","menuItems","visibleMenuItems","filter","menuItem","getActionPath","actionContext","bReturnOnlyPath","inActionName","bCheckStaticValue","sActionName","toString","sEntityTypeName","$Type","sEntityName","getEntitySetName","sProperty","sBindingParameter","sEntityType","oEntityContainer","computeDisplayMode","oPropertyAnnotations","oCollectionAnnotations","oTextAnnotation","oTextArrangementAnnotation","$EnumMember","_getEntityType","_requestObject","oSelectedContext","nBracketIndex","sTargetType","slice","sCurrentType","getBinding","warning","sDynamicActionEnabledPath","oPromise","requestSingletonProperty","vPropertyValue","setContextsBasedOnOperationAvailable","oInternalModelContext","aRequestPromises","forContextMenu","arguments","all","aResults","aApplicableContexts","aNotApplicableContexts","aResult","setDynamicActionContexts","trace","applicable","notApplicable","dynamicActionPathPrefix","internalModel","applicableProperty","notApplicableProperty","getSpecificAllowedExpression","aExpressions","aAllowedExpressionsPriority","AllowedExpressionsPrio","sort","a","b","getOperatorsForGuidProperty","allowedOperatorsForGuid","getParameterInfo","sParameterContextPath","substring","lastIndexOf","bResultContext","oParameterInfo","contextPath","parameterProperties","getContextPathProperties","addPageContextToSelectionVariant","oSelectionVariant","mPageContext","oNavigationService","getNavigationService","mixAttributesAndSelectionVariant","toJSONString","isStickyEditMode","bIsStickyMode","bUIEditable","getIsEditable","setUserDefaults","parameters","isAction","isCreate","actionDefaultValues","BaseType","__ui5_require_async","default","TypeMap","startupParameters","shellServices","startupAppState","getStartupAppState","startupAppStateData","getData","extendedParameters","selectionVariant","SelectOptions","oParameter","sPropertyName","sParameterName","parametertType","type","getBaseType","String","typeInstance","getDataTypeInstance","parseValue","oExtendedParameter","PropertyName","oRange","Ranges","Sign","Option","Low","getAdditionalParamsForCreate","oStartupParameters","oInboundParameters","oInbounds","aCreateParameters","sParameter","useForCreate","oRet","sCreateParameter","aValues","create","getSemanticObjectMapping","oOutbound","aSemanticObjectMapping","aParameters","sParam","format","getHeaderFacetItemConfigForExternalNavigation","oViewData","oCrossNav","oHeaderFacetItems","sId","oControlConfig","controlConfiguration","config","sOutbound","navigation","targetOutbound","outbound","generate","setSemanticObjectMappings","vMappings","oMappings","JSON","parse","sLocalProperty","sSemanticObjectProperty","oSelectOption","getSelectOption","removeSelectOption","massAddSelectOption","fnGetSemanticObjectsFromPath","sPath","aSemanticObjectUnavailableActions","aSemanticObjectForGetLinks","semanticObjectPath","semanticObjectForGetLinks","fnGetSemanticObjectPromise","getSemanticObjectsFromPath","getFilterAllowedExpression","oFilterRestrictionsAnnotation","mAllowedExpressions","FilterExpressionRestrictions","oProperty","Property","AllowedExpressions","getFilterRestrictions","sRestriction","aProps","map","_fetchPropertiesForNavPath","paths","navPath","props","navPathPrefix","reduce","outPaths","pathToCheck","startsWith","outPath","getFilterRestrictionsByPath","RequiredProperties","NonFilterableProperties","FilterAllowedExpressions","oFilterRestrictions","navigationText","frTerm","entityTypePathParts","replaceAll","filterOutNavPropBinding","entityTypePath","join","entitySetPath","getEntitySetPath","entitySetPathParts","isContainment","containmentNavPath","resultContextCheck","parentEntitySetPath","oParentRet","oParentFR","completeAllowedExps","outProp","propPath","outPropPath","mergeObjects","oNavRestrictions","MetaModelFunction","getNavigationRestrictions","oNavFilterRest","navResReqProps","uniqueSort","navNonFilterProps","navAssociationEntityRest","navAssocReqProps","navAssocNonFilterProps","templateControlFragment","sFragmentName","oPreprocessorSettings","oInOptions","oModifier","oOptions","view","oFragment","targets","fragmentData","XMLTemplateProcessor","loadTemplate","XMLPreprocessor","process","firstElementChild","isXML","owner","runAsOwner","fn","containingView","viewOwner","controller","Fragment","load","id","definition","getSingletonPath","parts","Boolean","propertyName","pop","navigationPath","entitySet","singletonName","resolvedPath","propertyBinding","bindProperty","requestValue","getParameterPath","sContext","aAction","_fntranslatedTextFromExpBindingString","expBinding","control","anyResourceText","AnyElement","anyText","addDependent","resultText","getAnyText","removeDependent","destroy","isSmallDevice","Device","system","desktop","resize","width","getFiltersFromAnnotation","annotationPath","svContext","getMetaContext","propertyFilters","annotation","targetObject","isAnnotationOfType","SelectionVariant","selectOption","$target","propertyType","propertyPath","j","range","getRangeDefinition","Filter","operator","rangeLow","rangeHigh","filters","and","getConverterContextForPath","sMetaPath","sEntitySet","oDiagnostics","createBindingContext","ConverterContext","createConverterContextForMacro","createRootContext","programmingModel","bindingParameters","result","findOrCreateRootContext","isNew","rootContext","context","useCache","rootContextPath","getDraftRootPath","getStickyRootPath","simpleRootContext","existingBindingContextOnPage","getInstancedViews","find","pageView","getProperty","createNewRootContext","messagesPath","getMessagesPath","newBindingParameters","$select","newSelect","bindContext","getBoundContext","source","managedObject","getView","INLINEEDIT_UPDATEGROUPID","fireButtonPress","hasTransientContext","updateRelatedAppsDetails","updateDataFieldForIBNButtonsVisibility","getIBNActions","getSemanticObjectPromise","FilterRestrictions","REQUIRED_PROPERTIES","NON_FILTERABLE_PROPERTIES","ALLOWED_EXPRESSIONS","getRelatedAppsMenuItems","getTranslatedTextFromExpBindingString"],"sources":["./CommonUtils.ts"],"sourcesContent":["import type { ActionParameter as EdmActionParameter } from \"@sap-ux/vocabularies-types\";\nimport type * as Edm from \"@sap-ux/vocabularies-types/Edm\";\nimport type { FilterRestrictionsType } from \"@sap-ux/vocabularies-types/vocabularies/Capabilities\";\nimport type {\n\tSemanticObjectMappingAbstractTypes,\n\tSemanticObjectMappingTypeTypes,\n\tSemanticObjectUnavailableActions\n} from \"@sap-ux/vocabularies-types/vocabularies/Common\";\nimport { CommonAnnotationTerms } from \"@sap-ux/vocabularies-types/vocabularies/Common\";\nimport type { SelectionPresentationVariant, SelectionVariantType, TextArrangement } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport { UIAnnotationTypes } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport Log from \"sap/base/Log\";\nimport uniqueSort from \"sap/base/util/array/uniqueSort\";\nimport mergeObjects from \"sap/base/util/merge\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type { ComponentData } from \"sap/fe/core/AppComponent\";\nimport type { FEView } from \"sap/fe/core/BaseController\";\nimport type ExtensionAPI from \"sap/fe/core/ExtensionAPI\";\nimport type PageController from \"sap/fe/core/PageController\";\nimport ConverterContext from \"sap/fe/core/converters/ConverterContext\";\nimport * as MetaModelConverter from \"sap/fe/core/converters/MetaModelConverter\";\nimport type { PageContextPathTarget } from \"sap/fe/core/converters/TemplateConverter\";\nimport type { InternalModelContext } from \"sap/fe/core/helpers/ModelHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport { isAnnotationOfType } from \"sap/fe/core/helpers/TypeGuards\";\nimport type { IShellServices } from \"sap/fe/core/services/ShellServicesFactory\";\nimport type Diagnostics from \"sap/fe/core/support/Diagnostics\";\nimport type SelectionVariant from \"sap/fe/navigation/SelectionVariant\";\nimport type Button from \"sap/m/Button\";\nimport type MenuButton from \"sap/m/MenuButton\";\nimport type MenuItem from \"sap/m/MenuItem\";\nimport type NavContainer from \"sap/m/NavContainer\";\nimport type OverflowToolbarButton from \"sap/m/OverflowToolbarButton\";\nimport Device from \"sap/ui/Device\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport Component from \"sap/ui/core/Component\";\nimport type ComponentContainer from \"sap/ui/core/ComponentContainer\";\nimport type Control from \"sap/ui/core/Control\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport Fragment from \"sap/ui/core/Fragment\";\nimport XMLTemplateProcessor from \"sap/ui/core/XMLTemplateProcessor\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport XMLPreprocessor from \"sap/ui/core/util/XMLPreprocessor\";\nimport type { default as MDCChart } from \"sap/ui/mdc/Chart\";\nimport type Table from \"sap/ui/mdc/Table\";\nimport type ActionToolbarAction from \"sap/ui/mdc/actiontoolbar/ActionToolbarAction\";\nimport type MDCTable from \"sap/ui/mdc/valuehelp/content/MDCTable\";\nimport type Context from \"sap/ui/model/Context\";\nimport Filter from \"sap/ui/model/Filter\";\nimport type FilterOperator from \"sap/ui/model/FilterOperator\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataV4Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport type { Link } from \"sap/ushell/services/Navigation\";\nimport type ObjectPageDynamicHeaderTitle from \"sap/uxap/ObjectPageDynamicHeaderTitle\";\nimport type ObjectPageLayout from \"sap/uxap/ObjectPageLayout\";\nimport type ObjectPageSubSection from \"sap/uxap/ObjectPageSubSection\";\nimport type {\n\tExpandPathType,\n\tMetaModelEntityType,\n\tMetaModelEnum,\n\tMetaModelNavProperty,\n\tMetaModelProperty,\n\tMetaModelType\n} from \"types/metamodel_types\";\nimport type { BindContextParameters } from \"./controllerextensions/editFlow/draft\";\nimport AnyElement from \"./controls/AnyElement\";\nimport { getRangeDefinition } from \"./converters/helpers/SelectionVariantHelper\";\nimport * as MetaModelFunction from \"./helpers/MetaModelFunction\";\n\ntype MyInboxIntent = {\n\tsemanticObject: string;\n\taction: string;\n};\n\nfunction normalizeSearchTerm(sSearchTerm: string | undefined): string | undefined {\n\tif (!sSearchTerm) {\n\t\treturn undefined;\n\t}\n\n\t// checking for search term \"OR\" is to allow the SD specific search for SaleOrderType=OR (OR is a hana keyword)\n\tif (sSearchTerm === \"OR\") {\n\t\treturn '\"' + sSearchTerm + '\"';\n\t}\n\n\tconst convertedSearchTerm = sSearchTerm.replace(/[\"();]/g, \" \"); // these are the specific characters that fail on both, CAP and RAP: \"();\n\tif (convertedSearchTerm === \"\" || convertedSearchTerm === \" \") {\n\t\treturn undefined;\n\t}\n\treturn convertedSearchTerm;\n}\n\nasync function waitForContextRequested(bindingContext: ODataV4Context): Promise<void> {\n\tconst model = bindingContext.getModel();\n\tconst metaModel = model.getMetaModel();\n\tconst entityPath = metaModel.getMetaPath(bindingContext.getPath());\n\tconst dataModel = MetaModelConverter.getInvolvedDataModelObjects(metaModel.getContext(entityPath));\n\tawait bindingContext.requestProperty(dataModel.targetEntityType.keys[0]?.name);\n}\n\nfunction fnHasTransientContexts(oListBinding: ODataListBinding): boolean {\n\tlet bHasTransientContexts = false;\n\tif (oListBinding) {\n\t\toListBinding.getCurrentContexts().forEach(function (oContext: ODataV4Context) {\n\t\t\tif (oContext && oContext.isTransient()) {\n\t\t\t\tbHasTransientContexts = true;\n\t\t\t}\n\t\t});\n\t}\n\treturn bHasTransientContexts;\n}\n\n// there is no navigation in entitySet path and property path\n\nasync function _getSOIntents(\n\toShellServiceHelper: IShellServices,\n\toObjectPageLayout: ObjectPageLayout,\n\toSemanticObject: string | undefined,\n\toParam: object | undefined\n): Promise<Link[][]> {\n\treturn oShellServiceHelper.getLinks([\n\t\t{\n\t\t\tsemanticObject: oSemanticObject,\n\t\t\tparams: oParam\n\t\t}\n\t]);\n}\n\ntype SOMapping = { LocalProperty: { $PropertyPath: string }; SemanticObjectProperty: unknown };\n// TO-DO add this as part of applySemanticObjectmappings logic in IntentBasednavigation controller extension\nfunction _createMappings(oMapping: Record<string, unknown>): SOMapping[] {\n\tconst aSOMappings: SOMapping[] = [];\n\tconst aMappingKeys = Object.keys(oMapping);\n\tlet oSemanticMapping: SOMapping;\n\tfor (const element of aMappingKeys) {\n\t\toSemanticMapping = {\n\t\t\tLocalProperty: {\n\t\t\t\t$PropertyPath: element\n\t\t\t},\n\t\t\tSemanticObjectProperty: oMapping[element]\n\t\t};\n\t\taSOMappings.push(oSemanticMapping);\n\t}\n\n\treturn aSOMappings;\n}\ntype SemanticItem = {\n\ttext: string;\n\ttargetSemObject: string;\n\ttargetAction: string;\n\ttargetParams: unknown;\n};\n/**\n * @param linkGroup\n * @param aExcludedActions\n * @param oTargetParams\n * @param aItems\n * @param aAllowedActions\n */\nfunction _getRelatedAppsMenuItems(\n\tlinkGroup: Link[][],\n\taExcludedActions: unknown[],\n\toTargetParams: unknown,\n\taItems: SemanticItem[],\n\taAllowedActions?: unknown[]\n): void {\n\tfor (const links of linkGroup) {\n\t\tfor (const oLink of links) {\n\t\t\tconst sIntent = oLink.intent;\n\t\t\tconst sAction = sIntent.split(\"-\")[1].split(\"?\")[0];\n\t\t\tif (\n\t\t\t\t(aAllowedActions && aAllowedActions.includes(sAction)) ||\n\t\t\t\t(!aAllowedActions && aExcludedActions && !aExcludedActions.includes(sAction))\n\t\t\t) {\n\t\t\t\taItems.push({\n\t\t\t\t\ttext: oLink.text,\n\t\t\t\t\ttargetSemObject: sIntent.split(\"#\")[1].split(\"-\")[0],\n\t\t\t\t\ttargetAction: sAction.split(\"~\")[0],\n\t\t\t\t\ttargetParams: oTargetParams\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport type SemanticObject = {\n\tallowedActions?: unknown[];\n\tunavailableActions?: unknown[];\n\tsemanticObject: string;\n\tpath: string;\n\tmapping?: Record<string, string>;\n};\n\nfunction _getRelatedIntents(\n\toAdditionalSemanticObjects: SemanticObject,\n\toBindingContext: Context,\n\taManifestSOItems: SemanticItem[],\n\taLinks: Link[][]\n): void {\n\tif (aLinks && aLinks.length > 0) {\n\t\tconst aAllowedActions = oAdditionalSemanticObjects.allowedActions || undefined;\n\t\tconst aExcludedActions = oAdditionalSemanticObjects.unavailableActions ? oAdditionalSemanticObjects.unavailableActions : [];\n\t\tconst aSOMappings = oAdditionalSemanticObjects.mapping ? _createMappings(oAdditionalSemanticObjects.mapping) : [];\n\t\tconst oTargetParams = { navigationContexts: oBindingContext, semanticObjectMapping: aSOMappings };\n\t\t_getRelatedAppsMenuItems(aLinks, aExcludedActions, oTargetParams, aManifestSOItems, aAllowedActions);\n\t}\n}\n\n/**\n * This function fetches the related intents when semantic object and action are passed from feEnvironment.getIntent() only in case of My Inbox integration.\n * @param semanticObjectAndAction This specifies the semantic object and action for fetching the intents\n * @param oBindingContext This sepcifies the binding context for updating related apps\n * @param appComponentSOItems This is a list of semantic items used for updating the related apps button\n * @param aLinks This is an array comprising of related intents\n */\n\nfunction _getRelatedIntentsWithSemanticObjectsAndAction(\n\tsemanticObjectAndAction: MyInboxIntent,\n\toBindingContext: Context,\n\tappComponentSOItems: SemanticItem[],\n\taLinks: Link[][]\n): void {\n\tif (aLinks.length > 0) {\n\t\tconst actions = [semanticObjectAndAction.action];\n\t\tconst excludedActions: [] = [];\n\t\tconst soMappings: [] = [];\n\t\tconst targetParams = { navigationContexts: oBindingContext, semanticObjectMapping: soMappings };\n\t\t_getRelatedAppsMenuItems(aLinks, excludedActions, targetParams, appComponentSOItems, actions);\n\t}\n}\n\ntype SemanticObjectConfig = {\n\tadditionalSemanticObjects: Record<string, SemanticObject>;\n};\ntype RelatedAppsConfig = {\n\ttext: string;\n\ttargetSemObject: string;\n\ttargetAction: string;\n};\nasync function updateRelateAppsModel(\n\toBindingContext: Context,\n\toEntry: Record<string, unknown> | undefined,\n\toObjectPageLayout: ObjectPageLayout,\n\taSemKeys: { $PropertyPath: string }[],\n\toMetaModel: ODataMetaModel,\n\toMetaPath: string,\n\tappComponent: AppComponent\n): Promise<RelatedAppsConfig[]> {\n\tconst oShellServiceHelper: IShellServices = appComponent.getShellServices();\n\tconst oParam: Record<string, unknown> = {};\n\tlet sCurrentSemObj = \"\",\n\t\tsCurrentAction = \"\";\n\tlet oSemanticObjectAnnotations;\n\tlet aRelatedAppsMenuItems: RelatedAppsConfig[] = [];\n\tlet aExcludedActions: unknown[] = [];\n\tlet aManifestSOKeys: string[];\n\n\tasync function fnGetParseShellHashAndGetLinks(): Promise<Link[][]> {\n\t\tconst oParsedUrl = oShellServiceHelper.parseShellHash(document.location.hash);\n\t\tsCurrentSemObj = oParsedUrl.semanticObject; // Current Semantic Object\n\t\tsCurrentAction = oParsedUrl.action;\n\t\treturn _getSOIntents(oShellServiceHelper, oObjectPageLayout, sCurrentSemObj, oParam);\n\t}\n\n\ttry {\n\t\tif (oEntry) {\n\t\t\tif (aSemKeys && aSemKeys.length > 0) {\n\t\t\t\tfor (const element of aSemKeys) {\n\t\t\t\t\tconst sSemKey = element.$PropertyPath;\n\t\t\t\t\tif (!oParam[sSemKey]) {\n\t\t\t\t\t\toParam[sSemKey] = { value: oEntry[sSemKey] };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// fallback to Technical Keys if no Semantic Key is present\n\t\t\t\tconst aTechnicalKeys = oMetaModel.getObject(`${oMetaPath}/$Type/$Key`);\n\t\t\t\tfor (const key in aTechnicalKeys) {\n\t\t\t\t\tconst sObjKey = aTechnicalKeys[key];\n\t\t\t\t\tif (!oParam[sObjKey]) {\n\t\t\t\t\t\toParam[sObjKey] = { value: oEntry[sObjKey] };\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Logic to read additional SO from manifest and updated relatedapps model\n\n\t\tconst oManifestData = getTargetView(oObjectPageLayout).getViewData() as SemanticObjectConfig;\n\t\tconst aManifestSOItems: SemanticItem[] = [];\n\t\tlet semanticObjectIntents;\n\t\tif (oManifestData.additionalSemanticObjects) {\n\t\t\taManifestSOKeys = Object.keys(oManifestData.additionalSemanticObjects);\n\t\t\tfor (const element of aManifestSOKeys) {\n\t\t\t\tsemanticObjectIntents = await Promise.resolve(_getSOIntents(oShellServiceHelper, oObjectPageLayout, element, oParam));\n\t\t\t\t_getRelatedIntents(\n\t\t\t\t\toManifestData.additionalSemanticObjects[element],\n\t\t\t\t\toBindingContext,\n\t\t\t\t\taManifestSOItems,\n\t\t\t\t\tsemanticObjectIntents\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\t// appComponentSOItems is updated in case of My Inbox integration when semantic object and action are passed from feEnvironment.getIntent() method\n\t\t// In other cases it remains as an empty list\n\t\t// We concat this list towards the end with aManifestSOItems\n\n\t\tconst appComponentSOItems: SemanticItem[] = [];\n\t\tconst componentData: ComponentData = appComponent.getComponentData();\n\t\tif (componentData.feEnvironment && componentData.feEnvironment.getIntent()) {\n\t\t\tconst intent: MyInboxIntent = componentData.feEnvironment.getIntent();\n\t\t\tsemanticObjectIntents = await Promise.resolve(\n\t\t\t\t_getSOIntents(oShellServiceHelper, oObjectPageLayout, intent.semanticObject, oParam)\n\t\t\t);\n\t\t\t_getRelatedIntentsWithSemanticObjectsAndAction(intent, oBindingContext, appComponentSOItems, semanticObjectIntents);\n\t\t}\n\n\t\tconst internalModelContext = oObjectPageLayout.getBindingContext(\"internal\") as InternalModelContext;\n\t\tconst aLinks = await fnGetParseShellHashAndGetLinks();\n\t\tif (aLinks) {\n\t\t\tif (aLinks.length > 0) {\n\t\t\t\tlet isSemanticObjectHasSameTargetInManifest = false;\n\t\t\t\tconst oTargetParams: {\n\t\t\t\t\tnavigationContexts?: Context;\n\t\t\t\t\tsemanticObjectMapping?: MetaModelType<SemanticObjectMappingAbstractTypes>[];\n\t\t\t\t} = {};\n\t\t\t\tconst aAnnotationsSOItems: SemanticItem[] = [];\n\t\t\t\tconst sEntitySetPath = `${oMetaPath}@`;\n\t\t\t\tconst sEntityTypePath = `${oMetaPath}/@`;\n\t\t\t\tconst oEntitySetAnnotations = oMetaModel.getObject(sEntitySetPath);\n\t\t\t\toSemanticObjectAnnotations = CommonUtils.getSemanticObjectAnnotations(oEntitySetAnnotations, sCurrentSemObj);\n\t\t\t\tif (!oSemanticObjectAnnotations.bHasEntitySetSO) {\n\t\t\t\t\tconst oEntityTypeAnnotations = oMetaModel.getObject(sEntityTypePath);\n\t\t\t\t\toSemanticObjectAnnotations = CommonUtils.getSemanticObjectAnnotations(oEntityTypeAnnotations, sCurrentSemObj);\n\t\t\t\t}\n\t\t\t\taExcludedActions = oSemanticObjectAnnotations.aUnavailableActions;\n\t\t\t\t//Skip same application from Related Apps\n\t\t\t\taExcludedActions.push(sCurrentAction);\n\t\t\t\toTargetParams.navigationContexts = oBindingContext;\n\t\t\t\toTargetParams.semanticObjectMapping = oSemanticObjectAnnotations.aMappings;\n\t\t\t\t_getRelatedAppsMenuItems(aLinks, aExcludedActions, oTargetParams, aAnnotationsSOItems);\n\n\t\t\t\taManifestSOItems.forEach(function ({ targetSemObject }) {\n\t\t\t\t\tif (aAnnotationsSOItems[0]?.targetSemObject === targetSemObject) {\n\t\t\t\t\t\tisSemanticObjectHasSameTargetInManifest = true;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// remove all actions from current hash application if manifest contains empty allowedActions\n\t\t\t\tif (\n\t\t\t\t\toManifestData.additionalSemanticObjects &&\n\t\t\t\t\taAnnotationsSOItems[0] &&\n\t\t\t\t\toManifestData.additionalSemanticObjects[aAnnotationsSOItems[0].targetSemObject] &&\n\t\t\t\t\t!!oManifestData.additionalSemanticObjects[aAnnotationsSOItems[0].targetSemObject].allowedActions\n\t\t\t\t) {\n\t\t\t\t\tisSemanticObjectHasSameTargetInManifest = true;\n\t\t\t\t}\n\t\t\t\tconst soItems = aManifestSOItems.concat(appComponentSOItems);\n\t\t\t\taRelatedAppsMenuItems = isSemanticObjectHasSameTargetInManifest ? soItems : soItems.concat(aAnnotationsSOItems);\n\t\t\t\t// If no app in list, related apps button will be hidden\n\t\t\t\tinternalModelContext.setProperty(\"relatedApps/visibility\", aRelatedAppsMenuItems.length > 0);\n\t\t\t\tinternalModelContext.setProperty(\"relatedApps/items\", aRelatedAppsMenuItems);\n\t\t\t} else {\n\t\t\t\tinternalModelContext.setProperty(\"relatedApps/visibility\", false);\n\t\t\t}\n\t\t} else {\n\t\t\tinternalModelContext.setProperty(\"relatedApps/visibility\", false);\n\t\t}\n\t} catch (error: unknown) {\n\t\tLog.error(\"Cannot read links\", error as string);\n\t}\n\treturn aRelatedAppsMenuItems;\n}\n\nfunction _getSemanticObjectAnnotations(\n\toEntityAnnotations: Record<string, unknown>,\n\tsCurrentSemObj: string\n): {\n\tbHasEntitySetSO: boolean;\n\taAllowedActions: string[];\n\taUnavailableActions: MetaModelType<SemanticObjectUnavailableActions>[];\n\taMappings: MetaModelType<SemanticObjectMappingAbstractTypes>[];\n} {\n\tconst oSemanticObjectAnnotations = {\n\t\tbHasEntitySetSO: false,\n\t\taAllowedActions: [],\n\t\taUnavailableActions: [] as MetaModelType<SemanticObjectUnavailableActions>[],\n\t\taMappings: [] as MetaModelType<SemanticObjectMappingAbstractTypes>[]\n\t};\n\tlet sAnnotationMappingTerm, sAnnotationActionTerm;\n\tlet sQualifier;\n\tfor (const key in oEntityAnnotations) {\n\t\tif (key.includes(CommonAnnotationTerms.SemanticObject) && oEntityAnnotations[key] === sCurrentSemObj) {\n\t\t\toSemanticObjectAnnotations.bHasEntitySetSO = true;\n\t\t\tsAnnotationMappingTerm = `@${CommonAnnotationTerms.SemanticObjectMapping}`;\n\t\t\tsAnnotationActionTerm = `@${CommonAnnotationTerms.SemanticObjectUnavailableActions}`;\n\n\t\t\tif (key.includes(\"#\")) {\n\t\t\t\tsQualifier = key.split(\"#\")[1];\n\t\t\t\tsAnnotationMappingTerm = `${sAnnotationMappingTerm}#${sQualifier}`;\n\t\t\t\tsAnnotationActionTerm = `${sAnnotationActionTerm}#${sQualifier}`;\n\t\t\t}\n\t\t\tif (oEntityAnnotations[sAnnotationMappingTerm]) {\n\t\t\t\toSemanticObjectAnnotations.aMappings = oSemanticObjectAnnotations.aMappings.concat(\n\t\t\t\t\toEntityAnnotations[sAnnotationMappingTerm] as MetaModelType<SemanticObjectMappingAbstractTypes>\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif (oEntityAnnotations[sAnnotationActionTerm]) {\n\t\t\t\toSemanticObjectAnnotations.aUnavailableActions = oSemanticObjectAnnotations.aUnavailableActions.concat(\n\t\t\t\t\toEntityAnnotations[sAnnotationActionTerm] as MetaModelType<SemanticObjectUnavailableActions>\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn oSemanticObjectAnnotations;\n}\n\nasync function fnUpdateRelatedAppsDetails(oObjectPageLayout: ObjectPageLayout, appComponent: AppComponent): Promise<unknown> {\n\tconst oMetaModel = (oObjectPageLayout.getModel() as ODataModel).getMetaModel();\n\tconst oBindingContext = oObjectPageLayout.getBindingContext() as ODataV4Context;\n\tconst path = (oBindingContext && oBindingContext.getPath()) || \"\";\n\tconst oMetaPath = oMetaModel.getMetaPath(path);\n\t// Semantic Key Vocabulary\n\tconst sSemanticKeyVocabulary = `${oMetaPath}/` + `@com.sap.vocabularies.Common.v1.SemanticKey`;\n\t//Semantic Keys\n\tconst aSemKeys = oMetaModel.getObject(sSemanticKeyVocabulary);\n\t// Unavailable Actions\n\tconst oEntry = oBindingContext?.getObject();\n\tif (!oEntry && oBindingContext) {\n\t\toBindingContext\n\t\t\t.requestObject()\n\t\t\t.then(async function (requestedObject: Record<string, unknown> | undefined) {\n\t\t\t\treturn CommonUtils.updateRelateAppsModel(\n\t\t\t\t\toBindingContext,\n\t\t\t\t\trequestedObject,\n\t\t\t\t\toObjectPageLayout,\n\t\t\t\t\taSemKeys,\n\t\t\t\t\toMetaModel,\n\t\t\t\t\toMetaPath,\n\t\t\t\t\tappComponent\n\t\t\t\t);\n\t\t\t})\n\t\t\t.catch(function (oError: unknown) {\n\t\t\t\tLog.error(\"Cannot update the related app details\", oError as string);\n\t\t\t});\n\t} else {\n\t\treturn CommonUtils.updateRelateAppsModel(oBindingContext, oEntry, oObjectPageLayout, aSemKeys, oMetaModel, oMetaPath, appComponent);\n\t}\n}\n\n/**\n * @param oButton\n */\nfunction fnFireButtonPress(oButton?: Control): void {\n\tif (\n\t\toButton &&\n\t\toButton.isA<Button | OverflowToolbarButton>([\"sap.m.Button\", \"sap.m.OverflowToolbarButton\"]) &&\n\t\toButton.getVisible() &&\n\t\toButton.getEnabled()\n\t) {\n\t\toButton.firePress();\n\t}\n}\n\nfunction getAppComponent(oControl: Control | Component): AppComponent {\n\tif (oControl.isA<AppComponent>(\"sap.fe.core.AppComponent\")) {\n\t\treturn oControl;\n\t}\n\tconst oOwner = Component.getOwnerComponentFor(oControl);\n\tif (!oOwner) {\n\t\tthrow new Error(\"There should be a sap.fe.core.AppComponent as owner of the control\");\n\t} else {\n\t\treturn getAppComponent(oOwner);\n\t}\n}\n\nfunction getCurrentPageView(oAppComponent: AppComponent): FEView {\n\tconst rootViewController = oAppComponent.getRootViewController();\n\treturn rootViewController.isFclEnabled()\n\t\t? rootViewController.getRightmostView()\n\t\t: CommonUtils.getTargetView((oAppComponent.getRootContainer() as NavContainer).getCurrentPage());\n}\n\nfunction getTargetView(oControl: ManagedObject | null): FEView {\n\tif (oControl && oControl.isA<ComponentContainer>(\"sap.ui.core.ComponentContainer\")) {\n\t\tconst oComponent = oControl.getComponentInstance();\n\t\toControl = oComponent && oComponent.getRootControl();\n\t}\n\twhile (oControl && !oControl.isA<FEView>(\"sap.ui.core.mvc.View\")) {\n\t\toControl = oControl.getParent();\n\t}\n\treturn oControl!;\n}\n\nfunction _fnCheckIsMatch(oObject: object, oKeysToCheck: Record<string, unknown>): boolean {\n\tfor (const sKey in oKeysToCheck) {\n\t\tif (oKeysToCheck[sKey] !== oObject[sKey as keyof typeof oObject]) {\n\t\t\treturn false;\n\t\t}\n\t}\n\treturn true;\n}\n\nfunction fnGetContextPathProperties(\n\tmetaModelContext: ODataMetaModel,\n\tsContextPath: string,\n\toFilter?: Record<string, unknown>\n): Record<string, MetaModelProperty> | Record<string, MetaModelNavProperty> {\n\tconst oEntityType: MetaModelEntityType = (metaModelContext.getObject(`${sContextPath}/`) || {}) as MetaModelEntityType,\n\t\toProperties: Record<string, MetaModelProperty> | Record<string, MetaModelNavProperty> = {};\n\n\tfor (const sKey in oEntityType) {\n\t\tif (\n\t\t\toEntityType.hasOwnProperty(sKey) &&\n\t\t\t!/^\\$/i.test(sKey) &&\n\t\t\toEntityType[sKey].$kind &&\n\t\t\t_fnCheckIsMatch(oEntityType[sKey], oFilter || { $kind: \"Property\" })\n\t\t) {\n\t\t\toProperties[sKey] = oEntityType[sKey];\n\t\t}\n\t}\n\treturn oProperties;\n}\n\nfunction fnGetIBNActions(oControl: Table | ObjectPageDynamicHeaderTitle | ObjectPageSubSection, aIBNActions: UI5Element[]): UI5Element[] {\n\tconst aActions = oControl && oControl.getActions();\n\tif (aActions) {\n\t\taActions.forEach(function (oAction) {\n\t\t\tif (oAction.isA<ActionToolbarAction>(\"sap.ui.mdc.actiontoolbar.ActionToolbarAction\")) {\n\t\t\t\toAction = oAction.getAction();\n\t\t\t}\n\t\t\tif (oAction.isA<MenuButton>(\"sap.m.MenuButton\")) {\n\t\t\t\tconst oMenu = oAction.getMenu();\n\t\t\t\tconst aItems = oMenu.getItems();\n\t\t\t\taItems.forEach((oItem) => {\n\t\t\t\t\tif (oItem.data(\"IBNData\")) {\n\t\t\t\t\t\taIBNActions.push(oItem);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (oAction.data(\"IBNData\")) {\n\t\t\t\taIBNActions.push(oAction);\n\t\t\t}\n\t\t});\n\t}\n\treturn aIBNActions;\n}\n\nasync function fnUpdateDataFieldForIBNButtonsVisibility(aIBNActions: UI5Element[], oView: View): Promise<void> {\n\tconst oParams: Record<string, { value: unknown }> = {};\n\tconst oAppComponent = CommonUtils.getAppComponent(oView);\n\tconst isSticky = ModelHelper.isStickySessionSupported((oView.getModel() as ODataModel).getMetaModel());\n\tconst fnGetLinks = function (oData?: Record<string, unknown> | undefined): void {\n\t\tif (oData) {\n\t\t\tconst aKeys = Object.keys(oData);\n\t\t\taKeys.forEach(function (sKey: string) {\n\t\t\t\tif (sKey.indexOf(\"_\") !== 0 && !sKey.includes(\"odata.context\")) {\n\t\t\t\t\toParams[sKey] = { value: oData[sKey] };\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (aIBNActions.length) {\n\t\t\taIBNActions.forEach(function (oIBNAction) {\n\t\t\t\tconst sSemanticObject = oIBNAction.data(\"IBNData\").semanticObject;\n\t\t\t\tconst sAction = oIBNAction.data(\"IBNData\").action;\n\t\t\t\toAppComponent\n\t\t\t\t\t.getShellServices()\n\t\t\t\t\t.getLinks([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tsemanticObject: sSemanticObject,\n\t\t\t\t\t\t\taction: sAction,\n\t\t\t\t\t\t\tparams: oParams\n\t\t\t\t\t\t}\n\t\t\t\t\t])\n\t\t\t\t\t.then(function (aLink): void {\n\t\t\t\t\t\tif (oIBNAction.isA<Control>(\"sap.ui.core.Control\") || oIBNAction.isA<MenuItem>(\"sap.m.MenuItem\")) {\n\t\t\t\t\t\t\toIBNAction.setVisible(\n\t\t\t\t\t\t\t\toIBNAction.getVisible() && aLink && aLink.length === 1 && aLink[0] && aLink[0].length === 1\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (isSticky) {\n\t\t\t\t\t\t\t(oIBNAction.getBindingContext(\"internal\") as InternalModelContext).setProperty(\n\t\t\t\t\t\t\t\toIBNAction.getId().split(\"--\")[1],\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tshellNavigationNotAvailable: !(aLink && aLink.length === 1 && aLink[0] && aLink[0].length === 1)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn;\n\t\t\t\t\t})\n\t\t\t\t\t.catch(function (oError: unknown) {\n\t\t\t\t\t\tLog.error(\"Cannot retrieve the links from the shell service\", oError as string);\n\t\t\t\t\t});\n\t\t\t});\n\t\t}\n\t};\n\tif (oView && oView.getBindingContext()) {\n\t\treturn (oView.getBindingContext() as ODataV4Context)\n\t\t\t?.requestObject()\n\t\t\t.then(function (oData: Record<string, unknown> | undefined) {\n\t\t\t\treturn fnGetLinks(oData);\n\t\t\t})\n\t\t\t.catch(function (oError: unknown) {\n\t\t\t\tLog.error(\"Cannot retrieve the links from the shell service\", oError as string);\n\t\t\t});\n\t} else {\n\t\treturn fnGetLinks();\n\t}\n}\n\n/**\n * Updates the menu button visibility if all the underlying selection buttons are hidden.\n * @param IBNActions\n */\nfunction updateMenuButtonVisiblity(IBNActions: UI5Element[]): void {\n\tconst menuButtonWithIBNAction: MenuButton[] = [];\n\tIBNActions.forEach(function (IBNAction) {\n\t\tif (IBNAction.isA<MenuButton>(\"sap.m.MenuItem\")) {\n\t\t\tmenuButtonWithIBNAction.push(IBNAction.getParent()?.getParent()?.getParent()?.getParent()?.getParent() as MenuButton);\n\t\t}\n\t});\n\tmenuButtonWithIBNAction.forEach(function (menuAction) {\n\t\tconst menuItems = menuAction?.getMenu().getItems();\n\t\tconst visibleMenuItems = menuItems.filter(function (menuItem) {\n\t\t\treturn menuItem.getVisible();\n\t\t});\n\t\tif (visibleMenuItems.length === 0) {\n\t\t\tmenuAction.setVisible(false);\n\t\t}\n\t});\n}\n\nfunction getActionPath(\n\tactionContext: Context,\n\tbReturnOnlyPath: boolean,\n\tinActionName?: string,\n\tbCheckStaticValue?: boolean\n):\n\t| string\n\t| {\n\t\t\tsContextPath: string;\n\t\t\tsProperty: string;\n\t\t\tsBindingParameter: string;\n\t  } {\n\tconst sActionName: string = !inActionName ? actionContext.getObject(actionContext.getPath()).toString() : inActionName;\n\tlet sContextPath = actionContext.getPath().split(\"/@\")[0];\n\tconst sEntityTypeName = (actionContext.getObject(sContextPath) as MetaModelEntityType).$Type;\n\tconst sEntityName = getEntitySetName(actionContext.getModel() as ODataMetaModel, sEntityTypeName);\n\tif (sEntityName) {\n\t\tsContextPath = `/${sEntityName}`;\n\t}\n\tif (bCheckStaticValue) {\n\t\treturn actionContext.getObject(`${sContextPath}/${sActionName}@Org.OData.Core.V1.OperationAvailable`);\n\t}\n\tif (bReturnOnlyPath) {\n\t\treturn `${sContextPath}/${sActionName}`;\n\t} else {\n\t\treturn {\n\t\t\tsContextPath: sContextPath,\n\t\t\tsProperty: actionContext.getObject(`${sContextPath}/${sActionName}@Org.OData.Core.V1.OperationAvailable/$Path`),\n\t\t\tsBindingParameter: actionContext.getObject(`${sContextPath}/${sActionName}/@$ui5.overload/0/$Parameter/0/$Name`)\n\t\t};\n\t}\n}\n\nfunction getEntitySetName(oMetaModel: ODataMetaModel, sEntityType: string): string | undefined {\n\tconst oEntityContainer = oMetaModel.getObject(\"/\");\n\tfor (const key in oEntityContainer) {\n\t\tif (typeof oEntityContainer[key] === \"object\" && oEntityContainer[key].$Type === sEntityType) {\n\t\t\treturn key;\n\t\t}\n\t}\n}\n\nfunction computeDisplayMode(\n\toPropertyAnnotations: Record<string, unknown>,\n\toCollectionAnnotations?: Record<string, unknown>\n): \"Description\" | \"ValueDescription\" | \"Value\" | \"DescriptionValue\" {\n\tconst oTextAnnotation = oPropertyAnnotations[\"@com.sap.vocabularies.Common.v1.Text\"],\n\t\toTextArrangementAnnotation = (oTextAnnotation &&\n\t\t\t((oPropertyAnnotations &&\n\t\t\t\toPropertyAnnotations[\"@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement\"]) ||\n\t\t\t\t(oCollectionAnnotations &&\n\t\t\t\t\toCollectionAnnotations[\"@com.sap.vocabularies.UI.v1.TextArrangement\"]))) as MetaModelEnum<TextArrangement>;\n\n\tif (oTextArrangementAnnotation) {\n\t\tif (oTextArrangementAnnotation.$EnumMember === \"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly\") {\n\t\t\treturn \"Description\";\n\t\t} else if (oTextArrangementAnnotation.$EnumMember === \"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast\") {\n\t\t\treturn \"ValueDescription\";\n\t\t} else if (oTextArrangementAnnotation.$EnumMember === \"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate\") {\n\t\t\treturn \"Value\";\n\t\t}\n\t\t//Default should be TextFirst if there is a Text annotation and neither TextOnly nor TextLast are set\n\t\treturn \"DescriptionValue\";\n\t}\n\treturn oTextAnnotation ? \"DescriptionValue\" : \"Value\";\n}\n\nfunction _getEntityType(oContext: ODataV4Context): string | undefined {\n\tconst oMetaModel = oContext.getModel().getMetaModel();\n\treturn oMetaModel.getObject(`${oMetaModel.getMetaPath(oContext.getPath())}/$Type`);\n}\n\nasync function _requestObject(sAction: string, oSelectedContext: ODataV4Context, sProperty: string): Promise<unknown> {\n\tlet oContext = oSelectedContext;\n\tconst nBracketIndex = sAction.indexOf(\"(\");\n\n\tif (nBracketIndex > -1) {\n\t\tconst sTargetType = sAction.slice(nBracketIndex + 1, -1);\n\t\tlet sCurrentType = _getEntityType(oContext);\n\n\t\twhile (sCurrentType !== sTargetType) {\n\t\t\t// Find parent binding context and retrieve entity type\n\t\t\toContext = oContext.getBinding().getContext() as ODataV4Context;\n\t\t\tif (oContext) {\n\t\t\t\tsCurrentType = _getEntityType(oContext);\n\t\t\t} else {\n\t\t\t\tLog.warning(\"Cannot determine target type to request property value for bound action invocation\");\n\t\t\t\treturn Promise.resolve(undefined);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn oContext.requestObject(sProperty);\n}\n\nexport type _RequestedProperty = {\n\tvPropertyValue: unknown;\n\toSelectedContext: Context;\n\tsAction: string;\n\tsDynamicActionEnabledPath: string;\n};\nasync function requestProperty(\n\toSelectedContext: ODataV4Context,\n\tsAction: string,\n\tsProperty: string,\n\tsDynamicActionEnabledPath: string\n): Promise<_RequestedProperty> {\n\tconst oPromise =\n\t\tsProperty && sProperty.indexOf(\"/\") === 0\n\t\t\t? requestSingletonProperty(sProperty, oSelectedContext.getModel())\n\t\t\t: _requestObject(sAction, oSelectedContext, sProperty);\n\n\treturn oPromise.then(function (vPropertyValue: unknown) {\n\t\treturn {\n\t\t\tvPropertyValue: vPropertyValue,\n\t\t\toSelectedContext: oSelectedContext,\n\t\t\tsAction: sAction,\n\t\t\tsDynamicActionEnabledPath: sDynamicActionEnabledPath\n\t\t};\n\t});\n}\n\nasync function setContextsBasedOnOperationAvailable(\n\toInternalModelContext: InternalModelContext,\n\taRequestPromises: Promise<_RequestedProperty>[],\n\tforContextMenu = false\n): Promise<void> {\n\treturn Promise.all(aRequestPromises)\n\t\t.then(function (aResults): void {\n\t\t\tif (aResults.length) {\n\t\t\t\tconst aApplicableContexts: unknown[] = [],\n\t\t\t\t\taNotApplicableContexts: unknown[] = [];\n\t\t\t\taResults.forEach(function (aResult) {\n\t\t\t\t\tif (aResult) {\n\t\t\t\t\t\tif (aResult.vPropertyValue) {\n\t\t\t\t\t\t\toInternalModelContext.getModel().setProperty(aResult.sDynamicActionEnabledPath, true);\n\t\t\t\t\t\t\taApplicableContexts.push(aResult.oSelectedContext);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taNotApplicableContexts.push(aResult.oSelectedContext);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tsetDynamicActionContexts(\n\t\t\t\t\toInternalModelContext,\n\t\t\t\t\taResults[0].sAction,\n\t\t\t\t\taApplicableContexts,\n\t\t\t\t\taNotApplicableContexts,\n\t\t\t\t\tforContextMenu\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn;\n\t\t})\n\t\t.catch(function (oError: unknown) {\n\t\t\tLog.trace(\"Cannot retrieve property value from path\", oError as string);\n\t\t});\n}\n\n/**\n * @param internalModelContext\n * @param action\n * @param applicable\n * @param notApplicable\n * @param forContextMenu\n */\nfunction setDynamicActionContexts(\n\tinternalModelContext: InternalModelContext,\n\taction: string,\n\tapplicable: unknown[],\n\tnotApplicable: unknown[],\n\tforContextMenu = false\n): void {\n\tconst dynamicActionPathPrefix = `${internalModelContext.getPath()}/dynamicActions/${action}`,\n\t\tinternalModel = internalModelContext.getModel(),\n\t\tapplicableProperty = !forContextMenu ? \"aApplicable\" : \"aApplicableForContextMenu\",\n\t\tnotApplicableProperty = !forContextMenu ? \"aNotApplicable\" : \"aNotApplicableForContextMenu\";\n\tinternalModel.setProperty(`${dynamicActionPathPrefix}/${applicableProperty}`, applicable);\n\tinternalModel.setProperty(`${dynamicActionPathPrefix}/${notApplicableProperty}`, notApplicable);\n}\n\nfunction getSpecificAllowedExpression(aExpressions: string[]): string {\n\tconst aAllowedExpressionsPriority = CommonUtils.AllowedExpressionsPrio;\n\n\taExpressions.sort(function (a: string, b: string) {\n\t\treturn aAllowedExpressionsPriority.indexOf(a) - aAllowedExpressionsPriority.indexOf(b);\n\t});\n\n\treturn aExpressions[0];\n}\n\n/**\n * Method to return allowed operators for type Guid.\n * @returns Allowed operators for type Guid\n */\nfunction getOperatorsForGuidProperty(): string {\n\tconst allowedOperatorsForGuid = [\"EQ\", \"NE\"];\n\treturn allowedOperatorsForGuid.toString();\n}\n\ntype ParameterInfo = {\n\tcontextPath?: string;\n\tparameterProperties?: Record<string, MetaModelProperty>;\n};\nfunction getParameterInfo(metaModelContext: ODataMetaModel, sContextPath: string): ParameterInfo {\n\tconst sParameterContextPath = sContextPath.substring(0, sContextPath.lastIndexOf(\"/\"));\n\tconst bResultContext = metaModelContext.getObject(`${sParameterContextPath}/@com.sap.vocabularies.Common.v1.ResultContext`);\n\tconst oParameterInfo: ParameterInfo = {};\n\tif (bResultContext && sParameterContextPath !== sContextPath) {\n\t\toParameterInfo.contextPath = sParameterContextPath;\n\t\toParameterInfo.parameterProperties = CommonUtils.getContextPathProperties(metaModelContext, sParameterContextPath) as Record<\n\t\t\tstring,\n\t\t\tMetaModelProperty\n\t\t>;\n\t}\n\treturn oParameterInfo;\n}\n\ntype ViewData = {\n\tcontrolConfiguration?: Record<string, Record<string, unknown>>;\n};\n\nfunction addPageContextToSelectionVariant(oSelectionVariant: SelectionVariant, mPageContext: unknown[], oView: View): SelectionVariant {\n\tconst oAppComponent = CommonUtils.getAppComponent(oView);\n\tconst oNavigationService = oAppComponent.getNavigationService();\n\treturn oNavigationService.mixAttributesAndSelectionVariant(mPageContext, oSelectionVariant.toJSONString());\n}\n\nfunction isStickyEditMode(oControl: Control): boolean {\n\tconst bIsStickyMode = ModelHelper.isStickySessionSupported((oControl.getModel() as ODataModel).getMetaModel());\n\tconst bUIEditable = CommonUtils.getIsEditable(oControl);\n\treturn bIsStickyMode && bUIEditable;\n}\n\nexport type UserDefaultParameter = EdmActionParameter | Context;\n\n/**\n * Retrieves the user defaults from the startup app state (if available) or the startup parameter and sets them to a model.\n * @param appComponent\n * @param parameters\n * @param model\n * @param isAction\n * @param isCreate\n * @param actionDefaultValues\n */\nasync function setUserDefaults(\n\tappComponent: AppComponent,\n\tparameters: UserDefaultParameter[],\n\tmodel: JSONModel | ODataV4Context,\n\tisAction: boolean,\n\tisCreate?: boolean,\n\tactionDefaultValues?: Record<string, unknown>\n): Promise<void> {\n\tconst BaseType = (await import(\"sap/ui/mdc/enums/BaseType\")).default;\n\tconst TypeMap = (await import(\"sap/ui/mdc/odata/v4/TypeMap\")).default;\n\n\tconst componentData = appComponent.getComponentData(),\n\t\tstartupParameters = (componentData && componentData.startupParameters) || {},\n\t\tshellServices = appComponent.getShellServices();\n\tconst startupAppState = await shellServices.getStartupAppState(appComponent);\n\tconst startupAppStateData = startupAppState?.getData() || {},\n\t\textendedParameters = (startupAppStateData.selectionVariant && startupAppStateData.selectionVariant.SelectOptions) || [];\n\tparameters.forEach(function (oParameter) {\n\t\tconst sPropertyName = isAction\n\t\t\t? `/${(oParameter as { name: string }).name}`\n\t\t\t: (oParameter as Context).getPath?.().slice((oParameter as Context).getPath().lastIndexOf(\"/\") + 1);\n\t\tconst sParameterName = isAction ? sPropertyName.slice(1) : sPropertyName;\n\t\tif (actionDefaultValues && isCreate) {\n\t\t\tif (actionDefaultValues[sParameterName]) {\n\t\t\t\tmodel.setProperty(sPropertyName, actionDefaultValues[sParameterName]);\n\t\t\t}\n\t\t} else if (startupParameters[sParameterName]) {\n\t\t\tconst parametertType = (\n\t\t\t\toParameter as {\n\t\t\t\t\tname: string;\n\t\t\t\t\ttype?: string;\n\t\t\t\t}\n\t\t\t).type\n\t\t\t\t? TypeMap.getBaseType(\n\t\t\t\t\t\t(\n\t\t\t\t\t\t\toParameter as {\n\t\t\t\t\t\t\t\tname: string;\n\t\t\t\t\t\t\t\ttype: string;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t).type\n\t\t\t\t  )\n\t\t\t\t: BaseType.String;\n\t\t\tconst typeInstance = TypeMap.getDataTypeInstance(parametertType);\n\t\t\tmodel.setProperty(sPropertyName, typeInstance.parseValue(startupParameters[sParameterName][0], \"string\"));\n\t\t} else if (extendedParameters.length > 0) {\n\t\t\tfor (const oExtendedParameter of extendedParameters) {\n\t\t\t\tif (oExtendedParameter.PropertyName === sParameterName) {\n\t\t\t\t\tconst oRange = oExtendedParameter.Ranges.length\n\t\t\t\t\t\t? oExtendedParameter.Ranges[oExtendedParameter.Ranges.length - 1]\n\t\t\t\t\t\t: undefined;\n\t\t\t\t\tif (oRange && oRange.Sign === \"I\" && oRange.Option === \"EQ\") {\n\t\t\t\t\t\tmodel.setProperty(sPropertyName, oRange.Low); // high is ignored when Option=EQ\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t});\n}\n\nexport type InboundParameter = {\n\tuseForCreate: boolean;\n};\nfunction getAdditionalParamsForCreate(\n\toStartupParameters: Record<string, unknown[]>,\n\toInboundParameters?: Record<string, InboundParameter>\n): unknown {\n\tconst oInbounds = oInboundParameters,\n\t\taCreateParameters =\n\t\t\toInbounds !== undefined\n\t\t\t\t? Object.keys(oInbounds).filter(function (sParameter: string) {\n\t\t\t\t\t\treturn oInbounds[sParameter].useForCreate;\n\t\t\t\t  })\n\t\t\t\t: [];\n\tlet oRet;\n\tfor (const element of aCreateParameters) {\n\t\tconst sCreateParameter = element;\n\t\tconst aValues = oStartupParameters && oStartupParameters[sCreateParameter];\n\t\tif (aValues && aValues.length === 1) {\n\t\t\toRet = oRet || Object.create(null);\n\t\t\toRet[sCreateParameter] = aValues[0];\n\t\t}\n\t}\n\treturn oRet;\n}\ntype OutboundParameter = {\n\tparameters: Record<string, OutboundParameterValue>;\n\tsemanticObject?: string;\n\taction?: string;\n};\ntype OutboundParameterValue = {\n\tvalue?: {\n\t\tvalue?: string;\n\t\tformat?: string;\n\t};\n};\nfunction getSemanticObjectMapping(oOutbound: OutboundParameter): MetaModelType<SemanticObjectMappingTypeTypes>[] {\n\tconst aSemanticObjectMapping: MetaModelType<SemanticObjectMappingTypeTypes>[] = [];\n\t// eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n\tif (oOutbound.parameters) {\n\t\tconst aParameters = Object.keys(oOutbound.parameters) || [];\n\t\tif (aParameters.length > 0) {\n\t\t\taParameters.forEach(function (sParam: string) {\n\t\t\t\tconst oMapping = oOutbound.parameters[sParam];\n\t\t\t\tif (oMapping.value && oMapping.value.value && oMapping.value.format === \"binding\") {\n\t\t\t\t\t// using the format of UI.Mapping\n\t\t\t\t\tconst oSemanticMapping = {\n\t\t\t\t\t\tLocalProperty: {\n\t\t\t\t\t\t\t$PropertyPath: oMapping.value.value\n\t\t\t\t\t\t},\n\t\t\t\t\t\tSemanticObjectProperty: sParam\n\t\t\t\t\t};\n\n\t\t\t\t\tif (aSemanticObjectMapping.length > 0) {\n\t\t\t\t\t\t// To check if the semanticObject Mapping is done for the same local property more that once then first one will be considered\n\t\t\t\t\t\tfor (const element of aSemanticObjectMapping) {\n\t\t\t\t\t\t\tif (element.LocalProperty?.$PropertyPath !== oSemanticMapping.LocalProperty.$PropertyPath) {\n\t\t\t\t\t\t\t\taSemanticObjectMapping.push(oSemanticMapping);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\taSemanticObjectMapping.push(oSemanticMapping);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\treturn aSemanticObjectMapping;\n}\n\nfunction getHeaderFacetItemConfigForExternalNavigation(\n\toViewData: ViewData,\n\toCrossNav: Record<string, OutboundParameter>\n): Record<\n\tstring,\n\t{\n\t\tsemanticObject: string;\n\t\taction: string;\n\t\tsemanticObjectMapping: MetaModelType<SemanticObjectMappingTypeTypes>[];\n\t}\n> {\n\tconst oHeaderFacetItems: Record<\n\t\tstring,\n\t\t{\n\t\t\tsemanticObject: string;\n\t\t\taction: string;\n\t\t\tsemanticObjectMapping: MetaModelType<SemanticObjectMappingTypeTypes>[];\n\t\t}\n\t> = {};\n\tlet sId;\n\tconst oControlConfig = oViewData.controlConfiguration as Record<\n\t\tstring,\n\t\t{\n\t\t\tnavigation?: {\n\t\t\t\ttargetOutbound?: {\n\t\t\t\t\toutbound: string;\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\t>;\n\tfor (const config in oControlConfig) {\n\t\tif (config.includes(\"@com.sap.vocabularies.UI.v1.DataPoint\") || config.includes(\"@com.sap.vocabularies.UI.v1.Chart\")) {\n\t\t\tconst sOutbound = oControlConfig[config].navigation?.targetOutbound?.outbound;\n\t\t\tif (sOutbound !== undefined) {\n\t\t\t\tconst oOutbound = oCrossNav[sOutbound];\n\t\t\t\tif (oOutbound.semanticObject && oOutbound.action) {\n\t\t\t\t\tif (config.includes(\"Chart\")) {\n\t\t\t\t\t\tsId = generate([\"fe\", \"MicroChartLink\", config]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsId = generate([\"fe\", \"HeaderDPLink\", config]);\n\t\t\t\t\t}\n\t\t\t\t\tconst aSemanticObjectMapping = CommonUtils.getSemanticObjectMapping(oOutbound);\n\t\t\t\t\toHeaderFacetItems[sId] = {\n\t\t\t\t\t\tsemanticObject: oOutbound.semanticObject,\n\t\t\t\t\t\taction: oOutbound.action,\n\t\t\t\t\t\tsemanticObjectMapping: aSemanticObjectMapping\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\tLog.error(`Cross navigation outbound is configured without semantic object and action for ${sOutbound}`);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn oHeaderFacetItems;\n}\n\nfunction setSemanticObjectMappings(oSelectionVariant: SelectionVariant, vMappings: unknown): SelectionVariant {\n\tconst oMappings = typeof vMappings === \"string\" ? JSON.parse(vMappings) : vMappings;\n\tfor (const element of oMappings) {\n\t\tconst sLocalProperty =\n\t\t\t(element[\"LocalProperty\"] && element[\"LocalProperty\"][\"$PropertyPath\"]) ||\n\t\t\t(element[\"@com.sap.vocabularies.Common.v1.LocalProperty\"] && element[\"@com.sap.vocabularies.Common.v1.LocalProperty\"][\"$Path\"]);\n\t\tconst sSemanticObjectProperty =\n\t\t\telement[\"SemanticObjectProperty\"] || element[\"@com.sap.vocabularies.Common.v1.SemanticObjectProperty\"];\n\t\tconst oSelectOption = oSelectionVariant.getSelectOption(sLocalProperty);\n\t\tif (oSelectOption) {\n\t\t\t//Create a new SelectOption with sSemanticObjectProperty as the property Name and remove the older one\n\t\t\toSelectionVariant.removeSelectOption(sLocalProperty);\n\t\t\toSelectionVariant.massAddSelectOption(sSemanticObjectProperty, oSelectOption);\n\t\t}\n\t}\n\treturn oSelectionVariant;\n}\n\ntype SemanticObjectFromPath = {\n\tsemanticObjectPath: string;\n\tsemanticObjectForGetLinks: { semanticObject: string }[];\n\tsemanticObject: {\n\t\tsemanticObject: { $Path: string };\n\t};\n\tunavailableActions: string[];\n};\nasync function fnGetSemanticObjectsFromPath(\n\toMetaModel: ODataMetaModel,\n\tsPath: string,\n\tsQualifier: string\n): Promise<SemanticObjectFromPath> {\n\treturn new Promise<SemanticObjectFromPath>(function (resolve) {\n\t\tlet sSemanticObject, aSemanticObjectUnavailableActions;\n\t\tif (sQualifier === \"\") {\n\t\t\tsSemanticObject = oMetaModel.getObject(`${sPath}@${CommonAnnotationTerms.SemanticObject}`);\n\t\t\taSemanticObjectUnavailableActions = oMetaModel.getObject(`${sPath}@${CommonAnnotationTerms.SemanticObjectUnavailableActions}`);\n\t\t} else {\n\t\t\tsSemanticObject = oMetaModel.getObject(`${sPath}@${CommonAnnotationTerms.SemanticObject}#${sQualifier}`);\n\t\t\taSemanticObjectUnavailableActions = oMetaModel.getObject(\n\t\t\t\t`${sPath}@${CommonAnnotationTerms.SemanticObjectUnavailableActions}#${sQualifier}`\n\t\t\t);\n\t\t}\n\n\t\tconst aSemanticObjectForGetLinks = [{ semanticObject: sSemanticObject }];\n\t\tconst oSemanticObject = {\n\t\t\tsemanticObject: sSemanticObject\n\t\t};\n\t\tresolve({\n\t\t\tsemanticObjectPath: sPath,\n\t\t\tsemanticObjectForGetLinks: aSemanticObjectForGetLinks,\n\t\t\tsemanticObject: oSemanticObject,\n\t\t\tunavailableActions: aSemanticObjectUnavailableActions\n\t\t});\n\t});\n}\n\nasync function fnGetSemanticObjectPromise(oMetaModel: ODataMetaModel, sPath: string, sQualifier: string): Promise<SemanticObjectFromPath> {\n\treturn CommonUtils.getSemanticObjectsFromPath(oMetaModel, sPath, sQualifier);\n}\n\nfunction getFilterAllowedExpression(oFilterRestrictionsAnnotation?: MetaModelType<FilterRestrictionsType>): _FilterAllowedExpressions {\n\tconst mAllowedExpressions: _FilterAllowedExpressions = {};\n\tif (oFilterRestrictionsAnnotation && oFilterRestrictionsAnnotation.FilterExpressionRestrictions !== undefined) {\n\t\toFilterRestrictionsAnnotation.FilterExpressionRestrictions.forEach(function (oProperty) {\n\t\t\tif (oProperty.Property && oProperty.AllowedExpressions !== undefined) {\n\t\t\t\t//SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression\n\t\t\t\tif (mAllowedExpressions[oProperty.Property.$PropertyPath] !== undefined) {\n\t\t\t\t\tmAllowedExpressions[oProperty.Property.$PropertyPath].push(oProperty.AllowedExpressions);\n\t\t\t\t} else {\n\t\t\t\t\tmAllowedExpressions[oProperty.Property.$PropertyPath] = [oProperty.AllowedExpressions];\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\treturn mAllowedExpressions;\n}\nfunction getFilterRestrictions(\n\toFilterRestrictionsAnnotation?: MetaModelType<FilterRestrictionsType>,\n\tsRestriction?: \"RequiredProperties\" | \"NonFilterableProperties\"\n): string[] {\n\tlet aProps: string[] = [];\n\tif (oFilterRestrictionsAnnotation && oFilterRestrictionsAnnotation[sRestriction as keyof MetaModelType<FilterRestrictionsType>]) {\n\t\taProps = (\n\t\t\toFilterRestrictionsAnnotation[sRestriction as keyof MetaModelType<FilterRestrictionsType>] as ExpandPathType<Edm.PropertyPath>[]\n\t\t).map(function (oProperty: ExpandPathType<Edm.PropertyPath>) {\n\t\t\treturn oProperty.$PropertyPath;\n\t\t});\n\t}\n\treturn aProps;\n}\n\nfunction _fetchPropertiesForNavPath(paths: string[], navPath: string, props: string[]): string[] {\n\tconst navPathPrefix = navPath + \"/\";\n\treturn paths.reduce((outPaths: string[], pathToCheck: string) => {\n\t\tif (pathToCheck.startsWith(navPathPrefix)) {\n\t\t\tconst outPath = pathToCheck.replace(navPathPrefix, \"\");\n\t\t\tif (!outPaths.includes(outPath)) {\n\t\t\t\toutPaths.push(outPath);\n\t\t\t}\n\t\t}\n\t\treturn outPaths;\n\t}, props);\n}\ntype _FilterAllowedExpressions = Record<string, string[]>;\nexport type _FilterRestrictions = {\n\tRequiredProperties: string[];\n\tNonFilterableProperties: string[];\n\tFilterAllowedExpressions: _FilterAllowedExpressions;\n};\nfunction getFilterRestrictionsByPath(entityPath: string, oContext: ODataMetaModel): _FilterRestrictions {\n\t// NOTE: For getting FilterAllowedExpressions please use 'getAllowedFilterExpressionForProperty' from 'sap/fe/core/converters/controls/ListReport/FilterField.ts'.\n\tconst oRet: _FilterRestrictions = {\n\t\tRequiredProperties: [],\n\t\tNonFilterableProperties: [],\n\t\tFilterAllowedExpressions: {}\n\t};\n\tlet oFilterRestrictions;\n\tconst navigationText = \"$NavigationPropertyBinding\";\n\tconst frTerm = \"@Org.OData.Capabilities.V1.FilterRestrictions\";\n\tconst entityTypePathParts = entityPath.replaceAll(\"%2F\", \"/\").split(\"/\").filter(ModelHelper.filterOutNavPropBinding);\n\tconst entityTypePath = `/${entityTypePathParts.join(\"/\")}/`;\n\tconst entitySetPath = ModelHelper.getEntitySetPath(entityPath, oContext);\n\tconst entitySetPathParts = entitySetPath.split(\"/\").filter(ModelHelper.filterOutNavPropBinding);\n\tconst isContainment = oContext.getObject(`${entityTypePath}$ContainsTarget`);\n\tconst containmentNavPath = !!isContainment && entityTypePathParts[entityTypePathParts.length - 1];\n\n\t//LEAST PRIORITY - Filter restrictions directly at Entity Set\n\t//e.g. FR in \"NS.EntityContainer/SalesOrderManage\" ContextPath: /SalesOrderManage\n\tif (!isContainment) {\n\t\toFilterRestrictions = oContext.getObject(`${entitySetPath}${frTerm}`) as MetaModelType<FilterRestrictionsType> | undefined;\n\t\toRet.RequiredProperties = getFilterRestrictions(oFilterRestrictions, \"RequiredProperties\") || [];\n\t\tconst resultContextCheck = oContext.getObject(`${entityTypePath}@com.sap.vocabularies.Common.v1.ResultContext`);\n\t\tif (!resultContextCheck) {\n\t\t\toRet.NonFilterableProperties = getFilterRestrictions(oFilterRestrictions, \"NonFilterableProperties\") || [];\n\t\t}\n\t\t//SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression\n\t\toRet.FilterAllowedExpressions = getFilterAllowedExpression(oFilterRestrictions) || {};\n\t}\n\n\tif (entityTypePathParts.length > 1) {\n\t\tconst navPath = isContainment ? (containmentNavPath as string) : entitySetPathParts[entitySetPathParts.length - 1];\n\t\t// In case of containment we take entitySet provided as parent. And in case of normal we would remove the last navigation from entitySetPath.\n\t\tconst parentEntitySetPath = isContainment ? entitySetPath : `/${entitySetPathParts.slice(0, -1).join(`/${navigationText}/`)}`;\n\t\t//THIRD HIGHEST PRIORITY - Reading property path restrictions - Annotation at main entity but directly on navigation property path\n\t\t//e.g. Parent Customer with PropertyPath=\"Set/CityName\" ContextPath: Customer/Set\n\t\tconst oParentRet: _FilterRestrictions = {\n\t\t\tRequiredProperties: [],\n\t\t\tNonFilterableProperties: [],\n\t\t\tFilterAllowedExpressions: {}\n\t\t};\n\t\tif (!navPath.includes(\"%2F\")) {\n\t\t\tconst oParentFR = oContext.getObject(`${parentEntitySetPath}${frTerm}`) as MetaModelType<FilterRestrictionsType> | undefined;\n\t\t\toRet.RequiredProperties = _fetchPropertiesForNavPath(\n\t\t\t\tgetFilterRestrictions(oParentFR, \"RequiredProperties\") || [],\n\t\t\t\tnavPath,\n\t\t\t\toRet.RequiredProperties || []\n\t\t\t);\n\t\t\toRet.NonFilterableProperties = _fetchPropertiesForNavPath(\n\t\t\t\tgetFilterRestrictions(oParentFR, \"NonFilterableProperties\") || [],\n\t\t\t\tnavPath,\n\t\t\t\toRet.NonFilterableProperties || []\n\t\t\t);\n\t\t\t//SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression\n\t\t\tconst completeAllowedExps = getFilterAllowedExpression(oParentFR) || {};\n\t\t\toParentRet.FilterAllowedExpressions = Object.keys(completeAllowedExps).reduce(\n\t\t\t\t(outProp: Record<string, string[]>, propPath: string) => {\n\t\t\t\t\tif (propPath.startsWith(navPath + \"/\")) {\n\t\t\t\t\t\tconst outPropPath = propPath.replace(navPath + \"/\", \"\");\n\t\t\t\t\t\toutProp[outPropPath] = completeAllowedExps[propPath];\n\t\t\t\t\t}\n\t\t\t\t\treturn outProp;\n\t\t\t\t},\n\t\t\t\t{} as Record<string, string[]>\n\t\t\t);\n\t\t}\n\n\t\t//SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression\n\t\toRet.FilterAllowedExpressions = mergeObjects(\n\t\t\t{},\n\t\t\toRet.FilterAllowedExpressions || {},\n\t\t\toParentRet.FilterAllowedExpressions || {}\n\t\t) as Record<string, string[]>;\n\n\t\t//SECOND HIGHEST priority - Navigation restrictions\n\t\t//e.g. Parent \"/Customer\" with NavigationPropertyPath=\"Set\" ContextPath: Customer/Set\n\t\tconst oNavRestrictions = MetaModelFunction.getNavigationRestrictions(oContext, parentEntitySetPath, navPath.replaceAll(\"%2F\", \"/\"));\n\t\tconst oNavFilterRest = oNavRestrictions && (oNavRestrictions[\"FilterRestrictions\"] as MetaModelType<FilterRestrictionsType>);\n\t\tconst navResReqProps = getFilterRestrictions(oNavFilterRest, \"RequiredProperties\") || [];\n\t\toRet.RequiredProperties = uniqueSort(oRet.RequiredProperties.concat(navResReqProps));\n\t\tconst navNonFilterProps = getFilterRestrictions(oNavFilterRest, \"NonFilterableProperties\") || [];\n\t\toRet.NonFilterableProperties = uniqueSort(oRet.NonFilterableProperties.concat(navNonFilterProps));\n\t\t//SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression\n\t\toRet.FilterAllowedExpressions = mergeObjects(\n\t\t\t{},\n\t\t\toRet.FilterAllowedExpressions || {},\n\t\t\tgetFilterAllowedExpression(oNavFilterRest) || {}\n\t\t) as Record<string, string[]>;\n\n\t\t//HIGHEST priority - Restrictions having target with navigation association entity\n\t\t// e.g. FR in \"CustomerParameters/Set\" ContextPath: \"Customer/Set\"\n\t\tconst navAssociationEntityRest = oContext.getObject(\n\t\t\t`/${entityTypePathParts.join(\"/\")}${frTerm}`\n\t\t) as MetaModelType<FilterRestrictionsType>;\n\t\tconst navAssocReqProps = getFilterRestrictions(navAssociationEntityRest, \"RequiredProperties\") || [];\n\t\toRet.RequiredProperties = uniqueSort(oRet.RequiredProperties.concat(navAssocReqProps));\n\t\tconst navAssocNonFilterProps = getFilterRestrictions(navAssociationEntityRest, \"NonFilterableProperties\") || [];\n\t\toRet.NonFilterableProperties = uniqueSort(oRet.NonFilterableProperties.concat(navAssocNonFilterProps));\n\t\t//SingleValue | MultiValue | SingleRange | MultiRange | SearchExpression | MultiRangeOrSearchExpression\n\t\toRet.FilterAllowedExpressions = mergeObjects(\n\t\t\t{},\n\t\t\toRet.FilterAllowedExpressions,\n\t\t\tgetFilterAllowedExpression(navAssociationEntityRest) || {}\n\t\t) as _FilterAllowedExpressions;\n\t}\n\treturn oRet;\n}\n\nexport type PreprocessorSettings = {\n\tappComponent?: AppComponent;\n\tbindingContexts: object;\n\tmodels: object;\n};\nexport type BaseTreeModifier = {\n\ttemplateControlFragment(\n\t\tsFragmentName: string,\n\t\tmPreprocessorSettings: PreprocessorSettings,\n\t\toView?: View\n\t): Promise<UI5Element[] | Element[]>;\n\ttargets: string;\n\tgetId(vControl: UI5Element | Element): string;\n\tgetControlType(oControl: UI5Element | Element): string;\n\tgetProperty<T>(oControl: UI5Element | Element, sPropertyName: string): Promise<T>;\n\tgetAggregation(parent: UI5Element | Element, name: string): Promise<UI5Element[] | Element[]>;\n\tinsertAggregation(\n\t\tparent: UI5Element | Element,\n\t\tname: string,\n\t\tcontrol: UI5Element | Element | UI5Element[] | Element[],\n\t\tindex?: number,\n\t\tview?: Element,\n\t\tskipAdjustIndex?: boolean\n\t): Promise<void>;\n\tsetProperty(oControl: UI5Element | Element, sPropertyName: string, vValue: unknown): void;\n\tbySelector(oSelector: object, oAppComponent?: Component, oView?: Element): ManagedObject | Element;\n};\n\nasync function templateControlFragment(\n\tsFragmentName: string | Element | null,\n\toPreprocessorSettings: PreprocessorSettings,\n\toInOptions?: {\n\t\tview?: View;\n\t\tisXML?: boolean;\n\t\tid?: string;\n\t\tcontroller?: PageController | ExtensionAPI;\n\t\tcontainingView?: View;\n\t\tcontextPath?: string;\n\t},\n\toModifier?: BaseTreeModifier\n): Promise<Element | UI5Element | Element[] | UI5Element[]> {\n\tconst oOptions = oInOptions || {};\n\tif (oModifier && typeof sFragmentName === \"string\") {\n\t\treturn oModifier.templateControlFragment(sFragmentName, oPreprocessorSettings, oOptions.view).then(function (oFragment) {\n\t\t\t// This is required as Flex returns an HTMLCollection as templating result in XML time.\n\t\t\treturn oModifier.targets === \"xmlTree\" && oFragment.length > 0 ? oFragment[0] : oFragment;\n\t\t});\n\t} else {\n\t\tconst fragmentData =\n\t\t\ttypeof sFragmentName === \"string\" ? XMLTemplateProcessor.loadTemplate(sFragmentName, \"fragment\") : sFragmentName;\n\t\tconst oFragment = await XMLPreprocessor.process(fragmentData, { name: sFragmentName }, oPreprocessorSettings);\n\t\tconst oControl = oFragment.firstElementChild;\n\t\tif (!!oOptions.isXML && oControl) {\n\t\t\treturn oControl;\n\t\t}\n\t\tlet owner: { runAsOwner: <T>(fn: () => T) => T } = oPreprocessorSettings.appComponent ?? { runAsOwner: (fn) => fn() };\n\t\tif (oOptions.containingView) {\n\t\t\tconst viewOwner = Component.getOwnerComponentFor(oOptions.containingView);\n\t\t\tif (viewOwner) {\n\t\t\t\towner = viewOwner;\n\t\t\t}\n\t\t}\n\t\tlet containingView: View | undefined;\n\t\tif (oOptions.view && !oOptions.controller) {\n\t\t\t// this is overall stupid, in case we are coming from the delegate with an xml node instead of a fragment we need to pass the containingView in there (done by the oModifier call for instance)\n\t\t\t// But in other runtime case where we are here we need to maintain the controller and thus cannot have a containingView...\n\t\t\tcontainingView = oOptions.view;\n\t\t}\n\t\treturn owner.runAsOwner(async () => {\n\t\t\treturn Fragment.load({\n\t\t\t\tid: oOptions.id,\n\t\t\t\ttype: \"SCOPEDFEFRAGMENT\",\n\t\t\t\tcontextPath: oOptions.contextPath,\n\t\t\t\tdefinition: oFragment as unknown as string,\n\t\t\t\tcontroller: oOptions.controller,\n\t\t\t\tcontainingView: containingView\n\t\t\t});\n\t\t});\n\t}\n}\n\nfunction getSingletonPath(path: string, metaModel: ODataMetaModel): string | undefined {\n\tconst parts = path.split(\"/\").filter(Boolean),\n\t\tpropertyName = parts.pop()!,\n\t\tnavigationPath = parts.join(\"/\"),\n\t\tentitySet = navigationPath && metaModel.getObject(`/${navigationPath}`);\n\tif (entitySet?.$kind === \"Singleton\") {\n\t\tconst singletonName = parts[parts.length - 1];\n\t\treturn `/${singletonName}/${propertyName}`;\n\t}\n\treturn undefined;\n}\n\nasync function requestSingletonProperty(path: string, model: ODataModel): Promise<unknown> {\n\tif (!path || !model) {\n\t\treturn Promise.resolve(null);\n\t}\n\tconst metaModel = model.getMetaModel();\n\t// Find the underlying entity set from the property path and check whether it is a singleton.\n\tconst resolvedPath = getSingletonPath(path, metaModel);\n\tif (resolvedPath) {\n\t\tconst propertyBinding = model.bindProperty(resolvedPath);\n\t\treturn propertyBinding.requestValue();\n\t}\n\n\treturn Promise.resolve(null);\n}\n\n// Get the path for action parameters that is needed to read the annotations\nfunction getParameterPath(sPath: string, sParameter: string): string {\n\tlet sContext;\n\tif (sPath.includes(\"@$ui5.overload\")) {\n\t\tsContext = sPath.split(\"@$ui5.overload\")[0];\n\t} else {\n\t\t// For Unbound Actions in Action Parameter Dialogs\n\t\tconst aAction = sPath.split(\"/0\")[0].split(\".\");\n\t\tsContext = `/${aAction[aAction.length - 1]}/`;\n\t}\n\treturn sContext + sParameter;\n}\n\n/**\n * Get resolved expression binding used for texts at runtime.\n * @param expBinding\n * @param control\n * @returns A string after resolution.\n */\nfunction _fntranslatedTextFromExpBindingString(expBinding: string, control: Control): string {\n\t// The idea here is to create dummy element with the expresion binding.\n\t// Adding it as dependent to the view/control would propagate all the models to the dummy element and resolve the binding.\n\t// We remove the dummy element after that and destroy it.\n\n\tconst anyResourceText = new AnyElement({ anyText: expBinding });\n\tcontrol.addDependent(anyResourceText);\n\tconst resultText = anyResourceText.getAnyText();\n\tcontrol.removeDependent(anyResourceText);\n\tanyResourceText.destroy();\n\n\treturn resultText;\n}\n/**\n * Check if the current device has a small screen.\n * @returns A Boolean.\n */\nfunction isSmallDevice(): boolean {\n\treturn !Device.system.desktop || Device.resize.width <= 320;\n}\n\n/**\n * Parses a SelectionVariant or SelectionPresentationVariant annotation and creates the corresponding filters.\n * @param control MDC Chart, MDC Table or MultiView control on which the filters are applied\n * @param annotationPath SelectionVariant or SelectionPresentationVariant annotation\n * @returns Returns an array of filters.\n */\nfunction getFiltersFromAnnotation(control: Control | MDCChart | MDCTable, annotationPath: string): Filter[] {\n\tconst metaModel = CommonUtils.getAppComponent(control as Control).getMetaModel();\n\tconst svContext = metaModel.getMetaContext(`${control.data(\"entityType\")}${annotationPath}`);\n\tconst propertyFilters: Record<string, Filter[]> = {};\n\tlet annotation = MetaModelConverter.getInvolvedDataModelObjects(svContext).targetObject;\n\n\tif (isAnnotationOfType<SelectionPresentationVariant>(annotation, UIAnnotationTypes.SelectionPresentationVariantType)) {\n\t\tannotation = annotation.SelectionVariant;\n\t}\n\n\tif (!annotation || !isAnnotationOfType<SelectionVariantType>(annotation, UIAnnotationTypes.SelectionVariantType)) {\n\t\treturn [];\n\t}\n\n\t(annotation.SelectOptions || []).forEach((selectOption) => {\n\t\tif (selectOption.PropertyName?.$target && selectOption.Ranges?.length > 0) {\n\t\t\tconst propertyType = selectOption.PropertyName.$target.type;\n\t\t\tconst propertyPath = selectOption.PropertyName.value;\n\t\t\tfor (const j in selectOption.Ranges) {\n\t\t\t\tconst range = getRangeDefinition(selectOption.Ranges[j], propertyType);\n\t\t\t\tpropertyFilters[propertyPath] = (propertyFilters[propertyPath] ?? []).concat(\n\t\t\t\t\tnew Filter(propertyPath, range.operator as FilterOperator, range.rangeLow, range.rangeHigh)\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t});\n\n\tconst filters = [];\n\tfor (const path in propertyFilters) {\n\t\tfilters.push(\n\t\t\tnew Filter({\n\t\t\t\tfilters: propertyFilters[path],\n\t\t\t\tand: false\n\t\t\t})\n\t\t);\n\t}\n\treturn filters;\n}\n\nfunction getConverterContextForPath(\n\tsMetaPath: string,\n\toMetaModel: ODataMetaModel,\n\tsEntitySet: string,\n\toDiagnostics: Diagnostics\n): ConverterContext<PageContextPathTarget> {\n\tconst oContext = oMetaModel.createBindingContext(sMetaPath) as ODataV4Context;\n\treturn ConverterContext?.createConverterContextForMacro(sEntitySet, oContext || oMetaModel, oDiagnostics, mergeObjects);\n}\n\n/**\n * Gets the context of the DraftRoot path.\n * If a view has been created with the draft Root Path, this method returns its bindingContext.\n * Where no view is found a new created context is returned.\n * The new created context request the key of the entity in order to get the Etag of this entity.\n * @param programmingModel\n * @param view\n * @param appComponent\n * @param bindingParameters\n * @returns Returns a Promise\n */\nasync function createRootContext(\n\tprogrammingModel: string,\n\tview: View,\n\tappComponent: AppComponent,\n\tbindingParameters?: BindContextParameters\n): Promise<Context | undefined> {\n\tconst result = findOrCreateRootContext(\n\t\tview.getBindingContext() as ODataV4Context,\n\t\tprogrammingModel,\n\t\tview,\n\t\tappComponent,\n\t\tbindingParameters,\n\t\ttrue\n\t);\n\tif (result.isNew && result.rootContext !== undefined) {\n\t\tawait CommonUtils.waitForContextRequested(result.rootContext);\n\t}\n\n\treturn result.rootContext;\n}\n\n/**\n * Sync function to find or create a root context for a given context.\n * @param context\n * @param programmingModel\n * @param view\n * @param appComponent\n * @param bindingParameters\n * @param useCache\n * @returns The context and a boolean to specify if a new context was created\n */\nfunction findOrCreateRootContext(\n\tcontext: ODataV4Context | undefined | null,\n\tprogrammingModel: string,\n\tview: View,\n\tappComponent: AppComponent,\n\tbindingParameters?: BindContextParameters,\n\tuseCache = false\n): { rootContext: ODataV4Context | undefined; isNew: boolean } {\n\tif (context) {\n\t\tconst rootContextPath =\n\t\t\tprogrammingModel === \"Draft\" ? ModelHelper.getDraftRootPath(context) : ModelHelper.getStickyRootPath(context);\n\t\tlet simpleRootContext: ODataV4Context;\n\t\tif (rootContextPath) {\n\t\t\tif (context.getPath() === rootContextPath) {\n\t\t\t\treturn { rootContext: context, isNew: false };\n\t\t\t}\n\t\t\t// Check if a view matches with the draft root path, and had already loaded its context\n\t\t\tconst existingBindingContextOnPage = appComponent\n\t\t\t\t.getRootViewController()\n\t\t\t\t.getInstancedViews()\n\t\t\t\t.find(\n\t\t\t\t\t(pageView: View) =>\n\t\t\t\t\t\tpageView.getBindingContext()?.getPath() === rootContextPath &&\n\t\t\t\t\t\tpageView.getBindingContext()?.getObject() !== undefined\n\t\t\t\t)\n\t\t\t\t?.getBindingContext() as ODataV4Context;\n\t\t\tif (existingBindingContextOnPage) {\n\t\t\t\treturn { rootContext: existingBindingContextOnPage, isNew: false };\n\t\t\t}\n\t\t\tconst internalModel = view.getModel(\"internal\") as JSONModel;\n\t\t\tsimpleRootContext = internalModel.getProperty(\"/simpleRootContext\");\n\t\t\tif (useCache && simpleRootContext?.getPath() === rootContextPath) {\n\t\t\t\treturn { rootContext: simpleRootContext, isNew: false };\n\t\t\t}\n\t\t\tconst model = context.getModel();\n\t\t\tsimpleRootContext = createNewRootContext(model, rootContextPath, bindingParameters);\n\t\t\t// Store this new created context to use it on the next iterations\n\t\t\tif (useCache) {\n\t\t\t\tinternalModel.setProperty(\"/simpleRootContext\", simpleRootContext);\n\t\t\t}\n\n\t\t\treturn { rootContext: simpleRootContext, isNew: true };\n\t\t}\n\t}\n\treturn {\n\t\trootContext: undefined,\n\t\tisNew: false\n\t};\n}\n\n/**\n * Sync function to create a new root context for a given context.\n * @param model The oDataModel\n * @param rootContextPath The root context path\n * @param bindingParameters The binding parameters which can be OData query options\n * @returns The root context\n */\nfunction createNewRootContext(model: ODataModel, rootContextPath: string, bindingParameters?: BindContextParameters): ODataV4Context {\n\tconst messagesPath = ModelHelper.getMessagesPath(model.getMetaModel(), rootContextPath);\n\tconst newBindingParameters = { ...(bindingParameters ?? {}) };\n\tif (messagesPath && (!newBindingParameters.$select || newBindingParameters.$select.includes(messagesPath) === false)) {\n\t\tconst newSelect = newBindingParameters.$select?.split(\",\") ?? [];\n\t\tnewSelect.push(messagesPath);\n\t\tnewBindingParameters.$select = newSelect.join(\",\");\n\t}\n\treturn model.bindContext(rootContextPath, undefined, newBindingParameters).getBoundContext();\n}\n\n/**\n * Helper method to determine if the source is to be display for the editmode or not.\n * @param source\n * @returns If the source is to be displayed in edit mode\n */\nfunction getIsEditable(source: ManagedObject | PageController): boolean {\n\tconst managedObject = source.isA<PageController>(\"sap.fe.core.PageController\") ? source.getView() : source;\n\treturn managedObject.getBindingContext(\"ui\")?.getProperty(\"/isEditable\");\n}\n\nconst CommonUtils = {\n\tINLINEEDIT_UPDATEGROUPID: \"inline\",\n\tfireButtonPress: fnFireButtonPress,\n\tgetTargetView: getTargetView,\n\tgetCurrentPageView: getCurrentPageView,\n\thasTransientContext: fnHasTransientContexts,\n\tupdateRelatedAppsDetails: fnUpdateRelatedAppsDetails,\n\tgetAppComponent: getAppComponent,\n\tgetContextPathProperties: fnGetContextPathProperties,\n\tgetParameterInfo: getParameterInfo,\n\tupdateDataFieldForIBNButtonsVisibility: fnUpdateDataFieldForIBNButtonsVisibility,\n\tgetEntitySetName: getEntitySetName,\n\tgetActionPath: getActionPath,\n\tcomputeDisplayMode: computeDisplayMode,\n\tisStickyEditMode: isStickyEditMode,\n\tgetOperatorsForGuidProperty: getOperatorsForGuidProperty,\n\taddPageContextToSelectionVariant: addPageContextToSelectionVariant,\n\tsetUserDefaults: setUserDefaults,\n\tgetIBNActions: fnGetIBNActions,\n\tgetHeaderFacetItemConfigForExternalNavigation: getHeaderFacetItemConfigForExternalNavigation,\n\tgetSemanticObjectMapping: getSemanticObjectMapping,\n\tsetSemanticObjectMappings: setSemanticObjectMappings,\n\tgetSemanticObjectPromise: fnGetSemanticObjectPromise,\n\tgetSemanticObjectsFromPath: fnGetSemanticObjectsFromPath,\n\twaitForContextRequested: waitForContextRequested,\n\tgetFilterRestrictionsByPath: getFilterRestrictionsByPath,\n\tgetSpecificAllowedExpression: getSpecificAllowedExpression,\n\tgetAdditionalParamsForCreate: getAdditionalParamsForCreate,\n\trequestSingletonProperty: requestSingletonProperty,\n\ttemplateControlFragment: templateControlFragment,\n\tFilterRestrictions: {\n\t\tREQUIRED_PROPERTIES: \"RequiredProperties\",\n\t\tNON_FILTERABLE_PROPERTIES: \"NonFilterableProperties\",\n\t\tALLOWED_EXPRESSIONS: \"FilterAllowedExpressions\"\n\t},\n\tAllowedExpressionsPrio: [\"SingleValue\", \"MultiValue\", \"SingleRange\", \"MultiRange\", \"SearchExpression\", \"MultiRangeOrSearchExpression\"],\n\tnormalizeSearchTerm: normalizeSearchTerm,\n\tsetContextsBasedOnOperationAvailable: setContextsBasedOnOperationAvailable,\n\tsetDynamicActionContexts: setDynamicActionContexts,\n\trequestProperty: requestProperty,\n\tgetParameterPath: getParameterPath,\n\tgetRelatedAppsMenuItems: _getRelatedAppsMenuItems,\n\tgetTranslatedTextFromExpBindingString: _fntranslatedTextFromExpBindingString,\n\tupdateRelateAppsModel: updateRelateAppsModel,\n\tgetSemanticObjectAnnotations: _getSemanticObjectAnnotations,\n\tgetFiltersFromAnnotation: getFiltersFromAnnotation,\n\tcreateRootContext: createRootContext,\n\tfindOrCreateRootContext,\n\tupdateMenuButtonVisiblity: updateMenuButtonVisiblity,\n\tisSmallDevice,\n\tgetConverterContextForPath,\n\tgetIsEditable: getIsEditable\n};\n\nexport default CommonUtils;\n"],"mappings":"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","ignoreList":[]}