/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/helpers/Aggregation","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/PropertyHelper","../../templating/DataModelPathHelper","../helpers/DataFieldHelper"],function(t,e,a,n,i,o,r){"use strict";var s={};var c=r.isReferencePropertyStaticallyHidden;var l=o.getContextRelativeTargetObjectPath;var u=o.enhanceDataModelPath;var p=i.hasStaticPercentUnit;var g=i.getAssociatedUnitPropertyPath;var d=i.getAssociatedUnitProperty;var f=i.getAssociatedTimezoneProperty;var v=i.getAssociatedTextPropertyPath;var y=i.getAssociatedTextProperty;var m=i.getAssociatedExternalIdPropertyPath;var $=i.getAssociatedExternalIdProperty;var D=i.getAssociatedCurrencyPropertyPath;var T=i.getAssociatedCurrencyProperty;var b=n.getDisplayMode;var F=a.isProperty;var h=a.isPathAnnotationExpression;var P=a.isAnnotationOfType;var I=a.isAnnotationOfTerm;var U=e.AggregationHelper;var A=t.not;var x=t.getExpressionFromAnnotation;var V=t.equal;function S(t){return t.hasOwnProperty("Action")}s.isDataFieldForActionAbstract=S;function C(t){return t.$Type==="com.sap.vocabularies.UI.v1.DataFieldForActionGroup"}s.isDataFieldForActionGroup=C;function O(t){return t?.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"}s.isDataFieldForAnnotation=O;function k(t){return t?.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"}s.isDataFieldForAction=k;function N(t){return t.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"}s.isDataFieldForIntentBasedNavigation=N;function j(t){return t.hasOwnProperty("Value")}s.isDataFieldTypes=j;function z(t){return t?.hasOwnProperty("Value")}s.isDataField=z;function M(t){const e=t.Target.$target;return P(e,"com.sap.vocabularies.UI.v1.FieldGroupType")}s.hasFieldGroupTarget=M;function W(t){const e=t.Target.$target;return I(e,"com.sap.vocabularies.UI.v1.Identification")}s.hasIdentificationTarget=W;function w(t){const e=t.Target.$target;return P(e,"com.sap.vocabularies.UI.v1.DataPointType")}s.hasDataPointTarget=w;function B(t,e){return A(V(x(t?.annotations?.UI?.Hidden,[],undefined,e.getRelativeModelPathFunction()),true))}s.visibleExpression=B;function E(t){const e=t.targetObject;return G(k(e)?e:undefined)}s.isDataModelObjectPathForActionWithDialog=E;function G(t){const e=t?.ActionTarget;if(e){const t=e.annotations?.Common?.IsActionCritical;if(e.parameters.length>1||t){return"Dialog"}else{return"None"}}else{return"None"}}s.isActionWithDialog=G;function R(t){let e;if(F(t)){const a=t.annotations?.UI?.DataFieldDefault?.Target?.$target;e=a?.TargetValue??a?.MaximumValue}else{e=t.TargetValue??t.MaximumValue}if(typeof e==="number"){return e.toString()}return h(e)?e:"100"}s.getTargetValueOnDataPoint=R;const H=function(t){return t.annotations?.UI?.DataFieldDefault?.Target?.$target?.$Type==="com.sap.vocabularies.UI.v1.DataPointType"};s.isDataPointFromDataFieldDefault=H;const Q=function(t){return H(t)&&t.annotations?.UI?.DataFieldDefault?.Target?.$target?.Visualization==="UI.VisualizationType/Rating"};s.isRatingVisualizationFromDataFieldDefault=Q;const q=function(t){if(F(t)&&H(t)){t=t.annotations.UI?.DataFieldDefault}return t.Target?.$target?.Visualization==="UI.VisualizationType/Progress"};s.isAProgressTypeFromDataPoint=q;function J(t,e){if(typeof e==="object"){if(j(e)&&e.Value?.$target){const a=e.Value?.$target;if(a?.annotations?.Common?.SemanticObject!==undefined){return t.getEntitySetBasedAnnotationPath(a?.fullyQualifiedName)}}else if(F(e)){if(e?.annotations?.Common?.SemanticObject!==undefined){return t.getEntitySetBasedAnnotationPath(e?.fullyQualifiedName)}}}return undefined}s.getSemanticObjectPath=J;function K(t){if(t){return t.includes("/")?t.substring(0,t.lastIndexOf("/")+1):""}return""}function L(t,e,a,n){if(a==="AnalyticalTable"){const a=t.annotations?.UI?.Hidden;if(a?.path&&F(a.$target)){const t=e+a.path;n.additionalProperties[t]=a.$target}const i=t.Criticality;if(i?.path&&F(i?.$target)){const t=e+i.path;n.additionalProperties[t]=i?.$target}}return n}function X(t,e,a,n){if(!t.properties.hasOwnProperty(e)){t.properties[e]={annotationProperty:a};if(n){t.properties[e].displayModeOfPropertyUsedAsDescription=n}}return Object.keys(t.properties).indexOf(e)}function Y(t,e){t.exportSettings.template=t.exportSettings?.template?`${t.exportSettings.template}${e}`:`${e}`}function Z(t,e,a,n,i){let o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:{properties:{},additionalProperties:{},exportSettings:{}};let r=arguments.length>6&&arguments[6]!==undefined?arguments[6]:false;let s=arguments.length>7&&arguments[7]!==undefined?arguments[7]:false;if(t&&e){let c;const p=m(e);const g=$(e);if(s){c=X(o,t,e);Y(o,`{${c}}`);return o}const D=K(t);const F=a.getEntityType();const h=new U(F,a);const P=y(g||e);const I=v(g||e);const A=a.getConverterContextFor(a.getContextPath()).getDataModelObjectPath();const x=u(A,p||t);const V=l(x);const S=u(x,I);const C=l(S);if(o.exportSettings?.template){Y(o,"\n");o.exportSettings.wrap=true}const O=i==="AnalyticalTable"&&!!h.isPropertyGroupable(e)?!!P&&!!h.isPropertyGroupable(P):true;if(P&&C){if(O){const a=p?p:t;const n=g?g:e;const i=b(n,x);let r;switch(i){case"Description":r=X(o,C,P,"Description");Y(o,`{${r}}`);break;case"ValueDescription":c=X(o,a,n);r=X(o,C,P,"ValueDescription");Y(o,`{${c}} ({${r}})`);break;case"DescriptionValue":c=X(o,a,n);r=X(o,C,P,"DescriptionValue");Y(o,`{${r}} ({${c}})`);break;default:c=X(o,a,n);Y(o,`{${c}}`);break}}else{c=X(o,t,e);Y(o,`{${c}}`)}}else{const a=T(e);const i=d(e);const s=a??i;const l=e?.annotations?.Measures?.ISOCurrency||e?.annotations?.Measures?.Unit;const u=f(e);const p=e?.annotations?.Common?.Timezone;if(s){at(o,V??t,r,x,s,a)}else if(u&&p?.$target){et(e,o,t,r)}else if(e.Target?.$target?.$Type==="com.sap.vocabularies.UI.v1.DataPointType"&&!e.Target?.$target?.ValueFormat||e.annotations?.UI?.DataFieldDefault?.Target?.$target?.$Type==="com.sap.vocabularies.UI.v1.DataPointType"){tt(e,o,V)}else if(e.$Type==="com.sap.vocabularies.Communication.v1.ContactType"){const t=e.fn?.$target;const a=e.fn?.path;c=X(o,D?D+a:a,t);Y(o,`{${c}}`)}else if(!n){c=X(o,t,e);Y(o,`{${c}}`);if(l){o.exportSettings.unit=`${l}`;if(e?.annotations?.Measures?.ISOCurrency){o.exportSettings.isCurrency=true}}else if(p){o.exportSettings.timezone=`${p}`}}}o=L(e,D,i,o);if(Object.keys(o.additionalProperties).length>0&&V){o.exportSettings.property=[V]}if(Object.keys(o.additionalProperties).length>0&&Object.keys(o.properties).length===0){c=X(o,t,e);Y(o,`{${c}}`)}}return o}s.collectRelatedProperties=Z;function _(t){let e;if(F(t)){e=t.annotations?.UI?.DataFieldDefault?.Target?.$target}else{e=t}return e.Visualization??"UI.VisualizationType/Number"}function tt(t,e,a){if(a===undefined){return}const n=t.Target?.$target?.Value.$target;const i=t.Target?.$target;const o=K(a);const r=t.annotations?.UI?.DataFieldDefault;const s=X(e,a,r?t:n);if(_(r?t:i)==="UI.VisualizationType/Number"){return}const c=R(r?t:i);if(h(c)){if(c.$target){const t=X(e,o?o+c.$target.name:c.$target.name,c.$target);e.exportSettings.dataPointTargetValue=c.path;Y(e,`{${s}}/{${t}}`)}}else if(p(r?t:n)&&q(t)){e.exportSettings.unit="%"}else{e.exportSettings.dataPointTargetValue=c;Y(e,`{${s}}/${c}`)}}function et(t,e,a,n){const i=t.annotations.Common.Timezone;const o=K(a);const r=X(e,a,t);const s=X(e,o+i.path,i.$target);if(n){Y(e,`{${r}}  {${s}}`)}else{e.exportSettings.timezoneProperty=o+i.path}}function at(t,e,a,n,i,o){const r=n.targetObject;if(r){const s=D(r)||g(r);const c=u(n,s);const p=l(c);const d=X(t,e,r);const f=X(t,p,i);if(a){Y(t,`{${d}}  {${f}}`)}else{t.exportSettings.unitProperty=p}if(o){t.exportSettings.isCurrency=true}t.exportSettings.scale=r.scale}}function nt(t,e,a){let n=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{properties:{},additionalProperties:{},exportSettings:{}};let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:false;let o=false;switch(t?.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":if(t.Value){const r=t.Value;o=c(t);n=Z(r.path,r.$target,e,false,a,n,i,o);const s=K(r.path);n=L(t,s,a,n)}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":switch(t.Target?.$target?.$Type){case"com.sap.vocabularies.UI.v1.FieldGroupType":t.Target.$target.Data?.forEach(t=>{n=nt(t,e,a,n,true)});break;case"com.sap.vocabularies.UI.v1.DataPointType":o=c(t);n=Z(t.Target.$target.Value.path,t,e,false,a,n,i,o);break;case"com.sap.vocabularies.Communication.v1.ContactType":const r=t.Target.$target;o=c(t);n=Z(t.Target.value,r,e,o,a,n,i,o);break;default:break}break;default:break}return n}s.collectRelatedPropertiesRecursively=nt;const it=function(t){if(F(t)){return t.type}let e;switch(t.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForActionGroup":case"com.sap.vocabularies.UI.v1.DataFieldWithActionGroup":case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":e=undefined;break;case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":e=t?.Value?.$target?.type;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":default:if(t.Target?.$target?.$Type){const a=t.Target.$target;if(a.$Type==="com.sap.vocabularies.Communication.v1.ContactType"&&h(a.fn)){e=a.fn.$target?.type}else if(a.$Type==="com.sap.vocabularies.UI.v1.DataPointType"){e=a.Value?.$Path?.$Type||a.Value?.$target?.type}else{e=t.Target.$target.$Type==="com.sap.vocabularies.UI.v1.ChartDefinitionType"?undefined:"Edm.Boolean"}}else{e=undefined}break}return e};s.getDataFieldDataType=it;return s},false);
//# sourceMappingURL=DataField.js.map