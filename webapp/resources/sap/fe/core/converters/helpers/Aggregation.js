/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/helpers/TypeGuards"],function(t){"use strict";var e={};var n=t.isProperty;var r=t.isNavigationProperty;var o=t.isEntityType;var i=t.isEntitySet;let g=function(){function t(t,e){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;this._entityType=t;this._converterContext=e;this._oAggregationAnnotationTarget=this._determineAggregationAnnotationTarget();if(r(this._oAggregationAnnotationTarget)||o(this._oAggregationAnnotationTarget)||i(this._oAggregationAnnotationTarget)){this.oTargetAggregationAnnotations=this._oAggregationAnnotationTarget.annotations.Aggregation}this._bApplySupported=this.oTargetAggregationAnnotations?.ApplySupported?true:false;if(this._bApplySupported){this._aGroupableProperties=this.oTargetAggregationAnnotations?.ApplySupported?.GroupableProperties;this._aAggregatableProperties=this.oTargetAggregationAnnotations?.ApplySupported?.AggregatableProperties;this.oContainerAggregationAnnotation=e.getEntityContainer().annotations.Aggregation}if(!this._aAggregatableProperties&&n){const t=this._getEntityProperties();this._aAggregatableProperties=t?.filter(t=>t.annotations?.Aggregation?.Aggregatable)}}e.AggregationHelper=t;var g=t.prototype;g._determineAggregationAnnotationTarget=function t(){const e=this._converterContext.getDataModelObjectPath()?.startingEntitySet?.entityType?.annotations?.Common?.ResultContext?true:false;let n;if(e){const t=this._converterContext.getDataModelObjectPath();const e=t?.targetObject;const r=t?.targetEntityType;if(e?.annotations?.Aggregation?.hasOwnProperty("ApplySupported")){n=e}else if(r?.annotations?.Aggregation?.ApplySupported){n=r}}else{const t=this._converterContext.getEntitySet();if(i(t)&&t.annotations.Aggregation?.ApplySupported){n=t}else{n=this._converterContext.getEntityType()}}return n};g.isAnalyticsSupported=function t(){return this._bApplySupported};g.isPropertyGroupable=function t(e){if(!this._bApplySupported){return undefined}else if(!this._aGroupableProperties||this._aGroupableProperties.length===0){return true}else{return this._aGroupableProperties.some(t=>t.$target===e)}};g.isPropertyAggregatable=function t(e){if(!this._bApplySupported){return undefined}else{const t=this._converterContext.getAnnotationsByTerm("Aggregation","Org.OData.Aggregation.V1.CustomAggregate",[this._oAggregationAnnotationTarget]);return t.some(t=>e.name===t.qualifier)}};g.getGroupableProperties=function t(){return this._aGroupableProperties};g.getAggregatableProperties=function t(){return this._aAggregatableProperties};g.getEntityType=function t(){return this._entityType};g.getAggregatedProperties=function t(){return this._converterContext.getAnnotationsByTerm("Analytics","com.sap.vocabularies.Analytics.v1.AggregatedProperties",[this._converterContext.getEntityContainer(),this._converterContext.getEntityType()])};g.getAggregatedProperty=function t(){return this._converterContext.getAnnotationsByTerm("Analytics","com.sap.vocabularies.Analytics.v1.AggregatedProperty",[this._converterContext.getEntityContainer(),this._converterContext.getEntityType()])};g.getTransAggregations=function t(){let e=this.getAggregatedProperty();if(!e||e.length===0){e=this.getAggregatedProperties()[0]}return e?.filter(t=>{if(this._getAggregatableAggregates(t.AggregatableProperty)){return t}})};g._getAggregatableAggregates=function t(e){const r=this.getAggregatableProperties()||[];return r.find(function(t){const r=e.qualifier?e.qualifier:e.$target?.name;if(n(t)){return t?.name===r}else if(t?.Property?.value){return t.Property.value===r}})};g._getEntityProperties=function t(){let e;if(i(this._oAggregationAnnotationTarget)){e=this._oAggregationAnnotationTarget?.entityType?.entityProperties}else if(o(this._oAggregationAnnotationTarget)){e=this._oAggregationAnnotationTarget?.entityProperties}return e};g.getCustomAggregateDefinitions=function t(){const e=this._converterContext.getAnnotationsByTerm("Aggregation","Org.OData.Aggregation.V1.CustomAggregate",[this._oAggregationAnnotationTarget]);return e};g.getAllowedTransformations=function t(){return this.oTargetAggregationAnnotations?.ApplySupported?.Transformations||this.oContainerAggregationAnnotation?.ApplySupportedDefaults?.Transformations};return t}();e.AggregationHelper=g;return e},false);
//# sourceMappingURL=Aggregation.js.map