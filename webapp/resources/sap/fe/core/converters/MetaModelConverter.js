/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/common/AnnotationConverter","sap/fe/core/helpers/TypeGuards","sap/fe/core/services/EnvironmentServiceFactory","../helpers/StableIdHelper"],function(e,t,n,i,o){"use strict";var a={};var r=o.prepareId;var l=i.DefaultEnvironmentCapabilities;var s=n.isSingleton;var p=n.isServiceObject;var c=n.isNavigationProperty;var y=n.isEntityType;var f=n.isEntitySet;var u=n.isEntityContainer;var $=e.getExpressionFromAnnotation;var d=e.formatResult;var h=e.constant;function P(e,t,n,i,o){let a;if(e===null){a={type:"Null"}}else if(typeof e==="string"){a={type:"String",String:e}}else if(typeof e==="boolean"){a={type:"Bool",Bool:e}}else if(typeof e==="number"){a={type:"Int",Int:e}}else if(Array.isArray(e)){const r={type:"Collection",Collection:e.map((e,a)=>m(e,`${n}/${t}/${a}`,i,o))};if(e.length>0){if(e[0].hasOwnProperty("$PropertyPath")){r.Collection.type="PropertyPath"}else if(e[0].hasOwnProperty("$Path")){r.Collection.type="Path"}else if(e[0].hasOwnProperty("$NavigationPropertyPath")){r.Collection.type="NavigationPropertyPath"}else if(e[0].hasOwnProperty("$AnnotationPath")){r.Collection.type="AnnotationPath"}else if(e[0].hasOwnProperty("$Type")){r.Collection.type="Record"}else if(e[0].hasOwnProperty("$If")){r.Collection.type="If"}else if(e[0].hasOwnProperty("$Or")){r.Collection.type="Or"}else if(e[0].hasOwnProperty("$And")){r.Collection.type="And"}else if(e[0].hasOwnProperty("$Eq")){r.Collection.type="Eq"}else if(e[0].hasOwnProperty("$Ne")){r.Collection.type="Ne"}else if(e[0].hasOwnProperty("$Not")){r.Collection.type="Not"}else if(e[0].hasOwnProperty("$Gt")){r.Collection.type="Gt"}else if(e[0].hasOwnProperty("$Ge")){r.Collection.type="Ge"}else if(e[0].hasOwnProperty("$Lt")){r.Collection.type="Lt"}else if(e[0].hasOwnProperty("$Le")){r.Collection.type="Le"}else if(e[0].hasOwnProperty("$Apply")){r.Collection.type="Apply"}else if(typeof e[0]==="object"){r.Collection.type="Record"}else{r.Collection.type="String"}}a=r}else if(typeof e==="object"){if(e.$Path!==undefined){a={type:"Path",Path:e.$Path}}else if(e.$Decimal!==undefined){a={type:"Decimal",Decimal:parseFloat(e.$Decimal)}}else if(e.$PropertyPath!==undefined){a={type:"PropertyPath",PropertyPath:e.$PropertyPath}}else if(e.$NavigationPropertyPath!==undefined){a={type:"NavigationPropertyPath",NavigationPropertyPath:e.$NavigationPropertyPath}}else if(e.$If!==undefined){a={type:"If",$If:e.$If}}else if(e.$And!==undefined){a={type:"And",$And:e.$And}}else if(e.$Or!==undefined){a={type:"Or",$Or:e.$Or}}else if(e.$Not!==undefined){a={type:"Not",$Not:e.$Not}}else if(e.$Eq!==undefined){a={type:"Eq",$Eq:e.$Eq}}else if(e.$Ne!==undefined){a={type:"Ne",$Ne:e.$Ne}}else if(e.$Gt!==undefined){a={type:"Gt",$Gt:e.$Gt}}else if(e.$Ge!==undefined){a={type:"Ge",$Ge:e.$Ge}}else if(e.$Lt!==undefined){a={type:"Lt",$Lt:e.$Lt}}else if(e.$Le!==undefined){a={type:"Le",$Le:e.$Le}}else if(e.$Apply!==undefined){a={type:"Apply",$Apply:e.$Apply,$Function:e.$Function}}else if(e.$AnnotationPath!==undefined){a={type:"AnnotationPath",AnnotationPath:e.$AnnotationPath}}else if(e.$EnumMember!==undefined){a={type:"EnumMember",EnumMember:e.$EnumMember}}else{a={type:"Record",Record:m(e,n,i,o)}}}return{name:t,value:a}}function m(e,t,n,i){let o;if(e===null){o={type:"Null"}}else if(typeof e==="string"){o={type:"String",String:e}}else if(typeof e==="boolean"){o={type:"Bool",Bool:e}}else if(typeof e==="number"){o={type:"Int",Int:e}}else if(Array.isArray(e)){const o={collection:e.map((e,o)=>m(e,`${t}/${o}`,n,i))};if(e.length>0){if(e[0].hasOwnProperty("$PropertyPath")){o.collection.type="PropertyPath"}else if(e[0].hasOwnProperty("$Path")){o.collection.type="Path"}else if(e[0].hasOwnProperty("$NavigationPropertyPath")){o.collection.type="NavigationPropertyPath"}else if(e[0].hasOwnProperty("$AnnotationPath")){o.collection.type="AnnotationPath"}else if(e[0].hasOwnProperty("$Type")){o.collection.type="Record"}else if(e[0].hasOwnProperty("$If")){o.collection.type="If"}else if(e[0].hasOwnProperty("$And")){o.collection.type="And"}else if(e[0].hasOwnProperty("$Or")){o.collection.type="Or"}else if(e[0].hasOwnProperty("$Eq")){o.collection.type="Eq"}else if(e[0].hasOwnProperty("$Ne")){o.collection.type="Ne"}else if(e[0].hasOwnProperty("$Not")){o.collection.type="Not"}else if(e[0].hasOwnProperty("$Gt")){o.collection.type="Gt"}else if(e[0].hasOwnProperty("$Ge")){o.collection.type="Ge"}else if(e[0].hasOwnProperty("$Lt")){o.collection.type="Lt"}else if(e[0].hasOwnProperty("$Le")){o.collection.type="Le"}else if(e[0].hasOwnProperty("$Apply")){o.collection.type="Apply"}else if(typeof e[0]==="object"){o.collection.type="Record"}else{o.collection.type="String"}}}else if(typeof e==="object"){if(e.$AnnotationPath!==undefined){o={type:"AnnotationPath",AnnotationPath:e.$AnnotationPath}}else if(e.$Path!==undefined){o={type:"Path",Path:e.$Path}}else if(e.$Decimal!==undefined){o={type:"Decimal",Decimal:parseFloat(e.$Decimal)}}else if(e.$PropertyPath!==undefined){o={type:"PropertyPath",PropertyPath:e.$PropertyPath}}else if(e.$If!==undefined){o={type:"If",$If:e.$If}}else if(e.$And!==undefined){o={type:"And",$And:e.$And}}else if(e.$Or!==undefined){o={type:"Or",$Or:e.$Or}}else if(e.$Not!==undefined){o={type:"Not",$Not:e.$Not}}else if(e.$Eq!==undefined){o={type:"Eq",$Eq:e.$Eq}}else if(e.$Ne!==undefined){o={type:"Ne",$Ne:e.$Ne}}else if(e.$Gt!==undefined){o={type:"Gt",$Gt:e.$Gt}}else if(e.$Ge!==undefined){o={type:"Ge",$Ge:e.$Ge}}else if(e.$Lt!==undefined){o={type:"Lt",$Lt:e.$Lt}}else if(e.$Le!==undefined){o={type:"Le",$Le:e.$Le}}else if(e.$Apply!==undefined){o={type:"Apply",$Apply:e.$Apply,$Function:e.$Function}}else if(e.$NavigationPropertyPath!==undefined){o={type:"NavigationPropertyPath",NavigationPropertyPath:e.$NavigationPropertyPath}}else if(e.$EnumMember!==undefined){o={type:"EnumMember",EnumMember:e.$EnumMember}}else{const a={type:"Record",propertyValues:[]};if(e.$Type){a.type=e.$Type}const r=[];Object.keys(e).forEach(o=>{if(o!=="$Type"&&o!=="$If"&&o!=="$Apply"&&o!=="$And"&&o!=="$Or"&&o!=="$Ne"&&o!=="$Gt"&&o!=="$Ge"&&o!=="$Lt"&&o!=="$Le"&&o!=="$Not"&&o!=="$Eq"&&!o.startsWith("@")){r.push(P(e[o],o,t,n,i))}else if(o.startsWith("@")){A({[o]:e[o]},t,n,i)}});a.propertyValues=r;o=a}}return o}function g(e,t){if(!t.hasOwnProperty(e)){t[e]={target:e,annotations:[]}}return t[e]}function v(e){const t=e.ID??e.Target?.$AnnotationPath;return t?r(t):t}function b(e){return e.filter(e=>{const t=e;if(t.Target&&t.Target.$AnnotationPath){return!t.Target.$AnnotationPath.includes(`@${"com.sap.vocabularies.UI.v1.Chart"}`)}else{return true}})}function N(e){return e.filter(e=>e.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation")}function O(e){return e.filter(e=>e.$AnnotationPath!==`@${"com.sap.vocabularies.UI.v1.Chart"}`)}function A(e,t,n,i){if(Object.keys(e).length===0){return}const o=g(t,n);if(!i.MicroChart){delete e[`@${"com.sap.vocabularies.UI.v1.Chart"}`]}else{i.loadLibrary?.("sap.suite.ui.microchart")}for(const a in e){let r=e[a];switch(a){case`@${"com.sap.vocabularies.UI.v1.HeaderFacets"}`:if(!i.MicroChart){r=b(r);e[a]=r}break;case`@${"com.sap.vocabularies.UI.v1.Identification"}`:if(!i.IntentBasedNavigation){r=N(r);e[a]=r}break;case`@${"com.sap.vocabularies.UI.v1.LineItem"}`:if(!i.IntentBasedNavigation){r=N(r);e[a]=r}if(!i.MicroChart){r=b(r);e[a]=r}break;case`@${"com.sap.vocabularies.UI.v1.FieldGroup"}`:const t=r;if(!i.IntentBasedNavigation&&t.Data){t.Data=N(t.Data);e[a]=r}if(!i.MicroChart&&t.Data){t.Data=b(t.Data);e[a]=r}break;case`@${"com.sap.vocabularies.UI.v1.PresentationVariant"}`:const n=r;if(!i.Chart&&n.Visualizations){n.Visualizations=O(n.Visualizations);e[a]=r}break;case`@com.sap.vocabularies.Common.v1.DraftRoot`:const o=e[`@Org.OData.Capabilities.V1.FilterRestrictions`];if(o?.FilterExpressionRestrictions?.length){if(!o.FilterExpressionRestrictions.some(e=>e?.Property?.$PropertyPath.includes("DraftAdministrativeData"))){o.FilterExpressionRestrictions.push({$Type:"Org.OData.Capabilities.V1.FilterExpressionRestrictionType",AllowedExpressions:"SingleRange",Property:{$PropertyPath:"DraftAdministrativeData/CreationDateTime"},fullyQualifiedName:undefined},{$Type:"Org.OData.Capabilities.V1.FilterExpressionRestrictionType",AllowedExpressions:"SingleRange",Property:{$PropertyPath:"DraftAdministrativeData/LastChangeDateTime"},fullyQualifiedName:undefined})}}break;default:break}let l=o;let s=a;const p=a.split("@");if(p.length>2){l=g(`${t}@${p[1]}`,n);s=p[2]}else{s=p[1]}const c=s.split("#");const y=c[1];s=c[0];const f={term:s,qualifier:y};let u=`${t}@${f.term}`;if(y){u+=`#${y}`}const $=r;if($===null){f.value={type:"Null"}}else if(typeof $==="string"){f.value={type:"String",String:$}}else if(typeof $==="boolean"){f.value={type:"Bool",Bool:$}}else if(typeof $==="number"){f.value={type:"Int",Int:$}}else if(Array.isArray($)){f.collection=$.map((e,t)=>m(e,`${u}/${t}`,n,i));if($.length>0){if($[0].hasOwnProperty("$PropertyPath")){f.collection.type="PropertyPath"}else if($[0].hasOwnProperty("$Path")){f.collection.type="Path"}else if($[0].hasOwnProperty("$NavigationPropertyPath")){f.collection.type="NavigationPropertyPath"}else if($[0].hasOwnProperty("$AnnotationPath")){f.collection.type="AnnotationPath"}else if($[0].hasOwnProperty("$Type")){f.collection.type="Record"}else if($[0].hasOwnProperty("$If")){f.collection.type="If"}else if($[0].hasOwnProperty("$Or")){f.collection.type="Or"}else if($[0].hasOwnProperty("$Eq")){f.collection.type="Eq"}else if($[0].hasOwnProperty("$Ne")){f.collection.type="Ne"}else if($[0].hasOwnProperty("$Not")){f.collection.type="Not"}else if($[0].hasOwnProperty("$Gt")){f.collection.type="Gt"}else if($[0].hasOwnProperty("$Ge")){f.collection.type="Ge"}else if($[0].hasOwnProperty("$Lt")){f.collection.type="Lt"}else if($[0].hasOwnProperty("$Le")){f.collection.type="Le"}else if($[0].hasOwnProperty("$And")){f.collection.type="And"}else if($[0].hasOwnProperty("$Apply")){f.collection.type="Apply"}else if(typeof $[0]==="object"){f.collection.type="Record"}else{f.collection.type="String"}}}else if(typeof $==="object"){if($.$If!==undefined){f.value={type:"If",$If:$.$If}}else if($.$And!==undefined){f.value={type:"And",$And:$.$And}}else if($.$Or!==undefined){f.value={type:"Or",$Or:$.$Or}}else if($.$Not!==undefined){f.value={type:"Not",$Not:$.$Not}}else if($.$Eq!==undefined){f.value={type:"Eq",$Eq:$.$Eq}}else if($.$Ne!==undefined){f.value={type:"Ne",$Ne:$.$Ne}}else if($.$Gt!==undefined){f.value={type:"Gt",$Gt:$.$Gt}}else if($.$Ge!==undefined){f.value={type:"Ge",$Ge:$.$Ge}}else if($.$Lt!==undefined){f.value={type:"Lt",$Lt:$.$Lt}}else if($.$Le!==undefined){f.value={type:"Le",$Le:$.$Le}}else if($.$Apply!==undefined){f.value={type:"Apply",$Apply:$.$Apply,$Function:$.$Function}}else if($.$Path!==undefined){f.value={type:"Path",Path:$.$Path}}else if($.$AnnotationPath!==undefined){f.value={type:"AnnotationPath",AnnotationPath:$.$AnnotationPath}}else if($.$Decimal!==undefined){f.value={type:"Decimal",Decimal:parseFloat($.$Decimal)}}else if($.$EnumMember!==undefined){f.value={type:"EnumMember",EnumMember:$.$EnumMember}}else{const e={propertyValues:[]};if($.$Type){const t=$.$Type;e.type=`${t}`}const t=[];for(const e in $){if(e!=="$Type"&&!e.startsWith("@")){t.push(P($[e],e,u,n,i))}else if(e.startsWith("@")){A({[e]:$[e]},u,n,i)}}e.propertyValues=t;f.record=e}}l.annotations.push(f)}}function T(e,t,n){return{_type:"Property",name:n,fullyQualifiedName:`${t.fullyQualifiedName}/${n}`,type:e.$Type,maxLength:e.$MaxLength,precision:e.$Precision,scale:e.$Scale,nullable:e.$Nullable??true}}function I(e,t,n){let i=[];if(e.$ReferentialConstraint){i=Object.keys(e.$ReferentialConstraint).map(n=>({sourceTypeName:t.name,sourceProperty:n,targetTypeName:e.$Type,targetProperty:e.$ReferentialConstraint[n]}))}const o={_type:"NavigationProperty",name:n,fullyQualifiedName:`${t.fullyQualifiedName}/${n}`,partner:e.$Partner,isCollection:e.$isCollection?e.$isCollection:false,containsTarget:!!e.$ContainsTarget,targetTypeName:e.$Type,referentialConstraint:i};return o}function C(e,t){if(e){return Object.fromEntries(Object.entries(e).map(e=>{let[n,i]=e;return[n,`${t}/${i}`]}))}return{}}function w(e,t,n){return{_type:"EntitySet",name:t,navigationPropertyBinding:C(e.$NavigationPropertyBinding,n),entityTypeName:e.$Type,fullyQualifiedName:`${n}/${t}`}}function E(e,t,n){return{_type:"Singleton",name:t,navigationPropertyBinding:C(e.$NavigationPropertyBinding,n),entityTypeName:e.$Type,fullyQualifiedName:`${n}/${t}`,nullable:true}}function D(e,t,n){return{_type:"ActionImport",name:t,fullyQualifiedName:`${n}/${t}`,actionName:e.$kind==="ActionImport"?e.$Action:e.$Function}}function L(e,t,n){const i={_type:"TypeDefinition",name:t.substring(n.length),fullyQualifiedName:t,underlyingType:e.$UnderlyingType};return i}function k(e,t,n){const i={_type:"ComplexType",name:t.substring(n.length),fullyQualifiedName:t,properties:[],navigationProperties:[]};const o=Object.keys(e).filter(t=>{if(t!="$Key"&&t!="$kind"){return e[t].$kind==="Property"}}).sort((e,t)=>e>t?1:-1).map(t=>T(e[t],i,t));i.properties=o;const a=Object.keys(e).filter(t=>{if(t!="$Key"&&t!="$kind"){return e[t].$kind==="NavigationProperty"}}).sort((e,t)=>e>t?1:-1).map(t=>I(e[t],i,t));i.navigationProperties=a;return i}function M(e,t){if(!e.$Key&&e.$BaseType){return M(t[e.$BaseType],t)}return e.$Key??[]}function G(e,t,n,i,o){const a={_type:"EntityType",name:t.substring(n.length),fullyQualifiedName:t,keys:[],entityProperties:[],navigationProperties:[],actions:{}};for(const t in e){const n=e[t];switch(n.$kind){case"Property":const e=T(n,a,t);a.entityProperties.push(e);break;case"NavigationProperty":const i=I(n,a,t);a.navigationProperties.push(i);break}}a.keys=M(e,i).map(e=>a.entityProperties.find(t=>t.name===e)).filter(e=>e!==undefined);const r=i.$Annotations[a.fullyQualifiedName];const l=r?.[`@${"com.sap.vocabularies.UI.v1.FilterFacets"}`];l?.forEach(e=>{e.ID=v(e)});if(!!a?.keys.length&&i.$Annotations[a.fullyQualifiedName]&&!r?.[`@${"com.sap.vocabularies.UI.v1.HeaderInfo"}`]){const e={$Type:`${"com.sap.vocabularies.UI.v1.HeaderInfoType"}`,TypeName:`${a.name}`,TypeNamePlural:"",Title:{$Type:`${"com.sap.vocabularies.UI.v1.DataField"}`,Value:{$Path:`${a.keys[0].name}`}},term:"com.sap.vocabularies.UI.v1.HeaderInfo"};i.$Annotations[a.fullyQualifiedName][`@${"com.sap.vocabularies.UI.v1.HeaderInfo"}`]=e}for(const e of a.entityProperties){if(!i.$Annotations[e.fullyQualifiedName]){i.$Annotations[e.fullyQualifiedName]={}}if(!o&&!i.$Annotations[e.fullyQualifiedName][`@${"com.sap.vocabularies.UI.v1.DataFieldDefault"}`]){i.$Annotations[e.fullyQualifiedName][`@${"com.sap.vocabularies.UI.v1.DataFieldDefault"}`]={$Type:"com.sap.vocabularies.UI.v1.DataField",Value:{$Path:e.name}}}}return a}function j(e,t,n){let i;if(e.$kind==="Function"){i=e.$Parameter??[]}else{i=e.$IsBound?[e.$Parameter[0]]:[]}const o=i.map(e=>e.$isCollection?`Collection(${e.$Type})`:e.$Type).join(",");const a=`${t}(${o})`;const r=e.$Parameter??[];return{_type:"Action",name:t.substring(n.length),fullyQualifiedName:a,isBound:e.$IsBound??false,isFunction:e.$kind==="Function",sourceType:i[0]?.$Type??"",returnType:e.$ReturnType?.$Type??"",returnCollection:e.$ReturnType?.$isCollection??false,parameters:r.map(e=>({_type:"ActionParameter",fullyQualifiedName:`${a}/${e.$Name}`,isCollection:e.$isCollection??false,name:e.$Name,type:e.$Type,nullable:e.$Nullable??false,maxLength:e.$MaxLength,precision:e.$Precision,scale:e.$Scale}))}}function F(e,t,n,i){i.entityContainer={_type:"EntityContainer",name:t.substring(e.length),fullyQualifiedName:t};for(const e in n){const o=n[e];switch(o.$kind){case"EntitySet":i.entitySets.push(w(o,e,t));break;case"Singleton":i.singletons.push(E(o,e,t));break;case"FunctionImport":case"ActionImport":i.actionImports.push(D(o,e,t));break}}}function S(e,t){const n={};for(const i in e){A(e[i],i,n,t)}return Object.values(n)}function x(e,t){const n=Object.keys(e).find(t=>{const n=e[t];return!Array.isArray(n)&&n.$kind==="Schema"})??"";const i={namespace:n.slice(0,-1),entityContainer:{_type:"EntityContainer",name:"",fullyQualifiedName:""},entitySets:[],entityTypes:[],complexTypes:[],typeDefinitions:[],singletons:[],associations:[],associationSets:[],actions:[],actionImports:[],annotations:{}};const o=(o,a)=>{switch(a.$kind){case"EntityContainer":F(n,o,a,i);break;case"Action":case"Function":i.actions.push(j(a,o,n));break;case"EntityType":i.entityTypes.push(G(a,o,n,e,t));break;case"ComplexType":i.complexTypes.push(k(a,o,n));break;case"TypeDefinition":i.typeDefinitions.push(L(a,o,n));break;case"EntitySet":case"Schema":break}};for(const t in e){const n=e[t];if(Array.isArray(n)){for(const e of n){o(t,e)}}else{o(t,n)}}return i}function B(e){let n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:l;let i=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const o={identification:"metamodelResult",version:"4.0",references:[]};t.lazy(o,"schema",()=>{const o=e.getObject("/$");const a=x(o,i);t.lazy(a.annotations,"metamodelResult",()=>S(o.$Annotations,n));return a});return o}a.parseMetaModel=B;const R={};const Q={};const q=new WeakMap;const U={};function V(e,n){const i=e.id;if(!R.hasOwnProperty(i)){const o=B(e,n);try{R[i]=t.convert(o);U[i]={criticality:{fn:ne}};const n=new String(i);Q[i]=n;q.set(n,e)}catch(e){throw new Error(e)}}return R[i]}a.convertTypes=V;function _(e,t,n,i){const o=Object.keys(R).find(t=>R[t]===e)??"";if(!U[o]){U[o]={}}U[o][t]={fn:n,viewId:i}}a.registerVirtualProperty=_;function K(e){const t=Q[e];return q.get(t)}a.getMetaModelById=K;function W(e){const t=e.getModel();if(!t.isA("sap.ui.model.odata.v4.ODataMetaModel")){throw new Error("This should only be called on a ODataMetaModel")}return V(t)}a.getConvertedTypes=W;function H(e){if(e){delete R[e.id]}}a.deleteModelCacheData=H;function z(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;const n=V(e.getModel());const i=e.getPath();const o=i.split("/");let a=o[1];let r=2;if(n.entityContainer.fullyQualifiedName===a){a=o[2];r++}let l=n.entitySets.find(e=>e.name===a);if(!l){l=n.singletons.find(e=>e.name===a)}let s=o.slice(r).join("/");const p=[l];while(s&&s.length>0&&s.startsWith("$NavigationPropertyBinding")){let e=s.split("/");let t=0;let n,i;e=e.slice(1);while(!n&&e.length>t){if(e[t]!=="$NavigationPropertyBinding"){i=e.slice(0,t+1).join("/").replace("/$NavigationPropertyBinding","");n=l&&l.navigationPropertyBinding[i]}t++}if(!n){i=e[0]}const o=i?.split("/")||[];let a=l&&l.entityType;for(const e of o){const t=a&&a.navigationProperties.find(t=>t.name===e);if(t){p.push(t);a=t.targetType}else{break}}l=l&&n||l&&l.navigationPropertyBinding[e[0]];if(l){p.push(l)}e=e.slice(o.length||1);if(e.length&&e[0]==="$"){e.shift()}s=e.join("/")}if(s.startsWith("$Type")){if(s.startsWith("$Type@")){s=s.replace("$Type","")}else{s=o.slice(3).join("/")}}if(l&&s.length){const e=l.entityType.resolvePath(s,t);if(e){if(t){e.visitedObjects=p.concat(e.visitedObjects)}}else if(l.entityType&&l.entityType.actions){const e=l.entityType&&l.entityType.actions;const t=s.split("/");if(e[t[0]]){const n=e[t[0]];if(t[1]&&n.parameters){const e=t[1];return n.parameters.find(t=>t.fullyQualifiedName.endsWith(`/${e}`))}else if(s.length===1){return n}}}return e}else{if(t){return{target:l,visitedObjects:p}}return l}}a.convertMetaModelContext=z;function J(e,t){const n=V(e.getModel());const i=z(e,true);let o;if(t&&t.getPath()!=="/"){o=J(t)}return X(i,n,o)}a.getInvolvedDataModelObjects=J;function X(e,t,n){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const o=e.visitedObjects.filter(e=>p(e)&&!y(e)&&!u(e));if(p(e.target)&&!y(e.target)&&o[o.length-1]!==e.target&&!i){o.push(e.target)}const a=[];const r=o[0];let l=r;let $=r.entityType;let d;let h=[];for(let e=1;e<o.length;e++){d=o[e];if(c(d)){h.push(d.name);a.push(d);$=d.targetType;const e=l?.navigationPropertyBinding[h.join("/")];if(e!==undefined){l=e;h=[]}}if(f(d)||s(d)){l=d;$=l.entityType}}if(h.length>0){l=undefined}if(n&&n.startingEntitySet!==r){const e=o.indexOf(n.startingEntitySet);if(e!==-1){const t=o.slice(0,e);n.startingEntitySet=r;n.navigationProperties=t.filter(c).concat(n.navigationProperties)}}const P={startingEntitySet:r,targetEntitySet:l,targetEntityType:$,targetObject:e.target,navigationProperties:a,contextLocation:n,convertedTypes:t};if(!p(P.targetObject)&&i){P.targetObject=p(d)?d:undefined}if(!P.contextLocation){P.contextLocation=P}return P}a.getInvolvedDataModelObjectFromPath=X;function Y(e){const t=e?.getModel()?.getMetaModel();if(t){const n=t.getMetaPath(e?.getPath());const i=J(t.getMetaContext(n));const o=i.targetEntityType.annotations.Common?.SemanticKey;let a=[];if(o){a=o.map(e=>e.value)}const r=i.targetEntityType.keys;let l=[];if(r){l=r.map(e=>e.name)}return{semanticKeys:a,technicalKeys:l}}return{technicalKeys:[],semanticKeys:[]}}a.getInvolvedDataModelObjectEntityKeys=Y;function Z(e){if(e?.includes(">")){const[t,...n]=e.split(">");const i=n.join(">");return{id:t,path:i}}else{return{id:undefined,path:e}}}a.extractModelAndPath=Z;function ee(e,t){const n=t?.getMetaPath(e);const i=n?t?.getContext(n):undefined;return i&&J(i)}a.getInvolvedDataModelObjectsForTargetPath=ee;function te(e,t){const n="@$ui5.fe.virtual.";if(e.includes(n)){const i=Object.keys(R).find(e=>R[e]===t);if(i&&U[i]){const o=e.substring(0,e.indexOf(t.namespace));const a=e.split(n);if(a.length===2){const e=a[1];const n=a[0].replace(o,"");const r=U[i][e];if(r?.fn){return{expression:r.fn(n,t,o),viewId:r.viewId}}}}return{expression:h(undefined)}}return{expression:h(undefined)}}a.getVirtualBindingExpression=te;function ne(e,t,n){const i=t.resolvePath(e)?.target?.Criticality;const o=i?$(i,[],undefined,e=>n?`${n}${e}`:e):undefined;if(!o){return h(undefined)}return d([o],"._formatters.CriticalityFormatter#getCriticality")}return a},false);
//# sourceMappingURL=MetaModelConverter.js.map