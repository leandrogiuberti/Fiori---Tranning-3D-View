/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/controls/Common/Action","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/DataModelPathHelper","sap/ui/core/Lib","../../ManifestSettings","../../helpers/Aggregation","../../helpers/ID","../../helpers/InsightsHelpers"],function(t,e,n,a,o,i,r,s,l,g,c,p,u){"use strict";var d={};var f=u.getInsightsVisibility;var h=u.getInsightsEnablement;var y=p.getFilterBarID;var m=p.getChartID;var A=c.AggregationHelper;var b=g.VisualizationType;var P=g.VariantManagementType;var v=g.TemplateType;var T=g.ActionType;var S=s.getTargetObjectPath;var C=r.generate;var M=i.KeyHelper;var I=o.insertCustomElements;var D=o.OverrideType;var E=a.isMenuAIOperation;var F=a.isActionAIOperation;var O=a.getActionsFromManifest;var V=n.isDataFieldForActionAbstract;var w=e.not;var N=e.getExpressionFromAnnotation;var B=e.equal;var z=e.compileExpression;var $=e.and;function L(t,e,n){const a=[];if(t?.Actions){t.Actions.forEach(t=>{const e=M.generateKeyFromDataField(t);if(V(t)&&!t.Inline&&!t.Determining){switch(t.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":if(t.ActionTarget&&!t.ActionTarget.isBound){a.push({type:T.DataFieldForAction,annotationPath:n.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),key:e,visible:q(t,n),isAIOperation:F(t)===true||undefined})}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":a.push({type:T.DataFieldForIntentBasedNavigation,annotationPath:n.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),key:e,visible:q(t,n),isNavigable:true});break}}if(j(t)){a.push({type:T.Menu,text:t.Label?.toString(),visible:q(t,n),menu:t.Actions.map(t=>G(t,n)),key:M.generateKeyFromDataField(t),isAIOperation:E(t.Actions)===true||undefined})}})}return a}function j(t){return t.$Type==="com.sap.vocabularies.UI.v1.DataFieldForActionGroup"}function G(t,e){return{type:T.DataFieldForAction,annotationPath:e.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),key:M.generateKeyFromDataField(t),visible:q(t,e)}}function R(t,e,n){const a=L(t,e,n);const o=O(n.getManifestControlConfiguration(e).actions,n,a);const i={enabled:D.overwrite,enableOnSelect:D.overwrite,visible:D.overwrite,command:D.overwrite,position:D.overwrite,group:D.overwrite,priority:D.overwrite};const r=I(a,o.actions,i);return{actions:r,commandActions:o.commandActions}}d.getChartActions=R;function k(t,e){const n=e.getManifestWrapper();const a=e.getManifestControlConfiguration(t);const o=n.getVariantManagement();const i=[];const r=a?.chartSettings?.personalization;const s=o===P.Control?true:false;if(r!==undefined&&!r||r=="false"){return false}if(typeof r==="object"){if(r.type){i.push("Type")}if(r.item){i.push("Item")}if(r.sort){i.push("Sort")}if(r.filter){i.push("Filter")}return i.join(",")}else if(s||!!r){return"Sort,Type,Item,Filter"}else{return"Sort,Type,Item"}}d.getP13nMode=k;function x(t,e){const n=e.getManifestControlConfiguration(t);return{header:n.chartSettings?.header,headerVisible:n?.chartSettings?.headerVisible}}d.getHeaderInfo=x;function H(t,e){const n=e.getManifestControlConfiguration(t);return n.chartSettings?.selectionMode}d.getSelectionMode=H;function K(t){let e;if(t?.Property){e={Property:{$PropertyPath:t?.Property?.value}}}else{e={Property:{$PropertyPath:t?.name}}}return e}function Q(e,n,a,o,i){const r=new A(a.getEntityType(),a,true);if(!o&&!r.isAnalyticsSupported()){throw new Error("ApplySupported is not added to the annotations")}const s=r.getTransAggregations();const g=r.getCustomAggregateDefinitions();const c=a.getManifestWrapper();const p=c.getVariantManagement();const u=k(n,a);if(u===undefined&&p==="Control"){t.warning("Variant Management cannot be enabled when personalization is disabled")}const d={};if(g){const t=r.getEntityType();for(const e of g){const n=e?.annotations?.Aggregation?.ContextDefiningProperties;const a=e?.qualifier;const o=a&&t.entityProperties.find(t=>t.name===a);const i=o&&o?.annotations?.Common?.Label?.toString();d[a]={name:a,label:i||`Custom Aggregate (${a})`,sortable:true}}}const P={};const T=l.getResourceBundleFor("sap.fe.core");if(s){for(const t of s){P[t.Name]={name:t.Name,propertyPath:t.AggregatableProperty.value,aggregationMethod:t.AggregationMethod,label:t?.annotations?.Common?.Label?t?.annotations?.Common?.Label?.toString():`${T.getText("AGGREGATABLE_PROPERTY")} (${t.Name})`,sortable:true,custom:false}}}const M=r.getAggregatableProperties();const I=r.getGroupableProperties();const D={};D.$Type="Org.OData.Aggregation.V1.ApplySupportedType";D.AggregatableProperties=[];D.GroupableProperties=[];if(M){D.AggregatableProperties=M.map(t=>K(t))}if(I){D.GroupableProperties=I.map(t=>({["$PropertyPath"]:t.value}))}const E=R(e,n,a);let[F]=n.split("@");if(F.lastIndexOf("/")===F.length-1){F=F.substring(0,F.length-1)}const O=e.Title?.toString()||"";const V=a.getDataModelObjectPath();const w=F.length===0;const N=V.targetEntitySet?V.targetEntitySet.name:V.startingEntitySet.name;const B=w?y(a.getContextPath()):undefined;const z={plotArea:{window:{start:"firstDataPoint",end:"lastDataPoint"}},legendGroup:{layout:{position:"bottom"}},tooltip:{formatString:""}};let L;if(!B||a.getTemplateType()===v.ObjectPage){L=true}else if(a.getTemplateType()===v.ListReport||a.getTemplateType()===v.AnalyticalListPage){L=false}const j=a.getManifestWrapper().hasMultipleVisualizations()||a.getTemplateType()===v.AnalyticalListPage;const G=j?".handlers.onSegmentedButtonPressed":"";const Q=j?"{= ${pageInternal>alpContentView} !== 'Table'}":"true";const W=r.getAllowedTransformations();D.enableSearch=W?W.includes("search"):true;let q="";if(e.fullyQualifiedName.split("#").length>1){q=e.fullyQualifiedName.split("#")[1]}const J=f("Analytical",a,n);const Y=a.getParameterEntityType()?true:false;const _=$(h(),J);const{header:X,headerVisible:Z}=x(n,a);const tt=H(n,a);const et=[];e?.DimensionAttributes?.forEach(t=>{const e={};e[t?.Dimension?.value]=t?.Role;et.push(e)});const nt=[];e?.MeasureAttributes?.forEach(t=>{const e={};e[t?.Measure?.value]=t?.Role;nt.push({})});const at=!!r.getAggregatedProperties()[0]?.filter(t=>e.Measures?.some(e=>t.Name===e.value))?.length;return{type:b.Chart,id:q?m(w?N:F,q,b.Chart):m(w?N:F,b.Chart),collection:S(a.getDataModelObjectPath()),apiId:C([q?m(w?N:F,q,b.Chart):m(w?N:F,b.Chart),"Chart"]),entityName:N,personalization:k(n,a),navigationPath:F,annotationPath:a.getAbsoluteAnnotationPath(n),filterId:B,vizProperties:JSON.stringify(z),actions:E.actions,commandActions:E.commandActions,title:O,autoBindOnInit:L,onSegmentedButtonPressed:G,visible:Q,customAgg:d,transAgg:P,applySupported:D,selectionPresentationVariantPath:i,variantManagement:U(u,p),isInsightsEnabled:_,isInsightsVisible:J,isParameterizedEntitySet:Y,header:X,headerVisible:Z,selectionMode:tt,chartDimensionKeyAndRole:et,chartMeasureKeyAndRole:nt,containsAggregatedProperty:r.getAggregatedProperty().length>0,containsTransAggInMeasures:at}}d.createChartVisualization=Q;function U(t,e){return e==="Control"&&!t?P.None:e}function W(t,e,n){const a=n.fullyQualifiedName.split("#").length>1?n.fullyQualifiedName.split("#")[1]:"";const[o]=e.split("@");const i=t.getDataModelObjectPath();const r=o.length===0;const s=i.targetEntitySet?.name??i.startingEntitySet.name;const l=new A(t.getEntityType(),t,true);const g=l.getAllowedTransformations();const c=!!t.getParameterEntityType();return{annotationPath:t.getAbsoluteAnnotationPath(e),isParameterizedEntitySet:c,collection:S(t.getDataModelObjectPath()),type:b.Chart,entityName:s,id:a?m(r?s:o,a,b.Chart):m(r?s:o,b.Chart),apiId:C([a?m(r?s:o,a,b.Chart):m(r?s:o,b.Chart),"Chart"]),applySupported:{$Type:"Org.OData.Aggregation.V1.ApplySupportedType",enableSearch:g?.includes("search")??true}}}d.createChartVisualizationForTemplating=W;function q(t,e){return z(w(B(N(t.annotations?.UI?.Hidden,[],undefined,e.getRelativeModelPathFunction()),true)))}function J(t){const e=t.getManifestWrapper().hasMultipleVisualizations()||t.getTemplateType()===v.AnalyticalListPage;const n=t.getDataModelObjectPath();const a=n.targetEntitySet?n.targetEntitySet.name:n.startingEntitySet.name;const o={type:b.Chart,id:m(a,b.Chart),apiId:C([m(a,b.Chart),"Chart"]),entityName:a,title:"",collection:"",personalization:undefined,navigationPath:"",annotationPath:"",vizProperties:JSON.stringify({legendGroup:{layout:{position:"bottom"}}}),actions:[],commandActions:{},autoBindOnInit:false,onSegmentedButtonPressed:"",visible:e?"{= ${pageInternal>alpContentView} !== 'Table'}":"true",customAgg:{},transAgg:{},applySupported:{$Type:"Org.OData.Aggregation.V1.ApplySupportedType",AggregatableProperties:[],GroupableProperties:[],enableSearch:false},multiViews:false,variantManagement:P.None};return o}d.createBlankChartVisualization=J;return d},false);
//# sourceMappingURL=Chart.js.map