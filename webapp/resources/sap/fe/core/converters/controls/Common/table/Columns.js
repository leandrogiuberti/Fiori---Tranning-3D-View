/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/helpers/Aggregation","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/DataFieldHelper","sap/fe/core/converters/helpers/IssueManager","sap/fe/core/converters/helpers/Key","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/EntitySetHelper","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/formatters/TableFormatter"],function(e,t,a,n,i,o,r,s,l,c,u,p,f,d,m,g,y,v,h){"use strict";var b={};var I=v.isMultiValueField;var T=y.isTimezone;var P=y.getStaticUnitOrCurrency;var D=y.getStaticTimezone;var F=y.getAssociatedUnitPropertyPath;var S=y.getAssociatedUnitProperty;var C=y.getAssociatedTimezoneProperty;var A=y.getAssociatedTextPropertyPath;var O=y.getAssociatedTextProperty;var U=y.getAssociatedCurrencyPropertyPath;var E=y.getAssociatedCurrencyProperty;var $=g.isStaticallyMandatory;var x=g.hasFieldControlNotMandatory;var M=m.getRestrictionsOnProperties;var V=d.getDisplayMode;var N=f.getTargetObjectPath;var L=f.getContextRelativeTargetObjectPath;var w=f.getContextPropertyRestriction;var k=f.enhanceDataModelPath;var H=p.isTypeDefinition;var j=p.isProperty;var G=p.isPathAnnotationExpression;var B=p.isNavigationProperty;var R=p.isAnnotationOfType;var z=u.replaceSpecialChars;var K=l.UI;var _=s.KeyHelper;var Q=r.IssueSeverity;var W=r.IssueCategoryType;var q=r.IssueCategory;var Y=o.isReferencePropertyStaticallyHidden;var J=i.insertCustomElements;var X=i.Placement;var Z=i.OverrideType;var ee=n.AggregationHelper;var te=a.isRatingVisualizationFromDataFieldDefault;var ae=a.isDataPointFromDataFieldDefault;var ne=a.isDataFieldTypes;var ie=a.isDataFieldForAnnotation;var oe=a.isDataField;var re=a.hasFieldGroupTarget;var se=a.hasDataPointTarget;var le=a.getTargetValueOnDataPoint;var ce=a.getSemanticObjectPath;var ue=a.getDataFieldDataType;var pe=a.collectRelatedPropertiesRecursively;var fe=a.collectRelatedProperties;var de=t.TemplateType;var me=t.Importance;var ge=t.HorizontalAlign;var ye=t.CreationMode;var ve=e.setUpConstraints;var he=e.pathInModel;var be=e.or;var Ie=e.not;var Te=e.ifElse;var Pe=e.getExpressionFromAnnotation;var De=e.formatResult;var Fe=e.equal;var Se=e.constant;var Ce=e.compileExpression;var Ae=e.and;var Oe=e.EDM_TYPE_MAPPING;let Ue=function(e){e["Default"]="Default";e["Annotation"]="Annotation";e["Slot"]="Slot";e["Computed"]="Computed";return e}({});b.ColumnType=Ue;function Ee(e,t,a,n){const i=dt(e,t,a,n);const o=Tt(n.getManifestControlConfiguration(a).columns??{},i,n,n.getAnnotationEntityType(e));const r=J(i,o,{width:Z.overwrite,widthIncludingColumnHeader:Z.overwrite,importance:Z.overwrite,horizontalAlign:Z.overwrite,availability:Z.overwrite,isNavigable:Z.overwrite,settings:Z.overwrite,formatOptions:Z.overwrite,exportSettings:Z.overwrite});return Pt(r,t,a,n)}b.getTableColumns=Ee;function $e(e,t){return t.find(t=>{const a=t;return a.propertyInfos===undefined&&a.relativePath===e})}b.findColumnByPath=$e;function xe(e,t){const a=e.getConverterContextFor(e.getContextPath()).getDataModelObjectPath();t.forEach(e=>{const n=e;if(n.propertyInfos===undefined&&n.relativePath){const e=k(a,n.relativePath);const i=e.targetObject;if(i){Me(i,e,t,n);const a=C(i);const o=i?.annotations?.Common?.Timezone;if(a){const e=$e(a.name,t);n.timezone=e?.name}else if(o){n.timezoneText=o.toString()}Ve(i,e,t,n)}}})}b.updateLinkedProperties=xe;function Me(e,t,a,n){const i=U(e)||F(e);if(i){const e=k(t,i);const o=L(e);if(o){const e=$e(o,a);n.unit=e?.name}}else{const t=e?.annotations?.Measures?.ISOCurrency||e?.annotations?.Measures?.Unit;if(t){n.unitText=`${t}`}}}function Ve(e,t,a,n){const i=V(e),o=A(e);if(o&&i!=="Value"){const e=k(t,o);const r=L(e);if(r){const e=$e(r,a);if(e&&e.name!==n.name){n.textArrangement={textProperty:e.name,mode:i};if(!e.exportSettings){e.exportSettings={type:"String"}}}}}}const Ne=function(e,t,a,n,i,o,r,s){if(a===undefined){a=[]}let l=[];const c=new ee(t,n);const u=c.getGroupableProperties();if(i==="AnalyticalTable"&&c.isAnalyticsSupported()&&u){l=u.map(e=>e.$target).filter(e=>e!==undefined).map(e=>O(e)).filter(e=>e&&!c.isPropertyGroupable(e)).map(e=>e?.name).filter(e=>e!==undefined)}t.entityProperties.forEach(t=>{const u=a.some(e=>e.name===t.name);if(!t.targetType&&!u&&!l.includes(t.name)){const l=fe(t.name,t,n,true,i);const u=Object.keys(l.properties);const p=Object.keys(l.additionalProperties);u.forEach(e=>{Et(r,l,e)});const f=Le(t,n.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),t.name,true,true,c,n,r,i,s,o,l);if(u.length>0){f.propertyInfos=u;if(l.exportSettings.dataPointTargetValue){f.exportDataPointTargetValue=l.exportSettings.dataPointTargetValue}u.forEach(t=>{e[t]=l.properties[t].annotationProperty})}if(p.length>0){f.additionalPropertyInfos=p;p.forEach(t=>{e[t]=l.additionalProperties[t]})}a.push(f)}if(V(t)==="Description"){s?.nonSortableProperties.push(t.name);if(G(t?.annotations?.Common?.Text)){a.push(Le(t,n.getEntitySetBasedAnnotationPath(t.fullyQualifiedName),t.name,false,false,c,n,r,i,s,o))}}});const p=We(e,a,n,t,r,i,o,s);return a.concat(p)};b.getColumnsFromEntityType=Ne;const Le=function(e,t,a,n,i,o,r,s,l,u,p,f,d){const m=ce(r,e);const g=Y(e);const y=e.name?Xe(e.name,true,false):undefined;const v=y!=e.name;const h=Ke(e,v);const b=ue(e);const I=Ut(e,b);const T=s[a]==="Description";const P=(!g||T)&&!u?.nonSortableProperties.includes(a);const D=!u?.nonFilterableProperties.includes(a);const F=o.isAnalyticsSupported()&&l==="AnalyticalTable"?!!o.isPropertyGroupable(e):P;const S={className:e.type||b,formatOptions:I.formatOptions,constraints:I.constraints};let C=null;if(Ge(e)){C=we(e,f)}const A=!g&&i?"Adaptation":"Hidden";const O=At(a,r);if(d){a=d}const U=n?a:`Property::${a}`;const E=(n?"DataField::":"Property::")+z(a);const $={key:E,type:Ue.Annotation,dataType:b??e.type,label:h??e.name,groupLabel:v?Ke(e):undefined,group:v?y:undefined,annotationPath:t,semanticObjectPath:m,availability:A,name:U,relativePath:a,sortable:P,filterable:D,isGroupable:F,isKey:e.isKey,exportSettings:C,caseSensitive:tt(r),typeConfig:S,importance:ft(r,e.annotations?.UI?.DataFieldDefault),required:bt(r,e,p),additionalLabels:O};Ct(e,$);ut(e,$);if(o.isAnalyticsSupported()&&c.isObjectPathDraftSupported(r.getDataModelObjectPath())&&(a==="HasActiveEntity"||a==="HasDraftEntity"||a==="IsActiveEntity")){$.extension={technicallyAggregatable:false,technicallyGroupable:true}}return $};const we=function(e,t){let a,n,i,o,r,s,l,c;const u=t?Object.keys(t.properties):[];if(t&&u?.length===1){e=t.properties[u[0]].annotationProperty}const p=ue(e);if(j(e)){a=S(e);l=E(e);n=C(e);i=P(e);o=D(e);s=T(e);c=e.scale}a=t?.exportSettings?.unitProperty??a?.name??l?.name;n=t?.exportSettings?.timezoneProperty??n?.name;c=t?.exportSettings?.scale??c;const f=St(p,s,!!l,t?.exportSettings);if(n||f==="DateTime"&&!o){r=false}const d={type:f,inputFormat:ke(p),delimiter:He(p),scale:c,unitProperty:a,unit:t?.exportSettings.unit??i,timezoneProperty:n,timezone:t?.exportSettings.timezone??o?.toString(),template:t?.exportSettings.template,wrap:t?.exportSettings.wrap,utc:r,property:t?.exportSettings.property};if(d.unitProperty||d.unit){d.autoScale=true}return je(d)};const ke=function(e){return e==="Edm.Date"?"YYYY-MM-DD":undefined};const He=function(e){return e==="Edm.Int64"?true:undefined};const je=function(e){for(const t in e){if(e[t]===undefined){delete e[t]}}return e};function Ge(e){let t,a;const n=e.annotations.UI?.DataFieldDefault;if(j(e)){if(Y(e)){return false}t=n?.$Type}else if(Y(e)){return false}else{a=e;t=a.$Type;if(t==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&a.Target?.$target?.$Type){t=a.Target?.$target?.$Type;return t!==undefined&&!"com.sap.vocabularies.UI.v1.ChartDefinitionType".includes(t)}else if(a.Value?.$target?.annotations?.Core?.MediaType?.term==="Org.OData.Core.V1.MediaType"&&a.Value?.$target?.annotations?.Core?.isURL!==true){return false}}return t?!["com.sap.vocabularies.UI.v1.DataFieldForAction","com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation","com.sap.vocabularies.UI.v1.DataFieldForActionGroup"].includes(t):true}const Be=function(e){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":return!!e.Inline;case"com.sap.vocabularies.UI.v1.DataFieldWithAction":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":return true;default:return false}};const Re=function(e){const t=e.targetObject;let a;if(t){switch(t.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":case"com.sap.vocabularies.UI.v1.DataPointType":a=t.Value.$target;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(t?.Target?.$target?.$Type==="com.sap.vocabularies.UI.v1.DataPointType"){a=t.Target.$target?.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldForAction":default:a=undefined}}const n=Se(false);const i=Se(false);return Ae(...[Ie(Fe(Pe(t?.annotations?.UI?.Hidden),true)),Te(!!a,a&&Ie(Fe(Pe(a.annotations?.UI?.Hidden),true)),true),be(Ie(n),i)])};const ze=function(e){const t=[];if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&e.Target?.$target?.$Type==="com.sap.vocabularies.UI.v1.FieldGroupType"){if(e?.annotations?.UI?.Hidden){return Ce(Ie(Fe(Pe(e.annotations.UI.Hidden),true)))}else{e.Target.$target.Data?.forEach(e=>{t.push(Re({targetObject:e}))});return Ce(Te(be(...t),Se(true),Se(false)))}}else{return undefined}};const Ke=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(!e){return undefined}if(j(e)||B(e)){const t=e.annotations?.UI?.DataFieldDefault;if(t&&!t.qualifier&&t.Label){return t.Label?.toString()}return e.annotations.Common?.Label?.toString()??e.name}else if(ne(e)){if(!!t&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"){return e?.Label?.toString()}return e?.Label?.toString()??Ce(Pe(e.Value?.$target?.annotations?.Common?.Label,[],e.Value?.$target?.name))}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return e.Label?.toString()??Ce(Pe(e.Target?.$target?.Value?.$target?.annotations?.Common?.Label?.valueOf()))}else{return e.Label?.toString()}};const _e=function(e){if(!e){return undefined}if(j(e)||e.annotations?.Common?.QuickInfo){return e.annotations?.Common?.QuickInfo?Ce(Pe(e.annotations.Common.QuickInfo)):undefined}else if(ne(e)){return e.Value?.$target?.annotations?.Common?.QuickInfo?Ce(Pe(e.Value.$target.annotations.Common.QuickInfo)):undefined}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){const t=e.Target?.$target;return t?.Value?.$target?.annotations?.Common?.QuickInfo?Ce(Pe(t.Value.$target.annotations.Common.QuickInfo)):undefined}else{return undefined}};function Qe(e,t){return De([he(`semanticKeyHasDraftIndicator`,"internal"),he(`filteredMessages`,"internal"),e,t],h.getErrorStatusTextVisibilityFormatter)}b.getRowStatusVisibility=Qe;const We=function(e,t,a,n,i,o,r,s){const l=[];const c={};const u=new ee(n,a);Object.keys(e).forEach(n=>{const p=e[n],f=a.getAbsoluteAnnotationPath(n),d=t.find(e=>e.name===n);const m=a.getConverterContextFor(a.getContextPath()).getDataModelObjectPath();const g=k(m,n);if(I(g)){const e=L(g,false,true);const d=Le(p,f,n,true,false,u,a,i,o,s,r,undefined,e);$t(t,n,d);l.push(d);c[n]=e??n}else if(d===undefined){const e=Le(p,f,n,true,false,u,a,i,o,s,r);$t(t,n,e);l.push(e)}else if(d.annotationPath!==f||d.propertyInfos){const e=`Property::${n}`;if(!t.some(t=>t.name===e)){const d=Le(p,f,n,false,false,u,a,i,o,s,r);$t(t,n,d);l.push(d);c[n]=e}else if(t.some(t=>t.name===e)&&t.some(e=>e.propertyInfos?.includes(n))){c[n]=e}}});t.forEach(e=>{e.propertyInfos=e.propertyInfos?.map(e=>c[e]??e);e.additionalPropertyInfos=e.additionalPropertyInfos?.map(e=>c[e]??e)});return l};const qe=function(e){if(ne(e)&&e.Value?.path){return e.Value?.path}else if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&e.Target?.$target?.Value?.path){return e.Target?.$target?.Value.path}else{return _.generateKeyFromDataField(e)}};const Ye=function(e,t,a){const n=a.getManifestControlConfiguration(t)?.columns;const i=n&&Object.keys(n);return i&&!!i.find(function(t){return t===e&&n[t].showDataFieldsLabel})};const Je=function(e){let t="";switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":t=e?.Value?.path;break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":t=e?.Target?.value;break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldForActionGroup":case"com.sap.vocabularies.UI.v1.DataFieldWithActionGroup":t=_.generateKeyFromDataField(e);break}return t};const Xe=function(e,t,a){const n=t?e.lastIndexOf("/"):e.indexOf("/");if(n===-1){return e}return a?e.substring(n+1,e.length):e.substring(0,n)};const Ze=function(e,t){if(ne(e)&&G(e.Value)){const a=k(t.getDataModelObjectPath(),e.Value.path);return I(a)}else{return false}};const et=function(e,t,a,n){return!a.includes(t)&&((e.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation")&&Object.keys(n.properties).some(e=>{const t=Y(n.properties[e].annotationProperty);return!t&&!a.includes(e)})||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")};const tt=function(e){const t=at(e);return c.isFilteringCaseSensitive(undefined,t)};b.isFilteringCaseSensitive=tt;function at(e){const t=e.getEntitySet();if(p.isEntitySet(t)){return t.annotations.Capabilities?.FilterFunctions??e.getEntityContainer().annotations.Capabilities?.FilterFunctions}return undefined}function nt(e){return e===undefined?undefined:{textLinesEdit:4,...e}}function it(e,t){const a=[];let n=false;for(let i=0;i<e.length;i++){a.push(e[i].value);if(e[i].value===t){n=true}}return{values:a,semanticKeyFound:n}}function ot(e,t){let a=false;let n;if(e&&e.length>=1&&t&&t.length>=1){for(let i=0;i<e.length;i++){if([e[i]].some(e=>t.includes(e))){a=true;n=e[i];break}}}return{semanticKeyHasPropertyInFieldGroup:a,fieldGroupPropertyPath:n}}function rt(e,t){const a=[];let n={semanticKeyHasPropertyInFieldGroup:false,fieldGroupPropertyPath:undefined};if(e&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&e.Target?.$target?.$Type==="com.sap.vocabularies.UI.v1.FieldGroupType"){e.Target.$target.Data?.forEach(e=>{if((e.$Type==="com.sap.vocabularies.UI.v1.DataField"||e.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")&&e.Value){a.push(e.Value.path)}n=ot(t,a)})}return{semanticKeyHasPropertyInFieldGroup:n.semanticKeyHasPropertyInFieldGroup,propertyPath:n.fieldGroupPropertyPath}}function st(e,t,a){if(!t){return{}}const n=it(t,e);const i=rt(a,n.values);if(i.semanticKeyHasPropertyInFieldGroup){return{fieldGroupDraftIndicatorPropertyPath:i.propertyPath,fieldGroupName:e,showErrorObjectStatus:Ce(Qe(e,true))}}else if(n.semanticKeyFound){return{hasDraftIndicator:true,showErrorObjectStatus:Ce(Qe(e,false))}}return{}}function lt(e){const t=e?.annotations?.UI?.Importance;if(t&&t.includes("UI.ImportanceType/High")){return 3}if(t&&t.includes("UI.ImportanceType/Medium")){return 2}if(t&&t.includes("UI.ImportanceType/Low")){return 1}return 0}function ct(e){const t=e?.annotations?.UI?.Importance;return t?t.split("/")[1]:me.None}function ut(e,t){const a=le(e);if(ae(e)&&typeof a==="string"&&t.exportSettings&&t.exportSettings?.unit!=="%"){t.exportDataPointTargetValue=a;t.exportSettings.template="{0}/"+a}}function pt(e){if(e&&e.length>0){let t=-1;let a=-1;let n;for(const i of e){a=lt(i);if(a>t){t=a;n=i}}return ct(n)}return me.None}function ft(e,t){if(!t){return undefined}const a=e.getDataModelObjectPath().targetEntityType.annotations.Common?.SemanticKey??[];const n=Dt(e);const i=[...a,...n].map(e=>e.$target?.fullyQualifiedName);let o;if(R(t,"com.sap.vocabularies.UI.v1.DataFieldForAnnotation")){const e=t.Target.$target;if(R(e,"com.sap.vocabularies.UI.v1.FieldGroupType")){const a=e.Data;if(a.some(function(e){return ne(e)&&i.includes(e.Value?.$target?.fullyQualifiedName)})){return me.High}else{if(t?.annotations?.UI?.Importance){return ct(t)}o=a.filter(function(e){return e?.annotations?.UI?.Importance});return pt(o)}}}return i.includes(t.Value?.$target?.fullyQualifiedName)?me.High:ct(t)}b.getImportance=ft;const dt=function(e,t,a,n){const i=n.getAnnotationEntityType(e),o=[],r={},s={},l=M(n),c=n.getManifestControlConfiguration(a),u=n.getManifestWrapper().getSapFeManifestConfiguration()?.macros?.table?.defaultCreationMode==="InlineCreationRows"?ye.InlineCreationRows:undefined,p=c?.tableSettings?.creationMode?.name??u??ye.Inline;const f=n.getAnnotationsByTerm("Common","com.sap.vocabularies.Common.v1.SemanticKey",[n.getEntityType()])[0];if(e){const i=n.getConverterContextFor(N(n.getDataModelObjectPath()));e.forEach(e=>{if(!Be(e)){return}let c=null;const u=ne(e)&&e.Value?.$target?.fullyQualifiedName?ce(n,e):undefined;const d=Je(e);const m=pe(e,n,t);const g=Object.keys(m.properties);const y=Object.keys(m.additionalProperties);const v=d?Xe(d,true,false):undefined;const h=v!=d;const b=Ke(e,h);const I=qe(e);const T=v?v.includes(`@${"com.sap.vocabularies.UI.v1.FieldGroup"}`):false;const P=T?Ye(I,a,n):false;const D=ue(e);const F=nt(st(I,f,e));const S=k(n.getDataModelObjectPath(),d);const C=S.targetEntityType.navigationProperties;const A=C.filter(e=>!e.isCollection&&e.targetType.annotations.Common?.SAPObjectNodeType?.Name==="BusinessSituation");const O=A.length>=1?A[0]:undefined;if(O&&F){F.hasSituationsIndicator=true}let U;if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&e.Target?.$target?.$Type==="com.sap.vocabularies.UI.v1.FieldGroupType"){U=ze(e)}const E=Ze(e,i);if(!E&&Ge(e)){c=we(e,m)}let $;if(D){$=Ut(e,D)}const x={className:D,formatOptions:{...F,...$?.formatOptions},constraints:$?.constraints};const M={};if(!D||!x){M.widthCalculation=null}const V=!E&&et(e,d,l.nonSortableProperties,m);const N=Y(e)?"Hidden":"Default";const L={key:_.generateKeyFromDataField(e),type:Ue.Annotation,label:b??I,groupLabel:h?Ke(e):undefined,group:h?v:undefined,FieldGroupHiddenExpressions:U,annotationPath:n.getEntitySetBasedAnnotationPath(e.fullyQualifiedName),semanticObjectPath:u,availability:N,name:I,showDataFieldsLabel:P,required:bt(n,e,p),relativePath:d,sortable:V,propertyInfos:g.length?g:undefined,additionalPropertyInfos:y.length>0?y:undefined,exportSettings:c,width:e.annotations?.HTML5?.CssDefaults?.width?.valueOf()||undefined,importance:ft(n,e),isNavigable:true,formatOptions:F,caseSensitive:tt(n),typeConfig:x,visualSettings:M,timezoneText:c?.timezone,isPartOfLineItem:true,dataType:D??"Edm.String",isMultiValue:E};const w=_e(e)??b;if(w){L.tooltip=w}if(m.exportSettings.dataPointTargetValue){L.exportDataPointTargetValue=m.exportSettings.dataPointTargetValue}o.push(L);g.forEach(t=>{r[t]=m.properties[t].annotationProperty;if(E){l.nonSortableProperties.push(t)}Et(s,m,t);if(m.properties[t].displayModeOfPropertyUsedAsDescription==="Description"){Ot(n,S,e,r,d,l)}});y.forEach(e=>{r[e]=m.additionalProperties[e]})})}return Ne(r,i,o,n,t,p,s,l)};const mt=function(e,t,a,n){let i;if(Array.isArray(e)){i=e.map(function(e){const i=t.find(function(t){return t.relativePath===e&&t.propertyInfos===undefined});if(i){return i.name}else{const i=We({[e]:n.resolvePath(e)},t,a,n,{});t.push(i[0]);return i[0].name}})}return i};const gt=function(e,t,a){const n=t.Data;return n.some(function(t){if(oe(t)&&t?.Value?.$target.type!=="Edm.Boolean"){return $(t)||a===ye.InlineCreationRows&&Ft(t.Value.$target.fullyQualifiedName,e)}})};const yt=function(e,t,a){const n=t.Target.$target;const i=x(t);if(re(t)){if(gt(e,n,a)){return true}const t=n.Data;return t.some(t=>bt(e,t,a))}if(se(t)&&n.Visualization!=="UI.VisualizationType/Rating"){if(i){return false}if($(t)){return true}return ht(e,n,a)}return false};const vt=function(e,t,a){return t.type!=="Edm.Boolean"&&!te(t)&&($(t)||a===ye.InlineCreationRows&&Ft(t.fullyQualifiedName,e))};const ht=function(e,t,a){return $(t)||a===ye.InlineCreationRows&&Ft(t.Value.$target.fullyQualifiedName,e)};const bt=function(e,t,a){const n=a||ye.Inline;if(e.getTemplateType()===de.ListReport||e.getTemplateType()===de.AnalyticalListPage){return undefined}if(j(t)){return vt(e,t,n)?Ce(K.IsEditable):undefined}if(ie(t)){return yt(e,t,n)?Ce(K.IsEditable):undefined}if(oe(t)&&t.Value?.$target?.type!=="Edm.Boolean"){return $(t)||n===ye.InlineCreationRows&&Ft(t.Value.$target.fullyQualifiedName,e)?Ce(K.IsEditable):undefined}return undefined};const It=function(e,t){if(Array.isArray(t)){e=t}if(e){return e.map(t=>`{${e.indexOf(t)}}`).join(`${"\n"}`)}return undefined};const Tt=function(e,t,a,n){const i={};function o(e,a){return t.some(e=>e.key===a)}function r(e){return e.type===Ue.Slot}function s(e){return e.type===undefined&&!!e.template}function l(e,t){const n=M(a);e.forEach(e=>{t.forEach(t=>{if(t.name===e){t.sortable=!n.nonSortableProperties.includes(e.replace("Property::",""));t.isGroupable=t.sortable;t.filterable=!n.nonFilterableProperties.includes(e.replace("Property::",""));t.isPartOfCustomColumn=true}})})}for(const c in e){const u=e[c];_.validateKey(c);const p={key:c,widthIncludingColumnHeader:u.widthIncludingColumnHeader,width:u.width||undefined,position:{anchor:u.position?.anchor,placement:u.position===undefined?X.After:u.position.placement},caseSensitive:tt(a)};if(o(u,c)){const e={...p,importance:u?.importance,horizontalAlign:u?.horizontalAlign,availability:u?.availability,type:Ue.Annotation,isNavigable:undefined,settings:u.settings,formatOptions:nt(u.formatOptions),exportSettings:u.disableExport?null:xt(u?.exportSettings,t,a,n,undefined,c)};i[c]=e}else{const e=mt(u.properties,t,a,n);const o=a.fetchTextFromMetaModel(u.tooltip),f=a.fetchTextFromMetaModel(u.header);const d=e&&!u.disableExport?xt(u?.exportSettings,t,a,n,e):null;const m={...p,header:f,importance:u?.importance||me.None,horizontalAlign:u?.horizontalAlign||ge.Begin,availability:u?.availability||"Default",template:u.template,propertyInfos:e,exportSettings:d,id:`CustomColumn::${c}`,name:`CustomColumn::${c}`,formatOptions:{textLinesEdit:4},isGroupable:false,isNavigable:false,sortable:false,visualSettings:{widthCalculation:null},tooltip:o?o:f,properties:u.properties,required:u.required&&a.getTemplateType()!==de.ListReport&&a.getTemplateType()!==de.AnalyticalListPage?Ce(K.IsEditable):undefined};if(e){l(e,t)}if(r(u)){const e={...m,type:Ue.Slot};i[c]=e}else if(s(u)){const e={...m,type:Ue.Default};i[c]=e}else{const e=`The annotation column '${c}' referenced in the manifest is not found`;a.getDiagnostics().addIssue(q.Manifest,Q.Low,e,W,W?.AnnotationColumns?.InvalidKey)}}}return i};function Pt(e,t,a,n){if(!["GridTable","TreeTable","AnalyticalTable"].includes(t)){return e}const i=e.find(e=>e.formatOptions?.hasSituationsIndicator!==undefined&&e.formatOptions?.hasSituationsIndicator===true);if(i?.formatOptions){i.formatOptions.hasSituationsIndicator=false;const t={key:"situationsIndicator",name:"situationsIndicator",propertyKey:i.name,isSituationsIndicator:true,availability:"Default",label:"{sap.fe.i18n>C_SITUATIONS_STATUS_COLUMN_LABEL_TOOLTIP}",tooltip:"{sap.fe.i18n>C_SITUATIONS_STATUS_COLUMN_LABEL_TOOLTIP}",type:Ue.Computed,formatOptions:null,exportSettings:null,clipboardSettings:null,propertyInfos:undefined,caseSensitive:false};const a=e.findIndex(e=>e.availability!=="Hidden");e.splice(a+1,0,t)}const o=e.filter(e=>e.formatOptions?.hasDraftIndicator===true);if(o.length&&n.getTemplateType()===de.ListReport&&(c.isDraftNode(n.getEntitySet())||c.isDraftRoot(n.getEntitySet()))){o.forEach(e=>{if(e?.formatOptions){e.formatOptions.hasDraftIndicator=false}});const t={key:"draftStatus",name:"draftStatus",propertyKey:o[0].name,isDraftIndicator:true,availability:"Default",label:"{sap.fe.i18n>C_DRAFT_STATUS_COLUMN_LABEL_TOOLTIP}",tooltip:"{sap.fe.i18n>C_DRAFT_STATUS_COLUMN_LABEL_TOOLTIP}",type:Ue.Computed,formatOptions:null,exportSettings:null,caseSensitive:false,clipboardSettings:null};let a=0;if(i){a=e.findIndex(e=>e.isSituationsIndicator===true)-1}else{a=e.findIndex(e=>e.availability!=="Hidden")}e.splice(a+1,0,t)}return e}b.addComputedColumns=Pt;function Dt(e){return w(e.getDataModelObjectPath(),e=>e?.InsertRestrictions?.RequiredProperties,false)}b.getRequiredProperties=Dt;function Ft(e,t){return Dt(t).map(e=>e.$target?.fullyQualifiedName).includes(e)}function St(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let a=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let n=arguments.length>3?arguments[3]:undefined;let i="String";if(!e||n?.dataPointTargetValue){return i}if(n?.isCurrency||a){return"Currency"}if(t){return"Timezone"}if(n?.wrap){return i}switch(e){case"Edm.Decimal":case"Edm.Int32":case"Edm.Int64":case"Edm.Double":case"Edm.Byte":i="Number";break;case"Edm.DateOfTime":case"Edm.Date":i="Date";break;case"Edm.DateTimeOffset":i="DateTime";break;case"Edm.TimeOfDay":i="Time";break;case"Edm.Boolean":i="Boolean";break;default:i="String"}return i}function Ct(e,t){const a=_e(e)??t.label;if(a){t.tooltip=a}}function At(e,t){const a=k(t.getDataModelObjectPath(),e).navigationProperties;if(a?.length>0){const e=[];a.forEach(t=>{e.push(Ke(t)||t.name)});return e}}function Ot(e,t,a,n,i,o){const r=t.navigationProperties.length!==e.getDataModelObjectPath().navigationProperties.length;if(r&&oe(a)){n[i]=a.Value.$target;o.nonSortableProperties.push(i)}else if(ie(a)&&re(a)){a.Target.$target.Data.forEach(t=>{if(oe(t)&&V(t.Value.$target)==="Description"){const a=k(e.getDataModelObjectPath(),t.Value.path);const i=a.navigationProperties.length!==e.getDataModelObjectPath().navigationProperties.length;if(i){n[t.Value.path]=t.Value.$target;o.nonSortableProperties.push(t.Value.path)}}})}}function Ut(e,t){let a,n={};if(j(e)){a=H(e.targetType)?Oe[e.targetType.underlyingType]:Oe[e.type]}if(!a&&t!==undefined){a=Oe[t]}const i={type:a?.type};if(a&&j(e)){const t=ve(a,e);if(Object.keys(t).length){i.constraints=t}}if(i.type!=="sap.ui.model.odata.type.Stream"){if(i?.type?.indexOf("sap.ui.model.odata.type.Int")===0||i?.type?.indexOf("sap.ui.model.odata.type.Double")===0){n={parseAsString:false,emptyString:""}}if(i.type==="sap.ui.model.odata.type.String"&&i.constraints?.nullable===false){n={parseKeepsEmptyString:true}}}if(Object.keys(n).length){i.formatOptions=n}return i}b.getTypeConfig=Ut;function Et(e,t,a){if(t.properties[a].displayModeOfPropertyUsedAsDescription&&!e[a]){e[a]=t.properties[a].displayModeOfPropertyUsedAsDescription}}function $t(e,t,a){const n=e.filter(e=>e.propertyInfos?.includes(t)&&e.isPartOfLineItem||e.isPartOfLineItem&&e.relativePath===a.relativePath);a.isPartOfLineItem=!!n.length;if(n.length&&!n?.some(e=>e.availability!=="Hidden")){a.sortable=false;a.isGroupable=false;a.filterable=false}}function xt(e,t,a,n,i,o){let r;if(o){r=t.find(e=>e.key===o);if(r?.exportSettings===null){return r?.exportSettings}}const s=e?.wrap??(!!(e?.property&&e.property?.length>1)||!!(i&&i.length>1));const l={...r?.exportSettings,type:e?.type??r?.exportSettings?.type,template:e?.template??It(i,e?.property)??r?.exportSettings?.template,property:e?.property,width:e?.width,wrap:s,label:e?.label,textAlign:e?.textAlign,trueValue:e?.trueValue,falseValue:e?.falseValue,valueMap:e?.valueMap};return je(l)}return b},false);
//# sourceMappingURL=Columns.js.map