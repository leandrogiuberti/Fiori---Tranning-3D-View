/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/macros/formatters/TableFormatter","../../../../helpers/BindingHelper","../../../ManifestSettings","../../../helpers/InsightsHelpers"],function(e,t,n,a,i,o,s,r){"use strict";var l={};var d=r.getInsightsVisibility;var c=r.getInsightsEnablement;var u=s.TemplateType;var p=s.CreationMode;var f=s.ActionType;var b=o.singletonPathVisitor;var g=o.UI;var y=a.isPathUpdatable;var v=a.isPathInsertable;var C=a.isPathDeletable;var h=a.getTargetObjectPath;var m=a.getRelativePaths;var M=n.isSingleton;var T=n.isNavigationProperty;var E=n.isEntitySet;var x=e.pathInModel;var S=e.or;var A=e.notEqual;var U=e.not;var D=e.lessOrEqual;var I=e.length;var P=e.isPathInModelExpression;var R=e.isConstant;var w=e.ifElse;var O=e.greaterThan;var k=e.greaterOrEqual;var H=e.getExpressionFromAnnotation;var V=e.formatResult;var j=e.equal;var F=e.constant;var L=e.compileExpression;var _=e.and;const N={Cut:"StandardAction::Cut",Copy:"StandardAction::Copy",Create:"StandardAction::Create",Delete:"StandardAction::Delete",CreationRow:"StandardAction::CreationRow",Paste:"StandardAction::Paste",MassEdit:"StandardAction::MassEdit",Insights:"StandardAction::Insights",MoveUp:"StandardAction::MoveUp",MoveDown:"StandardAction::MoveDown"};l.StandardActionKeys=N;function q(e,t,n){return{collectionPath:h(e.getDataModelObjectPath()),hiddenAnnotation:{create:z(e,"CreateHidden"),delete:z(e,"DeleteHidden"),update:z(e,"UpdateHidden")},creationMode:t,isDraftOrStickySupported:W(e),newAction:$(e),tableManifestConfiguration:n,restrictions:B(e)}}l.generateStandardActionsContext=q;function W(e){const n=e.getDataModelObjectPath();const a=t.isObjectPathDraftSupported(n);const i=n.startingEntitySet?.annotations?.Session?.StickySessionSupported?true:false;return a||i}l.isDraftOrStickySupported=W;function $(e){const t=e.getEntitySet();const n=E(t)?t.annotations.Common?.DraftRoot?.NewAction??t.annotations.Session?.StickySessionSupported?.NewAction:undefined;const a=n?.toString();if(a){const t=e?.getEntityType().actions[a]?.annotations?.Core?.OperationAvailable;return{name:a,available:H(t,[],true)}}return undefined}l.getNewAction=$;function z(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const a=e.getEntitySet();const i=!M(a)&&a?.annotations.UI?.[t]||e.getEntityType().annotations.UI?.[t];if(!i){return F(false)}const o=e.getDataModelObjectPath();const s=m(o);return H(i,s,undefined,t=>b(t,e.getConvertedTypes(),s))}l.isActionAnnotatedHidden=z;function B(e){const t=e.getDataModelObjectPath();const n=[{key:"isInsertable",function:v},{key:"isUpdatable",function:y},{key:"isDeletable",function:C}];const a={};n.forEach(function(n){const i=n["function"];a[n.key]={expression:i.apply(null,[t,{pathVisitor:(t,n)=>b(t,e.getConvertedTypes(),n)}]),navigationExpression:i.apply(null,[t,{ignoreTargetCollection:true,authorizeUnresolvable:true,pathVisitor:(t,n)=>b(t,e.getConvertedTypes(),n)}])}});return a}l.getRestrictions=B;function Q(e,t){return t||e.creationMode===p.External}l.getInsertUpdateActionsTemplating=Q;function G(e,t){const n=le(e,t);return{isTemplated:L(oe(t,n)),visible:L(n),visibleExpression:n,enabled:L(fe(e,t,n)),enabledForContextMenu:L(fe(e,t,n,true)),key:N.Create,type:f.Standard}}l.getStandardActionCreate=G;function K(e,t){const n=ee(e,t);return{isTemplated:L(se(n)),visible:L(n),enabled:L(ve(n,t,false)),enabledForContextMenu:L(ve(n,t,true)),key:N.Cut,type:f.Standard}}l.getStandardActionCut=K;function J(e,t){const n=te(e,t);return{isTemplated:L(se(n)),visible:L(n),enabled:L(Ce(n,false)),enabledForContextMenu:L(Ce(n,true)),key:N.Copy,type:f.Standard}}l.getStandardActionCopy=J;function X(e,t,n){const a=e.getEntityType().annotations.Hierarchy?.[`RecursiveHierarchyActions#${t.tableManifestConfiguration.hierarchyQualifier??""}`]?.ChangeNextSiblingAction!==undefined;const i=_(ee(e,t),a);return{isTemplated:L(se(i)),visible:L(i),enabled:L(he(i,t,n)),enabledForContextMenu:L(he(i,t,n,true)),key:n?N.MoveUp:N.MoveDown,type:f.Standard}}l.getStandardActionMoveUpDown=X;function Y(e,t){const n=de(e,t);return{isTemplated:L(se(n)),visible:L(n),enabled:L(be(e,t,n,false)),enabledForContextMenu:L(be(e,t,n,true)),key:N.Delete,type:f.Standard}}l.getStandardActionDelete=Y;function Z(e,t){const n=le(e,t,true);return{isTemplated:L(oe(t,n,true)),visible:L(n),enabled:L(pe(e,t,n)),key:N.CreationRow,type:f.Standard}}l.getCreationRow=Z;function ee(e,t){const n=t.restrictions?.isUpdatable?.expression;const a=e.getTemplateType()!==u.ListReport?g.IsEditable:e.getEntitySet()?.annotations.Common?.DraftRoot!==undefined;return w(j(t.tableManifestConfiguration?.type,"TreeTable"),_(t.tableManifestConfiguration.isHierarchyParentNodeUpdatable,U(_(R(n),j(n,false))),a),false)}l.getCutVisibility=ee;function te(e,t){const n=e?.getEntityType().annotations.Hierarchy?.[`RecursiveHierarchyActions#${t.tableManifestConfiguration.hierarchyQualifier??""}`]?.CopyAction;if(!n){return F(false)}const a=e.getTemplateType()!==u.ListReport?g.IsEditable:e.getEntitySet()?.annotations.Common?.DraftRoot!==undefined;return w(j(t.tableManifestConfiguration?.type,"TreeTable"),a,false)}l.getCopyVisibility=te;function ne(e,t,n){const a=ee(e,t);const i=te(e,t);const o=le(e,t,false,true);const s=ce(e,t,o,a,i,n);const r=ge(s,t,false);const l=ge(s,t,true);return{visible:L(s),enabled:L(r),enabledForContextMenu:L(l),key:N.Paste,type:f.Standard}}l.getStandardActionPaste=ne;function ae(e,t){const n=ue(e,t);return{isTemplated:L(se(n)),visible:L(n),enabled:L(ye(e,t,n)),enabledForContextMenu:L(ye(e,t,n,true)),key:N.MassEdit,type:f.Standard}}l.getStandardActionMassEdit=ae;function ie(e,t,n){const a=d("Table",e,n,t);const i=_(a,c());return{isTemplated:L(se(a)),visible:L(a),enabled:L(i),key:N.Insights,type:f.Standard}}l.getStandardActionInsights=ie;function oe(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return _(S(_(n,e.creationMode===p.CreationRow),_(!n,e.creationMode!==p.CreationRow)),S(U(R(t)),t))}l.getCreateTemplating=oe;function se(e){return S(U(R(e)),e)}l.getDefaultTemplating=se;function re(e,t){return e.getTemplateType()!==u.ListReport&&t.tableManifestConfiguration?.type==="AnalyticalTable"}function le(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const i=t.restrictions.isInsertable.expression;const o=re(e,t)||(n?z(e,"CreateHidden",false):t.hiddenAnnotation.create);const s=t.newAction;return w(t.creationMode===p.External,_(U(o),S(e.getTemplateType()===u.ListReport,g.IsEditable)),w(S(_(R(s?.available),j(s?.available,false)),_(R(i),j(i,false),!s),_(R(o),j(o,true)),_(t.creationMode===p.InlineCreationRows,t.tableManifestConfiguration?.type==="ResponsiveTable",w(_(t?.tableManifestConfiguration?.inlineCreationRowsHiddenInEditMode===false,U(a)),true,g.IsCreateMode))),false,w(e.getTemplateType()===u.ListReport,S(U(P(o)),U(o)),_(U(o),g.IsEditable))))}l.getCreateVisibility=le;function de(e,t){const n=t.hiddenAnnotation.delete;const a=t.restrictions.isDeletable.expression;return w(e.getTemplateType()===u.AnalyticalListPage||re(e,t),false,w(_(R(a),j(a,false)),false,w(_(R(n),j(n,F(true))),false,w(e.getTemplateType()!==u.ListReport,_(U(n),g.IsEditable),U(_(P(n),n))))))}l.getDeleteVisibility=de;function ce(e,t,n,a,i,o){let s=t.restrictions?.isUpdatable?.navigationExpression;if(s?._type==="Unresolvable"){s=F(true)}return _(t.tableManifestConfiguration.type==="TreeTable"?S(a,i):_(S(_(n,t.restrictions.isInsertable.expression),_(g.IsEditable,s)),A(t.tableManifestConfiguration.enablePaste,false),![u.ListReport,u.AnalyticalListPage].includes(e.getTemplateType())),o)}l.getPasteVisibility=ce;function ue(e,t){const n=t.hiddenAnnotation.update,a=t.restrictions.isUpdatable.expression,i=t.tableManifestConfiguration?.massEdit.enabled||false;const o=e.getTemplateType()===u.ObjectPage?g.IsEditable:[u.ListReport,u.FreeStylePage].includes(e.getTemplateType());return _(U(_(R(a),j(a,false))),i,o,U(n))}l.getMassEditVisibility=ue;function pe(e,t,n){const a=v(e.getDataModelObjectPath(),{ignoreTargetCollection:true,authorizeUnresolvable:true,pathVisitor:(t,n)=>{if(t.indexOf("/")===0){t=b(t,e.getConvertedTypes(),n);return t}const a=e.getDataModelObjectPath().navigationProperties;if(a){const e=a[a.length-1];const n=T(e)&&e.partner;if(n){t=`${n}/${t}`}}return t}});const o=a._type==="Unresolvable"?v(e.getDataModelObjectPath(),{pathVisitor:t=>b(t,e.getConvertedTypes(),[])}):a;return _(n,o,S(!t.tableManifestConfiguration.disableAddRowButtonForEmptyData,V([x("creationRowFieldValidity","internal")],i.validateCreationRowFields)))}l.getCreationRowEnablement=pe;function fe(e,t,n){let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const i=[];const o=!a?"":"contextmenu/";if(t.creationMode===p.InlineCreationRows){i.push(_(U(t.hiddenAnnotation.create),g.IsEditable))}else{i.push(n)}const s=t.restrictions.isInsertable.expression;const r=e.resolveAbsolutePath(t.collectionPath).target;i.push(S(E(r),_(s,S(e.getTemplateType()!==u.ObjectPage,g.IsEditable))));if(t.tableManifestConfiguration.type==="TreeTable"){i.push(D(x(o+"numberOfSelectedContexts","internal"),1));if(t.tableManifestConfiguration.createEnablement){i.push(A(x(o+"createEnablement/Create","internal"),false))}}return _(...i)}l.getCreateEnablement=fe;function be(e,t,n){let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const i=!a?"":"contextmenu/";const o=x(i+"deletableContexts","internal");const s=x(i+"unSavedContexts","internal");const r=x(i+"draftsWithDeletableActive","internal");const l=x(i+"draftsWithNonDeletableActive","internal");return _(n,S(t.restrictions.isDeletable.navigationExpression._type==="Unresolvable",t.restrictions.isDeletable.expression),S(O(I(o,true),0),O(I(r,true),0),O(I(l,true),0),O(I(s,true),0)))}l.getDeleteEnablement=be;function ge(e,t,n){const a=!n?"nodeUpdatesInfo/pasteEnablement":"contextmenu/nodeUpdatesInfo/pasteEnablement";if(t.tableManifestConfiguration.type==="TreeTable"){return _(e,S(t.restrictions.isUpdatable.navigationExpression._type==="Unresolvable",t.restrictions.isUpdatable.expression),w(S(D(I(x("selectedContexts","internal")),1),D(I(x("contextmenu/selectedContexts","internal")),1)),j(x(a,"internal"),true),false))}let i=t.restrictions?.isUpdatable?.navigationExpression;if(i?._type==="Unresolvable"){i=F(true)}return _(i,e)}l.getPasteEnablement=ge;function ye(e,n,a){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const o=n.restrictions.isUpdatable.expression;const s=!R(o)&&n.restrictions.isUpdatable.navigationExpression._type==="Unresolvable";const r=!i?"numberOfSelectedContexts":"contextmenu/numberOfSelectedContexts";const l=!i?"updatableContexts":"contextmenu/updatableContexts";const d=k(x(r,"internal"),1);const c=k(I(x(l,"internal")),1);const u=t.isObjectPathDraftSupported(e.getDataModelObjectPath());const p=me(e);const f=w(S(_(p,u),s),_(d,c),_(d));return _(a,w(s,f,_(f,o)))}l.getMassEditEnablement=ye;function ve(e,t,n){const a=!n?"nodeUpdatesInfo/cutEnablement":"contextmenu/nodeUpdatesInfo/cutEnablement";const i=x(a,"internal");return _(e,S(t.restrictions.isUpdatable.navigationExpression._type==="Unresolvable",t.restrictions.isUpdatable.expression),i)}l.getCutEnablement=ve;function Ce(e,t){const n=!t?"nodeUpdatesInfo/copyEnablement":"contextmenu/nodeUpdatesInfo/copyEnablement";const a=x(n,"internal");return _(e,a)}l.getCopyEnablement=Ce;function he(e,t,n){let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;const i=!a?"singleContextMovableUp":"contextmenu/singleContextMovableUp";const o=!a?"singleContextMovableDown":"contextmenu/singleContextMovableDown";const s=n?j(x(i,"internal"),true):j(x(o,"internal"),true);return _(e,S(t.restrictions.isUpdatable.navigationExpression._type==="Unresolvable",t.restrictions.isUpdatable.expression),s)}function me(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;if(e.getManifestWrapper().hasInlineEdit()){return false}const n=e.getTemplateType();if(n===u.ListReport||n===u.AnalyticalListPage||t&&e.getManifestWrapper().hasMultipleVisualizations()){return true}return false}l.isInDisplayMode=me;return l},false);
//# sourceMappingURL=StandardActions.js.map