/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/formatters/FPMFormatter","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/UIFormatters"],function(e,t,n,i,o,a,r,s,l,c){"use strict";var u={};var f=c.getActionEnabledExpression;var p=l.replaceSpecialChars;var d=r.UI;var b=o.getCustomActionID;var v=i.Placement;var h=n.ActionType;var m=t.resolveBindingString;var g=t.pathInModel;var y=t.or;var A=t.not;var O=t.isConstant;var E=t.ifElse;var S=t.greaterOrEqual;var I=t.formatResult;var C=t.equal;var M=t.constant;var k=t.compileExpression;var F=t.and;let T=function(e){e["Accept"]="Accept";e["Attention"]="Attention";e["Back"]="Back";e["Critical"]="Critical";e["Default"]="Default";e["Emphasized"]="Emphasized";e["Ghost"]="Ghost";e["Negative"]="Negative";e["Neutral"]="Neutral";e["Reject"]="Reject";e["Success"]="Success";e["Transparent"]="Transparent";e["Unstyled"]="Unstyled";e["Up"]="Up";return e}({});u.ButtonType=T;const x="sap-icon://ai";u.aiIcon=x;const P="sap-icon://print";u.PRINT_ICON=P;const D="sap-icon://excel-attachment";u.EXPORT_TO_SPREADSHEET_ICON=D;const N="sap-icon://document";u.EXPORT_TO_CSV_ICON=N;const B="sap-icon://pdf-attachment";u.EXPORT_TO_PDF_ICON=B;const _=e=>{let t,n,i,o;e.forEach(e=>{t=e.visible?.valueOf()==="false";i=false;o=[];n=[];if(e.visible&&!(e.visible.valueOf()==="true"||e.visible.valueOf()==="false")){n.push(e.visible)}if(e?.menu?.length){e?.menu?.forEach(e=>{const t=e.visible;if(t&&(typeof t==="boolean"||t.valueOf()==="true")){i=true}else if(t&&t.valueOf()!=="false"){o.push(t.valueOf())}});if(t){e.visible=false.toString()}else if(!i&&!o.length){e.visible=false.toString()}else if(i&&!n.length){e.visible=true.toString()}else if(i){e.visible=k(m(e.visible))}else if(n.length||o.length){const t=o.map(e=>m(e,"boolean"));e.visible=k(F(m(e.visible||true,"boolean"),y(...t)))}else{e.visible=(!t).toString()}}});return e};u.getVisibilityEnablementMenuActions=_;function U(e){e.forEach(e=>{if(e.visible?.valueOf()==="false"){return}if(e.type==="ForAction"){e.visible=k(F(m(e.visible,"boolean"),A(C(d.hasCollaborationAuthorization,false))))}})}u.addCollaborationCondition=U;function j(e,t,n){const i=t.find(e=>e.key===n);const o=e[n];let a={...i??o};if(Object.keys(a).length===0){t.filter(e=>e.type===h.Menu).forEach(e=>{e.menu?.forEach(e=>{if(e.key===n){a=e}})})}if(i){a.enabled=o?.enabled??i.enabled;a.visible=o?.visible??i.visible;for(const e in o||{}){const t=e;if(!i[t]&&t!=="menu"){a[t]=o[t]}}}const r=a?.visible||a?.type===h.DataFieldForAction||a?.type===h.DataFieldForIntentBasedNavigation;return{action:a,canBeMenuItem:r}}function R(e,t,n,i){const{action:o,canBeMenuItem:a}=j(t,n,e.defaultAction);if(a){e.defaultAction=o}if(o.command){i[o.key]=o}}function q(e,t,n,i){const o=[];const a=n.find(t=>t.key===e.key);if(e.menu?.length!==0){for(const a of e.menu??[]){const{action:e,canBeMenuItem:r}=j(t,n,a);if(r){o.push(e)}if(e.command){i[a]=e}}}else if(a){a.menu?.forEach(e=>o.push(e))}const r=e;r.menu=o;const s=o.map(e=>m(e.visible,"boolean"));r.visible=k(F(m(e.visible,"boolean"),y(...s)))}function W(e,t){const n={};const i=[];const o={};for(const a in e){const r=e[a];if(r.defaultAction!==undefined){R(r,e,t,o)}if(r.type===h.Menu){q(r,e,t,o);if(!r.menu?.length){i.push(r.key)}}if(r.command){o[a]=r}n[a]=r}i.forEach(e=>delete n[e]);return{actions:n,commandActions:o}}const $=function(e,t,n){let i=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;if(t&&e.enabled===undefined){return undefined}const o=V(e.enabled,n,i);const a=!i?"numberOfSelectedContexts":"contextmenu/numberOfSelectedContexts";return k(E(e.requiresSelection===true,E(e.enableOnSelect==="single",F(C(g(a,"internal"),1),o),F(S(g(a,"internal"),1),o)),o))};const z=function(e,t,n){if(t&&e.visible===undefined){return undefined}const i=V(e.visible,n);return k(i)};function H(e,t){if(!t){return}e.type=t.type;e.annotationPath=t.annotationPath;e.press=t.press;e.enabled=e.enabled??t.enabled;e.visible=e.visible??t.visible}function L(e,t,n,i,o,a,r){const s={};for(const a in e){const l=e[a];const c=l.press?.lastIndexOf(".")||-1;let u;if(n){for(const e of n){if(e.id?.startsWith("CustomAction::")){continue}if(e.key===a){u=e;break}else if(e.type==="Menu"){u=e.menu?.find(e=>e.key===a);if(u){break}}}}const f=!!u;if(l.facetName){r=l.facetName}s[a]={id:u?a:b(a),type:l.menu?h.Menu:h.Default,visible:z(l,f,t),enabled:$(l,f,t),enabledForContextMenu:$(l,f,t,true),handlerModule:l.press&&l.press.substring(0,c).replace(/\./gi,"/"),handlerMethod:l.press&&l.press.substring(c+1),press:l.press,text:l.text,noWrap:l.__noWrap,key:p(a),enableOnSelect:l.enableOnSelect,defaultValuesExtensionFunction:l.defaultValuesFunction,position:{anchor:l.position?.anchor,placement:l.position===undefined?v.After:l.position.placement},isNavigable:K(l,i,o),command:l.command,requiresSelection:l.requiresSelection===undefined?false:l.requiresSelection,enableAutoScroll:Q(l),menu:l.menu??(u?.type===h.Menu?[]:undefined),facetName:l.inline?r:undefined,defaultAction:l.defaultAction,isAIOperation:l?.isAIOperation??undefined,priority:l?.priority??undefined,group:l?.group??undefined};H(s[a],u)}return W(s,n??[])}u.getActionsFromManifest=L;function V(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const i=m(e,"boolean");let o;if(O(i)&&i.value===undefined){o=M(true)}else if(O(i)&&typeof i.value==="string"){const e=i.value;o=I([g("/","$view"),e,g("selectedContexts","internal")],a.customBooleanPropertyCheck,!n?t.getDataModelObjectPath().contextLocation?.targetEntityType||t.getEntityType():undefined)}else{o=i}return o}const X=e=>{let t={};e.forEach(e=>{if(e?.menu?.length){const n=e.menu;t=n.reduce((e,t)=>{let{key:n}=t;if(n&&!e[n]){e[n]=true}return e},t)}});return e.filter(e=>!t[e.key])};u.removeDuplicateActions=X;function w(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(t?.annotations.Core?.OperationAvailable){const i=e.getDataModelObjectPath();let o=f(t,e.getConvertedTypes(),i,n);const a=s.isCollaborationDraftSupportedFromConverterContext(e)&&s.getDraftRoot(e.getEntitySet());if(a){o=F(o,A(C(d.hasCollaborationAuthorization,false)))}return o}return M(true)}u.getEnabledForAnnotationActionExpression=w;function G(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return k(w(e,t,n))}u.getEnabledForAnnotationAction=G;function J(e){return e?e.map(e=>({LocalProperty:{$PropertyPath:e.LocalProperty.value},SemanticObjectProperty:e.SemanticObjectProperty.toString()})):[]}u.getSemanticObjectMapping=J;function K(e,t,n){let i=true;if(n){const e=t&&(t.detail||t.display);i=e?.route?true:false}if(e&&e.afterExecution&&(e.afterExecution?.navigateToInstance===false||e.afterExecution?.enableAutoScroll===true)||!i){return false}return true}u.isActionNavigable=K;function Q(e){return e?.afterExecution?.enableAutoScroll===true}u.enableAutoScroll=Q;function Y(e){return e.annotations?.UI?.IsCopyAction?.valueOf()===true&&e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"}u.dataFieldIsCopyAction=Y;function Z(t){if(t.length===1){return t[0]}if(t.length>1){e.error("Multiple actions are annotated with isCopyAction. There can be only one standard copy action.")}return undefined}u.getCopyAction=Z;function ee(e){const t=[];e.forEach(e=>{if(e.type==="Menu"&&!e.id?.startsWith("CustomAction::")&&e.menu){t.push(...e.menu)}});return t}u.getAnnotationMenuActionItems=ee;function te(e,t){const n={};for(const i in t){if(i.startsWith("DataFieldForAction::")&&e.find(e=>e.key===i)){n[i]=t[i]}}return n}u.getMatchingManifestAction=te;function ne(e,t){let n;e.forEach(e=>{if(e.type===h.Menu){e.menu?.forEach((i,o)=>{n=t.find(e=>e.key===i.key);if(n){e.menu?.splice(o,1,n)}});const i=ie(e.menu);if(i){e.isAIOperation=i}}})}u.prepareMenuActions=ne;function ie(e){let t=0;e.forEach(e=>{if(e.$Type!==undefined){if(oe(e)){t++}}else if(e.type!==undefined){if(ae(e)){t++}}});if(t===e?.length)return true;return false}u.isMenuAIOperation=ie;function oe(e){if(e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"){return e.ActionTarget?.annotations.UI?.IsAIOperation?.valueOf()===true}return false}u.isActionAIOperation=oe;function ae(e){return e?.isAIOperation===true}function re(e){const t=[];const n=[];e.forEach(e=>{if(e.group!==undefined&&!n.includes(e.group)){n.push(e.group);if(n.length>1){t.push({type:h.Separator,key:"Separator::"+e.group,group:e.group,position:{anchor:e.key,placement:v.Before}})}}t.push(e)});return t}u.addSeparators=re;return u},false);
//# sourceMappingURL=Action.js.map