/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/core/converters/annotations/DataField","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","../../../helpers/StableIdHelper","../../ManifestSettings","../../helpers/ConfigurableObject","../../helpers/DataFieldHelper","../../helpers/ID","../../helpers/Key"],function(e,t,a,n,o,i,r,s,l,c,f){"use strict";var u={};var p=f.KeyHelper;var d=c.getFormStandardActionButtonID;var m=c.getFormID;var v=l.isReferencePropertyStaticallyHidden;var y=s.insertCustomElements;var g=s.Placement;var b=s.OverrideType;var O=r.ActionType;var F=i.createIdForAnnotation;var P=o.getTargetObjectPath;var h=o.getTargetEntitySetPath;var T=n.isSingleton;var A=n.isNavigationProperty;var I=a.getSemanticObjectPath;var E=t.pathInModel;var D=t.not;var C=t.ifElse;var S=t.getExpressionFromAnnotation;var $=t.equal;var N=t.compileExpression;let U=function(e){e["Default"]="Default";e["Slot"]="Slot";e["Annotation"]="Annotation";return e}({});u.FormElementType=U;function w(e,t,a){let n,o;const i={textLinesEdit:4};if(a&&a.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){n=t.getManifestWrapper();o=n.getHorizontalLayoutForFieldGroup(e.Target.value,a.Target?.value);if(o===true){i.fieldGroupHorizontalLayout=o}}return i}function M(e,t){return t?.valueOf()===false||e.annotations?.UI?.PartOfPreview===undefined||e.annotations?.UI?.PartOfPreview.valueOf()===true}function j(e,t){const a=[];const n=t.getEntityTypeAnnotation(e.Target.value);const o=n.annotation;t=n.converterContext;function i(n,o){const i=p.generateKeyFromDataField(n);const r=I(t,n);const s=t.getManifestWrapper();const l=s.getFormContainer(e.Target.value)?.fields;const c=l?.[i]?.semanticObject;if(n.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForAction"&&n.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"&&n.$Type!=="com.sap.vocabularies.UI.v1.DataFieldForActionGroup"&&!v(n)){const s={key:i,type:U.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(n.fullyQualifiedName)}/`,semanticObjectPath:r,formatOptions:w(e,t,n),isPartOfPreview:M(n,o),label:n.Label??n.Value?.$target?.annotations?.Common?.Label?.toString(),semanticObject:c};if(n.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&n.Target.$target?.$Type==="com.sap.vocabularies.UI.v1.ConnectedFieldsType"){const e=Object.values(n.Target.$target.Data).filter(e=>e?.hasOwnProperty("Value"));s.connectedFields=e.map(e=>{const a={semanticObjectPath:I(t,e)};Object.defineProperty(a,"originalObject",{get:()=>e});Object.defineProperty(a,"originalTemplate",{get:()=>{const e=n.Target?.$target;return e&&"Template"in e?e.Template:undefined}});return a})}else if(n.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&n.Target.$target?.$Type==="com.sap.vocabularies.UI.v1.FieldGroupType"){const e=Object.values(n.Target.$target.Data).filter(e=>e?.hasOwnProperty("Value"));s.fieldGroupElements=e.map(e=>({$Type:e.$Type,fullyQualifiedName:e.fullyQualifiedName,Label:e.Label}))}a.push(s)}}switch(o?.term){case"com.sap.vocabularies.UI.v1.FieldGroup":o.Data.forEach(t=>i(t,e.annotations?.UI?.PartOfPreview));break;case"com.sap.vocabularies.UI.v1.Identification":o.forEach(t=>i(t,e.annotations?.UI?.PartOfPreview));break;case"com.sap.vocabularies.UI.v1.DataPoint":a.push({key:`DataPoint::${o.qualifier?o.qualifier:""}`,type:U.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(o.fullyQualifiedName)}/`});break;case"com.sap.vocabularies.UI.v1.InputMask":a.push({key:`MaskedInput::${o.qualifier?o.qualifier:""}`,type:U.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(o.fullyQualifiedName)}/`});break;case"com.sap.vocabularies.Common.v1.Masked":a.push({key:`Masked::${o.qualifier?o.qualifier:""}`,type:U.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(o.fullyQualifiedName)}/`});break;case"com.sap.vocabularies.Communication.v1.Contact":a.push({key:`Contact::${o.qualifier?o.qualifier:""}`,type:U.Annotation,annotationPath:`${t.getEntitySetBasedAnnotationPath(o.fullyQualifiedName)}/`});break;default:break}return a}u.getFormElementsFromAnnotations=j;function k(e,t){const a=t.getManifestWrapper();const n=a.getFormContainer(e.Target.value);const o={};if(n?.fields){Object.keys(n?.fields).forEach(a=>{o[a]={key:a,id:`CustomFormElement::${a}`,type:n.fields[a].type||U.Default,template:n.fields[a].template,propertyPath:n.fields[a]?.property,label:t.fetchTextFromMetaModel(n.fields[a].label),position:n.fields[a].position||{placement:g.After},formatOptions:{...w(e,t),...n.fields[a].formatOptions},...n.fields[a].readOnly!==undefined&&{readOnly:n.fields[a].readOnly},...n.fields[a].semanticObject!==undefined&&{semanticObject:n.fields[a].semanticObject}}})}return o}u.getFormElementsFromManifest=k;function x(e,t,a,n){const o=F(e);const i=t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName);const r=t.getEntityTypeAnnotation(e.Target.value);const s=N(D($(true,S(e.annotations?.UI?.Hidden))));let l;const c=r.converterContext.getEntitySet();const f=r.converterContext.getDataModelObjectPath().targetObject;if(c&&c!==t.getEntitySet()){l=h(r.converterContext.getDataModelObjectPath())}else if(A(f)&&f?.containsTarget===true){l=P(r.converterContext.getDataModelObjectPath(),false)}else if(c&&!l&&T(c)){l=c.fullyQualifiedName}else if(!c&&A(f)&&f?.containsTarget===false){l=P(r.converterContext.getDataModelObjectPath(),false)}const u=y(j(e,t),k(e,t),{formatOptions:b.overwrite,readOnly:b.overwrite,semanticObject:b.overwrite});a=a!==undefined?a.filter(t=>t.facetName==e.fullyQualifiedName):[];if(a.length===0){a=undefined}const p={id:d(o,"ShowHideDetails"),key:"StandardAction::ShowHideDetails",text:N(C($(E("showDetails","internal"),true),E("T_COMMON_OBJECT_PAGE_HIDE_FORM_CONTAINER_DETAILS","sap.fe.i18n"),E("T_COMMON_OBJECT_PAGE_SHOW_FORM_CONTAINER_DETAILS","sap.fe.i18n"))),type:O.ShowFormDetails,press:"FormContainerRuntime.toggleDetails"};if(e.annotations?.UI?.PartOfPreview?.valueOf()!==false&&u.some(e=>e.isPartOfPreview===false)){if(a!==undefined){a.push(p)}else{a=[p]}}return{id:o,formElements:u,annotationPath:i,isVisible:s,entitySet:l,actions:a,useSingleTextAreaFieldAsNotes:n?.useSingleTextAreaFieldAsNotes,annotationHidden:e.annotations?.UI?.Hidden?true:false}}u.getFormContainer=x;function H(t,a,n,o){const i=[];const r={useSingleTextAreaFieldAsNotes:o?.useSingleTextAreaFieldAsNotes};t.Facets?.forEach(t=>{if(t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return}try{i.push(x(t,a,n,r))}catch(a){e.error(`Skipping facet ${t.fullyQualifiedName} due to error:`,a)}});return i}function _(e){return e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"}u.isReferenceFacet=_;function L(e,t,a,n,o){switch(e?.$Type){case"com.sap.vocabularies.UI.v1.CollectionFacet":return{id:m(e),useFormContainerLabels:true,hasFacetsNotPartOfPreview:e.Facets.some(e=>e.annotations?.UI?.PartOfPreview?.valueOf()===false),formContainers:H(e,a,n,o),isVisible:t};case"com.sap.vocabularies.UI.v1.ReferenceFacet":return{id:m(e),useFormContainerLabels:false,hasFacetsNotPartOfPreview:e.annotations?.UI?.PartOfPreview?.valueOf()===false,formContainers:[x(e,a,n,o)],isVisible:t};default:throw new Error("Cannot create form based on ReferenceURLFacet")}}u.createFormDefinition=L;return u},false);
//# sourceMappingURL=Form.js.map