{"version":3,"names":["SubSectionType","_exports","visualizationTerms","createSubSections","facetCollection","converterContext","isHeaderSection","useSingleTextAreaFieldAsNotes","facetsToCreate","reduce","facetDefinition","$Type","push","Facets","find","facetType","splice","length","map","facet","createSubSection","createCustomHeaderFacetSubSections","customHeaderFacets","getHeaderFacetsFromManifest","getManifestWrapper","getHeaderFacets","aCustomHeaderFacets","Object","keys","forEach","key","customHeaderFacet","templateEdit","createCustomHeaderFacetSubSection","subSectionID","getCustomSubSectionID","subSection","id","title","type","XMLFragment","template","visible","level","sideContent","undefined","stashed","flexSettings","actions","objectPageLazyLoaderEnabled","getSubSectionKey","fallback","ID","toString","Label","addFormMenuActions","reverseIndex","startsWith","hiddenActions","getFormHiddenActions","actionOverwriteConfig","enabled","OverrideType","overwrite","command","position","menu","priority","group","formActions","getFormActions","manifestActions","getActionsFromManifest","annotationMenuActionItems","getAnnotationMenuActionItems","matchingManifestActions","getMatchingManifestAction","overwrittenMenuActionItems","insertCustomElements","manifestAction","formAllActions","prepareMenuActions","removeDuplicateActions","getVisibilityEnablementMenuActions","ActionUtilities","ensurePrimaryActionNeverOverflows","action","ActionType","Menu","defaultAction","Default","commandActions","getFacetActions","filter","subFacetDefinition","isReferenceFacet","actionReducer","referenceFacet","createFormActionReducer","getButtonType","emphasized","buttonTypeCondition","equal","getExpressionFromAnnotation","compileExpression","ifElse","ButtonType","Ghost","Transparent","hasSingleContent","getSubSectionID","hiddenAnnotation","annotations","UI","Hidden","isVisibleExpression","not","path","singletonPathVisitor","getConvertedTypes","isVisibilityDynamic","isConstant","isPathAnnotationExpression","Unknown","annotationPath","getEntitySetBasedAnnotationPath","fullyQualifiedName","getEnableLazyLoading","getStashedSettingsForHeaderFacet","designtime","getDesignTimeMetadataSettingsForHeaderFacet","unsupportedText","facets","visualizationFacets","index","_ref","Target","$target","includes","term","nonVisualizationFacets","visualization","visualizationContent","formContent","mixedContent","Log","warning","fakeFormFacet","_ref2","mixedSubSection","Mixed","content","facetActions","formCollectionSubSection","Form","formDefinition","createFormDefinition","facetName","value","presentation","getDataVisualizationConfiguration","isCondensedTableLayoutCompliant","getCondensedTableLayoutCompliance","doNotCheckApplySupported","shouldCreateTemplateChartVisualization","subSectionTitle","controlTitle","visualizations","annotation","isPartOfPreview","PartOfPreview","valueOf","showSubSectionTitle","getShowSubSectionTitle","dataVisualizationTitleVisible","and","dataVisualizationSubSection","DataVisualization","formElementSubSection","Notes","unsupportedSubSection","text","or","notEqual","resolveBindingString","referenceTarget","targetValue","dataFieldCollection","navigationPropertyPath","split","lastIndexOf","substring","Data","getManifestControlConfiguration","qualifier","dataField","RequiresContext","getDiagnostics","addIssue","IssueCategory","Annotation","IssueSeverity","Low","IssueType","MALFORMED_DATAFIELD_FOR_IBN","REQUIRESCONTEXT","Inline","INLINE","Determining","DETERMINING","mNavigationParameters","Mapping","semanticObjectMapping","getSemanticObjectMapping","DataFieldForIntentBasedNavigation","getFormID","KeyHelper","generateKeyFromDataField","NavigationAvailable","buttonType","Emphasized","press","fn","SemanticObject","Action","customData","semanticObject","formManifestActionsConfiguration","getDataFieldAnnotationAction","isAIOperation","isMenuAIOperation","Actions","formManifestMenuActionsConfiguration","DataFieldForAction","getEnabledForAnnotationAction","ActionTarget","binding","requiresDialog","isActionWithDialog","isActionAIOperation","contexts","pathInModel","invocationGrouping","InvocationGrouping","label","model","isNavigable","isActionNavigable","ref","isDialog","actionDefinition","bCritical","Common","IsActionCritical","parameters","createCustomSubSections","manifestSubSections","subSections","subSectionKey","createCustomSubSection","manifestSubSection","getSideContentID","equalSplit","placement","Placement","After","isVisible","isDynamicExpression","indexOf","values","previousAction","currentAction","subSectionDefinition","enableLazyLoading","componentName","settings","applyState","retrieveState","name","embeddedComponent","EmbeddedComponent","JSON","stringify","Placeholder","currentFacet","facetsToCreateInSection","manifestWrapper","useIconTabBar","hasNoOtherVisibleTableInTargets","entityType","getEntityType","every","subFacet","refFacet","subCollectionFacet","subRefFacet"],"sourceRoot":".","sources":["SubSection.ts"],"sourcesContent":["import type { Action } from \"@sap-ux/vocabularies-types/Edm\";\nimport { CommunicationAnnotationTerms } from \"@sap-ux/vocabularies-types/vocabularies/Communication\";\nimport type {\n\tCollectionFacet,\n\tCollectionFacetTypes,\n\tDataFieldAbstractTypes,\n\tDataFieldForActionTypes,\n\tEmphasized,\n\tFacetTypes,\n\tFieldGroup,\n\tOperationGroupingType,\n\tReferenceFacetTypes\n} from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport { UIAnnotationTerms, UIAnnotationTypes } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport Log from \"sap/base/Log\";\nimport type { BindingToolkitExpression, CompiledBindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport {\n\tand,\n\tcompileExpression,\n\tequal,\n\tfn,\n\tgetExpressionFromAnnotation,\n\tifElse,\n\tisConstant,\n\tnot,\n\tnotEqual,\n\tor,\n\tpathInModel,\n\tref,\n\tresolveBindingString\n} from \"sap/fe/base/BindingToolkit\";\nimport type { NavigationParameters } from \"sap/fe/core/controllerextensions/InternalIntentBasedNavigation\";\nimport type { PageContextPathTarget } from \"sap/fe/core/converters/TemplateConverter\";\nimport type {\n\tAnnotationAction,\n\tBaseAction,\n\tCombinedAction,\n\tCustomAction,\n\tOverrideTypeAction\n} from \"sap/fe/core/converters/controls/Common/Action\";\nimport {\n\tButtonType,\n\tgetActionsFromManifest,\n\tgetAnnotationMenuActionItems,\n\tgetEnabledForAnnotationAction,\n\tgetMatchingManifestAction,\n\tgetSemanticObjectMapping,\n\tgetVisibilityEnablementMenuActions,\n\tisActionAIOperation,\n\tisActionNavigable,\n\tisMenuAIOperation,\n\tprepareMenuActions,\n\tremoveDuplicateActions\n} from \"sap/fe/core/converters/controls/Common/Action\";\nimport type { ChartVisualization } from \"sap/fe/core/converters/controls/Common/Chart\";\nimport type { TableVisualization } from \"sap/fe/core/converters/controls/Common/Table\";\nimport type { CustomObjectPageHeaderFacet, FlexSettings } from \"sap/fe/core/converters/controls/ObjectPage/HeaderFacet\";\nimport {\n\tgetDesignTimeMetadataSettingsForHeaderFacet,\n\tgetHeaderFacetsFromManifest,\n\tgetStashedSettingsForHeaderFacet\n} from \"sap/fe/core/converters/controls/ObjectPage/HeaderFacet\";\nimport { IssueCategory, IssueSeverity, IssueType } from \"sap/fe/core/converters/helpers/IssueManager\";\nimport { KeyHelper } from \"sap/fe/core/converters/helpers/Key\";\nimport ActionUtilities from \"sap/fe/core/helpers/ActionUtilities\";\nimport { singletonPathVisitor } from \"sap/fe/core/helpers/BindingHelper\";\nimport { isPathAnnotationExpression } from \"sap/fe/core/helpers/TypeGuards\";\nimport type ConverterContext from \"../../ConverterContext\";\nimport type { FormManifestConfiguration, ManifestAction, ManifestSubSection } from \"../../ManifestSettings\";\nimport { ActionType } from \"../../ManifestSettings\";\nimport { isActionWithDialog } from \"../../annotations/DataField\";\nimport type { ConfigurableObject, ConfigurableRecord, CustomElement } from \"../../helpers/ConfigurableObject\";\nimport { OverrideType, Placement, insertCustomElements } from \"../../helpers/ConfigurableObject\";\nimport { getCustomSubSectionID, getFormID, getSideContentID, getSubSectionID } from \"../../helpers/ID\";\nimport { getFormActions, getFormHiddenActions } from \"../../objectPage/FormMenuActions\";\nimport type { DataVisualizationDefinition } from \"../Common/DataVisualization\";\nimport { getDataVisualizationConfiguration } from \"../Common/DataVisualization\";\nimport type { FormDefinition } from \"../Common/Form\";\nimport { createFormDefinition, isReferenceFacet } from \"../Common/Form\";\n\nexport enum SubSectionType {\n\tUnknown = \"Unknown\", // Default Type\n\tForm = \"Form\",\n\tNotes = \"Notes\",\n\tDataVisualization = \"DataVisualization\",\n\tXMLFragment = \"XMLFragment\",\n\tPlaceholder = \"Placeholder\",\n\tMixed = \"Mixed\",\n\tEmbeddedComponent = \"EmbeddedComponent\"\n}\n\nexport type ObjectPageSubSection =\n\t| UnsupportedSubSection\n\t| FormSubSection\n\t| DataVisualizationSubSection\n\t| ContactSubSection\n\t| XMLFragmentSubSection\n\t| PlaceholderFragmentSubSection\n\t| MixedSubSection\n\t| ReuseComponentSubSection\n\t| NoteSubSection;\n\ntype BaseSubSection = {\n\tid: string;\n\tkey: string;\n\ttitle: CompiledBindingToolkitExpression;\n\tannotationPath: string;\n\ttype: SubSectionType;\n\tvisible: CompiledBindingToolkitExpression;\n\tisVisibilityDynamic?: boolean | \"\";\n\tflexSettings?: FlexSettings;\n\tstashed?: boolean;\n\tlevel: number;\n\tcontent?: Array<ObjectPageSubSection>;\n\tsideContent?: SideContentDef;\n\tobjectPageLazyLoaderEnabled: boolean;\n\tclass?: string;\n\tapplyState?: string;\n\tretrieveState?: string;\n};\n\ntype UnsupportedSubSection = BaseSubSection & {\n\ttype: SubSectionType.Unknown;\n\ttext: string;\n};\n\nexport type DataVisualizationSubSection = BaseSubSection & {\n\ttype: SubSectionType.DataVisualization;\n\tpresentation: DataVisualizationDefinition;\n\tisPartOfPreview?: boolean;\n\tshowSubSectionTitle: boolean | CompiledBindingToolkitExpression;\n\tdataVisualizationTitleVisible?: string | boolean;\n\tdataVisualizationOptions?: Record<string, unknown>;\n};\n\ntype ContactSubSection = UnsupportedSubSection;\ntype NoteSubSection = BaseSubSection & {\n\ttype: SubSectionType.Notes;\n};\ntype XMLFragmentSubSection = Omit<BaseSubSection, \"annotationPath\"> & {\n\ttype: SubSectionType.XMLFragment;\n\ttemplate: string;\n\tactions: Record<string, CustomAction>;\n};\n\ntype ReuseComponentSubSection = BaseSubSection & {\n\ttype: SubSectionType.EmbeddedComponent;\n\tcomponentName: string;\n\tsettings: string;\n};\n\ntype PlaceholderFragmentSubSection = Omit<BaseSubSection, \"annotationPath\"> & {\n\ttype: SubSectionType.Placeholder;\n\tactions: Record<string, CustomAction>;\n};\n\nexport type MixedSubSection = BaseSubSection & {\n\ttype: SubSectionType.Mixed;\n\tcontent: Array<ObjectPageSubSection>;\n};\n\nexport type FormSubSection = BaseSubSection & {\n\ttype: SubSectionType.Form;\n\tformDefinition: FormDefinition;\n\tactions: BaseAction[];\n\tcommandActions: Record<string, CustomAction>;\n};\n\nexport type ObjectPageSection = ConfigurableObject & {\n\tid: string;\n\ttitle: CompiledBindingToolkitExpression;\n\tshowTitle?: boolean;\n\tvisible: CompiledBindingToolkitExpression;\n\tsubSections: ObjectPageSubSection[];\n\tuseSingleTextAreaFieldAsNotes?: boolean;\n\tapplyState?: string;\n\tretrieveState?: string;\n};\n\ntype SideContentDef = {\n\ttemplate?: string;\n\tid?: string;\n\tsideContentFallDown?: string;\n\tcontainerQuery?: string;\n\tvisible?: boolean;\n\tequalSplit?: boolean;\n};\n\nexport type CustomObjectPageSection = CustomElement<ObjectPageSection> & {\n\tonSectionLoaded?: string;\n};\n\nexport type CustomObjectPageSubSection = CustomElement<ObjectPageSubSection>;\n\nconst visualizationTerms: string[] = [\n\tUIAnnotationTerms.LineItem,\n\tUIAnnotationTerms.Chart,\n\tUIAnnotationTerms.PresentationVariant,\n\tUIAnnotationTerms.SelectionPresentationVariant,\n\tUIAnnotationTerms.Note\n];\n\n/**\n * Create subsections based on facet definition.\n * @param facetCollection Collection of facets\n * @param converterContext The converter context\n * @param isHeaderSection True if header section is generated in this iteration\n * @param useSingleTextAreaFieldAsNotes If the only field within a form container is a text-area field, the label is hidden\n * @returns The current subsections\n */\nexport function createSubSections(\n\tfacetCollection: FacetTypes[],\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tisHeaderSection?: boolean,\n\tuseSingleTextAreaFieldAsNotes?: boolean\n): ObjectPageSubSection[] {\n\t// First we determine which sub section we need to create\n\tconst facetsToCreate = facetCollection.reduce((facetsToCreate: FacetTypes[], facetDefinition) => {\n\t\tswitch (facetDefinition.$Type) {\n\t\t\tcase UIAnnotationTypes.ReferenceFacet:\n\t\t\t\tfacetsToCreate.push(facetDefinition);\n\t\t\t\tbreak;\n\t\t\tcase UIAnnotationTypes.CollectionFacet:\n\t\t\t\t// TODO If the Collection Facet has a child of type Collection Facet we bring them up one level (Form + Table use case) ?\n\t\t\t\t// first case facet Collection is combination of collection and reference facet or not all facets are reference facets.\n\t\t\t\tif (facetDefinition.Facets.find((facetType) => facetType.$Type === UIAnnotationTypes.CollectionFacet)) {\n\t\t\t\t\tfacetsToCreate.splice(facetsToCreate.length, 0, ...facetDefinition.Facets);\n\t\t\t\t} else {\n\t\t\t\t\tfacetsToCreate.push(facetDefinition);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase UIAnnotationTypes.ReferenceURLFacet:\n\t\t\t\t// Not supported\n\t\t\t\tbreak;\n\t\t}\n\t\treturn facetsToCreate;\n\t}, []);\n\n\t// Then we create the actual subsections\n\treturn facetsToCreate.map((facet) =>\n\t\tcreateSubSection(\n\t\t\tfacet,\n\t\t\tfacetsToCreate,\n\t\t\tconverterContext,\n\t\t\t0,\n\t\t\t!(facet as CollectionFacet)?.Facets?.length,\n\t\t\tisHeaderSection,\n\t\t\tuseSingleTextAreaFieldAsNotes\n\t\t)\n\t);\n}\n\n/**\n * Creates subsections based on the definition of the custom header facet.\n * @param converterContext The converter context\n * @returns The current subsections\n */\nexport function createCustomHeaderFacetSubSections(converterContext: ConverterContext<PageContextPathTarget>): ObjectPageSubSection[] {\n\tconst customHeaderFacets: Record<string, CustomObjectPageHeaderFacet> = getHeaderFacetsFromManifest(\n\t\tconverterContext.getManifestWrapper().getHeaderFacets()\n\t);\n\tconst aCustomHeaderFacets: CustomObjectPageHeaderFacet[] = [];\n\tObject.keys(customHeaderFacets).forEach(function (key) {\n\t\taCustomHeaderFacets.push(customHeaderFacets[key]);\n\t\treturn aCustomHeaderFacets;\n\t});\n\tconst facetsToCreate = aCustomHeaderFacets.reduce((facetsToCreate: CustomObjectPageHeaderFacet[], customHeaderFacet) => {\n\t\tif (customHeaderFacet.templateEdit) {\n\t\t\tfacetsToCreate.push(customHeaderFacet);\n\t\t}\n\t\treturn facetsToCreate;\n\t}, []);\n\n\treturn facetsToCreate.map((customHeaderFacet) => createCustomHeaderFacetSubSection(customHeaderFacet));\n}\n\n/**\n * Creates a subsection based on a custom header facet.\n * @param customHeaderFacet A custom header facet\n * @returns A definition for a subsection\n */\nfunction createCustomHeaderFacetSubSection(customHeaderFacet: CustomObjectPageHeaderFacet): ObjectPageSubSection {\n\tconst subSectionID = getCustomSubSectionID(customHeaderFacet.key);\n\tconst subSection: XMLFragmentSubSection = {\n\t\tid: subSectionID,\n\t\tkey: customHeaderFacet.key,\n\t\ttitle: customHeaderFacet.title,\n\t\ttype: SubSectionType.XMLFragment,\n\t\ttemplate: customHeaderFacet.templateEdit || \"\",\n\t\tvisible: customHeaderFacet.visible,\n\t\tlevel: 1,\n\t\tsideContent: undefined,\n\t\tstashed: customHeaderFacet.stashed,\n\t\tflexSettings: customHeaderFacet.flexSettings,\n\t\tactions: {},\n\t\tobjectPageLazyLoaderEnabled: false\n\t};\n\treturn subSection;\n}\n\nconst getSubSectionKey = (facetDefinition: FacetTypes, fallback: string): string => {\n\treturn facetDefinition.ID?.toString() || facetDefinition.Label?.toString() || fallback;\n};\n/**\n * Adds Form menu action to all form actions, removes duplicate actions and hidden actions.\n * @param actions The actions involved\n * @param facetDefinition The definition for the facet\n * @param converterContext The converter context\n * @returns The form menu actions\n */\nfunction addFormMenuActions(\n\tactions: BaseAction[],\n\tfacetDefinition: FacetTypes,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): CombinedAction {\n\t// annotation actions possibly has CustomActions, which are added at Subsection.ts#createFormActionReducer\n\t// those action are incorrect and cause unwanted results, so we need to carefully remove incorrect ones here\n\tfor (let reverseIndex = actions.length - 1; reverseIndex >= 0; reverseIndex--) {\n\t\tif (\n\t\t\tactions[reverseIndex].id?.startsWith(\"CustomAction::\") &&\n\t\t\t(actions[reverseIndex].key.startsWith(\"DataFieldForAction::\") ||\n\t\t\t\tactions[reverseIndex].key.startsWith(\"DataFieldForIntentBasedNavigation::\"))\n\t\t) {\n\t\t\tactions.splice(reverseIndex, 1);\n\t\t}\n\t}\n\tconst hiddenActions: BaseAction[] = getFormHiddenActions(facetDefinition, converterContext) || [],\n\t\tactionOverwriteConfig: OverrideTypeAction = {\n\t\t\tenabled: OverrideType.overwrite,\n\t\t\tvisible: OverrideType.overwrite,\n\t\t\tcommand: OverrideType.overwrite,\n\t\t\tposition: OverrideType.overwrite,\n\t\t\tmenu: OverrideType.overwrite,\n\t\t\tpriority: OverrideType.overwrite,\n\t\t\tgroup: OverrideType.overwrite\n\t\t},\n\t\tformActions: ConfigurableRecord<ManifestAction> = getFormActions(facetDefinition, converterContext),\n\t\t// 1. Get actions from annotations -> actions are passed to this method\n\t\t// 2. Get actions from manifest\n\t\tmanifestActions = getActionsFromManifest(formActions, converterContext, actions, undefined, undefined, hiddenActions),\n\t\t// 3. Get all annotation menu items\n\t\tannotationMenuActionItems = getAnnotationMenuActionItems(actions),\n\t\t// 4. Find manifest actions which override any annotation menu items\n\t\tmatchingManifestActions = getMatchingManifestAction(annotationMenuActionItems, manifestActions.actions),\n\t\t// 5. Get overridden annotation menu items\n\t\toverwrittenMenuActionItems = insertCustomElements(\n\t\t\tannotationMenuActionItems,\n\t\t\tmatchingManifestActions,\n\t\t\tactionOverwriteConfig\n\t\t) as CustomAction[];\n\t// If there is a manifest action defined for a neighbouring reference facet, it would not be part of manifest actions here\n\t// In this for-loop, ensuring a pure manifest action coming from another reference facet is not lost\n\tfor (let reverseIndex = actions.length - 1; reverseIndex >= 0; reverseIndex--) {\n\t\tif (actions[reverseIndex].id?.startsWith(\"CustomAction::\")) {\n\t\t\tfor (const manifestAction in manifestActions.actions) {\n\t\t\t\tif (manifestAction === actions[reverseIndex].key) {\n\t\t\t\t\tactions.splice(reverseIndex, 1);\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\t// 6. Override all actions\n\tlet formAllActions = insertCustomElements(actions, manifestActions.actions, actionOverwriteConfig) as CustomAction[];\n\t// 7. Replace original menu items with their corresponding overridden menu items\n\tprepareMenuActions(formAllActions, overwrittenMenuActionItems);\n\t// 8. Remove duplicate actions which are menu items\n\tformAllActions = removeDuplicateActions(formAllActions);\n\t// 9. Hide menus where all menu items are hidden\n\tformAllActions = getVisibilityEnablementMenuActions(formAllActions);\n\t// 10. Apply primary action overflow protection\n\tformAllActions = ActionUtilities.ensurePrimaryActionNeverOverflows(formAllActions) as CustomAction[];\n\t// 11. (Only for this subsection UI area) defaultAction of a menu must be of type ActionType.Default\n\tformAllActions.forEach((action) => {\n\t\tif (action.type === ActionType.Menu && !!action.defaultAction) {\n\t\t\t(action.defaultAction as CustomAction).type = ActionType.Default;\n\t\t}\n\t});\n\n\treturn {\n\t\tactions: formAllActions ?? actions,\n\t\tcommandActions: manifestActions.commandActions\n\t};\n}\n\n/**\n * Retrieves the action form a facet.\n * @param facetDefinition\n * @param converterContext\n * @returns The current facet actions\n */\nfunction getFacetActions(facetDefinition: FacetTypes, converterContext: ConverterContext<PageContextPathTarget>): CombinedAction {\n\tlet actions: BaseAction[] = [];\n\tswitch (facetDefinition.$Type) {\n\t\tcase UIAnnotationTypes.CollectionFacet:\n\t\t\tactions = (\n\t\t\t\tfacetDefinition.Facets.filter((subFacetDefinition) => isReferenceFacet(subFacetDefinition)) as ReferenceFacetTypes[]\n\t\t\t).reduce(\n\t\t\t\t(actionReducer: BaseAction[], referenceFacet) => createFormActionReducer(actionReducer, referenceFacet, converterContext),\n\t\t\t\t[]\n\t\t\t);\n\t\t\tbreak;\n\t\tcase UIAnnotationTypes.ReferenceFacet:\n\t\t\tactions = createFormActionReducer([], facetDefinition, converterContext);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\treturn addFormMenuActions(actions, facetDefinition, converterContext);\n}\n/**\n * Returns the button type based on @UI.Emphasized annotation.\n * @param emphasized Emphasized annotation value.\n * @returns The button type or path based expression.\n */\nfunction getButtonType(emphasized: Emphasized | undefined): ButtonType {\n\t// Emphasized is a boolean so if it's equal to true we show the button as Ghost, otherwise as Transparent\n\tconst buttonTypeCondition = equal(getExpressionFromAnnotation(emphasized), true);\n\treturn compileExpression(ifElse(buttonTypeCondition, ButtonType.Ghost, ButtonType.Transparent)) as ButtonType;\n}\n\n/**\n * Create a subsection based on FacetTypes.\n * @param facetDefinition\n * @param facetsToCreate\n * @param converterContext\n * @param level\n * @param hasSingleContent\n * @param isHeaderSection\n * @param useSingleTextAreaFieldAsNotes If the only field within a form container is a text-area field, the label is hidden\n * @returns A subsection definition\n */\nexport function createSubSection(\n\tfacetDefinition: FacetTypes,\n\tfacetsToCreate: FacetTypes[],\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tlevel: number,\n\thasSingleContent: boolean,\n\tisHeaderSection?: boolean,\n\tuseSingleTextAreaFieldAsNotes?: boolean\n): ObjectPageSubSection {\n\tconst subSectionID = getSubSectionID(facetDefinition);\n\tconst hiddenAnnotation = facetDefinition.annotations?.UI?.Hidden;\n\tconst isVisibleExpression = not(\n\t\tequal(\n\t\t\ttrue,\n\t\t\tgetExpressionFromAnnotation(hiddenAnnotation, [], false, (path: string) =>\n\t\t\t\tsingletonPathVisitor(path, converterContext.getConvertedTypes(), [])\n\t\t\t)\n\t\t)\n\t);\n\tconst isVisibilityDynamic = !isConstant(isVisibleExpression) && !isPathAnnotationExpression(hiddenAnnotation);\n\tconst title = facetDefinition.Label !== undefined ? compileExpression(getExpressionFromAnnotation(facetDefinition.Label)) : undefined;\n\tconst subSection: BaseSubSection = {\n\t\tid: subSectionID,\n\t\tkey: getSubSectionKey(facetDefinition, subSectionID),\n\t\ttitle: title,\n\t\ttype: SubSectionType.Unknown,\n\t\tannotationPath: converterContext.getEntitySetBasedAnnotationPath(facetDefinition.fullyQualifiedName),\n\t\tvisible: compileExpression(isVisibleExpression),\n\t\tisVisibilityDynamic: isVisibilityDynamic,\n\t\tlevel: level,\n\t\tsideContent: undefined,\n\t\tobjectPageLazyLoaderEnabled: converterContext.getManifestWrapper().getEnableLazyLoading()\n\t};\n\tif (isHeaderSection) {\n\t\tsubSection.stashed = getStashedSettingsForHeaderFacet(facetDefinition, facetDefinition, converterContext);\n\t\tsubSection.flexSettings = {\n\t\t\tdesigntime: getDesignTimeMetadataSettingsForHeaderFacet(facetDefinition, facetDefinition, converterContext)\n\t\t};\n\t}\n\tlet unsupportedText = \"\";\n\tlevel++;\n\tswitch (facetDefinition.$Type) {\n\t\tcase UIAnnotationTypes.CollectionFacet:\n\t\t\tconst facets = facetDefinition.Facets;\n\n\t\t\t// Filter for all facets of this subsection that are referring to an annotation describing a visualization (e.g. table or chart)\n\t\t\tconst visualizationFacets = facets\n\t\t\t\t.map((facet, index) => ({ index, facet })) // Remember the index assigned to each facet\n\t\t\t\t.filter(({ facet }) => {\n\t\t\t\t\treturn isReferenceFacet(facet) && facet.Target.$target && visualizationTerms.includes(facet.Target.$target.term);\n\t\t\t\t});\n\n\t\t\t// Filter out all visualization facets; \"visualizationFacets\" and \"nonVisualizationFacets\" are disjoint\n\t\t\tconst nonVisualizationFacets = facets.filter(\n\t\t\t\t(facet) => !visualizationFacets.find((visualization) => visualization.facet === facet)\n\t\t\t);\n\n\t\t\tif (visualizationFacets.length > 0) {\n\t\t\t\t// CollectionFacets with visualizations must be handled separately as they cannot be included in forms\n\t\t\t\tconst visualizationContent: ObjectPageSubSection[] = [];\n\t\t\t\tconst formContent: ObjectPageSubSection[] = [];\n\t\t\t\tconst mixedContent: ObjectPageSubSection[] = [];\n\n\t\t\t\t// Create each visualization facet as if it was its own subsection (via recursion), and keep their relative ordering\n\t\t\t\tfor (const { facet } of visualizationFacets) {\n\t\t\t\t\tvisualizationContent.push(createSubSection(facet, [], converterContext, level, true, isHeaderSection));\n\t\t\t\t}\n\n\t\t\t\tif (nonVisualizationFacets.length > 0) {\n\t\t\t\t\t// This subsection includes visualizations and other content, so it is a \"Mixed\" subsection\n\t\t\t\t\tLog.warning(\n\t\t\t\t\t\t`Warning: CollectionFacet '${facetDefinition.ID}' includes a combination of either a chart or a table and other content. This can lead to rendering issues. Consider moving the chart or table into a separate CollectionFacet.`\n\t\t\t\t\t);\n\n\t\t\t\t\tconst fakeFormFacet = { ...facetDefinition };\n\t\t\t\t\tfakeFormFacet.Facets = nonVisualizationFacets;\n\t\t\t\t\t// Create a joined form of all facets that are not referring to visualizations\n\t\t\t\t\tformContent.push(createSubSection(fakeFormFacet, [], converterContext, level, hasSingleContent, isHeaderSection));\n\t\t\t\t}\n\n\t\t\t\t// Merge the visualization content with the form content\n\t\t\t\tif (visualizationFacets.find(({ index }) => index === 0)) {\n\t\t\t\t\t// If the first facet is a visualization, display the visualizations first\n\t\t\t\t\tmixedContent.push(...visualizationContent);\n\t\t\t\t\tmixedContent.push(...formContent);\n\t\t\t\t} else {\n\t\t\t\t\t// Otherwise, display the form first\n\t\t\t\t\tmixedContent.push(...formContent);\n\t\t\t\t\tmixedContent.push(...visualizationContent);\n\t\t\t\t}\n\n\t\t\t\tconst mixedSubSection: MixedSubSection = {\n\t\t\t\t\t...subSection,\n\t\t\t\t\ttype: SubSectionType.Mixed,\n\t\t\t\t\tlevel: level,\n\t\t\t\t\tcontent: mixedContent\n\t\t\t\t};\n\t\t\t\treturn mixedSubSection;\n\t\t\t} else {\n\t\t\t\t// This CollectionFacet only includes content that can be rendered in a merged form\n\t\t\t\tconst facetActions = getFacetActions(facetDefinition, converterContext),\n\t\t\t\t\tformCollectionSubSection: FormSubSection = {\n\t\t\t\t\t\t...subSection,\n\t\t\t\t\t\ttype: SubSectionType.Form,\n\t\t\t\t\t\tformDefinition: createFormDefinition(\n\t\t\t\t\t\t\tfacetDefinition,\n\t\t\t\t\t\t\tcompileExpression(isVisibleExpression),\n\t\t\t\t\t\t\tconverterContext,\n\t\t\t\t\t\t\tfacetActions.actions,\n\t\t\t\t\t\t\t{ useSingleTextAreaFieldAsNotes }\n\t\t\t\t\t\t),\n\t\t\t\t\t\tlevel: level,\n\t\t\t\t\t\tactions: facetActions.actions.filter((action) => action.facetName === undefined),\n\t\t\t\t\t\tcommandActions: facetActions.commandActions\n\t\t\t\t\t};\n\t\t\t\treturn formCollectionSubSection;\n\t\t\t}\n\t\tcase UIAnnotationTypes.ReferenceFacet:\n\t\t\tif (!facetDefinition.Target.$target) {\n\t\t\t\tunsupportedText = `Unable to find annotationPath ${facetDefinition.Target.value}`;\n\t\t\t} else {\n\t\t\t\tswitch (facetDefinition.Target.$target.term) {\n\t\t\t\t\tcase UIAnnotationTerms.LineItem:\n\t\t\t\t\tcase UIAnnotationTerms.Chart:\n\t\t\t\t\tcase UIAnnotationTerms.PresentationVariant:\n\t\t\t\t\tcase UIAnnotationTerms.SelectionPresentationVariant:\n\t\t\t\t\t\tconst presentation = getDataVisualizationConfiguration(facetDefinition.Target.value, converterContext, {\n\t\t\t\t\t\t\tisCondensedTableLayoutCompliant: getCondensedTableLayoutCompliance(\n\t\t\t\t\t\t\t\tfacetDefinition,\n\t\t\t\t\t\t\t\tfacetsToCreate,\n\t\t\t\t\t\t\t\tconverterContext\n\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\tdoNotCheckApplySupported: isHeaderSection,\n\t\t\t\t\t\t\tshouldCreateTemplateChartVisualization: true\n\t\t\t\t\t\t});\n\t\t\t\t\t\tconst subSectionTitle: string = subSection.title ? subSection.title : \"\";\n\t\t\t\t\t\tconst controlTitle =\n\t\t\t\t\t\t\t(presentation.visualizations[0] as TableVisualization)?.annotation?.title ||\n\t\t\t\t\t\t\t(presentation.visualizations[0] as ChartVisualization)?.title;\n\t\t\t\t\t\tconst isPartOfPreview = facetDefinition.annotations?.UI?.PartOfPreview?.valueOf() !== false;\n\t\t\t\t\t\tconst showSubSectionTitle = getShowSubSectionTitle(controlTitle ?? \"\", subSectionTitle, hasSingleContent);\n\n\t\t\t\t\t\t// Either calculate the title visibility statically or dynamically\n\t\t\t\t\t\t// Additionally to checking whether a title exists,\n\t\t\t\t\t\t// we also need to check that the facet title is not the same as the control (i.e. visualization) title;\n\t\t\t\t\t\t// this is done by including \"showSubSectionTitle\" in the and expression\n\t\t\t\t\t\tconst dataVisualizationTitleVisible = ifElse(\n\t\t\t\t\t\t\tisVisibilityDynamic,\n\t\t\t\t\t\t\tand(isVisibleExpression, not(equal(title, \"undefined\")), showSubSectionTitle),\n\t\t\t\t\t\t\tand(\n\t\t\t\t\t\t\t\tcompileExpression(isVisibleExpression) !== undefined,\n\t\t\t\t\t\t\t\ttitle !== \"undefined\",\n\t\t\t\t\t\t\t\ttitle !== undefined,\n\t\t\t\t\t\t\t\tisVisibleExpression,\n\t\t\t\t\t\t\t\tshowSubSectionTitle\n\t\t\t\t\t\t\t)\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tconst dataVisualizationSubSection: DataVisualizationSubSection = {\n\t\t\t\t\t\t\t...subSection,\n\t\t\t\t\t\t\ttype: SubSectionType.DataVisualization,\n\t\t\t\t\t\t\tlevel: level,\n\t\t\t\t\t\t\tpresentation: presentation,\n\t\t\t\t\t\t\tisPartOfPreview,\n\t\t\t\t\t\t\tshowSubSectionTitle: compileExpression(showSubSectionTitle), // This is used on the ObjectPageSubSection\n\t\t\t\t\t\t\tdataVisualizationTitleVisible: compileExpression(dataVisualizationTitleVisible) // This is used to hide the Title control above data visualizations\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn dataVisualizationSubSection;\n\n\t\t\t\t\tcase UIAnnotationTerms.FieldGroup:\n\t\t\t\t\tcase UIAnnotationTerms.Identification:\n\t\t\t\t\tcase UIAnnotationTerms.DataPoint:\n\t\t\t\t\tcase UIAnnotationTerms.StatusInfo:\n\t\t\t\t\tcase CommunicationAnnotationTerms.Contact:\n\t\t\t\t\t\t// All those element belong to a from facet\n\t\t\t\t\t\tconst facetActions = getFacetActions(facetDefinition, converterContext),\n\t\t\t\t\t\t\tformElementSubSection: FormSubSection = {\n\t\t\t\t\t\t\t\t...subSection,\n\t\t\t\t\t\t\t\ttype: SubSectionType.Form,\n\t\t\t\t\t\t\t\tlevel: level,\n\t\t\t\t\t\t\t\tformDefinition: createFormDefinition(\n\t\t\t\t\t\t\t\t\tfacetDefinition,\n\t\t\t\t\t\t\t\t\tcompileExpression(isVisibleExpression),\n\t\t\t\t\t\t\t\t\tconverterContext,\n\t\t\t\t\t\t\t\t\tfacetActions.actions,\n\t\t\t\t\t\t\t\t\t{ useSingleTextAreaFieldAsNotes }\n\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\tactions: facetActions.actions.filter((action) => action.facetName === undefined),\n\t\t\t\t\t\t\t\tcommandActions: facetActions.commandActions\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\treturn formElementSubSection;\n\n\t\t\t\t\tcase UIAnnotationTerms.Note:\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\t...subSection,\n\t\t\t\t\t\t\ttype: SubSectionType.Notes\n\t\t\t\t\t\t};\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tunsupportedText = `For ${facetDefinition.Target.$target.term} Fragment`;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase UIAnnotationTypes.ReferenceURLFacet:\n\t\t\tunsupportedText = \"For Reference URL Facet\";\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\t// If we reach here we ended up with an unsupported SubSection type\n\tconst unsupportedSubSection: UnsupportedSubSection = {\n\t\t...subSection,\n\t\ttype: SubSectionType.Unknown,\n\t\ttext: unsupportedText\n\t};\n\treturn unsupportedSubSection;\n}\n\n/**\n * Checks whether to hide or show the subsection title.\n * @param controlTitle\n * @param subSectionTitle\n * @param hasSingleContent\n * @returns Boolean value or expression for showSubSectionTitle\n */\nexport function getShowSubSectionTitle(\n\tcontrolTitle: string,\n\tsubSectionTitle: string,\n\thasSingleContent: boolean\n): BindingToolkitExpression<boolean> {\n\t// visible shall be true if there are multiple content or if the control and subsection title are different\n\treturn or(not(hasSingleContent), notEqual(resolveBindingString(controlTitle), resolveBindingString(subSectionTitle)));\n}\n\nfunction createFormActionReducer(\n\tactions: BaseAction[],\n\tfacetDefinition: ReferenceFacetTypes,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): BaseAction[] {\n\tconst referenceTarget = facetDefinition.Target.$target;\n\tconst targetValue = facetDefinition.Target.value;\n\tlet manifestActions: Record<string, CustomAction> = {};\n\tlet dataFieldCollection: DataFieldAbstractTypes[] = [];\n\tlet navigationPropertyPath: string | undefined;\n\t[navigationPropertyPath] = targetValue.split(\"@\");\n\tif (navigationPropertyPath.length > 0) {\n\t\tif (navigationPropertyPath.lastIndexOf(\"/\") === navigationPropertyPath.length - 1) {\n\t\t\tnavigationPropertyPath = navigationPropertyPath.substring(0, navigationPropertyPath.length - 1);\n\t\t}\n\t} else {\n\t\tnavigationPropertyPath = undefined;\n\t}\n\n\tif (referenceTarget) {\n\t\tswitch (referenceTarget.term) {\n\t\t\tcase UIAnnotationTerms.FieldGroup:\n\t\t\t\tdataFieldCollection = (referenceTarget as FieldGroup).Data;\n\t\t\t\tmanifestActions = getActionsFromManifest(\n\t\t\t\t\tconverterContext.getManifestControlConfiguration<FormManifestConfiguration>(referenceTarget).actions as\n\t\t\t\t\t\t| Record<string, ManifestAction>\n\t\t\t\t\t\t| undefined,\n\t\t\t\t\tconverterContext,\n\t\t\t\t\t[],\n\t\t\t\t\tundefined,\n\t\t\t\t\tundefined,\n\t\t\t\t\tundefined,\n\t\t\t\t\tfacetDefinition.fullyQualifiedName\n\t\t\t\t).actions;\n\t\t\t\tbreak;\n\t\t\tcase UIAnnotationTerms.Identification:\n\t\t\tcase UIAnnotationTerms.StatusInfo:\n\t\t\t\tif (referenceTarget.qualifier) {\n\t\t\t\t\tdataFieldCollection = referenceTarget;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tbreak;\n\t\t}\n\t\tactions = dataFieldCollection.reduce((actionReducer, dataField: DataFieldAbstractTypes) => {\n\t\t\tswitch (dataField.$Type) {\n\t\t\t\tcase UIAnnotationTypes.DataFieldForIntentBasedNavigation:\n\t\t\t\t\tif (dataField.RequiresContext?.valueOf() === true) {\n\t\t\t\t\t\tconverterContext\n\t\t\t\t\t\t\t.getDiagnostics()\n\t\t\t\t\t\t\t.addIssue(IssueCategory.Annotation, IssueSeverity.Low, IssueType.MALFORMED_DATAFIELD_FOR_IBN.REQUIRESCONTEXT);\n\t\t\t\t\t}\n\t\t\t\t\tif (dataField.Inline?.valueOf() === true) {\n\t\t\t\t\t\tconverterContext\n\t\t\t\t\t\t\t.getDiagnostics()\n\t\t\t\t\t\t\t.addIssue(IssueCategory.Annotation, IssueSeverity.Low, IssueType.MALFORMED_DATAFIELD_FOR_IBN.INLINE);\n\t\t\t\t\t}\n\t\t\t\t\tif (dataField.Determining?.valueOf() === true) {\n\t\t\t\t\t\tconverterContext\n\t\t\t\t\t\t\t.getDiagnostics()\n\t\t\t\t\t\t\t.addIssue(IssueCategory.Annotation, IssueSeverity.Low, IssueType.MALFORMED_DATAFIELD_FOR_IBN.DETERMINING);\n\t\t\t\t\t}\n\t\t\t\t\tconst mNavigationParameters: NavigationParameters = {};\n\t\t\t\t\tif (dataField.Mapping) {\n\t\t\t\t\t\tmNavigationParameters.semanticObjectMapping = getSemanticObjectMapping(dataField.Mapping);\n\t\t\t\t\t}\n\t\t\t\t\tactionReducer.push({\n\t\t\t\t\t\ttype: ActionType.DataFieldForIntentBasedNavigation,\n\t\t\t\t\t\tid: getFormID(facetDefinition, dataField),\n\t\t\t\t\t\tkey: KeyHelper.generateKeyFromDataField(dataField),\n\t\t\t\t\t\ttext: dataField.Label?.toString(),\n\t\t\t\t\t\tannotationPath: \"\",\n\t\t\t\t\t\tenabled:\n\t\t\t\t\t\t\tdataField.NavigationAvailable !== undefined\n\t\t\t\t\t\t\t\t? compileExpression(equal(getExpressionFromAnnotation(dataField.NavigationAvailable), true))\n\t\t\t\t\t\t\t\t: \"true\",\n\t\t\t\t\t\tvisible: compileExpression(not(equal(getExpressionFromAnnotation(dataField.annotations?.UI?.Hidden), true))),\n\t\t\t\t\t\tbuttonType: getButtonType(dataField.annotations?.UI?.Emphasized),\n\t\t\t\t\t\tpress: compileExpression(\n\t\t\t\t\t\t\tfn(\"._intentBasedNavigation.navigate\", [\n\t\t\t\t\t\t\t\tgetExpressionFromAnnotation(dataField.SemanticObject),\n\t\t\t\t\t\t\t\tgetExpressionFromAnnotation(dataField.Action),\n\t\t\t\t\t\t\t\tmNavigationParameters\n\t\t\t\t\t\t\t])\n\t\t\t\t\t\t),\n\t\t\t\t\t\tcustomData: compileExpression({\n\t\t\t\t\t\t\tsemanticObject: getExpressionFromAnnotation(dataField.SemanticObject),\n\t\t\t\t\t\t\taction: getExpressionFromAnnotation(dataField.Action)\n\t\t\t\t\t\t})\n\t\t\t\t\t} as AnnotationAction);\n\t\t\t\t\tbreak;\n\t\t\t\tcase UIAnnotationTypes.DataFieldForAction:\n\t\t\t\t\tconst formManifestActionsConfiguration =\n\t\t\t\t\t\tconverterContext.getManifestControlConfiguration<FormManifestConfiguration>(referenceTarget).actions;\n\t\t\t\t\tactionReducer.push(\n\t\t\t\t\t\tgetDataFieldAnnotationAction(\n\t\t\t\t\t\t\tdataField,\n\t\t\t\t\t\t\tfacetDefinition,\n\t\t\t\t\t\t\tconverterContext,\n\t\t\t\t\t\t\tformManifestActionsConfiguration,\n\t\t\t\t\t\t\tnavigationPropertyPath\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase UIAnnotationTypes.DataFieldForActionGroup:\n\t\t\t\t\tactionReducer.push({\n\t\t\t\t\t\ttype: ActionType.Menu,\n\t\t\t\t\t\ttext: dataField.Label?.toString(),\n\t\t\t\t\t\tkey: KeyHelper.generateKeyFromDataField(dataField),\n\t\t\t\t\t\tid: getFormID(facetDefinition, dataField),\n\t\t\t\t\t\tvisible: compileExpression(not(equal(getExpressionFromAnnotation(dataField.annotations?.UI?.Hidden), true))),\n\t\t\t\t\t\tisAIOperation: isMenuAIOperation(dataField.Actions) === true || undefined,\n\t\t\t\t\t\tmenu: dataField.Actions.map((action) => {\n\t\t\t\t\t\t\tconst formManifestMenuActionsConfiguration =\n\t\t\t\t\t\t\t\tconverterContext.getManifestControlConfiguration<FormManifestConfiguration>(referenceTarget).actions;\n\t\t\t\t\t\t\treturn getDataFieldAnnotationAction(\n\t\t\t\t\t\t\t\taction as DataFieldForActionTypes,\n\t\t\t\t\t\t\t\tfacetDefinition,\n\t\t\t\t\t\t\t\tconverterContext,\n\t\t\t\t\t\t\t\tformManifestMenuActionsConfiguration,\n\t\t\t\t\t\t\t\tnavigationPropertyPath\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t})\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t\treturn actionReducer;\n\t\t}, actions);\n\t}\n\n\t// no overrides here, they are done in a later step in addFormMenuActions\n\treturn insertCustomElements(actions, manifestActions);\n}\n\nfunction getDataFieldAnnotationAction(\n\tdataField: DataFieldForActionTypes,\n\tfacetDefinition: ReferenceFacetTypes,\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\tformManifestActionsConfiguration: Record<string, ManifestAction> | undefined,\n\tnavigationPropertyPath?: string\n): AnnotationAction {\n\tconst key = KeyHelper.generateKeyFromDataField(dataField);\n\treturn {\n\t\ttype: ActionType.DataFieldForAction,\n\t\tid: getFormID(facetDefinition, dataField),\n\t\tkey: KeyHelper.generateKeyFromDataField(dataField),\n\t\ttext: dataField.Label?.toString(),\n\t\tannotationPath: \"\",\n\t\tenabled: getEnabledForAnnotationAction(converterContext, dataField.ActionTarget),\n\t\tbinding: navigationPropertyPath && !dataField.Inline ? `{ 'path' : '${navigationPropertyPath}'}` : undefined, // Inline Actions don't need the binding as they are inside the Form\n\t\tvisible: compileExpression(not(equal(getExpressionFromAnnotation(dataField.annotations?.UI?.Hidden), true))),\n\t\trequiresDialog: isActionWithDialog(dataField),\n\t\tbuttonType: getButtonType(dataField.annotations?.UI?.Emphasized),\n\t\tisAIOperation: isActionAIOperation(dataField) === true || undefined,\n\t\tpress: compileExpression(\n\t\t\tfn(\n\t\t\t\t\"invokeAction\",\n\t\t\t\t[\n\t\t\t\t\tdataField.Action,\n\t\t\t\t\t{\n\t\t\t\t\t\tcontexts: fn(\"getBindingContext\", [], pathInModel(\"\", \"$source\")),\n\t\t\t\t\t\tinvocationGrouping: (dataField.InvocationGrouping === \"UI.OperationGroupingType/ChangeSet\"\n\t\t\t\t\t\t\t? \"ChangeSet\"\n\t\t\t\t\t\t\t: \"Isolated\") as OperationGroupingType,\n\t\t\t\t\t\tlabel: dataField.Label?.toString(),\n\t\t\t\t\t\tmodel: fn(\"getModel\", [], pathInModel(\"/\", \"$source\")),\n\t\t\t\t\t\tisNavigable: isActionNavigable(formManifestActionsConfiguration && formManifestActionsConfiguration[key])\n\t\t\t\t\t}\n\t\t\t\t],\n\t\t\t\tref(\".editFlow\")\n\t\t\t)\n\t\t),\n\t\tfacetName: dataField.Inline ? facetDefinition.fullyQualifiedName : undefined\n\t};\n}\n\nexport function isDialog(actionDefinition: Action | undefined): string {\n\tif (actionDefinition) {\n\t\tconst bCritical = actionDefinition.annotations?.Common?.IsActionCritical;\n\t\tif (actionDefinition.parameters.length > 1 || bCritical) {\n\t\t\treturn \"Dialog\";\n\t\t} else {\n\t\t\treturn \"None\";\n\t\t}\n\t} else {\n\t\treturn \"None\";\n\t}\n}\n\nexport function createCustomSubSections(\n\tmanifestSubSections: Record<string, ManifestSubSection>,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): Record<string, CustomObjectPageSubSection> {\n\tconst subSections: Record<string, CustomObjectPageSubSection> = {};\n\tObject.keys(manifestSubSections).forEach(\n\t\t(subSectionKey) =>\n\t\t\t(subSections[subSectionKey] = createCustomSubSection(manifestSubSections[subSectionKey], subSectionKey, converterContext))\n\t);\n\treturn subSections;\n}\n\nexport function createCustomSubSection(\n\tmanifestSubSection: ManifestSubSection,\n\tsubSectionKey: string,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): CustomObjectPageSubSection {\n\tconst sideContent: SideContentDef | undefined = manifestSubSection.sideContent\n\t\t? {\n\t\t\t\ttemplate: manifestSubSection.sideContent.template,\n\t\t\t\tid: getSideContentID(subSectionKey),\n\t\t\t\tvisible: false,\n\t\t\t\tequalSplit: manifestSubSection.sideContent.equalSplit\n\t\t  }\n\t\t: undefined;\n\tlet position = manifestSubSection.position;\n\tif (!position) {\n\t\tposition = {\n\t\t\tplacement: Placement.After\n\t\t};\n\t}\n\tconst isVisible = manifestSubSection.visible !== undefined ? manifestSubSection.visible : true;\n\tconst isDynamicExpression = isVisible && typeof isVisible === \"string\" && isVisible.indexOf(\"{=\") === 0;\n\tconst manifestActions = getActionsFromManifest(manifestSubSection.actions, converterContext);\n\tmanifestActions.actions = removeDuplicateActions(Object.values(manifestActions.actions))?.reduce(\n\t\t(previousAction, currentAction) => ({ ...previousAction, [currentAction.key]: currentAction }),\n\t\t{}\n\t);\n\tconst subSectionDefinition = {\n\t\ttype: SubSectionType.Unknown,\n\t\tid: manifestSubSection.id || getCustomSubSectionID(subSectionKey),\n\t\tactions: manifestActions.actions,\n\t\tkey: subSectionKey,\n\t\ttitle: manifestSubSection.title,\n\t\tlevel: 1,\n\t\tposition: position,\n\t\tvisible: manifestSubSection.visible !== undefined ? manifestSubSection.visible : \"true\",\n\t\tsideContent: sideContent,\n\t\tisVisibilityDynamic: isDynamicExpression,\n\t\tobjectPageLazyLoaderEnabled: manifestSubSection.enableLazyLoading ?? false,\n\t\tcomponentName: \"\",\n\t\tsettings: \"\",\n\t\tapplyState: manifestSubSection.applyState,\n\t\tretrieveState: manifestSubSection.retrieveState\n\t};\n\tif (manifestSubSection.template || manifestSubSection.name) {\n\t\tsubSectionDefinition.type = SubSectionType.XMLFragment;\n\t\t(subSectionDefinition as unknown as XMLFragmentSubSection).template = manifestSubSection.template || manifestSubSection.name || \"\";\n\t} else if (manifestSubSection.embeddedComponent !== undefined) {\n\t\tsubSectionDefinition.type = SubSectionType.EmbeddedComponent;\n\t\tsubSectionDefinition.componentName = manifestSubSection.embeddedComponent.name;\n\t\tif (manifestSubSection.embeddedComponent.settings !== undefined) {\n\t\t\tsubSectionDefinition.settings = JSON.stringify(manifestSubSection.embeddedComponent.settings);\n\t\t}\n\t} else {\n\t\tsubSectionDefinition.type = SubSectionType.Placeholder;\n\t}\n\treturn subSectionDefinition as CustomObjectPageSubSection;\n}\n\n/**\n * Evaluate if the condensed mode can be applied on the table.\n * @param currentFacet\n * @param facetsToCreateInSection\n * @param converterContext\n * @returns `true` for compliant, false otherwise\n */\nfunction getCondensedTableLayoutCompliance(\n\tcurrentFacet: FacetTypes,\n\tfacetsToCreateInSection: FacetTypes[],\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): boolean {\n\tconst manifestWrapper = converterContext.getManifestWrapper();\n\tif (manifestWrapper.useIconTabBar()) {\n\t\t// If the OP use the tab based we check if the facets that will be created for this section are all non visible\n\t\treturn hasNoOtherVisibleTableInTargets(currentFacet, facetsToCreateInSection);\n\t} else {\n\t\tconst entityType = converterContext.getEntityType();\n\t\tif (entityType.annotations?.UI?.Facets?.length && entityType.annotations?.UI?.Facets?.length > 1) {\n\t\t\treturn hasNoOtherVisibleTableInTargets(currentFacet, facetsToCreateInSection);\n\t\t} else {\n\t\t\treturn true;\n\t\t}\n\t}\n}\n\nfunction hasNoOtherVisibleTableInTargets(currentFacet: FacetTypes, facetsToCreateInSection: FacetTypes[]): boolean {\n\treturn facetsToCreateInSection.every(function (subFacet) {\n\t\tif (subFacet !== currentFacet) {\n\t\t\tif (subFacet.$Type === UIAnnotationTypes.ReferenceFacet) {\n\t\t\t\tconst refFacet = subFacet;\n\t\t\t\tif (\n\t\t\t\t\trefFacet.Target?.$target?.term === UIAnnotationTerms.LineItem ||\n\t\t\t\t\trefFacet.Target?.$target?.term === UIAnnotationTerms.PresentationVariant ||\n\t\t\t\t\trefFacet.Target.$target?.term === UIAnnotationTerms.SelectionPresentationVariant\n\t\t\t\t) {\n\t\t\t\t\treturn refFacet.annotations?.UI?.Hidden !== undefined ? refFacet.annotations?.UI?.Hidden : false;\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tconst subCollectionFacet = subFacet as CollectionFacetTypes;\n\t\t\t\treturn subCollectionFacet.Facets.every(function (facet) {\n\t\t\t\t\tconst subRefFacet = facet as ReferenceFacetTypes;\n\t\t\t\t\tif (\n\t\t\t\t\t\tsubRefFacet.Target?.$target?.term === UIAnnotationTerms.LineItem ||\n\t\t\t\t\t\tsubRefFacet.Target?.$target?.term === UIAnnotationTerms.PresentationVariant ||\n\t\t\t\t\t\tsubRefFacet.Target?.$target?.term === UIAnnotationTerms.SelectionPresentationVariant\n\t\t\t\t\t) {\n\t\t\t\t\t\treturn subRefFacet.annotations?.UI?.Hidden !== undefined ? subRefFacet.annotations?.UI?.Hidden : false;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t});\n}\n"],"mappings":"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","ignoreList":[],"file":"SubSection-dbg.js"}