/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/helpers/ConfigurableObject","sap/fe/core/converters/helpers/ID","sap/fe/core/converters/helpers/Key","sap/fe/core/templating/PropertyHelper","sap/fe/core/templating/UIFormatters","../../../helpers/StableIdHelper","../../helpers/DataFieldHelper","../Common/Form"],function(e,t,a,n,i,o,r,s,c,l){"use strict";var u={};var d=l.getFormElementsFromManifest;var p=l.FormElementType;var f=c.isReferencePropertyStaticallyHidden;var v=c.isAnnotationFieldStaticallyHidden;var m=s.createIdForAnnotation;var g=r.isVisible;var b=o.isMultiLineText;var y=i.KeyHelper;var F=n.getHeaderFacetID;var I=n.getHeaderFacetFormID;var T=n.getHeaderFacetContainerID;var h=n.getCustomHeaderFacetID;var $=a.insertCustomElements;var U=a.Placement;var C=t.getSemanticObjectPath;var D=e.compileExpression;let P=function(e){e["Annotation"]="Annotation";e["XMLFragment"]="XMLFragment";return e}({});u.HeaderFacetType=P;let A=function(e){e["Reference"]="Reference";e["Collection"]="Collection";return e}({});u.FacetType=A;let S=function(e){e["Default"]="Default";e["NotAdaptable"]="not-adaptable";e["NotAdaptableTree"]="not-adaptable-tree";e["NotAdaptableVisibility"]="not-adaptable-visibility";return e}({});u.FlexDesignTimeType=S;var H=function(e){e["ProgressIndicator"]="ProgressIndicator";e["RatingIndicator"]="RatingIndicator";e["Content"]="Content";return e}(H||{});var E=function(e){e["None"]="None";e["DataPoint"]="DataPoint";e["Chart"]="Chart";e["Identification"]="Identification";e["Contact"]="Contact";e["Address"]="Address";e["FieldGroup"]="FieldGroup";e["PresentationVariant"]="PresentationVariant";return e}(E||{});function N(e){const t=[];e.getEntityType().annotations?.UI?.HeaderFacets?.forEach(a=>{const n=G(a,e);if(n){t.push(n)}});return t}u.getHeaderFacetsFromAnnotations=N;function R(e){const t={};Object.keys(e).forEach(a=>{const n=e[a];t[a]=w(n,a)});return t}u.getHeaderFacetsFromManifest=R;function V(e,t,a){if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){return false}const n=m(e)??"";const i=a.getManifestWrapper().getHeaderFacets();const o=i[n]?.stashed;return o===true}u.getStashedSettingsForHeaderFacet=V;function k(e,t,a){let n=S.Default;const i=m(e);if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&t.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){n=S.NotAdaptableTree}else{const e=a.getManifestWrapper().getHeaderFacets();if(i){const t=e[i]?.flexSettings?.designtime;switch(t){case S.NotAdaptable:case S.NotAdaptableTree:case S.NotAdaptableVisibility:n=t;break;default:break}}}return n}u.getDesignTimeMetadataSettingsForHeaderFacet=k;function x(e,t,a){if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&e.annotations?.UI?.Hidden?.valueOf()!==true){const n=F(e),i=(e,t)=>e.ID?.toString()||e.Label?.toString()||t,o=e.Target.value,r=M(e);let s;let c;switch(r){case E.FieldGroup:s=O(e,a);break;case E.DataPoint:c=B(e,a);break;default:break}if(e.Target?.$target?.term==="com.sap.vocabularies.UI.v1.Chart"&&v(e)){return undefined}else{return{type:P.Annotation,facetType:A.Reference,id:n,containerId:T(e),key:i(e,n),flexSettings:{designtime:k(e,t,a)},stashed:V(e,t,a),visible:D(g(e)),annotationPath:`${a.getEntitySetBasedAnnotationPath(e.fullyQualifiedName)}/`,targetAnnotationValue:o,targetAnnotationType:r,headerFormData:s,headerDataPointData:c}}}return undefined}function L(e,t){if(e.$Type==="com.sap.vocabularies.UI.v1.CollectionFacet"){const a=[],n=F(e),i=(e,t)=>e.ID?.toString()||e.Label?.toString()||t;e.Facets.forEach(n=>{const i=x(n,e,t);if(i){a.push(i)}});return{type:P.Annotation,facetType:A.Collection,id:n,containerId:T(e),key:i(e,n),flexSettings:{designtime:k(e,e,t)},stashed:V(e,e,t),visible:D(g(e)),annotationPath:`${t.getEntitySetBasedAnnotationPath(e.fullyQualifiedName)}/`,facets:a}}return undefined}function M(e){let t=E.None;const a={"com.sap.vocabularies.UI.v1.DataPoint":E.DataPoint,"com.sap.vocabularies.UI.v1.Chart":E.Chart,"com.sap.vocabularies.UI.v1.Identification":E.Identification,"com.sap.vocabularies.Communication.v1.Contact":E.Contact,"com.sap.vocabularies.Communication.v1.Address":E.Address,"com.sap.vocabularies.UI.v1.FieldGroup":E.FieldGroup,"com.sap.vocabularies.UI.v1.PresentationVariant":E.PresentationVariant};if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"&&e.Target.$target){t=a[e.Target.$target.term]??E.None}return t}function O(e,t){if(!e){throw new Error("Cannot get FieldGroup form data without facet definition")}const a=$(j(e,t),d(e,t));return{id:I(e),label:e.Label?.toString(),formElements:a}}function j(e,t){const a=[];if(e.$Type!=="com.sap.vocabularies.UI.v1.ReferenceURLFacet"&&e.$Type!=="com.sap.vocabularies.UI.v1.CollectionFacet"){const n=t.getEntityTypeAnnotation(e.Target.value);t=n.converterContext;e.Target?.$target?.Data.forEach(n=>{if(n.annotations?.UI?.Hidden?.valueOf()!==true){const i=C(t,n);if((n.$Type==="com.sap.vocabularies.UI.v1.DataField"||n.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithUrl"||n.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"||n.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation"||n.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction")&&!f(n)){a.push({isValueMultilineText:b(n.Value?.$target),type:p.Annotation,key:y.generateKeyFromDataField(n),visible:D(g(n)),label:n.Value?.$target?.annotations?.Common?.Label||n.Label,idPrefix:I(e,n),annotationPath:`${t.getEntitySetBasedAnnotationPath(n.fullyQualifiedName)}/`,semanticObjectPath:i})}else if(n.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"&&!f(n)){a.push({isValueMultilineText:false,type:p.Annotation,key:y.generateKeyFromDataField(n),visible:D(g(n)),label:n.Target?.$target?.annotations?.Common?.Label?.toString()||n.Label?.toString(),idPrefix:I(e,n),annotationPath:`${t.getEntitySetBasedAnnotationPath(n.fullyQualifiedName)}/`,semanticObjectPath:i})}}})}return a}function B(e,t){let a=H.Content;let n;if(e.$Type==="com.sap.vocabularies.UI.v1.ReferenceFacet"&&!v(e)){if(e.Target?.$target?.Visualization==="UI.VisualizationType/Progress"){a=H.ProgressIndicator}else if(e.Target?.$target?.Visualization==="UI.VisualizationType/Rating"){a=H.RatingIndicator}const i=e.Target?.$target;if(typeof i==="object"){if(i?.Value?.$target){const e=i.Value.$target;if(e?.annotations?.Common?.SemanticObject!==undefined){n=t.getEntitySetBasedAnnotationPath(e?.fullyQualifiedName)}}}}return{type:a,semanticObjectPath:n}}function G(e,t){let a;switch(e.$Type){case"com.sap.vocabularies.UI.v1.ReferenceFacet":a=x(e,e,t);break;case"com.sap.vocabularies.UI.v1.CollectionFacet":a=L(e,t);break;default:break}return a}function W(e){if(!e){return undefined}const t=["Heroes","Decoration","Workers","LongRunners"].includes(e)?`$auto.${e}`:e;return`{ path : '', parameters : { $$groupId : '${t}' } }`}function w(e,t){const a=h(t);let n=e.position;if(!n){n={placement:U.After}}return{facetType:A.Reference,type:e.type,id:a,containerId:a,key:t,position:n,visible:e.visible,fragmentName:e.template||e.name,title:e.title,subTitle:e.subTitle,stashed:e.stashed||false,flexSettings:{...{designtime:S.Default},...e.flexSettings},binding:W(e.requestGroupId),templateEdit:e.templateEdit}}return u},false);
//# sourceMappingURL=HeaderFacet.js.map