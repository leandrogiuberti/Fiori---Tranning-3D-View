{"version":3,"file":"TemplateModel.js","names":["TemplateModel","_dec","defineUI5Class","_class","_BaseObject","pageConfig","oMetaModel","_this","call","this","oConfigModel","JSONModel","setSizeLimit","Number","MAX_VALUE","bConfigLoaded","that","fnGetObject","_getObject","bind","sPath","oContext","setData","fnCreateMetaBindingContext","createBindingContext","fnCreateConfigBindingContext","fnSetData","_assertThisInitialized","_inheritsLoose","_proto","prototype","dataToSet","mParameters","fnCallBack","oBindingContext","bNoResolve","noResolve","sResolvedPath","getObject","destroy","apply","BaseObject"],"sources":["./TemplateModel.ts"],"sourcesContent":["import { defineUI5Class } from \"sap/fe/base/ClassSupport\";\nimport BaseObject from \"sap/ui/base/Object\";\nimport type Context from \"sap/ui/model/Context\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\n// We are overriding internal from the JSONModel so this makes sense\ntype InternalJSONModel = JSONModel & {\n\t_getObject(sPath: string, oContext?: Context): object;\n};\n@defineUI5Class(\"sap.fe.core.TemplateModel\")\nclass TemplateModel extends BaseObject {\n\tpublic oMetaModel: ODataMetaModel;\n\n\tpublic oConfigModel: JSONModel;\n\n\tpublic bConfigLoaded: boolean;\n\n\tpublic fnCreateMetaBindingContext: Function;\n\n\tpublic fnCreateConfigBindingContext: Function;\n\n\tpublic fnSetData: Function;\n\n\tconstructor(pageConfig: Function | object, oMetaModel: ODataMetaModel) {\n\t\tsuper();\n\t\tthis.oMetaModel = oMetaModel;\n\t\tthis.oConfigModel = new JSONModel();\n\t\t// don't limit aggregation bindings\n\t\tthis.oConfigModel.setSizeLimit(Number.MAX_VALUE);\n\t\tthis.bConfigLoaded = false;\n\t\t// eslint-disable-next-line @typescript-eslint/no-this-alias\n\t\tconst that = this;\n\n\t\tif (typeof pageConfig === \"function\") {\n\t\t\tconst fnGetObject = (this.oConfigModel as InternalJSONModel)._getObject.bind(this.oConfigModel);\n\t\t\t(this.oConfigModel as InternalJSONModel)._getObject = function (sPath: string, oContext: Context): Object {\n\t\t\t\tif (!that.bConfigLoaded) {\n\t\t\t\t\tthis.setData(pageConfig());\n\t\t\t\t}\n\t\t\t\treturn fnGetObject(sPath, oContext);\n\t\t\t};\n\t\t} else {\n\t\t\tthis.oConfigModel.setData(pageConfig);\n\t\t}\n\n\t\tthis.fnCreateMetaBindingContext = this.oMetaModel.createBindingContext.bind(this.oMetaModel);\n\t\tthis.fnCreateConfigBindingContext = this.oConfigModel.createBindingContext.bind(this.oConfigModel);\n\t\tthis.fnSetData = this.oConfigModel.setData.bind(this.oConfigModel);\n\n\t\tthis.oConfigModel.createBindingContext = this.createBindingContext.bind(this);\n\t\tthis.oConfigModel.setData = this.setData.bind(this);\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\treturn this.oConfigModel;\n\t}\n\n\t/**\n\t * Overwrite the standard setData to keep track whether the external configuration has been loaded or not.\n\t * @param dataToSet The data to set to the json model containing the configuration\n\t */\n\tsetData(dataToSet: object): void {\n\t\tthis.fnSetData(dataToSet);\n\t\tthis.bConfigLoaded = true;\n\t}\n\n\tcreateBindingContext(sPath: string, oContext?: Context, mParameters?: { noResolve?: boolean }, fnCallBack?: Function): Context {\n\t\tlet oBindingContext;\n\t\tconst bNoResolve = mParameters && mParameters.noResolve;\n\n\t\toBindingContext = this.fnCreateConfigBindingContext(sPath, oContext, mParameters, fnCallBack);\n\t\tconst sResolvedPath = !bNoResolve && oBindingContext?.getObject();\n\t\tif (sResolvedPath && typeof sResolvedPath === \"string\") {\n\t\t\toBindingContext = this.fnCreateMetaBindingContext(sResolvedPath, oContext, mParameters, fnCallBack);\n\t\t}\n\n\t\treturn oBindingContext;\n\t}\n\n\tdestroy(): void {\n\t\tthis.oConfigModel.destroy();\n\t\tJSONModel.prototype.destroy.apply(this);\n\t}\n}\n\nexport default TemplateModel;\n"],"mappings":";;;;seAMA,IAKMA,GAAaC,EADlBC,EAAe,6BAA4BD,EAAAE,EAAA,SAAAC,GAc3C,SAAAJ,EAAYK,EAA+BC,GAA4B,IAAAC,EACtEA,EAAAH,EAAAI,KAAAC,OAAOA,KACPF,EAAKD,WAAaA,EAClBC,EAAKG,aAAe,IAAIC,EAExBJ,EAAKG,aAAaE,aAAaC,OAAOC,WACtCP,EAAKQ,cAAgB,MAErB,MAAMC,EAAIT,EAEV,UAAWF,IAAe,WAAY,CACrC,MAAMY,EAAeV,EAAKG,aAAmCQ,WAAWC,KAAKZ,EAAKG,cACjFH,EAAKG,aAAmCQ,WAAa,SAAUE,EAAeC,GAC9E,IAAKL,EAAKD,cAAe,CACxBN,KAAKa,QAAQjB,IACd,CACA,OAAOY,EAAYG,EAAOC,EAC3B,CACD,KAAO,CACNd,EAAKG,aAAaY,QAAQjB,EAC3B,CAEAE,EAAKgB,2BAA6BhB,EAAKD,WAAWkB,qBAAqBL,KAAKZ,EAAKD,YACjFC,EAAKkB,6BAA+BlB,EAAKG,aAAac,qBAAqBL,KAAKZ,EAAKG,cACrFH,EAAKmB,UAAYnB,EAAKG,aAAaY,QAAQH,KAAKZ,EAAKG,cAErDH,EAAKG,aAAac,qBAAuBjB,EAAKiB,qBAAqBL,KAAIZ,GACvEA,EAAKG,aAAaY,QAAUf,EAAKe,QAAQH,KAAIZ,GAG7C,OAAOA,EAAKG,cAAYiB,EAAApB,EACzB,CAEAqB,EAAA5B,EAAAI,GAAA,IAAAyB,EAAA7B,EAAA8B,UAAAD,EAIAP,QAAA,SAAAA,EAAQS,GACPtB,KAAKiB,UAAUK,GACftB,KAAKM,cAAgB,IACtB,EAACc,EAEDL,qBAAA,SAAAA,EAAqBJ,EAAeC,EAAoBW,EAAuCC,GAC9F,IAAIC,EACJ,MAAMC,EAAaH,GAAeA,EAAYI,UAE9CF,EAAkBzB,KAAKgB,6BAA6BL,EAAOC,EAAUW,EAAaC,GAClF,MAAMI,GAAiBF,GAAcD,GAAiBI,YACtD,GAAID,UAAwBA,IAAkB,SAAU,CACvDH,EAAkBzB,KAAKc,2BAA2Bc,EAAehB,EAAUW,EAAaC,EACzF,CAEA,OAAOC,CACR,EAACL,EAEDU,QAAA,SAAAA,IACC9B,KAAKC,aAAa6B,UAClB5B,EAAUmB,UAAUS,QAAQC,MAAM/B,KACnC,EAAC,OAAAT,CAAA,CAxE0C,CAChByC,KAAUtC,GAAA,OA0EvBH,CAAa","ignoreList":[]}