/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/ui/VersionInfo","sap/ui/core/Lib","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(e,i,t,a,n){"use strict";function r(e){return new Promise((i,t)=>{sap.ui.require([e],t=>{if(!(t&&t.__esModule)){t=t===null||!(typeof t==="object"&&e.endsWith("/library"))?{default:t}:t;Object.defineProperty(t,"__esModule",{value:true})}i(t)},e=>{t(e)})})}var s={};function o(e,i){e.prototype=Object.create(i.prototype),e.prototype.constructor=e,l(e,i)}function l(e,i){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e},l(e,i)}const u={SmartSummarize:{intent:"IntelligentPrompt-summarize",library:"ux.eng.fioriai.reuse",imports:"ux/eng/fioriai/reuse/summary/SmartSummary"},MagicFiltering:{intent:"IntelligentPrompt-filter",library:"ux.eng.fioriai.reuse",imports:"ux/eng/fioriai/reuse/easyfilter/EasyFilter"},ErrorExplanation:{intent:"IntelligentPrompt-explain",library:"ux.eng.fioriai.reuse",imports:"ux/eng/fioriai/reuse/errorexplanation/ErrorExplanation"},EasyEdit:{intent:"IntelligentPrompt-fill",library:"ux.eng.fioriai.reuse",imports:"ux/eng/fioriai/reuse/easyfill/EasyFill"}};const c={Chart:true,MicroChart:true,Collaboration:false,UShell:true,IntentBasedNavigation:true,AppState:true,InsightsSupported:false,ContextSharingSupported:false,SmartSummarize:false,MagicFiltering:false,EasyEdit:false,ErrorExplanation:false,DisableInputAssistance:false,HiddenDraft:false,loadLibrary:async e=>p.resolveLibrary(e)};s.DefaultEnvironmentCapabilities=c;let p=function(a){function n(){var e;for(var i=arguments.length,t=new Array(i),n=0;n<i;n++){t[n]=arguments[n]}e=a.call(this,...t)||this;e.optionalFeatureLibraries={};return e}s.EnvironmentCapabilitiesService=n;o(n,a);var l=n.prototype;l.prepareFeature=async function e(i){const a=this.optionalFeatureLibraries[i];if(!a){throw new Error(`Feature '${i}' is unavailable`)}await t.load(a)};l.initialize=async function a(){const s=this.getContext();this.environmentCapabilities=Object.assign({},c);const o=sap.ui.require("sap/ushell/Container");const l=await i.load();this.environmentCapabilities.Chart=l.libraries.some(e=>e.name==="sap.viz");this.environmentCapabilities.MicroChart=l.libraries.some(e=>e.name==="sap.suite.ui.microchart");this.environmentCapabilities.Collaboration=l.libraries.some(e=>e.name==="sap.suite.ui.commons");if(this.environmentCapabilities.Collaboration){await n.resolveLibrary("sap.suite.ui.commons")}this.environmentCapabilities.UShell=!!o;this.environmentCapabilities.IntentBasedNavigation=!!o;this.environmentCapabilities.InsightsSupported=l.libraries.some(e=>e.name==="sap.insights");this.environmentCapabilities.ContextSharingSupported=l.libraries.some(e=>e.name==="sap.insights");const p=s.scopeObject.getManifestEntry("sap.fe")?.app?.hideDraft;if(p?.enabled){this.environmentCapabilities.HiddenDraft={enabled:true,stayOnCurrentPageAfterSave:p.stayOnCurrentPageAfterSave,stayOnCurrentPageAfterCancel:p.stayOnCurrentPageAfterCancel,hideCreateNext:p.hideCreateNext}}const f=await(o?.getServiceAsync("Navigation"));for(const[i,a]of Object.entries(u)){this.environmentCapabilities[i]=false;if(f){try{const{url:e}=await f.resolveIntent(`#${a.intent}`);this.optionalFeatureLibraries[i]={name:a.library,url:e,imports:a.imports};if(a.imports){try{await t.load(this.optionalFeatureLibraries[i]);await r(a.imports);this.environmentCapabilities[i]=true}catch(e){this.environmentCapabilities[i]=false}}else{this.environmentCapabilities[i]=true}}catch(t){e.info(`Feature unavailable ${i}: ${t?.message}`)}}}this.environmentCapabilities=Object.assign(this.environmentCapabilities,s.settings)};n.resolveLibrary=async function e(i){return new Promise(function(e){t.load({name:`${i}`}).then(function(){e(true);return}).catch(function(){e(false)})})};l.setCapabilities=function e(i){this.environmentCapabilities=i};l.setCapability=function e(i,t){this.environmentCapabilities[i]=t};l.getCapabilities=function e(){return this.environmentCapabilities};l.isInsightsEnabled=async function e(){return new Promise(async e=>{try{const i=await n.resolveLibrary("sap.insights");if(i){await n.resolveLibrary("sap.ui.comp");sap.ui.require(["sap/insights/CardHelper"],async i=>{try{await i.getServiceAsync("UIService");e(!await m())}catch{e(false)}})}else{e(false)}}catch{e(false)}})};l.isContextSharingEnabled=async function e(){const i=await n.resolveLibrary("sap.insights");if(i){await n.resolveLibrary("sap.ui.comp");try{await r("sap/insights/channels/ContextChannel")}catch(e){return false}return true}else{return false}};l.getInterface=function e(){return this};return n}(a);s.EnvironmentCapabilitiesService=p;let f=function(e){function i(){return e.apply(this,arguments)||this}s.EnvironmentServiceFactory=i;o(i,e);var t=i.prototype;t.createInstance=async function e(i){const t=new p(i);await t.initialize();return t};return i}(n);s.EnvironmentServiceFactory=f;async function m(){let e=false;try{await p.resolveLibrary("sap.suite.ui.commons");const{default:i}=await r("sap/suite/ui/commons/collaboration/CollaborationHelper");e=await i.isTeamsModeActive()}catch{return false}return e}s.getMSTeamsActive=m;return s},false);
//# sourceMappingURL=EnvironmentServiceFactory.js.map