/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(t,e,i){"use strict";function o(t){return new Promise((e,i)=>{sap.ui.require([t],i=>{if(!(i&&i.__esModule)){i=i===null||!(typeof i==="object"&&t.endsWith("/library"))?{default:i}:i;Object.defineProperty(i,"__esModule",{value:true})}e(i)},t=>{i(t)})})}var a={};function n(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,r(t,e)}function r(t,e){return r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},r(t,e)}let c=function(e){function i(){return e.apply(this,arguments)||this}a.CollaborativeToolsService=i;n(i,e);var r=i.prototype;r.init=function t(){this.collaborationService={isInitialized:false};this.initPromise=Promise.resolve(this)};r.getInterface=function t(){return this};r.initializeMSTeams=async function e(){try{const t=await this.getCollaborationServices();this.collaborationService.isInitialized=true;this.collaborationService.teamsHelperService=t.oTeamsHelperService;this.collaborationService.isContactsCollaborationSupported=typeof t.oTeamsHelperService.isContactsCollaborationSupported==="function"&&t.oTeamsHelperService.isContactsCollaborationSupported();this.collaborationService.cmHelperService=t.oCMHelperService}catch(e){t.info("Couldn't evaluate the support for contacts collaboration in MS Teams")}};r.getMailPopoverFromMsTeamsIntegration=async function t(e){if(!this.collaborationService.isInitialized){await this.initializeMSTeams()}try{return await(this.collaborationService.teamsHelperService?.enableContactsCollaboration(e))}catch{return undefined}};r.isContactsCollaborationSupported=async function t(){if(!this.collaborationService.isInitialized){await this.initializeMSTeams()}return this.collaborationService.isContactsCollaborationSupported===true};r.getTeamContactStatus=async function t(e){if(!this.collaborationService.isInitialized){await this.initializeMSTeams()}if(!this.collaborationService.isContactsCollaborationSupported){return undefined}try{return await(this.collaborationService.teamsHelperService?.getTeamsContactStatus(e))}catch{return undefined}};r.getTeamContactOptions=async function t(){if(!this.collaborationService.isInitialized){await this.initializeMSTeams()}if(!this.collaborationService.isContactsCollaborationSupported){return undefined}if(!this.collaborationService.contactOptions){try{this.collaborationService.contactOptions=await(this.collaborationService.teamsHelperService?.getTeamsContactCollabOptions())}catch{return undefined}}return this.collaborationService.contactOptions};r.getTeamContactOption=async function t(e){const i=await this.getTeamContactOptions();let o;if(i){for(let t=0;t<i.length;t++){if(i[t].key===e){o=i[t];break}}}return o};r.getTeamsCollabOptionsViaShare=async function t(e){if(!this.collaborationService.isInitialized){await this.initializeMSTeams()}return this.collaborationService.teamsHelperService?.getOptions(e)};r.getCollaborationManagerOption=async function t(){if(!this.collaborationService.isInitialized){await this.initializeMSTeams()}return this.collaborationService.cmHelperService?.getOptions()};r.getCollaborationServices=async function t(){const{default:e}=await o("sap/suite/ui/commons/collaboration/ServiceContainer");return e.getCollaborationServices()};return i}(e);a.CollaborativeToolsService=c;let s=function(t){function e(){return t.apply(this,arguments)||this}n(e,t);var i=e.prototype;i.createInstance=async function t(e){const i=new c(e);return i.initPromise};return e}(i);s.CollaborativeToolsServiceClass=c;return s},false);
//# sourceMappingURL=CollaborativeToolsServiceFactory.js.map