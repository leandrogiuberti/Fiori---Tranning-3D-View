/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/ManifestWrapper","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/TypeGuards","sap/ui/core/service/Service","sap/ui/core/service/ServiceFactory"],function(e,t,i,n,r){"use strict";var o={};var a=i.isProperty;function s(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,c(e,t)}function c(e,t){return c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},c(e,t)}let u=function(i){function n(){var e;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++){n[r]=arguments[r]}e=i.call(this,...n)||this;e.pageConfigurations=new Map;return e}o.InlineEditService=n;s(n,i);var r=n.prototype;r.init=function e(){this.initPromise=new Promise(async e=>{this.appComponent=i.prototype.getContext.bind(this)().scopeObject;await this.computePageConfigurations();e(this)})};r.computePageConfigurations=async function e(){const t=this.appComponent.getModel();if(t?.isA?.("sap.ui.model.odata.v4.ODataModel")){await t.getMetaModel().requestObject("/$EntityContainer/");const e=this.appComponent.getManifestEntry("sap.ui5")?.routing?.targets??{};for(const i in e){const n=this.getPageConfiguration(e[i].options?.settings||undefined,t.getMetaModel());if(n){this.pageConfigurations.set(i,n)}}}};r.getInlineConnectedProperties=function e(t,i){const n=this.pageConfigurations.get(t)?.connectedProperties;if(!n){return[]}for(const e of n){if(e.includes(i)){e.sort((e,t)=>{if(e===i)return-1;if(t===i)return 1;return 0});return e}}return[]};r.getAssociatedDataModelObject=function e(i,n,r){const o=i.createBindingContext(r);if(n.includes("com.sap.vocabularies.UI.v1.FieldGroup")){n=n.replace(`@${"com.sap.vocabularies.UI.v1.FieldGroup"}`,`$Type/@${"com.sap.vocabularies.UI.v1.FieldGroup"}`)}else if(n.includes("com.sap.vocabularies.UI.v1.Identification")){n=n.replace(`@${"com.sap.vocabularies.UI.v1.Identification"}`,`$Type/@${"com.sap.vocabularies.UI.v1.Identification"}`)}else if(n.includes("com.sap.vocabularies.UI.v1.LineItem")){n=n.replace(`@${"com.sap.vocabularies.UI.v1.LineItem"}`,`$Type/@${"com.sap.vocabularies.UI.v1.LineItem"}`)}const a=o?i.createBindingContext(n,o):null;return a?t.getInvolvedDataModelObjects(a,o):undefined};r.getPageConfiguration=function t(i,n){if(!i){return null}const r=new e(i);if(!r.hasInlineEdit()){return{active:false,enabledProperties:[],disabledProperties:[],connectedProperties:[]}}let o=i.contextPath;if(!o){o=i.entitySet?`/${i.entitySet}`:undefined}return{active:true,enabledProperties:this.getTargetPropertiesForInlineEdit(r.getInlineEditEnabledFields(),o,n),disabledProperties:this.getTargetPropertiesForInlineEdit(r.getInlineEditDisabledFields(),o,n),connectedProperties:this.getConnectedPropertiesForPage(r.getInlineConnectedFields(),o,n)}};r.getConnectedPropertiesForPage=function e(t,i,n){const r=[];for(const e of t){const t=Array.isArray(e)?e:[e];r.push(this.getTargetPropertiesForInlineEdit(t,i,n))}return r};r.getTargetPropertiesForInlineEdit=function e(t,i,r){if(!i){return[]}let o=[];for(const e of t){const t=this.getAssociatedDataModelObject(r,e,i);if(t&&t.targetObject){o=o.concat(n.getPropertiesForInlineEdit(t.targetObject))}}return o};n.getPropertiesForInlineEdit=function e(t){if(!t){return[]}if(a(t)){return[t.fullyQualifiedName]}if(t.$Type){switch(t.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataPointType":return n.getPropertiesForInlineEdit(t.Value?.$target);case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":return n.getPropertiesForInlineEdit(t.Target?.$target)}}if(t.term){switch(t.term){case"com.sap.vocabularies.UI.v1.FieldGroup":return t.Data.reduce((e,t)=>e.concat(n.getPropertiesForInlineEdit(t)),[]);case"com.sap.vocabularies.UI.v1.Identification":case"com.sap.vocabularies.UI.v1.LineItem":return t.reduce((e,t)=>e.concat(n.getPropertiesForInlineEdit(t)),[])}}return[]};r.doesPageHaveInlineEdit=function e(t){return this.pageConfigurations.get(t)?.active??false};r.isPropertyConsideredForInlineEdit=function e(t,i){if(i===""){return false}const n=this.pageConfigurations.get(t);if(n){return(n.enabledProperties.includes(i)||n.enabledProperties.length===0)&&!n.disabledProperties.includes(i)}return false};return n}(n);o.InlineEditService=u;let p=function(e){function t(){return e.apply(this,arguments)||this}o=t;s(t,e);var i=t.prototype;i.createInstance=async function e(t){const i=new u(t);return i.initPromise};return t}(r);o=p;return o},false);
//# sourceMappingURL=InlineEditServiceFactory.js.map