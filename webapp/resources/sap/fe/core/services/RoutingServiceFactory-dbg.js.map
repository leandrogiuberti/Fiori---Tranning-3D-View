{"version":3,"names":["RoutingServiceEventing","_dec","defineUI5Class","_dec2","event","_dec3","_dec4","_class","_class2","_EventProvider","_this","_len","arguments","length","args","Array","_key","call","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_inheritsLoose","EventProvider","_applyDecoratedDescriptor","prototype","configurable","enumerable","writable","initializer","RoutingService","_Service","_this2","_len2","_key2","navigationInfoQueue","enabled","bindingCleanupPromises","_exports","_proto","init","oContext","getContext","scopeType","oAppComponent","scopeObject","oModel","getModel","oMetaModel","getMetaModel","oRouter","getRouter","oRouterProxy","getRouterProxy","eventProvider","oRoutingConfig","getManifestEntry","routing","_parseRoutingConfiguration","oAppConfig","outbounds","crossNavigation","initPromise","Promise","resolve","beforeExit","detachRouteMatched","_fnOnRouteMatched","detachBeforeRouteMatched","_fnOnBeforeRouteMatched","fireEvent","exit","destroy","addBindingCleanupPromise","promise","push","waitForBindingCleanup","all","isFCL","config","routerClass","_mTargets","targets","sTargetName","Object","keys","assign","targetName","contextPattern","undefined","viewLevel","_getViewLevelFromPattern","routingHints","_mRoutes","routes","oRouteManifestInfo","aRouteTargets","getRouteTargetNames","target","sRouteName","name","sRoutePattern","pattern","indexOf","Log","warning","iRouteLevel","routeLevel","item","sParentTargetName","parent","routerHashKeys","RouterProxy","extractEntitySetsFromHash","split","FCLLevel","controlAggregation","forEach","aLevel0RouteNames","aLevel1RouteNames","sDefaultRouteName","sName","iLevel","sDefaultTargetName","slice","sContextPath","oSettings","options","settings","contextPath","entitySet","map","sTargetKey","sort","a","b","fullContextPath","parentOf","navigation","sNavName","targetRoute","detail","route","startsWith","sPattern","replace","regex","RegExp","match","_getRouteInformation","_getTargetInformation","_getComponentId","sOwnerId","sComponentId","substring","getTargetInformationFor","componentOrView","correctTargetName","getTargetName","targetComponentId","_sOwnerId","getId","id","viewId","getTargetNameForView","view","pageComponent","Component","getOwnerComponentFor","getLastSemanticMapping","oLastSemanticMapping","setLastSemanticMapping","oMapping","getHashFromRoute","context","routeName","parameterMapping","targetURLPromise","SemanticKeyHelper","getSemanticPath","prepareParameters","then","parameters","getURL","navigateTo","mParameterMapping","bPreserveHistory","delayedUsage","sTargetURLPromise","bIsStickyMode","ModelHelper","isStickySessionSupported","mParameters","targetUrl","navigateFunction","navToHash","sTargetRoute","oParametersPromise","getPath","aContextPathParts","aAllResolvedParameterPromises","sParameterKey","sParameterMappingExpression","oParsedExpression","BindingInfo","parse","aParts","parts","aResolvedParameterPromises","oPathPart","aRelativeParts","path","aLocalParts","localContextPath","join","localContext","bindContext","getBoundContext","oMetaContext","getMetaContext","requestProperty","oValue","oPropertyInfo","getObject","sEdmType","$Type","ODataUtils","formatLiteral","aResolvedParameters","value","formatter","apply","key","aAllResolvedParameters","oParameters","oResolvedParameter","oError","error","_fireRouteMatchEvents","EditState","cleanProcessedEditState","navigateToContext","viewData","currentTargetInfo","routeParametersPromise","isStickyMode","targetPath","navigationInfo","oRouteDetail","isA","sTargetPath","_getPathFromContext","bExitOnNavigateBackToRoot","exitFromApp","createOnNavigateParameters","sLayout","_calculateLayout","oNavigationInfo","bTargetEditable","editable","bPersistOPScroll","persistOPScroll","bShowPlaceholder","showPlaceholder","reason","redirectedToNonDraft","updateFCLLevel","recreateContext","useContext","checkNoHashChange","sCurrentHashNoAppState","getHash","routeInfoByHash","getRouteInfoByHash","mEventParameters","routeInformation","sCurrentRouteName","routePattern","sCurrentRoutePattern","views","aCurrentViews","setFocusForced","forceFocus","transient","includes","navMode","sap","ui","require","Container","shellServiceHelper","getShellServices","parsedUrl","parseShellHash","document","location","hash","navigationService","getServiceAsync","href","getHref","semanticObject","action","params","applicationUrlBasedOnIframe","getInframeUrl","url","URL","encodeURI","window","origin","pathname","openWindow","oRouteInfo","oRoute","sLastTargetName","oTarget","messageHandling","removeUnboundTransitionMessages","oRouteParameters","navTo","preserveHistory","noPreservationCache","bNavigated","pop","navigateToRoute","sTargetRouteName","sTargetURL","isCurrentStateImpactedBy","sPath","test","sSemanticPath","technicalPath","semanticPath","getPathToNavigateBack","_checkIfContextSupportsSemanticPath","metaModel","MetaModelConverter","getInvolvedDataModelObjects","targetObject","isDraftRoot","getProperty","entitySetName","getSemanticKeys","getHeaderContext","layout","findLayoutForHash","getRootViewController","calculateLayout","keepCurrentLayout","_onBeforeRouteMatched","oEvent","viewPreloaderService","getViewPreloaderService","setCache","getParameter","bPlaceholderEnabled","Placeholder","isPlaceholderEnabled","oRootView","getRootControl","BusyLocker","lock","_isNavigationTriggeredByRouterProxy","history","state","feLevel","_onRouteMatched","oAppStateHandler","getAppStateHandler","isLocked","unlock","getParameters","checkIfRouteChangedByIApp","NavigationReason","AppStateChanged","resetRouteChangedByIApp","checkRestoreHistoryWasTriggered","RestoreHistory","resetRestoreHistoryFlag","restoreHistory","resolveRouteMatch","catch","attachRouteMatched","oData","fnFunction","oListener","attachEvent","attachBeforeRouteMatched","detachEvent","attachAfterRouteMatched","detachAfterRouteMatched","initializeRouting","getEnvironmentCapabilities","getCapabilities","Collaboration","default","CollaborationHelper","__ui5_require_async","processAndExpandHash","bind","resetEditState","manageStartupMode","onRestore","bIsIappState","getHashChanger","oStartupParameters","getStartupParameters","bHasStartUpParameters","sHash","preferredMode","toUpperCase","_manageCreateStartup","_manageDeepLinkStartup","_managedPreferredModeEdit","getDefaultCreateHash","AppStartupHelper","getContextPath","getCreateStartupHash","sNewHash","replaceHash","setStartupModeAutoCreate","setStartupModeCreate","getDeepLinkStartupHash","app","inboundParameterForTargetResolution","oDeepLink","sTechnicalPath","setStartupModeDeeplink","startupParameters","resultingHash","shouldEdit","verifyEditAnnotations","parameter","getOutbounds","getRoutingHints","getInterface","Service","RoutingServiceFactory","_ServiceFactory","_proto2","createInstance","oServiceContext","oRoutingService","ServiceFactory"],"sourceRoot":".","sources":["RoutingServiceFactory.ts"],"sourcesContent":["import type { EntitySet } from \"@sap-ux/vocabularies-types/Edm\";\nimport Log from \"sap/base/Log\";\n\nimport type { Route } from \"@ui5/manifest/types/manifest\";\nimport { defineUI5Class, event } from \"sap/fe/base/ClassSupport\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type { StartupParameters } from \"sap/fe/core/AppComponent\";\nimport type { NavigationConfiguration } from \"sap/fe/core/TemplateComponent\";\nimport BusyLocker from \"sap/fe/core/controllerextensions/BusyLocker\";\nimport Placeholder from \"sap/fe/core/controllerextensions/Placeholder\";\nimport messageHandling from \"sap/fe/core/controllerextensions/messageHandler/messageHandling\";\nimport NavigationReason from \"sap/fe/core/controllerextensions/routing/NavigationReason\";\nimport RouterProxy from \"sap/fe/core/controllerextensions/routing/RouterProxy\";\nimport AppStartupHelper from \"sap/fe/core/helpers/AppStartupHelper\";\nimport EditState from \"sap/fe/core/helpers/EditState\";\nimport { getRouteTargetNames } from \"sap/fe/core/helpers/ManifestHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport SemanticKeyHelper from \"sap/fe/core/helpers/SemanticKeyHelper\";\nimport BindingInfo from \"sap/ui/base/BindingInfo\";\nimport EventProvider from \"sap/ui/base/EventProvider\";\nimport type { PropertyBindingInfo } from \"sap/ui/base/ManagedObject\";\nimport Component from \"sap/ui/core/Component\";\nimport type ComponentContainer from \"sap/ui/core/ComponentContainer\";\nimport type { ManifestOutboundEntry, RoutingConfiguration, RoutingTarget } from \"sap/ui/core/Manifest\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type { Route$MatchedEventParameters } from \"sap/ui/core/routing/Route\";\nimport type Router from \"sap/ui/core/routing/Router\";\nimport type { Router$RouteMatchedEvent } from \"sap/ui/core/routing/Router\";\nimport Service from \"sap/ui/core/service/Service\";\nimport ServiceFactory from \"sap/ui/core/service/ServiceFactory\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport ODataUtils from \"sap/ui/model/odata/v4/ODataUtils\";\nimport openWindow from \"sap/ui/util/openWindow\";\nimport type Container from \"sap/ushell/Container\";\nimport type Navigation from \"sap/ushell/services/Navigation\";\nimport type { ServiceContext } from \"types/metamodel_types\";\nimport * as MetaModelConverter from \"../converters/MetaModelConverter\";\n\ntype RoutingServiceSettings = {};\n@defineUI5Class(\"sap.fe.core.services.RoutingServiceEventing\")\nclass RoutingServiceEventing extends EventProvider {\n\t@event()\n\tbeforeRouteMatched!: Function;\n\n\t@event()\n\trouteMatched!: Function;\n\n\t@event()\n\tafterRouteMatched!: Function;\n}\n\nexport type RoutingEventParameters = Route$MatchedEventParameters & {\n\tnavigationInfo?: { reason?: NavigationReason };\n\trouteInformation?: unknown;\n\troutePattern?: string;\n\tconfig: { pattern?: string };\n};\n\nexport type CreateOnNavigateParameters =\n\t| { mode: \"Async\"; createContextPromise: Promise<Context> }\n\t| { mode: \"Deferred\"; listBinding: ODataListBinding; parentContext?: Context; data?: object };\n\nexport type RoutingNavigationInfo = {\n\tcreateOnNavigateParameters?: CreateOnNavigateParameters;\n\tbTargetEditable?: boolean;\n\tbPersistOPScroll?: boolean;\n\tbShowPlaceholder?: boolean;\n\tuseContext?: Context;\n\treason?: NavigationReason;\n\tredirectedToNonDraft?: string;\n\tbActionCreate?: boolean;\n};\n\nexport type RoutingNavigationParameters = {\n\tcheckNoHashChange?: boolean;\n\tcreateOnNavigateParameters?: CreateOnNavigateParameters;\n\teditable?: boolean;\n\ttransient?: boolean;\n\tpersistOPScroll?: boolean;\n\tFCLLevel?: number;\n\tupdateFCLLevel?: number;\n\tpreserveHistory?: boolean;\n\tnoPreservationCache?: boolean;\n\trecreateContext?: boolean;\n\tforceFocus?: boolean;\n\ttargetPath?: string;\n\tshowPlaceholder?: boolean;\n\treason?: NavigationReason;\n\tcallExtension?: boolean;\n\tlayout?: string;\n\tkeepCurrentLayout?: boolean;\n\tnavMode?: string;\n\tredirectedToNonDraft?: string;\n\tsemanticPath?: string | undefined;\n};\n\nexport type RoutingParameterMap = {\n\t[k: string]: unknown;\n};\n\nexport type SemanticMapping = {\n\tsemanticPath: string;\n\ttechnicalPath: string;\n};\ntype MinimalPageSetting = {\n\tcontextPath?: string;\n\tentitySet?: string;\n\tfullContextPath?: string;\n\tnavigation?: Record<string, NavigationConfiguration>;\n};\n\ntype InternalRouteDefinition = {\n\tname: string;\n\tpattern: string;\n\ttargets: string[];\n\trouteLevel: number;\n};\n\ntype ResolvedParameters = { key: string; value: unknown };\n\nexport class RoutingService extends Service<RoutingServiceSettings> {\n\toAppComponent!: AppComponent;\n\n\toModel!: ODataModel;\n\n\toMetaModel!: ODataMetaModel;\n\n\toRouter!: Router;\n\n\toRouterProxy!: RouterProxy;\n\n\teventProvider!: EventProvider;\n\n\tinitPromise!: Promise<RoutingService>;\n\n\toutbounds!: Record<string, ManifestOutboundEntry>;\n\n\t_mTargets!: Record<string, RoutingTarget>;\n\n\t_mRoutes!: Record<string, InternalRouteDefinition>;\n\n\toLastSemanticMapping?: SemanticMapping;\n\n\tbExitOnNavigateBackToRoot?: boolean;\n\n\tsCurrentRouteName?: string;\n\n\tsCurrentRoutePattern?: string;\n\n\taCurrentViews?: (View | ComponentContainer)[];\n\n\tnavigationInfoQueue: RoutingNavigationInfo[] = [];\n\n\tsContextPath!: string;\n\n\t_fnOnRouteMatched!: (ev: Router$RouteMatchedEvent) => void;\n\n\t_fnOnBeforeRouteMatched!: (ev: Router$RouteMatchedEvent) => void;\n\n\tenabled = false;\n\n\troutingHints?: Record<string, { parentOf: string[] }>;\n\n\tbindingCleanupPromises: Promise<void>[] = [];\n\n\tinit(): void {\n\t\tconst oContext = this.getContext();\n\t\tif (oContext.scopeType === \"component\") {\n\t\t\tthis.oAppComponent = oContext.scopeObject;\n\t\t\tthis.oModel = this.oAppComponent.getModel();\n\t\t\tthis.oMetaModel = this.oModel?.getMetaModel();\n\t\t\tthis.oRouter = this.oAppComponent.getRouter();\n\t\t\tthis.oRouterProxy = this.oAppComponent.getRouterProxy();\n\t\t\tthis.eventProvider = new RoutingServiceEventing();\n\n\t\t\tconst oRoutingConfig = this.oAppComponent.getManifestEntry(\"sap.ui5\").routing;\n\t\t\tthis._parseRoutingConfiguration(oRoutingConfig!);\n\n\t\t\tconst oAppConfig = this.oAppComponent.getManifestEntry(\"sap.app\");\n\t\t\tthis.outbounds = oAppConfig.crossNavigation?.outbounds ?? {};\n\t\t}\n\n\t\tthis.initPromise = Promise.resolve(this);\n\t}\n\n\tbeforeExit(): void {\n\t\tthis.enabled = false;\n\t\tthis.oRouter.detachRouteMatched(this._fnOnRouteMatched, this);\n\t\tthis.oRouter.detachBeforeRouteMatched(this._fnOnBeforeRouteMatched, this);\n\t\tthis.eventProvider.fireEvent(\"routeMatched\", {});\n\t}\n\n\texit(): void {\n\t\tthis.eventProvider.destroy();\n\t}\n\n\taddBindingCleanupPromise(promise: Promise<void>): void {\n\t\tthis.bindingCleanupPromises.push(promise);\n\t}\n\n\tasync waitForBindingCleanup(): Promise<void> {\n\t\tawait Promise.all(this.bindingCleanupPromises);\n\t\tthis.bindingCleanupPromises = [];\n\t}\n\n\t/**\n\t * Parse a manifest routing configuration for internal usage.\n\t * @param oRoutingConfig The routing configuration from the manifest\n\t */\n\t_parseRoutingConfiguration(oRoutingConfig: RoutingConfiguration): void {\n\t\tconst isFCL = oRoutingConfig?.config?.routerClass === \"sap.f.routing.Router\";\n\n\t\t// Information of targets\n\t\tthis._mTargets = {};\n\t\tif (oRoutingConfig?.targets) {\n\t\t\tfor (const sTargetName of Object.keys(oRoutingConfig.targets)) {\n\t\t\t\tthis._mTargets[sTargetName] = Object.assign({ targetName: sTargetName }, oRoutingConfig.targets[sTargetName]);\n\n\t\t\t\t// View level for FCL cases is calculated from the target pattern\n\t\t\t\tconst contextPattern = this._mTargets[sTargetName].contextPattern;\n\t\t\t\tif (contextPattern !== undefined) {\n\t\t\t\t\tthis._mTargets[sTargetName].viewLevel = this._getViewLevelFromPattern(contextPattern, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tthis.routingHints = {};\n\n\t\t// Information of routes\n\t\tthis._mRoutes = {};\n\t\tif (oRoutingConfig?.routes) {\n\t\t\tfor (const oRouteManifestInfo of oRoutingConfig.routes) {\n\t\t\t\tconst aRouteTargets = getRouteTargetNames(oRouteManifestInfo.target),\n\t\t\t\t\tsRouteName = oRouteManifestInfo.name,\n\t\t\t\t\tsRoutePattern = oRouteManifestInfo.pattern;\n\t\t\t\tif (!sRoutePattern) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\t// Check route pattern: all patterns need to end with ':?query:', that we use for parameters\n\t\t\t\tif (sRoutePattern.length < 8 || sRoutePattern.indexOf(\":?query:\") !== sRoutePattern.length - 8) {\n\t\t\t\t\tLog.warning(`Pattern for route ${sRouteName} doesn't end with ':?query:' : ${sRoutePattern}`);\n\t\t\t\t}\n\t\t\t\tconst iRouteLevel = this._getViewLevelFromPattern(sRoutePattern, 0);\n\t\t\t\tthis._mRoutes[sRouteName] = {\n\t\t\t\t\tname: sRouteName,\n\t\t\t\t\tpattern: sRoutePattern,\n\t\t\t\t\ttargets: aRouteTargets,\n\t\t\t\t\trouteLevel: iRouteLevel\n\t\t\t\t};\n\n\t\t\t\t// Add the parent targets in the list of targets for the route\n\t\t\t\tfor (const item of aRouteTargets) {\n\t\t\t\t\tconst sParentTargetName = this._mTargets[item].parent;\n\t\t\t\t\tif (sParentTargetName) {\n\t\t\t\t\t\taRouteTargets.push(sParentTargetName);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthis._mTargets[aRouteTargets[0]].routerHashKeys = RouterProxy.extractEntitySetsFromHash(sRoutePattern.split(\":?query:\")[0]);\n\n\t\t\t\tif (!isFCL) {\n\t\t\t\t\t// View level for non-FCL cases is calculated from the route pattern\n\t\t\t\t\tconst viewLevel = this._mTargets[aRouteTargets[0]].viewLevel;\n\t\t\t\t\tif (viewLevel === undefined || viewLevel < iRouteLevel) {\n\t\t\t\t\t\t// There are cases when different routes point to the same target. We take the\n\t\t\t\t\t\t// largest viewLevel in that case.\n\t\t\t\t\t\tthis._mTargets[aRouteTargets[0]].viewLevel = iRouteLevel;\n\t\t\t\t\t}\n\n\t\t\t\t\t// FCL level for non-FCL cases is equal to -1\n\t\t\t\t\tthis._mTargets[aRouteTargets[0]].FCLLevel = -1;\n\t\t\t\t} else if (aRouteTargets.length === 1 && this._mTargets[aRouteTargets[0]].controlAggregation !== \"beginColumnPages\") {\n\t\t\t\t\t// We're in the case where there's only 1 target for the route, and it's not in the first column\n\t\t\t\t\t// --> this is a fullscreen column after all columns in the FCL have been used\n\t\t\t\t\tthis._mTargets[aRouteTargets[0]].FCLLevel = 3;\n\t\t\t\t} else {\n\t\t\t\t\t// Other FCL cases\n\t\t\t\t\taRouteTargets.forEach((sTargetName) => {\n\t\t\t\t\t\tswitch (this._mTargets[sTargetName].controlAggregation) {\n\t\t\t\t\t\t\tcase \"beginColumnPages\":\n\t\t\t\t\t\t\t\tthis._mTargets[sTargetName].FCLLevel = 0;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tcase \"midColumnPages\":\n\t\t\t\t\t\t\t\tthis._mTargets[sTargetName].FCLLevel = 1;\n\t\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\t\tthis._mTargets[sTargetName].FCLLevel = 2;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Propagate viewLevel, contextPattern, FCLLevel and controlAggregation to parent targets\n\t\tObject.keys(this._mTargets).forEach((sTargetName: string) => {\n\t\t\tlet sParentTargetName = this._mTargets[sTargetName].parent;\n\t\t\twhile (sParentTargetName) {\n\t\t\t\tthis._mTargets[sParentTargetName].viewLevel =\n\t\t\t\t\tthis._mTargets[sParentTargetName].viewLevel || this._mTargets[sTargetName].viewLevel;\n\t\t\t\tthis._mTargets[sParentTargetName].contextPattern =\n\t\t\t\t\tthis._mTargets[sParentTargetName].contextPattern || this._mTargets[sTargetName].contextPattern;\n\t\t\t\tthis._mTargets[sParentTargetName].FCLLevel =\n\t\t\t\t\tthis._mTargets[sParentTargetName].FCLLevel || this._mTargets[sTargetName].FCLLevel;\n\t\t\t\tthis._mTargets[sParentTargetName].controlAggregation =\n\t\t\t\t\tthis._mTargets[sParentTargetName].controlAggregation || this._mTargets[sTargetName].controlAggregation;\n\t\t\t\tsTargetName = sParentTargetName;\n\t\t\t\tsParentTargetName = this._mTargets[sTargetName].parent;\n\t\t\t}\n\t\t});\n\n\t\t// Determine the root entity for the app\n\t\tconst aLevel0RouteNames = [];\n\t\tconst aLevel1RouteNames = [];\n\t\tlet sDefaultRouteName;\n\n\t\tfor (const sName in this._mRoutes) {\n\t\t\tconst iLevel = this._mRoutes[sName].routeLevel;\n\t\t\tif (iLevel === 0) {\n\t\t\t\taLevel0RouteNames.push(sName);\n\t\t\t} else if (iLevel === 1) {\n\t\t\t\taLevel1RouteNames.push(sName);\n\t\t\t}\n\t\t}\n\n\t\tif (aLevel0RouteNames.length === 1) {\n\t\t\tsDefaultRouteName = aLevel0RouteNames[0];\n\t\t} else if (aLevel1RouteNames.length === 1) {\n\t\t\tsDefaultRouteName = aLevel1RouteNames[0];\n\t\t}\n\n\t\tif (sDefaultRouteName) {\n\t\t\tconst sDefaultTargetName = this._mRoutes[sDefaultRouteName].targets.slice(-1)[0];\n\t\t\tthis.sContextPath = \"\";\n\t\t\tconst oSettings = this._mTargets[sDefaultTargetName].options?.settings as MinimalPageSetting | undefined;\n\t\t\tif (oSettings) {\n\t\t\t\tthis.sContextPath = oSettings.contextPath || `/${oSettings.entitySet}`;\n\t\t\t}\n\t\t\tif (!this.sContextPath) {\n\t\t\t\tLog.warning(\n\t\t\t\t\t`Cannot determine default contextPath: contextPath or entitySet missing in default target: ${sDefaultTargetName}`\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tLog.warning(\"Cannot determine default contextPath: no default route found.\");\n\t\t}\n\n\t\t// We need to establish the correct path to the different pages, including the navigation properties\n\t\tObject.keys(this._mTargets)\n\t\t\t.map((sTargetKey: string) => {\n\t\t\t\treturn this._mTargets[sTargetKey];\n\t\t\t})\n\t\t\t.sort((a: RoutingTarget, b: RoutingTarget) => {\n\t\t\t\treturn a.viewLevel !== undefined && b.viewLevel !== undefined && a.viewLevel < b.viewLevel ? -1 : 1;\n\t\t\t})\n\t\t\t.forEach((target: RoutingTarget) => {\n\t\t\t\t// After sorting the targets per level we can then go through their navigation object and update the paths accordingly.\n\t\t\t\tif (target.options) {\n\t\t\t\t\tconst settings = target.options.settings as MinimalPageSetting;\n\t\t\t\t\tconst sContextPath = settings.contextPath || (settings.entitySet ? `/${settings.entitySet}` : \"\");\n\t\t\t\t\tif (!settings.fullContextPath && sContextPath) {\n\t\t\t\t\t\tsettings.fullContextPath = `${sContextPath}/`;\n\t\t\t\t\t}\n\t\t\t\t\tconst parentOf: string[] = [];\n\t\t\t\t\tif (target.routerHashKeys?.[0]) {\n\t\t\t\t\t\tthis.routingHints![target.routerHashKeys?.[0]] = { parentOf: parentOf };\n\t\t\t\t\t}\n\t\t\t\t\tObject.keys(settings.navigation || {}).forEach((sNavName: string) => {\n\t\t\t\t\t\t// Check if it's a navigation property\n\t\t\t\t\t\tif (target.name === \"sap.fe.templates.ListReport\") {\n\t\t\t\t\t\t\tparentOf.push(sNavName);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst targetRoute = this._mRoutes[settings.navigation![sNavName].detail?.route];\n\n\t\t\t\t\t\tif (targetRoute && targetRoute.targets) {\n\t\t\t\t\t\t\ttargetRoute.targets.forEach((sTargetName: string) => {\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tthis._mTargets[sTargetName].options?.settings &&\n\t\t\t\t\t\t\t\t\t!this._mTargets[sTargetName].options?.settings?.fullContextPath\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tif (this._mTargets[sTargetName].options!.settings!.contextPath) {\n\t\t\t\t\t\t\t\t\t\tthis._mTargets[sTargetName].options!.settings!.fullContextPath =\n\t\t\t\t\t\t\t\t\t\t\tthis._mTargets[sTargetName].options!.settings!.contextPath + \"/\";\n\t\t\t\t\t\t\t\t\t} else if (target.viewLevel === 0) {\n\t\t\t\t\t\t\t\t\t\tthis._mTargets[sTargetName].options!.settings!.fullContextPath = `${\n\t\t\t\t\t\t\t\t\t\t\t(sNavName.startsWith(\"/\") ? \"\" : \"/\") + sNavName\n\t\t\t\t\t\t\t\t\t\t}/`;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tthis._mTargets[sTargetName].options!.settings!.fullContextPath = `${\n\t\t\t\t\t\t\t\t\t\t\tsettings.fullContextPath + sNavName\n\t\t\t\t\t\t\t\t\t\t}/`;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t}\n\n\t/**\n\t * Calculates a view level from a pattern by counting the number of segments.\n\t * @param sPattern The pattern\n\t * @param viewLevel The current level of view\n\t * @returns The level\n\t */\n\t_getViewLevelFromPattern(sPattern: string, viewLevel: number): number {\n\t\tsPattern = sPattern.replace(\":?query:\", \"\");\n\t\tconst regex = new RegExp(\"/[^/]*$\");\n\t\tif (sPattern && sPattern[0] !== \"/\" && sPattern[0] !== \"?\") {\n\t\t\tsPattern = `/${sPattern}`;\n\t\t}\n\t\tif (sPattern.length) {\n\t\t\tsPattern = sPattern.replace(regex, \"\");\n\t\t\tif (this.oRouter.match(sPattern) || sPattern === \"\") {\n\t\t\t\treturn this._getViewLevelFromPattern(sPattern, ++viewLevel);\n\t\t\t} else {\n\t\t\t\treturn this._getViewLevelFromPattern(sPattern, viewLevel);\n\t\t\t}\n\t\t} else {\n\t\t\treturn viewLevel;\n\t\t}\n\t}\n\n\t_getRouteInformation(sRouteName?: string): InternalRouteDefinition | undefined {\n\t\tif (sRouteName === undefined) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._mRoutes[sRouteName];\n\t}\n\n\t_getTargetInformation(sTargetName?: string): RoutingTarget | undefined {\n\t\tif (sTargetName === undefined) {\n\t\t\treturn undefined;\n\t\t}\n\t\treturn this._mTargets[sTargetName];\n\t}\n\n\t_getComponentId(sOwnerId: string, sComponentId: string): string {\n\t\tif (sComponentId.indexOf(`${sOwnerId}---`) === 0) {\n\t\t\treturn sComponentId.substring(sOwnerId.length + 3);\n\t\t}\n\t\treturn sComponentId;\n\t}\n\n\t/**\n\t * Get target information for a given component.\n\t * @param componentOrView Instance of the component or view\n\t * @returns The configuration for the target\n\t */\n\tgetTargetInformationFor(componentOrView: Component | View): RoutingTarget | undefined {\n\t\tconst correctTargetName = this.getTargetName(componentOrView);\n\t\treturn this._getTargetInformation(correctTargetName);\n\t}\n\n\t/**\n\t * Get the name of the page shown in the view as defined in the manifest routing section.\n\t * @param componentOrView\n\t * @returns The name of the page\n\t */\n\tgetTargetName(componentOrView: Component | View): string | undefined {\n\t\tconst targetComponentId = this._getComponentId(\n\t\t\t(componentOrView as unknown as { _sOwnerId: string })._sOwnerId,\n\t\t\tcomponentOrView.getId()\n\t\t);\n\t\tlet correctTargetName: string | undefined;\n\t\tObject.keys(this._mTargets).forEach((targetName: string) => {\n\t\t\tif (this._mTargets[targetName].id === targetComponentId || this._mTargets[targetName].viewId === targetComponentId) {\n\t\t\t\tcorrectTargetName = targetName;\n\t\t\t}\n\t\t});\n\t\treturn correctTargetName;\n\t}\n\n\t/**\n\t * Get the name of the page shown in the view as defined in the manifest routing section.\n\t * @param view\n\t * @returns The name of the page\n\t */\n\tgetTargetNameForView(view: View): string | undefined {\n\t\tconst pageComponent = Component.getOwnerComponentFor(view);\n\t\tlet targetName = pageComponent ? this.getTargetName(pageComponent) : undefined;\n\t\tif (!targetName) {\n\t\t\ttargetName = this.getTargetName(view);\n\t\t}\n\t\treturn targetName;\n\t}\n\n\tgetLastSemanticMapping(): SemanticMapping | undefined {\n\t\treturn this.oLastSemanticMapping;\n\t}\n\n\tsetLastSemanticMapping(oMapping?: SemanticMapping): void {\n\t\tthis.oLastSemanticMapping = oMapping;\n\t}\n\n\tasync getHashFromRoute(context: Context, routeName: string | null, parameterMapping?: unknown): Promise<string> {\n\t\tif (!this.enabled) {\n\t\t\treturn Promise.resolve(\"\");\n\t\t}\n\t\tlet targetURLPromise: Promise<string | undefined>;\n\t\tif (!parameterMapping) {\n\t\t\t// if there is no parameter mapping define this mean we rely entirely on the binding context path\n\t\t\ttargetURLPromise = Promise.resolve(SemanticKeyHelper.getSemanticPath(context));\n\t\t} else {\n\t\t\ttargetURLPromise = this.prepareParameters(parameterMapping as RoutingParameterMap, routeName, context).then(\n\t\t\t\t(parameters: object | undefined) => {\n\t\t\t\t\treturn this.oRouter.getURL(routeName!, parameters);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\treturn (await targetURLPromise) as string;\n\t}\n\n\tasync navigateTo(\n\t\toContext: Context,\n\t\tsRouteName: string | null,\n\t\tmParameterMapping: unknown,\n\t\tbPreserveHistory?: boolean,\n\t\tdelayedUsage?: false\n\t): Promise<void>;\n\n\tasync navigateTo(\n\t\toContext: Context,\n\t\tsRouteName: string | null,\n\t\tmParameterMapping: unknown,\n\t\tbPreserveHistory?: boolean,\n\t\tdelayedUsage?: true\n\t): Promise<() => void>;\n\n\tasync navigateTo(\n\t\toContext: Context,\n\t\tsRouteName: string | null,\n\t\tmParameterMapping: unknown,\n\t\tbPreserveHistory?: boolean,\n\t\tdelayedUsage?: boolean\n\t): Promise<(() => void) | void>;\n\n\tasync navigateTo(\n\t\toContext: Context,\n\t\tsRouteName: string | null,\n\t\tmParameterMapping: unknown,\n\t\tbPreserveHistory?: boolean,\n\t\tdelayedUsage?: boolean\n\t): Promise<(() => void) | void> {\n\t\tif (!this.enabled) {\n\t\t\treturn Promise.resolve();\n\t\t}\n\t\tlet sTargetURLPromise, bIsStickyMode: boolean;\n\t\tif (oContext.getModel() && oContext.getModel().getMetaModel && oContext.getModel().getMetaModel()) {\n\t\t\tbIsStickyMode = ModelHelper.isStickySessionSupported(oContext.getModel().getMetaModel());\n\t\t}\n\t\tif (!mParameterMapping) {\n\t\t\t// if there is no parameter mapping define this mean we rely entirely on the binding context path\n\t\t\tsTargetURLPromise = Promise.resolve(SemanticKeyHelper.getSemanticPath(oContext));\n\t\t} else {\n\t\t\tsTargetURLPromise = this.prepareParameters(mParameterMapping as RoutingParameterMap, sRouteName, oContext).then(\n\t\t\t\t(mParameters: object | undefined) => {\n\t\t\t\t\treturn this.oRouter.getURL(sRouteName!, mParameters);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tconst targetUrl = await sTargetURLPromise;\n\t\tconst navigateFunction = (): void => {\n\t\t\tthis.oRouterProxy.navToHash(targetUrl!, bPreserveHistory, false, false, !bIsStickyMode);\n\t\t};\n\t\tif (delayedUsage === true) {\n\t\t\treturn navigateFunction; // wrong but somehow the types are annoying\n\t\t} else {\n\t\t\treturn navigateFunction();\n\t\t}\n\t}\n\n\t/**\n\t * Method to return a map of routing target parameters where the binding syntax is resolved to the current model.\n\t * @param mParameters Parameters map in the format [k: string] : ComplexBindingSyntax\n\t * @param sTargetRoute Name of the target route\n\t * @param oContext The instance of the binding context\n\t * @returns A promise which resolves to the routing target parameters\n\t */\n\tasync prepareParameters(mParameters: RoutingParameterMap, sTargetRoute: string | null, oContext: Context): Promise<object> {\n\t\tlet oParametersPromise;\n\t\ttry {\n\t\t\tconst sContextPath = oContext.getPath();\n\t\t\tconst oMetaModel: ODataMetaModel = oContext.getModel().getMetaModel();\n\t\t\tconst aContextPathParts = sContextPath.split(\"/\");\n\t\t\tconst aAllResolvedParameterPromises = Object.keys(mParameters).map(async (sParameterKey: string) => {\n\t\t\t\tconst sParameterMappingExpression = mParameters[sParameterKey];\n\t\t\t\t// We assume the defined parameters will be compatible with a binding expression\n\t\t\t\tconst oParsedExpression = BindingInfo.parse(sParameterMappingExpression);\n\t\t\t\tconst aParts = oParsedExpression.parts || [oParsedExpression];\n\t\t\t\tconst aResolvedParameterPromises = aParts.map(async function (oPathPart: PropertyBindingInfo) {\n\t\t\t\t\tconst aRelativeParts = oPathPart.path.split(\"../\");\n\t\t\t\t\t// We go up the current context path as many times as necessary\n\t\t\t\t\tconst aLocalParts = aContextPathParts.slice(0, aContextPathParts.length - aRelativeParts.length + 1);\n\t\t\t\t\tconst localContextPath = aLocalParts.join(\"/\");\n\t\t\t\t\tconst localContext =\n\t\t\t\t\t\tlocalContextPath === oContext.getPath()\n\t\t\t\t\t\t\t? oContext\n\t\t\t\t\t\t\t: oContext.getModel().bindContext(localContextPath).getBoundContext();\n\n\t\t\t\t\tconst oMetaContext = oMetaModel.getMetaContext(localContextPath + \"/\" + aRelativeParts[aRelativeParts.length - 1]);\n\t\t\t\t\treturn localContext.requestProperty(aRelativeParts[aRelativeParts.length - 1]).then(function (oValue) {\n\t\t\t\t\t\tconst oPropertyInfo = oMetaContext.getObject();\n\t\t\t\t\t\tconst sEdmType = oPropertyInfo.$Type;\n\t\t\t\t\t\treturn ODataUtils.formatLiteral(oValue, sEdmType);\n\t\t\t\t\t});\n\t\t\t\t});\n\n\t\t\t\treturn Promise.all(aResolvedParameterPromises).then((aResolvedParameters: PropertyBindingInfo) => {\n\t\t\t\t\tconst value = oParsedExpression.formatter\n\t\t\t\t\t\t? oParsedExpression.formatter.apply(this, aResolvedParameters)\n\t\t\t\t\t\t: aResolvedParameters.join(\"\");\n\t\t\t\t\treturn { key: sParameterKey, value: value };\n\t\t\t\t});\n\t\t\t});\n\n\t\t\toParametersPromise = Promise.all(aAllResolvedParameterPromises).then(function (aAllResolvedParameters: ResolvedParameters[]) {\n\t\t\t\tconst oParameters: Record<string, unknown> = {};\n\t\t\t\taAllResolvedParameters.forEach(function (oResolvedParameter: ResolvedParameters) {\n\t\t\t\t\toParameters[oResolvedParameter.key] = oResolvedParameter.value;\n\t\t\t\t});\n\t\t\t\treturn oParameters;\n\t\t\t});\n\t\t} catch (oError) {\n\t\t\tLog.error(`Could not parse the parameters for the navigation to route ${sTargetRoute}`);\n\t\t\toParametersPromise = Promise.resolve({});\n\t\t}\n\t\treturn oParametersPromise;\n\t}\n\n\t_fireRouteMatchEvents(mParameters: Route$MatchedEventParameters): void {\n\t\tthis.bindingCleanupPromises = [];\n\t\tthis.eventProvider.fireEvent(\"beforeRouteMatched\", mParameters);\n\t\tthis.eventProvider.fireEvent(\"routeMatched\", mParameters);\n\t\tthis.eventProvider.fireEvent(\"afterRouteMatched\", mParameters);\n\n\t\tEditState.cleanProcessedEditState(); // Reset UI state when all bindings have been refreshed\n\t}\n\n\t/**\n\t * Navigates to a context.\n\t * @param context The Context to be navigated to, or the list binding for creation (deferred creation)\n\t * @param [parameters] Optional, map containing the following attributes:\n\t * @param [parameters.checkNoHashChange] Navigate to the context without changing the URL\n\t * @param [parameters.asyncContext] The context is created async, navigate to (...) and\n\t *                    wait for Promise to be resolved and then navigate into the context\n\t * @param [parameters.bDeferredContext] The context shall be created deferred at the target page\n\t * @param [parameters.editable] The target page shall be immediately in the edit mode to avoid flickering\n\t * @param [parameters.bPersistOPScroll] The bPersistOPScroll will be used for scrolling to first tab\n\t * @param [parameters.updateFCLLevel] `+1` if we add a column in FCL, `-1` to remove a column, 0 to stay on the same column\n\t * @param [parameters.noPreservationCache] Do navigation without taking into account the preserved cache mechanism\n\t * @param [parameters.bRecreateContext] Force re-creation of the context instead of using the one passed as parameter\n\t * @param [parameters.bForceFocus] Forces focus selection after navigation\n\t * @param [viewData] View data\n\t * @param [viewData.navigation]\n\t * @param [currentTargetInfo] The target information from which the navigation is triggered\n\t * @param [currentTargetInfo.name]\n\t * @returns Promise which is resolved once the navigation is triggered\n\t * @final\n\t */\n\tasync navigateToContext(\n\t\tcontext: Context | ODataListBinding,\n\t\tparameters: RoutingNavigationParameters = {},\n\t\tviewData?: { navigation?: object },\n\t\tcurrentTargetInfo?: { name: string }\n\t): Promise<boolean> {\n\t\tif (!this.enabled) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\n\t\tlet targetRoute = \"\";\n\t\tlet routeParametersPromise: Promise<object> | undefined;\n\t\tconst isStickyMode = ModelHelper.isStickySessionSupported(this.oMetaModel);\n\n\t\t// Manage parameter mapping\n\t\tif (parameters?.targetPath && viewData?.navigation) {\n\t\t\tconst navigationInfo = viewData.navigation as Record<string, { detail: { route: string; parameters: object } }>;\n\t\t\tconst oRouteDetail = navigationInfo[parameters.targetPath].detail;\n\t\t\ttargetRoute = oRouteDetail.route;\n\n\t\t\tif (oRouteDetail.parameters && context.isA<Context>(\"sap.ui.model.odata.v4.Context\")) {\n\t\t\t\trouteParametersPromise = this.prepareParameters(\n\t\t\t\t\toRouteDetail.parameters as unknown as RoutingParameterMap,\n\t\t\t\t\ttargetRoute,\n\t\t\t\t\tcontext\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tlet sTargetPath = this._getPathFromContext(context, parameters);\n\t\t// If the path is empty, we're supposed to navigate to the first page of the app\n\t\t// Check if we need to exit from the app instead\n\t\tif (sTargetPath.length === 0 && this.bExitOnNavigateBackToRoot) {\n\t\t\tthis.oRouterProxy.exitFromApp();\n\t\t\treturn Promise.resolve(true);\n\t\t}\n\n\t\t// If the navigation goes with a creation, we add (...) to the path (expecting context is an ODataListBinding)\n\t\tif (parameters?.createOnNavigateParameters) {\n\t\t\tsTargetPath += \"(...)\";\n\t\t}\n\n\t\t// Add layout parameter if needed\n\t\tconst sLayout = this._calculateLayout(sTargetPath, parameters);\n\t\tif (sLayout) {\n\t\t\tsTargetPath += `?layout=${sLayout}`;\n\t\t}\n\n\t\t// Navigation parameters for later usage\n\t\tconst oNavigationInfo: RoutingNavigationInfo = {\n\t\t\tcreateOnNavigateParameters: parameters.createOnNavigateParameters,\n\t\t\tbTargetEditable: parameters?.editable,\n\t\t\tbPersistOPScroll: parameters?.persistOPScroll,\n\t\t\tbShowPlaceholder: parameters?.showPlaceholder !== undefined ? parameters?.showPlaceholder : true,\n\t\t\treason: parameters?.reason,\n\t\t\tredirectedToNonDraft: parameters.redirectedToNonDraft\n\t\t};\n\n\t\tif (parameters?.updateFCLLevel !== -1 && parameters?.recreateContext !== true) {\n\t\t\tif (context.isA<Context>(\"sap.ui.model.odata.v4.Context\")) {\n\t\t\t\toNavigationInfo.useContext = context;\n\t\t\t}\n\t\t}\n\n\t\tif (parameters?.checkNoHashChange) {\n\t\t\t// Check if the new hash is different from the current one\n\t\t\tconst sCurrentHashNoAppState = this.oRouterProxy.getHash().replace(/[&?]{1}sap-iapp-state=[A-Z0-9]+/, \"\");\n\t\t\tif (sTargetPath === sCurrentHashNoAppState) {\n\t\t\t\t// The hash doesn't change, but we fire the routeMatch event to trigger page refresh / binding\n\t\t\t\tconst routeInfoByHash = this.oRouter.getRouteInfoByHash(this.oRouterProxy.getHash());\n\t\t\t\tlet mEventParameters: RoutingEventParameters = { config: {} };\n\t\t\t\tif (routeInfoByHash) {\n\t\t\t\t\tmEventParameters = { ...routeInfoByHash, config: {} };\n\t\t\t\t\tmEventParameters.navigationInfo = oNavigationInfo;\n\t\t\t\t\tmEventParameters.routeInformation = this._getRouteInformation(this.sCurrentRouteName);\n\t\t\t\t\tmEventParameters.routePattern = this.sCurrentRoutePattern;\n\t\t\t\t\tmEventParameters.views = this.aCurrentViews;\n\t\t\t\t}\n\n\t\t\t\tthis.oRouterProxy.setFocusForced(!!parameters.forceFocus);\n\n\t\t\t\tthis._fireRouteMatchEvents(mEventParameters);\n\n\t\t\t\treturn Promise.resolve(true);\n\t\t\t}\n\t\t}\n\n\t\tif (parameters?.transient && !!parameters.editable && !sTargetPath.includes(\"(...)\")) {\n\t\t\tif (sTargetPath.includes(\"?\")) {\n\t\t\t\tsTargetPath += \"&i-action=create\";\n\t\t\t} else {\n\t\t\t\tsTargetPath += \"?i-action=create\";\n\t\t\t}\n\t\t}\n\n\t\tif (parameters.navMode === \"openInNewTab\") {\n\t\t\t// Navigate to new tab/ window\n\t\t\tsap.ui.require([\"sap/ushell/Container\"], async (Container: Container) => {\n\t\t\t\tconst shellServiceHelper = this.oAppComponent.getShellServices();\n\t\t\t\tconst parsedUrl = shellServiceHelper.parseShellHash(document.location.hash);\n\t\t\t\tconst navigationService = (await Container.getServiceAsync(\"Navigation\")) as Navigation;\n\t\t\t\tconst href = await navigationService.getHref({\n\t\t\t\t\ttarget: {\n\t\t\t\t\t\tsemanticObject: parsedUrl.semanticObject,\n\t\t\t\t\t\taction: parsedUrl.action\n\t\t\t\t\t},\n\t\t\t\t\tparams: parsedUrl.params\n\t\t\t\t});\n\t\t\t\tconst applicationUrlBasedOnIframe = await shellServiceHelper.getInframeUrl();\n\t\t\t\tlet url, targetUrl: string;\n\t\t\t\tif (applicationUrlBasedOnIframe) {\n\t\t\t\t\turl = new URL(applicationUrlBasedOnIframe);\n\t\t\t\t\ttargetUrl = applicationUrlBasedOnIframe.replace(url.hash, `${href}&/${encodeURI(sTargetPath)}`);\n\t\t\t\t} else {\n\t\t\t\t\turl = new URL(window.location.href);\n\t\t\t\t\ttargetUrl = `${url.origin}${url.pathname}${href}&/${encodeURI(sTargetPath)}`;\n\t\t\t\t}\n\t\t\t\topenWindow(targetUrl);\n\t\t\t});\n\t\t\treturn Promise.resolve(true);\n\t\t} else {\n\t\t\t// Clear unbound messages upon navigating from LR to OP\n\t\t\t// This is to ensure stale error messages from LR are not shown to the user after navigation to OP.\n\t\t\tif (currentTargetInfo?.name === \"sap.fe.templates.ListReport\") {\n\t\t\t\tconst oRouteInfo = this.oRouter.getRouteInfoByHash(sTargetPath);\n\t\t\t\tif (oRouteInfo) {\n\t\t\t\t\tconst oRoute = this._getRouteInformation(oRouteInfo.name);\n\t\t\t\t\tif (oRoute && oRoute.targets && oRoute.targets.length > 0) {\n\t\t\t\t\t\tconst sLastTargetName = oRoute.targets[oRoute.targets.length - 1];\n\t\t\t\t\t\tconst oTarget = this._getTargetInformation(sLastTargetName);\n\t\t\t\t\t\tif (oTarget && oTarget.name === \"sap.fe.templates.ObjectPage\") {\n\t\t\t\t\t\t\tmessageHandling.removeUnboundTransitionMessages();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Add the navigation parameters in the queue\n\t\t\tthis.navigationInfoQueue.push(oNavigationInfo);\n\n\t\t\tif (targetRoute && routeParametersPromise) {\n\t\t\t\treturn routeParametersPromise.then((oRouteParameters: object) => {\n\t\t\t\t\tObject.assign(oRouteParameters, { bIsStickyMode: isStickyMode });\n\t\t\t\t\tthis.oRouter.navTo(targetRoute, oRouteParameters);\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn this.oRouterProxy\n\t\t\t\t.navToHash(\n\t\t\t\t\tsTargetPath,\n\t\t\t\t\t!!parameters.preserveHistory,\n\t\t\t\t\tparameters?.noPreservationCache,\n\t\t\t\t\tparameters?.forceFocus,\n\t\t\t\t\t!isStickyMode\n\t\t\t\t)\n\t\t\t\t.then((bNavigated) => {\n\t\t\t\t\tif (!bNavigated) {\n\t\t\t\t\t\t// The navigation did not happen --> remove the navigation parameters from the queue as they shouldn't be used\n\t\t\t\t\t\tthis.navigationInfoQueue.pop();\n\t\t\t\t\t}\n\t\t\t\t\treturn bNavigated;\n\t\t\t\t});\n\t\t}\n\t}\n\n\t/**\n\t * Navigates to a route.\n\t * @param sTargetRouteName Name of the target route\n\t * @param [oRouteParameters] Parameters to be used with route to create the target hash\n\t * @param oRouteParameters.bIsStickyMode\n\t * @param oRouteParameters.preserveHistory\n\t * @returns Promise that is resolved when the navigation is finalized\n\t * @final\n\t */\n\tasync navigateToRoute(\n\t\tsTargetRouteName: string,\n\t\toRouteParameters?: { bIsStickyMode?: boolean; preserveHistory?: boolean }\n\t): Promise<boolean> {\n\t\tif (!this.enabled) {\n\t\t\treturn Promise.resolve(false);\n\t\t}\n\t\tthis.setLastSemanticMapping(undefined);\n\t\tconst sTargetURL = this.oRouter.getURL(sTargetRouteName, oRouteParameters);\n\t\treturn this.oRouterProxy.navToHash(\n\t\t\tsTargetURL!,\n\t\t\t!!oRouteParameters?.preserveHistory,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\t!oRouteParameters?.bIsStickyMode\n\t\t);\n\t}\n\n\t/**\n\t * Checks if one of the current views on the screen is bound to a given context.\n\t * @param oContext The context\n\t * @returns `true` or `false` if the current state is impacted or not\n\t */\n\tisCurrentStateImpactedBy(oContext: Context): boolean {\n\t\tconst sPath = oContext.getPath();\n\n\t\t// First, check with the technical path. We have to try it, because for level > 1, we\n\t\t// uses technical keys even if Semantic keys are enabled\n\t\tif (this.oRouterProxy.isCurrentStateImpactedBy(sPath)) {\n\t\t\treturn true;\n\t\t} else if (/^[^()]+\\([^()]+\\)$/.test(sPath)) {\n\t\t\t// If the current path can be semantic (i.e. is like xxx(yyy))\n\t\t\t// check with the semantic path if we can find it\n\t\t\tlet sSemanticPath;\n\t\t\tif (this.oLastSemanticMapping && this.oLastSemanticMapping.technicalPath === sPath) {\n\t\t\t\t// We have already resolved this semantic path\n\t\t\t\tsSemanticPath = this.oLastSemanticMapping.semanticPath;\n\t\t\t} else {\n\t\t\t\tsSemanticPath = SemanticKeyHelper.getSemanticPath(oContext)!;\n\t\t\t}\n\n\t\t\treturn sSemanticPath != sPath ? this.oRouterProxy.isCurrentStateImpactedBy(sSemanticPath) : false;\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Returns the path used to navigate back from a specified path.\n\t * @param sPath\n\t * @returns The path\n\t */\n\tgetPathToNavigateBack(sPath: string): string {\n\t\tconst regex = new RegExp(\"/[^/]*$\");\n\t\tsPath = sPath.replace(regex, \"\");\n\t\tif (this.oRouter.match(sPath) || sPath === \"\") {\n\t\t\treturn sPath;\n\t\t} else {\n\t\t\treturn this.getPathToNavigateBack(sPath);\n\t\t}\n\t}\n\n\t/**\n\t * Checks if a semantic path shall be used to navigate to a given context.\n\t * @param context The context to navigate to\n\t * @returns True if semantic path shall be sued, false otherwise\n\t */\n\t_checkIfContextSupportsSemanticPath(context: Context): boolean {\n\t\t// First, check if this is a level-1 object (path = /aaa(bbb))\n\t\tif (!/^\\/[^(]+\\([^)]+\\)$/.test(context.getPath())) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Then check if the entity is a draft root\n\t\tconst metaModel = context.getModel().getMetaModel();\n\t\tconst entitySet = MetaModelConverter.getInvolvedDataModelObjects(metaModel.getMetaContext(context.getPath()))\n\t\t\t.targetObject as EntitySet;\n\n\t\tif (!ModelHelper.isDraftRoot(entitySet)) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// We don't support semantic path for newly created objects\n\t\tif (context.getProperty(\"IsActiveEntity\") === false && context.getProperty(\"HasActiveEntity\") === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\t// Finally, check if the entity has semantic keys\n\t\tconst entitySetName = entitySet.name;\n\t\treturn SemanticKeyHelper.getSemanticKeys(metaModel, entitySetName) !== undefined;\n\t}\n\n\t_getPathFromContext(context: Context | ODataListBinding, parameters: RoutingNavigationParameters): string {\n\t\tlet sPath = \"\";\n\n\t\tif (context.isA<ODataListBinding>(\"sap.ui.model.odata.v4.ODataListBinding\")) {\n\t\t\tsPath = context.getHeaderContext()?.getPath() ?? \"\";\n\t\t} else {\n\t\t\tsPath = context.getPath();\n\n\t\t\tif (parameters.updateFCLLevel === -1) {\n\t\t\t\t// When navigating back from a context, we need to remove the last component of the path\n\t\t\t\tsPath = this.getPathToNavigateBack(sPath);\n\n\t\t\t\t// Check if we're navigating back to a semantic path that was previously resolved\n\t\t\t\tif (this.oLastSemanticMapping?.technicalPath === sPath) {\n\t\t\t\t\tsPath = this.oLastSemanticMapping.semanticPath;\n\t\t\t\t}\n\t\t\t} else if (this._checkIfContextSupportsSemanticPath(context)) {\n\t\t\t\t// We check if we have to use a semantic path\n\t\t\t\tconst sSemanticPath = parameters.semanticPath ? parameters.semanticPath : SemanticKeyHelper.getSemanticPath(context, true);\n\n\t\t\t\tif (!sSemanticPath) {\n\t\t\t\t\t// We were not able to build the semantic path --> Use the technical path and\n\t\t\t\t\t// clear the previous mapping, otherwise the old mapping is used in EditFlow#updateDocument\n\t\t\t\t\t// and it leads to unwanted page reloads\n\t\t\t\t\tthis.setLastSemanticMapping(undefined);\n\t\t\t\t} else if (sSemanticPath !== sPath) {\n\t\t\t\t\t// Store the mapping technical <-> semantic path and use semantic path\n\t\t\t\t\tthis.setLastSemanticMapping({ technicalPath: sPath, semanticPath: sSemanticPath });\n\t\t\t\t\tsPath = sSemanticPath;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// remove extra '/' at the beginning of path\n\t\tif (sPath[0] === \"/\") {\n\t\t\tsPath = sPath.substring(1);\n\t\t}\n\n\t\treturn sPath;\n\t}\n\n\t_calculateLayout(hash: string, parameters: RoutingNavigationParameters): string {\n\t\t// Open in full screen mode when opening in new tab/ window\n\t\tif (parameters.navMode === \"openInNewTab\" && parameters.FCLLevel !== -1) {\n\t\t\treturn parameters.FCLLevel === 0 ? \"MidColumnFullScreen\" : \"EndColumnFullScreen\";\n\t\t}\n\t\tlet FCLLevel = parameters.FCLLevel ?? 0;\n\t\tif (parameters.updateFCLLevel) {\n\t\t\tFCLLevel += parameters.updateFCLLevel;\n\t\t\tif (FCLLevel < 0) {\n\t\t\t\tFCLLevel = 0;\n\t\t\t}\n\t\t}\n\n\t\t// When navigating back, try to find the layout in the navigation history if it's not provided as parameter\n\t\t// (layout calculation is not handled properly by the FlexibleColumnLayoutSemanticHelper in this case)\n\t\tif (parameters.updateFCLLevel !== undefined && parameters.updateFCLLevel < 0 && !parameters.layout) {\n\t\t\tparameters.layout = this.oRouterProxy.findLayoutForHash(hash);\n\t\t}\n\n\t\treturn this.oAppComponent.getRootViewController().calculateLayout(FCLLevel, hash, parameters.layout, parameters.keepCurrentLayout);\n\t}\n\n\t/**\n\t * Event handler before a route is matched.\n\t *\n\t */\n\t_onBeforeRouteMatched(oEvent: Router$RouteMatchedEvent): void {\n\t\tconst viewPreloaderService = this.oAppComponent.getViewPreloaderService();\n\t\tviewPreloaderService.setCache(\n\t\t\toEvent.getParameter(\"config\") as Route,\n\t\t\toEvent.getParameter(\"arguments\") as Record<string, string | object>,\n\t\t\tthis.oAppComponent\n\t\t);\n\n\t\tconst bPlaceholderEnabled = new Placeholder().isPlaceholderEnabled();\n\t\tif (!bPlaceholderEnabled) {\n\t\t\tconst oRootView = this.oAppComponent.getRootControl();\n\t\t\tBusyLocker.lock(oRootView);\n\t\t}\n\t}\n\n\t/**\n\t * Checks if the current navigation has been triggered by the RouterProxy.\n\t * @returns True if the current navigation has been triggered by the RouterProxy.\n\t */\n\t_isNavigationTriggeredByRouterProxy(): boolean {\n\t\t// The RouterProxy sets a 'feLevel' property on the history.state object\n\t\treturn history.state?.feLevel !== undefined;\n\t}\n\n\t/**\n\t * Event handler when a route is matched.\n\t * Hides the busy indicator and fires its own 'routematched' event.\n\t * @param oEvent The event\n\t */\n\t_onRouteMatched(oEvent: Router$RouteMatchedEvent): void {\n\t\tconst oAppStateHandler = this.oAppComponent.getAppStateHandler(),\n\t\t\toRootView = this.oAppComponent.getRootControl();\n\t\tconst bPlaceholderEnabled = new Placeholder().isPlaceholderEnabled();\n\t\tif (BusyLocker.isLocked(oRootView) && !bPlaceholderEnabled) {\n\t\t\tBusyLocker.unlock(oRootView);\n\t\t}\n\t\tconst mParameters: RoutingEventParameters = oEvent.getParameters() as RoutingEventParameters;\n\t\tif (this.navigationInfoQueue.length) {\n\t\t\tmParameters.navigationInfo = this.navigationInfoQueue[0];\n\t\t\tthis.navigationInfoQueue = this.navigationInfoQueue.slice(1);\n\t\t} else {\n\t\t\tmParameters.navigationInfo = {};\n\t\t}\n\t\tif (oAppStateHandler.checkIfRouteChangedByIApp()) {\n\t\t\tmParameters.navigationInfo.reason = NavigationReason.AppStateChanged;\n\t\t\toAppStateHandler.resetRouteChangedByIApp();\n\t\t} else if (this.oRouterProxy.checkRestoreHistoryWasTriggered()) {\n\t\t\tmParameters.navigationInfo.reason = NavigationReason.RestoreHistory;\n\t\t\tthis.oRouterProxy.resetRestoreHistoryFlag();\n\t\t}\n\n\t\tthis.sCurrentRouteName = oEvent.getParameter(\"name\");\n\t\tthis.sCurrentRoutePattern = mParameters.config.pattern;\n\t\tthis.aCurrentViews = oEvent.getParameter(\"views\");\n\n\t\tmParameters.routeInformation = this._getRouteInformation(this.sCurrentRouteName);\n\t\tmParameters.routePattern = this.sCurrentRoutePattern;\n\n\t\tthis._fireRouteMatchEvents(mParameters);\n\n\t\t// Check if current hash has been set by the routerProxy.navToHash function\n\t\t// If not, rebuild history properly (both in the browser and the RouterProxy)\n\t\tif (!this._isNavigationTriggeredByRouterProxy()) {\n\t\t\tthis.oRouterProxy\n\t\t\t\t.restoreHistory()\n\t\t\t\t.then((): void => {\n\t\t\t\t\tthis.oRouterProxy.resolveRouteMatch();\n\t\t\t\t\treturn;\n\t\t\t\t})\n\t\t\t\t.catch(function (oError: unknown) {\n\t\t\t\t\tLog.error(\"Error while restoring history\", oError as string);\n\t\t\t\t});\n\t\t} else {\n\t\t\tthis.oRouterProxy.resolveRouteMatch();\n\t\t}\n\t}\n\n\tattachRouteMatched(oData: object, fnFunction: Function, oListener?: object): void {\n\t\tthis.eventProvider.attachEvent(\"routeMatched\", oData, fnFunction, oListener);\n\t}\n\n\tattachBeforeRouteMatched(oData: object, fnFunction: Function, oListener?: object): void {\n\t\tthis.eventProvider.attachEvent(\"beforeRouteMatched\", oData, fnFunction, oListener);\n\t}\n\n\tdetachRouteMatched(fnFunction: Function, oListener?: object): void {\n\t\tthis.eventProvider.detachEvent(\"routeMatched\", fnFunction, oListener);\n\t}\n\n\tattachAfterRouteMatched(oData: object, fnFunction: Function, oListener?: object): void {\n\t\tthis.eventProvider.attachEvent(\"afterRouteMatched\", oData, fnFunction, oListener);\n\t}\n\n\tdetachAfterRouteMatched(fnFunction: Function, oListener: object): void {\n\t\tthis.eventProvider.detachEvent(\"afterRouteMatched\", fnFunction, oListener);\n\t}\n\n\tdetachBeforeRouteMatched(fnFunction: Function, oListener: object): void {\n\t\tthis.eventProvider.detachEvent(\"beforeRouteMatched\", fnFunction, oListener);\n\t}\n\tasync initializeRouting(): Promise<void> {\n\t\tthis.enabled = true;\n\n\t\tif (this.oAppComponent.getEnvironmentCapabilities().getCapabilities().Collaboration) {\n\t\t\tconst { default: CollaborationHelper } = await import(\"sap/suite/ui/commons/collaboration/CollaborationHelper\");\n\t\t\tawait CollaborationHelper.processAndExpandHash();\n\t\t}\n\t\t// Attach router handlers\n\n\t\tthis._fnOnRouteMatched = this._onRouteMatched.bind(this);\n\t\tthis.oRouter.attachRouteMatched(this._fnOnRouteMatched, this);\n\t\tthis.oRouter.attachBeforeRouteMatched(this._onBeforeRouteMatched, this);\n\t\t// Reset internal state\n\t\tthis.navigationInfoQueue = [];\n\t\tEditState.resetEditState();\n\t\tthis.bExitOnNavigateBackToRoot = !this.oRouter.match(\"\");\n\n\t\tawait this.manageStartupMode();\n\t}\n\n\tonRestore(): void {\n\t\tthis.manageStartupMode();\n\t}\n\n\tasync manageStartupMode(): Promise<void> {\n\t\tconst bIsIappState = this.oRouter.getHashChanger().getHash().includes(\"sap-iapp-state\");\n\t\ttry {\n\t\t\tconst oStartupParameters = await this.oAppComponent.getStartupParameters();\n\t\t\tconst bHasStartUpParameters = oStartupParameters !== undefined && Object.keys(oStartupParameters).length !== 0;\n\t\t\tconst sHash = this.oRouter.getHashChanger().getHash();\n\t\t\t// Manage startup parameters (in case of no iapp-state)\n\t\t\tif (!bIsIappState && bHasStartUpParameters && !sHash) {\n\t\t\t\tif (oStartupParameters.preferredMode && oStartupParameters.preferredMode[0].toUpperCase().includes(\"CREATE\")) {\n\t\t\t\t\t// Create mode\n\t\t\t\t\t// This check will catch multiple modes like create, createWith and autoCreateWith which all need\n\t\t\t\t\t// to be handled like create startup!\n\t\t\t\t\tawait this._manageCreateStartup(oStartupParameters);\n\t\t\t\t} else {\n\t\t\t\t\t// Deep link\n\t\t\t\t\tawait this._manageDeepLinkStartup(oStartupParameters);\n\t\t\t\t}\n\t\t\t}\n\t\t\tawait this._managedPreferredModeEdit(oStartupParameters);\n\t\t} catch (oError: unknown) {\n\t\t\tLog.error(\"Error during routing initialization\", oError as string);\n\t\t}\n\t}\n\n\tgetDefaultCreateHash(oStartupParameters?: StartupParameters): string {\n\t\treturn AppStartupHelper.getDefaultCreateHash(oStartupParameters, this.getContextPath(), this.oRouter);\n\t}\n\n\tasync _manageCreateStartup(oStartupParameters: StartupParameters): Promise<void> {\n\t\treturn AppStartupHelper.getCreateStartupHash(oStartupParameters, this.getContextPath(), this.oRouter, this.oMetaModel).then(\n\t\t\t(sNewHash: string): void => {\n\t\t\t\tif (sNewHash) {\n\t\t\t\t\t(this.oRouter.getHashChanger().replaceHash as Function)(sNewHash);\n\t\t\t\t\tif (oStartupParameters?.preferredMode && oStartupParameters.preferredMode[0].toUpperCase().includes(\"AUTOCREATE\")) {\n\t\t\t\t\t\tthis.oAppComponent.setStartupModeAutoCreate();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.oAppComponent.setStartupModeCreate();\n\t\t\t\t\t}\n\t\t\t\t\tthis.bExitOnNavigateBackToRoot = true;\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t);\n\t}\n\n\tasync _manageDeepLinkStartup(oStartupParameters: StartupParameters | null): Promise<void> {\n\t\treturn AppStartupHelper.getDeepLinkStartupHash(\n\t\t\tthis.oAppComponent.getManifestEntry(\"sap.ui5\").routing,\n\t\t\toStartupParameters,\n\t\t\tthis.oModel,\n\t\t\tthis.oAppComponent.getManifestEntry(\"sap.fe\")?.app?.inboundParameterForTargetResolution\n\t\t).then((oDeepLink) => {\n\t\t\tlet sHash;\n\t\t\tif (oDeepLink.context) {\n\t\t\t\tconst sTechnicalPath = oDeepLink.context.getPath();\n\t\t\t\tconst sSemanticPath = this._checkIfContextSupportsSemanticPath(oDeepLink.context)\n\t\t\t\t\t? SemanticKeyHelper.getSemanticPath(oDeepLink.context, false)!\n\t\t\t\t\t: sTechnicalPath;\n\n\t\t\t\tif (sSemanticPath !== sTechnicalPath) {\n\t\t\t\t\t// Store the mapping technical <-> semantic path to avoid recalculating it later\n\t\t\t\t\t// and use the semantic path instead of the technical one\n\t\t\t\t\tthis.setLastSemanticMapping({ technicalPath: sTechnicalPath, semanticPath: sSemanticPath });\n\t\t\t\t}\n\n\t\t\t\tsHash = sSemanticPath.substring(1); // To remove the leading '/'\n\t\t\t} else if (oDeepLink.hash) {\n\t\t\t\tsHash = oDeepLink.hash;\n\t\t\t}\n\n\t\t\tif (sHash) {\n\t\t\t\t//Replace the hash with newly created hash\n\t\t\t\t(this.oRouter.getHashChanger().replaceHash as Function)(sHash);\n\t\t\t\tthis.oAppComponent.setStartupModeDeeplink();\n\t\t\t}\n\t\t\treturn;\n\t\t});\n\t}\n\n\t/**\n\t * Manages the preferred mode edit by appending \"[&|?]i-action=edit\" to the hash if:\n\t * - There is a resulting hash from the previous logic,\n\t * - The preferred mode is edit, and\n\t * - The entity is editable\n\t * This works for both deep-link startup (#App?ID=myId&preferredMode=edit) and object page routing (#App?preferredMode=edit&/Entity(ID)).\n\t * @param startupParameters\n\t * @param startupParameters.preferredMode\n\t */\n\tasync _managedPreferredModeEdit(startupParameters: { preferredMode?: string[] }): Promise<void> {\n\t\tconst resultingHash = this.oRouter.getHashChanger().getHash();\n\t\tconst shouldEdit = !!startupParameters.preferredMode?.[0]?.toUpperCase()?.includes(\"EDIT\");\n\t\tconst editable = await AppStartupHelper.verifyEditAnnotations(this.getContextPath(), this.oMetaModel);\n\t\tif (resultingHash && shouldEdit && editable) {\n\t\t\tconst parameter = (resultingHash.includes(\"?\") ? \"&\" : \"?\") + \"i-action=edit\";\n\t\t\t(this.oRouter.getHashChanger().replaceHash as (hash: string) => void)(resultingHash + parameter);\n\t\t}\n\t}\n\n\tgetOutbounds(): Record<string, ManifestOutboundEntry> {\n\t\treturn this.outbounds;\n\t}\n\n\t/**\n\t * Returns the routing hints for the current route.\n\t * Currently, this only covers the parent-child relationship from a list report to an object page.\n\t * @returns The routing hints\n\t */\n\tgetRoutingHints(): Record<string, { parentOf: string[] }> {\n\t\treturn this.routingHints ?? {};\n\t}\n\n\t/**\n\t * Gets the name of the Draft root entity set or the sticky-enabled entity set.\n\t * @returns The name of the root EntitySet\n\t */\n\tgetContextPath(): string {\n\t\treturn this.sContextPath;\n\t}\n\n\tgetInterface(): this {\n\t\treturn this;\n\t}\n}\n\nclass RoutingServiceFactory extends ServiceFactory<RoutingServiceSettings> {\n\tasync createInstance(oServiceContext: ServiceContext<RoutingServiceSettings>): Promise<RoutingService> {\n\t\tconst oRoutingService = new RoutingService(oServiceContext);\n\t\treturn oRoutingService.initPromise;\n\t}\n}\n\nexport default RoutingServiceFactory;\n"],"mappings":"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","ignoreList":[],"file":"RoutingServiceFactory-dbg.js"}