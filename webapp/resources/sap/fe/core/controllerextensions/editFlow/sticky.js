/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/isEmptyObject","sap/fe/core/CommonUtils","sap/fe/core/helpers/ResourceModelHelper","sap/fe/core/library","sap/m/MessageBox","sap/ui/core/Lib","../../converters/MetaModelConverter","./operations/Operation"],function(e,t,o,n,r,i,s,a,c){"use strict";var d=a.convertTypes;var g=n.getResourceModel;const u=r.ProgrammingModel;function f(e,t){const o=l(e,t);const n=e.getModel().getMetaModel(),r=`${n.getMetaPath(e.getPath())}/${o}`,i=n.createBindingContext(r);return d(n).resolvePath(i.getPath()).target}function l(e,t){const o=e.getModel(),n=o.getMetaModel(),r=n.getMetaPath(e.getPath());return n.getObject(`${r}@com.sap.vocabularies.Session.v1.StickySessionSupported/${t}`)}async function S(e,o,n){const r="EditAction";const i=f(e,r);if(i){const s=await new c(o,e.getModel(),i,{messageHandler:n,contexts:[e],label:g(o).getText("C_COMMON_OBJECT_PAGE_EDIT"),skipMessages:true,oDataProperties:{disableSideEffects:true,ignoreETag:t(e.getObject()),groupId:"direct",replaceWithRVC:e.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"),deferredSubmit:false},bindingParameters:{$$inheritExpandSelect:true}}).execute();if(s[0].status==="rejected"){throw new Error(s[0].reason)}else{const t=s[0].value.returnedContext;if(t){const n=o.getSideEffectsService().getODataActionSideEffects(l(e,r),t);if(n?.triggerActions&&n.triggerActions.length){await o.getSideEffectsService().requestSideEffectsForODataAction(n,t)}}return t}}else{throw new Error(`Edit Action for Sticky Session not found for ${r}`)}}async function M(o,n,r,i,s){const a="SaveAction";const d=o.getModel(),g=d.getMetaModel(),u=g.getMetaPath(o.getPath());const l=f(o,a);const S=s?i?.resourceModel?.getText("T_OP_OBJECT_PAGE_SAVE"):i?.resourceModel?.getText("C_OP_OBJECT_PAGE_SAVE");if(l){const i=await new c(n,o.getModel(),l,{messageHandler:r,contexts:[o],label:S,skipMessages:true,oDataProperties:{disableSideEffects:true,ignoreETag:t(o.getObject()),groupId:"direct",replaceWithRVC:o.getBinding().isA("sap.ui.model.odata.v4.ODataListBinding"),deferredSubmit:false},bindingParameters:{$$inheritExpandSelect:true}}).execute();if(i[0].status==="rejected"){const t=g.getObject(`${u}/@${"com.sap.vocabularies.Common.v1.Messages"}/$Path`);if(t){try{await n.getSideEffectsService().requestSideEffects([t],o)}catch(t){e.error("Error while requesting side effects",t)}}throw new Error(i[0].reason)}else if(i[0].value.returnedContext===undefined){throw new Error(`Save Action for Sticky Session doesn't return a context for ${u}`)}return i[0].value.returnedContext}else{throw new Error(`Save Action for Sticky Session not found for ${u}`)}}async function p(e){const t=e.getModel(),o=t.getMetaModel(),n=o.getMetaPath(e.getPath()),r=o.getObject(`${n}@com.sap.vocabularies.Session.v1.StickySessionSupported/DiscardAction`);if(!r){throw new Error(`Discard Action for Sticky Session not found for ${n}`)}const i=t.bindContext(`/${r}(...)`);return i.invoke("$single").then(function(){return e})}function E(t,n,r){const a=o.getIsEditable(n),c=s.getResourceBundleFor("sap.fe.templates"),d=c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_MSG"),g=c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CONFIRM_BUTTON"),f=c.getText("T_COMMON_UTILS_NAVIGATION_AWAY_CANCEL_BUTTON");if(r===u.Sticky&&a){return i.warning(d,{actions:[g,f],emphasizedAction:g,onClose:function(o){if(o===g){e.info("Navigation confirmed.");t()}else{e.info("Navigation rejected.")}}})}return t()}const A={editDocumentInStickySession:S,activateDocument:M,discardDocument:p,processDataLossConfirmation:E};return A},false);
//# sourceMappingURL=sticky.js.map