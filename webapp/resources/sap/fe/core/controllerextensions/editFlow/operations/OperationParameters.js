/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/UIProvider","./actionHelper"],function(e,t){"use strict";function a(e){return new Promise((t,a)=>{sap.ui.require([e],a=>{if(!(a&&a.__esModule)){a=a===null||!(typeof a==="object"&&e.endsWith("/library"))?{default:a}:a;Object.defineProperty(a,"__esModule",{value:true})}t(a)},e=>{a(e)})})}var r={};var s=e.getCoreUIFactory;let i=function(){function e(e,a,r,s,i){this.parameterDialog=undefined;this.parametersValues={};this.startupParameters={};this.appComponent=e;this.model=a;this.convertedAction=r;this.skipParametersDialog=s;this.parameters=i;this.actionParameters=t.getActionParameters(this.convertedAction);this.isParameterDialogNeeded=this.actionParameters.length>0&&!(this.actionParameters.length===1&&this.actionParameters[0].name==="ResultIsActiveEntity");this.skipParametersDialog=(this.actionParameters.length&&this.actionParameters.filter(e=>e.name!=="ResultIsActiveEntity").every(e=>e.annotations.UI?.Hidden?.valueOf()===true)?true:this.skipParametersDialog)??false;this.setStartupParameters()}r=e;var i=e.prototype;i.setStartupParameters=function e(){const t=this.appComponent.getComponentData();this.startupParameters=t?.startupParameters??{}};i.isParameterDialog=function e(){return!!this.parameterDialog};i.isParameterDialogOpened=function e(){return this.parameterDialog?.isOpen()??false};i.resetParameterDialogState=function e(){this.parameterDialog?.resetState()};i.closeParameterDialog=async function e(){return this.parameterDialog?.closeDialog()};i.getOperationParameters=async function e(){if(this.isParameterDialogNeeded&&!(this.skipParametersDialog&&this.isMandatoryValuesProvided())){if(!this.parameterDialog){this.parameterDialog=s().newOperationParameterDialog(this.convertedAction,{appComponent:this.appComponent,model:this.model,contexts:this.parameters.contexts,parametersValues:{},defaultValuesExtensionFunction:this.parameters.defaultValuesExtensionFunction,isCreateAction:this.parameters.isCreateAction,label:this.parameters.label,view:this.parameters.view,events:{onParameterDialogOpened:this.parameters.events?.onParameterDialogOpened,onParameterDialogClosed:this.parameters.events?.onParameterDialogClosed}},this.parameters.parameterValues,this.parameters.entitySetName,this.parameters.messageHandler);await this.parameterDialog.createDialog();this.parameterDialog.openDialog()}return this.parameterDialog.waitForParametersValues()}if(this.parameters.parameterValues){for(const e in this.actionParameters){this.parametersValues[this.actionParameters[e].name]=this.parameters.parameterValues?.find(t=>t.name===this.actionParameters[e].name)?.value}}else{let e;for(const t in this.actionParameters){e=this.actionParameters[t];this.parametersValues[e.name]=await this.convertValue(e,this.startupParameters[e.name]?.[0]??e.annotations?.UI?.ParameterDefaultValue?.valueOf())}}return this.parametersValues};i.isMandatoryValuesProvided=function e(){const t=this.actionParameters.every(e=>e?.annotations?.UI?.Hidden?.valueOf()===true);if(this.parameters.parameterValues?.length&&!t){for(const e of this.actionParameters){if(e.name!=="ResultIsActiveEntity"&&!this.parameters.parameterValues?.find(t=>t.name===e.name)){return false}}}if(this.parameters.isCreateAction===true&&Object.keys(this.startupParameters).length&&!t){for(const e of this.actionParameters){if(!this.startupParameters[e.name]){return false}}}if(this.actionParameters.length&&t){return this.actionParameters.every(e=>{const t=e.annotations?.Common?.FieldControl;const a=t?.toString()==="Common.FieldControlType/Mandatory";return!a||this.startupParameters[e.name]||this.parameters.parameterValues?.find(t=>t.name===e.name)||e?.annotations?.UI?.ParameterDefaultValue?.valueOf()})}return true};i.convertValue=async function e(t,r){if(r===undefined||r===null){return r}const s=(await a("sap/ui/mdc/odata/v4/TypeMap")).default;const i=s.getBaseType(t.type);const n=s.getDataTypeInstance(i);return n.parseValue(r,"string")};return e}();r=i;return r},false);
//# sourceMappingURL=OperationParameters.js.map