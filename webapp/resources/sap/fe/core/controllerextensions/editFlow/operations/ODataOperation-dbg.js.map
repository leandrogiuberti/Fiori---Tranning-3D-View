{"version":3,"names":["InvocationGrouping","FELibrary","ODataOperation","operation","parameters","operationProperties","arguments","length","undefined","operationContextBindings","firstIterationOperations","apiGroupIdsToSubmit","Set","bindingParameters","operationParameters","neverSubmitted","failedContexts","operationPromises","apiGroupId","action","isAction","actionName","actionHelper","getActionName","sideEffects","appComponent","getSideEffectsService","getODataActionSideEffects","contexts","isFunction","disableStrictHandling","oDataStrictHandling","ODataStrictHandling","label","invocationGrouping","events","onResponse","onStrictResponse","onValidation","onStrictValidation","bind","onCancel","onStrictCancel","defineOperationParameters","setBindingParameters","isContinueOnErrorCompliant","ChangeSet","groupId","isAPIMode","deferredSubmit","_exports","_proto","prototype","deepClone","enhance$select","existingSelect","$select","split","returnEntityType","metaModel","model","getMetaModel","messagesPath","ModelHelper","getMessagesPath","getPath","isSameEntity","returnCollection","sourceEntityType","entityProperties","find","property","name","includes","$$inheritExpandSelect","getActionParameters","clear","operationContextBinding","destroy","execute","result","executeOperation","executeSequentially","Promise","allSettled","executeImport","error","Log","onODataResponse","operationContext","bindContext","push","setParametersValue","promises","invoke","defaultSubmit","afterODataOperationExecution","currentPromiseValues","all","setContinueOnError","map","context","executeBoundOperation","manageStrictHandlingFails","onAfterODataOperationExecution","reduce","promise","id","resolve","finalGroupId","getUpdateGroupId","operationPromise","enhanceSideEffects","returnedContext","ghostContextBindingProtection","origin","requestSideEffects","getRootViewController","getInstancedViews","some","pageView","getBindingContext","InstanceManager","getOpenDialogs","dialog","firstIterationResolve","firstIterationReject","strictHandlingPromise","reject","add","sideEffectsContext","getContext","getBoundContext","operationInvoke","ignoreETag","handleOdataStrictHandling","submitBatch","replaceWithRVC","race","onAfterODataInvoke","boundContext","retriggerFailedContexts","apiRetriggerGroupId","index","failedContext","submit","size","Array","from","values","submitOnModel","onODataSubmit","isStrictCanceled","isCanceled","delete","startsWith","submitMode","getManifestEntry","models","settings","groupProperties","SubmitMode","Auto","Direct","firstSubmit","defaultValues","parametersValues","parameter","type","setParameter","localPromise","sideEffectsService","disableSideEffects","concat","triggerActions","executeAction","pathExpressions","onRequestSideEffects","info"],"sourceRoot":".","sources":["ODataOperation.ts"],"sourcesContent":["import type { ActionImport, ActionParameter, Action as EdmAction } from \"@sap-ux/vocabularies-types\";\nimport Log from \"sap/base/Log\";\nimport deepClone from \"sap/base/util/deepClone\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport FELibrary from \"sap/fe/core/library\";\nimport InstanceManager from \"sap/m/InstanceManager\";\nimport type Message from \"sap/ui/core/message/Message\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type { default as ODataV4Context } from \"sap/ui/model/odata/v4/Context\";\nimport type ODataContextBinding from \"sap/ui/model/odata/v4/ODataContextBinding\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport SubmitMode from \"sap/ui/model/odata/v4/SubmitMode\";\nimport ModelHelper from \"../../../helpers/ModelHelper\";\nimport { isAction } from \"../../../helpers/TypeGuards\";\nimport type { ActionSideEffectsType } from \"../../../services/SideEffectsServiceFactory\";\nimport type { BindContextParameters } from \"../draft\";\nimport ODataStrictHandling from \"./ODataStrictHandling\";\nimport actionHelper from \"./actionHelper\";\n\nconst InvocationGrouping = FELibrary.InvocationGrouping;\n\nexport type OperationResult = {\n\treturnedContext?: ODataV4Context;\n\tboundContext: ODataV4Context;\n};\n\nexport default class ODataOperation {\n\tprivate operationContextBindings: ODataContextBinding[] = [];\n\n\tprivate readonly firstIterationOperations: Promise<unknown>[] = [];\n\n\tprivate readonly apiGroupIdsToSubmit: Set<string> = new Set();\n\n\tprivate readonly sideEffects: ActionSideEffectsType | undefined;\n\n\tprivate readonly actionName: string;\n\n\tprivate bindingParameters: Record<string, unknown> = {};\n\n\tprivate operationParameters: ActionParameter[] = [];\n\n\tprivate neverSubmitted = true;\n\n\tprivate readonly oDataStrictHandling: ODataStrictHandling | undefined;\n\n\tprivate failedContexts: ODataV4Context[] = [];\n\n\tprivate operationPromises: Promise<OperationResult>[] = [];\n\n\tprivate readonly apiGroupId = \"apiMode\";\n\n\tprivate readonly isContinueOnErrorCompliant: boolean;\n\n\t/**\n\t * Creates an instance of ODataOperation.\n\t * This instance is used to execute on the model an OData operation, which can be an action or an action import.\n\t * @param operation The operation to be executed. This can be an action or an import.\n\t * @param parameters The parameters for the operation\n\t * @param parameters.appComponent The AppComponent instance\n\t * @param parameters.contexts The contexts to be used for the operation\n\t * @param parameters.model The ODataModel instance\n\t * @param parameters.invocationGrouping The invocation grouping for the operation. This can be 'ChangeSet' or 'Isolated'.\n\t * @param parameters.disableStrictHandling If true, the strict handling is disabled\n\t * @param parameters.disableSideEffects If true, the side effects are disabled\n\t * @param parameters.ghostContextBindingProtection If true, the ghost context binding protection is enabled\n\t * @param parameters.label The label for the operation, used in the strict handling\n\t * @param parameters.events The events for the operation\n\t * @param parameters.events.onStrictValidation The event triggered when the strict handling is validated by the end user\n\t * @param parameters.events.onStrictCancel The event triggered when the strict handling is canceled by the end user\n\t * @param parameters.events.onStrictResponse The event triggered when the backend returns 412 messages (strict handling)\n\t * @param parameters.events.onODataResponse The event triggered when all responses related to the Fiori element operations are received\n\t * @param parameters.events.onODataSubmit The event triggered when the batch is submitted (request sent to the back end)\n\t * @param parameters.events.onAfterODataInvoke The event triggered when the promise of invoke method of the oDataContextBinding is resolved\n\t * @param parameters.events.onAfterODataOperationExecution The event triggered when first responses related to the Fiori element operations are received (before strict handling or final response if no 412 are received)\n\t * @param parameters.events.onRequestSideEffects The event triggered when side effects are requested\n\t * @param parameters.parametersValues The values for the parameters of the operation\n\t * @param operationProperties The model properties for the operation\n\t * @param operationProperties.enhance$select If true, the $select parameter is enhanced with additional properties (e.g. Messages)\n\t * @param operationProperties.groupId The groupId for the operation, used for batch processing\n\t * @param operationProperties.bindingParameters The binding parameters for the operation\n\t * @param operationProperties.deferredSubmit If true, the operation is not submitted immediately and must be submitted by the developer\n\t * @param operationProperties.ignoreETag If true, the ETag is ignored for the operation\n\t * @param operationProperties.replaceWithRVC Whether this operation binding's parent context, which must belong to a list binding, is replaced with the operation's return value context (see below) and that list context is returned instead\n\t */\n\tconstructor(\n\t\tprivate readonly operation: EdmAction | ActionImport,\n\t\tprivate readonly parameters: {\n\t\t\tappComponent: AppComponent;\n\t\t\tcontexts: ODataV4Context[];\n\t\t\tmodel: ODataModel;\n\t\t\tinvocationGrouping?: string;\n\t\t\tdisableStrictHandling?: boolean;\n\t\t\tdisableSideEffects?: boolean;\n\t\t\tghostContextBindingProtection?: boolean;\n\t\t\tlabel?: string;\n\t\t\tevents?: {\n\t\t\t\tonStrictValidation?: () => void;\n\t\t\t\tonStrictCancel?: () => void;\n\t\t\t\tonStrictResponse?: (messages412: Message[]) => void;\n\t\t\t\tonODataResponse?: () => void;\n\t\t\t\tonODataSubmit?: () => void;\n\t\t\t\tonAfterODataInvoke?: (odataContextBinding: ODataContextBinding, groupId: string) => Promise<unknown>;\n\t\t\t\tonAfterODataOperationExecution?: () => Promise<unknown>;\n\t\t\t\tonRequestSideEffects?: (\n\t\t\t\t\tsideEffects: ActionSideEffectsType,\n\t\t\t\t\toperation: EdmAction | ActionImport,\n\t\t\t\t\tsideEffectsPromises: Promise<unknown>[]\n\t\t\t\t) => void;\n\t\t\t};\n\t\t\tparametersValues?: Record<string, unknown>;\n\t\t},\n\t\tprivate readonly operationProperties: {\n\t\t\tenhance$select?: boolean;\n\t\t\tgroupId?: string;\n\t\t\tbindingParameters?: BindContextParameters;\n\t\t\tdeferredSubmit?: boolean;\n\t\t\tignoreETag?: boolean;\n\t\t\treplaceWithRVC?: boolean;\n\t\t} = {}\n\t) {\n\t\tconst action = isAction(this.operation) ? this.operation : this.operation.action;\n\t\tthis.actionName = actionHelper.getActionName(action);\n\n\t\tthis.sideEffects = this.parameters.appComponent\n\t\t\t.getSideEffectsService()\n\t\t\t.getODataActionSideEffects(this.actionName, this.parameters.contexts.length ? this.parameters.contexts[0] : undefined);\n\n\t\tif (!action.isFunction && this.parameters.disableStrictHandling !== true) {\n\t\t\tthis.oDataStrictHandling = new ODataStrictHandling({\n\t\t\t\tappComponent: this.parameters.appComponent,\n\t\t\t\tcontexts: this.parameters.contexts,\n\t\t\t\tlabel: this.parameters.label ?? this.actionName,\n\t\t\t\tinvocationGrouping: this.parameters.invocationGrouping,\n\t\t\t\tevents: {\n\t\t\t\t\tonResponse: this.parameters.events?.onStrictResponse,\n\t\t\t\t\tonValidation: this.onStrictValidation.bind(this),\n\t\t\t\t\tonCancel: this.parameters.events?.onStrictCancel\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tthis.defineOperationParameters();\n\t\tthis.setBindingParameters();\n\n\t\tthis.isContinueOnErrorCompliant =\n\t\t\tthis.parameters.invocationGrouping !== InvocationGrouping.ChangeSet &&\n\t\t\tthis.parameters.contexts.length > 1 &&\n\t\t\t(!this.operationProperties.groupId || this.isAPIMode(this.operationProperties.groupId)) &&\n\t\t\tthis.operationProperties.deferredSubmit !== true;\n\t}\n\n\t/**\n\t * Sets the binding parameters for the operations.\n\t */\n\tprivate setBindingParameters(): void {\n\t\tthis.bindingParameters = deepClone(this.operationProperties.bindingParameters ?? {});\n\n\t\tif (\n\t\t\tisAction(this.operation) &&\n\t\t\t!this.operation.isFunction &&\n\t\t\tthis.parameters.contexts.length &&\n\t\t\tthis.operationProperties.enhance$select === true\n\t\t) {\n\t\t\tconst existingSelect = (this.bindingParameters.$select as string | undefined)?.split(\",\") ?? [];\n\t\t\tconst returnEntityType = this.operation.returnEntityType;\n\t\t\tconst metaModel = this.parameters.model.getMetaModel();\n\t\t\tconst messagesPath = ModelHelper.getMessagesPath(metaModel, this.parameters.contexts[0].getPath())!;\n\t\t\tconst isSameEntity =\n\t\t\t\t!this.operation.returnCollection && !!returnEntityType && this.operation.sourceEntityType === returnEntityType;\n\t\t\tif (isSameEntity) {\n\t\t\t\tif (\n\t\t\t\t\t/* The former logic checked if the messagesPath is contained into the SideEffects\n                       but the check was invalid (always true)\n                       To be compliant with former version we don't check the SideEffects..\n\t\t\t\t\t   \n\t\t\t\t\t   this.sideEffects &&\n\t\t\t\t\t   messagesPath &&\n\t\t\t\t\t   (this.sideEffects.pathExpressions ?? []).some((exp) => typeof exp === \"string\" && [messagesPath, \"*\"].includes(exp))*/\n\t\t\t\t\tmessagesPath &&\n\t\t\t\t\t!!returnEntityType?.entityProperties.find((property) => property.name === messagesPath) &&\n\t\t\t\t\t!existingSelect.includes(messagesPath)\n\t\t\t\t) {\n\t\t\t\t\tthis.bindingParameters.$select = this.bindingParameters.$select\n\t\t\t\t\t\t? `${this.bindingParameters.$select},${messagesPath}`\n\t\t\t\t\t\t: messagesPath;\n\n\t\t\t\t\tthis.bindingParameters.$$inheritExpandSelect = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Defines the parameters of the operation.\n\t */\n\tprivate defineOperationParameters(): void {\n\t\tif (!isAction(this.operation)) {\n\t\t\tthis.operationParameters = this.operation.action.parameters;\n\t\t} else {\n\t\t\t//Remove the binding parameters from the parameters list\n\t\t\tthis.operationParameters = actionHelper.getActionParameters(this.operation);\n\t\t}\n\t}\n\n\tpublic clear(): void {\n\t\tfor (const operationContextBinding of this.operationContextBindings) {\n\t\t\toperationContextBinding.destroy();\n\t\t}\n\t\tthis.apiGroupIdsToSubmit.clear();\n\t\tthis.operationContextBindings = [];\n\t\tthis.failedContexts = [];\n\t\tthis.operationPromises = [];\n\t}\n\n\t/**\n\t * Executes the operation.\n\t * @returns The promise of the operation\n\t */\n\tasync execute(): Promise<PromiseSettledResult<OperationResult>[]> {\n\t\tlet result: PromiseSettledResult<OperationResult>[];\n\t\ttry {\n\t\t\tif (this.parameters.contexts.length) {\n\t\t\t\tresult = await (this.parameters.invocationGrouping === InvocationGrouping.ChangeSet || this.isContinueOnErrorCompliant\n\t\t\t\t\t? this.executeOperation()\n\t\t\t\t\t: this.executeSequentially());\n\t\t\t} else {\n\t\t\t\tresult = await Promise.allSettled([this.executeImport()]);\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tLog.error(\"Error while executing operation \" + this.actionName, error as string);\n\t\t\tthrow error;\n\t\t} finally {\n\t\t\tthis.parameters.events?.onODataResponse?.();\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * Executes the import operation.\n\t * @returns The promise of the operation\n\t */\n\tprivate async executeImport(): Promise<OperationResult> {\n\t\tconst operationContext = this.parameters.model.bindContext(`/${this.actionName}(...)`);\n\t\tthis.operationContextBindings.push(operationContext);\n\t\tthis.setParametersValue(operationContext);\n\t\tconst groupId = this.operationProperties.groupId ?? \"actionImport\";\n\t\tconst promises = [this.invoke(operationContext, groupId)];\n\n\t\tthis.defaultSubmit(groupId);\n\t\tawait Promise.allSettled(this.firstIterationOperations);\n\t\tawait this.afterODataOperationExecution();\n\t\tconst currentPromiseValues = await Promise.all(promises);\n\t\treturn currentPromiseValues[0];\n\t}\n\n\t/**\n\t * Executes the operations.\n\t * @returns The promise of the operations\n\t */\n\tprivate async executeOperation(): Promise<PromiseSettledResult<OperationResult>[]> {\n\t\tlet groupId = this.operationProperties.groupId;\n\t\tif (this.isContinueOnErrorCompliant) {\n\t\t\tgroupId = groupId ?? this.apiGroupId;\n\t\t\tthis.parameters.model.setContinueOnError(groupId);\n\t\t}\n\t\tthis.operationPromises = this.parameters.contexts.map(async (context) => this.executeBoundOperation(context, groupId));\n\t\tawait Promise.allSettled(this.firstIterationOperations);\n\t\tawait this.afterODataOperationExecution();\n\t\treturn Promise.allSettled(this.operationPromises);\n\t}\n\n\tprivate async afterODataOperationExecution(): Promise<void> {\n\t\tawait this.oDataStrictHandling?.manageStrictHandlingFails();\n\t\tawait this.parameters.events?.onAfterODataOperationExecution?.();\n\t}\n\n\t/**\n\t * Executes the operations sequentially.\n\t * @returns The promise of the operations\n\t */\n\tprivate async executeSequentially(): Promise<PromiseSettledResult<OperationResult>[]> {\n\t\t// serialization: executeBoundOperation to be called for each entry only after the promise returned from the one before has been resolved\n\t\tawait this.parameters.contexts.reduce(async (promise: Promise<void>, context: ODataV4Context, id: number): Promise<void> => {\n\t\t\tawait promise;\n\t\t\tthis.operationPromises.push(\n\t\t\t\tthis.executeBoundOperation(context, this.operationProperties.groupId ?? `${this.apiGroupId}${id + 1}`)\n\t\t\t);\n\t\t\tawait Promise.allSettled(this.firstIterationOperations);\n\t\t}, Promise.resolve());\n\t\tawait this.afterODataOperationExecution();\n\t\treturn Promise.allSettled(this.operationPromises);\n\t}\n\n\t/**\n\t * Executes the bound operation.\n\t * @param context The bound context\n\t * @param groupId The groupId of the batch\n\t * @returns The promise of the operation\n\t */\n\tprivate async executeBoundOperation(context: ODataV4Context, groupId?: string): Promise<OperationResult> {\n\t\tconst operationContext = this.parameters.model.bindContext(`${this.actionName}(...)`, context, this.bindingParameters);\n\t\tthis.operationContextBindings.push(operationContext);\n\t\tconst promises: Promise<unknown>[] = [];\n\t\tthis.setParametersValue(operationContext);\n\t\tconst finalGroupId = groupId ?? operationContext.getUpdateGroupId();\n\t\tconst operationPromise = this.invoke(operationContext, finalGroupId);\n\t\tpromises.push(operationPromise);\n\t\tthis.defaultSubmit(finalGroupId);\n\t\tPromise.allSettled(promises);\n\t\treturn operationPromise;\n\t}\n\n\t/**\n\t * Enhances the side effects of the operation\n\t *\n\t * When a new entity is created using a DataFieldForAction, a new\n\t * oDataContextBinding is created to execute the action. By default, this\n\t * oDataContextBinding is relative to the OdataListBinding of the table.\n\t *\n\t * Because of this dependency, when a SideEffects is executed on the\n\t * context into the OdataListBinding where the oDataContextBinding was bound, this SideEffects is also triggered on this\n\t * oDataContextBinding. We don't manage the lifecycle of the\n\t * oDataContextBinding. It means even if the draft related to the action\n\t * is removed, the odataContextBinding is still there, so if a SideEffects\n\t * is executed on the source target into oDataContextBinding, an error from the back end will be\n\t * received because we ask to refresh a property on an unknown entity.\n\t *\n\t * The SideEffects are requested only if the page is still open.\n\t * This avoids generating issues with ghost oDataContextBinding linked to destroyed context.\n\t * @param operationContextBinding The operation\n\t * @param returnedContext The returned context of this operation\n\t */\n\tprivate enhanceSideEffects(operationContextBinding: ODataContextBinding, returnedContext: ODataV4Context | undefined): void {\n\t\tif (returnedContext && this.parameters.ghostContextBindingProtection === true) {\n\t\t\tconst appComponent = this.parameters.appComponent;\n\t\t\tconst origin = operationContextBinding.requestSideEffects.bind(operationContextBinding);\n\t\t\toperationContextBinding.requestSideEffects = async (...args: unknown[]): Promise<void> => {\n\t\t\t\t// We check if one of the pages or an open dialog uses the returned context.\n\t\t\t\t// If not, side effects are not requested.\n\t\t\t\tif (\n\t\t\t\t\tappComponent\n\t\t\t\t\t\t.getRootViewController()\n\t\t\t\t\t\t.getInstancedViews()\n\t\t\t\t\t\t.some((pageView: View) => pageView.getBindingContext() === returnedContext) ||\n\t\t\t\t\tInstanceManager.getOpenDialogs().some((dialog) => dialog.getBindingContext() === returnedContext)\n\t\t\t\t) {\n\t\t\t\t\treturn origin(...args);\n\t\t\t\t}\n\t\t\t\treturn Promise.resolve();\n\t\t\t};\n\t\t}\n\t}\n\n\t/**\n\t * Invokes the operation on the context.\n\t * @param operationContextBinding The operation context binding\n\t * @param groupId The groupId of the batch\n\t * @returns The promise of the operation\n\t */\n\tprivate async invoke(operationContextBinding: ODataContextBinding, groupId: string): Promise<OperationResult> {\n\t\tlet returnedContext;\n\t\tlet firstIterationResolve!: Function;\n\t\tlet firstIterationReject!: Function;\n\t\tconst strictHandlingPromise = new Promise<unknown>(function (resolve, reject) {\n\t\t\tfirstIterationResolve = resolve;\n\t\t\tfirstIterationReject = reject;\n\t\t});\n\t\tthis.firstIterationOperations.push(strictHandlingPromise);\n\t\tif (groupId && this.isAPIMode(groupId)) {\n\t\t\tthis.apiGroupIdsToSubmit.add(groupId);\n\t\t}\n\t\ttry {\n\t\t\tconst sideEffectsContext =\n\t\t\t\t(operationContextBinding.getContext() as ODataV4Context | undefined) ?? operationContextBinding.getBoundContext();\n\t\t\tconst operationInvoke = operationContextBinding.invoke(\n\t\t\t\tgroupId,\n\t\t\t\tthis.operationProperties.ignoreETag,\n\t\t\t\tthis.oDataStrictHandling?.handleOdataStrictHandling.bind(\n\t\t\t\t\tthis.oDataStrictHandling,\n\t\t\t\t\toperationContextBinding,\n\t\t\t\t\tfirstIterationResolve,\n\t\t\t\t\t() => {\n\t\t\t\t\t\tif (this.isContinueOnErrorCompliant) {\n\t\t\t\t\t\t\tthis.parameters.model.setContinueOnError(groupId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.requestSideEffects(sideEffectsContext, groupId, []);\n\t\t\t\t\t\tthis.parameters.model.submitBatch(groupId);\n\t\t\t\t\t}\n\t\t\t\t),\n\t\t\t\tthis.operationProperties.replaceWithRVC\n\t\t\t);\n\t\t\tthis.requestSideEffects(sideEffectsContext, groupId, [operationInvoke]);\n\t\t\tawait Promise.race([operationInvoke, strictHandlingPromise]);\n\n\t\t\treturnedContext = await operationInvoke;\n\t\t\tthis.enhanceSideEffects(operationContextBinding, returnedContext);\n\t\t\tfirstIterationResolve();\n\t\t} catch (error) {\n\t\t\tfirstIterationReject(error);\n\t\t\tconst context = operationContextBinding.getContext();\n\t\t\tif (context) {\n\t\t\t\tthis.failedContexts.push(context as ODataV4Context);\n\t\t\t}\n\t\t\tthrow error;\n\t\t} finally {\n\t\t\tawait this.parameters.events?.onAfterODataInvoke?.(operationContextBinding, groupId);\n\t\t}\n\n\t\treturn {\n\t\t\treturnedContext,\n\t\t\tboundContext: operationContextBinding.getBoundContext()\n\t\t};\n\t}\n\n\t/**\n\t *  Manages the strict handling validation.\n\t */\n\tprivate onStrictValidation(): void {\n\t\tthis.parameters.events?.onStrictValidation?.();\n\t\tthis.retriggerFailedContexts();\n\t}\n\n\t/**\n\t * Triggers the failed operations when strict handling is true.\n\t * @returns A promise resolved when the new operations are resolved\n\t */\n\tprivate async retriggerFailedContexts(): Promise<void> {\n\t\t//Retry the action execution in case of strict handling and if there is at least one failed context (give it another try to succeed)\n\t\tif (this.parameters.invocationGrouping !== InvocationGrouping.ChangeSet) {\n\t\t\tconst apiRetriggerGroupId = \"apiRetrigger\";\n\t\t\tif (this.isContinueOnErrorCompliant) {\n\t\t\t\tthis.parameters.model.setContinueOnError(apiRetriggerGroupId);\n\t\t\t}\n\t\t\tlet index = 0;\n\t\t\tfor (const failedContext of this.failedContexts) {\n\t\t\t\tconst groupId = `${apiRetriggerGroupId}${this.isContinueOnErrorCompliant ? \"\" : index + 1}`;\n\t\t\t\tindex++;\n\t\t\t\tthis.operationPromises.push(this.executeBoundOperation(failedContext, groupId));\n\t\t\t}\n\t\t\tawait Promise.allSettled(this.operationPromises);\n\t\t}\n\t}\n\n\t/**\n\t * Submits the batch related to the groupId of the operation.\n\t */\n\tpublic submit(): void {\n\t\tif (!this.neverSubmitted || this.apiGroupIdsToSubmit.size === 0) {\n\t\t\treturn;\n\t\t}\n\t\tfor (const groupId of Array.from(this.apiGroupIdsToSubmit.values())) {\n\t\t\tthis.submitOnModel(groupId);\n\t\t}\n\t\tthis.parameters.events?.onODataSubmit?.();\n\t}\n\n\t/**\n\t *  Is strict handling canceled.\n\t * @returns True if it is canceled, otherwise false\n\t */\n\tpublic isStrictCanceled(): boolean {\n\t\treturn this.oDataStrictHandling?.isCanceled() ?? false;\n\t}\n\n\t/**\n\t * Submits the batch at the model level related to the groupId of the operation.\n\t * @param groupId The groupId of the batch\n\t */\n\tprivate submitOnModel(groupId: string): void {\n\t\tthis.parameters.model.submitBatch(groupId);\n\t\tthis.apiGroupIdsToSubmit.delete(groupId);\n\t}\n\n\t/**\n\t * Is the SubmitMode of the groupId set to API.\n\t * @param groupId The groupId of the batch\n\t * @returns True if the SubmitMode is set to API, false otherwise\n\t */\n\tprivate isAPIMode(groupId?: string): boolean {\n\t\tif (!groupId) {\n\t\t\treturn false;\n\t\t}\n\t\tif (groupId.startsWith(\"$auto\") || groupId.startsWith(\"$direct\") || groupId.startsWith(\"$single\")) {\n\t\t\treturn false;\n\t\t}\n\t\tconst submitMode = (\n\t\t\tthis.parameters.appComponent.getManifestEntry(\"sap.ui5\")?.models[\"\"]?.settings as\n\t\t\t\t| { groupProperties?: Record<string, { submit: SubmitMode }> }\n\t\t\t\t| undefined\n\t\t)?.groupProperties?.[groupId]?.submit;\n\n\t\tif (submitMode === undefined || [SubmitMode.Auto, SubmitMode.Direct].includes(submitMode)) {\n\t\t\treturn true;\n\t\t}\n\t\treturn true;\n\t}\n\n\t/**\n\t * Executes the submit of the operation if the submitMode is on API and deferredSubmit is not set to true\n\t * The submitBatch is skipped if the groupId is $auto or $direct since done by the model.\n\t * @param groupId The groupId of the batch\n\t */\n\tprivate defaultSubmit(groupId?: string): void {\n\t\tconst firstSubmit = this.neverSubmitted;\n\t\tconst isAPIMode = this.isAPIMode(groupId);\n\t\tif (!isAPIMode) {\n\t\t\t// The submitBatch is skipped if the groupId is $auto or $direct since done by the model\n\t\t\tthis.neverSubmitted = false;\n\t\t} else if (this.operationProperties.deferredSubmit !== true && groupId) {\n\t\t\tthis.neverSubmitted = false;\n\t\t\tthis.submitOnModel(groupId);\n\t\t}\n\t\tif (firstSubmit && !this.neverSubmitted) {\n\t\t\t//Trigger the callback only once\n\t\t\tthis.parameters.events?.onODataSubmit?.();\n\t\t}\n\t}\n\n\t/**\n\t *  Sets the default values for the parameters of the operation.\n\t * @param operationContextBinding The operation context binding\n\t */\n\tprivate setParametersValue(operationContextBinding: ODataContextBinding): void {\n\t\tif (this.operationParameters.length) {\n\t\t\tconst defaultValues = this.parameters.parametersValues ?? {};\n\t\t\tfor (const parameter of this.operationParameters) {\n\t\t\t\tconst name = parameter.name;\n\t\t\t\tif (!defaultValues[name]) {\n\t\t\t\t\tswitch (parameter.type) {\n\t\t\t\t\t\tcase \"Edm.String\":\n\t\t\t\t\t\t\tdefaultValues[name] = \"\";\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"Edm.Boolean\":\n\t\t\t\t\t\t\tdefaultValues[name] = false;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tcase \"Edm.Byte\":\n\t\t\t\t\t\tcase \"Edm.Int16\":\n\t\t\t\t\t\tcase \"Edm.Int32\":\n\t\t\t\t\t\tcase \"Edm.Int64\":\n\t\t\t\t\t\t\tdefaultValues[name] = 0;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\toperationContextBinding.setParameter(name, defaultValues[name]);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Requests the side effects for the action.\n\t * @param context  The context of the SideEffects\n\t * @param groupId  The groupId of the batch\n\t * @param localPromise The promise of the invoked action\n\t * @returns The promise of the side effect\n\t */\n\tprivate async requestSideEffects(context: ODataV4Context, groupId: string, localPromise?: Promise<unknown>[]): Promise<void> {\n\t\tconst sideEffectsService = this.parameters.appComponent.getSideEffectsService();\n\t\tlet promises: Promise<unknown>[] = localPromise ?? [];\n\t\t// trigger actions from side effects\n\t\tif (this.sideEffects && !this.parameters.disableSideEffects === true) {\n\t\t\tpromises = promises.concat(\n\t\t\t\t(this.sideEffects.triggerActions ?? []).map(async (action) => {\n\t\t\t\t\tif (this.isContinueOnErrorCompliant) {\n\t\t\t\t\t\tthis.submitOnModel(groupId);\n\t\t\t\t\t}\n\t\t\t\t\treturn sideEffectsService.executeAction(action, context, { submitBatch: false, groupId });\n\t\t\t\t}),\n\t\t\t\tthis.sideEffects.pathExpressions\n\t\t\t\t\t? sideEffectsService.requestSideEffects(this.sideEffects.pathExpressions, context, groupId)\n\t\t\t\t\t: []\n\t\t\t);\n\t\t\ttry {\n\t\t\t\tawait Promise.all(promises);\n\t\t\t\tif (this.sideEffects.pathExpressions) {\n\t\t\t\t\tthis.parameters.events?.onRequestSideEffects?.(this.sideEffects, this.operation, promises);\n\t\t\t\t}\n\t\t\t} catch (error) {\n\t\t\t\tLog.info(\"Error while requesting side effects for the operation \" + this.actionName, error as string);\n\t\t\t}\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"ODataOperation-dbg.js"}