{"version":3,"file":"NotApplicableContextDialog.js","names":["NotApplicableContextDialog","props","this","title","resourceModel","entityType","applicableContexts","notApplicableContexts","_shouldContinue","actionName","entitySetName","entitySet","_dialog","createDialog","_processingPromise","Promise","resolve","_fnResolve","_exports","_proto","prototype","onAfterClose","destroy","onContinue","close","open","async","owner","addDependent","getDialog","boundActionName","includes","split","length","suffixResourceKey","totalContexts","_jsx","Dialog","state","showHeader","resizable","verticalScrolling","horizontalScrolling","class","getTitleText","afterClose","bind","children","beginButton","Button","text","getText","undefined","press","type","endButton","content","_jsxs","_Fragment","VBox","Text","List","headerText","annotations","UI","HeaderInfo","TypeNamePlural","showSeparators","items","map","notApplicableContext","titleExpression","getTitleExpression","customListItem","CustomListItem","HBox","justifyContent","setBindingContext","actionLabel","key","defaultKey","getOverriddenText","pop","checkIfResourceKeyExists"],"sources":["./NotApplicableContextDialog.tsx"],"sourcesContent":["import type { EntityType } from \"@sap-ux/vocabularies-types\";\nimport type ResourceModel from \"sap/fe/core/ResourceModel\";\nimport { getTitleExpression } from \"sap/fe/core/templating/EntityTypeHelper\";\nimport Button from \"sap/m/Button\";\nimport CustomListItem from \"sap/m/CustomListItem\";\nimport Dialog from \"sap/m/Dialog\";\nimport HBox from \"sap/m/HBox\";\nimport List from \"sap/m/List\";\nimport Text from \"sap/m/Text\";\nimport VBox from \"sap/m/VBox\";\nimport type Control from \"sap/ui/core/Control\";\nimport type Context from \"sap/ui/model/Context\";\n\n/**\n * Display a dialog to inform the user that some contexts are not applicable for the action.\n * This is not the target Ux but just keeping the current behavior\n */\nexport default class NotApplicableContextDialog {\n\tprivate readonly title: string;\n\n\tprivate resourceModel: ResourceModel;\n\n\tprivate readonly entityType: EntityType;\n\n\tprivate readonly _dialog: Dialog;\n\n\tprivate readonly _processingPromise: Promise<boolean>;\n\n\tprivate _fnResolve!: (resolveValue: boolean) => void;\n\n\tprivate _shouldContinue: boolean;\n\n\tprivate readonly actionName: string | undefined;\n\n\tprivate readonly entitySetName: string | undefined;\n\n\tprivate notApplicableContexts: Context[];\n\n\tprivate applicableContexts: Context[];\n\n\tconstructor(props: {\n\t\ttitle: string;\n\t\tentityType: EntityType;\n\t\tresourceModel: ResourceModel;\n\t\tnotApplicableContexts: Context[];\n\t\tapplicableContexts: Context[];\n\t\tentitySet?: string;\n\t\tactionName?: string;\n\t}) {\n\t\tthis.title = props.title;\n\t\tthis.resourceModel = props.resourceModel;\n\t\tthis.entityType = props.entityType;\n\t\tthis.applicableContexts = props.applicableContexts;\n\t\tthis.notApplicableContexts = props.notApplicableContexts;\n\t\tthis._shouldContinue = false;\n\t\tthis.actionName = props.actionName;\n\t\tthis.entitySetName = props.entitySet;\n\t\tthis._dialog = this.createDialog();\n\t\tthis._processingPromise = new Promise((resolve) => {\n\t\t\tthis._fnResolve = resolve;\n\t\t});\n\t}\n\n\tprivate onAfterClose(): void {\n\t\tthis._fnResolve(this._shouldContinue);\n\t\tthis._dialog.destroy();\n\t}\n\n\tprivate onContinue(): void {\n\t\tthis._shouldContinue = true;\n\t\tthis._dialog.close();\n\t}\n\n\tasync open(owner: Control): Promise<boolean> {\n\t\towner.addDependent(this._dialog);\n\t\tthis._dialog.open();\n\t\treturn this._processingPromise;\n\t}\n\n\tgetDialog(): Dialog {\n\t\treturn this._dialog;\n\t}\n\n\tcreateDialog(): Dialog {\n\t\tlet boundActionName = this.actionName;\n\t\tboundActionName = boundActionName?.includes(\".\")\n\t\t\t? boundActionName?.split(\".\")[boundActionName?.split(\".\").length - 1]\n\t\t\t: boundActionName;\n\t\tconst suffixResourceKey = boundActionName && this.entitySetName ? `${this.entitySetName}|${boundActionName}` : \"\";\n\t\tconst totalContexts = this.notApplicableContexts?.length + this.applicableContexts.length;\n\t\treturn (\n\t\t\t<Dialog\n\t\t\t\tstate={\"Warning\"}\n\t\t\t\tshowHeader={true}\n\t\t\t\tresizable={true}\n\t\t\t\tverticalScrolling={true}\n\t\t\t\thorizontalScrolling={true}\n\t\t\t\tclass={\"sapUiContentPadding\"}\n\t\t\t\ttitle={this.getTitleText(this.title)}\n\t\t\t\tafterClose={this.onAfterClose.bind(this)}\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tbeginButton: (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttext={this.resourceModel.getText(\n\t\t\t\t\t\t\t\t\"C_ACTION_PARTIAL_FRAGMENT_SAPFE_CONTINUE_ANYWAY\",\n\t\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\t\tsuffixResourceKey\n\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\tpress={this.onContinue.bind(this)}\n\t\t\t\t\t\t\ttype=\"Emphasized\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t),\n\t\t\t\t\tendButton: (\n\t\t\t\t\t\t<Button text={this.resourceModel.getText(\"C_COMMON_SAPFE_CLOSE\")} press={(): Dialog => this._dialog.close()} />\n\t\t\t\t\t),\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<VBox>\n\t\t\t\t\t\t\t\t<Text\n\t\t\t\t\t\t\t\t\ttext={\n\t\t\t\t\t\t\t\t\t\tthis.notApplicableContexts.length === 1\n\t\t\t\t\t\t\t\t\t\t\t? this.resourceModel.getText(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"C_ACTION_PARTIAL_FRAGMENT_SAPFE_BOUND_ACTION\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t[this.notApplicableContexts.length, totalContexts],\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuffixResourceKey\n\t\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t\t\t: this.resourceModel.getText(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\"C_ACTION_PARTIAL_FRAGMENT_SAPFE_BOUND_ACTION_PLURAL\",\n\t\t\t\t\t\t\t\t\t\t\t\t\t[this.notApplicableContexts.length, totalContexts],\n\t\t\t\t\t\t\t\t\t\t\t\t\tsuffixResourceKey\n\t\t\t\t\t\t\t\t\t\t\t  )\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tclass=\"sapUiTinyMarginBegin sapUiTinyMarginTopBottom\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<List headerText={this.entityType.annotations.UI?.HeaderInfo?.TypeNamePlural} showSeparators=\"None\">\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\titems: this.notApplicableContexts.map((notApplicableContext) => {\n\t\t\t\t\t\t\t\t\t\t// Either show the HeaderInfoName or the Semantic Key property\n\t\t\t\t\t\t\t\t\t\tconst titleExpression = getTitleExpression(this.entityType);\n\t\t\t\t\t\t\t\t\t\tconst customListItem = (\n\t\t\t\t\t\t\t\t\t\t\t<CustomListItem>\n\t\t\t\t\t\t\t\t\t\t\t\t<HBox justifyContent={\"Start\"}>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<Text text={titleExpression} class=\"sapUiTinyMarginBegin sapUiTinyMarginTopBottom\" />\n\t\t\t\t\t\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t\t\t\t\t\t</CustomListItem>\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tcustomListItem.setBindingContext(notApplicableContext);\n\t\t\t\t\t\t\t\t\t\treturn customListItem;\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</Dialog>\n\t\t) as Dialog;\n\t}\n\n\t/**\n\t * Gets the title of the dialog.\n\t * @param actionLabel The label of the action\n\t * @returns The title.\n\t */\n\tprivate getTitleText(actionLabel: string | undefined): string {\n\t\tconst key = \"ACTION_PARAMETER_DIALOG_ACTION_TITLE\";\n\t\tconst defaultKey = \"C_OPERATIONS_ACTION_PARAMETER_DIALOG_TITLE\";\n\t\treturn this.getOverriddenText(key, defaultKey, actionLabel);\n\t}\n\n\t/**\n\t * Gets an overridden text.\n\t * @param key The key for an overridden text\n\t * @param defaultKey The default key for the text\n\t * @param actionLabel The label of the action\n\t * @returns The overridden text or label.\n\t */\n\tprivate getOverriddenText(key: string, defaultKey: string, actionLabel?: string): string {\n\t\tlet boundActionName = this.actionName?.split(\"(\")[0];\n\t\tboundActionName = boundActionName?.split(\".\").pop() ?? boundActionName;\n\t\tconst suffixResourceKey = boundActionName && this.entitySetName ? `${this.entitySetName}|${boundActionName}` : \"\";\n\t\tif (actionLabel) {\n\t\t\tif (this.resourceModel.checkIfResourceKeyExists(`${key}|${suffixResourceKey}`)) {\n\t\t\t\treturn this.resourceModel.getText(key, undefined, suffixResourceKey);\n\t\t\t} else if (this.resourceModel.checkIfResourceKeyExists(`${key}|${this.entitySetName}`)) {\n\t\t\t\treturn this.resourceModel.getText(key, undefined, `${this.entitySetName}`);\n\t\t\t} else if (this.resourceModel.checkIfResourceKeyExists(`${key}`)) {\n\t\t\t\treturn this.resourceModel.getText(key);\n\t\t\t} else {\n\t\t\t\treturn actionLabel;\n\t\t\t}\n\t\t} else {\n\t\t\treturn this.resourceModel.getText(defaultKey);\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[]}