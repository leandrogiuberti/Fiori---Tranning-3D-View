{"version":3,"names":["CreationMode","FELibrary","ProgrammingModel","DeleteOptionTypes","deleteHelper","DeleteDialogContentControl","getParameters","mParameters","getMetadata","getName","TransactionHelper","_proto","prototype","busyLock","appComponent","busyPath","BusyLocker","lock","getModel","busyUnlock","unlock","getProgrammingModel","source","path","isA","getPath","isRelative","getResolvedPath","metaModel","getMetaModel","ModelHelper","isDraftSupported","Draft","isStickySessionSupported","Sticky","NonDraft","validateDocument","oContext","oView","sCustomValidationFunction","customValidationFunction","sModule","substring","lastIndexOf","replace","sFunctionName","length","mData","data","FPMHelper","validationWrapper","Promise","resolve","getDataFromDefaultValueFunction","listBinding","model","metaContext","getMetaContext","listBindingObjectPath","MetaModelConverter","getInvolvedDataModelObjects","defaultFuncOnTargetObject","targetObject","annotations","Common","DefaultValuesFunction","defaultFuncOnTargetEntitySet","targetEntitySet","defaultFunctionName","toString","undefined","functionOnNavProp","isNavigationProperty","defaultFunctionContext","bindingPath","context","getContext","startsWith","includes","firstNav","split","parentPath","bindContext","getBoundContext","getHeaderContext","operation","Operation","getOperationFromName","isAnAction","isAction","result","ODataOperation","contexts","enhance$select","groupId","execute","filter","isFulfilled","value","boundContext","getObject","isListBindingHierarchical","getAggregation","hierarchyQualifier","isListBindingAnalytical","aggregation","createContext","initialData","options","dataForCreation","listBindingForCreation","parentContext","isExpanded","expand","Object","assign","bindList","$$groupId","getGroupId","$$updateGroupId","getUpdateGroupId","objectPath","parentNavigation","targetEntityType","Aggregation","ParentNavigationProperty","Error","parentBindingData","create","createAtEnd","createInactive","getCreationParameters","createData","metaPath","getMetaPath","nonComputedVisibleFields","getCreatePopupFields","fieldName","createDocument","mainListBinding","inParameters","resourceModel","messageHandler","fromCopyPaste","defaultValueFunctionData","newDocumentContext","parameters","programmingModel","getBusyPath","beforeCreateCallBack","inactive","messageHandlingKey","registerToHoldMessages","performCreation","showMessageDialog","control","parentControl","unHoldKey","error","Constants","ActionExecutionFailed","CancelActionDialog","isTransient","delete","busyMode","busyId","createDocumentContext","createParameters","entries","map","_ref","key","toES6Promise","contextPath","Log","OnBeforeCreateFailed","reduce","currentObject","createPromise","CommonUtils","INLINEEDIT_UPDATEGROUPID","submitBatch","createHash","getRouterProxy","getHash","componentData","getComponentData","startupParameters","newAction","_getNewAction","performCreationWithAction","status","reason","returnedContext","performCreationWithPOST","actionName","headerContextPath","messagesPath","getMessagesPath","bindingParameters","$$patchWithoutSideEffects","selectedProperties","push","join","callAction","showActionParameterDialog","label","_getSpecificCreateActionDialogLabel","view","isCreateAction","skipParameterDialog","defaultData","canHaveDialog","creationMode","CreationRow","Inline","creationDialogFields","CreationDialog","forEach","createWithDialog","refreshListBinding","waitForCreateCompletion","keepTransientContextOnFailed","msg","message","_isDraftEnabled","vContexts","contextForDraftModel","sProgrammingModel","deleteDocument","contextsToDelete","Array","isArray","firstContext","selectedContexts","draftEnabled","items","unSavedContext","entitySetName","getCollectionNameFromContext","numberOfSelectedContexts","lockedContext","find","contextData","IsActiveEntity","HasDraftEntity","DraftAdministrativeData","InProcessByUser","DraftIsCreatedByMe","showDeleMessageLockedObjet","nonTableTxt","unSavedContextUser","getText","title","description","type","deletableContexts","text","selected","TEXT","totalDeletable","draftsWithNonDeletableActive","draftsWithDeletableActive","unSavedContexts","updateDraftOptionsForDeletableTexts","nonDeletableText","getNonDeletableText","optionsDeletableTexts","getOptionsForDeletableTexts","commonBinding","getBinding","bindingType","updateContentForDeleteDialog","noDialog","silentMode","confirmed","showDeleteConfirmationDialog","messageHandling","removeBoundTransitionMessages","deleteConfirmHandler","lockingUserName","promiseKeeper","PromiseKeeper","MessageBox","show","onClose","promise","dialog","createDeleteDialog","addStyleClass","open","dialogConfirmed","vBox","VBox","resourceBundleCore","Library","getResourceBundleFor","Dialog","state","content","ariaLabelledBy","beginButton","Button","press","close","endButton","afterClose","destroy","editDocument","transactionDetails","removeTransitionMessages","oNewContext","draft","createDraftFromActiveDocument","bPreserveChanges","sticky","editDocumentInStickySession","err","showMessages","concurrentEditFlag","prepareSiblingContext","semanticKeys","SemanticKeyHelper","getSemanticKeys","semanticKeyPaths","$PropertyPath","$select","entityPath","technicalKeys","cancelDocument","mInParameters","isNewObject","isObjectModified","oModel","returnedValue","siblingContext","siblingContextCanonicalPath","draftAdminData","siblingData","draftDataContext","all","requestCanonicalPath","requestObject","CreationDateTime","LastChangeDateTime","skipDiscardPopover","_confirmDiscard","cancelButton","isKeepAlive","setKeepAlive","beforeCancelCallBack","hasPendingChanges","resetChanges","deleteDraft","discardedContext","discardDocument","refresh","activeContext","activeContextData","saveDocument","executeSideEffectsOnError","bindingsForSideEffects","skipConfirmationMsg","arguments","isStandardSave","oActiveDocument","activateDocument","messagesReceived","getMessages","concat","getType","MessageType","Success","MessageToast","hasTransientContext","getSideEffectsService","requestSideEffectsForNavigationProperty","sActionName","contextToProcess","sName","controlId","byId","oResult","convertedAction","parameterValues","invocationGrouping","oDataProperties","ghostContextBindingProtection","ignoreETag","oDataEvents","onODataSubmit","onODataResponse","onRequestSideEffects","handleActionEnablementOnOperation","internalModelContext","operationAvailableMap","defaultValuesExtensionFunction","convertedActionImport","action","_handleActionResponse","name","actionHelper","isStaticAction","getProperty","ActionRuntime","setActionEnablement","JSON","parse","getSelectedContexts","updateDeleteInfoForSelectedContexts","aTransientMessages","setProperty","handleValidationError","errorToRemove","Messaging","getMessageModel","getData","validation","removeMessages","_createPopover","settings","Popover","isModified","setEnabled","reject","confirmationPopover","showHeader","placement","Text","id","confirmButton","width","addAriaLabelledBy","addContent","attachBeforeOpen","setInitialFocus","attachAfterClose","destroyContent","CancelDiscardDraft","openBy","isRoot","requestSideEffects","$NavigationPropertyPath","requestRefresh","fieldNames","listMetaPath","transientListBinding","refreshInternal","transientContext","fieldMetaContexts","createBindingContext","createDialog","getCoreUIFactory","newCreateDialog","setUserDefaults","createAction","openDialog","e","resultPromiseKeeper","onExitDialog","event","getParameter","closeDialog","setBusy","bIsCreateDialog","transientData","keys","propertyPath","oProperty","$kind","createDataAsArray","_ref2","UiModelConstants","DocumentModified","newContext","creationSuccess","afterCreateCallBack","displayErrorMessages","showBoundStateMessages","CreationFailed","isOperationDialogOpen","isOpen","attachExitDialog","parentListBinding","onCreateCompleted","createdContext","success","detachCreateCompleted","attachCreateCompleted","creationSuccessful","created","catch","contextError","trace","oStartupParameters","sCreateHash","oMetaModel","sMetaPath","sNewAction","preferredMode","toUpperCase","sPreferredMode","lineItems","lineItem","isDataFieldForAction","Action","Label","singleton"],"sourceRoot":".","sources":["TransactionHelper.ts"],"sourcesContent":["import type { Action as EdmAction, EntitySet, NavigationProperty } from \"@sap-ux/vocabularies-types\";\nimport type { LineItem } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport Log from \"sap/base/Log\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type { FEView } from \"sap/fe/core/BaseController\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type ResourceModel from \"sap/fe/core/ResourceModel\";\nimport type { ExitDialogEvent } from \"sap/fe/core/UIProvider\";\nimport { getCoreUIFactory } from \"sap/fe/core/UIProvider\";\nimport BusyLocker from \"sap/fe/core/controllerextensions/BusyLocker\";\nimport type MessageHandler from \"sap/fe/core/controllerextensions/MessageHandler\";\nimport type { BindContextParameters } from \"sap/fe/core/controllerextensions/editFlow/draft\";\nimport draft from \"sap/fe/core/controllerextensions/editFlow/draft\";\nimport UiModelConstants from \"sap/fe/core/controllerextensions/editFlow/editFlowConstants\";\nimport sticky from \"sap/fe/core/controllerextensions/editFlow/sticky\";\nimport messageHandling from \"sap/fe/core/controllerextensions/messageHandler/messageHandling\";\nimport * as MetaModelConverter from \"sap/fe/core/converters/MetaModelConverter\";\nimport { isDataFieldForAction } from \"sap/fe/core/converters/annotations/DataField\";\nimport type { DeleteOption, DeleteParameters } from \"sap/fe/core/helpers/DeleteHelper\";\nimport deleteHelper from \"sap/fe/core/helpers/DeleteHelper\";\nimport FPMHelper from \"sap/fe/core/helpers/FPMHelper\";\nimport { getCreatePopupFields } from \"sap/fe/core/helpers/MetaModelFunction\";\nimport type { InternalModelContext } from \"sap/fe/core/helpers/ModelHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport PromiseKeeper from \"sap/fe/core/helpers/PromiseKeeper\";\nimport SemanticKeyHelper from \"sap/fe/core/helpers/SemanticKeyHelper\";\nimport toES6Promise from \"sap/fe/core/helpers/ToES6Promise\";\nimport { isAction, isFulfilled, isNavigationProperty } from \"sap/fe/core/helpers/TypeGuards\";\nimport FELibrary from \"sap/fe/core/library\";\nimport Button from \"sap/m/Button\";\nimport Dialog from \"sap/m/Dialog\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport type { $PopoverSettings } from \"sap/m/Popover\";\nimport Popover from \"sap/m/Popover\";\nimport Text from \"sap/m/Text\";\nimport VBox from \"sap/m/VBox\";\nimport type Event from \"sap/ui/base/Event\";\nimport type Control from \"sap/ui/core/Control\";\nimport Library from \"sap/ui/core/Lib\";\nimport Messaging from \"sap/ui/core/Messaging\";\nimport type Message from \"sap/ui/core/message/Message\";\nimport MessageType from \"sap/ui/core/message/MessageType\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type Table from \"sap/ui/mdc/Table\";\nimport type MultiValueFieldItem from \"sap/ui/mdc/field/MultiValueFieldItem\";\nimport type Binding from \"sap/ui/model/Binding\";\nimport type Context from \"sap/ui/model/Context\";\nimport type ODataV4Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type { ODataListBinding$CreateCompletedEvent } from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport ActionRuntime from \"../../ActionRuntime\";\nimport type { OperationResult } from \"./operations/ODataOperation\";\nimport ODataOperation from \"./operations/ODataOperation\";\nimport Operation from \"./operations/Operation\";\nimport actionHelper from \"./operations/actionHelper\";\n\nconst CreationMode = FELibrary.CreationMode;\nconst ProgrammingModel = FELibrary.ProgrammingModel;\n\n//Enums for delete text calculations for delete confirm dialog.\nconst DeleteOptionTypes = deleteHelper.DeleteOptionTypes;\nconst DeleteDialogContentControl = deleteHelper.DeleteDialogContentControl;\n\n/* Make sure that the mParameters is not the oEvent */\nfunction getParameters<T>(mParameters?: Event | T): T {\n\tif (mParameters && (mParameters as Event).getMetadata && (mParameters as Event).getMetadata().getName() === \"sap.ui.base.Event\") {\n\t\tmParameters = {} as T;\n\t}\n\treturn (mParameters as T) || ({} as T);\n}\n\nexport type CreateParameters = {\n\tdata?: Record<string, unknown>;\n\tbusyMode?: string;\n\tbusyId?: string;\n\tkeepTransientContextOnFailed?: boolean;\n\tparentControl: View;\n\tinactive?: boolean;\n\tbeforeCreateCallBack?: Function;\n\tafterCreateCallBack?: (context: ODataV4Context) => Promise<void>;\n\tskipParameterDialog?: boolean;\n\tcreationMode?: string;\n\tcreateAtEnd?: boolean;\n\tparentContext?: ODataV4Context;\n\tcreationDialogFields?: string[];\n};\n\nexport type CancelParameters = { cancelButton: Button; skipDiscardPopover: boolean; beforeCancelCallBack?: Function };\nexport type TransactionDeleteParameters = DeleteParameters & {\n\tselectedContexts?: ODataV4Context[];\n\ttitle?: string;\n\tnoDialog?: boolean;\n};\n\nexport type EditTransactionExecutionDetails = {\n\texistingDraftReused?: boolean; // true if an existing draft was returned, instead of returning a new one\n};\n\nclass TransactionHelper {\n\tbusyLock(appComponent: AppComponent, busyPath?: string): void {\n\t\tBusyLocker.lock(appComponent.getModel(\"ui\"), busyPath);\n\t}\n\n\tbusyUnlock(appComponent: AppComponent, busyPath?: string): void {\n\t\tBusyLocker.unlock(appComponent.getModel(\"ui\"), busyPath);\n\t}\n\n\tgetProgrammingModel(source: ODataV4Context | Binding): typeof ProgrammingModel {\n\t\tlet path: string;\n\t\tif (source.isA<ODataV4Context>(\"sap.ui.model.odata.v4.Context\")) {\n\t\t\tpath = source.getPath();\n\t\t} else {\n\t\t\tpath = (source.isRelative() ? source.getResolvedPath() : source.getPath()) ?? \"\";\n\t\t}\n\n\t\tconst metaModel = source.getModel()?.getMetaModel() as ODataMetaModel | undefined;\n\t\tif (metaModel && ModelHelper.isDraftSupported(metaModel, path)) {\n\t\t\treturn ProgrammingModel.Draft;\n\t\t} else if (metaModel && ModelHelper.isStickySessionSupported(metaModel)) {\n\t\t\treturn ProgrammingModel.Sticky;\n\t\t} else {\n\t\t\treturn ProgrammingModel.NonDraft;\n\t\t}\n\t}\n\n\t/**\n\t * Validates a document.\n\t * @param oContext Context of the document to be validated\n\t * @param [mParameters] Can contain the following attributes:\n\t * @param [mParameters.data] A map of data that should be validated\n\t * @param [mParameters.customValidationFunction] A string representing the path to the validation function\n\t * @param oView Contains the object of the current view\n\t * @returns Promise resolves with result of the custom validation function\n\t * @final\n\t */\n\tasync validateDocument(\n\t\toContext: ODataV4Context,\n\t\tmParameters: { customValidationFunction?: string; data: Record<string, unknown> },\n\t\toView: View\n\t): Promise<{ messageTarget?: string; messageText: string }[]> {\n\t\tconst sCustomValidationFunction = mParameters && mParameters.customValidationFunction;\n\t\tif (sCustomValidationFunction) {\n\t\t\tconst sModule = sCustomValidationFunction.substring(0, sCustomValidationFunction.lastIndexOf(\".\") || -1).replace(/\\./gi, \"/\"),\n\t\t\t\tsFunctionName = sCustomValidationFunction.substring(\n\t\t\t\t\tsCustomValidationFunction.lastIndexOf(\".\") + 1,\n\t\t\t\t\tsCustomValidationFunction.length\n\t\t\t\t),\n\t\t\t\tmData = mParameters.data;\n\t\t\tdelete mData[\"@$ui5.context.isTransient\"];\n\t\t\treturn FPMHelper.validationWrapper(sModule, sFunctionName, mData, oView, oContext);\n\t\t}\n\t\treturn Promise.resolve([]);\n\t}\n\n\t/**\n\t * Retrieves default values from the DefaultValue function.\n\t * @param listBinding The list binding to be used for creation\n\t * @param appComponent The app component\n\t * @returns A promise with an object containing the default values (or undefined if there's no default value function)\n\t */\n\tpublic async getDataFromDefaultValueFunction(listBinding: ODataListBinding, appComponent: AppComponent): Promise<object | undefined> {\n\t\tconst model = listBinding.getModel();\n\t\tconst metaModel = model.getMetaModel();\n\t\tconst metaContext = metaModel.getMetaContext(listBinding.getResolvedPath() as string);\n\t\tconst listBindingObjectPath = MetaModelConverter.getInvolvedDataModelObjects(metaContext);\n\n\t\tconst defaultFuncOnTargetObject = (listBindingObjectPath.targetObject as NavigationProperty | EntitySet).annotations.Common\n\t\t\t?.DefaultValuesFunction;\n\t\tconst defaultFuncOnTargetEntitySet = (listBindingObjectPath.targetEntitySet as EntitySet | undefined)?.annotations.Common\n\t\t\t?.DefaultValuesFunction;\n\t\tconst defaultFunctionName = (defaultFuncOnTargetObject ?? defaultFuncOnTargetEntitySet)?.toString();\n\n\t\tif (!defaultFunctionName) {\n\t\t\t// No default value function\n\t\t\treturn undefined;\n\t\t}\n\t\tconst functionOnNavProp = isNavigationProperty(listBindingObjectPath.targetObject) && defaultFuncOnTargetObject !== undefined;\n\t\tlet defaultFunctionContext;\n\n\t\tif (functionOnNavProp) {\n\t\t\t// If the path is a deep navigation, derive the correct parent context\n\t\t\tconst bindingPath = listBinding.getPath();\n\t\t\tconst context = listBinding.getContext();\n\t\t\tif (bindingPath?.startsWith(\"/\")) {\n\t\t\t\tdefaultFunctionContext = context;\n\t\t\t} else if (bindingPath && context && bindingPath.includes(\"/\")) {\n\t\t\t\t// Extract the first part of the navigation path (e.g., _ToHeader/_ToItems â†’ _ToHeader)\n\t\t\t\tconst firstNav = bindingPath.split(\"/\")[0];\n\n\t\t\t\t// Build the full path to the correct context for the function call\n\t\t\t\tconst parentPath = `${context.getPath()}/${firstNav}`;\n\n\t\t\t\t// Create a new binding context for this path\n\t\t\t\tdefaultFunctionContext = model.bindContext(parentPath).getBoundContext();\n\t\t\t} else {\n\t\t\t\t// Fallback to the current context if no navigation found\n\t\t\t\tdefaultFunctionContext = context;\n\t\t\t}\n\t\t} else {\n\t\t\t// If not a navigation property, use the header context (root object page context)\n\t\t\tdefaultFunctionContext = listBinding.getHeaderContext();\n\t\t}\n\t\t//const defaultFunctionContext = functionOnNavProp ? listBinding.getContext() : listBinding.getHeaderContext();\n\t\tif (!defaultFunctionContext) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst operation =\n\t\t\tOperation.getOperationFromName(defaultFunctionName, model, defaultFunctionContext) ??\n\t\t\tOperation.getOperationFromName(defaultFunctionName, model);\n\t\tif (!operation) {\n\t\t\treturn undefined;\n\t\t}\n\n\t\tconst isAnAction = isAction(operation);\n\t\tconst result = await new ODataOperation(\n\t\t\toperation,\n\t\t\t{\n\t\t\t\tappComponent,\n\t\t\t\tmodel,\n\t\t\t\tcontexts: isAnAction ? [defaultFunctionContext] : []\n\t\t\t},\n\t\t\t{\n\t\t\t\tenhance$select: false,\n\t\t\t\tgroupId: isAnAction ? \"functionGroup\" : \"functionImport\"\n\t\t\t}\n\t\t).execute();\n\t\treturn result.filter(isFulfilled)[0]?.value.boundContext.getObject();\n\t}\n\n\t/**\n\t * Checks if a list binding corresponds to a hierarchy.\n\t * @param listBinding\n\t * @returns True if the list binding is hierarchical.\n\t */\n\tisListBindingHierarchical(listBinding: ODataListBinding): boolean {\n\t\treturn (listBinding.getAggregation() as { hierarchyQualifier?: string } | undefined)?.hierarchyQualifier ? true : false;\n\t}\n\n\t/**\n\t * Checks if the given list binding is analytical.\n\t * @param listBinding The list binding to check\n\t * @returns TRUE if the list binding is analytical, `false` otherwise.\n\t */\n\tisListBindingAnalytical(listBinding: ODataListBinding): boolean {\n\t\tconst aggregation = listBinding.getAggregation() as { hierarchyQualifier?: string } | undefined;\n\t\treturn aggregation !== undefined && !aggregation.hierarchyQualifier;\n\t}\n\n\t/**\n\t * Creates a new context in a list binding. Handles both flat and hierarchical cases.\n\t * @param listBinding\n\t * @param initialData Initial data to create the context.\n\t * @param options Creation options.\n\t * @param options.createAtEnd Create the context at the end of the list (ignored in case of a hierarchy).\n\t * @param options.createInactive Create the context as inactive (ignored in case of a hierarchy).\n\t * @param options.parentContext Create the context as a\t child of this context (ony used in case of a hierarchy).\n\t * @returns The created context.\n\t */\n\tprivate async createContext(\n\t\tlistBinding: ODataListBinding,\n\t\tinitialData: object | undefined,\n\t\toptions: { createAtEnd?: boolean; createInactive?: boolean; parentContext?: ODataV4Context }\n\t): Promise<ODataV4Context> {\n\t\tconst dataForCreation = initialData ?? {};\n\n\t\tif (this.isListBindingHierarchical(listBinding)) {\n\t\t\tlet listBindingForCreation: ODataListBinding;\n\t\t\tif (options.parentContext?.isExpanded() === false) {\n\t\t\t\t// If the parent context already has children and is collapsed, we expand it first\n\t\t\t\tawait listBinding.expand(options.parentContext);\n\t\t\t}\n\n\t\t\tif (listBinding.isRelative()) {\n\t\t\t\tObject.assign(dataForCreation, { \"@$ui5.node.parent\": options.parentContext });\n\t\t\t\tlistBindingForCreation = listBinding;\n\t\t\t} else {\n\t\t\t\t// Absolute binding: creation from the ListReport\n\t\t\t\t// We use a temporary flat listBinding for the creation, to avoid adding the new context in the table (we don't want to display it until it's saved)\n\t\t\t\tconst model = listBinding.getModel();\n\t\t\t\tconst metaModel = model.getMetaModel();\n\t\t\t\tlistBindingForCreation = model.bindList(listBinding.getPath(), undefined, undefined, undefined, {\n\t\t\t\t\t$$groupId: listBinding.getGroupId(),\n\t\t\t\t\t$$updateGroupId: listBinding.getUpdateGroupId()\n\t\t\t\t});\n\n\t\t\t\t// Add the parent path in the initial data if a parent is provided\n\t\t\t\tif (options.parentContext) {\n\t\t\t\t\tconst objectPath = MetaModelConverter.getInvolvedDataModelObjects(metaModel.getMetaContext(listBinding.getPath()));\n\t\t\t\t\tconst hierarchyQualifier = (listBinding.getAggregation() as { hierarchyQualifier: string }).hierarchyQualifier;\n\t\t\t\t\tconst parentNavigation =\n\t\t\t\t\t\tobjectPath.targetEntityType.annotations.Aggregation?.[`RecursiveHierarchy#${hierarchyQualifier}`]\n\t\t\t\t\t\t\t?.ParentNavigationProperty.value;\n\t\t\t\t\tif (!parentNavigation) {\n\t\t\t\t\t\tthrow new Error(`Cannot find parent navigation property for ${listBinding.getPath()}`);\n\t\t\t\t\t}\n\t\t\t\t\tconst parentBindingData: Record<string, string> = {};\n\t\t\t\t\tparentBindingData[`${parentNavigation}@odata.bind`] = options.parentContext.getPath().replace(/^\\//, \"\"); // Remove leading \"/\" from the path\n\t\t\t\t\tObject.assign(dataForCreation, parentBindingData);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn listBindingForCreation.create(dataForCreation, true);\n\t\t} else if (this.isListBindingAnalytical(listBinding)) {\n\t\t\tif (listBinding.isRelative()) {\n\t\t\t\tthrow new Error(\"Creating a new document in a analytical table is supported only in a ListReport\");\n\t\t\t} else {\n\t\t\t\t// We use a temporary flat listBinding for the creation, to avoid adding the new context in the table (we don't want to display it until it's saved)\n\t\t\t\tconst model = listBinding.getModel();\n\t\t\t\tconst listBindingForCreation = model.bindList(listBinding.getPath(), undefined, undefined, undefined, {\n\t\t\t\t\t$$groupId: listBinding.getGroupId(),\n\t\t\t\t\t$$updateGroupId: listBinding.getUpdateGroupId()\n\t\t\t\t});\n\t\t\t\treturn listBindingForCreation.create(dataForCreation, true);\n\t\t\t}\n\t\t} else {\n\t\t\treturn listBinding.create(dataForCreation, true, options.createAtEnd, options.createInactive);\n\t\t}\n\t}\n\n\tgetCreationParameters(listBinding: ODataListBinding, createData: object | undefined, appComponent: AppComponent): string[] {\n\t\tconst metaModel = listBinding.getModel().getMetaModel();\n\t\tconst metaPath = metaModel.getMetaPath(listBinding.getHeaderContext()!.getPath());\n\n\t\tconst nonComputedVisibleFields = getCreatePopupFields(metaModel, metaPath, appComponent);\n\t\t// Do not consider fields for which we provide some initial data\n\t\treturn nonComputedVisibleFields.filter((fieldName: string) => {\n\t\t\treturn !(fieldName in (createData ?? {}));\n\t\t});\n\t}\n\n\t/**\n\t * Creates a new document.\n\t * @param mainListBinding OData V4 ListBinding object\n\t * @param [inParameters] Optional, can contain the following attributes:\n\t * @param [inParameters.data] A map of data that should be sent within the POST\n\t * @param [inParameters.busyMode] Global (default), Local, None TODO: to be refactored\n\t * @param [inParameters.busyId] ID of the local busy indicator\n\t * @param [inParameters.keepTransientContextOnFailed] If set, the context stays in the list if the POST failed and POST will be repeated with the next change\n\t * @param [inParameters.inactive] If set, the context is set as inactive for empty rows\n\t * @param [inParameters.skipParameterDialog] Skips the action parameter dialog\n\t * @param appComponent The app component\n\t * @param resourceModel The resource model\n\t * @param messageHandler The message handler extension\n\t * @param fromCopyPaste True if the creation has been triggered by a paste action\n\t * @param defaultValueFunctionData Default values retrieved from the DefaultValuesFunction to be applied to the new document\n\t * @returns Promise resolves with new binding context\n\t * @final\n\t */\n\tasync createDocument(\n\t\tmainListBinding: ODataListBinding,\n\t\tinParameters: CreateParameters | undefined,\n\t\tappComponent: AppComponent,\n\t\tresourceModel: ResourceModel,\n\t\tmessageHandler: MessageHandler,\n\t\tfromCopyPaste: boolean,\n\t\tdefaultValueFunctionData?: object | undefined\n\t): Promise<ODataV4Context> {\n\t\tlet newDocumentContext: ODataV4Context | undefined;\n\t\tconst parameters = getParameters(inParameters);\n\t\tif (!mainListBinding) {\n\t\t\tthrow new Error(\"Binding required for new document creation\");\n\t\t}\n\t\tconst programmingModel = this.getProgrammingModel(mainListBinding);\n\t\tif (programmingModel !== ProgrammingModel.Draft && programmingModel !== ProgrammingModel.Sticky) {\n\t\t\tthrow new Error(\"Create document only allowed for draft or sticky session supported services\");\n\t\t}\n\t\tconst busyPath = this.getBusyPath(parameters);\n\t\tparameters.beforeCreateCallBack = fromCopyPaste ? undefined : parameters.beforeCreateCallBack;\n\t\tif (!inParameters?.inactive) {\n\t\t\tthis.busyLock(appComponent, busyPath);\n\t\t}\n\t\tconst messageHandlingKey = messageHandler.registerToHoldMessages();\n\t\ttry {\n\t\t\tnewDocumentContext = await this.performCreation(\n\t\t\t\tmainListBinding,\n\t\t\t\tparameters,\n\t\t\t\tappComponent,\n\t\t\t\tmessageHandler,\n\t\t\t\tresourceModel,\n\t\t\t\tfromCopyPaste,\n\t\t\t\tdefaultValueFunctionData\n\t\t\t);\n\t\t\tawait messageHandler.showMessageDialog({ control: parameters.parentControl, unHoldKey: messageHandlingKey });\n\t\t\treturn newDocumentContext!;\n\t\t} catch (error: unknown) {\n\t\t\t// TODO: currently, the only errors handled here are raised as string - should be changed to Error objects\n\t\t\tawait messageHandler.showMessageDialog({ control: parameters.parentControl, unHoldKey: messageHandlingKey });\n\t\t\tif (\n\t\t\t\t(error === FELibrary.Constants.ActionExecutionFailed || error === FELibrary.Constants.CancelActionDialog) &&\n\t\t\t\tnewDocumentContext?.isTransient()\n\t\t\t) {\n\t\t\t\t// This is a workaround suggested by model as Context.delete results in an error\n\t\t\t\t// TODO: remove the $direct once model resolves this issue\n\t\t\t\t// this line shows the expected console error Uncaught (in promise) Error: Request canceled: POST Travel; group: submitLater\n\t\t\t\tnewDocumentContext.delete(\"$direct\");\n\t\t\t}\n\t\t\tthrow error;\n\t\t} finally {\n\t\t\tif (!inParameters?.inactive) {\n\t\t\t\tthis.busyUnlock(appComponent, busyPath);\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate getBusyPath(mParameters: CreateParameters): string {\n\t\treturn mParameters.busyMode === \"Local\" ? `/busyLocal/${mParameters.busyId}` : \"/busy\";\n\t}\n\n\t/**\n\t * Creates a new document.\n\t * @param mainListBinding OData V4 ListBinding object.\n\t * @param parameters Contains the following attributes\n\t * @param parameters.data A map of data that should be sent within the POST\n\t * @param parameters.busyMode Global (default), Local, None\n\t * @param parameters.busyId ID of the local busy indicator\n\t * @param parameters.keepTransientContextOnFailed If set, the context stays in the list if the POST failed and POST will be repeated with the next change\n\t * @param parameters.parentControl\n\t * @param parameters.inactive If set, the context is set as inactive for empty rows\n\t * @param parameters.beforeCreateCallBack Callback to be called before the creation\n\t * @param parameters.skipParameterDialog Skips the action parameter dialog\n\t * @param parameters.createAtEnd Create the context at the end of the list (ignored in case of a hierarchy).\n\t * @param parameters.createInactive Create the context as inactive (ignored in case of a hierarchy).\n\t * @param parameters.parentContext Create the context as a child of this context (only used in case of a hierarchy).\n\t * @returns Promise resolves with new binding context\n\t */\n\tprivate async createDocumentContext(mainListBinding: ODataListBinding, parameters: CreateParameters): Promise<ODataV4Context> {\n\t\tif (parameters.beforeCreateCallBack) {\n\t\t\t//beforeCreateCallBack expects createParameters of type any[]\n\t\t\tconst createParameters = parameters.data ? Object.entries(parameters.data).map(([key, value]) => ({ [key]: value })) : [];\n\t\t\ttry {\n\t\t\t\tawait toES6Promise(\n\t\t\t\t\tparameters.beforeCreateCallBack({\n\t\t\t\t\t\tcontextPath: mainListBinding && mainListBinding.getPath(),\n\t\t\t\t\t\tcreateParameters: createParameters\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t} catch (error: unknown) {\n\t\t\t\tLog.error(error as string);\n\t\t\t\tthrow FELibrary.Constants.OnBeforeCreateFailed;\n\t\t\t}\n\t\t\tparameters.data = createParameters.reduce((result, currentObject) => {\n\t\t\t\treturn { ...result, ...currentObject };\n\t\t\t}, {});\n\t\t}\n\t\tconst createPromise = this.createContext(mainListBinding, parameters.data, {\n\t\t\tcreateAtEnd: !!parameters.createAtEnd,\n\t\t\tcreateInactive: !!parameters.inactive,\n\t\t\tparentContext: parameters.parentContext\n\t\t});\n\t\tif (mainListBinding.getUpdateGroupId() === CommonUtils.INLINEEDIT_UPDATEGROUPID) {\n\t\t\tmainListBinding.getModel().submitBatch(CommonUtils.INLINEEDIT_UPDATEGROUPID);\n\t\t}\n\t\treturn createPromise;\n\t}\n\n\t/**\n\t * Creates a new document either via new Action or standard POST create.\n\t * @param mainListBinding OData V4 ListBinding object\n\t * @param parameters Contains the following attributes\n\t * @param parameters.data A map of data that should be sent within the POST\n\t * @param parameters.busyMode Global (default), Local, None\n\t * @param parameters.busyId ID of the local busy indicator\n\t * @param parameters.keepTransientContextOnFailed If set, the context stays in the list if the POST failed and POST will be repeated with the next change\n\t * @param parameters.parentControl\n\t * @param parameters.inactive If set, the context is set as inactive for empty rows\n\t * @param parameters.beforeCreateCallBack Callback to be called before the creation\n\t * @param parameters.skipParameterDialog Skips the action parameter dialog\n\t * @param parameters.createAtEnd Create the context at the end of the list (ignored in case of a hierarchy).\n\t * @param parameters.createInactive Create the context as inactive (ignored in case of a hierarchy).\n\t * @param parameters.parentContext Create the context as a child of this context (only used in case of a hierarchy).\n\t * @param appComponent The app component\n\t * @param messageHandler The message handler extension\n\t * @param resourceModel\n\t * @param fromCopyPaste True if the creation has been triggered by a paste action\n\t * @param defaultValueFunctionData Default values retrieved from the DefaultValuesFunction to be applied to the new document\n\t * @returns Promise resolves with new binding context\n\t */\n\tprivate async performCreation(\n\t\tmainListBinding: ODataListBinding,\n\t\tparameters: CreateParameters,\n\t\tappComponent: AppComponent,\n\t\tmessageHandler: MessageHandler,\n\t\tresourceModel: ResourceModel,\n\t\tfromCopyPaste: boolean,\n\t\tdefaultValueFunctionData?: object | undefined\n\t): Promise<ODataV4Context | undefined> {\n\t\tconst metaModel = mainListBinding.getModel().getMetaModel();\n\t\tconst metaPath = metaModel.getMetaPath(mainListBinding.getHeaderContext()!.getPath());\n\t\tconst createHash = appComponent.getRouterProxy().getHash();\n\t\tconst componentData = appComponent.getComponentData();\n\t\tconst startupParameters = componentData?.startupParameters ?? {};\n\t\tconst newAction = !mainListBinding.isRelative()\n\t\t\t? this._getNewAction(startupParameters, createHash, metaModel, metaPath)\n\t\t\t: undefined;\n\n\t\tif (newAction) {\n\t\t\tconst result = await this.performCreationWithAction(\n\t\t\t\tnewAction,\n\t\t\t\tmainListBinding,\n\t\t\t\tparameters,\n\t\t\t\tappComponent,\n\t\t\t\tresourceModel,\n\t\t\t\tmessageHandler\n\t\t\t);\n\t\t\tif (result.status === \"rejected\") {\n\t\t\t\tthrow result.reason;\n\t\t\t}\n\t\t\treturn result.value.returnedContext;\n\t\t} else {\n\t\t\treturn this.performCreationWithPOST(\n\t\t\t\tmainListBinding,\n\t\t\t\tparameters,\n\t\t\t\tappComponent,\n\t\t\t\tresourceModel,\n\t\t\t\tmessageHandler,\n\t\t\t\tfromCopyPaste,\n\t\t\t\tdefaultValueFunctionData\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Creates a document with an action.\n\t * @param actionName\n\t * @param mainListBinding\n\t * @param parameters\n\t * @param appComponent\n\t * @param resourceModel\n\t * @param messageHandler\n\t * @returns The created context.\n\t */\n\tprivate async performCreationWithAction(\n\t\tactionName: string,\n\t\tmainListBinding: ODataListBinding,\n\t\tparameters: CreateParameters,\n\t\tappComponent: AppComponent,\n\t\tresourceModel: ResourceModel,\n\t\tmessageHandler: MessageHandler\n\t): Promise<PromiseSettledResult<OperationResult>> {\n\t\tconst headerContextPath = mainListBinding.getHeaderContext()!.getPath();\n\t\tconst metaModel = mainListBinding.getModel().getMetaModel();\n\t\tconst metaPath = metaModel.getMetaPath(headerContextPath);\n\t\tconst messagesPath = ModelHelper.getMessagesPath(metaModel, metaPath);\n\t\tconst bindingParameters: BindContextParameters = { $$patchWithoutSideEffects: true, $$updateGroupId: \"$auto\" };\n\n\t\tconst selectedProperties: string[] = [];\n\t\tif (messagesPath) {\n\t\t\tselectedProperties.push(messagesPath);\n\t\t}\n\t\tif (this.getProgrammingModel(mainListBinding) === ProgrammingModel.Draft) {\n\t\t\tselectedProperties.push(\"IsActiveEntity\", \"HasDraftEntity\", \"HasActiveEntity\"); // Needed for our internal logic (e.g. navigation)\n\t\t}\n\t\tif (selectedProperties.length > 0) {\n\t\t\tbindingParameters[\"$select\"] = selectedProperties.join(\",\");\n\t\t}\n\t\tconst result = await this.callAction(\n\t\t\tactionName,\n\t\t\t{\n\t\t\t\tcontexts: mainListBinding.getHeaderContext(),\n\t\t\t\tshowActionParameterDialog: true,\n\t\t\t\tlabel: this._getSpecificCreateActionDialogLabel(metaModel, metaPath, actionName, resourceModel),\n\t\t\t\tbindingParameters: bindingParameters,\n\t\t\t\tview: parameters.parentControl,\n\t\t\t\tisCreateAction: true,\n\t\t\t\tskipParameterDialog: parameters.skipParameterDialog\n\t\t\t},\n\t\t\tappComponent,\n\t\t\tmessageHandler\n\t\t);\n\t\treturn result[0];\n\t}\n\n\t/**\n\t * Creates a docuemnt with a standard POST request.\n\t * @param mainListBinding\n\t * @param parameters\n\t * @param appComponent\n\t * @param resourceModel\n\t * @param messageHandler\n\t * @param fromCopyPaste\n\t * @param defaultValueFunctionData Default values retrieved from the DefaultValuesFunction to be applied to the new document\n\t * @returns The created context.\n\t */\n\tprivate async performCreationWithPOST(\n\t\tmainListBinding: ODataListBinding,\n\t\tparameters: CreateParameters,\n\t\tappComponent: AppComponent,\n\t\tresourceModel: ResourceModel,\n\t\tmessageHandler: MessageHandler,\n\t\tfromCopyPaste: boolean,\n\t\tdefaultValueFunctionData?: object | undefined\n\t): Promise<ODataV4Context | undefined> {\n\t\ttry {\n\t\t\tlet newDocumentContext: ODataV4Context | undefined;\n\t\t\tconst initialData = parameters.data;\n\t\t\tif (!fromCopyPaste) {\n\t\t\t\tlet defaultData = defaultValueFunctionData;\n\t\t\t\tif (defaultData === undefined) {\n\t\t\t\t\tdefaultData = await this.getDataFromDefaultValueFunction(mainListBinding, appComponent);\n\t\t\t\t}\n\t\t\t\tparameters.data = Object.assign({}, defaultData, parameters.data);\n\t\t\t}\n\t\t\tif (parameters.data) {\n\t\t\t\tdelete parameters.data[\"@odata.context\"];\n\t\t\t}\n\n\t\t\tconst canHaveDialog = parameters.creationMode !== CreationMode.CreationRow && parameters.creationMode !== CreationMode.Inline;\n\t\t\tconst creationDialogFields = canHaveDialog ? this.getCreationParameters(mainListBinding, initialData, appComponent) : [];\n\t\t\tif (parameters.creationMode === CreationMode.CreationDialog) {\n\t\t\t\tparameters.creationDialogFields?.forEach((fieldName) => {\n\t\t\t\t\tif (!creationDialogFields.includes(fieldName)) {\n\t\t\t\t\t\tcreationDialogFields.push(fieldName);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (creationDialogFields.length === 0) {\n\t\t\t\t\t// In CreationDialog mode, the dialog is mandatory\n\t\t\t\t\tthrow new Error(\"No fields available for the creation dialog\");\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (creationDialogFields.length > 0) {\n\t\t\t\tnewDocumentContext = await this.createWithDialog(\n\t\t\t\t\tmainListBinding,\n\t\t\t\t\tcreationDialogFields,\n\t\t\t\t\tparameters,\n\t\t\t\t\tappComponent,\n\t\t\t\t\tresourceModel,\n\t\t\t\t\tmessageHandler\n\t\t\t\t);\n\t\t\t\tif (this.isListBindingAnalytical(mainListBinding)) {\n\t\t\t\t\t// Refresh the list binding is needed to allow the new document created via the creationDialog to be visible in the list report.\n\t\t\t\t\t// This wasn't done for the analytical table because the expansion state is lost but we decided to do it as new documents\n\t\t\t\t\t// created via the creation dialog were not displayed in the table.\n\t\t\t\t\tthis.refreshListBinding(mainListBinding, appComponent);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnewDocumentContext = await this.createDocumentContext(mainListBinding, parameters);\n\t\t\t\tif (!parameters.inactive) {\n\t\t\t\t\tawait this.waitForCreateCompletion(newDocumentContext, parameters.keepTransientContextOnFailed === true);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn newDocumentContext;\n\t\t} catch (error: unknown) {\n\t\t\tconst msg = (error as Error).message ?? error;\n\t\t\tLog.error(\"Error while creating the new document\", msg);\n\t\t\tthrow msg;\n\t\t}\n\t}\n\n\t_isDraftEnabled(vContexts: ODataV4Context[]): boolean {\n\t\tconst contextForDraftModel = vContexts[0];\n\t\tconst sProgrammingModel = this.getProgrammingModel(contextForDraftModel);\n\t\treturn sProgrammingModel === ProgrammingModel.Draft;\n\t}\n\n\t/**\n\t * Delete one or multiple document(s).\n\t * @param contexts Contexts Either one context or an array with contexts to be deleted\n\t * @param mParameters Optional, can contain the following attributes:\n\t * @param mParameters.title Title of the object to be deleted\n\t * @param mParameters.description Description of the object to be deleted\n\t * @param mParameters.numberOfSelectedContexts Number of objects selected\n\t * @param mParameters.noDialog To disable the confirmation dialog\n\t * @param appComponent The appComponent\n\t * @param resourceModel The resource model to load text resources\n\t * @param messageHandler The message handler extension\n\t * @returns A promise resolved to true once the documents are deleted, or to false if the deletion was canceled by the user.\n\t */\n\tasync deleteDocument(\n\t\tcontexts: ODataV4Context | ODataV4Context[],\n\t\tmParameters: TransactionDeleteParameters,\n\t\tappComponent: AppComponent,\n\t\tresourceModel: ResourceModel,\n\t\tmessageHandler: MessageHandler\n\t): Promise<boolean> {\n\t\t// delete document lock\n\t\tthis.busyLock(appComponent);\n\n\t\tconst contextsToDelete = Array.isArray(contexts) ? [...contexts] : [contexts];\n\t\tconst firstContext = (mParameters.selectedContexts ?? contextsToDelete)[0];\n\n\t\ttry {\n\t\t\tconst draftEnabled = this._isDraftEnabled(mParameters.selectedContexts || contextsToDelete);\n\t\t\tconst items: Control[] = [];\n\t\t\tlet options: DeleteOption[] = [];\n\t\t\tlet unSavedContext: Context | undefined;\n\t\t\t// items(texts) and options(checkBoxes and single default option) for confirm dialog.\n\t\t\tif (mParameters) {\n\t\t\t\tmParameters = getParameters(mParameters);\n\t\t\t\tmParameters.entitySetName = this.getCollectionNameFromContext(firstContext);\n\t\t\t\tif (!mParameters.numberOfSelectedContexts) {\n\t\t\t\t\t// non-Table\n\t\t\t\t\tif (draftEnabled) {\n\t\t\t\t\t\t// Check if 1 of the drafts is locked by another user\n\t\t\t\t\t\tconst lockedContext = contextsToDelete.find((context) => {\n\t\t\t\t\t\t\tconst contextData = context.getObject();\n\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\tcontextData.IsActiveEntity === true &&\n\t\t\t\t\t\t\t\tcontextData.HasDraftEntity === true &&\n\t\t\t\t\t\t\t\tcontextData.DraftAdministrativeData &&\n\t\t\t\t\t\t\t\tcontextData.DraftAdministrativeData.InProcessByUser &&\n\t\t\t\t\t\t\t\t!contextData.DraftAdministrativeData.DraftIsCreatedByMe\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t});\n\t\t\t\t\t\tif (lockedContext) {\n\t\t\t\t\t\t\t// Show message box with the name of the locking user and return\n\t\t\t\t\t\t\tawait this.showDeleMessageLockedObjet(lockedContext, resourceModel);\n\t\t\t\t\t\t\treturn false; // No deletion happened\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tunSavedContext = contextsToDelete.find((context) => {\n\t\t\t\t\t\t\t\tconst { IsActiveEntity, HasDraftEntity, DraftAdministrativeData } = context.getObject() || {};\n\t\t\t\t\t\t\t\treturn IsActiveEntity === true && HasDraftEntity === true && !!DraftAdministrativeData?.InProcessByUser;\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tlet nonTableTxt = \"\";\n\t\t\t\t\tif (unSavedContext) {\n\t\t\t\t\t\tconst unSavedContextUser = unSavedContext.getObject().DraftAdministrativeData.InProcessByUser;\n\t\t\t\t\t\tnonTableTxt = resourceModel.getText(\n\t\t\t\t\t\t\t\"C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_UNSAVED_CHANGES\",\n\t\t\t\t\t\t\t[unSavedContextUser],\n\t\t\t\t\t\t\tmParameters.entitySetName\n\t\t\t\t\t\t);\n\t\t\t\t\t} else if (mParameters.title) {\n\t\t\t\t\t\tif (mParameters.description) {\n\t\t\t\t\t\t\tnonTableTxt = resourceModel.getText(\n\t\t\t\t\t\t\t\t\"C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTINFO\",\n\t\t\t\t\t\t\t\t[mParameters.title, mParameters.description],\n\t\t\t\t\t\t\t\tmParameters.entitySetName\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tnonTableTxt = resourceModel.getText(\n\t\t\t\t\t\t\t\t\"C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_ONLY\",\n\t\t\t\t\t\t\t\t[mParameters.title],\n\t\t\t\t\t\t\t\tmParameters.entitySetName\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnonTableTxt = resourceModel.getText(\n\t\t\t\t\t\t\t\"C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_OBJECTTITLE_SINGULAR\",\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tmParameters.entitySetName\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\toptions.push({\n\t\t\t\t\t\ttype: DeleteOptionTypes.deletableContexts,\n\t\t\t\t\t\tcontexts: contextsToDelete,\n\t\t\t\t\t\ttext: nonTableTxt,\n\t\t\t\t\t\tselected: true,\n\t\t\t\t\t\tcontrol: DeleteDialogContentControl.TEXT\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\t// Table\n\t\t\t\t\tlet totalDeletable = contextsToDelete.length;\n\n\t\t\t\t\tif (draftEnabled) {\n\t\t\t\t\t\ttotalDeletable +=\n\t\t\t\t\t\t\t(mParameters.draftsWithNonDeletableActive?.length ?? 0) +\n\t\t\t\t\t\t\t(mParameters.draftsWithDeletableActive?.length ?? 0) +\n\t\t\t\t\t\t\t(mParameters.unSavedContexts?.length ?? 0);\n\t\t\t\t\t\tdeleteHelper.updateDraftOptionsForDeletableTexts(\n\t\t\t\t\t\t\tmParameters,\n\t\t\t\t\t\t\tcontextsToDelete,\n\t\t\t\t\t\t\ttotalDeletable,\n\t\t\t\t\t\t\tresourceModel,\n\t\t\t\t\t\t\titems,\n\t\t\t\t\t\t\toptions\n\t\t\t\t\t\t);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst nonDeletableText = deleteHelper.getNonDeletableText(mParameters, totalDeletable, resourceModel);\n\t\t\t\t\t\tif (nonDeletableText) {\n\t\t\t\t\t\t\titems.push(nonDeletableText);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tconst optionsDeletableTexts = deleteHelper.getOptionsForDeletableTexts(mParameters, contextsToDelete, resourceModel);\n\t\t\t\t\toptions = [...options, ...optionsDeletableTexts];\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst commonBinding = firstContext.getBinding() as Binding;\n\t\t\tlet bindingType: \"Tree\" | \"Analytical\" | undefined;\n\t\t\tif (commonBinding.isA<ODataListBinding>(\"sap.ui.model.odata.v4.ODataListBinding\")) {\n\t\t\t\tif (this.isListBindingHierarchical(commonBinding)) {\n\t\t\t\t\tbindingType = \"Tree\";\n\t\t\t\t} else if (this.isListBindingAnalytical(commonBinding)) {\n\t\t\t\t\tbindingType = \"Analytical\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Confirm the deletion if needed\n\t\t\tdeleteHelper.updateContentForDeleteDialog(options, items);\n\t\t\tif (mParameters.noDialog !== true && mParameters.silentMode !== true) {\n\t\t\t\tconst confirmed = await this.showDeleteConfirmationDialog(items, mParameters, resourceModel);\n\t\t\t\tif (!confirmed) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Proceed with the deletion\n\t\t\tmessageHandling.removeBoundTransitionMessages();\n\t\t\tawait deleteHelper.deleteConfirmHandler(\n\t\t\t\toptions,\n\t\t\t\tmParameters,\n\t\t\t\tmessageHandler,\n\t\t\t\tresourceModel,\n\t\t\t\tappComponent,\n\t\t\t\tdraftEnabled,\n\t\t\t\tbindingType\n\t\t\t);\n\n\t\t\treturn true;\n\t\t} finally {\n\t\t\t// delete document unlock\n\t\t\tthis.busyUnlock(appComponent);\n\t\t}\n\t}\n\n\t/**\n\t * Shows an error message when trying to delee a locked object.\n\t * @param lockedContext\n\t * @param resourceModel\n\t * @returns A promise that resolves when the message box is closed\n\t */\n\tprivate async showDeleMessageLockedObjet(lockedContext: ODataV4Context, resourceModel: ResourceModel): Promise<void> {\n\t\tconst lockingUserName = lockedContext.getObject().DraftAdministrativeData.InProcessByUser;\n\t\tconst promiseKeeper = new PromiseKeeper<void>();\n\t\tMessageBox.show(resourceModel.getText(\"C_TRANSACTION_HELPER_CONFIRM_DELETE_WITH_SINGLE_OBJECT_LOCKED\", [lockingUserName]), {\n\t\t\ttitle: resourceModel.getText(\"C_COMMON_DELETE\"),\n\t\t\tonClose: () => {\n\t\t\t\tpromiseKeeper.resolve();\n\t\t\t}\n\t\t});\n\n\t\treturn promiseKeeper.promise;\n\t}\n\n\t/**\n\t * Shows the dialog to confirm the object deletion.\n\t * @param items\n\t * @param parameters\n\t * @param resourceModel\n\t * @returns True if the user accepted the deletion, false otherwise\n\t */\n\tprivate async showDeleteConfirmationDialog(\n\t\titems: Control[],\n\t\tparameters: Partial<{ parentControl: Control | undefined; entitySetName: string }>,\n\t\tresourceModel: ResourceModel\n\t): Promise<boolean> {\n\t\tconst promiseKeeper = new PromiseKeeper<boolean>();\n\t\tconst dialog = this.createDeleteDialog(items, parameters, resourceModel, promiseKeeper);\n\t\tdialog.addStyleClass(\"sapUiContentPadding\");\n\t\tdialog.open();\n\t\treturn promiseKeeper.promise;\n\t}\n\n\t/**\n\t * Create the confirmation dialog fo the deletion.\n\t * @param items An array of controls used for the dialog content\n\t * @param parameters Contains the following attributes:\n\t * @param parameters.parentControl Parent control of the delete button if any\n\t * @param parameters.entitySetName Name of the current entitySet\n\t * @param resourceModel The resource model to load text resources\n\t * @param promiseKeeper\n\t * @returns The created delete confirmation dialog\n\t */\n\tcreateDeleteDialog(\n\t\titems: Control[],\n\t\tparameters: Partial<{ parentControl: Control | undefined; entitySetName: string }>,\n\t\tresourceModel: ResourceModel,\n\t\tpromiseKeeper: PromiseKeeper<boolean>\n\t): Dialog {\n\t\tlet dialogConfirmed = false;\n\t\tconst vBox = new VBox({ items: items });\n\t\tconst resourceBundleCore = Library.getResourceBundleFor(\"sap.fe.core\")!;\n\t\tlet title: string | undefined;\n\t\tif (parameters.parentControl?.isA(\"sap.ui.mdc.Table\")) {\n\t\t\ttitle = resourceModel.getText(\"M_COMMON_TABLE_DELETE\", undefined, parameters.entitySetName);\n\t\t} else {\n\t\t\ttitle = resourceBundleCore.getText(\"C_COMMON_DELETE\");\n\t\t}\n\t\tconst dialog = new Dialog({\n\t\t\ttitle: title,\n\t\t\tstate: \"Warning\",\n\t\t\tcontent: [vBox],\n\t\t\tariaLabelledBy: items,\n\t\t\tbeginButton: new Button({\n\t\t\t\ttext: title,\n\t\t\t\ttype: \"Emphasized\",\n\t\t\t\tpress: function (): void {\n\t\t\t\t\tdialogConfirmed = true;\n\t\t\t\t\tdialog.close();\n\t\t\t\t}\n\t\t\t}),\n\t\t\tendButton: new Button({\n\t\t\t\ttext: resourceModel.getText(\"C_COMMON_DIALOG_CANCEL\"),\n\t\t\t\tpress: function (): void {\n\t\t\t\t\tdialog.close();\n\t\t\t\t}\n\t\t\t}),\n\t\t\tafterClose: function (): void {\n\t\t\t\tdialog.destroy();\n\t\t\t\t// if dialog is closed unconfirmed (e.g. via \"Cancel\" or Escape button), ensure to reject promise\n\t\t\t\tpromiseKeeper.resolve(dialogConfirmed);\n\t\t\t}\n\t\t});\n\t\treturn dialog;\n\t}\n\n\t/**\n\t * Edits a document.\n\t * @param oContext Context of the active document\n\t * @param oView Current view\n\t * @param appComponent The appComponent\n\t * @param messageHandler The message handler extension\n\t * @param groupId The batch groupId for post call of edit action\n\t * @param transactionDetails Optional object to return additional details about how the transaction was executed\n\t * @returns Promise resolves with the new draft context in case of draft programming model\n\t * @final\n\t */\n\tasync editDocument(\n\t\toContext: ODataV4Context,\n\t\toView: FEView,\n\t\tappComponent: AppComponent,\n\t\tmessageHandler: MessageHandler,\n\t\tgroupId: string,\n\t\ttransactionDetails?: EditTransactionExecutionDetails\n\t): Promise<ODataV4Context | undefined> {\n\t\tconst sProgrammingModel = this.getProgrammingModel(oContext);\n\t\tif (!oContext) {\n\t\t\tthrow new Error(\"Binding context to active document is required\");\n\t\t}\n\t\tif (sProgrammingModel !== ProgrammingModel.Draft && sProgrammingModel !== ProgrammingModel.Sticky) {\n\t\t\tthrow new Error(\"Edit is only allowed for draft or sticky session supported services\");\n\t\t}\n\t\tthis.busyLock(appComponent);\n\t\t// before triggering the edit action we'll have to remove all bound transition messages\n\t\tmessageHandler.removeTransitionMessages();\n\t\tconst messageHandlingKey = messageHandler.registerToHoldMessages();\n\n\t\ttry {\n\t\t\tconst oNewContext =\n\t\t\t\tsProgrammingModel === ProgrammingModel.Draft\n\t\t\t\t\t? await draft.createDraftFromActiveDocument(\n\t\t\t\t\t\t\toContext,\n\t\t\t\t\t\t\tappComponent,\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tbPreserveChanges: true,\n\t\t\t\t\t\t\t\toView: oView\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tgroupId,\n\t\t\t\t\t\t\tmessageHandler,\n\t\t\t\t\t\t\ttransactionDetails\n\t\t\t\t\t  )\n\t\t\t\t\t: await sticky.editDocumentInStickySession(oContext, appComponent, messageHandler);\n\n\t\t\tawait messageHandler.showMessageDialog({ unHoldKey: messageHandlingKey });\n\t\t\treturn oNewContext;\n\t\t} catch (err: unknown) {\n\t\t\tawait messageHandler.showMessages({ concurrentEditFlag: true, unHoldKey: messageHandlingKey });\n\t\t\tthrow err;\n\t\t} finally {\n\t\t\tthis.busyUnlock(appComponent);\n\t\t}\n\t}\n\n\tprepareSiblingContext(context: ODataV4Context): ODataV4Context {\n\t\tconst model = context.getModel();\n\t\tconst metaModel = model.getMetaModel();\n\t\tconst contextPath = context.getPath();\n\t\tconst semanticKeys = SemanticKeyHelper.getSemanticKeys(metaModel, metaModel.getMetaContext(contextPath).getObject(\"@sapui.name\"));\n\t\tif (semanticKeys && semanticKeys.length) {\n\t\t\tconst semanticKeyPaths = semanticKeys.map((key) => key.$PropertyPath);\n\t\t\treturn model.bindContext(`${contextPath}/SiblingEntity`, undefined, { $select: semanticKeyPaths }).getBoundContext();\n\t\t}\n\t\tconst entityPath = metaModel.getMetaPath(contextPath);\n\t\tconst technicalKeys = metaModel.getObject(`${entityPath}/SiblingEntity/`)[\"$Key\"];\n\t\treturn model.bindContext(`${contextPath}/SiblingEntity`, undefined, { $select: technicalKeys }).getBoundContext();\n\t}\n\t/**\n\t * Cancel 'edit' mode of a document.\n\t * @param oContext Context of the document to be canceled or deleted\n\t * @param [mInParameters] Optional, can contain the following attributes:\n\t * @param mInParameters.cancelButton Cancel Button of the discard popover (mandatory for now)\n\t * @param mInParameters.skipDiscardPopover Optional, supresses the discard popover incase of draft applications while navigating out of OP\n\t * @param appComponent The appComponent\n\t * @param resourceModel The model to load text resources\n\t * @param messageHandler The message handler extension\n\t * @param isNewObject True if we're trying to cancel a newly created object\n\t * @param isObjectModified True if the object has been modified by the user\n\t * @returns Promise resolves with ???\n\t * @final\n\t */\n\tasync cancelDocument(\n\t\toContext: ODataV4Context,\n\t\tmInParameters: CancelParameters | undefined,\n\t\tappComponent: AppComponent,\n\t\tresourceModel: ResourceModel,\n\t\tmessageHandler: MessageHandler,\n\t\tisNewObject: boolean,\n\t\tisObjectModified: boolean\n\t): Promise<{\n\t\tactiveContext: ODataV4Context | undefined;\n\t\tactiveContextData: Record<string, unknown> | undefined;\n\t}> {\n\t\t//context must always be passed - mandatory parameter\n\t\tif (!oContext) {\n\t\t\tthrow new Error(\"No context exists. Pass a meaningful context\");\n\t\t}\n\t\tconst mParameters = getParameters(mInParameters);\n\t\tconst oModel = oContext.getModel();\n\t\tconst sProgrammingModel = this.getProgrammingModel(oContext);\n\n\t\tif (sProgrammingModel !== ProgrammingModel.Draft && sProgrammingModel !== ProgrammingModel.Sticky) {\n\t\t\tthrow new Error(\"Cancel document only allowed for draft or sticky session supported services\");\n\t\t}\n\t\tthis.busyLock(appComponent);\n\t\ttry {\n\t\t\tlet returnedValue: ODataV4Context | undefined;\n\t\t\tlet siblingContext: ODataV4Context | undefined,\n\t\t\t\tsiblingContextCanonicalPath: string | undefined,\n\t\t\t\tdraftAdminData: { DraftAdministrativeData: { CreationDateTime: Date; LastChangeDateTime: Date } },\n\t\t\t\tsiblingData: Record<string, unknown> | undefined;\n\n\t\t\tif (sProgrammingModel === ProgrammingModel.Draft && !isObjectModified) {\n\t\t\t\tsiblingContext = this.prepareSiblingContext(oContext);\n\t\t\t\tconst draftDataContext = oModel\n\t\t\t\t\t.bindContext(oContext.getPath(), undefined, {\n\t\t\t\t\t\t$select: [\"DraftAdministrativeData/CreationDateTime\", \"DraftAdministrativeData/LastChangeDateTime\"]\n\t\t\t\t\t})\n\t\t\t\t\t.getBoundContext();\n\t\t\t\t[siblingContextCanonicalPath, draftAdminData, siblingData] = await Promise.all([\n\t\t\t\t\tisNewObject ? undefined : siblingContext?.requestCanonicalPath(),\n\t\t\t\t\tdraftDataContext.requestObject(),\n\t\t\t\t\tisNewObject ? undefined : siblingContext?.requestObject()\n\t\t\t\t]);\n\t\t\t\tif (draftAdminData) {\n\t\t\t\t\tisObjectModified =\n\t\t\t\t\t\tdraftAdminData.DraftAdministrativeData?.CreationDateTime !==\n\t\t\t\t\t\tdraftAdminData.DraftAdministrativeData?.LastChangeDateTime;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (!mParameters.skipDiscardPopover) {\n\t\t\t\tawait this._confirmDiscard(mParameters.cancelButton, isObjectModified, resourceModel);\n\t\t\t}\n\t\t\tif (oContext.isKeepAlive()) {\n\t\t\t\t// if the context is kept alive we set it again to detach the onBeforeDestroy callback and handle navigation here\n\t\t\t\t// the context needs to still be kept alive to be able to reset changes properly\n\t\t\t\toContext.setKeepAlive(true, undefined);\n\t\t\t}\n\t\t\tif (mParameters.beforeCancelCallBack) {\n\t\t\t\tawait mParameters.beforeCancelCallBack({ context: oContext });\n\t\t\t}\n\t\t\tif (sProgrammingModel === ProgrammingModel.Draft) {\n\t\t\t\tif (isNewObject) {\n\t\t\t\t\tif (oContext.hasPendingChanges()) {\n\t\t\t\t\t\toContext.getBinding().resetChanges();\n\t\t\t\t\t}\n\t\t\t\t\tawait draft.deleteDraft(oContext, messageHandler, appComponent);\n\t\t\t\t} else {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (oContext.hasPendingChanges()) {\n\t\t\t\t\t\t\toContext.getBinding().resetChanges();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tsiblingContext = siblingContext ?? this.prepareSiblingContext(oContext);\n\t\t\t\t\t\t[siblingContextCanonicalPath, siblingData] = await Promise.all([\n\t\t\t\t\t\t\tsiblingContext?.requestCanonicalPath(),\n\t\t\t\t\t\t\tsiblingContext?.requestObject()\n\t\t\t\t\t\t]);\n\t\t\t\t\t\treturnedValue = siblingContextCanonicalPath\n\t\t\t\t\t\t\t? oModel.bindContext(siblingContextCanonicalPath).getBoundContext()\n\t\t\t\t\t\t\t: undefined;\n\t\t\t\t\t} finally {\n\t\t\t\t\t\tawait draft.deleteDraft(oContext, messageHandler, appComponent);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst discardedContext = await sticky.discardDocument(oContext);\n\t\t\t\tif (discardedContext) {\n\t\t\t\t\tif (discardedContext.hasPendingChanges()) {\n\t\t\t\t\t\tdiscardedContext.getBinding().resetChanges();\n\t\t\t\t\t}\n\t\t\t\t\tif (!isNewObject) {\n\t\t\t\t\t\tdiscardedContext.refresh();\n\t\t\t\t\t\treturnedValue = discardedContext;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// remove existing bound transition messages\n\t\t\tmessageHandler.removeTransitionMessages();\n\t\t\t// show unbound messages\n\t\t\tawait messageHandler.showMessages();\n\n\t\t\treturn {\n\t\t\t\tactiveContext: returnedValue,\n\t\t\t\tactiveContextData: siblingData\n\t\t\t};\n\t\t} catch (err: unknown) {\n\t\t\tawait messageHandler.showMessages();\n\t\t\tthrow err;\n\t\t} finally {\n\t\t\tthis.busyUnlock(appComponent);\n\t\t}\n\t}\n\n\t/**\n\t * Saves the document.\n\t * @param context Context of the document to be saved\n\t * @param appComponent The appComponent\n\t * @param resourceModel The model to load text resources\n\t * @param executeSideEffectsOnError True if we should execute side effects in case of an error\n\t * @param bindingsForSideEffects The listBindings to be used for executing side effects on error\n\t * @param messageHandler The message handler extension\n\t * @param isNewObject True if we're trying to cancel a newly created object\n\t * @param skipConfirmationMsg\n\t * @returns Promise resolves with ???\n\t * @final\n\t */\n\tasync saveDocument(\n\t\tcontext: ODataV4Context,\n\t\tappComponent: AppComponent,\n\t\tresourceModel: ResourceModel,\n\t\texecuteSideEffectsOnError: boolean,\n\t\tbindingsForSideEffects: ODataListBinding[],\n\t\tmessageHandler: MessageHandler,\n\t\tisNewObject: boolean,\n\t\tskipConfirmationMsg = false,\n\t\tisStandardSave?: boolean\n\t): Promise<ODataV4Context> {\n\t\tconst sProgrammingModel = this.getProgrammingModel(context);\n\t\tif (sProgrammingModel !== ProgrammingModel.Sticky && sProgrammingModel !== ProgrammingModel.Draft) {\n\t\t\tthrow new Error(\"Save is only allowed for draft or sticky session supported services\");\n\t\t}\n\n\t\ttry {\n\t\t\tthis.busyLock(appComponent);\n\t\t\tconst entitySetName = this.getCollectionNameFromContext(context);\n\t\t\tconst oActiveDocument =\n\t\t\t\tsProgrammingModel === ProgrammingModel.Draft\n\t\t\t\t\t? await draft.activateDocument(context, appComponent, messageHandler, { resourceModel: resourceModel }, isStandardSave)\n\t\t\t\t\t: await sticky.activateDocument(\n\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\tappComponent,\n\t\t\t\t\t\t\tmessageHandler,\n\t\t\t\t\t\t\t{ resourceModel: resourceModel },\n\t\t\t\t\t\t\tisStandardSave\n\t\t\t\t\t  );\n\n\t\t\tconst messagesReceived = messageHandling.getMessages().concat(messageHandling.getMessages(true, true)); // get unbound and bound messages present in the model\n\t\t\tif (!skipConfirmationMsg && !(messagesReceived.length === 1 && messagesReceived[0].getType() === MessageType.Success)) {\n\t\t\t\t// show our object creation toast only if it is not coming from backend\n\t\t\t\tMessageToast.show(\n\t\t\t\t\tisNewObject\n\t\t\t\t\t\t? resourceModel.getText(\"C_TRANSACTION_HELPER_OBJECT_CREATED\", undefined, entitySetName)\n\t\t\t\t\t\t: resourceModel.getText(\"C_TRANSACTION_HELPER_OBJECT_SAVED\", undefined, entitySetName)\n\t\t\t\t);\n\t\t\t}\n\n\t\t\treturn oActiveDocument;\n\t\t} catch (err: unknown) {\n\t\t\tif (executeSideEffectsOnError && bindingsForSideEffects?.length > 0) {\n\t\t\t\t/* The sideEffects are executed only for table items in transient state */\n\t\t\t\tbindingsForSideEffects.forEach((listBinding) => {\n\t\t\t\t\tif (!CommonUtils.hasTransientContext(listBinding)) {\n\t\t\t\t\t\tappComponent.getSideEffectsService().requestSideEffectsForNavigationProperty(listBinding.getPath(), context);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tawait messageHandler.showMessages();\n\t\t\tthrow err;\n\t\t} finally {\n\t\t\tthis.busyUnlock(appComponent);\n\t\t}\n\t}\n\n\t/**\n\t * Calls a bound or unbound action.\n\t * @param sActionName The name of the action to be called\n\t * @param [mParameters] Contains the following attributes:\n\t * @param [mParameters.parameterValues] A map of action parameter names and provided values\n\t * @param [mParameters.skipParameterDialog] Skips the parameter dialog if values are provided for all of them\n\t * @param [mParameters.contexts] Mandatory for a bound action: Either one context or an array with contexts for which the action is to be called\n\t * @param [mParameters.model] Mandatory for an unbound action: An instance of an OData V4 model\n\t * @param [mParameters.invocationGrouping] Mode how actions are to be called: 'ChangeSet' to put all action calls into one changeset, 'Isolated' to put them into separate changesets\n\t * @param [mParameters.label] A human-readable label for the action\n\t * @param mParameters.bindingParameters\n\t * @param mParameters.showActionParameterDialog\n\t * @param mParameters.entitySetName\n\t * @param mParameters.view\n\t * @param mParameters.controlId\n\t * @param mParameters.isCreateAction\n\t * @param mParameters.operationAvailableMap\n\t * @param mParameters.internalModelContext\n\t * @param mParameters.groupId\n\t * @param mParameters.defaultValuesExtensionFunction\n\t * @param mParameters.ignoreETag If specified, the action is called without ETag handling\n\t * @param appComponent The appComponent\n\t * @param messageHandler The message handler extension\n\t * @returns Promise resolves with an array of response objects (TODO: to be changed)\n\t * @final\n\t */\n\tasync callAction(\n\t\tsActionName: string,\n\t\tmParameters: {\n\t\t\tbindingParameters?: BindContextParameters;\n\t\t\tparameterValues?: Record<string, unknown>[];\n\t\t\tskipParameterDialog?: boolean;\n\t\t\tshowActionParameterDialog?: boolean;\n\t\t\tlabel?: string;\n\t\t\tinvocationGrouping?: string;\n\t\t\tentitySetName?: string;\n\t\t\tcontexts?: ODataV4Context | ODataV4Context[] | null;\n\t\t\tmodel?: ODataModel;\n\t\t\tview: View;\n\t\t\tcontrolId?: string;\n\t\t\tisCreateAction?: boolean;\n\t\t\toperationAvailableMap?: string;\n\t\t\tinternalModelContext?: InternalModelContext | null;\n\t\t\tgroupId?: string;\n\t\t\tdefaultValuesExtensionFunction?: string;\n\t\t\tignoreETag?: boolean;\n\t\t},\n\t\tappComponent: AppComponent,\n\t\tmessageHandler: MessageHandler\n\t): Promise<PromiseSettledResult<OperationResult>[]> {\n\t\tmParameters = getParameters(mParameters);\n\t\tlet contextToProcess;\n\t\tlet oModel: ODataModel | undefined;\n\t\tif (!sActionName) {\n\t\t\tthrow new Error(\"Provide name of action to be executed\");\n\t\t}\n\t\t// action imports are not directly obtained from the metaModel by it is present inside the entityContainer\n\t\t// and the acions it refers to present outside the entitycontainer, hence to obtain kind of the action\n\t\t// split() on its name was required\n\t\tconst sName = sActionName.split(\"/\")[1];\n\n\t\tcontextToProcess = sName ? undefined : mParameters.contexts;\n\t\t//checking whether the context is an array with more than 0 length or not an array(create action)\n\t\tif (contextToProcess && ((Array.isArray(contextToProcess) && contextToProcess.length) || !Array.isArray(contextToProcess))) {\n\t\t\tcontextToProcess = Array.isArray(contextToProcess) ? contextToProcess[0] : contextToProcess;\n\t\t\toModel = contextToProcess.getModel();\n\t\t}\n\t\tif (mParameters.model) {\n\t\t\toModel = mParameters.model;\n\t\t}\n\t\tif (!oModel) {\n\t\t\tthrow new Error(\"Pass a context for a bound action or pass the model for an unbound action\");\n\t\t}\n\t\ttry {\n\t\t\tconst control = (mParameters.controlId ? mParameters.view.byId(mParameters.controlId) : mParameters.view) as\n\t\t\t\t| Control\n\t\t\t\t| undefined;\n\t\t\tlet oResult: PromiseSettledResult<OperationResult>[];\n\t\t\tif (contextToProcess && mParameters.contexts) {\n\t\t\t\tconst contexts = Array.isArray(mParameters.contexts) ? mParameters.contexts : [mParameters.contexts]; // Ensure that contexts is an array (for static actions it's not an we need to fix it)\n\t\t\t\tconst convertedAction = Operation.getOperationFromName(sActionName, oModel, contexts[0]);\n\t\t\t\tif (!isAction(convertedAction)) {\n\t\t\t\t\tthrow new Error(\"Unknown bound action\");\n\t\t\t\t}\n\t\t\t\toResult = await new Operation(appComponent, oModel, convertedAction, {\n\t\t\t\t\tparameterValues: mParameters.parameterValues as Record<string, string | boolean | number | MultiValueFieldItem[]>[],\n\t\t\t\t\tcontexts,\n\t\t\t\t\tinvocationGrouping: mParameters.invocationGrouping,\n\t\t\t\t\tlabel: mParameters.label,\n\t\t\t\t\tskipParameterDialog: mParameters.skipParameterDialog,\n\t\t\t\t\tbindingParameters: mParameters.bindingParameters,\n\t\t\t\t\tentitySetName: mParameters.entitySetName,\n\t\t\t\t\toDataProperties: {\n\t\t\t\t\t\tghostContextBindingProtection: true,\n\t\t\t\t\t\tenhance$select: true,\n\t\t\t\t\t\tgroupId: mParameters.groupId,\n\t\t\t\t\t\tignoreETag: mParameters.ignoreETag\n\t\t\t\t\t},\n\t\t\t\t\toDataEvents: {\n\t\t\t\t\t\tonODataSubmit: (): void => {\n\t\t\t\t\t\t\tmessageHandler?.removeTransitionMessages();\n\t\t\t\t\t\t\tthis.busyLock(appComponent);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonODataResponse: (): void => {\n\t\t\t\t\t\t\tthis.busyUnlock(appComponent);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonRequestSideEffects: (): void => {\n\t\t\t\t\t\t\tthis.handleActionEnablementOnOperation({\n\t\t\t\t\t\t\t\tinternalModelContext: mParameters.internalModelContext,\n\t\t\t\t\t\t\t\toperationAvailableMap: mParameters.operationAvailableMap,\n\t\t\t\t\t\t\t\tcontrol: control,\n\t\t\t\t\t\t\t\tcontexts,\n\t\t\t\t\t\t\t\tconvertedAction\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tview: mParameters.view as FEView,\n\t\t\t\t\tisCreateAction: mParameters.isCreateAction,\n\t\t\t\t\tmessageHandler: messageHandler,\n\t\t\t\t\tdefaultValuesExtensionFunction: mParameters.defaultValuesExtensionFunction\n\t\t\t\t}).execute();\n\t\t\t} else {\n\t\t\t\tconst convertedActionImport = Operation.getOperationFromName(sActionName, oModel);\n\t\t\t\tif (!convertedActionImport || isAction(convertedActionImport)) {\n\t\t\t\t\tthrow new Error(\"Unknown action import\");\n\t\t\t\t}\n\t\t\t\toResult = await new Operation(appComponent, oModel, convertedActionImport.action, {\n\t\t\t\t\tparameterValues: mParameters.parameterValues as Record<string, string | boolean | number | MultiValueFieldItem[]>[],\n\t\t\t\t\tlabel: mParameters.label,\n\t\t\t\t\tskipParameterDialog: mParameters.skipParameterDialog,\n\t\t\t\t\tbindingParameters: mParameters.bindingParameters,\n\t\t\t\t\tentitySetName: mParameters.entitySetName,\n\t\t\t\t\toDataEvents: {\n\t\t\t\t\t\tonODataSubmit: (): void => {\n\t\t\t\t\t\t\tthis.busyLock(appComponent);\n\t\t\t\t\t\t},\n\t\t\t\t\t\tonODataResponse: (): void => {\n\t\t\t\t\t\t\tthis.busyUnlock(appComponent);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\toDataProperties: {\n\t\t\t\t\t\tignoreETag: mParameters.ignoreETag\n\t\t\t\t\t},\n\t\t\t\t\tmessageHandler: messageHandler,\n\t\t\t\t\tview: mParameters.view as FEView\n\t\t\t\t}).execute();\n\t\t\t}\n\n\t\t\tif (messageHandler) {\n\t\t\t\tthis._handleActionResponse(mParameters, sActionName);\n\t\t\t}\n\t\t\treturn oResult;\n\t\t} catch (err: unknown) {\n\t\t\tif (messageHandler) {\n\t\t\t\tthis._handleActionResponse(mParameters, sActionName);\n\t\t\t}\n\t\t\tthrow err;\n\t\t}\n\t}\n\n\t/**\n\t * Gets the collection name from the context.\n\t * @param context The context\n\t * @returns The collection name\n\t */\n\tgetCollectionNameFromContext(context: ODataV4Context): string | undefined {\n\t\tconst metaContext = context.getModel().getMetaModel().getMetaContext(context.getPath());\n\t\treturn (MetaModelConverter.getInvolvedDataModelObjects(metaContext).targetObject as EntitySet | NavigationProperty | undefined)\n\t\t\t?.name;\n\t}\n\n\thandleActionEnablementOnOperation(parameters: {\n\t\tinternalModelContext?: InternalModelContext | null;\n\t\toperationAvailableMap?: string;\n\t\tcontrol?: Control;\n\t\tcontexts?: ODataV4Context[];\n\t\tconvertedAction: EdmAction;\n\t}): void {\n\t\tif (parameters.internalModelContext && parameters.operationAvailableMap) {\n\t\t\tlet selectedContexts: ODataV4Context[] = [];\n\t\t\t//check for skipping static actions\n\t\t\tif (!actionHelper.isStaticAction(parameters.convertedAction)) {\n\t\t\t\tselectedContexts = parameters.internalModelContext.getProperty(\"selectedContexts\") || [];\n\t\t\t\tActionRuntime.setActionEnablement(\n\t\t\t\t\tparameters.internalModelContext,\n\t\t\t\t\tJSON.parse(parameters.operationAvailableMap),\n\t\t\t\t\tselectedContexts,\n\t\t\t\t\t\"table\"\n\t\t\t\t);\n\t\t\t} else if (parameters.control) {\n\t\t\t\tif (parameters.control.isA<Table>(\"sap.ui.mdc.Table\")) {\n\t\t\t\t\tselectedContexts = parameters.control.getSelectedContexts() as ODataV4Context[];\n\t\t\t\t\tActionRuntime.setActionEnablement(\n\t\t\t\t\t\tparameters.internalModelContext,\n\t\t\t\t\t\tJSON.parse(parameters.operationAvailableMap),\n\t\t\t\t\t\tselectedContexts,\n\t\t\t\t\t\t\"table\"\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t\t//update delete button\n\t\t\tdeleteHelper.updateDeleteInfoForSelectedContexts(parameters.internalModelContext, selectedContexts);\n\t\t}\n\t}\n\n\t_handleActionResponse(\n\t\tmParameters: {\n\t\t\tlabel?: string;\n\t\t\tinternalModelContext?: InternalModelContext | null;\n\t\t},\n\t\tsActionName: string\n\t): void {\n\t\tconst aTransientMessages = messageHandling.getMessages(true, true);\n\t\tif (aTransientMessages.length > 0 && mParameters && mParameters.internalModelContext) {\n\t\t\tmParameters.internalModelContext.setProperty(\"sActionName\", mParameters.label ? mParameters.label : sActionName);\n\t\t}\n\t}\n\n\t/**\n\t * Handles validation errors for the 'Discard' action.\n\t * @final\n\t */\n\thandleValidationError(): void {\n\t\tconst errorToRemove = Messaging.getMessageModel()\n\t\t\t.getData()\n\t\t\t.filter((error: Message) => error.validation); // only needs to handle validation messages, technical and persistent errors needs not to be checked here.\n\t\tMessaging.removeMessages(errorToRemove);\n\t}\n\n\t/**\n\t * Creates a new Popover. Factory method to make unit tests easier.\n\t * @param settings Initial parameters for the popover\n\t * @returns A new Popover\n\t */\n\t_createPopover(settings?: $PopoverSettings): Popover {\n\t\treturn new Popover(settings);\n\t}\n\n\t/**\n\t * Shows a popover to confirm discard if needed.\n\t * @param cancelButton The control which will open the popover\n\t * @param isModified True if the object has been modified and a confirmation popover must be shown\n\t * @param resourceModel The model to load text resources\n\t * @returns Promise resolves if user confirms discard, rejects if otherwise, rejects if no control passed to open popover\n\t * @final\n\t */\n\tasync _confirmDiscard(cancelButton: Button, isModified: boolean, resourceModel: ResourceModel): Promise<void> {\n\t\t// If the data isn't modified, do not show any confirmation popover\n\t\tif (!isModified) {\n\t\t\tthis.handleValidationError();\n\t\t\treturn Promise.resolve();\n\t\t}\n\n\t\tcancelButton.setEnabled(false);\n\t\treturn new Promise<void>((resolve, reject) => {\n\t\t\tconst confirmationPopover = this._createPopover({\n\t\t\t\tshowHeader: false,\n\t\t\t\tplacement: \"Top\"\n\t\t\t});\n\t\t\tconfirmationPopover.addStyleClass(\"sapUiContentPadding\");\n\n\t\t\t// Create the content of the popover\n\t\t\tconst title = new Text({\n\t\t\t\tid: \"DraftDiscardMessage\",\n\t\t\t\ttext: resourceModel.getText(\"C_TRANSACTION_HELPER_DRAFT_DISCARD_MESSAGE\")\n\t\t\t});\n\t\t\tconst confirmButton = new Button({\n\t\t\t\ttext: resourceModel.getText(\"C_TRANSACTION_HELPER_DRAFT_DISCARD_BUTTON\"),\n\t\t\t\twidth: \"100%\",\n\t\t\t\tpress: (): void => {\n\t\t\t\t\tthis.handleValidationError();\n\t\t\t\t\tconfirmationPopover.data(\"continueDiscard\", true);\n\t\t\t\t\tconfirmationPopover.close();\n\t\t\t\t}\n\t\t\t});\n\t\t\tconfirmButton.addAriaLabelledBy(title);\n\t\t\tconfirmationPopover.addContent(new VBox({ items: [title, confirmButton] }));\n\n\t\t\t// Attach handler\n\t\t\tconfirmationPopover.attachBeforeOpen(() => {\n\t\t\t\tconfirmationPopover.setInitialFocus(confirmButton);\n\t\t\t});\n\t\t\tconfirmationPopover.attachAfterClose(() => {\n\t\t\t\tconfirmationPopover.destroyContent();\n\t\t\t\tcancelButton.setEnabled(true);\n\t\t\t\tif (confirmationPopover.data(\"continueDiscard\")) {\n\t\t\t\t\tresolve();\n\t\t\t\t} else {\n\t\t\t\t\treject(FELibrary.Constants.CancelDiscardDraft);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tconfirmationPopover.openBy(cancelButton, false);\n\t\t});\n\t}\n\n\t/**\n\t * Reloads data for an ODataListBinding.\n\t * @param listBinding The listbinding to refresh\n\t * @param appComponent\n\t * @returns The corresponding promise\n\t */\n\tasync refreshListBinding(listBinding: ODataListBinding, appComponent: AppComponent): Promise<void> {\n\t\ttry {\n\t\t\tif (listBinding.isRoot()) {\n\t\t\t\tif (this.isListBindingHierarchical(listBinding)) {\n\t\t\t\t\t// We use a side-effect refresh for a TreeTable, to preserve expansion states\n\t\t\t\t\tawait appComponent\n\t\t\t\t\t\t.getSideEffectsService()\n\t\t\t\t\t\t.requestSideEffects([{ $NavigationPropertyPath: \"\" }], listBinding.getHeaderContext()!);\n\t\t\t\t} else {\n\t\t\t\t\tawait listBinding.requestRefresh();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tawait appComponent\n\t\t\t\t\t.getSideEffectsService()\n\t\t\t\t\t.requestSideEffects([{ $NavigationPropertyPath: listBinding.getPath() }], listBinding.getContext());\n\t\t\t}\n\t\t} catch (error) {\n\t\t\tLog.error(`Error while refreshing list binding ${listBinding.getPath()}`, error as string);\n\t\t}\n\t}\n\n\tasync createWithDialog(\n\t\tlistBinding: ODataListBinding,\n\t\tfieldNames: string[],\n\t\tparameters: {\n\t\t\tparentControl?: Control;\n\t\t\tdata?: Record<string, unknown>;\n\t\t\tbIsCreateDialog?: boolean;\n\t\t\tbeforeCreateCallBack?: Function;\n\t\t\tafterCreateCallBack?: (newDocumentContext: ODataV4Context) => Promise<void>;\n\t\t\tcreateAtEnd?: boolean;\n\t\t\tinactive?: boolean;\n\t\t\tparentContext?: ODataV4Context;\n\t\t\tkeepTransientContextOnFailed?: boolean;\n\t\t\tcreateAction?: boolean;\n\t\t\tcreationMode?: string;\n\t\t},\n\t\tappComponent: AppComponent,\n\t\tresourceModel: ResourceModel,\n\t\tmessageHandler: MessageHandler\n\t): Promise<ODataV4Context> {\n\t\tconst model = listBinding.getModel() as ODataModel;\n\t\tconst metaModel = model.getMetaModel();\n\t\tconst listMetaPath = metaModel.getMetaPath(listBinding.getResolvedPath()!);\n\n\t\t// Create a fake (transient) listBinding and context, just for the binding context of the dialog\n\t\tconst transientListBinding = model.bindList(listBinding.getPath(), listBinding.getContext(), undefined, undefined, {\n\t\t\t$$updateGroupId: \"submitLater\"\n\t\t});\n\t\ttransientListBinding.refreshInternal = function (): void {\n\t\t\t/* */\n\t\t};\n\t\tconst transientContext = transientListBinding.create(parameters.data, true);\n\t\tconst fieldMetaContexts = fieldNames.map((name) => {\n\t\t\treturn metaModel.createBindingContext(`${listMetaPath}/${name}`) as Context;\n\t\t});\n\n\t\tconst createDialog = getCoreUIFactory().newCreateDialog(\n\t\t\ttransientContext,\n\t\t\tfieldNames,\n\t\t\tappComponent,\n\t\t\tparameters.creationMode === CreationMode.CreationDialog ? \"Standalone\" : \"WithNavigation\",\n\t\t\tparameters.parentControl\n\t\t);\n\n\t\ttry {\n\t\t\tawait CommonUtils.setUserDefaults(\n\t\t\t\tappComponent,\n\t\t\t\tfieldMetaContexts,\n\t\t\t\ttransientContext,\n\t\t\t\tfalse,\n\t\t\t\tparameters.createAction,\n\t\t\t\tparameters.data\n\t\t\t);\n\t\t\tcreateDialog.openDialog();\n\t\t} catch (e) {\n\t\t\tawait messageHandler.showMessages();\n\t\t\tthrow e;\n\t\t}\n\n\t\tconst resultPromiseKeeper = new PromiseKeeper<ODataV4Context>();\n\n\t\tconst onExitDialog = async (event: ExitDialogEvent): Promise<void> => {\n\t\t\tif (!event.getParameter(\"accept\")) {\n\t\t\t\t// User has cancelled creation: destroy the transient list binding and close the dialog\n\t\t\t\ttransientListBinding.destroy();\n\t\t\t\tcreateDialog.closeDialog();\n\t\t\t\tresultPromiseKeeper.reject(FELibrary.Constants.CancelActionDialog);\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tcreateDialog.setBusy(true);\n\t\t\tparameters.bIsCreateDialog = true;\n\t\t\ttry {\n\t\t\t\tconst transientData = transientContext.getObject();\n\t\t\t\tlet createData: Record<string, unknown> = {};\n\t\t\t\tObject.keys(transientData).forEach((propertyPath) => {\n\t\t\t\t\tconst oProperty = metaModel.getObject(`${listMetaPath}/${propertyPath}`);\n\t\t\t\t\t// Ensure navigation properties are not part of the payload, as deep create not supported\n\t\t\t\t\t// And remove any property starting by @$ui5 as they are not property created by filling the form\n\t\t\t\t\tif (oProperty && oProperty.$kind !== \"NavigationProperty\" && !propertyPath?.startsWith(\"@$ui5\")) {\n\t\t\t\t\t\tcreateData[propertyPath] = transientData[propertyPath];\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif (parameters.beforeCreateCallBack) {\n\t\t\t\t\t//beforeCreateCallBack expects createParameters of type any[]\n\t\t\t\t\tconst createDataAsArray = Object.entries(createData).map(([key, value]) => ({ [key]: value }));\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait toES6Promise(\n\t\t\t\t\t\t\tparameters.beforeCreateCallBack({\n\t\t\t\t\t\t\t\tcontextPath: listBinding.getPath(),\n\t\t\t\t\t\t\t\tcreateParameters: createDataAsArray\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tLog.error(\"Error while creating the new document\", error as string);\n\t\t\t\t\t\tthrow FELibrary.Constants.OnBeforeCreateFailed;\n\t\t\t\t\t}\n\t\t\t\t\tcreateData = createDataAsArray.reduce((result, currentObject) => {\n\t\t\t\t\t\treturn { ...result, ...currentObject };\n\t\t\t\t\t}, {});\n\t\t\t\t}\n\t\t\t\tif (Object.keys(createData).length > 0) {\n\t\t\t\t\tappComponent.getModel(\"ui\").setProperty(UiModelConstants.DocumentModified, true);\n\t\t\t\t}\n\t\t\t\tconst newContext = await this.createContext(listBinding, createData, {\n\t\t\t\t\tcreateAtEnd: parameters.createAtEnd,\n\t\t\t\t\tcreateInactive: parameters.inactive,\n\t\t\t\t\tparentContext: parameters.parentContext\n\t\t\t\t});\n\n\t\t\t\tconst creationSuccess = await this.waitForCreateCompletion(newContext, parameters.keepTransientContextOnFailed === true);\n\t\t\t\tif (creationSuccess) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait parameters.afterCreateCallBack?.(newContext);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tcreateDialog.displayErrorMessages(Messaging.getMessageModel().getData());\n\t\t\t\t\t\tawait messageHandler.showMessageDialog({ showBoundStateMessages: true });\n\n\t\t\t\t\t\t// Delete the created document and refresh its list binding (otherwise the created document is still visible in the list)\n\t\t\t\t\t\tawait this.deleteDocument(newContext, { silentMode: true }, appComponent, resourceModel, messageHandler);\n\t\t\t\t\t\tawait this.refreshListBinding(listBinding, appComponent);\n\n\t\t\t\t\t\tLog.error(\"Error while creating/saving the new document\", error as string);\n\t\t\t\t\t\tthrow FELibrary.Constants.CreationFailed;\n\t\t\t\t\t}\n\n\t\t\t\t\ttransientListBinding.destroy();\n\t\t\t\t\tcreateDialog.closeDialog();\n\t\t\t\t\tresultPromiseKeeper.resolve(newContext);\n\t\t\t\t}\n\t\t\t} catch (error: unknown) {\n\t\t\t\t// in case of creation failed, dialog should stay open - to achieve the same, nothing has to be done (like in case of success with bKeepDialogOpen)\n\t\t\t\tif (![FELibrary.Constants.OnBeforeCreateFailed, FELibrary.Constants.CreationFailed].includes(error)) {\n\t\t\t\t\t// other errors are not expected\n\t\t\t\t\ttransientListBinding.destroy();\n\t\t\t\t\tcreateDialog.closeDialog();\n\t\t\t\t\tresultPromiseKeeper.reject(error as string | Error);\n\t\t\t\t}\n\t\t\t} finally {\n\t\t\t\tcreateDialog.setBusy(false);\n\t\t\t\tmessageHandler.showMessages({ isOperationDialogOpen: createDialog.isOpen() });\n\t\t\t}\n\t\t};\n\n\t\tcreateDialog.attachExitDialog({}, onExitDialog);\n\n\t\treturn resultPromiseKeeper.promise;\n\t}\n\n\t/**\n\t * Waits for the creation of a context to be finished.\n\t * @param newContext The context being created\n\t * @param keepTransientContextOnFailed\n\t * @returns True if the creation was successful\n\t */\n\tasync waitForCreateCompletion(newContext: ODataV4Context, keepTransientContextOnFailed: boolean): Promise<boolean> {\n\t\tconst promiseKeeper = new PromiseKeeper<boolean>();\n\t\tconst parentListBinding = newContext.getBinding() as ODataListBinding;\n\n\t\tconst onCreateCompleted = (event: ODataListBinding$CreateCompletedEvent): void => {\n\t\t\tconst createdContext = event.getParameter(\"context\");\n\t\t\tconst success = event.getParameter(\"success\");\n\t\t\tif (createdContext === newContext) {\n\t\t\t\tparentListBinding.detachCreateCompleted(onCreateCompleted);\n\t\t\t\tpromiseKeeper.resolve(success === true);\n\t\t\t}\n\t\t};\n\n\t\tparentListBinding.attachCreateCompleted(onCreateCompleted);\n\n\t\tconst creationSuccessful = await promiseKeeper.promise;\n\t\tif (!creationSuccessful) {\n\t\t\tif (!keepTransientContextOnFailed) {\n\t\t\t\t// Cancel the pending POST and delete the context in the listBinding\n\t\t\t\t(newContext.created() ?? Promise.resolve()).catch(function (contextError: unknown) {\n\t\t\t\t\tLog.trace(\"transient creation context deletion error\", contextError as string);\n\t\t\t\t});\n\t\t\t\tparentListBinding.resetChanges();\n\t\t\t\tparentListBinding.getModel().resetChanges(parentListBinding.getUpdateGroupId());\n\t\t\t\tthrow FELibrary.Constants.CreationFailed;\n\t\t\t}\n\t\t\treturn false;\n\t\t} else {\n\t\t\tawait newContext.created();\n\t\t\treturn true;\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves the name of the NewAction to be executed.\n\t * @param oStartupParameters Startup parameters of the application\n\t * @param [oStartupParameters.preferredMode]\n\t * @param sCreateHash Hash to be checked for action type\n\t * @param oMetaModel The MetaModel used to check for NewAction parameter\n\t * @param sMetaPath The MetaPath\n\t * @returns The name of the action\n\t * @final\n\t */\n\t_getNewAction(\n\t\toStartupParameters: {\n\t\t\tpreferredMode?: string[];\n\t\t},\n\t\tsCreateHash: string,\n\t\toMetaModel: ODataMetaModel,\n\t\tsMetaPath: string\n\t): string {\n\t\tlet sNewAction;\n\n\t\tif (oStartupParameters && oStartupParameters.preferredMode && sCreateHash.toUpperCase().includes(\"I-ACTION=CREATEWITH\")) {\n\t\t\tconst sPreferredMode = oStartupParameters.preferredMode[0];\n\t\t\tsNewAction = sPreferredMode.toUpperCase().includes(\"CREATEWITH:\")\n\t\t\t\t? sPreferredMode.substring(sPreferredMode.lastIndexOf(\":\") + 1)\n\t\t\t\t: undefined;\n\t\t} else if (\n\t\t\toStartupParameters &&\n\t\t\toStartupParameters.preferredMode &&\n\t\t\tsCreateHash.toUpperCase().includes(\"I-ACTION=AUTOCREATEWITH\")\n\t\t) {\n\t\t\tconst sPreferredMode = oStartupParameters.preferredMode[0];\n\t\t\tsNewAction = sPreferredMode.toUpperCase().includes(\"AUTOCREATEWITH:\")\n\t\t\t\t? sPreferredMode.substring(sPreferredMode.lastIndexOf(\":\") + 1)\n\t\t\t\t: undefined;\n\t\t} else {\n\t\t\tsNewAction =\n\t\t\t\toMetaModel && oMetaModel.getObject !== undefined\n\t\t\t\t\t? oMetaModel.getObject(`${sMetaPath}@com.sap.vocabularies.Session.v1.StickySessionSupported/NewAction`) ||\n\t\t\t\t\t  oMetaModel.getObject(`${sMetaPath}@com.sap.vocabularies.Common.v1.DraftRoot/NewAction`)\n\t\t\t\t\t: undefined;\n\t\t}\n\t\treturn sNewAction;\n\t}\n\n\t/**\n\t * Retrieves the label for the title of a specific create action dialog, e.g. Create Sales Order from Quotation.\n\t *\n\t * The following priority is applied:\n\t * 1. label of line-item annotation.\n\t * 2. label annotated in the action.\n\t * 3. \"Create\" as a constant from i18n.\n\t * @param oMetaModel The MetaModel used to check for the NewAction parameter\n\t * @param sMetaPath The MetaPath\n\t * @param sNewAction Contains the name of the action to be executed\n\t * @param resourceModel ResourceBundle to access the default Create label\n\t * @returns The label for the Create Action Dialog\n\t * @final\n\t */\n\t_getSpecificCreateActionDialogLabel(\n\t\toMetaModel: ODataMetaModel | undefined,\n\t\tsMetaPath: string,\n\t\tsNewAction: string,\n\t\tresourceModel: ResourceModel | undefined\n\t): string | undefined {\n\t\tconst lineItems = oMetaModel?.getObject(`${sMetaPath}/@com.sap.vocabularies.UI.v1.LineItem`) as LineItem | undefined;\n\n\t\tconst label = lineItems?.find((lineItem) => isDataFieldForAction(lineItem) && lineItem.Action.split(\"(\", 1)[0] === sNewAction)\n\t\t\t?.Label;\n\n\t\treturn (\n\t\t\tlabel ||\n\t\t\toMetaModel?.getObject(`${sMetaPath}/${sNewAction}@com.sap.vocabularies.Common.v1.Label`) ||\n\t\t\tresourceModel?.getText(\"C_TRANSACTION_HELPER_SAPFE_ACTION_CREATE\")\n\t\t);\n\t}\n}\n\nconst singleton = new TransactionHelper();\nexport default singleton;\n"],"mappings":"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","ignoreList":[],"file":"TransactionHelper-dbg.js"}