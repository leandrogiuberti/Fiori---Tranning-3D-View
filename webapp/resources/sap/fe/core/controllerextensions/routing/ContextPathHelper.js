/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/SemanticKeyHelper","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(t,e,n,s,i){"use strict";var r={};var a=t.getInvolvedDataModelObjects;function o(t,e){const n=/^[/]?(\w+)\([^/]+\)$/.exec(t);if(!n){return false}const s=`/${n[1]}`;return e.getObject(`${s}@com.sap.vocabularies.Common.v1.DraftRoot`)?true:false}r.isPathOnDraftRoot=o;function l(t,n,r){const a=function(t){if(t.indexOf("'")===0&&t.lastIndexOf("'")===t.length-1){t=decodeURIComponent(t.substring(1,t.length-1))}return t};const o=t.substring(t.indexOf("(")+1,t.length-1).split(",");let l=n;let c=o;if(n.includes("IsActiveEntity")){l=n.filter(t=>!t.includes("IsActiveEntity"));c=o.filter(t=>!t.startsWith("IsActiveEntity"))}if(l.length!=c.length){return null}const u=e.isFilteringCaseSensitive(r);let f;if(l.length===1){if(c[0].indexOf("=")>0){const t=c[0].split("=");c[0]=t[1]}const t=a(c[0]);f=[new s({path:l[0],operator:i.EQ,value1:t,caseSensitive:u})]}else{const t={};c.forEach(function(e){const n=e.split("="),s=a(n[1]);t[n[0]]=s});let e=false;f=l.map(function(n){const r=n,a=t[r];if(a!==undefined){return new s({path:r,operator:i.EQ,value1:a,caseSensitive:u})}else{e=true;return new s({path:"XX"})}});if(e){return null}}const g=new s({filters:[new s("IsActiveEntity","EQ",false),new s("SiblingEntity/IsActiveEntity","EQ",null)],and:false});f.push(g);return new s(f,true)}r.createFilterFromPath=l;async function c(t,e,n){const s=n.getMetaModel();if(!t||t.length===0){return null}const i=l(e,t,s);if(i===null){return null}const r=e.startsWith("/")?e:`/${e}`;const o=s.getMetaContext(r);const c=a(o);const u=c.targetEntityType.keys.map(t=>t.name);const f=n.bindList(o.getPath(),undefined,undefined,i,{$select:u.join(","),$$groupId:"$auto.Heroes"});const g=await f.requestContexts(0,2);if(g.length){return g[0]}else{return null}}async function u(t){const e=t.getModel();const n=e.getMetaModel();const s=a(n.getMetaContext(t.getPath()));const i=s.targetEntityType.keys.map(t=>t.name);return c(i,t.getPath(),e)}r.getDraftOrActiveContext=u;async function f(t,e,s,i){const r=e.getMetaModel();let a=i.getHashChanger().getHash().split("?")[0];if(a?.lastIndexOf("/")===a?.length-1){a=a.substring(0,a.length-1)}if(!o(a,r)){return t}let l=a?.substring(0,a.indexOf("("));if(l[0]==="/"){l=l.substring(1)}const u=n.getSemanticKeys(r,l)?.map(t=>t.$PropertyPath);if(u===undefined){return t}const f=s.getLastSemanticMapping();if(f?.semanticPath===t){return f.technicalPath}const g=await c(u,a,e);const h=g?.getPath();if(h&&h!==t){s.setLastSemanticMapping({technicalPath:h,semanticPath:t});return h}return t}r.resolvePath=f;return r},false);
//# sourceMappingURL=ContextPathHelper.js.map