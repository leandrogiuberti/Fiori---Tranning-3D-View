{"version":3,"file":"Placeholder.js","names":["PlaceholderControllerExtension","_dec","defineUI5Class","_dec2","publicExtension","_dec3","_dec4","_dec5","_dec6","_dec7","_dec8","_dec9","_dec10","_class","_class2","_ControllerExtension","call","this","_inheritsLoose","_proto","prototype","attachHideCallback","isPlaceholderEnabled","oView","base","getView","oPage","getParent","oContainer","oNavContainer","_fnContainerDelegate","onAfterShow","oEvent","isBackToPage","URLSearchParams","window","location","hash","replace","get","hidePlaceholder","addEventDelegate","oPageReady","getController","pageReady","aAttachEvents","getControllerName","push","forEach","sEvent","attachEvent","attachRouteMatchers","_init","hideRootPlaceholder","oRootContainer","oAppComponent","getRootContainer","getAppComponent","Placeholder","registerProvider","oConfig","name","html","autoClose","isPlaceholderDebugEnabled","initPlaceholderDebug","resetPlaceholderDebugStats","handler","apply","target","_placeholder","placeholder","debugStats","iHidePlaceholderTimestamp","Date","now","bind","proxy1","Proxy","search","iPageReadyEventTimestamp","iHeroesBatchReceivedEventTimestamp","getPlaceholderDebugStats","bPlaceholderEnabledInFLP","ObjectPath","isEnabled","disableAnimation","getRootControl","addStyleClass","enableAnimation","removeStyleClass","ControllerExtension","_applyDecoratedDescriptor","Object","getOwnPropertyDescriptor"],"sources":["./Placeholder.ts"],"sourcesContent":["import ObjectPath from \"sap/base/util/ObjectPath\";\nimport type FlexibleColumnLayout from \"sap/f/FlexibleColumnLayout\";\nimport { defineUI5Class, publicExtension } from \"sap/fe/base/ClassSupport\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type PageController from \"sap/fe/core/PageController\";\nimport \"sap/fe/placeholder/library\";\nimport type NavContainer from \"sap/m/NavContainer\";\nimport type ComponentContainer from \"sap/ui/core/ComponentContainer\";\nimport type Control from \"sap/ui/core/Control\";\nimport Placeholder from \"sap/ui/core/Placeholder\";\nimport ControllerExtension from \"sap/ui/core/mvc/ControllerExtension\";\n\ntype PlaceholderDebugStats = {\n\tiHidePlaceholderTimestamp: number;\n\tiPageReadyEventTimestamp: number;\n\tiHeroesBatchReceivedEventTimestamp: number;\n};\ntype PlaceholderRootContainer = (NavContainer | FlexibleColumnLayout) & {\n\t_placeholder: {\n\t\tplaceholder: unknown;\n\t};\n\thidePlaceholder: Function;\n};\n/**\n * {@link sap.ui.core.mvc.ControllerExtension Controller extension} for Placeholder\n *\n */\n@defineUI5Class(\"sap.fe.core.controllerextensions.Placeholder\")\nclass PlaceholderControllerExtension extends ControllerExtension {\n\tprivate base!: PageController;\n\n\tprivate oAppComponent!: AppComponent;\n\n\tprivate oRootContainer!: PlaceholderRootContainer;\n\n\tprivate debugStats!: PlaceholderDebugStats;\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t@publicExtension()\n\tpublic attachHideCallback(): void {\n\t\tif (this.isPlaceholderEnabled()) {\n\t\t\tconst oView = this.base.getView();\n\t\t\tconst oPage = oView.getParent() && (oView.getParent() as Control & { oContainer: ComponentContainer }).oContainer;\n\t\t\tconst oNavContainer = (oPage && oPage.getParent()) as PlaceholderRootContainer;\n\n\t\t\tif (!oNavContainer || !oPage) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst _fnContainerDelegate = {\n\t\t\t\tonAfterShow: function (oEvent: { isBackToPage?: boolean }): void {\n\t\t\t\t\tif (\n\t\t\t\t\t\toEvent.isBackToPage ||\n\t\t\t\t\t\tnew URLSearchParams(window.location.hash.replace(/#.*\\?/, \"\")).get(\"restoreHistory\") === \"true\"\n\t\t\t\t\t) {\n\t\t\t\t\t\t// in case we navigate to the listreport using the shell\n\t\t\t\t\t\toNavContainer.hidePlaceholder();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\toPage.addEventDelegate(_fnContainerDelegate);\n\n\t\t\tconst oPageReady = oView.getController().pageReady;\n\t\t\t//In case of objectPage, the placeholder should be hidden when heroes requests are received\n\t\t\t// But for some scenario like \"Create item\", heroes requests are not sent .\n\t\t\t// The pageReady event is then used as fallback\n\n\t\t\tconst aAttachEvents = [\"pageReady\"];\n\t\t\tif (oView.getControllerName() === \"sap.fe.templates.ObjectPage.ObjectPageController\") {\n\t\t\t\taAttachEvents.push(\"heroesBatchReceived\");\n\t\t\t}\n\t\t\taAttachEvents.forEach((sEvent: string) => {\n\t\t\t\toPageReady.attachEvent(\n\t\t\t\t\tsEvent,\n\t\t\t\t\tnull,\n\t\t\t\t\tfunction () {\n\t\t\t\t\t\toNavContainer.hidePlaceholder();\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\t@publicExtension()\n\tattachRouteMatchers(): void {\n\t\tthis._init();\n\t}\n\n\thideRootPlaceholder(): void {\n\t\tthis.oRootContainer = this.oAppComponent.getRootContainer() as PlaceholderRootContainer;\n\t\tthis.oRootContainer.hidePlaceholder();\n\t}\n\n\t_init(): void {\n\t\tthis.oAppComponent = this.base.getAppComponent();\n\t\tthis.oRootContainer = this.oAppComponent.getRootContainer() as PlaceholderRootContainer;\n\n\t\t// eslint-disable-next-line no-constant-condition\n\t\tif (this.isPlaceholderEnabled()) {\n\t\t\tPlaceholder.registerProvider(function (oConfig: { name: string }) {\n\t\t\t\tswitch (oConfig.name) {\n\t\t\t\t\tcase \"sap.fe.templates.ListReport\":\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\thtml: \"sap/fe/placeholder/view/PlaceholderLR.fragment.html\",\n\t\t\t\t\t\t\tautoClose: false\n\t\t\t\t\t\t};\n\t\t\t\t\tcase \"sap.fe.templates.ObjectPage\":\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\thtml: \"sap/fe/placeholder/view/PlaceholderOP.fragment.html\",\n\t\t\t\t\t\t\tautoClose: false\n\t\t\t\t\t\t};\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (this.isPlaceholderDebugEnabled()) {\n\t\t\tthis.initPlaceholderDebug();\n\t\t}\n\t}\n\n\t@publicExtension()\n\tinitPlaceholderDebug(): void {\n\t\tthis.resetPlaceholderDebugStats();\n\t\tconst handler = {\n\t\t\tapply: (target: Function): unknown => {\n\t\t\t\tif (this.oRootContainer._placeholder && this.oRootContainer._placeholder.placeholder) {\n\t\t\t\t\tthis.debugStats.iHidePlaceholderTimestamp = Date.now();\n\t\t\t\t}\n\t\t\t\treturn target.bind(this.oRootContainer)();\n\t\t\t}\n\t\t};\n\t\t// eslint-disable-next-line no-undef\n\t\tconst proxy1 = new Proxy(this.oRootContainer.hidePlaceholder, handler);\n\t\tthis.oRootContainer.hidePlaceholder = proxy1;\n\t}\n\n\t@publicExtension()\n\tisPlaceholderDebugEnabled(): boolean {\n\t\tif (new URLSearchParams(window.location.search).get(\"sap-ui-xx-placeholder-debug\") === \"true\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t@publicExtension()\n\tresetPlaceholderDebugStats(): void {\n\t\tthis.debugStats = {\n\t\t\tiHidePlaceholderTimestamp: 0,\n\t\t\tiPageReadyEventTimestamp: 0,\n\t\t\tiHeroesBatchReceivedEventTimestamp: 0\n\t\t};\n\t}\n\n\t@publicExtension()\n\tgetPlaceholderDebugStats(): PlaceholderDebugStats {\n\t\treturn this.debugStats;\n\t}\n\n\t@publicExtension()\n\tisPlaceholderEnabled(): boolean {\n\t\tconst bPlaceholderEnabledInFLP = ObjectPath.get(\"sap-ushell-config.apps.placeholder.enabled\");\n\t\tif (bPlaceholderEnabledInFLP === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn Placeholder.isEnabled();\n\t}\n\n\t@publicExtension()\n\tdisableAnimation(): void {\n\t\tthis.base.getAppComponent().getRootControl().addStyleClass(\"sapFeNoAnimation\");\n\t}\n\n\t@publicExtension()\n\tenableAnimation(): void {\n\t\tthis.base.getAppComponent().getRootControl().removeStyleClass(\"sapFeNoAnimation\");\n\t}\n}\n\nexport default PlaceholderControllerExtension;\n"],"mappings":";;;;m4BAuBA,IAKMA,GAA8BC,EADnCC,EAAe,gDAA+CC,EAc7DC,IAAiBC,EA6CjBD,IAAiBE,EAqCjBF,IAAiBG,EAgBjBH,IAAiBI,EAQjBJ,IAAiBK,EASjBL,IAAiBM,EAKjBN,IAAiBO,EAUjBP,IAAiBQ,EAKjBR,IAAiBH,EAAAY,GAAAC,EAAA,SAAAC,GA3IlB,SAAAf,IAAc,OACbe,EAAAC,KAAAC,OAAOA,IACR,CAACC,EAAAlB,EAAAe,GAAA,IAAAI,EAAAnB,EAAAoB,UAAAD,EAGME,mBADP,SACOA,IACN,GAAIJ,KAAKK,uBAAwB,CAChC,MAAMC,EAAQN,KAAKO,KAAKC,UACxB,MAAMC,EAAQH,EAAMI,aAAgBJ,EAAMI,YAA6DC,WACvG,MAAMC,EAAiBH,GAASA,EAAMC,YAEtC,IAAKE,IAAkBH,EAAO,CAC7B,MACD,CACA,MAAMI,EAAuB,CAC5BC,YAAa,SAAUC,GACtB,GACCA,EAAOC,cACP,IAAIC,gBAAgBC,OAAOC,SAASC,KAAKC,QAAQ,QAAS,KAAKC,IAAI,oBAAsB,OACxF,CAEDV,EAAcW,iBACf,CACD,GAEDd,EAAMe,iBAAiBX,GAEvB,MAAMY,EAAanB,EAAMoB,gBAAgBC,UAKzC,MAAMC,EAAgB,CAAC,aACvB,GAAItB,EAAMuB,sBAAwB,mDAAoD,CACrFD,EAAcE,KAAK,sBACpB,CACAF,EAAcG,QAASC,IACtBP,EAAWQ,YACVD,EACA,KACA,WACCpB,EAAcW,iBACf,EACAvB,OAGH,CACD,EAACE,EAGDgC,oBADA,SACAA,IACClC,KAAKmC,OACN,EAACjC,EAEDkC,oBAAA,SAAAA,IACCpC,KAAKqC,eAAiBrC,KAAKsC,cAAcC,mBACzCvC,KAAKqC,eAAed,iBACrB,EAACrB,EAEDiC,MAAA,SAAAA,IACCnC,KAAKsC,cAAgBtC,KAAKO,KAAKiC,kBAC/BxC,KAAKqC,eAAiBrC,KAAKsC,cAAcC,mBAGzC,GAAIvC,KAAKK,uBAAwB,CAChCoC,EAAYC,iBAAiB,SAAUC,GACtC,OAAQA,EAAQC,MACf,IAAK,8BACJ,MAAO,CACNC,KAAM,sDACNC,UAAW,OAEb,IAAK,8BACJ,MAAO,CACND,KAAM,sDACNC,UAAW,OAEb,SAEF,EACD,CACA,GAAI9C,KAAK+C,4BAA6B,CACrC/C,KAAKgD,sBACN,CACD,EAAC9C,EAGD8C,qBADA,SACAA,IACChD,KAAKiD,6BACL,MAAMC,EAAU,CACfC,MAAQC,IACP,GAAIpD,KAAKqC,eAAegB,cAAgBrD,KAAKqC,eAAegB,aAAaC,YAAa,CACrFtD,KAAKuD,WAAWC,0BAA4BC,KAAKC,KAClD,CACA,OAAON,EAAOO,KAAK3D,KAAKqC,eAAjBe,KAIT,MAAMQ,EAAS,IAAIC,MAAM7D,KAAKqC,eAAed,gBAAiB2B,GAC9DlD,KAAKqC,eAAed,gBAAkBqC,CACvC,EAAC1D,EAGD6C,0BADA,SACAA,IACC,GAAI,IAAI9B,gBAAgBC,OAAOC,SAAS2C,QAAQxC,IAAI,iCAAmC,OAAQ,CAC9F,OAAO,IACR,CACA,OAAO,KACR,EAACpB,EAGD+C,2BADA,SACAA,IACCjD,KAAKuD,WAAa,CACjBC,0BAA2B,EAC3BO,yBAA0B,EAC1BC,mCAAoC,EAEtC,EAAC9D,EAGD+D,yBADA,SACAA,IACC,OAAOjE,KAAKuD,UACb,EAACrD,EAGDG,qBADA,SACAA,IACC,MAAM6D,EAA2BC,EAAW7C,IAAI,8CAChD,GAAI4C,IAA6B,MAAO,CACvC,OAAO,KACR,CAEA,OAAOzB,EAAY2B,WACpB,EAAClE,EAGDmE,iBADA,SACAA,IACCrE,KAAKO,KAAKiC,kBAAkB8B,iBAAiBC,cAAc,mBAC5D,EAACrE,EAGDsE,gBADA,SACAA,IACCxE,KAAKO,KAAKiC,kBAAkB8B,iBAAiBG,iBAAiB,mBAC/D,EAAC,OAAA1F,CAAA,CAHiB,CApJ0B2F,GAAmBC,EAAA9E,EAAAM,UAAA,sBAAAjB,GAAA0F,OAAAC,yBAAAhF,EAAAM,UAAA,sBAAAN,EAAAM,WAAAwE,EAAA9E,EAAAM,UAAA,uBAAAf,GAAAwF,OAAAC,yBAAAhF,EAAAM,UAAA,uBAAAN,EAAAM,WAAAwE,EAAA9E,EAAAM,UAAA,wBAAAd,GAAAuF,OAAAC,yBAAAhF,EAAAM,UAAA,wBAAAN,EAAAM,WAAAwE,EAAA9E,EAAAM,UAAA,6BAAAb,GAAAsF,OAAAC,yBAAAhF,EAAAM,UAAA,6BAAAN,EAAAM,WAAAwE,EAAA9E,EAAAM,UAAA,8BAAAZ,GAAAqF,OAAAC,yBAAAhF,EAAAM,UAAA,8BAAAN,EAAAM,WAAAwE,EAAA9E,EAAAM,UAAA,4BAAAX,GAAAoF,OAAAC,yBAAAhF,EAAAM,UAAA,4BAAAN,EAAAM,WAAAwE,EAAA9E,EAAAM,UAAA,wBAAAV,GAAAmF,OAAAC,yBAAAhF,EAAAM,UAAA,wBAAAN,EAAAM,WAAAwE,EAAA9E,EAAAM,UAAA,oBAAAT,GAAAkF,OAAAC,yBAAAhF,EAAAM,UAAA,oBAAAN,EAAAM,WAAAwE,EAAA9E,EAAAM,UAAA,mBAAAR,GAAAiF,OAAAC,yBAAAhF,EAAAM,UAAA,mBAAAN,EAAAM,WAAAN,KAAAD,GAAA,OA0JjDb,CAA8B","ignoreList":[]}