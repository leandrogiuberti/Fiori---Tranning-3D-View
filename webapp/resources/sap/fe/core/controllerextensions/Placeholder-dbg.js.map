{"version":3,"names":["PlaceholderControllerExtension","_dec","defineUI5Class","_dec2","publicExtension","_dec3","_dec4","_dec5","_dec6","_dec7","_dec8","_dec9","_dec10","_class","_class2","_ControllerExtension","call","_inheritsLoose","_proto","prototype","attachHideCallback","isPlaceholderEnabled","oView","base","getView","oPage","getParent","oContainer","oNavContainer","_fnContainerDelegate","onAfterShow","oEvent","isBackToPage","URLSearchParams","window","location","hash","replace","get","hidePlaceholder","addEventDelegate","oPageReady","getController","pageReady","aAttachEvents","getControllerName","push","forEach","sEvent","attachEvent","attachRouteMatchers","_init","hideRootPlaceholder","oRootContainer","oAppComponent","getRootContainer","getAppComponent","Placeholder","registerProvider","oConfig","name","html","autoClose","isPlaceholderDebugEnabled","initPlaceholderDebug","resetPlaceholderDebugStats","handler","apply","target","_placeholder","placeholder","debugStats","iHidePlaceholderTimestamp","Date","now","bind","proxy1","Proxy","search","iPageReadyEventTimestamp","iHeroesBatchReceivedEventTimestamp","getPlaceholderDebugStats","bPlaceholderEnabledInFLP","ObjectPath","isEnabled","disableAnimation","getRootControl","addStyleClass","enableAnimation","removeStyleClass","ControllerExtension","_applyDecoratedDescriptor","Object","getOwnPropertyDescriptor"],"sourceRoot":".","sources":["Placeholder.ts"],"sourcesContent":["import ObjectPath from \"sap/base/util/ObjectPath\";\nimport type FlexibleColumnLayout from \"sap/f/FlexibleColumnLayout\";\nimport { defineUI5Class, publicExtension } from \"sap/fe/base/ClassSupport\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type PageController from \"sap/fe/core/PageController\";\nimport \"sap/fe/placeholder/library\";\nimport type NavContainer from \"sap/m/NavContainer\";\nimport type ComponentContainer from \"sap/ui/core/ComponentContainer\";\nimport type Control from \"sap/ui/core/Control\";\nimport Placeholder from \"sap/ui/core/Placeholder\";\nimport ControllerExtension from \"sap/ui/core/mvc/ControllerExtension\";\n\ntype PlaceholderDebugStats = {\n\tiHidePlaceholderTimestamp: number;\n\tiPageReadyEventTimestamp: number;\n\tiHeroesBatchReceivedEventTimestamp: number;\n};\ntype PlaceholderRootContainer = (NavContainer | FlexibleColumnLayout) & {\n\t_placeholder: {\n\t\tplaceholder: unknown;\n\t};\n\thidePlaceholder: Function;\n};\n/**\n * {@link sap.ui.core.mvc.ControllerExtension Controller extension} for Placeholder\n *\n */\n@defineUI5Class(\"sap.fe.core.controllerextensions.Placeholder\")\nclass PlaceholderControllerExtension extends ControllerExtension {\n\tprivate base!: PageController;\n\n\tprivate oAppComponent!: AppComponent;\n\n\tprivate oRootContainer!: PlaceholderRootContainer;\n\n\tprivate debugStats!: PlaceholderDebugStats;\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\t@publicExtension()\n\tpublic attachHideCallback(): void {\n\t\tif (this.isPlaceholderEnabled()) {\n\t\t\tconst oView = this.base.getView();\n\t\t\tconst oPage = oView.getParent() && (oView.getParent() as Control & { oContainer: ComponentContainer }).oContainer;\n\t\t\tconst oNavContainer = (oPage && oPage.getParent()) as PlaceholderRootContainer;\n\n\t\t\tif (!oNavContainer || !oPage) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst _fnContainerDelegate = {\n\t\t\t\tonAfterShow: function (oEvent: { isBackToPage?: boolean }): void {\n\t\t\t\t\tif (\n\t\t\t\t\t\toEvent.isBackToPage ||\n\t\t\t\t\t\tnew URLSearchParams(window.location.hash.replace(/#.*\\?/, \"\")).get(\"restoreHistory\") === \"true\"\n\t\t\t\t\t) {\n\t\t\t\t\t\t// in case we navigate to the listreport using the shell\n\t\t\t\t\t\toNavContainer.hidePlaceholder();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\toPage.addEventDelegate(_fnContainerDelegate);\n\n\t\t\tconst oPageReady = oView.getController().pageReady;\n\t\t\t//In case of objectPage, the placeholder should be hidden when heroes requests are received\n\t\t\t// But for some scenario like \"Create item\", heroes requests are not sent .\n\t\t\t// The pageReady event is then used as fallback\n\n\t\t\tconst aAttachEvents = [\"pageReady\"];\n\t\t\tif (oView.getControllerName() === \"sap.fe.templates.ObjectPage.ObjectPageController\") {\n\t\t\t\taAttachEvents.push(\"heroesBatchReceived\");\n\t\t\t}\n\t\t\taAttachEvents.forEach((sEvent: string) => {\n\t\t\t\toPageReady.attachEvent(\n\t\t\t\t\tsEvent,\n\t\t\t\t\tnull,\n\t\t\t\t\tfunction () {\n\t\t\t\t\t\toNavContainer.hidePlaceholder();\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t}\n\n\t@publicExtension()\n\tattachRouteMatchers(): void {\n\t\tthis._init();\n\t}\n\n\thideRootPlaceholder(): void {\n\t\tthis.oRootContainer = this.oAppComponent.getRootContainer() as PlaceholderRootContainer;\n\t\tthis.oRootContainer.hidePlaceholder();\n\t}\n\n\t_init(): void {\n\t\tthis.oAppComponent = this.base.getAppComponent();\n\t\tthis.oRootContainer = this.oAppComponent.getRootContainer() as PlaceholderRootContainer;\n\n\t\t// eslint-disable-next-line no-constant-condition\n\t\tif (this.isPlaceholderEnabled()) {\n\t\t\tPlaceholder.registerProvider(function (oConfig: { name: string }) {\n\t\t\t\tswitch (oConfig.name) {\n\t\t\t\t\tcase \"sap.fe.templates.ListReport\":\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\thtml: \"sap/fe/placeholder/view/PlaceholderLR.fragment.html\",\n\t\t\t\t\t\t\tautoClose: false\n\t\t\t\t\t\t};\n\t\t\t\t\tcase \"sap.fe.templates.ObjectPage\":\n\t\t\t\t\t\treturn {\n\t\t\t\t\t\t\thtml: \"sap/fe/placeholder/view/PlaceholderOP.fragment.html\",\n\t\t\t\t\t\t\tautoClose: false\n\t\t\t\t\t\t};\n\t\t\t\t\tdefault:\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\tif (this.isPlaceholderDebugEnabled()) {\n\t\t\tthis.initPlaceholderDebug();\n\t\t}\n\t}\n\n\t@publicExtension()\n\tinitPlaceholderDebug(): void {\n\t\tthis.resetPlaceholderDebugStats();\n\t\tconst handler = {\n\t\t\tapply: (target: Function): unknown => {\n\t\t\t\tif (this.oRootContainer._placeholder && this.oRootContainer._placeholder.placeholder) {\n\t\t\t\t\tthis.debugStats.iHidePlaceholderTimestamp = Date.now();\n\t\t\t\t}\n\t\t\t\treturn target.bind(this.oRootContainer)();\n\t\t\t}\n\t\t};\n\t\t// eslint-disable-next-line no-undef\n\t\tconst proxy1 = new Proxy(this.oRootContainer.hidePlaceholder, handler);\n\t\tthis.oRootContainer.hidePlaceholder = proxy1;\n\t}\n\n\t@publicExtension()\n\tisPlaceholderDebugEnabled(): boolean {\n\t\tif (new URLSearchParams(window.location.search).get(\"sap-ui-xx-placeholder-debug\") === \"true\") {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\t@publicExtension()\n\tresetPlaceholderDebugStats(): void {\n\t\tthis.debugStats = {\n\t\t\tiHidePlaceholderTimestamp: 0,\n\t\t\tiPageReadyEventTimestamp: 0,\n\t\t\tiHeroesBatchReceivedEventTimestamp: 0\n\t\t};\n\t}\n\n\t@publicExtension()\n\tgetPlaceholderDebugStats(): PlaceholderDebugStats {\n\t\treturn this.debugStats;\n\t}\n\n\t@publicExtension()\n\tisPlaceholderEnabled(): boolean {\n\t\tconst bPlaceholderEnabledInFLP = ObjectPath.get(\"sap-ushell-config.apps.placeholder.enabled\");\n\t\tif (bPlaceholderEnabledInFLP === false) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn Placeholder.isEnabled();\n\t}\n\n\t@publicExtension()\n\tdisableAnimation(): void {\n\t\tthis.base.getAppComponent().getRootControl().addStyleClass(\"sapFeNoAnimation\");\n\t}\n\n\t@publicExtension()\n\tenableAnimation(): void {\n\t\tthis.base.getAppComponent().getRootControl().removeStyleClass(\"sapFeNoAnimation\");\n\t}\n}\n\nexport default PlaceholderControllerExtension;\n"],"mappings":"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","ignoreList":[],"file":"Placeholder-dbg.js"}