{"version":3,"file":"NavContainer.controller.js","names":["NavContainerController","_dec","defineUI5Class","_dec2","usingExtension","ViewState","override","applyInitialStateOnly","adaptBindingRefreshControls","aControls","oView","this","getView","oController","getController","push","_getCurrentPage","adaptStateControls","aStateControls","onRestore","oNavContainer","getAppContentContainer","oInternalModel","getModel","oPages","getProperty","sComponentId","setProperty","onContainerReady","onSuspend","oNavController","aPages","getPages","forEach","oPage","oTargetView","CommonUtils","getTargetView","viewState","_class","_class2","_BaseController","_this","_len","arguments","length","args","Array","_key","call","_initializerDefineProperty","_descriptor","_inheritsLoose","_proto","prototype","async","oPagePromise","then","oCurrentPage","KeepAliveHelper","restoreView","Promise","resolve","getCurrentPage","isPlaceholder","attachEventOnce","oEvent","oTargetPage","getParameter","undefined","_getNavContainer","getInstancedViews","navContainer","pages","getViewsFromPages","getVisibleViews","isFclEnabled","_scrollTablesToLastNavigatedItems","displayErrorPage","errorMessage","parameters","_FCLLevel","reject","messagePage","Page","showHeader","addPage","illustratedMessage","IllustratedMessage","title","description","illustrationType","errorType","removeAllContent","addContent","fromPage","handleShellBack","oAppComponent","getAppComponent","getShellServices","setBackNavigation","to","getId","fromView","getViewFromContainer","isA","pageReady","forcePageReady","e","Log","info","BaseController","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./NavContainer.controller.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport { defineUI5Class, usingExtension } from \"sap/fe/base/ClassSupport\";\nimport type { FEView } from \"sap/fe/core/BaseController\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type PageController from \"sap/fe/core/PageController\";\nimport type { NavigationToErrorPageResult } from \"sap/fe/core/controllerextensions/MessageHandler\";\nimport ViewState from \"sap/fe/core/controllerextensions/ViewState\";\nimport KeepAliveHelper from \"sap/fe/core/helpers/KeepAliveHelper\";\nimport IllustratedMessage from \"sap/m/IllustratedMessage\";\nimport type NavContainer from \"sap/m/NavContainer\";\nimport Page from \"sap/m/Page\";\nimport type UI5Event from \"sap/ui/base/Event\";\nimport type Control from \"sap/ui/core/Control\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\nimport BaseController from \"./RootViewBaseController\";\n\n/**\n * Base controller class for your own root view with a sap.m.NavContainer control.\n *\n * By using or extending this controller you can use your own root view with the sap.fe.core.AppComponent and\n * you can make use of SAP Fiori elements pages and SAP Fiori elements building blocks.\n * @hideconstructor\n * @public\n * @since 1.108.0\n */\n@defineUI5Class(\"sap.fe.core.rootView.NavContainer\")\nclass NavContainerController extends BaseController {\n\t@usingExtension(\n\t\tViewState.override({\n\t\t\tapplyInitialStateOnly: function () {\n\t\t\t\treturn false;\n\t\t\t},\n\t\t\tadaptBindingRefreshControls: function (this: ViewState, aControls: Promise<FEView | undefined>[]): void {\n\t\t\t\tconst oView = this.getView(),\n\t\t\t\t\toController = oView.getController() as NavContainerController;\n\t\t\t\taControls.push(oController._getCurrentPage(oView));\n\t\t\t},\n\t\t\tadaptStateControls: function (this: ViewState, aStateControls: Promise<FEView | undefined>[]) {\n\t\t\t\tconst oView = this.getView(),\n\t\t\t\t\toController = oView.getController() as NavContainerController;\n\t\t\t\taStateControls.push(oController._getCurrentPage(oView));\n\t\t\t},\n\t\t\tonRestore: function (this: ViewState) {\n\t\t\t\tconst oView = this.getView(),\n\t\t\t\t\toController = oView.getController() as NavContainerController,\n\t\t\t\t\toNavContainer = oController.getAppContentContainer();\n\t\t\t\tconst oInternalModel = oNavContainer.getModel(\"internal\") as JSONModel;\n\t\t\t\tconst oPages = oInternalModel.getProperty(\"/pages\");\n\n\t\t\t\tfor (const sComponentId in oPages) {\n\t\t\t\t\toInternalModel.setProperty(`/pages/${sComponentId}/restoreStatus`, \"pending\");\n\t\t\t\t}\n\t\t\t\toController.onContainerReady();\n\t\t\t},\n\t\t\tonSuspend: function (this: ViewState) {\n\t\t\t\tconst oView = this.getView(),\n\t\t\t\t\toNavController = oView.getController() as NavContainerController,\n\t\t\t\t\toNavContainer = oNavController.getAppContentContainer() as NavContainer;\n\t\t\t\tconst aPages = oNavContainer.getPages();\n\t\t\t\taPages.forEach(function (oPage: Control) {\n\t\t\t\t\tconst oTargetView = CommonUtils.getTargetView(oPage);\n\n\t\t\t\t\tconst oController = oTargetView && oTargetView.getController();\n\t\t\t\t\tif (oController && oController.viewState && oController.viewState.onSuspend) {\n\t\t\t\t\t\toController.viewState.onSuspend();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t})\n\t)\n\tviewState!: ViewState;\n\n\tmessagePage?: Page;\n\n\tasync onContainerReady(): Promise<void> {\n\t\t// Restore views if neccessary.\n\t\tconst oView = this.getView(),\n\t\t\toPagePromise = this._getCurrentPage(oView);\n\n\t\treturn oPagePromise.then(async function (oCurrentPage) {\n\t\t\tif (oCurrentPage) {\n\t\t\t\tconst oTargetView = CommonUtils.getTargetView(oCurrentPage);\n\t\t\t\treturn KeepAliveHelper.restoreView(oTargetView);\n\t\t\t}\n\t\t\treturn;\n\t\t});\n\t}\n\n\tasync _getCurrentPage(this: NavContainerController, oView: View): Promise<FEView | undefined> {\n\t\tconst oNavContainer = this.getAppContentContainer() as NavContainer;\n\t\treturn new Promise(function (resolve: (value: FEView | undefined) => void) {\n\t\t\tconst oCurrentPage = oNavContainer.getCurrentPage() as FEView;\n\t\t\tif ((oCurrentPage?.getController?.() as { isPlaceholder?: Function })?.isPlaceholder?.()) {\n\t\t\t\toCurrentPage\n\t\t\t\t\t.getController()\n\t\t\t\t\t.attachEventOnce(\"targetPageInsertedInContainer\", function (oEvent: UI5Event<{ targetpage: Page }>) {\n\t\t\t\t\t\tconst oTargetPage = oEvent.getParameter(\"targetpage\");\n\t\t\t\t\t\tconst oTargetView = CommonUtils.getTargetView(oTargetPage);\n\t\t\t\t\t\tresolve(oTargetView !== oView ? oTargetView : undefined);\n\t\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tconst oTargetView = CommonUtils.getTargetView(oCurrentPage);\n\t\t\t\tresolve(oTargetView !== oView ? oTargetView : undefined);\n\t\t\t}\n\t\t});\n\t}\n\n\t_getNavContainer(): NavContainer {\n\t\treturn this.getAppContentContainer() as NavContainer;\n\t}\n\n\t/**\n\t * Gets the instanced views in the navContainer component.\n\t * @returns Return the views.\n\t */\n\tgetInstancedViews(): View[] {\n\t\tconst navContainer = this._getNavContainer();\n\t\tconst pages = navContainer.getPages();\n\t\treturn this.getViewsFromPages(pages);\n\t}\n\n\t/**\n\t * Gets the current visible page.\n\t * @returns Return the view.\n\t */\n\tgetVisibleViews(): View[] {\n\t\tconst navContainer = this._getNavContainer();\n\t\tconst pages = [navContainer.getCurrentPage()];\n\t\treturn this.getViewsFromPages(pages);\n\t}\n\n\t/**\n\t * Check if the FCL component is enabled.\n\t * @returns `false` since we are not in FCL scenario\n\t * @final\n\t */\n\tisFclEnabled(): boolean {\n\t\treturn false;\n\t}\n\n\t_scrollTablesToLastNavigatedItems(): void {\n\t\t// Do nothing\n\t}\n\n\t/**\n\t * Method that creates a new Page to display the IllustratedMessage containing the current error.\n\t * @param errorMessage\n\t * @param parameters\n\t * @param _FCLLevel\n\t * @returns A promise that creates a Page to display the error\n\t */\n\tasync displayErrorPage(errorMessage: string, parameters: NavigationToErrorPageResult, _FCLLevel = 0): Promise<boolean> {\n\t\treturn new Promise<boolean>(async (resolve, reject) => {\n\t\t\ttry {\n\t\t\t\tconst oNavContainer = this._getNavContainer();\n\n\t\t\t\tif (!this.messagePage) {\n\t\t\t\t\tthis.messagePage = new Page({\n\t\t\t\t\t\tshowHeader: false\n\t\t\t\t\t});\n\n\t\t\t\t\toNavContainer.addPage(this.messagePage);\n\t\t\t\t}\n\n\t\t\t\tconst illustratedMessage = new IllustratedMessage({\n\t\t\t\t\ttitle: errorMessage,\n\t\t\t\t\tdescription: parameters.description ?? \"\",\n\t\t\t\t\tillustrationType: parameters.errorType ? `sapIllus-${parameters.errorType}` : \"sapIllus-UnableToLoad\"\n\t\t\t\t});\n\t\t\t\tthis.messagePage.removeAllContent();\n\t\t\t\tthis.messagePage.addContent(illustratedMessage);\n\n\t\t\t\tconst fromPage = oNavContainer.getCurrentPage();\n\t\t\t\tif (parameters.handleShellBack === true) {\n\t\t\t\t\tconst oAppComponent = CommonUtils.getAppComponent(fromPage);\n\t\t\t\t\tawait oAppComponent.getShellServices().setBackNavigation(async function () {\n\t\t\t\t\t\toNavContainer.to(fromPage.getId());\n\t\t\t\t\t\tawait oAppComponent.getShellServices().setBackNavigation();\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\tconst fromView = this.getViewFromContainer(fromPage);\n\t\t\t\toNavContainer.attachEventOnce(\"afterNavigate\", () => {\n\t\t\t\t\tif (fromView && fromView.isA<View>(\"sap.ui.core.mvc.View\")) {\n\t\t\t\t\t\t(fromView.getController() as PageController).pageReady?.forcePageReady();\n\t\t\t\t\t}\n\t\t\t\t\tresolve(true);\n\t\t\t\t});\n\t\t\t\toNavContainer.to(this.messagePage.getId());\n\t\t\t} catch (e) {\n\t\t\t\treject(false);\n\t\t\t\tLog.info(e as string);\n\t\t\t}\n\t\t});\n\t}\n}\n\nexport default NavContainerController;\n"],"mappings":"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","ignoreList":[]}