/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/helpers/TypeGuards"],function(t,e){"use strict";var n={};var i=e.isServiceObject;var r=e.isPropertyPathExpression;var a=e.isProperty;var o=e.isPathAnnotationExpression;var s=e.isNavigationProperty;var c=e.isMultipleNavigationProperty;var l=e.isEntityType;var g=e.isEntitySet;var f=e.isComplexType;var u=e.isAnnotationTerm;var p=t.unresolvableExpression;var y=t.isConstant;var d=t.getExpressionFromAnnotation;var h=t.equal;var v=t.constant;const P=function(t,e){return b(t?.contextLocation,t?.navigationProperties,e).map(t=>t.name)};n.getRelativePaths=P;const b=function(t){let e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:[];let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;const i=t=>{let e=0;while(t.length>1&&e!=t.length-1){const n=t[e];const i=t[e+1];if(s(n)&&n.partner===i.name){t.splice(e,2)}else{e++}}return t};const r=(t,e,n)=>{const i=[];t.forEach((t,r)=>{if(e[r]!==t){i.push(n?t:e[r])}});return i};if(!t){return e}if(e.length>=t.navigationProperties.length){let a=r(t.navigationProperties,e,false);a=a.concat(e.slice(t.navigationProperties.length));return n?a:i(a)}let a=r(e,t.navigationProperties,true);a=a.concat(t.navigationProperties.slice(e.length));if(!n){i(a)}a=a.map(t=>s(t)?t.targetType.navigationProperties.find(e=>e.name===t.partner):t);return a};n.getPathRelativeLocation=b;const O=function(t,e){let n="";if(o(e)){n=e.path}else if(typeof e==="string"){n=e}let i;if(o(e)){i=e.$target}else if(E(t)){i=t.convertedTypes.resolvePath(`${S(t)}/${n}`)?.target}else{if(n.startsWith("/")){n=n.substring(1)}i=t.targetEntityType.resolvePath(n)}const r=n.split("/");let a=t;for(const t of r){a=j(a,t)}a.targetObject=i;return a};n.enhanceDataModelPath=O;const j=function(t,e){let n;let i;const r=t.navigationProperties.concat();const a=r.length;const o=a?r[a-1].targetType:t.targetEntityType;if(!o){return t}else if(l(o)||f(o)){const a=t.targetEntitySet;const s=o.navigationProperties.find(t=>t.name===e);if(s){r.push(s);i=s.targetType;const t=m(r);if(t&&a?.navigationPropertyBinding.hasOwnProperty(t)){n=a.navigationPropertyBinding[t]}}else{const t=(o.entityProperties||o.properties).find(t=>t.name===e);if(t?.targetType?._type==="ComplexType"){r.push(t)}}}return{startingEntitySet:t.startingEntitySet,navigationProperties:r,contextLocation:t.contextLocation,targetEntitySet:n??t.targetEntitySet,targetEntityType:i??t.targetEntityType,targetObject:t.targetObject,convertedTypes:t.convertedTypes}};const E=function(t){return t.navigationProperties.find(t=>f(t?.targetType))!==undefined};const m=function(t){const e=t.length;if(e){const n=t[e-1];const i=f(n.targetType);let r="";if(e>1&&!i){for(let n=0;n<e-1;n++){const e=t[n];if(f(e.targetType)){r+=`${e.name}/`}else{r=""}}}return i?"":`${r}${n.name}`}return""};const T=function(t){const e=`/${t.startingEntitySet.name}`;let n=e;let i=t.startingEntitySet;const r=t.navigationProperties;let a;for(let t=0;t<r.length;t++){a=m(r.slice(0,t+1));if(i&&i.navigationPropertyBinding.hasOwnProperty(a)){n+=`/$NavigationPropertyBinding/${a.replace("/","%2F")}`;i=i.navigationPropertyBinding[a]}}n+="/$";return n};n.getTargetEntitySetPath=T;const S=function(t){let e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n="";if(!t.startingEntitySet){return"/"}if(!e){n+=`/${t.startingEntitySet.name}`}if(t.navigationProperties.length>0){n=Q(n);n+=t.navigationProperties.map(t=>t.name).join("/")}return n};n.getTargetNavigationPath=S;const $=function(t){let e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n=S(t,e);if(i(t.targetObject)&&!s(t.targetObject)&&!l(t.targetObject)&&!g(t.targetObject)&&(!a(t.targetObject)||!f(t.targetObject?.targetType))&&t.targetObject!==t.startingEntitySet){n=Q(n);n+=`${t.targetObject.name}`}else if(t.targetObject&&u(t.targetObject)){n=Q(n);n+=`@${t.targetObject.term}`;if(t.targetObject.hasOwnProperty("qualifier")&&!!t.targetObject.qualifier){n+=`#${t.targetObject.qualifier}`}}return n};n.getTargetObjectPath=$;const x=function(t){let e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(t.contextLocation?.startingEntitySet!==t.startingEntitySet){return $(t)}return N(t,e,n)};n.getContextRelativeTargetObjectPath=x;const N=function(t){let e=arguments.length>1&&arguments[1]!==undefined?arguments[1]:false;let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;if(!t.targetObject){return undefined}const o=b(t.contextLocation,t.navigationProperties);if(e){if(o.some(c)){return undefined}}let p=n?o.map(t=>{const e=c(t);return e?`${t.name}*`:t.name}).join("/"):o.map(t=>t.name).join("/");if((i(t.targetObject)&&t.targetObject.name||r(t.targetObject)&&t.targetObject.value)&&!s(t.targetObject)&&!l(t.targetObject)&&!g(t.targetObject)&&(!a(t.targetObject)||!f(t.targetObject?.targetType))&&t.targetObject!==t.startingEntitySet){p=Q(p);p+=r(t.targetObject)?`${t.targetObject.value}`:`${t.targetObject.name}`}else if(u(t.targetObject)){p=Q(p);p+=`@${t.targetObject.term}`;if(t.targetObject.hasOwnProperty("qualifier")&&!!t.targetObject.qualifier){p+=`#${t.targetObject.qualifier}`}}return p};const R=function(t,e){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:true;const i=n?t.contextLocation:t;const r=i?.navigationProperties?.slice(-1)[0];const a=e(r?.annotations?.Capabilities);return a?.length?a:e(i?.targetEntitySet?.annotations?.Capabilities)||[]};n.getContextPropertyRestriction=R;const C=function(t,e){return k(t,t=>t?.UpdateRestrictions?.Updatable,e)};n.isPathUpdatable=C;const L=function(t,e){return t.targetEntityType.annotations.Aggregation?.[`RecursiveHierarchy#${e}`]?.ParentNavigationProperty.$target?.fullyQualifiedName};n.getHierarchyParentNavigationPropertyPath=L;const F=function(t){const e=t.targetObject?.annotations?.Capabilities?.UpdateRestrictions?.NonUpdatableNavigationProperties;if(e&&e?.length>0){return e.map(e=>t.contextLocation&&O(t.contextLocation,e.value).targetObject.fullyQualifiedName)}return t.targetEntitySet?.annotations.Capabilities?.UpdateRestrictions?.NonUpdatableNavigationProperties?.map(t=>t.$target?.fullyQualifiedName)};n.getNonUpdatableNavigationProperties=F;const U=function(t,e){return k(t,t=>t?.SearchRestrictions?.Searchable,e)};n.isPathSearchable=U;const B=function(t,e){return k(t,t=>t?.DeleteRestrictions?.Deletable,e)};n.isPathDeletable=B;const q=function(t,e){return k(t,t=>t?.InsertRestrictions?.Insertable,e)};n.isPathInsertable=q;const w=function(t,e){return k(t,t=>t?.FilterRestrictions?.Filterable,e)};n.isPathFilterable=w;const A=function(t,e){return k(t,n=>{if(n&&"FilterRestrictions"in n){const i=n?.FilterRestrictions?.FilterExpressionRestrictions||[];const r=i.find(e=>e.Property.$target===t.targetObject);if(r){return e.includes(r?.AllowedExpressions?.toString())}else{return false}}else{return false}})};n.checkFilterExpressionRestrictions=A;const D=t=>{let e=false;let n=[];let i=t.startingEntitySet;let r=null;let o=i;let s="";for(const c of t.navigationProperties){if(e){n=[]}n.push(c.name);s=n.join("/");if(a(c)||!c.containsTarget){if(i&&i.navigationPropertyBinding.hasOwnProperty(s)){r=i;i=i.navigationPropertyBinding[s];o=i;e=true}else{r=i;i=null;e=true}}else{r=i;o=null}}return{parentEntitySet:r,targetEntitySet:o,parentNavigationPath:s}};n.getTargetEntitySetInfo=D;const I=(t,e,n)=>{const i=t.navigationProperties;const{parentEntitySet:r,parentNavigationPath:a}=D(t);let o,s;for(const c of r?.annotations?.Capabilities?.NavigationRestrictions?.RestrictedProperties??[]){if(a===c.NavigationProperty.value){const r=e(c)?.valueOf();if(r!==undefined){if(y(d(r))){o=v(r)}else{const e=i.slice(0,-1);s=e;if(t.contextLocation&&s.length<t.contextLocation?.navigationProperties.length&&!i[i.length-1].partner){o=undefined}else{const e=b(t.contextLocation,s).map(t=>t.name);const i=n?.pathVisitor?H(n.pathVisitor,e):undefined;o=h(d(r,e,undefined,i),true)}}}}}return o};const V=(t,e,n)=>{const i=t.targetEntityType;let r;const{targetEntitySet:a}=D(t);let o=e(a?.annotations?.Capabilities);if(a===null&&o===undefined){o=e(i?.annotations?.Capabilities)}if(o!==undefined){const e=P(t);const i=n?.pathVisitor?H(n.pathVisitor,e):undefined;r=h(d(o,e,undefined,i),true)}return r};const k=function(t,e,n){if(!t||!t.startingEntitySet){return v(true)}t=O(t,n?.propertyPath);const i=I(t,e,n);const r=n?.ignoreTargetCollection?undefined:V(t,e,n);return i||r||(n?.authorizeUnresolvable?p:v(true))};n.checkOnPath=k;const Q=function(t){if(t.length&&!t.endsWith("/")){return`${t}/`}return t};const H=function(t,e){return function(n){return t(n,e)}};return n},false);
//# sourceMappingURL=DataModelPathHelper.js.map