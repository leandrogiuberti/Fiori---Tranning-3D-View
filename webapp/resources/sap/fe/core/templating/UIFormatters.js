/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/TypeGuards","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/DisplayModeFormatter","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/PropertyHelper"],function(e,t,n,a,i,o,r,s){"use strict";var l={};var u=s.isMultiLineText;var d=s.isKey;var c=s.isImmutable;var f=s.isComputed;var p=s.hasValueHelp;var g=s.hasStaticPercentUnit;var m=s.getAssociatedUnitProperty;var y=s.getAssociatedCurrencyProperty;var b=r.isRequiredExpression;var v=r.isReadOnlyExpression;var h=r.isNonEditableExpression;var D=r.isDisabledExpression;var T=i.isPathUpdatable;var E=i.getTargetObjectPath;var O=i.getRelativePaths;var x=i.getContextRelativeTargetObjectPath;var M=i.enhanceDataModelPath;var I=a.isProperty;var V=a.isPathAnnotationExpression;var $=a.isMultipleNavigationProperty;var C=a.isAnnotationOfType;var P=n.singletonPathVisitor;var U=n.bindingContextPathVisitor;var F=n.UI;var j=t.getInvolvedDataModelObjects;var S=t.convertMetaModelContext;var A=e.unresolvableExpression;var k=e.pathInModel;var R=e.or;var w=e.not;var B=e.isTruthy;var N=e.isConstant;var q=e.ifElse;var L=e.getExpressionFromAnnotation;var z=e.formatWithTypeInformation;var W=e.formatResult;var H=e.equal;var G=e.constant;var K=e.compileExpression;var Q=e.and;var _=e.addTypeInformation;var Y=e.EDM_TYPE_MAPPING;const J={Disabled:"Disabled",Display:"Display",Editable:"Editable",EditableDisplay:"EditableDisplay",EditableReadOnly:"EditableReadOnly",ReadOnly:"ReadOnly"};l.FieldEditMode=J;const X=function(e){return o.getDisplayMode(e.targetObject,e)};l.getDisplayMode=X;const Z=function(e,t,n){let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:F.IsEditable;let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:true;return ee(e,t,n,true,a,i)};l.getEditableExpressionAsObject=Z;const ee=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:undefined;let n=arguments.length>2?arguments[2]:undefined;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:F.IsEditable;let o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:true;const r=O(n);if(!e||typeof e==="string"){return K(false)}let s=G(true);if(t!==undefined&&!I(t)){s=q(h(t),false,i)}else if(t!==undefined){s=i}const l=V(e)?e.$target:e;const u=T(n,{propertyPath:e,pathVisitor:(e,t)=>P(e,n.convertedTypes,t)});if(K(u)==="false"&&o){return a?u:"false"}const p=l!==undefined?q(R(Q(w(u),o),f(l),d(l),c(l),h(l,r)),q(R(f(l),h(l,r)),false,F.IsTransientBinding),i):A;if(a){return Q(p,s)}return K(Q(p,s))};l.getEditableExpression=ee;const te=function(e,t){const n=E(e);const a=k(`/collaboration/activities${n}`,"internal");const i=e?.contextLocation?.targetEntityType?.keys;const o=[];i?.forEach(function(e){const t=k(e.name);o.push(t)});return W([a,...o],t)};l.getCollaborationExpression=te;const ne=function(e,t,n){return ae(e,t,true,n)};l.getEnabledExpressionAsObject=ne;const ae=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3?arguments[3]:undefined;if(!e||typeof e==="string"){return K(true)}let i;if(a){i=O(a)}let o=G(true);if(t!==undefined&&!I(t)){o=q(D(t),false,true)}const r=V(e)?e.$target:e;const s=r!==undefined?q(D(r,i),false,true):A;if(n){return Q(s,o)}return K(Q(s,o))};l.getEnabledExpression=ae;const ie=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:undefined;let o=arguments.length>5&&arguments[5]!==undefined?arguments[5]:F.IsEditable;if(!e||typeof e==="string"||!I(i)&&i?.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath"){return J.Display}const r=V(e)?e.$target:e;if(!I(r)){return J.Display}const s=O(t);const l=T(t,{propertyPath:r,pathVisitor:(e,n)=>P(e,t.convertedTypes,n)});const u=Z(e,i,t,o,false);const d=ne(e,i,t);const p=y(r);const g=p||m(r);let b=G(J.Editable);if(g){const e=v(g,s);b=q(R(e,f(g),Q(c(g),w(F.IsTransientBinding)),n),q(!N(e)&&e,J.EditableReadOnly,J.EditableDisplay),J.Editable)}if(!g&&(r?.annotations?.Measures?.ISOCurrency||r?.annotations?.Measures?.Unit)){b=G(J.EditableDisplay)}let h;if(i!=undefined&&!I(i)){h=R(v(r,s),v(i))}else{h=v(r,s)}const D=q(R(l,F.IsTransientBinding),q(d,q(u,b,q(Q(!N(h)&&h,o),J.ReadOnly,J.Display)),q(o,J.Disabled,J.Display)),J.Display);if(a){return D}return K(D)};l.getEditMode=ie;const oe=function(e){const t=e?.targetObject;return t&&re(t)};l.hasValidAnalyticalCurrencyOrUnit=oe;const re=function(e){const t=e?.annotations?.Measures?.ISOCurrency;const n=t?t:e?.annotations?.Measures?.Unit;if(n){return K(R(B(L(n)),w(F.IsTotal)))}else{return K(G(true))}};l.getExpressionForMeasureUnit=re;const se=function(e,t,n){const a=V(e)&&e.$target||e;const i=a.annotations?.Common?.Text!==undefined;if(p(a)){return K(t)}else{return i?K(q(H(n,"Editable"),"Value",t)):"Value"}};l.getFieldDisplay=se;const le=function(e,t){const n=Y[e?.type]||(t?Y[t]:undefined);const a={type:n.type,constraints:{},formatOptions:{}};if(I(e)){a.constraints={scale:n.constraints?.$Scale?e.scale:undefined,precision:n.constraints?.$Precision?e.precision:undefined,maxLength:n.constraints?.$MaxLength?e.maxLength:undefined,nullable:n.constraints?.$Nullable?e.nullable:undefined,minimum:n.constraints?.["@Org.OData.Validation.V1.Minimum/$Decimal"]&&!isNaN(e.annotations?.Validation?.Minimum)?`${e.annotations?.Validation?.Minimum}`:undefined,maximum:n.constraints?.["@Org.OData.Validation.V1.Maximum/$Decimal"]&&!isNaN(e.annotations?.Validation?.Maximum)?`${e.annotations?.Validation?.Maximum}`:undefined,isDigitSequence:a.type==="sap.ui.model.odata.type.String"&&n.constraints?.["@com.sap.vocabularies.Common.v1.IsDigitSequence"]&&e.annotations?.Common?.IsDigitSequence?true:undefined,V4:n.constraints?.$V4?true:undefined}}a.formatOptions={parseAsString:a?.type?.indexOf("sap.ui.model.odata.type.Int")===0||a?.type?.indexOf("sap.ui.model.odata.type.Double")===0?false:undefined,emptyString:a?.type?.indexOf("sap.ui.model.odata.type.Int")===0||a?.type?.indexOf("sap.ui.model.odata.type.Double")===0?"":undefined,parseKeepsEmptyString:a.type==="sap.ui.model.odata.type.String"?true:undefined};return a};l.getTypeConfig=le;const ue=function(e){return e?.annotations?.UI?.DoNotCheckScaleOfMeasuredQuantity&&e?.annotations?.UI.DoNotCheckScaleOfMeasuredQuantity?.valueOf()?{skipDecimalsValidation:true}:{}};l.getConstraintOptions=ue;const de=function(e,t,n,a,i,o,r){const s=e.targetObject;let l=s.annotations?.Measures?.Unit;const u=O(e);t=z(s,t);const d=l?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";l=l?l:s.annotations?.Measures?.ISOCurrency;const c=V(l)&&l.$target?z(l.$target,L(l,u),n):L(l,u);let f;if(d==="sap.ui.model.odata.type.Unit"){if(i&&!o){f={skipDecimalsValidation:true}}else if(!i){f=ue(e.targetObject)}}if(d==="sap.ui.model.odata.type.Currency"){if(r){f={skipDecimalsValidation:true}}}if(i){a={...a,emptyString:""}}return _([t,c],d,undefined,a,f)};l.getBindingWithUnitOrCurrency=de;const ce=function(e,t){const n=e.targetObject;const a=O(e);const i={};t=z(n,t);const o="sap.fe.core.type.Date";const r=n?.annotations?.Validation?.Minimum?.$Date?n?.annotations?.Validation?.Minimum?.$Date:n?.annotations?.Validation?.Minimum;const s=n?.annotations?.Validation?.Maximum?.$Date?n?.annotations?.Validation?.Maximum?.$Date:n?.annotations?.Validation?.Maximum;const l=r&&V(r)?z(n?.annotations?.Validation?.Minimum,L(n?.annotations?.Validation?.Minimum,a)):r;const u=s&&V(s)?z(n?.annotations?.Validation?.Maximum,L(n?.annotations?.Validation?.Maximum,a)):s;return(l||u)&&_([t,l,u],o,undefined,i)};l.getBindingForDatePicker=ce;const fe=function(e,t,n,a){const i=e?.targetObject;if(!i){return""}let o=i.annotations?.Measures?.Unit;if(g(i)){return G("%")}const r=O(e);const s=o?"sap.ui.model.odata.type.Unit":"sap.ui.model.odata.type.Currency";o=o?o:i.annotations?.Measures?.ISOCurrency;const l=V(o)&&o.$target?z(o.$target,L(o,r)):L(o,r);let u=k(x(e));u=z(i,u,true);let d;if(s==="sap.ui.model.odata.type.Unit"){if(t&&!n){d={skipDecimalsValidation:true}}else if(!t){d=ue(i)}}else if(s==="sap.ui.model.odata.type.Currency"){if(a){d={skipDecimalsValidation:true}}}return _([u,l],s,undefined,{parseKeepsEmptyString:true,showNumber:false},d)};l.getBindingForUnitOrCurrency=fe;const pe=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let i=arguments.length>4?arguments[4]:undefined;const o=e.targetObject;const r=o.annotations?.Common?.Timezone;const s=o.annotations?.UI?.DateTimeStyle;const l=O(e);t=z(o,t);const u="sap.fe.core.type.DateTimeWithTimezone";const d=V(r)&&r.$target?z(r.$target,L(r,l),n):L(r,l);let c={};if(a){c={showTimezoneForEmptyValues:false}}if(s){c={...c,...{style:s}}}else if(i?.dateTimeStyle!==undefined){c={...c,...{style:i.dateTimeStyle}}}if(i?.dateTimePattern!==undefined){c={...c,...{pattern:i.dateTimePattern}}}if(i?.showTime!==undefined){c={...c,...{showTime:i.showTime}}}if(i?.showDate!==undefined){c={...c,...{showDate:i.showDate}}}if(i?.showTimezone!==undefined){c={...c,...{showTimezone:i.showTimezone}}}return _([t,d],u,undefined,c)};l.getBindingWithTimezone=pe;const ge=function(e,t,n){const a=e.targetObject;const i=n?.dateTimePattern;const o=a.annotations?.UI?.DateTimeStyle??n?.dateTimeStyle;t=z(a,t);t.type=Y[a.type].type;t.formatOptions={...o&&{style:o.toString()},...i&&{pattern:i}};return t};l.getBindingForDateFormat=ge;const me=function(e,t){const n=e.targetObject;t=z(n,t);const a="sap.ui.model.odata.type.DateTimeWithTimezone";const i={showTime:false,showDate:false,showTimezone:true,parseKeepsEmptyString:true};return _([null,t],a,undefined,i)};l.getBindingForTimezone=me;const ye=function(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Begin";let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"Begin";return K(q(H(e,"Display"),t,n))};l.getAlignmentExpression=ye;const be=function(e,t){if(t&&t.context){return S(t.context)}return null};be.requiresIContext=true;l.getConverterContext=be;const ve=function(e,t){if(t&&t.context){return j(t.context)}return null};ve.requiresIContext=true;l.getDataModelObjectPath=ve;const he=function(e){if(e.navigationProperties?.length){const t=e?.navigationProperties.findIndex(t=>{if($(t)){if(e.contextLocation?.navigationProperties?.length){return e.contextLocation?.navigationProperties.findIndex(e=>e.name===t.name)===-1}return true}return false})>-1;if(t){return true}}return false};l.isMultiValueField=he;const De=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;return Te(e,t,n,true)};l.getRequiredExpressionAsObject=De;const Te=function(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:false;let a=arguments.length>3&&arguments[3]!==undefined?arguments[3]:false;let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:{};let o=arguments.length>5?arguments[5]:undefined;const r=i.requiredPropertiesFromInsertRestrictions;const s=i.requiredPropertiesFromUpdateRestrictions;if(!e||typeof e==="string"){if(a){return G(false)}return K(G(false))}let l;if(o){l=O(o)}let u=G(false);if(t!==undefined&&!I(t)){u=b(t)}let d=G(false);let c=G(false);const f=V(e)&&e.$target||e;const p=b(f,l);const g=n||F.IsEditable;if(r?.includes(f.name)){d=F.IsCreateMode}if(s?.includes(f.name)){c=Q(F.IsEditable,w(F.IsCreateMode))}const m=R(Q(R(p,u),g),d,c);if(a){return m}return K(m)};l.getRequiredExpression=Te;const Ee=function(e){return K(Q(F.IsEditable,b(e.targetObject?.$target)))};l.getRequiredExpressionForFieldGroup=Ee;const Oe=function(e){const t=e?.targetObject;const n=e?.targetObject?.$target?.Data??t?.Target.$target?.Data??{};const a=Object.keys(n);const i=[];let o;const r=[];for(const e of a){if(n[e]?.["$Type"]&&n[e]["$Type"]?.includes("DataField")){i.push(n[e])}}for(const e of i){switch(e.$Type){case"com.sap.vocabularies.UI.v1.DataField":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":case"com.sap.vocabularies.UI.v1.DataFieldWithUrl":case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithAction":if(typeof e.Value==="object"){o=e.Value.$target}break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":if(e.Target?.$target){if(C(e.Target.$target,["com.sap.vocabularies.UI.v1.DataField","com.sap.vocabularies.UI.v1.DataPointType"])){if(typeof e.Target.$target.Value==="object"){o=e.Target.$target.Value.$target}}else{if(typeof e.Target==="object"){o=e.Target.$target}break}}break;default:break}r.push(De(o,e,false))}return K(R(...r))};l.getRequiredExpressionForConnectedDataField=Oe;function xe(e,t){return w(H(L(e?.annotations?.UI?.Hidden,t),true))}l.isVisible=xe;const Me=function(e){return u(e.targetObject)};l.isMultiLine=Me;function Ie(e,t,n,a){const i=e.annotations.Core?.OperationAvailable?.term==="Org.OData.Core.V1.OperationAvailable";if(!i){return G(true)}let o="";if(n&&a&&a===true&&n.contextLocation?.targetEntityType&&n.contextLocation.targetEntityType!==e.sourceEntityType){const t=O(n);let a=M(n.contextLocation);for(const n of t){a=M(a,n);if(a.targetEntityType===e.sourceEntityType){o=`${O(a).join("/")}/`;break}}}const r=e.isBound?e.parameters[0]?.fullyQualifiedName:undefined;const s=L(e.annotations.Core?.OperationAvailable,[],undefined,e=>`${o}${U(e,t,r)}`);return H(s,true)}l.getActionEnabledExpression=Ie;function Ve(e){let t=G(true);if(C(e.targetObject?.Target?.$target,"com.sap.vocabularies.UI.v1.FieldGroupType")){t=xe(e.targetObject?.Target?.$target)}return K(Q(xe(e.targetObject),t))}l.isQuickViewFacetVisible=Ve;const $e=function(e){return e.breadcrumbsHierarchyMode&&e.fclEnabled===true?"{fclhelper>/breadCrumbIsVisible}":!!e.breadcrumbsHierarchyMode};l.getVisibleExpressionForBreadcrumbs=$e;return l},false);
//# sourceMappingURL=UIFormatters.js.map