/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/MetaPath","sap/ui/core/Component","sap/ui/core/Lib","sap/fe/core/templating/PropertyHelper","sap/fe/core/CommonUtils","sap/ui/rta/plugin/annotations/AnnotationTypes"],function(e,t,n,r,o,a,i,l){"use strict";var s={};var p=a.isUnit;var u=a.isCurrency;var m=a.hasUnit;var g=a.hasCurrency;var c=t.convertTypes;const y=o.getResourceBundleFor("sap.fe.core.designtime");const T=function(e){return y.getText(e)};s.getText=T;const f={["UI.TextArrangementType/TextOnly"]:"Text Only",["UI.TextArrangementType/TextFirst"]:"Text First",["UI.TextArrangementType/TextLast"]:"Text Last",["UI.TextArrangementType/TextSeparate"]:"ID Only"};function d(e){return e.annotations.Common?.Text!==undefined&&!g(e)&&!m(e)&&!u(e)&&!p(e)}function C(e,t,n,r){if(r[e.fullyQualifiedName]){return}r[e.fullyQualifiedName]=true;t.push(...e.entityProperties.filter(n).filter(e=>{if(e.annotations.UI?.Hidden?.valueOf()===true||!!e.targetType){return false}return true}).map(t=>({property:t,entityType:e})))}function A(t,r,o){const a=t.getMetaModel();const i=t.getFullContextPath();let l=r;while(l&&!l.isA("sap.fe.core.buildingBlocks.BuildingBlock")){l=l.getParent()}let s=i;if(l){s=l.getProperty("metaPath")??i}const p=[];if(a&&i){let t;try{t=new n(c(a),s,i)}catch(t){e.warning(`No metamodel or metaPath is not reachable with ${s} and ${i}`);return null}const r={};C(t.getClosestEntityType(),p,o,r)}return p}function h(e){let t;if(e.isA("sap.ui.layout.form.FormElement")){const n=e.getFields();if(n?.length>0&&n[0].isA("sap.fe.macros.Field")){const e=n[0];t=e.getMainPropertyRelativePath()}}return t}s.getTargetPropertyFromFormElement=h;function x(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:false;return{changeType:"renameLabel",title:()=>e?T("RTA_CONTEXT_ACTIONMENU_RENAME"):T("RTA_CONTEXT_ACTIONMENU_CHANGELABELS"),icon:"sap-icon://edit",singleRename:e,controlBasedRenameChangeType:"renameField",type:l.StringType,delegate:{getAnnotationsChangeInfo:(e,t)=>{let n=r.getOwnerComponentFor(e);if(!n){const t=i.getTargetView(e);n=t?.getController().getOwnerComponent()}if(n){let t;const r=A(n,e,()=>true);const o=h(e);if(o){t=r?.find(e=>e.property.name===o)?.property}if(r&&r.length>0){return{serviceUrl:e.getModel()?.getServiceUrl(),properties:r.map(e=>({propertyName:`${e.property.name}`,annotationPath:"/"+e.entityType.fullyQualifiedName+"/"+e.property.name+"@com.sap.vocabularies.Common.v1.Label",currentValue:e.property.annotations.Common?.Label?.toString()??e.property.name})),possibleValues:[],preSelectedProperty:t?"/"+t.fullyQualifiedName+"@com.sap.vocabularies.Common.v1.Label":""}}}return null}}}}s.getRenameAction=x;function v(){let e=arguments.length>0&&arguments[0]!==undefined?arguments[0]:"RTA_CONTEXT_ACTIONMENU_TEXTARRANGE";return{changeType:"textArrangement_Test",title:()=>T(e),type:l.ValueListType,delegate:{getAnnotationsChangeInfo:(e,t)=>{let n=r.getOwnerComponentFor(e);if(!n){const t=i.getTargetView(e);n=t?.getController().getOwnerComponent()}if(n){const t=A(n,e,d);if(t&&t.length>0){return{serviceUrl:e.getModel()?.getServiceUrl(),properties:t.map(e=>{const t=e.entityType.annotations.UI?.TextArrangement?.toString()??"UI.TextArrangementType/TextFirst".toString();return{propertyName:e.property.annotations.Common?.Label?.toString()??e.property.name,annotationPath:"/"+e.entityType.fullyQualifiedName+"/"+e.property.name+"@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement",currentValue:e.property.annotations.Common?.Text?.annotations?.UI?.TextArrangement?.toString()??t}}),possibleValues:Object.keys(f).map(e=>({key:e,text:f[e]})),preSelectedProperty:""}}}return null}}}}s.getTextArrangementChangeAction=v;return s},false);
//# sourceMappingURL=AnnotationBasedChanges.js.map