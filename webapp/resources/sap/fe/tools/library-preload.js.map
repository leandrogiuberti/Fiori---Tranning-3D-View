{"version":3,"file":"library-preload.js","sections":[{"offset":{"line":1,"column":0},"map":{"version":3,"names":["split","input","LF","CRLF","a","pL","p1","indexOf","p2","push","substring","length","BatchContent","data","this","type","stringData","stringSplit","pos","_exports","_proto","prototype","lookLine","readLine","inc","Batch","isChangeSet","boundary","changeSetErrorResponse","parts","getBoundary","headerValue","l","element","ll","trim","readHeader","line","colPos","Error","s0","s1","name","toLowerCase","value","readAppHttp","batchContent","headers","payload","state","rawUrl","undefined","h","method","url","actualBody","JSON","parse","e","body","extractContent","content","contentId","changeSetBoundary","parseBatch","parsePart","boundaryNext","boundaryEnd","isChangeset","arguments","batch","part"],"sources":["./BatchParser.ts"],"sourcesContent":["function split(input: string): string[] {\n\tconst LF = \"\\n\";\n\tconst CRLF = \"\\r\\n\";\n\tconst a = [];\n\n\tlet pL = 0;\n\tlet p1 = input.indexOf(CRLF, pL);\n\tlet p2 = input.indexOf(LF, pL);\n\n\twhile (p1 !== -1 || p2 !== -1) {\n\t\tif (p1 !== -1 && p1 <= p2) {\n\t\t\ta.push(input.substring(pL, p1));\n\t\t\tpL = p1 + 2;\n\t\t} else {\n\t\t\ta.push(input.substring(pL, p2));\n\t\t\tpL = p2 + 1;\n\t\t}\n\t\tp1 = input.indexOf(CRLF, pL);\n\t\tp2 = input.indexOf(LF, pL);\n\t}\n\tif (pL < input.length) {\n\t\ta.push(input.substring(pL));\n\t}\n\treturn a;\n}\n\n/**\n *\n */\nexport class BatchContent {\n\ttype: number;\n\n\tstringData: string;\n\n\tstringSplit: string[];\n\n\tpos: number;\n\n\tpublic constructor(data: string) {\n\t\tthis.type = 0;\n\t\tthis.stringData = data;\n\t\tthis.stringSplit = split(data);\n\t\tthis.pos = 0;\n\t}\n\n\tpublic lookLine(): string {\n\t\treturn this.stringSplit[this.pos];\n\t}\n\n\tpublic readLine(): string {\n\t\treturn this.stringSplit[this.pos++];\n\t}\n\n\tpublic inc(): void {\n\t\tthis.pos++;\n\t}\n}\n\nexport class Batch {\n\tchangeSetErrorResponse: any;\n\n\tparts: BatchPart[];\n\n\tpublic constructor(\n\t\tpublic isChangeSet: boolean,\n\t\tpublic boundary: string\n\t) {\n\t\tif (this.isChangeSet) {\n\t\t\tthis.changeSetErrorResponse = null;\n\t\t}\n\t\tthis.parts = [];\n\t}\n}\n\nexport function getBoundary(headerValue: string): string {\n\tconst l = headerValue.split(\";\");\n\n\tfor (const element of l) {\n\t\tconst ll = element.split(\"=\");\n\t\tif (ll[0].trim() === \"boundary\") {\n\t\t\treturn ll[1];\n\t\t}\n\t}\n\treturn \"\";\n}\n\nfunction readHeader(line: string): any {\n\tconst colPos = line.indexOf(\":\");\n\tif (colPos === -1) {\n\t\tthrow new Error('Invalid header \"content-type\" in batch part');\n\t}\n\n\tconst s0 = line.substring(0, colPos);\n\tconst s1 = line.substring(colPos + 1);\n\treturn {\n\t\tname: s0.toLowerCase(),\n\t\tvalue: s1.trim()\n\t};\n}\nexport type BatchPart = {\n\turl: string;\n\tmethod: string;\n\tbody: any;\n\theaders: Record<string, string>;\n\tcontentId?: string;\n};\n\nfunction readAppHttp(batchContent: BatchContent, boundary: string): BatchPart {\n\tconst headers: any = {};\n\tconst payload = [];\n\n\tlet state = 0; //read url\n\tconst rawUrl = batchContent.readLine();\n\n\tstate = 1; //read header\n\tlet line = batchContent.lookLine();\n\n\twhile (line !== null && line !== undefined && line.indexOf(boundary) !== 0) {\n\t\tif (state === 1) {\n\t\t\tif (line.length === 0) {\n\t\t\t\tstate = 2; //read body\n\t\t\t\tbatchContent.inc();\n\t\t\t} else {\n\t\t\t\tconst h = readHeader(line);\n\t\t\t\theaders[h.name] = h.value;\n\t\t\t\tbatchContent.inc();\n\t\t\t}\n\t\t} else if (state === 2) {\n\t\t\tpayload.push(line);\n\t\t\tbatchContent.inc();\n\t\t}\n\t\tline = batchContent.lookLine();\n\t}\n\tif (line === undefined) {\n\t\tthrow new Error(\"Invalid boundary while parsing batch request. Expect boundary \" + boundary);\n\t}\n\n\tconst [method, url] = rawUrl.split(\" \");\n\n\tlet actualBody: any;\n\tif (payload.length > 0) {\n\t\ttry {\n\t\t\tactualBody = JSON.parse(payload[0]);\n\t\t} catch (e) {\n\t\t\tactualBody = payload[0];\n\t\t}\n\t}\n\treturn {\n\t\turl: `/${url}`,\n\t\tmethod: method,\n\t\theaders: headers,\n\t\tbody: actualBody\n\t};\n}\n\nfunction extractContent(batchContent: BatchContent, headers: any, boundary: string): any {\n\tlet content;\n\tif (!headers[\"content-type\"]) {\n\t\tthrow new Error('Missing header \"content-type\" in batch part');\n\t} else if (headers[\"content-type\"] === \"application/http\") {\n\t\tcontent = readAppHttp(batchContent, boundary);\n\t\tif (headers[\"content-id\"]) {\n\t\t\tcontent.contentId = headers[\"content-id\"];\n\t\t}\n\t} else if (headers[\"content-type\"].indexOf(\"multipart/mixed;\") > -1) {\n\t\tconst changeSetBoundary = getBoundary(headers[\"content-type\"]);\n\t\tcontent = parseBatch(batchContent, changeSetBoundary, true);\n\t}\n\treturn content;\n}\n\nfunction parsePart(batchContent: BatchContent, boundary: string): any {\n\tconst boundaryNext = boundary;\n\tconst boundaryEnd = boundary + \"--\";\n\tconst headers: any = {};\n\tlet content;\n\n\tlet state = 1; //read header\n\tlet line = batchContent.lookLine();\n\n\twhile (line !== null && line !== undefined && line !== boundaryNext && line !== boundaryEnd) {\n\t\tif (state === 1) {\n\t\t\tif (line.length === 0) {\n\t\t\t\tstate = 2; //read body\n\t\t\t\tbatchContent.inc();\n\t\t\t} else {\n\t\t\t\tconst h = readHeader(line);\n\t\t\t\theaders[h.name] = h.value;\n\t\t\t\tbatchContent.inc();\n\t\t\t}\n\t\t} else if (state === 2) {\n\t\t\tcontent = extractContent(batchContent, headers, boundary);\n\t\t}\n\t\tline = batchContent.lookLine();\n\t}\n\tif (line === undefined) {\n\t\tthrow new Error(\"Invalid boundary while parsing batch request. Expect boundary \" + boundary);\n\t}\n\n\treturn content;\n}\n\nexport function parseBatch(content: BatchContent, boundary: string, isChangeset = false): any {\n\tconst boundaryNext = \"--\" + boundary;\n\tconst boundaryEnd = \"--\" + boundary + \"--\";\n\n\tconst batch = new Batch(isChangeset, boundary);\n\n\tlet part;\n\n\tlet line = content.readLine();\n\twhile (line !== null && line !== undefined && line !== boundaryNext) {\n\t\t//read lines before first boundary\n\t\tline = content.readLine();\n\t}\n\tif (line === undefined) {\n\t\tthrow new Error(\"Invalid boundary while parsing batch request\");\n\t}\n\t//line is now read boundary\n\tline = content.lookLine(); //read line behind\n\n\twhile (line !== null && line !== undefined && line !== boundaryEnd) {\n\t\tpart = parsePart(content, boundaryNext) as BatchPart;\n\t\tif (part) {\n\t\t\tbatch.parts.push(part);\n\t\t}\n\t\tline = content.lookLine(); //now on boundary\n\t\tif (line === boundaryNext) {\n\t\t\tline = content.readLine(); //consume boundaryNext\n\t\t}\n\t}\n\n\tcontent.readLine(); //consume boundaryEnd\n\tline = content.lookLine(); //read line behind\n\twhile (line !== null && line !== undefined && line.length === 0) {\n\t\t//read empty lines after first boundary end\n\t\tcontent.readLine();\n\t\tline = content.lookLine();\n\t}\n\n\treturn batch;\n}\n"],"mappings":"AAAA;;;;iFAAA,SAASA,EAAMC,GACd,MAAMC,EAAK,KACX,MAAMC,EAAO,OACb,MAAMC,EAAI,GAEV,IAAIC,EAAK,EACT,IAAIC,EAAKL,EAAMM,QAAQJ,EAAME,GAC7B,IAAIG,EAAKP,EAAMM,QAAQL,EAAIG,GAE3B,MAAOC,KAAQ,GAAKE,KAAQ,EAAG,CAC9B,GAAIF,KAAQ,GAAKA,GAAME,EAAI,CAC1BJ,EAAEK,KAAKR,EAAMS,UAAUL,EAAIC,IAC3BD,EAAKC,EAAK,CACX,KAAO,CACNF,EAAEK,KAAKR,EAAMS,UAAUL,EAAIG,IAC3BH,EAAKG,EAAK,CACX,CACAF,EAAKL,EAAMM,QAAQJ,EAAME,GACzBG,EAAKP,EAAMM,QAAQL,EAAIG,EACxB,CACA,GAAIA,EAAKJ,EAAMU,OAAQ,CACtBP,EAAEK,KAAKR,EAAMS,UAAUL,GACxB,CACA,OAAOD,CACR,CAEA,IAGaQ,EAAY,WASxB,SAAAA,EAAmBC,GAClBC,KAAKC,KAAO,EACZD,KAAKE,WAAaH,EAClBC,KAAKG,YAAcjB,EAAMa,GACzBC,KAAKI,IAAM,CACZ,CAACC,EAAAP,eAAA,IAAAQ,EAAAR,EAAAS,UAAAD,EAEME,SAAP,SAAOA,IACN,OAAOR,KAAKG,YAAYH,KAAKI,IAC9B,EAACE,EAEMG,SAAP,SAAOA,IACN,OAAOT,KAAKG,YAAYH,KAAKI,MAC9B,EAACE,EAEMI,IAAP,SAAOA,IACNV,KAAKI,KACN,EAAC,OAAAN,CAAA,CA1BuB,GA0BvBO,EAAAP,eAAA,IAGWa,EAKZ,SAAAA,EACQC,EACAC,GACNb,KAFMY,cAAoBZ,KACpBa,WAEP,GAAIb,KAAKY,YAAa,CACrBZ,KAAKc,uBAAyB,IAC/B,CACAd,KAAKe,MAAQ,EACd,EAACV,EAAAM,QAGK,SAASK,EAAYC,GAC3B,MAAMC,EAAID,EAAY/B,MAAM,KAE5B,IAAK,MAAMiC,KAAWD,EAAG,CACxB,MAAME,EAAKD,EAAQjC,MAAM,KACzB,GAAIkC,EAAG,GAAGC,SAAW,WAAY,CAChC,OAAOD,EAAG,EACX,CACD,CACA,MAAO,EACR,CAACf,EAAAW,cAED,SAASM,EAAWC,GACnB,MAAMC,EAASD,EAAK9B,QAAQ,KAC5B,GAAI+B,KAAY,EAAG,CAClB,MAAM,IAAIC,MAAM,8CACjB,CAEA,MAAMC,EAAKH,EAAK3B,UAAU,EAAG4B,GAC7B,MAAMG,EAAKJ,EAAK3B,UAAU4B,EAAS,GACnC,MAAO,CACNI,KAAMF,EAAGG,cACTC,MAAOH,EAAGN,OAEZ,CASA,SAASU,EAAYC,EAA4BnB,GAChD,MAAMoB,EAAe,CAAC,EACtB,MAAMC,EAAU,GAEhB,IAAIC,EAAQ,EACZ,MAAMC,EAASJ,EAAavB,WAE5B0B,EAAQ,EACR,IAAIZ,EAAOS,EAAaxB,WAExB,MAAOe,IAAS,MAAQA,IAASc,WAAad,EAAK9B,QAAQoB,KAAc,EAAG,CAC3E,GAAIsB,IAAU,EAAG,CAChB,GAAIZ,EAAK1B,SAAW,EAAG,CACtBsC,EAAQ,EACRH,EAAatB,KACd,KAAO,CACN,MAAM4B,EAAIhB,EAAWC,GACrBU,EAAQK,EAAEV,MAAQU,EAAER,MACpBE,EAAatB,KACd,CACD,MAAO,GAAIyB,IAAU,EAAG,CACvBD,EAAQvC,KAAK4B,GACbS,EAAatB,KACd,CACAa,EAAOS,EAAaxB,UACrB,CACA,GAAIe,IAASc,UAAW,CACvB,MAAM,IAAIZ,MAAM,iEAAmEZ,EACpF,CAEA,MAAO0B,EAAQC,GAAOJ,EAAOlD,MAAM,KAEnC,IAAIuD,EACJ,GAAIP,EAAQrC,OAAS,EAAG,CACvB,IACC4C,EAAaC,KAAKC,MAAMT,EAAQ,GACjC,CAAE,MAAOU,GACRH,EAAaP,EAAQ,EACtB,CACD,CACA,MAAO,CACNM,IAAK,IAAIA,IACTD,OAAQA,EACRN,QAASA,EACTY,KAAMJ,EAER,CAEA,SAASK,EAAed,EAA4BC,EAAcpB,GACjE,IAAIkC,EACJ,IAAKd,EAAQ,gBAAiB,CAC7B,MAAM,IAAIR,MAAM,8CACjB,MAAO,GAAIQ,EAAQ,kBAAoB,mBAAoB,CAC1Dc,EAAUhB,EAAYC,EAAcnB,GACpC,GAAIoB,EAAQ,cAAe,CAC1Bc,EAAQC,UAAYf,EAAQ,aAC7B,CACD,MAAO,GAAIA,EAAQ,gBAAgBxC,QAAQ,qBAAuB,EAAG,CACpE,MAAMwD,EAAoBjC,EAAYiB,EAAQ,iBAC9Cc,EAAUG,EAAWlB,EAAciB,EAAmB,KACvD,CACA,OAAOF,CACR,CAEA,SAASI,EAAUnB,EAA4BnB,GAC9C,MAAMuC,EAAevC,EACrB,MAAMwC,EAAcxC,EAAW,KAC/B,MAAMoB,EAAe,CAAC,EACtB,IAAIc,EAEJ,IAAIZ,EAAQ,EACZ,IAAIZ,EAAOS,EAAaxB,WAExB,MAAOe,IAAS,MAAQA,IAASc,WAAad,IAAS6B,GAAgB7B,IAAS8B,EAAa,CAC5F,GAAIlB,IAAU,EAAG,CAChB,GAAIZ,EAAK1B,SAAW,EAAG,CACtBsC,EAAQ,EACRH,EAAatB,KACd,KAAO,CACN,MAAM4B,EAAIhB,EAAWC,GACrBU,EAAQK,EAAEV,MAAQU,EAAER,MACpBE,EAAatB,KACd,CACD,MAAO,GAAIyB,IAAU,EAAG,CACvBY,EAAUD,EAAed,EAAcC,EAASpB,EACjD,CACAU,EAAOS,EAAaxB,UACrB,CACA,GAAIe,IAASc,UAAW,CACvB,MAAM,IAAIZ,MAAM,iEAAmEZ,EACpF,CAEA,OAAOkC,CACR,CAEO,SAASG,EAAWH,EAAuBlC,GAA4C,IAA1ByC,EAAWC,UAAA1D,OAAA,GAAA0D,UAAA,KAAAlB,UAAAkB,UAAA,GAAG,MACjF,MAAMH,EAAe,KAAOvC,EAC5B,MAAMwC,EAAc,KAAOxC,EAAW,KAEtC,MAAM2C,EAAQ,IAAI7C,EAAM2C,EAAazC,GAErC,IAAI4C,EAEJ,IAAIlC,EAAOwB,EAAQtC,WACnB,MAAOc,IAAS,MAAQA,IAASc,WAAad,IAAS6B,EAAc,CAEpE7B,EAAOwB,EAAQtC,UAChB,CACA,GAAIc,IAASc,UAAW,CACvB,MAAM,IAAIZ,MAAM,+CACjB,CAEAF,EAAOwB,EAAQvC,WAEf,MAAOe,IAAS,MAAQA,IAASc,WAAad,IAAS8B,EAAa,CACnEI,EAAON,EAAUJ,EAASK,GAC1B,GAAIK,EAAM,CACTD,EAAMzC,MAAMpB,KAAK8D,EAClB,CACAlC,EAAOwB,EAAQvC,WACf,GAAIe,IAAS6B,EAAc,CAC1B7B,EAAOwB,EAAQtC,UAChB,CACD,CAEAsC,EAAQtC,WACRc,EAAOwB,EAAQvC,WACf,MAAOe,IAAS,MAAQA,IAASc,WAAad,EAAK1B,SAAW,EAAG,CAEhEkD,EAAQtC,WACRc,EAAOwB,EAAQvC,UAChB,CAEA,OAAOgD,CACR,CAACnD,EAAA6C,aAAA,OAAA7C,CAAA","ignoreList":[],"sourceRoot":""}},{"offset":{"line":6,"column":0},"map":{"version":3,"names":["buildingBlockIconTabFilter","addBuildingBlockTab","inspector","_jsx","IconTabFilter","text","children","items","Text","insertAggregation","_exports","addBBInfo","ui5Control","bb","getBuildingBlock","addBuildingBlockInfo","addDefinition","async","iconTabFilterContent","formattedXML","serializeControlAsFormattedXML","CodeEditor","syntaxHints","type","setHeight","window","innerHeight","setValue","addContentToIconTabFilter","bbInstance","getParent","isA","metaPath","contextPath","involvedObject","getDataModelObjectForMetaPath","getDefinitionNavigator","parent","formFields","$parent","push","label","visualization","Button","press","definition","key","involvedObjectElement","targetType","_type","Array","isArray","length","toString","undefined","value","simpleForm","SimpleForm","element","addContent","Label","VBox","content","index","iconTabFilter","getItems","removeContent","getContent"],"sources":["./BuildingBlockTab.tsx"],"sourcesContent":["import type BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport Button from \"sap/m/Button\";\nimport type IconTabBar from \"sap/m/IconTabBar\";\nimport IconTabFilter from \"sap/m/IconTabFilter\";\nimport Label from \"sap/m/Label\";\nimport Text from \"sap/m/Text\";\nimport VBox from \"sap/m/VBox\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport CodeEditor from \"sap/ui/codeeditor/CodeEditor\";\nimport type Control from \"sap/ui/core/Control\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport SimpleForm from \"sap/ui/layout/form/SimpleForm\";\nimport { serializeControlAsFormattedXML } from \"./XMLSerializer\";\n\ntype AnnotationBuildingBlock = BuildingBlock & { metaPath: string; contextPath: string };\ntype DefinitionForm = { label: string; visualization: Text | Button };\nlet buildingBlockIconTabFilter: IconTabFilter;\n\nexport function addBuildingBlockTab(inspector: IconTabBar): void {\n\tbuildingBlockIconTabFilter = (\n\t\t<IconTabFilter key=\"buildingBlock\" text={\"Building Block\"}>\n\t\t\t{{\n\t\t\t\titems: [\n\t\t\t\t\t<IconTabFilter key=\"controlTree\" text=\"Control Tree\">\n\t\t\t\t\t\t<Text text=\"Start inspecting by hovering over items\" />\n\t\t\t\t\t</IconTabFilter>,\n\t\t\t\t\t<IconTabFilter key=\"definition\" text=\"Definition\"></IconTabFilter>\n\t\t\t\t]\n\t\t\t}}\n\t\t</IconTabFilter>\n\t);\n\tinspector.insertAggregation(\"items\", buildingBlockIconTabFilter, 1);\n}\n\nexport function addBBInfo(ui5Control: UI5Element): void {\n\tconst bb = getBuildingBlock(ui5Control);\n\taddBuildingBlockInfo(bb);\n\taddDefinition(bb);\n}\n\nexport async function addBuildingBlockInfo(bb: AnnotationBuildingBlock): Promise<void> {\n\tlet iconTabFilterContent;\n\tif (!bb) {\n\t\ticonTabFilterContent = <Text text=\"No associated Builing Block\" />;\n\t} else {\n\t\tconst formattedXML = await serializeControlAsFormattedXML(bb);\n\t\ticonTabFilterContent = <CodeEditor syntaxHints={false} type=\"XML\" />;\n\t\ticonTabFilterContent.setHeight(window.innerHeight - 120 + \"px\");\n\t\ticonTabFilterContent.setValue(formattedXML);\n\t}\n\taddContentToIconTabFilter(\"controlTree\", iconTabFilterContent);\n}\n\nconst getBuildingBlock = function (ui5Control: ManagedObject | null): AnnotationBuildingBlock {\n\tlet bbInstance;\n\twhile (ui5Control) {\n\t\tui5Control = ui5Control.getParent();\n\t\tif (!ui5Control) {\n\t\t\tbreak;\n\t\t}\n\n\t\tif (ui5Control.isA(\"sap.fe.core.buildingBlocks.BuildingBlock\")) {\n\t\t\tbbInstance = ui5Control;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn bbInstance as AnnotationBuildingBlock;\n};\n\nexport function addDefinition(bb: AnnotationBuildingBlock): void {\n\tlet iconTabFilterContent;\n\tif (bb && bb.metaPath && bb.contextPath) {\n\t\tconst involvedObject = bb.getDataModelObjectForMetaPath(bb.metaPath, bb.contextPath);\n\t\ticonTabFilterContent = getDefinitionNavigator(involvedObject as Record<string, unknown>);\n\t} else if (!bb) {\n\t\ticonTabFilterContent = <Text text=\"No associated Builing Block\" />;\n\t} else {\n\t\ticonTabFilterContent = <Text text=\"No Definition Found\" />;\n\t}\n\taddContentToIconTabFilter(\"definition\", iconTabFilterContent);\n}\n\nexport function getDefinitionNavigator(involvedObject: Record<string, unknown>, parent?: Record<string, unknown>): Control {\n\tconst formFields: DefinitionForm[] = [];\n\tinvolvedObject.$parent = parent;\n\tif (parent) {\n\t\tformFields.push({\n\t\t\tlabel: \"Parent\",\n\t\t\tvisualization: (\n\t\t\t\t<Button\n\t\t\t\t\ttext={\"Go Up\"}\n\t\t\t\t\ttype=\"Transparent\"\n\t\t\t\t\tpress={(): void => {\n\t\t\t\t\t\tconst definition = getDefinitionNavigator(parent, parent.$parent as Record<string, unknown>);\n\t\t\t\t\t\taddContentToIconTabFilter(\"definition\", definition);\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t)\n\t\t});\n\t}\n\tfor (const key in involvedObject) {\n\t\tif (key === \"$parent\") {\n\t\t\tcontinue; // Skip the $parent property\n\t\t}\n\t\tlet visualization;\n\t\tconst involvedObjectElement = involvedObject[key];\n\t\tif (typeof involvedObjectElement === \"object\") {\n\t\t\tlet targetType = (involvedObjectElement as { _type?: string })._type;\n\t\t\tif (Array.isArray(involvedObjectElement) && involvedObjectElement.length > 0) {\n\t\t\t\ttargetType = (involvedObjectElement[0] as { _type?: string })._type + \" Array\";\n\t\t\t} else if (!targetType) {\n\t\t\t\ttargetType = \"Object\";\n\t\t\t}\n\t\t\tvisualization = (\n\t\t\t\t<Button\n\t\t\t\t\ttext={\"Type \" + targetType + \" > Drill Down\"}\n\t\t\t\t\ttype=\"Transparent\"\n\t\t\t\t\tpress={(): void => {\n\t\t\t\t\t\tconst definition = getDefinitionNavigator(involvedObjectElement as Record<string, unknown>, involvedObject);\n\t\t\t\t\t\taddContentToIconTabFilter(\"definition\", definition);\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else if (\n\t\t\ttypeof involvedObjectElement === \"string\" ||\n\t\t\ttypeof involvedObjectElement === \"number\" ||\n\t\t\ttypeof involvedObjectElement === \"boolean\"\n\t\t) {\n\t\t\tvisualization = <Text text={involvedObjectElement.toString()} />;\n\t\t} else if (involvedObjectElement === undefined || involvedObjectElement === null) {\n\t\t\tvisualization = <Text text=\"undefined\" />;\n\t\t} else if (typeof involvedObjectElement === \"function\") {\n\t\t\t<Button\n\t\t\t\ttext={key}\n\t\t\t\ttype=\"Transparent\"\n\t\t\t\tpress={(): void => {\n\t\t\t\t\tconst value = involvedObjectElement();\n\t\t\t\t\tconst definition = getDefinitionNavigator({ value: value });\n\t\t\t\t\taddContentToIconTabFilter(\"definition\", definition);\n\t\t\t\t}}\n\t\t\t/>;\n\t\t\t// TODO: we can probably do better over here\n\t\t\tcontinue;\n\t\t}\n\t\tformFields.push({\n\t\t\tlabel: key,\n\t\t\tvisualization\n\t\t});\n\t}\n\n\tconst simpleForm = <SimpleForm />;\n\tif (formFields.length > 0) {\n\t\tfor (const element of formFields) {\n\t\t\tsimpleForm.addContent(<Label text={element.label} />);\n\t\t\tsimpleForm.addContent(element.visualization);\n\t\t}\n\t}\n\n\treturn <VBox>{simpleForm}</VBox>;\n}\n\nfunction addContentToIconTabFilter(key: string, content: Control): void {\n\tlet index = 0;\n\tswitch (key) {\n\t\tcase \"controlTree\":\n\t\t\tindex = 0;\n\t\t\tbreak;\n\t\tcase \"definition\":\n\t\t\tindex = 1;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\tconst iconTabFilter = buildingBlockIconTabFilter.getItems()[index] as IconTabFilter;\n\ticonTabFilter.removeContent(iconTabFilter.getContent()[0]);\n\ticonTabFilter.addContent(content);\n}\n"],"mappings":"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","ignoreList":[],"sourceRoot":""}},{"offset":{"line":11,"column":0},"map":{"version":3,"names":["currentControl","codeEditor","_jsx","CodeEditor","syntaxHints","type","parentButton","Button","enabled","text","press","showElement","getParent","FE","window","opener","$fe","requestList","List","items","mode","class","selectionChange","oEvent","oItem","getParameter","currentRequest","getBindingContext","getObject","this","getModel","setProperty","currentCache","createdCaches","trace","odataPropsToControl","Object","keys","mChangeListeners","forEach","key","push","count","length","children","StandardListItem","title","description","info","inspector","IconTabBar","expanded","_jsxs","IconTabFilter","noData","CustomListItem","Link","href","target","HTML","content","VBox","renderType","Toolbar","CheckBox","selected","controlIndex","MessageBox","alert","HBox","height","width","traceId","getProperty","dependentBindings","__feBinding","getDependentBindings","binding","__feSource","closestDomRef","style","outline","e","Log","SimpleForm","Label","Text","value","editable","currentValue","changeListeners","selectedOdataPropControls","controlPerKey","selectedOdataPropControl","getMetadata","getName","getId","prop","__feForProp","control","placeAt","setModel","supportModel","addBuildingBlockTab","ResizeHandler","register","document","querySelector","setHeight","innerHeight","async","ui5Control","getDomRef","setEnabled","setText","formattedXML","serializeControlAsFormattedXML","setValue","addBBInfo","stateValue","stateContent","getData","stateContentKey","stateContentValue","loadSupportLinksForElement","toggleElementInspector"],"sources":["./InfoSupportTool.tsx"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport { loadSupportLinksForElement } from \"sap/fe/tools/SupportLinks\";\nimport { serializeControlAsFormattedXML } from \"sap/fe/tools/XMLSerializer\";\nimport Button from \"sap/m/Button\";\nimport CheckBox from \"sap/m/CheckBox\";\nimport CustomListItem from \"sap/m/CustomListItem\";\nimport HBox from \"sap/m/HBox\";\nimport IconTabBar from \"sap/m/IconTabBar\";\nimport IconTabFilter from \"sap/m/IconTabFilter\";\nimport Label from \"sap/m/Label\";\nimport Link from \"sap/m/Link\";\nimport List from \"sap/m/List\";\nimport type { ListBase$SelectionChangeEvent } from \"sap/m/ListBase\";\nimport MessageBox from \"sap/m/MessageBox\";\nimport StandardListItem from \"sap/m/StandardListItem\";\nimport Text from \"sap/m/Text\";\nimport Toolbar from \"sap/m/Toolbar\";\nimport VBox from \"sap/m/VBox\";\nimport CodeEditor from \"sap/ui/codeeditor/CodeEditor\";\nimport type Control from \"sap/ui/core/Control\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport HTML from \"sap/ui/core/HTML\";\nimport ResizeHandler from \"sap/ui/core/ResizeHandler\";\nimport SimpleForm from \"sap/ui/layout/form/SimpleForm\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\nimport { addBBInfo, addBuildingBlockTab } from \"./BuildingBlockTab\";\n\nlet currentControl: UI5Element | undefined;\nconst codeEditor: CodeEditor = <CodeEditor syntaxHints={false} type=\"XML\" />;\nconst parentButton: Button = (\n\t<Button\n\t\tenabled={false}\n\t\ttext={\"Select an item to see it's parent\"}\n\t\tpress={function (): void {\n\t\t\tshowElement(currentControl?.getParent() as UI5Element);\n\t\t}}\n\t/>\n);\n// @ts-ignore\nconst FE = window?.opener?.$fe ?? window?.$fe;\n\nconst requestList: List = (\n\t<List\n\t\titems={\"{/data}\"}\n\t\tmode={\"SingleSelectMaster\"}\n\t\tclass={\"feRequestList\"}\n\t\tselectionChange={function (this: List, oEvent: ListBase$SelectionChangeEvent): void {\n\t\t\tconst oItem = oEvent.getParameter(\"listItem\");\n\t\t\tif (oItem) {\n\t\t\t\t//console.log(\"Selected item is: \" + oItem.getId());\n\t\t\t\tconst currentRequest = oItem.getBindingContext()?.getObject();\n\t\t\t\t(this.getModel() as JSONModel).setProperty(\"/selectedItem\", currentRequest);\n\t\t\t\tconst currentCache = FE.createdCaches[currentRequest.trace];\n\t\t\t\tconst odataPropsToControl: { key: string; count: number }[] = [];\n\t\t\t\tif (currentCache) {\n\t\t\t\t\tObject.keys(currentCache.mChangeListeners).forEach((key) => {\n\t\t\t\t\t\todataPropsToControl.push({ key, count: currentCache.mChangeListeners[key].length });\n\t\t\t\t\t});\n\t\t\t\t\t(this.getModel() as JSONModel).setProperty(\"/odataPropsToControl\", odataPropsToControl);\n\t\t\t\t\t(this.getModel() as JSONModel).setProperty(\"/currentCache\", currentCache);\n\t\t\t\t}\n\t\t\t}\n\t\t}}\n\t>\n\t\t{{ items: <StandardListItem title=\"{urlBase}\" description={\"{request/method}\"} info={\"#{trace}\"} /> }}\n\t</List>\n);\nconst inspector: IconTabBar = (\n\t<IconTabBar expanded={true}>\n\t\t{{\n\t\t\titems: [\n\t\t\t\t<IconTabFilter key=\"supportLinks\" text={\"Service Implementation\"}>\n\t\t\t\t\t<List items={\"{/supportLinks}\"} noData={\"{/supportLinksStateText}\"}>\n\t\t\t\t\t\t<CustomListItem>\n\t\t\t\t\t\t\t<Link text=\"{Text}\" href=\"{Url}\" target={\"linkContent\"} class={\"sapUiTinyMargin\"} />\n\t\t\t\t\t\t</CustomListItem>\n\t\t\t\t\t</List>\n\t\t\t\t\t<HTML content={'<iframe name=\"linkContent\" width=\"99%\" height=\"85%\"/>'}></HTML>\n\t\t\t\t</IconTabFilter>,\n\t\t\t\t<IconTabFilter key=\"tree\" text={\"Control Tree\"}>\n\t\t\t\t\t<VBox renderType={\"Bare\"}>\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t<Toolbar>\n\t\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\t\tcontent: [\n\t\t\t\t\t\t\t\t\t\t\t<CheckBox text={\"Prevent interaction\"} selected={\"{/preventInteraction}\"} />,\n\t\t\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\t\t\ttext={\"Send to Console\"}\n\t\t\t\t\t\t\t\t\t\t\t\tpress={function (): void {\n\t\t\t\t\t\t\t\t\t\t\t\t\tFE[\"$\" + FE.controlIndex] = currentControl;\n\t\t\t\t\t\t\t\t\t\t\t\t\tMessageBox.alert(\"Control sent to console as $fe.$\" + FE.controlIndex);\n\t\t\t\t\t\t\t\t\t\t\t\t\tFE.controlIndex++;\n\t\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t\t/>,\n\t\t\t\t\t\t\t\t\t\t\tparentButton\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t</Toolbar>,\n\t\t\t\t\t\t\t\tcodeEditor\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}}\n\t\t\t\t\t</VBox>\n\t\t\t\t\t;\n\t\t\t\t</IconTabFilter>,\n\t\t\t\t<IconTabFilter key=\"properties\" text={\"Control Properties\"}></IconTabFilter>,\n\t\t\t\t<IconTabFilter key=\"state\" text={\"Control State\"}>\n\t\t\t\t\t<List items={\"{/state}\"}>\n\t\t\t\t\t\t<StandardListItem title=\"{key}\" description=\"{value}\" />\n\t\t\t\t\t</List>\n\t\t\t\t</IconTabFilter>,\n\t\t\t\t<IconTabFilter key=\"requests\" text=\"OData Requests\">\n\t\t\t\t\t<Button\n\t\t\t\t\t\tpress={function (this: Control): void {\n\t\t\t\t\t\t\t(this.getModel() as JSONModel).setProperty(\"/data\", []);\n\t\t\t\t\t\t}}\n\t\t\t\t\t\ttext={\"Clear All\"}\n\t\t\t\t\t/>\n\t\t\t\t\t<HBox height={\"100%\"} class={\"feRequestHBox\"}>\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\trequestList,\n\t\t\t\t\t\t\t\t<VBox width={\"100%\"}>\n\t\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\t\ttext={\"Highlight related controls\"}\n\t\t\t\t\t\t\t\t\t\tpress={function (this: Button): void {\n\t\t\t\t\t\t\t\t\t\t\tconst traceId = this.getModel()!.getProperty(\"/selectedItem\").trace;\n\t\t\t\t\t\t\t\t\t\t\tconst dependentBindings = FE.createdCaches[traceId].__feBinding.getDependentBindings();\n\t\t\t\t\t\t\t\t\t\t\tdependentBindings.forEach((binding: any) => {\n\t\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (binding.__feSource && binding.closestDomRef) {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tbinding.closestDomRef.style.outline = \"3px auto green\";\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tLog.info(\"Error while highlighting dependent bindings\", e as string);\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t<SimpleForm>\n\t\t\t\t\t\t\t\t\t\t<Label text={\"Method\"} />\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{/selectedItem/request/method}\" />\n\t\t\t\t\t\t\t\t\t\t<Label text={\"URL\"} />\n\t\t\t\t\t\t\t\t\t\t<Text text=\"{/selectedItem/urlBase}\" />\n\t\t\t\t\t\t\t\t\t\t<Label text={\"Parameters\"} />\n\t\t\t\t\t\t\t\t\t\t<CodeEditor value=\"{/selectedItem/parameters}\" type=\"json\" editable={true} height={\"200px\"} />\n\t\t\t\t\t\t\t\t\t\t<Label text={\"Data\"} />\n\t\t\t\t\t\t\t\t\t\t<CodeEditor value=\"{/selectedItem/responseBody}\" type=\"json\" editable={true} height={\"300px\"} />\n\t\t\t\t\t\t\t\t\t\t<Label text={\"Data Tree\"} />\n\t\t\t\t\t\t\t\t\t\t{/*<Tree items=\"{/selectedItem/responseBodyObj}\">*/}\n\t\t\t\t\t\t\t\t\t\t{/*\t<StandardTreeItem title=\"{text}\"/>*/}\n\t\t\t\t\t\t\t\t\t\t{/*</Tree>*/}\n\t\t\t\t\t\t\t\t\t</SimpleForm>\n\t\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}}\n\t\t\t\t\t</HBox>\n\t\t\t\t</IconTabFilter>,\n\t\t\t\t<IconTabFilter key=\"state\" text={\"OData Properties > Controls\"}>\n\t\t\t\t\t<HBox>\n\t\t\t\t\t\t{{\n\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t<List\n\t\t\t\t\t\t\t\t\titems={\"{/odataPropsToControl}\"}\n\t\t\t\t\t\t\t\t\tmode={\"SingleSelectMaster\"}\n\t\t\t\t\t\t\t\t\tselectionChange={function (this: List, oEvent: ListBase$SelectionChangeEvent): void {\n\t\t\t\t\t\t\t\t\t\tconst oItem = oEvent.getParameter(\"listItem\");\n\t\t\t\t\t\t\t\t\t\tif (oItem) {\n\t\t\t\t\t\t\t\t\t\t\t//console.log(\"Selected item is: \" + oItem.getId());\n\t\t\t\t\t\t\t\t\t\t\tconst currentValue = oItem.getBindingContext()?.getObject();\n\t\t\t\t\t\t\t\t\t\t\tconst currentCache = (this.getModel() as JSONModel).getProperty(\"/currentCache\");\n\t\t\t\t\t\t\t\t\t\t\tconst changeListeners = currentCache.mChangeListeners[currentValue.key];\n\t\t\t\t\t\t\t\t\t\t\tconst selectedOdataPropControls: {\n\t\t\t\t\t\t\t\t\t\t\t\tkey: string;\n\t\t\t\t\t\t\t\t\t\t\t\tprop: string;\n\t\t\t\t\t\t\t\t\t\t\t\tcount: number;\n\t\t\t\t\t\t\t\t\t\t\t\tcontrol: Control;\n\t\t\t\t\t\t\t\t\t\t\t}[] = [];\n\t\t\t\t\t\t\t\t\t\t\tconst controlPerKey: Record<\n\t\t\t\t\t\t\t\t\t\t\t\tstring,\n\t\t\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey: string;\n\t\t\t\t\t\t\t\t\t\t\t\t\tprop: string;\n\t\t\t\t\t\t\t\t\t\t\t\t\tcount: number;\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol: Control;\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t> = {};\n\t\t\t\t\t\t\t\t\t\t\tfor (const selectedOdataPropControl of changeListeners) {\n\t\t\t\t\t\t\t\t\t\t\t\tconst key =\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectedOdataPropControl.__feSource.getMetadata().getName() +\n\t\t\t\t\t\t\t\t\t\t\t\t\t\" #\" +\n\t\t\t\t\t\t\t\t\t\t\t\t\tselectedOdataPropControl.__feSource.getId();\n\t\t\t\t\t\t\t\t\t\t\t\tconst prop = selectedOdataPropControl.__feForProp;\n\t\t\t\t\t\t\t\t\t\t\t\tcontrolPerKey[key + \"_\" + prop] ??= {\n\t\t\t\t\t\t\t\t\t\t\t\t\tkey: key,\n\t\t\t\t\t\t\t\t\t\t\t\t\tprop: prop,\n\t\t\t\t\t\t\t\t\t\t\t\t\tcount: 0,\n\t\t\t\t\t\t\t\t\t\t\t\t\tcontrol: selectedOdataPropControl.__feSource\n\t\t\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\t\t\tcontrolPerKey[key + \"_\" + prop].count++;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\tObject.keys(controlPerKey).forEach((key) => {\n\t\t\t\t\t\t\t\t\t\t\t\tselectedOdataPropControls.push(controlPerKey[key]);\n\t\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\t\t\t(this.getModel() as JSONModel).setProperty(\n\t\t\t\t\t\t\t\t\t\t\t\t\"/selectedOdataPropControls\",\n\t\t\t\t\t\t\t\t\t\t\t\tselectedOdataPropControls\n\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<StandardListItem title=\"{key}\" description=\"{count}\" />\n\t\t\t\t\t\t\t\t</List>,\n\t\t\t\t\t\t\t\t<List\n\t\t\t\t\t\t\t\t\titems={\"{/selectedOdataPropControls}\"}\n\t\t\t\t\t\t\t\t\tmode={\"SingleSelectMaster\"}\n\t\t\t\t\t\t\t\t\tselectionChange={function (this: List, oEvent: ListBase$SelectionChangeEvent): void {\n\t\t\t\t\t\t\t\t\t\tconst oItem = oEvent.getParameter(\"listItem\");\n\t\t\t\t\t\t\t\t\t\tif (oItem) {\n\t\t\t\t\t\t\t\t\t\t\t//console.log(\"Selected item is: \" + oItem.getId());\n\t\t\t\t\t\t\t\t\t\t\tconst currentValue = oItem.getBindingContext()?.getObject();\n\t\t\t\t\t\t\t\t\t\t\tshowElement(currentValue.control);\n\t\t\t\t\t\t\t\t\t\t\t//(this.getModel() as JSONModel).setProperty(\"/odataPropsToControl\", odataPropsToControl);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<StandardListItem title=\"{key}\" description=\"Used #{count}\" info=\"Property: {prop}\" />\n\t\t\t\t\t\t\t\t</List>\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t}}\n\t\t\t\t\t</HBox>\n\t\t\t\t</IconTabFilter>\n\t\t\t],\n\t\t\tcontent: []\n\t\t}}\n\t</IconTabBar>\n);\n\ninspector.placeAt(\"sapUiSupportBody\");\ninspector.setModel(FE.supportModel);\naddBuildingBlockTab(inspector);\nResizeHandler.register(document.querySelector(\"body\")!, () => {\n\tcodeEditor?.setHeight(window.innerHeight - 120 + \"px\");\n});\n\nconst showElement = async function (ui5Control: UI5Element): Promise<void> {\n\tcodeEditor.setHeight(window.innerHeight - 120 + \"px\");\n\n\tif (currentControl && currentControl.getDomRef()) {\n\t\t(currentControl.getDomRef() as HTMLElement).style.outline = \"none\";\n\t}\n\n\tcurrentControl = ui5Control;\n\tparentButton.setEnabled(!!currentControl?.getParent());\n\tparentButton.setText(\"Parent \" + currentControl?.getParent()?.getMetadata().getName());\n\tif (ui5Control.getDomRef()) {\n\t\t(ui5Control.getDomRef() as HTMLElement).style.outline = \"3px auto red\";\n\t}\n\n\tconst formattedXML = await serializeControlAsFormattedXML(ui5Control);\n\tcodeEditor.setValue(formattedXML);\n\n\taddBBInfo(ui5Control);\n\n\tconst stateValue = [];\n\tif (ui5Control.getModel(\"$componentState\")) {\n\t\tconst stateContent = (ui5Control.getModel(\"$componentState\") as JSONModel).getData();\n\n\t\tfor (const stateContentKey in stateContent) {\n\t\t\tconst stateContentValue = stateContent[stateContentKey];\n\t\t\tif (stateContentKey !== \"__boundProperties\") {\n\t\t\t\tstateValue.push({ key: stateContentKey, value: stateContentValue });\n\t\t\t}\n\t\t}\n\t}\n\n\t(codeEditor.getModel() as JSONModel).setProperty(\"/state\", stateValue);\n\n\tloadSupportLinksForElement(ui5Control);\n};\n\nFE.toggleElementInspector({ showElement });\n"],"mappings":"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","ignoreList":[],"sourceRoot":""}},{"offset":{"line":16,"column":0},"map":{"version":3,"names":["onMouseOver","e","target","closestUI5Elt","closest","isLocked","style","outline","inspector","showElement","UI5Element","getElementById","getAttribute","onKeyDown","ctrlKey","lastTarget","window","$fe","supportModel","getProperty","preventDefault","stopPropagation","stopImmediatePropagation","onMouseDown","onMouseClick","onMouseOut","isInspecting","toggleElementInspector","textRef","document","addEventListener","localInspector","showInspector","ui5Control","removeAllContent","addContent","_jsx","CodeEditor","type","height","value","serializeControlAsXML","removeEventListener","_exports","subInspector","Panel","width","headerText","expanded","children","content","Text","text","popup","Popup","open","Dock","EndBottom"],"sources":["./Inspector.tsx"],"sourcesContent":["import { serializeControlAsXML } from \"sap/fe/tools/XMLSerializer\";\nimport Panel from \"sap/m/Panel\";\nimport Text from \"sap/m/Text\";\nimport CodeEditor from \"sap/ui/codeeditor/CodeEditor\";\nimport UI5Element from \"sap/ui/core/Element\";\nimport Popup from \"sap/ui/core/Popup\";\n\nfunction onMouseOver(e: MouseEvent): void {\n\tconst target = e.target as HTMLElement | null;\n\tif (target) {\n\t\tconst closestUI5Elt = target.closest(\"[data-sap-ui]\");\n\t\tif (closestUI5Elt && !isLocked) {\n\t\t\t(closestUI5Elt as HTMLElement).style.outline = \"2px auto rebeccapurple\";\n\t\t\tinspector?.showElement(UI5Element.getElementById(closestUI5Elt.getAttribute(\"data-sap-ui\"))!);\n\t\t}\n\t}\n}\nfunction onKeyDown(e: KeyboardEvent): void {\n\tif (e.ctrlKey) {\n\t\tisLocked = !isLocked;\n\t\tif (isLocked) {\n\t\t\tconst target = e.target as HTMLElement | null;\n\t\t\tif (target) {\n\t\t\t\tconst closestUI5Elt = target.closest(\"[data-sap-ui]\");\n\t\t\t\tif (closestUI5Elt) {\n\t\t\t\t\t(closestUI5Elt as HTMLElement).style.outline = \"3px auto red\";\n\t\t\t\t\tlastTarget = closestUI5Elt as HTMLElement;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (lastTarget) {\n\t\t\tlastTarget.style.outline = \"none\";\n\t\t}\n\t\t// @ts-ignore\n\t\tif (window.$fe.supportModel.getProperty(\"/preventInteraction\")) {\n\t\t\te.preventDefault();\n\t\t\te.stopPropagation();\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t}\n}\nfunction onMouseDown(e: MouseEvent): void {\n\tisLocked = !isLocked;\n\tif (isLocked) {\n\t\tconst target = e.target as HTMLElement | null;\n\t\tif (target) {\n\t\t\tconst closestUI5Elt = target.closest(\"[data-sap-ui]\");\n\t\t\tif (closestUI5Elt) {\n\t\t\t\t(closestUI5Elt as HTMLElement).style.outline = \"3px auto red\";\n\t\t\t\tlastTarget = closestUI5Elt as HTMLElement;\n\t\t\t}\n\t\t}\n\t} else if (lastTarget) {\n\t\tlastTarget.style.outline = \"none\";\n\t}\n\t// @ts-ignore\n\tif (window.$fe.supportModel.getProperty(\"/preventInteraction\")) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\te.stopImmediatePropagation();\n\t}\n}\nfunction onMouseClick(e: MouseEvent): void {\n\t// @ts-ignore\n\tif (window.$fe.supportModel.getProperty(\"/preventInteraction\")) {\n\t\te.preventDefault();\n\t\te.stopPropagation();\n\t\te.stopImmediatePropagation();\n\t}\n}\nfunction onMouseOut(e: MouseEvent): void {\n\tconst target = e.target as HTMLElement | null;\n\tif (target && !isLocked) {\n\t\tconst closestUI5Elt = target.closest(\"[data-sap-ui]\");\n\t\tif (closestUI5Elt) {\n\t\t\t(closestUI5Elt as HTMLElement).style.outline = \"none\";\n\t\t}\n\t}\n}\nlet lastTarget: HTMLElement | null;\nlet isInspecting = false;\nlet isLocked = false;\nlet inspector: { showElement: (ui5Control: UI5Element) => void } | null = null;\nexport function toggleElementInspector(textRef: { showElement: (ui5Control: UI5Element) => void } | null): void {\n\tif (!isInspecting) {\n\t\tisInspecting = true;\n\t\tdocument.addEventListener(\"keydown\", onKeyDown);\n\t\tdocument.addEventListener(\"mousedown\", onMouseDown);\n\t\tdocument.addEventListener(\"mouseover\", onMouseOver);\n\t\tdocument.addEventListener(\"click\", onMouseClick);\n\t\tdocument.addEventListener(\"mouseout\", onMouseOut);\n\t\tif (!textRef) {\n\t\t\tconst localInspector = showInspector();\n\t\t\tinspector = {\n\t\t\t\tshowElement: function (ui5Control: UI5Element): void {\n\t\t\t\t\tlocalInspector.removeAllContent();\n\t\t\t\t\tlocalInspector.addContent(<CodeEditor type=\"XML\" height={\"500px\"} value={serializeControlAsXML(ui5Control)} />);\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\tinspector = textRef;\n\t\t}\n\t} else {\n\t\tdocument.removeEventListener(\"keydown\", onKeyDown);\n\t\tdocument.removeEventListener(\"mousedown\", onMouseDown);\n\t\tdocument.removeEventListener(\"mouseover\", onMouseOver);\n\t\tdocument.removeEventListener(\"click\", onMouseClick);\n\t\tdocument.removeEventListener(\"mouseout\", onMouseOut);\n\t\tisInspecting = false;\n\t}\n}\n\nfunction showInspector(): Panel {\n\tconst subInspector: Panel = (\n\t\t<Panel width=\"500px\" headerText=\"UI5 Element Inspector\" expanded={true}>\n\t\t\t{{\n\t\t\t\tcontent: <Text text=\"Hover over an element to inspect it\" />\n\t\t\t}}\n\t\t</Panel>\n\t);\n\tconst popup = new Popup(subInspector);\n\tpopup.open(Popup.Dock.EndBottom, Popup.Dock.EndBottom);\n\treturn subInspector;\n}\n"],"mappings":"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","ignoreList":[],"sourceRoot":""}},{"offset":{"line":21,"column":0},"map":{"version":3,"names":["instrumentODataModel","thisLib","cacheFn","ODataPropertyBinding","prototype","createAndSetCache","cacheFn2","ODataListBinding","cacheFn3","ODataContextBinding","fnRequest","_Requestor","request","_len","arguments","length","args","Array","_key","includes","cacheId","oOwner","oCache","__feCacheId","apply","this","createdCaches","that","_len2","_key2","cacheResult","__feBinding","mParameters","applyParametersFn","applyParameters","_len3","_key3","_len4","_key4","getRootBinding","changeParameters","instrumentUpdateBindings","updateBindingsFn","_len5","_key5","res","Object","keys","mBindingInfos","forEach","bindingInfoName","binding","__feSource","__feForProp","hasOwnProperty","defineProperty","get","visibleControl","getDomRef","getParent","aBindings","subBinding","__feInComposite","__feComposite","managedObjectBindingSupport","ManagedObjectBindingSupport","updateBindings","managedObjectSupport","ManagedObject","_len6","_key6","_len7","_key7","addODataTrace","_origXML","XMLHttpRequest","window","xhr","fnOpen","open","fnSend","send","fnSetRequestHeader","setRequestHeader","_len8","_key8","url","_len9","_key9","body","header","_len10","_key10","toLowerCase","addEventListener","e","target","responseURL","batchText","batchBoundary","split","batchRequest","parseBatch","BatchContent","responseBoundary","getResponseHeader","decodedContent","responseText","batchResponse","parts","part","partIndex","requestPart","data","supportModel","getProperty","urlObj","URL","urlParams","URLSearchParams","search","feTrace","requestParam","searchParams","value","key","push","urlBase","responseBody","JSON","stringify","responseBodyObj","parameters","trace","setProperty","refresh","_exports"],"sources":["./ODataTracer.ts"],"sourcesContent":["import { BatchContent, parseBatch } from \"sap/fe/tools/BatchParser\";\nimport ODataContextBinding from \"sap/ui/model/odata/v4/ODataContextBinding\";\nimport ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport ODataPropertyBinding from \"sap/ui/model/odata/v4/ODataPropertyBinding\";\n\nimport ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type Control from \"sap/ui/core/Control\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\n// @ts-ignore\nimport type ODataBinding from \"sap/ui/model/odata/v4/ODataBinding\";\n// @ts-ignore\nimport ManagedObjectBindingSupport from \"sap/ui/model/ManagedObjectBindingSupport\";\n// @ts-ignore\nimport _Requestor from \"sap/ui/model/odata/v4/lib/_Requestor\";\n\ntype RequestInfo = {\n\turl?: string;\n\tbody?: string;\n\theader?: Record<string, string>;\n};\ntype BindingDef = {\n\t__feSource: ManagedObject;\n\t__feForProp: string;\n\t__feInComposite?: boolean;\n\t__feComposite?: BindingDef;\n\tclosestDomRef: HTMLElement | null;\n\taBindings?: BindingDef[];\n};\nfunction instrumentODataModel(thisLib: any): void {\n\t// @ts-ignore\n\tconst cacheFn = ODataPropertyBinding.prototype.createAndSetCache;\n\t// @ts-ignore\n\tconst cacheFn2 = ODataListBinding.prototype.createAndSetCache;\n\t// @ts-ignore\n\tconst cacheFn3 = ODataContextBinding.prototype.createAndSetCache;\n\t// @ts-ignore\n\tconst fnRequest = _Requestor.prototype.request;\n\t// @ts-ignore\n\t_Requestor.prototype.request = function (...args: any[]): unknown {\n\t\tif (!args[1].includes(\"sap-valid-feTrace\")) {\n\t\t\tconst cacheId = args[2].oOwner.oCache?.__feCacheId;\n\t\t\tif (cacheId) {\n\t\t\t\tif (args[1].includes(\"?\")) {\n\t\t\t\t\targs[1] += `&sap-valid-feTrace=${cacheId}`;\n\t\t\t\t} else {\n\t\t\t\t\targs[1] += `?sap-valid-feTrace=${cacheId}`;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn fnRequest.apply(this, args);\n\t};\n\t//const adjustPredicateFn = ODataBinding.prototype.adjustPredicate;\n\t// @ts-ignore\n\t//const fetchCacheFn = ODataListBinding.prototype.fetchCache;\n\t//\tconst contextMakingRequest = [];\n\tlet cacheId = 0;\n\tconst createdCaches: Record<number, ODataBinding> = {};\n\t// // @ts-ignore\n\t// ODataListBinding.prototype.fetchCache = function() {\n\t// \ttry { throw new Error() } catch(e) {  }\n\t// \t// @ts-ignore\n\t// \tconst call = ODataListBinding.prototype.fetchCache.caller\n\t// \treturn fetchCacheFn.apply(this, arguments)\n\t// }\n\t// @ts-ignore\n\tODataListBinding.prototype.createAndSetCache = function (...args: never[]): unknown {\n\t\t// eslint-disable-next-line @typescript-eslint/no-this-alias\n\t\tconst that = this;\n\t\tconst cacheResult = cacheFn2.apply(this, args);\n\t\tcacheResult.__feBinding = that;\n\n\t\t// @ts-ignore\n\t\tif (!this.mParameters[\"sap-valid-feTrace\"]) {\n\t\t\tcacheResult.__feCacheId = cacheId++;\n\t\t\t// @ts-ignore\n\t\t\tthis.mParameters[\"sap-valid-feTrace\"] = cacheId++;\n\t\t\t//this.changeParameters({ \"sap-valid-feTrace\": cacheResult.__feCacheId });\n\t\t} else {\n\t\t\t// @ts-ignore\n\t\t\tcacheResult.__feCacheId = this.mParameters[\"sap-valid-feTrace\"];\n\t\t}\n\n\t\tcreatedCaches[cacheResult.__feCacheId] = cacheResult;\n\t\treturn cacheResult;\n\t};\n\t// @ts-ignore\n\tconst applyParametersFn = ODataContextBinding.prototype.applyParameters;\n\t// @ts-ignore\n\tODataContextBinding.prototype.applyParameters = function (mParameters: object): unknown {\n\t\t// @ts-ignore\n\t\tif (!mParameters[\"sap-valid-feTrace\"]) {\n\t\t\t// @ts-ignore\n\t\t\tmParameters[\"sap-valid-feTrace\"] = cacheId++;\n\t\t}\n\t\tapplyParametersFn.apply(this, [mParameters]);\n\t};\n\t// @ts-ignore\n\tODataContextBinding.prototype.createAndSetCache = function (...args: never[]): unknown {\n\t\t// eslint-disable-next-line @typescript-eslint/no-this-alias\n\t\tconst that = this;\n\t\tconst cacheResult = cacheFn3.apply(this, args);\n\t\tcacheResult.__feBinding = that;\n\n\t\t// @ts-ignore\n\t\tcacheResult.__feCacheId = this.mParameters[\"sap-valid-feTrace\"];\n\t\tcreatedCaches[cacheResult.__feCacheId] = cacheResult;\n\t\treturn cacheResult;\n\t};\n\t// @ts-ignore\n\tODataPropertyBinding.prototype.createAndSetCache = function (...args: never[]): unknown {\n\t\t// eslint-disable-next-line @typescript-eslint/no-this-alias\n\t\tconst that = this;\n\t\tconst cacheResult = cacheFn.apply(this, args);\n\t\tcacheResult.__feBinding = that;\n\n\t\tif (this.getRootBinding() === this) {\n\t\t\treturn cacheResult;\n\t\t}\n\t\t// @ts-ignore\n\t\tif (!this.getRootBinding().mParameters?.[\"sap-valid-feTrace\"]) {\n\t\t\tcacheResult.__feCacheId = cacheId++;\n\t\t\t(this.getRootBinding() as ODataContextBinding).changeParameters({ \"sap-valid-feTrace\": cacheResult.__feCacheId });\n\t\t} else {\n\t\t\t// @ts-ignore\n\t\t\tcacheResult.__feCacheId = this.getRootBinding().mParameters[\"sap-valid-feTrace\"];\n\t\t}\n\n\t\tcreatedCaches[cacheResult.__feCacheId] = cacheResult;\n\t\treturn cacheResult;\n\t};\n\n\tconst instrumentUpdateBindings = function (updateBindingsFn: Function): Function {\n\t\treturn function (this: any, ...args: never[]): void {\n\t\t\tconst res = updateBindingsFn.apply(this, args);\n\t\t\tObject.keys(this.mBindingInfos).forEach((bindingInfoName) => {\n\t\t\t\tif (this.mBindingInfos[bindingInfoName].binding) {\n\t\t\t\t\tthis.mBindingInfos[bindingInfoName].binding.__feSource = this;\n\t\t\t\t\tthis.mBindingInfos[bindingInfoName].binding.__feForProp = bindingInfoName;\n\t\t\t\t\tif (!this.mBindingInfos[bindingInfoName].binding.hasOwnProperty(\"closestDomRef\")) {\n\t\t\t\t\t\tObject.defineProperty(this.mBindingInfos[bindingInfoName].binding, \"closestDomRef\", {\n\t\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\t\tlet visibleControl: Control = this.__feSource as Control;\n\t\t\t\t\t\t\t\twhile (visibleControl && visibleControl.getDomRef && !visibleControl.getDomRef()) {\n\t\t\t\t\t\t\t\t\tvisibleControl = visibleControl.getParent() as Control;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn visibleControl?.getDomRef && visibleControl.getDomRef();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t\tif (this.mBindingInfos[bindingInfoName].binding.aBindings) {\n\t\t\t\t\t\tthis.mBindingInfos[bindingInfoName].binding.aBindings.forEach((subBinding: BindingDef) => {\n\t\t\t\t\t\t\tsubBinding.__feSource = this;\n\t\t\t\t\t\t\tsubBinding.__feInComposite = true;\n\t\t\t\t\t\t\tsubBinding.__feForProp = bindingInfoName;\n\t\t\t\t\t\t\tsubBinding.__feComposite = this.mBindingInfos[bindingInfoName].binding;\n\t\t\t\t\t\t\tif (!subBinding.hasOwnProperty(\"closestDomRef\")) {\n\t\t\t\t\t\t\t\tObject.defineProperty(subBinding, \"closestDomRef\", {\n\t\t\t\t\t\t\t\t\tget: function () {\n\t\t\t\t\t\t\t\t\t\tlet visibleControl: Control | undefined = this.__feSource;\n\t\t\t\t\t\t\t\t\t\twhile (visibleControl && visibleControl.getDomRef && !visibleControl.getDomRef()) {\n\t\t\t\t\t\t\t\t\t\t\tvisibleControl = visibleControl.getParent() as Control | undefined;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn visibleControl?.getDomRef && visibleControl.getDomRef();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn res;\n\t\t};\n\t};\n\n\tconst managedObjectBindingSupport = ManagedObjectBindingSupport.updateBindings;\n\t// @ts-ignore\n\tconst managedObjectSupport = ManagedObject.prototype.updateBindings;\n\tManagedObjectBindingSupport.updateBindings = function (...args: never[]): unknown {\n\t\treturn instrumentUpdateBindings(managedObjectBindingSupport).apply(this, args);\n\t};\n\t// @ts-ignore\n\tManagedObject.prototype.updateBindings = function (...args: never[]): unknown {\n\t\treturn instrumentUpdateBindings(managedObjectSupport).apply(this, args);\n\t};\n\tthisLib.createdCaches = createdCaches;\n}\nexport function addODataTrace(thisLib: { supportModel: JSONModel }): void {\n\tinstrumentODataModel(thisLib);\n\tconst _origXML = XMLHttpRequest;\n\t// @ts-ignore\n\twindow.XMLHttpRequest = function (): XMLHttpRequest {\n\t\tconst xhr = new _origXML();\n\t\tconst fnOpen = xhr.open;\n\t\tconst fnSend = xhr.send;\n\t\tconst fnSetRequestHeader = xhr.setRequestHeader;\n\t\txhr.open = function (this: XMLHttpRequest & { request?: RequestInfo }, ...args: never[]): void {\n\t\t\tthis.request ??= {};\n\t\t\tthis.request.url = args[1];\n\t\t\t// @ts-ignore\n\t\t\tfnOpen.apply(this, args);\n\t\t};\n\t\txhr.send = function (this: XMLHttpRequest & { request?: RequestInfo }, ...args: never[]): void {\n\t\t\tthis.request ??= {};\n\t\t\tthis.request.body = args[0];\n\t\t\t// @ts-ignore\n\t\t\tfnSend.apply(this, args);\n\t\t};\n\t\txhr.setRequestHeader = function (this: XMLHttpRequest & { request?: RequestInfo }, ...args: never[]): void {\n\t\t\tthis.request ??= {};\n\t\t\tthis.request.header ??= {};\n\t\t\tthis.request.header[(args[0] as string).toLowerCase()] = args[1];\n\t\t\t// @ts-ignore\n\t\t\tfnSetRequestHeader.apply(this, args);\n\t\t};\n\t\txhr.addEventListener(\n\t\t\t\"load\",\n\t\t\tfunction (this: XMLHttpRequest & { request?: RequestInfo }, e: ProgressEvent<XMLHttpRequestEventTarget>): void {\n\t\t\t\tif ((e.target as XMLHttpRequest).responseURL.includes(\"$batch\")) {\n\t\t\t\t\tconst batchText = this.request!.body!;\n\t\t\t\t\tconst batchBoundary = this.request!.header![\"content-type\"].split(\"boundary=\")[1];\n\t\t\t\t\tconst batchRequest = parseBatch(new BatchContent(batchText), batchBoundary);\n\t\t\t\t\tconst responseBoundary = (e.target as XMLHttpRequest).getResponseHeader(\"content-type\")!.split(\"boundary=\")[1];\n\n\t\t\t\t\tconst decodedContent = (e.target as XMLHttpRequest).responseText;\n\t\t\t\t\tconst batchResponse = parseBatch(new BatchContent(decodedContent), responseBoundary);\n\t\t\t\t\tbatchResponse.parts.forEach((part: any, partIndex: number) => {\n\t\t\t\t\t\tconst requestPart = batchRequest.parts[partIndex];\n\t\t\t\t\t\tconst data = thisLib.supportModel.getProperty(\"/data\");\n\t\t\t\t\t\tconst urlObj = new URL(`http://example.com/${requestPart.url}`);\n\t\t\t\t\t\tconst urlParams = new URLSearchParams(urlObj.search);\n\t\t\t\t\t\tconst feTrace = urlParams.get(\"sap-valid-feTrace\");\n\t\t\t\t\t\tconst requestParam: Record<string, string> = {};\n\t\t\t\t\t\turlObj.searchParams.forEach((value, key) => {\n\t\t\t\t\t\t\trequestParam[key] = value;\n\t\t\t\t\t\t});\n\t\t\t\t\t\tdata.push({\n\t\t\t\t\t\t\turlBase: requestPart.url.split(\"?\")[0],\n\t\t\t\t\t\t\trequest: requestPart,\n\t\t\t\t\t\t\tresponseBody: JSON.stringify(part.body, null, 4),\n\t\t\t\t\t\t\tresponseBodyObj: part.body,\n\t\t\t\t\t\t\tparameters: JSON.stringify(requestParam, null, 4),\n\t\t\t\t\t\t\ttrace: feTrace\n\t\t\t\t\t\t});\n\t\t\t\t\t\tthisLib.supportModel.setProperty(\"/data\", data);\n\t\t\t\t\t\tthisLib.supportModel.refresh();\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t);\n\n\t\treturn xhr;\n\t};\n}\n"],"mappings":"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","ignoreList":[],"sourceRoot":""}},{"offset":{"line":26,"column":0},"map":{"version":3,"names":["FE","window","opener","$fe","supportLinkTimeout","supportLinksModel","supportLinkFunction","getMetaPath","_element","element","isA","viewData","getViewData","contextPath","entitySet","mainPropertyRelativePath","annotatedActionIdentifier","getCustomData","find","data","getKey","getValue","split","pop","metaPath","getParent","loadSupportLinks","async","model","supportModel","odataModel","getModel","setProperty","serviceRoot","getServiceUrl","startsWith","url","URL","pathname","useBackendUrl","URLSearchParams","location","search","get","proxy","backendUrl","protocol","replace","hostname","port","metaModel","getMetaModel","supportLinkAnnotations","getObject","resolvedUrl","Url","supportLinkServiceUrl","ODataModel","serviceUrl","requestObject","error","FunctionImport","functionCall","bindContext","cacheToken","join","cachedRequests","getProperty","setParameter","execute","links","getBoundContext","value","link","_exports","loadSupportLinksForElement","debounce","func","delay","_len","arguments","length","args","Array","_key","undefined","clearTimeout","setTimeout","debouncedGetSupportLinks"],"sources":["./SupportLinks.ts"],"sourcesContent":["import type { ViewData } from \"sap/fe/core/services/TemplatedViewServiceFactory\";\nimport type Field from \"sap/fe/macros/Field\";\nimport type TableAPI from \"sap/fe/macros/table/TableAPI\";\nimport type Button from \"sap/m/Button\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\n\n// @ts-ignore\nconst FE = window?.opener?.$fe ?? window?.$fe;\n\nlet supportLinkTimeout: number | undefined;\nlet supportLinksModel: ODataModel | undefined;\nlet supportLinkFunction: string | undefined;\nconst getMetaPath = function (_element: UI5Element): string | undefined {\n\tlet element: UI5Element | null | ManagedObject = _element;\n\twhile (element) {\n\t\tif (element.isA<View>(\"sap.ui.core.mvc.View\")) {\n\t\t\tconst viewData = element.getViewData() as ViewData | undefined;\n\t\t\treturn viewData?.contextPath || \"/\" + viewData?.entitySet;\n\t\t} else if (element.isA<Field>(\"sap.fe.macros.Field\")) {\n\t\t\treturn element.contextPath + \"/\" + element.mainPropertyRelativePath;\n\t\t} else if (element.isA<Button>(\"sap.m.Button\")) {\n\t\t\t// That's just an ugly POC to get the action name, we need to find a better way\n\t\t\tconst annotatedActionIdentifier = element\n\t\t\t\t.getCustomData()\n\t\t\t\t?.find((data) => data.getKey() === \"annotatedActionIdentifier\")\n\t\t\t\t?.getValue();\n\t\t\tif (annotatedActionIdentifier) {\n\t\t\t\treturn annotatedActionIdentifier.split(\"::\")[1].split(\".\").pop();\n\t\t\t}\n\t\t} else if (element.isA<TableAPI>(\"sap.fe.macros.table.TableAPI\")) {\n\t\t\treturn element.metaPath.split(\"/@\")[0];\n\t\t}\n\t\telement = element.getParent();\n\t}\n\treturn;\n};\n\nexport const loadSupportLinks = async function (element: UI5Element): Promise<void> {\n\tconst model = FE.supportModel;\n\tconst odataModel = element.getModel() as ODataModel | undefined;\n\tif (!odataModel) {\n\t\treturn;\n\t}\n\tmodel.setProperty(\"/supportLinksStateText\", \"Loading...\");\n\tlet serviceRoot = odataModel.getServiceUrl();\n\n\tif (!serviceRoot.startsWith(\"/\")) {\n\t\t// in a local scenario, the service URL also contains the host and port, we need to remove it\n\t\tconst url = new URL(serviceRoot);\n\t\tserviceRoot = url.pathname;\n\t}\n\n\t// create model to read the service\n\tif (!supportLinksModel) {\n\t\tconst useBackendUrl = new URLSearchParams(window.location.search).get(\"useBackendUrl\");\n\t\tlet proxy = \"\";\n\t\tif (useBackendUrl) {\n\t\t\tconst backendUrl = new URL(useBackendUrl);\n\t\t\tproxy = `/databinding/proxy/${backendUrl.protocol.replace(\":\", \"\")}/${backendUrl.hostname}:${backendUrl.port}`;\n\t\t}\n\n\t\tconst metaModel = odataModel.getMetaModel();\n\t\t// annotations not yet finalized / merged\n\t\ttype SupportLinkAnnotations = {\n\t\t\tFunctionImport: string;\n\t\t\tUrl: string;\n\t\t};\n\n\t\tconst supportLinkAnnotations = metaModel.getObject(\"/@com.sap.vocabularies.Support.v1.TechnicalInfoLinks\") as\n\t\t\t| SupportLinkAnnotations\n\t\t\t| undefined;\n\t\tif (!supportLinkAnnotations) {\n\t\t\tmodel.setProperty(\"/supportLinksStateText\", \"Service links not implemented for this application\");\n\t\t\treturn;\n\t\t}\n\n\t\tconst resolvedUrl = new URL(supportLinkAnnotations.Url, `http://dummy${serviceRoot}`).pathname;\n\t\tconst supportLinkServiceUrl = resolvedUrl.replace(/\\/\\$metadata$/, \"/\");\n\t\tsupportLinksModel = new ODataModel({ serviceUrl: `${proxy}${supportLinkServiceUrl}` });\n\n\t\ttry {\n\t\t\tawait supportLinksModel.getMetaModel().requestObject(\"/\");\n\t\t} catch (error) {\n\t\t\tmodel.setProperty(\"/supportLinksStateText\", \"System/Application does not provide service implementation information\");\n\t\t\treturn;\n\t\t}\n\n\t\tsupportLinkFunction = supportLinkAnnotations.FunctionImport;\n\t}\n\n\tif (!supportLinkFunction) {\n\t\treturn;\n\t}\n\n\tconst metaPath = getMetaPath(element);\n\n\tif (metaPath) {\n\t\tconst functionCall = supportLinksModel.bindContext(`/${supportLinkFunction}(...)`);\n\t\tconst cacheToken = metaPath.split(\"/\").join(\"_\");\n\t\tconst cachedRequests = model.getProperty(\"/cachedSupportLinks/\" + cacheToken);\n\n\t\tif (cachedRequests) {\n\t\t\tmodel.setProperty(\"/supportLinks\", cachedRequests);\n\t\t} else {\n\t\t\t// finally call the service\n\t\t\tfunctionCall.setParameter(\"ServiceRoot\", serviceRoot);\n\t\t\tfunctionCall.setParameter(\"EdmPath\", metaPath.replace(/^\\//, \"\")); // without leading slash\n\t\t\ttry {\n\t\t\t\tawait functionCall.execute(\"$auto\");\n\t\t\t\tconst links = functionCall.getBoundContext().getObject().value;\n\t\t\t\tfor (const link of links) {\n\t\t\t\t\tif (link.Url?.startsWith(\"../\")) {\n\t\t\t\t\t\t// relative URL, we need to resolve it\n\t\t\t\t\t\tlink.Url = new URL(link.Url, `http://dummy${supportLinksModel.getServiceUrl()}`).pathname;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tmodel.setProperty(\"/supportLinks\", links);\n\t\t\t\tmodel.setProperty(\"/cachedSupportLinks/\" + cacheToken, links);\n\t\t\t} catch (error) {\n\t\t\t\tmodel.setProperty(\"/supportLinks\", []);\n\t\t\t\tmodel.setProperty(\"/supportLinksStateText\", \"Failed to load service implementation links\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\tmodel.setProperty(\"/supportLinksStateText\", \"No service implementation links were found\");\n};\n\nexport const loadSupportLinksForElement = function (element: UI5Element): void {\n\t// debounce the call and only request if the user stays on a control for a while\n\tconst debounce = (func: Function, delay: number) => {\n\t\treturn function (...args: any[]) {\n\t\t\tif (supportLinkTimeout !== undefined) {\n\t\t\t\tclearTimeout(supportLinkTimeout);\n\t\t\t}\n\t\t\tsupportLinkTimeout = window.setTimeout(() => {\n\t\t\t\tfunc(...args);\n\t\t\t}, delay);\n\t\t};\n\t};\n\tconst debouncedGetSupportLinks = debounce(loadSupportLinks, 500);\n\tdebouncedGetSupportLinks(element);\n};\n"],"mappings":"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","ignoreList":[],"sourceRoot":""}},{"offset":{"line":31,"column":0},"map":{"version":3,"names":["openPopup","myWin","window","open","ui5Url","sap","ui","require","toUrl","document","write","close","onInit","codeData","loader","_","getModuleContent","Array","isArray","define","codeData2","_InfoSupportTool","onunload","_exports"],"sources":["./SupportPopup.tsx"],"sourcesContent":["export function openPopup(): void {\n\tconst myWin = window.open(\"\", \"_blank\", \"popup,toolbar=no,width=800,height=800\");\n\tif (myWin) {\n\t\tconst ui5Url = sap.ui.require.toUrl(\"sap-ui-core.js\");\n\t\tmyWin.document.write(`<html>\n\t\t\t<head>\n\t\t\t\t<meta charset=\"utf-8\">\n\t\t\t\t<title>FE Diagnostics</title>\n\t\t\t\t<script id=\"sap-ui-bootstrap\"\n\t\t\t\t\tsrc=\"${ui5Url}\"\n\t\t\t\t\tdata-sap-ui-async=\"true\"\n\t\t\t\t\tdata-sap-ui-oninit=\"onInit\"\n\t\t\t\t\tdata-sap-ui-compatVersion=\"edge\"\n\t\t\t\t\tdata-sap-ui-libs=\"sap.ui.core\"\n\t\t\t\t\tdata-sap-ui-theme=\"sap_horizon\">\n\t\t\t\t</script>\n\n\t\t\t\t<style>\n\t\t\t\t\t.sapUiSupportBody {\n\t\t\t\t\t\tmargin: 0;\n\t\t\t\t\t\tfont-family: var(--sapFontFamily);\n\t\t\t\t\t}\n\t\t\t\t\t.sapUiSupportBody .sapMITBContent {\n\t\t\t\t\t\tpadding: 0;\n\t\t\t\t\t}\n\t\t\t\t\t.feRequestList {\n\t\t\t\t\t\tmax-width: 500px;\n\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t\toverflow: scroll;\n\t\t\t\t\t}\n\t\t\t\t\t.feRequestHBox {\n\t\t\t\t\t\theight: 100%;\n\t\t\t\t\t}\n\t\t\t\t</style>\n\t\t\t\t</head>\n\t\t\t\t<body class=\"sapUiSupportBody\">\n\t\t\t\t\t<div id=\"sapUiSupportBody\">\n\n\t\t\t\t\t</div>\n\t\t\t\t</body>\n\t\t\t</html>`);\n\n\t\tmyWin.document.close();\n\t\t// @ts-ignore\n\t\tmyWin.window.onInit = function (): void {\n\t\t\t// @ts-ignore\n\t\t\tconst codeData = window.sap.ui.loader._.getModuleContent(\"sap/fe/tools/XMLSerializer.js\");\n\t\t\tif (Array.isArray(codeData)) {\n\t\t\t\t// @ts-ignore\n\t\t\t\tmyWin.sap.ui.define(codeData[0], codeData[1], codeData[2]);\n\t\t\t}\n\t\t\t// @ts-ignore\n\t\t\tconst codeData2 = window.sap.ui.loader._.getModuleContent(\"sap/fe/tools/InfoSupportTool.js\");\n\t\t\tif (Array.isArray(codeData2)) {\n\t\t\t\t// @ts-ignore\n\t\t\t\tmyWin.sap.ui.define(codeData2[0], codeData2[1], codeData2[2]);\n\t\t\t}\n\t\t\t// @ts-ignore\n\t\t\tmyWin.sap.ui.require([\"sap/fe/tools/InfoSupportTool\"], function (_InfoSupportTool: any): void {});\n\t\t};\n\t\twindow.onunload = function (): void {\n\t\t\tmyWin.close();\n\t\t};\n\t}\n}\n"],"mappings":"AAAA;;;;kFAAO,SAASA,IACf,MAAMC,EAAQC,OAAOC,KAAK,GAAI,SAAU,yCACxC,GAAIF,EAAO,CACV,MAAMG,EAASC,IAAIC,GAAGC,QAAQC,MAAM,kBACpCP,EAAMQ,SAASC,MAAM,sJAKXN,gzBAiCVH,EAAMQ,SAASE,QAEfV,EAAMC,OAAOU,OAAS,WAErB,MAAMC,EAAWX,OAAOG,IAAIC,GAAGQ,OAAOC,EAAEC,iBAAiB,iCACzD,GAAIC,MAAMC,QAAQL,GAAW,CAE5BZ,EAAMI,IAAIC,GAAGa,OAAON,EAAS,GAAIA,EAAS,GAAIA,EAAS,GACxD,CAEA,MAAMO,EAAYlB,OAAOG,IAAIC,GAAGQ,OAAOC,EAAEC,iBAAiB,mCAC1D,GAAIC,MAAMC,QAAQE,GAAY,CAE7BnB,EAAMI,IAAIC,GAAGa,OAAOC,EAAU,GAAIA,EAAU,GAAIA,EAAU,GAC3D,CAEAnB,EAAMI,IAAIC,GAAGC,QAAQ,CAAC,gCAAiC,SAAUc,GAA8B,EAChG,EACAnB,OAAOoB,SAAW,WACjBrB,EAAMU,OACP,CACD,CACD,CAACY,EAAAvB,YAAA,OAAAuB,CAAA","ignoreList":[],"sourceRoot":""}},{"offset":{"line":36,"column":0},"map":{"version":3,"names":["nameSpaceMap","macro","macros","feBB","macroField","macrodata","log","customData","control","controls","core","dt","m","f","fl","internalMacro","mdc","actiontoolbar","mdcField","mdcTable","u","uxap","macroMicroChart","microChart","macroTable","mdcvc","mdcv","valueHelp","contentSwitcher","filterBar","draftIndicator","visualFilter","reveseNamespaceMap","Object","keys","reduce","reverseMap","currentName","escapeXMLAttributeValue","value","replace","_exports","serializeObject","objectType","maxDepth","arguments","length","undefined","out","map","key","filter","val","join","serializeControlAsXML","controlToSerialize","showCustomStyleClasses","asString","tabCount","UID","CONTROLID","definedNamespaces","getNamespaceAlias","className","namesSplit","split","namespace","slice","namespaceAlias","toLowerCase","getTab","toAdd","tab","i","serializeDelegate","start","sAggregationName","controlDetail","getParent","indexInParent","getAggregation","indexOf","nameFull","getMetadata","getName","name","end","hasAggregation","mAggregations","getAllAggregations","mAggregationsKey","controlAggregation","_sGetter","Array","isArray","getBindingPath","getBindingInfo","template","middle","id","getId","data","mProperties","concat","mBindingInfos","mAssociations","mEventRegistry","sort","a","b","localeCompare","uniqueKeys","Set","from","oControlKey","hasOwnProperty","bindingDetail","bindingString","type","oOutputFormat","binding","propertyValue","e","associationValue","associationValueElement","fFunction","aCustomStyleClasses","startAggregation","sName","startsWith","substring","endAggregation","outXML","controlToRender","Serializer","serialize","xmlString","parser","DOMParser","parseFromString","firstElementChild","outerHTML","async","serializeControlAsFormattedXML","ui5ControlOrBB","serialized"],"sources":["./XMLSerializer.tsx"],"sourcesContent":["import type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type Control from \"sap/ui/core/Control\";\nimport type UI5Element from \"sap/ui/core/Element\";\n// @ts-ignore\nimport Serializer from \"sap/ui/core/util/serializer/Serializer\";\n\nconst nameSpaceMap: Record<string, string> = {\n\tmacro: \"sap.fe.macros\",\n\tmacros: \"sap.fe.macros\",\n\tfeBB: \"sap.fe.core.buildingBlocks.templating\",\n\tmacroField: \"sap.fe.macros.field\",\n\tmacrodata: \"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\",\n\tlog: \"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\",\n\tcustomData: \"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\",\n\tcontrol: \"sap.fe.core.controls\",\n\tcontrols: \"sap.fe.macros.controls\",\n\tcore: \"sap.ui.core\",\n\tdt: \"sap.ui.dt\",\n\tm: \"sap.m\",\n\tf: \"sap.ui.layout.form\",\n\tfl: \"sap.ui.fl\",\n\tinternalMacro: \"sap.fe.macros.internal\",\n\tmdc: \"sap.ui.mdc\",\n\tactiontoolbar: \"sap.ui.mdc.actiontoolbar\",\n\tmdcField: \"sap.ui.mdc.field\",\n\tmdcTable: \"sap.ui.mdc.table\",\n\tu: \"sap.ui.unified\",\n\tuxap: \"sap.uxap\",\n\tmacroMicroChart: \"sap.fe.macros.microchart\",\n\tmicroChart: \"sap.suite.ui.microchart\",\n\tmacroTable: \"sap.fe.macros.table\",\n\tmdcvc: \"sap.ui.mdc.valuehelp.content\",\n\tmdcv: \"sap.ui.mdc.valuehelp\",\n\tvalueHelp: \"sap.fe.macros.valueHelp\",\n\tcontentSwitcher: \"sap.fe.macros.contentSwitcher\",\n\tfilterBar: \"sap.fe.macros.filterBar\",\n\tdraftIndicator: \"sap.fe.macros.draftIndicator\",\n\tvisualFilter: \"sap.fe.macros.visualFilters\"\n};\nconst reveseNamespaceMap = Object.keys(nameSpaceMap).reduce((reverseMap: Record<string, string>, currentName) => {\n\treverseMap[nameSpaceMap[currentName]] = currentName;\n\treturn reverseMap;\n}, {});\n\nexport function escapeXMLAttributeValue(value?: string): string | undefined {\n\treturn value?.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&apos;\");\n}\n\nfunction serializeObject(objectType: object, maxDepth: int = 3): string | undefined {\n\tif (maxDepth == 0) return undefined;\n\tif (!objectType) {\n\t\treturn undefined;\n\t}\n\tconst keys = Object.keys(objectType);\n\tconst out: string[] = keys.map((key) => {\n\t\tconst value: never = objectType[key as keyof typeof objectType] as unknown as never;\n\t\tif (typeof value === \"function\") {\n\t\t\treturn \"\";\n\t\t} else if (typeof value === \"object\") {\n\t\t\treturn `${key}: ${serializeObject(value, maxDepth - 1)}`;\n\t\t} else {\n\t\t\treturn `${key}: ${value}`;\n\t\t}\n\t});\n\treturn out.filter((val) => val.length).join(\", \");\n}\nexport function serializeControlAsXML(\n\tcontrolToSerialize?: UI5Element | UI5Element[],\n\tshowCustomStyleClasses = false,\n\tasString = false\n): string {\n\tlet tabCount = 0;\n\tconst UID = /uid--id-\\d{13}-\\d{1,3}/;\n\tconst CONTROLID = /id-\\d{13}-\\d{1,3}/;\n\tconst definedNamespaces: Record<string, boolean> = {};\n\n\tfunction getNamespaceAlias(className: string): string {\n\t\tconst namesSplit = className.split(\".\");\n\t\tconst namespace = namesSplit.slice(0, -1);\n\t\tlet namespaceAlias = namespace[namespace.length - 1];\n\t\tif (reveseNamespaceMap[namespace.join(\".\")]) {\n\t\t\tnamespaceAlias = reveseNamespaceMap[namespace.join(\".\")];\n\t\t}\n\t\tif (namespaceAlias === undefined) {\n\t\t\tnamespaceAlias = \"test\";\n\t\t}\n\t\treturn namespaceAlias.toLowerCase();\n\t}\n\n\tfunction getTab(toAdd = 0): string {\n\t\tlet tab = \"\";\n\t\tfor (let i = 0; i < tabCount + toAdd; i++) {\n\t\t\ttab += \"\\t\";\n\t\t}\n\t\treturn tab;\n\t}\n\tconst serializeDelegate = {\n\t\tstart: function (control: Control, sAggregationName: string): string {\n\t\t\tlet controlDetail = \"\";\n\t\t\tif (sAggregationName) {\n\t\t\t\tif (control.getParent()) {\n\t\t\t\t\tconst indexInParent = (control.getParent()!.getAggregation(sAggregationName) as ManagedObject[])?.indexOf?.(control);\n\t\t\t\t\tif (indexInParent > 0) {\n\t\t\t\t\t\tcontrolDetail += `\\n${getTab()}`;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst nameFull = control.getMetadata().getName();\n\t\t\tconst namesSplit = nameFull.split(\".\");\n\t\t\tconst name = namesSplit[namesSplit.length - 1];\n\t\t\tconst namespaceAlias = getNamespaceAlias(nameFull);\n\t\t\tcontrolDetail += `<${namespaceAlias}:${name}\\n`;\n\t\t\t//if (!definedNamespaces[namespaceAlias]) {\n\t\t\tdefinedNamespaces[namespaceAlias] = true;\n\t\t\tcontrolDetail += `${getTab()}xmlns:${namespaceAlias}=\"${nameSpaceMap[namespaceAlias]}\"`;\n\t\t\t//}\n\t\t\treturn controlDetail;\n\t\t},\n\t\tend: function (control: any): string {\n\t\t\tconst nameFull = control.getMetadata().getName();\n\t\t\tconst namesSplit = nameFull.split(\".\");\n\t\t\tconst name = namesSplit[namesSplit.length - 1];\n\t\t\tconst namespaceAlias = getNamespaceAlias(nameFull);\n\t\t\tlet hasAggregation = false;\n\t\t\tconst mAggregations = control.getMetadata().getAllAggregations();\n\t\t\tfor (const mAggregationsKey in mAggregations) {\n\t\t\t\tconst controlAggregation = control[mAggregations[mAggregationsKey]._sGetter]();\n\t\t\t\tif (\n\t\t\t\t\t(!Array.isArray(controlAggregation) && controlAggregation !== null && controlAggregation !== undefined) ||\n\t\t\t\t\t(Array.isArray(controlAggregation) && controlAggregation.length > 0)\n\t\t\t\t) {\n\t\t\t\t\thasAggregation = true;\n\t\t\t\t}\n\t\t\t\tif (control.getBindingPath(mAggregationsKey) && control.getBindingInfo(mAggregationsKey).template) {\n\t\t\t\t\thasAggregation = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hasAggregation) {\n\t\t\t\treturn `</${namespaceAlias}:${name}>`;\n\t\t\t} else {\n\t\t\t\treturn `/>`;\n\t\t\t}\n\t\t},\n\t\tmiddle: function (control: any): string {\n\t\t\tlet id = control.getId();\n\t\t\tid = typeof id === \"string\" ? id?.replace?.(CONTROLID, \"id\") : id;\n\t\t\tlet data = \"\";\n\t\t\t//if (!ManagedObjectMetadata.isGeneratedId(id)) {\n\t\t\tdata = ` id=\"${id}\"`;\n\t\t\t//}\n\t\t\tlet keys = Object.keys(control.mProperties)\n\t\t\t\t.concat(Object.keys(control.mBindingInfos))\n\t\t\t\t.concat(Object.keys(control.mAssociations))\n\t\t\t\t.concat(Object.keys(control.mEventRegistry));\n\t\t\tkeys = keys.sort((a, b) => a.localeCompare(b));\n\t\t\tconst uniqueKeys = new Set(keys);\n\t\t\tkeys = Array.from(uniqueKeys);\n\t\t\tfor (const oControlKey of keys) {\n\t\t\t\tif (oControlKey !== \"id\") {\n\t\t\t\t\tif (control.mBindingInfos.hasOwnProperty(oControlKey)) {\n\t\t\t\t\t\tconst bindingDetail = { ...control.mBindingInfos[oControlKey] };\n\t\t\t\t\t\tif (bindingDetail.bindingString) {\n\t\t\t\t\t\t\tdata += `\\n${getTab()}${oControlKey}=\"${escapeXMLAttributeValue(bindingDetail.bindingString)}\"`;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif (bindingDetail.type?.oOutputFormat) {\n\t\t\t\t\t\t\t\tdelete bindingDetail.type.oOutputFormat;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (bindingDetail.binding) {\n\t\t\t\t\t\t\t\tdelete bindingDetail.binding;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (bindingDetail.template) {\n\t\t\t\t\t\t\t\tdelete bindingDetail.template;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdata += `\\n${getTab()}${oControlKey}='${escapeXMLAttributeValue(serializeObject(bindingDetail))}'`;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (control.mProperties.hasOwnProperty(oControlKey) && control.mProperties[oControlKey] !== undefined) {\n\t\t\t\t\t\tlet propertyValue = control.mProperties[oControlKey];\n\t\t\t\t\t\tpropertyValue = typeof propertyValue === \"string\" ? propertyValue?.replace?.(UID, \"uid--id\") : propertyValue;\n\t\t\t\t\t\tpropertyValue = typeof propertyValue === \"string\" ? propertyValue?.replace?.(CONTROLID, \"id\") : propertyValue;\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tpropertyValue =\n\t\t\t\t\t\t\t\ttypeof propertyValue === \"object\"\n\t\t\t\t\t\t\t\t\t? escapeXMLAttributeValue(serializeObject(propertyValue))\n\t\t\t\t\t\t\t\t\t: escapeXMLAttributeValue(propertyValue);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t// Stringify may fail for circular references but it's not the end of the world\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdata += `\\n${getTab()} ${oControlKey}=\"${propertyValue}\"`;\n\t\t\t\t\t} else if (control.mAssociations.hasOwnProperty(oControlKey)) {\n\t\t\t\t\t\tlet associationValue = control.mAssociations[oControlKey];\n\t\t\t\t\t\tif (!Array.isArray(associationValue)) {\n\t\t\t\t\t\t\tassociationValue = [associationValue];\n\t\t\t\t\t\t}\n\t\t\t\t\t\tassociationValue = associationValue.map((associationValueElement: string) => {\n\t\t\t\t\t\t\treturn typeof associationValueElement === \"string\"\n\t\t\t\t\t\t\t\t? associationValueElement?.replace?.(CONTROLID, \"id\")\n\t\t\t\t\t\t\t\t: associationValueElement;\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tdata += `\\n${getTab()} ${oControlKey}=\"${(associationValue?.join?.(\",\") ?? associationValue) || undefined}\"`;\n\t\t\t\t\t} else if (control.mEventRegistry.hasOwnProperty(oControlKey)) {\n\t\t\t\t\t\tif (control.mEventRegistry[oControlKey][0]?.fFunction?.name) {\n\t\t\t\t\t\t\tdata += `\\n${getTab()} ${oControlKey}=\"${control.mEventRegistry[oControlKey][0]?.fFunction?.name}\"`;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tdata += `\\n${getTab()} ${oControlKey}=\"someEventHandler\"`;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (showCustomStyleClasses && control.aCustomStyleClasses?.length > 0) {\n\t\t\t\tdata += `\\n${getTab()} customStyleClasses : ${control.aCustomStyleClasses.join(\", \")}`;\n\t\t\t}\n\t\t\tdata += `\\n`;\n\t\t\tlet hasAggregation = false;\n\t\t\tconst mAggregations = control.getMetadata().getAllAggregations();\n\t\t\tfor (const mAggregationsKey in mAggregations) {\n\t\t\t\tconst controlAggregation = control[mAggregations[mAggregationsKey]._sGetter]();\n\t\t\t\tif (\n\t\t\t\t\t(!Array.isArray(controlAggregation) && controlAggregation !== null && controlAggregation !== undefined) ||\n\t\t\t\t\t(Array.isArray(controlAggregation) && controlAggregation.length > 0)\n\t\t\t\t) {\n\t\t\t\t\thasAggregation = true;\n\t\t\t\t}\n\t\t\t\tif (control.getBindingPath(mAggregationsKey) && control.getBindingInfo(mAggregationsKey).template) {\n\t\t\t\t\thasAggregation = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (hasAggregation) {\n\t\t\t\tdata += \">\";\n\t\t\t}\n\t\t\treturn data;\n\t\t},\n\t\tstartAggregation: function (control: Control, sName: string): string {\n\t\t\tconst namespaceAlias = getNamespaceAlias(control.getMetadata().getName());\n\t\t\tif (sName.startsWith(\"$\")) {\n\t\t\t\tsName = sName.substring(1);\n\t\t\t}\n\t\t\tlet out = `\\n${getTab()}<${namespaceAlias}:${sName}>`;\n\t\t\ttabCount++;\n\t\t\tout += `\\n${getTab()}`;\n\t\t\treturn out;\n\t\t},\n\t\tendAggregation: function (control: any, sName: string): string {\n\t\t\ttabCount--;\n\t\t\tif (sName.startsWith(\"$\")) {\n\t\t\t\tsName = sName.substring(1);\n\t\t\t}\n\t\t\tconst namespaceAlias = getNamespaceAlias(control.getMetadata().getName());\n\t\t\tif (control.mBindingInfos[sName]) {\n\t\t\t\treturn `\\n${getTab()}</${namespaceAlias}:${sName}>\\n`;\n\t\t\t} else {\n\t\t\t\treturn `\\n${getTab()}</${namespaceAlias}:${sName}>\\n`;\n\t\t\t}\n\t\t}\n\t};\n\tlet outXML;\n\tif (Array.isArray(controlToSerialize)) {\n\t\toutXML = controlToSerialize.map((controlToRender: UI5Element) => {\n\t\t\treturn new Serializer(controlToRender, serializeDelegate).serialize();\n\t\t});\n\t} else {\n\t\toutXML = new Serializer(controlToSerialize, serializeDelegate).serialize();\n\t}\n\tif (asString) {\n\t\treturn Array.isArray(outXML) ? outXML.join(\"\\n\") : outXML;\n\t}\n\tconst xmlString = `<root>${outXML}</root>`;\n\tconst parser = new DOMParser();\n\treturn parser.parseFromString(xmlString, \"text/xml\").firstElementChild?.firstElementChild?.outerHTML ?? \"No Content\";\n}\n\nexport async function serializeControlAsFormattedXML(ui5ControlOrBB: UI5Element): Promise<string> {\n\tconst serialized = serializeControlAsXML(ui5ControlOrBB);\n\treturn serialized;\n}\n"],"mappings":"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","ignoreList":[],"sourceRoot":""}},{"offset":{"line":41,"column":0},"map":{"version":3,"names":["sap","ui","define","ObjectPath","_library","Inspector","ODataTracer","SupportPopup","XMLSerializer","BindingParser","UI5Element","Lib","_library2","JSONModel","serializeControlAsXML","openPopup","addODataTrace","toggleElementInspector","thisLib","init","name","apiVersion","dependencies","types","interfaces","controls","elements","version","noLibraryCSS","set","serializeXML","byId","getElementById","storeAppComponent","appComponent","controlIndex","supportModel","data","cachedSupportLinks","supportLinksStateText","_keepBindingStrings"],"sources":["library-dbg.js"],"mappings":"AAAA;;;;AAIAA,IAAIC,GAAGC,kCAAO,CAAC,2BAA4B,sBAAuB,yBAA0B,2BAA4B,4BAA6B,6BAA8B,4BAA6B,sBAAuB,kBAAmB,sBAAuB,+BAAgC,SAAUC,EAAYC,EAAUC,EAAWC,EAAaC,EAAcC,EAAeC,EAAeC,EAAYC,EAAKC,EAAWC,GAC/a,aAEA,IAAIC,EAAwBN,EAAcM,sBAC1C,IAAIC,EAAYR,EAAaQ,UAC7B,IAAIC,EAAgBV,EAAYU,cAChC,IAAIC,EAAyBZ,EAAUY,uBACvC,MAAMC,EAAUP,EAAIQ,KAAK,CACvBC,KAAM,eACNC,WAAY,EACZC,aAAc,CAAC,cAAe,eAC9BC,MAAO,GACPC,WAAY,GACZC,SAAU,GACVC,SAAU,GAEVC,QAAS,UACTC,aAAc,OAGhBzB,EAAW0B,IAAI,MAAOX,GACtBA,EAAQY,aAAehB,EACvBI,EAAQa,KAAOrB,EAAWsB,eAC1Bd,EAAQD,uBAAyBA,EACjCC,EAAQe,kBAAoB,SAAUC,GACpChB,EAAQgB,aAAeA,CACzB,EACAhB,EAAQiB,aAAe,EACvBjB,EAAQkB,aAAe,IAAIvB,EAAU,CACnCwB,KAAM,GACNC,mBAAoB,CAAC,EACrBC,sBAAuB,6CAEzBvB,EAAcE,GACdT,EAAc+B,oBAAsB,KACpCzB,IACA,OAAOG,CACT,EAAG","ignoreList":[],"sourceRoot":""}},{"offset":{"line":46,"column":0},"map":{"version":3,"names":[],"sources":["library-preload.js?bundle-code-0"],"mappings":"AAAA;AACA","sourcesContent":["sap.ui.require.preload({\n"],"sourceRoot":""}}]}