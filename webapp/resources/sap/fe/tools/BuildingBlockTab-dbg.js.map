{"version":3,"names":["buildingBlockIconTabFilter","addBuildingBlockTab","inspector","_jsx","IconTabFilter","text","children","items","Text","insertAggregation","_exports","addBBInfo","ui5Control","bb","getBuildingBlock","addBuildingBlockInfo","addDefinition","iconTabFilterContent","formattedXML","serializeControlAsFormattedXML","CodeEditor","syntaxHints","type","setHeight","window","innerHeight","setValue","addContentToIconTabFilter","bbInstance","getParent","isA","metaPath","contextPath","involvedObject","getDataModelObjectForMetaPath","getDefinitionNavigator","parent","formFields","$parent","push","label","visualization","Button","press","definition","key","involvedObjectElement","targetType","_type","Array","isArray","length","toString","undefined","value","simpleForm","SimpleForm","element","addContent","Label","VBox","content","index","iconTabFilter","getItems","removeContent","getContent"],"sourceRoot":".","sources":["BuildingBlockTab.tsx"],"sourcesContent":["import type BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport Button from \"sap/m/Button\";\nimport type IconTabBar from \"sap/m/IconTabBar\";\nimport IconTabFilter from \"sap/m/IconTabFilter\";\nimport Label from \"sap/m/Label\";\nimport Text from \"sap/m/Text\";\nimport VBox from \"sap/m/VBox\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport CodeEditor from \"sap/ui/codeeditor/CodeEditor\";\nimport type Control from \"sap/ui/core/Control\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport SimpleForm from \"sap/ui/layout/form/SimpleForm\";\nimport { serializeControlAsFormattedXML } from \"./XMLSerializer\";\n\ntype AnnotationBuildingBlock = BuildingBlock & { metaPath: string; contextPath: string };\ntype DefinitionForm = { label: string; visualization: Text | Button };\nlet buildingBlockIconTabFilter: IconTabFilter;\n\nexport function addBuildingBlockTab(inspector: IconTabBar): void {\n\tbuildingBlockIconTabFilter = (\n\t\t<IconTabFilter key=\"buildingBlock\" text={\"Building Block\"}>\n\t\t\t{{\n\t\t\t\titems: [\n\t\t\t\t\t<IconTabFilter key=\"controlTree\" text=\"Control Tree\">\n\t\t\t\t\t\t<Text text=\"Start inspecting by hovering over items\" />\n\t\t\t\t\t</IconTabFilter>,\n\t\t\t\t\t<IconTabFilter key=\"definition\" text=\"Definition\"></IconTabFilter>\n\t\t\t\t]\n\t\t\t}}\n\t\t</IconTabFilter>\n\t);\n\tinspector.insertAggregation(\"items\", buildingBlockIconTabFilter, 1);\n}\n\nexport function addBBInfo(ui5Control: UI5Element): void {\n\tconst bb = getBuildingBlock(ui5Control);\n\taddBuildingBlockInfo(bb);\n\taddDefinition(bb);\n}\n\nexport async function addBuildingBlockInfo(bb: AnnotationBuildingBlock): Promise<void> {\n\tlet iconTabFilterContent;\n\tif (!bb) {\n\t\ticonTabFilterContent = <Text text=\"No associated Builing Block\" />;\n\t} else {\n\t\tconst formattedXML = await serializeControlAsFormattedXML(bb);\n\t\ticonTabFilterContent = <CodeEditor syntaxHints={false} type=\"XML\" />;\n\t\ticonTabFilterContent.setHeight(window.innerHeight - 120 + \"px\");\n\t\ticonTabFilterContent.setValue(formattedXML);\n\t}\n\taddContentToIconTabFilter(\"controlTree\", iconTabFilterContent);\n}\n\nconst getBuildingBlock = function (ui5Control: ManagedObject | null): AnnotationBuildingBlock {\n\tlet bbInstance;\n\twhile (ui5Control) {\n\t\tui5Control = ui5Control.getParent();\n\t\tif (!ui5Control) {\n\t\t\tbreak;\n\t\t}\n\n\t\tif (ui5Control.isA(\"sap.fe.core.buildingBlocks.BuildingBlock\")) {\n\t\t\tbbInstance = ui5Control;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn bbInstance as AnnotationBuildingBlock;\n};\n\nexport function addDefinition(bb: AnnotationBuildingBlock): void {\n\tlet iconTabFilterContent;\n\tif (bb && bb.metaPath && bb.contextPath) {\n\t\tconst involvedObject = bb.getDataModelObjectForMetaPath(bb.metaPath, bb.contextPath);\n\t\ticonTabFilterContent = getDefinitionNavigator(involvedObject as Record<string, unknown>);\n\t} else if (!bb) {\n\t\ticonTabFilterContent = <Text text=\"No associated Builing Block\" />;\n\t} else {\n\t\ticonTabFilterContent = <Text text=\"No Definition Found\" />;\n\t}\n\taddContentToIconTabFilter(\"definition\", iconTabFilterContent);\n}\n\nexport function getDefinitionNavigator(involvedObject: Record<string, unknown>, parent?: Record<string, unknown>): Control {\n\tconst formFields: DefinitionForm[] = [];\n\tinvolvedObject.$parent = parent;\n\tif (parent) {\n\t\tformFields.push({\n\t\t\tlabel: \"Parent\",\n\t\t\tvisualization: (\n\t\t\t\t<Button\n\t\t\t\t\ttext={\"Go Up\"}\n\t\t\t\t\ttype=\"Transparent\"\n\t\t\t\t\tpress={(): void => {\n\t\t\t\t\t\tconst definition = getDefinitionNavigator(parent, parent.$parent as Record<string, unknown>);\n\t\t\t\t\t\taddContentToIconTabFilter(\"definition\", definition);\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t)\n\t\t});\n\t}\n\tfor (const key in involvedObject) {\n\t\tif (key === \"$parent\") {\n\t\t\tcontinue; // Skip the $parent property\n\t\t}\n\t\tlet visualization;\n\t\tconst involvedObjectElement = involvedObject[key];\n\t\tif (typeof involvedObjectElement === \"object\") {\n\t\t\tlet targetType = (involvedObjectElement as { _type?: string })._type;\n\t\t\tif (Array.isArray(involvedObjectElement) && involvedObjectElement.length > 0) {\n\t\t\t\ttargetType = (involvedObjectElement[0] as { _type?: string })._type + \" Array\";\n\t\t\t} else if (!targetType) {\n\t\t\t\ttargetType = \"Object\";\n\t\t\t}\n\t\t\tvisualization = (\n\t\t\t\t<Button\n\t\t\t\t\ttext={\"Type \" + targetType + \" > Drill Down\"}\n\t\t\t\t\ttype=\"Transparent\"\n\t\t\t\t\tpress={(): void => {\n\t\t\t\t\t\tconst definition = getDefinitionNavigator(involvedObjectElement as Record<string, unknown>, involvedObject);\n\t\t\t\t\t\taddContentToIconTabFilter(\"definition\", definition);\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else if (\n\t\t\ttypeof involvedObjectElement === \"string\" ||\n\t\t\ttypeof involvedObjectElement === \"number\" ||\n\t\t\ttypeof involvedObjectElement === \"boolean\"\n\t\t) {\n\t\t\tvisualization = <Text text={involvedObjectElement.toString()} />;\n\t\t} else if (involvedObjectElement === undefined || involvedObjectElement === null) {\n\t\t\tvisualization = <Text text=\"undefined\" />;\n\t\t} else if (typeof involvedObjectElement === \"function\") {\n\t\t\t<Button\n\t\t\t\ttext={key}\n\t\t\t\ttype=\"Transparent\"\n\t\t\t\tpress={(): void => {\n\t\t\t\t\tconst value = involvedObjectElement();\n\t\t\t\t\tconst definition = getDefinitionNavigator({ value: value });\n\t\t\t\t\taddContentToIconTabFilter(\"definition\", definition);\n\t\t\t\t}}\n\t\t\t/>;\n\t\t\t// TODO: we can probably do better over here\n\t\t\tcontinue;\n\t\t}\n\t\tformFields.push({\n\t\t\tlabel: key,\n\t\t\tvisualization\n\t\t});\n\t}\n\n\tconst simpleForm = <SimpleForm />;\n\tif (formFields.length > 0) {\n\t\tfor (const element of formFields) {\n\t\t\tsimpleForm.addContent(<Label text={element.label} />);\n\t\t\tsimpleForm.addContent(element.visualization);\n\t\t}\n\t}\n\n\treturn <VBox>{simpleForm}</VBox>;\n}\n\nfunction addContentToIconTabFilter(key: string, content: Control): void {\n\tlet index = 0;\n\tswitch (key) {\n\t\tcase \"controlTree\":\n\t\t\tindex = 0;\n\t\t\tbreak;\n\t\tcase \"definition\":\n\t\t\tindex = 1;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\tconst iconTabFilter = buildingBlockIconTabFilter.getItems()[index] as IconTabFilter;\n\ticonTabFilter.removeContent(iconTabFilter.getContent()[0]);\n\ticonTabFilter.addContent(content);\n}\n"],"mappings":"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","ignoreList":[],"file":"BuildingBlockTab-dbg.js"}