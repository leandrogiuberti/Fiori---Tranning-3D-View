{"version":3,"names":["extendObjectPageDefinition","pageDefinition","converterContext","convertedPageDefinition","primaryAction","getPrimaryAction","header","actions","footerActions","designtime","getDesigntime","_exports","headerActions","primaryActionExpression","aActions","getBindingExp","sExpression","includes","replace","slice","aSemanticPositiveActions","filter","oAction","annotationPath","targetObject","getConverterContextFor","getDataModelObjectPath","targetCriticality","getExpressionFromAnnotation","Criticality","isConstant","value","oEntitySet","getEntitySet","length","getPressExpressionForPrimaryAction","undefined","name","visible","enabled","getEditCommandExecutionVisible","getEditCommandExecutionEnabled"],"sourceRoot":".","sources":["ExtendPageDefinition.ts"],"sourcesContent":["import type { DataFieldForAction } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport { CriticalityType } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport type { CompiledBindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport { getExpressionFromAnnotation, isConstant } from \"sap/fe/base/BindingToolkit\";\nimport type ConverterContext from \"sap/fe/core/converters/ConverterContext\";\nimport type { PageContextPathTarget } from \"sap/fe/core/converters/TemplateConverter\";\nimport type { BaseAction } from \"sap/fe/core/converters/controls/Common/Action\";\nimport type { ObjectPageDefinition } from \"sap/fe/core/converters/templates/ObjectPageConverter\";\nimport {\n\tgetEditCommandExecutionEnabled,\n\tgetEditCommandExecutionVisible,\n\tgetPressExpressionForPrimaryAction\n} from \"sap/fe/templates/ObjectPage/ObjectPageTemplating\";\n\nexport type FinalPageDefinition = ObjectPageDefinition & {\n\tprimaryAction: string;\n\tdesigntime: string | undefined;\n};\n\nexport const extendObjectPageDefinition = function (\n\tpageDefinition: ObjectPageDefinition,\n\tconverterContext: ConverterContext<PageContextPathTarget>\n): FinalPageDefinition {\n\tconst convertedPageDefinition = pageDefinition as FinalPageDefinition;\n\tconvertedPageDefinition.primaryAction = getPrimaryAction(converterContext, pageDefinition.header.actions, pageDefinition.footerActions);\n\tconvertedPageDefinition.designtime = getDesigntime();\n\treturn convertedPageDefinition;\n};\n\n/**\n * Method to get the expression for the execute event of the forward action.\n * Generates primaryActionExpression to be executed on the keyboard shortcut Ctrl+Enter with the\n * forward flow (priority is the semantic positive action OR if that's not there, then the primary action).\n * @param converterContext The converter context\n * @param headerActions An array containing all the actions for this ObjectPage header\n * @param footerActions An array containing all the actions for this ObjectPage footer\n * @returns  Binding expression or function string\n */\nexport const getPrimaryAction = function (\n\tconverterContext: ConverterContext<PageContextPathTarget>,\n\theaderActions: BaseAction[],\n\tfooterActions: BaseAction[]\n): string {\n\tlet primaryActionExpression = \"\";\n\tconst aActions = [...headerActions, ...footerActions];\n\n\tconst getBindingExp = function (sExpression: CompiledBindingToolkitExpression | string): string | undefined {\n\t\tif (sExpression && sExpression.includes(\"{=\")) {\n\t\t\treturn sExpression.replace(\"{=\", \"(\").slice(0, -1) + \")\";\n\t\t}\n\t\treturn sExpression;\n\t};\n\tconst aSemanticPositiveActions = aActions.filter((oAction) => {\n\t\tif (oAction?.annotationPath) {\n\t\t\tconst targetObject = converterContext\n\t\t\t\t.getConverterContextFor<DataFieldForAction>(oAction?.annotationPath)\n\t\t\t\t.getDataModelObjectPath().targetObject;\n\t\t\tconst targetCriticality = getExpressionFromAnnotation(targetObject?.Criticality);\n\t\t\tif (isConstant(targetCriticality) && targetCriticality.value === CriticalityType.Positive) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t});\n\tconst oEntitySet = converterContext.getEntitySet();\n\tif (aSemanticPositiveActions.length > 0) {\n\t\tprimaryActionExpression = getPressExpressionForPrimaryAction(\n\t\t\taSemanticPositiveActions[0].annotationPath\n\t\t\t\t? converterContext\n\t\t\t\t\t\t.getConverterContextFor<DataFieldForAction>(aSemanticPositiveActions[0].annotationPath)\n\t\t\t\t\t\t.getDataModelObjectPath().targetObject\n\t\t\t\t: undefined,\n\t\t\toEntitySet?.name,\n\t\t\taSemanticPositiveActions[0],\n\t\t\tgetBindingExp(aSemanticPositiveActions[0].visible ?? \"true\"),\n\t\t\tgetBindingExp(aSemanticPositiveActions[0].enabled ?? \"true\"),\n\t\t\tgetBindingExp(getEditCommandExecutionVisible(headerActions)),\n\t\t\tgetBindingExp(getEditCommandExecutionEnabled(headerActions))\n\t\t);\n\t} else {\n\t\tprimaryActionExpression = getPressExpressionForPrimaryAction(\n\t\t\tundefined,\n\t\t\toEntitySet?.name,\n\t\t\tnull,\n\t\t\t\"false\",\n\t\t\t\"false\",\n\t\t\tgetBindingExp(getEditCommandExecutionVisible(headerActions)),\n\t\t\tgetBindingExp(getEditCommandExecutionEnabled(headerActions))\n\t\t);\n\t}\n\treturn primaryActionExpression;\n};\n\nexport function getDesigntime(): string | undefined {\n\treturn \"sap/fe/templates/ObjectPage/designtime/ObjectPage.designtime\";\n}\n"],"mappings":"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","ignoreList":[],"file":"ExtendPageDefinition-dbg.js"}