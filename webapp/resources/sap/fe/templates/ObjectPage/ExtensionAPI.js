/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/ClassSupport","sap/fe/core/CommonUtils","sap/fe/core/ExtensionAPI","sap/fe/core/converters/helpers/ID","sap/fe/core/helpers/RecommendationHelper","sap/fe/core/helpers/ResourceModelHelper","sap/ui/core/InvisibleMessage","sap/ui/core/library","sap/ui/core/message/Message","sap/ui/core/message/MessageType"],function(e,t,s,n,o,i,r,a,g,c,l){"use strict";var p,u;var f=g.InvisibleMessageMode;var d=i.recommendationHelper;var h=o.getSideContentLayoutID;var P=t.defineUI5Class;function y(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,C(e,t)}function C(e,t){return C=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},C(e,t)}let M=(p=P("sap.fe.templates.ObjectPage.ExtensionAPI"),p(u=function(t){function n(){return t.apply(this,arguments)||this}y(n,t);var o=n.prototype;o.refresh=async function e(t){const n=this._view.getBindingContext();if(!n){return Promise.resolve()}const o=s.getAppComponent(this._view),i=o.getSideEffectsService(),r=n.getModel().getMetaModel(),a={targetProperties:[],targetEntities:[]};if(t===undefined||t===null){a.targetEntities.push({$NavigationPropertyPath:""})}else{const e=Array.isArray(t)?t:[t];const s=this._controller.getOwnerComponent();const n=s.getContextPath()||`/${s.getEntitySet()}`;for(const t of e){if(t===""){a.targetProperties.push("*")}else{const e=r.getObject(`${n}/${t}/$kind`);if(e==="NavigationProperty"){a.targetEntities.push({$NavigationPropertyPath:t})}else if(e){a.targetProperties.push(t)}else{return Promise.reject(`${t} is not a valid path to be refreshed`)}}}}return i.requestSideEffects([...a.targetEntities,...a.targetProperties],n)};o.getSelectedContexts=function e(t){let s=this._view.byId(t);if(s?.isA("sap.ui.mdc.Table")){s=s.getParent()}if(s?.isA("sap.fe.macros.table.TableAPI")){return s.getSelectedContexts()}return[]};o.showSideContent=function e(t,s){const n=h(t),o=this._view.byId(n),i=s===undefined?!o.getShowSideContent():s;o.setShowSideContent(i,false)};o.getBindingContext=function e(){return this._view.getBindingContext()};o._getMessageStripBindingContextPath=function e(){const t=this._view.getBindingContext("internal")?.getPath();const s=this._view.getBindingContext()?.getPath();return t&&s?`${t}/MessageStrip/${s.replace(/\//g,"-")}`:""};o.showMessages=function e(t){this._showMessages(t)};o._showMessages=function t(n){let o=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"Custom";try{const e=this._view;const t=e.getModel("internal");const i=t.bindContext(this._getMessageStripBindingContextPath()).getBoundContext();if(!i){return}const g=r.getResourceModel(e);let p=null;i.setProperty(`OP${o}MessageVisible`,!!p);switch(n.length){case 0:break;case 1:p=n[0];i.setProperty(`OP${o}MessageVisible`,!!p);break;default:const t={Error:{id:2,count:0},Warning:{id:1,count:0},Information:{id:0,count:0}};p=n.reduce((e,s)=>{const n=s.getType();e.setType(t[n].id>t[e.getType()].id?n:e.getType());t[n].count++;return e},new c({type:l.Information}));if(o==="Backend"&&!s.getIsEditable(e)){i.setProperty(`OP${o}MessageVisible`,false)}else{i.setProperty(`OP${o}MessageVisible`,!!p)}if(t.Error.count>0){p.setMessage(g.getText("OBJECTPAGESTATE_ERROR"))}else if(t.Warning.count>0){p.setMessage(g.getText("OBJECTPAGESTATE_WARNING"))}else{p.setMessage(g.getText("OBJECTPAGESTATE_INFORMATION"))}}i.setProperty(`OP${o}MessageText`,p?p.getMessage():null);i.setProperty(`OP${o}MessageType`,p?p.getType():null);if(p){a.getInstance().announce(p.getMessage(),f.Assertive)}}catch(t){e.error("Cannot display ObjectPage message")}};o.hideMessage=function e(){const t=this._view.getModel("internal");const s=t.bindContext(this._getMessageStripBindingContextPath()).getBoundContext();s.setProperty(`OPCustomMessageVisible`,false)};o.setRecommendations=function e(t){d.transformRecommendationsForInternalStorage(t);this._view.getModel("internal").setProperty("/recommendationsData",t)};o.setAsSectionTitleOwner=function e(t){let s;const n=t;let o;while(t){if(t.isA("sap.fe.macros.controls.Section")){s=t;break}if(t.isA("sap.fe.core.ReuseComponent")){t=t.container.getParent();o=true}const e=t.getParent();if(e){t=e}else{break}}if(s){if(o&&s.getVisibleSubSections().length>1){s.adjustForSingleContent(n,{multipleSubSectionsWithReuseComponent:true})}else{s.adjustForSingleContent(n)}}};return n}(n))||u);return M},false);
//# sourceMappingURL=ExtensionAPI.js.map