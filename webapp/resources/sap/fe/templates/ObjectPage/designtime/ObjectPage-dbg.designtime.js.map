{"version":3,"names":["getAdaptationProperties","designtimeSettings","control","returnValues","forEach","setting","id","getAdaptationPropertyValue","viewDataSettings","getParent","getViewData","viewDataComponent","returnValue","editableHeaderContent","undefined","variantManagement","sectionLayout","content","header","visible","showRelatedApps","openInEditMode","JSON","stringify","additionalSemanticObjects","designTime","actions","annotation","textArrangement","getTextArrangementChangeAction","rename","getRenameAction","settings","fe","name","getText","icon","isEnabled","isManifestChangesEnabled","handler","getDesigntimeSettings","propertyValues","unchangedData","configContext","getBindingContext","isConfigModelPrepared","items","getSettings","getSettingsIfKeyUser","CommonUtils","getAppComponent","prepareConfigModel","resourceModel","getModel","openAdaptionDialog","then","propertyValuesEntered","extractChanges","noChanges","properties","alwaysShowContentHeader","ignore","backgroundDesignAnchorBar","blocked","busy","busyIndicatorDelay","busyIndicatorSize","enableLazyLoading","flexEnabled","headerContentPinnable","headerContentPinned","height","isChildPage","preserveHeaderStateOnScroll","toggleHeaderOnTitleClick","sectionTitleLevel","showAnchorBar","showAnchorBarPopover","showEditHeaderButton","showFooter","showHeaderContent","showOnlyHighImportance","showTitleInHeaderContent","subSectionLayout","upperCaseAnchorBar","useIconTabBar","useTwoColumnsForLargeScreen","aggregations","footer","propagateMetadata","elementToPropagate","isA","isVisible","element","parent","getShowFooter","grandParent","headerTitle","manifestSettings","getPropertyNamesAndDescriptions","manifestSettingsValues","manifestPropertyPath","manifestPropertyChange","propertyChanges","propertyPath","separateChanges"],"sourceRoot":".","sources":["ObjectPage.designtime.ts"],"sourcesContent":["import CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type ResourceModel from \"sap/fe/core/ResourceModel\";\nimport type { ObjectPageManifestSettings } from \"sap/fe/core/converters/ManifestSettings\";\nimport { getRenameAction, getText, getTextArrangementChangeAction } from \"sap/fe/core/designtime/AnnotationBasedChanges\";\nimport type { DesigntimeSetting, SettingsData, adaptionChange } from \"sap/fe/macros/designtime/Designtime.helper\";\nimport {\n\textractChanges,\n\tgetPropertyNamesAndDescriptions,\n\tgetSettingsIfKeyUser,\n\tisConfigModelPrepared,\n\tisManifestChangesEnabled,\n\tnoChanges,\n\topenAdaptionDialog,\n\tprepareConfigModel,\n\tseparateChanges\n} from \"sap/fe/macros/designtime/Designtime.helper\";\nimport { getDesigntimeSettings, getSettings } from \"sap/fe/templates/ObjectPage/designtime/ObjectPage.designtime.helper\";\nimport type Control from \"sap/ui/core/Control\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type Context from \"sap/ui/model/Context\";\nimport type ObjectPageLayout from \"sap/uxap/ObjectPageLayout\";\nimport type ObjectPageComponent from \"../Component\";\n\ntype PropertyValue = Record<string, string | number | boolean | object | undefined>;\n\nfunction getAdaptationProperties(designtimeSettings: DesigntimeSetting[], control: ObjectPageLayout): PropertyValue {\n\tconst returnValues: PropertyValue = {};\n\tdesigntimeSettings.forEach(function (setting) {\n\t\treturnValues[setting.id] = getAdaptationPropertyValue(control, setting);\n\t});\n\treturn returnValues;\n}\n\n/**\n * Returns the value of one of the settings that have been defined for object page adaptation.\n * @param control Reference to the object page\n * @param setting The definition of the setting required for adaptation\n * @returns Setting definition with a value for selected control\n */\nfunction getAdaptationPropertyValue(control: ObjectPageLayout, setting: DesigntimeSetting): boolean | string | number {\n\t// Here we are retrieving the viewData from the parent view of the control\n\t// There is no type/class that has all properties from the object page manifest settings\n\t// That's why we are using two different constants for the same object\n\tconst viewDataSettings = (control.getParent() as View)!.getViewData() as ObjectPageManifestSettings;\n\tconst viewDataComponent = (control.getParent() as View)!.getViewData() as ObjectPageComponent;\n\tlet returnValue: boolean | string | number = \"\";\n\n\tswitch (setting.id) {\n\t\tcase \"editableHeaderContent\":\n\t\t\treturnValue = viewDataSettings.editableHeaderContent !== undefined ? viewDataSettings.editableHeaderContent : true;\n\t\t\tbreak;\n\t\tcase \"variantManagement\":\n\t\t\treturnValue = viewDataSettings.variantManagement !== undefined ? viewDataSettings.variantManagement : \"None\";\n\t\t\tbreak;\n\t\tcase \"sectionLayout\":\n\t\t\treturnValue = viewDataSettings.sectionLayout !== undefined ? viewDataSettings.sectionLayout : \"Page\";\n\t\t\tbreak;\n\t\tcase \"visible\":\n\t\t\treturnValue = viewDataSettings.content?.header?.visible !== undefined ? viewDataSettings.content.header.visible : true;\n\t\t\tbreak;\n\t\tcase \"showRelatedApps\":\n\t\t\treturnValue = viewDataComponent.showRelatedApps !== undefined ? viewDataComponent.showRelatedApps : true;\n\t\t\tbreak;\n\t\tcase \"openInEditMode\":\n\t\t\treturnValue = viewDataComponent.openInEditMode !== undefined ? viewDataComponent.openInEditMode : false;\n\t\t\tbreak;\n\t\tcase \"additionalSemanticObjects\":\n\t\t\treturnValue = JSON.stringify(viewDataComponent.additionalSemanticObjects);\n\t}\n\treturn returnValue;\n}\n\nconst designTime = {\n\tactions: {\n\t\tannotation: {\n\t\t\ttextArrangement: getTextArrangementChangeAction(),\n\t\t\trename: getRenameAction()\n\t\t},\n\t\tsettings: {\n\t\t\tfe: {\n\t\t\t\tname: getText(\"RTA_CONTEXT_ACTIONMENU_CONFIG\"),\n\t\t\t\ticon: \"sap-icon://developer-settings\",\n\t\t\t\tisEnabled: isManifestChangesEnabled,\n\t\t\t\thandler: async function (control: ObjectPageLayout): Promise<unknown> {\n\t\t\t\t\tconst designtimeSettings = getDesigntimeSettings();\n\n\t\t\t\t\tconst propertyValues = getAdaptationProperties(designtimeSettings, control);\n\t\t\t\t\tconst unchangedData = { ...propertyValues };\n\t\t\t\t\tconst configContext = control.getBindingContext(\"internal\") as Context;\n\t\t\t\t\tif (!isConfigModelPrepared(configContext)) {\n\t\t\t\t\t\t// first time this session\n\t\t\t\t\t\tlet items: SettingsData[] = [];\n\t\t\t\t\t\titems = getSettings(propertyValues);\n\t\t\t\t\t\t// sap-fe-rta-mode=true and then Adapt UI\n\t\t\t\t\t\titems = getSettingsIfKeyUser(CommonUtils.getAppComponent(control), items);\n\t\t\t\t\t\t// use internal model to persist adaptation configuration values\n\t\t\t\t\t\tprepareConfigModel(items, configContext);\n\t\t\t\t\t}\n\t\t\t\t\tconst resourceModel = control.getModel(\"sap.fe.i18n\") as ResourceModel;\n\t\t\t\t\treturn openAdaptionDialog(\n\t\t\t\t\t\tconfigContext,\n\t\t\t\t\t\tpropertyValues,\n\t\t\t\t\t\t\"{sap.fe.i18n>RTA_CONFIGURATION_TITLE_OP}\",\n\t\t\t\t\t\tresourceModel\n\t\t\t\t\t).then(function (propertyValuesEntered: PropertyValue): adaptionChange[] | [] {\n\t\t\t\t\t\treturn extractChanges(designtimeSettings, unchangedData, propertyValuesEntered, \"\", control);\n\t\t\t\t\t}, noChanges);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t// We disable dynamic page properties in the property panel of Fiori Tools\n\tproperties: {\n\t\talwaysShowContentHeader: { ignore: true },\n\t\tbackgroundDesignAnchorBar: { ignore: true },\n\t\tblocked: { ignore: true },\n\t\tbusy: { ignore: true },\n\t\tbusyIndicatorDelay: { ignore: true },\n\t\tbusyIndicatorSize: { ignore: true },\n\t\tenableLazyLoading: { ignore: true },\n\t\tflexEnabled: { ignore: true },\n\t\theaderContentPinnable: { ignore: true },\n\t\theaderContentPinned: { ignore: true },\n\t\theight: { ignore: true },\n\t\tisChildPage: { ignore: true },\n\t\tpreserveHeaderStateOnScroll: { ignore: true },\n\t\ttoggleHeaderOnTitleClick: { ignore: true },\n\t\tsectionTitleLevel: { ignore: true },\n\t\tshowAnchorBar: { ignore: true },\n\t\tshowAnchorBarPopover: { ignore: true },\n\t\tshowEditHeaderButton: { ignore: true },\n\t\tshowFooter: { ignore: true },\n\t\tshowHeaderContent: { ignore: true },\n\t\tshowOnlyHighImportance: { ignore: true },\n\t\tshowTitleInHeaderContent: { ignore: true },\n\t\tsubSectionLayout: { ignore: true },\n\t\tupperCaseAnchorBar: { ignore: true },\n\t\tuseIconTabBar: { ignore: true },\n\t\tuseTwoColumnsForLargeScreen: { ignore: true },\n\t\tvisible: { ignore: true }\n\t},\n\n\taggregations: {\n\t\tfooter: {\n\t\t\tpropagateMetadata: function (elementToPropagate: Control): { isVisible: Function } | undefined {\n\t\t\t\tif (elementToPropagate.isA(\"sap.m.IBar\")) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tisVisible: function (element: Control): boolean | undefined {\n\t\t\t\t\t\t\tconst parent = element.getParent();\n\t\t\t\t\t\t\tif (parent && parent.isA<ObjectPageLayout>(\"sap.uxap.ObjectPageLayout\")) {\n\t\t\t\t\t\t\t\treturn parent.getShowFooter();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconst grandParent = element.getParent()?.getParent();\n\t\t\t\t\t\t\t\treturn grandParent?.isA<ObjectPageLayout>(\"sap.uxap.ObjectPageLayout\") && grandParent.getShowFooter();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\theaderTitle: {\n\t\t\tpropagateMetadata: function (elementToPropagate: Control): { isVisible: Function } | undefined {\n\t\t\t\tif (elementToPropagate.isA(\"sap.uxap.ObjectPageDynamicHeaderTitle\")) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t// as the header title is always visible, we return true\n\t\t\t\t\t\tisVisible: () => true\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t// These functions provide the properties used in object page adaptation to Fiori tools.\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tmanifestSettings: function (control: ObjectPageLayout): DesigntimeSetting[] {\n\t\treturn getPropertyNamesAndDescriptions(getDesigntimeSettings(), control.getModel(\"sap.fe.i18n\") as ResourceModel);\n\t},\n\t// getAdaptationPropertyValue\n\tmanifestSettingsValues: function (designtimeSettings: DesigntimeSetting[], control: ObjectPageLayout): PropertyValue {\n\t\tconst returnValues: PropertyValue = {};\n\t\tdesigntimeSettings.forEach(function (setting) {\n\t\t\treturnValues[setting.id] = getAdaptationPropertyValue(control, setting);\n\t\t});\n\t\treturn returnValues;\n\t},\n\t// get path for control configuration. Pass reference to the control\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tmanifestPropertyPath: function (control: ObjectPageLayout): string {\n\t\treturn \"\";\n\t},\n\t// create change structue. Pass array of manifest setting and new value, the property path and the control\n\tmanifestPropertyChange: function (propertyChanges: PropertyValue, propertyPath: string, control: ObjectPageLayout): adaptionChange[] {\n\t\treturn separateChanges(propertyChanges, propertyPath, control);\n\t}\n};\n\nexport default designTime;\n"],"mappings":"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","ignoreList":[],"file":"ObjectPage-dbg.designtime.js"}