{"version":3,"file":"ObjectPage.designtime.js","names":["getAdaptationProperties","designtimeSettings","control","returnValues","forEach","setting","id","getAdaptationPropertyValue","viewDataSettings","getParent","getViewData","viewDataComponent","returnValue","editableHeaderContent","undefined","variantManagement","sectionLayout","content","header","visible","showRelatedApps","openInEditMode","JSON","stringify","additionalSemanticObjects","designTime","actions","annotation","textArrangement","getTextArrangementChangeAction","rename","getRenameAction","settings","fe","name","getText","icon","isEnabled","isManifestChangesEnabled","handler","async","getDesigntimeSettings","propertyValues","unchangedData","configContext","getBindingContext","isConfigModelPrepared","items","getSettings","getSettingsIfKeyUser","CommonUtils","getAppComponent","prepareConfigModel","resourceModel","getModel","openAdaptionDialog","then","propertyValuesEntered","extractChanges","noChanges","properties","alwaysShowContentHeader","ignore","backgroundDesignAnchorBar","blocked","busy","busyIndicatorDelay","busyIndicatorSize","enableLazyLoading","flexEnabled","headerContentPinnable","headerContentPinned","height","isChildPage","preserveHeaderStateOnScroll","toggleHeaderOnTitleClick","sectionTitleLevel","showAnchorBar","showAnchorBarPopover","showEditHeaderButton","showFooter","showHeaderContent","showOnlyHighImportance","showTitleInHeaderContent","subSectionLayout","upperCaseAnchorBar","useIconTabBar","useTwoColumnsForLargeScreen","aggregations","footer","propagateMetadata","elementToPropagate","isA","isVisible","element","parent","getShowFooter","grandParent","headerTitle","manifestSettings","getPropertyNamesAndDescriptions","manifestSettingsValues","manifestPropertyPath","manifestPropertyChange","propertyChanges","propertyPath","separateChanges"],"sources":["./ObjectPage.designtime.ts"],"sourcesContent":["import CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type ResourceModel from \"sap/fe/core/ResourceModel\";\nimport type { ObjectPageManifestSettings } from \"sap/fe/core/converters/ManifestSettings\";\nimport { getRenameAction, getText, getTextArrangementChangeAction } from \"sap/fe/core/designtime/AnnotationBasedChanges\";\nimport type { DesigntimeSetting, SettingsData, adaptionChange } from \"sap/fe/macros/designtime/Designtime.helper\";\nimport {\n\textractChanges,\n\tgetPropertyNamesAndDescriptions,\n\tgetSettingsIfKeyUser,\n\tisConfigModelPrepared,\n\tisManifestChangesEnabled,\n\tnoChanges,\n\topenAdaptionDialog,\n\tprepareConfigModel,\n\tseparateChanges\n} from \"sap/fe/macros/designtime/Designtime.helper\";\nimport { getDesigntimeSettings, getSettings } from \"sap/fe/templates/ObjectPage/designtime/ObjectPage.designtime.helper\";\nimport type Control from \"sap/ui/core/Control\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type Context from \"sap/ui/model/Context\";\nimport type ObjectPageLayout from \"sap/uxap/ObjectPageLayout\";\nimport type ObjectPageComponent from \"../Component\";\n\ntype PropertyValue = Record<string, string | number | boolean | object | undefined>;\n\nfunction getAdaptationProperties(designtimeSettings: DesigntimeSetting[], control: ObjectPageLayout): PropertyValue {\n\tconst returnValues: PropertyValue = {};\n\tdesigntimeSettings.forEach(function (setting) {\n\t\treturnValues[setting.id] = getAdaptationPropertyValue(control, setting);\n\t});\n\treturn returnValues;\n}\n\n/**\n * Returns the value of one of the settings that have been defined for object page adaptation.\n * @param control Reference to the object page\n * @param setting The definition of the setting required for adaptation\n * @returns Setting definition with a value for selected control\n */\nfunction getAdaptationPropertyValue(control: ObjectPageLayout, setting: DesigntimeSetting): boolean | string | number {\n\t// Here we are retrieving the viewData from the parent view of the control\n\t// There is no type/class that has all properties from the object page manifest settings\n\t// That's why we are using two different constants for the same object\n\tconst viewDataSettings = (control.getParent() as View)!.getViewData() as ObjectPageManifestSettings;\n\tconst viewDataComponent = (control.getParent() as View)!.getViewData() as ObjectPageComponent;\n\tlet returnValue: boolean | string | number = \"\";\n\n\tswitch (setting.id) {\n\t\tcase \"editableHeaderContent\":\n\t\t\treturnValue = viewDataSettings.editableHeaderContent !== undefined ? viewDataSettings.editableHeaderContent : true;\n\t\t\tbreak;\n\t\tcase \"variantManagement\":\n\t\t\treturnValue = viewDataSettings.variantManagement !== undefined ? viewDataSettings.variantManagement : \"None\";\n\t\t\tbreak;\n\t\tcase \"sectionLayout\":\n\t\t\treturnValue = viewDataSettings.sectionLayout !== undefined ? viewDataSettings.sectionLayout : \"Page\";\n\t\t\tbreak;\n\t\tcase \"visible\":\n\t\t\treturnValue = viewDataSettings.content?.header?.visible !== undefined ? viewDataSettings.content.header.visible : true;\n\t\t\tbreak;\n\t\tcase \"showRelatedApps\":\n\t\t\treturnValue = viewDataComponent.showRelatedApps !== undefined ? viewDataComponent.showRelatedApps : true;\n\t\t\tbreak;\n\t\tcase \"openInEditMode\":\n\t\t\treturnValue = viewDataComponent.openInEditMode !== undefined ? viewDataComponent.openInEditMode : false;\n\t\t\tbreak;\n\t\tcase \"additionalSemanticObjects\":\n\t\t\treturnValue = JSON.stringify(viewDataComponent.additionalSemanticObjects);\n\t}\n\treturn returnValue;\n}\n\nconst designTime = {\n\tactions: {\n\t\tannotation: {\n\t\t\ttextArrangement: getTextArrangementChangeAction(),\n\t\t\trename: getRenameAction()\n\t\t},\n\t\tsettings: {\n\t\t\tfe: {\n\t\t\t\tname: getText(\"RTA_CONTEXT_ACTIONMENU_CONFIG\"),\n\t\t\t\ticon: \"sap-icon://developer-settings\",\n\t\t\t\tisEnabled: isManifestChangesEnabled,\n\t\t\t\thandler: async function (control: ObjectPageLayout): Promise<unknown> {\n\t\t\t\t\tconst designtimeSettings = getDesigntimeSettings();\n\n\t\t\t\t\tconst propertyValues = getAdaptationProperties(designtimeSettings, control);\n\t\t\t\t\tconst unchangedData = { ...propertyValues };\n\t\t\t\t\tconst configContext = control.getBindingContext(\"internal\") as Context;\n\t\t\t\t\tif (!isConfigModelPrepared(configContext)) {\n\t\t\t\t\t\t// first time this session\n\t\t\t\t\t\tlet items: SettingsData[] = [];\n\t\t\t\t\t\titems = getSettings(propertyValues);\n\t\t\t\t\t\t// sap-fe-rta-mode=true and then Adapt UI\n\t\t\t\t\t\titems = getSettingsIfKeyUser(CommonUtils.getAppComponent(control), items);\n\t\t\t\t\t\t// use internal model to persist adaptation configuration values\n\t\t\t\t\t\tprepareConfigModel(items, configContext);\n\t\t\t\t\t}\n\t\t\t\t\tconst resourceModel = control.getModel(\"sap.fe.i18n\") as ResourceModel;\n\t\t\t\t\treturn openAdaptionDialog(\n\t\t\t\t\t\tconfigContext,\n\t\t\t\t\t\tpropertyValues,\n\t\t\t\t\t\t\"{sap.fe.i18n>RTA_CONFIGURATION_TITLE_OP}\",\n\t\t\t\t\t\tresourceModel\n\t\t\t\t\t).then(function (propertyValuesEntered: PropertyValue): adaptionChange[] | [] {\n\t\t\t\t\t\treturn extractChanges(designtimeSettings, unchangedData, propertyValuesEntered, \"\", control);\n\t\t\t\t\t}, noChanges);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t// We disable dynamic page properties in the property panel of Fiori Tools\n\tproperties: {\n\t\talwaysShowContentHeader: { ignore: true },\n\t\tbackgroundDesignAnchorBar: { ignore: true },\n\t\tblocked: { ignore: true },\n\t\tbusy: { ignore: true },\n\t\tbusyIndicatorDelay: { ignore: true },\n\t\tbusyIndicatorSize: { ignore: true },\n\t\tenableLazyLoading: { ignore: true },\n\t\tflexEnabled: { ignore: true },\n\t\theaderContentPinnable: { ignore: true },\n\t\theaderContentPinned: { ignore: true },\n\t\theight: { ignore: true },\n\t\tisChildPage: { ignore: true },\n\t\tpreserveHeaderStateOnScroll: { ignore: true },\n\t\ttoggleHeaderOnTitleClick: { ignore: true },\n\t\tsectionTitleLevel: { ignore: true },\n\t\tshowAnchorBar: { ignore: true },\n\t\tshowAnchorBarPopover: { ignore: true },\n\t\tshowEditHeaderButton: { ignore: true },\n\t\tshowFooter: { ignore: true },\n\t\tshowHeaderContent: { ignore: true },\n\t\tshowOnlyHighImportance: { ignore: true },\n\t\tshowTitleInHeaderContent: { ignore: true },\n\t\tsubSectionLayout: { ignore: true },\n\t\tupperCaseAnchorBar: { ignore: true },\n\t\tuseIconTabBar: { ignore: true },\n\t\tuseTwoColumnsForLargeScreen: { ignore: true },\n\t\tvisible: { ignore: true }\n\t},\n\n\taggregations: {\n\t\tfooter: {\n\t\t\tpropagateMetadata: function (elementToPropagate: Control): { isVisible: Function } | undefined {\n\t\t\t\tif (elementToPropagate.isA(\"sap.m.IBar\")) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tisVisible: function (element: Control): boolean | undefined {\n\t\t\t\t\t\t\tconst parent = element.getParent();\n\t\t\t\t\t\t\tif (parent && parent.isA<ObjectPageLayout>(\"sap.uxap.ObjectPageLayout\")) {\n\t\t\t\t\t\t\t\treturn parent.getShowFooter();\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconst grandParent = element.getParent()?.getParent();\n\t\t\t\t\t\t\t\treturn grandParent?.isA<ObjectPageLayout>(\"sap.uxap.ObjectPageLayout\") && grandParent.getShowFooter();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\theaderTitle: {\n\t\t\tpropagateMetadata: function (elementToPropagate: Control): { isVisible: Function } | undefined {\n\t\t\t\tif (elementToPropagate.isA(\"sap.uxap.ObjectPageDynamicHeaderTitle\")) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\t// as the header title is always visible, we return true\n\t\t\t\t\t\tisVisible: () => true\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t// These functions provide the properties used in object page adaptation to Fiori tools.\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tmanifestSettings: function (control: ObjectPageLayout): DesigntimeSetting[] {\n\t\treturn getPropertyNamesAndDescriptions(getDesigntimeSettings(), control.getModel(\"sap.fe.i18n\") as ResourceModel);\n\t},\n\t// getAdaptationPropertyValue\n\tmanifestSettingsValues: function (designtimeSettings: DesigntimeSetting[], control: ObjectPageLayout): PropertyValue {\n\t\tconst returnValues: PropertyValue = {};\n\t\tdesigntimeSettings.forEach(function (setting) {\n\t\t\treturnValues[setting.id] = getAdaptationPropertyValue(control, setting);\n\t\t});\n\t\treturn returnValues;\n\t},\n\t// get path for control configuration. Pass reference to the control\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tmanifestPropertyPath: function (control: ObjectPageLayout): string {\n\t\treturn \"\";\n\t},\n\t// create change structue. Pass array of manifest setting and new value, the property path and the control\n\tmanifestPropertyChange: function (propertyChanges: PropertyValue, propertyPath: string, control: ObjectPageLayout): adaptionChange[] {\n\t\treturn separateChanges(propertyChanges, propertyPath, control);\n\t}\n};\n\nexport default designTime;\n"],"mappings":"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","ignoreList":[]}