/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/base/HookSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/helpers/BindingHelper","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/FieldControlHelper","sap/fe/core/templating/UIFormatters","sap/fe/macros/field/FieldTemplating","sap/m/Link","sap/m/MessageStrip","sap/ui/core/message/MessageType","sap/fe/base/jsx-runtime/jsx"],function(e,t,i,r,n,s,a,o,l,p,c,u,f){"use strict";var T,d,g,h,b,v;var y={};var E=l.getTextBindingExpression;var P=o.getActionEnabledExpression;var S=a.isRequiredExpression;var m=s.getRelativePaths;var O=s.enhanceDataModelPath;var x=n.UI;var R=i.controllerExtensionHandler;var _=t.property;var A=t.defineUI5Class;var C=e.pathInModel;var j=e.not;var N=e.ifElse;var I=e.concat;var k=e.and;function B(e,t,i,r){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function L(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,w(e,t)}function w(e,t){return w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},w(e,t)}function M(e,t,i,r,n){var s={};return Object.keys(r).forEach(function(e){s[e]=r[e]}),s.enumerable=!!s.enumerable,s.configurable=!!s.configurable,("value"in s||s.initializer)&&(s.writable=!0),s=i.slice().reverse().reduce(function(i,r){return r(e,t,i)||i},s),n&&void 0!==s.initializer&&(s.value=s.initializer?s.initializer.call(n):void 0,s.initializer=void 0),void 0===s.initializer?(Object.defineProperty(e,t,s),null):s}function z(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let q=(T=A("sap.fe.templates.ObjectPage.view.fragments.TransportSelection"),d=_({type:"boolean"}),g=R("editFlow","onBeforeSave"),T(h=(b=function(e){function t(t,i){var r;r=e.call(this,t,i)||this;B(r,"leadingControl",v,r);return r}y=t;L(t,e);var i=t.prototype;i.onMetadataAvailable=function t(i){e.prototype.onMetadataAvailable.call(this,i);this.content=this.createContent()};i.selectTransport=async function e(){if(!this.selectTransportAction){return Promise.resolve()}const t=this.getBindingContext();const i=this.messageStrip.getLink().getText();return this.getPageController()?.editFlow.invokeAction(this.selectTransportAction,{contexts:t,label:i})};i.getTypeExpression=function e(){const t=m(this.transportPropertyObjectPath);const i=S(this.transportPropertyObjectPath.targetObject,t);return N(k(i,j(C(this.definition?.transportRequestProperty))),u.Warning,u.Information)};i.getLinkTextExpression=function e(){return N(C(this.definition?.transportRequestProperty),this.getTranslatedText("T_TRANSPORT_SELECTION_CHANGE_TRANSPORT"),this.getTranslatedText("T_TRANSPORT_SELECTION_SELECT_TRANSPORT"))};i.getStripText=function e(){const t=E(this.transportPropertyObjectPath,{});const i=this.getTranslatedText("T_TRANSPORT_SELECTION_NO_TRANSPORT_SELECTED");const r=I(`${this.getTranslatedText("T_TRANSPORT_SELECTION_SELECTED_TRANSPORT")} `,t);return N(C(this.definition?.transportRequestProperty),r,i)};i.getStripVisible=function e(){return N(this.actionEnabledExpression,x.IsEditable,false)};i.createContent=function e(){const t=this.getDataModelObjectPath();this.definition=this.getManifestWrapper()?.getTransportSelection();if(this.definition){let e=t?.targetEntityType.actions[this.definition.selectTransportAction];if(!e){e=t?.targetEntityType.actions[`${t?.convertedTypes.namespace}.${this.definition.selectTransportAction}`]}if(t&&e){this.selectTransportAction=e.fullyQualifiedName;this.actionEnabledExpression=P(e,t?.convertedTypes,t);this.transportPropertyObjectPath=O(t,this.definition.transportRequestProperty);this.messageStrip=f(c,{text:this.getStripText(),type:this.getTypeExpression(),showIcon:"true",customIcon:"sap-icon://shipping-status",class:"sapUiSmallMarginTop",visible:this.getStripVisible(),children:{link:f(p,{press:this.selectTransport.bind(this),text:this.getLinkTextExpression()})}});return this.messageStrip}}};i.validateTransportRequestBeforeSave=async function e(){if(this.messageStrip.getVisible()&&this.messageStrip.getType()===u.Warning&&this.leadingControl&&this.definition){return this.selectTransport()}return Promise.resolve()};return t}(r),v=M(b.prototype,"leadingControl",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),M(b.prototype,"validateTransportRequestBeforeSave",[g],Object.getOwnPropertyDescriptor(b.prototype,"validateTransportRequestBeforeSave"),b.prototype),b))||h);y=q;return y},false);
//# sourceMappingURL=TransportSelection.js.map