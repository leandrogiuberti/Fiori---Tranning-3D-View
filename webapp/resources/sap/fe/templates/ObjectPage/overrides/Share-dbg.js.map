{"version":3,"names":["FACET_IDENTIFIER","ADAPTIVECARD","bGlobalIsStickySupported","createFilterToFetchActiveContext","mKeyValues","bIsActiveEntityDefined","aKeys","Object","keys","aFilters","filter","sKey","sValue","undefined","map","Filter","FilterOperator","EQ","oActiveFilter","filters","and","push","getActiveContextPath","oController","sPageEntityName","oFilter","oListBinding","getView","getBindingContext","getModel","bindList","$$groupId","requestContexts","then","oContexts","length","getPath","getActiveContextInstances","oContext","oEntitySet","aActiveContextpromises","aPages","sMetaPath","getMetaModel","getMetaPath","indexOf","substring","aMetaPathArray","split","sCurrentHashNoParams","HashChanger","getInstance","getHash","aCurrentHashArray","oPageMap","aPageHashArray","forEach","sPageHash","aKeyValues","sPageHashName","ModelHelper","isDraftSupported","sKeyAssignment","aParts","sKeyValue","includes","oMetaModel","aTechnicalKeys","getObject","join","lastIndexOf","decodeURIComponent","oPageEntitySet","sNavigationPath","oPageInfo","sPageEntitySetName","$NavigationPropertyBinding","pageEntityName","getActiveContextPaths","sRootEntityName","oPageContext","Promise","all","aData","aActiveContextPaths","i","sActiveContextPath","sNavigatioProperty","sEntitySetName","values","replace","catch","oError","Log","info","resolve","fetchActiveContextPaths","oPromise","aSemanticKeys","oModel","isStickySessionSupported","SemanticKeyHelper","getSemanticKeys","oViewData","getViewData","viewLevel","getShareUrl","bIsEditable","bIsStickySupported","sShareUrl","sHash","sBasePath","hrefForAppSpecificHash","window","location","hash","origin","pathname","search","getShareEmailUrl","oUShellContainer","sap","ui","require","getFLPUrlAsync","sFLPUrl","sError","error","document","URL","getJamUrl","bIsEditMode","sJamUrl","ushellContainer","runningInIframe","getFLPUrl","sUrl","getQueryUrlForCardDefinition","context","pathsToQuery","DUMMY_GROUP_ID","model","requestor","oRequestor","selectOptions","path","requestSideEffects","requests","mBatchQueue","splice","longUrl","reduce","url","req","$owner","mergedReq","mergeGetRequests","absoluteServiceURL","getAbsoluteURL","getServiceUrl","getActionControls","opLayout","headerTitle","getHeaderTitle","headerActionsInUI","getActions","controls","actionInUI","isA","menu","getMenu","menuItems","getItems","serviceURL","regex","RegExp","test","ShareExtensionOverride","adaptShareMetadata","oShareMetadata","base","CommonUtils","getIsEditable","manifest","getAppComponent","getManifest","appId","id","appTitle","title","getController","oPageTitleInfo","_getPageTitleInformation","oData","sTitle","sObjectSubtitle","subtitle","toString","tile","email","jam","shareInfoModel","teamsUrl","getTeamsUrl","setProperty","getCardDefinition","cardDefinition","view","bindingContext","metaModel","opController","appComponent","getCollaborationManagerService","getDesignTimeCard","serviceURI","conveterdTypes","convertTypes","bindingContextPath","webUrl","contextPath","shellServiceHelper","getShellServices","contextInfo","cardConfig","headerFacets","getHeaderFacetsConfig","actions","getActionsConfig","objectTitle","getTitle","appUrl","getProperty","cardGenerator","AdaptiveCardGenerator","getPathsToQuery","queryUrl","controller","manifestActionsConfig","content","header","_getObjectPageLayoutControl","actionControlsInUI","actionConfig","config","actionControl","configKey","data","getText","isVisible","getActionVisibilityViaManifest","actionKey","startsWith","actionVisible","visible","enabled","dynamicHeaderControls","getHeaderContent","headerItems","cummulativeConfigs","currentFacet","facetIdentifer","formElementsConfig","_getFacetLabelsInfo","currentItem","isBound","getVisible","position","placement","Placement","After","anchor","pop","facetControl","labelCtrls","getFormLabels","allConfigs","label","labelIdentifier","labelText","endsWith"],"sourceRoot":".","sources":["Share.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type PageController from \"sap/fe/core/PageController\";\nimport type Share from \"sap/fe/core/controllerextensions/Share\";\nimport type { ShareMetadata } from \"sap/fe/core/controllerextensions/Share\";\nimport { type ManifestAction } from \"sap/fe/core/converters/ManifestSettings\";\nimport { convertTypes } from \"sap/fe/core/converters/MetaModelConverter\";\nimport { Placement } from \"sap/fe/core/converters/helpers/ConfigurableObject\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport SemanticKeyHelper from \"sap/fe/core/helpers/SemanticKeyHelper\";\nimport { type WrappedCard } from \"sap/fe/core/services/CollaborationManagerServiceFactory\";\nimport type ObjectPageController from \"sap/fe/templates/ObjectPage/ObjectPageController.controller\";\nimport AdaptiveCardGenerator from \"sap/fe/templates/ObjectPage/card/Generator\";\nimport type { CustomActionConfigs } from \"sap/fe/templates/ObjectPage/card/actions/HeaderActions\";\nimport type {\n\tCustomFormElementsConfig,\n\tCustomHeaderFacetConfigs,\n\tHeaderFacetConfig\n} from \"sap/fe/templates/ObjectPage/card/facets/HeaderContent\";\nimport type StashableHBox from \"sap/fe/templates/ObjectPage/controls/StashableHBox\";\nimport type Button from \"sap/m/Button\";\nimport type HBox from \"sap/m/HBox\";\nimport type Label from \"sap/m/Label\";\nimport type MenuButton from \"sap/m/MenuButton\";\nimport type MenuItem from \"sap/m/MenuItem\";\nimport type Control from \"sap/ui/core/Control\";\nimport HashChanger from \"sap/ui/core/routing/HashChanger\";\nimport Filter from \"sap/ui/model/Filter\";\nimport FilterOperator from \"sap/ui/model/FilterOperator\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport type ObjectPageDynamicHeaderTitle from \"sap/uxap/ObjectPageDynamicHeaderTitle\";\nimport type ObjectPageLayout from \"sap/uxap/ObjectPageLayout\";\nimport type { IAdaptiveCard } from \"types/adaptiveCard_types\";\nimport type { MetaModelEntitySet } from \"../../../../../../../../types/metamodel_types\";\n\nconst FACET_IDENTIFIER = \"facetIdentifier\";\nconst ADAPTIVECARD = \"adaptive\";\nlet bGlobalIsStickySupported: boolean;\n\nfunction createFilterToFetchActiveContext(mKeyValues: Record<string, unknown>, bIsActiveEntityDefined: boolean): Filter {\n\tconst aKeys = Object.keys(mKeyValues);\n\n\tconst aFilters = aKeys\n\t\t.filter(function (sKey: string) {\n\t\t\tconst sValue = mKeyValues[sKey];\n\t\t\treturn sValue !== undefined;\n\t\t})\n\t\t.map(function (sKey: string) {\n\t\t\tconst sValue = mKeyValues[sKey];\n\t\t\treturn new Filter(sKey, FilterOperator.EQ, sValue);\n\t\t});\n\n\tif (bIsActiveEntityDefined) {\n\t\tconst oActiveFilter = new Filter({\n\t\t\tfilters: [new Filter(\"SiblingEntity/IsActiveEntity\", FilterOperator.EQ, true)],\n\t\t\tand: false\n\t\t});\n\n\t\taFilters.push(oActiveFilter);\n\t}\n\n\treturn new Filter(aFilters, true);\n}\nasync function getActiveContextPath(oController: PageController, sPageEntityName: string, oFilter: Filter): Promise<string> {\n\tconst oListBinding = oController\n\t\t.getView()\n\t\t.getBindingContext()\n\t\t.getModel()\n\t\t.bindList(`/${sPageEntityName}`, undefined, undefined, oFilter, { $$groupId: \"$auto.Heroes\" });\n\treturn oListBinding.requestContexts(0, 2).then(function (oContexts) {\n\t\tif (oContexts && oContexts.length) {\n\t\t\treturn oContexts[0].getPath();\n\t\t}\n\t\treturn \"\";\n\t});\n}\ntype PageInfo = { pageEntityName?: string; mKeyValues?: Record<string, unknown>; bIsActiveEntityDefined?: boolean };\nfunction getActiveContextInstances(oContext: Context, oController: PageController, oEntitySet: MetaModelEntitySet): Promise<string>[] {\n\tconst aActiveContextpromises: Promise<string>[] = [];\n\tconst aPages: PageInfo[] = [];\n\tlet sMetaPath = oContext.getModel().getMetaModel().getMetaPath(oContext.getPath());\n\tif (sMetaPath.indexOf(\"/\") === 0) {\n\t\tsMetaPath = sMetaPath.substring(1);\n\t}\n\tconst aMetaPathArray = sMetaPath.split(\"/\");\n\tconst sCurrentHashNoParams = HashChanger.getInstance().getHash().split(\"?\")[0];\n\tconst aCurrentHashArray = sCurrentHashNoParams.split(\"/\");\n\n\t// oPageMap - creating an object that contains map of metapath name and it's technical details\n\t// which is required to create a filter to fetch the relavant/correct active context\n\t// Example: {SalesOrderManage:{technicalID:technicalIDValue}, _Item:{technicalID:technicalIDValue}} etc.,\n\tconst oPageMap: Record<string, PageInfo> = {};\n\tconst aPageHashArray: string[] = [];\n\taCurrentHashArray.forEach(function (sPageHash: string) {\n\t\tconst aKeyValues = sPageHash.substring(sPageHash.indexOf(\"(\") + 1, sPageHash.length - 1).split(\",\");\n\t\tconst mKeyValues: Record<string, unknown> = {};\n\t\tconst sPageHashName = sPageHash.split(\"(\")[0];\n\t\toPageMap[sPageHashName] = {};\n\t\taPageHashArray.push(sPageHashName);\n\t\toPageMap[sPageHashName][\"bIsActiveEntityDefined\"] = ModelHelper.isDraftSupported(\n\t\t\toContext.getModel().getMetaModel(),\n\t\t\toContext.getPath()\n\t\t)\n\t\t\t? true\n\t\t\t: false;\n\t\tfor (const sKeyAssignment of aKeyValues) {\n\t\t\tconst aParts = sKeyAssignment.split(\"=\");\n\t\t\tlet sKeyValue = aParts[1];\n\t\t\tlet sKey = aParts[0];\n\t\t\t// In case if only one technical key is defined then the url just contains the technicalIDValue but not the technicalID\n\t\t\t// Example: SalesOrderManage(ID=11111129-aaaa-bbbb-cccc-ddddeeeeffff,IsActiveEntity=false)/_Item(11111129-aaaa-bbbb-cccc-ddddeeeeffff)\n\t\t\t// In above example SalesOrderItem has only one technical key defined, hence technicalID info is not present in the url\n\t\t\t// Hence in such cases we get technical key and use them to fetch active context\n\t\t\tif (!sKeyAssignment.includes(\"=\")) {\n\t\t\t\tconst oMetaModel = oContext.getModel().getMetaModel();\n\t\t\t\tconst aTechnicalKeys = oMetaModel.getObject(`/${aPageHashArray.join(\"/\")}/$Type/$Key`);\n\t\t\t\tsKeyValue = aParts[0];\n\t\t\t\tsKey = aTechnicalKeys[0];\n\t\t\t\toPageMap[sPageHash.split(\"(\")[0]][\"bIsActiveEntityDefined\"] = false;\n\t\t\t}\n\n\t\t\tif (sKey !== \"IsActiveEntity\") {\n\t\t\t\tif (sKeyValue.indexOf(\"'\") === 0 && sKeyValue.lastIndexOf(\"'\") === sKeyValue.length - 1) {\n\t\t\t\t\t// Remove the quotes from the value and decode special chars\n\t\t\t\t\tsKeyValue = decodeURIComponent(sKeyValue.substring(1, sKeyValue.length - 1));\n\t\t\t\t}\n\t\t\t\tmKeyValues[sKey] = sKeyValue;\n\t\t\t}\n\t\t}\n\t\toPageMap[sPageHashName].mKeyValues = mKeyValues;\n\t});\n\n\tlet oPageEntitySet = oEntitySet;\n\taMetaPathArray.forEach(function (sNavigationPath: string) {\n\t\tconst oPageInfo: PageInfo = {};\n\t\tconst sPageEntitySetName = oPageEntitySet.$NavigationPropertyBinding && oPageEntitySet.$NavigationPropertyBinding[sNavigationPath];\n\t\tif (sPageEntitySetName) {\n\t\t\toPageInfo.pageEntityName = oPageEntitySet.$NavigationPropertyBinding[sNavigationPath];\n\t\t\toPageEntitySet = oContext.getModel().getMetaModel().getObject(`/${sPageEntitySetName}`) || oEntitySet;\n\t\t} else {\n\t\t\toPageInfo.pageEntityName = sNavigationPath;\n\t\t}\n\t\toPageInfo.mKeyValues = oPageMap[sNavigationPath]?.mKeyValues;\n\t\toPageInfo.bIsActiveEntityDefined = oPageMap[sNavigationPath]?.bIsActiveEntityDefined;\n\t\taPages.push(oPageInfo);\n\t});\n\n\taPages.forEach(function (oPageInfo: PageInfo) {\n\t\tconst oFilter = createFilterToFetchActiveContext(oPageInfo.mKeyValues!, !!oPageInfo.bIsActiveEntityDefined);\n\t\taActiveContextpromises.push(getActiveContextPath(oController, oPageInfo.pageEntityName!, oFilter));\n\t});\n\n\treturn aActiveContextpromises;\n}\n\n/**\n * Method to fetch active context path's.\n * @param oContext The Page Context\n * @param oController\n * @returns Promise which is resolved once the active context's are fetched\n */\nasync function getActiveContextPaths(oContext: Context, oController: PageController): Promise<string[]> {\n\tconst sCurrentHashNoParams = HashChanger.getInstance().getHash().split(\"?\")[0];\n\tlet sRootEntityName = sCurrentHashNoParams && sCurrentHashNoParams.substring(0, sCurrentHashNoParams.indexOf(\"(\"));\n\tif (sRootEntityName.indexOf(\"/\") === 0) {\n\t\tsRootEntityName = sRootEntityName.substring(1);\n\t}\n\tconst oEntitySet = oContext.getModel().getMetaModel().getObject(`/${sRootEntityName}`);\n\tconst oPageContext = oContext;\n\tconst aActiveContextpromises = getActiveContextInstances(oContext, oController, oEntitySet);\n\tif (aActiveContextpromises.length > 0) {\n\t\treturn Promise.all(aActiveContextpromises)\n\t\t\t.then(function (aData: string[]) {\n\t\t\t\tconst aActiveContextPaths: string[] = [];\n\t\t\t\tlet oPageEntitySet = oEntitySet;\n\t\t\t\tif (aData[0]?.indexOf(\"/\") === 0) {\n\t\t\t\t\taActiveContextPaths.push(aData[0].substring(1));\n\t\t\t\t} else {\n\t\t\t\t\taActiveContextPaths.push(aData[0]);\n\t\t\t\t}\n\t\t\t\t// In the active context paths identify and replace the entitySet Name with corresponding navigation property name\n\t\t\t\t// Required to form the url pointing to active context\n\t\t\t\t// Example : SalesOrderItem --> _Item, MaterialDetails --> _MaterialDetails etc.,\n\t\t\t\tfor (let i = 1; i < aData.length; i++) {\n\t\t\t\t\tlet sActiveContextPath = aData[i];\n\t\t\t\t\tlet sNavigatioProperty = \"\";\n\t\t\t\t\tlet sEntitySetName = sActiveContextPath && sActiveContextPath.substring(0, sActiveContextPath.indexOf(\"(\"));\n\t\t\t\t\tif (sEntitySetName?.indexOf(\"/\") === 0) {\n\t\t\t\t\t\tsEntitySetName = sEntitySetName.substring(1);\n\t\t\t\t\t}\n\t\t\t\t\tif (sActiveContextPath?.indexOf(\"/\") === 0) {\n\t\t\t\t\t\tsActiveContextPath = sActiveContextPath.substring(1);\n\t\t\t\t\t}\n\t\t\t\t\tsNavigatioProperty = Object.keys(oPageEntitySet.$NavigationPropertyBinding)[\n\t\t\t\t\t\tObject.values(oPageEntitySet.$NavigationPropertyBinding).indexOf(sEntitySetName)\n\t\t\t\t\t];\n\t\t\t\t\tif (sNavigatioProperty) {\n\t\t\t\t\t\taActiveContextPaths.push(sActiveContextPath?.replace(sEntitySetName, sNavigatioProperty));\n\t\t\t\t\t\toPageEntitySet = oPageContext.getModel().getMetaModel().getObject(`/${sEntitySetName}`) || oEntitySet;\n\t\t\t\t\t} else {\n\t\t\t\t\t\taActiveContextPaths.push(sActiveContextPath);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn aActiveContextPaths;\n\t\t\t})\n\t\t\t.catch(function (oError: unknown) {\n\t\t\t\tLog.info(\"Failed to retrieve one or more active context path's\", oError as string);\n\t\t\t\treturn [];\n\t\t\t});\n\t} else {\n\t\treturn Promise.resolve([]);\n\t}\n}\nasync function fetchActiveContextPaths(oContext: Context, oController: PageController): Promise<string[]> {\n\tlet oPromise, aSemanticKeys;\n\tconst sCurrentHashNoParams = HashChanger.getInstance().getHash().split(\"?\")[0];\n\tif (oContext) {\n\t\tconst oModel = oContext.getModel();\n\t\tconst oMetaModel = oModel.getMetaModel();\n\t\tbGlobalIsStickySupported = ModelHelper.isStickySessionSupported(oMetaModel);\n\t\tlet sRootEntityName = sCurrentHashNoParams && sCurrentHashNoParams.substring(0, sCurrentHashNoParams.indexOf(\"(\"));\n\t\tif (sRootEntityName.indexOf(\"/\") === 0) {\n\t\t\tsRootEntityName = sRootEntityName.substring(1);\n\t\t}\n\t\taSemanticKeys = SemanticKeyHelper.getSemanticKeys(oMetaModel, sRootEntityName);\n\t}\n\t// Fetch active context details incase of below scenario's(where page is not sticky supported(we do not have draft instance))\n\t// 1. In case of draft enabled Object page where semantic key based URL is not possible(like semantic keys are not modeled in the entity set)\n\t// 2. In case of draft enabled Sub Object Pages (where semantic bookmarking is not supported)\n\tconst oViewData = oController.getView().getViewData();\n\tif (oContext && !bGlobalIsStickySupported && ((oViewData.viewLevel === 1 && !aSemanticKeys) || oViewData.viewLevel >= 2)) {\n\t\toPromise = getActiveContextPaths(oContext, oController);\n\t\treturn oPromise;\n\t} else {\n\t\treturn Promise.resolve([]);\n\t}\n}\n\n// /**\n//  * Get share URL.\n//  * @param bIsEditable\n//  * @param bIsStickySupported\n//  * @param aActiveContextPaths\n//  * @returns {string} The share URL\n//  * @protected\n//  * @static\n//  */\nfunction getShareUrl(bIsEditable: boolean, bIsStickySupported: boolean, aActiveContextPaths: string[]): string {\n\tlet sShareUrl;\n\tconst sHash = HashChanger.getInstance().getHash();\n\tconst sBasePath = HashChanger.getInstance().hrefForAppSpecificHash ? HashChanger.getInstance().hrefForAppSpecificHash!(\"\") : \"\";\n\tif (bIsEditable && !bIsStickySupported && aActiveContextPaths) {\n\t\tsShareUrl = sBasePath + aActiveContextPaths.join(\"/\");\n\t} else {\n\t\tsShareUrl = sHash ? sBasePath + sHash : window.location.hash;\n\t}\n\treturn window.location.origin + window.location.pathname + window.location.search + sShareUrl;\n}\nasync function getShareEmailUrl(): Promise<string> {\n\tconst oUShellContainer = sap.ui.require(\"sap/ushell/Container\");\n\tif (oUShellContainer) {\n\t\treturn oUShellContainer\n\t\t\t.getFLPUrlAsync(true)\n\t\t\t.then(function (sFLPUrl: string) {\n\t\t\t\treturn sFLPUrl;\n\t\t\t})\n\t\t\t.catch(function (sError: unknown) {\n\t\t\t\tLog.error(\"Could not retrieve cFLP URL for the sharing dialog (dialog will not be opened)\", sError as string);\n\t\t\t});\n\t} else {\n\t\treturn Promise.resolve(document.URL);\n\t}\n}\n\nfunction getJamUrl(bIsEditMode: boolean, bIsStickySupported: boolean, aActiveContextPaths: string[]): Promise<string> | undefined {\n\tlet sJamUrl: string;\n\tconst sHash = HashChanger.getInstance().getHash();\n\tconst sBasePath = HashChanger.getInstance().hrefForAppSpecificHash ? HashChanger.getInstance().hrefForAppSpecificHash!(\"\") : \"\";\n\tif (bIsEditMode && !bIsStickySupported && aActiveContextPaths) {\n\t\tsJamUrl = sBasePath + aActiveContextPaths.join(\"/\");\n\t} else {\n\t\tsJamUrl = sHash ? sBasePath + sHash : window.location.hash;\n\t}\n\t// in case we are in cFLP scenario, the application is running\n\t// inside an iframe, and there for we need to get the cFLP URL\n\t// and not 'document.URL' that represents the iframe URL\n\tconst ushellContainer = sap.ui.require(\"sap/ushell/Container\");\n\tif (ushellContainer && ushellContainer.runningInIframe && ushellContainer.runningInIframe()) {\n\t\tushellContainer\n\t\t\t.getFLPUrl(true)\n\t\t\t.then(function (sUrl: string) {\n\t\t\t\treturn sUrl.substring(0, sUrl.indexOf(\"#\")) + sJamUrl;\n\t\t\t})\n\t\t\t.catch(function (sError: unknown) {\n\t\t\t\tLog.error(\"Could not retrieve cFLP URL for the sharing dialog (dialog will not be opened)\", sError as string);\n\t\t\t});\n\t} else {\n\t\treturn Promise.resolve(window.location.origin + window.location.pathname + sJamUrl);\n\t}\n}\n\n/**\n * Get query url formed by context and paths to request.\n * @param context Binding context of the view\n * @param pathsToQuery Paths to request. Add to $select and $expand query of the data URL.\n * @returns Query URL for data to be shown in the card.\n */\nfunction getQueryUrlForCardDefinition(context: Context, pathsToQuery: string[]): string | undefined {\n\t// NOTE: Below approach uses private implementations from UI5 V4 model and requestor.\n\t// This would need to change once we get a public API to support this requirement from UI5 V4 model (JIRA: FIORITECHP1-28756).\n\tconst DUMMY_GROUP_ID = \"_fe_ms_teams\";\n\tconst model = context.getModel();\n\tconst requestor = context.getModel().oRequestor;\n\tconst selectOptions = pathsToQuery.map((path) => path.replace(\".\", \"/\"));\n\tcontext.requestSideEffects(selectOptions, DUMMY_GROUP_ID);\n\t// For this scenario, 1st request in the batch is always empty according to model.\n\tconst requests = requestor.mBatchQueue?.[DUMMY_GROUP_ID]?.splice(1);\n\n\t// Batch queue contains separate requests from control bindings with different groupIds.\n\t// We need to merge the all the requests as we need a single data url.\n\tif (requests && requests.length > 0) {\n\t\t// Url for request can be different based on $select/$expand parameters.\n\t\tconst longUrl = requests.reduce((url, req) => (req.url.length > url.length ? req.url : url), \"\");\n\t\trequests.forEach((req) => {\n\t\t\tdelete req.$owner;\n\t\t\treq.url = longUrl;\n\t\t});\n\t\tconst mergedReq = requestor.mergeGetRequests(requests)[0];\n\t\tconst absoluteServiceURL = getAbsoluteURL(model.getServiceUrl());\n\t\tdelete requestor.mBatchQueue[DUMMY_GROUP_ID];\n\t\treturn `${absoluteServiceURL}${mergedReq.url}`;\n\t}\n}\n\n/**\n * Get action controls from object page layout.\n * @param opLayout ObjectPageLayout control.\n * @returns Action buttons and menu items present in OP header.\n */\nfunction getActionControls(opLayout: ObjectPageLayout): (Button | MenuItem)[] {\n\tconst headerTitle = opLayout.getHeaderTitle() as ObjectPageDynamicHeaderTitle;\n\tconst headerActionsInUI = headerTitle.getActions();\n\treturn headerActionsInUI.reduce(\n\t\t(controls, actionInUI): (Button | MenuItem)[] => {\n\t\t\tif (actionInUI?.isA?.<Button>(\"sap.m.Button\")) {\n\t\t\t\tcontrols.push(actionInUI);\n\t\t\t} else if (actionInUI?.isA?.<MenuButton>(\"sap.m.MenuButton\")) {\n\t\t\t\tconst menu = actionInUI.getMenu();\n\t\t\t\tconst menuItems = menu.getItems();\n\t\t\t\tcontrols = [...controls, ...menuItems];\n\t\t\t}\n\t\t\treturn controls;\n\t\t},\n\t\t[] as (Button | MenuItem)[]\n\t);\n}\n\n/**\n * Get absolute service url.\n * @param serviceURL Service URL\n * @returns Absolute service URL.\n */\nfunction getAbsoluteURL(serviceURL: string): string {\n\tconst regex = new RegExp(\"^(?:[a-z]+:)?//\", \"i\");\n\tif (regex.test(serviceURL)) {\n\t\treturn serviceURL;\n\t}\n\treturn `${window.location.origin}${serviceURL}`;\n}\n\nconst ShareExtensionOverride = {\n\tadaptShareMetadata: async function (this: Share, oShareMetadata: ShareMetadata): Promise<unknown> {\n\t\tconst oContext = this.base.getView().getBindingContext();\n\t\tconst bIsEditable = CommonUtils.getIsEditable(this.base.getView());\n\n\t\ttry {\n\t\t\tconst manifest = this.base.getAppComponent().getManifest();\n\t\t\tconst appId = manifest?.[\"sap.app\"]?.id;\n\t\t\tconst appTitle = manifest?.[\"sap.app\"]?.title;\n\t\t\tconst aActiveContextPaths = await fetchActiveContextPaths(oContext, this.base.getView().getController());\n\t\t\tconst oPageTitleInfo = await (this.base.getView().getController() as ObjectPageController)._getPageTitleInformation();\n\t\t\tconst oData = await Promise.all([\n\t\t\t\tgetJamUrl(bIsEditable, bGlobalIsStickySupported, aActiveContextPaths),\n\t\t\t\tgetShareUrl(bIsEditable, bGlobalIsStickySupported, aActiveContextPaths),\n\t\t\t\tgetShareEmailUrl()\n\t\t\t]);\n\n\t\t\tlet sTitle = oPageTitleInfo.title;\n\t\t\tconst sObjectSubtitle = oPageTitleInfo.subtitle ? oPageTitleInfo.subtitle.toString() : \"\";\n\t\t\tif (sObjectSubtitle) {\n\t\t\t\tsTitle = `${sTitle} - ${sObjectSubtitle}`;\n\t\t\t}\n\t\t\toShareMetadata.tile = {\n\t\t\t\ttitle: oPageTitleInfo.title,\n\t\t\t\tsubtitle: sObjectSubtitle\n\t\t\t};\n\t\t\toShareMetadata.email.title = sTitle;\n\t\t\toShareMetadata.title = sTitle;\n\t\t\toShareMetadata.jam.url = oData[0];\n\t\t\toShareMetadata.url = oData[1];\n\t\t\toShareMetadata.email.url = oData[2];\n\t\t\t// MS Teams collaboration does not want to allow further changes to the URL\n\t\t\t// so update colloborationInfo model at LR override to ignore further extension changes at multiple levels\n\t\t\tconst shareInfoModel = this.base?.getView()?.getModel(\"shareInfo\") as JSONModel | undefined;\n\t\t\tconst teamsUrl = await this.getTeamsUrl(oShareMetadata.url);\n\t\t\tif (shareInfoModel) {\n\t\t\t\tshareInfoModel.setProperty(\"/collaborationInfo/url\", teamsUrl);\n\t\t\t\tshareInfoModel.setProperty(\"/collaborationInfo/appTitle\", appTitle);\n\t\t\t\tshareInfoModel.setProperty(\"/collaborationInfo/subTitle\", sObjectSubtitle);\n\t\t\t\tshareInfoModel.setProperty(\"/collaborationInfo/appId\", appId);\n\t\t\t}\n\t\t} catch (error: unknown) {\n\t\t\tLog.error(error as string);\n\t\t}\n\n\t\treturn oShareMetadata;\n\t},\n\n\t/**\n\t * Get adaptive card definition for object page to  share via MS teams collaboration.\n\t * @returns Adaptive card definition.\n\t */\n\tgetCardDefinition: async function (this: Share): Promise<IAdaptiveCard | undefined | WrappedCard> {\n\t\tlet cardDefinition: IAdaptiveCard | undefined | WrappedCard;\n\t\tconst view = this.base.getView();\n\t\tconst bindingContext = this.base.getView().getBindingContext();\n\t\tconst model = bindingContext?.getModel() as ODataModel | undefined;\n\t\tconst metaModel = model?.getMetaModel();\n\t\tconst opController = view.getController() as ObjectPageController;\n\t\tconst appComponent = opController.getAppComponent();\n\t\tcardDefinition = (await appComponent.getCollaborationManagerService().getDesignTimeCard(ADAPTIVECARD)) as WrappedCard;\n\t\tif (!cardDefinition && model && metaModel && bindingContext) {\n\t\t\tconst serviceURI = getAbsoluteURL(model.getServiceUrl());\n\t\t\tconst conveterdTypes = convertTypes(metaModel);\n\t\t\tconst bindingContextPath = bindingContext.getPath();\n\t\t\tconst webUrl = `${serviceURI}${bindingContextPath.substring(1)}`;\n\t\t\tconst contextPath = `${metaModel.getMetaPath(bindingContext.getPath())}/`;\n\t\t\tconst shellServiceHelper = opController.getAppComponent().getShellServices();\n\t\t\tconst contextInfo = {\n\t\t\t\tcontextPath,\n\t\t\t\tbindingContextPath\n\t\t\t};\n\n\t\t\t// pass facet as part of cardConfig\n\t\t\tconst cardConfig = {\n\t\t\t\theaderFacets: ShareExtensionOverride.getHeaderFacetsConfig(opController),\n\t\t\t\tactions: ShareExtensionOverride.getActionsConfig(opController),\n\t\t\t\twebUrl,\n\t\t\t\tserviceURI,\n\t\t\t\tobjectTitle: await shellServiceHelper.getTitle(),\n\t\t\t\tappUrl: this.base.getView().getModel(\"shareInfo\")?.getProperty(\"/collaborationInfo/url\"),\n\t\t\t\tcontextInfo\n\t\t\t};\n\t\t\tconst cardGenerator = new AdaptiveCardGenerator(conveterdTypes, cardConfig);\n\t\t\tconst pathsToQuery = cardGenerator.getPathsToQuery();\n\t\t\t// TODO:\n\t\t\t// 'getQueryUrlForCardDefinition' uses a private implementation from V4 model to create query url.\n\t\t\t// This workaround was discussed with V4 model for temporary use.\n\t\t\t// We would need to revert this once we have an API or better approach from V4 model.(JIRA: FIORITECHP1-28756)\n\t\t\tconst queryUrl = getQueryUrlForCardDefinition(bindingContext, pathsToQuery);\n\t\t\tcardDefinition = cardGenerator.getCardDefinition(queryUrl);\n\t\t} else if (!cardDefinition) {\n\t\t\tLog.error(\"FE V4 : Share Object Page controller extension : Card was not created\");\n\t\t}\n\t\treturn cardDefinition;\n\t},\n\n\t/**\n\t * Get action configs for card creation.\n\t * @param controller View controller.\n\t * @returns Action configs\n\t */\n\tgetActionsConfig: function (controller: ObjectPageController): CustomActionConfigs {\n\t\t// fetch the information about UI from object page layout\n\t\tconst manifestActionsConfig = controller.getView().getViewData().content?.header?.actions || {};\n\t\tconst opLayout = controller._getObjectPageLayoutControl();\n\t\tconst actionControlsInUI = getActionControls(opLayout);\n\t\tconst actionConfig = actionControlsInUI.reduce((config, actionControl) => {\n\t\t\tconst configKey = actionControl.data(\"annotatedActionIdentifier\");\n\t\t\tif (configKey) {\n\t\t\t\tconfig[configKey] = {\n\t\t\t\t\ttitle: actionControl.getText()\n\t\t\t\t};\n\t\t\t\tif (manifestActionsConfig[configKey]) {\n\t\t\t\t\tconfig[configKey].isVisible = this.getActionVisibilityViaManifest(manifestActionsConfig[configKey]);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn config;\n\t\t}, {} as CustomActionConfigs);\n\t\tObject.keys(manifestActionsConfig).forEach((actionKey: string) => {\n\t\t\tif (actionKey.startsWith(\"DataFieldForAction\") && !actionConfig[actionKey]) {\n\t\t\t\tconst actionVisible = this.getActionVisibilityViaManifest(manifestActionsConfig[actionKey]);\n\t\t\t\tif (actionVisible !== undefined) {\n\t\t\t\t\tactionConfig[actionKey] = {\n\t\t\t\t\t\tisVisible: actionVisible\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn actionConfig;\n\t},\n\n\t/**\n\t * Returns action visiblity based on manifest configuration.\n\t * If the action has have dynamic visibility or enablement from manifest, it is not visible in the card.\n\t * @param manifestActionsConfig Manifest Action config\n\t * @returns Boolean value to indicate visibility of action\n\t */\n\tgetActionVisibilityViaManifest: function (manifestActionsConfig: ManifestAction): boolean | undefined {\n\t\tlet actionVisible = typeof manifestActionsConfig.visible === \"boolean\" ? manifestActionsConfig.visible : undefined;\n\t\tif (typeof manifestActionsConfig.visible === \"string\") {\n\t\t\tactionVisible = manifestActionsConfig.visible === \"true\" ? true : false;\n\t\t}\n\n\t\t// Enable is dynamic or statically false.\n\t\tif (actionVisible !== false) {\n\t\t\tif (\n\t\t\t\tmanifestActionsConfig.enabled === false ||\n\t\t\t\t(typeof manifestActionsConfig.enabled === \"string\" && manifestActionsConfig.enabled !== \"true\")\n\t\t\t) {\n\t\t\t\tactionVisible = false;\n\t\t\t}\n\t\t}\n\t\treturn actionVisible;\n\t},\n\n\t/**\n\t * Get header facets with title, position and visibility.\n\t * @param controller Object page controller\n\t * @returns Object of facets\n\t */\n\tgetHeaderFacetsConfig: function (controller: ObjectPageController): CustomHeaderFacetConfigs {\n\t\t// fetch the information about UI from object page layout\n\t\tconst dynamicHeaderControls = (controller._getObjectPageLayoutControl().getHeaderContent()[0] as HBox)?.getItems();\n\t\t// get visibility, title and manually calculate position from UI changes\n\n\t\tconst headerItems: CustomHeaderFacetConfigs = dynamicHeaderControls?.reduce(\n\t\t\t(cummulativeConfigs: CustomHeaderFacetConfigs, currentFacet: Control | StashableHBox) => {\n\t\t\t\tconst facetIdentifer: string | null = currentFacet.data(FACET_IDENTIFIER);\n\t\t\t\tif (facetIdentifer && currentFacet.isA<StashableHBox>(\"sap.fe.templates.ObjectPage.controls.StashableHBox\")) {\n\t\t\t\t\t// Direct StashableHBox is an equivalent of ReferenceFacet.\n\t\t\t\t\tconst formElementsConfig = ShareExtensionOverride._getFacetLabelsInfo(currentFacet);\n\t\t\t\t\tconst currentItem: HeaderFacetConfig = {\n\t\t\t\t\t\t// In case of key user changes from FLP, the visible property is not bound(modifier unbinds the control property).\n\n\t\t\t\t\t\t// If there is a binding then it can come from annotations or manifest.\n\t\t\t\t\t\t// We don't support manifest overrides for visible yet for header content in cards.\n\t\t\t\t\t\t// So, if there is a binding we fall back to annotations(default behaviour of Adaptive Card Generator).\n\n\t\t\t\t\t\t// If there is no binding, it might mean that there might be key user change or visible by default.\n\t\t\t\t\t\tisVisible: currentFacet.isBound(\"visible\") ? undefined : currentFacet.getVisible(),\n\t\t\t\t\t\ttitle: currentFacet.getTitle(),\n\t\t\t\t\t\tposition: {\n\t\t\t\t\t\t\tplacement: Placement.After,\n\t\t\t\t\t\t\tanchor: Object.keys(cummulativeConfigs).pop() || \"\"\n\t\t\t\t\t\t},\n\t\t\t\t\t\tformElementsConfig\n\t\t\t\t\t};\n\t\t\t\t\tcummulativeConfigs[facetIdentifer] = currentItem;\n\t\t\t\t\treturn cummulativeConfigs;\n\t\t\t\t}\n\t\t\t\treturn cummulativeConfigs;\n\t\t\t},\n\t\t\t{}\n\t\t);\n\t\treturn headerItems;\n\t},\n\n\t/**\n\t * Get form elements label configurations from facet.\n\t * @param facetControl StashableHBox control that represents the reference facet.\n\t * @returns Form elements' label text configurations\n\t */\n\t_getFacetLabelsInfo(facetControl: StashableHBox): CustomFormElementsConfig {\n\t\tconst labelCtrls = facetControl.getFormLabels();\n\n\t\treturn labelCtrls.reduce((allConfigs: CustomFormElementsConfig, label: Label) => {\n\t\t\tconst labelIdentifier = label.data(\"labelIdentifier\");\n\t\t\tconst labelText = label.getText();\n\t\t\tif (labelIdentifier) {\n\t\t\t\tallConfigs[labelIdentifier] = {\n\t\t\t\t\tlabelText: labelText.endsWith(\":\") ? labelText.substring(0, labelText.length - 1) : labelText\n\t\t\t\t};\n\t\t\t}\n\t\t\treturn allConfigs;\n\t\t}, {} as CustomFormElementsConfig);\n\t}\n};\n\nexport default ShareExtensionOverride;\n"],"mappings":"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","ignoreList":[],"file":"Share-dbg.js"}