/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/helpers/KeepAliveHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/library"],function(e,t,n,r,o){"use strict";const i=o.VariantManagement;const a={retrieve:function(e){return{selectedSection:e.getSelectedSection()}},apply:function(t,n){const r=n?.selectedSection;if(r){const n=t.getSections().find(e=>e.getId()===r);if(n?.getVisible()===false){const n=this.getView().getController();n.pageReady.waitPageReady().then(function(){t.setSelectedSection(r);return undefined}).catch(t=>{const n=t instanceof Error?t.message:String(t);e.error(`FE V4 : OP : ViewState : ObjectPageLayout state couldn't be applied : ${n}`)})}else{t.setSelectedSection(r)}}},refreshBinding:function(o){const i=o.getBindingContext();const a=i&&i.getBinding();if(a){const e=r.getMetaPathForContext(i);const s=n.getControlRefreshStrategyForContextPath(o,e);if(s==="self"){const n=i.getModel(),r=n.getMetaModel(),o=t.getContextPathProperties(r,e,{$kind:"NavigationProperty"})||{},s=Object.keys(o).reduce(function(e,t){if(o[t].$isCollection!==true){e.push({$NavigationPropertyPath:t})}return e},[]),c=[{$PropertyPath:"*"}],l=a.getGroupId();i.requestSideEffects(c.concat(s),l)}else if(s==="includingDependents"){a.refresh()}}else{e.info(`ObjectPage: ${o.getId()} was not refreshed. No binding found!`)}}};const s={_getObjectPageLayout:function(){const e=this.getView();const t=e.getController();return t._getObjectPageLayoutControl()},_getOPStateHandler:function(e){const t=s._getObjectPageLayout.call(this);if(t===e){return{retrieve:a.retrieve,apply:a.apply}}},_getOPRefreshHandler:function(e){const t=s._getObjectPageLayout.call(this);if(t===e){return{refreshBinding:a.refreshBinding}}},adaptControlStateHandler:function(e,t){const n=s._getOPStateHandler.call(this,e);if(n){t.push(n)}},adaptBindingRefreshHandler:function(e,t){const n=s._getOPRefreshHandler.call(this,e);if(n){t.refreshBinding=n.refreshBinding}},applyInitialStateOnly:function(){return false},adaptStateControls:function(e){const t=this.base.getView(),n=t.getViewData();switch(n.variantManagement){case i.Control:break;case i.Page:case i.None:break;default:throw new Error(`unhandled variant setting: ${n.variantManagement}`)}e.push(t.byId("fe::ObjectPage"))},adaptBindingRefreshControls:function(e){const t=this.base.getView(),r=n.getViewRefreshInfo(t),o=t.getController();let i=[];if(r){const e=o._getObjectPageLayoutControl();i.push(e)}if(r!=="includingDependents"){const e=o._findTables();i=i.concat(n.getControlsForRefresh(t,e)||[])}return i.reduce(function(e,t){if(!e.includes(t)){e.push(t)}return e},e)}};return s},false);
//# sourceMappingURL=ViewState.js.map