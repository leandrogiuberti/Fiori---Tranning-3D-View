{"version":3,"names":["USERS_PARAMETERS","USER_ID_PARAMETER","CollaborationDraft","_dec","defineUI5Class","_dec2","property","type","required","_dec3","_class","_class2","_BuildingBlock","props","others","_this","call","_initializerDefineProperty","_descriptor","_descriptor2","showCollaborationUserDetails","event","source","getSource","userDetailsPopover","getUserDetailsPopover","setBindingContext","getBindingContext","openBy","manageCollaboration","manageDialog","getManageDialog","readInvitedUsers","open","formatUserStatus","userStatus","UserStatus","CurrentlyEditing","getTranslatedText","ChangesMade","NoChangesMade","NotYetInvited","addUserFieldChanged","userInput","getParameter","then","newUserId","internalModelContext","invitedUsers","getProperty","newUser","id","name","findIndex","user","setValueState","setValueStateText","addUser","bind","catch","inviteUser","users","newlyInvitedUsers","bindingContext","contexts","manageDialogUserTable","getBinding","getContexts","forEach","context","push","UserID","UserAccessRole","results","Promise","all","shareObject","requestInvitedUsersInDraft","newUsers","invitedUser","includes","messageHandler","getPageController","showMessageDialog","length","MessageToast","show","getSharedItemName","toString","closeManageDialog","currentUserList","activeUsers","getModel","me","CollaborationUtils","getMe","getAppComponent","userContext","userData","getObject","isMe","isActive","find","u","userDescription","UserDescription","initials","formatInitials","getText","UserEditingState","InProgress","status","color","getUserColor","setProperty","e","close","destroy","_exports","_inheritsLoose","_proto","prototype","onMetadataAvailable","_ownerComponent","_controlLoaded","PromiseKeeper","GridTableControl","undefined","Lib","load","default","__ui5_require_async","GridTableColumnControl","contextObject","getDataModelObjectPath","contextPath","content","createContent","resolve","_jsx","ResponsivePopover","showHeader","class","placement","children","_jsxs","HBox","Avatar","displaySize","backgroundColor","VBox","Label","text","addDependent","Dialog","title","getInvitationDialogTitleExpBinding","horizontalScrolling","verticalScrolling","contentWidth","stretch","CommonHelper","isDesktop","beginButton","Button","press","enabled","parts","path","formatter","formatInviteButton","endButton","width","MessageStrip","showIcon","showCloseButton","getManageDialogAddUserSection","getManageDialogUserTable","bindElement","model","getManageDialogUserTableColumns","_Fragment","template","alignItems","justifyContent","label","Text","ObjectStatus","state","formatUserStatusColor","icon","removeUser","visible","rows","visibleRowCount","visibleRowCountMode","selectionMode","columns","Field","value","additionalValue","display","valueHelp","placeholder","change","dependents","ValueHelp","delegate","getValueHelpDelegate","validateInput","typeahead","MDCPopover","MTable","caseSensitive","useAsValueHelp","dialog","MDCDialog","ValueState","Success","Warning","Information","nbUsers","some","transient","item","deleteUserID","filter","parameters","$select","$$groupId","invitedUserList","bindList","getPath","requestContexts","headerInfo","targetEntityType","annotations","UI","HeaderInfo","sharedItemName","Title","isAnnotationOfType","isPathAnnotationExpression","Value","TypeName","actionName","targetEntitySet","Common","DraftRoot","ShareAction","action","resolvePath","userParameters","param","payload","propertyPath","qualifiers","valueHelpQualifier","isActionParameterDialog","getExpressionFromAnnotation","params","titleExpression","formatResult","collaborationFormatter","getFormattedText","compileExpression","getInviteButton","src","_getOwner","getMetaModel","ModelHelper","isCollaborationDraftSupported","items","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["CollaborationDraft.tsx"],"sourcesContent":["import type { EntitySet, Action as VocabularyAction } from \"@sap-ux/vocabularies-types/Edm\";\nimport type { EntitySetAnnotations_Common } from \"@sap-ux/vocabularies-types/vocabularies/Common_Edm\";\nimport type { DataField, DataFieldTypes } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport { UIAnnotationTypes } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport type { CompiledBindingToolkitExpression } from \"sap/fe/base/BindingToolkit\";\nimport { compileExpression, formatResult, getExpressionFromAnnotation } from \"sap/fe/base/BindingToolkit\";\nimport type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { defineUI5Class, property } from \"sap/fe/base/ClassSupport\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport type { BackendUser, User } from \"sap/fe/core/controllerextensions/collaboration/CollaborationCommon\";\nimport {\n\tCollaborationUtils,\n\tUserEditingState,\n\tUserStatus,\n\tshareObject\n} from \"sap/fe/core/controllerextensions/collaboration/CollaborationCommon\";\nimport collaborationFormatter from \"sap/fe/core/formatters/CollaborationFormatter\";\nimport type { InternalModelContext } from \"sap/fe/core/helpers/ModelHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport PromiseKeeper from \"sap/fe/core/helpers/PromiseKeeper\";\nimport { isAnnotationOfType, isPathAnnotationExpression } from \"sap/fe/core/helpers/TypeGuards\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport CommonHelper from \"sap/fe/macros/CommonHelper\";\nimport type { ValueHelpPayload } from \"sap/fe/macros/internal/valuehelp/ValueListHelper\";\nimport Avatar from \"sap/m/Avatar\";\nimport Button from \"sap/m/Button\";\nimport Dialog from \"sap/m/Dialog\";\nimport HBox from \"sap/m/HBox\";\nimport Label from \"sap/m/Label\";\nimport MessageStrip from \"sap/m/MessageStrip\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport ObjectStatus from \"sap/m/ObjectStatus\";\nimport ResponsivePopover from \"sap/m/ResponsivePopover\";\nimport type Table from \"sap/m/Table\";\nimport Text from \"sap/m/Text\";\nimport VBox from \"sap/m/VBox\";\nimport type Event from \"sap/ui/base/Event\";\nimport type Control from \"sap/ui/core/Control\";\nimport Lib from \"sap/ui/core/Lib\";\nimport { ValueState } from \"sap/ui/core/library\";\nimport type { Field$ChangeEvent } from \"sap/ui/mdc/Field\";\nimport Field from \"sap/ui/mdc/Field\";\nimport ValueHelp from \"sap/ui/mdc/ValueHelp\";\nimport MDCDialog from \"sap/ui/mdc/valuehelp/Dialog\";\nimport MDCPopover from \"sap/ui/mdc/valuehelp/Popover\";\nimport MTable from \"sap/ui/mdc/valuehelp/content/MTable\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type Integer from \"sap/ui/model/type/Integer\";\nimport type GridTableColumn from \"sap/ui/table/Column\";\nimport type GridTable from \"sap/ui/table/Table\";\n\nconst USERS_PARAMETERS = \"Users\";\nconst USER_ID_PARAMETER = \"UserID\";\n\n@defineUI5Class(\"sap.fe.templates.ObjectPage.components.CollaborationDraft\")\nexport default class CollaborationDraft extends BuildingBlock {\n\t@property({ type: \"string\", required: true })\n\tpublic contextPath!: string;\n\n\t@property({ type: \"string\" })\n\tpublic id?: string;\n\n\tprivate contextObject?: DataModelObjectPath<EntitySet>;\n\n\tprivate userDetailsPopover?: ResponsivePopover;\n\n\tprivate manageDialog?: Dialog;\n\n\tprivate manageDialogUserTable?: Table;\n\n\tprivate static GridTableControl: typeof GridTable;\n\n\tprivate static GridTableColumnControl: typeof GridTableColumn;\n\n\tprivate _controlLoaded?: PromiseKeeper<void>;\n\n\tconstructor(props: PropertiesOf<CollaborationDraft>, others?: PropertiesOf<CollaborationDraft>) {\n\t\tsuper(props, others);\n\t}\n\n\tasync onMetadataAvailable(_ownerComponent: TemplateComponent): Promise<void> {\n\t\tthis._controlLoaded = new PromiseKeeper();\n\t\tif (CollaborationDraft.GridTableControl === undefined) {\n\t\t\tawait Lib.load({ name: \"sap.ui.table\" });\n\t\t\tconst { default: GridTableControl } = await import(\"sap/ui/table/Table\");\n\t\t\tCollaborationDraft.GridTableControl = GridTableControl;\n\t\t\tconst { default: GridTableColumnControl } = await import(\"sap/ui/table/Column\");\n\t\t\tCollaborationDraft.GridTableColumnControl = GridTableColumnControl;\n\t\t}\n\t\tthis.contextObject = this.getDataModelObjectPath(this.contextPath);\n\t\tthis.content = this.createContent();\n\t\tthis._controlLoaded.resolve();\n\t}\n\n\t/**\n\t * Event handler to create and show the user details popover.\n\t * @param event The event object\n\t */\n\tshowCollaborationUserDetails = (event: Event<{}, Control>): void => {\n\t\tconst source = event.getSource();\n\t\tif (!this.userDetailsPopover) {\n\t\t\tthis.userDetailsPopover = this.getUserDetailsPopover();\n\t\t}\n\n\t\tthis.userDetailsPopover?.setBindingContext(source.getBindingContext(\"internal\") as InternalModelContext, \"internal\");\n\t\tthis.userDetailsPopover?.openBy(source);\n\t};\n\n\t/**\n\t * Returns the user details popover.\n\t * @returns The control tree\n\t */\n\tgetUserDetailsPopover(): ResponsivePopover {\n\t\tconst userDetailsPopover = (\n\t\t\t<ResponsivePopover showHeader={false} class=\"sapUiContentPadding\" placement=\"Bottom\">\n\t\t\t\t<HBox>\n\t\t\t\t\t<Avatar initials=\"{internal>initials}\" displaySize=\"S\" backgroundColor=\"{internal>color}\" />\n\t\t\t\t\t<VBox>\n\t\t\t\t\t\t<Label class=\"sapUiMediumMarginBegin\" text=\"{internal>name}\" />\n\t\t\t\t\t\t<Label class=\"sapUiMediumMarginBegin\" text=\"{internal>id}\" />\n\t\t\t\t\t</VBox>\n\t\t\t\t</HBox>\n\t\t\t</ResponsivePopover>\n\t\t);\n\n\t\tthis.addDependent(userDetailsPopover);\n\n\t\treturn userDetailsPopover;\n\t}\n\n\t/**\n\t * Event handler to create and open the manage dialog.\n\t *\n\t */\n\tmanageCollaboration = (): void => {\n\t\tif (!this.manageDialog) {\n\t\t\tthis.manageDialog = this.getManageDialog();\n\t\t}\n\n\t\tthis.readInvitedUsers();\n\t\tthis.manageDialog?.open();\n\t};\n\n\t/**\n\t * Returns the manage dialog used to invite further users.\n\t * @returns The control tree\n\t */\n\tgetManageDialog(): Dialog {\n\t\tconst manageDialog = (\n\t\t\t<Dialog\n\t\t\t\ttitle={this.getInvitationDialogTitleExpBinding()}\n\t\t\t\thorizontalScrolling=\"False\"\n\t\t\t\tverticalScrolling=\"False\"\n\t\t\t\tcontentWidth=\"35em\"\n\t\t\t\tstretch={CommonHelper.isDesktop() ? \"false\" : \"true\"}\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tbeginButton: (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttext={this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_DIALOG_CONFIRMATION\")}\n\t\t\t\t\t\t\tpress={this.inviteUser}\n\t\t\t\t\t\t\ttype=\"Emphasized\"\n\t\t\t\t\t\t\tenabled={{\n\t\t\t\t\t\t\t\tparts: [{ path: \"internal>invitedUsers/length\" }, { path: \"internal>invitedUsers\" }],\n\t\t\t\t\t\t\t\tformatter: this.formatInviteButton\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t),\n\t\t\t\t\tendButton: (\n\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\ttext={this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_DIALOG_CANCEL\")}\n\t\t\t\t\t\t\tpress={this.closeManageDialog}\n\t\t\t\t\t\t/>\n\t\t\t\t\t),\n\t\t\t\t\tcontent: (\n\t\t\t\t\t\t<VBox class=\"sapUiSmallMargin\">\n\t\t\t\t\t\t\t<VBox width=\"100%\">\n\t\t\t\t\t\t\t\t<MessageStrip\n\t\t\t\t\t\t\t\t\ttext={this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_MESSAGESTRIP\")}\n\t\t\t\t\t\t\t\t\ttype=\"Information\"\n\t\t\t\t\t\t\t\t\tshowIcon={true}\n\t\t\t\t\t\t\t\t\tshowCloseButton={false}\n\t\t\t\t\t\t\t\t\tclass=\"sapUiMediumMarginBottom\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</VBox>\n\t\t\t\t\t\t\t<Label text={this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_INPUT_LABEL\")} required={true} />\n\t\t\t\t\t\t\t{this.getManageDialogAddUserSection()}\n\t\t\t\t\t\t\t{this.getManageDialogUserTable()}\n\t\t\t\t\t\t</VBox>\n\t\t\t\t\t)\n\t\t\t\t}}\n\t\t\t</Dialog>\n\t\t);\n\n\t\tthis.addDependent(manageDialog);\n\t\tmanageDialog.bindElement({\n\t\t\tmodel: \"internal\",\n\t\t\tpath: \"collaboration\"\n\t\t});\n\n\t\treturn manageDialog;\n\t}\n\n\t/**\n\t * Returning the table column with the list of invited users.\n\t * @returns The control tree\n\t */\n\tgetManageDialogUserTableColumns(): GridTableColumn[] {\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<CollaborationDraft.GridTableColumnControl width={CommonHelper.isDesktop() ? \"10%\" : \"3em\"}>\n\t\t\t\t\t{{\n\t\t\t\t\t\ttemplate: (\n\t\t\t\t\t\t\t<HBox alignItems=\"Center\" justifyContent=\"SpaceBetween\">\n\t\t\t\t\t\t\t\t<Avatar displaySize=\"XS\" backgroundColor=\"{internal>color}\" initials=\"{internal>initials}\" />\n\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t</CollaborationDraft.GridTableColumnControl>\n\t\t\t\t<CollaborationDraft.GridTableColumnControl width={CommonHelper.isDesktop() ? \"35%\" : \"6em\"}>\n\t\t\t\t\t{{\n\t\t\t\t\t\tlabel: <Text text={this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_TABLE_USER_COLUMN\")} />,\n\t\t\t\t\t\ttemplate: <Text text=\"{internal>name}\" />\n\t\t\t\t\t}}\n\t\t\t\t</CollaborationDraft.GridTableColumnControl>\n\t\t\t\t<CollaborationDraft.GridTableColumnControl width={CommonHelper.isDesktop() ? \"46%\" : \"9em\"}>\n\t\t\t\t\t{{\n\t\t\t\t\t\tlabel: <Text text={this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_TABLE_USER_STATUS_COLUMN\")} />,\n\t\t\t\t\t\ttemplate: (\n\t\t\t\t\t\t\t<ObjectStatus\n\t\t\t\t\t\t\t\tstate={{ path: \"internal>status\", formatter: this.formatUserStatusColor }}\n\t\t\t\t\t\t\t\ttext={{ path: \"internal>status\", formatter: this.formatUserStatus }}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t</CollaborationDraft.GridTableColumnControl>\n\t\t\t\t<CollaborationDraft.GridTableColumnControl width={CommonHelper.isDesktop() ? \"8%\" : \"3em\"}>\n\t\t\t\t\t{{\n\t\t\t\t\t\ttemplate: (\n\t\t\t\t\t\t\t<HBox>\n\t\t\t\t\t\t\t\t<Button\n\t\t\t\t\t\t\t\t\ticon=\"sap-icon://decline\"\n\t\t\t\t\t\t\t\t\ttype=\"Transparent\"\n\t\t\t\t\t\t\t\t\tpress={this.removeUser}\n\t\t\t\t\t\t\t\t\tvisible=\"{= !!${internal>transient} }\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</HBox>\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t</CollaborationDraft.GridTableColumnControl>\n\t\t\t</>\n\t\t);\n\t}\n\n\t/**\n\t * Returns the table with the list of invited users.\n\t * @returns The control tree\n\t */\n\tgetManageDialogUserTable(): Table | undefined {\n\t\tthis.manageDialogUserTable = (\n\t\t\t<CollaborationDraft.GridTableControl\n\t\t\t\twidth=\"100%\"\n\t\t\t\trows={{ path: \"internal>invitedUsers\" }}\n\t\t\t\tvisibleRowCount={CommonHelper.isDesktop() ? \"5\" : \"3\"}\n\t\t\t\tvisibleRowCountMode=\"Fixed\"\n\t\t\t\tselectionMode=\"None\"\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tcolumns: this.getManageDialogUserTableColumns()\n\t\t\t\t}}\n\t\t\t</CollaborationDraft.GridTableControl>\n\t\t);\n\t\treturn this.manageDialogUserTable;\n\t}\n\n\t/**\n\t * Returns the section on the dialog related to the user field.\n\t * @returns The control tree\n\t */\n\tgetManageDialogAddUserSection(): HBox {\n\t\treturn (\n\t\t\t<HBox class=\"sapUiMediumMarginBottom\" width=\"100%\">\n\t\t\t\t<Field\n\t\t\t\t\tvalue=\"{internal>UserID}\"\n\t\t\t\t\tadditionalValue=\"{internal>UserDescription}\"\n\t\t\t\t\tdisplay=\"DescriptionValue\"\n\t\t\t\t\twidth=\"20em\"\n\t\t\t\t\trequired={true}\n\t\t\t\t\tvalueHelp=\"userValueHelp\"\n\t\t\t\t\tplaceholder={this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_INPUT_PLACEHOLDER\")}\n\t\t\t\t\tchange={this.addUserFieldChanged}\n\t\t\t\t>\n\t\t\t\t\t{{\n\t\t\t\t\t\tdependents: (\n\t\t\t\t\t\t\t<ValueHelp id=\"userValueHelp\" delegate={this.getValueHelpDelegate()} validateInput={true}>\n\t\t\t\t\t\t\t\t{{\n\t\t\t\t\t\t\t\t\ttypeahead: (\n\t\t\t\t\t\t\t\t\t\t<MDCPopover>\n\t\t\t\t\t\t\t\t\t\t\t<MTable caseSensitive=\"true\" useAsValueHelp=\"false\" />\n\t\t\t\t\t\t\t\t\t\t</MDCPopover>\n\t\t\t\t\t\t\t\t\t),\n\t\t\t\t\t\t\t\t\tdialog: <MDCDialog />\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t</ValueHelp>\n\t\t\t\t\t\t)\n\t\t\t\t\t}}\n\t\t\t\t</Field>\n\t\t\t</HBox>\n\t\t);\n\t}\n\n\t/**\n\t * Formatter to set the user status depending on the editing status.\n\t * @param userStatus The editing status of the user\n\t * @returns The user status\n\t */\n\tformatUserStatus = (userStatus: UserStatus): string => {\n\t\tswitch (userStatus) {\n\t\t\tcase UserStatus.CurrentlyEditing:\n\t\t\t\treturn this.getTranslatedText(\"C_COLLABORATIONDRAFT_USER_CURRENTLY_EDITING\");\n\t\t\tcase UserStatus.ChangesMade:\n\t\t\t\treturn this.getTranslatedText(\"C_COLLABORATIONDRAFT_USER_CHANGES_MADE\");\n\t\t\tcase UserStatus.NoChangesMade:\n\t\t\t\treturn this.getTranslatedText(\"C_COLLABORATIONDRAFT_USER_NO_CHANGES_MADE\");\n\t\t\tcase UserStatus.NotYetInvited:\n\t\t\tdefault:\n\t\t\t\treturn this.getTranslatedText(\"C_COLLABORATIONDRAFT_USER_NOT_YET_INVITED\");\n\t\t}\n\t};\n\n\t/**\n\t * Formatter to set the user color depending on the editing status.\n\t * @param userStatus The editing status of the user\n\t * @returns The user status color\n\t */\n\tformatUserStatusColor(userStatus: UserStatus): ValueState {\n\t\tswitch (userStatus) {\n\t\t\tcase UserStatus.CurrentlyEditing:\n\t\t\t\treturn ValueState.Success;\n\t\t\tcase UserStatus.ChangesMade:\n\t\t\t\treturn ValueState.Warning;\n\t\t\tcase UserStatus.NoChangesMade:\n\t\t\tcase UserStatus.NotYetInvited:\n\t\t\tdefault:\n\t\t\t\treturn ValueState.Information;\n\t\t}\n\t}\n\n\t/**\n\t * Formatter to enable the invite button depending on the invited users status.\n\t * @param nbUsers Number of users\n\t * @param invitedUsers List of the invited users\n\t * @returns True or False\n\t */\n\tformatInviteButton(nbUsers: Integer | undefined, invitedUsers: User[] | undefined): boolean {\n\t\tif (!nbUsers) {\n\t\t\treturn false;\n\t\t}\n\t\treturn !!invitedUsers?.some((user) => user.status === 0);\n\t}\n\n\t/**\n\t * Add the added user to the list of invited users.\n\t * @param userInput The user to be invited\n\t * @param invitedUsers The users already invited\n\t * @param newUser The user to be invited\n\t */\n\taddUser(userInput: Field, invitedUsers: User[], newUser: User): void {\n\t\tconst internalModelContext = userInput.getBindingContext(\"internal\") as InternalModelContext;\n\t\tconst activeUsers = (userInput.getModel(\"internal\") as JSONModel).getProperty(\"/collaboration/activeUsers\");\n\t\tnewUser.name = newUser.name || newUser.id;\n\t\tnewUser.initials = CollaborationUtils.formatInitials(newUser.name);\n\t\tnewUser.color = CollaborationUtils.getUserColor(newUser.id, activeUsers, invitedUsers);\n\t\tnewUser.transient = true;\n\t\tnewUser.status = UserStatus.NotYetInvited;\n\t\tinvitedUsers.push(newUser);\n\t\tinternalModelContext.setProperty(\"invitedUsers\", invitedUsers);\n\t\tinternalModelContext.setProperty(\"UserID\", \"\");\n\t\tinternalModelContext.setProperty(\"UserDescription\", \"\");\n\t}\n\n\t/**\n\t * Sets the value state of the user field whenever changed.\n\t * @param event The event object of the user input\n\t * @returns Promise that is resolved once the value state was set.\n\t */\n\taddUserFieldChanged = async (event: Field$ChangeEvent): Promise<void> => {\n\t\tconst userInput = event.getSource();\n\t\treturn event\n\t\t\t.getParameter(\"promise\")\n\t\t\t?.then(\n\t\t\t\tfunction (this: CollaborationDraft, newUserId: string): void {\n\t\t\t\t\tconst internalModelContext = userInput.getBindingContext(\"internal\") as InternalModelContext;\n\t\t\t\t\tconst invitedUsers: User[] = internalModelContext.getProperty(\"invitedUsers\") || [];\n\t\t\t\t\tconst newUser: User = {\n\t\t\t\t\t\tid: internalModelContext?.getProperty(\"UserID\"),\n\t\t\t\t\t\tname: internalModelContext?.getProperty(\"UserDescription\")\n\t\t\t\t\t};\n\t\t\t\t\tif (invitedUsers.findIndex((user) => user.id === newUserId) > -1) {\n\t\t\t\t\t\tuserInput.setValueState(\"Error\");\n\t\t\t\t\t\tuserInput.setValueStateText(this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_USER_ERROR\"));\n\t\t\t\t\t} else if (\n\t\t\t\t\t\t!(\n\t\t\t\t\t\t\tinvitedUsers.findIndex((user) => user.id === newUser.id) > -1 ||\n\t\t\t\t\t\t\t(newUser.id === newUser.name && newUser.id === \"\")\n\t\t\t\t\t\t)\n\t\t\t\t\t) {\n\t\t\t\t\t\tthis.addUser(userInput, invitedUsers, newUser);\n\t\t\t\t\t\tuserInput.setValueState(\"None\");\n\t\t\t\t\t\tuserInput.setValueStateText(\"\");\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t)\n\t\t\t.catch(\n\t\t\t\tfunction (this: CollaborationDraft): void {\n\t\t\t\t\tuserInput.setValueState(\"Warning\");\n\t\t\t\t\tuserInput.setValueStateText(this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_USER_NOT_FOUND\"));\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t};\n\n\t/**\n\t * Event handler to remove a user from the list of invited user.\n\t * @param event The event object of the remove button\n\t */\n\tremoveUser(event: Event<{}, Button>): void {\n\t\tconst item = event.getSource();\n\t\tconst internalModelContext = item?.getBindingContext(\"pageInternal\");\n\t\tconst deleteUserID = item?.getBindingContext(\"internal\")?.getProperty(\"id\");\n\t\tlet invitedUsers: User[] = internalModelContext?.getProperty(\"collaboration/invitedUsers\");\n\t\tinvitedUsers = invitedUsers.filter((user) => user.id !== deleteUserID);\n\t\tinternalModelContext?.setProperty(\"collaboration/invitedUsers\", invitedUsers);\n\t}\n\n\t/**\n\t * Call the share action to update the list of invited users.\n\t * @param event The event object of the invite button\n\t */\n\tinviteUser = async (event: Event<{}, Button>): Promise<void> => {\n\t\tconst users: BackendUser[] = [],\n\t\t\tnewlyInvitedUsers: string[] = [];\n\t\tconst source = event.getSource();\n\t\tconst bindingContext = source.getBindingContext() as Context;\n\t\tconst contexts = (this.manageDialogUserTable?.getBinding(\"rows\") as ODataListBinding).getContexts();\n\t\tcontexts.forEach(function (context) {\n\t\t\tusers.push({\n\t\t\t\tUserID: context.getProperty(\"id\"),\n\t\t\t\tUserAccessRole: \"O\" // For now according to UX every user retrieves the owner role\n\t\t\t});\n\t\t\tif (context.getProperty(\"status\") === UserStatus.NotYetInvited) {\n\t\t\t\tnewlyInvitedUsers.push(context.getProperty(\"id\"));\n\t\t\t}\n\t\t});\n\n\t\ttry {\n\t\t\t// We request the number of invited users after the share action to see how many users were really invited\n\t\t\tconst results = await Promise.all([shareObject(bindingContext, users), this.requestInvitedUsersInDraft()]);\n\t\t\tconst newUsers: Context[] = [];\n\t\t\tresults[1].forEach((invitedUser) => {\n\t\t\t\tif (newlyInvitedUsers.includes(invitedUser.getProperty(\"UserID\"))) {\n\t\t\t\t\tnewUsers.push(invitedUser);\n\t\t\t\t}\n\t\t\t});\n\t\t\tconst messageHandler = this.getPageController()!.messageHandler;\n\t\t\tawait messageHandler.showMessageDialog();\n\n\t\t\tswitch (newUsers.length) {\n\t\t\t\tcase 0:\n\t\t\t\t\tMessageToast.show(\n\t\t\t\t\t\tthis.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_SUCCESS_TOAST_NO_USER\", [\n\t\t\t\t\t\t\tthis.getSharedItemName(bindingContext)\n\t\t\t\t\t\t])\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 1:\n\t\t\t\t\tMessageToast.show(\n\t\t\t\t\t\tthis.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_SUCCESS_TOAST\", [this.getSharedItemName(bindingContext)])\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tMessageToast.show(\n\t\t\t\t\t\tthis.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_SUCCESS_TOAST_PLURAL\", [\n\t\t\t\t\t\t\tnewUsers.length.toString(),\n\t\t\t\t\t\t\tthis.getSharedItemName(bindingContext)\n\t\t\t\t\t\t])\n\t\t\t\t\t);\n\t\t\t}\n\t\t} catch {\n\t\t\tMessageToast.show(this.getTranslatedText(\"C_COLLABORATIONDRAFT_INVITATION_FAILED_TOAST\"));\n\t\t}\n\t\tthis.closeManageDialog();\n\t};\n\n\t/**\n\t * Fetches the list of users that are already invited in the draft.\n\t * @returns Promise with the list of user contexts.\n\t */\n\tprivate async requestInvitedUsersInDraft(): Promise<Context[]> {\n\t\tconst model = this.getModel();\n\t\tconst parameters = {\n\t\t\t$select: \"UserID,UserDescription,UserEditingState\",\n\t\t\t$$groupId: \"$auto.Workers\"\n\t\t};\n\t\tconst invitedUserList = model?.bindList(\n\t\t\t`${this.getBindingContext()?.getPath()}/DraftAdministrativeData/DraftAdministrativeUser`,\n\t\t\tundefined,\n\t\t\t[],\n\t\t\t[],\n\t\t\tparameters\n\t\t) as ODataListBinding;\n\n\t\t// for now we set a limit to 100. there shouldn't be more than a few\n\t\treturn invitedUserList.requestContexts(0, 100);\n\t}\n\n\t/**\n\t * Reads the currently invited user and store it in the internal model.\n\t * @returns Promise that is resolved once the users are read.\n\t */\n\treadInvitedUsers = async (): Promise<void> => {\n\t\tconst internalModelContext = this.getBindingContext(\"internal\") as InternalModelContext;\n\n\t\ttry {\n\t\t\tconst currentUserList = await this.requestInvitedUsersInDraft();\n\t\t\tconst invitedUsers: User[] = [];\n\t\t\tconst activeUsers = this.getModel(\"internal\")?.getProperty(\"/collaboration/activeUsers\") || [];\n\t\t\tconst me = CollaborationUtils.getMe(this.getAppComponent()!);\n\t\t\tlet userStatus: UserStatus;\n\t\t\tif (currentUserList.length > 0) {\n\t\t\t\tcurrentUserList.forEach((userContext) => {\n\t\t\t\t\tconst userData = userContext.getObject() as BackendUser;\n\t\t\t\t\tconst isMe: boolean = me?.id === userData.UserID;\n\t\t\t\t\tconst isActive = activeUsers.find((u: User) => u.id === userData.UserID);\n\t\t\t\t\tlet userDescription = userData.UserDescription || userData.UserID;\n\t\t\t\t\tconst initials = CollaborationUtils.formatInitials(userDescription);\n\t\t\t\t\tuserDescription = isMe ? `${CollaborationUtils.getText(\"C_COLLABORATIONDRAFT_ME\", userDescription)}` : userDescription;\n\t\t\t\t\tif (isActive) {\n\t\t\t\t\t\tuserStatus = UserStatus.CurrentlyEditing;\n\t\t\t\t\t} else if (userData.UserEditingState === UserEditingState.InProgress) {\n\t\t\t\t\t\tuserStatus = UserStatus.ChangesMade;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tuserStatus = UserStatus.NoChangesMade;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst user: User = {\n\t\t\t\t\t\tid: userData.UserID,\n\t\t\t\t\t\tname: userDescription,\n\t\t\t\t\t\tstatus: userStatus,\n\t\t\t\t\t\tcolor: CollaborationUtils.getUserColor(userData.UserID, activeUsers, invitedUsers),\n\t\t\t\t\t\tinitials: initials,\n\t\t\t\t\t\tme: isMe\n\t\t\t\t\t};\n\t\t\t\t\tinvitedUsers.push(user);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\t//not yet shared, just add me\n\t\t\t\tinvitedUsers.push(me);\n\t\t\t}\n\t\t\tinternalModelContext.setProperty(\"collaboration/UserID\", \"\");\n\t\t\tinternalModelContext.setProperty(\"collaboration/UserDescription\", \"\");\n\t\t\tinternalModelContext.setProperty(\"collaboration/invitedUsers\", invitedUsers);\n\t\t} catch (e) {\n\t\t\tMessageToast.show(this.getTranslatedText(\"C_COLLABORATIONDRAFT_READING_USER_FAILED\"));\n\t\t}\n\t};\n\n\t/**\n\t * Get the name of the object to be shared.\n\t * @param bindingContext The context of the page.\n\t * @returns The name of the object to be shared.\n\t */\n\tgetSharedItemName(bindingContext: Context): string {\n\t\tconst headerInfo = this.contextObject?.targetEntityType.annotations.UI?.HeaderInfo;\n\t\tlet sharedItemName = \"\";\n\t\tconst title = headerInfo?.Title;\n\t\tif (\n\t\t\ttitle &&\n\t\t\tisAnnotationOfType<DataFieldTypes>(title, [\n\t\t\t\tUIAnnotationTypes.DataField,\n\t\t\t\tUIAnnotationTypes.DataFieldWithAction,\n\t\t\t\tUIAnnotationTypes.DataFieldWithActionGroup,\n\t\t\t\tUIAnnotationTypes.DataFieldWithNavigationPath,\n\t\t\t\tUIAnnotationTypes.DataFieldWithIntentBasedNavigation,\n\t\t\t\tUIAnnotationTypes.DataFieldWithUrl,\n\t\t\t\tUIAnnotationTypes.DataFieldWithNavigationPath\n\t\t\t])\n\t\t) {\n\t\t\tsharedItemName = isPathAnnotationExpression(title.Value) ? bindingContext.getProperty(title.Value.path) : title.Value;\n\t\t}\n\t\treturn sharedItemName || (headerInfo?.TypeName as unknown as string) || \"\";\n\t}\n\n\t/**\n\t * Generates the delegate payload for the user field value help.\n\t * @returns The value help delegate payload\n\t */\n\tgetValueHelpDelegate(): { name: string; payload: ValueHelpPayload } {\n\t\t// The non null assertion is safe here, because the action is only available if the annotation is present\n\t\tconst actionName = (\n\t\t\tthis.contextObject?.targetEntitySet!.annotations.Common as EntitySetAnnotations_Common\n\t\t).DraftRoot!.ShareAction!.toString();\n\t\t// We are also sure that the action exist\n\t\tconst action = this.contextObject?.targetEntityType.resolvePath(actionName) as VocabularyAction;\n\t\t// By definition the action has a parameter with the name \"Users\"\n\t\tconst userParameters = action.parameters.find((param) => param.name === USERS_PARAMETERS)!;\n\n\t\treturn {\n\t\t\tname: \"sap/fe/macros/valuehelp/ValueHelpDelegate\",\n\t\t\tpayload: {\n\t\t\t\tpropertyPath: `/${userParameters.type}/${USER_ID_PARAMETER}`,\n\t\t\t\tqualifiers: {},\n\t\t\t\tvalueHelpQualifier: \"\",\n\t\t\t\tisActionParameterDialog: true\n\t\t\t}\n\t\t};\n\t}\n\n\t/**\n\t * Generate the expression binding of the Invitation dialog.\n\t * @returns The dialog title binding expression\n\t */\n\tgetInvitationDialogTitleExpBinding(): CompiledBindingToolkitExpression {\n\t\tconst headerInfo = this.contextObject?.targetEntityType.annotations.UI?.HeaderInfo;\n\t\tconst title = getExpressionFromAnnotation((headerInfo?.Title as DataField | undefined)?.Value, [], \"\");\n\t\tconst params = [\"C_COLLABORATIONDRAFT_INVITATION_DIALOG\", headerInfo?.TypeName.toString(), title];\n\t\tconst titleExpression = formatResult(params, collaborationFormatter.getFormattedText);\n\t\treturn compileExpression(titleExpression);\n\t}\n\n\t/**\n\t * Event handler to close the manage dialog.\n\t *\n\t */\n\tcloseManageDialog = (): void => {\n\t\tthis.manageDialog?.close();\n\t\tthis.manageDialog?.destroy();\n\t\tdelete this.manageDialog;\n\t};\n\n\t/**\n\t * Returns the invite button if there's a share action on root level.\n\t * @returns The control tree\n\t */\n\tgetInviteButton(): HBox {\n\t\tif ((this.contextObject?.targetEntitySet?.annotations.Common as EntitySetAnnotations_Common)?.DraftRoot?.ShareAction) {\n\t\t\treturn (\n\t\t\t\t<HBox visible=\"{ui>/isEditable}\" alignItems=\"Center\" justifyContent=\"Start\">\n\t\t\t\t\t<Avatar backgroundColor=\"TileIcon\" src=\"sap-icon://add-employee\" displaySize=\"XS\" press={this.manageCollaboration} />\n\t\t\t\t</HBox>\n\t\t\t);\n\t\t} else {\n\t\t\treturn <HBox />;\n\t\t}\n\t}\n\n\t/**\n\t * Returns the content of the collaboration draft building block.\n\t * @returns The control tree\n\t */\n\tcreateContent(): Control | undefined {\n\t\tif (this._getOwner()?.getMetaModel() && ModelHelper.isCollaborationDraftSupported(this._getOwner()!.getMetaModel())) {\n\t\t\treturn (\n\t\t\t\t<HBox>\n\t\t\t\t\t<HBox\n\t\t\t\t\t\titems={{ path: \"internal>/collaboration/activeUsers\" }}\n\t\t\t\t\t\tclass=\"sapUiTinyMarginBegin\"\n\t\t\t\t\t\tvisible=\"{= ${ui>/isEditable} &amp;&amp; ${internal>/collaboration/connected} }\"\n\t\t\t\t\t\talignItems=\"Center\"\n\t\t\t\t\t\tjustifyContent=\"Start\"\n\t\t\t\t\t>\n\t\t\t\t\t\t<Avatar\n\t\t\t\t\t\t\tinitials=\"{internal>initials}\"\n\t\t\t\t\t\t\tdisplaySize=\"XS\"\n\t\t\t\t\t\t\tbackgroundColor=\"{internal>color}\"\n\t\t\t\t\t\t\tpress={this.showCollaborationUserDetails}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</HBox>\n\t\t\t\t\t{this.getInviteButton()}\n\t\t\t\t</HBox>\n\t\t\t);\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"CollaborationDraft-dbg.js"}