/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/helpers/StableIdHelper","sap/fe/core/helpers/TitleHelper","sap/fe/macros/CommonHelper","sap/fe/macros/field/FieldTemplating","sap/m/library","sap/ui/base/BindingInfo","sap/ui/core/Lib","sap/ui/model/odata/v4/AnnotationHelper"],function(e,t,n,o,i,r,a,s,c,u,l,d,f){"use strict";var g={};var p=c.getTextBindingExpression;var b=c.formatValueRecursively;var m=c.addTextArrangementToBindingExpression;var v=a.getTitleBindingExpression;var y=o.UI;var S=o.Draft;var E=n.getInvolvedDataModelObjects;var C=t.ActionType;var A=e.resolveBindingString;var I=e.pathInModel;var O=e.or;var h=e.not;var T=e.ifElse;var F=e.getExpressionFromAnnotation;var x=e.equal;var D=e.constant;var $=e.compileExpression;var V=e.and;const P=u.ButtonType;const B=function(e,t,n){return v(e,p,undefined,n,t)};g.getExpressionForTitle=B;const M=function(e,t){let n=F(t?.Description?.Value);if(t?.Description?.Value?.$target?.annotations?.Common?.Text?.annotations?.UI?.TextArrangement){n=m(n,e)}const o=$(b(n,e));return o==="undefined"?"":o};g.getExpressionForDescription=M;const H=function(e,t){const n=e.resourceModel.getText("T_OP_OBJECT_PAGE_SAVE");const o=e.resourceModel.getText("T_OP_OBJECT_PAGE_CREATE");let i;if(t.startingEntitySet.annotations.Session?.StickySessionSupported){i=T(y.IsCreateMode,o,n)}else{i=T(S.IsNewObject,o,n)}return $(i)};g.getExpressionForSaveButton=H;const w=function(e,t){return t.resourceModel.getText("HEADER_FORM_LABEL",[e])};g.getExpressionForLabelOnHeaderForm=w;const j=function(e){const t=["Primary","DefaultApply","Secondary","ForAction","ForNavigation","SwitchToActiveObject","SwitchToDraftObject","DraftActions","Copy","Standard"];return!t.includes(e.type??"")};g.isManifestAction=j;const G=function(e){const t=e.targetEntityType?.annotations?.UI?.Identification;const n=t?.filter(e=>e.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"&&e.Criticality)||[];const o=n.length?n.map(e=>{const t=F(e.Criticality);return V(h(x(F(e.annotations?.UI?.Hidden),true)),O(x(t,"UI.CriticalityType/Negative"),x(t,"1"),x(t,1),x(t,"UI.CriticalityType/Positive"),x(t,"3"),x(t,3)))}):[D(false)];return $(T(O(...o),P.Ghost,P.Emphasized))};g.buildEmphasizedButtonExpression=G;const N=function(e){const t=f.getNavigationPath(e);if(t){return"{path:'"+t+"'}"}else{return"{path: ''}"}};g.getElementBinding=N;const R=function(e){if(e.annotations?.Common?.DraftRoot?.EditAction){return true}else{return false}};g.checkDraftState=R;const _=function(e){if(e.annotations?.Common?.DraftRoot?.ShareAction){return true}else{return false}};g.checkCollaborationDraftRoot=_;const L=function(e){if(R(e)){if(_(e)){return $(V(I("HasActiveEntity"),y.IsEditable))}else{return $(V(x(I("DraftAdministrativeData/DraftIsCreatedByMe"),true),y.IsEditable,h(y.IsCreateMode)))}}else{return false}};g.getSwitchToActiveVisibility=L;const U=function(e){if(R(e)){if(_(e)){return $(V(I("HasDraftEntity"),h(y.IsEditable)))}else{return $(V(x(I("DraftAdministrativeData/DraftIsCreatedByMe"),true),h(y.IsEditable),h(y.IsCreateMode),I("HasDraftEntity")))}}else{return false}};g.getSwitchToDraftVisibility=U;const Q=function(e){if(R(e)){if(_(e)){return $(T(I("IsActiveEntity"),I("HasDraftEntity"),I("HasActiveEntity")))}else{return $(V(x(I("DraftAdministrativeData/DraftIsCreatedByMe"),true),h(y.IsCreateMode)))}}else{return false}};g.getSwitchDraftAndActiveVisibility=Q;const k=function(e,t){let n;if(e&&e.length){n=e.find(function(e){return e.type===t})}return n};g._findAction=k;const z=function(e){const t=k(e,"Secondary");return t?t.enabled:"false"};g.getDeleteCommandExecutionEnabled=z;const q=function(e){const t=k(e,"Secondary");return t?t.visible:"false"};g.getDeleteCommandExecutionVisible=q;const J=function(e){const t=k(e,"Primary");return t?t.visible:"false"};g.getEditCommandExecutionVisible=J;const W=function(e){const t=k(e,"Primary");return t?t.enabled:"false"};g.getEditCommandExecutionEnabled=W;const K=function(e){const t=e.getPath();const n=t.split("/");const o="/"+n[1];const i=e.getObject(o+"@");const r=i.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftRoot");const a=i.hasOwnProperty("@com.sap.vocabularies.Common.v1.DraftNode");const s=i.hasOwnProperty("@com.sap.vocabularies.Session.v1.StickySessionSupported");let c;if(r){c=e.getObject(`${o}@com.sap.vocabularies.Common.v1.DraftRoot/EditAction`)}else if(a){c=e.getObject(`${o}@com.sap.vocabularies.Common.v1.DraftNode/EditAction`)}else if(s){c=e.getObject(`${o}@com.sap.vocabularies.Session.v1.StickySessionSupported/EditAction`)}return!c?c:`${o}/${c}`};g.getEditAction=K;const X=function(e,t){let n,o,i;if(e&&e["@Org.OData.Core.V1.Computed"]){n=e["@Org.OData.Core.V1.Computed"].Bool?e["@Org.OData.Core.V1.Computed"].Bool=="true":true}if(e&&e["@Org.OData.Core.V1.Immutable"]){o=e["@Org.OData.Core.V1.Immutable"].Bool?e["@Org.OData.Core.V1.Immutable"].Bool=="true":true}i=n||o;if(t){i=i||t=="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly"}if(i){return true}else{return false}};g.isReadOnlyFromStaticAnnotations=X;const Y=function(e){let t;if(e){if(l.parse(e)){t="%"+e+" === 1 "}}if(t){return"{= "+t+"? false : true }"}else{return undefined}};g.readOnlyExpressionFromDynamicAnnotations=Y;const Z=function(e,t,n,o,i){t=te(t,n,i);const r=e?.[t]?.["navigation"];if(r){if(r["targetOutbound"]&&r["targetOutbound"]["outbound"]||r["targetOutbound"]&&r["targetOutbound"]["outbound"]&&r["targetSections"]){return".handlers.onDataPointTitlePressed($controller, ${$source>/},'"+JSON.stringify(o)+"','"+r["targetOutbound"]["outbound"]+"','"+i+"' )"}else if(r["targetSections"]){return".handlers.navigateToSubSection($controller, '"+JSON.stringify(r["targetSections"])+"')"}else{return undefined}}};g.getExpressionForMicroChartTitlePress=Z;const ee=function(e,t,n,o){t=te(t,n,o);const i=e?.[t]?.["navigation"];if(i&&(i["targetOutbound"]||i["targetOutbound"]&&i["targetSections"])){return"External"}else if(i&&i["targetSections"]){return"InPage"}else{return"None"}};g.getMicroChartTitleAsLink=ee;const te=function(e,t,n){if(t?.targetObject?.$Type==="com.sap.vocabularies.UI.v1.PresentationVariantType"){e=t.targetObject?.Visualizations[0]?.value;e=n?`${n}/${e}`:e}return e};g.getMicroChartControlConfigurationPath=te;const ne=function(e,t,n){const o=e[t],i=["Heroes","Decoration","Workers","LongRunners"];let r=n;if(o&&o.requestGroupId&&i.some(function(e){return e===o.requestGroupId})){r="$auto."+o.requestGroupId}return r};g.getGroupIdFromConfig=ne;const oe=function(e,t,n,o,i){t=te(t,n,o);return ne(e,t,i)};g.getGroupIdFromConfigForMicroChart=oe;const ie=function(e,t){const n=ne(e,t);let o;if(n){o="{ path : '', parameters : { $$groupId : '"+n+"' } }"}return o};g.getBindingWithGroupIdFromConfig=ie;const re=function(e){let t;const n=i.getAlternateAndSecondaryKeys(e?.targetEntityType,e?.targetEntitySet);if(n?.length){t={path:""};t.parameters={$select:n.join(",")||""}}return JSON.stringify(t)};g.createBindingForAlternateAndSecondaryKeys=re;const ae=function(e){return e&&e.length===1&&!!e[0].isValueMultilineText};g.doesFieldGroupContainOnlyOneMultiLineDataField=ae;const se=function(e){if(e.isShareButtonVisibleForMyInbox===false){return"false"}const t=e.fclEnabled?V(I("/showShareIcon","fclhelper"),h(y.IsCreateMode)):h(y.IsCreateMode);return $(t)};g.getShareButtonVisibility=se;const ce=function(e,t,n,o){const i=e?X(e,n):true;const r=Y(n);if(!i&&!r){return true}const a=t?X(t,o):true;const s=Y(o);if(!a&&!s){return true}if(i&&a&&!r&&!s){return false}if(r&&!s){return r}else if(!r&&s){return s}else{return ue(n,o)}};g.getVisiblityOfHeaderInfo=ce;const ue=function(e,t){return"{= %"+e+" === 1 ? ( %"+t+" === 1 ? false : true ) : true }"};g.combineTitleAndDescriptionExpression=ue;const le=function(){const e="${$view>/}.getBindingContext()",t="${$view>/}.byId('fe::ObjectPage').data('ObjectPageSubtitle')",n="${$view>/}.byId('fe::ObjectPage').data('ObjectPageDescription')";const o={title:t,description:n};return s.generateFunction(".editFlow.deleteDocument",e,s.objectToString(o))};g.getPressExpressionForDelete=le;const de=function(e,t,n){const o=s.addSingleQuotes(e&&e.Action),i=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],r=i==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const a={contexts:"${$view>/}.getBindingContext()",entitySetName:s.addSingleQuotes(t),invocationGrouping:s.addSingleQuotes(r),model:"${$source>/}.getModel()",label:s.addSingleQuotes(e&&e.Label,true),isNavigable:n&&n.isNavigable,defaultValuesExtensionFunction:n&&n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};return s.generateFunction(".handlers.onCallAction","${$view>/}",o,s.objectToString(a))};g.getPressExpressionForEdit=de;const fe=function(e,t,n){const o=e.targetObject;const i=s.addSingleQuotes(o.Action);const r={contexts:"${$view>/}.getBindingContext()",entitySetName:s.addSingleQuotes(t),invocationGrouping:s.addSingleQuotes(o.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated"),model:"${$source>/}.getModel()",label:s.addSingleQuotes(o.Label,true),isNavigable:n.isNavigable,defaultValuesExtensionFunction:n.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};return s.generateFunction(".handlers.onCallAction","${$view>/}",i,s.objectToString(r))};g.getPressExpressionForFooterAnnotationAction=fe;const ge=function(e,t,n,o,i,r,a){const c=s.addSingleQuotes(e?.Action.toString()??""),u=e&&e.InvocationGrouping&&e.InvocationGrouping["$EnumMember"],l=u==="com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated";const d={contexts:"${$view>/}.getBindingContext()",entitySetName:t?s.addSingleQuotes(t):"",invocationGrouping:s.addSingleQuotes(l),model:"${$source>/}.getModel()",label:s.addSingleQuotes(e?.Label?.toString()??"",true),isNavigable:n?.isNavigable,defaultValuesExtensionFunction:n?.defaultValuesExtensionFunction?`'${n.defaultValuesExtensionFunction}'`:undefined};const f={positiveActionVisible:o,positiveActionEnabled:i,editActionVisible:r,editActionEnabled:a};return s.generateFunction(".handlers.onPrimaryAction","$controller","${$view>/}","${$view>/}.getBindingContext()",c,s.objectToString(d),s.objectToString(f))};g.getPressExpressionForPrimaryAction=ge;const pe=function(e,t){if(t&&t.Facet&&t.Facet.targetAnnotationType==="DataPoint"){return ie(e,t.Facet.targetAnnotationValue)}};g.getStashableHBoxBinding=pe;const be=function(e){if(e?.targetObject?.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAnnotation"){return undefined}return"Bare"};g.getHeaderFormHboxRenderType=be;function me(e,t,n,o){if(t.defaultAction){const e=t.defaultAction;try{switch(e.type){case"ForAction":{return de(n,o,t.defaultAction)}case"ForNavigation":{if(e.command){return"cmd:"+e.command}else{return e.press}}default:{if(e.command){return"cmd:"+e.command}if(e.noWrap){return e.press}else{return s.buildActionWrapper(e,{id:"forTheObjectPage"})}}}}catch(e){return"binding for the default action is not working as expected"}}return undefined}g.getDefaultActionHandler=me;function ve(e){return e.isPartOfPreview===true||e.presentation.visualizations[0].type!=="Table"}g.isVisualizationIsPartOfPreview=ve;const ye=function(e,t){const n=e.getInterface(1).getModel();const o=e=>{if(e.length){return e.map(e=>A(e.visible??true,"boolean"))}return[D(false)]};const i=e=>{const t=e.annotationPath;if(t){const e=n.getContext(t);return E(e)}return undefined};const r=t.filter(e=>e.type===C.DataFieldForAction);const a=o(t.filter(e=>j(e)));const s=o(r);const c=!!r.find(e=>{const t=i(e);return!t?.targetObject?.annotations?.UI?.Hidden});return $(O(c,O(...a),V(O(y.IsEditable,O(...s)),h(I("isCreateDialogOpen","internal")))))};g.getFooterVisibilityExpression=ye;function Se(e,t){if(t){if(!e.showSubSectionTitle){return"H4"}else if(e.level===2&&e.dataVisualizationTitleVisible==="true"){return"H6"}else{return"H5"}}else if(!e.showSubSectionTitle){return"H3"}else if(e.level===2&&e.dataVisualizationTitleVisible==="true"){return"H5"}else{return"H4"}}g.getHeaderLevel=Se;const Ee=function(e,t){let n="";if(e.label){n=r.generate([e.id,"Title"])}const o=r.generate([t,"Label"]);return n?`${n},${o}`:o};g.getHeaderFormAriaLabelledBy=Ee;const Ce=function(e){const t=d.getResourceBundleFor("sap.fe.core");return e!==undefined?t.getText("C_FORM_ARIA_TEXT",[e]):undefined};ye.requiresIContext=true;g.getFormAriaText=Ce;return g},false);
//# sourceMappingURL=ObjectPageTemplating.js.map