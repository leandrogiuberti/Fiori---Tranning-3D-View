/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/helpers/KeepAliveHelper","sap/fe/core/library","sap/fe/navigation/library","sap/ui/Device","sap/ui/mdc/p13n/StateUtil"],function(t,e,n,i,a,r){"use strict";const o=i.NavType,s=n.VariantManagement,l=n.TemplateContentView;const p={adaptApplyStateNavParams:function(t){t.applyVariantFromURLParams=true},applyInitialStateOnly:function(){return true},onBeforeStateApplied:function(t,e){const n=this.getView(),i=n.getController(),a=i._getFilterBarControl(),r=i._getControls("table");if(a){a.setSuspendSelection(true);t.push(a.waitForInitialization());if(e===o.hybrid){this._clearFilterConditions(a)}}r.forEach(function(e){t.push(e.initialized())})},adaptBindingRefreshControls:function(t){const n=this.base.getView(),i=n.getController(),a=i._getControls(),r=e.getControlsForRefresh(n,a);Array.prototype.push.apply(t,r)},adaptStateControls:function(t){const e=this.base.getView(),n=e.getController();const i=this._getFilterBarVM(e);if(i){t.push(i)}if(n._isMultiMode()){t.push(n._getMultiModeControl())}if(n._hasMultiVisualizations()){t.push(n._getSegmentedButton(l.Chart));t.push(n._getSegmentedButton(l.Table))}t.push(e.byId("fe::ListReport"))},retrieveAdditionalStates:function(t){const e=this.getView(),n=e.getController();if(n._hasMultiVisualizations()){const n=e.getBindingContext("internal").getProperty("alpContentView");t.alpContentView=n}},applyAdditionalStates:function(t){const e=this.getView(),n=e.getController();if(t){if(n._hasMultiVisualizations()){const n=e.getBindingContext("internal");if(!a.system.desktop&&t.alpContentView==l.Hybrid){t.alpContentView=l.Chart}n.getModel().setProperty(`${n.getPath()}/alpContentView`,t.alpContentView)}}},_getFilterBarVM:t=>{let e;const n=t.getViewData();switch(n.variantManagement){case s.Page:e=t.byId("fe::PageVariantManagement");break;case s.Control:e=t.getController()._getFilterBarVariantControl();break;case s.None:default:break}return e},_fnClearStateBeforexAppNav:async function(e){return r.retrieveExternalState(e).then(t=>{const e=t.filter;for(const t in e){if(t!=="$editState"&&t!=="$search"&&e[t]){e[t].forEach(t=>{t["filtered"]=false})}}return e}).catch(function(e){t.error("Error while retrieving the external state",e)})},_clearFilterConditions:async function(t){const e=[];return t.waitForInitialization().then(async()=>{const n=await this._fnClearStateBeforexAppNav(t);return r.applyExternalState(t,{filter:n,items:e})})}};return p},false);
//# sourceMappingURL=ViewState.js.map