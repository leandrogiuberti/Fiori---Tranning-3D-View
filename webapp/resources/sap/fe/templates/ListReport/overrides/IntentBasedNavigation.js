/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/navigation/SelectionVariant"],function(t,e){"use strict";const n={adaptNavigationContext:function(i,o){try{const t=this.base.getView(),r=t.getController(),s=r._getFilterBarControl(),l=t.getModel().getMetaModel();let a,c;const p=r._intentBasedNavigation.keepNavigationPropertiesForNavigation();if(s&&!i.isEmpty()){const s={selectionVariant:r.getFilterBarSelectionVariant().toJSONObject()};let f={selectionVariant:{}};f=this.base.getAppComponent().getNavigationService().checkIsPotentiallySensitive(s);let g=new e(f?.selectionVariant);const u=t.getViewData(),d=u.fullContextPath;if(!p){const t=r._intentBasedNavigation.getNavigationPropertiesFromEntityType(l,d);g=n.removeNavigationPropertiesFromSV(g,t)}a=n.prepareFiltersForExternalNavigation(g,d);n.handleMultiModeControl(r,g);c=n.updateNonConflictingFilterProperties(o,g,i,a.filterPropertiesWithoutConflict);o=c.targetInfo;delete o.propertiesWithoutConflict}}catch(e){const n=e instanceof Error?e.message:String(e);t.error(`Failed to process navigation context - ${n}`)}},handleMultiModeControl:function(t,e){const n=t._getMultiModeControl();if(n){const t=n.getTabsModel();if(t){const i=t.getProperty(`/${n.content?.getSelectedKey()}/notApplicable/fields`);if(Array.isArray(i)&&i.length>0){i.forEach(function(t){e.removeSelectOption(t)})}}}},prepareFiltersForExternalNavigation(t,n){let i;const o={};const r={};let s="",l="",a,c,p;function f(t){let e;for(const i in t){let r=i;if(t[r]){if(r.includes("/")){e=r;const t=r.split("/");r=t[t.length-1]}else{e=n}if(!o[r]){o[r]=[]}o[r].push(e)}}}const g=t.getSelectOptionsPropertyNames();const u={};g.forEach(e=>{const n=t.getSelectOption(e);if(n){u[`${e}`]=n}});f(u);for(const t in o){const e=o[t];if(e.length>1){for(let o=0;o<=e.length-1;o++){i=e[o];if(i===n){a=`${n}/${t}`;p=t;s=t}else{p=i;a=`${n}/${i}`.replaceAll(/\*/g,"");l=i}u[a.split("/").filter(function(t){return t!=""}).join(".")]=u[p];delete u[i]}c=s||l;u[t]=u[c]}else{i=e[0];a=i===n?`${n}/${t}`:`${n}/${i}`.replaceAll("*","");r[t]=a.split("/").filter(function(t){return t!=""}).join(".")}}const d=new e;for(const t in u){d.massAddSelectOption(t,u[t])}return{updatedSelectionVariant:d,filterPropertiesWithoutConflict:r}},removeNavigationPropertiesFromSV(t,n){const i=n?n.map(t=>t.name):[];const o=t.getSelectOptionsPropertyNames();return o.reduce((e,n)=>{if(i.length>0){const t=n.split(".")[0];if(t&&i.includes(t)){return e}}const o=t.getSelectOption(n);if(o){e.massAddSelectOption(n,o)}return e},new e)},updateNonConflictingFilterProperties:function(t,e,n,i){const o=t.propertiesWithoutConflict;const r=i;e.getSelectOptionsPropertyNames().forEach(function(t){const i=e.getSelectOption(t);if(i&&i.length){const e=n.getSelectOptionsPropertyNames();if(!e.includes(t)){n.massAddSelectOption(t,i)}else{if(o&&t in o){n.massAddSelectOption(o[t],i)}if(r&&t in r){n.massAddSelectOption(r[t],i)}}}});return{targetInfo:t,selectionVariant:n}},getEntitySet:function(){return this.base.getCurrentEntitySet()}};return n},false);
//# sourceMappingURL=IntentBasedNavigation.js.map