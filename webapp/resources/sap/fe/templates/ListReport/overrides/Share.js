/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/ui/core/routing/HashChanger"],function(t,e,n){"use strict";async function o(t){const e=t._getTable?.();if(!e){return""}const n=e.getParent();const o=await n.getDownloadUrlWithFilters();const i=o.split("?");const r=`${i[0]}/$count?`;const a=[];if(i.length>1){const t=i[1];t.split("&").forEach(function(t){const e=t.split("=");switch(e[0]){case"$apply":case"$search":case"$filter":a.push(t)}})}return r+a.join("&")}async function i(){const e=sap.ui.require("sap/ushell/Container");if(e){return e.getFLPUrlAsync(true).then(function(t){return t}).catch(function(e){t.error("Could not retrieve cFLP URL for the sharing dialog (dialog will not be opened)",e)})}else{return Promise.resolve(document.URL)}}async function r(t){const e=t._getFilterBarControl();if(e){return o(t)}return""}function a(){const e=n.getInstance().getHash();const o=n.getInstance().hrefForAppSpecificHash?n.getInstance().hrefForAppSpecificHash?.(""):"";const i=e?o+e:window.location.hash;const r=sap.ui.require("sap/ushell/Container");if(r&&r.runningInIframe&&r.runningInIframe()){r.getFLPUrl(true).then(function(t){return t.substring(0,t.indexOf("#"))+i}).catch(function(e){t.error("Could not retrieve cFLP URL for the sharing dialog (dialog will not be opened)",e)})}else{return window.location.origin+window.location.pathname+i}}async function s(t,n){const o=e.getAppComponent(t),i=o.getRouterProxy(),r=i.getHash(),a=o.getRootViewController(),s=a.getAppSpecificHash(),c=await o.getAppStateHandler().createAppState({replaceHash:false,skipMerge:true});const l=c?.appStateKey;if(l&&s){n.tile.url=s+i.setAppStateInHash(r,l)}}async function c(e){const n=e._getFilterBarControl();try{if(e.getView().getBindingContext("internal").getProperty("hasPendingFilters")){return await new Promise(function(t){const o=e._getTable?.();if(!o){return}const i=o.getRowBinding()||o.getBinding("items");i.attachEventOnce("dataReceived",function(){t()});n.triggerSearch()})}}catch(n){const o=e.getView()?.getModel("shareInfo");if(o){o.setProperty("/saveAsTileClicked",false)}const i=n instanceof Error?n.message:String(n);t.error(`FE : Save as tile - data sync failed : Share : ${i}`)}}async function l(t,n){const o=t.getModel("shareInfo");if(o&&o.getProperty("/saveAsTileClicked")){await c(t.getController());await s(t,n);const o=e.getAppComponent(t);const i=o.getManifest();const a=i["sap.ui"];const l=a&&a.icons&&a.icons.icon||"";const u=i["sap.app"];const g=u&&u.title||"";n.tile.icon=l;n.tile.title=g;n.tile.queryUrl=await r(t.getController())}}const u={adaptShareMetadata:async function(e){try{await l(this.base.getView(),e);const t=a();e.title=document.title;if(t){e.jam.url=t}const n=this.base?.getView()?.getModel("shareInfo");const o=await this.getTeamsUrl(e.url);if(n){n.setProperty("/collaborationInfo/url",o);n.setProperty("/collaborationInfo/appTitle",e.title)}const r=await i();e.email.url=r}catch(e){t.error(e)}return e}};return u},false);
//# sourceMappingURL=Share.js.map