{"version":3,"file":"ExtensionAPI.js","names":["ListReportExtensionAPI","_dec","defineUI5Class","_class","_ExtensionAPI","apply","this","arguments","_inheritsLoose","_proto","prototype","refresh","async","filterBar","_controller","_getFilterBarControl","filterBarAPI","getParent","triggerSearch","Promise","resolve","getSelectedContexts","oControl","_isMultiMode","_getMultiModeControl","getSelectedInnerControl","content","_getTable","isA","aSelectedContexts","get_chart","aSelectedDataPoints","ChartUtils","getChartSelectedData","item","push","context","refreshTabsCount","keys","setTabContentToBeRefreshedOnNextOpening","setFilterValues","sConditionPath","sOperator","vValues","_getAdaptationFilterBarControl","undefined","FilterUtils","createFiltersFromFilterConditions","mFilterConditions","Log","error","getFilterInfo","getFilters","oFilterBar","setCustomMessage","message","tabKey","onClose","ListReportMessageStrip","LRMessageStrip","showCustomMessage","InvisibleMessage","getInstance","announce","InvisibleMessageMode","Assertive","destroy","call","setSelectedTab","control","_getIconTabBar","fireSelect","selectedKey","ExtensionAPI"],"sources":["./ExtensionAPI.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport { defineUI5Class } from \"sap/fe/base/ClassSupport\";\nimport ExtensionAPI from \"sap/fe/core/ExtensionAPI\";\nimport ChartUtils from \"sap/fe/macros/chart/ChartUtils\";\nimport type { IFilterControl } from \"sap/fe/macros/filter/FilterUtils\";\nimport FilterUtils from \"sap/fe/macros/filter/FilterUtils\";\nimport type FilterBarAPI from \"sap/fe/macros/filterBar/FilterBarAPI\";\nimport type TableAPI from \"sap/fe/macros/table/TableAPI\";\nimport type { InternalBindingInfo } from \"sap/fe/macros/table/Utils\";\nimport type { LRCustomMessage } from \"sap/fe/templates/ListReport/LRMessageStrip\";\nimport { LRMessageStrip } from \"sap/fe/templates/ListReport/LRMessageStrip\";\nimport type ListReportController from \"sap/fe/templates/ListReport/ListReportController.controller\";\nimport InvisibleMessage from \"sap/ui/core/InvisibleMessage\";\nimport { InvisibleMessageMode } from \"sap/ui/core/library\";\nimport type Chart from \"sap/ui/mdc/Chart\";\nimport type FilterBar from \"sap/ui/mdc/FilterBar\";\nimport type Table from \"sap/ui/mdc/Table\";\nimport type { ConditionObject } from \"sap/ui/mdc/condition/Condition\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\n\n/**\n * Extension API for list reports in SAP Fiori elements for OData V4.\n *\n * To correctly integrate your app extension coding with SAP Fiori elements, use only the extensionAPI of SAP Fiori elements. Don't access or manipulate controls, properties, models, or other internal objects created by the SAP Fiori elements framework.\n * @public\n * @hideconstructor\n * @final\n * @since 1.79.0\n */\n@defineUI5Class(\"sap.fe.templates.ListReport.ExtensionAPI\")\nclass ListReportExtensionAPI extends ExtensionAPI {\n\tpublic _controller!: ListReportController;\n\n\tListReportMessageStrip!: LRMessageStrip;\n\n\t/**\n\t * Refreshes the List Report.\n\t * This method currently only supports triggering the search (by clicking on the GO button)\n\t * in the List Report Filter Bar. It can be used to request the initial load or to refresh the\n\t * currently shown data based on the filters entered by the user.\n\t * Please note: The Promise is resolved once the search is triggered and not once the data is returned.\n\t * @returns Resolved once the data is refreshed or rejected if the request failed\n\t * @public\n\t */\n\tasync refresh(): Promise<void> {\n\t\tconst filterBar = this._controller._getFilterBarControl();\n\t\tconst filterBarAPI = filterBar?.getParent() as FilterBarAPI;\n\t\tif (filterBarAPI) {\n\t\t\tfilterBarAPI.triggerSearch();\n\t\t}\n\t\t// TODO: if there is no filter bar, make refresh work\n\t\treturn Promise.resolve();\n\t}\n\n\t/**\n\t * Gets the list entries currently selected for the displayed control.\n\t * @returns Array containing the selected contexts\n\t * @public\n\t */\n\tgetSelectedContexts(): Context[] {\n\t\tconst oControl = ((this._controller._isMultiMode() &&\n\t\t\tthis._controller._getMultiModeControl()?.getSelectedInnerControl()?.content) ||\n\t\t\tthis._controller._getTable()) as Table | (Chart & { get_chart: Function }) | TableAPI; // This can never be a TableAPI, but it causes issue line 73 otherwise.\n\t\tif (oControl.isA<Chart & { get_chart: Function }>(\"sap.ui.mdc.Chart\")) {\n\t\t\tconst aSelectedContexts = [];\n\t\t\tif (oControl && oControl.get_chart()) {\n\t\t\t\tconst aSelectedDataPoints = ChartUtils.getChartSelectedData(oControl.get_chart());\n\t\t\t\tfor (const item of aSelectedDataPoints) {\n\t\t\t\t\taSelectedContexts.push(item.context);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn aSelectedContexts;\n\t\t} else {\n\t\t\treturn (oControl.getParent() as TableAPI).getSelectedContexts();\n\t\t}\n\t}\n\n\t/**\n\t * Refreshes the count of the views in the MultiMode control.\n\t * @param [keys] The list of the keys identifying the views defined in the manifest for which the views' count will be refreshed. If not provided, all the views' count will be refreshed\n\t * @public\n\t */\n\trefreshTabsCount(keys?: string[]): void {\n\t\tthis._controller._getMultiModeControl()?.refreshTabsCount(keys);\n\t}\n\n\t/**\n\t * Refreshes the content of the underlying views upon the next opening.\n\t * Note: The content of the selected view, if part of the provided keys, will be refreshed immediately.\n\t * @param [keys] The list of the keys identifying the views defined in the manifest for which the views' content will be refreshed. If not provided, all the views' content will be refreshed\n\t * @public\n\t */\n\tsetTabContentToBeRefreshedOnNextOpening(keys?: string[]): void {\n\t\tthis._controller._getMultiModeControl()?.setTabContentToBeRefreshedOnNextOpening(keys);\n\t}\n\n\t/**\n\t * Set the filter values for the given property in the filter bar.\n\t * The filter values can be either a single value or an array of values.\n\t * Each filter value must be represented as a primitive value.\n\t * @param sConditionPath The path to the property as a condition path\n\t * @param [sOperator] The operator to be used (optional) - if not set, the default operator (EQ) will be used\n\t * @param vValues The values to be applied\n\t * @returns A promise for asynchronous handling\n\t * @public\n\t */\n\tasync setFilterValues(\n\t\tsConditionPath: string,\n\t\tsOperator: string | undefined,\n\t\tvValues?: undefined | string | number | boolean | string[] | number[] | boolean[]\n\t): Promise<void> {\n\t\t// The List Report has two filter bars: The filter bar in the header and the filter bar in the \"Adapt Filter\" dialog;\n\t\t// when the dialog is opened, the user is working with that active control: Pass it to the setFilterValues method!\n\t\tconst filterBar = this._controller._getAdaptationFilterBarControl() || this._controller._getFilterBarControl();\n\t\tif (vValues === undefined) {\n\t\t\tvValues = sOperator;\n\t\t\treturn FilterUtils.setFilterValues(filterBar as FilterBar, sConditionPath, vValues);\n\t\t}\n\n\t\treturn FilterUtils.setFilterValues(filterBar as FilterBar, sConditionPath, sOperator, vValues);\n\t}\n\n\t/**\n\t * This method converts the filter conditions to filters.\n\t * @param mFilterConditions Map containing the filter conditions of the FilterBar.\n\t * @returns Object containing the converted FilterBar filters or undefined.\n\t * @public\n\t */\n\tcreateFiltersFromFilterConditions(mFilterConditions: Record<string, ConditionObject[]>): object | undefined {\n\t\tconst filterBar = this._controller._getFilterBarControl();\n\t\tif (!filterBar) {\n\t\t\tLog.error(\"The filter bar is not available\");\n\t\t\treturn;\n\t\t}\n\t\treturn FilterUtils.getFilterInfo(filterBar as unknown as IFilterControl, undefined, mFilterConditions);\n\t}\n\n\t/**\n\t * Provides all the model filters from the filter bar that are currently active\n\t * along with the search expression.\n\t * @returns An array of active filters and the search expression or undefined.\n\t * @public\n\t */\n\tgetFilters(): InternalBindingInfo | undefined {\n\t\tconst oFilterBar = this._controller._getFilterBarControl();\n\t\treturn FilterUtils.getFilters(oFilterBar as unknown as IFilterControl);\n\t}\n\n\t/**\n\t * Provide an option for showing a custom message in the message strip above the list report table.\n\t * @param message Custom message along with the message type to be set on the table.\n\t * @param message.message Message string to be displayed.\n\t * @param message.type Indicates the type of message.\n\t * @param tabKey The tabKey identifying the table where the custom message is displayed. If tabKey is empty, the message is displayed in all tabs . If tabKey = ['1','2'], the message is displayed in tabs 1 and 2 only\n\t * @param onClose A function that is called when the user closes the message bar.\n\t * @public\n\t */\n\tsetCustomMessage(message: LRCustomMessage | undefined, tabKey?: string[] | string | null, onClose?: Function): void {\n\t\tif (!this.ListReportMessageStrip) {\n\t\t\tthis.ListReportMessageStrip = new LRMessageStrip();\n\t\t}\n\t\tthis.ListReportMessageStrip.showCustomMessage(message, this._controller, tabKey, onClose);\n\t\tif (message?.message) {\n\t\t\tInvisibleMessage.getInstance().announce(message.message, InvisibleMessageMode.Assertive);\n\t\t}\n\t}\n\n\t/**\n\t * Destroys the message strip set on the List Report, if any.\n\t * @private\n\t */\n\tdestroy(): void {\n\t\tthis.ListReportMessageStrip?.destroy();\n\t\tsuper.destroy();\n\t}\n\n\t/**\n\t * Provides an option for the selection of a specific tab programamatically.\n\t * @param tabKey Specific tab to be selected.\n\t * @public\n\t */\n\tsetSelectedTab(tabKey: string): void {\n\t\tconst control = this._controller._getIconTabBar();\n\t\tcontrol?.fireSelect({ selectedKey: \"fe::table::\" + tabKey + \"::LineItem\" });\n\t}\n}\n\nexport default ListReportExtensionAPI;\n"],"mappings":";;;;skBAoBA,IAUMA,GAAsBC,EAD3BC,EAAe,4CAA2CD,EAAAE,EAAA,SAAAC,GAAA,SAAAJ,IAAA,OAAAI,EAAAC,MAAAC,KAAAC,YAAAD,IAAA,CAAAE,EAAAR,EAAAI,GAAA,IAAAK,EAAAT,EAAAU,UAM1DD,EASME,QAANC,eAAMD,IACL,MAAME,EAAYP,KAAKQ,YAAYC,uBACnC,MAAMC,EAAeH,GAAWI,YAChC,GAAID,EAAc,CACjBA,EAAaE,eACd,CAEA,OAAOC,QAAQC,SAChB,EAEAX,EAKAY,oBAAA,SAAAA,IACC,MAAMC,EAAahB,KAAKQ,YAAYS,gBACnCjB,KAAKQ,YAAYU,wBAAwBC,2BAA2BC,SACpEpB,KAAKQ,YAAYa,YAClB,GAAIL,EAASM,IAAqC,oBAAqB,CACtE,MAAMC,EAAoB,GAC1B,GAAIP,GAAYA,EAASQ,YAAa,CACrC,MAAMC,EAAsBC,EAAWC,qBAAqBX,EAASQ,aACrE,IAAK,MAAMI,KAAQH,EAAqB,CACvCF,EAAkBM,KAAKD,EAAKE,QAC7B,CACD,CACA,OAAOP,CACR,KAAO,CACN,OAAQP,EAASL,YAAyBI,qBAC3C,CACD,EAEAZ,EAKA4B,iBAAA,SAAAA,EAAiBC,GAChBhC,KAAKQ,YAAYU,wBAAwBa,iBAAiBC,EAC3D,EAEA7B,EAMA8B,wCAAA,SAAAA,EAAwCD,GACvChC,KAAKQ,YAAYU,wBAAwBe,wCAAwCD,EAClF,EAEA7B,EAUM+B,gBAAN5B,eAAM4B,EACLC,EACAC,EACAC,GAIA,MAAM9B,EAAYP,KAAKQ,YAAY8B,kCAAoCtC,KAAKQ,YAAYC,uBACxF,GAAI4B,IAAYE,UAAW,CAC1BF,EAAUD,EACV,OAAOI,EAAYN,gBAAgB3B,EAAwB4B,EAAgBE,EAC5E,CAEA,OAAOG,EAAYN,gBAAgB3B,EAAwB4B,EAAgBC,EAAWC,EACvF,EAEAlC,EAMAsC,kCAAA,SAAAA,EAAkCC,GACjC,MAAMnC,EAAYP,KAAKQ,YAAYC,uBACnC,IAAKF,EAAW,CACfoC,EAAIC,MAAM,mCACV,MACD,CACA,OAAOJ,EAAYK,cAActC,EAAwCgC,UAAWG,EACrF,EAEAvC,EAMA2C,WAAA,SAAAA,IACC,MAAMC,EAAa/C,KAAKQ,YAAYC,uBACpC,OAAO+B,EAAYM,WAAWC,EAC/B,EAEA5C,EASA6C,iBAAA,SAAAA,EAAiBC,EAAsCC,EAAmCC,GACzF,IAAKnD,KAAKoD,uBAAwB,CACjCpD,KAAKoD,uBAAyB,IAAIC,CACnC,CACArD,KAAKoD,uBAAuBE,kBAAkBL,EAASjD,KAAKQ,YAAa0C,EAAQC,GACjF,GAAIF,GAASA,QAAS,CACrBM,EAAiBC,cAAcC,SAASR,EAAQA,QAASS,EAAqBC,UAC/E,CACD,EAEAxD,EAIAyD,QAAA,SAAAA,IACC5D,KAAKoD,wBAAwBQ,UAC7B9D,EAAAM,UAAMwD,QAAOC,KAAA7D,KACd,EAEAG,EAKA2D,eAAA,SAAAA,EAAeZ,GACd,MAAMa,EAAU/D,KAAKQ,YAAYwD,iBACjCD,GAASE,WAAW,CAAEC,YAAa,cAAgBhB,EAAS,cAC7D,EAAC,OAAAxD,CAAA,CA3JyD,CACtByE,KAAYtE,GAAA,OA6JlCH,CAAsB","ignoreList":[]}