{"version":3,"file":"MessagePopover.js","names":["FeMessagePopover","_dec","defineUI5Class","_class","_MessagePopover","apply","this","arguments","_inheritsLoose","_proto","prototype","init","MessagePopover","setModel","Messaging","getMessageModel","bindAggregation","path","length","template","MessageItem","type","title","description","markupDescription","longtextUrl","subtitle","activeTitle","link","getLinkForErrorExplanation","undefined","setGroupItems","messagePopoverInstance","appComponent","CommonUtils","getAppComponent","environmentService","getEnvironmentCapabilities","environmentCapabilities","ErrorExplanation","Link","text","Library","getResourceBundleFor","getText","icon","customData","CustomData","key","value","visible","press","async","prepareFeature","explain","__ui5_require_async","registrationIds","getManifestEntry","registrationIdsString","join","errorExplanationMetadata","version","fioriId","appName","componentName","id","errorExplanationData","message","data","code","descriptionUrl","error","Log","FESRHelper","setSemanticStepname"],"sources":["./MessagePopover.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport { defineUI5Class } from \"sap/fe/base/ClassSupport\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport Link from \"sap/m/Link\";\nimport MessageItem from \"sap/m/MessageItem\";\nimport MessagePopover from \"sap/m/MessagePopover\";\nimport CustomData from \"sap/ui/core/CustomData\";\nimport Library from \"sap/ui/core/Lib\";\nimport Messaging from \"sap/ui/core/Messaging\";\nimport FESRHelper from \"sap/ui/performance/trace/FESRHelper\";\nimport type { ErrorExplanationData, ErrorExplanationMetadata } from \"ux/eng/fioriai/reuse/errorexplanation/ErrorExplanation\";\n\n@defineUI5Class(\"sap.fe.macros.messages.MessagePopover\")\nclass FeMessagePopover extends MessagePopover {\n\tinit(): void {\n\t\tMessagePopover.prototype.init.apply(this);\n\t\tthis.setModel(Messaging.getMessageModel(), \"message\");\n\n\t\tthis.bindAggregation(\"items\", {\n\t\t\tpath: \"message>/\",\n\t\t\tlength: 9999,\n\t\t\ttemplate: new MessageItem({\n\t\t\t\ttype: \"{message>type}\",\n\t\t\t\ttitle: \"{message>message}\",\n\t\t\t\tdescription: \"{message>description}\",\n\t\t\t\tmarkupDescription: true,\n\t\t\t\tlongtextUrl: \"{message>descriptionUrl}\",\n\t\t\t\tsubtitle: \"{message>additionalText}\",\n\t\t\t\tactiveTitle: \"{= ${message>controlIds}.length > 0 ? true : false}\",\n\t\t\t\tlink: this.getLinkForErrorExplanation(this) || undefined\n\t\t\t})\n\t\t});\n\t\tthis.setGroupItems(true);\n\t}\n\n\tgetLinkForErrorExplanation(messagePopoverInstance: MessagePopover): Link | null {\n\t\tconst appComponent = CommonUtils.getAppComponent(messagePopoverInstance);\n\t\tconst environmentService = appComponent.getEnvironmentCapabilities();\n\t\tif (environmentService.environmentCapabilities.ErrorExplanation) {\n\t\t\tconst link = new Link({\n\t\t\t\ttext: Library.getResourceBundleFor(\"sap.fe.macros\")!.getText(\"C_GENERATE_EXPLANATION\"),\n\t\t\t\ticon: \"sap-icon://ai\",\n\t\t\t\tcustomData: [\n\t\t\t\t\tnew CustomData({\n\t\t\t\t\t\tkey: \"message\",\n\t\t\t\t\t\tvalue: \"{message>message}\"\n\t\t\t\t\t}),\n\t\t\t\t\tnew CustomData({\n\t\t\t\t\t\tkey: \"description\",\n\t\t\t\t\t\tvalue: \"{message>description}\"\n\t\t\t\t\t}),\n\t\t\t\t\tnew CustomData({\n\t\t\t\t\t\tkey: \"descriptionUrl\",\n\t\t\t\t\t\tvalue: \"{message>descriptionUrl}\"\n\t\t\t\t\t}),\n\t\t\t\t\tnew CustomData({\n\t\t\t\t\t\tkey: \"code\",\n\t\t\t\t\t\tvalue: \"{message>code}\"\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t\t// link is visible only when type is Warning or Error Not for Information\n\t\t\t\tvisible: \"{= ${message>type} !== 'Information' }\",\n\t\t\t\tpress: async function (this: Link): Promise<void> {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait environmentService.prepareFeature(\"ErrorExplanation\");\n\t\t\t\t\t\tconst { explain } = await import(\"ux/eng/fioriai/reuse/errorexplanation/ErrorExplanation\");\n\n\t\t\t\t\t\tconst registrationIds = appComponent.getManifestEntry(\"sap.fiori\")?.registrationIds;\n\t\t\t\t\t\tconst registrationIdsString = registrationIds && registrationIds.length > 0 ? registrationIds.join(\",\") : \"\";\n\t\t\t\t\t\tconst errorExplanationMetadata: ErrorExplanationMetadata = {\n\t\t\t\t\t\t\tversion: 1,\n\t\t\t\t\t\t\tfioriId: registrationIdsString,\n\t\t\t\t\t\t\tappName: appComponent.getManifestEntry(\"sap.app\")?.title || undefined,\n\t\t\t\t\t\t\tcomponentName: appComponent.getManifestEntry(\"sap.app\")?.id || undefined\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst errorExplanationData: ErrorExplanationData = {\n\t\t\t\t\t\t\tversion: 1,\n\t\t\t\t\t\t\tmessage: this.data(\"message\"),\n\t\t\t\t\t\t\tcode: this.data(\"code\"),\n\t\t\t\t\t\t\tdescription: this.data(\"description\"),\n\t\t\t\t\t\t\tdescriptionUrl: this.data(\"descriptionUrl\")\n\t\t\t\t\t\t};\n\t\t\t\t\t\tawait explain(errorExplanationMetadata, errorExplanationData);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tLog.error(\"Error explanation failed\", error as Error);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tFESRHelper.setSemanticStepname(link, \"press\", \"fe4:ee:explain\");\n\t\t\treturn link;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nexport default FeMessagePopover;\n"],"mappings":";;;;0vBAaMA,GAAgBC,EADrBC,EAAe,yCAAwCD,EAAAE,EAAA,SAAAC,GAAA,SAAAJ,IAAA,OAAAI,EAAAC,MAAAC,KAAAC,YAAAD,IAAA,CAAAE,EAAAR,EAAAI,GAAA,IAAAK,EAAAT,EAAAU,UAAAD,EAEvDE,KAAA,SAAAA,IACCC,EAAeF,UAAUC,KAAKN,MAAMC,MACpCA,KAAKO,SAASC,EAAUC,kBAAmB,WAE3CT,KAAKU,gBAAgB,QAAS,CAC7BC,KAAM,YACNC,OAAQ,KACRC,SAAU,IAAIC,EAAY,CACzBC,KAAM,iBACNC,MAAO,oBACPC,YAAa,wBACbC,kBAAmB,KACnBC,YAAa,2BACbC,SAAU,2BACVC,YAAa,sDACbC,KAAMtB,KAAKuB,2BAA2BvB,OAASwB,cAGjDxB,KAAKyB,cAAc,KACpB,EAACtB,EAEDoB,2BAAA,SAAAA,EAA2BG,GAC1B,MAAMC,EAAeC,EAAYC,gBAAgBH,GACjD,MAAMI,EAAqBH,EAAaI,6BACxC,GAAID,EAAmBE,wBAAwBC,iBAAkB,CAChE,MAAMX,EAAO,IAAIY,EAAK,CACrBC,KAAMC,EAAQC,qBAAqB,iBAAkBC,QAAQ,0BAC7DC,KAAM,gBACNC,WAAY,CACX,IAAIC,EAAW,CACdC,IAAK,UACLC,MAAO,sBAER,IAAIF,EAAW,CACdC,IAAK,cACLC,MAAO,0BAER,IAAIF,EAAW,CACdC,IAAK,iBACLC,MAAO,6BAER,IAAIF,EAAW,CACdC,IAAK,OACLC,MAAO,oBAITC,QAAS,yCACTC,MAAOC,iBACN,UACOhB,EAAmBiB,eAAe,oBACxC,MAAMC,QAAEA,SAAkBC,EAAO,0DAEjC,MAAMC,EAAkBvB,EAAawB,iBAAiB,cAAcD,gBACpE,MAAME,EAAwBF,GAAmBA,EAAgBtC,OAAS,EAAIsC,EAAgBG,KAAK,KAAO,GAC1G,MAAMC,EAAqD,CAC1DC,QAAS,EACTC,QAASJ,EACTK,QAAS9B,EAAawB,iBAAiB,YAAYnC,OAASQ,UAC5DkC,cAAe/B,EAAawB,iBAAiB,YAAYQ,IAAMnC,WAEhE,MAAMoC,EAA6C,CAClDL,QAAS,EACTM,QAAS7D,KAAK8D,KAAK,WACnBC,KAAM/D,KAAK8D,KAAK,QAChB7C,YAAajB,KAAK8D,KAAK,eACvBE,eAAgBhE,KAAK8D,KAAK,yBAErBd,EAAQM,EAA0BM,EACzC,CAAE,MAAOK,GACRC,EAAID,MAAM,2BAA4BA,EACvC,CACD,IAEDE,EAAWC,oBAAoB9C,EAAM,QAAS,kBAC9C,OAAOA,CACR,KAAO,CACN,OAAO,IACR,CACD,EAAC,OAAA5B,CAAA,CAjFsD,CACzBY,KAAcT,GAAA,OAmF9BH,CAAgB","ignoreList":[]}