{"version":3,"names":["FeMessagePopover","_dec","defineUI5Class","_class","_MessagePopover","apply","arguments","_inheritsLoose","_proto","prototype","init","MessagePopover","setModel","Messaging","getMessageModel","bindAggregation","path","length","template","MessageItem","type","title","description","markupDescription","longtextUrl","subtitle","activeTitle","link","getLinkForErrorExplanation","undefined","setGroupItems","messagePopoverInstance","appComponent","CommonUtils","getAppComponent","environmentService","getEnvironmentCapabilities","environmentCapabilities","ErrorExplanation","Link","text","Library","getResourceBundleFor","getText","icon","customData","CustomData","key","value","visible","press","prepareFeature","explain","__ui5_require_async","registrationIds","getManifestEntry","registrationIdsString","join","errorExplanationMetadata","version","fioriId","appName","componentName","id","errorExplanationData","message","data","code","descriptionUrl","error","Log","FESRHelper","setSemanticStepname"],"sourceRoot":".","sources":["MessagePopover.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport { defineUI5Class } from \"sap/fe/base/ClassSupport\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport Link from \"sap/m/Link\";\nimport MessageItem from \"sap/m/MessageItem\";\nimport MessagePopover from \"sap/m/MessagePopover\";\nimport CustomData from \"sap/ui/core/CustomData\";\nimport Library from \"sap/ui/core/Lib\";\nimport Messaging from \"sap/ui/core/Messaging\";\nimport FESRHelper from \"sap/ui/performance/trace/FESRHelper\";\nimport type { ErrorExplanationData, ErrorExplanationMetadata } from \"ux/eng/fioriai/reuse/errorexplanation/ErrorExplanation\";\n\n@defineUI5Class(\"sap.fe.macros.messages.MessagePopover\")\nclass FeMessagePopover extends MessagePopover {\n\tinit(): void {\n\t\tMessagePopover.prototype.init.apply(this);\n\t\tthis.setModel(Messaging.getMessageModel(), \"message\");\n\n\t\tthis.bindAggregation(\"items\", {\n\t\t\tpath: \"message>/\",\n\t\t\tlength: 9999,\n\t\t\ttemplate: new MessageItem({\n\t\t\t\ttype: \"{message>type}\",\n\t\t\t\ttitle: \"{message>message}\",\n\t\t\t\tdescription: \"{message>description}\",\n\t\t\t\tmarkupDescription: true,\n\t\t\t\tlongtextUrl: \"{message>descriptionUrl}\",\n\t\t\t\tsubtitle: \"{message>additionalText}\",\n\t\t\t\tactiveTitle: \"{= ${message>controlIds}.length > 0 ? true : false}\",\n\t\t\t\tlink: this.getLinkForErrorExplanation(this) || undefined\n\t\t\t})\n\t\t});\n\t\tthis.setGroupItems(true);\n\t}\n\n\tgetLinkForErrorExplanation(messagePopoverInstance: MessagePopover): Link | null {\n\t\tconst appComponent = CommonUtils.getAppComponent(messagePopoverInstance);\n\t\tconst environmentService = appComponent.getEnvironmentCapabilities();\n\t\tif (environmentService.environmentCapabilities.ErrorExplanation) {\n\t\t\tconst link = new Link({\n\t\t\t\ttext: Library.getResourceBundleFor(\"sap.fe.macros\")!.getText(\"C_GENERATE_EXPLANATION\"),\n\t\t\t\ticon: \"sap-icon://ai\",\n\t\t\t\tcustomData: [\n\t\t\t\t\tnew CustomData({\n\t\t\t\t\t\tkey: \"message\",\n\t\t\t\t\t\tvalue: \"{message>message}\"\n\t\t\t\t\t}),\n\t\t\t\t\tnew CustomData({\n\t\t\t\t\t\tkey: \"description\",\n\t\t\t\t\t\tvalue: \"{message>description}\"\n\t\t\t\t\t}),\n\t\t\t\t\tnew CustomData({\n\t\t\t\t\t\tkey: \"descriptionUrl\",\n\t\t\t\t\t\tvalue: \"{message>descriptionUrl}\"\n\t\t\t\t\t}),\n\t\t\t\t\tnew CustomData({\n\t\t\t\t\t\tkey: \"code\",\n\t\t\t\t\t\tvalue: \"{message>code}\"\n\t\t\t\t\t})\n\t\t\t\t],\n\t\t\t\t// link is visible only when type is Warning or Error Not for Information\n\t\t\t\tvisible: \"{= ${message>type} !== 'Information' }\",\n\t\t\t\tpress: async function (this: Link): Promise<void> {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tawait environmentService.prepareFeature(\"ErrorExplanation\");\n\t\t\t\t\t\tconst { explain } = await import(\"ux/eng/fioriai/reuse/errorexplanation/ErrorExplanation\");\n\n\t\t\t\t\t\tconst registrationIds = appComponent.getManifestEntry(\"sap.fiori\")?.registrationIds;\n\t\t\t\t\t\tconst registrationIdsString = registrationIds && registrationIds.length > 0 ? registrationIds.join(\",\") : \"\";\n\t\t\t\t\t\tconst errorExplanationMetadata: ErrorExplanationMetadata = {\n\t\t\t\t\t\t\tversion: 1,\n\t\t\t\t\t\t\tfioriId: registrationIdsString,\n\t\t\t\t\t\t\tappName: appComponent.getManifestEntry(\"sap.app\")?.title || undefined,\n\t\t\t\t\t\t\tcomponentName: appComponent.getManifestEntry(\"sap.app\")?.id || undefined\n\t\t\t\t\t\t};\n\t\t\t\t\t\tconst errorExplanationData: ErrorExplanationData = {\n\t\t\t\t\t\t\tversion: 1,\n\t\t\t\t\t\t\tmessage: this.data(\"message\"),\n\t\t\t\t\t\t\tcode: this.data(\"code\"),\n\t\t\t\t\t\t\tdescription: this.data(\"description\"),\n\t\t\t\t\t\t\tdescriptionUrl: this.data(\"descriptionUrl\")\n\t\t\t\t\t\t};\n\t\t\t\t\t\tawait explain(errorExplanationMetadata, errorExplanationData);\n\t\t\t\t\t} catch (error) {\n\t\t\t\t\t\tLog.error(\"Error explanation failed\", error as Error);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\tFESRHelper.setSemanticStepname(link, \"press\", \"fe4:ee:explain\");\n\t\t\treturn link;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n}\n\nexport default FeMessagePopover;\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;MAaMA,gBAAgB,IAAAC,IAAA,GADrBC,cAAc,CAAC,uCAAuC,CAAC,EAAAD,IAAA,CAAAE,MAAA,0BAAAC,eAAA;IAAA,SAAAJ,iBAAA;MAAA,OAAAI,eAAA,CAAAC,KAAA,OAAAC,SAAA;IAAA;IAAAC,cAAA,CAAAP,gBAAA,EAAAI,eAAA;IAAA,IAAAI,MAAA,GAAAR,gBAAA,CAAAS,SAAA;IAAAD,MAAA,CAEvDE,IAAI,GAAJ,SAAAA,IAAIA,CAAA,EAAS;MACZC,cAAc,CAACF,SAAS,CAACC,IAAI,CAACL,KAAK,CAAC,IAAI,CAAC;MACzC,IAAI,CAACO,QAAQ,CAACC,SAAS,CAACC,eAAe,CAAC,CAAC,EAAE,SAAS,CAAC;MAErD,IAAI,CAACC,eAAe,CAAC,OAAO,EAAE;QAC7BC,IAAI,EAAE,WAAW;QACjBC,MAAM,EAAE,IAAI;QACZC,QAAQ,EAAE,IAAIC,WAAW,CAAC;UACzBC,IAAI,EAAE,gBAAgB;UACtBC,KAAK,EAAE,mBAAmB;UAC1BC,WAAW,EAAE,uBAAuB;UACpCC,iBAAiB,EAAE,IAAI;UACvBC,WAAW,EAAE,0BAA0B;UACvCC,QAAQ,EAAE,0BAA0B;UACpCC,WAAW,EAAE,qDAAqD;UAClEC,IAAI,EAAE,IAAI,CAACC,0BAA0B,CAAC,IAAI,CAAC,IAAIC;QAChD,CAAC;MACF,CAAC,CAAC;MACF,IAAI,CAACC,aAAa,CAAC,IAAI,CAAC;IACzB,CAAC;IAAAtB,MAAA,CAEDoB,0BAA0B,GAA1B,SAAAA,0BAA0BA,CAACG,sBAAsC,EAAe;MAC/E,MAAMC,YAAY,GAAGC,WAAW,CAACC,eAAe,CAACH,sBAAsB,CAAC;MACxE,MAAMI,kBAAkB,GAAGH,YAAY,CAACI,0BAA0B,CAAC,CAAC;MACpE,IAAID,kBAAkB,CAACE,uBAAuB,CAACC,gBAAgB,EAAE;QAChE,MAAMX,IAAI,GAAG,IAAIY,IAAI,CAAC;UACrBC,IAAI,EAAEC,OAAO,CAACC,oBAAoB,CAAC,eAAe,CAAC,CAAEC,OAAO,CAAC,wBAAwB,CAAC;UACtFC,IAAI,EAAE,eAAe;UACrBC,UAAU,EAAE,CACX,IAAIC,UAAU,CAAC;YACdC,GAAG,EAAE,SAAS;YACdC,KAAK,EAAE;UACR,CAAC,CAAC,EACF,IAAIF,UAAU,CAAC;YACdC,GAAG,EAAE,aAAa;YAClBC,KAAK,EAAE;UACR,CAAC,CAAC,EACF,IAAIF,UAAU,CAAC;YACdC,GAAG,EAAE,gBAAgB;YACrBC,KAAK,EAAE;UACR,CAAC,CAAC,EACF,IAAIF,UAAU,CAAC;YACdC,GAAG,EAAE,MAAM;YACXC,KAAK,EAAE;UACR,CAAC,CAAC,CACF;UACD;UACAC,OAAO,EAAE,wCAAwC;UACjDC,KAAK,EAAE,eAAAA,CAAA,EAA2C;YACjD,IAAI;cACH,MAAMf,kBAAkB,CAACgB,cAAc,CAAC,kBAAkB,CAAC;cAC3D,MAAM;gBAAEC;cAAQ,CAAC,GAAG,MAAMC,mBAAA,CAAO,wDAAwD,CAAC;cAE1F,MAAMC,eAAe,GAAGtB,YAAY,CAACuB,gBAAgB,CAAC,WAAW,CAAC,EAAED,eAAe;cACnF,MAAME,qBAAqB,GAAGF,eAAe,IAAIA,eAAe,CAACrC,MAAM,GAAG,CAAC,GAAGqC,eAAe,CAACG,IAAI,CAAC,GAAG,CAAC,GAAG,EAAE;cAC5G,MAAMC,wBAAkD,GAAG;gBAC1DC,OAAO,EAAE,CAAC;gBACVC,OAAO,EAAEJ,qBAAqB;gBAC9BK,OAAO,EAAE7B,YAAY,CAACuB,gBAAgB,CAAC,SAAS,CAAC,EAAElC,KAAK,IAAIQ,SAAS;gBACrEiC,aAAa,EAAE9B,YAAY,CAACuB,gBAAgB,CAAC,SAAS,CAAC,EAAEQ,EAAE,IAAIlC;cAChE,CAAC;cACD,MAAMmC,oBAA0C,GAAG;gBAClDL,OAAO,EAAE,CAAC;gBACVM,OAAO,EAAE,IAAI,CAACC,IAAI,CAAC,SAAS,CAAC;gBAC7BC,IAAI,EAAE,IAAI,CAACD,IAAI,CAAC,MAAM,CAAC;gBACvB5C,WAAW,EAAE,IAAI,CAAC4C,IAAI,CAAC,aAAa,CAAC;gBACrCE,cAAc,EAAE,IAAI,CAACF,IAAI,CAAC,gBAAgB;cAC3C,CAAC;cACD,MAAMd,OAAO,CAACM,wBAAwB,EAAEM,oBAAoB,CAAC;YAC9D,CAAC,CAAC,OAAOK,KAAK,EAAE;cACfC,GAAG,CAACD,KAAK,CAAC,0BAA0B,EAAEA,KAAc,CAAC;YACtD;UACD;QACD,CAAC,CAAC;QACFE,UAAU,CAACC,mBAAmB,CAAC7C,IAAI,EAAE,OAAO,EAAE,gBAAgB,CAAC;QAC/D,OAAOA,IAAI;MACZ,CAAC,MAAM;QACN,OAAO,IAAI;MACZ;IACD,CAAC;IAAA,OAAA3B,gBAAA;EAAA,EAhF6BW,cAAc,MAAAR,MAAA;EAAA,OAmF9BH,gBAAgB;AAAA","ignoreList":[],"file":"MessagePopover-dbg.js"}