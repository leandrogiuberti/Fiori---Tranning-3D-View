{"version":3,"file":"ValueHelp.js","names":["ValueHelp","_dec","defineUI5Class","_dec2","association","type","_dec3","property","_dec4","_dec5","_dec6","_dec7","_dec8","_dec9","_dec10","_dec11","_class","_class2","_BuildingBlock","props","others","_this","_flexId","id","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","_descriptor6","_descriptor7","_descriptor8","_descriptor9","_descriptor10","requestGroupId","collaborationEnabled","_exports","_inheritsLoose","getValueHelpForMetaPath","pageController","metaPath","contextPath","metaModel","requiresValidation","arguments","length","undefined","dependents","getView","getDependents","targetMetaPath","startsWith","foundDep","find","child","isA","childMetaPath","getMetaPath","childContextPath","getContextPath","childTargetPath","valueHelp","getId","idPrefix","createId","addDependent","getContent","targetId","innerValueHelp","UI5Element","getElementById","destroy","getParent","_proto","prototype","onMetadataAvailable","content","_getOwner","runAsOwner","createContent","metaContextPath","getMetaPathObject","getMetaModel","entitySetOrSingleton","getClosestEntitySet","isEntitySet","ModelHelper","isCollaborationDraftSupported","createBindingContext","getPath","filterFieldValueHelp","FieldHelper","valueHelpPropertyForFilterField","valueHelpProperty","templateResult","getValueHelpTemplate","useSemanticDateRange","useMultiValueField","navigationPrefix","conditionModel","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./ValueHelp.tsx"],"sourcesContent":["import type { EnhanceWithUI5, PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { association, defineUI5Class, property } from \"sap/fe/base/ClassSupport\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport { isEntitySet } from \"sap/fe/core/helpers/TypeGuards\";\nimport FieldHelper from \"sap/fe/macros/field/FieldHelper\";\nimport { getValueHelpTemplate } from \"sap/fe/macros/internal/valuehelp/ValueHelpTemplating\";\n\nimport type PageController from \"sap/fe/core/PageController\";\nimport type Control from \"sap/ui/core/Control\";\nimport UI5Element from \"sap/ui/core/Element\";\nimport type MDCValueHelp from \"sap/ui/mdc/ValueHelp\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\n/**\n * Building block for creating a ValueHelp based on the provided OData V4 metadata.\n * @private\n */\n@defineUI5Class(\"sap.fe.macros.ValueHelp\")\nexport default class ValueHelp extends BuildingBlock<MDCValueHelp | Control> {\n\t/**\n\t * A prefix that is added to the generated ID of the value help.\n\t */\n\t@association({ type: \"string\" })\n\tidPrefix?: string;\n\n\t/**\n\t * Defines the metadata path to the property.\n\t */\n\t@property({ type: \"string\" })\n\tmetaPath!: string;\n\n\t@property({ type: \"string\" })\n\tcontextPath!: string;\n\n\t/**\n\t * Indicator whether the value help is for a filter field.\n\t */\n\t@property({ type: \"string\" })\n\tconditionModel = \"\";\n\n\t/**\n\t * Indicates that this is a value help of a filter field. Necessary to decide if a\n\t * validation should occur on the back end or already on the client.\n\t */\n\t@property({ type: \"boolean\" })\n\tfilterFieldValueHelp = false;\n\n\t/**\n\t * Specifies the Sematic Date Range option for the filter field.\n\t */\n\t@property({ type: \"boolean\" })\n\tuseSemanticDateRange = true;\n\n\t/**\n\t * Specifies whether the ValueHelp can be used with a MultiValueField\n\t */\n\t@property({ type: \"boolean\" })\n\tuseMultiValueField = false;\n\n\t@property({ type: \"string\" })\n\tnavigationPrefix?: string;\n\n\t@property({ type: \"boolean\" })\n\trequiresValidation = false;\n\n\t@association({ type: \"string\" })\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\t_flexId?: string;\n\n\trequestGroupId: string | undefined = \"$auto.Workers\";\n\n\tcollaborationEnabled = false;\n\n\ttargetId?: string;\n\n\tconstructor(props: PropertiesOf<ValueHelp>, others?: PropertiesOf<ValueHelp>) {\n\t\tif (props._flexId) {\n\t\t\tprops.id = props._flexId + \"::Block\";\n\t\t}\n\t\tsuper(props, others);\n\t}\n\n\tstatic getValueHelpForMetaPath(\n\t\tpageController: PageController,\n\t\tmetaPath: string,\n\t\tcontextPath: string | undefined,\n\t\tmetaModel: ODataMetaModel | undefined,\n\t\trequiresValidation = false\n\t): ValueHelp | undefined {\n\t\tconst dependents = pageController.getView()?.getDependents();\n\t\tconst targetMetaPath = metaPath.startsWith(\"/\") ? metaPath : contextPath + \"/\" + metaPath;\n\t\tconst foundDep = dependents?.find((child) => {\n\t\t\tif (child.isA<EnhanceWithUI5<ValueHelp>>(\"sap.fe.macros.ValueHelp\") && !requiresValidation) {\n\t\t\t\tconst childMetaPath = child.getMetaPath();\n\t\t\t\tconst childContextPath = child.getContextPath();\n\t\t\t\tconst childTargetPath = childMetaPath.startsWith(\"/\") ? childMetaPath : childContextPath + \"/\" + childMetaPath;\n\t\t\t\treturn childTargetPath === targetMetaPath;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tif (!foundDep) {\n\t\t\tconst valueHelp = new ValueHelp({\n\t\t\t\tmetaPath: metaPath,\n\t\t\t\tcontextPath: contextPath,\n\t\t\t\tmetaModel: metaModel?.getId(),\n\t\t\t\tidPrefix: pageController.getView()?.createId(\"FieldValueHelp\"),\n\t\t\t\trequiresValidation: requiresValidation\n\t\t\t});\n\t\t\tpageController.getView().addDependent(valueHelp);\n\t\t\tif (!valueHelp.getContent() && valueHelp.targetId) {\n\t\t\t\tconst innerValueHelp = UI5Element.getElementById(valueHelp.targetId);\n\t\t\t\tvalueHelp.destroy();\n\t\t\t\treturn innerValueHelp?.getParent() as ValueHelp | undefined;\n\t\t\t}\n\n\t\t\treturn valueHelp;\n\t\t} else {\n\t\t\treturn foundDep as ValueHelp | undefined;\n\t\t}\n\t}\n\n\tonMetadataAvailable(): void {\n\t\tif (!this.content) {\n\t\t\tthis._getOwner()?.runAsOwner(() => {\n\t\t\t\tthis.content = this.createContent();\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateContent(): Control | MDCValueHelp | undefined {\n\t\tconst metaContextPath = this.getMetaPathObject(this.metaPath, this.contextPath);\n\t\tconst metaModel = this._getOwner()?.getMetaModel(this.metaModel);\n\t\tif (metaContextPath && metaModel) {\n\t\t\tconst entitySetOrSingleton = metaContextPath.getClosestEntitySet();\n\t\t\tif (isEntitySet(entitySetOrSingleton)) {\n\t\t\t\tthis.collaborationEnabled = ModelHelper.isCollaborationDraftSupported(metaModel);\n\t\t\t}\n\n\t\t\tlet metaPath = metaModel.createBindingContext(metaContextPath.getPath());\n\t\t\tif (metaPath) {\n\t\t\t\tif (this.filterFieldValueHelp) {\n\t\t\t\t\tmetaPath = metaModel.createBindingContext(FieldHelper.valueHelpPropertyForFilterField(metaPath))!;\n\t\t\t\t} else {\n\t\t\t\t\tmetaPath = metaModel.createBindingContext(FieldHelper.valueHelpProperty(metaPath))!;\n\t\t\t\t}\n\t\t\t\tconst idPrefix = this.idPrefix ?? \"ValueHelp\";\n\t\t\t\tconst templateResult = getValueHelpTemplate(metaPath, {\n\t\t\t\t\tmetaPath: metaModel.createBindingContext(metaContextPath.getPath())!,\n\t\t\t\t\tcontextPath: metaModel.createBindingContext(metaContextPath.getContextPath())!,\n\t\t\t\t\tfilterFieldValueHelp: this.filterFieldValueHelp,\n\t\t\t\t\tuseSemanticDateRange: this.useSemanticDateRange,\n\t\t\t\t\tuseMultiValueField: this.useMultiValueField,\n\t\t\t\t\tnavigationPrefix: this.navigationPrefix,\n\t\t\t\t\trequiresValidation: this.requiresValidation,\n\t\t\t\t\t_flexId: this._flexId,\n\t\t\t\t\tidPrefix: idPrefix,\n\t\t\t\t\tconditionModel: this.conditionModel,\n\t\t\t\t\trequestGroupId: this.requestGroupId,\n\t\t\t\t\tcollaborationEnabled: this.collaborationEnabled\n\t\t\t\t});\n\t\t\t\tif (typeof templateResult === \"string\") {\n\t\t\t\t\tthis.targetId = templateResult;\n\t\t\t\t\treturn undefined;\n\t\t\t\t} else {\n\t\t\t\t\treturn templateResult;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[]}