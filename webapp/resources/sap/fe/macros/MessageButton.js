/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/ClassSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/m/Button","sap/m/MessageItem","sap/m/MessagePopover","sap/m/library","sap/ui/core/Element","sap/ui/core/Messaging","sap/ui/core/message/MessageType","sap/fe/base/jsx-runtime/jsx"],function(e,t,s,i,n,o,r,a,l,g,c){"use strict";var u,p,h,f,_;var m={};var d=r.ButtonType;var E=t.event;var v=t.defineUI5Class;function M(e,t,s,i){s&&Object.defineProperty(e,t,{enumerable:s.enumerable,configurable:s.configurable,writable:s.writable,value:s.initializer?s.initializer.call(i):void 0})}function b(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,P(e,t)}function P(e,t){return P=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},P(e,t)}function S(e,t,s,i,n){var o={};return Object.keys(i).forEach(function(e){o[e]=i[e]}),o.enumerable=!!o.enumerable,o.configurable=!!o.configurable,("value"in o||o.initializer)&&(o.writable=!0),o=s.slice().reverse().reduce(function(s,i){return i(e,t,s)||s},o),n&&void 0!==o.initializer&&(o.value=o.initializer?o.initializer.call(n):void 0,o.initializer=void 0),void 0===o.initializer?(Object.defineProperty(e,t,o),null):o}function T(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let C=(u=v("sap.fe.macros.MessageButton"),p=E(),u(h=(f=function(t){function s(e,s){var i;i=t.call(this,e,s)||this;M(i,"visibilityChange",_,i);i._messageItemMessageDetailMap={};return i}m=s;b(s,t);var r=s.prototype;r.onMetadataAvailable=function e(){if(!this.content){this.content=this.createContent()}this._messageModel=l.getMessageModel();this._mmPropertyBinding=this._messageModel.bindProperty("/");this._mmPropertyBinding.attachChange(this.processMessages,this);const t={onBeforeRendering:()=>{this.processMessages();this.removeEventDelegate(t)}};this.addEventDelegate(t)};r.processMessages=async function e(){const t=this._messageModel?.getData();const s=t.reduce((e,t)=>{const s=t.getTargets().length>0;const i=t.getTechnical();if(s&&!i){e.push({message:t})}return e},[]);if(s&&s.length>0){await this.getPageController().messageHandler.beforeShowMessageButton(s)}this.adjustMessageButtonProperties(s)};r.adjustMessageButtonProperties=function e(t){this._messageItemMessageDetailMap={};if(t&&t.length>0){const e={Error:0,Warning:1,Success:2,Information:3,None:4};let s=e.None;let i=0;const n=[];for(const o of t){const t=o.message;const r=t.getType();const a=e[r];if(a<s){s=a}if(r===g.Error){i++}n.push(this.createMessageItem(o))}this.getContent()?.setText(t.length.toString());const o=[d.Negative,d.Critical,d.Success,d.Neutral,d.Default];this.getContent()?.setType(o[s]);const r=["C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_TITLE_ERROR","C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_WARNING_TOOLTIP","C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_SUCCESS","C_MESSAGE_HANDLING_SAPFE_ERROR_MESSAGES_PAGE_TITLE_INFO",""];const a=i>1?"C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_MULTIPLE_ERROR_TOOLTIP":r[s];let l=this.getTranslatedText(a);if(i>1){l=`${i}  ${l}`}this.getContent()?.setTooltip(l);if(!this.getContent()?.getVisible()){this.getContent()?.setVisible(true);this.fireEvent("visibilityChange",{visible:this.getContent()?.getVisible()})}this.createMessagePopover(n)}if(t.length===0){if(this.getContent()?.getVisible()){this.getContent()?.setVisible(false);this.fireEvent("visibilityChange",{visible:this.getContent()?.getVisible()})}}};r.createMessageItem=function e(t){const s=t.message;const i=c(n,{title:s.getMessage(),description:s.getDescription(),type:s.getType(),markupDescription:true,longtextUrl:s.getDescriptionUrl(),subtitle:s.getAdditionalText(),groupName:t.groupName||this.getTranslatedText("T_MESSAGE_BUTTON_SAPFE_MESSAGE_GROUP_GENERAL"),activeTitle:s.getControlIds().length>0||typeof t.activeTitleHandler==="function"});this._messageItemMessageDetailMap[i.getId()]=t;return i};r.createMessagePopover=function e(t){this._messagePopover?.destroy();this._messagePopover=c(o,{groupItems:true,activeTitlePress:e=>{const t=e.getParameter("item");this.handleActiveTitlePress(t)},children:{items:t}});this.getContent()?.addDependent(this._messagePopover);setTimeout(()=>{this._messagePopover.openBy(this.getContent())},0)};r.handleActiveTitlePress=function t(s){if(s){const e=this._messageItemMessageDetailMap[s?.getId()];if(e.activeTitleHandler){e.activeTitleHandler(e.message)}else{const t=e.message.getControlId();const s=a.getElementById(t);if(s){s.focus()}}}else{e.error("message item not found!")}};r.destroy=function e(){this._mmPropertyBinding.destroy()};r.toggleMessagePopover=function e(){this._messagePopover.toggle(this.content)};r.createContent=function e(){return c(i,{visible:"false",press:this.toggleMessagePopover.bind(this)})};return s}(s),_=S(f.prototype,"visibilityChange",[p],{configurable:true,enumerable:true,writable:true,initializer:null}),f))||h);m=C;return m},false);
//# sourceMappingURL=MessageButton.js.map