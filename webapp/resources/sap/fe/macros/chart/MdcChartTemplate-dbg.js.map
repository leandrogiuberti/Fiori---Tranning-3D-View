{"version":3,"names":["measureRole","personalizationValues","createChartDefinition","chartBlock","converterContext","contextObjectPath","controlPath","visualizationPath","getContextRelativeTargetObjectPath","visualizations","_metaPathContext","getObject","$Type","Visualizations","PresentationVariant","length","checkChartExists","visualizationDefinition","getDataVisualizationConfiguration","isCondensedTableLayoutCompliant","useCondensedLayout","isMacroOrMultipleView","shouldCreateTemplateChartVisualization","some","visualization","includes","$AnnotationPath","getContentId","macroId","getExtraParams","extraParams","customActions","actions","Object","values","forEach","action","isA","key","getActionProperties","text","placement","anchor","map","_","index","act","actionKey","concat","press","requiresSelection","enabled","undefined","position","menu","actionProperties","__noWrap","createBindingContext","data","contextPath","uid","actionsModel","JSONModel","setProperty","getChartMeasures","chartAnnotationPath","chartDefinition","annotationPath","split","filter","item","pos","indexOf","toString","replaceAll","oChart","getInvolvedDataModelObjects","_metaModel","_context","targetObject","measures","annoPath","getPath","chartMeasures","Measures","chartDynamicMeasures","DynamicMeasures","entitySetPath","replace","transAggregations","transAgg","customAggregations","customAgg","containsAggregatedProperty","containsTransAggInMeasures","Log","warning","isCustomAggregateIsMeasure","oChartMeasure","oCustomAggMeasure","getCustomAggMeasure","Error","dynamicMeasure","getDynamicMeasures","chartMeasure","value","customAggMeasure","measureType","setCustomAggMeasure","setTransAggMeasure","setChartMeasureAttributes","_chart","MeasureAttributes","measuresModel","$$valueAsPromise","measure","error","role","label","propertyPath","push","transAggMeasure","name","aggregationMethod","chartDynamicMeasure","chart","aggregatedProperty","startsWith","Name","AggregatableProperty","AggregationMethod","resolveBindingString","annotations","Common","Label","$target","measureAttributes","measureAttribute","_setChartMeasureAttribute","path","DynamicMeasure","Measure","measureAttributeDataPoint","DataPoint","Role","dataPoint","setMeasureRole","setMeasureDataPoint","createDataPointProperty","oDataPointAnno","oDataPoint","TargetValue","targetValue","$Path","ForecastValue","foreCastValue","oCriticality","Criticality","isPathAnnotationExpression","Calculated","Static","$EnumMember","CriticalityCalculation","oThresholds","bConstant","buildThresholds","ConstantThresholds","DynamicThresholds","criticality","thresholds","criticalityCalculation","keys","ImprovementDirection","dynamicThresholds","oneSupplied","usedMeasures","constantThresholds","initialiseThresholds","processThresholds","AggregationLevels","processAggregationLevelForThresholds","oAggregationLevel","VisibleDimensions","sKey","processAggregationLevelsForConstantThresholds","aggregationLevel","aggregationLevelInfo","visibleDimensions","AggregationLevel","$PropertyPath","Value","ChartHelper","formatJSONToString","getDependents","chartContext","_commandActions","commandAction","getActionCommand","checkPersonalizationInChartProperties","personalization","_personalization","join","verifyValidPersonalization","valid","splitArray","acceptedValues","arrayElement","getVariantManagement","variantManagement","createVariantManagement","_jsx","VariantManagement","id","generate","_blockId","for","showSetAsDefault","headerLevel","select","event","fireVariantSelected","save","fireVariantSaved","getPersistenceProvider","PersistenceProvider","pushActionCommand","actionContext","dataField","chartOperationAvailableMap","onExecuteAction","getPressEventForDataFieldForActionButton","onExecuteIBN","CommonHelper","getPressHandlerForDataFieldForIBN","onExecuteManifest","buildActionWrapper","dataFieldContext","dataFieldAction","getActionContext","isBoundPath","getPathToBoundActionOverload","isBound","escapeXMLAttributeValue","getOperationAvailableMap","context","isActionEnabled","isDataFieldForActionButtonEnabled","$IsBound","Action","enableOnSelect","isIBNEnabled","RequiresContext","commandEnabled","type","actionCommand","CommandExecution","execute","commandExecute","visible","getVisible","command","IsBound","view","CommonUtils","getTargetView","getSource","controller","getController","sInvocationGrouping","InvocationGrouping","params","contexts","getBindingContext","getProperty","invocationGrouping","controlId","operationAvailableMap","model","getModel","editFlow","invokeAction","navigationParameters","navigationContexts","Mapping","semanticObjectMapping","JSON","stringify","_intentBasedNavigation","navigate","SemanticObject","FPMHelper","actionWrapper","handlerModule","handlerMethod","getItems","dimensions","Dimensions","formatDimensions","_chartContext","dimension","getItem","formatMeasures","prefix","MdcChartItem","propertyKey","getToolbarActions","getActions","onSegmentedButtonPressed","getSegmentedButton","isInsightsEnabled","getStandardActions","isInsightsVisible","ActionToolbarAction","children","Button","onAddCardToInsightsPressed","layoutData","OverflowToolbarLayoutData","priority","removeMenuItems","chartActions","actionsWithOverflowProtection","ActionHelper","ensurePrimaryActionNeverOverflows","getAction","hasOwnProperty","getCustomActions","idx","splice","actionEnabled","getActionToolbarAction","unittestid","ariaHasPopup","getActionToolbarMenuAction","useDefaultActionOnly","DefaultActionHandler","getUseDefaultActionOnly","buttonMode","getButtonMode","defaultAction","group","getMenuItemFromMenu","menuItemAction","pressHandler","noWrap","functionName","selectedContexts","MenuItem","props","aMenuItems","isAIOperation","isMenuAIOperation","MenuButton","menuPosition","Dock","BeginBottom","icon","aiIcon","Menu","isMenuItem","getNavigationActions","getAnnotationActions","menuItems","menuAction","actionObject","getAnnotationActionsEnabled","dataFieldModelObjectPath","isDataModelObjectPathForActionWithDialog","toolbarAction","pressEvent","buildAction","getActionPress","actionPress","getCustomActionPress","getActionPressWithAnnotationPath","getStandardActionPressWithNoCommand","layoutInformation","aggregationName","alignment","SegmentedButton","selectionChange","fireSegmentedButtonPressed","merge","getParameters","selectedKey","getSelectedKey","notEqual","pathInModel","items","getSegmentedButtonItems","segmentedButtonItems","isDesktop","getSegmentedButtonItem","tooltip","SegmentedButtonItem","getVisualizationPath","metaPath","term","resolvedTarget","getEntityTypeAnnotation","getVisualizationsFromAnnotation","chartViz","find","viz","hiddenPathContext","getHiddenPathExpressionForTableActionsAndIBN","getChartConverterContext","properties","originalViewData","diagnostics","viewData","assign","resourceModel","appComponent","deepClone","controlConfiguration","relativePath","getTargetObjectPath","contextLocation","entitySetName","targetEntitySet","entitySet","ConverterContext","createConverterContextForMacro","startingEntitySet","ManifestWrapper","getConverterContext","initialConverterContext","modifyIdentifiers","_applyIdToContent","_contentId","initialise","metaContextPath","getMetaPathObject","_resolvedContextPath","_getOwner","preprocessorContext","models","metaModel","getContextPath","viewConfig","getManifestWrapper","getViewConfiguration","isMultiTabs","paths","hasMultipleVisualizations","getTemplateType","TemplateType","AnalyticalListPage","getUiChart","_blockActions","collection","navigationPath","autoBindOnInit","vizProperties","getFilterBar","draftSupported","ModelHelper","isMetaPathDraftSupported","_chartType","formatChartType","ChartType","commandActions","presentationPath","createPresentationPathContext","_sortConditions","getSortConditions","applySupported","chartActionsContext","Actions","targetCollectionPath","getTargetCollectionPath","targetCollectionPathContext","actionsObject","convertedTypes","resolvePath","target","_customData","entityType","parse","multiSelectDisabledActions","getMultiSelectDisabledActions","segmentedButtonId","multiViews","selectionPresentationVariantPath","chartDimensionKeyAndRole","chartMeasureKeyAndRole","isParameterizedEntitySet","substring","filterBar","Element","getElementById","getDelegate","chartDelegate","payload","selectionMode","toUpperCase","chartContextPath","parameters","$$groupId","getCustomData","CustomData","getNoData","IllustratedMessage","illustrationSize","IllustratedMessageSize","Auto","illustrationType","IllustratedMessageType","BeforeSearch","title","getTranslatedText","description","enableDefaultTitleAndDescription","enableVerticalResponsiveness","getMdcChartTemplate","FlexItemData","growFactor","shrinkFactor","MdcChart","binding","internal","chartType","sortConditions","header","Title","headerVisible","minHeight","Device","system","phone","height","width","headerStyle","p13nMode","noDataText","delegate","customData","dependents","variant","noData","_exports"],"sourceRoot":".","sources":["MdcChartTemplate.tsx"],"sourcesContent":["import type { PrimitiveType, PropertyPath } from \"@sap-ux/vocabularies-types\";\nimport type { AggregatedProperty } from \"@sap-ux/vocabularies-types/vocabularies/Analytics\";\nimport { AnalyticsAnnotationTerms } from \"@sap-ux/vocabularies-types/vocabularies/Analytics\";\nimport { CoreAnnotationTerms } from \"@sap-ux/vocabularies-types/vocabularies/Core\";\nimport type {\n\tChartMeasureAttributeType,\n\tChartMeasureRoleType,\n\tChart as ChartType,\n\tCriticalityCalculationType,\n\tCriticalityType,\n\tDataFieldAbstractTypes,\n\tDataFieldForAction,\n\tDataFieldForIntentBasedNavigation,\n\tDataPoint,\n\tImprovementDirectionType,\n\tLevelThresholdsType,\n\tPresentationVariant,\n\tSelectionPresentationVariant\n} from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport { OperationGroupingType, UIAnnotationTerms, UIAnnotationTypes } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport Log from \"sap/base/Log\";\nimport deepClone from \"sap/base/util/deepClone\";\nimport merge from \"sap/base/util/merge\";\nimport uid from \"sap/base/util/uid\";\nimport {\n\tnotEqual,\n\tpathInModel,\n\tresolveBindingString,\n\ttype BindingToolkitExpression,\n\ttype CompiledBindingToolkitExpression\n} from \"sap/fe/base/BindingToolkit\";\nimport type { CommandProperties } from \"sap/fe/base/jsx-runtime/jsx\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport { escapeXMLAttributeValue } from \"sap/fe/core/buildingBlocks/templating/BuildingBlockTemplateProcessor\";\nimport type { NavigationParameters } from \"sap/fe/core/controllerextensions/InternalIntentBasedNavigation\";\nimport CommandExecution from \"sap/fe/core/controls/CommandExecution\";\nimport ConverterContext from \"sap/fe/core/converters/ConverterContext\";\nimport type { BaseManifestSettings, ControlConfiguration } from \"sap/fe/core/converters/ManifestSettings\";\nimport { TemplateType } from \"sap/fe/core/converters/ManifestSettings\";\nimport ManifestWrapper from \"sap/fe/core/converters/ManifestWrapper\";\nimport { getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type { PageContextPathTarget } from \"sap/fe/core/converters/TemplateConverter\";\nimport { isDataModelObjectPathForActionWithDialog } from \"sap/fe/core/converters/annotations/DataField\";\nimport {\n\taiIcon,\n\tisMenuAIOperation,\n\ttype AnnotationAction,\n\ttype BaseAction,\n\ttype CustomAction\n} from \"sap/fe/core/converters/controls/Common/Action\";\nimport type { ChartP13nType, ChartVisualization } from \"sap/fe/core/converters/controls/Common/Chart\";\nimport type { VisualizationAndPath } from \"sap/fe/core/converters/controls/Common/DataVisualization\";\nimport {\n\tgetDataVisualizationConfiguration,\n\tgetVisualizationsFromAnnotation\n} from \"sap/fe/core/converters/controls/Common/DataVisualization\";\nimport FPMHelper from \"sap/fe/core/helpers/FPMHelper\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport { isPathAnnotationExpression } from \"sap/fe/core/helpers/TypeGuards\";\nimport type { ViewData } from \"sap/fe/core/services/TemplatedViewServiceFactory\";\nimport type Diagnostics from \"sap/fe/core/support/Diagnostics\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { getContextRelativeTargetObjectPath, getTargetObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport CommonHelper from \"sap/fe/macros/CommonHelper\";\nimport type Action from \"sap/fe/macros/chart/Action\";\nimport type ActionGroup from \"sap/fe/macros/chart/ActionGroup\";\nimport type { Button$PressEvent } from \"sap/m/Button\";\nimport Button from \"sap/m/Button\";\nimport FlexItemData from \"sap/m/FlexItemData\";\nimport IllustratedMessage from \"sap/m/IllustratedMessage\";\nimport IllustratedMessageSize from \"sap/m/IllustratedMessageSize\";\nimport IllustratedMessageType from \"sap/m/IllustratedMessageType\";\nimport Menu from \"sap/m/Menu\";\nimport MenuButton from \"sap/m/MenuButton\";\nimport MenuItem from \"sap/m/MenuItem\";\nimport OverflowToolbarLayoutData from \"sap/m/OverflowToolbarLayoutData\";\nimport type { SegmentedButton$SelectionChangeEvent } from \"sap/m/SegmentedButton\";\nimport SegmentedButton from \"sap/m/SegmentedButton\";\nimport SegmentedButtonItem from \"sap/m/SegmentedButtonItem\";\nimport type { OverflowToolbarPriority } from \"sap/m/library\";\nimport Device from \"sap/ui/Device\";\nimport type { CommandExecution$ExecuteEvent } from \"sap/ui/core/CommandExecution\";\nimport CustomData from \"sap/ui/core/CustomData\";\nimport Element from \"sap/ui/core/Element\";\nimport { Dock } from \"sap/ui/core/Popup\";\nimport type { VariantManagement$SaveEvent, VariantManagement$SelectEvent } from \"sap/ui/fl/variants/VariantManagement\";\nimport VariantManagement from \"sap/ui/fl/variants/VariantManagement\";\nimport MdcChart from \"sap/ui/mdc/Chart\";\nimport type Control from \"sap/ui/mdc/Control\";\nimport ActionToolbarAction from \"sap/ui/mdc/actiontoolbar/ActionToolbarAction\";\nimport MdcChartItem from \"sap/ui/mdc/chart/Item\";\nimport PersistenceProvider from \"sap/ui/mdc/p13n/PersistenceProvider\";\nimport type Context from \"sap/ui/model/Context\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type { ExpandPathType, MetaModelEnum, MetaModelType } from \"../../../../../../../types/metamodel_types\";\nimport type ChartBlock from \"../Chart\";\nimport type MacroAPI from \"../MacroAPI\";\nimport ActionHelper from \"../internal/helpers/ActionHelper\";\nimport DefaultActionHandler from \"../internal/helpers/DefaultActionHandler\";\nimport ChartHelper from \"./ChartHelper\";\n\nconst measureRole: { [key: string]: string } = {\n\t\"com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1\": \"axis1\",\n\t\"com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis2\": \"axis2\",\n\t\"com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis3\": \"axis3\",\n\t\"com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis4\": \"axis4\"\n};\ntype ExtendedActionGroup = ActionGroup & { menuContentActions?: Record<string, Action> };\ntype ChartPayload = {\n\tchartContextPath: string;\n\tparameters: object;\n\tselectionMode: string;\n};\ntype ChartDelegate = {\n\tname: string;\n\tpayload: ChartPayload;\n};\nexport type ActionOrActionGroup = Record<string, Action | ExtendedActionGroup>;\nexport type CustomAndAction = CustomAction & (Action | ActionGroup);\ntype CustomToolbarMenuAction = {\n\tid: string;\n\ttext: string | undefined;\n\tvisible: string | undefined;\n\tenabled?: string | boolean;\n\tuseDefaultActionOnly?: boolean;\n\tbuttonMode?: string;\n\tdefaultAction?: string;\n\tactions?: CustomAction;\n\tpriority?: OverflowToolbarPriority;\n\tgroup?: number;\n};\n\nenum personalizationValues {\n\tSort = \"Sort\",\n\tType = \"Type\",\n\tItem = \"Item\",\n\tFilter = \"Filter\"\n}\n\nexport type MeasureType = {\n\tid?: string;\n\tkey?: string;\n\trole?: string;\n\tpropertyPath?: string;\n\taggregationMethod?: string;\n\tlabel?: string | BindingToolkitExpression<PrimitiveType>;\n\tvalue?: string;\n\tdataPoint?: string;\n\tname?: string;\n};\n\ntype DimensionType = {\n\tid?: string;\n\tkey?: string;\n\trole?: string;\n\tpropertyPath?: string;\n\tlabel?: string | BindingToolkitExpression<PrimitiveType>;\n\tvalue?: string;\n};\n\nexport type CommandAction = {\n\tactionContext: Context;\n\tonExecuteAction: string;\n\tonExecuteIBN?: string;\n\tonExecuteManifest: CompiledBindingToolkitExpression;\n\tchartOperationAvailableMap?: string;\n};\n\ntype ToolBarAction = {\n\tunittestid: string;\n\tid?: string;\n\tlabel: string;\n\tariaHasPopup?: string;\n\tpress?: string;\n\tenabled?: string | boolean;\n\tvisible: string | boolean;\n};\n\nexport type ChartCustomData = {\n\ttargetCollectionPath: string;\n\tentitySet: string;\n\tentityType: string;\n\toperationAvailableMap: string;\n\tmultiSelectDisabledActions: string;\n\tsegmentedButtonId: string;\n\tcustomAgg: object;\n\ttransAgg: object;\n\tapplySupported: object;\n\tvizProperties: object;\n\tdraftSupported?: boolean;\n\tmultiViews?: boolean;\n\tselectionPresentationVariantPath?: object;\n\tchartDimensionKeyAndRole?: object;\n\tchartMeasureKeyAndRole?: object;\n};\n\nexport type ChartContextObjectPath = ChartType | SelectionPresentationVariant | PresentationVariant;\n\ntype ActionProperties = {\n\tkey: string;\n\ttext: string;\n\t__noWrap: boolean;\n\tpress: string | null;\n\trequiresSelection: boolean;\n\tenabled: boolean;\n\tposition?: object;\n\tmenu?: string[];\n};\n\ntype ToolbarAction = MenuItem | ActionToolbarAction | undefined;\n\nfunction createChartDefinition(\n\tchartBlock: ChartBlock,\n\tconverterContext: ConverterContext,\n\tcontextObjectPath: DataModelObjectPath<ChartType | SelectionPresentationVariant | PresentationVariant>,\n\tcontrolPath: string\n): ChartVisualization {\n\tlet visualizationPath = getContextRelativeTargetObjectPath(contextObjectPath);\n\tlet visualizations: Record<string, string>[] = [];\n\tif (chartBlock._metaPathContext?.getObject()?.$Type === UIAnnotationTypes.PresentationVariantType) {\n\t\tvisualizations = chartBlock._metaPathContext.getObject().Visualizations;\n\t} else if (chartBlock._metaPathContext?.getObject()?.$Type === UIAnnotationTypes.SelectionPresentationVariantType) {\n\t\tvisualizations = chartBlock._metaPathContext.getObject().PresentationVariant?.Visualizations;\n\t}\n\tif (visualizations?.length && !checkChartExists(visualizations, controlPath)) {\n\t\tvisualizationPath = \"\";\n\t}\n\n\t// fallback to default Chart if visualizationPath is missing or visualizationPath is not found in control (in case of PresentationVariant)\n\tif (!visualizationPath) {\n\t\tvisualizationPath = `@${UIAnnotationTerms.Chart}`;\n\t}\n\n\tconst visualizationDefinition = getDataVisualizationConfiguration(visualizationPath, converterContext, {\n\t\tisCondensedTableLayoutCompliant: chartBlock.useCondensedLayout,\n\t\tisMacroOrMultipleView: true,\n\t\tshouldCreateTemplateChartVisualization: false\n\t});\n\treturn visualizationDefinition.visualizations[0] as ChartVisualization;\n}\n\nfunction checkChartExists(visualizations: Record<string, string>[], visualizationPath: string | undefined): boolean {\n\treturn visualizations.some((visualization) => visualizationPath?.includes(visualization.$AnnotationPath));\n}\n\nfunction getContentId(macroId: string): string {\n\treturn `${macroId}-content`;\n}\n\n/**\n * Function used to get details WRT action(s) shown in the chart's toolbar.\n * @param chartBlock Chart block properties\n * @param visualizationPath Visualization path\n * @returns Object with all the required action(s) details\n */\nfunction getExtraParams(chartBlock: ChartBlock, visualizationPath: string | undefined): Record<string, object> {\n\tconst extraParams: Record<string, object> = {};\n\tconst customActions: Record<string, object> = {};\n\n\tif (chartBlock.actions) {\n\t\tObject.values(chartBlock.actions)?.forEach((action: Action | ActionGroup) => {\n\t\t\tif (action.isA<ActionGroup>(\"sap.fe.macros.chart.ActionGroup\")) {\n\t\t\t\tcustomActions[action.key] = getActionProperties(\n\t\t\t\t\taction.key,\n\t\t\t\t\taction.text,\n\t\t\t\t\tnull,\n\t\t\t\t\tfalse,\n\t\t\t\t\ttrue,\n\t\t\t\t\t{\n\t\t\t\t\t\tplacement: action.placement,\n\t\t\t\t\t\tanchor: action.anchor\n\t\t\t\t\t},\n\t\t\t\t\taction.actions.map((_, index) => action.key + \"_Menu_\" + index)\n\t\t\t\t);\n\n\t\t\t\taction.actions?.forEach((act: Action, index: number) => {\n\t\t\t\t\tconst actionKey = action.key.concat(\"_Menu_\", index as unknown as string);\n\t\t\t\t\tcustomActions[actionKey] = getActionProperties(\n\t\t\t\t\t\tactionKey,\n\t\t\t\t\t\tact.text,\n\t\t\t\t\t\tact.press,\n\t\t\t\t\t\t!!act.requiresSelection,\n\t\t\t\t\t\tact.enabled === null || act.enabled === undefined ? true : act.enabled\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t} else if (action.isA<Action>(\"sap.fe.macros.chart.Action\")) {\n\t\t\t\tcustomActions[action.key] = getActionProperties(\n\t\t\t\t\taction.key,\n\t\t\t\t\taction.text,\n\t\t\t\t\taction.press,\n\t\t\t\t\t!!action.requiresSelection,\n\t\t\t\t\taction.enabled === null || action.enabled == undefined ? true : action.enabled,\n\t\t\t\t\t{\n\t\t\t\t\t\tplacement: action.placement,\n\t\t\t\t\t\tanchor: action.anchor\n\t\t\t\t\t}\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t}\n\tif (visualizationPath && chartBlock.actions) {\n\t\textraParams[visualizationPath] = {\n\t\t\tactions: customActions\n\t\t};\n\t}\n\n\treturn extraParams;\n}\n\nfunction getActionProperties(\n\tkey: string,\n\ttext: string,\n\tpress: string | null,\n\trequiresSelection: boolean,\n\tenabled: boolean,\n\tposition?: object,\n\tmenu?: string[]\n): ActionProperties {\n\tconst actionProperties: ActionProperties = {\n\t\tkey,\n\t\ttext,\n\t\t__noWrap: true,\n\t\tpress,\n\t\trequiresSelection,\n\t\tenabled\n\t};\n\n\tif (position) {\n\t\tactionProperties.position = position;\n\t}\n\tif (menu) {\n\t\tactionProperties.menu = menu;\n\t}\n\n\treturn actionProperties;\n}\n\nfunction createBindingContext(data: object | BaseAction[] | CustomAction): Context {\n\tconst contextPath = `/${uid()}`;\n\tconst actionsModel = new JSONModel();\n\tactionsModel.setProperty(contextPath, data);\n\treturn actionsModel.createBindingContext(contextPath)!;\n}\n\nfunction getChartMeasures(chartBlock: ChartBlock): Context {\n\tconst chartAnnotationPath = chartBlock.chartDefinition.annotationPath.split(\"/\");\n\t// this is required because getAbsolutePath in converterContext returns \"/SalesOrderManage/_Item/_Item/@com.sap.vocabularies.v1.Chart\" as annotationPath\n\tconst annotationPath = chartAnnotationPath\n\t\t.filter(function (item: string, pos: number): boolean {\n\t\t\treturn chartAnnotationPath.indexOf(item) == pos;\n\t\t})\n\t\t.toString()\n\t\t.replaceAll(\",\", \"/\");\n\tconst oChart = getInvolvedDataModelObjects<ChartType>(\n\t\tchartBlock._metaModel.createBindingContext(annotationPath)!,\n\t\tchartBlock._context\n\t).targetObject;\n\tlet measures: MeasureType[] = [];\n\tconst annoPath = chartBlock._metaPathContext.getPath();\n\tconst chartMeasures = oChart?.Measures ? oChart.Measures : [];\n\tconst chartDynamicMeasures = oChart?.DynamicMeasures ? oChart.DynamicMeasures : [];\n\tconst entitySetPath = annoPath.replace(/@com.sap.vocabularies.UI.v1.(Chart|PresentationVariant|SelectionPresentationVariant).*/, \"\");\n\tconst transAggregations = chartBlock.chartDefinition.transAgg as Record<string, MeasureType>;\n\tconst customAggregations = chartBlock.chartDefinition.customAgg as Record<string, Record<string, unknown>>;\n\n\t// intimate the user if there is AggregateProperty configured with no DynamicMeasures, but there are measures with AggregatedProperties\n\tif (\n\t\tchartBlock.chartDefinition.containsAggregatedProperty &&\n\t\t!chartDynamicMeasures &&\n\t\tchartBlock.chartDefinition.containsTransAggInMeasures\n\t) {\n\t\tLog.warning(\n\t\t\t\"The transformational aggregate measures are configured as Chart.Measures but should be configured as Chart.DynamicMeasures instead. Please check the SAP Help documentation and correct the configuration accordingly.\"\n\t\t);\n\t}\n\tconst isCustomAggregateIsMeasure = chartMeasures.some((oChartMeasure: MeasureType) => {\n\t\tconst oCustomAggMeasure = getCustomAggMeasure(customAggregations, oChartMeasure);\n\t\treturn !!oCustomAggMeasure;\n\t});\n\tif (chartBlock.chartDefinition.containsAggregatedProperty && !chartDynamicMeasures?.length && !isCustomAggregateIsMeasure) {\n\t\tthrow new Error(\"Please configure DynamicMeasures for the chart\");\n\t}\n\tif (chartBlock.chartDefinition.containsAggregatedProperty && oChart) {\n\t\tfor (const dynamicMeasure of chartDynamicMeasures) {\n\t\t\tmeasures = getDynamicMeasures(measures, dynamicMeasure, entitySetPath, oChart, chartBlock);\n\t\t}\n\t}\n\tfor (const chartMeasure of chartMeasures) {\n\t\tconst key = chartMeasure.value;\n\t\tconst customAggMeasure = getCustomAggMeasure(customAggregations, chartMeasure);\n\t\tconst measureType: MeasureType = {};\n\t\tif (customAggMeasure) {\n\t\t\tmeasures = setCustomAggMeasure(measures, measureType, customAggMeasure, key);\n\t\t\t//if there is neither aggregatedProperty nor measures pointing to customAggregates, but we have normal measures. Now check if these measures are part of AggregatedProperties Obj\n\t\t} else if (!chartBlock.chartDefinition.containsAggregatedProperty && transAggregations[key]) {\n\t\t\tmeasures = setTransAggMeasure(measures, measureType, transAggregations, key);\n\t\t}\n\t\tsetChartMeasureAttributes(chartBlock._chart.MeasureAttributes, entitySetPath, measureType, chartBlock);\n\t}\n\tconst measuresModel: JSONModel = new JSONModel(measures);\n\t(measuresModel as { $$valueAsPromise?: boolean }).$$valueAsPromise = true;\n\treturn measuresModel.createBindingContext(\"/\");\n}\n\nfunction setCustomAggMeasure(measures: MeasureType[], measure: MeasureType, customAggMeasure: MeasureType, key: string): MeasureType[] {\n\tif (key.includes(\"/\")) {\n\t\tLog.error(`$expand is not yet supported. Measure: ${key} from an association cannot be used`);\n\t}\n\tmeasure.key = customAggMeasure.value;\n\tmeasure.role = \"axis1\";\n\tmeasure.label = customAggMeasure.label;\n\tmeasure.propertyPath = customAggMeasure.value;\n\tmeasures.push(measure);\n\treturn measures;\n}\n\nfunction setTransAggMeasure(\n\tmeasures: MeasureType[],\n\tmeasure: MeasureType,\n\ttransAggregations: Record<string, MeasureType>,\n\tkey: string\n): MeasureType[] {\n\tconst transAggMeasure = transAggregations[key];\n\tmeasure.key = transAggMeasure.name;\n\tmeasure.role = \"axis1\";\n\tmeasure.propertyPath = key;\n\tmeasure.aggregationMethod = transAggMeasure.aggregationMethod;\n\tmeasure.label = transAggMeasure.label || measure.label;\n\tmeasures.push(measure);\n\treturn measures;\n}\n\nfunction getDynamicMeasures(\n\tmeasures: MeasureType[],\n\tchartDynamicMeasure: MeasureType,\n\tentitySetPath: string,\n\tchart: ChartType,\n\tchartBlock: ChartBlock\n): MeasureType[] {\n\tconst key = chartDynamicMeasure.value || \"\";\n\tconst aggregatedProperty = getInvolvedDataModelObjects<AggregatedProperty>(\n\t\tchartBlock._metaModel.createBindingContext(entitySetPath + key) as Context,\n\t\tchartBlock._context\n\t).targetObject;\n\tif (key.includes(\"/\")) {\n\t\tLog.error(`$expand is not yet supported. Measure: ${key} from an association cannot be used`);\n\t\t// check if the annotation path is wrong\n\t} else if (!aggregatedProperty) {\n\t\tthrow new Error(`Please provide the right AnnotationPath to the Dynamic Measure ${chartDynamicMeasure.value}`);\n\t\t// check if the path starts with @\n\t} else if (chartDynamicMeasure.value?.startsWith(`@${AnalyticsAnnotationTerms.AggregatedProperty}`) === null) {\n\t\tthrow new Error(`Please provide the right AnnotationPath to the Dynamic Measure ${chartDynamicMeasure.value}`);\n\t} else {\n\t\t// check if AggregatedProperty is defined in given DynamicMeasure\n\t\tconst dynamicMeasure: MeasureType = {\n\t\t\tkey: aggregatedProperty.Name.toString(),\n\t\t\trole: \"axis1\"\n\t\t};\n\t\tdynamicMeasure.propertyPath = aggregatedProperty.AggregatableProperty.value;\n\t\tdynamicMeasure.aggregationMethod = aggregatedProperty.AggregationMethod.toString();\n\t\tdynamicMeasure.label = resolveBindingString(\n\t\t\taggregatedProperty.annotations?.Common?.Label?.toString() ??\n\t\t\t\taggregatedProperty.AggregatableProperty.$target?.annotations?.Common?.Label?.toString() ??\n\t\t\t\t\"\"\n\t\t);\n\t\tsetChartMeasureAttributes(chart.MeasureAttributes, entitySetPath, dynamicMeasure, chartBlock);\n\t\tmeasures.push(dynamicMeasure);\n\t}\n\treturn measures;\n}\n\nfunction getCustomAggMeasure(customAggregations: Record<string, MeasureType | undefined>, measure: MeasureType): MeasureType | null {\n\tif (measure.value && customAggregations[measure.value]) {\n\t\tmeasure.label = customAggregations[measure.value]?.label;\n\t\treturn measure;\n\t}\n\treturn null;\n}\n\nfunction setChartMeasureAttributes(\n\tmeasureAttributes: ChartMeasureAttributeType[],\n\tentitySetPath: string,\n\tmeasure: MeasureType,\n\tchartBlock: ChartBlock\n): void {\n\tif (measureAttributes?.length) {\n\t\tfor (const measureAttribute of measureAttributes) {\n\t\t\t_setChartMeasureAttribute(measureAttribute, entitySetPath, measure, chartBlock);\n\t\t}\n\t}\n}\n\nfunction _setChartMeasureAttribute(\n\tmeasureAttribute: ChartMeasureAttributeType,\n\tentitySetPath: string,\n\tmeasure: MeasureType,\n\tchartBlock: ChartBlock\n): void {\n\tconst path = measureAttribute.DynamicMeasure ? measureAttribute?.DynamicMeasure?.value : measureAttribute?.Measure?.value;\n\tconst measureAttributeDataPoint = measureAttribute.DataPoint ? measureAttribute?.DataPoint?.value : null;\n\tconst role = measureAttribute.Role;\n\tconst dataPoint: DataPoint | undefined = measureAttributeDataPoint\n\t\t? getInvolvedDataModelObjects<DataPoint>(\n\t\t\t\tchartBlock._metaModel.createBindingContext(entitySetPath + measureAttributeDataPoint) as Context,\n\t\t\t\tchartBlock._context\n\t\t  ).targetObject\n\t\t: undefined;\n\tif (measure.key === path) {\n\t\tsetMeasureRole(measure, role as unknown as MetaModelEnum<ChartMeasureRoleType>);\n\t\t//still to add data point, but UI5 Chart API is missing\n\t\tsetMeasureDataPoint(measure, dataPoint);\n\t}\n}\n\n/**\n * Format the data point as a JSON object.\n * @param oDataPointAnno\n * @returns The formatted json object\n */\nfunction createDataPointProperty(oDataPointAnno: DataPoint): {\n\ttargetValue?: string;\n\tforeCastValue?: string;\n\tcriticality?: Record<string, unknown>;\n} {\n\tconst oDataPoint: { targetValue?: string; foreCastValue?: string; criticality?: Record<string, unknown> } = {};\n\n\tif (oDataPointAnno.TargetValue) {\n\t\toDataPoint.targetValue = oDataPointAnno.TargetValue.$Path;\n\t}\n\n\tif (oDataPointAnno.ForecastValue) {\n\t\toDataPoint.foreCastValue = oDataPointAnno.ForecastValue.$Path;\n\t}\n\n\tlet oCriticality = null;\n\tif (oDataPointAnno.Criticality) {\n\t\tif (isPathAnnotationExpression(oDataPointAnno.Criticality) && oDataPointAnno.Criticality.path) {\n\t\t\t//will be an aggregated property or custom aggregate\n\t\t\toCriticality = {\n\t\t\t\tCalculated: oDataPointAnno.Criticality.path\n\t\t\t};\n\t\t} else {\n\t\t\toCriticality = {\n\t\t\t\tStatic: (oDataPointAnno.Criticality as unknown as MetaModelEnum<CriticalityType>).$EnumMember.replace(\n\t\t\t\t\t\"com.sap.vocabularies.UI.v1.CriticalityType/\",\n\t\t\t\t\t\"\"\n\t\t\t\t)\n\t\t\t};\n\t\t}\n\t} else if (oDataPointAnno.CriticalityCalculation) {\n\t\tconst oThresholds: Record<string, unknown> & { AggregationLevels?: unknown[] } = {};\n\t\tconst bConstant = buildThresholds(oThresholds, oDataPointAnno.CriticalityCalculation);\n\n\t\tif (bConstant) {\n\t\t\toCriticality = {\n\t\t\t\tConstantThresholds: oThresholds\n\t\t\t};\n\t\t} else {\n\t\t\toCriticality = {\n\t\t\t\tDynamicThresholds: oThresholds\n\t\t\t};\n\t\t}\n\t}\n\n\tif (oCriticality) {\n\t\toDataPoint.criticality = oCriticality;\n\t}\n\n\treturn oDataPoint;\n}\n\n/**\n * Checks whether the thresholds are dynamic or constant.\n * @param thresholds The threshold skeleton\n * @param criticalityCalculation The UI.DataPoint.CriticalityCalculation annotation\n * @returns `true` if the threshold should be supplied as ConstantThresholds, <code>false</code> if the threshold should\n * be supplied as DynamicThresholds\n * @private\n */\nfunction buildThresholds(\n\tthresholds: Record<string, unknown> & { AggregationLevels?: unknown[] },\n\tcriticalityCalculation: CriticalityCalculationType\n): boolean {\n\tconst keys = [\n\t\t\"AcceptanceRangeLowValue\",\n\t\t\"AcceptanceRangeHighValue\",\n\t\t\"ToleranceRangeLowValue\",\n\t\t\"ToleranceRangeHighValue\",\n\t\t\"DeviationRangeLowValue\",\n\t\t\"DeviationRangeHighValue\"\n\t];\n\tthresholds.ImprovementDirection = (\n\t\tcriticalityCalculation.ImprovementDirection as unknown as MetaModelEnum<ImprovementDirectionType>\n\t)?.$EnumMember.replace(\"com.sap.vocabularies.UI.v1.ImprovementDirectionType/\", \"\");\n\n\tconst dynamicThresholds: Record<string, unknown> & { usedMeasures: unknown[] } = {\n\t\toneSupplied: false,\n\t\tusedMeasures: []\n\t\t// combination to check whether at least one is supplied\n\t};\n\tconst constantThresholds: Record<string, unknown> = {\n\t\toneSupplied: false\n\t\t// combination to check whether at least one is supplied\n\t};\n\n\tinitialiseThresholds(keys, dynamicThresholds, constantThresholds, criticalityCalculation);\n\tprocessThresholds(keys, thresholds, dynamicThresholds, constantThresholds, criticalityCalculation);\n\n\treturn !dynamicThresholds.oneSupplied;\n}\n\nfunction initialiseThresholds(\n\tkeys: string[],\n\tdynamicThresholds: Record<string, unknown> & { usedMeasures: unknown[] },\n\tconstantThresholds: Record<string, unknown>,\n\tcriticalityCalculation: CriticalityCalculationType\n): void {\n\tfor (const key of keys) {\n\t\tdynamicThresholds[key] = criticalityCalculation[key as keyof CriticalityCalculationType]\n\t\t\t? criticalityCalculation[key as keyof CriticalityCalculationType].$Path\n\t\t\t: undefined;\n\t\tdynamicThresholds.oneSupplied = dynamicThresholds.oneSupplied || dynamicThresholds[key];\n\n\t\tif (!dynamicThresholds.oneSupplied) {\n\t\t\t// only consider in case no dynamic threshold is supplied\n\t\t\tconstantThresholds[key] = criticalityCalculation[key as keyof CriticalityCalculationType];\n\t\t\tconstantThresholds.oneSupplied = constantThresholds.oneSupplied || constantThresholds[key];\n\t\t} else if (dynamicThresholds[key]) {\n\t\t\tdynamicThresholds.usedMeasures.push(dynamicThresholds[key as keyof CriticalityCalculationType]);\n\t\t}\n\t}\n}\n\nfunction processThresholds(\n\tkeys: string[],\n\tthresholds: Record<string, unknown> & { AggregationLevels?: unknown[] },\n\tdynamicThresholds: Record<string, unknown> & { usedMeasures: unknown[] },\n\tconstantThresholds: Record<string, unknown>,\n\tcriticalityCalculation: CriticalityCalculationType\n): void {\n\t// dynamic definition shall overrule constant definition\n\tif (dynamicThresholds.oneSupplied) {\n\t\tfor (const key of keys) {\n\t\t\tif (dynamicThresholds[key]) {\n\t\t\t\tthresholds[key] = dynamicThresholds[key];\n\t\t\t}\n\t\t}\n\t\tthresholds.usedMeasures = dynamicThresholds.usedMeasures;\n\t} else {\n\t\tthresholds.AggregationLevels = [];\n\t\tprocessAggregationLevelForThresholds(keys, thresholds, constantThresholds, criticalityCalculation);\n\t}\n}\n\nfunction processAggregationLevelForThresholds(\n\tkeys: string[],\n\tthresholds: Record<string, unknown> & { AggregationLevels?: unknown[] },\n\tconstantThresholds: Record<string, unknown>,\n\tcriticalityCalculation: CriticalityCalculationType\n): void {\n\tlet oAggregationLevel: Record<string, unknown> = {};\n\t// check if at least one static value is supplied\n\tif (constantThresholds.oneSupplied) {\n\t\t// add one entry in the aggregation level\n\t\toAggregationLevel = {\n\t\t\tVisibleDimensions: null\n\t\t};\n\n\t\tfor (const sKey of keys) {\n\t\t\tif (constantThresholds[sKey]) {\n\t\t\t\toAggregationLevel[sKey] = constantThresholds[sKey];\n\t\t\t}\n\t\t}\n\n\t\tthresholds.AggregationLevels?.push(oAggregationLevel);\n\t}\n\n\tprocessAggregationLevelsForConstantThresholds(keys, thresholds, criticalityCalculation, oAggregationLevel);\n}\n\nfunction processAggregationLevelsForConstantThresholds(\n\tkeys: string[],\n\tthresholds: Record<string, unknown> & { AggregationLevels?: unknown[] },\n\tcriticalityCalculation: CriticalityCalculationType,\n\taggregationLevel: Record<string, unknown>\n): void {\n\tif (criticalityCalculation.ConstantThresholds && criticalityCalculation.ConstantThresholds.length > 0) {\n\t\tfor (const aggregationLevelInfo of criticalityCalculation.ConstantThresholds) {\n\t\t\tconst visibleDimensions: string[] | null = aggregationLevelInfo.AggregationLevel ? [] : null;\n\n\t\t\tif (visibleDimensions && aggregationLevelInfo.AggregationLevel && aggregationLevelInfo.AggregationLevel.length > 0) {\n\t\t\t\tfor (const propertyPath of aggregationLevelInfo.AggregationLevel) {\n\t\t\t\t\tvisibleDimensions.push((propertyPath as unknown as ExpandPathType<PropertyPath>).$PropertyPath);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\taggregationLevel = {\n\t\t\t\tVisibleDimensions: visibleDimensions\n\t\t\t};\n\n\t\t\tfor (const key of keys) {\n\t\t\t\tconst value = aggregationLevelInfo[key as unknown as keyof LevelThresholdsType];\n\t\t\t\tif (value) {\n\t\t\t\t\taggregationLevel[key] = value;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthresholds.AggregationLevels?.push(aggregationLevel);\n\t\t}\n\t}\n}\n\nfunction setMeasureDataPoint(measure: MeasureType, dataPoint: DataPoint | undefined): void {\n\tif (dataPoint && dataPoint.Value.$Path == measure.key) {\n\t\tmeasure.dataPoint = ChartHelper.formatJSONToString(createDataPointProperty(dataPoint)) || \"\";\n\t}\n}\n\nfunction setMeasureRole(measure: MeasureType, role: MetaModelEnum<ChartMeasureRoleType> | undefined): void {\n\tif (role != null) {\n\t\tconst index = role.$EnumMember;\n\t\tmeasure.role = measureRole[index];\n\t}\n}\n\nfunction getDependents(chartBlock: ChartBlock, chartContext: Context): string | string[] {\n\tif (chartBlock._commandActions.length > 0) {\n\t\treturn chartBlock._commandActions.map((commandAction: CommandAction) => {\n\t\t\treturn getActionCommand(commandAction, chartContext, chartBlock);\n\t\t});\n\t}\n\treturn \"\";\n}\n\n/**\n *\n * @param personalization Specifies the chart personalization\n */\n\nfunction checkPersonalizationInChartProperties(personalization: ChartP13nType, chartBlock: ChartBlock): void {\n\tif (personalization) {\n\t\tif (personalization === \"false\" || (personalization as boolean) === false) {\n\t\t\tchartBlock._personalization = undefined;\n\t\t} else if (personalization === \"true\" || (personalization as boolean) === true) {\n\t\t\tchartBlock._personalization = Object.values(personalizationValues).join(\",\");\n\t\t} else if (verifyValidPersonalization(personalization as string) === true) {\n\t\t\tchartBlock._personalization = personalization;\n\t\t} else {\n\t\t\tchartBlock._personalization = undefined;\n\t\t}\n\t}\n}\n\n/**\n *\n * @param personalization\n * @returns `true` or `false` if the personalization is valid or not valid\n */\nfunction verifyValidPersonalization(personalization: string): boolean {\n\tlet valid = true;\n\tconst splitArray = personalization.split(\",\");\n\tconst acceptedValues: string[] = Object.values(personalizationValues);\n\tsplitArray.forEach((arrayElement) => {\n\t\tif (!acceptedValues.includes(arrayElement)) {\n\t\t\tvalid = false;\n\t\t}\n\t});\n\treturn valid;\n}\n\nfunction getVariantManagement(chartBlock: ChartBlock): string {\n\tconst variantManagement = chartBlock.variantManagement ? chartBlock.variantManagement : chartBlock.chartDefinition.variantManagement;\n\treturn chartBlock.personalization === undefined ? \"None\" : variantManagement;\n}\n\nfunction createVariantManagement(chartBlock: ChartBlock): string {\n\tconst personalization = chartBlock.personalization;\n\tif (personalization) {\n\t\tconst variantManagement = getVariantManagement(chartBlock);\n\t\tif (variantManagement === \"Control\") {\n\t\t\treturn (\n\t\t\t\t<VariantManagement\n\t\t\t\t\tid={generate([chartBlock._blockId, \"VM\"])}\n\t\t\t\t\tfor={[chartBlock._blockId!]}\n\t\t\t\t\tshowSetAsDefault={true}\n\t\t\t\t\theaderLevel={chartBlock.headerLevel}\n\t\t\t\t\tselect={(event: VariantManagement$SelectEvent): void => {\n\t\t\t\t\t\tchartBlock.fireVariantSelected?.(event);\n\t\t\t\t\t}}\n\t\t\t\t\tsave={(event: VariantManagement$SaveEvent): void => {\n\t\t\t\t\t\tchartBlock.fireVariantSaved?.(event);\n\t\t\t\t\t}}\n\t\t\t\t/>\n\t\t\t);\n\t\t} else if (variantManagement === \"None\" || variantManagement === \"Page\") {\n\t\t\treturn \"\";\n\t\t}\n\t} else if (!personalization) {\n\t\tLog.warning(\"Variant Management cannot be enabled when personalization is disabled\");\n\t}\n\treturn \"\";\n}\n\nfunction getPersistenceProvider(chartBlock: ChartBlock): PersistenceProvider | undefined {\n\tif (getVariantManagement(chartBlock) === \"None\") {\n\t\treturn <PersistenceProvider id={generate([chartBlock._blockId, \"PersistenceProvider\"])} for={chartBlock._blockId} />;\n\t}\n}\n\nfunction pushActionCommand(\n\tactionContext: Context,\n\tdataField: (MetaModelType<DataFieldForAction> & { InvocationGrouping: MetaModelEnum<OperationGroupingType> }) | undefined,\n\tchartOperationAvailableMap: string | undefined,\n\taction: BaseAction | CustomAction,\n\tchartBlock: ChartBlock\n): void {\n\tif (dataField) {\n\t\tconst commandAction = {\n\t\t\tactionContext: actionContext,\n\t\t\tonExecuteAction: ChartHelper.getPressEventForDataFieldForActionButton(\n\t\t\t\tchartBlock._blockId!,\n\t\t\t\tdataField,\n\t\t\t\tchartOperationAvailableMap || \"\"\n\t\t\t),\n\t\t\tonExecuteIBN: CommonHelper.getPressHandlerForDataFieldForIBN(\n\t\t\t\tdataField as unknown as DataFieldForIntentBasedNavigation,\n\t\t\t\t`\\${internal>selectedContexts}`,\n\t\t\t\tfalse\n\t\t\t),\n\t\t\tonExecuteManifest: CommonHelper.buildActionWrapper(action as CustomAction, chartBlock),\n\t\t\tchartOperationAvailableMap\n\t\t};\n\t\tchartBlock._commandActions.push(commandAction);\n\t}\n}\n\nfunction getActionCommand(commandAction: CommandAction, chartContext: Context, chartBlock: ChartBlock): string {\n\tconst action = commandAction.actionContext.getObject();\n\tconst dataFieldContext = action.annotationPath && chartBlock._metaModel.createBindingContext(action.annotationPath);\n\tconst dataField = dataFieldContext && dataFieldContext.getObject();\n\tconst dataFieldAction = chartBlock._metaModel.createBindingContext(action.annotationPath + \"/Action\")!;\n\tconst actionContext = CommonHelper.getActionContext(dataFieldAction);\n\tconst isBoundPath = CommonHelper.getPathToBoundActionOverload(dataFieldAction);\n\tconst isBound = chartBlock._metaModel.createBindingContext(isBoundPath)!.getObject();\n\tconst chartOperationAvailableMap = escapeXMLAttributeValue(\n\t\tChartHelper.getOperationAvailableMap(chartContext.getObject(), {\n\t\t\tcontext: chartContext\n\t\t})\n\t);\n\tconst isActionEnabled = action.enabled\n\t\t? action.enabled\n\t\t: ChartHelper.isDataFieldForActionButtonEnabled(\n\t\t\t\tisBound && isBound.$IsBound,\n\t\t\t\tdataField.Action,\n\t\t\t\tchartBlock._context,\n\t\t\t\tchartOperationAvailableMap || \"\",\n\t\t\t\taction.enableOnSelect || \"\"\n\t\t  );\n\tlet isIBNEnabled;\n\tif (action.enabled) {\n\t\tisIBNEnabled = action.enabled;\n\t} else if (dataField.RequiresContext) {\n\t\tisIBNEnabled = \"{= %{internal>numberOfSelectedContexts} >= 1}\";\n\t}\n\n\tlet commandEnabled: boolean;\n\tswitch (action.type) {\n\t\tcase \"ForAction\":\n\t\t\tcommandEnabled = isActionEnabled ?? action.enabled;\n\t\t\tbreak;\n\t\tcase \"ForNavigation\":\n\t\t\tcommandEnabled = isIBNEnabled ?? action.enabled;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tcommandEnabled = action.enabled;\n\t\t\tbreak;\n\t}\n\n\tconst actionCommand = (\n\t\t<CommandExecution\n\t\t\texecute={(event: CommandExecution$ExecuteEvent): void =>\n\t\t\t\tcommandExecute(event, action, chartBlock._blockId!, commandAction.chartOperationAvailableMap!, dataField)\n\t\t\t}\n\t\t\tenabled={commandEnabled}\n\t\t\tvisible={(getVisible(dataFieldContext, chartBlock) as boolean) ?? action.visible}\n\t\t\tcommand={action.command}\n\t\t/>\n\t);\n\n\tif (\n\t\taction.type == \"ForAction\" &&\n\t\t(!isBound ||\n\t\t\tisBound.IsBound !== true ||\n\t\t\t(actionContext as unknown as Record<string, unknown>)[`@${CoreAnnotationTerms.OperationAvailable}`] !== false)\n\t) {\n\t\treturn actionCommand;\n\t} else if (action.type == \"ForAction\") {\n\t\treturn \"\";\n\t} else {\n\t\treturn actionCommand;\n\t}\n}\n\nfunction commandExecute(\n\tevent: CommandExecution$ExecuteEvent,\n\taction: { InvocationGrouping: { $EnumMember: string }; action: string; type: string; handlerModule: string; handlerMethod: string },\n\tid: string,\n\tchartOperationAvailableMap: string,\n\tdataField: DataFieldForAction | DataFieldForIntentBasedNavigation\n): void {\n\tconst view = CommonUtils.getTargetView(event.getSource());\n\tconst controller = view?.getController();\n\n\tswitch (action.type) {\n\t\tcase \"ForAction\":\n\t\t\tconst sInvocationGrouping =\n\t\t\t\taction.InvocationGrouping &&\n\t\t\t\taction.InvocationGrouping.$EnumMember === \"com.sap.vocabularies.UI.v1.OperationGroupingType/ChangeSet\"\n\t\t\t\t\t? \"ChangeSet\"\n\t\t\t\t\t: \"Isolated\";\n\t\t\tconst params = {\n\t\t\t\tcontexts: view.getBindingContext(\"internal\")?.getProperty(\"selectedContexts\"),\n\t\t\t\tinvocationGrouping: sInvocationGrouping,\n\t\t\t\tcontrolId: id,\n\t\t\t\toperationAvailableMap: chartOperationAvailableMap,\n\t\t\t\tmodel: view.getModel(),\n\t\t\t\tlabel: dataField.Label as string\n\t\t\t};\n\t\t\tcontroller.editFlow.invokeAction(dataField.Action as string, params);\n\t\t\tbreak;\n\t\tcase \"ForNavigation\":\n\t\t\tconst navigationParameters: NavigationParameters = {\n\t\t\t\tnavigationContexts: view.getBindingContext(\"internal\")?.getProperty(\"selectedContexts\")\n\t\t\t};\n\t\t\tif ((dataField as DataFieldForIntentBasedNavigation).Mapping) {\n\t\t\t\tnavigationParameters.semanticObjectMapping = JSON.stringify((dataField as DataFieldForIntentBasedNavigation).Mapping);\n\t\t\t}\n\t\t\tcontroller._intentBasedNavigation.navigate(\n\t\t\t\t(dataField as DataFieldForIntentBasedNavigation).SemanticObject as unknown as string,\n\t\t\t\t(dataField as DataFieldForIntentBasedNavigation).Action as unknown as string,\n\t\t\t\tnavigationParameters\n\t\t\t);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tFPMHelper.actionWrapper(event, action.handlerModule, action.handlerMethod, {\n\t\t\t\tcontexts: view.getBindingContext(\"internal\")?.getProperty(\"selectedContexts\")\n\t\t\t});\n\t\t\tbreak;\n\t}\n}\n\nfunction getItems(chartBlock: ChartBlock): string | string[] {\n\tif (chartBlock._chart) {\n\t\tconst dimensions: string[] = [];\n\t\tconst measures: string[] = [];\n\t\tif (chartBlock._chart.Dimensions) {\n\t\t\tChartHelper.formatDimensions(chartBlock._chartContext)\n\t\t\t\t.getObject()\n\t\t\t\t.forEach((dimension: DimensionType) => {\n\t\t\t\t\tdimension.id = generate([chartBlock.id, \"dimension\", dimension.key]);\n\t\t\t\t\tdimensions.push(\n\t\t\t\t\t\tgetItem(\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tid: dimension.id,\n\t\t\t\t\t\t\t\tkey: dimension.key,\n\t\t\t\t\t\t\t\tlabel: dimension.label,\n\t\t\t\t\t\t\t\trole: dimension.role\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\"_fe_groupable_\",\n\t\t\t\t\t\t\t\"groupable\"\n\t\t\t\t\t\t)\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t}\n\t\tif (chartBlock.measures) {\n\t\t\tChartHelper.formatMeasures(chartBlock.measures).forEach((measure: MeasureType) => {\n\t\t\t\tmeasure.id = generate([chartBlock.id, \"measure\", measure.key]);\n\t\t\t\tmeasures.push(\n\t\t\t\t\tgetItem(\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: measure.id,\n\t\t\t\t\t\t\tkey: measure.key,\n\t\t\t\t\t\t\tlabel: measure.label,\n\t\t\t\t\t\t\trole: measure.role\n\t\t\t\t\t\t},\n\t\t\t\t\t\t\"_fe_aggregatable_\",\n\t\t\t\t\t\t\"aggregatable\"\n\t\t\t\t\t)\n\t\t\t\t);\n\t\t\t});\n\t\t}\n\t\tif (dimensions.length && measures.length) {\n\t\t\treturn dimensions.concat(measures);\n\t\t}\n\t}\n\treturn \"\";\n}\n\nfunction getItem(item: MeasureType | DimensionType, prefix: string, type: string): string {\n\treturn (\n\t\t<MdcChartItem\n\t\t\tid={item.id}\n\t\t\tpropertyKey={prefix + item.key}\n\t\t\ttype={type}\n\t\t\tlabel={resolveBindingString(item.label as string, \"string\")}\n\t\t\trole={item.role}\n\t\t/>\n\t);\n}\n\nfunction getToolbarActions(chartBlock: ChartBlock): ToolbarAction[] {\n\tconst actions = getActions(chartBlock);\n\tif (chartBlock.chartDefinition?.onSegmentedButtonPressed) {\n\t\tactions.push(getSegmentedButton(chartBlock));\n\t}\n\tif (chartBlock.chartDefinition.isInsightsEnabled) {\n\t\tactions.push(\n\t\t\tgetStandardActions(\n\t\t\t\tchartBlock.chartDefinition.isInsightsEnabled,\n\t\t\t\tchartBlock.chartDefinition.isInsightsVisible,\n\t\t\t\tchartBlock._blockId!,\n\t\t\t\tchartBlock\n\t\t\t)\n\t\t);\n\t}\n\tif (actions.length > 0) {\n\t\treturn actions;\n\t}\n\treturn [];\n}\n\nfunction getStandardActions(\n\tisInsightsEnabled: BindingToolkitExpression<boolean> | undefined,\n\tisInsightsVisible: BindingToolkitExpression<boolean> | undefined,\n\tid: string,\n\tchartBlock: ChartBlock\n): MenuItem | ActionToolbarAction {\n\treturn (\n\t\t<ActionToolbarAction visible={isInsightsVisible}>\n\t\t\t<Button\n\t\t\t\tid={generate([id, \"StandardAction::Insights\"])}\n\t\t\t\ttext=\"{sap.fe.i18n>M_COMMON_INSIGHTS_CARD}\"\n\t\t\t\tpress={(): void => {\n\t\t\t\t\tchartBlock.onAddCardToInsightsPressed();\n\t\t\t\t}}\n\t\t\t\tenabled={isInsightsEnabled}\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tlayoutData: <OverflowToolbarLayoutData priority=\"AlwaysOverflow\" />\n\t\t\t\t}}\n\t\t\t</Button>\n\t\t</ActionToolbarAction>\n\t);\n}\n\nfunction getActions(chartBlock: ChartBlock): ToolbarAction[] {\n\tconst actions = removeMenuItems(chartBlock.chartActions ?? []);\n\t// Apply primary action overflow protection before processing\n\tconst actionsWithOverflowProtection = ActionHelper.ensurePrimaryActionNeverOverflows(actions);\n\n\treturn actionsWithOverflowProtection.map((action: BaseAction) => {\n\t\tif (action.annotationPath || (action.type === \"Menu\" && !action.id?.startsWith(\"CustomAction\"))) {\n\t\t\t// Load annotation based actions\n\t\t\treturn getAction(action, chartBlock._chartContext, false, chartBlock);\n\t\t} else if (action.hasOwnProperty(\"noWrap\")) {\n\t\t\t// Load XML or manifest based actions / action groups\n\t\t\treturn getCustomActions(action as CustomAndAction, chartBlock._chartContext, chartBlock);\n\t\t}\n\t});\n}\n\nfunction removeMenuItems(actions: BaseAction[]): BaseAction[] {\n\t// If action is already part of menu in action group, then it will\n\t// be removed from the main actions list\n\tfor (const action of actions) {\n\t\tif (action.menu) {\n\t\t\taction.menu.forEach((item) => {\n\t\t\t\tconst idx = actions.map((act) => act.key).indexOf(item.key);\n\t\t\t\tif (idx !== -1) {\n\t\t\t\t\tactions.splice(idx, 1);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\treturn actions;\n}\n\nfunction getCustomActions(action: CustomAndAction, chartContext: Context, chartBlock: ChartBlock): ToolbarAction {\n\tlet actionEnabled = action.enabled as string | boolean | undefined;\n\tif ((action.requiresSelection ?? false) && action.enabled === \"true\") {\n\t\tactionEnabled = \"{= %{internal>numberOfSelectedContexts} >= 1}\";\n\t}\n\tif (action.type === \"Default\") {\n\t\t// Load XML or manifest based toolbar actions\n\t\treturn getActionToolbarAction(\n\t\t\taction,\n\t\t\t{\n\t\t\t\tid: generate([chartBlock._blockId, action.id]),\n\t\t\t\tunittestid: \"DataFieldForActionButtonAction\",\n\t\t\t\tlabel: action.text ? action.text : \"\",\n\t\t\t\tariaHasPopup: undefined,\n\t\t\t\tpress: action.press ? action.press : \"\",\n\t\t\t\tenabled: actionEnabled,\n\t\t\t\tvisible: action.visible ? action.visible : false\n\t\t\t},\n\t\t\tfalse,\n\t\t\tchartBlock\n\t\t);\n\t} else if (action.type === \"Menu\") {\n\t\t// Load action groups (Menu)\n\t\treturn getActionToolbarMenuAction(\n\t\t\t{\n\t\t\t\tid: generate([chartBlock._blockId, action.id]),\n\t\t\t\ttext: action.text,\n\t\t\t\tvisible: action.visible,\n\t\t\t\tenabled: actionEnabled,\n\t\t\t\tuseDefaultActionOnly: DefaultActionHandler.getUseDefaultActionOnly(action),\n\t\t\t\tbuttonMode: DefaultActionHandler.getButtonMode(action),\n\t\t\t\tdefaultAction: undefined,\n\t\t\t\tactions: action,\n\t\t\t\tpriority: action.priority,\n\t\t\t\tgroup: action.group\n\t\t\t},\n\t\t\tchartContext,\n\t\t\tchartBlock\n\t\t);\n\t}\n}\n\nfunction getMenuItemFromMenu(menuItemAction: CustomAction, chartContext: Context, chartBlock: ChartBlock): ToolbarAction {\n\tlet pressHandler: { press: (event: Button$PressEvent) => void } | { \"jsx:command\": CommandProperties };\n\tif (menuItemAction.annotationPath) {\n\t\t//Annotation based action is passed as menu item for menu button\n\t\treturn getAction(menuItemAction, chartContext, true, chartBlock);\n\t}\n\tif (menuItemAction.command) {\n\t\tpressHandler = { \"jsx:command\": `cmd:${menuItemAction.command}|press` as CommandProperties };\n\t} else if (menuItemAction.noWrap ?? false) {\n\t\tpressHandler = {\n\t\t\tpress: (event: Button$PressEvent): void => {\n\t\t\t\tconst functionName = menuItemAction.handlerMethod?.split(\".\")[1] as string;\n\t\t\t\tconst controller = { ...CommonUtils.getTargetView(event.getSource()).getController() } as unknown as {\n\t\t\t\t\t[temp: string]: (event: Button$PressEvent) => void;\n\t\t\t\t};\n\t\t\t\tif (controller[functionName]) controller[functionName](event);\n\t\t\t}\n\t\t};\n\t} else {\n\t\tpressHandler = {\n\t\t\tpress: (event: Button$PressEvent): void => {\n\t\t\t\tconst selectedContexts = CommonUtils.getTargetView(event.getSource())\n\t\t\t\t\t.getBindingContext(\"internal\")\n\t\t\t\t\t?.getProperty(\"selectedContexts\");\n\t\t\t\tFPMHelper.actionWrapper(event, menuItemAction.handlerModule, menuItemAction.handlerMethod, { contexts: selectedContexts });\n\t\t\t}\n\t\t};\n\t}\n\n\treturn <MenuItem text={menuItemAction.text} {...pressHandler} visible={menuItemAction.visible} enabled={menuItemAction.enabled} />;\n}\n\nfunction getActionToolbarMenuAction(\n\tprops: CustomToolbarMenuAction,\n\tchartContext: Context,\n\tchartBlock: ChartBlock\n): MenuItem | ActionToolbarAction {\n\tconst aMenuItems = (props.actions?.menu as CustomAction[]).map((action: CustomAction) => {\n\t\treturn getMenuItemFromMenu(action, chartContext, chartBlock);\n\t});\n\tconst isAIOperation = isMenuAIOperation(props.actions?.menu as CustomAction[]);\n\treturn (\n\t\t<ActionToolbarAction>\n\t\t\t<MenuButton\n\t\t\t\ttext={props.text}\n\t\t\t\ttype=\"Transparent\"\n\t\t\t\tid={props.id}\n\t\t\t\tvisible={props.visible}\n\t\t\t\tenabled={props.enabled}\n\t\t\t\tuseDefaultActionOnly={props.useDefaultActionOnly}\n\t\t\t\tbuttonMode={props.buttonMode}\n\t\t\t\tmenuPosition={Dock.BeginBottom}\n\t\t\t\tdefaultAction={\"props.defaultAction\" as unknown as () => void}\n\t\t\t\ticon={isAIOperation ? aiIcon : undefined}\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tmenu: <Menu>{aMenuItems}</Menu>,\n\t\t\t\t\tlayoutData: <OverflowToolbarLayoutData priority={props.priority} group={props.group} />\n\t\t\t\t}}\n\t\t\t</MenuButton>\n\t\t</ActionToolbarAction>\n\t);\n}\n\nfunction getAction(action: BaseAction | CustomAction, chartContext: Context, isMenuItem: boolean, chartBlock: ChartBlock): ToolbarAction {\n\tconst dataFieldContext = chartBlock._metaModel.createBindingContext(action.annotationPath ?? \"\")!;\n\tif (action.type === \"ForNavigation\") {\n\t\treturn getNavigationActions(action, dataFieldContext, isMenuItem, chartBlock);\n\t} else if (action.type === \"ForAction\") {\n\t\treturn getAnnotationActions(chartContext, action as AnnotationAction, dataFieldContext, isMenuItem, chartBlock);\n\t} else if (action.type === \"Menu\") {\n\t\tconst menuItems = action.menu?.map((menuAction: BaseAction) => {\n\t\t\treturn getAction(menuAction, chartContext, true, chartBlock);\n\t\t});\n\t\treturn (\n\t\t\t<ActionToolbarAction>\n\t\t\t\t<MenuButton\n\t\t\t\t\ttext={action.text}\n\t\t\t\t\ttype=\"Transparent\"\n\t\t\t\t\tid={action.key}\n\t\t\t\t\tvisible={action.visible}\n\t\t\t\t\tenabled={action.enabled}\n\t\t\t\t\tmenuPosition={Dock.BeginBottom}\n\t\t\t\t\ticon={action?.isAIOperation === true ? aiIcon : undefined}\n\t\t\t\t>\n\t\t\t\t\t{{\n\t\t\t\t\t\tmenu: <Menu>{menuItems}</Menu>,\n\t\t\t\t\t\tlayoutData: <OverflowToolbarLayoutData priority={action.priority} group={action.group} />\n\t\t\t\t\t}}\n\t\t\t\t</MenuButton>\n\t\t\t</ActionToolbarAction>\n\t\t);\n\t}\n\treturn undefined;\n}\n\nfunction getNavigationActions(\n\taction: BaseAction | CustomAction,\n\tdataFieldContext: Context,\n\tisMenuItem: boolean,\n\tchartBlock: ChartBlock\n): MenuItem | ActionToolbarAction {\n\tlet enabled = \"true\";\n\tconst dataField = dataFieldContext.getObject();\n\tif (action.enabled !== undefined) {\n\t\tenabled = action.enabled;\n\t} else if (dataField.RequiresContext) {\n\t\tenabled = \"{= %{internal>numberOfSelectedContexts} >= 1}\";\n\t}\n\treturn getActionToolbarAction(\n\t\taction,\n\t\t{\n\t\t\tid: undefined,\n\t\t\tunittestid: \"DataFieldForIntentBasedNavigationButtonAction\",\n\t\t\tlabel: dataField.Label,\n\t\t\tariaHasPopup: undefined,\n\t\t\tpress: CommonHelper.getPressHandlerForDataFieldForIBN(dataField, `\\${internal>selectedContexts}`, false)!,\n\t\t\tenabled: enabled,\n\t\t\tvisible: getVisible(dataFieldContext, chartBlock)\n\t\t},\n\t\tisMenuItem,\n\t\tchartBlock,\n\t\tdataField\n\t);\n}\n\nfunction getAnnotationActions(\n\tchartContext: Context,\n\taction: AnnotationAction,\n\tdataFieldContext: Context,\n\tisMenuItem: boolean,\n\tchartBlock: ChartBlock\n): ToolbarAction {\n\tconst dataFieldAction = chartBlock._metaModel.createBindingContext(action.annotationPath + \"/Action\")!;\n\tconst actionContext = chartBlock._metaModel.createBindingContext(CommonHelper.getActionContext(dataFieldAction));\n\tconst actionObject = actionContext?.getObject();\n\tconst isBoundPath = CommonHelper.getPathToBoundActionOverload(dataFieldAction);\n\tconst isBound = chartBlock._metaModel.createBindingContext(isBoundPath)!.getObject();\n\tconst dataField = dataFieldContext.getObject();\n\tif (!isBound || isBound.$IsBound !== true || actionObject[`@${CoreAnnotationTerms.OperationAvailable}`] !== false) {\n\t\tconst enabled = getAnnotationActionsEnabled(action, isBound, dataField, chartContext, chartBlock._context);\n\t\tconst dataFieldModelObjectPath = getInvolvedDataModelObjects<DataFieldAbstractTypes>(\n\t\t\tchartBlock._metaModel.createBindingContext(action.annotationPath) as Context\n\t\t);\n\t\tconst ariaHasPopup = isDataModelObjectPathForActionWithDialog(dataFieldModelObjectPath);\n\t\tconst chartOperationAvailableMap =\n\t\t\tescapeXMLAttributeValue(\n\t\t\t\tChartHelper.getOperationAvailableMap(chartContext.getObject(), {\n\t\t\t\t\tcontext: chartContext\n\t\t\t\t})\n\t\t\t) || \"\";\n\t\treturn getActionToolbarAction(\n\t\t\taction,\n\t\t\t{\n\t\t\t\tid: generate([chartBlock._blockId, getInvolvedDataModelObjects(dataFieldContext)]),\n\t\t\t\tunittestid: \"DataFieldForActionButtonAction\",\n\t\t\t\tlabel: dataField.Label,\n\t\t\t\tariaHasPopup: ariaHasPopup,\n\t\t\t\tenabled: enabled,\n\t\t\t\tvisible: getVisible(dataFieldContext, chartBlock)\n\t\t\t},\n\t\t\tisMenuItem,\n\t\t\tchartBlock,\n\t\t\tdataField,\n\t\t\tchartOperationAvailableMap\n\t\t);\n\t}\n\treturn undefined;\n}\n\nfunction getActionToolbarAction(\n\taction: (BaseAction | CustomAction) & { noWrap?: boolean },\n\ttoolbarAction: ToolBarAction,\n\tisMenuItem: boolean,\n\tchartBlock: ChartBlock,\n\tdataField?: DataFieldForAction | DataFieldForIntentBasedNavigation,\n\tchartOperationAvailableMap?: string\n): MenuItem | ActionToolbarAction {\n\tif (isMenuItem) {\n\t\tconst pressEvent: { press: (event: Button$PressEvent) => void } | { \"jsx:command\": CommandProperties } = action.command\n\t\t\t? { \"jsx:command\": `cmd:${action.command}|press` as CommandProperties }\n\t\t\t: {\n\t\t\t\t\tpress: (event: Button$PressEvent): void => {\n\t\t\t\t\t\tconst view = CommonUtils.getTargetView(event.getSource());\n\t\t\t\t\t\tconst controller = view.getController();\n\t\t\t\t\t\tif (action.type === \"ForAction\") {\n\t\t\t\t\t\t\tconst params = {\n\t\t\t\t\t\t\t\tcontexts: view.getBindingContext(\"internal\")?.getProperty(\"selectedContexts\"),\n\t\t\t\t\t\t\t\tinvocationGrouping:\n\t\t\t\t\t\t\t\t\t(dataField as DataFieldForAction)?.InvocationGrouping === OperationGroupingType.ChangeSet\n\t\t\t\t\t\t\t\t\t\t? \"ChangeSet\"\n\t\t\t\t\t\t\t\t\t\t: \"Isolated\",\n\t\t\t\t\t\t\t\tcontrolId: chartBlock._blockId,\n\t\t\t\t\t\t\t\toperationAvailableMap: chartOperationAvailableMap,\n\t\t\t\t\t\t\t\tmodel: view.getModel(),\n\t\t\t\t\t\t\t\tlabel: dataField?.Label as string\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tcontroller.editFlow.invokeAction(dataField?.Action as string, params);\n\t\t\t\t\t\t} else if (action.type === \"ForNavigation\") {\n\t\t\t\t\t\t\tconst navigationParameters: NavigationParameters = {\n\t\t\t\t\t\t\t\tnavigationContexts: view.getBindingContext(\"internal\")?.getProperty(\"selectedContexts\")\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tif ((dataField as DataFieldForIntentBasedNavigation)?.Mapping) {\n\t\t\t\t\t\t\t\tnavigationParameters.semanticObjectMapping = JSON.stringify(\n\t\t\t\t\t\t\t\t\t(dataField as DataFieldForIntentBasedNavigation).Mapping\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tcontroller._intentBasedNavigation.navigate(\n\t\t\t\t\t\t\t\t(dataField as DataFieldForIntentBasedNavigation).SemanticObject as unknown as string,\n\t\t\t\t\t\t\t\t(dataField as DataFieldForIntentBasedNavigation).Action as unknown as string,\n\t\t\t\t\t\t\t\tnavigationParameters\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t  };\n\n\t\treturn <MenuItem text={toolbarAction.label} {...pressEvent} enabled={toolbarAction.enabled} visible={toolbarAction.visible} />;\n\t} else {\n\t\treturn buildAction(action, toolbarAction, chartBlock, dataField, chartOperationAvailableMap);\n\t}\n}\n\nfunction buildAction(\n\taction: BaseAction | CustomAction,\n\ttoolbarAction: ToolBarAction,\n\tchartBlock: ChartBlock,\n\tdataField?: DataFieldForAction | DataFieldForIntentBasedNavigation,\n\tchartOperationAvailableMap?: string\n): ActionToolbarAction {\n\treturn (\n\t\t<ActionToolbarAction>\n\t\t\t<Button\n\t\t\t\tid={toolbarAction.id}\n\t\t\t\ttext={toolbarAction.label}\n\t\t\t\tariaHasPopup={toolbarAction.ariaHasPopup}\n\t\t\t\t{...getActionPress(action, dataField, chartOperationAvailableMap, chartBlock)}\n\t\t\t\tenabled={toolbarAction.enabled}\n\t\t\t\tvisible={toolbarAction.visible}\n\t\t\t\ticon={action.isAIOperation === true ? aiIcon : undefined}\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\tlayoutData: <OverflowToolbarLayoutData priority={action.priority} group={action.group} />\n\t\t\t\t}}\n\t\t\t</Button>\n\t\t</ActionToolbarAction>\n\t);\n}\n\nfunction getActionPress(\n\taction: BaseAction | CustomAction,\n\tdataField?: DataFieldForAction | DataFieldForIntentBasedNavigation,\n\tchartOperationAvailableMap?: string,\n\tchartBlock?: ChartBlock\n): { press: (event: Button$PressEvent) => void } | { \"jsx:command\": CommandProperties } {\n\tlet actionPress: { press: (event: Button$PressEvent) => void } | { \"jsx:command\": CommandProperties } = {\n\t\tpress: \"\" as unknown as () => void\n\t};\n\n\tif (action.hasOwnProperty(\"noWrap\")) {\n\t\tif (action.command) {\n\t\t\tactionPress = { \"jsx:command\": `cmd:${action.command}|press` as CommandProperties };\n\t\t} else if ((action as CustomAction).noWrap === true) {\n\t\t\tactionPress = getCustomActionPress(action as CustomAction);\n\t\t} else if (!action.annotationPath) {\n\t\t\tactionPress = getActionPressWithAnnotationPath(action as CustomAction);\n\t\t}\n\t} else {\n\t\tactionPress = action.command\n\t\t\t? { \"jsx:command\": `cmd:${action.command}|press` as CommandProperties }\n\t\t\t: getStandardActionPressWithNoCommand(action, dataField, chartBlock, chartOperationAvailableMap);\n\t}\n\n\treturn actionPress;\n}\n\nfunction getCustomActionPress(action: CustomAction): { press: (event: Button$PressEvent) => void } {\n\treturn {\n\t\tpress: (event: Button$PressEvent): void => {\n\t\t\tconst functionName = action.handlerMethod?.split(\".\")[1] as string;\n\t\t\tconst controller = { ...CommonUtils.getTargetView(event.getSource()).getController() } as unknown as {\n\t\t\t\t[method: string]: (event: Button$PressEvent) => void;\n\t\t\t};\n\t\t\tif (controller[functionName]) controller[functionName](event);\n\t\t}\n\t};\n}\n\nfunction getActionPressWithAnnotationPath(action: CustomAction): { press: (event: Button$PressEvent) => void } {\n\treturn {\n\t\tpress: (event: Button$PressEvent): void => {\n\t\t\tconst selectedContexts = event.getSource().getBindingContext(\"internal\")?.getProperty(\"selectedContexts\");\n\t\t\tFPMHelper.actionWrapper(event, action.handlerModule, action.handlerMethod, {\n\t\t\t\tcontexts: selectedContexts\n\t\t\t});\n\t\t}\n\t};\n}\n\nfunction getStandardActionPressWithNoCommand(\n\taction: BaseAction | CustomAction,\n\tdataField?: DataFieldForAction | DataFieldForIntentBasedNavigation,\n\tchartBlock?: ChartBlock,\n\tchartOperationAvailableMap?: string\n): { press: (event: Button$PressEvent) => void } {\n\treturn {\n\t\tpress: (event: Button$PressEvent): void => {\n\t\t\tconst view = CommonUtils.getTargetView(event.getSource());\n\t\t\tconst controller = view.getController();\n\t\t\tif (action.type === \"ForAction\") {\n\t\t\t\tconst params = {\n\t\t\t\t\tcontexts: view.getBindingContext(\"internal\")?.getProperty(\"selectedContexts\"),\n\t\t\t\t\tinvocationGrouping:\n\t\t\t\t\t\t(dataField as DataFieldForAction)?.InvocationGrouping === OperationGroupingType.ChangeSet\n\t\t\t\t\t\t\t? \"ChangeSet\"\n\t\t\t\t\t\t\t: \"Isolated\",\n\t\t\t\t\tcontrolId: chartBlock?._blockId,\n\t\t\t\t\toperationAvailableMap: chartOperationAvailableMap,\n\t\t\t\t\tmodel: view.getModel(),\n\t\t\t\t\tlabel: dataField?.Label as string\n\t\t\t\t};\n\t\t\t\tcontroller.editFlow.invokeAction(dataField?.Action as string, params);\n\t\t\t} else if (action.type === \"ForNavigation\") {\n\t\t\t\tconst navigationParameters: NavigationParameters = {\n\t\t\t\t\tnavigationContexts: view.getBindingContext(\"internal\")?.getProperty(\"selectedContexts\")\n\t\t\t\t};\n\t\t\t\tif ((dataField as DataFieldForIntentBasedNavigation)?.Mapping) {\n\t\t\t\t\tnavigationParameters.semanticObjectMapping = JSON.stringify((dataField as DataFieldForIntentBasedNavigation).Mapping);\n\t\t\t\t}\n\t\t\t\tcontroller._intentBasedNavigation.navigate(\n\t\t\t\t\t(dataField as DataFieldForIntentBasedNavigation).SemanticObject as unknown as string,\n\t\t\t\t\t(dataField as DataFieldForIntentBasedNavigation).Action as unknown as string,\n\t\t\t\t\tnavigationParameters\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t};\n}\n\nfunction getAnnotationActionsEnabled(\n\taction: BaseAction,\n\tisBound: Record<string, boolean>,\n\tdataField: DataFieldForAction,\n\tchartContext: Context,\n\tcontext: Context\n): string {\n\treturn action.enabled !== undefined\n\t\t? action.enabled\n\t\t: ChartHelper.isDataFieldForActionButtonEnabled(\n\t\t\t\tisBound && isBound.$IsBound,\n\t\t\t\tdataField.Action as string,\n\t\t\t\tcontext,\n\t\t\t\tChartHelper.getOperationAvailableMap(chartContext.getObject(), { context: chartContext }),\n\t\t\t\taction.enableOnSelect || \"\"\n\t\t  );\n}\n\nfunction getSegmentedButton(chartBlock: ChartBlock): ActionToolbarAction {\n\treturn (\n\t\t<ActionToolbarAction\n\t\t\tlayoutInformation={{\n\t\t\t\taggregationName: \"end\",\n\t\t\t\talignment: \"End\"\n\t\t\t}}\n\t\t>\n\t\t\t<SegmentedButton\n\t\t\t\tid={generate([chartBlock._blockId, \"SegmentedButton\", \"TemplateContentView\"])}\n\t\t\t\tselectionChange={(event: SegmentedButton$SelectionChangeEvent): void => {\n\t\t\t\t\tchartBlock.fireSegmentedButtonPressed?.(\n\t\t\t\t\t\tmerge(event.getParameters(), { selectedKey: event.getSource().getSelectedKey() })\n\t\t\t\t\t);\n\t\t\t\t}}\n\t\t\t\tvisible={notEqual(pathInModel(\"alpContentView\", \"pageInternal\"), \"Table\")}\n\t\t\t\tselectedKey={pathInModel(\"alpContentView\", \"pageInternal\")}\n\t\t\t>\n\t\t\t\t{{\n\t\t\t\t\titems: getSegmentedButtonItems()\n\t\t\t\t}}\n\t\t\t</SegmentedButton>\n\t\t</ActionToolbarAction>\n\t);\n}\n\nfunction getSegmentedButtonItems(): string[] {\n\tconst segmentedButtonItems = [];\n\tif (CommonHelper.isDesktop()) {\n\t\tsegmentedButtonItems.push(\n\t\t\tgetSegmentedButtonItem(\"{sap.fe.i18n>M_COMMON_HYBRID_SEGMENTED_BUTTON_ITEM_TOOLTIP}\", \"Hybrid\", \"sap-icon://chart-table-view\")\n\t\t);\n\t}\n\tsegmentedButtonItems.push(\n\t\tgetSegmentedButtonItem(\"{sap.fe.i18n>M_COMMON_CHART_SEGMENTED_BUTTON_ITEM_TOOLTIP}\", \"Chart\", \"sap-icon://bar-chart\")\n\t);\n\tsegmentedButtonItems.push(\n\t\tgetSegmentedButtonItem(\"{sap.fe.i18n>M_COMMON_TABLE_SEGMENTED_BUTTON_ITEM_TOOLTIP}\", \"Table\", \"sap-icon://table-view\")\n\t);\n\treturn segmentedButtonItems;\n}\n\nfunction getSegmentedButtonItem(tooltip: string, key: string, icon: string): string {\n\treturn <SegmentedButtonItem tooltip={tooltip} key={key} icon={icon} />;\n}\n\n/**\n * Returns the annotation path pointing to the visualization annotation (Chart).\n * @param contextObjectPath The datamodel object path for the chart\n * @param converterContext The converter context\n * @returns The annotation path\n */\nfunction getVisualizationPath(\n\tcontextObjectPath: DataModelObjectPath<ChartType | SelectionPresentationVariant | PresentationVariant>,\n\tconverterContext: ConverterContext\n): string {\n\tconst metaPath = getContextRelativeTargetObjectPath(contextObjectPath);\n\n\t// fallback to default Chart if metaPath is not set\n\tif (!metaPath) {\n\t\tLog.error(`Missing metaPath parameter for Chart`);\n\t\treturn `@${UIAnnotationTerms.Chart}`;\n\t}\n\n\tif (contextObjectPath.targetObject?.term === UIAnnotationTerms.Chart) {\n\t\treturn metaPath; // MetaPath is already pointing to a Chart\n\t}\n\n\t//Need to switch to the context related the PV or SPV\n\tconst resolvedTarget = converterContext.getEntityTypeAnnotation(metaPath);\n\n\tlet visualizations: VisualizationAndPath[] = [];\n\tswitch (contextObjectPath.targetObject?.term) {\n\t\tcase UIAnnotationTerms.SelectionPresentationVariant:\n\t\t\tif (contextObjectPath.targetObject.PresentationVariant) {\n\t\t\t\tvisualizations = getVisualizationsFromAnnotation(\n\t\t\t\t\tcontextObjectPath.targetObject,\n\t\t\t\t\tmetaPath,\n\t\t\t\t\tresolvedTarget.converterContext,\n\t\t\t\t\ttrue\n\t\t\t\t);\n\t\t\t}\n\t\t\tbreak;\n\t\tcase UIAnnotationTerms.PresentationVariant:\n\t\t\tvisualizations = getVisualizationsFromAnnotation(\n\t\t\t\tcontextObjectPath.targetObject,\n\t\t\t\tmetaPath,\n\t\t\t\tresolvedTarget.converterContext,\n\t\t\t\ttrue\n\t\t\t);\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tbreak;\n\t}\n\n\tconst chartViz = visualizations.find((viz) => {\n\t\treturn viz.visualization.term === UIAnnotationTerms.Chart;\n\t});\n\n\tif (chartViz) {\n\t\treturn chartViz.annotationPath;\n\t} else {\n\t\t// fallback to default Chart if annotation missing in PV\n\t\tLog.error(`Bad metaPath parameter for chart: ${contextObjectPath.targetObject?.term}`);\n\t\treturn `@${UIAnnotationTerms.Chart}`;\n\t}\n}\n\nfunction getVisible(dataFieldContext: Context, chartBlock: ChartBlock): string | boolean {\n\tconst dataField = dataFieldContext.getObject();\n\tif (dataField[`@${UIAnnotationTerms.Hidden}`] && dataField[`@${UIAnnotationTerms.Hidden}`].$Path) {\n\t\tconst hiddenPathContext = chartBlock._metaModel.createBindingContext(\n\t\t\tdataFieldContext.getPath() + `/@${UIAnnotationTerms.Hidden}/$Path`,\n\t\t\tdataField[`@${UIAnnotationTerms.Hidden}`].$Path\n\t\t);\n\t\treturn ChartHelper.getHiddenPathExpressionForTableActionsAndIBN(dataField[`@${UIAnnotationTerms.Hidden}`].$Path, {\n\t\t\tcontext: hiddenPathContext\n\t\t});\n\t} else if (dataField[`@${UIAnnotationTerms.Hidden}`]) {\n\t\treturn !dataField[`@${UIAnnotationTerms.Hidden}`];\n\t} else {\n\t\treturn true;\n\t}\n}\n\nfunction getChartConverterContext(\n\tproperties: ChartBlock,\n\toriginalViewData: Partial<ViewData>,\n\tcontextObjectPath: DataModelObjectPath<ChartContextObjectPath>,\n\tdiagnostics: Diagnostics,\n\textraParams?: Record<string, unknown>\n): ConverterContext<PageContextPathTarget> {\n\tlet viewData = Object.assign({}, originalViewData);\n\tdelete viewData.resourceModel;\n\tdelete viewData.appComponent;\n\tviewData = deepClone(viewData);\n\tlet controlConfiguration = {};\n\n\t// Only merge in page control configuration if the building block is on the same context\n\tconst relativePath = getTargetObjectPath(contextObjectPath.contextLocation ?? contextObjectPath);\n\tconst entitySetName = contextObjectPath.contextLocation?.targetEntitySet?.name ?? contextObjectPath.targetEntitySet?.name;\n\tif (\n\t\trelativePath === originalViewData?.contextPath ||\n\t\trelativePath === `/${originalViewData?.entitySet}` ||\n\t\tentitySetName === originalViewData?.entitySet\n\t) {\n\t\tcontrolConfiguration = viewData.controlConfiguration!;\n\t}\n\tviewData.controlConfiguration = merge(controlConfiguration, extraParams || {}) as ControlConfiguration;\n\n\treturn ConverterContext.createConverterContextForMacro(\n\t\tcontextObjectPath.startingEntitySet.name,\n\t\tproperties._metaModel,\n\t\tdiagnostics,\n\t\tmerge,\n\t\tcontextObjectPath.contextLocation,\n\t\tnew ManifestWrapper(viewData as BaseManifestSettings)\n\t);\n}\n\nfunction getConverterContext(\n\tchartBlock: ChartBlock,\n\tviewData: ViewData,\n\tcontextObjectPath: DataModelObjectPath<ChartContextObjectPath>,\n\tdiagnostics: Diagnostics\n): ConverterContext<PageContextPathTarget> {\n\tconst initialConverterContext = getChartConverterContext(chartBlock, viewData, contextObjectPath, diagnostics);\n\tconst visualizationPath = getVisualizationPath(contextObjectPath, initialConverterContext);\n\tconst extraParams = getExtraParams(chartBlock, visualizationPath);\n\treturn getChartConverterContext(chartBlock, viewData, contextObjectPath, diagnostics, extraParams);\n}\n\nfunction modifyIdentifiers(chartBlock: ChartBlock): void {\n\tif (chartBlock._applyIdToContent) {\n\t\tchartBlock._blockId = chartBlock.id.replace(/::Chart$/, \"\");\n\t\tchartBlock._contentId = chartBlock._blockId;\n\t} else {\n\t\tchartBlock._blockId = chartBlock.id;\n\t\tchartBlock._contentId = getContentId(chartBlock.id);\n\t}\n}\n\nfunction initialise(\n\tchartBlock: ChartBlock,\n\tviewData: ViewData,\n\tdiagnostics: Diagnostics,\n\tcontextObjectPath: DataModelObjectPath<ChartContextObjectPath>\n): void {\n\tconst metaContextPath = chartBlock.getMetaPathObject(chartBlock.metaPath, chartBlock._resolvedContextPath);\n\tchartBlock._metaModel = chartBlock._getOwner()?.preprocessorContext?.models.metaModel as ODataMetaModel;\n\tchartBlock._metaPathContext = chartBlock._metaModel.createBindingContext(metaContextPath!.getPath())!;\n\tchartBlock._context = chartBlock._metaModel.createBindingContext(chartBlock.contextPath ?? metaContextPath?.getContextPath())!;\n\n\tconst converterContext = getConverterContext(chartBlock, viewData, contextObjectPath, diagnostics);\n\tconst viewConfig = converterContext.getManifestWrapper()?.getViewConfiguration();\n\tconst isMultiTabs = (viewConfig?.paths?.length as number) > 1;\n\tconst hasMultipleVisualizations =\n\t\tconverterContext.getManifestWrapper()?.hasMultipleVisualizations() ||\n\t\tconverterContext.getTemplateType() === TemplateType.AnalyticalListPage;\n\n\tchartBlock._chartContext = ChartHelper.getUiChart(chartBlock._metaPathContext)!;\n\tchartBlock._chart = chartBlock._chartContext.getObject() as ChartType;\n\tchartBlock._blockActions = [];\n\tchartBlock._commandActions = [];\n\tmodifyIdentifiers(chartBlock);\n\tif (chartBlock._chart) {\n\t\tchartBlock.chartDefinition = createChartDefinition(\n\t\t\tchartBlock,\n\t\t\tconverterContext,\n\t\t\tcontextObjectPath,\n\t\t\tchartBlock._chartContext.getPath()\n\t\t);\n\t\tconst collection = chartBlock._metaModel.createBindingContext(chartBlock.chartDefinition.collection) as Context;\n\t\t// API Properties\n\t\tchartBlock.navigationPath = chartBlock.chartDefinition.navigationPath;\n\t\tchartBlock.autoBindOnInit = chartBlock.chartDefinition.autoBindOnInit;\n\t\tchartBlock.vizProperties = chartBlock.chartDefinition.vizProperties;\n\t\tchartBlock.chartActions = chartBlock.chartDefinition.actions;\n\t\tchartBlock.filter = getFilterBar(chartBlock);\n\t\tlet personalization: ChartP13nType;\n\t\tif (chartBlock.chartDefinition?.personalization !== undefined) {\n\t\t\tpersonalization = chartBlock.chartDefinition.personalization;\n\t\t} else {\n\t\t\tswitch (chartBlock.personalization) {\n\t\t\t\tcase \"false\":\n\t\t\t\t\tpersonalization = undefined;\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"true\":\n\t\t\t\t\tpersonalization = Object.values(personalizationValues).join(\",\");\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tpersonalization = chartBlock.personalization as string;\n\t\t\t}\n\t\t}\n\t\tcheckPersonalizationInChartProperties(personalization, chartBlock);\n\t\tchartBlock.visible = chartBlock.chartDefinition.visible;\n\t\tchartBlock.draftSupported = ModelHelper.isMetaPathDraftSupported(metaContextPath!);\n\t\tchartBlock._chartType = ChartHelper.formatChartType(chartBlock._chart.ChartType);\n\n\t\tconst operationAvailableMap = ChartHelper.getOperationAvailableMap(chartBlock._chart, {\n\t\t\tcontext: chartBlock._chartContext\n\t\t});\n\n\t\tif (Object.keys(chartBlock.chartDefinition?.commandActions as object).length > 0) {\n\t\t\tObject.keys(chartBlock.chartDefinition?.commandActions as object).forEach((key: string) => {\n\t\t\t\tconst action = chartBlock.chartDefinition?.commandActions[key];\n\t\t\t\tconst actionContext = createBindingContext(action);\n\t\t\t\tconst dataFieldContext = action.annotationPath && chartBlock._metaModel.createBindingContext(action.annotationPath);\n\t\t\t\tconst dataField = dataFieldContext && dataFieldContext.getObject();\n\t\t\t\tconst chartOperationAvailableMap = escapeXMLAttributeValue(operationAvailableMap);\n\t\t\t\tpushActionCommand(actionContext, dataField, chartOperationAvailableMap, action, chartBlock);\n\t\t\t});\n\t\t}\n\t\tchartBlock.measures = getChartMeasures(chartBlock);\n\t\tconst presentationPath = CommonHelper.createPresentationPathContext(chartBlock._metaPathContext);\n\t\tchartBlock._sortConditions = ChartHelper.getSortConditions(\n\t\t\tchartBlock._metaPathContext,\n\t\t\tchartBlock._metaPathContext.getObject(),\n\t\t\tpresentationPath.getPath(),\n\t\t\tchartBlock.chartDefinition.applySupported\n\t\t);\n\t\tconst chartActionsContext = chartBlock._metaModel.createBindingContext(\n\t\t\tchartBlock._chartContext.getPath() + \"/Actions\",\n\t\t\tchartBlock._chart.Actions as unknown as Context\n\t\t);\n\t\tconst targetCollectionPath = CommonHelper.getTargetCollectionPath(collection);\n\t\tconst targetCollectionPathContext = chartBlock._metaModel.createBindingContext(targetCollectionPath, collection)!;\n\t\tconst actionsObject = contextObjectPath.convertedTypes.resolvePath(chartActionsContext.getPath())?.target;\n\n\t\tchartBlock._customData = {\n\t\t\ttargetCollectionPath: chartBlock.chartDefinition.collection,\n\t\t\tentitySet:\n\t\t\t\ttypeof targetCollectionPathContext.getObject() === \"string\"\n\t\t\t\t\t? targetCollectionPathContext.getObject()\n\t\t\t\t\t: targetCollectionPathContext.getObject(\"@sapui.name\"),\n\t\t\tentityType: chartBlock.chartDefinition.collection + \"/\",\n\t\t\toperationAvailableMap: JSON.parse(operationAvailableMap),\n\t\t\tmultiSelectDisabledActions: ActionHelper.getMultiSelectDisabledActions(actionsObject as DataFieldAbstractTypes[]) + \"\",\n\t\t\tsegmentedButtonId: generate([chartBlock._blockId, \"SegmentedButton\", \"TemplateContentView\"]),\n\t\t\tcustomAgg: chartBlock.chartDefinition?.customAgg,\n\t\t\ttransAgg: chartBlock.chartDefinition?.transAgg,\n\t\t\tapplySupported: chartBlock.chartDefinition?.applySupported,\n\t\t\tvizProperties: JSON.parse(chartBlock.vizProperties),\n\t\t\tdraftSupported: chartBlock.draftSupported,\n\t\t\tmultiViews: chartBlock.chartDefinition?.multiViews || (!hasMultipleVisualizations && isMultiTabs),\n\t\t\tselectionPresentationVariantPath: {\n\t\t\t\tdata: chartBlock.chartDefinition?.selectionPresentationVariantPath\n\t\t\t},\n\t\t\tchartDimensionKeyAndRole: chartBlock.chartDefinition?.chartDimensionKeyAndRole,\n\t\t\tchartMeasureKeyAndRole: chartBlock.chartDefinition?.chartMeasureKeyAndRole\n\t\t};\n\t\tif (chartBlock.chartDefinition.isParameterizedEntitySet) {\n\t\t\tchartBlock._customData.entitySet = chartBlock.chartDefinition.collection.substring(1);\n\t\t}\n\t} else {\n\t\t// fallback to display empty chart\n\t\tchartBlock.autoBindOnInit = false;\n\t\tchartBlock.visible = \"true\";\n\t\tchartBlock.navigationPath = \"\";\n\n\t\tchartBlock._customData = {\n\t\t\ttargetCollectionPath: \"\",\n\t\t\tentitySet: \"\",\n\t\t\tentityType: \"\",\n\t\t\toperationAvailableMap: \"\",\n\t\t\tmultiSelectDisabledActions: \"\",\n\t\t\tsegmentedButtonId: \"\",\n\t\t\tcustomAgg: {},\n\t\t\ttransAgg: {},\n\t\t\tapplySupported: {},\n\t\t\tvizProperties: {}\n\t\t};\n\t}\n}\n\nfunction getFilterBar(chartBlock: ChartBlock): string | undefined {\n\tconst filterBar = Element.getElementById(chartBlock.filterBar);\n\tif (chartBlock.filterBar && filterBar?.isA<MacroAPI>(\"sap.fe.macros.filterBar.FilterBarAPI\")) {\n\t\treturn getContentId(chartBlock.filterBar);\n\t} else if (filterBar?.isA<Control>(\"sap.fe.macros.controls.FilterBar\")) {\n\t\treturn chartBlock.filterBar;\n\t} else if (chartBlock.filterBar) {\n\t\treturn getContentId(chartBlock.filterBar);\n\t}\n}\n\nfunction getDelegate(chartBlock: ChartBlock): object {\n\tif (chartBlock.chartDelegate) {\n\t\t(chartBlock.chartDelegate as ChartDelegate).payload.selectionMode =\n\t\t\tchartBlock.chartDefinition.selectionMode?.toUpperCase() ??\n\t\t\t(chartBlock.chartDelegate as ChartDelegate).payload.selectionMode ??\n\t\t\t\"MULTIPLE\";\n\t}\n\treturn chartBlock.chartDelegate\n\t\t? chartBlock.chartDelegate\n\t\t: {\n\t\t\t\tname: \"sap/fe/macros/chart/ChartDelegate\",\n\t\t\t\tpayload: {\n\t\t\t\t\tchartContextPath: chartBlock._customData.targetCollectionPath,\n\t\t\t\t\tparameters: {\n\t\t\t\t\t\t$$groupId: \"$auto.Workers\"\n\t\t\t\t\t},\n\t\t\t\t\tselectionMode:\n\t\t\t\t\t\tchartBlock.chartDefinition.selectionMode?.toUpperCase() ?? chartBlock.selectionMode?.toUpperCase() ?? \"MULTIPLE\"\n\t\t\t\t}\n\t\t  };\n}\n\nfunction getCustomData(chartBlock: ChartBlock): CustomData[] {\n\treturn [\n\t\t<CustomData key={\"targetCollectionPath\"} value={chartBlock._customData.targetCollectionPath} />,\n\t\t<CustomData key={\"entitySet\"} value={chartBlock._customData.entitySet} />,\n\t\t<CustomData key={\"entityType\"} value={chartBlock._customData.entityType} />,\n\t\t<CustomData key={\"operationAvailableMap\"} value={chartBlock._customData.operationAvailableMap} />,\n\t\t<CustomData key={\"multiSelectDisabledActions\"} value={chartBlock._customData.multiSelectDisabledActions} />,\n\t\t<CustomData key={\"segmentedButtonId\"} value={chartBlock._customData.segmentedButtonId} />,\n\t\t<CustomData key={\"customAgg\"} value={chartBlock._customData.customAgg} />,\n\t\t<CustomData key={\"transAgg\"} value={chartBlock._customData.transAgg} />,\n\t\t<CustomData key={\"applySupported\"} value={chartBlock._customData.applySupported} />,\n\t\t<CustomData key={\"vizProperties\"} value={chartBlock._customData.vizProperties} />,\n\t\t<CustomData key={\"draftSupported\"} value={chartBlock._customData.draftSupported} />,\n\t\t<CustomData key={\"multiViews\"} value={chartBlock._customData.multiViews} />,\n\t\t<CustomData key={\"selectionPresentationVariantPath\"} value={chartBlock._customData.selectionPresentationVariantPath} />,\n\t\t<CustomData key={\"chartDimensionKeyAndRole\"} value={chartBlock._customData.chartDimensionKeyAndRole} />,\n\t\t<CustomData key={\"chartMeasureKeyAndRole\"} value={chartBlock._customData.chartMeasureKeyAndRole} />\n\t];\n}\n\nfunction getNoData(chartBlock: ChartBlock): IllustratedMessage | undefined {\n\tif (chartBlock._customData.targetCollectionPath === \"\") {\n\t\treturn;\n\t}\n\treturn (\n\t\t<IllustratedMessage\n\t\t\tillustrationSize={IllustratedMessageSize.Auto}\n\t\t\tillustrationType={IllustratedMessageType.BeforeSearch}\n\t\t\ttitle={chartBlock.getTranslatedText(\"T_TABLE_AND_CHART_NO_DATA_TITLE_TEXT\")}\n\t\t\tdescription={chartBlock.getTranslatedText(\"T_TABLE_AND_CHART_NO_DATA_TEXT\")}\n\t\t\tenableDefaultTitleAndDescription={false}\n\t\t\tenableVerticalResponsiveness={true}\n\t\t></IllustratedMessage>\n\t);\n}\n\nexport function getMdcChartTemplate(\n\tchartBlock: ChartBlock,\n\tviewData: ViewData,\n\tdiagnostics: Diagnostics,\n\tcontextObjectPath: DataModelObjectPath<ChartContextObjectPath>\n): MdcChart {\n\tinitialise(chartBlock, viewData, diagnostics, contextObjectPath);\n\tchartBlock.layoutData = <FlexItemData growFactor=\"1\" shrinkFactor=\"1\" />;\n\n\treturn (\n\t\t<MdcChart\n\t\t\tbinding={{ internal: \"controls/\" + chartBlock._blockId }}\n\t\t\tid={chartBlock._contentId}\n\t\t\tchartType={chartBlock._chartType}\n\t\t\tsortConditions={chartBlock._sortConditions}\n\t\t\theader={chartBlock.chartDefinition.header ?? chartBlock.header ?? chartBlock._chart?.Title?.toString() ?? \"\"}\n\t\t\theaderVisible={chartBlock.chartDefinition.headerVisible ?? chartBlock.headerVisible}\n\t\t\tminHeight={Device.system.phone ? \"80vh\" : \"400px\"}\n\t\t\theight=\"100%\"\n\t\t\twidth=\"100%\"\n\t\t\theaderLevel={chartBlock.headerLevel}\n\t\t\theaderStyle={chartBlock.headerStyle}\n\t\t\tp13nMode={(chartBlock._personalization! as string)?.split(\",\")}\n\t\t\tfilter={chartBlock.filter}\n\t\t\tnoDataText={\n\t\t\t\tchartBlock._customData.targetCollectionPath === \"\"\n\t\t\t\t\t? chartBlock.getTranslatedText(\"M_CHART_NO_ANNOTATION_SET_TEXT\")\n\t\t\t\t\t: chartBlock.noDataText\n\t\t\t}\n\t\t\tautoBindOnInit={chartBlock.autoBindOnInit}\n\t\t\tdelegate={getDelegate(chartBlock)}\n\t\t\tvisible={chartBlock.visible}\n\t\t>\n\t\t\t{{\n\t\t\t\tcustomData: getCustomData(chartBlock),\n\t\t\t\tdependents: [getDependents(chartBlock, chartBlock._chartContext), getPersistenceProvider(chartBlock)],\n\t\t\t\titems: getItems(chartBlock),\n\t\t\t\tactions: chartBlock.chartActions ? getToolbarActions(chartBlock) : chartBlock._blockActions,\n\t\t\t\tvariant: createVariantManagement(chartBlock),\n\t\t\t\tnoData: getNoData(chartBlock)\n\t\t\t}}\n\t\t</MdcChart>\n\t);\n}\n"],"mappings":"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","ignoreList":[],"file":"MdcChartTemplate-dbg.js"}