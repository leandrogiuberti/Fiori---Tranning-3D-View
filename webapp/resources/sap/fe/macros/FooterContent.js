/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/controls/CommandExecution","sap/fe/core/converters/ManifestSettings","sap/fe/core/converters/MetaModelConverter","sap/fe/core/converters/annotations/DataField","sap/fe/core/converters/controls/Common/Action","sap/fe/core/helpers/BindingHelper","sap/fe/core/helpers/FPMHelper","sap/fe/core/helpers/ModelHelper","sap/fe/core/library","sap/fe/core/templating/CriticalityFormatters","sap/fe/macros/messages/MessageButton","sap/m/Button","sap/m/DraftIndicator","sap/m/Menu","sap/m/MenuButton","sap/m/MenuItem","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/ui/core/InvisibleText","sap/fe/base/HookSupport","sap/fe/templates/ObjectPage/ObjectPageTemplating","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSeparator","sap/ui/model/json/JSONModel","sap/fe/base/jsx-runtime/jsx","sap/fe/base/jsx-runtime/jsxs"],function(e,t,i,n,a,r,o,s,l,c,d,u,p,f,g,h,b,m,_,v,C,y,E,w,A,D,O,x,M,I){"use strict";var B,P,T,S,N,V,j,R,F,z,G,H,L,J,k,U;var q={};var W=w.controllerExtensionHandler;var $=c.UI;var X=c.Draft;var Y=l.aiIcon;var K=s.isActionWithDialog;var Q=o.getInvolvedDataModelObjects;var Z=r.ActionType;var ee=i.property;var te=i.implementInterface;var ie=i.defineUI5Class;var ne=i.defineReference;var ae=t.resolveBindingString;var re=t.pathInModel;var oe=t.or;var se=t.ifElse;var le=t.equal;var ce=t.constant;var de=t.compileExpression;var ue=t.and;function pe(e,t,i,n){i&&Object.defineProperty(e,t,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(n):void 0})}function fe(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,ge(e,t)}function ge(e,t){return ge=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},ge(e,t)}function he(e,t,i,n,a){var r={};return Object.keys(n).forEach(function(e){r[e]=n[e]}),r.enumerable=!!r.enumerable,r.configurable=!!r.configurable,("value"in r||r.initializer)&&(r.writable=!0),r=i.slice().reverse().reduce(function(i,n){return n(e,t,i)||i},r),a&&void 0!==r.initializer&&(r.value=r.initializer?r.initializer.call(a):void 0,r.initializer=void 0),void 0===r.initializer?(Object.defineProperty(e,t,r),null):r}function be(e,t){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}let me=(B=ie("sap.fe.macros.FooterContent"),P=te("sap.ui.core.Toolbar"),T=te("sap.m.IBar"),S=ee({type:"string",required:true}),N=ee({type:"string",required:true}),V=ee({type:"string"}),j=ne(),R=W("routing","onAfterBinding"),B(F=(z=function(t){function i(e,i){var n;n=t.call(this,e,i)||this;pe(n,"__implements__sap_ui_core_Toolbar",G,n);pe(n,"__implements__sap_m_IBar",H,n);pe(n,"id",L,n);pe(n,"metaPath",J,n);pe(n,"contextPath",k,n);pe(n,"cmdExecution",U,n);n._hideCreateNext=false;return n}q=i;fe(i,t);var n=i.prototype;n.onAfterBinding=async function e(){if(this._hiddenDraft){const e=this._getOwner()?.getRootController();const t=e.getView().getBindingContext();const i=await e.editFlow.isRootContextNew(t);this.getModel("footerInternal").setProperty("/rootIsNewObject",i)}};n.initialize=function e(){const t=this._getOwner();this.setModel(new x,"footerInternal");this.actions=t?.preprocessorContext?.bindingContexts?.converterContext?.getObject("footerActions");const i=t?.preprocessorContext?.fullContextPath;this.oDataMetaModel=t?.preprocessorContext?.models.metaModel;this.dataViewModelPath=this.getDataModelObjectForMetaPath(this.metaPath,i??this.contextPath);const n=this.dataViewModelPath.startingEntitySet;this.isDraftValidation=!!(u.getDraftRoot(n)?.PreparationAction&&n?.entityType.annotations.Common?.Messages);this.content=this.createContent()};n.onMetadataAvailable=function e(){const t=this._getOwner()?.getRootController();this._hiddenDraft=t.getAppComponent().getEnvironmentCapabilities().getCapabilities().HiddenDraft?.enabled;this._hideCreateNext=t.getAppComponent().getEnvironmentCapabilities().getCapabilities().HiddenDraft?.hideCreateNext===true;if(!this.content){this.initialize()}};n.getActionModelPath=function e(t){const i=t.annotationPath;if(i){const e=this.oDataMetaModel.getContext(i);return Q(e)}return undefined};n.getDraftIndicator=function e(){const t=this.dataViewModelPath.targetEntitySet||this.dataViewModelPath.startingEntitySet;const i=t.annotations?.Common;if((i?.DraftRoot||i?.DraftNode)&&!this._hiddenDraft){return M(b,{state:"{ui>/draftStatus}",visible:"{ui>/isEditable}"})}return undefined};n.getApplyButton=function e(t){const i=this._getOwner()?.getRootController();const n=i.getView().getViewData();if(n?.viewLevel!=null&&n?.viewLevel<=1||this._hiddenDraft){return null}if(this.isDraftValidation&&!n.isDesktop&&!n.fclEnabled){return M(_,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_APPLY_DRAFT}",defaultAction:async()=>{await i._applyDocument(i.getView().getBindingContext())},useDefaultActionOnly:"true",buttonMode:"Split",type:t,"dt:designtime":"not-adaptable",children:M(m,{children:M(v,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_VALIDATE_DRAFT}",press:async()=>{await i._validateDocument()}})})})}return M(h,{id:this.createId("StandardAction::Apply"),text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_APPLY_DRAFT}",type:t,enabled:true,press:async()=>{await i._applyDocument(i.getView().getBindingContext())},visible:"{ui>/isEditable}","dt:designtime":"not-adaptable"})};n.getPrimary=function e(t,i){const n=this._getOwner()?.getRootController();const r=n.getAppComponent().getEnvironmentCapabilities().getCapabilities().HiddenDraft?.enabled;const o=n.getView().getViewData();n.getView().addDependent(M(a,{ref:this.cmdExecution,command:"Save",execute:n._saveDocument,visible:oe(se(r===true,se(o.fclEnabled===true,ue($.IsEditable,le(re("/showSaveAndCancelButton","fclhelper"),true)),$.IsEditable),$.IsEditable),le(re("/isInlineEditActive","ui"),true))}));if(this.isDraftValidation&&!o.isDesktop){return M(_,{text:this.getTextSaveButton(),"jsx:command":"cmd:Save|defaultAction",useDefaultActionOnly:"true",buttonMode:"Split",type:t,visible:de(se(r===true,se(o.fclEnabled===true,ue($.IsEditable,le(re("/showSaveAndCancelButton","fclhelper"),true)),$.IsEditable),$.IsEditable)),"dt:designtime":"not-adaptable",children:M(m,{children:M(v,{text:"{sap.fe.i18n>T_COMMON_OBJECT_PAGE_VALIDATE_DRAFT}",press:async()=>{await n._validateDocument()}})})})}return M(h,{id:this.createId("StandardAction::Save"),text:this.getTextSaveButton(),type:t,visible:de(se(r===true,se(o.fclEnabled===true,ue($.IsEditable,le(re("/showSaveAndCancelButton","fclhelper"),true)),$.IsEditable),$.IsEditable)),enabled:true,"jsx:command":"cmd:Save|press","dt:designtime":"not-adaptable",children:{layoutData:M(D,{priority:i?.priority,group:i?.group})}})};n.getTextSaveButton=function e(){const t=this.getTranslatedText("T_OP_OBJECT_PAGE_SAVE");const i=this.getTranslatedText("T_OP_OBJECT_PAGE_CREATE");return se(se(this.dataViewModelPath.startingEntitySet.annotations.Session?.StickySessionSupported!==undefined,$.IsCreateMode,se(this._hiddenDraft,ue(re("/rootIsNewObject","footerInternal")),X.IsNewObject)),i,t)};n.getCancelButton=function e(t){const i=this._getOwner()?.getRootController();const n=i.getAppComponent().getEnvironmentCapabilities().getCapabilities().HiddenDraft?.enabled;const r=i.getView().getViewData();i.getView().addDependent(M(a,{ref:this.cmdExecution,command:"Cancel",execute:()=>{i._cancelDocument({cancelButton:"fe::FooterBar::StandardAction::Cancel"})},visible:se(n===true,se(r.fclEnabled===true,ue($.IsEditable,le(re("/showSaveAndCancelButton","fclhelper"),true)),$.IsEditable),$.IsEditable)}));return M(h,{id:this.createId("StandardAction::Cancel"),text:u.isDraftRoot(this.dataViewModelPath.targetEntitySet)&&!this._hiddenDraft?"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_DISCARD_DRAFT}":"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_CANCEL}","jsx:command":"cmd:Cancel|press",visible:de(se(n===true,se(r.fclEnabled===true,ue($.IsEditable,le(re("/showSaveAndCancelButton","fclhelper"),true)),$.IsEditable),$.IsEditable)),ariaHasPopup:se(re("/isDocumentModified","ui"),ce("Dialog"),ce("None")),enabled:true,"dt:designtime":"not-adaptable",children:{layoutData:M(D,{priority:t?.priority,closeOverflowOnInteraction:false})}})};n.getCreateNextButton=function e(t){const i=this._getOwner()?.getRootController();const n=i.getView().getViewData();return M(h,{id:this.createId("StandardAction::CreateNext"),text:"{sap.fe.i18n>C_COMMON_OBJECT_PAGE_CREATE_NEXT}",press:i.editFlow.createNextDocument,type:t,visible:se(this._hiddenDraft===true,se(n.fclEnabled===true,ue(X.IsNewObject,le(re("/showSaveAndCancelButton","fclhelper"),true)),X.IsNewObject),X.IsNewObject),enabled:true,"dt:designtime":"not-adaptable",children:{layoutData:M(D,{closeOverflowOnInteraction:false})}})};n.getToolbarSeparator=function e(t){return M(O,{children:{layoutData:M(D,{group:t.group})}})};n.getDataFieldForActionButton=function e(t){if(t.annotationPath){const e=this._getOwner()?.getRootController();const i=t.annotationPath;let n;const a=e.getView();const r=this.oDataMetaModel.getContext(i);const o=Q(r);const s=o.targetObject;if(s){const i={entitySetName:this.dataViewModelPath.targetEntitySet?.name,invocationGrouping:s.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?p.InvocationGrouping.ChangeSet:p.InvocationGrouping.Isolated,label:s.Label?.toString(),isNavigable:t.isNavigable,defaultValuesExtensionFunction:t.defaultValuesExtensionFunction};if(!t.command){n={press:()=>{e.handlers.onCallAction(a,s.Action,{...i,...{contexts:a.getBindingContext(),model:a.getModel()}})}}}else{if(!t.command.startsWith("cmd:")){t.command=`cmd:${t.command}`}n={"jsx:command":`${t.command}|press`}}return M(h,{id:this.createId(this.getActionModelPath(t)),"dt:designtime":t.visible==="true"||t.visible==="false"?undefined:"not-adaptable-visibility",text:i.label,...n,ariaHasPopup:K(o.targetObject),visible:t.visible,enabled:t.enabled,type:f.buildExpressionForCriticalityButtonType(o),icon:t?.isAIOperation===true?Y:undefined,children:{layoutData:M(D,{priority:t.priority,group:t.group})}})}}};n.getManifestButton=function t(i){if(A.isManifestAction(i)){let t;if(i.command){t={"jsx:command":`cmd:${i.command}|press`}}else{t={press:t=>{d.actionWrapper(t,i.handlerModule,i.handlerMethod,{}).catch(t=>e.error(t))}}}return I(h,{id:this.createId(i.id),"dt:designtime":i.visible==="true"||i.visible==="false"?undefined:"not-adaptable-visibility",text:i.text??"",...t,type:"Transparent",visible:i.visible,enabled:i.enabled,icon:i?.isAIOperation===true?Y:undefined,children:[{layoutData:M(D,{priority:i.priority,group:i.group})},"‚"]})}};n.getActionControls=function e(){const t=A.buildEmphasizedButtonExpression(this.dataViewModelPath);return this.actions?.map(e=>{switch(e.type){case Z.DefaultApply:return this.getApplyButton(t);case Z.DataFieldForAction:return this.getDataFieldForActionButton(e);case Z.Primary:const i=this._getOwner()?.getRootController();const n=i.getView().getViewData();const a=n?.viewLevel??0;if(this._hiddenDraft&&!this._hideCreateNext&&a>1){const e=t?ae(t):undefined;return this.getPrimary(de(se(X.IsNewObject,undefined,e)))}return this.getPrimary(t,e);case Z.Secondary:return this.getCancelButton(e);case Z.CreateNext:if(this._hiddenDraft&&!this._hideCreateNext){const e=t?ae(t):undefined;return this.getCreateNextButton(de(se(X.IsNewObject,e,undefined)))}return;case Z.Separator:return this.getToolbarSeparator(e);default:return this.getManifestButton(e)}}).filter(e=>!!e)};n.createContent=function e(){const t=this._getOwner()?.getRootController();const i=t.getView().getViewData();const n=M(g,{id:this.createId("MessageButton"),visible:de(se(this._hiddenDraft===true,se(i.fclEnabled===true,ue($.IsEditable,le(re("/showSaveAndCancelButton","fclhelper"),true)),true),true)),messageChange:()=>t._getFooterVisibility(),ariaLabelledBy:[this.createId("MessageButton::AriaText")],type:"Emphasized",ariaHasPopup:"Dialog"});const r=I(C,{id:this.createId("_fc"),asyncMode:true,children:[M(E,{id:this.createId("MessageButton::AriaText"),text:"{sap.fe.i18n>C_COMMON_SAPFE_ERROR_MESSAGES_PAGE_BUTTON_ARIA_TEXT}"}),n,M(y,{}),this.getDraftIndicator(),this.getActionControls()]});t.getView().addDependent(M(a,{ref:this.cmdExecution,command:"OpenMessageButtonMenu",execute:()=>n.firePress()}));return r};return i}(n),G=he(z.prototype,"__implements__sap_ui_core_Toolbar",[P],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),H=he(z.prototype,"__implements__sap_m_IBar",[T],{configurable:true,enumerable:true,writable:true,initializer:function(){return true}}),L=he(z.prototype,"id",[S],{configurable:true,enumerable:true,writable:true,initializer:null}),J=he(z.prototype,"metaPath",[N],{configurable:true,enumerable:true,writable:true,initializer:null}),k=he(z.prototype,"contextPath",[V],{configurable:true,enumerable:true,writable:true,initializer:null}),U=he(z.prototype,"cmdExecution",[j],{configurable:true,enumerable:true,writable:true,initializer:null}),he(z.prototype,"onAfterBinding",[R],Object.getOwnPropertyDescriptor(z.prototype,"onAfterBinding"),z.prototype),z))||F);q=me;return q},false);
//# sourceMappingURL=FooterContent.js.map