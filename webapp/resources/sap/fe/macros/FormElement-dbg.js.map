{"version":3,"names":["FormElementControl","_dec","defineUI5Class","_dec2","property","type","_dec3","_dec4","_dec5","defaultValue","_dec6","aggregation","multiple","singularName","_class","_class2","_FormElement","properties","others","_this","call","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","ensureDefaultField","attachModelContextChange","onModelContextChange","bind","_exports","_inheritsLoose","_proto","prototype","fields","length","field","Field","metaPath","contextPath","id","getId","addField","evt","source","getSource","owner","Component","getOwnerComponentFor","metaModel","getMetaModel","getFullContextPath","metaPathContext","createBindingContext","oContextObjectPath","getInvolvedDataModelObjects","error","Log","targetObject","label","getLabel","annotations","Common","Label","toString","setLabel","FormElement","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["FormElement.ts"],"sourcesContent":["import type { ServiceObject } from \"@sap-ux/vocabularies-types\";\nimport Log from \"sap/base/Log\";\nimport type { EnhanceWithUI5, PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { aggregation, defineUI5Class, property } from \"sap/fe/base/ClassSupport\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport { getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport Field from \"sap/fe/macros/Field\";\nimport type UI5Event from \"sap/ui/base/Event\";\nimport Component from \"sap/ui/core/Component\";\nimport type Control from \"sap/ui/core/Control\";\nimport type { $ControlSettings } from \"sap/ui/core/Control\";\nimport FormElement from \"sap/ui/layout/form/FormElement\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\n\n/**\n * Building block used to create a form element based on the metadata provided by OData V4.\n * @public\n * @since 1.90.0\n */\n@defineUI5Class(\"sap.fe.macros.form.FormElement\")\nexport default class FormElementControl extends FormElement {\n\t/**\n\t * Defines the path of the context used in the current page or block.\n\t * This setting is defined by the framework.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tpublic contextPath!: string;\n\n\t/**\n\t * Defines the relative path of the property in the metamodel, based on the current contextPath.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tpublic metaPath!: string;\n\n\t/**\n\t * Label shown for the field. If not set, the label from the annotations will be shown.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tlabel?: string;\n\n\t/**\n\t * If set to false, the FormElement is not rendered.\n\t * @public\n\t */\n\t@property({ type: \"boolean\", defaultValue: true })\n\tvisible!: boolean;\n\n\t/**\n\t * Optional aggregation of controls that should be displayed inside the FormElement.\n\t * If not set, a default Field building block will be rendered\n\t * @public\n\t */\n\t@aggregation({ type: \"sap.ui.core.Control\", multiple: true, singularName: \"field\" })\n\tfields?: Control[];\n\n\t/**\n\t * Constructor for the FormElementControl.\n\t * Adds a default Field if no fields are provided and attaches a handler for model context changes.\n\t * @param properties Initial settings for the new control\n\t * @param others Additional settings\n\t */\n\tconstructor(properties: string | ($ControlSettings & PropertiesOf<FormElementControl>), others?: $ControlSettings) {\n\t\tsuper(properties as string, others);\n\t\tthis.ensureDefaultField();\n\t\tthis.attachModelContextChange(this.onModelContextChange.bind(this));\n\t}\n\n\t/**\n\t * Ensures that a default Field is created and added to the aggregation if no fields are provided.\n\t * @private\n\t */\n\tensureDefaultField(): void {\n\t\tif (!this.fields || this.fields.length === 0) {\n\t\t\tconst field = new Field({\n\t\t\t\tmetaPath: this.metaPath,\n\t\t\t\tcontextPath: this.contextPath,\n\t\t\t\tid: this.getId() + \"--FormElementField\"\n\t\t\t});\n\t\t\tthis.addField(field);\n\t\t}\n\t}\n\n\t/**\n\t * Handles model context changes to update the label from OData annotations if not set explicitly.\n\t * @param evt The model context change event\n\t * @private\n\t */\n\tonModelContextChange(evt: UI5Event): void {\n\t\tconst source = evt.getSource() as unknown as FormElementControl;\n\t\tconst owner = Component.getOwnerComponentFor(source) as EnhanceWithUI5<TemplateComponent>;\n\t\tconst metaModel = owner?.getMetaModel();\n\t\tconst contextPath = source.contextPath ? source.contextPath + \"/\" : owner?.getFullContextPath();\n\t\tconst metaPathContext = metaModel?.createBindingContext(contextPath + source.metaPath) as Context;\n\t\tlet oContextObjectPath: DataModelObjectPath<ServiceObject> | undefined;\n\t\ttry {\n\t\t\toContextObjectPath = getInvolvedDataModelObjects(metaPathContext);\n\t\t} catch (error) {\n\t\t\tLog.error(`Error while getting the involved data model objects: ${error}`);\n\t\t}\n\t\tif (oContextObjectPath && !oContextObjectPath.targetObject) {\n\t\t\tLog.error(`No target object found for the given path ${source.metaPath} on the FormElement`);\n\t\t} else {\n\t\t\tconst label = source.getLabel() || oContextObjectPath?.targetObject?.annotations.Common?.Label?.toString();\n\t\t\tif (label) {\n\t\t\t\tsource.setLabel(label);\n\t\t\t}\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"FormElement-dbg.js"}