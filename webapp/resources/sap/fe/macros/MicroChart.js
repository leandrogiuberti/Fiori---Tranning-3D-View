/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/base/ClassSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/helpers/StableIdHelper","sap/fe/core/templating/CriticalityFormatters","sap/fe/core/templating/DataModelPathHelper","sap/fe/core/templating/UIFormatters","sap/m/Text","sap/ui/core/Lib","./CommonHelper","./controls/ConditionalWrapper","./internal/TitleLink","./microchart/MicroChartContainer","./microchart/MicroChartHelper","sap/fe/base/jsx-runtime/jsx"],function(t,e,a,r,i,n,o,h,s,c,l,u,g,p,C){"use strict";var d,b,y,T,m,_,f,P,M,O,v,I,j,D,U,A,w,k,B,x,z,N,E,L,S,F,R,V,H,$,Q,W,q,G,K,J,X,Y,Z;function tt(t){return new Promise((e,a)=>{sap.ui.require([t],a=>{if(!(a&&a.__esModule)){a=a===null||!(typeof a==="object"&&t.endsWith("/library"))?{default:a}:a;Object.defineProperty(a,"__esModule",{value:true})}e(a)},t=>{a(t)})})}var et={};var at=o.getExpressionForMeasureUnit;var rt=n.getTargetNavigationPath;var it=n.enhanceDataModelPath;var nt=i.buildExpressionForCriticalityColorMicroChart;var ot=e.property;var ht=e.event;var st=e.defineUI5Class;var ct=t.pathInModel;var lt=t.or;var ut=t.not;var gt=t.ifElse;var pt=t.getExpressionFromAnnotation;var Ct=t.equal;var dt=t.constant;var bt=t.compileExpression;function yt(t,e,a,r){a&&Object.defineProperty(t,e,{enumerable:a.enumerable,configurable:a.configurable,writable:a.writable,value:a.initializer?a.initializer.call(r):void 0})}function Tt(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,mt(t,e)}function mt(t,e){return mt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},mt(t,e)}function _t(t,e,a,r,i){var n={};return Object.keys(r).forEach(function(t){n[t]=r[t]}),n.enumerable=!!n.enumerable,n.configurable=!!n.configurable,("value"in n||n.initializer)&&(n.writable=!0),n=a.slice().reverse().reduce(function(a,r){return r(t,e,a)||a},n),i&&void 0!==n.initializer&&(n.value=n.initializer?n.initializer.call(i):void 0,n.initializer=void 0),void 0===n.initializer?(Object.defineProperty(t,e,n),null):n}function ft(t,e){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}var Pt=function(t){t["External"]="External";t["InPage"]="InPage";t["None"]="None";return t}(Pt||{});let Mt=(d=st("sap.fe.macros.MicroChart",{returnTypes:["sap.fe.macros.microchart.MicroChartContainer","sap.fe.macros.controls.ConditionalWrapper"]}),b=ot({type:"boolean"}),y=ot({type:"string",required:true}),T=ot({type:"string"}),m=ot({type:"string"}),_=ot({type:"string"}),f=ot({type:"string"}),P=ot({type:"boolean"}),M=ot({type:"string"}),O=ot({type:"string"}),v=ht(),I=ot({type:"object"}),j=ot({type:"object"}),D=ot({type:"object"}),U=ot({type:"object"}),A=ot({type:"string"}),w=ot({type:"object"}),k=ot({type:"object"}),B=ot({type:"boolean"}),d(x=(z=function(t){function e(e,a){var r;r=t.call(this,e,a)||this;yt(r,"showOnlyChart",N,r);yt(r,"metaPath",E,r);yt(r,"contextPath",L,r);yt(r,"navigationType",S,r);yt(r,"batchGroupId",F,r);yt(r,"size",R,r);yt(r,"hideOnNoData",V,r);yt(r,"title",H,r);yt(r,"description",$,r);yt(r,"titlePress",Q,r);yt(r,"_chartTarget",W,r);yt(r,"_dataPoint",q,r);yt(r,"_targetNavigationPath",G,r);yt(r,"_microChartDataModelObjectPath",K,r);yt(r,"_binding",J,r);yt(r,"_sortOrder",X,r);yt(r,"_measureDataPath",Y,r);yt(r,"isAnalytics",Z,r);return r}et=e;Tt(e,t);var a=e.prototype;a.getSortOrder=function t(e){return e.map(t=>({Property:t.Property?.value,Descending:t.Descending,fullyQualifiedName:"",$Type:"com.sap.vocabularies.Common.v1.SortOrderType"}))};a.setProperty=function e(a,r,i){if(!this._applyingSettings&&r!==undefined&&Object.keys(this.getMetadata().getProperties()).includes(a)){t.prototype.setProperty.call(this,a,r,true);if(this.content){this.content.destroy();this.content=this.createContent();this.createMicroChart()}}else{t.prototype.setProperty.call(this,a,r,i)}return this};a.clone=function e(a,r){const i=t.prototype.clone.call(this,a,r);i.createMicroChart();return i};a.onMetadataAvailable=async function t(e){if(!this.content){const t=this._getOwner();this.contextPath=this.contextPath??t?.preprocessorContext?.fullContextPath;const e=t?.getMetaModel();this._microChartDataModelObjectPath=this.getDataModelObjectForMetaPath(this.metaPath,this.contextPath);if(this._microChartDataModelObjectPath?.targetObject?.term==="com.sap.vocabularies.UI.v1.PresentationVariant"){if(this._microChartDataModelObjectPath.targetObject.SortOrder?.length){this._sortOrder=this.getSortOrder(this._microChartDataModelObjectPath.targetObject.SortOrder)}this._microChartDataModelObjectPath=this.getDataModelObjectForMetaPath(`${this._microChartDataModelObjectPath.targetObject.Visualizations[0].value}`,rt(this._microChartDataModelObjectPath)+"/")}if(this._microChartDataModelObjectPath){if(this._microChartDataModelObjectPath.targetObject?.term==="com.sap.vocabularies.UI.v1.PresentationVariant"){if(this._microChartDataModelObjectPath.targetObject.SortOrder?.length!=null){this._sortOrder=this.getSortOrder(this._microChartDataModelObjectPath.targetObject.SortOrder)}}this._chartTarget=this._microChartDataModelObjectPath.targetObject;this._measureDataPath=it(this._microChartDataModelObjectPath,this._chartTarget.Measures[0].value);if(p.shouldRenderMicroChart(this._chartTarget)){this._dataPoint=this._chartTarget?.MeasureAttributes[0]?.DataPoint?.$target;this._targetNavigationPath=e?.createBindingContext(rt(this._microChartDataModelObjectPath));this.showOnlyChart=typeof this.showOnlyChart==="string"?this.showOnlyChart==="true":this.showOnlyChart;this.content=this.createContent();await this.createMicroChart()}else{this.logWarning()}}}};a.createMicroChart=async function t(){const e={"UI.ChartType/Bullet":`sap/suite/ui/microchart/BulletMicroChart`,"UI.ChartType/Donut":`sap/suite/ui/microchart/RadialMicroChart`,"UI.ChartType/Pie":`sap/suite/ui/microchart/HarveyBallMicroChart`,"UI.ChartType/BarStacked":`sap/suite/ui/microchart/StackedBarMicroChart`,"UI.ChartType/Column":`sap/suite/ui/microchart/ColumnMicroChart`,"UI.ChartType/Bar":`sap/suite/ui/microchart/ComparisonMicroChart`,"UI.ChartType/Line":`sap/suite/ui/microchart/LineMicroChart`,"UI.ChartType/Area":`sap/suite/ui/microchart/AreaMicroChart`};const a=this._chartTarget.ChartType;if(Object.keys(e).includes(a)){const t=(await tt(e[a])).default;const r=await this.getMicroChartAggregations();if(this.isAnalytics){(this.content?.getAggregation("contentTrue")).setAggregation("microChart",C(t,{...this.getMicroChartProperties(),children:r}))}else{this.content.setAggregation("microChart",C(t,{...this.getMicroChartProperties(),children:r}))}}};a.logWarning=function t(){const e={};if(this._chartTarget.ChartType==="UI.ChartType/Bullet"){e["DataPoint_Value"]=this._dataPoint?.Value||undefined}p.logWarning(this._chartTarget.ChartType,e)};a.getMicroChartProperties=function t(){let e={size:this.size,hideOnNoData:this.hideOnNoData};const a=it(this._microChartDataModelObjectPath,this._chartTarget?.MeasureAttributes[0]?.DataPoint?.value);const r=p.getAggregationForMicrochart(this._chartTarget.ChartType,this._targetNavigationPath?.getObject(),a,this._targetNavigationPath?.getObject("@sapui.name"),undefined,this._measureDataPath,this._sortOrder,this._microChartDataModelObjectPath?.targetObject?.Dimensions?.[0]?.value,true);switch(this._chartTarget.ChartType){case"UI.ChartType/Bullet":e=p.getBulletMicroChartProperties(e,this._dataPoint);break;case"UI.ChartType/Donut":e=p.getRadialMicroChartProperties(e,this._dataPoint);break;case"UI.ChartType/Pie":e=p.getHarveyMicroChartProperties(e,this._dataPoint);break;case"UI.ChartType/BarStacked":e.bars=r;break;case"UI.ChartType/Column":e.columns=p.getAggregationForMicrochart(this._chartTarget.ChartType,this._targetNavigationPath?.getObject(),a,this._targetNavigationPath?.getObject("@sapui.name"),this._chartTarget?.Dimensions?.[0],this._measureDataPath,this._sortOrder,this._microChartDataModelObjectPath?.targetObject?.Dimensions?.[0]?.value,true);break;case"UI.ChartType/Bar":e.maxValue=this._dataPoint.MaximumValue?bt(dt(this._dataPoint.MaximumValue?.valueOf())):undefined;e.minValue=this._dataPoint.MinimumValue?bt(dt(this._dataPoint.MinimumValue?.valueOf())):undefined;e.colorPalette=p.getColorPaletteForMicroChart(this._dataPoint);e.data=r;break;case"UI.ChartType/Line":e.showThresholdLine=false;break;default:break}return e};a.getMicroChartAggregations=async function t(){const e=this._dataPoint.Criticality?nt(this._dataPoint):undefined;if(this._chartTarget.ChartType==="UI.ChartType/Bullet"){return p.getBulletMicroChartAggregations(this._dataPoint,e)}if(this._chartTarget.ChartType==="UI.ChartType/BarStacked"){return p.getStackMicroChartAggregations(this._dataPoint,this._measureDataPath,e)}if(this._chartTarget.ChartType==="UI.ChartType/Pie"){return p.getHarveyMicroChartAggregations(this._dataPoint,e)}if(this._chartTarget.ChartType==="UI.ChartType/Bar"){return p.getComparisonMicroChartAggregations(this._dataPoint,e,this._chartTarget)}if(this._chartTarget.ChartType==="UI.ChartType/Area"){return p.getAreaMicroChartAggregations(this._chartTarget,this._microChartDataModelObjectPath,this._targetNavigationPath,this.showOnlyChart)}if(this._chartTarget.ChartType==="UI.ChartType/Column"){return p.getColumnMicroChartAggregations(this._dataPoint,e,this.showOnlyChart)}if(this._chartTarget.ChartType==="UI.ChartType/Line"){if(this._microChartDataModelObjectPath&&this._targetNavigationPath){return p.getLineMicroChartAggragations(this._microChartDataModelObjectPath,this._chartTarget,this._targetNavigationPath)}}return};a.createMicroChartId=function t(e){let a;switch(e){case"UI.ChartType/Bullet":a="BulletMicroChart";break;case"UI.ChartType/Donut":a="RadialMicroChart";break;case"UI.ChartType/Pie":a="HarveyBallMicroChart";break;case"UI.ChartType/BarStacked":a="StackedBarMicroChart";break;case"UI.ChartType/Area":a="AreaMicroChart";break;case"UI.ChartType/Column":a="ColumnMicroChart";break;case"UI.ChartType/Bar":a="ComparisonMicroChart";break;case"UI.ChartType/Line":a="LineMicroChart";break}return this.createId(a)};a.getMicroChartContainerProperties=function t(){const e={chartTitle:this.title||this._chartTarget.Title?.valueOf()||undefined};e.showOnlyChart=this.showOnlyChart;e.chartTitle=this._chartTarget.Title||undefined;e.chartDescription=this.description||this._chartTarget.Description?.valueOf()||undefined;this._binding=p.getBindingExpressionForMicrochart(this._chartTarget.ChartType,this._measureDataPath,this,this._targetNavigationPath?.getObject(),this._targetNavigationPath?.getObject("@sapui.name"));e.uomPath=p.getUOMPathForMicrochart(this.showOnlyChart,this._measureDataPath,this._chartTarget.ChartType);e.id=this.createMicroChartId(this._chartTarget.ChartType);const a=["UI.ChartType/Bullet","UI.ChartType/Pie","UI.ChartType/Radial"];if(a.includes(this._chartTarget.ChartType)){e.visible=bt(ut(gt(pt(this._chartTarget.Measures[0].$target?.annotations.UI?.Hidden),dt(true),dt(false))))}else{e.visible=undefined}if(this._chartTarget.ChartType==="UI.ChartType/BarStacked"){e.dataPointQualifiers=p.getDataPointQualifiersForMicroChart(this._chartTarget?.MeasureAttributes[0]?.DataPoint?.value)}if(this._chartTarget.ChartType==="UI.ChartType/Area"||this._chartTarget.ChartType==="UI.ChartType/Column"){e.dataPointQualifiers=p.getDataPointQualifiersForMicroChart(this._chartTarget?.MeasureAttributes[0]?.DataPoint?.value);e.measures=[this._measureDataPath?.targetObject?.name]}if(this._chartTarget.ChartType==="UI.ChartType/Line"){e.measures=p.getMeasurePropertyPaths(this._chartTarget,this._microChartDataModelObjectPath?.targetEntityType.annotations,"Line",true);e.dataPointQualifiers=p.getDataPointQualifiersForMeasures(this._chartTarget,this._microChartDataModelObjectPath?.targetEntityType.annotations,"Line",true)}if(this._chartTarget.ChartType==="UI.ChartType/Area"||this._chartTarget.ChartType==="UI.ChartType/Column"||this._chartTarget.ChartType==="UI.ChartType/Line"){const t=it(this._microChartDataModelObjectPath,this._chartTarget.Dimensions[0].value);e.dimension=t?.targetObject?.annotations?.Common?.Text?t?.targetObject?.annotations?.Common?.Text?.path:t?.targetObject?.name;e.measurePrecision=this._dataPoint?.Value?.$target?.precision;e.measureScale=p.getMeasureScaleForMicroChart(this._dataPoint);e.dimensionPrecision=t?.targetObject?.precision;e.calendarPattern=p.getCalendarPattern(t?.targetObject?.type,t?.targetObject?.annotations,true)}return e};a.createTitle=function t(e){if(e){const t=r.generate(["fe","MicroChartLink",this._targetNavigationPath?.getObject("@sapui.name"),this._microChartDataModelObjectPath?.targetObject?.term,this._microChartDataModelObjectPath?.targetObject?.qualifier]);const a=this.getPageController()?.getView().getId();const i=`${a}--${t}`;const n={id:i,text:e};const o=s.getResourceBundleFor("sap.fe.macros");if(this.navigationType==="InPage"){const t=o?.getText("T_COMMON_HEADERDP_TITLE_LINK_INPAGE_ARIA");n.showAsLink=true;n.linkAriaText=t}else if(this.navigationType==="External"){const e=c.getHeaderDataPointLinkVisibility(t,true);const a=o?.getText("M_MICROCHART_TITLE_FRAGMENT_HEADER_MICROCHART_LINK_ARIA");n.showAsLink=e;n.linkAriaText=a}return C(u,{...n,linkPress:t=>{this.fireEvent("titlePress",t)}})}};a.createContent=function t(){const e=["UI.ChartType/Bullet","UI.ChartType/Donut","UI.ChartType/Pie","UI.ChartType/BarStacked","UI.ChartType/Area","UI.ChartType/Column","UI.ChartType/Bar","UI.ChartType/Line"].includes(this._chartTarget.ChartType);if(!e){return C(h,{text:"This chart type is not supported. Other Types yet to be implemented.."})}else if(this.isAnalytics){return C(l,{condition:bt(lt(ut(ct("@$ui5.node.isExpanded")),Ct(ct("@$ui5.node.level"),0))),visible:at(this._dataPoint.Value.$target),children:{contentTrue:this.createChartContent(),contentFalse:C(h,{text:"*"})}})}else{return this.createChartContent()}};a.createChartContent=function t(){const e={...this.getMicroChartContainerProperties(),binding:this._binding};return C(g,{...e,children:{microChartTitle:!this.showOnlyChart?this.createTitle(e.chartTitle):undefined}})};return e}(a),N=_t(z.prototype,"showOnlyChart",[b],{configurable:true,enumerable:true,writable:true,initializer:function(){return false}}),E=_t(z.prototype,"metaPath",[y],{configurable:true,enumerable:true,writable:true,initializer:null}),L=_t(z.prototype,"contextPath",[T],{configurable:true,enumerable:true,writable:true,initializer:null}),S=_t(z.prototype,"navigationType",[m],{configurable:true,enumerable:true,writable:true,initializer:function(){return Pt.None}}),F=_t(z.prototype,"batchGroupId",[_],{configurable:true,enumerable:true,writable:true,initializer:null}),R=_t(z.prototype,"size",[f],{configurable:true,enumerable:true,writable:true,initializer:null}),V=_t(z.prototype,"hideOnNoData",[P],{configurable:true,enumerable:true,writable:true,initializer:function(){return false}}),H=_t(z.prototype,"title",[M],{configurable:true,enumerable:true,writable:true,initializer:function(){return""}}),$=_t(z.prototype,"description",[O],{configurable:true,enumerable:true,writable:true,initializer:function(){return""}}),Q=_t(z.prototype,"titlePress",[v],{configurable:true,enumerable:true,writable:true,initializer:null}),W=_t(z.prototype,"_chartTarget",[I],{configurable:true,enumerable:true,writable:true,initializer:null}),q=_t(z.prototype,"_dataPoint",[j],{configurable:true,enumerable:true,writable:true,initializer:null}),G=_t(z.prototype,"_targetNavigationPath",[D],{configurable:true,enumerable:true,writable:true,initializer:null}),K=_t(z.prototype,"_microChartDataModelObjectPath",[U],{configurable:true,enumerable:true,writable:true,initializer:null}),J=_t(z.prototype,"_binding",[A],{configurable:true,enumerable:true,writable:true,initializer:null}),X=_t(z.prototype,"_sortOrder",[w],{configurable:true,enumerable:true,writable:true,initializer:null}),Y=_t(z.prototype,"_measureDataPath",[k],{configurable:true,enumerable:true,writable:true,initializer:null}),Z=_t(z.prototype,"isAnalytics",[B],{configurable:true,enumerable:true,writable:true,initializer:null}),z))||x);et=Mt;return et},false);
//# sourceMappingURL=MicroChart.js.map