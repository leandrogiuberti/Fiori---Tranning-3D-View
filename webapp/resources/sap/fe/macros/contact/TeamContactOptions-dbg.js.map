{"version":3,"names":["TeamContactOptions","_dec","defineUI5Class","_dec2","property","type","_class","_class2","_BuildingBlock","properties","others","_this","call","_initializerDefineProperty","_descriptor","visible","contactOptions","_exports","_inheritsLoose","_proto","prototype","retrieveContactOptions","appComponent","getAppComponent","getCollaborativeToolsService","getTeamContactOptions","setMail","mail","setVisible","onMetadataAvailable","content","createContent","getContactOptionButton","contactOptionDef","button","_jsx","Button","icon","class","customData","CustomData","key","value","press","event","data","callBackHandler","FESRHelper","setSemanticStepname","fesrStepName","length","toolbar","Toolbar","width","formattedText","FormattedText","textAlign","msTeamsText","Library","getResourceBundleFor","getText","setHtmlText","addContent","ToolbarSpacer","forEach","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["TeamContactOptions.tsx"],"sourcesContent":["import { defineUI5Class, property, type PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport Button from \"sap/m/Button\";\nimport FormattedText from \"sap/m/FormattedText\";\nimport Toolbar from \"sap/m/Toolbar\";\nimport ToolbarSpacer from \"sap/m/ToolbarSpacer\";\nimport type { ContactOption as TeamsContactOption } from \"sap/suite/ui/commons/collaboration/TeamsHelperService\";\nimport type Event from \"sap/ui/base/Event\";\nimport type { $ControlSettings } from \"sap/ui/core/Control\";\nimport CustomData from \"sap/ui/core/CustomData\";\nimport Library from \"sap/ui/core/Lib\";\nimport FESRHelper from \"sap/ui/performance/trace/FESRHelper\";\n\n@defineUI5Class(\"sap.fe.macros.contact.TeamContactOptions\")\nexport default class TeamContactOptions extends BuildingBlock<Toolbar> {\n\t@property({ type: \"string\" })\n\tmail: string | undefined;\n\n\tvisible = false;\n\n\tcontactOptions: TeamsContactOption[] | undefined = [];\n\n\tconstructor(properties: $ControlSettings & PropertiesOf<TeamContactOptions>, others?: $ControlSettings) {\n\t\tsuper(properties, others);\n\t}\n\n\t/**\n\t * Retrieve the contact options from the collaborative tools service.\n\t */\n\tasync retrieveContactOptions(): Promise<void> {\n\t\tconst appComponent = this.getAppComponent();\n\t\tif (appComponent) {\n\t\t\tthis.contactOptions = await appComponent.getCollaborativeToolsService().getTeamContactOptions();\n\t\t}\n\t}\n\n\t/**\n\t * Setter for the mail that handles the visibility of the control.\n\t * @param mail\n\t */\n\tsetMail(mail: string): void {\n\t\tthis.mail = mail;\n\t\tthis.visible = !!mail;\n\t\tthis.setVisible(this.visible);\n\t}\n\n\t/**\n\t * Handler for the onMetadataAvailable event.\n\t */\n\tasync onMetadataAvailable(): Promise<void> {\n\t\tif (!this.content) {\n\t\t\tawait this.retrieveContactOptions();\n\t\t\tthis.createContent();\n\t\t}\n\t}\n\n\t/**\n\t * Get the button for the contact option.\n\t * @param contactOptionDef\n\t * @returns The button control\n\t */\n\tgetContactOptionButton(contactOptionDef: TeamsContactOption): Button {\n\t\tconst button = (\n\t\t\t<Button\n\t\t\t\ticon={contactOptionDef.icon}\n\t\t\t\tclass=\"sapUiSmallMarginBegin\"\n\t\t\t\ttype=\"Transparent\"\n\t\t\t\tcustomData={[new CustomData({ key: \"type\", value: contactOptionDef.key })]}\n\t\t\t\tpress={(event: Event): void => {\n\t\t\t\t\t// we set the mail custom data just before the callback is called, to ensure we give it the right mail value\n\t\t\t\t\tbutton.data(\"email\", this.mail);\n\t\t\t\t\tcontactOptionDef.callBackHandler(event);\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\t\tFESRHelper.setSemanticStepname(button, \"press\", contactOptionDef.fesrStepName);\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Create the content.\n\t */\n\tcreateContent(): void {\n\t\tif (!this.contactOptions?.length) {\n\t\t\treturn;\n\t\t}\n\t\tconst toolbar = <Toolbar width=\"100%\" class=\"sapUiTinyMarginBottom\" />;\n\t\tconst formattedText = <FormattedText textAlign=\"Left\" />;\n\t\tconst msTeamsText = Library.getResourceBundleFor(\"sap.fe.macros\")!.getText(\"M_COMMON_MS_TEAMS_TITLE\");\n\t\tformattedText.setHtmlText(`<strong>${msTeamsText}</strong>`);\n\t\ttoolbar.addContent(formattedText);\n\t\ttoolbar.addContent(<ToolbarSpacer />);\n\t\tthis.contactOptions.forEach((contactOptionDef) => {\n\t\t\ttoolbar.addContent(this.getContactOptionButton(contactOptionDef));\n\t\t});\n\t\tthis.setVisible(this.visible);\n\t\tthis.content = toolbar;\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"TeamContactOptions-dbg.js"}