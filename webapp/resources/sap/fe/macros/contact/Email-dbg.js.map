{"version":3,"names":["Email","_dec","defineUI5Class","_dec2","property","type","isBindingInfo","_dec3","_dec4","_dec5","_dec6","_class","_class2","_BuildingBlock","properties","others","_this","call","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","visible","undefined","Object","keys","length","constant","linkEnabled","_exports","_inheritsLoose","_proto","prototype","isTeamsConnectionActive","appComponent","getAppComponent","getCollaborativeToolsService","isContactsCollaborationSupported","getMailPopoverFromMsTeamsIntegration","mail","setLinkEnabled","enabled","content","setEnabled","onMetadataAvailable","createContent","openPopover","event","preventDefault","revertToDefaultBehaviour","link","getSource","mailBBv4","getParent","popover","openBy","MLibrary","URLHelper","redirect","getValue","getText","setValue","value","setProperty","setText","_jsx","Link","text","emptyIndicatorMode","class","press","ariaLabelledBy","wrapping","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["Email.tsx"],"sourcesContent":["import { constant } from \"sap/fe/base/BindingToolkit\";\nimport { defineUI5Class, property, type PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport type { Link$PressEvent } from \"sap/m/Link\";\nimport Link from \"sap/m/Link\";\nimport type Popover from \"sap/m/Popover\";\nimport MLibrary from \"sap/m/library\";\nimport type { PropertyBindingInfo } from \"sap/ui/base/ManagedObject\";\nimport type { $ControlSettings } from \"sap/ui/core/Control\";\n\n@defineUI5Class(\"sap.fe.macros.contact.Email\")\nexport default class Email extends BuildingBlock<Link> {\n\t@property({\n\t\ttype: \"any\",\n\t\tisBindingInfo: true\n\t})\n\tvisible: PropertyBindingInfo = constant(true);\n\n\t@property({\n\t\ttype: \"any\",\n\t\tisBindingInfo: true\n\t})\n\ttext!: PropertyBindingInfo;\n\n\t@property({ type: \"boolean\" })\n\tlinkEnabled = true;\n\n\t@property({ type: \"string\" })\n\tmail!: string | undefined;\n\n\t@property({ type: \"string\" })\n\temptyIndicatorMode = \"Off\";\n\n\tconstructor(properties: $ControlSettings & PropertiesOf<Email>, others?: $ControlSettings) {\n\t\tsuper(properties, others);\n\t\tif (this.visible === undefined || (typeof this.visible === \"object\" && Object.keys(this.visible).length === 0)) {\n\t\t\tthis.visible = constant(true);\n\t\t}\n\t\tif (!this.linkEnabled) this.linkEnabled = true;\n\t}\n\n\t/**\n\t * Checks if the Teams connection is active.\n\t * @returns Boolean value\n\t */\n\tasync isTeamsConnectionActive(): Promise<boolean> {\n\t\tconst appComponent = this.getAppComponent();\n\t\tif (appComponent) {\n\t\t\treturn appComponent.getCollaborativeToolsService().isContactsCollaborationSupported();\n\t\t} else {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Get the mail Popover from the Teams integration.\n\t * @param mail\n\t * @returns Popover or undefined\n\t */\n\tgetMailPopoverFromMsTeamsIntegration(mail: string): Promise<Popover | undefined> | undefined {\n\t\tconst appComponent = this.getAppComponent();\n\t\tif (appComponent) {\n\t\t\treturn appComponent.getCollaborativeToolsService().getMailPopoverFromMsTeamsIntegration(mail);\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\t/**\n\t * Setter for the linkEnabled property.\n\t * @param enabled\n\t */\n\tsetLinkEnabled(enabled: boolean): void {\n\t\tthis.linkEnabled = enabled;\n\t\tthis.content?.setEnabled(enabled);\n\t}\n\n\t/**\n\t * Handler for the onMetadataAvailable event.\n\t */\n\tonMetadataAvailable(): void {\n\t\tif (!this.content) {\n\t\t\tif (this.visible === undefined || (typeof this.visible === \"object\" && Object.keys(this.visible).length === 0)) {\n\t\t\t\tthis.visible = constant(true);\n\t\t\t}\n\t\t\tif (!this.linkEnabled) this.linkEnabled = true;\n\t\t\tthis.content = this.createContent();\n\t\t}\n\t}\n\n\t/**\n\t * Open a popover if the Teams connection is active or a classic mail.\n\t * @param event\n\t */\n\tasync openPopover(event: Link$PressEvent): Promise<void> {\n\t\tevent.preventDefault(); // stop default behavior based on href\n\t\tlet revertToDefaultBehaviour = false;\n\t\tconst link = event.getSource();\n\t\t// \"this\" doesn't contain the Email instance corresponding to the link so we need to retrieve it in order to read the mail\n\t\tconst mailBBv4 = link.getParent() as Email;\n\n\t\t// we need to check if the teams connection is active now because at templating the teamshelper service might not have been initialized yet\n\t\tif (await this.isTeamsConnectionActive()) {\n\t\t\tif (mailBBv4.mail) {\n\t\t\t\tconst popover = await this.getMailPopoverFromMsTeamsIntegration(mailBBv4.mail);\n\t\t\t\tif (popover) {\n\t\t\t\t\tpopover.openBy(link);\n\t\t\t\t} else {\n\t\t\t\t\trevertToDefaultBehaviour = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\trevertToDefaultBehaviour = true;\n\t\t}\n\t\tif (revertToDefaultBehaviour) {\n\t\t\tMLibrary.URLHelper.redirect(`mailto:${mailBBv4.mail}`);\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves the current value of the Link.\n\t * @returns The current value of the Link\n\t */\n\tgetValue(): string | undefined {\n\t\treturn this.content?.getText();\n\t}\n\n\t/**\n\t * Sets the current value of the Link.\n\t * @param value\n\t * @returns The current Email reference\n\t */\n\tsetValue(value: string | undefined): Email {\n\t\tthis.setProperty(\"text\", value);\n\t\tthis.content?.setText(value);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Create the content.\n\t * @returns The Link\n\t */\n\tcreateContent(): Link {\n\t\treturn (\n\t\t\t<Link\n\t\t\t\tvisible={this.visible}\n\t\t\t\ttext={this.text}\n\t\t\t\tenabled={this.linkEnabled}\n\t\t\t\temptyIndicatorMode={this.emptyIndicatorMode}\n\t\t\t\tclass=\"sapMTextRenderWhitespaceWrap\"\n\t\t\t\tpress={async (event: Link$PressEvent): Promise<void> => this.openPopover(event)}\n\t\t\t\tariaLabelledBy={this.ariaLabelledBy}\n\t\t\t\twrapping={true}\n\t\t\t/>\n\t\t) as Link;\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"Email-dbg.js"}