{"version":3,"file":"TeamContactOptions.js","names":["TeamContactOptions","_dec","defineUI5Class","_dec2","property","type","_class","_class2","_BuildingBlock","properties","others","_this","call","this","_initializerDefineProperty","_descriptor","visible","contactOptions","_exports","_inheritsLoose","_proto","prototype","retrieveContactOptions","async","appComponent","getAppComponent","getCollaborativeToolsService","getTeamContactOptions","setMail","mail","setVisible","onMetadataAvailable","content","createContent","getContactOptionButton","contactOptionDef","button","_jsx","Button","icon","class","customData","CustomData","key","value","press","event","data","callBackHandler","FESRHelper","setSemanticStepname","fesrStepName","length","toolbar","Toolbar","width","formattedText","FormattedText","textAlign","msTeamsText","Library","getResourceBundleFor","getText","setHtmlText","addContent","ToolbarSpacer","forEach","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./TeamContactOptions.tsx"],"sourcesContent":["import { defineUI5Class, property, type PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport Button from \"sap/m/Button\";\nimport FormattedText from \"sap/m/FormattedText\";\nimport Toolbar from \"sap/m/Toolbar\";\nimport ToolbarSpacer from \"sap/m/ToolbarSpacer\";\nimport type { ContactOption as TeamsContactOption } from \"sap/suite/ui/commons/collaboration/TeamsHelperService\";\nimport type Event from \"sap/ui/base/Event\";\nimport type { $ControlSettings } from \"sap/ui/core/Control\";\nimport CustomData from \"sap/ui/core/CustomData\";\nimport Library from \"sap/ui/core/Lib\";\nimport FESRHelper from \"sap/ui/performance/trace/FESRHelper\";\n\n@defineUI5Class(\"sap.fe.macros.contact.TeamContactOptions\")\nexport default class TeamContactOptions extends BuildingBlock<Toolbar> {\n\t@property({ type: \"string\" })\n\tmail: string | undefined;\n\n\tvisible = false;\n\n\tcontactOptions: TeamsContactOption[] | undefined = [];\n\n\tconstructor(properties: $ControlSettings & PropertiesOf<TeamContactOptions>, others?: $ControlSettings) {\n\t\tsuper(properties, others);\n\t}\n\n\t/**\n\t * Retrieve the contact options from the collaborative tools service.\n\t */\n\tasync retrieveContactOptions(): Promise<void> {\n\t\tconst appComponent = this.getAppComponent();\n\t\tif (appComponent) {\n\t\t\tthis.contactOptions = await appComponent.getCollaborativeToolsService().getTeamContactOptions();\n\t\t}\n\t}\n\n\t/**\n\t * Setter for the mail that handles the visibility of the control.\n\t * @param mail\n\t */\n\tsetMail(mail: string): void {\n\t\tthis.mail = mail;\n\t\tthis.visible = !!mail;\n\t\tthis.setVisible(this.visible);\n\t}\n\n\t/**\n\t * Handler for the onMetadataAvailable event.\n\t */\n\tasync onMetadataAvailable(): Promise<void> {\n\t\tif (!this.content) {\n\t\t\tawait this.retrieveContactOptions();\n\t\t\tthis.createContent();\n\t\t}\n\t}\n\n\t/**\n\t * Get the button for the contact option.\n\t * @param contactOptionDef\n\t * @returns The button control\n\t */\n\tgetContactOptionButton(contactOptionDef: TeamsContactOption): Button {\n\t\tconst button = (\n\t\t\t<Button\n\t\t\t\ticon={contactOptionDef.icon}\n\t\t\t\tclass=\"sapUiSmallMarginBegin\"\n\t\t\t\ttype=\"Transparent\"\n\t\t\t\tcustomData={[new CustomData({ key: \"type\", value: contactOptionDef.key })]}\n\t\t\t\tpress={(event: Event): void => {\n\t\t\t\t\t// we set the mail custom data just before the callback is called, to ensure we give it the right mail value\n\t\t\t\t\tbutton.data(\"email\", this.mail);\n\t\t\t\t\tcontactOptionDef.callBackHandler(event);\n\t\t\t\t}}\n\t\t\t/>\n\t\t);\n\t\tFESRHelper.setSemanticStepname(button, \"press\", contactOptionDef.fesrStepName);\n\n\t\treturn button;\n\t}\n\n\t/**\n\t * Create the content.\n\t */\n\tcreateContent(): void {\n\t\tif (!this.contactOptions?.length) {\n\t\t\treturn;\n\t\t}\n\t\tconst toolbar = <Toolbar width=\"100%\" class=\"sapUiTinyMarginBottom\" />;\n\t\tconst formattedText = <FormattedText textAlign=\"Left\" />;\n\t\tconst msTeamsText = Library.getResourceBundleFor(\"sap.fe.macros\")!.getText(\"M_COMMON_MS_TEAMS_TITLE\");\n\t\tformattedText.setHtmlText(`<strong>${msTeamsText}</strong>`);\n\t\ttoolbar.addContent(formattedText);\n\t\ttoolbar.addContent(<ToolbarSpacer />);\n\t\tthis.contactOptions.forEach((contactOptionDef) => {\n\t\t\ttoolbar.addContent(this.getContactOptionButton(contactOptionDef));\n\t\t});\n\t\tthis.setVisible(this.visible);\n\t\tthis.content = toolbar;\n\t}\n}\n"],"mappings":";;;;k0CAcqBA,GAAkBC,EADtCC,EAAe,4CAA2CC,EAEzDC,EAAS,CAAEC,KAAM,WAAWJ,EAAAK,GAAAC,EAAA,SAAAC,GAO7B,SAAAR,EAAYS,EAAiEC,GAA2B,IAAAC,EACvGA,EAAAH,EAAAI,KAAAC,KAAMJ,EAAYC,IAAOG,KAACC,EAAAH,EAAA,OAAAI,EAAAJ,KAL3BK,QAAU,MAAKL,EAEfM,eAAmD,GAAE,OAAAN,CAIrD,CAEAO,EAAAlB,EAAAmB,EAAAnB,EAAAQ,GAAA,IAAAY,EAAApB,EAAAqB,UAAAD,EAGME,uBAANC,eAAMD,IACL,MAAME,EAAeX,KAAKY,kBAC1B,GAAID,EAAc,CACjBX,KAAKI,qBAAuBO,EAAaE,+BAA+BC,uBACzE,CACD,EAEAP,EAIAQ,QAAA,SAAAA,EAAQC,GACPhB,KAAKgB,KAAOA,EACZhB,KAAKG,UAAYa,EACjBhB,KAAKiB,WAAWjB,KAAKG,QACtB,EAEAI,EAGMW,oBAANR,eAAMQ,IACL,IAAKlB,KAAKmB,QAAS,OACZnB,KAAKS,yBACXT,KAAKoB,eACN,CACD,EAEAb,EAKAc,uBAAA,SAAAA,EAAuBC,GACtB,MAAMC,EACLC,EAACC,EAAM,CACNC,KAAMJ,EAAiBI,KACvBC,MAAM,wBACNnC,KAAK,cACLoC,WAAY,CAAC,IAAIC,EAAW,CAAEC,IAAK,OAAQC,MAAOT,EAAiBQ,OACnEE,MAAQC,IAEPV,EAAOW,KAAK,QAASlC,KAAKgB,MAC1BM,EAAiBa,gBAAgBF,MAIpCG,EAAWC,oBAAoBd,EAAQ,QAASD,EAAiBgB,cAEjE,OAAOf,CACR,EAEAhB,EAGAa,cAAA,SAAAA,IACC,IAAKpB,KAAKI,gBAAgBmC,OAAQ,CACjC,MACD,CACA,MAAMC,EAAUhB,EAACiB,EAAO,CAACC,MAAM,OAAOf,MAAM,0BAC5C,MAAMgB,EAAgBnB,EAACoB,EAAa,CAACC,UAAU,SAC/C,MAAMC,EAAcC,EAAQC,qBAAqB,iBAAkBC,QAAQ,2BAC3EN,EAAcO,YAAY,WAAWJ,cACrCN,EAAQW,WAAWR,GACnBH,EAAQW,WAAW3B,EAAC4B,EAAa,KACjCpD,KAAKI,eAAeiD,QAAS/B,IAC5BkB,EAAQW,WAAWnD,KAAKqB,uBAAuBC,MAEhDtB,KAAKiB,WAAWjB,KAAKG,SACrBH,KAAKmB,QAAUqB,CAChB,EAAC,OAAArD,CAAA,CAnF4B,CADkBmE,GAAapD,EAAAqD,EAAA7D,EAAAc,UAAA,QAAAlB,GAAA,CAAAkE,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAAjE,KAAAD,GAAAY,EAAAlB,EAAA,OAAAkB,CAAA","ignoreList":[]}