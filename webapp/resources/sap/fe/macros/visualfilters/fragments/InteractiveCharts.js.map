{"version":3,"file":"InteractiveCharts.js","names":["getVisualFilterChart","visualFilter","showError","getInteractiveChartWithError","chartType","getInteractiveChart","_exports","chartAnnotation","chartMeasure","Dimensions","_jsx","InteractiveLineChart","errorMessageTitle","errorMessage","interactiveChartProperties","InteractiveChartHelper","getInteractiveChartProperties","_jsxs","InteractiveBarChart","selectionChanged","event","VisualFilterRuntime","getChartProperties","children","getBarChartAggregations","customData","getCustomData","getLineChartAggregations","visualFilterChartProperties","visible","showErrorExpression","errorMessageTitleExpression","errorMessageExpression","bars","aggregationBinding","points","barChartAggregations","InteractiveBarChartBar","label","chartLabel","value","measure","displayedValue","color","selected","lineChartAggregations","InteractiveLineChartPoint","id","generate","metaPath","dimension","CustomData","outParameter","valuelistProperty","multipleSelectionAllowed","$target","name","isPathAnnotationExpression","annotations","Common","Text","path","undefined","scalefactor","uom","inParameters","inParameterFilters","type","selectionVariant","required","showOverlayInitially","requiredProperties","stringifiedParameters","draftSupported"],"sources":["./InteractiveCharts.tsx"],"sourcesContent":["import { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport { isPathAnnotationExpression } from \"sap/fe/core/helpers/TypeGuards\";\nimport InteractiveBarChart, { InteractiveBarChart$SelectionChangedEvent, type $InteractiveBarChartSettings } from \"sap/suite/ui/microchart/InteractiveBarChart\";\nimport InteractiveBarChartBar from \"sap/suite/ui/microchart/InteractiveBarChartBar\";\nimport InteractiveLineChart, { InteractiveLineChart$SelectionChangedEvent, type $InteractiveLineChartSettings } from \"sap/suite/ui/microchart/InteractiveLineChart\";\nimport InteractiveLineChartPoint, { type $InteractiveLineChartPointSettings } from \"sap/suite/ui/microchart/InteractiveLineChartPoint\";\nimport { AggregationBindingInfo } from \"sap/ui/base/ManagedObject\";\nimport CustomData from \"sap/ui/core/CustomData\";\nimport InteractiveChartHelper, { type InteractiveChartType } from \"../InteractiveChartHelper\";\nimport type VisualFilter from \"../VisualFilter\";\nimport VisualFilterRuntime from \"../VisualFilterRuntime\";\n\ntype visualFilterChartAggregations = Pick<$InteractiveBarChartSettings, \"bars\"> | Pick<$InteractiveLineChartSettings, \"points\">;\n\nexport function getVisualFilterChart(visualFilter: VisualFilter): string {\n\tif (visualFilter.showError) {\n\t\treturn getInteractiveChartWithError(visualFilter);\n\t} else if (visualFilter.chartType) {\n\t\treturn getInteractiveChart(visualFilter);\n\t} else {\n\t\treturn \"\";\n\t}\n}\n\nexport function getInteractiveChartWithError(visualFilter: VisualFilter): string {\n\tconst chartAnnotation = visualFilter.chartAnnotation;\n\tif (visualFilter.chartMeasure && chartAnnotation?.Dimensions && chartAnnotation.Dimensions[0]) {\n\t\treturn (\n\t\t\t<InteractiveLineChart\n\t\t\t\tshowError={visualFilter.showError}\n\t\t\t\terrorMessageTitle={visualFilter.errorMessageTitle}\n\t\t\t\terrorMessage={visualFilter.errorMessage}\n\t\t\t/>\n\t\t);\n\t}\n\treturn \"\";\n}\n\nexport function getInteractiveChart(visualFilter: VisualFilter): string {\n\tconst interactiveChartProperties = InteractiveChartHelper.getInteractiveChartProperties(visualFilter);\n\tif (visualFilter.chartType === \"UI.ChartType/Bar\") {\n\t\treturn (\n\t\t\t<InteractiveBarChart\n\t\t\t\tselectionChanged={(event: InteractiveBarChart$SelectionChangedEvent): void => {\n\t\t\t\t\tVisualFilterRuntime.selectionChanged(event);\n\t\t\t\t}}\n\t\t\t\t{...getChartProperties(interactiveChartProperties, visualFilter)}\n\t\t\t>\n\t\t\t\t{getBarChartAggregations(interactiveChartProperties)}\n\t\t\t\t{{\n\t\t\t\t\tcustomData: getCustomData(visualFilter, interactiveChartProperties)\n\t\t\t\t}}\n\t\t\t</InteractiveBarChart>\n\t\t);\n\t} else if (visualFilter.chartType === \"UI.ChartType/Line\") {\n\t\treturn (\n\t\t\t<InteractiveLineChart\n\t\t\t\tselectionChanged={(event: InteractiveLineChart$SelectionChangedEvent): void => {\n\t\t\t\t\tVisualFilterRuntime.selectionChanged(event);\n\t\t\t\t}}\n\t\t\t\t{...getChartProperties(interactiveChartProperties, visualFilter)}\n\t\t\t>\n\t\t\t\t{getLineChartAggregations(interactiveChartProperties)}\n\t\t\t\t{{\n\t\t\t\t\tcustomData: getCustomData(visualFilter, interactiveChartProperties)\n\t\t\t\t}}\n\t\t\t</InteractiveLineChart>\n\t\t);\n\t}\n\treturn \"\";\n}\n\nfunction getChartProperties(\n\tinteractiveChartProperties: InteractiveChartType,\n\tvisualFilter: VisualFilter\n): Partial<PropertiesOf<$InteractiveBarChartSettings | $InteractiveLineChartPointSettings>> | undefined {\n\tconst visualFilterChartProperties: $InteractiveBarChartSettings | $InteractiveLineChartPointSettings = {\n\t\tvisible: interactiveChartProperties.showErrorExpression,\n\t\tshowError: interactiveChartProperties.showErrorExpression,\n\t\terrorMessageTitle: interactiveChartProperties.errorMessageTitleExpression,\n\t\terrorMessage: interactiveChartProperties.errorMessageExpression\n\t};\n\tif (visualFilter.chartType === \"UI.ChartType/Bar\") {\n\t\tvisualFilterChartProperties.bars = interactiveChartProperties.aggregationBinding as unknown as AggregationBindingInfo;\n\t} else if (visualFilter.chartType === \"UI.ChartType/Line\") {\n\t\t(visualFilterChartProperties as $InteractiveLineChartSettings).points =\n\t\t\tinteractiveChartProperties.aggregationBinding as unknown as AggregationBindingInfo;\n\t}\n\treturn visualFilterChartProperties;\n}\n\nfunction getBarChartAggregations(interactiveChartProperties: InteractiveChartType): visualFilterChartAggregations {\n\tconst barChartAggregations = {};\n\t(barChartAggregations as $InteractiveBarChartSettings).bars = (\n\t\t<InteractiveBarChartBar\n\t\t\tlabel={interactiveChartProperties.chartLabel}\n\t\t\tvalue={interactiveChartProperties.measure}\n\t\t\tdisplayedValue={interactiveChartProperties.displayedValue}\n\t\t\tcolor={interactiveChartProperties.color}\n\t\t\tselected=\"{path: '$field>/conditions', formatter: 'sap.fe.macros.visualfilters.VisualFilterRuntime.getAggregationSelected'}\"\n\t\t/>\n\t);\n\treturn barChartAggregations;\n}\n\nfunction getLineChartAggregations(interactiveChartProperties: InteractiveChartType): visualFilterChartAggregations {\n\tconst lineChartAggregations = {};\n\t(lineChartAggregations as $InteractiveLineChartSettings).points = (\n\t\t<InteractiveLineChartPoint\n\t\t\tlabel={interactiveChartProperties.chartLabel}\n\t\t\tvalue={interactiveChartProperties.measure}\n\t\t\tdisplayedValue={interactiveChartProperties.displayedValue}\n\t\t\tcolor={interactiveChartProperties.color}\n\t\t\tselected=\"{path: '$field>/conditions', formatter: 'sap.fe.macros.visualfilters.VisualFilterRuntime.getAggregationSelected'}\"\n\t\t/>\n\t);\n\treturn lineChartAggregations;\n}\n\nfunction getCustomData(visualFilter: VisualFilter, interactiveChartProperties: InteractiveChartType): CustomData[] {\n\tconst id = generate([visualFilter.metaPath]);\n\tconst dimension = visualFilter.chartAnnotation?.Dimensions[0];\n\treturn [\n\t\t<CustomData key={\"outParameter\"} value={visualFilter.outParameter} />,\n\t\t<CustomData key={\"valuelistProperty\"} value={visualFilter.valuelistProperty} />,\n\t\t<CustomData key={\"multipleSelectionAllowed\"} value={visualFilter.multipleSelectionAllowed} />,\n\t\t<CustomData key={\"dimension\"} value={dimension?.$target?.name} />,\n\t\t<CustomData\n\t\t\tkey={\"dimensionText\"}\n\t\t\tvalue={\n\t\t\t\tisPathAnnotationExpression(dimension?.$target?.annotations.Common?.Text)\n\t\t\t\t\t? dimension?.$target?.annotations.Common?.Text.path\n\t\t\t\t\t: undefined\n\t\t\t}\n\t\t/>,\n\t\t<CustomData key={\"scalefactor\"} value={interactiveChartProperties.scalefactor} />,\n\t\t<CustomData key={\"measure\"} value={visualFilter.chartMeasure} />,\n\t\t<CustomData key={\"uom\"} value={interactiveChartProperties.uom} />,\n\t\t<CustomData key={\"inParameters\"} value={interactiveChartProperties.inParameters} />,\n\t\t<CustomData key={\"inParameterFilters\"} value={interactiveChartProperties.inParameterFilters} />,\n\t\t<CustomData key={\"dimensionType\"} value={dimension?.$target?.type} />,\n\t\t<CustomData key={\"selectionVariantAnnotation\"} value={interactiveChartProperties.selectionVariant} />,\n\t\t<CustomData key={\"required\"} value={visualFilter.required} />,\n\t\t<CustomData key={\"showOverlayInitially\"} value={visualFilter.showOverlayInitially} />,\n\t\t<CustomData key={\"requiredProperties\"} value={visualFilter.requiredProperties} />,\n\t\t<CustomData key={\"infoPath\"} value={id} />,\n\t\t<CustomData key={\"parameters\"} value={interactiveChartProperties.stringifiedParameters} />,\n\t\t<CustomData key={\"draftSupported\"} value={visualFilter.draftSupported} />\n\t];\n}\n"],"mappings":"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","ignoreList":[]}