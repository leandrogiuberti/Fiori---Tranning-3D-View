{"version":3,"names":["ALPTableDelegate","Object","assign","TableDelegate","apiVersion","_internalUpdateBindingInfo","table","bindingInfo","filterInfo","chartFilters","_computeRowBindingInfoFromTemplate","getRowBinding","suspended","view","CommonUtils","getTargetView","mdcChart","getController","getChartControl","chartAPI","getParent","chartSelectionsExist","hasSelections","tableFilterInfo","TableUtils","getAllFilterInfo","tableFilters","filters","chartFilterInfo","ChartUtils","forEach","element","getPath","sPath","getChartPropertiesWithoutPrefixes","finalFilters","concat","oFilter","length","Filter","and","bindingPath","path","updateBindingInfoWithSearchQuery","addFilterOnActiveEntities","rebind","internalModelContext","getBindingContext","templateContentView","getProperty"],"sourceRoot":".","sources":["ALPTableDelegate.ts"],"sourcesContent":["import CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type Chart from \"sap/fe/macros/Chart\";\nimport ChartUtils from \"sap/fe/macros/chart/ChartUtils\";\nimport TableUtils from \"sap/fe/macros/table/Utils\";\nimport TableDelegate from \"sap/fe/macros/table/delegates/TableDelegate\";\nimport type ListReportController from \"sap/fe/templates/ListReport/ListReportController.controller\";\nimport type { BaseAggregationBindingInfo, BasePropertyInfo } from \"sap/ui/base/ManagedObject\";\nimport type MDCChart from \"sap/ui/mdc/Chart\";\nimport type Table from \"sap/ui/mdc/Table\";\nimport Filter from \"sap/ui/model/Filter\";\n/**\n * Helper class for sap.ui.mdc.Table.\n * <h3><b>Note:</b></h3>\n * The class is experimental and the API/behaviour is not finalised and hence this should not be used for productive usage.\n * @author SAP SE\n * @private\n * @since 1.69.0\n * @alias sap.fe.macros.ALPTableDelegate\n */\nconst ALPTableDelegate = Object.assign({}, TableDelegate, {\n\tapiVersion: 2,\n\t_internalUpdateBindingInfo: function (table: Table, bindingInfo: BasePropertyInfo) {\n\t\tlet filterInfo;\n\t\tlet chartFilters;\n\n\t\t// We need to deepClone the info we get from the custom data, otherwise some of its subobjects (e.g. parameters) will\n\t\t// be shared with oBindingInfo and modified later (Object.assign only does a shallow clone)\n\t\tObject.assign(bindingInfo, TableDelegate._computeRowBindingInfoFromTemplate(table));\n\t\tif (table.getRowBinding()) {\n\t\t\tbindingInfo.suspended = false;\n\t\t}\n\t\tconst view = CommonUtils.getTargetView(table);\n\t\tconst mdcChart = (view.getController() as ListReportController).getChartControl?.() as MDCChart;\n\t\tconst chartAPI = mdcChart?.getParent() as Chart;\n\t\tconst chartSelectionsExist = chartAPI?.hasSelections();\n\t\tconst tableFilterInfo = TableUtils.getAllFilterInfo(table);\n\t\tconst tableFilters = tableFilterInfo && tableFilterInfo.filters;\n\t\tfilterInfo = tableFilterInfo;\n\t\tif (chartSelectionsExist) {\n\t\t\tconst chartFilterInfo = ChartUtils.getAllFilterInfo(mdcChart);\n\t\t\tif (chartFilterInfo && chartFilterInfo.filters) {\n\t\t\t\tchartFilterInfo.filters.forEach((element: Filter) => {\n\t\t\t\t\tif (element.getPath()) {\n\t\t\t\t\t\t(element as { sPath?: string }).sPath = chartAPI.getChartPropertiesWithoutPrefixes(element.getPath()!);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tchartFilters = chartFilterInfo?.filters ?? null;\n\t\t\tfilterInfo = chartFilterInfo;\n\t\t}\n\t\tconst finalFilters = (tableFilters && chartFilters ? tableFilters.concat(chartFilters) : chartFilters || tableFilters) || [];\n\t\tconst oFilter =\n\t\t\tfinalFilters.length > 0\n\t\t\t\t? new Filter({\n\t\t\t\t\t\tfilters: finalFilters,\n\t\t\t\t\t\tand: true\n\t\t\t\t  })\n\t\t\t\t: null;\n\n\t\tif (filterInfo.bindingPath) {\n\t\t\t// In case of parameters\n\t\t\tbindingInfo.path = filterInfo.bindingPath;\n\t\t}\n\n\t\t// Prepare binding info with filter/search parameters\n\t\tALPTableDelegate.updateBindingInfoWithSearchQuery(bindingInfo, filterInfo, oFilter);\n\n\t\tTableDelegate.addFilterOnActiveEntities(table, bindingInfo);\n\t},\n\trebind: function (table: Table, bindingInfo: BaseAggregationBindingInfo) {\n\t\tconst internalModelContext = table.getBindingContext(\"pageInternal\");\n\t\tconst templateContentView = internalModelContext?.getProperty(`${internalModelContext.getPath()}/alpContentView`);\n\t\tif (templateContentView !== \"Chart\") {\n\t\t\tTableDelegate.rebind(table, bindingInfo);\n\t\t}\n\t}\n});\n\nexport default ALPTableDelegate;\n"],"mappings":";;;;;;;EAUA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;EACA,MAAMA,gBAAgB,GAAGC,MAAM,CAACC,MAAM,CAAC,CAAC,CAAC,EAAEC,aAAa,EAAE;IACzDC,UAAU,EAAE,CAAC;IACbC,0BAA0B,EAAE,SAAAA,CAAUC,KAAY,EAAEC,WAA6B,EAAE;MAClF,IAAIC,UAAU;MACd,IAAIC,YAAY;;MAEhB;MACA;MACAR,MAAM,CAACC,MAAM,CAACK,WAAW,EAAEJ,aAAa,CAACO,kCAAkC,CAACJ,KAAK,CAAC,CAAC;MACnF,IAAIA,KAAK,CAACK,aAAa,CAAC,CAAC,EAAE;QAC1BJ,WAAW,CAACK,SAAS,GAAG,KAAK;MAC9B;MACA,MAAMC,IAAI,GAAGC,WAAW,CAACC,aAAa,CAACT,KAAK,CAAC;MAC7C,MAAMU,QAAQ,GAAIH,IAAI,CAACI,aAAa,CAAC,CAAC,CAA0BC,eAAe,GAAG,CAAa;MAC/F,MAAMC,QAAQ,GAAGH,QAAQ,EAAEI,SAAS,CAAC,CAAU;MAC/C,MAAMC,oBAAoB,GAAGF,QAAQ,EAAEG,aAAa,CAAC,CAAC;MACtD,MAAMC,eAAe,GAAGC,UAAU,CAACC,gBAAgB,CAACnB,KAAK,CAAC;MAC1D,MAAMoB,YAAY,GAAGH,eAAe,IAAIA,eAAe,CAACI,OAAO;MAC/DnB,UAAU,GAAGe,eAAe;MAC5B,IAAIF,oBAAoB,EAAE;QACzB,MAAMO,eAAe,GAAGC,UAAU,CAACJ,gBAAgB,CAACT,QAAQ,CAAC;QAC7D,IAAIY,eAAe,IAAIA,eAAe,CAACD,OAAO,EAAE;UAC/CC,eAAe,CAACD,OAAO,CAACG,OAAO,CAAEC,OAAe,IAAK;YACpD,IAAIA,OAAO,CAACC,OAAO,CAAC,CAAC,EAAE;cACrBD,OAAO,CAAwBE,KAAK,GAAGd,QAAQ,CAACe,iCAAiC,CAACH,OAAO,CAACC,OAAO,CAAC,CAAE,CAAC;YACvG;UACD,CAAC,CAAC;QACH;QACAvB,YAAY,GAAGmB,eAAe,EAAED,OAAO,IAAI,IAAI;QAC/CnB,UAAU,GAAGoB,eAAe;MAC7B;MACA,MAAMO,YAAY,GAAG,CAACT,YAAY,IAAIjB,YAAY,GAAGiB,YAAY,CAACU,MAAM,CAAC3B,YAAY,CAAC,GAAGA,YAAY,IAAIiB,YAAY,KAAK,EAAE;MAC5H,MAAMW,OAAO,GACZF,YAAY,CAACG,MAAM,GAAG,CAAC,GACpB,IAAIC,MAAM,CAAC;QACXZ,OAAO,EAAEQ,YAAY;QACrBK,GAAG,EAAE;MACL,CAAC,CAAC,GACF,IAAI;MAER,IAAIhC,UAAU,CAACiC,WAAW,EAAE;QAC3B;QACAlC,WAAW,CAACmC,IAAI,GAAGlC,UAAU,CAACiC,WAAW;MAC1C;;MAEA;MACAzC,gBAAgB,CAAC2C,gCAAgC,CAACpC,WAAW,EAAEC,UAAU,EAAE6B,OAAO,CAAC;MAEnFlC,aAAa,CAACyC,yBAAyB,CAACtC,KAAK,EAAEC,WAAW,CAAC;IAC5D,CAAC;IACDsC,MAAM,EAAE,SAAAA,CAAUvC,KAAY,EAAEC,WAAuC,EAAE;MACxE,MAAMuC,oBAAoB,GAAGxC,KAAK,CAACyC,iBAAiB,CAAC,cAAc,CAAC;MACpE,MAAMC,mBAAmB,GAAGF,oBAAoB,EAAEG,WAAW,CAAC,GAAGH,oBAAoB,CAACd,OAAO,CAAC,CAAC,iBAAiB,CAAC;MACjH,IAAIgB,mBAAmB,KAAK,OAAO,EAAE;QACpC7C,aAAa,CAAC0C,MAAM,CAACvC,KAAK,EAAEC,WAAW,CAAC;MACzC;IACD;EACD,CAAC,CAAC;EAAC,OAEYP,gBAAgB;AAAA","ignoreList":[],"file":"ALPTableDelegate-dbg.js"}