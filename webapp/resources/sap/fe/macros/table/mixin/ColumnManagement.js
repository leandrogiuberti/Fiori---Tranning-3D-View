/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/converters/MetaModelConverter","sap/fe/core/helpers/ResourceModelHelper","sap/fe/core/helpers/StandardRecommendationHelper","sap/fe/core/templating/DataFieldFormatters"],function(e,i,t,n,s){"use strict";var l={};var o=s.generateVisibleExpression;var c=n.standardRecommendationHelper;var a=t.getResourceModel;var r=i.getInvolvedDataModelObjectEntityKeys;var u=e.compileExpression;let f=function(){function e(){}l=e;var i=e.prototype;i.setupMixin=function e(i){};i.getPropertyUIHiddenCache=function e(){if(this.propertyUIHiddenCache===undefined){this.propertyUIHiddenCache={}}return this.propertyUIHiddenCache};i.getDynamicVisibilityForColumns=function e(){if(this.dynamicVisibilityForColumns===undefined){this.dynamicVisibilityForColumns=[]}return this.dynamicVisibilityForColumns};i.checkIfColumnExists=function e(i,t){return i.some(function(e){if(e?.columnName===t&&e?.sColumnNameVisible||e?.sTextArrangement!==undefined&&e?.sTextArrangement===t){return t}})};i.getTableIdentifierColumnInfo=function e(){const i=this.getContent();const t=this.getTableDefinition().headerInfoTitle;const n=i&&i.getModel()?.getMetaModel(),s=i.data("metaPath");const l=n.getObject(`${s}/$Type/$Key`);const o=[];if(l&&l.length>0){l.forEach(function(e){if(e!=="IsActiveEntity"){o.push(e)}})}const c=this.getTableDefinition().semanticKeys;const a=[];const r=[];const u=i.getColumns();u.forEach(function(e){const i=e?.getPropertyKey?.();if(i){a.push(i)}});a.forEach(function(e){const i=n.getObject(`${s}/$Type/${e}@`);const t=i&&i["@com.sap.vocabularies.Common.v1.Text"]?.$Path;const l=i&&i["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"]?.$EnumMember;r.push({columnName:e,sTextArrangement:t,sColumnNameVisible:!(l==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly")})});return{headerInfoTitlePath:t,filteredTechnicalKeys:o,semanticKeyColumns:c,aFilteredColummns:r}};i.getIdentifierColumn=function e(i){const{headerInfoTitlePath:t,filteredTechnicalKeys:n,semanticKeyColumns:s,aFilteredColummns:l}=this.getTableIdentifierColumnInfo();let o;if(i){const e=c.getCurrentRootContext();const i=r(e);if(s.length>0){o=s.filter(e=>!i.semanticKeys.includes(e))}else if(n.length>0){o=n.filter(e=>!i.technicalKeys.includes(e))}return o}if(t!==undefined&&this.checkIfColumnExists(l,t)){o=t}else if(s!==undefined&&s.length===1&&this.checkIfColumnExists(l,s[0])){o=s[0]}else if(n.length===1&&this.checkIfColumnExists(l,n[0])){o=n[0]}return o};i.computeColumnValue=function e(i,t,n,s){const l=t.getObject(i);let o;let c=l;if(n){if(i.lastIndexOf("/")>0){i=i.slice(0,i.lastIndexOf("/")+1);i=i.concat(n)}else{i=n}o=t.getObject(i);if(o){if(s){const e=s.slice(s.indexOf("/")+1);switch(e){case"TextOnly":c=o;break;case"TextFirst":c=`${o} (${l})`;break;case"TextLast":c=`${l} (${o})`;break;case"TextSeparate":c=l;break;default:}}else{c=`${o} (${l})`}}}return c};i.getTableColValue=function e(i,t,n,s){const l=a(this.getContent());let o="";const[{key:c,visibility:r}]=s;const u=this.getKeyColumnInfo(c)?.label;const f=this.computeColumnValue(c,i,t,n);o=r?`${u}: ${f}`:`${u} (${l.getText("T_COLUMN_INDICATOR_IN_TABLE_DEFINITION")}): ${f}`;return o};i.getKeyColumnInfo=function e(i){return this.getTableDefinition().columns.find(function(e){return e.key.split("::").pop()===i})};i.isColumnValueVisible=function e(i,t){let n;if(!this.getPropertyUIHiddenCache()[i]){const e=this.getDataModelAndConvertedTargetObject(i)?.dataModelPath;if(!e){return false}const s=u(o(e));n=this.createAnyControl(s,t);this.getPropertyUIHiddenCache()[i]=n;n.setBindingContext(null);this.addDependent(n)}else{n=this.getPropertyUIHiddenCache()[i]}n.setBindingContext(t);const s=n.getAny();n.setBindingContext(null);return s};i.checkColumnValueVisible=function e(i,t){const n=Array.isArray(i)?i:[i];const s=[];for(const e of n){const i=this.isColumnValueVisible(e,t);if(i==="true"||i===true){s.push(e)}}if(s.length>0){return s}};i.checkVisibility=function e(i,t){const n=t.find(e=>e.columnName===i);if(n){return{visibility:n.sColumnNameVisible}}return{visibility:false}};i.getTableColumnVisibilityInfo=function e(i){const{headerInfoTitlePath:t,filteredTechnicalKeys:n,semanticKeyColumns:s,aFilteredColummns:l}=this.getTableIdentifierColumnInfo();const o=[];if(t!==undefined&&this.checkColumnValueVisible(t,i)){const{visibility:e}=this.checkVisibility(t,l);o.push({key:t,visibility:e})}else if(s!==undefined&&s.length===1&&this.checkColumnValueVisible(s[0],i)){const{visibility:e}=this.checkVisibility(s[0],l);o.push({key:s[0],visibility:e})}else if(n.length===1&&this.checkColumnValueVisible(n[0],i)){const{visibility:e}=this.checkVisibility(n[0],l);o.push({key:n[0],visibility:e})}else if(s!==undefined&&s.length>0&&this.checkColumnValueVisible(s,i)){const e=this.checkColumnValueVisible(s,i);if(e){for(const i of e){const{visibility:e}=this.checkVisibility(i,l);o.push({key:i,visibility:e})}}}else if(n.length>0&&this.checkColumnValueVisible(n,i)){const e=this.checkColumnValueVisible(n,i);if(e){for(const i of e){const{visibility:e}=this.checkVisibility(i,l);o.push({key:i,visibility:e})}}}return o};i.modifyDynamicVisibilityForColumn=function e(i,t){const n=this.getDynamicVisibilityForColumns().find(e=>e.columnKey===i);if(n){n.visible=t}else{this.getDynamicVisibilityForColumns().push({columnKey:i,visible:t})}};i.updateColumnsVisibility=function i(t,n){e.updateColumnsVisibilityStatic(t,this.getDynamicVisibilityForColumns(),n)};e.updateColumnsVisibilityStatic=function e(i,t,n){if(!i&&!t.length){return}const s=i?i.split(",").map(e=>e.trim()):[];const l=n.columns;l.forEach(e=>{let i=s.includes(e.relativePath);if(!i&&e.propertyInfos){i=e.propertyInfos.some(e=>{const i=l.find(i=>i.name===e);return i?.relativePath&&s.includes(i.relativePath)})}if(i){e.availability="Hidden";if("sortable"in e){e.sortable=false}if("filterable"in e){e.filterable=false}if("isGroupable"in e){e.isGroupable=false}}const n=t.find(i=>i.columnKey===e.key);if(n){e.availability=n.visible?"Default":"Hidden"}})};return e}();l=f;return l},false);
//# sourceMappingURL=ColumnManagement.js.map