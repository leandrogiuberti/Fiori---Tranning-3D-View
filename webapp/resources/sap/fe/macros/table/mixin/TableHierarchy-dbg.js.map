{"version":3,"names":["DropPosition","TableHierarchy","_exports","_proto","prototype","setupMixin","_baseClass","_onCopyCut","evt","forContextMenu","action","table","getSource","getParent","menu","internalContext","getBindingContext","selectedContexts","getSelectedContexts","length","Log","error","setProperty","MessageToast","show","ResourceModelHelper","getResourceModel","getText","getProperty","TableRuntime","clearSelection","fireSelectionChange","pasteButton","getActions","find","toolbarAction","test","getAction","getId","setTimeout","focus","_onDragEnterDocument","ui5Event","draggedContext","getParameter","getContent","getRowBinding","getBinding","preventDefault","targetContext","isAncestorOf","disabledBetween","disabledOn","tableDefinition","getTableDefinition","isMoveAllowedInfo","control","isMoveToPositionAllowed","customFunction","FPMHelper","getCustomFunction","moduleName","methodName","undefined","safeIsMoveAllowed","annotation","allowDropBetweenNodes","Math","abs","getIndex","getLength","changeSiblingForRootsSupported","isDropBetweenAllowedForDrag","allowedDropPosition","OnOrBetween","On","Between","setDropPosition","_onDragStartDocument","context","updatablePropertyPath","disableDrag","isRelative","isMovableInfo","isNodeMovable","_error","_onDropDocument","BusyLocker","lock","droppedOnContext","dropInfo","position","parentContext","contextBefore","contextAfter","getContextAfter","getContextBefore","movedContext","Promise","all","dropContext","requestSideEffectsForChangeNextSiblingAction","getTranslatedText","message","unlock","_onCollapseExpandNode","_ui5Event","expand","promiseArray","map","singleContext","isExpanded","collapse","Number","MAX_SAFE_INTEGER","_onMoveUpDown","moveUp","arguments","mdcTable","setBusy","requestParent","contextMoved","movePromise","previousSibling","requestSibling","move","nextSibling","parent","newIndex","scrollToIndex","focusRow","_requestSideEffectsForHierarchyActions","requestSideEffectsForCopyAction","entityPath","data","metaModel","getModel","getMetaModel","targetObject","getContext","convertMetaModelContext","MetaModelConverter","entityType","targetType","actionName","annotations","Hierarchy","hierarchyQualifier","appComponent","CommonUtils","getAppComponent","sideEffectsService","getSideEffectsService","sideEffects","getODataActionSideEffects","requestSideEffectsForODataAction","allowed","isAllowed","parentBefore","paramsBefore","getDropBetweenParameters","parentAfter","paramsAfter","contextIndex","Error","listBinding","getAllCurrentContexts","ctx","info","internalModelContext","isTableSorted","moveContext","finally","params"],"sourceRoot":".","sources":["TableHierarchy.ts"],"sourcesContent":["import type { EntitySet, NavigationProperty } from \"@sap-ux/vocabularies-types\";\nimport Log from \"sap/base/Log\";\nimport { type IInterfaceWithMixin } from \"sap/fe/base/ClassSupport\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport BusyLocker from \"sap/fe/core/controllerextensions/BusyLocker\";\nimport * as MetaModelConverter from \"sap/fe/core/converters/MetaModelConverter\";\nimport FPMHelper from \"sap/fe/core/helpers/FPMHelper\";\nimport { type InternalModelContext } from \"sap/fe/core/helpers/ModelHelper\";\nimport ResourceModelHelper from \"sap/fe/core/helpers/ResourceModelHelper\";\nimport type Menu from \"sap/m/Menu\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport type UI5Event from \"sap/ui/base/Event\";\nimport type Control from \"sap/ui/core/Control\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport type DragDropInfo from \"sap/ui/core/dnd/DragDropInfo\";\nimport type MDCTable from \"sap/ui/mdc/Table\";\nimport type ActionToolbarAction from \"sap/ui/mdc/actiontoolbar/ActionToolbarAction\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport { type ITableBlock } from \"../TableAPI\";\nimport TableRuntime from \"../TableRuntime\";\n\nenum DropPosition {\n\tOn = \"On\",\n\tBetween = \"Between\",\n\tOnOrBetween = \"OnOrBetween\"\n}\n\ntype DropInformation =\n\t| { position: DropPosition.On; parentContext: Context | null }\n\t| { position: DropPosition.Between; contextBefore: Context | null; contextAfter: Context | null };\n\nexport default class TableHierarchy implements IInterfaceWithMixin {\n\tsetupMixin(_baseClass: Function): void {\n\t\t// This method is needed to implement interface IInterfaceWithMixin\n\t}\n\n\t/**\n\t * Handles the Cut/Copy operation.\n\t * @param evt The UI5 event\n\t * @param forContextMenu\n\t */\n\t_onCopyCut(this: ITableBlock & TableHierarchy, evt: UI5Event<{}, UI5Element>, forContextMenu: boolean, action: \"Copy\" | \"Cut\"): void {\n\t\tlet table: MDCTable;\n\t\tif (!forContextMenu) {\n\t\t\ttable = evt.getSource().getParent() as MDCTable;\n\t\t} else {\n\t\t\tconst menu = evt.getSource().getParent() as Menu;\n\t\t\ttable = menu.getParent()?.getParent() as MDCTable;\n\t\t}\n\t\tconst internalContext = table.getBindingContext(\"internal\") as InternalModelContext;\n\t\tconst selectedContexts = this.getSelectedContexts();\n\t\tif (selectedContexts.length > 1) {\n\t\t\tLog.error(`Multi ${action === \"Cut\" ? \"cutting\" : \"copying\"} is not supported`);\n\t\t\treturn;\n\t\t}\n\n\t\tinternalContext.setProperty(\"nodeUpdatesInfo/pastableContexts\", selectedContexts);\n\t\tinternalContext.setProperty(\"nodeUpdatesInfo/lastAction\", action);\n\t\tMessageToast.show(ResourceModelHelper.getResourceModel(table).getText(\"M_CUTCOPY_READY\"));\n\t\tif (!forContextMenu || internalContext.getProperty(\"numberOfSelectedContexts\") > 0) {\n\t\t\tTableRuntime.clearSelection(table);\n\t\t\ttable.fireSelectionChange();\n\t\t} else if (forContextMenu) {\n\t\t\t// Using the context menu implicitly defines a context for the action\n\t\t\ttable.fireSelectionChange();\n\t\t}\n\n\t\tinternalContext.setProperty(\"nodeUpdatesInfo/cutEnablement\", false);\n\t\tinternalContext.setProperty(\"contextmenu/nodeUpdatesInfo/cutEnablement\", false);\n\t\tinternalContext.setProperty(\"nodeUpdatesInfo/copyEnablement\", false);\n\t\tinternalContext.setProperty(\"contextmenu/nodeUpdatesInfo/copyEnablement\", false);\n\t\tconst pasteButton = (table.getActions() as ActionToolbarAction[]).find((toolbarAction) =>\n\t\t\t/::Paste$/.test(toolbarAction.getAction().getId())\n\t\t);\n\t\tsetTimeout(() => {\n\t\t\tpasteButton?.focus();\n\t\t}, 0);\n\t}\n\n\t/**\n\t * The dragged element enters a table row.\n\t * @param ui5Event UI5 event coming from the MDC drag and drop config\n\t */\n\t_onDragEnterDocument(\n\t\tthis: ITableBlock & TableHierarchy,\n\t\tui5Event: UI5Event<{ bindingContext: Context; dragSource: Context; dropPosition: \"Before\" | \"After\" | \"On\" }, DragDropInfo>\n\t): void {\n\t\tconst draggedContext = ui5Event.getParameter(\"dragSource\");\n\t\tif (this.getContent().getRowBinding() !== draggedContext.getBinding()) {\n\t\t\t// The drag is done on a different table -> not authorized\n\t\t\tui5Event.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tconst targetContext: Context | null = ui5Event.getParameter(\"bindingContext\");\n\t\tif (draggedContext.isAncestorOf(targetContext)) {\n\t\t\t// The ancestor is dropped on a descendant -> not authorized\n\t\t\tui5Event.preventDefault();\n\t\t\treturn;\n\t\t}\n\n\t\tlet disabledBetween = false;\n\t\tlet disabledOn = false;\n\t\tconst tableDefinition = this.getTableDefinition();\n\t\tconst isMoveAllowedInfo = tableDefinition.control.isMoveToPositionAllowed;\n\t\tconst customFunction = isMoveAllowedInfo\n\t\t\t? FPMHelper.getCustomFunction<(node: Context, parent: Context | null) => boolean>(\n\t\t\t\t\tisMoveAllowedInfo.moduleName,\n\t\t\t\t\tisMoveAllowedInfo.methodName,\n\t\t\t\t\tui5Event.getSource().getParent() as Control\n\t\t\t  )\n\t\t\t: undefined;\n\n\t\tif (targetContext === this.getContent().getBindingContext()) {\n\t\t\t// The drag is done on the table itself -> drop as root node)\n\t\t\tdisabledOn = !this.safeIsMoveAllowed(customFunction, draggedContext, null);\n\t\t\tdisabledBetween = true;\n\t\t} else {\n\t\t\tdisabledOn = !this.safeIsMoveAllowed(customFunction, draggedContext, targetContext);\n\t\t\tdisabledBetween = tableDefinition.annotation.allowDropBetweenNodes !== true;\n\n\t\t\tif (\n\t\t\t\tMath.abs(targetContext.getIndex()! - draggedContext.getIndex()!) === 1 &&\n\t\t\t\t!(targetContext.getIndex() === 0 && ui5Event.getParameter(\"dropPosition\") === \"Before\") &&\n\t\t\t\t!(\n\t\t\t\t\ttargetContext.getIndex() === this.getContent().getRowBinding().getLength() - 1 &&\n\t\t\t\t\tui5Event.getParameter(\"dropPosition\") === \"After\"\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t//\n\t\t\t\tdisabledBetween = true;\n\t\t\t}\n\n\t\t\t// If the drop between node is allowed, we need to check if the target is a root node and if the table supports changeSiblingForRoots\n\t\t\tif (\n\t\t\t\t!disabledBetween &&\n\t\t\t\t!tableDefinition.annotation.changeSiblingForRootsSupported &&\n\t\t\t\ttargetContext.getProperty(\"@$ui5.node.level\") === 1\n\t\t\t) {\n\t\t\t\tdisabledBetween = true;\n\t\t\t}\n\n\t\t\t// Check custom logic for drop between if there's some, and if it's not already disabled at the table level\n\t\t\tif (customFunction && !disabledBetween) {\n\t\t\t\tdisabledBetween = !this.isDropBetweenAllowedForDrag(customFunction, draggedContext, targetContext);\n\t\t\t}\n\t\t}\n\n\t\tlet allowedDropPosition: DropPosition = DropPosition.OnOrBetween;\n\t\tif (disabledBetween && disabledOn) {\n\t\t\t//Set the element as non droppable\n\t\t\tui5Event.preventDefault();\n\t\t\treturn;\n\t\t}\n\t\tif (disabledBetween) {\n\t\t\tallowedDropPosition = DropPosition.On;\n\t\t} else if (disabledOn) {\n\t\t\tallowedDropPosition = DropPosition.Between;\n\t\t}\n\t\tui5Event.getSource().setDropPosition(allowedDropPosition);\n\t}\n\n\t/**\n\t * Starts the drag of the document.\n\t * @param ui5Event UI5 event coming from the MDC drag and drop config\n\t */\n\t_onDragStartDocument(this: ITableBlock & TableHierarchy, ui5Event: UI5Event<{ bindingContext: Context }, Control>): void {\n\t\tconst context = ui5Event.getParameter(\"bindingContext\");\n\t\tconst updatablePropertyPath = this.getTableDefinition().annotation.updatablePropertyPath;\n\n\t\t// Check if the context can be updated according to update restrictions\n\t\tlet disableDrag = !!updatablePropertyPath && !context.getProperty(updatablePropertyPath);\n\n\t\t// In case of a TreeTable in a ListReport with draft, check that the context has no associated draft\n\t\tif (!disableDrag && !(context.getBinding() as ODataListBinding).isRelative()) {\n\t\t\tdisableDrag = context.getProperty(\"HasDraftEntity\") === true;\n\t\t}\n\n\t\t// Apply custom logic if there's one\n\t\tconst isMovableInfo = this.getTableDefinition().control.isNodeMovable;\n\t\ttry {\n\t\t\tif (isMovableInfo && !disableDrag) {\n\t\t\t\tdisableDrag =\n\t\t\t\t\t(\n\t\t\t\t\t\tFPMHelper.getCustomFunction<(contexts: Context[]) => boolean>(\n\t\t\t\t\t\t\tisMovableInfo.moduleName,\n\t\t\t\t\t\t\tisMovableInfo.methodName,\n\t\t\t\t\t\t\tui5Event.getSource()\n\t\t\t\t\t\t) as Function\n\t\t\t\t\t)(context) === false;\n\t\t\t}\n\t\t} catch (_error) {\n\t\t\tdisableDrag = false;\n\t\t}\n\t\tif (disableDrag) {\n\t\t\t//Set the element as non draggable\n\t\t\tui5Event.preventDefault();\n\t\t}\n\t}\n\n\t/**\n\t * Drops the document.\n\t * @param ui5Event UI5 event coming from the MDC drag and drop config\n\t * @returns The Promise\n\t */\n\tasync _onDropDocument(\n\t\tthis: ITableBlock & TableHierarchy,\n\t\tui5Event: UI5Event<{\n\t\t\tbindingContext: Context;\n\t\t\tdragSource: Context;\n\t\t\tdropPosition: string;\n\t\t}>\n\t): Promise<void> {\n\t\tBusyLocker.lock(this.getContent());\n\n\t\ttry {\n\t\t\tconst droppedOnContext = ui5Event.getParameter(\"bindingContext\");\n\t\t\tlet dropInfo: DropInformation;\n\t\t\tif (droppedOnContext === this.getContent().getBindingContext()) {\n\t\t\t\t// The drop is done on the table itself -> drop as root node)\n\t\t\t\tdropInfo = { position: DropPosition.On, parentContext: null };\n\t\t\t} else if (ui5Event.getParameter(\"dropPosition\") === DropPosition.On) {\n\t\t\t\t// Drop on a node\n\t\t\t\tdropInfo = { position: DropPosition.On, parentContext: droppedOnContext };\n\t\t\t} else {\n\t\t\t\t// Drop between 2 nodes\n\t\t\t\tlet contextBefore: Context | null;\n\t\t\t\tlet contextAfter: Context | null;\n\t\t\t\tif (ui5Event.getParameter(\"dropPosition\") === \"After\") {\n\t\t\t\t\tcontextBefore = droppedOnContext;\n\t\t\t\t\tcontextAfter = this.getContextAfter(droppedOnContext);\n\t\t\t\t} else {\n\t\t\t\t\tcontextBefore = this.getContextBefore(droppedOnContext);\n\t\t\t\t\tcontextAfter = droppedOnContext;\n\t\t\t\t}\n\t\t\t\tdropInfo = { position: DropPosition.Between, contextAfter, contextBefore };\n\t\t\t}\n\n\t\t\tconst movedContext = ui5Event.getParameter(\"dragSource\");\n\t\t\tawait Promise.all([this.dropContext(movedContext, dropInfo), this.requestSideEffectsForChangeNextSiblingAction(movedContext)]);\n\t\t} catch (error) {\n\t\t\tMessageToast.show(this.getTranslatedText(\"M_TABLEDROP_FAILED\", [\"\"]));\n\t\t\tLog.error(\"The operation is unsuccessful. \" + (error as Error).message ?? \"\");\n\t\t} finally {\n\t\t\tBusyLocker.unlock(this.getContent());\n\t\t}\n\t}\n\n\t/**\n\t * Handler for collapse/expand from the context menu.\n\t * @param this\n\t * @param _ui5Event\n\t * @param expand\n\t */\n\tasync _onCollapseExpandNode(this: ITableBlock & TableHierarchy, _ui5Event: UI5Event, expand: boolean): Promise<void> {\n\t\tconst selectedContexts = this.getSelectedContexts();\n\t\tif (expand) {\n\t\t\tconst promiseArray = selectedContexts.map(async (singleContext: Context) => {\n\t\t\t\t// Checking for false specifically; undefined means the node cannot expand/collapse\n\t\t\t\tif (singleContext.isExpanded() !== undefined) {\n\t\t\t\t\t// Temporary workaround due to model limitation.\n\t\t\t\t\t// We need to collapse a node before expanding it to ensure we expand it completely.\n\t\t\t\t\t// Will be changed once the model fixes the issue.\n\t\t\t\t\tif (singleContext.isExpanded() === true) {\n\t\t\t\t\t\tawait singleContext.collapse();\n\t\t\t\t\t}\n\t\t\t\t\treturn singleContext.expand(Number.MAX_SAFE_INTEGER);\n\t\t\t\t}\n\t\t\t});\n\t\t\tawait Promise.all(promiseArray);\n\t\t} else {\n\t\t\tawait Promise.all(\n\t\t\t\tselectedContexts.map(async (singleContext: Context) => {\n\t\t\t\t\tif (singleContext.isExpanded() === true) {\n\t\t\t\t\t\treturn singleContext.collapse(true);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Internal method to move a row up or down in a Tree table.\n\t * @param _ui5Event\n\t * @param moveUp True for move up, false for move down\n\t * @param forContextMenu\n\t */\n\tasync _onMoveUpDown(this: ITableBlock & TableHierarchy, _ui5Event: UI5Event, moveUp: boolean, forContextMenu = false): Promise<void> {\n\t\tconst selectedContexts = this.getSelectedContexts();\n\t\tif (selectedContexts.length !== 1) {\n\t\t\treturn;\n\t\t}\n\t\tconst mdcTable = this.getContent();\n\t\tmdcTable.setBusy(true);\n\n\t\t// Move the context up or down\n\t\tconst movedContext = selectedContexts[0];\n\t\tconst parentContext = await movedContext.requestParent();\n\t\tlet contextMoved = false;\n\t\tlet movePromise = null;\n\t\tif (moveUp) {\n\t\t\tconst previousSibling = await movedContext.requestSibling(-1);\n\t\t\tif (previousSibling) {\n\t\t\t\tmovePromise = movedContext.move({ nextSibling: previousSibling, parent: parentContext });\n\t\t\t\tcontextMoved = true;\n\t\t\t}\n\t\t} else {\n\t\t\tconst nextSibling = await movedContext.requestSibling(1);\n\t\t\tif (nextSibling) {\n\t\t\t\tmovePromise = nextSibling.move({ nextSibling: movedContext, parent: parentContext });\n\t\t\t\tcontextMoved = true;\n\t\t\t}\n\t\t}\n\n\t\tawait Promise.all([movePromise, this.requestSideEffectsForChangeNextSiblingAction(movedContext)]);\n\n\t\t// Scroll to the new position\n\t\tconst newIndex = movedContext.getIndex();\n\t\tif (contextMoved && newIndex !== undefined && newIndex >= 0) {\n\t\t\tif (!forContextMenu) {\n\t\t\t\tmdcTable.scrollToIndex(newIndex);\n\t\t\t} else {\n\t\t\t\tmdcTable.focusRow(newIndex);\n\t\t\t}\n\t\t}\n\t\tmdcTable.setBusy(false);\n\t}\n\n\t/**\n\t * Requests the side effect for the ChangeNextSiblingAction.\n\t * @param movedContext The context that has been moved\n\t * @returns A Promise\n\t */\n\tasync requestSideEffectsForChangeNextSiblingAction(this: ITableBlock & TableHierarchy, movedContext: Context): Promise<void> {\n\t\treturn this._requestSideEffectsForHierarchyActions(movedContext, \"ChangeNextSiblingAction\");\n\t}\n\n\t/**\n\t * Requests the side effect for the CopyAction.\n\t * @param movedContext The context that has been moved\n\t * @returns A Promise\n\t */\n\tasync requestSideEffectsForCopyAction(this: ITableBlock & TableHierarchy, movedContext: Context): Promise<void> {\n\t\treturn this._requestSideEffectsForHierarchyActions(movedContext, \"CopyAction\");\n\t}\n\n\t/**\n\t * Requests the side effect for the CopyAction or ChangeNextSiblingAction.\n\t * @param movedContext The context that has been moved\n\t * @param action\n\t * @returns A Promise\n\t */\n\tasync _requestSideEffectsForHierarchyActions(\n\t\tthis: ITableBlock & TableHierarchy,\n\t\tmovedContext: Context,\n\t\taction: \"ChangeNextSiblingAction\" | \"CopyAction\"\n\t): Promise<void> {\n\t\tconst entityPath = this.getContent().data(\"metaPath\");\n\t\tconst metaModel = movedContext.getModel().getMetaModel();\n\n\t\tconst targetObject = metaModel.getContext(entityPath);\n\t\tconst convertMetaModelContext = MetaModelConverter.convertMetaModelContext(targetObject) as NavigationProperty | EntitySet;\n\t\tconst entityType = (convertMetaModelContext as NavigationProperty).targetType ?? (convertMetaModelContext as EntitySet).entityType;\n\t\tconst actionName = entityType.annotations.Hierarchy?.[\n\t\t\t`RecursiveHierarchyActions#${this.getTableDefinition().control.hierarchyQualifier ?? \"\"}`\n\t\t]?.[action] as string | undefined;\n\n\t\tif (actionName) {\n\t\t\tconst appComponent = CommonUtils.getAppComponent(this.getContent());\n\t\t\tconst sideEffectsService = appComponent.getSideEffectsService();\n\t\t\tconst sideEffects = sideEffectsService.getODataActionSideEffects(actionName, movedContext);\n\t\t\tif (sideEffects) {\n\t\t\t\tawait sideEffectsService.requestSideEffectsForODataAction(sideEffects, movedContext);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Safely checks if moving a node is allowed.\n\t * @param customFunction\n\t * @param movedContext\n\t * @param parentContext\n\t * @returns True if allowed\n\t */\n\tprivate safeIsMoveAllowed(\n\t\tcustomFunction: ((context: Context, parent: Context | null) => boolean) | undefined,\n\t\tmovedContext: Context,\n\t\tparentContext: Context | null\n\t): boolean {\n\t\tif (!customFunction) {\n\t\t\treturn true;\n\t\t}\n\n\t\tlet allowed = true;\n\t\ttry {\n\t\t\tallowed = customFunction(movedContext, parentContext) === true;\n\t\t} catch (error) {\n\t\t\tLog.error(\"Cannot execute function related to isMoveToPositionAllowed\", error as string);\n\t\t\tallowed = true;\n\t\t}\n\n\t\treturn allowed;\n\t}\n\n\t/**\n\t * Checks is drop \"between\" is allowed by custom logic for a given targetContext.\n\t * @param customFunction\n\t * @param draggedContext\n\t * @param targetContext\n\t * @returns True if allowed\n\t */\n\tprivate isDropBetweenAllowedForDrag(\n\t\tcustomFunction: (context: Context, parent: Context | null) => boolean,\n\t\tdraggedContext: Context,\n\t\ttargetContext: Context\n\t): boolean {\n\t\tlet isAllowed = true;\n\n\t\t// Determine what to do if we drop before targetContext\n\t\tconst contextBefore = this.getContextBefore(targetContext);\n\t\tconst parentBefore = contextBefore === null ? null : contextBefore.getParent();\n\t\tconst paramsBefore = this.getDropBetweenParameters(contextBefore, parentBefore, targetContext, targetContext.getParent());\n\n\t\t// Determine what to do if we drop after targetContext\n\t\tconst contextAfter = this.getContextAfter(targetContext);\n\t\tconst parentAfter = contextAfter === null ? null : contextAfter.getParent();\n\t\tconst paramsAfter = this.getDropBetweenParameters(targetContext, targetContext.getParent(), contextAfter, parentAfter);\n\n\t\t// If paramsBefore or paramsAfter cannot be determined (because parents are not loaded), we allow drop between and do the real check in onDropDocument\n\t\tif (paramsBefore !== undefined && paramsAfter !== undefined) {\n\t\t\tif (paramsBefore.parent === paramsAfter.parent) {\n\t\t\t\t// Dropping before or after will move under the same parent --> we call the custom logic only once\n\t\t\t\tisAllowed = this.safeIsMoveAllowed(customFunction, draggedContext, paramsBefore.parent);\n\t\t\t} else {\n\t\t\t\t// As the MDC table cannot disable drop before and after separately, we disable drop between only if both drop before and after are forbidden\n\t\t\t\tisAllowed =\n\t\t\t\t\tthis.safeIsMoveAllowed(customFunction, draggedContext, paramsBefore.parent) ||\n\t\t\t\t\tthis.safeIsMoveAllowed(customFunction, draggedContext, paramsAfter.parent);\n\t\t\t}\n\t\t}\n\n\t\treturn isAllowed;\n\t}\n\n\t/**\n\t * Returns the context that is placed before a given context in a ListBinding.\n\t * @param context\n\t * @returns The context before, or null\n\t */\n\tprivate getContextBefore(context: Context): Context | null {\n\t\tconst contextIndex = context.getIndex();\n\t\tif (contextIndex === undefined) {\n\t\t\tthrow new Error(\"Unexpected error\");\n\t\t}\n\n\t\tconst listBinding = context.getBinding() as ODataListBinding;\n\t\treturn contextIndex === 0\n\t\t\t? null\n\t\t\t: listBinding.getAllCurrentContexts().find((ctx) => {\n\t\t\t\t\treturn ctx.getIndex() === contextIndex - 1;\n\t\t\t  }) ?? null;\n\t}\n\n\t/**\n\t * Returns the context that is placed after a given context in a ListBinding.\n\t * @param context\n\t * @returns The context after, or null\n\t */\n\tprivate getContextAfter(context: Context): Context | null {\n\t\tconst contextIndex = context.getIndex();\n\t\tif (contextIndex === undefined) {\n\t\t\tthrow new Error(\"Unexpected error\");\n\t\t}\n\n\t\tconst listBinding = context.getBinding() as ODataListBinding;\n\t\treturn (\n\t\t\tlistBinding.getAllCurrentContexts().find((ctx) => {\n\t\t\t\treturn ctx.getIndex() === contextIndex + 1;\n\t\t\t}) ?? null\n\t\t);\n\t}\n\n\t/**\n\t * Returns information to perform a drop between 2 nodes: the new parent and the next sibling.\n\t * @param contextBefore Context after which the drop is done\n\t * @param parentBefore Parent of contextBefore (undefined if not known)\n\t * @param contextAfter Context before which the drop is done\n\t * @param parentAfter Parent of contextAfter (undefined if not known)\n\t * @returns The new parent and the next sibling, or undefined if it cannot be determined\n\t */\n\tprivate getDropBetweenParameters(\n\t\tcontextBefore: Context | null,\n\t\tparentBefore: Context | null | undefined,\n\t\tcontextAfter: Context | null,\n\t\tparentAfter: Context | null | undefined\n\t): { parent: Context | null; nextSibling?: Context | null } | undefined {\n\t\tif (contextBefore === null) {\n\t\t\t// Drop before first node --> move as first root node\n\t\t\treturn { parent: null, nextSibling: contextAfter };\n\t\t} else if (contextAfter === null) {\n\t\t\t// Drop after last node --> move as next sibling of the last node\n\t\t\treturn parentBefore !== undefined ? { parent: parentBefore, nextSibling: null } : undefined;\n\t\t} else if (parentAfter === contextBefore) {\n\t\t\t// Drop between a parent and its first child --> move as first child of the parent\n\t\t\treturn { parent: contextBefore, nextSibling: contextAfter };\n\t\t} else if (parentBefore === undefined || parentAfter === undefined) {\n\t\t\t// If one of the parent is not known, we don't know what to do\n\t\t\treturn undefined;\n\t\t} else if (parentBefore === parentAfter) {\n\t\t\t// Drop between 2 siblings\n\t\t\treturn { parent: parentBefore, nextSibling: contextAfter };\n\t\t} else {\n\t\t\t// NodeX\n\t\t\t//  ....\n\t\t\t//     |-- contextBefore\n\t\t\t// contextAfter\n\t\t\t// --> Move as the next sibling of contextBefore\n\t\t\treturn { parent: parentBefore, nextSibling: null };\n\t\t}\n\t}\n\n\t/**\n\t * Internal method to drop a context on or between 2 nodes.\n\t * @param context\n\t * @param info\n\t * @returns The move Promise\n\t */\n\tprivate async dropContext(this: ITableBlock & TableHierarchy, context: Context, info: DropInformation): Promise<void> {\n\t\tconst isMoveAllowedInfo = this.getTableDefinition().control.isMoveToPositionAllowed;\n\t\tconst customFunction = isMoveAllowedInfo\n\t\t\t? FPMHelper.getCustomFunction<(node: Context, parent: Context | null) => boolean>(\n\t\t\t\t\tisMoveAllowedInfo.moduleName,\n\t\t\t\t\tisMoveAllowedInfo.methodName,\n\t\t\t\t\tthis.getContent()\n\t\t\t  )\n\t\t\t: undefined;\n\t\tconst table = this.getContent();\n\t\ttable.setBusy(true);\n\t\tconst internalModelContext = table.getBindingContext(\"internal\") as InternalModelContext;\n\t\tconst isTableSorted = internalModelContext.getProperty(\"isSorted\") === true;\n\n\t\tconst moveContext = async (parent: Context | null, nextSibling?: Context | null): Promise<void> => {\n\t\t\t// We check if the move is allowed by custom logic (if any), as this check might\n\t\t\t// not have been done in onDragEnterDocument if the parent was not loaded yet.\n\t\t\tif (this.safeIsMoveAllowed(customFunction, context, parent)) {\n\t\t\t\t// If the table is sorted, we ignore the sibling as the position shall be determined by the server\n\t\t\t\treturn context.move({ parent, nextSibling: isTableSorted ? undefined : nextSibling });\n\t\t\t} else {\n\t\t\t\tMessageToast.show(this.getTranslatedText(\"M_TABLE_DROP_NOT_ALLOWED\"));\n\t\t\t}\n\t\t};\n\n\t\tif (info.position === DropPosition.On) {\n\t\t\t// Drop on a node\n\t\t\treturn moveContext(info.parentContext).finally(() => table.setBusy(false));\n\t\t} else {\n\t\t\t// Drop between 2 nodes\n\t\t\tconst [parentBefore, parentAfter] = await Promise.all([\n\t\t\t\tinfo.contextBefore?.requestParent() ?? null,\n\t\t\t\tinfo.contextAfter?.requestParent() ?? null\n\t\t\t]);\n\t\t\tconst params = this.getDropBetweenParameters(info.contextBefore, parentBefore, info.contextAfter, parentAfter)!;\n\t\t\treturn moveContext(params.parent, params.nextSibling).finally(() => table.setBusy(false));\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"TableHierarchy-dbg.js"}