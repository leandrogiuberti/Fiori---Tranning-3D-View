/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/BindingToolkit","sap/fe/core/helpers/FPMHelper","sap/fe/macros/field/FieldTemplating","../CommonHelper","./TableHelper","./TableRuntime","./uploadTable/UploadTableRuntime"],function(e,t,n,o,i,a,l,r){"use strict";var s={};var c=o.formatValueRecursively;var d=t.isPathInModelExpression;var u=t.isConstant;var b=t.getExpressionFromAnnotation;var p=t.compileExpression;const h=1;const g=10;let P=function(){function t(e,t,n){this.tableBlockProperties=e;this.tableAPI=n;this.collectionEntity=t.collectionEntity;this.metaModel=t.metaModel;if(n){this.constructorWithFunctions(n)}else{this.constructorWithStrings()}}s=t;var o=t.prototype;o.constructorWithStrings=function e(){const t=this.tableBlockProperties.tableDefinition?.control?.type;this.addCardToInsightsPress="API.onAddCardToInsightsPressed($event, $controller)";this.beforeExport="API.onBeforeExport($event)";this.beforeOpenContextMenu="API.onContextMenuPress($event)";this.collapseNode=t==="TreeTable"?"API.onCollapseExpandNode($event, false)":undefined;this.contextMenuItemSelected="TableRuntime.onContextMenuItemSelected";const n=this.tableBlockProperties.tableDefinition?.annotation.row?.navigationInfo;if(n!==undefined||this.tableBlockProperties.overrideRowPress){if(n?.type==="Outbound"){this.contextMenuOpenInNewTab=`.onOpenInNewTabNavigateOutBound('${n.navigationTarget}', %{internal>contextmenu/selectedContexts}, "", ${g})`}else{this.contextMenuShareToCollaborationManager=`API.onShareToCollaborationManagerPress($event, $controller, %{internal>contextmenu/selectedContexts}, ${h})`;this.contextMenuOpenInNewTab=`API.onOpenInNewTabPress($event, $controller,  %{internal>contextmenu/selectedContexts}, %{internal>contextmenu/navigableContexts},{ callExtension: true, targetPath: '${n?.targetPath??""}', navMode: 'openInNewTab' }, ${g})`}}this.dataStateChange="API.onDataStateChange";if(this.tableBlockProperties.tableDefinition?.control?.hasDataStateIndicatorFilter){this.dataStateIndicatorFilter="TableRuntime.dataStateIndicatorFilter"}this.dragStartDocument=t==="TreeTable"?"API.onDragStartDocument":undefined;this.dragEnterDocument=t==="TreeTable"?"API.onDragEnterDocument":undefined;this.dropDocument=t==="TreeTable"?"API.onDropDocument":undefined;this.expandNode=t==="TreeTable"?"API.onCollapseExpandNode($event, true)":undefined;this.fieldChangeInCreationRow=`TableRuntime.onFieldChangeInCreationRow($event, ${!!this.tableBlockProperties.tableDefinition.control.customValidationFunction})`;this.fieldLiveChange=this.tableBlockProperties.creationMode?.name==="InlineCreationRows"?"API.onFieldLiveChange($event)":undefined;this.rowPress="API.onTableRowPress";this.segmentedButtonPress="API.onSegmentedButtonPressed";this.selectionChange="API.onSelectionChanged";this.tableContextChange=t==="TreeTable"?`TableRuntime.onTreeTableContextChanged($event, ${this.tableBlockProperties.tableDefinition?.annotation?.initialExpansionLevel})`:undefined;this.uploadCompleted="UploadTableRuntime.onUploadCompleted";this.uploadFileNameLengthExceeded="UploadTableRuntime.onFileNameLengthExceeded";this.uploadFileSizeExceeded="UploadTableRuntime.onFileSizeExceeded";this.uploadItemValidationHandler="UploadTableRuntime.uploadFile";this.uploadMediaTypeMismatch="UploadTableRuntime.onMediaTypeMismatch";this.variantSaved="API.onVariantSaved";this.variantSelected="API.onVariantSelected"};o.constructorWithFunctions=function e(t){const n=this.tableBlockProperties.tableDefinition?.control?.type;this.addCardToInsightsPress=t.onAddCardToInsightsPressed.bind(t);this.beforeExport=t.onBeforeExport.bind(t);this.beforeOpenContextMenu=t.onContextMenuPress.bind(t);this.collapseNode=n==="TreeTable"?e=>{t.onCollapseExpandNode(e,false)}:undefined;this.contextMenuItemSelected=l.onContextMenuItemSelected.bind(l);const o=this.tableBlockProperties.tableDefinition?.annotation.row?.navigationInfo;if(o!==undefined||this.tableBlockProperties.overrideRowPress){if(o?.type==="Outbound"){this.contextMenuOpenInNewTab=e=>{const n=t.getPageController();const i=t.getBindingContext("internal");n?.onOpenInNewTabNavigateOutBound?.(o.navigationTarget,i?.getProperty("contextmenu/selectedContexts"),"",g)}}else{this.contextMenuShareToCollaborationManager=e=>{const n=t.getPageController();const o=t.getBindingContext("internal");t.onShareToCollaborationManagerPress(e,n,o?.getProperty("contextmenu/selectedContexts"),h)};this.contextMenuOpenInNewTab=e=>{const n=t.getPageController();const i=t.getBindingContext("internal");t.onOpenInNewTabPress(e,n,i?.getProperty("contextmenu/selectedContexts"),i?.getProperty("contextmenu/navigableContexts"),{callExtension:true,targetPath:o?.targetPath??"",navMode:"openInNewTab"},g)}}}this.dataStateChange=t.onDataStateChange.bind(t);if(this.tableBlockProperties.tableDefinition?.control?.hasDataStateIndicatorFilter){this.dataStateIndicatorFilter=t.dataStateIndicatorFilter.bind(t)}this.dragStartDocument=n==="TreeTable"?t.onDragStartDocument.bind(t):undefined;this.dragEnterDocument=n==="TreeTable"?t.onDragEnterDocument.bind(t):undefined;this.dropDocument=n==="TreeTable"?t.onDropDocument.bind(t):undefined;this.expandNode=n==="TreeTable"?e=>{t.onCollapseExpandNode(e,true)}:undefined;this.fieldChangeInCreationRow=e=>{l.onFieldChangeInCreationRow(e,!!this.tableBlockProperties.tableDefinition.control.customValidationFunction)};this.fieldLiveChange=this.tableBlockProperties.creationMode?.name==="InlineCreationRows"?t.onFieldLiveChange.bind(t):undefined;this.rowPress=t.onTableRowPress.bind(t);this.segmentedButtonPress=t.onSegmentedButtonPressed.bind(t);this.selectionChange=t.onSelectionChanged.bind(t);this.tableContextChange=n==="TreeTable"?e=>{l.onTreeTableContextChanged(e,this.tableBlockProperties.tableDefinition?.annotation?.initialExpansionLevel)}:undefined;this.uploadCompleted=r.onUploadCompleted.bind(r);this.uploadFileNameLengthExceeded=r.onFileNameLengthExceeded.bind(r);this.uploadFileSizeExceeded=r.onFileSizeExceeded.bind(r);this.uploadItemValidationHandler=r.uploadFile.bind(r);this.uploadMediaTypeMismatch=r.onMediaTypeMismatch.bind(r);this.variantSaved=t.onVariantSaved.bind(t);this.variantSelected=t.onVariantSelected.bind(t)};o.getCreateButtonPressHandler=function e(t,n){if(this.tableAPI){return n?l.onCreateButtonPress.bind(l):e=>{const n=this.tableAPI.getBindingContext("internal");const o=t?"contextmenu/selectedContexts":"selectedContexts";l.onCreateButtonPress(e,n?.getProperty(o))}}else if(!n){return t?"TableRuntime.onCreateButtonPress($event, ${internal>contextmenu/selectedContexts})":"TableRuntime.onCreateButtonPress($event, ${internal>selectedContexts})"}else{return"TableRuntime.onCreateButtonPress($event)"}};o.getCreateMenuItemPressHandler=function e(t,n){const o=n?"contextmenu/selectedContexts":"selectedContexts";if(this.tableAPI){return e=>{l.onCreateMenuItemPress(e,t,this.tableAPI.getBindingContext("internal")?.getProperty(o))}}else{return`TableRuntime.onCreateMenuItemPress($event, ${t}, \${internal>${o}})`}};o.getCutHandler=function e(t){if(this.tableAPI){return e=>{this.tableAPI.onCut(e,t)}}else{return`API.onCut($event, ${t})`}};o.getCopyHandler=function e(t){if(this.tableAPI){return e=>{this.tableAPI.onCopy(e,t)}}else{return`API.onCopy($event, ${t})`}};o.getDataFieldForActionButtonPressHandler=function e(t,n,o,l){if(!t){return undefined}const r=n.annotationPath?i.getActionContext(this.metaModel.createBindingContext(n.annotationPath+"/Action")):undefined;const s=r?this.metaModel.createBindingContext(r):undefined;if(this.tableAPI){const e=t.Action;const i=this.tableBlockProperties.contextObjectPath.targetEntityType.fullyQualifiedName;const r=typeof s?.getObject()!=="string"&&(a._isStaticAction(s?.getObject(),e)||a._isActionOverloadOnDifferentType(e.toString(),i));const c=!l?"aApplicable":"aApplicableForContextMenu";const d=!l?"aNotApplicable":"aNotApplicableForContextMenu";const u=!l?"":"contextmenu/";return e=>{const i=this.tableAPI.getBindingContext("internal");const a={contexts:!r?i.getProperty(`${u}selectedContexts`):null,bStaticAction:r?r:undefined,entitySetName:this.collectionEntity.name,applicableContexts:!r?i.getProperty(`dynamicActions/${t.Action}/${c}/`):null,notApplicableContexts:!r?i.getProperty(`dynamicActions/${t.Action}/${d}/`):null,isNavigable:(o??n).isNavigable,enableAutoScroll:n.enableAutoScroll,defaultValuesExtensionFunction:n.defaultValuesExtensionFunction,invocationGrouping:t?.InvocationGrouping==="UI.OperationGroupingType/ChangeSet"?"ChangeSet":"Isolated",controlId:this.tableBlockProperties.contentId,operationAvailableMap:this.tableBlockProperties.tableDefinition.operationAvailableMap,label:t.Label?.valueOf()??"",model:this.tableAPI.getPageController().getModel()};this.tableAPI?.onActionPress(e,this.tableAPI.getPageController(),t.Action.valueOf(),a)}}else{return a.pressEventDataFieldForActionButton({contextObjectPath:this.tableBlockProperties.contextObjectPath,contentId:this.tableBlockProperties.contentId},t,this.collectionEntity.name,this.tableBlockProperties.tableDefinition.operationAvailableMap,s?.getObject(),(o??n).isNavigable,n.enableAutoScroll,n.defaultValuesExtensionFunction,l)}};o.getDataFieldForIBNPressHandler=function e(t,n){if(t.annotationPath===undefined){return undefined}const o=this.metaModel.createBindingContext(t.annotationPath);const a=o?.getObject();if(!a){return undefined}const l=this.tableBlockProperties.tableDefinition.enableAnalytics!==true;if(this.tableAPI){return e=>{const t=this.tableAPI.getBindingContext("internal");const o={};o.navigationContexts=n?t.getProperty("contextmenu/selectedContexts"):t.getProperty("selectedContexts");if(a.RequiresContext&&!a.Inline&&l){const e=!n?"aApplicable":"aApplicableForContextMenu";const i=!n?"aNotApplicable":"aNotApplicableForContextMenu";o.applicableContexts=t.getProperty(`ibn/${a.SemanticObject}-${a.Action}/${e}/`);o.notApplicableContexts=t.getProperty(`ibn/${a.SemanticObject}-${a.Action}/${i}/`);o.label=a.Label}o.semanticObjectMapping=a.Mapping;const i=this.tableAPI.getPageController();if(l){i?._intentBasedNavigation.navigateWithConfirmationDialog(a.SemanticObject,a.Action,o,e.getSource())}else{i?._intentBasedNavigation.navigate(a.SemanticObject,a.Action,o,e.getSource())}}}else{return i.getPressHandlerForDataFieldForIBN(a,n?"${internal>contextmenu/selectedContexts}":"${internal>selectedContexts}",l,n)}};o.getExpressionForDataFieldValue=function e(t,n){const o=t?.Value;if(!o){return undefined}if(typeof o==="string"){return this.tableAPI?o:i.addSingleQuotes(o,true)}else{const e=b(o);if(u(e)||d(e)){const t=c(e,n);return p(t)}}};o.getDeleteButtonPressHandler=function e(t){const n=(this.collectionEntity?.entityType||this.collectionEntity?.targetType)?.annotations?.UI?.HeaderInfo;const o=!t?"":"contextmenu/";const a=`${o}deletableContexts`;const l=`${o}selectedContextsIncludingInactive`;const r=!t?`numberOfSelectedContexts`:`${o}numberOfSelectedContextsForDelete`;const s=`${o}unSavedContexts`;const c=`${o}lockedContexts`;const d=`${o}draftsWithDeletableActive`;const u=`${o}draftsWithNonDeletableActive`;const b=this.getExpressionForDataFieldValue(n?.Title,this.tableBlockProperties.contextObjectPath);const p=this.getExpressionForDataFieldValue(n?.Description,this.tableBlockProperties.contextObjectPath);if(this.tableAPI){return e=>{const t=this.tableAPI.getBindingContext("internal");const n={id:this.tableBlockProperties.contentId,numberOfSelectedContexts:t?.getProperty(r),unSavedContexts:t?.getProperty(s),lockedContexts:t?.getProperty(c),draftsWithDeletableActive:t?.getProperty(d),draftsWithNonDeletableActive:t?.getProperty(u),controlId:t?.getProperty("controlId"),title:b,description:p,selectedContexts:t?.getProperty(l)};this.tableAPI.getPageController()?.editFlow.deleteMultipleDocuments(t?.getProperty(a),n)}}else{const e={id:i.addSingleQuotes(this.tableBlockProperties.contentId),numberOfSelectedContexts:`\${internal>${r}}`,unSavedContexts:`\${internal>${s}}`,lockedContexts:`\${internal>${c}}`,draftsWithDeletableActive:`\${internal>${d}}`,draftsWithNonDeletableActive:`\${internal>${u}}`,controlId:"${internal>controlId}",title:b,description:p,selectedContexts:`\${internal>${l}}`};return i.generateFunction(".editFlow.deleteMultipleDocuments",`\${internal>${a}}`,i.objectToString(e))}};o.getManifestActionPressHandler=function t(o,a){if(this.tableAPI){if(o.noWrap===true){const t=this.tableAPI.findSlotActionFromKey(o.key);if(t){return e=>{const n=a?"contextmenu/selectedContexts":"selectedContexts";const o=this.tableAPI.getBindingContext("internal");const i={...e.getParameters(),contexts:o.getProperty(n)};t.fireEvent("press",i)}}else{e.error("Couldn't find action with key "+o.key);return undefined}}else{return t=>{const i=a?"contextmenu/selectedContexts":"selectedContexts";const l=this.tableAPI.getBindingContext("internal");n.actionWrapper(t,o.handlerModule,o.handlerMethod,{contexts:l.getProperty(i)}).catch(t=>{e.error("Error while executing custom action",t)})}}}else{return o.noWrap===true?o.press:i.buildActionWrapper(o,{id:this.tableBlockProperties.contentId},a)}};o.getMassEditButtonPressHandler=function e(t){if(this.tableAPI){return e=>{this.tableAPI.onMassEditButtonPressed(e,t)}}else{return`API.onMassEditButtonPressed($event, ${t})`}};o.getMoveUpDownHandler=function e(t,n){if(this.tableAPI){return e=>{this.tableAPI.onMoveUpDown(e,t,n)}}else{return`API.onMoveUpDown($event, ${t}, ${n})`}};o.getPasteHandler=function e(t){if(this.tableAPI){const e=this.tableAPI.getPageController();return n=>{this.tableAPI.onPaste(n,e,t)}}else{return`API.onPaste($event, $controller, ${t})`}};return t}();s=P;return s},false);
//# sourceMappingURL=TableEventHandlerProvider.js.map