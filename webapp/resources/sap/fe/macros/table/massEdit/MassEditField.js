/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/BindingToolkit","sap/fe/core/controls/Any","sap/fe/core/helpers/StableIdHelper","sap/fe/macros/Field","sap/fe/macros/table/massEdit/library","sap/m/Select","sap/ui/core/Item","sap/ui/mdc/enums/FieldEditMode","../../field/FieldRuntimeHelper","sap/fe/base/jsx-runtime/jsx"],function(e,t,r,i,s,n,o,p,a,l){"use strict";var c={};var h=s.SpecificSelectKeys;var u=e.isConstant;var d=e.compileExpression;var y=e.compileConstant;let f=function(){function e(e,t){this.isValid=true;this.properties=e;this.context=t;this.context=t;this.select=this.createSelect();this.field=this.createField()}c=e;var s=e.prototype;s.getControls=function e(){const t=[this.select];if(this.field){t.push(this.field)}return t};s.getFieldValues=function e(){const t=this.select.getSelectedKey();const r=this.properties.selectItems.find(e=>t===e.key);const i={};let s="";let n="";const o=this.field?.getBindingContext()?.getProperty(this.properties.propertyInfo.relativePath);if(!this.select.getParent()?.getVisible()||!r){return{}}switch(r.key){case h.ClearFieldValueKey:s=this.getFormattedValue(o);break;case h.ReplaceKey:if(this.field){const e=this.properties.propertyInfo.unitOrCurrencyPropertyPath?this.field.getBindingContext()?.getProperty(this.properties.propertyInfo.unitOrCurrencyPropertyPath):undefined;const t=this.properties.selectItems.find(t=>this.properties.propertyInfo.unitOrCurrencyPropertyPath&&t.propertyValue===o&&t.unitOrCurrencyValue===e||!this.properties.propertyInfo.unitOrCurrencyPropertyPath&&t.text===o);const r=t?.propertyValue??o;const i=t?.unitOrCurrencyValue??e;if(r===null&&i===null){return{}}s=this.getFormattedValue(r);n=i}break;case h.KeepKey:return{};default:if(this.properties.inputType==="CheckBox"){s=this.getFormattedValue(r.key)}else{return{}}break}i[this.properties.propertyInfo.relativePath]=s;if(this.properties.propertyInfo.unitOrCurrencyPropertyPath){i[this.properties.propertyInfo.unitOrCurrencyPropertyPath]=n}return i};s.isReadOnlyOnContext=function e(r){const i=this.properties.readOnlyExpression;let s=false;if(u(i)){s=y(i,false,undefined,true)}else{const e=new t({anyBoolean:d(i)});e.setModel(r.getModel());e.setBindingContext(r);s=e.getBinding("anyBoolean")?.getExternalValue();e.destroy()}return s};s.getFormattedValue=function e(t){if(this.properties.inputType==="CheckBox"){return t==="true"}return t??this.properties.propertyInfo.emptyValue};s.createField=function e(){if(this.properties.inputType!=="CheckBox"){return l(i,{contextPath:this.context,metaPath:this.properties.propertyInfo.relativePath,id:r.generate(["MED_",this.properties.propertyInfo.key,"_Field"]),editMode:p.Editable,visible:false,change:this.handleFieldChange.bind(this)})}};s.handleFieldChange=function e(t){this.isValid=!!a.getFieldStateOnChange(t).state["validity"]};s.isFieldValid=function e(){return this.isValid};s.createSelect=function e(){return l(n,{id:r.generate(["MED_",this.properties.propertyInfo.key]),items:this.properties.selectItems.map(e=>l(o,{text:e.text},e.key)),required:this.properties.isFieldRequired,change:this.handleSelectionChange.bind(this),width:"100%",ariaLabelledBy:[r.generate(["MED_",this.properties.propertyInfo.key,"Label"])]})};s.handleSelectionChange=function e(){const t=this.select.getSelectedItem();if(this.field&&t){this.isValid=true;const e=this.field.getBindingContext();const r=t.getKey();let i;this.field.setVisible(![h.KeepKey,h.ClearFieldValueKey].includes(t.getKey()));if(!(r in h)){i=this.properties.selectItems.find(e=>e.key===r);this.select.setSelectedKey(h.ReplaceKey)}if(e){const t=this.properties.propertyInfo.unitOrCurrencyPropertyPath;e.setProperty(this.properties.propertyInfo.relativePath,this.properties.descriptionPath?i?.text:i?.propertyValue);if(t){e.setProperty(t,i?.unitOrCurrencyValue)}}}};return e}();c=f;return c},false);
//# sourceMappingURL=MassEditField.js.map