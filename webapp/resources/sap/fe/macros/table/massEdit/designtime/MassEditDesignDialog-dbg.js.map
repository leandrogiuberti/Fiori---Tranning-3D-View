{"version":3,"names":["MassEditDesignDialog","tableAPI","massEditDialogHelper","getMassEditDialogHelper","popup","createDialog","selectionPanel","getPanels","dialogPromise","Promise","resolve","reject","_fnResolve","_fnReject","_exports","_proto","prototype","_jsx","Popup","title","Library","getResourceBundleFor","getText","mode","panels","SelectionPanel","enableCount","showHeader","close","onClose","bind","getPopup","openDialog","owner","selectedFields","setData","open","getDependents","find","control","isA","addStyleClass","displayedFields","Object","assign","split","map","fieldName","entityFields","generateEntityFieldsProperties","p13nData","field","visible","propertyInfo","relativePath","name","label","setP13nData","event","getParameter","getP13nData","item","join","undefined","destroy"],"sourceRoot":".","sources":["MassEditDesignDialog.tsx"],"sourcesContent":["import type ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport type TableAPI from \"sap/fe/macros/table/TableAPI\";\nimport type Dialog from \"sap/m/Dialog\";\nimport type { Popup$CloseEvent } from \"sap/m/p13n/Popup\";\nimport Popup from \"sap/m/p13n/Popup\";\nimport SelectionPanel from \"sap/m/p13n/SelectionPanel\";\nimport type Control from \"sap/ui/core/Control\";\nimport Library from \"sap/ui/core/Lib\";\nimport type MassEditDialogHelper from \"../MassEditDialogHelper\";\n\nexport default class MassEditDesignDialog {\n\tprivate massEditDialogHelper: MassEditDialogHelper;\n\n\tprivate popup: Popup;\n\n\tprivate readonly selectionPanel: SelectionPanel;\n\n\tprivate _fnResolve!: (value: string) => void;\n\n\tprivate _fnReject!: (error: unknown) => void;\n\n\tprivate readonly dialogPromise: Promise<string>;\n\n\tconstructor(private tableAPI: TableAPI) {\n\t\tthis.massEditDialogHelper = this.tableAPI.getMassEditDialogHelper() as MassEditDialogHelper;\n\t\tthis.popup = this.createDialog();\n\n\t\tthis.selectionPanel = this.popup.getPanels()[0] as SelectionPanel;\n\t\tthis.dialogPromise = new Promise((resolve, reject) => {\n\t\t\tthis._fnResolve = resolve;\n\t\t\tthis._fnReject = reject;\n\t\t});\n\t}\n\n\t/**\n\t * Creates the dialog for the mass edit adaptation.\n\t * @returns The popup\n\t */\n\tprivate createDialog(): Popup {\n\t\treturn (\n\t\t\t<Popup\n\t\t\t\ttitle={(Library.getResourceBundleFor(\"sap.fe.macros\") as ResourceBundle).getText(\"C_MASS_EDIT_DESIGN_DIALOG_TITLE\")}\n\t\t\t\tmode=\"Dialog\"\n\t\t\t\tpanels={[<SelectionPanel title=\"Columns\" enableCount=\"true\" showHeader=\"true\" />]}\n\t\t\t\tclose={this.onClose.bind(this)}\n\t\t\t/>\n\t\t);\n\t}\n\n\t/**\n\t * Gets the dialog for the mass edit adaptation.\n\t * @returns The popup\n\t */\n\tgetPopup(): Popup {\n\t\treturn this.popup;\n\t}\n\n\t/**\n\t * Opens the dialog for the mass edit adaptation.\n\t * @param owner The owner of the dialog\n\t * @param selectedFields The selected fields\n\t * @returns The new selected fields\n\t */\n\tasync openDialog(owner: Control, selectedFields: string): Promise<string> {\n\t\tawait this.setData(selectedFields);\n\t\tthis.popup.open(owner);\n\t\t(this.popup.getDependents().find((control) => control.isA<Dialog>(\"sap.m.Dialog\")) as Dialog | undefined)?.addStyleClass(\n\t\t\t\"sapUiRTABorder\"\n\t\t);\n\t\treturn this.dialogPromise;\n\t}\n\n\t/**\n\t * Sets the p13n data for the dialog.\n\t * @param selectedFields The selected fields\n\t */\n\tprivate async setData(selectedFields: string): Promise<void> {\n\t\tconst displayedFields = Object.assign({}, ...selectedFields.split(\",\").map((fieldName) => ({ [fieldName]: true })));\n\t\tconst entityFields = await this.massEditDialogHelper.generateEntityFieldsProperties();\n\t\tconst p13nData = entityFields.map((field) => {\n\t\t\treturn {\n\t\t\t\tvisible: !!displayedFields[field.propertyInfo.relativePath],\n\t\t\t\tname: field.propertyInfo.relativePath,\n\t\t\t\tlabel: field.label\n\t\t\t};\n\t\t});\n\t\tthis.selectionPanel.setP13nData(p13nData);\n\t}\n\n\t/**\n\t * Closes and destroys the dialog.\n\t * @param event The close event\n\t */\n\tprivate onClose(event: Popup$CloseEvent): void {\n\t\tif (event.getParameter(\"reason\") === \"Ok\") {\n\t\t\tthis._fnResolve(\n\t\t\t\tthis.selectionPanel\n\t\t\t\t\t.getP13nData(true)\n\t\t\t\t\t.map((item) => item.name)\n\t\t\t\t\t.join(\",\")\n\t\t\t);\n\t\t} else {\n\t\t\tthis._fnReject(undefined);\n\t\t}\n\t\tif (this.popup) {\n\t\t\tthis.popup.destroy();\n\t\t}\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"MassEditDesignDialog-dbg.js"}