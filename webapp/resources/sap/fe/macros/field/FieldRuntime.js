/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/base/util/ObjectPath","sap/fe/core/CommonUtils","sap/fe/core/helpers/FPMHelper","sap/fe/macros/CommonHelper","sap/m/HBox","sap/m/table/Util","sap/ui/core/Lib","sap/ui/model/Filter","sap/ui/model/Sorter","./FieldRuntimeHelper"],function(e,t,n,o,r,s,a,i,c,l,u){"use strict";const p={uploadPromises:{},creatingInactiveRow:false,isDraftIndicatorVisible:function(e,t,n,o,r){if(o!==undefined&&n!==undefined&&(!o||n)&&!r){return e===t}else{return false}},onValidateFieldGroup:function(e){const t=e.getSource();const o=n.getTargetView(t),r=o.getController();const s=u.getExtensionController(r);s._sideEffects.handleFieldGroupChange(e)},_fnFixHashQueryString:function(e){if(e?.includes("?")){e=e.split("?")[0]}return e},retrieveTextFromValueList:async function(t,n,o){let s;let a;let l;if(t){a=this.getModel()?.getMetaModel()||r.getMetaModel();l=a.getObject(`${n}@sapui.name`);return a.requestValueListInfo(n,true).then(function(e){const n=e[e[""]?"":Object.keys(e)[0]];const r=n.$model;const a=r.getMetaModel();const i=n.Parameters.find(function(e){return e.LocalDataProperty&&e.LocalDataProperty.$PropertyPath===l});if(i&&!i.ValueListProperty){throw new Error(`Inconsistent value help annotation for ${l}`)}const u=a.getObject(`/${n.CollectionPath}/${i.ValueListProperty}@com.sap.vocabularies.Common.v1.Text`);if(u&&u.$Path){s=u.$Path;const e=new c({path:i.ValueListProperty,operator:"EQ",value1:t});const o=r.bindList(`/${n.CollectionPath}`,undefined,undefined,e,{$select:s});return o.requestContexts(0,2)}else{o="Value";return t}}).then(function(e){const n=s?e[0]?.getObject()[s]:"";if(!n){return t}switch(o){case"Description":return n||t;case"DescriptionValue":return i.getResourceBundleFor("sap.fe.core").getText("C_FORMAT_FOR_TEXT_ARRANGEMENT",[n,t]);case"ValueDescription":return i.getResourceBundleFor("sap.fe.core").getText("C_FORMAT_FOR_TEXT_ARRANGEMENT",[t,n]);default:return t}}).catch(function(t){const o=t;const r=o.status&&o.status===404?`Metadata not found (${o.status}) for value help of property ${n}`:o.message;e.error(r)})}return t},displayAggregateDetails:async function(e,t){if(!t){return}const n=e.getSource();const r=o.getMdcTable(n);const i=n.getBindingContext();const c=i.getBinding();const u=i.getObject();const p=[];const d=i.getFilter();if(d){p.push(d)}const g=p.concat(c.getFilters("Application"),c.getFilters("Control"));const f=c.getAggregation();const m=f.aggregate[t].unit;const h={};h[m]={};const P={};P[t]={grandTotal:false,subtotals:false,unit:m};const T=n.getDependents()[0].clone();const C=new s({renderType:"Bare",justifyContent:"End",items:[T]});const F={group:h,aggregate:P};if(f.search){F.search=f.search}const y={path:c.getResolvedPath(),filters:g,parameters:{$$aggregation:F},sorter:new l(m,false)};const $=u["@$ui5.node.level"]===0;const b=await a.createOrUpdateMultiUnitPopover(`${r.getId()}-multiUnitPopover`,{control:r,grandTotal:$,itemsBindingInfo:y,listItemContentTemplate:C});r.addDependent(b);const M=()=>{r.removeDependent(b);b.detachEvent("afterClose",M);b.destroy()};b.attachEvent("afterClose",M);b.openBy(n)}};t.set("sap.fe.macros.field.FieldRuntime",p);return p},false);
//# sourceMappingURL=FieldRuntime.js.map