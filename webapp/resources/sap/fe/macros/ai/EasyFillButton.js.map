{"version":3,"file":"EasyFillButton.js","names":["EasyFillButton","_dec","defineUI5Class","_dec2","property","type","_dec3","implementInterface","_class","_class2","_BuildingBlock","_this","_len","arguments","length","args","Array","_key","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_exports","_inheritsLoose","_proto","prototype","onMetadataAvailable","_ownerComponent","content","createContent","_easyEditDocument","async","getAppComponent","getEnvironmentCapabilities","getCapabilities","EasyEdit","controller","getPageController","view","getView","getModel","getProperty","editFlow","editDocument","apply","getBindingContext","easyEditDialog","getOwnerComponent","runAsOwner","EasyFillDialog","getEditableFields","_getEditableFields","bind","open","addDependent","allFields","findAggregatedObjects","control","isA","editableFields","forEach","field","propertyRelativePath","getMainPropertyRelativePath","undefined","isEditable","getEditable","Promise","resolve","_jsx","CommandExecution","execute","command","button","Button","id","createId","text","getTranslatedText","icon","ButtonType","Ghost","setLayoutData","OverflowToolbarLayoutData","priority","OverflowToolbarPriority","High","FESRHelper","setSemanticStepname","setVisible","getOverflowToolbarConfig","canOverflow","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./EasyFillButton.tsx"],"sourcesContent":["import { defineUI5Class, implementInterface, property, type EnhanceWithUI5 } from \"sap/fe/base/ClassSupport\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport CommandExecution from \"sap/fe/core/controls/CommandExecution\";\nimport type Field from \"sap/fe/macros/Field\";\nimport EasyFillDialog from \"sap/fe/macros/ai/EasyFillDialog\";\nimport Button from \"sap/m/Button\";\nimport OverflowToolbarLayoutData from \"sap/m/OverflowToolbarLayoutData\";\nimport type { IOverflowToolbarContent, OverflowToolbarConfig } from \"sap/m/library\";\nimport { ButtonType, OverflowToolbarPriority } from \"sap/m/library\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport FESRHelper from \"sap/ui/performance/trace/FESRHelper\";\n\n@defineUI5Class(\"sap.fe.macros.ai.EasyFillButton\")\nexport default class EasyFillButton extends BuildingBlock<Button> implements IOverflowToolbarContent {\n\t@property({ type: \"string\" })\n\ttext?: string;\n\n\t@implementInterface(\"sap.m.IOverflowToolbarContent\")\n\t__implements__sap_m_IOverflowToolbarContent = true;\n\n\tonMetadataAvailable(_ownerComponent: TemplateComponent): void {\n\t\tsuper.onMetadataAvailable(_ownerComponent);\n\t\tthis.content = this.createContent();\n\t}\n\n\tasync _easyEditDocument(): Promise<void> {\n\t\tif (this.getAppComponent()?.getEnvironmentCapabilities().getCapabilities().EasyEdit) {\n\t\t\tconst controller = this.getPageController();\n\t\t\tconst view = controller.getView();\n\t\t\tif (!this.getPageController()?.getModel(\"ui\").getProperty(\"/isEditable\")) {\n\t\t\t\tawait controller.editFlow.editDocument.apply(controller.editFlow, [view?.getBindingContext()]);\n\t\t\t}\n\t\t\t// Open easy create dialog\n\t\t\tconst easyEditDialog = this.getPageController()\n\t\t\t\t.getOwnerComponent()\n\t\t\t\t?.runAsOwner(() => {\n\t\t\t\t\treturn new EasyFillDialog({ getEditableFields: this._getEditableFields.bind(this) });\n\t\t\t\t});\n\n\t\t\teasyEditDialog.open();\n\t\t\tview?.addDependent(easyEditDialog);\n\t\t}\n\t}\n\n\tasync _getEditableFields(): Promise<unknown> {\n\t\t// Connect all sections\n\t\tconst allFields = this.getPageController()\n\t\t\t.getView()\n\t\t\t?.findAggregatedObjects(true, (control: ManagedObject): boolean => {\n\t\t\t\treturn control.isA(\"sap.fe.macros.Field\");\n\t\t\t}) as EnhanceWithUI5<Field>[];\n\t\tconst editableFields: Record<string, { isEditable: boolean }> = {};\n\t\tallFields.forEach((field) => {\n\t\t\tconst propertyRelativePath = field.getMainPropertyRelativePath();\n\t\t\tif (propertyRelativePath) {\n\t\t\t\tif (editableFields[propertyRelativePath] === undefined) {\n\t\t\t\t\teditableFields[propertyRelativePath] = { isEditable: field.getEditable() };\n\t\t\t\t} else {\n\t\t\t\t\t// If the field is already in the editableFields object, we combine the editable state, if at least one field is editable then we consider it editable\n\t\t\t\t\teditableFields[propertyRelativePath].isEditable =\n\t\t\t\t\t\teditableFields[propertyRelativePath].isEditable || field.getEditable();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn Promise.resolve(editableFields);\n\t}\n\n\tcreateContent(): Button | undefined {\n\t\tif (this.getAppComponent()?.getEnvironmentCapabilities().getCapabilities().EasyEdit) {\n\t\t\tthis.getPageController()\n\t\t\t\t.getView()\n\t\t\t\t?.addDependent(<CommandExecution execute={this._easyEditDocument.bind(this)} command=\"EasyEdit\" />);\n\n\t\t\tconst button = (\n\t\t\t\t<Button\n\t\t\t\t\tid={this.createId(\"button\")}\n\t\t\t\t\tdt:designtime=\"not-adaptable\"\n\t\t\t\t\ttext={this.getTranslatedText(\"C_EASYEDIT_BUTTON\")}\n\t\t\t\t\ticon=\"sap-icon://ai\"\n\t\t\t\t\ttype={ButtonType.Ghost}\n\t\t\t\t\tjsx:command=\"cmd:EasyEdit|press\"\n\t\t\t\t/>\n\t\t\t);\n\t\t\tthis.setLayoutData(<OverflowToolbarLayoutData priority={OverflowToolbarPriority.High} />);\n\t\t\tFESRHelper.setSemanticStepname(button, \"press\", \"fe4:ef:easyfill\");\n\t\t\treturn button;\n\t\t}\n\t\tthis.setVisible(false);\n\t}\n\n\tgetOverflowToolbarConfig(): OverflowToolbarConfig {\n\t\treturn {\n\t\t\tcanOverflow: true\n\t\t};\n\t}\n}\n"],"mappings":";;;;u6CAcqBA,GAAcC,EADlCC,EAAe,mCAAkCC,EAEhDC,EAAS,CAAEC,KAAM,WAAWC,EAG5BC,EAAmB,iCAAgCN,EAAAO,GAAAC,EAAA,SAAAC,GAAA,SAAAV,IAAA,IAAAW,EAAA,QAAAC,EAAAC,UAAAC,OAAAC,EAAA,IAAAC,MAAAJ,GAAAK,EAAA,EAAAA,EAAAL,EAAAK,IAAA,CAAAF,EAAAE,GAAAJ,UAAAI,EAAA,CAAAN,EAAAD,EAAAQ,KAAAC,QAAAJ,IAAAI,KAAAC,EAAAT,EAAA,OAAAU,EAAAV,GAAAS,EAAAT,EAAA,8CAAAW,EAAAX,GAAA,OAAAA,CAAA,CAAAY,EAAAvB,EAAAwB,EAAAxB,EAAAU,GAAA,IAAAe,EAAAzB,EAAA0B,UAAAD,EAGpDE,oBAAA,SAAAA,EAAoBC,GACnBlB,EAAAgB,UAAMC,oBAAmBT,KAAAC,KAACS,GAC1BT,KAAKU,QAAUV,KAAKW,eACrB,EAACL,EAEKM,kBAANC,eAAMD,IACL,GAAIZ,KAAKc,mBAAmBC,6BAA6BC,kBAAkBC,SAAU,CACpF,MAAMC,EAAalB,KAAKmB,oBACxB,MAAMC,EAAOF,EAAWG,UACxB,IAAKrB,KAAKmB,qBAAqBG,SAAS,MAAMC,YAAY,eAAgB,OACnEL,EAAWM,SAASC,aAAaC,MAAMR,EAAWM,SAAU,CAACJ,GAAMO,qBAC1E,CAEA,MAAMC,EAAiB5B,KAAKmB,oBAC1BU,qBACCC,WAAW,IACL,IAAIC,EAAe,CAAEC,kBAAmBhC,KAAKiC,mBAAmBC,KAAKlC,SAG9E4B,EAAeO,OACff,GAAMgB,aAAaR,EACpB,CACD,EAACtB,EAEK2B,mBAANpB,eAAMoB,IAEL,MAAMI,EAAYrC,KAAKmB,oBACrBE,WACCiB,sBAAsB,KAAOC,GACvBA,EAAQC,IAAI,wBAErB,MAAMC,EAA0D,CAAC,EACjEJ,EAAUK,QAASC,IAClB,MAAMC,EAAuBD,EAAME,8BACnC,GAAID,EAAsB,CACzB,GAAIH,EAAeG,KAA0BE,UAAW,CACvDL,EAAeG,GAAwB,CAAEG,WAAYJ,EAAMK,cAC5D,KAAO,CAENP,EAAeG,GAAsBG,WACpCN,EAAeG,GAAsBG,YAAcJ,EAAMK,aAC3D,CACD,IAED,OAAOC,QAAQC,QAAQT,EACxB,EAACnC,EAEDK,cAAA,SAAAA,IACC,GAAIX,KAAKc,mBAAmBC,6BAA6BC,kBAAkBC,SAAU,CACpFjB,KAAKmB,oBACHE,WACCe,aAAae,EAACC,EAAgB,CAACC,QAASrD,KAAKY,kBAAkBsB,KAAKlC,MAAOsD,QAAQ,cAEtF,MAAMC,EACLJ,EAACK,EAAM,CACNC,GAAIzD,KAAK0D,SAAS,UAClB,gBAAc,gBACdC,KAAM3D,KAAK4D,kBAAkB,qBAC7BC,KAAK,gBACL3E,KAAM4E,EAAWC,MACjB,cAAY,uBAGd/D,KAAKgE,cAAcb,EAACc,EAAyB,CAACC,SAAUC,EAAwBC,QAChFC,EAAWC,oBAAoBf,EAAQ,QAAS,mBAChD,OAAOA,CACR,CACAvD,KAAKuE,WAAW,MACjB,EAACjE,EAEDkE,yBAAA,SAAAA,IACC,MAAO,CACNC,YAAa,KAEf,EAAC,OAAA5F,CAAA,CA7EmD,CAJT6F,GAAaxE,EAAAyE,EAAArF,EAAAiB,UAAA,QAAAvB,GAAA,CAAA4F,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAA5E,EAAAwE,EAAArF,EAAAiB,UAAA,+CAAApB,GAAA,CAAAyF,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,kBAKV,IAAI,IAAAzF,KAAAD,GAAAe,EAAAvB,EAAA,OAAAuB,CAAA","ignoreList":[]}