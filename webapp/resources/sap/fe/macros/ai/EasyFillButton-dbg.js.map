{"version":3,"names":["EasyFillButton","_dec","defineUI5Class","_dec2","property","type","_dec3","implementInterface","_class","_class2","_BuildingBlock","_this","_len","arguments","length","args","Array","_key","call","_initializerDefineProperty","_descriptor","_descriptor2","_exports","_inheritsLoose","_proto","prototype","onMetadataAvailable","_ownerComponent","content","createContent","_easyEditDocument","getAppComponent","getEnvironmentCapabilities","getCapabilities","EasyEdit","controller","getPageController","view","getView","getModel","getProperty","editFlow","editDocument","apply","getBindingContext","easyEditDialog","getOwnerComponent","runAsOwner","EasyFillDialog","getEditableFields","_getEditableFields","bind","open","addDependent","allFields","findAggregatedObjects","control","isA","editableFields","forEach","field","propertyRelativePath","getMainPropertyRelativePath","undefined","isEditable","getEditable","Promise","resolve","_jsx","CommandExecution","execute","command","button","Button","id","createId","text","getTranslatedText","icon","ButtonType","Ghost","setLayoutData","OverflowToolbarLayoutData","priority","OverflowToolbarPriority","High","FESRHelper","setSemanticStepname","setVisible","getOverflowToolbarConfig","canOverflow","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["EasyFillButton.tsx"],"sourcesContent":["import { defineUI5Class, implementInterface, property, type EnhanceWithUI5 } from \"sap/fe/base/ClassSupport\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport CommandExecution from \"sap/fe/core/controls/CommandExecution\";\nimport type Field from \"sap/fe/macros/Field\";\nimport EasyFillDialog from \"sap/fe/macros/ai/EasyFillDialog\";\nimport Button from \"sap/m/Button\";\nimport OverflowToolbarLayoutData from \"sap/m/OverflowToolbarLayoutData\";\nimport type { IOverflowToolbarContent, OverflowToolbarConfig } from \"sap/m/library\";\nimport { ButtonType, OverflowToolbarPriority } from \"sap/m/library\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport FESRHelper from \"sap/ui/performance/trace/FESRHelper\";\n\n@defineUI5Class(\"sap.fe.macros.ai.EasyFillButton\")\nexport default class EasyFillButton extends BuildingBlock<Button> implements IOverflowToolbarContent {\n\t@property({ type: \"string\" })\n\ttext?: string;\n\n\t@implementInterface(\"sap.m.IOverflowToolbarContent\")\n\t__implements__sap_m_IOverflowToolbarContent = true;\n\n\tonMetadataAvailable(_ownerComponent: TemplateComponent): void {\n\t\tsuper.onMetadataAvailable(_ownerComponent);\n\t\tthis.content = this.createContent();\n\t}\n\n\tasync _easyEditDocument(): Promise<void> {\n\t\tif (this.getAppComponent()?.getEnvironmentCapabilities().getCapabilities().EasyEdit) {\n\t\t\tconst controller = this.getPageController();\n\t\t\tconst view = controller.getView();\n\t\t\tif (!this.getPageController()?.getModel(\"ui\").getProperty(\"/isEditable\")) {\n\t\t\t\tawait controller.editFlow.editDocument.apply(controller.editFlow, [view?.getBindingContext()]);\n\t\t\t}\n\t\t\t// Open easy create dialog\n\t\t\tconst easyEditDialog = this.getPageController()\n\t\t\t\t.getOwnerComponent()\n\t\t\t\t?.runAsOwner(() => {\n\t\t\t\t\treturn new EasyFillDialog({ getEditableFields: this._getEditableFields.bind(this) });\n\t\t\t\t});\n\n\t\t\teasyEditDialog.open();\n\t\t\tview?.addDependent(easyEditDialog);\n\t\t}\n\t}\n\n\tasync _getEditableFields(): Promise<unknown> {\n\t\t// Connect all sections\n\t\tconst allFields = this.getPageController()\n\t\t\t.getView()\n\t\t\t?.findAggregatedObjects(true, (control: ManagedObject): boolean => {\n\t\t\t\treturn control.isA(\"sap.fe.macros.Field\");\n\t\t\t}) as EnhanceWithUI5<Field>[];\n\t\tconst editableFields: Record<string, { isEditable: boolean }> = {};\n\t\tallFields.forEach((field) => {\n\t\t\tconst propertyRelativePath = field.getMainPropertyRelativePath();\n\t\t\tif (propertyRelativePath) {\n\t\t\t\tif (editableFields[propertyRelativePath] === undefined) {\n\t\t\t\t\teditableFields[propertyRelativePath] = { isEditable: field.getEditable() };\n\t\t\t\t} else {\n\t\t\t\t\t// If the field is already in the editableFields object, we combine the editable state, if at least one field is editable then we consider it editable\n\t\t\t\t\teditableFields[propertyRelativePath].isEditable =\n\t\t\t\t\t\teditableFields[propertyRelativePath].isEditable || field.getEditable();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\treturn Promise.resolve(editableFields);\n\t}\n\n\tcreateContent(): Button | undefined {\n\t\tif (this.getAppComponent()?.getEnvironmentCapabilities().getCapabilities().EasyEdit) {\n\t\t\tthis.getPageController()\n\t\t\t\t.getView()\n\t\t\t\t?.addDependent(<CommandExecution execute={this._easyEditDocument.bind(this)} command=\"EasyEdit\" />);\n\n\t\t\tconst button = (\n\t\t\t\t<Button\n\t\t\t\t\tid={this.createId(\"button\")}\n\t\t\t\t\tdt:designtime=\"not-adaptable\"\n\t\t\t\t\ttext={this.getTranslatedText(\"C_EASYEDIT_BUTTON\")}\n\t\t\t\t\ticon=\"sap-icon://ai\"\n\t\t\t\t\ttype={ButtonType.Ghost}\n\t\t\t\t\tjsx:command=\"cmd:EasyEdit|press\"\n\t\t\t\t/>\n\t\t\t);\n\t\t\tthis.setLayoutData(<OverflowToolbarLayoutData priority={OverflowToolbarPriority.High} />);\n\t\t\tFESRHelper.setSemanticStepname(button, \"press\", \"fe4:ef:easyfill\");\n\t\t\treturn button;\n\t\t}\n\t\tthis.setVisible(false);\n\t}\n\n\tgetOverflowToolbarConfig(): OverflowToolbarConfig {\n\t\treturn {\n\t\t\tcanOverflow: true\n\t\t};\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"EasyFillButton-dbg.js"}