{"version":3,"file":"FormHelper.js","names":["FormHelper","isReferenceFacetPartOfPreview","referenceFacet","partOfPreview","toString","$Type","annotatedTerm","create$Select","semanticKeys","secondaryKeys","keys","map","key","value","join","length","generateBindingExpression","navigationPath","dataModelObjectPath","targetEntityType","annotations","Common","SemanticKey","alternateAndSecondaryKeys","ModelHelper","getAlternateAndSecondaryKeys","targetEntitySet","undefined","binding","path","parameters","$select","JSON","stringify","getFormContainerTitleLevel","title","titleLevel","TitleLevel","H1","H2","H3","H4","H5","H6","Auto"],"sources":["./FormHelper.ts"],"sourcesContent":["import type { EntitySet, EntityType } from \"@sap-ux/vocabularies-types\";\nimport type { SemanticKey } from \"@sap-ux/vocabularies-types/vocabularies/Common\";\nimport type { PathInModelExpression } from \"sap/fe/base/BindingToolkit\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { TitleLevel } from \"sap/ui/core/library\";\n\n/**\n * Internally uses structure of a semantic key object\n */\n/**\n * Input parameter type for isReferenceFacetPartOfPreview\n */\ninterface ReferenceFacet {\n\t$Type?: string;\n\t\"@com.sap.vocabularies.UI.v1.PartOfPreview\"?: boolean | unknown;\n}\n\n/**\n * Helper class used by MDC controls for OData(V4) specific handling\n * @private\n */\nconst FormHelper = {\n\t/**\n\t * Method that checks, if a reference facet needs to be assigned to either \"blocks\" or \"moreBlocks\" (tagged by subsection property \"partOfPreview!).\n\t * @param referenceFacet Reference facet that needs to be assigned\n\t * @param partOfPreview Subsection property \"partOfPreview\" that needs to aligned with the reference facet's annotation \"PartOfPreview!\n\t * @param partOfPreview.toString\n\t * @returns True, if the ReferenceFacet has the same annotation as the subsection's property \"partOfPreview\"\n\t */\n\tisReferenceFacetPartOfPreview: function (referenceFacet: ReferenceFacet, partOfPreview: { toString(): string }): boolean {\n\t\tpartOfPreview = partOfPreview.toString();\n\t\tif (referenceFacet.$Type === \"com.sap.vocabularies.UI.v1.ReferenceFacet\") {\n\t\t\tconst annotatedTerm = referenceFacet[\"@com.sap.vocabularies.UI.v1.PartOfPreview\"];\n\t\t\treturn (partOfPreview === \"true\" && annotatedTerm !== false) || (partOfPreview === \"false\" && annotatedTerm === false);\n\t\t}\n\t\treturn false;\n\t},\n\n\t/**\n\t * Creates and returns a select query with the selected fields from the parameters passed.\n\t * @param semanticKeys SemanticKeys included in the entity set\n\t * @param secondaryKeys SecondaryKeys included in entity type\n\t * @returns The fields to be included in the select query\n\t */\n\tcreate$Select: function (semanticKeys?: SemanticKey, secondaryKeys?: string[]): string {\n\t\tlet keys = \"\";\n\t\tkeys = (semanticKeys || []).map((key) => key.value).join(\",\");\n\t\tif (keys) {\n\t\t\tkeys += secondaryKeys?.length ? \",\" + secondaryKeys.join(\",\") : \"\";\n\t\t} else {\n\t\t\tkeys = secondaryKeys?.length ? secondaryKeys.join(\",\") : keys;\n\t\t}\n\t\treturn keys;\n\t},\n\n\t/**\n\t * Generates the binding expression for the form.\n\t * @param navigationPath The navigation path defined for the entity\n\t * @param dataModelObjectPath DataModelObjectPath of the navigationPath\n\t * @returns The Binding expression including path and $select query as parameter depending on the function parameters\n\t */\n\tgenerateBindingExpression: function (\n\t\tnavigationPath?: string,\n\t\tdataModelObjectPath?: DataModelObjectPath<EntitySet>\n\t): string | undefined {\n\t\tconst semanticKeys = dataModelObjectPath?.targetEntityType?.annotations?.Common?.SemanticKey;\n\t\tconst alternateAndSecondaryKeys = ModelHelper.getAlternateAndSecondaryKeys(\n\t\t\tdataModelObjectPath?.targetEntityType as EntityType,\n\t\t\tdataModelObjectPath?.targetEntitySet as EntitySet\n\t\t);\n\t\tif (!navigationPath) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst binding: Partial<PathInModelExpression<undefined>> = {\n\t\t\tpath: navigationPath || \"\"\n\t\t};\n\t\tif (semanticKeys || alternateAndSecondaryKeys?.length) {\n\t\t\tbinding.parameters = { $select: FormHelper.create$Select(semanticKeys, alternateAndSecondaryKeys) };\n\t\t}\n\t\treturn JSON.stringify(binding);\n\t},\n\n\t/**\n\t * Calculates the title level for the containers in this form.\n\t *\n\t * If there is no form title, the form containers get the same header level as the form, otherwise the levels are incremented to reflect the deeper nesting.\n\t * @param [title] The title of the form\n\t * @param [titleLevel] The title level of the form\n\t * @returns The title level of the form containers\n\t */\n\tgetFormContainerTitleLevel: function (title?: string, titleLevel?: TitleLevel): TitleLevel | undefined {\n\t\tif (!title) {\n\t\t\treturn titleLevel;\n\t\t}\n\t\tswitch (titleLevel) {\n\t\t\tcase TitleLevel.H1:\n\t\t\t\treturn TitleLevel.H2;\n\t\t\tcase TitleLevel.H2:\n\t\t\t\treturn TitleLevel.H3;\n\t\t\tcase TitleLevel.H3:\n\t\t\t\treturn TitleLevel.H4;\n\t\t\tcase TitleLevel.H4:\n\t\t\t\treturn TitleLevel.H5;\n\t\t\tcase TitleLevel.H5:\n\t\t\tcase TitleLevel.H6:\n\t\t\t\treturn TitleLevel.H6;\n\t\t\tdefault:\n\t\t\t\treturn TitleLevel.Auto;\n\t\t}\n\t}\n};\n\nexport default FormHelper;\n"],"mappings":";;;;sHAsBA,MAAMA,EAAa,CAQlBC,8BAA+B,SAAUC,EAAgCC,GACxEA,EAAgBA,EAAcC,WAC9B,GAAIF,EAAeG,QAAU,4CAA6C,CACzE,MAAMC,EAAgBJ,EAAe,6CACrC,OAAQC,IAAkB,QAAUG,IAAkB,OAAWH,IAAkB,SAAWG,IAAkB,KACjH,CACA,OAAO,KACR,EAQAC,cAAe,SAAUC,EAA4BC,GACpD,IAAIC,EAAO,GACXA,GAAQF,GAAgB,IAAIG,IAAKC,GAAQA,EAAIC,OAAOC,KAAK,KACzD,GAAIJ,EAAM,CACTA,GAAQD,GAAeM,OAAS,IAAMN,EAAcK,KAAK,KAAO,EACjE,KAAO,CACNJ,EAAOD,GAAeM,OAASN,EAAcK,KAAK,KAAOJ,CAC1D,CACA,OAAOA,CACR,EAQAM,0BAA2B,SAC1BC,EACAC,GAEA,MAAMV,EAAeU,GAAqBC,kBAAkBC,aAAaC,QAAQC,YACjF,MAAMC,EAA4BC,EAAYC,6BAC7CP,GAAqBC,iBACrBD,GAAqBQ,iBAEtB,IAAKT,EAAgB,CACpB,OAAOU,SACR,CACA,MAAMC,EAAqD,CAC1DC,KAAMZ,GAAkB,IAEzB,GAAIT,GAAgBe,GAA2BR,OAAQ,CACtDa,EAAQE,WAAa,CAAEC,QAAS/B,EAAWO,cAAcC,EAAce,GACxE,CACA,OAAOS,KAAKC,UAAUL,EACvB,EAUAM,2BAA4B,SAAUC,EAAgBC,GACrD,IAAKD,EAAO,CACX,OAAOC,CACR,CACA,OAAQA,GACP,KAAKC,EAAWC,GACf,OAAOD,EAAWE,GACnB,KAAKF,EAAWE,GACf,OAAOF,EAAWG,GACnB,KAAKH,EAAWG,GACf,OAAOH,EAAWI,GACnB,KAAKJ,EAAWI,GACf,OAAOJ,EAAWK,GACnB,KAAKL,EAAWK,GAChB,KAAKL,EAAWM,GACf,OAAON,EAAWM,GACnB,QACC,OAAON,EAAWO,KAErB,GACC,OAEa5C,CAAU","ignoreList":[]}