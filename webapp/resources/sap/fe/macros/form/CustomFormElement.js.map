{"version":3,"file":"CustomFormElement.js","names":["CustomFormElement","_dec","defineUI5Class","_dec2","implementInterface","_dec3","property","type","required","_dec4","_dec5","_class","_class2","_BuildingBlock","properties","others","_this","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_exports","_inheritsLoose","_proto","prototype","getFormDoNotAdjustWidth","content","onMetadataAvailable","setUpSidesEffectHandlingForContent","metaPath","appComponent","getAppComponent","dataModelObjectForMetaPath","getDataModelObjectForMetaPath","contextPath","sideEffectService","getSideEffectsService","fieldGroupIds","computeFieldGroupIds","targetEntityType","fullyQualifiedName","targetObject","length","push","formElementKey","customControls","findAggregatedObjects","managedObject","isA","control","setUpSidesEffectHandlingForControl","getFieldGroupIds","setFieldGroupIds","attachValidateFieldGroup","event","Field","onValidateFieldGroup","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./CustomFormElement.tsx"],"sourcesContent":["import type { Property } from \"@sap-ux/vocabularies-types\";\nimport { defineUI5Class, implementInterface, property, type PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport Field from \"sap/fe/macros/Field\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type Control from \"sap/ui/core/Control\";\nimport type { $ControlSettings, Control$ValidateFieldGroupEvent } from \"sap/ui/core/Control\";\nimport type { IFormContent } from \"sap/ui/core/library\";\n\n@defineUI5Class(\"sap.fe.macros.form.CustomFormElement\")\nexport default class CustomFormElement extends BuildingBlock<Control> implements IFormContent {\n\t@implementInterface(\"sap.ui.core.IFormContent\")\n\t__implements__sap_ui_core_IFormContent = true;\n\n\t/**\n\t * Metadata path to the property used for the side effects.\n\t */\n\t@property({\n\t\ttype: \"string\",\n\t\trequired: true\n\t})\n\tpublic metaPath?: string;\n\n\t@property({\n\t\ttype: \"string\"\n\t})\n\tpublic contextPath?: string;\n\n\t/**\n\t * The key used to identify the custom form element (note that this is also the fragmentId).\n\t */\n\t@property({\n\t\ttype: \"string\",\n\t\trequired: true\n\t})\n\tpublic formElementKey?: string;\n\n\tfieldGroupIds?: string[];\n\n\tconstructor(properties: $ControlSettings & PropertiesOf<CustomFormElement>, others?: $ControlSettings) {\n\t\tsuper(properties, others);\n\t}\n\n\tgetFormDoNotAdjustWidth(): boolean {\n\t\treturn (this.content as unknown as IFormContent)?.getFormDoNotAdjustWidth?.() ?? false;\n\t}\n\n\tonMetadataAvailable(): void {\n\t\tthis.setUpSidesEffectHandlingForContent();\n\t}\n\n\t/**\n\t * Sets up side effect handling for the content of the custom form element.\n\t */\n\tsetUpSidesEffectHandlingForContent(): void {\n\t\tif (!this.content || !this.metaPath) {\n\t\t\treturn;\n\t\t}\n\t\tconst appComponent = this.getAppComponent();\n\t\tconst dataModelObjectForMetaPath = this.getDataModelObjectForMetaPath<Property>(this.metaPath, this.contextPath);\n\t\tif (!appComponent || !dataModelObjectForMetaPath) {\n\t\t\treturn;\n\t\t}\n\t\tconst sideEffectService = appComponent.getSideEffectsService();\n\t\tthis.fieldGroupIds = sideEffectService.computeFieldGroupIds(\n\t\t\tdataModelObjectForMetaPath.targetEntityType?.fullyQualifiedName ?? \"\",\n\t\t\tdataModelObjectForMetaPath.targetObject?.fullyQualifiedName ?? \"\"\n\t\t);\n\t\tif (this.fieldGroupIds.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\t// we add a unique fieldGroupId based on the fragmentID taht will be used to trigger specific handling\n\t\t// that fires immediate side effects and register non immediate\n\t\tthis.fieldGroupIds.push(`fe_sideEffectHandling_${this.formElementKey}`);\n\n\t\tconst customControls =\n\t\t\t(this.content?.findAggregatedObjects(true, (managedObject: ManagedObject) =>\n\t\t\t\tmanagedObject.isA<Control>(\"sap.ui.core.Control\")\n\t\t\t) as Control[] | undefined) ?? [];\n\t\tfor (const control of customControls) {\n\t\t\tthis.setUpSidesEffectHandlingForControl(control);\n\t\t}\n\t}\n\n\t/**\n\t * Sets up side effect handling for a control.\n\t * @param control\n\t */\n\tsetUpSidesEffectHandlingForControl(control: Control): void {\n\t\tif (control.getFieldGroupIds()?.length) {\n\t\t\t// there is already some fieldgroup handling  do not overwrite it\n\t\t\treturn;\n\t\t}\n\t\tcontrol.setFieldGroupIds(this.fieldGroupIds);\n\t\tcontrol.attachValidateFieldGroup((event: Control$ValidateFieldGroupEvent) => {\n\t\t\t(Field as unknown as { onValidateFieldGroup: Function }).onValidateFieldGroup(event);\n\t\t});\n\t}\n}\n"],"mappings":";;;;urCAUqBA,GAAiBC,EADrCC,EAAe,wCAAuCC,EAErDC,EAAmB,4BAA2BC,EAM9CC,EAAS,CACTC,KAAM,SACNC,SAAU,OACTC,EAGDH,EAAS,CACTC,KAAM,WACLG,EAMDJ,EAAS,CACTC,KAAM,SACNC,SAAU,OACTP,EAAAU,GAAAC,EAAA,SAAAC,GAKF,SAAAb,EAAYc,EAAgEC,GAA2B,IAAAC,EACtGA,EAAAH,EAAAI,KAAAC,KAAMJ,EAAYC,IAAOG,KAACC,EAAAH,EAAA,yCAAAI,EAAAJ,GA1B3BG,EAAAH,EAAA,WAAAK,EAAAL,GAAAG,EAAAH,EAAA,cAAAM,EAAAN,GAcAG,EAAAH,EAAA,iBAAAO,EAAAP,GAAA,OAAAA,CAaA,CAACQ,EAAAxB,EAAAyB,EAAAzB,EAAAa,GAAA,IAAAa,EAAA1B,EAAA2B,UAAAD,EAEDE,wBAAA,SAAAA,IACC,OAAQV,KAAKW,SAAqCD,6BAA+B,KAClF,EAACF,EAEDI,oBAAA,SAAAA,IACCZ,KAAKa,oCACN,EAEAL,EAGAK,mCAAA,SAAAA,IACC,IAAKb,KAAKW,UAAYX,KAAKc,SAAU,CACpC,MACD,CACA,MAAMC,EAAef,KAAKgB,kBAC1B,MAAMC,EAA6BjB,KAAKkB,8BAAwClB,KAAKc,SAAUd,KAAKmB,aACpG,IAAKJ,IAAiBE,EAA4B,CACjD,MACD,CACA,MAAMG,EAAoBL,EAAaM,wBACvCrB,KAAKsB,cAAgBF,EAAkBG,qBACtCN,EAA2BO,kBAAkBC,oBAAsB,GACnER,EAA2BS,cAAcD,oBAAsB,IAEhE,GAAIzB,KAAKsB,cAAcK,SAAW,EAAG,CACpC,MACD,CAGA3B,KAAKsB,cAAcM,KAAK,yBAAyB5B,KAAK6B,kBAEtD,MAAMC,EACJ9B,KAAKW,SAASoB,sBAAsB,KAAOC,GAC3CA,EAAcC,IAAa,yBACG,GAChC,IAAK,MAAMC,KAAWJ,EAAgB,CACrC9B,KAAKmC,mCAAmCD,EACzC,CACD,EAEA1B,EAIA2B,mCAAA,SAAAA,EAAmCD,GAClC,GAAIA,EAAQE,oBAAoBT,OAAQ,CAEvC,MACD,CACAO,EAAQG,iBAAiBrC,KAAKsB,eAC9BY,EAAQI,yBAA0BC,IAChCC,EAAwDC,qBAAqBF,IAEhF,EAAC,OAAAzD,CAAA,CA/DC,CAxB4C4D,GAAaxC,EAAAyC,EAAAjD,EAAAe,UAAA,0CAAAxB,GAAA,CAAA2D,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,kBAElB,IAAI,IAAA5C,EAAAwC,EAAAjD,EAAAe,UAAA,YAAAtB,GAAA,CAAAyD,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAA3C,EAAAuC,EAAAjD,EAAAe,UAAA,eAAAlB,GAAA,CAAAqD,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAA1C,EAAAsC,EAAAjD,EAAAe,UAAA,kBAAAjB,GAAA,CAAAoD,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAArD,KAAAD,GAAAa,EAAAxB,EAAA,OAAAwB,CAAA","ignoreList":[]}