{"version":3,"names":["FormAPI","_dec","defineUI5Class","_dec2","implementInterface","_dec3","property","type","_dec4","expectedAnnotations","expectedTypes","_dec5","_class","_class2","_MacroAPI","_this","_len","arguments","length","args","Array","_key","call","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_inheritsLoose","_proto","prototype","getSectionContentRole","getDataFromProvider","useSingleTextAreaFieldAsNotes","formContent","content","formContainers","getFormContainers","forEach","formContainer","FormContainerAPI","setTextAreaLabelVisibility","formTitle","formContentTitle","getTitle","getText","setTitle","title","formContainerTitle","formActionToolbarTitleControl","getAggregation","getContent","innerControl","isA","formActionToolbarTitle","MTitle","MacroAPI","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["FormAPI.ts"],"sourcesContent":["import { defineUI5Class, implementInterface, property } from \"sap/fe/base/ClassSupport\";\nimport type ISingleSectionContributor from \"sap/fe/macros/controls/section/ISingleSectionContributor\";\nimport type { ProviderData } from \"sap/fe/macros/controls/section/ISingleSectionContributor\";\nimport type OverflowToolbar from \"sap/m/OverflowToolbar\";\nimport MTitle from \"sap/m/Title\";\nimport type Control from \"sap/ui/core/Control\";\nimport type Title from \"sap/ui/core/Title\";\nimport type Form from \"sap/ui/layout/form/Form\";\nimport type FormContainer from \"sap/ui/layout/form/FormContainer\";\nimport MacroAPI from \"../MacroAPI\";\nimport FormContainerAPI from \"./FormContainerAPI\";\n\n@defineUI5Class(\"sap.fe.macros.form.FormAPI\")\nclass FormAPI extends MacroAPI implements ISingleSectionContributor {\n\t@implementInterface(\"sap.fe.macros.controls.section.ISingleSectionContributor\")\n\t__implements__sap_fe_macros_controls_section_ISingleSectionContributor = true;\n\n\tgetSectionContentRole(): \"provider\" | \"consumer\" {\n\t\treturn \"provider\";\n\t}\n\n\t/**\n\t * Implementation of the getDataFromProvider method which is a part of the ISingleSectionContributor\n\t *\n\t * Will be called from the sap.fe.macros.controls.Section control when there is a Form building block rendered within a section\n\t * and the form's title would be provided to the Section and accordingly adjusted here.\n\t *\n\t */\n\n\tgetDataFromProvider(useSingleTextAreaFieldAsNotes: boolean): ProviderData {\n\t\tconst formContent = this.content as Form;\n\t\tconst formContainers = formContent.getFormContainers();\n\t\tif (useSingleTextAreaFieldAsNotes && formContainers.length) {\n\t\t\tformContainers.forEach((formContainer: FormContainer) => {\n\t\t\t\tFormContainerAPI.setTextAreaLabelVisibility(formContainer);\n\t\t\t});\n\t\t}\n\t\t// if the form's content directly has a title\n\t\tlet formTitle = \"\";\n\t\tif (formContainers.length === 1) {\n\t\t\tconst formContentTitle = (formContent.getTitle() as Title)?.getText();\n\t\t\tif (formContentTitle) {\n\t\t\t\tformTitle = formContentTitle;\n\t\t\t\tformContent.setTitle(\"\");\n\t\t\t\treturn {\n\t\t\t\t\ttitle: formTitle\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tconst formContainerTitle = (formContainers[0]?.getTitle() as Title)?.getText();\n\t\t\t//if the title from the formContainer needs to be fetched\n\t\t\tif (formContainerTitle && formContainerTitle !== \"\") {\n\t\t\t\tformTitle = formContainerTitle;\n\t\t\t}\n\n\t\t\t// if the title needs to be fetched from the toolbar aggregation's content of form container\n\t\t\tlet formActionToolbarTitleControl;\n\t\t\t(formContainers[0].getAggregation(\"toolbar\") as OverflowToolbar)?.getContent().forEach(function (innerControl: Control) {\n\t\t\t\tif (innerControl.isA<MTitle>(\"sap.m.Title\")) {\n\t\t\t\t\tformActionToolbarTitleControl = innerControl;\n\t\t\t\t\tconst formActionToolbarTitle = innerControl.getText();\n\t\t\t\t\tif (formActionToolbarTitle && formActionToolbarTitle != \"\") {\n\t\t\t\t\t\tformTitle = innerControl.getText();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (formTitle && formTitle !== \"\") {\n\t\t\t\tformContainers[0]?.setTitle(\"\");\n\t\t\t\t//this is needed to handle cases where title is present for both formContainer and the form action toolbar, but the title rendered on the UI is the one coming from one of those\n\t\t\t\t(formActionToolbarTitleControl as unknown as MTitle)?.setTitle(new MTitle(\"\"));\n\t\t\t\treturn {\n\t\t\t\t\ttitle: formTitle\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\ttitle: formTitle\n\t\t};\n\t}\n\n\t/**\n\t * The identifier of the form control.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tid!: string;\n\n\t/**\n\t * Defines the relative path of the property in the metamodel, based on the current contextPath.\n\t * @public\n\t */\n\t@property({\n\t\ttype: \"string\",\n\t\texpectedAnnotations: [\n\t\t\t\"@com.sap.vocabularies.UI.v1.FieldGroup\",\n\t\t\t\"@com.sap.vocabularies.UI.v1.CollectionFacet\",\n\t\t\t\"@com.sap.vocabularies.UI.v1.ReferenceFacet\"\n\t\t],\n\t\texpectedTypes: [\"EntitySet\", \"EntityType\", \"Singleton\", \"NavigationProperty\"]\n\t})\n\tmetaPath!: string;\n\n\t/**\n\t * The title of the form control.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\ttitle!: string;\n}\n\nexport default FormAPI;\n"],"mappings":"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","ignoreList":[],"file":"FormAPI-dbg.js"}