{"version":3,"names":["FormContainerAPI","_dec","defineUI5Class","_dec2","property","type","_dec3","_dec4","xmlEventHandler","_class","_class2","_FormContainerAPI","_MacroAPI","props","_this","call","_initializerDefineProperty","_descriptor","_descriptor2","setParentBindingContext","formContainerId","_inheritsLoose","_proto","prototype","onMetadataAvailable","ownerComponent","view","getRootController","getView","formContainer","byId","setFormElementsInvisibleTextsToStatic","attachEventOnce","bind","formElements","getFormElements","forEach","formElement","dependents","getDependents","dependent","isA","toStatic","setInvisibleTextWhereTextAreaLabelIsHidden","field","addDependent","InvisibleText","generate","getId","text","getLabel","setLabel","Label","visible","layoutData","ColumnElementData","cellsLarge","addAriaLabelledBy","setTextAreaLabelVisibility","allFormElements","filter","getVisible","length","fields","getFields","control","Field","getControlInFieldWrapper","getContent","isTextArea","isRequired","getRequired","pageMode","getParent","editMode","getLabelControl","setVisible","textAreaLabelVisibility","isInvisibleTextAdded","find","toggleDetails","showDetails","MacroAPI","isDependentBound","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer","Object","getOwnPropertyDescriptor"],"sourceRoot":".","sources":["FormContainerAPI.ts"],"sourcesContent":["import type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { defineUI5Class, property, xmlEventHandler } from \"sap/fe/base/ClassSupport\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport Field from \"sap/fe/macros/Field\";\nimport type FieldWrapper from \"sap/fe/macros/controls/FieldWrapper\";\nimport Label from \"sap/m/Label\";\nimport type Control from \"sap/ui/core/Control\";\nimport InvisibleText from \"sap/ui/core/InvisibleText\";\nimport ColumnElementData from \"sap/ui/layout/form/ColumnElementData\";\nimport type FormContainer from \"sap/ui/layout/form/FormContainer\";\nimport type FormElement from \"sap/ui/layout/form/FormElement\";\nimport type mdcField from \"sap/ui/mdc/Field\";\nimport MacroAPI from \"../MacroAPI\";\n\n/**\n * @alias sap.fe.macros.form.FormContainerAPI\n * @private\n */\n@defineUI5Class(\"sap.fe.macros.form.FormContainerAPI\")\nclass FormContainerAPI extends MacroAPI {\n\t/**\n\t * The identifier of the form container control.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tformContainerId!: string;\n\n\t@property({ type: \"boolean\" })\n\tshowDetails = false;\n\n\tstatic isDependentBound = true;\n\n\tconstructor(props?: PropertiesOf<FormContainerAPI>) {\n\t\tsuper(props);\n\t\tthis.setParentBindingContext(\"internal\", `controls/${this.formContainerId}`);\n\t}\n\n\t/**\n\t * Handler for the onMetadataAvailable event.\n\t * @param ownerComponent\n\t */\n\tonMetadataAvailable(ownerComponent: TemplateComponent): void {\n\t\tconst view = ownerComponent.getRootController()?.getView();\n\t\tif (!view) {\n\t\t\treturn;\n\t\t}\n\t\tlet formContainer = view.byId(this.formContainerId) as FormContainer | undefined;\n\t\tif (formContainer) {\n\t\t\tthis.setFormElementsInvisibleTextsToStatic(formContainer);\n\t\t} else {\n\t\t\tview.attachEventOnce(\n\t\t\t\t\"afterRendering\",\n\t\t\t\tfunction (this: FormContainerAPI): void {\n\t\t\t\t\tformContainer = view.byId(this.formContainerId) as FormContainer | undefined;\n\t\t\t\t\tif (formContainer) {\n\t\t\t\t\t\tthis.setFormElementsInvisibleTextsToStatic(formContainer);\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Sets the Invisible Texts to static.\n\t * @param formContainer FormContainer control.\n\t */\n\tsetFormElementsInvisibleTextsToStatic(formContainer: FormContainer): void {\n\t\tconst formElements = formContainer.getFormElements();\n\t\tformElements.forEach((formElement: FormElement) => {\n\t\t\tconst dependents = formElement.getDependents();\n\t\t\tdependents.forEach((dependent) => {\n\t\t\t\tif (dependent.isA<InvisibleText>(\"sap.ui.core.InvisibleText\")) {\n\t\t\t\t\tdependent.toStatic();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Sets the InvisibleText when the TextArea Label is hidden.\n\t * @param formElement FormElement control.\n\t * @param field Field control.\n\t */\n\tstatic setInvisibleTextWhereTextAreaLabelIsHidden(formElement: FormElement, field: mdcField): void {\n\t\tformElement.addDependent(new InvisibleText(generate([field.getId(), \"FormElementAriaText\"]), { text: formElement.getLabel() }));\n\t\tformElement.setLabel(\n\t\t\tnew Label(generate([field.getId(), \"FormElementLabel\"]), {\n\t\t\t\ttext: formElement.getLabel(),\n\t\t\t\tvisible: false,\n\t\t\t\tlayoutData: new ColumnElementData({ cellsLarge: 12 })\n\t\t\t})\n\t\t);\n\t\tfield.addAriaLabelledBy(generate([field.getId(), \"FormElementAriaText\"]));\n\t}\n\n\t/**\n\t * Sets the TextArea Label's Visibility.\n\t * @param formContainer FormContainer control.\n\t */\n\tstatic setTextAreaLabelVisibility(formContainer: FormContainer): void {\n\t\tconst allFormElements = formContainer.getFormElements();\n\t\tconst formElements = allFormElements.filter((formElement) => formElement.getVisible());\n\t\tif (formElements.length === 1) {\n\t\t\tconst fields = formElements[0].getFields();\n\t\t\tif (fields.length === 1) {\n\t\t\t\tconst control = Field.getControlInFieldWrapper((fields[0] as mdcField).getContent());\n\t\t\t\tconst isTextArea = control?.isA(\"sap.fe.macros.field.TextAreaEx\");\n\t\t\t\tconst isRequired = (fields[0] as mdcField).getRequired() === true;\n\t\t\t\tconst pageMode = (control?.getParent() as FieldWrapper).editMode;\n\t\t\t\tif (isTextArea && isRequired && pageMode !== \"Display\") {\n\t\t\t\t\t(formElements[0].getLabelControl() as unknown as Control).setVisible(true);\n\t\t\t\t}\n\t\t\t\tif (control?.isA(\"sap.m.ExpandableText\") && pageMode === \"Display\") {\n\t\t\t\t\t(formElements[0].getLabelControl() as unknown as Control).setVisible(false);\n\t\t\t\t}\n\t\t\t\tconst textAreaLabelVisibility = (formElements[0].getLabelControl() as unknown as Control).getVisible();\n\t\t\t\tconst dependents = formElements[0].getDependents();\n\t\t\t\tconst isInvisibleTextAdded = dependents.find((dependent) => dependent.isA<InvisibleText>(\"sap.ui.core.InvisibleText\"));\n\t\t\t\tif (!textAreaLabelVisibility && !isInvisibleTextAdded) {\n\t\t\t\t\tthis.setInvisibleTextWhereTextAreaLabelIsHidden(formElements[0], fields[0] as mdcField);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t@xmlEventHandler()\n\ttoggleDetails(): void {\n\t\tthis.showDetails = !this.showDetails;\n\t}\n}\n\nexport default FormContainerAPI;\n"],"mappings":"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","ignoreList":[],"file":"FormContainerAPI-dbg.js"}