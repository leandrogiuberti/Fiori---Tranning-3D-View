{"version":3,"names":["CustomFormElement","_dec","defineUI5Class","_dec2","implementInterface","_dec3","property","type","required","_dec4","_dec5","_class","_class2","_BuildingBlock","properties","others","_this","call","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_exports","_inheritsLoose","_proto","prototype","getFormDoNotAdjustWidth","content","onMetadataAvailable","setUpSidesEffectHandlingForContent","metaPath","appComponent","getAppComponent","dataModelObjectForMetaPath","getDataModelObjectForMetaPath","contextPath","sideEffectService","getSideEffectsService","fieldGroupIds","computeFieldGroupIds","targetEntityType","fullyQualifiedName","targetObject","length","push","formElementKey","customControls","findAggregatedObjects","managedObject","isA","control","setUpSidesEffectHandlingForControl","getFieldGroupIds","setFieldGroupIds","attachValidateFieldGroup","event","Field","onValidateFieldGroup","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["CustomFormElement.tsx"],"sourcesContent":["import type { Property } from \"@sap-ux/vocabularies-types\";\nimport { defineUI5Class, implementInterface, property, type PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport Field from \"sap/fe/macros/Field\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type Control from \"sap/ui/core/Control\";\nimport type { $ControlSettings, Control$ValidateFieldGroupEvent } from \"sap/ui/core/Control\";\nimport type { IFormContent } from \"sap/ui/core/library\";\n\n@defineUI5Class(\"sap.fe.macros.form.CustomFormElement\")\nexport default class CustomFormElement extends BuildingBlock<Control> implements IFormContent {\n\t@implementInterface(\"sap.ui.core.IFormContent\")\n\t__implements__sap_ui_core_IFormContent = true;\n\n\t/**\n\t * Metadata path to the property used for the side effects.\n\t */\n\t@property({\n\t\ttype: \"string\",\n\t\trequired: true\n\t})\n\tpublic metaPath?: string;\n\n\t@property({\n\t\ttype: \"string\"\n\t})\n\tpublic contextPath?: string;\n\n\t/**\n\t * The key used to identify the custom form element (note that this is also the fragmentId).\n\t */\n\t@property({\n\t\ttype: \"string\",\n\t\trequired: true\n\t})\n\tpublic formElementKey?: string;\n\n\tfieldGroupIds?: string[];\n\n\tconstructor(properties: $ControlSettings & PropertiesOf<CustomFormElement>, others?: $ControlSettings) {\n\t\tsuper(properties, others);\n\t}\n\n\tgetFormDoNotAdjustWidth(): boolean {\n\t\treturn (this.content as unknown as IFormContent)?.getFormDoNotAdjustWidth?.() ?? false;\n\t}\n\n\tonMetadataAvailable(): void {\n\t\tthis.setUpSidesEffectHandlingForContent();\n\t}\n\n\t/**\n\t * Sets up side effect handling for the content of the custom form element.\n\t */\n\tsetUpSidesEffectHandlingForContent(): void {\n\t\tif (!this.content || !this.metaPath) {\n\t\t\treturn;\n\t\t}\n\t\tconst appComponent = this.getAppComponent();\n\t\tconst dataModelObjectForMetaPath = this.getDataModelObjectForMetaPath<Property>(this.metaPath, this.contextPath);\n\t\tif (!appComponent || !dataModelObjectForMetaPath) {\n\t\t\treturn;\n\t\t}\n\t\tconst sideEffectService = appComponent.getSideEffectsService();\n\t\tthis.fieldGroupIds = sideEffectService.computeFieldGroupIds(\n\t\t\tdataModelObjectForMetaPath.targetEntityType?.fullyQualifiedName ?? \"\",\n\t\t\tdataModelObjectForMetaPath.targetObject?.fullyQualifiedName ?? \"\"\n\t\t);\n\t\tif (this.fieldGroupIds.length === 0) {\n\t\t\treturn;\n\t\t}\n\t\t// we add a unique fieldGroupId based on the fragmentID taht will be used to trigger specific handling\n\t\t// that fires immediate side effects and register non immediate\n\t\tthis.fieldGroupIds.push(`fe_sideEffectHandling_${this.formElementKey}`);\n\n\t\tconst customControls =\n\t\t\t(this.content?.findAggregatedObjects(true, (managedObject: ManagedObject) =>\n\t\t\t\tmanagedObject.isA<Control>(\"sap.ui.core.Control\")\n\t\t\t) as Control[] | undefined) ?? [];\n\t\tfor (const control of customControls) {\n\t\t\tthis.setUpSidesEffectHandlingForControl(control);\n\t\t}\n\t}\n\n\t/**\n\t * Sets up side effect handling for a control.\n\t * @param control\n\t */\n\tsetUpSidesEffectHandlingForControl(control: Control): void {\n\t\tif (control.getFieldGroupIds()?.length) {\n\t\t\t// there is already some fieldgroup handling  do not overwrite it\n\t\t\treturn;\n\t\t}\n\t\tcontrol.setFieldGroupIds(this.fieldGroupIds);\n\t\tcontrol.attachValidateFieldGroup((event: Control$ValidateFieldGroupEvent) => {\n\t\t\t(Field as unknown as { onValidateFieldGroup: Function }).onValidateFieldGroup(event);\n\t\t});\n\t}\n}\n"],"mappings":"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","ignoreList":[],"file":"CustomFormElement-dbg.js"}