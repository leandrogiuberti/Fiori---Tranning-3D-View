{"version":3,"file":"FormContainerAPI.js","names":["FormContainerAPI","_dec","defineUI5Class","_dec2","property","type","_dec3","_dec4","xmlEventHandler","_class","_class2","_FormContainerAPI","_MacroAPI","props","_this","call","this","_initializerDefineProperty","_descriptor","_descriptor2","setParentBindingContext","formContainerId","_inheritsLoose","_proto","prototype","onMetadataAvailable","ownerComponent","view","getRootController","getView","formContainer","byId","setFormElementsInvisibleTextsToStatic","attachEventOnce","bind","formElements","getFormElements","forEach","formElement","dependents","getDependents","dependent","isA","toStatic","setInvisibleTextWhereTextAreaLabelIsHidden","field","addDependent","InvisibleText","generate","getId","text","getLabel","setLabel","Label","visible","layoutData","ColumnElementData","cellsLarge","addAriaLabelledBy","setTextAreaLabelVisibility","allFormElements","filter","getVisible","length","fields","getFields","control","Field","getControlInFieldWrapper","getContent","isTextArea","isRequired","getRequired","pageMode","getParent","editMode","getLabelControl","setVisible","textAreaLabelVisibility","isInvisibleTextAdded","find","toggleDetails","showDetails","MacroAPI","isDependentBound","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer","Object","getOwnPropertyDescriptor"],"sources":["./FormContainerAPI.ts"],"sourcesContent":["import type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { defineUI5Class, property, xmlEventHandler } from \"sap/fe/base/ClassSupport\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport Field from \"sap/fe/macros/Field\";\nimport type FieldWrapper from \"sap/fe/macros/controls/FieldWrapper\";\nimport Label from \"sap/m/Label\";\nimport type Control from \"sap/ui/core/Control\";\nimport InvisibleText from \"sap/ui/core/InvisibleText\";\nimport ColumnElementData from \"sap/ui/layout/form/ColumnElementData\";\nimport type FormContainer from \"sap/ui/layout/form/FormContainer\";\nimport type FormElement from \"sap/ui/layout/form/FormElement\";\nimport type mdcField from \"sap/ui/mdc/Field\";\nimport MacroAPI from \"../MacroAPI\";\n\n/**\n * @alias sap.fe.macros.form.FormContainerAPI\n * @private\n */\n@defineUI5Class(\"sap.fe.macros.form.FormContainerAPI\")\nclass FormContainerAPI extends MacroAPI {\n\t/**\n\t * The identifier of the form container control.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tformContainerId!: string;\n\n\t@property({ type: \"boolean\" })\n\tshowDetails = false;\n\n\tstatic isDependentBound = true;\n\n\tconstructor(props?: PropertiesOf<FormContainerAPI>) {\n\t\tsuper(props);\n\t\tthis.setParentBindingContext(\"internal\", `controls/${this.formContainerId}`);\n\t}\n\n\t/**\n\t * Handler for the onMetadataAvailable event.\n\t * @param ownerComponent\n\t */\n\tonMetadataAvailable(ownerComponent: TemplateComponent): void {\n\t\tconst view = ownerComponent.getRootController()?.getView();\n\t\tif (!view) {\n\t\t\treturn;\n\t\t}\n\t\tlet formContainer = view.byId(this.formContainerId) as FormContainer | undefined;\n\t\tif (formContainer) {\n\t\t\tthis.setFormElementsInvisibleTextsToStatic(formContainer);\n\t\t} else {\n\t\t\tview.attachEventOnce(\n\t\t\t\t\"afterRendering\",\n\t\t\t\tfunction (this: FormContainerAPI): void {\n\t\t\t\t\tformContainer = view.byId(this.formContainerId) as FormContainer | undefined;\n\t\t\t\t\tif (formContainer) {\n\t\t\t\t\t\tthis.setFormElementsInvisibleTextsToStatic(formContainer);\n\t\t\t\t\t}\n\t\t\t\t}.bind(this)\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Sets the Invisible Texts to static.\n\t * @param formContainer FormContainer control.\n\t */\n\tsetFormElementsInvisibleTextsToStatic(formContainer: FormContainer): void {\n\t\tconst formElements = formContainer.getFormElements();\n\t\tformElements.forEach((formElement: FormElement) => {\n\t\t\tconst dependents = formElement.getDependents();\n\t\t\tdependents.forEach((dependent) => {\n\t\t\t\tif (dependent.isA<InvisibleText>(\"sap.ui.core.InvisibleText\")) {\n\t\t\t\t\tdependent.toStatic();\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Sets the InvisibleText when the TextArea Label is hidden.\n\t * @param formElement FormElement control.\n\t * @param field Field control.\n\t */\n\tstatic setInvisibleTextWhereTextAreaLabelIsHidden(formElement: FormElement, field: mdcField): void {\n\t\tformElement.addDependent(new InvisibleText(generate([field.getId(), \"FormElementAriaText\"]), { text: formElement.getLabel() }));\n\t\tformElement.setLabel(\n\t\t\tnew Label(generate([field.getId(), \"FormElementLabel\"]), {\n\t\t\t\ttext: formElement.getLabel(),\n\t\t\t\tvisible: false,\n\t\t\t\tlayoutData: new ColumnElementData({ cellsLarge: 12 })\n\t\t\t})\n\t\t);\n\t\tfield.addAriaLabelledBy(generate([field.getId(), \"FormElementAriaText\"]));\n\t}\n\n\t/**\n\t * Sets the TextArea Label's Visibility.\n\t * @param formContainer FormContainer control.\n\t */\n\tstatic setTextAreaLabelVisibility(formContainer: FormContainer): void {\n\t\tconst allFormElements = formContainer.getFormElements();\n\t\tconst formElements = allFormElements.filter((formElement) => formElement.getVisible());\n\t\tif (formElements.length === 1) {\n\t\t\tconst fields = formElements[0].getFields();\n\t\t\tif (fields.length === 1) {\n\t\t\t\tconst control = Field.getControlInFieldWrapper((fields[0] as mdcField).getContent());\n\t\t\t\tconst isTextArea = control?.isA(\"sap.fe.macros.field.TextAreaEx\");\n\t\t\t\tconst isRequired = (fields[0] as mdcField).getRequired() === true;\n\t\t\t\tconst pageMode = (control?.getParent() as FieldWrapper).editMode;\n\t\t\t\tif (isTextArea && isRequired && pageMode !== \"Display\") {\n\t\t\t\t\t(formElements[0].getLabelControl() as unknown as Control).setVisible(true);\n\t\t\t\t}\n\t\t\t\tif (control?.isA(\"sap.m.ExpandableText\") && pageMode === \"Display\") {\n\t\t\t\t\t(formElements[0].getLabelControl() as unknown as Control).setVisible(false);\n\t\t\t\t}\n\t\t\t\tconst textAreaLabelVisibility = (formElements[0].getLabelControl() as unknown as Control).getVisible();\n\t\t\t\tconst dependents = formElements[0].getDependents();\n\t\t\t\tconst isInvisibleTextAdded = dependents.find((dependent) => dependent.isA<InvisibleText>(\"sap.ui.core.InvisibleText\"));\n\t\t\t\tif (!textAreaLabelVisibility && !isInvisibleTextAdded) {\n\t\t\t\t\tthis.setInvisibleTextWhereTextAreaLabelIsHidden(formElements[0], fields[0] as mdcField);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t@xmlEventHandler()\n\ttoggleDetails(): void {\n\t\tthis.showDetails = !this.showDetails;\n\t}\n}\n\nexport default FormContainerAPI;\n"],"mappings":"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","ignoreList":[]}