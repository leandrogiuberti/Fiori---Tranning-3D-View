/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/util/deepClone","sap/fe/core/CommonUtils","sap/m/Button","sap/m/CheckBox","sap/m/Dialog","sap/m/Input","sap/m/InputListItem","sap/m/List","sap/m/MessageStrip","sap/m/MultiInput","sap/m/Select","sap/m/Token","sap/ui/core/Component","sap/ui/core/Item","sap/ui/model/json/JSONModel"],function(e,t,n,o,a,r,i,s,c,d,p,u,f,l,g){"use strict";var h={};function m(e,t,n){const o={};e.forEach(function(e){if(typeof t[e.id]!=="object"&&t[e.id]!==n[e.id]||typeof t[e.id]==="object"&&JSON.stringify(t[e.id])!==JSON.stringify(n[e.id])){if(e.writeObject&&n[e.id]===e.writeObjectFor){const t={};if(e.writeObject&&e.writeObject?.length>0){e.writeObject.forEach(function(e){t[e.path?e.path:e.id]=n[e.id]})}o[e.path?e.path:e.id]=t}else if(!e.skipChange){o[e.path?e.path:e.id]=n[e.id]}}});return o}h.getChangedPropertyValues=m;function y(e,t,n,o){return{appComponent:e,selector:e,changeSpecificData:{appDescriptorChangeType:"appdescr_fe_changePageConfiguration",content:{parameters:{page:t,entityPropertyChange:{propertyPath:n,operation:"UPSERT",propertyValue:o}}}}}}h.getChangeStructure=y;function C(e,t){for(const n in e){if(n!=="id"&&typeof e[n]==="string"){e[n]=t.getText(e[n])}}}function w(e,t){const n=e.getData();n.forEach(e=>{C(e,t);e.control.forEach(e=>{C(e,t);e.enum?.forEach(e=>{C(e,t)})})})}function P(t,n,a){let c=arguments.length>3&&arguments[3]!==undefined?arguments[3]:"rta/configSettings";const f=new g;f.setData(e(t.getProperty(c)));w(f,a);const h=new s;h.setModel(f);const m=e=>{const t=["personalizationSort","personalizationColumn","personalizationFilter","personalizationGroup"];const o=e==="Own Settings";if(o){t.forEach(e=>{const t=h.getItems();for(const o of t){const t=o.getContent();for(const o of t){if(o.data("id")===e){if(o.setSelected){o.setSelected(false);n[e]=false}break}}}})}};const y=new i({label:"{label}"});y.bindContent({path:"control",factory:function(e,t){const a=t.getProperty("type");const i=t.getProperty("id");switch(a){case"string":if(t.getProperty("enum")){const e=new l({text:"{name}",key:"{id}"});const t=new p({selectedKey:"{value}",change:function(e){n[this.data("id")]=e.getParameter("selectedItem").getKey()}}).data("id",i);t.bindItems({path:"enum",template:e});return t}else{return new r({value:"{value}",change:function(e){n[this.data("id")]=e.getParameter("value")}}).data("id",i)}case"string[]":const e=new d({width:"70%",showValueHelp:false,showClearIcon:true,tokens:(n?.navigationProperties).map(e=>new u({text:e,key:e})),tokenUpdate:function(e){const t=n[this.data("id")];if(e.getParameter("addedTokens")?.length>0){t.push((e?.getParameter("addedTokens"))[0]?.getProperty("key"))}else if(e.getParameter("removedTokens")?.length>0){t.splice(t.indexOf((e?.getParameter("removedTokens"))[0]?.getProperty("key")),1)}}}).data("id",i);e.addValidator(function(e){const t=e.text;return new u({key:t,text:t})});return e;case"number":return new r({value:"{value}",type:"Number",change:function(e){n[this.data("id")]=e.getParameter("value")}}).data("id",i);case"boolean":return new o({selected:"{value}",select:function(e){n[this.data("id")]=e.getParameter("selected")}}).data("id",i);case"booleanOrString":const a=new l({text:"{name}",key:"{id}"});const s=new p({selectedKey:"{value}",change:function(e){let t=e.getParameter("selectedItem").getKey();if(t.toLowerCase()==="false"||t.toLowerCase()==="true"){t=JSON.parse(t.toLowerCase())}n[this.data("id")]=t;if(this.data("id")==="personalization"){m(t)}}}).data("id",i);s.bindItems({path:"enum",template:a});return s;case"json":return new r({value:"{value}",change:function(e){n[this.data("id")]=JSON.parse(e.getParameter("value")?.toString())}}).data("id",i);default:break}}});h.bindItems({path:"/",template:y});return h}h.createAdaptionDialogContent=P;async function S(e,t,o,r){let i=arguments.length>4&&arguments[4]!==undefined?arguments[4]:"rta/configSettings";let s=arguments.length>5&&arguments[5]!==undefined?arguments[5]:"{sap.fe.i18n>RTA_CONFIGURATION_INFO_MESSAGE}";let d=arguments.length>6?arguments[6]:undefined;const p=P(e,t,r,i);const u=[];const f=new c({showIcon:true,type:"Information",text:s});f.addStyleClass("sapUiSmallMarginBottom");u.push(f);u.push(p);const l=u.indexOf(p);return new Promise(function(s,c){const p=new a({title:o,contentWidth:d?d.width:"550px",contentHeight:d?d.height:"300px",content:u,buttons:[new n({text:"{sap.fe.i18n>RTA_CONFIGURATION_APPLY}",type:"Emphasized",press:function(){D(e,p.getContent()[l].getModel(),i);p.close();s(t)}}),new n({text:"{sap.fe.i18n>RTA_CONFIGURATION_CANCEL}",press:function(){p.close();c()}})]});p.setModel(r,"sap.fe.i18n");p.addStyleClass("sapUiContentPadding");p.addStyleClass("sapUiRTABorder");p.open();return})}h.openAdaptionDialog=S;function b(e,t,n,o){let a={};const r=[];for(const[i,s]of Object.entries(e)){a={};a[i]=s;r.push(I(a,t,n,o))}return r}h.processChanges=b;function O(e,t,n,o){let a={};const r=[];for(const[i,s]of Object.entries(e)){a={};a[i]=s;r.push(I(a,t,n,o))}return r}h.processGlobalChanges=O;function I(e,t,n,o){if(o===""){o=Object.keys(e)[0]}else{o=o+"/"+Object.keys(e)[0]}const a=e[Object.keys(e)[0]];return y(t,n,o,a)}h.getChange=I;function k(e,n,o){const a=t.getAppComponent(o);const r=v(o.getParent());return b(e,a,r,n)}h.separateChanges=k;function T(e,n,o){const a=t.getAppComponent(o);const r="sap.fe";return O(e,a,r,n)}function v(e){const n=t.getTargetView(e).getId().split("::");return n[n.length-1]}const x=function(e,t,n,o,a,r){const i=m(e,t,n);let s=k(i,o,a);if(r){const e=m(r,t,n);const i=T(e,o,a);s=s.concat(i)}if(s.length>0){return s}else{return[]}};h.extractChanges=x;const A=function(){return[]};h.noChanges=A;function M(e){let t={};const n=e.getShellServices();t=n?.parseParameters?.(window.location.search);return!!t&&t["fiori-tools-rta-mode"]?.[0]==="forAdaptation"}h.isFioriToolsRtaMode=M;function j(e){let t={};const n=e.getShellServices();t=n?.parseParameters?.(window.location.search);return!!t&&t["sap-fe-rta-mode"]?.[0]==="true"}h.isRTAMode=j;function E(e,t){if(!M(e)){return t.filter(e=>e.keyUser)}return t}h.getSettingsIfKeyUser=E;function N(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"rta/configSettings";if(e.getProperty(t)){return true}return false}h.isConfigModelPrepared=N;function U(e,t){let n=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"rta/configSettings";if(!t.getProperty(n)){t.setProperty(n,e)}}h.prepareConfigModel=U;function R(e){let t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"rta/configSettings";const n=e.getObject(t);const o=n.find(e=>e?.control[0]?.id==="personalization");if(o){return o.control[0].value}return undefined}h.getPersonalizationSetting=R;function D(t,n){let o=arguments.length>2&&arguments[2]!==undefined?arguments[2]:"rta/configSettings";const a=e(n.getData());t.setProperty(o,a)}h.updateConfigModel=D;function F(e,t){e.forEach(function(e){e.name=t.getText(e.name);e.description=t.getText(e.description);if(e.enums){e.enums.forEach(function(e){e.name=t.getText(e.name)})}});return e}h.getPropertyNamesAndDescriptions=F;function _(e){let t=f.getOwnerComponentFor(e);if(t===undefined&&e.getParent()){t=f.getOwnerComponentFor(e.getParent())}const n=t?.getAppComponent().getManifestEntry("sap.fe");return n?.app?.disableManifestChanges!==true}h.isManifestChangesEnabled=_;return h},false);
//# sourceMappingURL=Designtime.helper.js.map