{"version":3,"file":"DelegateUtil.js","names":["NS_MACRODATA","_retrieveModel","this","control","detachModelContextChange","sModelName","modelName","oModel","getModel","resolve","attachModelContextChange","DelegateUtil","FETCHED_PROPERTIES_DATA_KEY","setCachedProperties","fetchedProperties","window","Element","key","setCustomData","getCachedProperties","undefined","getCustomData","getCustomDataWithModifier","property","modifier","Promise","customData","retrieveCustomDataNode","length","getProperty","oControl","sProperty","getAttributeNS","data","Function","vValue","setAttributeNS","fetchPropertiesForEntity","sEntitySet","oMetaModel","requestObject","fetchAnnotationsForEntity","fetchModel","getDelegate","payload","oContext","call","templateControlFragment","sFragmentName","oPreprocessorSettings","oOptions","oModifier","CommonUtils","doesValueHelpExist","mParameters","sPropertyName","sValueHelpType","sOriginalProperty","sBindingPath","propertyContext","createBindingContext","valueHelpPropertyPath","FieldHelper","valueHelpProperty","bIsAbsolute","indexOf","includes","getObject","propertyDataModel","getInvolvedDataModelObjects","unitOrCurrencyPropertyPath","getAssociatedCurrencyPropertyPath","targetObject","getAssociatedUnitPropertyPath","unitOrCurrencyDataModel","enhanceDataModelPath","getTargetObjectPath","sGeneratedId","generateID","flexId","generate","getId","getRelativePropertyPath","context","getPath","then","async","getAggregation","aDependents","oDependent","oTargetDependent","getControlType","metaPath","targets","getContent","getPayload","propertyPath","targetId","lastIDPart","split","generatedIdLastPart","oDependentAsUi5Element","isA","isValueHelpRequired","bInFilterField","oPropertyContext","sValueHelpProperty","bReadOnly","all","aResults","Array","isArray","catch","oError","Log","warning","isMultiValue","dataType","propertyKey","aRetrievedCustomData","bind","oCustomData","push"],"sources":["./DelegateUtil.ts"],"sourcesContent":["import type { Property } from \"@sap-ux/vocabularies-types\";\nimport Log from \"sap/base/Log\";\nimport type { BaseTreeModifier, PreprocessorSettings } from \"sap/fe/core/CommonUtils\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type ExtensionAPI from \"sap/fe/core/ExtensionAPI\";\nimport type PageController from \"sap/fe/core/PageController\";\nimport { getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type {\n\tAnnotationTableColumn,\n\tColumnExportSettings,\n\tCustomBasedTableColumn,\n\tExtensionForAnalytics,\n\tPropertyTypeConfig\n} from \"sap/fe/core/converters/controls/Common/table/Columns\";\nimport type { CustomElement } from \"sap/fe/core/converters/helpers/ConfigurableObject\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport { enhanceDataModelPath, getTargetObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport type { DisplayMode } from \"sap/fe/core/templating/DisplayModeFormatter\";\nimport { getRelativePropertyPath } from \"sap/fe/core/templating/PropertyFormatters\";\nimport { getAssociatedCurrencyPropertyPath, getAssociatedUnitPropertyPath } from \"sap/fe/core/templating/PropertyHelper\";\nimport type ValueHelp from \"sap/fe/macros/ValueHelp\";\nimport FieldHelper from \"sap/fe/macros/field/FieldHelper\";\nimport { generateID } from \"sap/fe/macros/internal/valuehelp/ValueHelpTemplating\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type { MDCTablePropertyInfo } from \"sap/ui/mdc/Table\";\nimport type MDCValueHelp from \"sap/ui/mdc/ValueHelp\";\nimport type Model from \"sap/ui/model/Model\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\nconst NS_MACRODATA = \"http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1\";\n\nexport type tableDelegateModel = {\n\tenableAutoColumnWidth: boolean;\n\treadOnly: boolean;\n\ttableType: string;\n\tonChange: Function;\n\tid: string;\n\tnavigationPropertyPath: string;\n\tcolumnInfo: CustomElement<CustomBasedTableColumn>;\n\tcollection: {\n\t\tsPath: string;\n\t\toModel: string;\n\t};\n\twidthIncludingColumnHeader: boolean;\n};\n\nexport type PropertyInfo = {\n\tadditionalLabels?: string[];\n\tcaseSensitive?: boolean;\n\tdescription?: string;\n\tdescriptionProperty?: string;\n\texportSettings?: ColumnExportSettings | null;\n\tclipboardSettings?: Object | null;\n\tformatOptions?: Object | null;\n\tfilterable?: boolean;\n\tgroup?: string;\n\tgroupable?: boolean;\n\tfilterExpression?: string;\n\tgroupLabel?: string;\n\tisKey?: boolean;\n\tlabel?: string;\n\tmaxConditions?: number;\n\tmetadataPath?: string;\n\tmode?: DisplayMode;\n\tname: string;\n\tkey?: string;\n\tpath?: string;\n\tpropertyInfos?: string[];\n\trelativePath?: string;\n\tsortable?: boolean;\n\tsortDirection?: string;\n\ttext?: string;\n\ttooltip?: string;\n\ttypeConfig?: PropertyTypeConfig;\n\ttype?: string;\n\tunit?: string;\n\tvalueProperty?: string;\n\tvisible?: boolean;\n\tvisualSettings?: MDCTablePropertyInfo[\"visualSettings\"];\n\texportDataPointTargetValue?: string;\n\tisParameter?: boolean;\n\taggregatable?: boolean;\n\trequired?: boolean;\n\textension?: ExtensionForAnalytics;\n};\n\nfunction _retrieveModel(this: {\n\tmodelName: string | undefined;\n\tcontrol: UI5Element & { getDelegate: () => { payload?: { modelName: string } } };\n\tresolve: Function;\n}): void {\n\tthis.control.detachModelContextChange(_retrieveModel, this);\n\tconst sModelName = this.modelName,\n\t\toModel = this.control.getModel(sModelName);\n\n\tif (oModel) {\n\t\tthis.resolve(oModel);\n\t} else {\n\t\tthis.control.attachModelContextChange(_retrieveModel, this);\n\t}\n}\n\nexport type Modifier = {\n\tgetAggregation: Function;\n\tgetProperty: Function;\n\tsetProperty: Function;\n\tinsertAggregation: Function;\n};\n\nconst DelegateUtil = {\n\tFETCHED_PROPERTIES_DATA_KEY: \"sap_fe_ControlDelegate_propertyInfoMap\",\n\tsetCachedProperties(control: Element | UI5Element, fetchedProperties: PropertyInfo[]): void {\n\t\t// do not cache during templating, else it becomes part of the cached view\n\t\tif (control instanceof window.Element) {\n\t\t\treturn;\n\t\t}\n\t\tconst key = DelegateUtil.FETCHED_PROPERTIES_DATA_KEY;\n\t\tDelegateUtil.setCustomData(control, key, fetchedProperties as unknown as string);\n\t},\n\tgetCachedProperties(control: Element | UI5Element): PropertyInfo[] | undefined {\n\t\t// properties are not cached during templating\n\t\tif (control instanceof window.Element) {\n\t\t\treturn undefined;\n\t\t}\n\t\tconst key = DelegateUtil.FETCHED_PROPERTIES_DATA_KEY;\n\t\treturn DelegateUtil.getCustomData<PropertyInfo[]>(control, key);\n\t},\n\tasync getCustomDataWithModifier<T = unknown>(\n\t\tcontrol: Element | UI5Element,\n\t\tproperty: string,\n\t\tmodifier?: BaseTreeModifier\n\t): Promise<T | undefined> {\n\t\tif (!modifier) {\n\t\t\treturn Promise.resolve(DelegateUtil.getCustomData<T>(control, property));\n\t\t}\n\t\tconst customData = await DelegateUtil.retrieveCustomDataNode(control, property, modifier);\n\t\tif (customData.length === 1) {\n\t\t\treturn modifier.getProperty(customData[0], \"value\");\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t},\n\n\tgetCustomData<T = unknown>(oControl: Element | UI5Element, sProperty: string): T | undefined {\n\t\t// Delegate invoked from a non-flex change - FilterBarDelegate._addP13nItem for OP table filtering, FilterBarDelegate.fetchProperties etc.\n\t\tif (oControl && sProperty) {\n\t\t\tif (oControl instanceof window.Element) {\n\t\t\t\treturn oControl.getAttributeNS(NS_MACRODATA, sProperty) as T;\n\t\t\t}\n\t\t\tif (oControl.data instanceof Function) {\n\t\t\t\treturn oControl.data(sProperty);\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t},\n\n\tsetCustomData(oControl: Element | UI5Element, sProperty: string, vValue: unknown): void {\n\t\tif (oControl && sProperty) {\n\t\t\tif (oControl instanceof window.Element) {\n\t\t\t\treturn oControl.setAttributeNS(NS_MACRODATA, `customData:${sProperty}`, vValue as string);\n\t\t\t}\n\t\t\tif (oControl.data instanceof Function) {\n\t\t\t\treturn oControl.data(sProperty, vValue);\n\t\t\t}\n\t\t}\n\t},\n\tfetchPropertiesForEntity(sEntitySet: string, oMetaModel: ODataMetaModel): unknown {\n\t\treturn oMetaModel.requestObject(`${sEntitySet}/`);\n\t},\n\tfetchAnnotationsForEntity(sEntitySet: string, oMetaModel: ODataMetaModel): unknown {\n\t\treturn oMetaModel.requestObject(`${sEntitySet}@`);\n\t},\n\tasync fetchModel(oControl: UI5Element & { getDelegate: () => { payload?: { modelName: string } } }): Promise<Model> {\n\t\treturn new Promise((resolve) => {\n\t\t\tconst sModelName = oControl.getDelegate().payload && oControl.getDelegate().payload?.modelName,\n\t\t\t\toContext = { modelName: sModelName, control: oControl, resolve: resolve };\n\t\t\t_retrieveModel.call(oContext);\n\t\t});\n\t},\n\tasync templateControlFragment(\n\t\tsFragmentName: string | Element | null,\n\t\toPreprocessorSettings: PreprocessorSettings,\n\t\toOptions?: { view?: View; isXML?: boolean; id?: string; controller?: PageController | ExtensionAPI; containingView?: View },\n\t\toModifier?: BaseTreeModifier\n\t): Promise<Element | UI5Element | Element[] | UI5Element[]> {\n\t\treturn CommonUtils.templateControlFragment(sFragmentName, oPreprocessorSettings, oOptions, oModifier);\n\t},\n\n\tasync doesValueHelpExist(mParameters: {\n\t\tsPropertyName: string;\n\t\tsValueHelpType: string;\n\t\toMetaModel: ODataMetaModel;\n\t\tmetaPath?: string;\n\t\toModifier?: BaseTreeModifier;\n\t\tsBindingPath: string;\n\t\tflexId?: string;\n\t\toControl: Element | UI5Element;\n\t}): Promise<boolean> {\n\t\tconst sPropertyName = mParameters.sPropertyName || \"\";\n\t\tconst sValueHelpType = mParameters.sValueHelpType || \"\";\n\t\tconst oMetaModel = mParameters.oMetaModel;\n\t\tconst oModifier = mParameters.oModifier;\n\t\tconst sOriginalProperty = `${mParameters.sBindingPath}/${sPropertyName}`;\n\t\tconst propertyContext = oMetaModel.createBindingContext(sOriginalProperty)!;\n\t\tlet valueHelpPropertyPath = FieldHelper.valueHelpProperty(propertyContext);\n\t\tconst bIsAbsolute = mParameters.sBindingPath && mParameters.sBindingPath.indexOf(\"/\") === 0;\n\n\t\t// unit/currency\n\t\tif (valueHelpPropertyPath.includes(\"$Path\")) {\n\t\t\tvalueHelpPropertyPath = oMetaModel.getObject(valueHelpPropertyPath);\n\t\t}\n\t\tconst propertyDataModel = getInvolvedDataModelObjects(propertyContext);\n\t\tif (bIsAbsolute && valueHelpPropertyPath.indexOf(\"/\") !== 0) {\n\t\t\tconst unitOrCurrencyPropertyPath =\n\t\t\t\tgetAssociatedCurrencyPropertyPath(propertyDataModel.targetObject as Property) ||\n\t\t\t\tgetAssociatedUnitPropertyPath(propertyDataModel.targetObject as Property);\n\t\t\tconst unitOrCurrencyDataModel = enhanceDataModelPath(propertyDataModel, unitOrCurrencyPropertyPath);\n\t\t\tvalueHelpPropertyPath = getTargetObjectPath(unitOrCurrencyDataModel);\n\t\t}\n\n\t\tconst sGeneratedId = generateID(\n\t\t\tmParameters.flexId,\n\t\t\tgenerate([oModifier ? oModifier.getId(mParameters.oControl) : (mParameters.oControl as UI5Element).getId(), sValueHelpType]),\n\t\t\tundefined,\n\t\t\tgetRelativePropertyPath(propertyContext.getProperty(sOriginalProperty), {\n\t\t\t\tcontext: {\n\t\t\t\t\tgetModel: () => {\n\t\t\t\t\t\treturn mParameters.oMetaModel;\n\t\t\t\t\t},\n\t\t\t\t\tgetPath: () => {\n\t\t\t\t\t\treturn sOriginalProperty;\n\t\t\t\t\t}\n\t\t\t\t} as unknown as Context\n\t\t\t}),\n\t\t\tgetRelativePropertyPath(propertyContext.getProperty(valueHelpPropertyPath), {\n\t\t\t\tcontext: {\n\t\t\t\t\tgetModel: () => {\n\t\t\t\t\t\treturn mParameters.oMetaModel;\n\t\t\t\t\t},\n\t\t\t\t\tgetPath: () => {\n\t\t\t\t\t\treturn valueHelpPropertyPath;\n\t\t\t\t\t}\n\t\t\t\t} as unknown as Context\n\t\t\t})\n\t\t);\n\n\t\treturn Promise.resolve()\n\t\t\t.then(async function () {\n\t\t\t\tif (oModifier) {\n\t\t\t\t\treturn oModifier.getAggregation(mParameters.oControl, \"dependents\");\n\t\t\t\t}\n\t\t\t\treturn (mParameters.oControl as UI5Element).getAggregation(\"dependents\") as UI5Element[];\n\t\t\t})\n\t\t\t.then(async function (aDependents: Element[] | UI5Element[]) {\n\t\t\t\tif (aDependents) {\n\t\t\t\t\tfor (const oDependent of aDependents) {\n\t\t\t\t\t\tlet oTargetDependent: UI5Element | Element | undefined = oDependent;\n\t\t\t\t\t\tif (oModifier) {\n\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\toModifier.getControlType(oDependent) === \"sap.fe.macros.ValueHelp\" &&\n\t\t\t\t\t\t\t\t(await oModifier.getProperty(oDependent, \"metaPath\")) === mParameters.metaPath\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t// in xml validate against the metaPath of the ValueHelp\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\toModifier.getControlType(oDependent) === \"sap.fe.macros.ValueHelp\" &&\n\t\t\t\t\t\t\t\toModifier.targets !== \"xmlTree\"\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t// in xml validate against the metaPath of the ValueHelp\n\t\t\t\t\t\t\t\toTargetDependent = (oDependent as ValueHelp).getContent();\n\t\t\t\t\t\t\t} else if (\n\t\t\t\t\t\t\t\toModifier.getControlType(oDependent) === \"sap.ui.mdc.ValueHelp\" &&\n\t\t\t\t\t\t\t\toModifier.targets !== \"xmlTree\" &&\n\t\t\t\t\t\t\t\toModifier.getId(oTargetDependent).includes(\"::FilterFieldValueHelp::\")\n\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\tconst payload = (oDependent as MDCValueHelp).getPayload() as { propertyPath?: string };\n\t\t\t\t\t\t\t\tif (payload?.propertyPath && payload?.propertyPath === mParameters.metaPath) {\n\t\t\t\t\t\t\t\t\t// specific case of the OVP\n\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t} else if (!payload?.propertyPath) {\n\t\t\t\t\t\t\t\t\t// sometimes propertyPath is not filled\n\t\t\t\t\t\t\t\t\tconst targetId = oModifier.getId(oTargetDependent);\n\t\t\t\t\t\t\t\t\tconst lastIDPart = targetId.split(\"::FilterFieldValueHelp::\")[1];\n\t\t\t\t\t\t\t\t\tconst generatedIdLastPart = sGeneratedId.split(\"::FilterFieldValueHelp::\")[1];\n\t\t\t\t\t\t\t\t\tif (lastIDPart === generatedIdLastPart) {\n\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (oTargetDependent && oModifier.getId(oTargetDependent) === sGeneratedId) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst oDependentAsUi5Element = oDependent as UI5Element;\n\t\t\t\t\t\t\tif (oDependentAsUi5Element.isA<ValueHelp>(\"sap.fe.macros.ValueHelp\")) {\n\t\t\t\t\t\t\t\toTargetDependent = oDependentAsUi5Element.getContent();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif ((oTargetDependent as UI5Element)?.getId() === sGeneratedId) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn false;\n\t\t\t});\n\t},\n\tasync isValueHelpRequired(\n\t\tmParameters: {\n\t\t\tsPropertyName: string;\n\t\t\toMetaModel: ODataMetaModel;\n\t\t\tsBindingPath: string;\n\t\t\toControl: Element | UI5Element;\n\t\t\toModifier: BaseTreeModifier;\n\t\t},\n\t\tbInFilterField?: boolean\n\t): Promise<boolean> {\n\t\tconst sPropertyName = mParameters.sPropertyName || \"\",\n\t\t\toMetaModel = mParameters.oMetaModel,\n\t\t\tsProperty = `${mParameters.sBindingPath}/${sPropertyName}`,\n\t\t\toPropertyContext = oMetaModel.createBindingContext(sProperty)!,\n\t\t\tsValueHelpProperty = FieldHelper.valueHelpProperty(oPropertyContext, bInFilterField);\n\n\t\treturn this.getCustomDataWithModifier<string | boolean>(mParameters.oControl, \"displayModePropertyBinding\", mParameters.oModifier)\n\t\t\t.then(async function (bReadOnly: string | boolean | undefined) {\n\t\t\t\t// Check whether the control is read-only. If yes, no need of a value help.\n\t\t\t\tbReadOnly = typeof bReadOnly === \"boolean\" ? bReadOnly : bReadOnly === \"true\";\n\t\t\t\tif (bReadOnly) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\t// Else, check whether Value Help relevant annotation exists for the property.\n\t\t\t\t// TODO use PropertyFormatter.hasValueHelp () => if doing so, QUnit tests fail due to mocked model implementation\n\t\t\t\treturn Promise.all([\n\t\t\t\t\toMetaModel.requestObject(`${sValueHelpProperty}@com.sap.vocabularies.Common.v1.ValueListWithFixedValues`),\n\t\t\t\t\toMetaModel.requestObject(`${sValueHelpProperty}@com.sap.vocabularies.Common.v1.ValueListReferences`),\n\t\t\t\t\toMetaModel.requestObject(`${sValueHelpProperty}@com.sap.vocabularies.Common.v1.ValueListMapping`),\n\t\t\t\t\toMetaModel.requestObject(`${sValueHelpProperty}@com.sap.vocabularies.Common.v1.ValueList`)\n\t\t\t\t]);\n\t\t\t})\n\t\t\t.then(function (aResults: boolean | [object, object, object, object]) {\n\t\t\t\tif (!Array.isArray(aResults)) {\n\t\t\t\t\treturn aResults;\n\t\t\t\t}\n\t\t\t\treturn !!aResults[0] || !!aResults[1] || !!aResults[2] || !!aResults[3];\n\t\t\t})\n\t\t\t.catch(function (oError) {\n\t\t\t\tLog.warning(\"Error while retrieving custom data / value list annotation values\", oError as string);\n\t\t\t\treturn false;\n\t\t\t});\n\t},\n\tisMultiValue(property: AnnotationTableColumn): boolean {\n\t\tlet isMultiValue = true;\n\t\tif (property.dataType && property.dataType?.indexOf(\"Boolean\") > 0) {\n\t\t\tisMultiValue = false;\n\t\t}\n\t\treturn isMultiValue;\n\t},\n\t/**\n\t * Retrieves a custom data node from the control.\n\t * @param control The control from which to retrieve the custom data node\n\t * @param propertyKey The key of the custom data node to retrieve\n\t * @param modifier The modifier for the control\n\t * @returns - The custom data node\n\t */\n\tasync retrieveCustomDataNode(control: Element | UI5Element, propertyKey: string, modifier: BaseTreeModifier): Promise<Element[]> {\n\t\tconst customData: Element[] = [];\n\t\tconst aRetrievedCustomData = await Promise.resolve().then(\n\t\t\tmodifier.getAggregation.bind(modifier, control, \"customData\") as () => Promise<Element[]>\n\t\t);\n\n\t\t// Process each retrieved custom data element\n\t\tfor (const oCustomData of aRetrievedCustomData) {\n\t\t\tconst key = await modifier.getProperty(oCustomData, \"key\");\n\t\t\tif (key === propertyKey) {\n\t\t\t\tcustomData.push(oCustomData);\n\t\t\t}\n\t\t}\n\n\t\treturn customData;\n\t}\n};\nexport default DelegateUtil;\n"],"mappings":"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","ignoreList":[]}