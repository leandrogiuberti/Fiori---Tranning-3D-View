{"version":3,"names":["ValueHelp","_dec","defineUI5Class","_dec2","association","type","_dec3","property","_dec4","_dec5","_dec6","_dec7","_dec8","_dec9","_dec10","_dec11","_class","_class2","_BuildingBlock","props","others","_this","_flexId","id","call","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","_descriptor6","_descriptor7","_descriptor8","_descriptor9","_descriptor10","requestGroupId","collaborationEnabled","_exports","_inheritsLoose","getValueHelpForMetaPath","pageController","metaPath","contextPath","metaModel","requiresValidation","arguments","length","undefined","dependents","getView","getDependents","targetMetaPath","startsWith","foundDep","find","child","isA","childMetaPath","getMetaPath","childContextPath","getContextPath","childTargetPath","valueHelp","getId","idPrefix","createId","addDependent","getContent","targetId","innerValueHelp","UI5Element","getElementById","destroy","getParent","_proto","prototype","onMetadataAvailable","content","_getOwner","runAsOwner","createContent","metaContextPath","getMetaPathObject","getMetaModel","entitySetOrSingleton","getClosestEntitySet","isEntitySet","ModelHelper","isCollaborationDraftSupported","createBindingContext","getPath","filterFieldValueHelp","FieldHelper","valueHelpPropertyForFilterField","valueHelpProperty","templateResult","getValueHelpTemplate","useSemanticDateRange","useMultiValueField","navigationPrefix","conditionModel","BuildingBlock","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["ValueHelp.tsx"],"sourcesContent":["import type { EnhanceWithUI5, PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { association, defineUI5Class, property } from \"sap/fe/base/ClassSupport\";\nimport BuildingBlock from \"sap/fe/core/buildingBlocks/BuildingBlock\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport { isEntitySet } from \"sap/fe/core/helpers/TypeGuards\";\nimport FieldHelper from \"sap/fe/macros/field/FieldHelper\";\nimport { getValueHelpTemplate } from \"sap/fe/macros/internal/valuehelp/ValueHelpTemplating\";\n\nimport type PageController from \"sap/fe/core/PageController\";\nimport type Control from \"sap/ui/core/Control\";\nimport UI5Element from \"sap/ui/core/Element\";\nimport type MDCValueHelp from \"sap/ui/mdc/ValueHelp\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\n\n/**\n * Building block for creating a ValueHelp based on the provided OData V4 metadata.\n * @private\n */\n@defineUI5Class(\"sap.fe.macros.ValueHelp\")\nexport default class ValueHelp extends BuildingBlock<MDCValueHelp | Control> {\n\t/**\n\t * A prefix that is added to the generated ID of the value help.\n\t */\n\t@association({ type: \"string\" })\n\tidPrefix?: string;\n\n\t/**\n\t * Defines the metadata path to the property.\n\t */\n\t@property({ type: \"string\" })\n\tmetaPath!: string;\n\n\t@property({ type: \"string\" })\n\tcontextPath!: string;\n\n\t/**\n\t * Indicator whether the value help is for a filter field.\n\t */\n\t@property({ type: \"string\" })\n\tconditionModel = \"\";\n\n\t/**\n\t * Indicates that this is a value help of a filter field. Necessary to decide if a\n\t * validation should occur on the back end or already on the client.\n\t */\n\t@property({ type: \"boolean\" })\n\tfilterFieldValueHelp = false;\n\n\t/**\n\t * Specifies the Sematic Date Range option for the filter field.\n\t */\n\t@property({ type: \"boolean\" })\n\tuseSemanticDateRange = true;\n\n\t/**\n\t * Specifies whether the ValueHelp can be used with a MultiValueField\n\t */\n\t@property({ type: \"boolean\" })\n\tuseMultiValueField = false;\n\n\t@property({ type: \"string\" })\n\tnavigationPrefix?: string;\n\n\t@property({ type: \"boolean\" })\n\trequiresValidation = false;\n\n\t@association({ type: \"string\" })\n\t// eslint-disable-next-line @typescript-eslint/naming-convention\n\t_flexId?: string;\n\n\trequestGroupId: string | undefined = \"$auto.Workers\";\n\n\tcollaborationEnabled = false;\n\n\ttargetId?: string;\n\n\tconstructor(props: PropertiesOf<ValueHelp>, others?: PropertiesOf<ValueHelp>) {\n\t\tif (props._flexId) {\n\t\t\tprops.id = props._flexId + \"::Block\";\n\t\t}\n\t\tsuper(props, others);\n\t}\n\n\tstatic getValueHelpForMetaPath(\n\t\tpageController: PageController,\n\t\tmetaPath: string,\n\t\tcontextPath: string | undefined,\n\t\tmetaModel: ODataMetaModel | undefined,\n\t\trequiresValidation = false\n\t): ValueHelp | undefined {\n\t\tconst dependents = pageController.getView()?.getDependents();\n\t\tconst targetMetaPath = metaPath.startsWith(\"/\") ? metaPath : contextPath + \"/\" + metaPath;\n\t\tconst foundDep = dependents?.find((child) => {\n\t\t\tif (child.isA<EnhanceWithUI5<ValueHelp>>(\"sap.fe.macros.ValueHelp\") && !requiresValidation) {\n\t\t\t\tconst childMetaPath = child.getMetaPath();\n\t\t\t\tconst childContextPath = child.getContextPath();\n\t\t\t\tconst childTargetPath = childMetaPath.startsWith(\"/\") ? childMetaPath : childContextPath + \"/\" + childMetaPath;\n\t\t\t\treturn childTargetPath === targetMetaPath;\n\t\t\t}\n\t\t\treturn false;\n\t\t});\n\t\tif (!foundDep) {\n\t\t\tconst valueHelp = new ValueHelp({\n\t\t\t\tmetaPath: metaPath,\n\t\t\t\tcontextPath: contextPath,\n\t\t\t\tmetaModel: metaModel?.getId(),\n\t\t\t\tidPrefix: pageController.getView()?.createId(\"FieldValueHelp\"),\n\t\t\t\trequiresValidation: requiresValidation\n\t\t\t});\n\t\t\tpageController.getView().addDependent(valueHelp);\n\t\t\tif (!valueHelp.getContent() && valueHelp.targetId) {\n\t\t\t\tconst innerValueHelp = UI5Element.getElementById(valueHelp.targetId);\n\t\t\t\tvalueHelp.destroy();\n\t\t\t\treturn innerValueHelp?.getParent() as ValueHelp | undefined;\n\t\t\t}\n\n\t\t\treturn valueHelp;\n\t\t} else {\n\t\t\treturn foundDep as ValueHelp | undefined;\n\t\t}\n\t}\n\n\tonMetadataAvailable(): void {\n\t\tif (!this.content) {\n\t\t\tthis._getOwner()?.runAsOwner(() => {\n\t\t\t\tthis.content = this.createContent();\n\t\t\t});\n\t\t}\n\t}\n\n\tcreateContent(): Control | MDCValueHelp | undefined {\n\t\tconst metaContextPath = this.getMetaPathObject(this.metaPath, this.contextPath);\n\t\tconst metaModel = this._getOwner()?.getMetaModel(this.metaModel);\n\t\tif (metaContextPath && metaModel) {\n\t\t\tconst entitySetOrSingleton = metaContextPath.getClosestEntitySet();\n\t\t\tif (isEntitySet(entitySetOrSingleton)) {\n\t\t\t\tthis.collaborationEnabled = ModelHelper.isCollaborationDraftSupported(metaModel);\n\t\t\t}\n\n\t\t\tlet metaPath = metaModel.createBindingContext(metaContextPath.getPath());\n\t\t\tif (metaPath) {\n\t\t\t\tif (this.filterFieldValueHelp) {\n\t\t\t\t\tmetaPath = metaModel.createBindingContext(FieldHelper.valueHelpPropertyForFilterField(metaPath))!;\n\t\t\t\t} else {\n\t\t\t\t\tmetaPath = metaModel.createBindingContext(FieldHelper.valueHelpProperty(metaPath))!;\n\t\t\t\t}\n\t\t\t\tconst idPrefix = this.idPrefix ?? \"ValueHelp\";\n\t\t\t\tconst templateResult = getValueHelpTemplate(metaPath, {\n\t\t\t\t\tmetaPath: metaModel.createBindingContext(metaContextPath.getPath())!,\n\t\t\t\t\tcontextPath: metaModel.createBindingContext(metaContextPath.getContextPath())!,\n\t\t\t\t\tfilterFieldValueHelp: this.filterFieldValueHelp,\n\t\t\t\t\tuseSemanticDateRange: this.useSemanticDateRange,\n\t\t\t\t\tuseMultiValueField: this.useMultiValueField,\n\t\t\t\t\tnavigationPrefix: this.navigationPrefix,\n\t\t\t\t\trequiresValidation: this.requiresValidation,\n\t\t\t\t\t_flexId: this._flexId,\n\t\t\t\t\tidPrefix: idPrefix,\n\t\t\t\t\tconditionModel: this.conditionModel,\n\t\t\t\t\trequestGroupId: this.requestGroupId,\n\t\t\t\t\tcollaborationEnabled: this.collaborationEnabled\n\t\t\t\t});\n\t\t\t\tif (typeof templateResult === \"string\") {\n\t\t\t\t\tthis.targetId = templateResult;\n\t\t\t\t\treturn undefined;\n\t\t\t\t} else {\n\t\t\t\t\treturn templateResult;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;EAcA;AACA;AACA;AACA;EAHA,IAKqBA,SAAS,IAAAC,IAAA,GAD7BC,cAAc,CAAC,yBAAyB,CAAC,EAAAC,KAAA,GAKxCC,WAAW,CAAC;IAAEC,IAAI,EAAE;EAAS,CAAC,CAAC,EAAAC,KAAA,GAM/BC,QAAQ,CAAC;IAAEF,IAAI,EAAE;EAAS,CAAC,CAAC,EAAAG,KAAA,GAG5BD,QAAQ,CAAC;IAAEF,IAAI,EAAE;EAAS,CAAC,CAAC,EAAAI,KAAA,GAM5BF,QAAQ,CAAC;IAAEF,IAAI,EAAE;EAAS,CAAC,CAAC,EAAAK,KAAA,GAO5BH,QAAQ,CAAC;IAAEF,IAAI,EAAE;EAAU,CAAC,CAAC,EAAAM,KAAA,GAM7BJ,QAAQ,CAAC;IAAEF,IAAI,EAAE;EAAU,CAAC,CAAC,EAAAO,KAAA,GAM7BL,QAAQ,CAAC;IAAEF,IAAI,EAAE;EAAU,CAAC,CAAC,EAAAQ,KAAA,GAG7BN,QAAQ,CAAC;IAAEF,IAAI,EAAE;EAAS,CAAC,CAAC,EAAAS,MAAA,GAG5BP,QAAQ,CAAC;IAAEF,IAAI,EAAE;EAAU,CAAC,CAAC,EAAAU,MAAA,GAG7BX,WAAW,CAAC;IAAEC,IAAI,EAAE;EAAS,CAAC,CAAC,EAAAJ,IAAA,CAAAe,MAAA,IAAAC,OAAA,0BAAAC,cAAA;IAUhC,SAAAlB,UAAYmB,KAA8B,EAAEC,MAAgC,EAAE;MAAA,IAAAC,KAAA;MAC7E,IAAIF,KAAK,CAACG,OAAO,EAAE;QAClBH,KAAK,CAACI,EAAE,GAAGJ,KAAK,CAACG,OAAO,GAAG,SAAS;MACrC;MACAD,KAAA,GAAAH,cAAA,CAAAM,IAAA,OAAML,KAAK,EAAEC,MAAM,CAAC;MA5DrB;AACD;AACA;MAFCK,0BAAA,CAAAJ,KAAA,cAAAK,WAAA,EAAAL,KAAA;MAMA;AACD;AACA;MAFCI,0BAAA,CAAAJ,KAAA,cAAAM,YAAA,EAAAN,KAAA;MAAAI,0BAAA,CAAAJ,KAAA,iBAAAO,YAAA,EAAAP,KAAA;MASA;AACD;AACA;MAFCI,0BAAA,CAAAJ,KAAA,oBAAAQ,YAAA,EAAAR,KAAA;MAMA;AACD;AACA;AACA;MAHCI,0BAAA,CAAAJ,KAAA,0BAAAS,YAAA,EAAAT,KAAA;MAOA;AACD;AACA;MAFCI,0BAAA,CAAAJ,KAAA,0BAAAU,YAAA,EAAAV,KAAA;MAMA;AACD;AACA;MAFCI,0BAAA,CAAAJ,KAAA,wBAAAW,YAAA,EAAAX,KAAA;MAAAI,0BAAA,CAAAJ,KAAA,sBAAAY,YAAA,EAAAZ,KAAA;MAAAI,0BAAA,CAAAJ,KAAA,wBAAAa,YAAA,EAAAb,KAAA;MAAAI,0BAAA,CAAAJ,KAAA,aAAAc,aAAA,EAAAd,KAAA;MAAAA,KAAA,CAgBAe,cAAc,GAAuB,eAAe;MAAAf,KAAA,CAEpDgB,oBAAoB,GAAG,KAAK;MAAA,OAAAhB,KAAA;IAS5B;IAACiB,QAAA,GAAAtC,SAAA;IAAAuC,cAAA,CAAAvC,SAAA,EAAAkB,cAAA;IAAAlB,SAAA,CAEMwC,uBAAuB,GAA9B,SAAOA,uBAAuBA,CAC7BC,cAA8B,EAC9BC,QAAgB,EAChBC,WAA+B,EAC/BC,SAAqC,EAEb;MAAA,IADxBC,kBAAkB,GAAAC,SAAA,CAAAC,MAAA,QAAAD,SAAA,QAAAE,SAAA,GAAAF,SAAA,MAAG,KAAK;MAE1B,MAAMG,UAAU,GAAGR,cAAc,CAACS,OAAO,CAAC,CAAC,EAAEC,aAAa,CAAC,CAAC;MAC5D,MAAMC,cAAc,GAAGV,QAAQ,CAACW,UAAU,CAAC,GAAG,CAAC,GAAGX,QAAQ,GAAGC,WAAW,GAAG,GAAG,GAAGD,QAAQ;MACzF,MAAMY,QAAQ,GAAGL,UAAU,EAAEM,IAAI,CAAEC,KAAK,IAAK;QAC5C,IAAIA,KAAK,CAACC,GAAG,CAA4B,yBAAyB,CAAC,IAAI,CAACZ,kBAAkB,EAAE;UAC3F,MAAMa,aAAa,GAAGF,KAAK,CAACG,WAAW,CAAC,CAAC;UACzC,MAAMC,gBAAgB,GAAGJ,KAAK,CAACK,cAAc,CAAC,CAAC;UAC/C,MAAMC,eAAe,GAAGJ,aAAa,CAACL,UAAU,CAAC,GAAG,CAAC,GAAGK,aAAa,GAAGE,gBAAgB,GAAG,GAAG,GAAGF,aAAa;UAC9G,OAAOI,eAAe,KAAKV,cAAc;QAC1C;QACA,OAAO,KAAK;MACb,CAAC,CAAC;MACF,IAAI,CAACE,QAAQ,EAAE;QACd,MAAMS,SAAS,GAAG,IAAI/D,SAAS,CAAC;UAC/B0C,QAAQ,EAAEA,QAAQ;UAClBC,WAAW,EAAEA,WAAW;UACxBC,SAAS,EAAEA,SAAS,EAAEoB,KAAK,CAAC,CAAC;UAC7BC,QAAQ,EAAExB,cAAc,CAACS,OAAO,CAAC,CAAC,EAAEgB,QAAQ,CAAC,gBAAgB,CAAC;UAC9DrB,kBAAkB,EAAEA;QACrB,CAAC,CAAC;QACFJ,cAAc,CAACS,OAAO,CAAC,CAAC,CAACiB,YAAY,CAACJ,SAAS,CAAC;QAChD,IAAI,CAACA,SAAS,CAACK,UAAU,CAAC,CAAC,IAAIL,SAAS,CAACM,QAAQ,EAAE;UAClD,MAAMC,cAAc,GAAGC,UAAU,CAACC,cAAc,CAACT,SAAS,CAACM,QAAQ,CAAC;UACpEN,SAAS,CAACU,OAAO,CAAC,CAAC;UACnB,OAAOH,cAAc,EAAEI,SAAS,CAAC,CAAC;QACnC;QAEA,OAAOX,SAAS;MACjB,CAAC,MAAM;QACN,OAAOT,QAAQ;MAChB;IACD,CAAC;IAAA,IAAAqB,MAAA,GAAA3E,SAAA,CAAA4E,SAAA;IAAAD,MAAA,CAEDE,mBAAmB,GAAnB,SAAAA,mBAAmBA,CAAA,EAAS;MAC3B,IAAI,CAAC,IAAI,CAACC,OAAO,EAAE;QAClB,IAAI,CAACC,SAAS,CAAC,CAAC,EAAEC,UAAU,CAAC,MAAM;UAClC,IAAI,CAACF,OAAO,GAAG,IAAI,CAACG,aAAa,CAAC,CAAC;QACpC,CAAC,CAAC;MACH;IACD,CAAC;IAAAN,MAAA,CAEDM,aAAa,GAAb,SAAAA,aAAaA,CAAA,EAAuC;MACnD,MAAMC,eAAe,GAAG,IAAI,CAACC,iBAAiB,CAAC,IAAI,CAACzC,QAAQ,EAAE,IAAI,CAACC,WAAW,CAAC;MAC/E,MAAMC,SAAS,GAAG,IAAI,CAACmC,SAAS,CAAC,CAAC,EAAEK,YAAY,CAAC,IAAI,CAACxC,SAAS,CAAC;MAChE,IAAIsC,eAAe,IAAItC,SAAS,EAAE;QACjC,MAAMyC,oBAAoB,GAAGH,eAAe,CAACI,mBAAmB,CAAC,CAAC;QAClE,IAAIC,WAAW,CAACF,oBAAoB,CAAC,EAAE;UACtC,IAAI,CAAChD,oBAAoB,GAAGmD,WAAW,CAACC,6BAA6B,CAAC7C,SAAS,CAAC;QACjF;QAEA,IAAIF,QAAQ,GAAGE,SAAS,CAAC8C,oBAAoB,CAACR,eAAe,CAACS,OAAO,CAAC,CAAC,CAAC;QACxE,IAAIjD,QAAQ,EAAE;UACb,IAAI,IAAI,CAACkD,oBAAoB,EAAE;YAC9BlD,QAAQ,GAAGE,SAAS,CAAC8C,oBAAoB,CAACG,WAAW,CAACC,+BAA+B,CAACpD,QAAQ,CAAC,CAAE;UAClG,CAAC,MAAM;YACNA,QAAQ,GAAGE,SAAS,CAAC8C,oBAAoB,CAACG,WAAW,CAACE,iBAAiB,CAACrD,QAAQ,CAAC,CAAE;UACpF;UACA,MAAMuB,QAAQ,GAAG,IAAI,CAACA,QAAQ,IAAI,WAAW;UAC7C,MAAM+B,cAAc,GAAGC,oBAAoB,CAACvD,QAAQ,EAAE;YACrDA,QAAQ,EAAEE,SAAS,CAAC8C,oBAAoB,CAACR,eAAe,CAACS,OAAO,CAAC,CAAC,CAAE;YACpEhD,WAAW,EAAEC,SAAS,CAAC8C,oBAAoB,CAACR,eAAe,CAACrB,cAAc,CAAC,CAAC,CAAE;YAC9E+B,oBAAoB,EAAE,IAAI,CAACA,oBAAoB;YAC/CM,oBAAoB,EAAE,IAAI,CAACA,oBAAoB;YAC/CC,kBAAkB,EAAE,IAAI,CAACA,kBAAkB;YAC3CC,gBAAgB,EAAE,IAAI,CAACA,gBAAgB;YACvCvD,kBAAkB,EAAE,IAAI,CAACA,kBAAkB;YAC3CvB,OAAO,EAAE,IAAI,CAACA,OAAO;YACrB2C,QAAQ,EAAEA,QAAQ;YAClBoC,cAAc,EAAE,IAAI,CAACA,cAAc;YACnCjE,cAAc,EAAE,IAAI,CAACA,cAAc;YACnCC,oBAAoB,EAAE,IAAI,CAACA;UAC5B,CAAC,CAAC;UACF,IAAI,OAAO2D,cAAc,KAAK,QAAQ,EAAE;YACvC,IAAI,CAAC3B,QAAQ,GAAG2B,cAAc;YAC9B,OAAOhD,SAAS;UACjB,CAAC,MAAM;YACN,OAAOgD,cAAc;UACtB;QACD;MACD;IACD,CAAC;IAAA,OAAAhG,SAAA;EAAA,EAtJqCsG,aAAa,GAAA5E,WAAA,GAAA6E,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,eAAAzE,KAAA;IAAAqG,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA;EAAA,IAAAhF,YAAA,GAAA4E,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,eAAAtE,KAAA;IAAAkG,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA;EAAA,IAAA/E,YAAA,GAAA2E,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,kBAAApE,KAAA;IAAAgG,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA;EAAA,IAAA9E,YAAA,GAAA0E,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,qBAAAnE,KAAA;IAAA+F,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA,WAAAA,CAAA;MAAA,OAoBlC,EAAE;IAAA;EAAA,IAAA7E,YAAA,GAAAyE,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,2BAAAlE,KAAA;IAAA8F,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA,WAAAA,CAAA;MAAA,OAOI,KAAK;IAAA;EAAA,IAAA5E,YAAA,GAAAwE,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,2BAAAjE,KAAA;IAAA6F,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA,WAAAA,CAAA;MAAA,OAML,IAAI;IAAA;EAAA,IAAA3E,YAAA,GAAAuE,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,yBAAAhE,KAAA;IAAA4F,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA,WAAAA,CAAA;MAAA,OAMN,KAAK;IAAA;EAAA,IAAA1E,YAAA,GAAAsE,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,uBAAA/D,KAAA;IAAA2F,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA;EAAA,IAAAzE,YAAA,GAAAqE,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,yBAAA9D,MAAA;IAAA0F,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA,WAAAA,CAAA;MAAA,OAML,KAAK;IAAA;EAAA,IAAAxE,aAAA,GAAAoE,yBAAA,CAAAtF,OAAA,CAAA2D,SAAA,cAAA7D,MAAA;IAAAyF,YAAA;IAAAC,UAAA;IAAAC,QAAA;IAAAC,WAAA;EAAA,IAAA1F,OAAA,MAAAD,MAAA;EAAAsB,QAAA,GAAAtC,SAAA;EAAA,OAAAsC,QAAA;AAAA","ignoreList":[],"file":"ValueHelp-dbg.js"}