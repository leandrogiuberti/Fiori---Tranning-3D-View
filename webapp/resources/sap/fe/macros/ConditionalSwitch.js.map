{"version":3,"file":"ConditionalSwitch.js","names":["ConditionalSwitch","_dec","defineUI5Class","_dec2","implementInterface","_dec3","aggregation","type","isDefault","_dec4","multiple","singularName","_dec5","property","_class","_class2","_BuildingBlockBase","idOrSettings","settings","scope","_this","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","DEBOUNCE_TIME","_exports","_inheritsLoose","_proto","prototype","_createContentDebounced","_createDebounceTimer","undefined","clearTimeout","window","setTimeout","_createContent","factory","switchProperties","reduce","reducer","prop","key","value","oldContent","content","newContent","getBindingContext","destroy","ariaLabelledBy","addAssociation","join","sAssociationName","sId","bSuppressInvalidate","addSwitchProperty","conditionalSwitchProperty","addAggregation","fnBoundDebounced","bind","attachEvent","removeSwitchProperty","vIndex","removeAggregation","detachEvent","getFormDoNotAdjustWidth","BuildingBlockBase","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./ConditionalSwitch.tsx"],"sourcesContent":["import BuildingBlockBase from \"sap/fe/base/BuildingBlockBase\";\nimport type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { aggregation, defineUI5Class, implementInterface, property } from \"sap/fe/base/ClassSupport\";\nimport type ConditionalSwitchProperty from \"sap/fe/macros/ConditionalSwitchProperty\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type Control from \"sap/ui/core/Control\";\nimport type { IFormContent } from \"sap/ui/core/library\";\n\n/**\n * Defines a conditional template that renders content based on the evaluation of a set of switchProperties.\n * The switchProperties are defined using the {@link sap.fe.macros.ConditionalSwitchProperty} building block.\n * @public\n * @since 1.141.0\n * @ui5-experimental-since 1.141.0\n */\n@defineUI5Class(\"sap.fe.macros.ConditionalSwitch\")\nexport default class ConditionalSwitch extends BuildingBlockBase implements IFormContent {\n\t@implementInterface(\"sap.ui.core.IFormContent\")\n\t__implements__sap_ui_core_IFormContent = true;\n\n\t@aggregation({ type: \"sap.ui.core.IFormContent\", isDefault: false })\n\tcontent?: Control;\n\n\t@aggregation({ type: \"sap.fe.macros.ConditionalSwitchProperty\", isDefault: true, multiple: true, singularName: \"switchProperty\" })\n\tswitchProperties!: ConditionalSwitchProperty[];\n\n\t/**\n\t * A function that returns the content to be rendered based on the evaluation of the switchProperties.\n\t * The function receives an object with the switchProperties as key-value pairs, the binding context, and the displayed control.\n\t * The function should return a single UI5 control.\n\t * @public\n\t */\n\t@property({ type: \"function\" })\n\tfactory?: Function;\n\n\tprivate _createDebounceTimer?: number;\n\n\tprivate fnBoundDebounced?: Function;\n\n\tconstructor(idOrSettings?: string | PropertiesOf<ConditionalSwitch>, settings?: PropertiesOf<ConditionalSwitch>, scope?: object) {\n\t\tsuper(idOrSettings, settings, scope);\n\t}\n\n\t/**\n\t * Time in milliseconds to debounce content creation calls.\n\t * We use a debounce function to avoid multiple calls in quick succession when multiple switchProperties are changed at once.\n\t * @private\n\t */\n\tprivate readonly DEBOUNCE_TIME = 200;\n\n\t/**\n\t * Debounced content creation to avoid multiple calls in quick succession.\n\t * This is useful when multiple switchProperties are changed at once.\n\t */\n\t_createContentDebounced(): void {\n\t\tif (this._createDebounceTimer !== undefined) {\n\t\t\tclearTimeout(this._createDebounceTimer);\n\t\t}\n\t\tthis._createDebounceTimer = window.setTimeout(() => {\n\t\t\tthis._createContent();\n\t\t}, this.DEBOUNCE_TIME);\n\t}\n\n\t/**\n\t * Creates the content based on the current switchProperties and the factory function.\n\t * If no factory function is provided, the content will be empty.\n\t */\n\tprivate _createContent(): void {\n\t\tif (this.factory) {\n\t\t\tconst switchProperties: object = this.switchProperties.reduce(\n\t\t\t\t(reducer: Record<string, unknown>, prop: ConditionalSwitchProperty): Record<string, unknown> => {\n\t\t\t\t\treducer[prop.key] = prop.value;\n\t\t\t\t\treturn reducer;\n\t\t\t\t},\n\t\t\t\t{} as Record<string, unknown>\n\t\t\t);\n\n\t\t\tconst oldContent = this.content;\n\t\t\tconst newContent = this.factory.call(this, switchProperties, this.getBindingContext(), this.content);\n\t\t\tif (newContent !== oldContent) {\n\t\t\t\toldContent?.destroy();\n\t\t\t\tthis.content = newContent;\n\t\t\t}\n\t\t\tif (this.ariaLabelledBy !== undefined) {\n\t\t\t\tthis.content?.addAssociation(\"ariaLabelledBy\", this.ariaLabelledBy.join(\",\"));\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Overrides the addAssociation method to propagate ariaLabelledBy associations to the content.\n\t * @param sAssociationName The name of the association\n\t * @param sId The ID of the associated control or the control instance\n\t * @param bSuppressInvalidate Whether to suppress invalidation\n\t * @returns The current instance for method chaining\n\t */\n\toverride addAssociation(sAssociationName: string, sId: string | ManagedObject, bSuppressInvalidate?: boolean): this {\n\t\tsuper.addAssociation(sAssociationName, sId, bSuppressInvalidate);\n\t\tif (sAssociationName === \"ariaLabelledBy\" && this.content) {\n\t\t\tthis.content.addAssociation(\"ariaLabelledBy\", sId);\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Adds a ConditionalSwitchProperty to the 'switchProperties' aggregation and attaches a change listener to it.\n\t * The change listener will trigger a content re-creation when the property value changes.\n\t * @param conditionalSwitchProperty\n\t * @returns The current instance for method chaining.\n\t */\n\taddSwitchProperty(conditionalSwitchProperty: ConditionalSwitchProperty): this {\n\t\tsuper.addAggregation(\"switchProperties\", conditionalSwitchProperty);\n\t\tif (!this.fnBoundDebounced) {\n\t\t\t// Bind the debounced content creation method to the instance\n\t\t\tthis.fnBoundDebounced = this._createContentDebounced.bind(this);\n\t\t}\n\t\tconditionalSwitchProperty.attachEvent(\"valueChanged\", this.fnBoundDebounced);\n\t\tthis._createContentDebounced();\n\t\treturn this;\n\t}\n\n\t/**\n\t * Removes a ConditionalSwitchProperty from the 'switchProperties' aggregation and detaches its change listener.\n\t * @param vIndex The index, ID, or instance of the ConditionalSwitchProperty to remove.\n\t * @returns The removed ConditionalSwitchProperty instance or null if not found.\n\t */\n\tremoveSwitchProperty(vIndex: number | string | ConditionalSwitchProperty): ConditionalSwitchProperty | null {\n\t\tconst conditionalSwitchProperty = super.removeAggregation(\"switchProperties\", vIndex) as ConditionalSwitchProperty | null;\n\t\tif (conditionalSwitchProperty !== null && this.fnBoundDebounced) {\n\t\t\tconditionalSwitchProperty.detachEvent(\"valueChanged\", this.fnBoundDebounced);\n\t\t}\n\t\tthis._createContentDebounced();\n\t\treturn conditionalSwitchProperty;\n\t}\n\n\t// #region IFormContent\n\n\tgetFormDoNotAdjustWidth(): boolean {\n\t\treturn (this.content as unknown as IFormContent)?.getFormDoNotAdjustWidth?.() ?? false;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}