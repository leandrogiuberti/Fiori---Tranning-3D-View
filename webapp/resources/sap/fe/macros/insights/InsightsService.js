/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/VersionInfo","sap/ui/core/Lib"],function(e,t){"use strict";function a(e){return new Promise((t,a)=>{sap.ui.require([e],a=>{if(!(a&&a.__esModule)){a=a===null||!(typeof a==="object"&&e.endsWith("/library"))?{default:a}:a;Object.defineProperty(a,"__esModule",{value:true})}t(a)},e=>{a(e)})})}var r={};const n=15;const s="{{destinations.service}}";function i(e,t){return e==="Analytical"}function o(e){let{type:t,requestParameters:a}=e;let r=a.queryUrl;if(a.queryUrl.includes(a.serviceUrl)){r=a.queryUrl.split(a.serviceUrl)[1]}if(t==="Table"){r=`${r}&$top=${n}`}return{request:{url:`${s}${a.serviceUrl}$batch`,method:"POST",headers:{"X-CSRF-Token":"{{csrfTokens.token1}}"},batch:{response:{method:"GET",url:r,headers:{Accept:"application/json"}}}}}}function u(e){const t={title:e.content.cardTitle,actions:[{type:"Navigation",parameters:"{= extension.formatters.getNavigationContext(${parameters>/state/value})}"}]};if(e.type==="Table"){t.status={text:"{/response/@odata.count}"}}return t}function p(e){let t={sensitiveProps:[],nhHybridIAppStateKey:e.iAppStateKey};if(e.appVariantId){t={...t,...{"sap-appvar-id":e.appVariantId}}}const a={parameters:{ibnTarget:e.intent,ibnParams:t}};return JSON.stringify(a)}function c(e,t,a,r,s,i,o,u){const c={state:{value:p(a)},_relevantODataFilters:{value:[]},_relevantODataParameters:{value:[]},_mandatoryODataFilters:{value:e},_mandatoryODataParameters:{value:[]},sensitiveProps:[],_entitySet:{value:r},_contentDataUrl:{value:i},_HeaderDataUrl:{value:i},_contentTopQuery:{value:u==="Table"?`$top=${n}`:""},_headerTopQuery:{value:u==="Table"?`$top=${n}`:""},_contentSkipQuery:{value:u==="Table"?"$skip=0":""},_headerSkipQuery:{value:u==="Table"?"$skip=0":""},_contentSortQuery:{value:o===""?"":`$orderby=${o}`},_headerSortQuery:{value:o===""?"":`$orderby=${o}`}};for(const e in t){c._relevantODataFilters.value.push(e);c[e]={value:t[e].value,type:t[e].type}}for(const e in s){c._relevantODataParameters.value.push(e);c._mandatoryODataParameters.value.push(e);c[e]={value:s[e].value,type:s[e].type}}return c}function l(e){const t={};const a=e.requestParameters.serviceUrl;t.destinations={service:{name:"(default)",defaultUrl:"/"}};t.csrfTokens={token1:{data:{request:{url:`${s}${a}`,method:"HEAD",headers:{"X-CSRF-Token":"Fetch"}}}}};t.parameters=c(e.parameters.mandatoryFilters??[],e.parameters.filters??{},e.navigation,e.entitySetPath,e.parameters.oDataParameters??{},e.requestParameters.queryUrl,e.requestParameters.sortQuery,e.type);return t}function d(e){const t={type:e.type};t.configuration=l(e);t.header=u(e);t.data=o(e);if(i(e.type,e.content)){t.content=v(e.content)}else{t.content=y(e)}t.extension="module:sap/fe/core/InsightsFormattersExtension";return t}function y(e){let{requestParameters:t,content:a,parameters:r}=e;const s={data:{path:"/response/value"},maxItems:n,row:{highlight:a.rowCriticality?a.rowCriticality:undefined,columns:a.insightsRelevantColumns}};if(t.groupBy){const e=t.groupBy.property;const a=t.groupBy.descending;s.group={title:"{"+e+"}",order:{path:e,dir:a===true?"DESC":"ASC"}}}if(r.isNavigationEnabled===true){s.row.actions=[{type:"Navigation",parameters:"{= extension.formatters.getNavigationContext(${parameters>/state/value}, ${})}"}]}return s}function v(e){return{chartType:e.chartType,chartProperties:e.chartProperties,data:{path:"/response/value"},dimensions:e.dimensions,measures:e.measures,feeds:e.feeds,actions:[{type:"Navigation",parameters:"{= extension.formatters.getNavigationContext(${parameters>/state/value}, ${})}"}],actionableArea:"Chart"}}r.getAnalyticalCardContent=v;async function f(t){let{parentAppManifest:a,entitySetPath:r,type:n,content:s}=t;const o=await e.load();const u={parentAppId:a["sap.app"].id,cardType:"RT",versions:{ui5:o.version+"-"+o.buildTimestamp},filterEntitySet:r};if(i(n,s)){u.allowedChartTypes=s.allowedChartTypes}return u}async function m(e){const t={...e.parentAppManifest["sap.app"]};const a={...e.parentAppManifest["sap.ui5"]};const r=a.models[""];const n=r.dataSource?r.dataSource:"";const s={};t.id=`user.${t.id}.${Date.now()}`;t.type="card";t.dataSources.filterService={...t.dataSources[n]};s["sap.app"]=t;s["sap.card"]=d(e);s["sap.insights"]=await f(e);s["sap.ui5"]={contentDensities:a.contentDensities,dependencies:{libs:{"sap.insights":{lazy:false}}},componentName:s["sap.app"].id};return s}r.createCardManifest=m;async function h(e,t){const{default:r}=await a("sap/insights/CardHelper");const n=await r.getServiceAsync("UIService");const s=await m(e);await n.showCardPreview(s,true,t)}r.showInsightsCardPreview=h;async function g(e,r){const{default:n}=await a("sap/insights/CardHelper");const s=await n.getServiceAsync("UIService");const i=t.getResourceBundleFor("sap.fe.macros")?.getText("C_SEND_TO_COLLABORATION_MANAGER");await s.showCardPreview(e,true,{type:"None"},i,e=>{const t=e.getParameter("manifest")??e.getSource().getManifest();r.publishCard(t)})}r.showCollaborationManagerCardPreview=g;async function C(e){return m(e)}r.getCardManifest=C;return r},false);
//# sourceMappingURL=InsightsService.js.map