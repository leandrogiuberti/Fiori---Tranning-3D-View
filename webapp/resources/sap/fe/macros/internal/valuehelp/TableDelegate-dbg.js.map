{"version":3,"names":["ODataTableDelegate","Object","assign","TableDelegate","fetchProperties","table","model","_getModel","properties","_createPropertyInfos","createInternalBindingContext","setSortConditions","MacrosDelegateUtil","setCachedProperties","getBindingContext","setProperty","sortConditionsCD","data","rawSortConditions","CommonHelper","parseCustomData","sorters","forEach","sortCondition","infoName","convertPropertyPathToInfoName","name","propertyPath","propertyInfo","find","column","propertyInfos","path","key","dialog","isA","getParent","internalModel","getModel","internalBindingContext","newInternalBindingContextPath","getPath","getId","getProperty","newInternalBindingContext","bindContext","getBoundContext","setBindingContext","collectRelatedProperties","dataModelPropertyPath","dataModelAdditionalPropertyPath","getAdditionalProperty","relatedProperties","targetObject","additionalProperty","additionalPropertyPath","getTargetObjectPath","property","textAnnotation","annotations","Common","Text","textArrangement","UI","TextArrangement","toString","displayMode","getDisplayMode","metadataInfo","getDelegate","payload","entitySetPath","collectionName","metaModel","getMetaModel","requestObject","then","entitySetAnnotations","sortRestrictionsInfo","getSortRestrictionsInfo","filterRestrictions","filterRestrictionsInfo","getFilterRestrictionsInfo","filterFunctions","caseSensitive","ModelHelper","isFilteringCaseSensitive","customDataForColumns","getCustomData","propertiesToBeCreated","dataModelEntityPath","getInvolvedDataModelObjects","getContext","customData","columnDef","typeConfig","isTypeFilterable","$Type","getTypeMap","getTypeConfig","TypeMap","label","enhanceDataModelPath","targetPropertyPath","type","propertyTypeConfig","formatOptions","constraints","relatedPropertiesInfo","relatedPropertyPaths","keys","length","dataType","className","sortable","isSortableProperty","filterable","isFilterableProperty","maxConditions","getPropertyMaxConditions","push","relatedColumns","createRelatedProperties","concat","updateBindingInfo","mdcTable","bindingInfo","apply","collectionPath","parameters","filterBar","Element","getElementById","getFilter","isFilterEnabled","isFilteringEnabled","conditions","innerFilterInfo","outerFilterInfo","filters","tableProperties","getCachedProperties","getConditions","FilterUtil","getFilterInfo","isTreeTable","hierarchyQualifier","$$aggregation","expandTo","initialExpansionLevel","parameterNames","DelegateUtil","getParameterNames","_updatePropertyInfo","parameterPath","getParametersInfo","$search","CommonUtils","normalizeSearchTerm","getSearch","undefined","search","Number","MAX_SAFE_INTEGER","$$sharedRequest","_applyDefaultSorting","$select","reduce","query","includes","$count","isDraftSupported","Filter","FilterOperator","EQ","Promise","resolve","attachEventOnce","sorter","defaultSortPropertyName","Sorter","aTableProperties","oMDCTable","mConditions","oMetadataInfo","aConditionKey","oMetaModel","conditionKey","conditionKeyType","getObject","tableProperty","index","findIndex","oColumnDef","typeInstance","baseType","oFormatOptions","oConstraints","updateBinding","oTable","oBindingInfo","oBinding","bNeedManualRefresh","oInternalBindingContext","sManualUpdatePropertyKey","sLastSearch","sLastFilter","bPendingManualUpdate","lastSearch","lastFilter","oRowBinding","getRowBinding","deepEqual","requestRefresh","getGroupId","finally","catch","oError","Log","error","fireEvent","existingColumns","relatedPropertyNameMap","relatedColumn","newName","valueHelpColumnTypeConfig","valueHelpTableColumn","getLabel","map","columnName","hasOwnProperty","isMultiValueFilterExpression","getAssociatedTextPropertyPath","getAssociatedCurrencyPropertyPath","getAssociatedUnitPropertyPath","getAssociatedTimezonePropertyPath","dataModelAdditionalProperty"],"sourceRoot":".","sources":["TableDelegate.ts"],"sourcesContent":["import type { Property } from \"@sap-ux/vocabularies-types\";\nimport Log from \"sap/base/Log\";\nimport deepEqual from \"sap/base/util/deepEqual\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport { getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport { getTypeConfig } from \"sap/fe/core/converters/controls/Common/table/Columns\";\nimport type { FilterRestrictionsInfoType, SortRestrictionsInfoType } from \"sap/fe/core/helpers/MetaModelFunction\";\nimport { getFilterRestrictionsInfo, getSortRestrictionsInfo, isMultiValueFilterExpression } from \"sap/fe/core/helpers/MetaModelFunction\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { enhanceDataModelPath, getTargetObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport { getDisplayMode } from \"sap/fe/core/templating/DisplayModeFormatter\";\nimport {\n\tgetAssociatedCurrencyPropertyPath,\n\tgetAssociatedTextPropertyPath,\n\tgetAssociatedTimezonePropertyPath,\n\tgetAssociatedUnitPropertyPath,\n\tgetLabel\n} from \"sap/fe/core/templating/PropertyHelper\";\nimport type { DefaultTypeForEdmType } from \"sap/fe/core/type/EDM\";\nimport { isTypeFilterable } from \"sap/fe/core/type/EDM\";\nimport type { CollectionBindingInfo, FilterInfo } from \"sap/fe/macros/CollectionBindingInfo\";\nimport CommonHelper from \"sap/fe/macros/CommonHelper\";\nimport MacrosDelegateUtil from \"sap/fe/macros/DelegateUtil\";\nimport type { FilterConditions } from \"sap/fe/macros/filterBar/FilterHelper\";\nimport { getPath, isFilterableProperty, isSortableProperty } from \"sap/fe/macros/internal/valuehelp/TableDelegateHelper\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type { BaseAggregationBindingInfo } from \"sap/ui/base/ManagedObject\";\nimport Element from \"sap/ui/core/Element\";\nimport type FilterBar from \"sap/ui/mdc/FilterBar\";\nimport type Table from \"sap/ui/mdc/Table\";\nimport type { MDCTablePropertyInfo as PropertyInfo } from \"sap/ui/mdc/Table\";\nimport type { ConditionObject } from \"sap/ui/mdc/condition/Condition\";\nimport TableDelegate from \"sap/ui/mdc/odata/v4/TableDelegate\";\nimport TypeMap from \"sap/ui/mdc/odata/v4/TypeMap\";\nimport DelegateUtil from \"sap/ui/mdc/odata/v4/util/DelegateUtil\";\nimport FilterUtil from \"sap/ui/mdc/util/FilterUtil\";\nimport type Context from \"sap/ui/model/Context\";\nimport Filter from \"sap/ui/model/Filter\";\nimport FilterOperator from \"sap/ui/model/FilterOperator\";\nimport type Model from \"sap/ui/model/Model\";\nimport Sorter from \"sap/ui/model/Sorter\";\nimport type JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataListBinding from \"sap/ui/model/odata/v4/ODataListBinding\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport type { MetaModelEntitySetAnnotation } from \"../../../../../../../../types/metamodel_types\";\n\ntype ComplexPropertyMap = Record<string, Property>;\n\ntype MdcTableDelegate = { name: string; payload: Payload };\n\ntype Payload = {\n\tcollectionName?: string;\n\tcollectionPath?: string;\n\tdefaultSortPropertyName?: string;\n\thierarchyQualifier?: string;\n\tinitialExpansionLevel?: number;\n};\n/**\n * Test delegate for OData V4.\n */\nconst ODataTableDelegate = Object.assign({}, TableDelegate);\n\n/**\n * Fetches the relevant metadata for the table and returns property info array.\n * @param table Instance of the MDCtable\n * @returns Array of property info\n */\nODataTableDelegate.fetchProperties = async function (table: Table): Promise<PropertyInfo> {\n\tconst model = await this._getModel(table);\n\tconst properties = await this._createPropertyInfos(table, model);\n\tODataTableDelegate.createInternalBindingContext(table);\n\tODataTableDelegate.setSortConditions(table, properties);\n\tMacrosDelegateUtil.setCachedProperties(table, properties);\n\t(table.getBindingContext(\"internal\") as Context).setProperty(\"tablePropertiesAvailable\", true);\n\treturn properties;\n};\n\n/**\n * Set sort conditions on the table.\n * @param table Valuehelp table instance\n * @param properties PropertyInfo array\n */\nODataTableDelegate.setSortConditions = function (table: Table, properties: PropertyInfo[]): void {\n\tconst sortConditionsCD = table.data(\"sortConditions\");\n\tconst rawSortConditions = CommonHelper.parseCustomData(sortConditionsCD) as { sorters: { name: string }[] } | undefined;\n\tif (rawSortConditions?.sorters) {\n\t\trawSortConditions.sorters.forEach((sortCondition) => {\n\t\t\tconst infoName = ODataTableDelegate.convertPropertyPathToInfoName(sortCondition.name, properties);\n\t\t\tif (infoName && infoName !== sortCondition.name) {\n\t\t\t\tsortCondition.name = infoName;\n\t\t\t}\n\t\t});\n\t\ttable.setSortConditions({ ...rawSortConditions });\n\t}\n};\n\n/**\n * Convert a property path to its corresponding info name.\n * @param propertyPath Property path to be converted.\n * @param properties Table PropertyInfo array\n * @returns Property info name if found, otherwise returns the original property path.\n */\nODataTableDelegate.convertPropertyPathToInfoName = function (propertyPath: string, properties: PropertyInfo[]): string {\n\tconst propertyInfo = properties.find((column) => {\n\t\treturn !column.propertyInfos && column.path === propertyPath;\n\t});\n\treturn propertyInfo?.key ?? propertyPath;\n};\n\nODataTableDelegate.createInternalBindingContext = function (table: Table): void {\n\tlet dialog: ManagedObject | null = table;\n\twhile (dialog && !dialog.isA(\"sap.ui.mdc.valuehelp.Dialog\")) {\n\t\tdialog = (dialog as ManagedObject).getParent();\n\t}\n\n\tconst internalModel = table.getModel(\"internal\") as JSONModel;\n\n\tif (dialog && internalModel) {\n\t\tconst internalBindingContext = dialog.getBindingContext(\"internal\");\n\t\tlet newInternalBindingContextPath;\n\t\tif (internalBindingContext) {\n\t\t\tnewInternalBindingContextPath = internalBindingContext.getPath() + `::VHDialog::${dialog.getId()}::table`;\n\t\t} else {\n\t\t\tnewInternalBindingContextPath = `/buildingblocks/${table.getId()}`;\n\t\t\tinternalModel.setProperty(\"/buildingblocks\", { ...internalModel.getProperty(\"/buildingblocks\") });\n\t\t}\n\t\tconst newInternalBindingContext = internalModel.bindContext(newInternalBindingContextPath).getBoundContext();\n\t\ttable.setBindingContext(newInternalBindingContext, \"internal\");\n\t}\n};\n\n/**\n * Collect related properties from a property's annotations.\n * @param dataModelPropertyPath The model object path of the property.\n * @returns The related properties that were identified.\n * @private\n */\nfunction collectRelatedProperties(dataModelPropertyPath: DataModelObjectPath<Property>): ComplexPropertyMap {\n\tconst dataModelAdditionalPropertyPath = getAdditionalProperty(dataModelPropertyPath);\n\tconst relatedProperties: ComplexPropertyMap = {};\n\tif (dataModelAdditionalPropertyPath?.targetObject) {\n\t\tconst additionalProperty = dataModelAdditionalPropertyPath.targetObject;\n\t\tconst additionalPropertyPath = getTargetObjectPath(dataModelAdditionalPropertyPath, true);\n\n\t\tconst property = dataModelPropertyPath.targetObject as Property;\n\t\tconst propertyPath = getTargetObjectPath(dataModelPropertyPath, true);\n\n\t\tconst textAnnotation = property.annotations?.Common?.Text,\n\t\t\ttextArrangement = textAnnotation?.annotations?.UI?.TextArrangement?.toString(),\n\t\t\tdisplayMode = textAnnotation && textArrangement && getDisplayMode(property);\n\n\t\tif (displayMode === \"Description\") {\n\t\t\trelatedProperties[additionalPropertyPath] = additionalProperty;\n\t\t} else if ((displayMode && displayMode !== \"Value\") || !textAnnotation) {\n\t\t\trelatedProperties[propertyPath] = property;\n\t\t\trelatedProperties[additionalPropertyPath] = additionalProperty;\n\t\t}\n\t}\n\treturn relatedProperties;\n}\n\nODataTableDelegate._createPropertyInfos = async function (table: Table, model: ODataModel): Promise<PropertyInfo[]> {\n\tconst metadataInfo = (table.getDelegate() as { payload: Payload }).payload;\n\tconst properties: PropertyInfo[] = [];\n\tconst entitySetPath = `/${metadataInfo.collectionName}`;\n\tconst metaModel = model.getMetaModel();\n\n\treturn metaModel.requestObject(`${entitySetPath}@`).then(function (entitySetAnnotations: MetaModelEntitySetAnnotation) {\n\t\tconst sortRestrictionsInfo = getSortRestrictionsInfo(entitySetAnnotations);\n\t\tconst filterRestrictions = entitySetAnnotations[\"@Org.OData.Capabilities.V1.FilterRestrictions\"];\n\t\tconst filterRestrictionsInfo = getFilterRestrictionsInfo(filterRestrictions);\n\t\tconst filterFunctions = entitySetAnnotations[\"@Org.OData.Capabilities.V1.FilterFunctions\"];\n\t\tconst caseSensitive = ModelHelper.isFilteringCaseSensitive(metaModel, filterFunctions);\n\t\tconst customDataForColumns = MacrosDelegateUtil.getCustomData<{\n\t\t\tcustomData: (PropertyInfo & { $Type: keyof typeof DefaultTypeForEdmType })[];\n\t\t}>(table, \"columns\")!;\n\t\tconst propertiesToBeCreated: Record<string, Property> = {};\n\t\tconst dataModelEntityPath = getInvolvedDataModelObjects((table.getModel() as ODataModel).getMetaModel().getContext(entitySetPath));\n\t\tcustomDataForColumns.customData.forEach(function (columnDef: PropertyInfo & { $Type: keyof typeof DefaultTypeForEdmType }) {\n\t\t\tlet typeConfig = isTypeFilterable(columnDef.$Type)\n\t\t\t\t? table.getTypeMap().getTypeConfig(columnDef.$Type)\n\t\t\t\t: TypeMap.getTypeConfig(\"sap.ui.model.odata.type.String\");\n\t\t\tconst propertyInfo: PropertyInfo = {\n\t\t\t\tkey: columnDef.path!,\n\t\t\t\tlabel: columnDef.label\n\t\t\t};\n\n\t\t\tconst dataModelPropertyPath = enhanceDataModelPath<Property>(dataModelEntityPath, columnDef.path);\n\t\t\tconst property = dataModelPropertyPath.targetObject as Property;\n\t\t\tif (property) {\n\t\t\t\tconst targetPropertyPath = getTargetObjectPath(dataModelPropertyPath, true);\n\t\t\t\tif (isTypeFilterable(property.type as keyof typeof DefaultTypeForEdmType)) {\n\t\t\t\t\tconst propertyTypeConfig = getTypeConfig(property);\n\t\t\t\t\ttypeConfig =\n\t\t\t\t\t\tTypeMap.getTypeConfig(\n\t\t\t\t\t\t\tpropertyTypeConfig.type ?? \"sap.ui.model.odata.type.String\",\n\t\t\t\t\t\t\tpropertyTypeConfig.formatOptions,\n\t\t\t\t\t\t\tpropertyTypeConfig.constraints\n\t\t\t\t\t\t) ?? typeConfig;\n\t\t\t\t}\n\t\t\t\t//Check if there is an additional property linked to the property as a Unit, Currency, Timezone or textArrangement\n\t\t\t\tconst relatedPropertiesInfo = collectRelatedProperties(dataModelPropertyPath);\n\t\t\t\tconst relatedPropertyPaths: string[] = Object.keys(relatedPropertiesInfo);\n\n\t\t\t\tif (relatedPropertyPaths.length) {\n\t\t\t\t\tpropertyInfo.propertyInfos = relatedPropertyPaths;\n\t\t\t\t\t// Collect information of related columns to be created.\n\t\t\t\t\trelatedPropertyPaths.forEach((path) => {\n\t\t\t\t\t\tpropertiesToBeCreated[path] = relatedPropertiesInfo[path];\n\t\t\t\t\t});\n\t\t\t\t\t// Also add property for the inOut Parameters on the ValueHelp when textArrangement is set to #TextOnly\n\t\t\t\t\t// It will not be linked to the complex Property (BCP 2270141154)\n\t\t\t\t\tif (!relatedPropertyPaths.find((path) => relatedPropertiesInfo[path] === property)) {\n\t\t\t\t\t\tpropertiesToBeCreated[targetPropertyPath] = property;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tpropertyInfo.path = columnDef.path;\n\t\t\t\t\tpropertyInfo.dataType = typeConfig.className;\n\t\t\t\t\tpropertyInfo.constraints = columnDef.constraints;\n\t\t\t\t\tpropertyInfo.formatOptions = columnDef.formatOptions;\n\t\t\t\t\tpropertyInfo.sortable = isSortableProperty(sortRestrictionsInfo, columnDef);\n\t\t\t\t\tpropertyInfo.filterable = isFilterableProperty(filterRestrictionsInfo, columnDef);\n\t\t\t\t\tpropertyInfo.maxConditions = getPropertyMaxConditions(filterRestrictionsInfo, columnDef);\n\t\t\t\t\tpropertyInfo.caseSensitive = caseSensitive;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tpropertyInfo.path = columnDef.path;\n\t\t\t\tpropertyInfo.caseSensitive = caseSensitive;\n\t\t\t\tpropertyInfo.dataType = typeConfig.className;\n\t\t\t}\n\t\t\tproperties.push(propertyInfo);\n\t\t});\n\t\tconst relatedColumns = createRelatedProperties(\n\t\t\tpropertiesToBeCreated,\n\t\t\tproperties,\n\t\t\tsortRestrictionsInfo,\n\t\t\tfilterRestrictionsInfo,\n\t\t\tcaseSensitive\n\t\t);\n\t\treturn properties.concat(relatedColumns);\n\t});\n};\n\n/**\n * Updates the binding info with the relevant path and model from the metadata.\n * @param mdcTable The MDCTable instance\n * @param bindingInfo The bindingInfo of the table\n */\nODataTableDelegate.updateBindingInfo = function (mdcTable: Table, bindingInfo: CollectionBindingInfo): void {\n\tTableDelegate.updateBindingInfo.apply(this, [mdcTable, bindingInfo]);\n\n\tconst metadataInfo = (mdcTable.getDelegate() as MdcTableDelegate).payload;\n\n\tif (metadataInfo) {\n\t\tbindingInfo.path = bindingInfo?.path || metadataInfo.collectionPath || `/${metadataInfo.collectionName}`;\n\t}\n\n\tbindingInfo.parameters = bindingInfo.parameters || {};\n\n\tconst filterBar = Element.getElementById(mdcTable.getFilter()) as FilterBar,\n\t\tisFilterEnabled = mdcTable.isFilteringEnabled();\n\tlet conditions: Record<string, FilterConditions[]>;\n\tlet innerFilterInfo, outerFilterInfo: FilterInfo;\n\tconst filters = [];\n\tconst tableProperties = MacrosDelegateUtil.getCachedProperties(mdcTable) as unknown as PropertyInfo[];\n\n\t//TODO: consider a mechanism ('FilterMergeUtil' or enhance 'FilterUtil') to allow the connection between different filters)\n\tif (isFilterEnabled) {\n\t\tconditions = mdcTable.getConditions();\n\t\tinnerFilterInfo = FilterUtil.getFilterInfo(mdcTable, conditions, tableProperties, []) as FilterInfo;\n\t\tif (innerFilterInfo.filters) {\n\t\t\tfilters.push(innerFilterInfo.filters);\n\t\t}\n\t}\n\tconst isTreeTable = !!metadataInfo?.hierarchyQualifier;\n\tif (isTreeTable) {\n\t\tbindingInfo.parameters.$$aggregation = {\n\t\t\thierarchyQualifier: metadataInfo.hierarchyQualifier,\n\t\t\texpandTo: metadataInfo.initialExpansionLevel\n\t\t};\n\t}\n\tif (filterBar) {\n\t\tconditions = filterBar.getConditions();\n\t\tif (conditions) {\n\t\t\tconst parameterNames = DelegateUtil.getParameterNames(filterBar);\n\t\t\t// The table properties needs to updated with the filter field if no Selectionfields are annotated and not part as value help parameter\n\t\t\tODataTableDelegate._updatePropertyInfo(tableProperties, mdcTable, conditions, metadataInfo);\n\t\t\touterFilterInfo = FilterUtil.getFilterInfo(filterBar, conditions, tableProperties, parameterNames);\n\n\t\t\tif (outerFilterInfo.filters) {\n\t\t\t\tfilters.push(outerFilterInfo.filters);\n\t\t\t}\n\n\t\t\tconst parameterPath = DelegateUtil.getParametersInfo(filterBar, conditions);\n\t\t\tif (parameterPath) {\n\t\t\t\tbindingInfo.path = parameterPath;\n\t\t\t}\n\t\t}\n\t\tif (!isTreeTable) {\n\t\t\t// get the basic search\n\t\t\tbindingInfo.parameters.$search = CommonUtils.normalizeSearchTerm(filterBar.getSearch()) || undefined;\n\t\t} else if (filterBar.getSearch()) {\n\t\t\tif (!bindingInfo.parameters.$$aggregation) {\n\t\t\t\tbindingInfo.parameters.$$aggregation = {};\n\t\t\t}\n\t\t\tbindingInfo.parameters.$$aggregation.search = CommonUtils.normalizeSearchTerm(filterBar.getSearch());\n\t\t\tbindingInfo.parameters.$$aggregation.expandTo = Number.MAX_SAFE_INTEGER;\n\t\t}\n\t}\n\t// BCP: 2370078660 - sharedRequest is set to false in order to avoid deadlock situation where the the oData\n\t// model cache is neither changeable (result of ListBinding.$$sharedRequest = true) nor deletable\n\t// (result of Context.setSelected(true) -> ListBinding.keepAlive)\n\tbindingInfo.parameters.$$sharedRequest = false;\n\n\tthis._applyDefaultSorting(bindingInfo, (mdcTable.getDelegate() as MdcTableDelegate).payload);\n\t// add select to bindingInfo (BCP 2170163012)\n\tbindingInfo.parameters.$select = tableProperties?.reduce(function (query: string, property: PropertyInfo) {\n\t\t// Navigation properties (represented by X/Y) should not be added to $select.\n\t\t// ToDo : They should be added as $expand=X($select=Y) instead\n\t\tif (property.path && !property.path.includes(\"/\")) {\n\t\t\tquery = query ? `${query},${property.path}` : property.path;\n\t\t}\n\t\treturn query;\n\t}, \"\");\n\n\t// Add $count\n\tbindingInfo.parameters.$count = true;\n\n\t//If the entity is DraftEnabled add a DraftFilter\n\tif (bindingInfo.path && ModelHelper.isDraftSupported(mdcTable.getModel()?.getMetaModel() as ODataMetaModel, bindingInfo.path)) {\n\t\tfilters.push(new Filter(\"IsActiveEntity\", FilterOperator.EQ, true));\n\t}\n\tbindingInfo.filters = new Filter(filters as Filter[], true);\n};\n\nODataTableDelegate.getTypeMap = function (): object {\n\treturn TypeMap;\n};\n\n/**\n * Get table Model.\n * @param table Instance of the MDCtable\n * @returns Model\n */\nODataTableDelegate._getModel = async function (table: Table): Promise<Model> {\n\tconst metadataInfo = (table.getDelegate() as { payload: { model: string } }).payload;\n\tlet model: Model = table.getModel(metadataInfo.model)!;\n\tif (!model) {\n\t\tawait new Promise((resolve) => {\n\t\t\ttable.attachEventOnce(\"modelContextChange\", resolve);\n\t\t});\n\t\tmodel = table.getModel(metadataInfo.model)!;\n\t}\n\treturn model;\n};\n\n/**\n * Applies a default sort order if needed. This is only the case if the request is not a $search request\n * (means the parameter $search of the bindingInfo is undefined) and if a sort order has not been set already,\n * for example, using a presentation variant or manually set by the user.\n * @param bindingInfo The bindingInfo of the table\n * @param payload The payload of the TableDelegate\n */\nODataTableDelegate._applyDefaultSorting = function (bindingInfo: CollectionBindingInfo, payload: Payload): void {\n\tif (\n\t\tbindingInfo.parameters &&\n\t\tbindingInfo.parameters.$search == undefined &&\n\t\tbindingInfo.parameters.$$aggregation?.search == undefined &&\n\t\tbindingInfo.sorter &&\n\t\tbindingInfo.sorter.length == 0\n\t) {\n\t\tconst defaultSortPropertyName = payload ? payload.defaultSortPropertyName : undefined;\n\t\tif (defaultSortPropertyName) {\n\t\t\tbindingInfo.sorter.push(new Sorter(defaultSortPropertyName, false));\n\t\t}\n\t}\n};\n\n/**\n * Updates the table properties with filter field infos.\n * @param aTableProperties Array with table properties\n * @param oMDCTable The MDCTable instance\n * @param mConditions The conditions of the table\n * @param oMetadataInfo The metadata info of the filter field\n */\nODataTableDelegate._updatePropertyInfo = function (\n\taTableProperties: PropertyInfo[],\n\toMDCTable: Table,\n\tmConditions: Record<string, ConditionObject[]>,\n\toMetadataInfo: Payload\n): void {\n\tconst aConditionKey = Object.keys(mConditions),\n\t\toMetaModel = (oMDCTable.getModel() as ODataModel).getMetaModel()!;\n\taConditionKey.forEach(function (conditionKey: string) {\n\t\t// The typeConfig is not set in the table propertyInfos, but we need to set it for the filter fields\n\t\tconst conditionKeyType = oMetaModel.getObject(`/${oMetadataInfo.collectionName}/${conditionKey}`)?.$Type ?? \"Edm.String\";\n\t\tconst typeConfig = oMDCTable.getTypeMap().getTypeConfig(conditionKeyType);\n\t\taTableProperties.forEach((tableProperty, index) => {\n\t\t\tif (tableProperty.path === conditionKey) {\n\t\t\t\t(aTableProperties[index] as PropertyInfo & { typeConfig: object }).typeConfig = typeConfig;\n\t\t\t}\n\t\t});\n\t\tif (\n\t\t\taTableProperties.findIndex(function (tableProperty: PropertyInfo) {\n\t\t\t\treturn tableProperty.path === conditionKey;\n\t\t\t}) === -1\n\t\t) {\n\t\t\tconst oColumnDef: PropertyInfo = {\n\t\t\t\tkey: conditionKey,\n\t\t\t\tlabel: conditionKey,\n\t\t\t\tpath: conditionKey,\n\t\t\t\tdataType: typeConfig.typeInstance.baseType,\n\t\t\t\tformatOptions: typeConfig.typeInstance?.oFormatOptions,\n\t\t\t\tconstraints: typeConfig.typeInstance?.oConstraints\n\t\t\t};\n\t\t\taTableProperties.push(oColumnDef);\n\t\t}\n\t});\n};\n\nODataTableDelegate.updateBinding = function (\n\toTable: Table,\n\toBindingInfo: BaseAggregationBindingInfo & {\n\t\tparameters: {\n\t\t\t$search?: string;\n\t\t};\n\t},\n\toBinding: ODataListBinding\n): void {\n\tlet bNeedManualRefresh = false;\n\tconst oInternalBindingContext = oTable.getBindingContext(\"internal\");\n\tconst sManualUpdatePropertyKey = \"pendingManualBindingUpdate\";\n\tconst sLastSearch = \"lastSearch\";\n\tconst sLastFilter = \"lastFilter\";\n\tconst bPendingManualUpdate = oInternalBindingContext?.getProperty(sManualUpdatePropertyKey);\n\tconst lastSearch = oInternalBindingContext?.getProperty(sLastSearch);\n\tconst lastFilter = oInternalBindingContext?.getProperty(sLastFilter);\n\tlet oRowBinding = oTable.getRowBinding();\n\n\t//oBinding=null means that a rebinding needs to be forced via updateBinding in mdc TableDelegate\n\tTableDelegate.updateBinding.apply(ODataTableDelegate, [oTable, oBindingInfo, oBinding]);\n\t//get row binding after rebind from TableDelegate.updateBinding in case oBinding was null\n\tif (!oRowBinding) {\n\t\toRowBinding = oTable.getRowBinding();\n\t}\n\tif (oRowBinding) {\n\t\t/**\n\t\t * Manual refresh if filters are not changed by binding.refresh() since updating the bindingInfo\n\t\t * is not enough to trigger a batch request.\n\t\t * In case there is no internalBindingContext (see BCP 2280161524) we can not determine if a manual\n\t\t * refresh is needed or not. Therefore, we always refresh in this special case\n\t\t */\n\t\tbNeedManualRefresh = oInternalBindingContext\n\t\t\t? deepEqual(oBindingInfo.filters, lastFilter) && oBindingInfo.parameters?.$search === lastSearch && !bPendingManualUpdate\n\t\t\t: true;\n\t}\n\toInternalBindingContext?.setProperty(sLastSearch, oBindingInfo.parameters?.$search);\n\toInternalBindingContext?.setProperty(sLastFilter, oBindingInfo.filters);\n\n\tif (bNeedManualRefresh && oTable.getFilter()) {\n\t\toInternalBindingContext?.setProperty(sManualUpdatePropertyKey, true);\n\t\toRowBinding\n\t\t\t.requestRefresh(oRowBinding.getGroupId())\n\t\t\t.finally(function () {\n\t\t\t\toInternalBindingContext?.setProperty(sManualUpdatePropertyKey, false);\n\t\t\t})\n\t\t\t.catch(function (oError: unknown) {\n\t\t\t\tLog.error(\"Error while refreshing a filterBar VH table\", oError as string);\n\t\t\t});\n\t}\n\toTable.fireEvent(\"bindingUpdated\");\n\t//no need to check for semantic targets here since we are in a VH and don't want to allow further navigation\n};\n\n/**\n * Creates a simple property for each identified complex property.\n * @param propertiesToBeCreated Identified properties.\n * @param existingColumns The list of columns created for properties defined on the Value List.\n * @param sortRestrictionsInfo An object containing the sort restriction information\n * @param filterRestrictionsInfo An object containing the filter restriction information\n * @param caseSensitive\n * @returns The array of properties created.\n * @private\n */\nfunction createRelatedProperties(\n\tpropertiesToBeCreated: Record<string, Property>,\n\texistingColumns: PropertyInfo[],\n\tsortRestrictionsInfo: SortRestrictionsInfoType,\n\tfilterRestrictionsInfo: FilterRestrictionsInfoType,\n\tcaseSensitive?: boolean\n): PropertyInfo[] {\n\tconst relatedPropertyNameMap: Record<string, string> = {},\n\t\trelatedColumns: PropertyInfo[] = [];\n\tObject.keys(propertiesToBeCreated).forEach((path) => {\n\t\tconst property = propertiesToBeCreated[path],\n\t\t\trelatedColumn = existingColumns.find((column) => column.path === path); // Complex properties doesn't have path so only simple column are found\n\t\tif (!relatedColumn) {\n\t\t\tconst newName = `Property::${path}`;\n\t\t\trelatedPropertyNameMap[path] = newName;\n\t\t\tconst propertyTypeConfig = getTypeConfig(property);\n\t\t\tconst valueHelpColumnTypeConfig = TypeMap.getTypeConfig(\n\t\t\t\tpropertyTypeConfig.type ?? \"sap.ui.model.odata.type.String\",\n\t\t\t\tpropertyTypeConfig.formatOptions,\n\t\t\t\tpropertyTypeConfig.constraints\n\t\t\t);\n\t\t\tconst valueHelpTableColumn: PropertyInfo = {\n\t\t\t\tkey: newName,\n\t\t\t\tlabel: getLabel(property),\n\t\t\t\tpath,\n\t\t\t\tsortable: isSortableProperty(sortRestrictionsInfo, property),\n\t\t\t\tfilterable: isFilterableProperty(filterRestrictionsInfo, property),\n\t\t\t\tdataType: valueHelpColumnTypeConfig.className,\n\t\t\t\tformatOptions: isTypeFilterable(property.type as keyof typeof DefaultTypeForEdmType)\n\t\t\t\t\t? propertyTypeConfig.formatOptions\n\t\t\t\t\t: undefined,\n\t\t\t\tconstraints: isTypeFilterable(property.type as keyof typeof DefaultTypeForEdmType)\n\t\t\t\t\t? propertyTypeConfig.constraints\n\t\t\t\t\t: undefined,\n\t\t\t\tcaseSensitive\n\t\t\t};\n\t\t\tvalueHelpTableColumn.maxConditions = getPropertyMaxConditions(filterRestrictionsInfo, valueHelpTableColumn);\n\t\t\trelatedColumns.push(valueHelpTableColumn);\n\t\t}\n\t});\n\t// The property 'key' has been prefixed with 'Property::' for uniqueness.\n\t// Update the same in other propertyInfos[] references which point to this property.\n\texistingColumns.forEach((column) => {\n\t\tif (column.propertyInfos) {\n\t\t\tcolumn.propertyInfos = column.propertyInfos?.map((columnName) => relatedPropertyNameMap[columnName] ?? columnName);\n\t\t}\n\t});\n\treturn relatedColumns;\n}\n\n/**\n * Identifies the maxConditions for a given property.\n * @param filterRestrictionsInfo The filter restriction information from the restriction annotation.\n * @param property The target property.\n * @returns `-1` or `1` if the property is a MultiValueFilterExpression.\n * @private\n */\n\nfunction getPropertyMaxConditions(filterRestrictionsInfo: FilterRestrictionsInfoType, property: PropertyInfo | Property): number {\n\tconst propertyPath = getPath(property);\n\treturn propertyPath &&\n\t\tfilterRestrictionsInfo.propertyInfo?.hasOwnProperty(propertyPath) &&\n\t\tisMultiValueFilterExpression(filterRestrictionsInfo.propertyInfo[propertyPath] as unknown as string)\n\t\t? -1\n\t\t: 1;\n}\n\n/**\n * Identifies the additional property which references to the unit, timezone, textArrangement or currency.\n * @param dataModelPropertyPath The model object path of the property.\n * @returns The additional property.\n * @private\n */\nfunction getAdditionalProperty(dataModelPropertyPath: DataModelObjectPath<Property>): DataModelObjectPath<Property> | undefined {\n\tconst property = dataModelPropertyPath.targetObject;\n\tconst additionalPropertyPath =\n\t\tproperty &&\n\t\t(getAssociatedTextPropertyPath(property) ||\n\t\t\tgetAssociatedCurrencyPropertyPath(property) ||\n\t\t\tgetAssociatedUnitPropertyPath(property) ||\n\t\t\tgetAssociatedTimezonePropertyPath(property));\n\tif (!additionalPropertyPath) {\n\t\treturn undefined;\n\t}\n\tconst dataModelAdditionalProperty = enhanceDataModelPath<Property>(dataModelPropertyPath, additionalPropertyPath);\n\n\t//Additional Property could refer to a navigation property, keep the key and path as navigation property\n\tconst additionalProperty = dataModelAdditionalProperty.targetObject;\n\tif (!additionalProperty) {\n\t\treturn undefined;\n\t}\n\treturn dataModelAdditionalProperty;\n}\n\nexport default ODataTableDelegate;\n"],"mappings":"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","ignoreList":[],"file":"TableDelegate-dbg.js"}