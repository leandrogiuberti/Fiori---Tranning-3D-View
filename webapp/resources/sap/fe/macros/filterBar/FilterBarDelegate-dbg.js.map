{"version":3,"names":["ODataFilterBarDelegate","Object","assign","FilterBarDelegate","apiVersion","EDIT_STATE_PROPERTY_NAME","SEARCH_PROPERTY_NAME","VALUE_HELP_TYPE","FETCHED_PROPERTIES_DATA_KEY","_templateEditState","sIdPrefix","metaModel","oModifier","oThis","JSONModel","id","isDraftCollaborative","ModelHelper","isCollaborationDraftSupported","oPreprocessorSettings","bindingContexts","this","createBindingContext","models","DelegateUtil","templateControlFragment","undefined","finally","destroy","_templateCustomFilter","oFilterBar","oSelectionFieldInfo","oMetaModel","sEntityTypePath","getCustomDataWithModifier","annotationPath","context","getContext","dataModelPath","getInvolvedDataModelObjects","documentRefText","targetObject","annotations","Common","DocumentationRef","toString","oItemModel","TemplateModel","contextPath","item","oView","CommonUtils","getTargetView","oController","getController","oOptions","controller","view","_getPropertyPath","sConditionPath","FilterUtils","getPropertyPathFromConditionPath","_findSelectionField","aSelectionFields","sFlexName","find","oSelectionField","conditionPath","replaceAll","availability","_generateIdPrefix","sFilterBarId","sControlType","sNavigationPrefix","generate","_templateValueHelp","oSettings","oParameters","idPrefix","sVhIdPrefix","conditionModel","navigationPrefix","filterFieldValueHelp","useSemanticDateRange","bUseSemanticDateRange","metaPath","useMultiValueField","requiresValidation","collaborationEnabled","requestGroupId","jsonModel","mergeObjects","targetPath","FieldHelper","valueHelpPropertyForFilterField","isXML","valueHelpXMLString","jsx","renderAsXML","getValueHelpTemplate","getModel","valueHelpXML","DOMParser","parseFromString","Promise","resolve","firstElementChild","then","aVHElements","sAggregationName","Array","isArray","forEach","elt","insertAggregation","oControl","catch","oError","Log","error","valueHelp","_addXMLCustomFilterField","sPropertyPath","aDependents","getAggregation","i","length","oFilterField","isA","sDataProperty","getPropertyKey","sFilterFieldId","getId","indexOf","_templateFilterField","sInFilterBarId","pageModel","vhIdPrefix","propertyPath","sPropertyName","settings","visualFilter","editMode","label","oVisualFilter","converterContext","_addPropertyInfo","oParentControl","mPropertyBag","sPropertyInfoName","sPropertyInfoKey","KeyHelper","getSelectionFieldKeyFromPath","replace","modifier","delegate","getProperty","aPropertyInfo","hasPropertyInfo","some","prop","key","name","entityTypePath","payload","createConverterContext","appComponent","entityType","getEntityType","filterField","getFilterField","propertyInfo","buildProperyInfo","_updatePropertyInfo","errorMsg","warning","propertyBag","parentControl","propertyInfoForFilterBar","propertyInfoForFilterBarObj","JSON","parse","push","stringify","customDataNode","retrieveCustomDataNode","setAttribute","_propertyInfo","formatPropertyInfo","setProperty","addItem","_addP13nItem","model","getMetaModel","targets","_addFlexItem","removeItem","oFilterFieldProperty","doRemoveItem","filterFieldProperty","data","addCondition","removeCondition","propertyInfoFromCD","clearFilters","oFilterControl","filterBarAPI","getParent","StateHelper","clearFilterValues","fetchModel","oModel","fetchPropertiesForEntity","oEntityType","getObject","includeHidden","oConverterContext","sEntitySetPath","getEntitySetPath","mFilterFields","getConvertedFilterFields","getAppComponent","aFetchedProperties","oFilterFieldInfo","sAnnotationPath","template","oPropertyAnnotations","getConvertedTypes","resolvePath","target","sTargetPropertyPrefix","CommonHelper","getLocationForPropertyPath","sProperty","selectionFields","UI","SelectionFields","filterFacets","FilterFacets","_isFilterAdaptable","isPropertyFilterable","aParameterFields","processedFields","processSelectionFields","processedFieldsKeys","oProps","filter","oProp","includes","oFR","getFilterRestrictionsByPath","mAllowedExpressions","FilterAllowedExpressions","iFilterFieldIndex","oSelField","group","groupLabel","path","tooltip","removeFromAppState","hasValueHelp","oProperty","oPropertyContext","bRemoveFromAppState","oFilterDefaultValueAnnotation","oFilterDefaultValue","getModelType","$Type","defaultFilterConditions","fieldPath","operator","values","filterExpression","getSpecificAllowedExpression","visible","propInfo","getResourceModel","getText","typeConfig","TypeMap","getTypeConfig","dataType","formatOptions","constraints","getLocalizedText","isParameter","setCustomData","getLineItemQualifierFromTable","annotationPaths","getMetaPath","split","Visualizations","visualization","$AnnotationPath","metaPaths","filterFieldInfo","propertyAnnotations","isInFilterFacets","isSelectionField","_isFilterInSelectionFields","filterFacet","fieldGroup","Target","$target","Data","dataField","Value","AdaptationHidden","filterFieldKey","selectionField","value","sFlexPropertyName","oAppComponent","bIsXML","type","sNavigationPath","getNavigationPath","sUseSemanticDateRange","sBindingPath","substring","lastIndexOf","sRetrievedEntityTypePath","sRetrievedUseSemanticDateRange","endsWith","property","filterOutNavPropBinding","join","getPath","sValueHelpType","doesValueHelpExist","bValueHelpExists","localId","_getPageModel","_getCachedProperties","window","Element","getCustomData","_setCachedProperties","_getCachedOrFetchPropertiesForEntity","localGroupLabel","oGroup","sortPropertyInfosByGroupLabel","fetchProperties","filterBar","propertyInfos","fetchFilterProperties","getTypeMap"],"sourceRoot":".","sources":["FilterBarDelegate.ts"],"sourcesContent":["import type { Property } from \"@sap-ux/vocabularies-types\";\nimport type { PropertyAnnotations_Common } from \"@sap-ux/vocabularies-types/vocabularies/Common_Edm\";\nimport type {\n\tDataFieldAbstractTypes,\n\tDataFieldTypes,\n\tFieldGroupType,\n\tFilterFacets,\n\tReferenceFacet,\n\tSelectionFields\n} from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport { UIAnnotationTerms } from \"@sap-ux/vocabularies-types/vocabularies/UI\";\nimport Log from \"sap/base/Log\";\nimport mergeObjects from \"sap/base/util/merge\";\nimport type { EnhanceWithUI5 } from \"sap/fe/base/ClassSupport\";\nimport jsx from \"sap/fe/base/jsx-runtime/jsx\";\nimport type AppComponent from \"sap/fe/core/AppComponent\";\nimport type { BaseTreeModifier, PreprocessorSettings } from \"sap/fe/core/CommonUtils\";\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport TemplateModel from \"sap/fe/core/TemplateModel\";\nimport { getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type {\n\tPropertyInfo as FEPropertyInfo,\n\tFilterField,\n\tPropertyInfoExternal\n} from \"sap/fe/core/converters/controls/ListReport/FilterBar\";\nimport { processSelectionFields, sortPropertyInfosByGroupLabel } from \"sap/fe/core/converters/controls/ListReport/FilterBar\";\nimport { KeyHelper } from \"sap/fe/core/converters/helpers/Key\";\nimport { isPropertyFilterable } from \"sap/fe/core/helpers/MetaModelFunction\";\nimport ModelHelper from \"sap/fe/core/helpers/ModelHelper\";\nimport { getLocalizedText, getResourceModel } from \"sap/fe/core/helpers/ResourceModelHelper\";\nimport { generate } from \"sap/fe/core/helpers/StableIdHelper\";\nimport { hasValueHelp } from \"sap/fe/core/templating/PropertyFormatters\";\nimport { getModelType } from \"sap/fe/core/type/EDM\";\nimport CommonHelper from \"sap/fe/macros/CommonHelper\";\nimport DelegateUtil from \"sap/fe/macros/DelegateUtil\";\nimport FieldHelper from \"sap/fe/macros/field/FieldHelper\";\nimport type { IFilterControl } from \"sap/fe/macros/filter/FilterUtils\";\nimport FilterUtils from \"sap/fe/macros/filter/FilterUtils\";\nimport type { PropertyInfo } from \"sap/fe/macros/internal/PropertyInfo\";\nimport { getValueHelpTemplate } from \"sap/fe/macros/internal/valuehelp/ValueHelpTemplating\";\nimport type { ControlPropertyInfo } from \"sap/fe/macros/mdc/adapter/StateHelper\";\nimport StateHelper from \"sap/fe/macros/mdc/adapter/StateHelper\";\nimport type TableAPI from \"sap/fe/macros/table/TableAPI\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport type View from \"sap/ui/core/mvc/View\";\nimport type FilterBar from \"sap/ui/mdc/FilterBar\";\nimport FilterBarDelegate from \"sap/ui/mdc/FilterBarDelegate\";\nimport type MDCFilterField from \"sap/ui/mdc/FilterField\";\nimport type ValueHelp from \"sap/ui/mdc/ValueHelp\";\nimport TypeMap from \"sap/ui/mdc/odata/v4/TypeMap\";\nimport type Context from \"sap/ui/model/Context\";\nimport type Model from \"sap/ui/model/Model\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type MacroAPI from \"../MacroAPI\";\n\ntype ModifierElement = UI5Element | UI5Element[] | Element | Element[];\ntype NullableModifierElement = void | ModifierElement | null;\nconst ODataFilterBarDelegate = Object.assign({}, FilterBarDelegate) as typeof FilterBarDelegate & {\n\tapiVersion: number;\n\t_isFilterInSelectionFields(selectionFields: SelectionFields, filterFieldInfo: FilterField): boolean;\n\t_findSelectionField(aSelectionFields: FilterField[], sFlexName: string): FilterField | undefined;\n\tclearFilters(oFilterControl: FilterBar): Promise<void>;\n\tgetTypeMap(): typeof TypeMap;\n\tfetchFilterProperties(filterBar: IFilterControl): Promise<ControlPropertyInfo[] | PropertyInfoExternal[]>;\n\tfetchProperties(filterBar: FilterBar): Promise<PropertyInfoExternal[]>;\n\t_isFilterAdaptable(\n\t\tfilterFieldInfo: FilterField,\n\t\tpropertyAnnotations: Property,\n\t\tselectionFields?: SelectionFields,\n\t\tfilterFacets?: FilterFacets\n\t): boolean;\n\tfetchPropertiesForEntity(sEntityTypePath: string, oMetaModel: ODataMetaModel, oFilterControl: IFilterControl): PropertyInfo[];\n\t_templateCustomFilter(\n\t\toFilterBar: IFilterControl,\n\t\tsIdPrefix: string,\n\t\toSelectionFieldInfo: FilterField,\n\t\toMetaModel: ODataMetaModel,\n\t\toModifier: BaseTreeModifier\n\t): Promise<ModifierElement>;\n\t_addP13nItem(sPropertyInfoName: string, oParentControl: FilterBar): Promise<NullableModifierElement>;\n\t_addFlexItem(\n\t\tsFlexPropertyName: string,\n\t\toParentControl: FilterBar,\n\t\toMetaModel: ODataMetaModel,\n\t\toModifier: BaseTreeModifier | undefined,\n\t\toAppComponent?: AppComponent,\n\t\tview?: View\n\t): Promise<NullableModifierElement>;\n\taddItem(\n\t\toParentControl: FilterBar,\n\t\tsPropertyInfoName: string,\n\t\tmPropertyBag?: { modifier: BaseTreeModifier; appComponent: AppComponent }\n\t): Promise<NullableModifierElement>;\n\taddCondition(\n\t\toParentControl: FilterBar,\n\t\tsPropertyInfoName: string,\n\t\tmPropertyBag: { appComponent: AppComponent; modifier: BaseTreeModifier }\n\t): Promise<void | null>;\n\tremoveItem(\n\t\toParentControl: FilterBar,\n\t\toFilterFieldProperty: UI5Element | Element,\n\t\tmPropertyBag: { appComponent: AppComponent; modifier: BaseTreeModifier }\n\t): Promise<boolean | null>;\n\tremoveCondition(\n\t\toParentControl: FilterBar,\n\t\tsPropertyInfoName: string,\n\t\tmPropertyBag: {\n\t\t\tappComponent: AppComponent;\n\t\t\tmodifier: BaseTreeModifier;\n\t\t}\n\t): Promise<void | null>;\n};\nODataFilterBarDelegate.apiVersion = 2;\nconst EDIT_STATE_PROPERTY_NAME = \"$editState\",\n\tSEARCH_PROPERTY_NAME = \"$search\",\n\tVALUE_HELP_TYPE = \"FilterFieldValueHelp\",\n\tFETCHED_PROPERTIES_DATA_KEY = \"sap_fe_FilterBarDelegate_propertyInfoMap\";\n\n// For one single entry in UI.SelectionFields\ntype AnnotationSelectionField = {\n\tvalue: string;\n};\n\nasync function _templateEditState(\n\tsIdPrefix: string,\n\tmetaModel: ODataMetaModel,\n\toModifier: BaseTreeModifier | undefined\n): Promise<ModifierElement> {\n\tconst oThis = new JSONModel({\n\t\t\tid: sIdPrefix,\n\t\t\tisDraftCollaborative: ModelHelper.isCollaborationDraftSupported(metaModel)\n\t\t}),\n\t\toPreprocessorSettings = {\n\t\t\tbindingContexts: {\n\t\t\t\tthis: oThis.createBindingContext(\"/\")\n\t\t\t},\n\t\t\tmodels: {\n\t\t\t\t//\"this.i18n\": ResourceModel.getModel(), TODO: To be checked why this is needed, should not be needed at all\n\t\t\t\tthis: oThis\n\t\t\t}\n\t\t};\n\n\treturn DelegateUtil.templateControlFragment(\n\t\t\"sap.fe.macros.filterBar.DraftEditState\",\n\t\toPreprocessorSettings,\n\t\tundefined,\n\t\toModifier\n\t).finally(function () {\n\t\toThis.destroy();\n\t});\n}\n\nODataFilterBarDelegate._templateCustomFilter = async function (\n\toFilterBar: IFilterControl,\n\tsIdPrefix: string,\n\toSelectionFieldInfo: FilterField,\n\toMetaModel: ODataMetaModel,\n\toModifier: BaseTreeModifier\n): Promise<ModifierElement> {\n\tconst sEntityTypePath = await DelegateUtil.getCustomDataWithModifier<string>(oFilterBar, \"entityType\", oModifier);\n\n\tif (oSelectionFieldInfo.annotationPath !== undefined) {\n\t\t// if property is not defined in the manifest\n\t\ttype PropertyAnnotations_Common_extended = PropertyAnnotations_Common & { DocumentationRef?: string };\n\t\tconst context = oMetaModel.getContext(oSelectionFieldInfo.annotationPath),\n\t\t\tdataModelPath = getInvolvedDataModelObjects<Property>(context),\n\t\t\tdocumentRefText = (\n\t\t\t\tdataModelPath.targetObject?.annotations.Common as PropertyAnnotations_Common_extended\n\t\t\t)?.DocumentationRef?.toString();\n\t\toSelectionFieldInfo.documentRefText = documentRefText;\n\t}\n\n\tconst oThis = new JSONModel({\n\t\t\tid: sIdPrefix\n\t\t}),\n\t\toItemModel = new TemplateModel(oSelectionFieldInfo, oMetaModel),\n\t\toPreprocessorSettings = {\n\t\t\tbindingContexts: {\n\t\t\t\tcontextPath: oMetaModel.createBindingContext(sEntityTypePath!),\n\t\t\t\tthis: oThis.createBindingContext(\"/\"),\n\t\t\t\titem: oItemModel.createBindingContext(\"/\")\n\t\t\t},\n\t\t\tmodels: {\n\t\t\t\tcontextPath: oMetaModel,\n\t\t\t\tthis: oThis,\n\t\t\t\titem: oItemModel\n\t\t\t}\n\t\t},\n\t\toView = CommonUtils.getTargetView(oFilterBar),\n\t\toController = oView ? oView.getController() : undefined,\n\t\toOptions = {\n\t\t\tcontroller: oController ? oController : undefined,\n\t\t\tview: oView\n\t\t};\n\n\treturn DelegateUtil.templateControlFragment(\"sap.fe.macros.filter.CustomFilter\", oPreprocessorSettings, oOptions, oModifier).finally(\n\t\tfunction () {\n\t\t\toThis.destroy();\n\t\t\toItemModel.destroy();\n\t\t}\n\t);\n};\nfunction _getPropertyPath(sConditionPath: string): string {\n\treturn FilterUtils.getPropertyPathFromConditionPath(sConditionPath);\n}\nODataFilterBarDelegate._findSelectionField = function (aSelectionFields: FilterField[], sFlexName: string): FilterField | undefined {\n\treturn aSelectionFields.find(function (oSelectionField: FilterField) {\n\t\treturn (\n\t\t\t(oSelectionField.conditionPath === sFlexName || oSelectionField.conditionPath.replaceAll(/\\*/g, \"\") === sFlexName) &&\n\t\t\toSelectionField.availability !== \"Hidden\"\n\t\t);\n\t});\n};\nfunction _generateIdPrefix(sFilterBarId: string, sControlType: string, sNavigationPrefix?: string): string {\n\treturn sNavigationPrefix ? generate([sFilterBarId, sControlType, sNavigationPrefix]) : generate([sFilterBarId, sControlType]);\n}\nasync function _templateValueHelp(\n\toSettings: {\n\t\tisXML: boolean;\n\t\tbindingContexts: {\n\t\t\tmetaPath: Context;\n\t\t\tcontextPath: Context;\n\t\t};\n\t\tmodels: {\n\t\t\tmetaPath: ODataMetaModel;\n\t\t\tcontextPath: ODataMetaModel;\n\t\t};\n\t},\n\toParameters: {\n\t\tsVhIdPrefix: string;\n\t\tsNavigationPrefix?: string;\n\t\tbUseSemanticDateRange: boolean;\n\t\toModifier?: BaseTreeModifier;\n\t\toControl: UI5Element;\n\t\tview?: View;\n\t}\n): Promise<void> {\n\tconst oThis = {\n\t\tidPrefix: oParameters.sVhIdPrefix,\n\t\tconditionModel: \"$filters\",\n\t\tnavigationPrefix: oParameters.sNavigationPrefix ? `/${oParameters.sNavigationPrefix}` : \"\",\n\t\tfilterFieldValueHelp: true,\n\t\tuseSemanticDateRange: oParameters.bUseSemanticDateRange,\n\t\tmetaPath: oSettings.bindingContexts.metaPath,\n\t\tcontextPath: oSettings.bindingContexts.contextPath,\n\t\tuseMultiValueField: false,\n\t\trequiresValidation: false,\n\t\tcollaborationEnabled: false,\n\t\trequestGroupId: undefined\n\t};\n\tconst jsonModel = new JSONModel(oThis);\n\tconst oPreprocessorSettings = mergeObjects({}, oSettings, {\n\t\tbindingContexts: {\n\t\t\tthis: jsonModel.createBindingContext(\"/\")\n\t\t},\n\t\tmodels: {\n\t\t\tthis: oThis\n\t\t}\n\t}) as PreprocessorSettings;\n\tconst targetPath = FieldHelper.valueHelpPropertyForFilterField(oSettings.bindingContexts.metaPath);\n\n\tif (oSettings.isXML) {\n\t\tlet valueHelpXMLString = jsx.renderAsXML<string | undefined>(\n\t\t\t() =>\n\t\t\t\tgetValueHelpTemplate(oSettings.bindingContexts.metaPath.getModel().createBindingContext(targetPath), oThis) as\n\t\t\t\t\t| string\n\t\t\t\t\t| undefined\n\t\t);\n\t\tif (valueHelpXMLString) {\n\t\t\tif (oSettings.isXML) {\n\t\t\t\tvalueHelpXMLString = `<root>${valueHelpXMLString}</root>`;\n\t\t\t}\n\t\t\tconst valueHelpXML = new DOMParser().parseFromString(valueHelpXMLString, \"text/xml\");\n\t\t\treturn Promise.resolve(\n\t\t\t\tDelegateUtil.templateControlFragment(valueHelpXML.firstElementChild, oPreprocessorSettings, {\n\t\t\t\t\tisXML: oSettings.isXML\n\t\t\t\t})\n\t\t\t)\n\t\t\t\t.then(async function (aVHElements: ModifierElement): Promise<void> {\n\t\t\t\t\tif (aVHElements) {\n\t\t\t\t\t\tconst sAggregationName = \"dependents\";\n\t\t\t\t\t\t//Some filter fields have the PersistenceProvider aggregation besides the FVH :\n\t\t\t\t\t\tif (Array.isArray(aVHElements)) {\n\t\t\t\t\t\t\taVHElements.forEach(function (elt: Element | UI5Element) {\n\t\t\t\t\t\t\t\tif (oParameters.oModifier) {\n\t\t\t\t\t\t\t\t\toParameters.oModifier.insertAggregation(oParameters.oControl, sAggregationName, elt, 0);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\toParameters.oControl.insertAggregation(sAggregationName, elt as UI5Element, 0, false);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else if (oParameters.oModifier) {\n\t\t\t\t\t\t\treturn oParameters.oModifier.insertAggregation(\n\t\t\t\t\t\t\t\toParameters.oControl,\n\t\t\t\t\t\t\t\tsAggregationName,\n\t\t\t\t\t\t\t\taVHElements,\n\t\t\t\t\t\t\t\t0,\n\t\t\t\t\t\t\t\toParameters.view as unknown as Element\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\toParameters.oControl.insertAggregation(sAggregationName, aVHElements as UI5Element, 0, false);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t})\n\t\t\t\t.catch(function (oError: unknown) {\n\t\t\t\t\tLog.error(\"Error while evaluating DelegateUtil.isValueHelpRequired\", oError as string);\n\t\t\t\t})\n\t\t\t\t.finally(function () {\n\t\t\t\t\tjsonModel.destroy();\n\t\t\t\t});\n\t\t}\n\t} else {\n\t\tconst valueHelp = getValueHelpTemplate(oSettings.bindingContexts.metaPath.getModel().createBindingContext(targetPath), oThis) as\n\t\t\t| ValueHelp\n\t\t\t| undefined;\n\t\tif (valueHelp) {\n\t\t\tconst sAggregationName = \"dependents\";\n\t\t\t//Some filter fields have the PersistenceProvider aggregation besides the FVH :\n\t\t\tif (Array.isArray(valueHelp)) {\n\t\t\t\tvalueHelp.forEach(function (elt: Element | UI5Element) {\n\t\t\t\t\tif (oParameters.oModifier) {\n\t\t\t\t\t\toParameters.oModifier.insertAggregation(oParameters.oControl, sAggregationName, elt, 0);\n\t\t\t\t\t} else {\n\t\t\t\t\t\toParameters.oControl.insertAggregation(sAggregationName, elt as UI5Element, 0, false);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if (oParameters.oModifier) {\n\t\t\t\toParameters.oModifier.insertAggregation(oParameters.oControl, sAggregationName, valueHelp, 0);\n\t\t\t} else {\n\t\t\t\toParameters.oControl.insertAggregation(sAggregationName, valueHelp, 0, false);\n\t\t\t}\n\t\t}\n\t}\n}\nasync function _addXMLCustomFilterField(\n\toFilterBar: IFilterControl,\n\toModifier: BaseTreeModifier,\n\tsPropertyPath: string\n): Promise<UI5Element | Element | void> {\n\ttry {\n\t\tconst aDependents = await Promise.resolve(oModifier.getAggregation(oFilterBar, \"dependents\"));\n\t\tlet i;\n\t\tif (aDependents && aDependents.length > 1) {\n\t\t\tfor (i = 0; i <= aDependents.length; i++) {\n\t\t\t\tconst oFilterField = aDependents[i];\n\t\t\t\tif (oFilterField && (oFilterField as UI5Element).isA<MDCFilterField>(\"sap.ui.mdc.FilterField\")) {\n\t\t\t\t\tconst sDataProperty = (oFilterField as MDCFilterField).getPropertyKey(),\n\t\t\t\t\t\tsFilterFieldId = (oFilterField as MDCFilterField).getId();\n\t\t\t\t\tif (sPropertyPath === sDataProperty && sFilterFieldId.indexOf(\"CustomFilterField\")) {\n\t\t\t\t\t\treturn oFilterField;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} catch (oError) {\n\t\tLog.error(\"Filter Cannot be added\", oError as string);\n\t}\n}\n\nasync function _templateFilterField(\n\toSettings: Record<string, unknown>,\n\toParameters: Record<string, unknown>,\n\tsInFilterBarId?: string,\n\tpageModel?: JSONModel\n): Promise<UI5Element | UI5Element[] | Element | Element[]> {\n\tconst oThis = new JSONModel({\n\t\tidPrefix: oParameters.sIdPrefix,\n\t\tvhIdPrefix: oParameters.sVhIdPrefix,\n\t\tpropertyPath: oParameters.sPropertyName,\n\t\tnavigationPrefix: oParameters.sNavigationPrefix ? `/${oParameters.sNavigationPrefix}` : \"\",\n\t\tuseSemanticDateRange: oParameters.bUseSemanticDateRange,\n\t\tsettings: oParameters.oSettings,\n\t\tvisualFilter: oParameters.visualFilter,\n\t\teditMode: `{internal>/${sInFilterBarId}/filterFields/${oParameters.sPropertyName}/editMode}`,\n\t\tlabel: oParameters.label\n\t});\n\ttry {\n\t\tconst oMetaModel = oParameters.oMetaModel as ODataMetaModel;\n\t\tconst oVisualFilter = new TemplateModel(oParameters.visualFilter as object, oMetaModel);\n\t\tconst oPreprocessorSettings = mergeObjects({}, oSettings, {\n\t\t\tbindingContexts: {\n\t\t\t\tthis: oThis.createBindingContext(\"/\"),\n\t\t\t\tvisualFilter: oVisualFilter.createBindingContext(\"/\")\n\t\t\t},\n\t\t\tmodels: {\n\t\t\t\tthis: oThis,\n\t\t\t\tvisualFilter: oVisualFilter,\n\t\t\t\tmetaModel: oMetaModel,\n\t\t\t\tconverterContext: pageModel\n\t\t\t}\n\t\t}) as PreprocessorSettings;\n\n\t\treturn await DelegateUtil.templateControlFragment(\"sap.fe.macros.internal.filterField.FilterFieldTemplate\", oPreprocessorSettings, {\n\t\t\tisXML: !!oSettings.isXML\n\t\t});\n\t} finally {\n\t\toThis.destroy();\n\t}\n}\n\nasync function _addPropertyInfo(\n\toParentControl: FilterBar,\n\tmPropertyBag: { modifier: BaseTreeModifier; appComponent: AppComponent },\n\toMetaModel: ODataMetaModel,\n\tsPropertyInfoName: string\n): Promise<void> {\n\ttry {\n\t\t// key should have the same value as name\n\t\tconst sPropertyInfoKey = KeyHelper.getSelectionFieldKeyFromPath(sPropertyInfoName);\n\t\tsPropertyInfoName = sPropertyInfoName.replace(\"*\", \"\");\n\t\tif (mPropertyBag && !mPropertyBag.modifier) {\n\t\t\tthrow \"FilterBar Delegate method called without modifier.\";\n\t\t}\n\n\t\tconst delegate = await mPropertyBag.modifier.getProperty<FilterBarDelegate>(oParentControl, \"delegate\");\n\t\tconst aPropertyInfo = await mPropertyBag.modifier.getProperty<FEPropertyInfo[]>(oParentControl, \"propertyInfo\");\n\t\t//We do not get propertyInfo in case of table filters\n\t\tif (aPropertyInfo) {\n\t\t\tconst hasPropertyInfo = aPropertyInfo.some(function (prop: FEPropertyInfo) {\n\t\t\t\treturn prop.key === sPropertyInfoKey || prop.name === sPropertyInfoKey;\n\t\t\t});\n\t\t\tif (!hasPropertyInfo) {\n\t\t\t\tconst entityTypePath = delegate.payload.entityTypePath;\n\t\t\t\tconst converterContext = FilterUtils.createConverterContext(\n\t\t\t\t\toParentControl as unknown as IFilterControl,\n\t\t\t\t\tentityTypePath,\n\t\t\t\t\toMetaModel,\n\t\t\t\t\tmPropertyBag.appComponent\n\t\t\t\t);\n\t\t\t\tconst entityType = converterContext.getEntityType();\n\t\t\t\tconst filterField = FilterUtils.getFilterField(sPropertyInfoName, converterContext, entityType);\n\t\t\t\tconst propertyInfo = FilterUtils.buildProperyInfo(filterField!, converterContext);\n\t\t\t\tawait _updatePropertyInfo(\n\t\t\t\t\taPropertyInfo as PropertyInfo[],\n\t\t\t\t\tmPropertyBag,\n\t\t\t\t\tpropertyInfo as unknown as PropertyInfo,\n\t\t\t\t\toParentControl\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t} catch (errorMsg) {\n\t\tLog.warning(`${oParentControl.getId()} : ${errorMsg}`);\n\t}\n}\n\nasync function _updatePropertyInfo(\n\tpropertyInfo: PropertyInfo[],\n\tpropertyBag: { modifier: BaseTreeModifier; appComponent: AppComponent },\n\tfilterField: PropertyInfo,\n\tparentControl: FilterBar\n): Promise<void> {\n\tlet propertyInfoForFilterBar = await DelegateUtil.getCustomDataWithModifier<string>(\n\t\tparentControl,\n\t\t\"feFilterInfo\",\n\t\tpropertyBag.modifier\n\t);\n\tif (propertyInfoForFilterBar && propertyInfoForFilterBar.length > 0) {\n\t\tconst propertyInfoForFilterBarObj = JSON.parse(propertyInfoForFilterBar) as PropertyInfo[];\n\t\tpropertyInfoForFilterBarObj.push(filterField);\n\t\tpropertyInfoForFilterBar = JSON.stringify(propertyInfoForFilterBarObj);\n\t\tpropertyInfoForFilterBar = propertyInfoForFilterBar.replace(/\\{/g, \"\\\\{\");\n\t\tpropertyInfoForFilterBar = propertyInfoForFilterBar.replace(/\\}/g, \"\\\\}\");\n\t\tconst customDataNode = await DelegateUtil.retrieveCustomDataNode(parentControl, \"feFilterInfo\", propertyBag.modifier);\n\t\tcustomDataNode[0].setAttribute(\"value\", propertyInfoForFilterBar);\n\t\tpropertyBag.modifier.insertAggregation(parentControl, \"customData\", customDataNode[0], 0);\n\t}\n\n\t// Custom data is set to the parent control to store the propertyInfo\n\tpropertyInfo.push(filterField);\n\t//remove unwanted property from the propertyInfo\n\tconst _propertyInfo = FilterUtils.formatPropertyInfo(propertyInfo as FEPropertyInfo[]);\n\t//Update the propertyInfo in the parent control\n\tpropertyBag.modifier.setProperty(parentControl, \"propertyInfo\", _propertyInfo);\n}\n/**\n * Method responsible for creating filter field in standalone mode / in the personalization settings of the filter bar.\n * @param oParentControl Parent control instance to which the filter field is added\n * @param sPropertyInfoName Name of the property being added as the filter field\n * @param mPropertyBag Instance of the property bag from Flex API\n * @param mPropertyBag.appComponent AppComponent\n * @param mPropertyBag.modifier Modifier from Flex API\n * @returns Once resolved, a filter field definition is returned\n */\nODataFilterBarDelegate.addItem = async function (\n\toParentControl: FilterBar,\n\tsPropertyInfoName: string,\n\tmPropertyBag?: { view: View; modifier: BaseTreeModifier; appComponent: AppComponent }\n): Promise<NullableModifierElement> {\n\tif (!mPropertyBag) {\n\t\t// Invoked during runtime.\n\t\treturn ODataFilterBarDelegate._addP13nItem(sPropertyInfoName, oParentControl);\n\t}\n\tconst modifier = mPropertyBag.modifier;\n\tconst model = mPropertyBag && mPropertyBag.appComponent && mPropertyBag.appComponent.getModel();\n\tconst oMetaModel = model && model.getMetaModel();\n\tif (!oMetaModel) {\n\t\treturn Promise.resolve(null);\n\t}\n\tconst isXML = modifier && modifier.targets === \"xmlTree\";\n\tif (isXML) {\n\t\tawait _addPropertyInfo(oParentControl, mPropertyBag, oMetaModel, sPropertyInfoName);\n\t}\n\treturn ODataFilterBarDelegate._addFlexItem(\n\t\tsPropertyInfoName,\n\t\toParentControl,\n\t\toMetaModel,\n\t\tmodifier,\n\t\tmPropertyBag.appComponent,\n\t\tmPropertyBag.view\n\t);\n};\n\n/**\n * Method responsible for removing filter field in standalone / personalization filter bar.\n * @param oParentControl Parent control instance from which the filter field is removed\n * @param oFilterFieldProperty Object of the filter field property being removed as filter field\n * @param mPropertyBag Instance of property bag from Flex API\n * @param mPropertyBag.appComponent AppComponent\n * @param mPropertyBag.modifier Modifier from Flex API\n * @returns The resolved promise\n */\nODataFilterBarDelegate.removeItem = async function (\n\toParentControl: FilterBar,\n\toFilterFieldProperty: UI5Element | Element,\n\tmPropertyBag: { appComponent: AppComponent; modifier: BaseTreeModifier }\n): Promise<boolean | null> {\n\tlet doRemoveItem = true;\n\tconst modifier = mPropertyBag.modifier;\n\tconst isXML = modifier && modifier.targets === \"xmlTree\";\n\tif (isXML) {\n\t\tconst model = mPropertyBag && mPropertyBag.appComponent && mPropertyBag.appComponent.getModel();\n\t\tconst oMetaModel = model && model.getMetaModel();\n\t\tif (!oMetaModel) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\t\tconst filterFieldProperty = await mPropertyBag.modifier.getProperty(oFilterFieldProperty, \"propertyKey\");\n\t\tawait _addPropertyInfo(oParentControl, mPropertyBag, oMetaModel, filterFieldProperty as string);\n\t}\n\tif (\n\t\ttypeof oFilterFieldProperty !== \"string\" &&\n\t\t(oFilterFieldProperty as UI5Element).isA &&\n\t\t(oFilterFieldProperty as UI5Element).isA(\"sap.ui.mdc.FilterField\")\n\t) {\n\t\tif ((oFilterFieldProperty as UI5Element).data(\"isSlot\") === \"true\" && mPropertyBag) {\n\t\t\t// Inserting into the modifier creates a change from flex also filter is been removed hence promise is resolved to false\n\t\t\tmodifier.insertAggregation(oParentControl, \"dependents\", oFilterFieldProperty);\n\t\t\tdoRemoveItem = false;\n\t\t}\n\t}\n\treturn Promise.resolve(doRemoveItem);\n};\n\n/**\n * Method responsible for creating filter field condition in standalone / personalization filter bar.\n * @param oParentControl Parent control instance to which the filter field is added\n * @param sPropertyInfoName Name of the property being added as filter field\n * @param mPropertyBag Instance of property bag from Flex API\n * @param mPropertyBag.appComponent AppComponent\n * @param mPropertyBag.modifier Modifier from Flex API\n * @returns The resolved promise\n */\nODataFilterBarDelegate.addCondition = async function (\n\toParentControl: FilterBar,\n\tsPropertyInfoName: string,\n\tmPropertyBag: { appComponent: AppComponent; modifier: BaseTreeModifier }\n): Promise<void | null> {\n\tconst modifier = mPropertyBag.modifier;\n\tconst isXML = modifier && modifier.targets === \"xmlTree\";\n\tif (isXML) {\n\t\tconst model = mPropertyBag && mPropertyBag.appComponent && mPropertyBag.appComponent.getModel();\n\t\tconst oMetaModel = model && model.getMetaModel();\n\t\tif (!oMetaModel) {\n\t\t\treturn Promise.resolve(null);\n\t\t}\n\t\tawait _addPropertyInfo(oParentControl, mPropertyBag, oMetaModel, sPropertyInfoName);\n\t}\n\treturn Promise.resolve();\n};\n\n/**\n * Method responsible for removing filter field in standalone / personalization filter bar.\n * @param oParentControl Parent control instance from which the filter field is removed\n * @param sPropertyInfoName Name of the property being removed as filter field\n * @param mPropertyBag Instance of property bag from Flex API\n * @param mPropertyBag.appComponent AppComponent\n * @param mPropertyBag.modifier Modifier from Flex API\n * @returns The resolved promise\n */\nODataFilterBarDelegate.removeCondition = async function (\n\toParentControl: FilterBar,\n\tsPropertyInfoName: string,\n\tmPropertyBag: {\n\t\tappComponent: AppComponent;\n\t\tmodifier: BaseTreeModifier;\n\t}\n): Promise<void | null> {\n\tconst modifier = mPropertyBag.modifier;\n\tconst isXML = modifier && modifier.targets === \"xmlTree\";\n\tif (isXML) {\n\t\tconst propertyInfoFromCD = await DelegateUtil.getCustomDataWithModifier<string>(\n\t\t\toParentControl,\n\t\t\t\"sap_fe_FilterBarDelegate_propertyInfoMap\",\n\t\t\tmodifier\n\t\t);\n\t\tif (!propertyInfoFromCD) {\n\t\t\tconst model = mPropertyBag && mPropertyBag.appComponent && mPropertyBag.appComponent.getModel();\n\t\t\tconst oMetaModel = model && model.getMetaModel();\n\t\t\tif (!oMetaModel) {\n\t\t\t\treturn Promise.resolve(null);\n\t\t\t}\n\t\t\tawait _addPropertyInfo(oParentControl, mPropertyBag, oMetaModel, sPropertyInfoName);\n\t\t}\n\t}\n\treturn Promise.resolve();\n};\n/**\n * Clears all input values of visible filter fields in the filter bar.\n * @param oFilterControl Instance of the FilterBar control\n * @returns The resolved promise\n */\nODataFilterBarDelegate.clearFilters = async function (oFilterControl: FilterBar): Promise<void> {\n\tconst filterBarAPI = oFilterControl.getParent();\n\treturn StateHelper.clearFilterValues(filterBarAPI as MacroAPI);\n};\n/**\n * Creates the filter field in the table adaptation of the FilterBar.\n * @param sPropertyInfoName The property name of the entity type for which the filter field needs to be created\n * @param oParentControl Instance of the parent control\n * @returns Once resolved, a filter field definition is returned\n */\nODataFilterBarDelegate._addP13nItem = async function (\n\tsPropertyInfoName: string,\n\toParentControl: FilterBar\n): Promise<NullableModifierElement> {\n\treturn DelegateUtil.fetchModel(oParentControl)\n\t\t.then(async function (oModel: Model) {\n\t\t\treturn ODataFilterBarDelegate._addFlexItem(\n\t\t\t\tsPropertyInfoName,\n\t\t\t\toParentControl,\n\t\t\t\toModel.getMetaModel() as ODataMetaModel,\n\t\t\t\tundefined\n\t\t\t);\n\t\t})\n\t\t.catch(function (oError) {\n\t\t\tLog.error(\"Model could not be resolved\", oError as string);\n\t\t\treturn null;\n\t\t});\n};\nODataFilterBarDelegate.fetchPropertiesForEntity = function (\n\tsEntityTypePath: string,\n\toMetaModel: ODataMetaModel,\n\toFilterControl: IFilterControl\n): PropertyInfo[] {\n\tconst oEntityType = oMetaModel.getObject(sEntityTypePath);\n\tconst includeHidden = oFilterControl.isA(\"sap.ui.mdc.valuehelp.FilterBar\") ? true : undefined;\n\tif (!oFilterControl || !oEntityType) {\n\t\treturn [];\n\t}\n\tconst oConverterContext = FilterUtils.createConverterContext(oFilterControl, sEntityTypePath);\n\tconst sEntitySetPath = ModelHelper.getEntitySetPath(sEntityTypePath);\n\n\tconst mFilterFields = FilterUtils.getConvertedFilterFields(\n\t\toFilterControl,\n\t\tsEntityTypePath,\n\t\tincludeHidden,\n\t\toMetaModel,\n\t\tCommonUtils.getAppComponent(oFilterControl)\n\t);\n\tlet aFetchedProperties: FEPropertyInfo[] = [];\n\tmFilterFields.forEach(function (oFilterFieldInfo: FilterField) {\n\t\tconst sAnnotationPath = oFilterFieldInfo.annotationPath;\n\t\tif (sAnnotationPath && !oFilterFieldInfo.template) {\n\t\t\tconst oPropertyAnnotations = oConverterContext.getConvertedTypes().resolvePath<Property>(sAnnotationPath).target;\n\t\t\tconst sTargetPropertyPrefix = CommonHelper.getLocationForPropertyPath(oMetaModel, sAnnotationPath);\n\t\t\tconst sProperty = sAnnotationPath.replace(`${sTargetPropertyPrefix}/`, \"\");\n\t\t\tconst entityType = oConverterContext.getEntityType();\n\t\t\tconst selectionFields = entityType.annotations?.UI?.SelectionFields;\n\t\t\tconst filterFacets = entityType.annotations?.UI?.FilterFacets;\n\t\t\tif (\n\t\t\t\toPropertyAnnotations &&\n\t\t\t\tODataFilterBarDelegate._isFilterAdaptable(oFilterFieldInfo, oPropertyAnnotations, selectionFields, filterFacets) &&\n\t\t\t\tisPropertyFilterable(oMetaModel, sTargetPropertyPrefix, _getPropertyPath(sProperty), true)\n\t\t\t) {\n\t\t\t\taFetchedProperties.push(oFilterFieldInfo as PropertyInfo);\n\t\t\t}\n\t\t} else {\n\t\t\t//Custom Filters\n\t\t\taFetchedProperties.push(oFilterFieldInfo as PropertyInfo);\n\t\t}\n\t});\n\n\tconst aParameterFields: string[] = [];\n\tconst processedFields = processSelectionFields(aFetchedProperties as FilterField[], oConverterContext);\n\tconst processedFieldsKeys: string[] = [];\n\tprocessedFields.forEach(function (oProps: FEPropertyInfo) {\n\t\tif (oProps.key) {\n\t\t\tprocessedFieldsKeys.push(oProps.key);\n\t\t}\n\t});\n\n\taFetchedProperties = aFetchedProperties.filter(function (oProp: FEPropertyInfo) {\n\t\treturn processedFieldsKeys.includes(oProp.key!);\n\t});\n\n\tconst oFR = CommonUtils.getFilterRestrictionsByPath(sEntitySetPath, oMetaModel),\n\t\tmAllowedExpressions = oFR.FilterAllowedExpressions;\n\t//Object.keys(processedFields).forEach(function (sFilterFieldKey: string) {\n\tprocessedFields.forEach(function (oProp, iFilterFieldIndex: number) {\n\t\tconst oSelField = aFetchedProperties[iFilterFieldIndex];\n\t\tif (!oSelField || !oSelField.conditionPath) {\n\t\t\treturn;\n\t\t}\n\t\tconst sPropertyPath = _getPropertyPath(oSelField.conditionPath);\n\t\t//fetchBasic\n\t\toProp = Object.assign(oProp, {\n\t\t\tgroup: oSelField.group,\n\t\t\tgroupLabel: oSelField.groupLabel,\n\t\t\tpath: oSelField.conditionPath,\n\t\t\ttooltip: null,\n\t\t\tremoveFromAppState: false,\n\t\t\thasValueHelp: false\n\t\t});\n\n\t\t//fetchPropInfo\n\t\tif (oSelField.annotationPath) {\n\t\t\tconst sAnnotationPath = oSelField.annotationPath;\n\t\t\tconst oProperty = oMetaModel.getObject(sAnnotationPath),\n\t\t\t\toPropertyAnnotations = oMetaModel.getObject(`${sAnnotationPath}@`),\n\t\t\t\toPropertyContext = oMetaModel.createBindingContext(sAnnotationPath);\n\n\t\t\tconst bRemoveFromAppState =\n\t\t\t\toPropertyAnnotations[\"@com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive\"] ||\n\t\t\t\toPropertyAnnotations[\"@com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext\"] ||\n\t\t\t\toPropertyAnnotations[\"@com.sap.vocabularies.Analytics.v1.Measure\"];\n\n\t\t\tconst sTargetPropertyPrefix = CommonHelper.getLocationForPropertyPath(oMetaModel, oSelField.annotationPath);\n\t\t\tconst sProperty = sAnnotationPath.replace(`${sTargetPropertyPrefix}/`, \"\");\n\t\t\tlet oFilterDefaultValueAnnotation;\n\t\t\tlet oFilterDefaultValue;\n\t\t\tif (oPropertyContext && isPropertyFilterable(oMetaModel, sTargetPropertyPrefix, _getPropertyPath(sProperty), true)) {\n\t\t\t\toFilterDefaultValueAnnotation = oPropertyAnnotations[\"@com.sap.vocabularies.Common.v1.FilterDefaultValue\"];\n\t\t\t\tif (oFilterDefaultValueAnnotation) {\n\t\t\t\t\toFilterDefaultValue = oFilterDefaultValueAnnotation[`$${getModelType(oProperty.$Type)}`];\n\t\t\t\t}\n\n\t\t\t\toProp = Object.assign(oProp, {\n\t\t\t\t\ttooltip: oPropertyAnnotations[\"@com.sap.vocabularies.Common.v1.QuickInfo\"] || undefined,\n\t\t\t\t\tremoveFromAppState: bRemoveFromAppState,\n\t\t\t\t\thasValueHelp: hasValueHelp(oPropertyContext.getObject(), { context: oPropertyContext }),\n\t\t\t\t\tdefaultFilterConditions: oFilterDefaultValue\n\t\t\t\t\t\t? [\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tfieldPath: oSelField.conditionPath,\n\t\t\t\t\t\t\t\t\toperator: \"EQ\",\n\t\t\t\t\t\t\t\t\tvalues: [oFilterDefaultValue]\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t  ]\n\t\t\t\t\t\t: undefined\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//base\n\n\t\tif (oProp) {\n\t\t\tif (mAllowedExpressions[sPropertyPath] && mAllowedExpressions[sPropertyPath].length > 0) {\n\t\t\t\toProp.filterExpression = CommonUtils.getSpecificAllowedExpression(mAllowedExpressions[sPropertyPath]);\n\t\t\t} else {\n\t\t\t\toProp.filterExpression = \"auto\";\n\t\t\t}\n\n\t\t\toProp = Object.assign(oProp, {\n\t\t\t\tvisible: oSelField.availability === \"Default\"\n\t\t\t});\n\t\t}\n\n\t\tprocessedFields[iFilterFieldIndex] = oProp;\n\t});\n\tprocessedFields.forEach(function (propInfo: FEPropertyInfo) {\n\t\t// key should have the same value as name\n\t\tpropInfo.key = propInfo.name;\n\t\tif (propInfo.path === \"$editState\") {\n\t\t\tpropInfo.label = getResourceModel(oFilterControl).getText(\"FILTERBAR_EDITING_STATUS\");\n\t\t}\n\t\tpropInfo.typeConfig = TypeMap.getTypeConfig(propInfo.dataType, propInfo.formatOptions, propInfo.constraints);\n\t\tpropInfo.label = getLocalizedText(propInfo.label!, oFilterControl) || \"\";\n\t\tif (propInfo.isParameter) {\n\t\t\taParameterFields.push(propInfo.name);\n\t\t}\n\t});\n\n\taFetchedProperties = processedFields;\n\tDelegateUtil.setCustomData(oFilterControl, \"parameters\", aParameterFields as unknown as string);\n\n\treturn aFetchedProperties as PropertyInfo[];\n};\n\nfunction getLineItemQualifierFromTable(oControl: ManagedObject, oMetaModel: ODataMetaModel): string | undefined {\n\tif (oControl.isA<EnhanceWithUI5<TableAPI>>(\"sap.fe.macros.table.TableAPI\")) {\n\t\tconst annotationPaths = oControl.getMetaPath().split(\"#\")[0].split(\"/\");\n\t\tswitch (annotationPaths[annotationPaths.length - 1]) {\n\t\t\tcase `@${UIAnnotationTerms.SelectionPresentationVariant}`:\n\t\t\tcase `@${UIAnnotationTerms.PresentationVariant}`:\n\t\t\t\treturn oMetaModel\n\t\t\t\t\t.getObject(oControl.getMetaPath())\n\t\t\t\t\t.Visualizations?.find((visualization: { $AnnotationPath: string }) =>\n\t\t\t\t\t\tvisualization.$AnnotationPath.includes(`@${UIAnnotationTerms.LineItem}`)\n\t\t\t\t\t).$AnnotationPath;\n\t\t\tcase `@${UIAnnotationTerms.LineItem}`:\n\t\t\t\tconst metaPaths = oControl.getMetaPath().split(\"/\");\n\t\t\t\treturn metaPaths[metaPaths.length - 1];\n\t\t}\n\t}\n\treturn undefined;\n}\n\nODataFilterBarDelegate._isFilterAdaptable = function (\n\tfilterFieldInfo: FilterField,\n\tpropertyAnnotations: Property,\n\tselectionFields?: SelectionFields,\n\tfilterFacets?: FilterFacets\n): boolean {\n\tlet isInFilterFacets: boolean;\n\tconst isSelectionField = selectionFields ? ODataFilterBarDelegate._isFilterInSelectionFields(selectionFields, filterFieldInfo) : false;\n\tif (filterFacets) {\n\t\tisInFilterFacets = filterFacets.some(function (filterFacet: ReferenceFacet) {\n\t\t\tconst fieldGroup = filterFacet.Target?.$target as FieldGroupType;\n\t\t\treturn fieldGroup?.Data.some(function (dataField: DataFieldAbstractTypes) {\n\t\t\t\t// we expect dataField to be DataFieldTypes (having a Value) inside FieldGroups inside FilterFacets\n\t\t\t\tif ((dataField as DataFieldTypes).Value.path === filterFieldInfo.key) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t\t// dataField types having no Value (DataFieldForAnnotationTypes, DataFieldForActionAbstractTypes, DataFieldForActionGroupTypes), there is nothing to check, but this should not occur anyway\n\t\t\t\treturn false;\n\t\t\t});\n\t\t});\n\t} else {\n\t\tisInFilterFacets = false;\n\t}\n\treturn isSelectionField || isInFilterFacets || !propertyAnnotations.annotations?.UI?.AdaptationHidden;\n};\n\nODataFilterBarDelegate._isFilterInSelectionFields = function (selectionFields: SelectionFields, filterFieldInfo: FilterField): boolean {\n\tconst filterFieldKey = filterFieldInfo.key?.indexOf(\"::\") > 0 ? filterFieldInfo.key?.replace(\"::\", \"/\") : filterFieldInfo.key;\n\treturn selectionFields.some(function (selectionField: AnnotationSelectionField) {\n\t\tif (selectionField.value === filterFieldKey) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t});\n};\n\nODataFilterBarDelegate._addFlexItem = async function (\n\tsFlexPropertyName: string,\n\toParentControl: FilterBar,\n\toMetaModel: ODataMetaModel,\n\toModifier: BaseTreeModifier | undefined,\n\toAppComponent: AppComponent | undefined,\n\tview?: View | undefined\n): Promise<NullableModifierElement> {\n\tconst sFilterBarId = oModifier ? oModifier.getId(oParentControl) : oParentControl.getId(),\n\t\tsIdPrefix = oModifier ? \"\" : \"Adaptation\",\n\t\taSelectionFields = FilterUtils.getConvertedFilterFields(\n\t\t\toParentControl as unknown as IFilterControl,\n\t\t\tundefined,\n\t\t\tundefined,\n\t\t\toMetaModel,\n\t\t\toAppComponent,\n\t\t\toModifier,\n\t\t\toModifier ? undefined : getLineItemQualifierFromTable(oParentControl.getParent()!, oMetaModel)\n\t\t),\n\t\toSelectionField = ODataFilterBarDelegate._findSelectionField(aSelectionFields, sFlexPropertyName),\n\t\tsPropertyPath = _getPropertyPath(sFlexPropertyName),\n\t\tbIsXML = !!oModifier && oModifier.targets === \"xmlTree\";\n\tif (sFlexPropertyName === EDIT_STATE_PROPERTY_NAME) {\n\t\treturn _templateEditState(_generateIdPrefix(sFilterBarId, `${sIdPrefix}FilterField`), oMetaModel, oModifier);\n\t} else if (sFlexPropertyName === SEARCH_PROPERTY_NAME) {\n\t\treturn Promise.resolve(null);\n\t} else if (oSelectionField?.template) {\n\t\treturn ODataFilterBarDelegate._templateCustomFilter(\n\t\t\toParentControl as unknown as IFilterControl,\n\t\t\t_generateIdPrefix(sFilterBarId, `${sIdPrefix}`),\n\t\t\toSelectionField,\n\t\t\toMetaModel,\n\t\t\toModifier!\n\t\t);\n\t}\n\n\tif (oSelectionField?.type === \"Slot\" && oModifier) {\n\t\treturn _addXMLCustomFilterField(oParentControl as unknown as IFilterControl, oModifier, sPropertyPath);\n\t}\n\n\tconst sNavigationPath = CommonHelper.getNavigationPath(sPropertyPath);\n\tlet sEntityTypePath: string;\n\tlet sUseSemanticDateRange;\n\tlet oSettings: {\n\t\tbindingContexts: {\n\t\t\tcontextPath: Context;\n\t\t\tproperty: Context;\n\t\t};\n\t\tmodels: {\n\t\t\tcontextPath: ODataMetaModel;\n\t\t\tproperty?: ODataMetaModel;\n\t\t\tmetaPath?: ODataMetaModel;\n\t\t};\n\t\tisXML: boolean;\n\t};\n\tlet sBindingPath;\n\tlet oParameters: {\n\t\tmetaPath: string;\n\t\tsPropertyName: string;\n\t\tsBindingPath: string;\n\t\tsValueHelpType: string;\n\t\toMetaModel: ODataMetaModel;\n\t\tsIdPrefix: string;\n\t\toSettings: unknown;\n\t\tsVhIdPrefix: string;\n\t\tsNavigationPrefix?: string;\n\t\tbUseSemanticDateRange: boolean;\n\t\toModifier?: BaseTreeModifier;\n\t\toControl: UI5Element;\n\t\tvisualFilter?: unknown;\n\t\tview?: View;\n\t\tlabel?: string;\n\t};\n\n\treturn Promise.resolve()\n\t\t.then(async function () {\n\t\t\tif (oSelectionField?.isParameter) {\n\t\t\t\tconst sAnnotationPath = oSelectionField.annotationPath;\n\t\t\t\treturn sAnnotationPath.substring(0, sAnnotationPath.lastIndexOf(\"/\") + 1);\n\t\t\t}\n\t\t\treturn DelegateUtil.getCustomDataWithModifier<string>(oParentControl, \"entityType\", oModifier);\n\t\t})\n\t\t.then(async function (sRetrievedEntityTypePath: string | undefined) {\n\t\t\tsEntityTypePath = sRetrievedEntityTypePath!;\n\t\t\treturn DelegateUtil.getCustomDataWithModifier<string>(oParentControl, \"useSemanticDateRange\", oModifier);\n\t\t})\n\t\t.then(async function (sRetrievedUseSemanticDateRange: string | undefined) {\n\t\t\tsUseSemanticDateRange = sRetrievedUseSemanticDateRange;\n\t\t\tconst oPropertyContext = oMetaModel.createBindingContext(sEntityTypePath + sPropertyPath)!;\n\t\t\tlet sInFilterBarId = oModifier ? oModifier.getId(oParentControl) : oParentControl.getId();\n\t\t\tif (sInFilterBarId.endsWith(\"-content\")) {\n\t\t\t\t// -content is only added when the building block is used directly in the filter bar\n\t\t\t\tsInFilterBarId = sInFilterBarId.substring(0, sInFilterBarId.lastIndexOf(\"-content\"));\n\t\t\t\t// By using the id of the parent control, we can get the correct idPrefix for the value help\n\t\t\t}\n\t\t\toSettings = {\n\t\t\t\tbindingContexts: {\n\t\t\t\t\tcontextPath: oMetaModel.createBindingContext(sEntityTypePath)!,\n\t\t\t\t\tproperty: oPropertyContext\n\t\t\t\t},\n\t\t\t\tmodels: {\n\t\t\t\t\tcontextPath: oMetaModel,\n\t\t\t\t\tproperty: oMetaModel\n\t\t\t\t},\n\t\t\t\tisXML: bIsXML\n\t\t\t};\n\t\t\tsBindingPath = `/${ModelHelper.getEntitySetPath(sEntityTypePath)\n\t\t\t\t.split(\"/\")\n\t\t\t\t.filter(ModelHelper.filterOutNavPropBinding)\n\t\t\t\t.join(\"/\")}`;\n\t\t\toParameters = {\n\t\t\t\tmetaPath: oPropertyContext.getPath(),\n\t\t\t\tsPropertyName: sPropertyPath,\n\t\t\t\tsBindingPath: sBindingPath,\n\t\t\t\tsValueHelpType: sIdPrefix + VALUE_HELP_TYPE,\n\t\t\t\toControl: oParentControl,\n\t\t\t\toMetaModel: oMetaModel,\n\t\t\t\toModifier: oModifier,\n\t\t\t\tsIdPrefix: _generateIdPrefix(sInFilterBarId, `${sIdPrefix}FilterField`, sNavigationPath),\n\t\t\t\tsVhIdPrefix: _generateIdPrefix(sInFilterBarId, sIdPrefix + VALUE_HELP_TYPE),\n\t\t\t\tsNavigationPrefix: sNavigationPath,\n\t\t\t\tbUseSemanticDateRange: sUseSemanticDateRange as unknown as boolean,\n\t\t\t\toSettings: oSelectionField?.settings ?? {},\n\t\t\t\tvisualFilter: oSelectionField?.visualFilter,\n\t\t\t\tview,\n\t\t\t\tlabel: oSelectionField?.label\n\t\t\t};\n\n\t\t\treturn DelegateUtil.doesValueHelpExist(oParameters);\n\t\t})\n\t\t.then(async function (bValueHelpExists: boolean) {\n\t\t\tif (!bValueHelpExists) {\n\t\t\t\treturn _templateValueHelp(\n\t\t\t\t\t{\n\t\t\t\t\t\tbindingContexts: {\n\t\t\t\t\t\t\tcontextPath: oMetaModel.createBindingContext(sEntityTypePath)!,\n\t\t\t\t\t\t\tmetaPath: oSettings.bindingContexts.property\n\t\t\t\t\t\t},\n\t\t\t\t\t\tmodels: {\n\t\t\t\t\t\t\tcontextPath: oMetaModel,\n\t\t\t\t\t\t\tmetaPath: oMetaModel\n\t\t\t\t\t\t},\n\t\t\t\t\t\tisXML: bIsXML\n\t\t\t\t\t},\n\t\t\t\t\toParameters\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn;\n\t\t})\n\t\t.then(async function () {\n\t\t\treturn DelegateUtil.getCustomDataWithModifier<string>(oParentControl, \"localId\", oModifier);\n\t\t})\n\t\t.then(async function (localId: string | undefined) {\n\t\t\tlet pageModel;\n\t\t\tif (oParameters.visualFilter) {\n\t\t\t\t//Need to set the convertercontext as pageModel in settings for BuildingBlock 2.0\n\t\t\t\tpageModel = CommonUtils.getTargetView(oParentControl).getController()._getPageModel();\n\t\t\t}\n\t\t\treturn _templateFilterField(oSettings, oParameters, localId, pageModel);\n\t\t});\n};\nfunction _getCachedProperties(oFilterBar: IFilterControl | Element): null | PropertyInfo[] | undefined {\n\t// properties are not cached during templating\n\tif (oFilterBar instanceof window.Element) {\n\t\treturn null;\n\t}\n\treturn DelegateUtil.getCustomData<PropertyInfo[]>(oFilterBar, FETCHED_PROPERTIES_DATA_KEY);\n}\nfunction _setCachedProperties(oFilterBar: IFilterControl | Element, aFetchedProperties: PropertyInfo[]): void {\n\t// do not cache during templating, else it becomes part of the cached view\n\tif (oFilterBar instanceof window.Element) {\n\t\treturn;\n\t}\n\tDelegateUtil.setCustomData(oFilterBar, FETCHED_PROPERTIES_DATA_KEY, aFetchedProperties as unknown as string);\n}\nfunction _getCachedOrFetchPropertiesForEntity(\n\tsEntityTypePath: string,\n\toMetaModel: ODataMetaModel,\n\toFilterBar: IFilterControl\n): ControlPropertyInfo[] | PropertyInfoExternal[] {\n\tlet aFetchedProperties = _getCachedProperties(oFilterBar);\n\tlet localGroupLabel;\n\n\tif (!aFetchedProperties) {\n\t\taFetchedProperties = ODataFilterBarDelegate.fetchPropertiesForEntity(sEntityTypePath, oMetaModel, oFilterBar);\n\t\taFetchedProperties.forEach(function (oGroup: FEPropertyInfo) {\n\t\t\tlocalGroupLabel = null;\n\t\t\tif (oGroup.groupLabel) {\n\t\t\t\tlocalGroupLabel = getLocalizedText(oGroup.groupLabel, oFilterBar);\n\t\t\t\toGroup.groupLabel = localGroupLabel === null ? oGroup.groupLabel : localGroupLabel;\n\t\t\t}\n\t\t});\n\t\tsortPropertyInfosByGroupLabel(aFetchedProperties);\n\t\t_setCachedProperties(oFilterBar, aFetchedProperties);\n\t}\n\treturn aFetchedProperties;\n}\nODataFilterBarDelegate.fetchProperties = async function (filterBar: FilterBar): Promise<PropertyInfoExternal[]> {\n\tconst propertyInfos = await ODataFilterBarDelegate.fetchFilterProperties(filterBar as unknown as IFilterControl);\n\tDelegateUtil.setCustomData(filterBar, \"feFilterInfo\", propertyInfos);\n\tif (propertyInfos.length > 0) {\n\t\treturn FilterUtils.formatPropertyInfo(propertyInfos as PropertyInfo[]) as PropertyInfoExternal[];\n\t} else {\n\t\treturn [];\n\t}\n};\n\nODataFilterBarDelegate.fetchFilterProperties = async function (\n\tfilterBar: IFilterControl\n): Promise<ControlPropertyInfo[] | PropertyInfoExternal[]> {\n\tconst entityTypePath = DelegateUtil.getCustomData<string>(filterBar, \"entityType\")!;\n\treturn DelegateUtil.fetchModel(filterBar as FilterBar).then(function (model: Model) {\n\t\tif (!model) {\n\t\t\treturn [];\n\t\t}\n\t\treturn _getCachedOrFetchPropertiesForEntity(entityTypePath, model.getMetaModel() as ODataMetaModel, filterBar);\n\t});\n};\n\nODataFilterBarDelegate.getTypeMap = function (): typeof TypeMap {\n\treturn TypeMap;\n};\n\nexport default ODataFilterBarDelegate;\n"],"mappings":"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","ignoreList":[],"file":"FilterBarDelegate-dbg.js"}