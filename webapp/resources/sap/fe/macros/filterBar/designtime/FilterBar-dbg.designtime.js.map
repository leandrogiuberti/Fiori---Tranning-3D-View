{"version":3,"names":["configPath","getAdaptationProperties","designtimeSettings","filterBar","filterBarAPI","propertyValues","forEach","setting","id","getAdaptationPropertyValue","_exports","filterBarApi","returnValue","filterBarInfoForConversion","StateHelper","_getControlInfoForConversion","getContent","getProperty","useSemanticDateRange","selectionFieldsConfigs","navigationProperties","FilterBarBlockDesignTime","actions","annotation","textArrangement","getTextArrangementChangeAction","rename","getRenameAction","settings","fe","name","getText","icon","isEnabled","isManifestChangesEnabled","handler","getParent","getDesigntimeSettings","unchangedData","structuredClone","configContext","getBindingContext","isConfigModelPrepared","items","getSettings","getSettingsIfKeyUser","CommonUtils","getAppComponent","prepareConfigModel","resourceModel","getModel","openAdaptionDialog","then","propertyValuesEntered","propertyPath","getPropertyPath","extractChanges","noChanges","properties","showClearButton","ignore","liveMode","showGoButton","showMessages","visible","blocked","busy","busyIndicatorDelay","busyIndicatorSize","initialLayout","showAdaptFiltersButton","aggregations","manifestSettings","getPropertyNamesAndDescriptions","manifestSettingsValues","returnValues","manifestPropertyPath","control","manifestPropertyChange","propertyChanges","separateChanges"],"sourceRoot":".","sources":["FilterBar.designtime.ts"],"sourcesContent":["/*!\n */\n\nimport CommonUtils from \"sap/fe/core/CommonUtils\";\nimport type ResourceModel from \"sap/fe/core/ResourceModel\";\nimport { getRenameAction, getText, getTextArrangementChangeAction } from \"sap/fe/core/designtime/AnnotationBasedChanges\";\nimport type { DesigntimeSetting, PropertyValue, adaptionChange } from \"sap/fe/macros/designtime/Designtime.helper\";\nimport {\n\textractChanges,\n\tgetPropertyNamesAndDescriptions,\n\tgetSettingsIfKeyUser,\n\tisConfigModelPrepared,\n\tisManifestChangesEnabled,\n\tnoChanges,\n\topenAdaptionDialog,\n\tprepareConfigModel,\n\tseparateChanges\n} from \"sap/fe/macros/designtime/Designtime.helper\";\nimport type FilterBarAPI from \"sap/fe/macros/filterBar/FilterBarAPI\";\nimport { getDesigntimeSettings, getPropertyPath, getSettings } from \"sap/fe/macros/filterBar/designtime/FilterBar.designtime.helper\";\nimport StateHelper from \"sap/fe/macros/mdc/adapter/StateHelper\";\nimport type FilterBar from \"sap/ui/mdc/FilterBar\";\nimport type Context from \"sap/ui/model/Context\";\n\nconst configPath = \"rta/filterBarConfigSettings\";\n\nexport function getAdaptationProperties(\n\tdesigntimeSettings: DesigntimeSetting[],\n\tfilterBar: FilterBar,\n\tfilterBarAPI: FilterBarAPI\n): PropertyValue {\n\tconst propertyValues: PropertyValue = {};\n\tdesigntimeSettings.forEach(function (setting) {\n\t\tpropertyValues[setting.id] = getAdaptationPropertyValue(setting, filterBar, filterBarAPI);\n\t});\n\treturn propertyValues;\n}\n\n/**\n * Returns the value of one of the settings that have been defined for filter bar adaptation.\n * @param setting The definition of the setting required for adaptation\n * @param filterBar Reference of the filter bar control\n * @param filterBarApi Reference of the parent of filter bar control\n * @returns Setting definition with a value for selected control\n */\nfunction getAdaptationPropertyValue(\n\tsetting: DesigntimeSetting,\n\tfilterBar: FilterBar,\n\tfilterBarApi: FilterBarAPI\n): boolean | string | number | string[] {\n\tlet returnValue: boolean | string | number | string[] = \"\";\n\n\tconst filterBarInfoForConversion = StateHelper._getControlInfoForConversion(filterBar);\n\n\tswitch (setting.id) {\n\t\tcase \"showClearButton\":\n\t\t\treturnValue = filterBarApi.getContent()?.getProperty(\"showClearButton\") || false;\n\t\t\tbreak;\n\t\tcase \"useSemanticDateRange\":\n\t\t\treturnValue =\n\t\t\t\tfilterBarInfoForConversion.useSemanticDateRange ||\n\t\t\t\tfilterBarInfoForConversion.selectionFieldsConfigs?.useSemanticDateRange ||\n\t\t\t\tfalse;\n\t\t\tbreak;\n\t\tcase \"navigationProperties\":\n\t\t\treturnValue = filterBarInfoForConversion.selectionFieldsConfigs?.navigationProperties || []; // prevent navigationProperties from being undefined\n\t\t\tbreak;\n\t}\n\treturn returnValue;\n}\n\nconst FilterBarBlockDesignTime = {\n\tactions: {\n\t\tannotation: {\n\t\t\ttextArrangement: getTextArrangementChangeAction(),\n\t\t\trename: getRenameAction()\n\t\t},\n\t\tsettings: {\n\t\t\tfe: {\n\t\t\t\tname: getText(\"RTA_CONTEXT_ACTIONMENU_CONFIG\"),\n\t\t\t\ticon: \"sap-icon://developer-settings\",\n\t\t\t\tisEnabled: isManifestChangesEnabled,\n\t\t\t\thandler: async function (filterBar: FilterBar): Promise<adaptionChange[]> {\n\t\t\t\t\tconst filterBarApi = filterBar.getParent() as FilterBarAPI;\n\t\t\t\t\tconst designtimeSettings = getDesigntimeSettings();\n\t\t\t\t\tconst propertyValues = getAdaptationProperties(designtimeSettings, filterBar, filterBarApi);\n\t\t\t\t\tconst unchangedData = structuredClone(propertyValues); //deep copy to remember the starting value set, needed for the navigation properties multi inhput field\n\t\t\t\t\tconst configContext = filterBar.getBindingContext(\"internal\") as Context;\n\t\t\t\t\tif (!isConfigModelPrepared(configContext, configPath)) {\n\t\t\t\t\t\t// first time this session\n\t\t\t\t\t\tlet items = getSettings(filterBarApi, propertyValues);\n\t\t\t\t\t\titems = getSettingsIfKeyUser(CommonUtils.getAppComponent(filterBar), items);\n\t\t\t\t\t\t// use internal model to persist adaptation configuration values\n\t\t\t\t\t\tprepareConfigModel(items, configContext, configPath);\n\t\t\t\t\t}\n\t\t\t\t\tconst resourceModel = filterBar.getModel(\"sap.fe.i18n\") as ResourceModel;\n\t\t\t\t\treturn openAdaptionDialog(\n\t\t\t\t\t\tconfigContext,\n\t\t\t\t\t\tpropertyValues,\n\t\t\t\t\t\t\"{sap.fe.i18n>RTA_CONFIGURATION_TITLE_FILTERBAR}\",\n\t\t\t\t\t\tresourceModel,\n\t\t\t\t\t\tconfigPath\n\t\t\t\t\t).then(function (propertyValuesEntered: PropertyValue): adaptionChange[] | [] {\n\t\t\t\t\t\tconst propertyPath = getPropertyPath();\n\t\t\t\t\t\treturn extractChanges(designtimeSettings, unchangedData, propertyValuesEntered, propertyPath, filterBar);\n\t\t\t\t\t}, noChanges);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t},\n\t// We disable mdc filter bar properties in the property panel of Fiori Tools\n\tproperties: {\n\t\tshowClearButton: { ignore: true },\n\t\tliveMode: { ignore: true },\n\t\tshowGoButton: { ignore: true },\n\t\tshowMessages: { ignore: true },\n\t\tvisible: { ignore: true },\n\t\tblocked: { ignore: true },\n\t\tbusy: { ignore: true },\n\t\tbusyIndicatorDelay: { ignore: true },\n\t\tbusyIndicatorSize: { ignore: true },\n\t\tinitialLayout: { ignore: true },\n\t\tshowAdaptFiltersButton: { ignore: true }\n\t},\n\n\taggregations: {},\n\t// These functions provide the properties used in filter bar adaption to Fiori tools.\n\tmanifestSettings: function (filterBar: FilterBar): DesigntimeSetting[] {\n\t\treturn getPropertyNamesAndDescriptions(getDesigntimeSettings(), filterBar.getModel(\"sap.fe.i18n\") as ResourceModel);\n\t},\n\t// getAdaptionPropertyValue\n\tmanifestSettingsValues: function (designtimeSettings: DesigntimeSetting[], filterBar: FilterBar): PropertyValue {\n\t\tconst filterBarApi = filterBar.getParent() as FilterBarAPI;\n\t\tconst returnValues: PropertyValue = {};\n\t\tdesigntimeSettings.forEach(function (setting) {\n\t\t\treturnValues[setting.id] = getAdaptationPropertyValue(setting, filterBar, filterBarApi);\n\t\t});\n\t\treturn returnValues;\n\t},\n\t// get path for control configuration. Pass reference to the control\n\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\n\tmanifestPropertyPath: function (control: FilterBar): string {\n\t\treturn getPropertyPath();\n\t},\n\t// create change structue. Pass array of manifest setting and new value, the property path and the control\n\tmanifestPropertyChange: function (propertyChanges: PropertyValue, propertyPath: string, control: FilterBar): adaptionChange[] {\n\t\treturn separateChanges(propertyChanges, propertyPath, control);\n\t}\n};\n\nexport default FilterBarBlockDesignTime;\n"],"mappings":"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","ignoreList":[],"file":"FilterBar-dbg.designtime.js"}