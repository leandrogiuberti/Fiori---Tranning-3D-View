{"version":3,"file":"FieldWrapper.js","names":["FieldWrapper","_dec","defineUI5Class","_dec2","implementInterface","_dec3","property","type","_dec4","defaultValue","_dec5","_dec6","_dec7","_dec8","_dec9","association","multiple","singularName","_dec10","aggregation","isDefault","_dec11","_class","_class2","_Control","id","settings","_this","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","_descriptor6","_descriptor7","_descriptor8","_descriptor9","_descriptor10","resourceBundle","Lib","getResourceBundleFor","_inheritsLoose","_proto","prototype","enhanceAccessibilityState","oElement","mAriaProps","oParent","getParent","addAggregation","sAggregationName","oObject","bSuppressInvalidate","isA","setPreferUserInteraction","getAccessibilityInfo","oContent","editMode","contentDisplay","contentEdit","length","getIdForLabel","setEditMode","value","switchToDisplayTimeOutId","clearTimeout","undefined","delaySwitchToDisplay","window","setTimeout","setProperty","invalidate","_setAriaLabelledBy","addAriaLabelledBy","aAriaLabelledBy","ariaLabelledBy","sId","aAriaLabelledBys","getAriaLabelledBy","includes","onBeforeRendering","aContentEdit","item","render","oRm","oControl","openStart","style","textAlign","width","parentControl","hasInlineEdit","formatOptions","reactiveAreaMode","attr","getText","openEnd","renderControl","close","Control","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./FieldWrapper.ts"],"sourcesContent":["import type ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport type { PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { aggregation, association, defineUI5Class, implementInterface, property } from \"sap/fe/base/ClassSupport\";\nimport type InputBase from \"sap/m/InputBase\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type { $ControlSettings } from \"sap/ui/core/Control\";\nimport Control from \"sap/ui/core/Control\";\nimport Lib from \"sap/ui/core/Lib\";\nimport type RenderManager from \"sap/ui/core/RenderManager\";\nimport type { AccessibilityInfo, CSSSize, IFormContent, TextAlign } from \"sap/ui/core/library\";\nimport type Field from \"../Field\";\n\ntype ControlWithAccessibility = Control & { addAriaLabelledBy?: (id: string) => void; getAriaLabelledBy: () => string[] };\n\n@defineUI5Class(\"sap.fe.macros.controls.FieldWrapper\")\nclass FieldWrapper extends Control implements IFormContent {\n\t@implementInterface(\"sap.ui.core.IFormContent\")\n\t__implements__sap_ui_core_IFormContent = true;\n\n\t@property({ type: \"sap.ui.core.TextAlign\" })\n\ttextAlign!: TextAlign;\n\n\t@property({ type: \"sap.ui.core.CSSSize\", defaultValue: null })\n\twidth!: CSSSize;\n\n\t@property({ type: \"boolean\", defaultValue: false })\n\tformDoNotAdjustWidth!: boolean;\n\n\t@property({ type: \"string\", defaultValue: \"Display\" })\n\teditMode!: string;\n\n\t@property({ type: \"boolean\", defaultValue: false })\n\trequired!: boolean;\n\n\t@property({ type: \"boolean\", defaultValue: false })\n\tdelaySwitchToDisplay!: boolean;\n\n\t/**\n\t * Association to controls / IDs that label this control (see WAI-ARIA attribute aria-labelledby).\n\t */\n\t@association({ type: \"sap.ui.core.Control\", multiple: true, singularName: \"ariaLabelledBy\" })\n\tariaLabelledBy!: string[];\n\n\t@aggregation({ type: \"sap.ui.core.Control\", multiple: false, isDefault: true })\n\tcontentDisplay!: ControlWithAccessibility;\n\n\t@aggregation({ type: \"sap.ui.core.Control\", multiple: true })\n\tcontentEdit!: ControlWithAccessibility[];\n\n\tprivate resourceBundle: ResourceBundle;\n\n\tprivate switchToDisplayTimeOutId?: number;\n\n\tconstructor(\n\t\tid?: string | undefined | (PropertiesOf<FieldWrapper> & $ControlSettings),\n\t\tsettings?: $ControlSettings & PropertiesOf<FieldWrapper>\n\t) {\n\t\tsuper(id as string, settings);\n\t\tthis.resourceBundle = Lib.getResourceBundleFor(\"sap.fe.controls\")!;\n\t}\n\n\tenhanceAccessibilityState(oElement: object, mAriaProps: object): object {\n\t\tconst oParent = this.getParent();\n\n\t\tif (oParent && (oParent as ManagedObject & { enhanceAccessibilityState?: Function }).enhanceAccessibilityState) {\n\t\t\t// forward  enhanceAccessibilityState call to the parent\n\t\t\t(oParent as ManagedObject & { enhanceAccessibilityState: Function }).enhanceAccessibilityState(oElement, mAriaProps);\n\t\t}\n\n\t\treturn mAriaProps;\n\t}\n\n\t/**\n\t * Adds a control to the aggregation.\n\t * @param sAggregationName\n\t * @param oObject\n\t * @param bSuppressInvalidate\n\t * @returns The FieldWrapper instance\n\t */\n\taddAggregation(sAggregationName: string, oObject: ManagedObject, bSuppressInvalidate?: boolean): this {\n\t\tif (sAggregationName === \"contentEdit\" && oObject.isA<InputBase>(\"sap.m.InputBase\")) {\n\t\t\toObject.setPreferUserInteraction(true);\n\t\t}\n\t\treturn super.addAggregation(sAggregationName, oObject, bSuppressInvalidate);\n\t}\n\n\tgetAccessibilityInfo(): AccessibilityInfo {\n\t\tlet oContent;\n\t\tif (this.editMode === \"Display\") {\n\t\t\toContent = this.contentDisplay;\n\t\t} else {\n\t\t\toContent = this.contentEdit.length ? this.contentEdit[0] : null;\n\t\t}\n\t\treturn oContent && oContent.getAccessibilityInfo ? oContent.getAccessibilityInfo() : {};\n\t}\n\n\t/**\n\t * Returns the DOMNode ID to be used for the \"labelFor\" attribute.\n\t *\n\t * We forward the call of this method to the content control.\n\t * @returns ID to be used for the <code>labelFor</code>\n\t */\n\tgetIdForLabel(): string {\n\t\tlet oContent;\n\t\tif (this.editMode === \"Display\") {\n\t\t\toContent = this.contentDisplay;\n\t\t} else {\n\t\t\toContent = this.contentEdit.length ? this.contentEdit[0] : null;\n\t\t}\n\t\treturn (oContent as Control)?.getIdForLabel();\n\t}\n\n\t/**\n\t * Setter for editMode.\n\t * @param value\n\t */\n\tsetEditMode(value: string): void {\n\t\tif (this.switchToDisplayTimeOutId) {\n\t\t\tclearTimeout(this.switchToDisplayTimeOutId);\n\t\t\tthis.switchToDisplayTimeOutId = undefined;\n\t\t}\n\t\tif (this.delaySwitchToDisplay && this.editMode && value === \"Display\" && this.editMode !== \"Display\") {\n\t\t\tthis.switchToDisplayTimeOutId = window.setTimeout(() => {\n\t\t\t\tthis.setProperty(\"editMode\", value);\n\t\t\t\tthis.invalidate();\n\t\t\t\tthis.switchToDisplayTimeOutId = undefined;\n\t\t\t}, 100); // workaround to ensure input focusout does not trigger a Patch request\n\t\t\t// DINC0524872\n\t\t} else {\n\t\t\tthis.setProperty(\"editMode\", value);\n\t\t}\n\t}\n\n\t_setAriaLabelledBy(oContent?: ControlWithAccessibility): void {\n\t\tif (oContent && oContent.addAriaLabelledBy) {\n\t\t\tconst aAriaLabelledBy = this.ariaLabelledBy;\n\n\t\t\tfor (const sId of aAriaLabelledBy) {\n\t\t\t\tconst aAriaLabelledBys = oContent.getAriaLabelledBy() || [];\n\t\t\t\tif (!aAriaLabelledBys.includes(sId)) {\n\t\t\t\t\toContent.addAriaLabelledBy(sId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonBeforeRendering(): void {\n\t\t// before calling the renderer of the FieldWrapper parent control may have set ariaLabelledBy\n\t\t// we ensure it is passed to its inner controls\n\t\tthis._setAriaLabelledBy(this.contentDisplay);\n\t\tconst aContentEdit = this.contentEdit;\n\t\tfor (const item of aContentEdit) {\n\t\t\tthis._setAriaLabelledBy(item);\n\t\t}\n\t}\n\n\tstatic render(oRm: RenderManager, oControl: FieldWrapper): void {\n\t\toRm.openStart(\"div\", oControl);\n\t\toRm.style(\"text-align\", oControl.textAlign);\n\t\tif (oControl.editMode === \"Display\") {\n\t\t\toRm.style(\"width\", oControl.width);\n\t\t\tconst parentControl = oControl.getParent() as Field;\n\t\t\tif (parentControl.hasInlineEdit && parentControl.formatOptions?.reactiveAreaMode !== \"Overlay\") {\n\t\t\t\t// tooltip\n\t\t\t\toRm.attr(\"title\", oControl.resourceBundle.getText(\"M_INLINE_EDIT_TOOLTIP_DOUBLECLICK_EDIT\"));\n\t\t\t\t// focus\n\t\t\t\toRm.attr(\"tabindex\", 0);\n\t\t\t}\n\t\t\toRm.openEnd();\n\t\t\toRm.renderControl(oControl.contentDisplay); // render the child Control for display\n\t\t} else {\n\t\t\tconst aContentEdit = oControl.contentEdit;\n\n\t\t\toRm.style(\"width\", oControl.width);\n\t\t\toRm.openEnd();\n\t\t\tfor (const oContent of aContentEdit) {\n\t\t\t\t// render the child Control  for edit\n\t\t\t\toRm.renderControl(oContent);\n\t\t\t}\n\t\t}\n\t\toRm.close(\"div\"); // end of the complete Control\n\t}\n}\n\nexport default FieldWrapper;\n"],"mappings":"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","ignoreList":[]}