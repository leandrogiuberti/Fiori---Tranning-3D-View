/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/base/ClassSupport","sap/fe/macros/controls/filterbar/FilterContainer","sap/fe/macros/controls/filterbar/VisualFilterContainer","sap/ui/core/Element","sap/ui/mdc/FilterBar","sap/ui/mdc/filterbar/aligned/FilterItemLayout","./filterbar/utils/VisualFilterUtils"],function(t,e,i,r,o,a,n,l){"use strict";var s,u,c,d,f,h,g,y,F;var p=e.property;var _=e.defineUI5Class;var B=e.association;function b(t,e,i,r){i&&Object.defineProperty(t,e,{enumerable:i.enumerable,configurable:i.configurable,writable:i.writable,value:i.initializer?i.initializer.call(r):void 0})}function m(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,L(t,e)}function L(t,e){return L=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},L(t,e)}function S(t,e,i,r,o){var a={};return Object.keys(r).forEach(function(t){a[t]=r[t]}),a.enumerable=!!a.enumerable,a.configurable=!!a.configurable,("value"in a||a.initializer)&&(a.writable=!0),a=i.slice().reverse().reduce(function(i,r){return r(t,e,i)||i},a),o&&void 0!==a.initializer&&(a.value=a.initializer?a.initializer.call(o):void 0,a.initializer=void 0),void 0===a.initializer?(Object.defineProperty(t,e,a),null):a}function v(t,e){throw Error("Decorating class property failed. Please ensure that transform-class-properties is enabled and runs after the decorators transform.")}const C="sap.fe.macros.controls.filterbar.VisualFilterContainer",A="sap.fe.macros.controls.filterbar.FilterContainer";let z=(s=_("sap.fe.macros.controls.FilterBar"),u=p({type:"string",defaultValue:"compact"}),c=p({type:"boolean",defaultValue:false}),d=B({type:"sap.m.SegmentedButton",multiple:false}),s(f=(h=function(e){function a(t,i){var r;delete t?.propertyInfo;delete i?.propertyInfo;r=e.call(this,t,i)||this;b(r,"initialLayout",g,r);b(r,"disableDraftEditStateFilter",y,r);b(r,"toggleControl",F,r);r._isInitialized=false;r._initializeStatus();return r}m(a,e);var s=a.prototype;s._initializeStatus=async function t(){await this.waitForInitialization();this._isInitialized=true};s.isInitialized=function t(){return!!this._isInitialized};s.setToggleControl=function t(e){if(typeof e==="string"){this._oSegmentedButton=o.getElementById(e)}else{this._oSegmentedButton=e}if(this.toggleControl&&this._oSegmentedButton){this._oSegmentedButton.detachEvent("selectionChange",this._toggleLayout.bind(this))}if(this._oSegmentedButton){this._oSegmentedButton.attachEvent("selectionChange",this._toggleLayout.bind(this))}this.setAssociation("toggleControl",e,true)};s._toggleLayout=function e(){this.waitForInitialization().then(()=>{const t=this._oSegmentedButton?.getSelectedKey();if(t==="visual"&&this._oFilterBarLayout?.isA("sap.fe.macros.controls.filterbar.VisualFilterContainer")||t==="compact"&&!this._oFilterBarLayout?.isA("sap.fe.macros.controls.filterbar.VisualFilterContainer")){return}if(!this._oSecondaryFilterBarLayout){this._oSecondaryFilterBarLayout=new r}if(this._oSecondaryFilterBarLayout?.isA("sap.fe.macros.controls.filterbar.VisualFilterContainer")){this.setShowAdaptFiltersButton(false)}else{this.setShowAdaptFiltersButton(true)}const e=this._oFilterBarLayout;const i=this.getFilterItems();const o=e.getAllFilterFields();const a=this.getSortedFilterFields(i,o);const n=e.getAllButtons();const l=e.getAllVisualFilterFields&&e.getAllVisualFilterFields();if(this._oSecondaryFilterBarLayout?.isA("sap.fe.macros.controls.filterbar.VisualFilterContainer")){this._oSecondaryFilterBarLayout.setAllFilterFields(a,l)}this._oFilterBarLayout=this._oSecondaryFilterBarLayout;o.forEach((t,i)=>{e.removeFilterField(t);this._oFilterBarLayout.insertFilterField(t,i)});n.forEach(t=>{e.removeButton(t);this._oFilterBarLayout.addButton(t)});this._oSecondaryFilterBarLayout=e;this.setAggregation("layout",this._oFilterBarLayout,true);this._oFilterBarLayout.invalidate();return}).catch(e=>{t.error(e)})};s.getSortedFilterFields=function t(e,i){const r=[];e.forEach(function(t){r.push(t.getId())});i.sort(function(t,e){let i,o;t.getContent().forEach(function(t){if(t.isA("sap.ui.mdc.FilterField")){i=t.getId()}});e.getContent().forEach(function(t){if(t.isA("sap.ui.mdc.FilterField")){o=t.getId()}});return r.indexOf(i??"")-r.indexOf(o??"")});return i};s._createInnerLayout=function t(){this._oFilterBarLayout=new i;this._cLayoutItem=n;this._oFilterBarLayout.getInner().addStyleClass("sapUiMdcFilterBarBaseAFLayout");this._addButtons();const e=this._oFilterBarLayout.getInner();const r={onBeforeRendering:()=>{if(this.initialLayout==="visual"){this._toggleLayout()}e.removeEventDelegate(r)}};e.addEventDelegate(r);this.setAggregation("layout",this._oFilterBarLayout,true)};s.exit=function t(){e.prototype.exit.call(this);if(this._oSegmentedButton){this._oSegmentedButton.detachEvent("selectionChange",this._toggleLayout);delete this._oSegmentedButton}};s.getSegmentedButton=function t(){return this._oSegmentedButton};s.enableRequests=function t(e,i){this.setSuspendSelection(!e);this._enableVisualFilterChartBindings(e,i)};s._getFilterLayoutByType=function t(e){const i=this._oFilterBarLayout.isA(e)?this._oFilterBarLayout:undefined;return!i&&this._oSecondaryFilterBarLayout?.isA(e)?this._oSecondaryFilterBarLayout:i};s._enableVisualFilterChartBindings=function t(e,i){const r=this._getFilterLayoutByType(C);if(r){r.enableChartBinding(e,i);return}const o=this._getFilterLayoutByType(A);if(o){const t=o.getAllVisualFilterFields();if(t){l.enableChartBinding(t,e,i)}}};return a}(a),g=S(h.prototype,"initialLayout",[u],{configurable:true,enumerable:true,writable:true,initializer:null}),y=S(h.prototype,"disableDraftEditStateFilter",[c],{configurable:true,enumerable:true,writable:true,initializer:null}),F=S(h.prototype,"toggleControl",[d],{configurable:true,enumerable:true,writable:true,initializer:null}),h))||f);return z},false);
//# sourceMappingURL=FilterBar.js.map