/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/fe/base/ClassSupport","sap/fe/core/buildingBlocks/BuildingBlock","sap/fe/core/buildingBlocks/templating/BuildingBlockTemplateProcessor","sap/fe/core/helpers/TypeGuards","sap/ui/core/Fragment","sap/ui/core/util/XMLPreprocessor"],function(t,e,o,n,i,s){"use strict";var r,a;var c={};var l=n.isContext;var p=o.xml;var g=o.parseXMLString;var f=t.defineUI5Class;function h(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,u(t,e)}function u(t,e){return u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},u(t,e)}let d=(r=f("sap.fe.macros.controls.BuildingBlockWithTemplating"),r(a=function(t){function e(){return t.apply(this,arguments)||this}c=e;h(e,t);var o=e.prototype;o.onMetadataAvailable=function t(){if(!this.content){this._createContent()}};o._createContent=function t(){const e=this._getOwner();if(e?.isA("sap.fe.core.TemplateComponent")){this.contentCreated=this.createContent(e)}};o.createProxyMethods=function t(e){var o=this;for(const t of e){this[t]=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++){n[i]=arguments[i]}return o.content?.[t]?.(...n)}}};o.setProperty=function e(o,n,i){if(!this._applyingSettings&&n!==undefined&&Object.keys(this.getMetadata().getProperties()).includes(o)){t.prototype.setProperty.call(this,o,n,true);this._createContent()}else{t.prototype.setProperty.call(this,o,n,i)}return this};o.setAggregation=function e(o,n,i){if(!this._applyingSettings&&Object.keys(this.getMetadata().getAggregations()).includes(o)){t.prototype.setAggregation.call(this,o,n,true);this._createContent()}else{t.prototype.setAggregation.call(this,o,n,i)}return this};o.removeAggregation=function e(o,n,i){let s;if(!this._applyingSettings&&n!==undefined&&Object.keys(this.getMetadata().getAggregations()).includes(o)){s=t.prototype.removeAggregation.call(this,o,n,i);this._createContent()}else{s=t.prototype.removeAggregation.call(this,o,n,i)}return s};o.addAggregation=function e(o,n,i){if(!this._applyingSettings&&Object.keys(this.getMetadata().getAggregations()).includes(o)){t.prototype.addAggregation.call(this,o,n,i);this._createContent()}else{t.prototype.addAggregation.call(this,o,n,i)}return this};o.insertAggregation=function e(o,n,i,s){if(!this._applyingSettings&&Object.keys(this.getMetadata().getAggregations()).includes(o)){t.prototype.insertAggregation.call(this,o,n,i,s);this._createContent()}else{t.prototype.insertAggregation.call(this,o,n,i,s)}return this};o.createContent=async function t(e){if(this.contentCreated){await this.contentCreated}const o=e.getPreprocessorContext()??{models:{},bindingContexts:{}};const n=this.getMetadata();const r=this.metadata.buildingBlockMetadata;if(r){const t=r.publicNamespace??r.namespace;const a=r.name;const c=`${n.getName()}`.replaceAll(".","/");const f=[];const h=[];const u=r.aggregations;for(const t in r.properties){let e=this[t];let o=e;if(o?.hasOwnProperty?.("path")&&o?.hasOwnProperty?.("model")){o=this.getModel(o.model)?.getObject(o.path)}if(r.properties[t].type==="function"){f.push(p`${t}="THIS._fireEvent($event, $controller, '${t}')"`)}else if(o?.isA&&o.isA("sap.fe.macros.controls.BuildingBlockObjectProperty")){const e=o.serialize(`feBB:${t}`);h.push(e)}else if(r.properties[t].type==="array"){u[t]=r.properties[t]}else if(e!==undefined&&e!==null&&(typeof e!=="object"||Object.keys(e).length>0)){if(l(e)){e=e.getPath()}else if(t==="id"){f.push(p`${t}="${e}-block"`)}else{f.push(p`${t}="${e}"`)}}}for(const t in u){const e=this[t];if(e&&(!Array.isArray(e)||e?.length>0)){const o=[];if(Array.isArray(e)){for(const t of e){if(t.isA("sap.fe.macros.controls.BuildingBlockObjectProperty"))o.push(t.serialize())}}else if(e.isA("sap.fe.macros.controls.BuildingBlockObjectProperty")){o.push(e.serialize())}const n=`<feBB:${t}>${o.join("\n")}</feBB:${t}>`;h.push(n)}}const d=await s.process(g(p`<root><feBB:${a}
			xmlns:core="sap.ui.core"
			xmlns:feBB="${t}"
			${f.length>0?f:""}
			core:require="{THIS: '${c}'}"
			>${h.length>0?h:""}</feBB:${a}></root>`,true)[0],{models:{}},o);if(d.firstElementChild){this.content?.destroy();this.content=await e.runAsOwner(async()=>i.load({definition:d.firstElementChild,controller:e.getRootController()}))}}};return e}(e))||a);c=d;return c},false);
//# sourceMappingURL=BuildingBlockWithTemplating.js.map