/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *      (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/base/Log","sap/fe/core/CommonUtils","sap/fe/core/controllerextensions/viewState/IViewStateContributorMixin","sap/fe/core/helpers/LoaderUtils"],function(t,e,n,a){"use strict";var i={};var s=a.requireDependencies;function r(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,l(t,e)}function l(t,e){return l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},l(t,e)}let o=function(n){function a(){return n.apply(this,arguments)||this}i=a;r(a,n);var l=a.prototype;l.setupMixin=function t(e){n.prototype.setupMixin.call(this,e);const a=e.prototype.init;e.prototype.init=function(){a?.call(this);this.setupStateInteractionsForLazyRendering()}};l.setupStateInteractionsForLazyRendering=function t(){};l.isBlocksAvailable=function t(){return false};l.registerSubSectionDelegate=function t(e){const n={onBeforeRendering:()=>{if(this.checkForStateInteractions()){e.removeEventDelegate(n)}}};e.addEventDelegate(n)};l.setInitialState=async function t(){};l.retrieveState=async function t(){await this._stateHandlersAvailable;if(this._retrieveHandler){const t=this.isBlocksAvailable();if(t){this._retrieveStatePending=false;const t=e.getTargetView(this);const n=t.getController().getExtensionAPI();return this._retrieveHandler.call(n,this)}else if(this._applyStatePending){this._retrieveStatePending=false;return this._stateToApply??null}else{this._retrieveStatePending=true}}return null};l.applyLegacyState=async function t(e){const n=e(this);return this.applyState(n)};l.applyState=async function t(n){await this._stateHandlersAvailable;if(this._applyHandler){const t=this.isBlocksAvailable();if(t){const t=e.getTargetView(this);const a=t.getController().getExtensionAPI();this.resetStateToApply();return this._applyHandler?.call(a,this,n)}else{this._stateToApply=n;this._applyStatePending=true}}};l.triggerStateInteractions=async function t(){await this._stateHandlersAvailable;const n=this._retrieveHandler&&this._retrieveStatePending;const a=this._applyHandler&&this._applyStatePending;if(n){if(a){this.applyState(this._stateToApply)}this._retrieveStatePending=false;const t=e.getTargetView(this);const n=t.getController().getExtensionAPI();await n.updateAppState()}else if(a){this.applyState(this._stateToApply)}};l.resetStateToApply=function t(){this._stateToApply=undefined;this._applyStatePending=false};l.checkForStateInteractions=function t(){const e=this.isBlocksAvailable();if(e){this.triggerStateInteractions();return true}return false};l.getStateHandlerInstance=async function e(n){try{if(n){const t=this.getModulePath(n);const e=await s([t]);const a=n.substring(n.lastIndexOf(".")+1);const i=e[0][a];if(i){return i}else{throw new Error("handler not found")}}}catch(e){t.warning(`'${this.getId()}' control's state handler '${n}' couldn't be resolved: ${e}`)}};l._setStateHandler=async function t(e,n){this[`_${e}Handler`]=await this.getStateHandlerInstance(n);this[`${e}StateHandler`]=n};l.setApplyStateHandler=async function t(e){this._stateHandlersAvailable=(this._stateHandlersAvailable||Promise.resolve()).then(async()=>this._setStateHandler("apply",e));return this._stateHandlersAvailable};l.setRetrieveStateHandler=async function t(e){this._stateHandlersAvailable=(this._stateHandlersAvailable||Promise.resolve()).then(async()=>this._setStateHandler("retrieve",e));return this._stateHandlersAvailable};l.getModulePath=function t(e){return e.substring(0,e.lastIndexOf(".")).replace(/\./g,"/")};return a}(n);i=o;return i},false);
//# sourceMappingURL=BaseStateHandler.js.map