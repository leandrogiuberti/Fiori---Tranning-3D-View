{"version":3,"file":"FormElement.js","names":["FormElementControl","_dec","defineUI5Class","_dec2","property","type","_dec3","_dec4","_dec5","defaultValue","_dec6","aggregation","multiple","singularName","_class","_class2","_FormElement","properties","others","_this","call","this","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_descriptor4","_descriptor5","ensureDefaultField","attachModelContextChange","onModelContextChange","bind","_exports","_inheritsLoose","_proto","prototype","fields","length","field","Field","metaPath","contextPath","id","getId","addField","evt","source","getSource","owner","Component","getOwnerComponentFor","metaModel","getMetaModel","getFullContextPath","metaPathContext","createBindingContext","oContextObjectPath","getInvolvedDataModelObjects","error","Log","targetObject","label","getLabel","annotations","Common","Label","toString","setLabel","FormElement","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sources":["./FormElement.ts"],"sourcesContent":["import type { ServiceObject } from \"@sap-ux/vocabularies-types\";\nimport Log from \"sap/base/Log\";\nimport type { EnhanceWithUI5, PropertiesOf } from \"sap/fe/base/ClassSupport\";\nimport { aggregation, defineUI5Class, property } from \"sap/fe/base/ClassSupport\";\nimport type TemplateComponent from \"sap/fe/core/TemplateComponent\";\nimport { getInvolvedDataModelObjects } from \"sap/fe/core/converters/MetaModelConverter\";\nimport type { DataModelObjectPath } from \"sap/fe/core/templating/DataModelPathHelper\";\nimport Field from \"sap/fe/macros/Field\";\nimport type UI5Event from \"sap/ui/base/Event\";\nimport Component from \"sap/ui/core/Component\";\nimport type Control from \"sap/ui/core/Control\";\nimport type { $ControlSettings } from \"sap/ui/core/Control\";\nimport FormElement from \"sap/ui/layout/form/FormElement\";\nimport type Context from \"sap/ui/model/odata/v4/Context\";\n\n/**\n * Building block used to create a form element based on the metadata provided by OData V4.\n * @public\n * @since 1.90.0\n */\n@defineUI5Class(\"sap.fe.macros.form.FormElement\")\nexport default class FormElementControl extends FormElement {\n\t/**\n\t * Defines the path of the context used in the current page or block.\n\t * This setting is defined by the framework.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tpublic contextPath!: string;\n\n\t/**\n\t * Defines the relative path of the property in the metamodel, based on the current contextPath.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tpublic metaPath!: string;\n\n\t/**\n\t * Label shown for the field. If not set, the label from the annotations will be shown.\n\t * @public\n\t */\n\t@property({ type: \"string\" })\n\tlabel?: string;\n\n\t/**\n\t * If set to false, the FormElement is not rendered.\n\t * @public\n\t */\n\t@property({ type: \"boolean\", defaultValue: true })\n\tvisible!: boolean;\n\n\t/**\n\t * Optional aggregation of controls that should be displayed inside the FormElement.\n\t * If not set, a default Field building block will be rendered\n\t * @public\n\t */\n\t@aggregation({ type: \"sap.ui.core.Control\", multiple: true, singularName: \"field\" })\n\tfields?: Control[];\n\n\t/**\n\t * Constructor for the FormElementControl.\n\t * Adds a default Field if no fields are provided and attaches a handler for model context changes.\n\t * @param properties Initial settings for the new control\n\t * @param others Additional settings\n\t */\n\tconstructor(properties: string | ($ControlSettings & PropertiesOf<FormElementControl>), others?: $ControlSettings) {\n\t\tsuper(properties as string, others);\n\t\tthis.ensureDefaultField();\n\t\tthis.attachModelContextChange(this.onModelContextChange.bind(this));\n\t}\n\n\t/**\n\t * Ensures that a default Field is created and added to the aggregation if no fields are provided.\n\t * @private\n\t */\n\tensureDefaultField(): void {\n\t\tif (!this.fields || this.fields.length === 0) {\n\t\t\tconst field = new Field({\n\t\t\t\tmetaPath: this.metaPath,\n\t\t\t\tcontextPath: this.contextPath,\n\t\t\t\tid: this.getId() + \"--FormElementField\"\n\t\t\t});\n\t\t\tthis.addField(field);\n\t\t}\n\t}\n\n\t/**\n\t * Handles model context changes to update the label from OData annotations if not set explicitly.\n\t * @param evt The model context change event\n\t * @private\n\t */\n\tonModelContextChange(evt: UI5Event): void {\n\t\tconst source = evt.getSource() as unknown as FormElementControl;\n\t\tconst owner = Component.getOwnerComponentFor(source) as EnhanceWithUI5<TemplateComponent>;\n\t\tconst metaModel = owner?.getMetaModel();\n\t\tconst contextPath = source.contextPath ? source.contextPath + \"/\" : owner?.getFullContextPath();\n\t\tconst metaPathContext = metaModel?.createBindingContext(contextPath + source.metaPath) as Context;\n\t\tlet oContextObjectPath: DataModelObjectPath<ServiceObject> | undefined;\n\t\ttry {\n\t\t\toContextObjectPath = getInvolvedDataModelObjects(metaPathContext);\n\t\t} catch (error) {\n\t\t\tLog.error(`Error while getting the involved data model objects: ${error}`);\n\t\t}\n\t\tif (oContextObjectPath && !oContextObjectPath.targetObject) {\n\t\t\tLog.error(`No target object found for the given path ${source.metaPath} on the FormElement`);\n\t\t} else {\n\t\t\tconst label = source.getLabel() || oContextObjectPath?.targetObject?.annotations.Common?.Label?.toString();\n\t\t\tif (label) {\n\t\t\t\tsource.setLabel(label);\n\t\t\t}\n\t\t}\n\t}\n}\n"],"mappings":";;;;myCAeA,IAMqBA,GAAkBC,EADtCC,EAAe,kCAAiCC,EAO/CC,EAAS,CAAEC,KAAM,WAAWC,EAO5BF,EAAS,CAAEC,KAAM,WAAWE,EAO5BH,EAAS,CAAEC,KAAM,WAAWG,EAO5BJ,EAAS,CAAEC,KAAM,UAAWI,aAAc,OAAOC,EAQjDC,EAAY,CAAEN,KAAM,sBAAuBO,SAAU,KAAMC,aAAc,UAAUZ,EAAAa,GAAAC,EAAA,SAAAC,GASpF,SAAAhB,EAAYiB,EAA4EC,GAA2B,IAAAC,EAClHA,EAAAH,EAAAI,KAAAC,KAAMJ,EAAsBC,IAAOG,KA5CpCC,EAAAH,EAAA,cAAAI,EAAAJ,GAQAG,EAAAH,EAAA,WAAAK,EAAAL,GAOAG,EAAAH,EAAA,QAAAM,EAAAN,GAOAG,EAAAH,EAAA,UAAAO,EAAAP,GAOAG,EAAAH,EAAA,SAAAQ,EAAAR,GAgBCA,EAAKS,qBACLT,EAAKU,yBAAyBV,EAAKW,qBAAqBC,KAAIZ,IAAQ,OAAAA,CACrE,CAEAa,EAAAhC,EAAAiC,EAAAjC,EAAAgB,GAAA,IAAAkB,EAAAlC,EAAAmC,UAAAD,EAIAN,mBAAA,SAAAA,IACC,IAAKP,KAAKe,QAAUf,KAAKe,OAAOC,SAAW,EAAG,CAC7C,MAAMC,EAAQ,IAAIC,EAAM,CACvBC,SAAUnB,KAAKmB,SACfC,YAAapB,KAAKoB,YAClBC,GAAIrB,KAAKsB,QAAU,uBAEpBtB,KAAKuB,SAASN,EACf,CACD,EAEAJ,EAKAJ,qBAAA,SAAAA,EAAqBe,GACpB,MAAMC,EAASD,EAAIE,YACnB,MAAMC,EAAQC,EAAUC,qBAAqBJ,GAC7C,MAAMK,EAAYH,GAAOI,eACzB,MAAMX,EAAcK,EAAOL,YAAcK,EAAOL,YAAc,IAAMO,GAAOK,qBAC3E,MAAMC,EAAkBH,GAAWI,qBAAqBd,EAAcK,EAAON,UAC7E,IAAIgB,EACJ,IACCA,EAAqBC,EAA4BH,EAClD,CAAE,MAAOI,GACRC,EAAID,MAAM,wDAAwDA,IACnE,CACA,GAAIF,IAAuBA,EAAmBI,aAAc,CAC3DD,EAAID,MAAM,6CAA6CZ,EAAON,8BAC/D,KAAO,CACN,MAAMqB,EAAQf,EAAOgB,YAAcN,GAAoBI,cAAcG,YAAYC,QAAQC,OAAOC,WAChG,GAAIL,EAAO,CACVf,EAAOqB,SAASN,EACjB,CACD,CACD,EAAC,OAAA7D,CAAA,CAvDmF,CAnCrCoE,GAAW7C,EAAA8C,EAAAtD,EAAAoB,UAAA,eAAAhC,GAAA,CAAAmE,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAAjD,EAAA6C,EAAAtD,EAAAoB,UAAA,YAAA7B,GAAA,CAAAgE,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAAhD,EAAA4C,EAAAtD,EAAAoB,UAAA,SAAA5B,GAAA,CAAA+D,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAA/C,EAAA2C,EAAAtD,EAAAoB,UAAA,WAAA3B,GAAA,CAAA8D,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAA9C,EAAA0C,EAAAtD,EAAAoB,UAAA,UAAAzB,GAAA,CAAA4D,aAAA,KAAAC,WAAA,KAAAC,SAAA,KAAAC,YAAA,OAAA1D,KAAAD,GAAAkB,EAAAhC,EAAA,OAAAgC,CAAA","ignoreList":[]}