{"version":3,"file":"CalendarFactory.js","names":["CalenderFactory","_BaseFactory","EFB","token","_this","call","this","setControl","Calendar","_inheritsLoose","_proto","prototype","invokeOkButtonHandler","calendar","getControl","popover","getToken","getCustomDataValue","key","keySpecificSelectedValues","formattedDate","DateFormat","getDateInstance","format","getSelectedDates","getStartDate","operator","length","FilterOperator","EQ","newSpecificValue","selectedValues","EasyFilterUtils","areItemsSame","getEasyFilter","updateTokenArray","close","invokeShowAllButtonHandler","async","getKey","valueHelpPromise","Promise","resolve","reject","fireEvent","getItems","newSelectedValues","error","Error","Log","message","String","BaseFactory"],"sources":["./CalendarFactory.ts"],"sourcesContent":["import Log from \"sap/base/Log\";\nimport type { EnhanceWithUI5 } from \"sap/fe/base/ClassSupport\";\nimport { BaseFactory } from \"sap/fe/controls/easyFilter/innerControls/BaseFactory\";\nimport type Popover from \"sap/m/Popover\";\nimport type UI5Date from \"sap/ui/core/date/UI5Date\";\nimport DateFormat from \"sap/ui/core/format/DateFormat\";\nimport FilterOperator from \"sap/ui/model/FilterOperator\";\nimport Calendar from \"sap/ui/unified/Calendar\";\nimport type EasyFilterBarContainer from \"../EasyFilterBarContainer\";\nimport type { TokenDefinition, TokenSelectedValuesDefinition } from \"../EasyFilterBarContainer\";\nimport type EasyFilterToken from \"../Token\";\nimport EasyFilterUtils from \"../utils\";\n\nclass CalenderFactory extends BaseFactory<Calendar> {\n\tconstructor(EFB: EnhanceWithUI5<EasyFilterBarContainer>, token: EnhanceWithUI5<EasyFilterToken>) {\n\t\tsuper(EFB, token);\n\t\tthis.setControl(new Calendar({}));\n\t}\n\n\tinvokeOkButtonHandler(): void {\n\t\tconst calendar = this.getControl();\n\t\tconst popover = this.getToken()?.getCustomDataValue(\"popover\") as Popover;\n\t\tconst { key, keySpecificSelectedValues } = this.getToken()?.getCustomDataValue(\"TokenInfo\") as TokenDefinition;\n\t\tconst formattedDate = DateFormat.getDateInstance().format(calendar?.getSelectedDates()[0].getStartDate() as UI5Date | Date);\n\t\tconst operator = keySpecificSelectedValues.length === 0 ? FilterOperator.EQ : keySpecificSelectedValues[0].operator;\n\t\tconst newSpecificValue: TokenDefinition[\"keySpecificSelectedValues\"] = [\n\t\t\t{\n\t\t\t\toperator: operator as Exclude<\n\t\t\t\t\tFilterOperator,\n\t\t\t\t\tFilterOperator.BT | FilterOperator.NB | FilterOperator.All | FilterOperator.Any\n\t\t\t\t>,\n\t\t\t\tselectedValues: [formattedDate] as string[] | number[] | boolean[]\n\t\t\t}\n\t\t];\n\t\tif (EasyFilterUtils.areItemsSame(keySpecificSelectedValues, newSpecificValue)) {\n\t\t\treturn;\n\t\t}\n\t\tthis.getEasyFilter()?.updateTokenArray(\"setSelectedValues\", newSpecificValue, key);\n\t\tpopover?.close();\n\t}\n\n\tasync invokeShowAllButtonHandler(): Promise<void> {\n\t\tconst token = this.getToken();\n\t\tconst key = token?.getKey() as string;\n\t\tconst valueHelpPromise = new Promise<TokenSelectedValuesDefinition[]>((resolve, reject) => {\n\t\t\tthis.getEasyFilter()?.fireEvent(\"showValueHelp\", {\n\t\t\t\tkey,\n\t\t\t\tselectedValues: token?.getItems(),\n\t\t\t\tresolve,\n\t\t\t\treject\n\t\t\t});\n\t\t});\n\n\t\ttry {\n\t\t\tconst newSelectedValues = await valueHelpPromise;\n\t\t\tthis.getEasyFilter()?.updateTokenArray(\"setSelectedValues\", newSelectedValues, key);\n\t\t} catch (error) {\n\t\t\tif (error instanceof Error) {\n\t\t\t\tLog.error(\"Error while fetching new tokens\", error.message);\n\t\t\t} else {\n\t\t\t\tLog.error(\"Error while fetching new tokens\", String(error));\n\t\t\t}\n\t\t}\n\t}\n}\n\nexport default CalenderFactory;\n"],"mappings":";;;;qcAaMA,EAAe,SAAAC,GACpB,SAAAD,EAAYE,EAA6CC,GAAwC,IAAAC,EAChGA,EAAAH,EAAAI,KAAAC,KAAMJ,EAAKC,IAAMG,KACjBF,EAAKG,WAAW,IAAIC,EAAS,CAAC,IAAI,OAAAJ,CACnC,CAACK,EAAAT,EAAAC,GAAA,IAAAS,EAAAV,EAAAW,UAAAD,EAEDE,sBAAA,SAAAA,IACC,MAAMC,EAAWP,KAAKQ,aACtB,MAAMC,EAAUT,KAAKU,YAAYC,mBAAmB,WACpD,MAAMC,IAAEA,EAAGC,0BAAEA,GAA8Bb,KAAKU,YAAYC,mBAAmB,aAC/E,MAAMG,EAAgBC,EAAWC,kBAAkBC,OAAOV,GAAUW,mBAAmB,GAAGC,gBAC1F,MAAMC,EAAWP,EAA0BQ,SAAW,EAAIC,EAAeC,GAAKV,EAA0B,GAAGO,SAC3G,MAAMI,EAAiE,CACtE,CACCJ,SAAUA,EAIVK,eAAgB,CAACX,KAGnB,GAAIY,EAAgBC,aAAad,EAA2BW,GAAmB,CAC9E,MACD,CACAxB,KAAK4B,iBAAiBC,iBAAiB,oBAAqBL,EAAkBZ,GAC9EH,GAASqB,OACV,EAAC1B,EAEK2B,2BAANC,eAAMD,IACL,MAAMlC,EAAQG,KAAKU,WACnB,MAAME,EAAMf,GAAOoC,SACnB,MAAMC,EAAmB,IAAIC,QAAyC,CAACC,EAASC,KAC/ErC,KAAK4B,iBAAiBU,UAAU,gBAAiB,CAChD1B,MACAa,eAAgB5B,GAAO0C,WACvBH,UACAC,aAIF,IACC,MAAMG,QAA0BN,EAChClC,KAAK4B,iBAAiBC,iBAAiB,oBAAqBW,EAAmB5B,EAChF,CAAE,MAAO6B,GACR,GAAIA,aAAiBC,MAAO,CAC3BC,EAAIF,MAAM,kCAAmCA,EAAMG,QACpD,KAAO,CACND,EAAIF,MAAM,kCAAmCI,OAAOJ,GACrD,CACD,CACD,EAAC,OAAA/C,CAAA,CAlDmB,CAASoD,GAAW,OAqD1BpD,CAAe","ignoreList":[]}