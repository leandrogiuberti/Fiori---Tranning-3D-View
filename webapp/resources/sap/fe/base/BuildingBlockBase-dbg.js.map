{"version":3,"names":["BuildingBlockBase","_dec","defineUI5Class","_dec2","aggregation","type","multiple","isDefault","_dec3","association","singularName","_dec4","defineState","_class","_class2","_Control","settings","others","scope","_this","id","call","_initializerDefineProperty","_descriptor","_descriptor2","_descriptor3","_oldDomRef","_inheritsLoose","render","oRm","oControl","content","getVisible","InvisibleRenderer","renderControl","_proto","prototype","bindProperty","name","bindingInfo","propertyMetadata","getMetadata","getProperty","bindable","group","onAfterRendering","event","domRef","getDomRef","WeakRef","suffix","oContent","deref","document","getElementById","getFocusDomRef","enhanceAccessibilityState","_oElement","mAriaProps","oParent","getParent","getAccessibilityInfo","accessibilityInfo","isA","getIdForLabel","addStyleClass","styleClass","removeStyleClass","bindState","path","BindingToolkit","state","Control","_applyDecoratedDescriptor","configurable","enumerable","writable","initializer"],"sourceRoot":".","sources":["BuildingBlockBase.ts"],"sourcesContent":["import type { ConstantExpression, PathInModelExpression, PrimitiveType } from \"sap/fe/base/BindingToolkit\";\nimport * as BindingToolkit from \"sap/fe/base/BindingToolkit\";\nimport type { PropertiesOf, StateOf } from \"sap/fe/base/ClassSupport\";\nimport { aggregation, association, defineState, defineUI5Class } from \"sap/fe/base/ClassSupport\";\nimport type ManagedObject from \"sap/ui/base/ManagedObject\";\nimport type { PropertyBindingInfo } from \"sap/ui/base/ManagedObject\";\nimport Control from \"sap/ui/core/Control\";\nimport type UI5Element from \"sap/ui/core/Element\";\nimport InvisibleRenderer from \"sap/ui/core/InvisibleRenderer\";\nimport type RenderManager from \"sap/ui/core/RenderManager\";\nimport type { AccessibilityInfo } from \"sap/ui/core/library\";\n\ninterface BuildingBlockBase<T extends UI5Element = Control, K extends object = {}> {\n\t// Force a state update\n\t_updateState(): Promise<void>;\n}\n\n/**\n * Base class for building blocks.\n * This contains the low level functionality of having a content aggregation and handling the rendering of the content without an actual DOM element.\n * The building block also defines a state object that can be used to store the state of the building block.\n * Accessibility and classes information are forwarded to the content control.\n * @public\n */\n@defineUI5Class(\"sap.fe.base.BuildingBlockBase\")\nclass BuildingBlockBase<T extends UI5Element = Control, K extends object = {}> extends Control {\n\t@aggregation({ type: \"sap.ui.core.Element\", multiple: false, isDefault: true })\n\tcontent?: T;\n\n\t/**\n\t * Association to controls / IDs that label this control (see WAI-ARIA attribute aria-labelledby).\n\t */\n\t@association({ type: \"sap.ui.core.Control\", multiple: true, singularName: \"ariaLabelledBy\" })\n\tariaLabelledBy!: string[];\n\n\t@defineState()\n\tprotected state!: StateOf<K>;\n\n\tconstructor(settings?: string | PropertiesOf<BuildingBlockBase<T>>, others?: PropertiesOf<BuildingBlockBase<T>>, scope?: object) {\n\t\tif (typeof settings === \"string\") {\n\t\t\tothers ??= {};\n\t\t\tothers.id = settings;\n\t\t}\n\t\t// Scope is defined and is there, but somehow doesn't appear on all the children of ManagedObject\n\t\t// eslint-disable-next-line @typescript-eslint/ban-ts-comment\n\t\t// @ts-ignore\n\t\tsuper(settings as unknown as string, others, scope);\n\t}\n\n\tprivate _oldDomRef: WeakRef<Element> | null = null;\n\n\tstatic render<T extends Control>(oRm: RenderManager, oControl: BuildingBlockBase<T>): void {\n\t\tif (!oControl.content || oControl.getVisible() === false) {\n\t\t\tInvisibleRenderer.render(oRm, oControl);\n\t\t} else {\n\t\t\toRm.renderControl(oControl.content);\n\t\t}\n\t}\n\n\t/**\n\t * Override the bindProperty to deal with the case where the property is a binding info.\n\t * @param name The name of te property\n\t * @param bindingInfo The binding info\n\t * @returns The instance of the building block for chaining\n\t */\n\toverride bindProperty(name: string, bindingInfo: PropertyBindingInfo): this {\n\t\tconst propertyMetadata = this.getMetadata().getProperty(name);\n\t\tif (propertyMetadata?.bindable === false && propertyMetadata.group === \"Data\") {\n\t\t\t(this as Record<string, unknown>)[name] = bindingInfo;\n\t\t} else {\n\t\t\tsuper.bindProperty(name, bindingInfo);\n\t\t}\n\t\treturn this;\n\t}\n\n\t//set the old dom ref\n\toverride onAfterRendering(event: JQuery.Event): void {\n\t\tconst domRef = this.getDomRef();\n\t\tif (domRef) {\n\t\t\tthis._oldDomRef = new WeakRef(domRef);\n\t\t} else {\n\t\t\tthis._oldDomRef = null;\n\t\t}\n\t\tsuper.onAfterRendering(event);\n\t}\n\n\toverride getDomRef(suffix?: string): Element | null {\n\t\tconst oContent = this.content;\n\t\tlet domRef: Element | null = oContent?.getDomRef(suffix) ?? super.getDomRef(suffix);\n\t\tif (!domRef && !suffix) {\n\t\t\tdomRef = this._oldDomRef?.deref() ?? null;\n\t\t\tif (domRef) {\n\t\t\t\treturn document.getElementById(domRef.id);\n\t\t\t}\n\t\t}\n\t\treturn domRef;\n\t}\n\n\toverride getFocusDomRef(): Element | null {\n\t\tconst oContent = this.content;\n\t\treturn oContent ? oContent.getFocusDomRef() : super.getFocusDomRef();\n\t}\n\n\t/**\n\t * This function asks up the control tree to enhance the accessibility state of the control.\n\t * @param _oElement The element to enhance\n\t * @param mAriaProps The current aria properties\n\t * @returns The enhanced aria properties\n\t */\n\toverride enhanceAccessibilityState(_oElement: object, mAriaProps: object): object {\n\t\tconst oParent = this.getParent();\n\n\t\tif (oParent && (oParent as ManagedObject & { enhanceAccessibilityState?: Function }).enhanceAccessibilityState) {\n\t\t\t// forward  enhanceAccessibilityState call to the parent\n\t\t\t(oParent as ManagedObject & { enhanceAccessibilityState: Function }).enhanceAccessibilityState(_oElement, mAriaProps);\n\t\t}\n\n\t\treturn mAriaProps;\n\t}\n\n\t/**\n\t * This function (if available on the concrete control) provides the current accessibility state of the control.\n\t * @returns The accessibility information for the control.\n\t */\n\toverride getAccessibilityInfo(): AccessibilityInfo {\n\t\tlet accessibilityInfo = {};\n\t\tif (this.content?.isA<Control>(\"sap.ui.core.Control\") && this.content.getAccessibilityInfo) {\n\t\t\taccessibilityInfo = this.content.getAccessibilityInfo();\n\t\t}\n\t\treturn accessibilityInfo;\n\t}\n\n\t/**\n\t * Returns the DOMNode ID to be used for the \"labelFor\" attribute.\n\t *\n\t * We forward the call of this method to the content control.\n\t * @returns ID to be used for the <code>labelFor</code>\n\t */\n\toverride getIdForLabel(): string {\n\t\tif (this.content?.isA<Control>(\"sap.ui.core.Control\")) {\n\t\t\treturn this.content.getIdForLabel();\n\t\t}\n\t\treturn \"\";\n\t}\n\n\toverride addStyleClass(styleClass: string): this {\n\t\t(this.content as unknown as Control)?.addStyleClass(styleClass);\n\t\tsuper.addStyleClass(styleClass);\n\t\treturn this;\n\t}\n\n\toverride removeStyleClass(styleClass: string): this {\n\t\t(this.content as unknown as Control)?.removeStyleClass(styleClass);\n\t\tsuper.removeStyleClass(styleClass);\n\t\treturn this;\n\t}\n\n\t/**\n\t * Shorthand for the BindingToolkit.bindState function with the current state object.\n\t * @param path A property in the state object\n\t * @returns The binding toolkit expression for the state\n\t */\n\tprotected bindState<ST extends PrimitiveType>(path: keyof K): PathInModelExpression<ST> | ConstantExpression<ST> {\n\t\treturn BindingToolkit.bindState(this.state as K, path);\n\t}\n}\n\nexport default BuildingBlockBase;\n"],"mappings":"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","ignoreList":[],"file":"BuildingBlockBase-dbg.js"}