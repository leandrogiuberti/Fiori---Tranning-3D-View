/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["./BaseAPI","sap/fe/test/Utils","sap/fe/test/builder/FEBuilder","sap/fe/test/builder/MdcTableBuilder","sap/ui/test/OpaBuilder","sap/ui/test/actions/Action","sap/ui/core/library","sap/ui/test/Opa5"],function(e,t,r,i,n,s,o,a){"use strict";var u=o.SortOrder;var c=function(r,n){if(!t.isOfType(r,i)){throw new Error("oTableBuilder parameter must be an TableBuilder instance")}return e.call(this,r,n)};c.prototype=Object.create(e.prototype);c.prototype.constructor=c;c.createRowMatchers=function(e,r,n,s){var o=t.parseArguments([[Object,Number],Object,[Array,Function],Array],arguments),a=[];if(t.isOfType(o[0],Object)){a.push(i.Row.Matchers.cellValues(o[0]))}else if(t.isOfType(o[0],Number)){a.push(function(e){var t=e.getParent(),r=e.sParentAggregationName;return t&&r?t.getAggregation(r).indexOf(e)===o[0]:false})}if(t.isOfType(o[1],Object)){a.push(i.Row.Matchers.states(o[1]))}if(!t.isOfType(o[3],[null,undefined])){a.push(i.Row.Matchers.hiddenCells(o[3]))}if(!t.isOfType(o[2],[null,undefined])){a=a.concat(o[2])}return a};c.prototype.createGroupRowMatchers=function(e,t){return[i.Row.Matchers.visualGroup(e,t)]};c.prototype.iOpenColumnAdaptation=function(){var e=this.getBuilder();return this.prepareResult(e.doOpenColumnAdaptation().description(t.formatMessage("Opening the column adaptation dialog for '{0}' (if not open yet)",this.getIdentifier())).execute())};c.prototype.iConfirmColumnAdaptation=function(){return this.prepareResult(i.createAdaptationDialogBuilder(this.getOpaInstance()).doPressFooterButton(n.Matchers.resourceBundle("text","sap.ui.mdc","p13nDialog.OK")).description(t.formatMessage("Confirming the column adaptation dialog for '{0}' (if currently open)",this.getIdentifier())).execute())};c.prototype.iOpenColumnSorting=function(){var e=this.getBuilder();return this.prepareResult(e.doOpenColumnSorting().description(t.formatMessage("Opening the column sorting dialog for '{0}' (if not open yet)",this.getIdentifier())).execute())};c.prototype.iConfirmColumnSorting=function(){return this.prepareResult(i.createSortingDialogBuilder(this.getOpaInstance()).doPressFooterButton(n.Matchers.resourceBundle("text","sap.ui.mdc","p13nDialog.OK")).description(t.formatMessage("Closing the column sorting dialog for '{0}' (if currently open)",this.getIdentifier())).execute())};c.prototype.iOpenFilterDialog=function(){var e=this.getBuilder();return this.prepareResult(e.doOpenColumnFiltering().description(t.formatMessage("Opening the filter dialog for '{0}' (if not open yet)",this.getIdentifier())).execute())};c.prototype.iConfirmFilterDialog=function(){return this._iConfirmFilterDialogWithQueryPanel()};c.prototype._iConfirmFilterDialogWithQueryPanel=function(){var e=this.getIdentifier(),s=i.createFilteringDialogBuilder(this.getOpaInstance()).hasChildren(n.create().hasType("sap.m.ComboBox")),o=n.create(this.getOpaInstance()).isDialogElement().hasType("sap.m.ComboBox");return this.prepareResult(r.create(this.getOpaInstance()).success(function(){if(r.controlsExist(o)){s.doPressFooterButton(n.Matchers.resourceBundle("text","sap.ui.mdc","p13nDialog.OK")).description(t.formatMessage("Closing the filter dialog for '{0}' (if currently open)",e)).execute()}}).execute())};c.prototype._iConfirmFilterDialogWithListPanel=function(){return this.prepareResult(i.createFilteringDialogBuilder(this.getOpaInstance()).doPressFooterButton(n.Matchers.resourceBundle("text","sap.ui.mdc","p13nDialog.OK")).description(t.formatMessage("Closing the filter dialog for '{0}' (if currently open)",this.getIdentifier())).execute())};c.prototype.selectColumnOnFilterDialog=function(e){var s=this.getIdentifier().id,o,a=function(e){return e.startsWith("Property::")?e.split("::")[1]:e},u=r.create(this.getOpaInstance()).hasType("sap.m.ComboBox").isDialogElement(),c=i.createFilteringDialogBuilder(this.getOpaInstance()).has(n.Matchers.children(u)).has(function(e){if(e.length!==1){throw Error(t.formatMessage("Cannot open filtering dialog of table '{0}'",s))}o=e[0];return o.getItems()}),l=function(r){var i=t.isOfType(e,String)?function(t){return t.getText()===e}:function(t){return a(t.getKey())===e.name};return r.filter(i)};return this.prepareResult(c.has(l).do(function(r){if(r.length===0){throw Error(t.formatMessage("Cannot open filter field '{0}'",e))}var i=r[0],s=i.getText();n.Actions.executor(n.Actions.enterText(s,false,false,true))(o)}).execute())};c.prototype.personalization=function(i,o,a,u,c,l,p){var f=t.parseArguments([[String,Object],Object,[Function,Array,s],String,n,Function,Function],arguments),h=r.create(this.getOpaInstance()),g,d=r.create(this.getOpaInstance()).hasType("sap.m.ColumnListItem").isDialogElement();c=f[4];l=f[5];p=f[6];i=f[0];if(t.isOfType(i,String)){d.hasSome(n.Matchers.bindingProperties(e.MDC_P13N_MODEL,{label:i}),n.Matchers.bindingProperties(e.MDC_P13N_MODEL,{name:i}))}else{d.has(n.Matchers.bindingProperties(e.MDC_P13N_MODEL,{name:i.name}))}o=f[1];var m=o&&o.visible===false;if(!m&&!t.isOfType(o,[null,undefined])){d.hasState(o)}a=f[2];if(!t.isOfType(a,[null,undefined])){c.do(a)}u=f[3];return this.prepareResult(h.success(function(){g=r.controlsExist(c);if(!g){l();c.success(p)}return c.has(n.Matchers.children(d)).has(function(e){if(m){return e.length===0}return r.Matchers.atIndex(0)(e)}).description(u).execute()}).execute())};c.prototype.sortingPersonalization=function(e,i,o,a,c,l,p){var f=t.parseArguments([[String,Object],Object,[Function,Array,s],String,n,Function,Function],arguments),h=r.create(this.getOpaInstance()),g,d=r.create(this.getOpaInstance()).hasType("sap.m.CustomListItem").isDialogElement(),m=n.Matchers.childrenMatcher(n.create().hasType("sap.m.ComboBox").hasProperties({placeholder:"Sort By"})),O;c=f[4];l=f[5];p=f[6];e=f[0];if(t.isOfType(e,String)){O=n.Matchers.childrenMatcher(n.create(this.getOpaInstance()).hasType("sap.m.ComboBox").has(function(t){return t.getSelectedItem()?t.getSelectedItem().getText()===e:false}))}else{O=n.Matchers.childrenMatcher(n.create(this.getOpaInstance()).hasType("sap.m.ComboBox").hasProperties({selectedKey:e.name}))}i=f[1];var y=i&&i.visible===false;c.has(n.Matchers.children(d)).has(function(e){var t=n.Matchers.filter(O)(e);if(t.length){return t}return n.Matchers.filter(m)(e)}).has(function(e){if(y){return e.length===0}return r.Matchers.atIndex(0)(e)});if(!y&&!t.isOfType(i,[null,undefined])){if(i.sortOrder){var M=i.sortOrder;delete i.sortOrder;c.hasChildren(n.create().hasType("sap.m.SegmentedButton").has(function(e){if(M===u.None){return!e.enabled}return e.getSelectedKey()===(M===u.Ascending?"asc":"desc")}))}}o=f[2];if(!t.isOfType(o,[null,undefined])){c.do(o)}a=f[3];return this.prepareResult(h.success(function(){g=r.controlsExist(c);if(!g){l();c.success(p)}return c.description(a).execute()}).execute())};c.prototype.columnAdaptation=function(e,t,r,n){return this.personalization(e,t,r,n,i.createAdaptationDialogBuilder(this.getOpaInstance()),this.iOpenColumnAdaptation.bind(this),this.iConfirmColumnAdaptation.bind(this))};c.prototype.columnSorting=function(e,t,r,n){return this.sortingPersonalization(e,t,r,n,i.createSortingDialogBuilder(this.getOpaInstance()),this.iOpenColumnSorting.bind(this),this.iConfirmColumnSorting.bind(this))};return c});
//# sourceMappingURL=TableAPI.js.map