/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["./TableAPI","sap/fe/test/Utils","sap/ui/test/OpaBuilder","sap/fe/test/builder/FEBuilder","sap/ui/test/matchers/Interactable","sap/fe/test/builder/VMBuilder","sap/ui/core/library","sap/ui/core/Core","sap/fe/test/builder/MdcTableBuilder","sap/fe/test/builder/MdcFilterFieldBuilder","./APIHelper","sap/ui/test/Opa5"],function(e,t,i,r,s,n,a,o,c,u,l,p){"use strict";var d=a.SortOrder;var h=function(t,i){return e.call(this,t,i)};h.prototype=Object.create(e.prototype);h.prototype.constructor=h;h.prototype.isAction=true;h.prototype.iPressCell=function(i,r){var s=this.getBuilder();return this.prepareResult(s.checkNumberOfMatches(1).doClickOnCell(e.createRowMatchers(i),r).description(t.formatMessage("Pressing cell of table '{0}' with row value = '{1}' and column {2} = '{3}' ",this.getIdentifier(),i,isNaN(r)?"header":"index",r)).execute())};h.prototype.iSelectRows=function(i,r){var s=t.parseArguments([[Object,Number],Object],arguments),n=this.getBuilder();return this.prepareResult(n.doSelect(e.createRowMatchers(s[0],s[1])).description(t.formatMessage("Selecting rows of table '{0}' with values='{1}' and state='{2}'",this.getIdentifier(),s[0],s[1])).execute())};h.prototype.iSelectAllRows=function(){var e=this.getBuilder();return this.prepareResult(e.doSelectAll().description(t.formatMessage("Selecting all rows in table '{0}'",this.getIdentifier())).execute())};h.prototype.iPressRow=function(i){var r=this.getBuilder();return this.prepareResult(r.checkNumberOfMatches(1).doNavigate(e.createRowMatchers(i)).description(t.formatMessage("Pressing row of table '{0}' with values='{1}'",this.getIdentifier(),i)).execute())};h.prototype.iExpandGroupRow=function(e,i){var r=this.getBuilder();return this.prepareResult(r.checkNumberOfMatches(1).doExpand(this.createGroupRowMatchers(e,i)).description(t.formatMessage("Expanding group row {0} - {1} of table '{2}'",e,i,this.getIdentifier())).execute())};h.prototype.iCollapseGroupRow=function(e,i){var r=this.getBuilder();return this.prepareResult(r.checkNumberOfMatches(1).doCollapse(this.createGroupRowMatchers(e,i)).description(t.formatMessage("Collapsing group row {0} - {1} of table '{2}'",e,i,this.getIdentifier())).execute())};h.prototype.iScroll=function(e){var i=this.getBuilder();return this.prepareResult(i.checkNumberOfMatches(1).doScroll(e).description(t.formatMessage("Scrolling the table '{0}' '{1}'",this.getIdentifier(),e)).execute())};h.prototype.iPressMore=function(){var e=this.getBuilder();return this.prepareResult(e.checkNumberOfMatches(1).doPressMore().description(t.formatMessage("Press more")).execute())};h.prototype.iChangeRow=function(i,r,s){var n=this.getBuilder(),a=false;if(arguments.length===1){a=true;r=i}if(!a){n.checkNumberOfMatches(1).doEditValues(e.createRowMatchers(i),r,s)}else{n.checkNumberOfMatches(1).doEditCreationRowValues(r,s)}return this.prepareResult(n.description(t.formatMessage("Changing row values of table '{0}' with old values='{1}' to new values='{2}'",this.getIdentifier(),a?"<CreationRow>":i,r)).execute())};h.prototype.iExecuteAction=function(e){var i=t.parseArguments([[Object,String]],arguments),r=this.getBuilder();return this.prepareResult(r.doExecuteAction(this.createActionMatcher(e)).description(t.formatMessage("Executing table action '{0}'",i[0])).execute())};h.prototype.iExecuteMenuAction=function(e){return this.prepareResult(l.createMenuActionExecutorBuilder(e).execute())};h.prototype.iExecuteShowHideDetails=function(e){var i=this.getBuilder();return this.prepareResult(i.doShowHideDetails(e).description(t.formatMessage("Executing the Show/Hide Details action for '{0}'{1}",this.getIdentifier(),e!==undefined?" enforcing 'Show Details' = "+e:"")).execute())};h.prototype.iExecuteDelete=function(){var e=this.getBuilder(),i="::StandardAction::Delete";return this.prepareResult(e.doExecuteAction(r.Matchers.id(new RegExp(t.formatMessage("{0}$",i)))).description(t.formatMessage("Pressing delete action of table '{0}'",this.getIdentifier())).execute())};h.prototype.iSelectQuickFilterItem=function(e){var r;if(t.isOfType(e,String)){r={text:e}}else if(t.isOfType(e,Object)){r={key:e.annotationPath}}return this.prepareResult(this.getBuilder().doSelectQuickFilter(i.Matchers.properties(r)).description(t.formatMessage("Selecting on table '{0}' quickFilter Item  with text '{1}'",this.getIdentifier(),e)).execute())};h.prototype.iExecuteCreate=function(){var e=this.getBuilder(),i="::StandardAction::Create";return this.prepareResult(e.doExecuteAction(r.Matchers.id(new RegExp(t.formatMessage("{0}$",i)))).description(t.formatMessage("Pressing create action of table '{0}'",this.getIdentifier())).execute())};h.prototype.iExecuteFullScreen=function(){var e=this.getBuilder(),i="::StandardAction::FullScreen";return this.prepareResult(e.doExecuteAction(r.Matchers.id(new RegExp(t.formatMessage("{0}$",i)))).description(t.formatMessage("Pressing fullscreen action of table '{0}'",this.getIdentifier())).execute())};h.prototype.iExecuteInlineCreate=function(){var e=this.getBuilder();return this.prepareResult(e.doOnChildren(i.create(this).hasType("sap.ui.table.CreationRow").has(r.Matchers.bound()).checkNumberOfMatches(1).doPress("applyBtn")).description(t.formatMessage("Pressing inline create action of table '{0}'",this.getIdentifier())).execute())};h.prototype.iExecuteInlineAction=function(i,r){var s=t.parseArguments([[Object,Number],[String,Number]],arguments),n=this.getBuilder();return this.prepareResult(n.checkNumberOfMatches(1).doExecuteInlineAction(e.createRowMatchers(s[0]),s[1]).description(t.formatMessage("Pressing inline action of table '{0}' for row '{1}' and action "+(t.isOfType(s[1],Number)?"with column index '{2}'":"'{2}'"),this.getIdentifier(),s[0],s[1])).execute())};h.prototype.iExecuteKeyboardShortcut=function(e,i,r){return this.prepareResult(this.getBuilder().doPressKeyboardShortcut(e,i,r).description(t.formatMessage(i&&r?"Execute keyboard shortcut '{1}' on column '{3}' of row with values '{2}' of table '{0}'":"Execute keyboard shortcut '{1}' on table '{0}'",this.getIdentifier(),e,i,r)).execute())};h.prototype.iSaveVariant=function(e){var i=t.isOfType(e,String)?function(i){return n.create(this).hasId(i.getId?i.getId()+"::VM":i[0].getId()+"::VM").doSaveAs(e).description(t.formatMessage("Saving variant for '{0}' as '{1}'",this.getIdentifier(),e)).execute()}:function(e){return n.create(this).hasId(e.getId?e.getId()+"::VM":e[0].getId()+"::VM").doSave().description(t.formatMessage("Saving current variant for '{0}'",this.getIdentifier())).execute()};return this.prepareResult(this.getBuilder().success(i.bind(this)).execute())};h.prototype.iRemoveVariant=function(e){return this.prepareResult(this.getBuilder().success(function(i){return n.create(this).hasId(i.getId()+"::VM").doRemoveVariant(e).description(t.formatMessage("Removing variant '{1}' for '{0}'",this.getIdentifier(),e)).execute()}.bind(this)).execute())};h.prototype.iSelectVariant=function(e){return this.prepareResult(this.getBuilder().success(function(i){return n.create(this).hasId(i.getId()+"::VM").doSelectVariant(e).description(t.formatMessage("Selecting variant '{1}' for '{0}'",this.getIdentifier(),e)).execute()}.bind(this)).execute())};h.prototype.iSetDefaultVariant=function(e){return this.prepareResult(this.getBuilder().success(function(i){return e?n.create(this).hasId(i.getId?i.getId()+"::VM":i[0].getId()+"::VM").doSetVariantAsDefault(e).description(t.formatMessage("Setting variant '{1}' as default for '{0}'",this.getIdentifier(),e)).execute():n.create(this).hasId(i.getId?i.getId()+"::VM":i[0].getId()+"::VM").doResetDefaultVariant().description(t.formatMessage("Setting Standard variant as default for '{0}'",this.getIdentifier())).execute()}.bind(this)).execute())};h.prototype.iAddAdaptationColumn=function(e){return this.columnAdaptation(e,{selected:false},i.Actions.press("selectMulti"),t.formatMessage("Adding column '{1}' to table '{0}'",this.getIdentifier(),e))};h.prototype.iRemoveAdaptationColumn=function(e){return this.columnAdaptation(e,{selected:true},i.Actions.press("selectMulti"),t.formatMessage("Removing column '{1}' from table '{0}'",this.getIdentifier(),e))};h.prototype.iChangeSortOrder=function(e,r){var s=this.getOpaInstance(),n=[],a=function(r){var n=i.create(s).hasType("sap.m.ComboBox"),a=i.Matchers.children(n)(r),o=t.isOfType(e,String)?function(t){return t.getText()===e}:function(t){return t.getKey()===e.name};return i.Actions.executor(function(i){var r=i.getItems().find(o);if(!r){throw Error(t.formatMessage("can not find sort item '{0}'",e))}i.setSelectedItem(r);i.fireChange({selectedItem:r})})(a)},o=function(e){var t=r===d.None?"sap-icon://decline":"sap-icon://sort-"+(r===d.Ascending?"ascending":"descending"),n=i.create(s).hasType("sap.m.Button").hasProperties({icon:t});var a=i.Matchers.children(n)(e);return i.Actions.executor(i.Actions.press())(a)};r=r||d.Ascending;switch(r){case d.Ascending:case d.Descending:n.push(a);n.push(o);break;case d.None:n.push(o);break;default:throw new Error("unhandled switch case: "+r)}return this.columnSorting(e,undefined,n,t.formatMessage("Setting sort of '{1}' from table '{0}' to '{2}'",this.getIdentifier(),e,r))};h.prototype.iSortByColumn=function(e,i,r){var s=this.getBuilder(),n=t.isOfType(e,Object)?e.name:e,a=!i?n:i,o=r?d.Descending:d.Ascending;return this.prepareResult(s.doSortByColumn(n,a,o).description(t.formatMessage("Sorting column '{1}{2}' of table '{0}'",this.getIdentifier(),e,i?"/"+i:"")).execute())};h.prototype.iGroupByColumn=function(e,i){var r=this.getBuilder(),s=t.isOfType(e,Object)?e.name:e;return this.prepareResult(r.doGroupByColumn(s,i).description(t.formatMessage("Grouping column '{1}{2}' of table '{0}'",this.getIdentifier(),e,i?"/"+i:"")).execute())};h.prototype.iAggregateByColumn=function(e,i){var r=this.getBuilder(),s=t.isOfType(e,Object)?e.name:e;return this.prepareResult(r.doAggregateByColumn(s,i).description(t.formatMessage("Aggregating column '{1}{2}' of table '{0}'",this.getIdentifier(),e,i?"/"+i:"")).execute())};h.prototype.iChangeSearchField=function(e){return this.prepareResult(this.getBuilder().doChangeSearch(e).description(t.formatMessage("Changing the search text on table '{0}' to '{1}'",this.getIdentifier(),e||"")).execute())};h.prototype.iResetSearchField=function(){return this.prepareResult(this.getBuilder().doResetSearch().description(t.formatMessage("Resetting the search field on table '{0}'",this.getIdentifier())).execute())};h.prototype.iChangeFilterField=function(e,t,i){return this._iChangeFilterFieldOnQueryPanel(e,t,i)};h.prototype._iChangeFilterFieldOnQueryPanel=function(e,s,n){var a=this,o=false,l=this.getIdentifier().id,p=function(e){return e.startsWith("Property::")?e.split("::")[1]:e},d=c.createFilteringDialogBuilder(this.getOpaInstance()).hasChildren(i.create().hasType("sap.m.ComboBox")),h=u.create(this.getOpaInstance()).isDialogElement().hasType("sap.ui.mdc.FilterField").has(function(i){if(t.isOfType(e,String)){return i.getLabel()===e}else{return p(i.getFieldPath())===e.name}}).description(t.formatMessage("Changing the filter field '{0}' of table '{1}' by adding '{2}' (was cleared first: {3})",e,l,s,n?n:false));return this.prepareResult(r.create(this.getOpaInstance()).success(function(){if(!r.controlsExist(d)){a.iOpenFilterDialog.bind(a)();o=true}return d.do(function(){if(!r.controlsExist(h)){a.selectColumnOnFilterDialog.bind(a,e)()}}).do(function(){h.doChangeValue(s,n).success(function(){if(o){a.iConfirmFilterDialog.bind(a)()}}).execute()}).execute()}).execute())};h.prototype._iChangeFilterFieldOnListPanel=function(e,s,n){var a=u.create(this.getOpaInstance()).isDialogElement().hasType("sap.ui.mdc.FilterField").hasConditional(t.isOfType(e,String),i.Matchers.properties({label:e}),i.Matchers.properties({fieldPath:e.name})).checkNumberOfMatches(1),o,c=t.formatMessage("Changing the filter field '{0}' of table '{1}' by adding '{2}' (was cleared first: {3})",e,this.getIdentifier(),s,n),l=this.iOpenFilterDialog.bind(this),p=this.iConfirmFilterDialog.bind(this);return this.prepareResult(r.create(this.getOpaInstance()).success(function(){o=r.controlsExist(a);if(!o){l();a.success(p)}return a.doChangeValue(s,n).description(c).execute()}).execute())};h.prototype.iOpenValueHelpOfFilterField=function(e){var s=this,n=this.getIdentifier().id,a=t.isOfType(e,String)?e:e.name,o,l=r.create(this.getOpaInstance()).hasType("sap.m.ComboBox").isDialogElement(),p=c.createFilteringDialogBuilder(this.getOpaInstance()).has(i.Matchers.children(l)).has(function(e){if(e.length!==1){throw Error(t.formatMessage("Cannot open filtering dialog of table '{0}'",n))}o=e[0];return o.getItems()}),d=function(e){var t=function(e){return e.getText()===a};return e.filter(t)},h=u.create(this.getOpaInstance()).isDialogElement().hasType("sap.ui.mdc.FilterField").has(function(e){return e.getId().split("::").pop()===a}),g=i.create(s.getOpaInstance()).hasId(n+"::AdaptationFilterField::"+a+"-inner-vhi").doPress().description("Opening value help for '"+e+"' from within a dialog");return this.prepareResult(r.create(this.getOpaInstance()).success(function(){if(!r.controlsExist(h)){return p.has(d).do(function(r){if(r.length===0){throw Error(t.formatMessage("Cannot open filter field '{0}'",e))}var s=r[0],n=s.getText();i.Actions.executor(i.Actions.enterText(n,false,false,true))(o)}).success(function(){return g.execute()}).execute()}else{return g.execute()}}).execute())};h.prototype.iPasteData=function(e){return this.prepareResult(this.getBuilder().doPasteData(e).description(t.formatMessage("Pasting {0} rows into table '{1}'",e.length,this.getIdentifier())).execute())};h.prototype.iClickOnMessageStripFilter=function(){return this.getBuilder().doClickOnMessageStripFilter().execute()};return h});
//# sourceMappingURL=TableActions.js.map