{"version":3,"file":"CollaborationClient.js","names":["CollaborationClient","oPageDefinition","sAppId","appId","sComponentId","componentId","viewId","actions","iEnterDraft","userID","userName","OpaBuilder","create","this","hasId","do","view","oContext","getBindingContext","CollaborationAPI","enterDraft","description","execute","iLeaveDraft","leaveDraft","iLockPropertyForEdition","sPropertyPath","lockField","iUnlockPropertyForEdition","unlockField","iUpdatePropertyValue","value","updatePropertyValue","iDiscardDraft","discardDraft","iDeleteObject","objectPath","deleteObject","assertions","iCheckDefaultUserChangedValue","check","checkReceived","userAction","Activity","Change","clientContent","iCheckDefaultUserRemovedLock","Unlock","iCheckValueIsLockedByDefaultUser","checkLockedByOther","iCheckValueIsNotLockedByDefaultUser","iCheckDefaultUserLeftDraft","Leave","iCheckDefaultUserEnteredDraft","Join","iCheckDefaultUserCreatedDocument","sDocumentPath","Create"],"sources":["./CollaborationClient.ts"],"sourcesContent":["import { Activity } from \"sap/fe/core/controllerextensions/collaboration/CollaborationCommon\";\nimport CollaborationAPI from \"sap/fe/test/api/CollaborationAPI\";\nimport type Opa5 from \"sap/ui/test/Opa5\";\nimport OpaBuilder from \"sap/ui/test/OpaBuilder\";\n\nfunction CollaborationClient(oPageDefinition: { appId: string; componentId: string }) {\n\tconst sAppId = oPageDefinition.appId,\n\t\tsComponentId = oPageDefinition.componentId,\n\t\tviewId = `${sAppId}::${sComponentId}`;\n\n\treturn {\n\t\tactions: {\n\t\t\tiEnterDraft: function (userID: string, userName: string) {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.hasId(viewId)\n\t\t\t\t\t.do(function (view: any) {\n\t\t\t\t\t\tconst oContext = view.getBindingContext();\n\t\t\t\t\t\tCollaborationAPI.enterDraft(oContext, userID, userName);\n\t\t\t\t\t})\n\t\t\t\t\t.viewId(\"\")\n\t\t\t\t\t.description(\"Remote session entering draft\")\n\t\t\t\t\t.execute();\n\t\t\t},\n\n\t\t\tiLeaveDraft: function () {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.do(function () {\n\t\t\t\t\t\tCollaborationAPI.leaveDraft();\n\t\t\t\t\t})\n\t\t\t\t\t.description(\"Remote session leaving draft\")\n\t\t\t\t\t.execute();\n\t\t\t},\n\n\t\t\tiLockPropertyForEdition: function (sPropertyPath: string) {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.do(function () {\n\t\t\t\t\t\tCollaborationAPI.lockField(sPropertyPath);\n\t\t\t\t\t})\n\t\t\t\t\t.description(`Remote session locking property ${sPropertyPath}`)\n\t\t\t\t\t.execute();\n\t\t\t},\n\n\t\t\tiUnlockPropertyForEdition: function () {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.do(function () {\n\t\t\t\t\t\tCollaborationAPI.unlockField();\n\t\t\t\t\t})\n\t\t\t\t\t.description(\"Remote session unlocking property \")\n\t\t\t\t\t.execute();\n\t\t\t},\n\n\t\t\tiUpdatePropertyValue: function (sPropertyPath: string, value: any) {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.do(function () {\n\t\t\t\t\t\tCollaborationAPI.updatePropertyValue(sPropertyPath, value);\n\t\t\t\t\t})\n\t\t\t\t\t.description(`Remote session updating property ${sPropertyPath} with ${value}`)\n\t\t\t\t\t.execute();\n\t\t\t},\n\n\t\t\tiDiscardDraft: function () {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.do(function () {\n\t\t\t\t\t\tCollaborationAPI.discardDraft();\n\t\t\t\t\t})\n\t\t\t\t\t.description(\"Remote session discarding draft\")\n\t\t\t\t\t.execute();\n\t\t\t},\n\n\t\t\tiDeleteObject: function (objectPath: string) {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.do(function () {\n\t\t\t\t\t\tCollaborationAPI.deleteObject(objectPath);\n\t\t\t\t\t})\n\t\t\t\t\t.description(`Remote session deleting object ${objectPath}`)\n\t\t\t\t\t.execute();\n\t\t\t}\n\t\t},\n\t\tassertions: {\n\t\t\tiCheckDefaultUserChangedValue: function (sPropertyPath: string) {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.check(function () {\n\t\t\t\t\t\treturn CollaborationAPI.checkReceived({\n\t\t\t\t\t\t\tuserID: \"DEFAULT_USER\",\n\t\t\t\t\t\t\tuserAction: Activity.Change,\n\t\t\t\t\t\t\tclientContent: sPropertyPath\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.description(`Remote session received change notification for${sPropertyPath} changed`)\n\t\t\t\t\t.execute();\n\t\t\t},\n\t\t\tiCheckDefaultUserRemovedLock: function (sPropertyPath: string) {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.check(function () {\n\t\t\t\t\t\t// Check that we have received an UNLOCK without a CHANGE\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t!CollaborationAPI.checkReceived(\n\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\tuserID: \"DEFAULT_USER\",\n\t\t\t\t\t\t\t\t\tuserAction: Activity.Change,\n\t\t\t\t\t\t\t\t\tclientContent: sPropertyPath\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\tfalse\n\t\t\t\t\t\t\t) &&\n\t\t\t\t\t\t\tCollaborationAPI.checkReceived({\n\t\t\t\t\t\t\t\tuserID: \"DEFAULT_USER\",\n\t\t\t\t\t\t\t\tuserAction: Activity.Unlock,\n\t\t\t\t\t\t\t\tclientContent: sPropertyPath\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t);\n\t\t\t\t\t})\n\t\t\t\t\t.description(`Remote session received unlock without change notification for${sPropertyPath}`)\n\t\t\t\t\t.execute();\n\t\t\t},\n\t\t\tiCheckValueIsLockedByDefaultUser: function (sPropertyPath: string) {\n\t\t\t\treturn OpaBuilder.create(this as unknown as Opa5)\n\t\t\t\t\t.check(function () {\n\t\t\t\t\t\treturn CollaborationAPI.checkLockedByOther(sPropertyPath);\n\t\t\t\t\t})\n\t\t\t\t\t.description(`On remote session, property ${sPropertyPath} is currently locked by another user`)\n\t\t\t\t\t.execute();\n\t\t\t},\n\t\t\tiCheckValueIsNotLockedByDefaultUser: function (sPropertyPath: string) {\n\t\t\t\treturn OpaBuilder.create(this as unknown as Opa5)\n\t\t\t\t\t.check(function () {\n\t\t\t\t\t\treturn !CollaborationAPI.checkLockedByOther(sPropertyPath);\n\t\t\t\t\t})\n\t\t\t\t\t.description(`On remote session, property ${sPropertyPath} is not locked by another user`)\n\t\t\t\t\t.execute();\n\t\t\t},\n\t\t\tiCheckDefaultUserLeftDraft: function () {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.check(function () {\n\t\t\t\t\t\treturn CollaborationAPI.checkReceived({ userID: \"DEFAULT_USER\", userAction: Activity.Leave });\n\t\t\t\t\t})\n\t\t\t\t\t.description(\"Remote session received notification on default user leaving the draft session\")\n\t\t\t\t\t.execute();\n\t\t\t},\n\n\t\t\tiCheckDefaultUserEnteredDraft: function () {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.check(function () {\n\t\t\t\t\t\treturn CollaborationAPI.checkReceived({ userID: \"DEFAULT_USER\", userAction: Activity.Join });\n\t\t\t\t\t})\n\t\t\t\t\t.description(\"Remote session received notification on default user entering the draft session\")\n\t\t\t\t\t.execute();\n\t\t\t},\n\n\t\t\tiCheckDefaultUserCreatedDocument: function (sDocumentPath?: string) {\n\t\t\t\treturn OpaBuilder.create(this as any as Opa5)\n\t\t\t\t\t.check(function () {\n\t\t\t\t\t\treturn CollaborationAPI.checkReceived({\n\t\t\t\t\t\t\tuserID: \"DEFAULT_USER\",\n\t\t\t\t\t\t\tuserAction: Activity.Create,\n\t\t\t\t\t\t\tclientContent: sDocumentPath\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t\t.description(\n\t\t\t\t\t\tsDocumentPath\n\t\t\t\t\t\t\t? `Remote session received create notification for ${sDocumentPath}`\n\t\t\t\t\t\t\t: \"Remote session received create notification\"\n\t\t\t\t\t)\n\t\t\t\t\t.execute();\n\t\t\t}\n\t\t}\n\t};\n}\n\nexport default CollaborationClient;\n"],"mappings":"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","ignoreList":[]}