/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/base/Object","sap/ui/test/Opa5","./Utils","./BaseArrangements","./BaseActions","./BaseAssertions","./Shell","sap/ui/test/opaQunit","sap/base/Log","sap/base/util/ObjectPath"],function(e,n,t,s,i,r,a,o,u,c){"use strict";var f=Promise.resolve();var g;var p=e.extend("sap.fe.test.JourneyRunner",{constructor:function(n){e.apply(this);this._mInstanceSettings=t.mergeObjects({pages:{onTheShell:new a}},n)},run:function(e,n){var s=1;if(!t.isOfType(e,Object)){s=0;e=t.mergeObjects(this._mInstanceSettings)}else{e=t.mergeObjects(this._mInstanceSettings,e)}var i=Array.prototype.slice.call(arguments,s);if(i&&i.length&&Array.isArray(i[0])){i=i[0]}var r=e.async,a;if(r){a=Promise.resolve()}else{a=f}a=a.then(this._preRunActions.bind(this,e)).then(this._runActions.bind(this,i)).then(this._postRunActions.bind(this,e)).catch(function(e){u.error("JourneyRunner.run failed",e)});if(!r){f=a}return a},getBaseActions:function(){return new i},getBaseAssertions:function(){return new r},getBaseArrangements:function(e){return new s(e)},_preRunActions:function(e){n.extendConfig(this._getOpaConfig(e));n.createPageObjects(e.pages)},_runActions:function(e){var n=this,s=Promise.resolve(),i,r=new Promise(function(e){i=e});u.info("JourneyRunner started");QUnit.done(function(){u.info("JourneyRunner ended");i()});e.forEach(function(e){if(t.isOfType(e,String)){s=s.then(function(){return new Promise(function(n){sap.ui.require([e],function(e){n(e)})})})}else{s=s.then(function(){return e})}s=s.then(n._runJourney)});return s.then(function(){return r})},_runJourney:function(e){if(t.isOfType(e,Function)){e.call()}},_postRunActions:function(e){this._removePages(e.pages);n.resetConfig()},_removePages:function(e){var n=this;if(e){Object.keys(e).forEach(function(t){var s=e[t],i=n._createClassName(s.namespace||"sap.ui.test.opa.pageObject",t);c.set(i,undefined)})}},_createClassName:function(e,n){return e+"."+n},_getOpaConfig:function(e){var n=Object.assign({viewNamespace:"sap.fe.templates",autoWait:true,timeout:30,pollingInterval:50,logLevel:"ERROR",disableHistoryOverride:true,asyncPolling:true},e.opaConfig);if(!n.actions){n.actions=this.getBaseActions(e)}if(!n.assertions){n.assertions=this.getBaseAssertions(e)}if(!n.arrangements){n.arrangements=this.getBaseArrangements(e)}return n}});p.getDefaultRunner=function(){if(!g){g=new p}return g};p.setDefaultRunner=function(e){if(g){g.destroy()}g=e};p.run=function(){var e=p.getDefaultRunner();e.run.apply(e,arguments)};return p});
//# sourceMappingURL=JourneyRunner.js.map