/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/test/Opa5","sap/ui/test/OpaBuilder","sap/ui/thirdparty/jquery","./Utils","./Stubs"],function(e,t,jQuery,n,r){"use strict";var a=e.extend("sap.fe.test.BaseArrangements",{constructor:function(t){e.apply(this);var r=new URLSearchParams(window.location.search),a={"sap-ui-log-level":"ERROR","sap-ui-xx-viewCache":true};if(r.get("useBackendUrl")){a.useBackendUrl=r.get("useBackendUrl")}this._mSettings=n.mergeObjects({launchParameters:a},t)},iStartMyApp:function(a,i){var s=this._mSettings.launchUrl,c=n.mergeObjects(this._mSettings.launchParameters,i),u=Object.keys(c).reduce(function(e,t){return e+"&"+t+"="+c[t]},""),o=s+(u?"?"+u.substring(1):"")+(a?"#"+a:"");this.iStartMyAppInAFrame(o);return t.create(this).success(function(){var t=e.getWindow();r.stubAll(t)}).description(n.formatMessage("Started URL '{0}' in iFrame",o)).execute()},resetTestData:function(){function e(e){return new Promise(function(t,n){var r=indexedDB.deleteDatabase(e);r.onsuccess=t;r.onerror=n})}localStorage.clear();sessionStorage.clear();if(indexedDB){if(typeof indexedDB.databases==="function"){return indexedDB.databases().then(function(t){return Promise.all(t.map(function(t){return e(t.name)}))})}else{return e("ui5-cachemanager-db")}}else{return Promise.resolve()}},iResetTestData:function(){var e=this,r=false;return t.create(this).success(function(){e.resetTestData().finally(function(){r=true}).catch(function(e){throw e});return t.create(this).check(function(){return r}).execute()}).description(n.formatMessage("Resetting test data")).execute()},iResetMockData:function(r){var a=false;return t.create(this).success(function(){var n=r.AppId?e.getWindow()[r.AppId].Component.getMetadata().getManifest()["sap.app"]["dataSources"]["mainService"]["uri"]:r.ServiceUri,i=jQuery.post(n+"\\$metadata/reload");Promise.all([i]).finally(function(){a=true}).catch(function(e){throw e});return t.create(this).check(function(){return a}).execute()}).description(n.formatMessage("Resetting mock data")).execute()},iTearDownMyApp:function(){return t.create(this).do(function(){var t=e.getWindow();r.restoreAll(t)}).do(this.iTeardownMyAppFrame.bind(this)).description("Tearing down my app").execute()},iRestartMyApp:function(){var n=this;return t.create(this).success(function(){var t=e.getWindow().location.hash.substring(1);return n.iTearDownMyApp().and.iStartMyApp(t)}).description("Restarting the app").execute()}});a._dummy=function(){};return a});
//# sourceMappingURL=BaseArrangements.js.map