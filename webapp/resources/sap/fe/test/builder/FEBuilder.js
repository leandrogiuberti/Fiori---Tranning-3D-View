/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
        (c) Copyright 2009-2021 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/test/OpaBuilder","sap/fe/test/Utils","sap/ui/test/Opa5","sap/ui/test/matchers/Matcher","sap/ui/core/util/ShortcutHelper","sap/base/util/deepEqual","sap/ui/test/matchers/Interactable"],function(t,e,r,n,a,u,i){"use strict";var o=function(){return t.apply(this,arguments)};var s={focused:function(e){var r=t.Matchers.focused(true);return e?r:t.Matchers.not(r)},controlType:function(t){return function(e){return e&&e.isA(t)}},content:function(t){return function(r){if(!r){return false}var n=r.getMetadata().getDefaultAggregationName()||"content",a=e.getAggregation(r,n);if(!a){return false}if(!Array.isArray(a)){a=[a]}return a.some(function(e){return o.Matchers.states(t)(e)})}},p13nMode:function(t){if(!Array.isArray(t)){t=[]}t.sort();return function(e){var r=e.getP13nMode();if(!Array.isArray(r)){r=[]}r.sort();return u(t,r)}},label:function(e){return function(r){if(r.getMetadata().getProperty("label")){return t.Matchers.match(t.Matchers.properties({label:e}))(r)}return o.Matchers.label(e)(r)}}};o.create=function(t){return new o(t)};o.prototype=Object.create(t.prototype);o.prototype.constructor=o;o.prototype.getStatesMatcher=function(t){return o.Matchers.states(t)};o.prototype.hasState=function(t){if(!t){return this}if(t.visible===false){this.mustBeVisible(false);this.mustBeEnabled(false)}if(t.enabled===false){this.mustBeEnabled(false)}return this.has(this.getStatesMatcher(t))};o.prototype.doPressKeyboardShortcut=function(t){return this.do(o.Actions.keyboardShortcut(t))};o.prototype.doOnSubSectionToolBar=function(e,r){var n=o.Matchers.deepAggregation("actions",e),a=function(t){return t.getAggregation("_button")?t.getAggregation("_button").getAggregation("_textButton"):null};return this.do(function(e){var u=n(e)[0],i=u.getMetadata().getName()==="sap.m.MenuButton"?a(u)||u:u;t.Actions.executor(r||t.Actions.press())(i)})};o.prototype.doOnAggregation=function(e,r,n){if(arguments.length<3){n=r;r=undefined}var a=o.Matchers.deepAggregation(e,r);return this.do(function(e){t.Actions.executor(n)(a(e))})};o.getControls=function(e,n){var a=e.build(),u=r.getPlugin().getMatchingControls(a),i=t.Matchers.filter(a.matchers)(u);if(n){if(i.length>1){throw new Error("found ambiguous results")}return i.length?i[0]:null}return i};o.controlsExist=function(t){return!!o.getControls(t).length};o.createClosePopoverBuilder=function(e,r,n){return t.create(e).success(function(){var a=false,u=function(){a=true},i=o.createPopoverBuilder(e,r);if(n||o.controlsExist(i)){return i.do(function(t){t.attachEventOnce("afterClose",u);t.close()}).success(t.create(e).check(function(){return a})).execute()}})};o.createPopoverBuilder=function(e,r){var n=t.create(e).hasType("sap.m.Popover").isDialogElement(true).has(function(t){return t.isOpen()}).checkNumberOfMatches(1);if(r){n.has(r||[])}return n};o.createMessageToastBuilder=function(e){return t.create().check(function(){var t=r.getWindow();return t.sapFEStubs&&t.sapFEStubs.getLastToastMessage&&t.sapFEStubs.getLastToastMessage()===e}).description("Toast message '"+e+"' was displayed")};o.Matchers={FOCUSED_ELEMENT:function(){var t=r.getWindow().sap.ui.require("sap/ui/core/Core"),e=t.getCurrentFocusedControlId();if(e){return t.byId(e)}return null},state:function(r,n){if(r in s){return s[r](n)}return function(a){var u=a.getMetadata(),i=u.hasAggregation(r)&&u.getAggregation(r).multiple?e.getAggregation(a,r):null;if(!i){var s={};s[r]=n;return o.Matchers.match(t.Matchers.properties(s))(a)}if(!Array.isArray(i)){i=[i]}if(!Array.isArray(n)){if(e.isOfType(n,Number)){return i.length===n}return i.some(function(t){return o.Matchers.states(n)(t)})}return n.length===i.length&&i.every(function(t,e){return o.Matchers.states(n[e])(t)})}},states:function(r,n){if(!e.isOfType(r,Object)){return t.Matchers.TRUE}if(!e.isOfType(n,Function)){n=o.Matchers.state}return o.Matchers.match(Object.keys(r).map(function(t){return n(t,r[t])}))},match:function(e){var r=t.Matchers.match(e);return function(t){return!!r(t)}},bound:function(){return function(t){return t&&!!t.getBindingContext()}},allMatch:function(e){var r=t.Matchers.filter(e);return function(t){var e=t&&t.length||0;return e===r(t).length}},someMatch:function(e){var r=t.Matchers.filter(e);return function(t){return r(t).length>0}},id:function(t){return function(r){if(e.isOfType(t,String)){return r.getId()===t}else{return t.test(r.getId())}}},type:function(t){return function(r){if(e.isOfType(t,String)){return r.getMetadata().getName()===t}else{return t.test(r.getMetadata().getName())}}},atIndex:function(t){return function(r){if(e.isOfType(r,[null,undefined])){return null}r=[].concat(r);return r.length>t?r[t]:null}},singleElement:function(){return function(t){if(!Array.isArray(t)){t=[t]}if(t.length!==1){return false}return t[0]}},label:function(e){return t.Matchers.some(function(t){var r=t.getId&&t.getId();return r&&o.controlsExist(o.create().hasType("sap.m.Label").hasProperties({text:e,labelFor:r}))},function(t){var n=t.getAriaLabelledBy&&t.getAriaLabelledBy();if(Array.isArray(n)&&n.length>0){return n.some(function(t){var n=r.getWindow().sap.ui.require("sap/ui/core/Core").byId(t);return n&&n.getText&&n.getText()===e})}})},deepAggregation:function(r,n){var a=t.Matchers.filter(n),u=function(t){return e.getAggregation(t,this)};return function(t){var e=r.split("/"),n=e.reduce(function(t,e){return Array.prototype.concat.apply([],t.map(u.bind(e)))},[t]);return a(n)}},deepAggregationMatcher:function(t,e){var r=o.Matchers.deepAggregation(t,e);return function(t){return r(t).length>0}}};o.Actions={keyboardShortcut:function(t,r,n){var u=e.parseArguments([String,String,Boolean],arguments);t=u[0];r=u[1];n=u[2];return function(e){var u=a.parseShortcut(t);u.type="keydown";if(t.toLowerCase()===u.key){u.key=t}var i=r?e.$().find(r):e.$();if(!n){e.focus()}i.trigger(u)}}};return o});
//# sourceMappingURL=FEBuilder.js.map