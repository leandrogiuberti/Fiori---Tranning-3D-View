/*!
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define(["sap/sac/df/firefly/ff2600.visualization.abstract"],function(e){"use strict";e.XCellEngineParser=function(){};e.XCellEngineParser.prototype=new e.XObject;e.XCellEngineParser.prototype._ff_c="XCellEngineParser";e.XCellEngineParser.create=function(){let t=new e.XCellEngineParser;return t};e.XCellEngineParser.prototype.m_lookahead=null;e.XCellEngineParser.prototype.m_tokenizer=null;e.XCellEngineParser.prototype.additiveExpression=function(){let t=this.multiplicativeExpression();while(this.isLookaheadAdditionOrSubtractionOperator()){let r=this.consume(e.XTokenTypes.ADDITIVE_OPERATOR);let n=this.multiplicativeExpression();t=e.XCellEngineParserBinaryOperation.create(t,r.getValue(),n)}return t};e.XCellEngineParser.prototype.argumentList=function(){this.consume(e.XTokenTypes.OPEN_PARENTHESIS);let t=e.XList.create();t.add(this.expression());while(e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.COMMA)){this.consume(e.XTokenTypes.COMMA);t.add(this.expression())}this.consume(e.XTokenTypes.CLOSE_PARENTHESIS);return t};e.XCellEngineParser.prototype.consume=function(t){let r=this.m_lookahead;if(e.isNull(r)){throw e.XException.createIllegalStateException(e.XStringUtils.concatenate3('SyntaxError: Unexpected end of input, expected: "',t,'"'))}if(!e.XString.isEqual(r.getType(),t)){throw e.XException.createIllegalStateException(e.XStringUtils.concatenate4('SyntaxError: Unexpected token: "',r.getValue(),'", expected: "',t))}this.m_lookahead=this.m_tokenizer.getNextToken();return r};e.XCellEngineParser.prototype.doubleLiteral=function(){let t=this.consume(e.XTokenTypes.DOUBLE);return e.XCellEngineParserLiteral.create(e.XDoubleValue.create(e.XDouble.convertFromString(t.getValue())))};e.XCellEngineParser.prototype.expression=function(){let e=this.additiveExpression();return e};e.XCellEngineParser.prototype.functionCallExpression=function(){let t=this.consume(e.XTokenTypes.FUNCTION_NAME).getValue();let r=this.argumentList();return e.XCellEngineParserFunctionCall.create(t,r)};e.XCellEngineParser.prototype.identifier=function(){let t=null;let r=null;if(e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.IDENTIFIER)){r=this.consume(e.XTokenTypes.IDENTIFIER);t=e.XCellEngineParserIdentifier.create(r.getValue())}else{r=this.consume(e.XTokenTypes.RANGE_IDENTIFIER);t=e.XCellEngineParserIdentifier.create(r.getValue())}return t};e.XCellEngineParser.prototype.integerLiteral=function(){let t=this.consume(e.XTokenTypes.INTEGER);return e.XCellEngineParserLiteral.create(e.XIntegerValue.create(e.XInteger.convertFromString(t.getValue())))};e.XCellEngineParser.prototype.isLookAheadMultiplicativeOperator=function(){return e.notNull(this.m_lookahead)&&e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.MULTIPLICATIVE_OPERATOR)};e.XCellEngineParser.prototype.isLookAheadOpenParenthesis=function(){return e.notNull(this.m_lookahead)&&e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.OPEN_PARENTHESIS)};e.XCellEngineParser.prototype.isLookaheadAdditionOrSubtractionOperator=function(){return e.notNull(this.m_lookahead)&&e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.ADDITIVE_OPERATOR)};e.XCellEngineParser.prototype.multiplicativeExpression=function(){let t=this.primaryExpression();while(this.isLookAheadMultiplicativeOperator()){let r=this.consume(e.XTokenTypes.MULTIPLICATIVE_OPERATOR);let n=this.primaryExpression();t=e.XCellEngineParserBinaryOperation.create(t,r.getValue(),n)}return t};e.XCellEngineParser.prototype.parenthesisedExpression=function(){this.consume(e.XTokenTypes.OPEN_PARENTHESIS);let t=this.expression();this.consume(e.XTokenTypes.CLOSE_PARENTHESIS);return t};e.XCellEngineParser.prototype.parse=function(t){this.m_tokenizer=e.XCellEngineTokenizer.create(t);this.m_lookahead=this.m_tokenizer.getNextToken();if(e.isNull(this.m_lookahead)){return e.XCellEngineParserLiteral.create(e.XStringValue.create(""))}return this.expression()};e.XCellEngineParser.prototype.primaryExpression=function(){let t;if(this.isLookAheadOpenParenthesis()){t=this.parenthesisedExpression()}else if(e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.INTEGER)){t=this.integerLiteral()}else if(e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.IDENTIFIER)||e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.RANGE_IDENTIFIER)){t=this.identifier()}else if(e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.DOUBLE)){t=this.doubleLiteral()}else if(e.XString.isEqual(this.m_lookahead.getType(),e.XTokenTypes.FUNCTION_NAME)){t=this.functionCallExpression()}else{t=this.stringLiteral()}return t};e.XCellEngineParser.prototype.stringLiteral=function(){let t=this.consume(e.XTokenTypes.STRING);return e.XCellEngineParserLiteral.create(e.XStringValue.create(t.getValue()))};e.XCellEngineParserBinaryOperation=function(){};e.XCellEngineParserBinaryOperation.prototype=new e.XObject;e.XCellEngineParserBinaryOperation.prototype._ff_c="XCellEngineParserBinaryOperation";e.XCellEngineParserBinaryOperation.create=function(t,r,n){let o=new e.XCellEngineParserBinaryOperation;o.m_left=t;o.operator=r;o.m_right=n;return o};e.XCellEngineParserBinaryOperation.prototype.m_left=null;e.XCellEngineParserBinaryOperation.prototype.m_right=null;e.XCellEngineParserBinaryOperation.prototype.operator=null;e.XCellEngineParserBinaryOperation.prototype.accept=function(e){e.visitBinaryOperation(this)};e.XCellEngineParserBinaryOperation.prototype.getLeft=function(){return this.m_left};e.XCellEngineParserBinaryOperation.prototype.getOperator=function(){return this.operator};e.XCellEngineParserBinaryOperation.prototype.getRight=function(){return this.m_right};e.XCellEngineParserBinaryOperation.prototype.isEqualTo=function(t){let r=t;return this.m_left.isEqualTo(r.m_left)&&e.XString.isEqual(this.operator,r.operator)&&this.m_right.isEqualTo(r.m_right)};e.XCellEngineParserFunctionCall=function(){};e.XCellEngineParserFunctionCall.prototype=new e.XObject;e.XCellEngineParserFunctionCall.prototype._ff_c="XCellEngineParserFunctionCall";e.XCellEngineParserFunctionCall.create=function(t,r){let n=new e.XCellEngineParserFunctionCall;n.m_functionName=t;n.m_args=r;return n};e.XCellEngineParserFunctionCall.prototype.m_args=null;e.XCellEngineParserFunctionCall.prototype.m_functionName=null;e.XCellEngineParserFunctionCall.prototype.accept=function(e){e.visitFunctionCall(this)};e.XCellEngineParserFunctionCall.prototype.getArs=function(){return this.m_args};e.XCellEngineParserFunctionCall.prototype.getFunctionName=function(){return this.m_functionName};e.XCellEngineParserFunctionCall.prototype.isEqualTo=function(t){let r=t;let n=true;for(let t=0;t<this.m_args.size();t++){let o=this.m_args.get(t);let i=r.m_args.get(t);if(e.isNull(o)||e.isNull(i)||!o.isEqualTo(i)){n=false;break}}return e.XString.isEqual(this.m_functionName,r.m_functionName)&&n};e.XCellEngineParserIdentifier=function(){};e.XCellEngineParserIdentifier.prototype=new e.XObject;e.XCellEngineParserIdentifier.prototype._ff_c="XCellEngineParserIdentifier";e.XCellEngineParserIdentifier.create=function(t){let r=new e.XCellEngineParserIdentifier;r.m_identifier=t;return r};e.XCellEngineParserIdentifier.prototype.m_identifier=null;e.XCellEngineParserIdentifier.prototype.accept=function(e){e.visitIdentifier(this)};e.XCellEngineParserIdentifier.prototype.getIdentifier=function(){return this.m_identifier};e.XCellEngineParserIdentifier.prototype.isEqualTo=function(t){let r=t;return e.XString.isEqual(this.m_identifier,r.m_identifier)};e.XCellEngineParserLiteral=function(){};e.XCellEngineParserLiteral.prototype=new e.XObject;e.XCellEngineParserLiteral.prototype._ff_c="XCellEngineParserLiteral";e.XCellEngineParserLiteral.create=function(t){let r=new e.XCellEngineParserLiteral;r.m_value=t;return r};e.XCellEngineParserLiteral.prototype.m_value=null;e.XCellEngineParserLiteral.prototype.accept=function(e){e.visitLiteral(this)};e.XCellEngineParserLiteral.prototype.getValue=function(){return this.m_value};e.XCellEngineParserLiteral.prototype.isEqualTo=function(e){let t=e;return this.m_value.isEqualTo(t.m_value)};e.XCellEngineToken=function(){};e.XCellEngineToken.prototype=new e.XObject;e.XCellEngineToken.prototype._ff_c="XCellEngineToken";e.XCellEngineToken.create=function(t,r){let n=new e.XCellEngineToken;n.m_type=t;n.m_value=r;return n};e.XCellEngineToken.prototype.m_type=null;e.XCellEngineToken.prototype.m_value=null;e.XCellEngineToken.prototype.getType=function(){return this.m_type};e.XCellEngineToken.prototype.getValue=function(){return this.m_value};e.XCellEngineTokenizer=function(){};e.XCellEngineTokenizer.prototype=new e.XObject;e.XCellEngineTokenizer.prototype._ff_c="XCellEngineTokenizer";e.XCellEngineTokenizer.create=function(t){let r=new e.XCellEngineTokenizer;r.m_string=t;r.m_cursor=0;r.m_extractors=e.XArray.create(8);r.setupXTokenizer();return r};e.XCellEngineTokenizer.prototype.m_cursor=0;e.XCellEngineTokenizer.prototype.m_extractors=null;e.XCellEngineTokenizer.prototype.m_string=null;e.XCellEngineTokenizer.prototype.getNextToken=function(){let t=null;if(!this.hasMoreTokens()){return t}if(this.startsWithEquals()){if(this.m_cursor===0){this.m_cursor=1}t=this.runExtractors();if(e.notNull(t)){return t}throw e.XException.createIllegalStateException(e.XStringUtils.concatenate3('Unexpected token: "',e.XString.substring(this.m_string,this.m_cursor,this.m_cursor+1),'"'))}else{t=e.XCellEngineToken.create(e.XTokenTypes.STRING,e.XString.substring(this.m_string,0,e.XString.size(this.m_string)))}return t};e.XCellEngineTokenizer.prototype.hasMoreTokens=function(){return e.notNull(this.m_string)&&e.XString.size(this.m_string)>0&&this.m_cursor<e.XString.size(this.m_string)};e.XCellEngineTokenizer.prototype.runExtractors=function(){let t=null;for(let r=0;r<this.m_extractors.size();r++){let n=this.m_extractors.get(r);n.setCursorPosition(this.m_cursor);t=n.extract();this.m_cursor=n.getCursorPosition();if(e.notNull(t)){break}}return t};e.XCellEngineTokenizer.prototype.setupXTokenizer=function(){this.m_extractors.set(0,e.XWhiteSpaceExtractor.create(this.m_string));this.m_extractors.set(1,e.XCellEngineIdentifierExtractor.create(this.m_string));this.m_extractors.set(2,e.XCellFunctionCallExtractor.create(this.m_string));this.m_extractors.set(3,e.XNumericTokenExtractor.create(this.m_string));this.m_extractors.set(4,e.XAdditiveOperatorExtractor.create(this.m_string));this.m_extractors.set(5,e.XMultiplicativeOperatorExtractor.create(this.m_string));this.m_extractors.set(6,e.XParenthesisExtractor.create(this.m_string));this.m_extractors.set(7,e.XCellCommaExtractor.create(this.m_string))};e.XCellEngineTokenizer.prototype.startsWithEquals=function(){return e.XString.isEqual(e.XString.substring(this.m_string,0,1),"=")};e.XAbstractTokenExtractor=function(){};e.XAbstractTokenExtractor.prototype=new e.XObject;e.XAbstractTokenExtractor.prototype._ff_c="XAbstractTokenExtractor";e.XAbstractTokenExtractor.prototype.m_cursor=0;e.XAbstractTokenExtractor.prototype.m_string=null;e.XAbstractTokenExtractor.prototype.extract=function(){let t=e.XString.substring(this.getString(),this.getCursorPosition(),e.XString.size(this.getString()));return this.extractInternal(t)};e.XAbstractTokenExtractor.prototype.getCursorPosition=function(){return this.m_cursor};e.XAbstractTokenExtractor.prototype.getString=function(){return this.m_string};e.XAbstractTokenExtractor.prototype.increaseCursor=function(){this.m_cursor++};e.XAbstractTokenExtractor.prototype.isEOF=function(){return this.m_cursor===e.XString.size(this.m_string)};e.XAbstractTokenExtractor.prototype.setCursorPosition=function(e){this.m_cursor=e};e.XAbstractTokenExtractor.prototype.setString=function(e){this.m_string=e};e.XCellEngineCellProvider=function(){};e.XCellEngineCellProvider.prototype=new e.XObject;e.XCellEngineCellProvider.prototype._ff_c="XCellEngineCellProvider";e.XCellEngineCellProvider.create=function(t){let r=new e.XCellEngineCellProvider;r.setupCellProvider(t);return r};e.XCellEngineCellProvider.prototype.m_cells=null;e.XCellEngineCellProvider.prototype.m_spreadsheet=null;e.XCellEngineCellProvider.prototype.getCellAtAddress=function(e){return this.m_cells.get(e.getRow()).get(e.getColumn())};e.XCellEngineCellProvider.prototype.getCellRangeWithAddress=function(t,r){let n=e.XList.create();for(let o=t.getRow();o<=r.getRow();o++){let i=e.XList.create();n.add(i);for(let e=t.getColumn();e<=r.getColumn();e++){i.add(this.m_cells.get(o).get(e))}}return n};e.XCellEngineCellProvider.prototype.getCellRangeWithAddressRange=function(t){let r=e.XList.create();for(let n=t.getStartRow();n<=t.getEndRow();n++){let o=e.XList.create();r.add(o);for(let e=t.getStartColumn();e<=t.getEndColumn();e++){o.add(this.m_cells.get(n).get(e))}}return r};e.XCellEngineCellProvider.prototype.getCells=function(){return this.m_cells};e.XCellEngineCellProvider.prototype.releaseObject=function(){for(let t=0;t<this.m_cells.size();t++){for(let r=0;r<this.m_cells.get(t).size();r++){e.XObjectExt.release(this.m_cells.get(t).get(r))}e.XObjectExt.release(this.m_cells.get(t))}e.XObjectExt.release(this.m_cells)};e.XCellEngineCellProvider.prototype.setupCellProvider=function(t){this.m_spreadsheet=t;this.m_cells=e.XList.create();for(let t=0;t<100;t++){let t=e.XList.create();this.m_cells.add(t);for(let r=0;r<26;r++){let r=e.XCellEngineCell.createWithSpreadsheet(this.m_spreadsheet);t.add(r)}}};e.XSpreadsheetCellAccessor=function(){};e.XSpreadsheetCellAccessor.prototype=new e.XObject;e.XSpreadsheetCellAccessor.prototype._ff_c="XSpreadsheetCellAccessor";e.XSpreadsheetCellAccessor.create=function(t){let r=new e.XSpreadsheetCellAccessor;r.m_spreadsheet=t;return r};e.XSpreadsheetCellAccessor.prototype.m_spreadsheet=null;e.XSpreadsheetCellAccessor.prototype.getCellAtAddress=function(e){return this.m_spreadsheet.getCellAtAddress(e)};e.XSpreadsheetCellAccessor.prototype.getCellRangeWithAddress=function(e,t){return this.m_spreadsheet.getCellRangeWithAddress(e,t)};e.XSpreadsheetInterpreter=function(){};e.XSpreadsheetInterpreter.prototype=new e.XObject;e.XSpreadsheetInterpreter.prototype._ff_c="XSpreadsheetInterpreter";e.XSpreadsheetInterpreter.create=function(t){let r=new e.XSpreadsheetInterpreter;r.setupFunctions();r.m_cellProvider=t;return r};e.XSpreadsheetInterpreter.prototype.m_cellProvider=null;e.XSpreadsheetInterpreter.prototype.m_functions=null;e.XSpreadsheetInterpreter.prototype.m_root=null;e.XSpreadsheetInterpreter.prototype.compile=function(e){e.accept(this);return this.m_root};e.XSpreadsheetInterpreter.prototype.getFunction=function(t){return this.m_functions.getByKey(e.XString.toLowerCase(t))};e.XSpreadsheetInterpreter.prototype.isRange=function(t){return e.XStringUtils.containsString(t,":",true)};e.XSpreadsheetInterpreter.prototype.setupFunctions=function(){this.m_functions=e.XHashMapByString.create();this.m_functions.put("sum",e.XSumOperation.create());this.m_functions.put("average",e.XAverageOperation.create());this.m_functions.put("count",e.XCountOperation.create());this.m_functions.put("max",e.XMaxOperation.create());this.m_functions.put("min",e.XMinOperation.create())};e.XSpreadsheetInterpreter.prototype.visitBinaryOperation=function(t){t.getLeft().accept(this);let r=this.m_root;t.getRight().accept(this);let n=this.m_root;let o=e.XSpreadsheetOperationFactory.createBinaryOperation(t.getOperator());this.m_root=e.XSpreadsheetBinaryOperation.create(r,o,n)};e.XSpreadsheetInterpreter.prototype.visitFunctionCall=function(t){let r=e.XList.create();for(let e=0;e<t.getArs().size();e++){t.getArs().get(e).accept(this);r.add(this.m_root)}let n=t.getFunctionName();let o=this.getFunction(n);if(e.isNull(o)){throw e.XException.createIllegalStateException(e.XStringUtils.concatenate3('SyntaxError: Function with name: "',n,'", expected does not exist'))}this.m_root=e.XSpreadsheetFunctionCall.create(o,r)};e.XSpreadsheetInterpreter.prototype.visitIdentifier=function(t){let r=t.getIdentifier();if(this.isRange(r)){let t=e.XCellAddressRange.createWithString(r);this.m_root=e.XSpreadsheetRangeIdentifier.create(this.m_cellProvider.getCellRangeWithAddress(t.getStartingAddress(),t.getEndingAddress()))}else{this.m_root=e.XSpreadsheetIdentifier.create(this.m_cellProvider.getCellAtAddress(e.XCellAddress.create(r)))}};e.XSpreadsheetInterpreter.prototype.visitLiteral=function(t){this.m_root=e.XSpreadsheetLiteral.create(t.getValue())};e.XSpreadsheetBinaryOperation=function(){};e.XSpreadsheetBinaryOperation.prototype=new e.XObject;e.XSpreadsheetBinaryOperation.prototype._ff_c="XSpreadsheetBinaryOperation";e.XSpreadsheetBinaryOperation.create=function(t,r,n){let o=new e.XSpreadsheetBinaryOperation;o.left=t;o.operator=r;o.right=n;return o};e.XSpreadsheetBinaryOperation.prototype.left=null;e.XSpreadsheetBinaryOperation.prototype.operator=null;e.XSpreadsheetBinaryOperation.prototype.right=null;e.XSpreadsheetBinaryOperation.prototype.evaluate=function(){let t;try{t=this.operator.apply(this.left.evaluate(),this.right.evaluate())}catch(r){t=e.XStringValue.create("#ERROR")}return t};e.XSpreadsheetBinaryOperation.prototype.isEqualTo=function(t){let r=t;return this.left.isEqualTo(r.left)&&this.right.isEqualTo(r.right)&&e.XString.isEqual(this.operator.getOperationType(),r.operator.getOperationType())};e.XSpreadsheetFunctionCall=function(){};e.XSpreadsheetFunctionCall.prototype=new e.XObject;e.XSpreadsheetFunctionCall.prototype._ff_c="XSpreadsheetFunctionCall";e.XSpreadsheetFunctionCall.create=function(t,r){let n=new e.XSpreadsheetFunctionCall;n.m_function=t;n.m_args=r;return n};e.XSpreadsheetFunctionCall.prototype.m_args=null;e.XSpreadsheetFunctionCall.prototype.m_function=null;e.XSpreadsheetFunctionCall.prototype.evaluate=function(){let t;try{let r=e.XList.create();for(let e=0;e<this.m_args.size();e++){r.add(this.m_args.get(e).evaluate())}t=this.m_function.apply(r)}catch(r){t=e.XStringValue.create("#ERROR")}return t};e.XSpreadsheetIdentifier=function(){};e.XSpreadsheetIdentifier.prototype=new e.XObject;e.XSpreadsheetIdentifier.prototype._ff_c="XSpreadsheetIdentifier";e.XSpreadsheetIdentifier.create=function(t){let r=new e.XSpreadsheetIdentifier;r.m_cell=t;return r};e.XSpreadsheetIdentifier.prototype.m_cell=null;e.XSpreadsheetIdentifier.prototype.evaluate=function(){let t;try{t=this.m_cell.evaluate()}catch(r){t=e.XStringValue.create("#ERROR")}return t};e.XSpreadsheetIdentifier.prototype.isEqualTo=function(e){let t=e;return this.m_cell.isEqualTo(t.m_cell)};e.XSpreadsheetLiteral=function(){};e.XSpreadsheetLiteral.prototype=new e.XObject;e.XSpreadsheetLiteral.prototype._ff_c="XSpreadsheetLiteral";e.XSpreadsheetLiteral.create=function(t){let r=new e.XSpreadsheetLiteral;r.m_value=t;return r};e.XSpreadsheetLiteral.prototype.m_value=null;e.XSpreadsheetLiteral.prototype.evaluate=function(){return this.m_value};e.XSpreadsheetLiteral.prototype.isEqualTo=function(e){let t=e;return this.m_value.isEqualTo(t.m_value)};e.XSpreadsheetOperationFactory={createBinaryOperation:function(t){let r=null;if(e.XSpreadsheetOperationFactory.isAdditionOperator(t)){r=e.XAdditionFunction.create()}else if(e.XSpreadsheetOperationFactory.isSubtractionOperator(t)){r=e.XSubtractionFunction.create()}else if(e.XSpreadsheetOperationFactory.isMultiplicationOperator(t)){r=e.XMultiplicationFunction.create()}else if(e.XSpreadsheetOperationFactory.isDivisionOperator(t)){r=e.XDivisionFunction.create()}return r},isAdditionOperator:function(t){return e.XString.isEqual(t,"+")},isDivisionOperator:function(t){return e.XString.isEqual(t,"/")},isMultiplicationOperator:function(t){return e.XString.isEqual(t,"*")},isSubtractionOperator:function(t){return e.XString.isEqual(t,"-")}};e.XSpreadsheetRangeIdentifier=function(){};e.XSpreadsheetRangeIdentifier.prototype=new e.XObject;e.XSpreadsheetRangeIdentifier.prototype._ff_c="XSpreadsheetRangeIdentifier";e.XSpreadsheetRangeIdentifier.create=function(t){let r=new e.XSpreadsheetRangeIdentifier;r.m_range=e.XRangeValue.create(t);return r};e.XSpreadsheetRangeIdentifier.prototype.m_range=null;e.XSpreadsheetRangeIdentifier.prototype.evaluate=function(){return this.m_range};e.XCellEngineBinaryOperationTypes={ADDITION:"ADDITION",DIVISION:"DIVISION",MULTIPLICATION:"MULTIPLICATION",SUBTRACTION:"SUBTRACTION"};e.XAdditionFunction=function(){};e.XAdditionFunction.prototype=new e.XObject;e.XAdditionFunction.prototype._ff_c="XAdditionFunction";e.XAdditionFunction.create=function(){let t=new e.XAdditionFunction;return t};e.XAdditionFunction.prototype.apply=function(t,r){let n=this.convertToDouble(t);let o=this.convertToDouble(r);return e.XDoubleValue.create(n.getDouble()+o.getDouble())};e.XAdditionFunction.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XAdditionFunction.prototype.getOperationType=function(){return e.XCellEngineBinaryOperationTypes.ADDITION};e.XAverageOperation=function(){};e.XAverageOperation.prototype=new e.XObject;e.XAverageOperation.prototype._ff_c="XAverageOperation";e.XAverageOperation.create=function(){return new e.XAverageOperation};e.XAverageOperation.prototype.apply=function(t){let r=e.XDoubleValue.create(0);let n=t.get(0);if(!n.getValueType().isEqualTo(e.XValueType.LIST)){r=this.convertToDouble(n)}else{let t=n;let o=0;for(let n=0;n<t.toRangeList().size();n++){let i=t.toRangeList().get(n);for(let t=0;t<i.size();t++){o=o+1;let n=this.convertToDouble(r);let l=this.convertToDouble(i.get(t).evaluate());r=e.XDoubleValue.create(n.getDouble()+l.getDouble())}}r=e.XDoubleValue.create(this.convertToDouble(r).getDouble()/o)}return r};e.XAverageOperation.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XCountOperation=function(){};e.XCountOperation.prototype=new e.XObject;e.XCountOperation.prototype._ff_c="XCountOperation";e.XCountOperation.create=function(){return new e.XCountOperation};e.XCountOperation.prototype.apply=function(t){let r=e.XDoubleValue.create(0);let n=t.get(0);if(!n.getValueType().isEqualTo(e.XValueType.LIST)){return e.XDoubleValue.create(1)}else{let t=n;for(let n=0;n<t.toRangeList().size();n++){let o=t.toRangeList().get(n);for(let t=0;t<o.size();t++){let t=this.convertToDouble(r);r=e.XDoubleValue.create(t.getDouble()+1)}}}return r};e.XCountOperation.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XDivisionFunction=function(){};e.XDivisionFunction.prototype=new e.XObject;e.XDivisionFunction.prototype._ff_c="XDivisionFunction";e.XDivisionFunction.create=function(){let t=new e.XDivisionFunction;return t};e.XDivisionFunction.prototype.apply=function(t,r){let n=this.convertToDouble(t);let o=this.convertToDouble(r);return e.XDoubleValue.create(n.getDouble()/o.getDouble())};e.XDivisionFunction.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XDivisionFunction.prototype.getOperationType=function(){return e.XCellEngineBinaryOperationTypes.DIVISION};e.XMaxOperation=function(){};e.XMaxOperation.prototype=new e.XObject;e.XMaxOperation.prototype._ff_c="XMaxOperation";e.XMaxOperation.create=function(){return new e.XMaxOperation};e.XMaxOperation.prototype.apply=function(t){let r=e.XDoubleValue.create(0);let n=t.get(0);let o=null;let i=null;if(!n.getValueType().isEqualTo(e.XValueType.LIST)){i=this.convertToDouble(n);r=e.XDoubleValue.create(i.getDouble())}else{let t=n;let l=t.toRangeList();r=this.convertToDouble(l.get(0).get(0).evaluate());for(let t=0;t<l.size();t++){let n=l.get(t);for(let t=0;t<n.size();t++){o=this.convertToDouble(r);i=this.convertToDouble(n.get(t).evaluate());if(i.getDouble()>o.getDouble()){r=e.XDoubleValue.create(i.getDouble())}}}}return r};e.XMaxOperation.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XMinOperation=function(){};e.XMinOperation.prototype=new e.XObject;e.XMinOperation.prototype._ff_c="XMinOperation";e.XMinOperation.create=function(){return new e.XMinOperation};e.XMinOperation.prototype.apply=function(t){let r=e.XDoubleValue.create(0);let n=t.get(0);let o=null;let i=null;if(!n.getValueType().isEqualTo(e.XValueType.LIST)){i=this.convertToDouble(n);r=e.XDoubleValue.create(i.getDouble())}else{let t=n;let l=t.toRangeList();r=this.convertToDouble(l.get(0).get(0).evaluate());for(let t=0;t<l.size();t++){let n=l.get(t);for(let t=0;t<n.size();t++){o=this.convertToDouble(r);i=this.convertToDouble(n.get(t).evaluate());if(i.getDouble()<o.getDouble()){r=e.XDoubleValue.create(i.getDouble())}}}}return r};e.XMinOperation.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XMultiplicationFunction=function(){};e.XMultiplicationFunction.prototype=new e.XObject;e.XMultiplicationFunction.prototype._ff_c="XMultiplicationFunction";e.XMultiplicationFunction.create=function(){let t=new e.XMultiplicationFunction;return t};e.XMultiplicationFunction.prototype.apply=function(t,r){let n=this.convertToDouble(t);let o=this.convertToDouble(r);return e.XDoubleValue.create(n.getDouble()*o.getDouble())};e.XMultiplicationFunction.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XMultiplicationFunction.prototype.getOperationType=function(){return e.XCellEngineBinaryOperationTypes.MULTIPLICATION};e.XSubtractionFunction=function(){};e.XSubtractionFunction.prototype=new e.XObject;e.XSubtractionFunction.prototype._ff_c="XSubtractionFunction";e.XSubtractionFunction.create=function(){let t=new e.XSubtractionFunction;return t};e.XSubtractionFunction.prototype.apply=function(t,r){let n=this.convertToDouble(t);let o=this.convertToDouble(r);return e.XDoubleValue.create(n.getDouble()-o.getDouble())};e.XSubtractionFunction.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XSubtractionFunction.prototype.getOperationType=function(){return e.XCellEngineBinaryOperationTypes.SUBTRACTION};e.XSumOperation=function(){};e.XSumOperation.prototype=new e.XObject;e.XSumOperation.prototype._ff_c="XSumOperation";e.XSumOperation.create=function(){return new e.XSumOperation};e.XSumOperation.prototype.apply=function(t){let r=e.XDoubleValue.create(0);let n=t.get(0);let o=null;let i=null;if(!n.getValueType().isEqualTo(e.XValueType.LIST)){o=this.convertToDouble(r);i=this.convertToDouble(n);r=e.XDoubleValue.create(o.getDouble()+i.getDouble())}else{let t=n;for(let n=0;n<t.toRangeList().size();n++){let l=t.toRangeList().get(n);for(let t=0;t<l.size();t++){o=this.convertToDouble(r);i=this.convertToDouble(l.get(t).evaluate());r=e.XDoubleValue.create(o.getDouble()+i.getDouble())}}}return r};e.XSumOperation.prototype.convertToDouble=function(t){return e.XDoubleValue.create(e.XDouble.convertFromString(t.getStringRepresentation()))};e.XCellAddressConverter=function(){};e.XCellAddressConverter.prototype=new e.XObject;e.XCellAddressConverter.prototype._ff_c="XCellAddressConverter";e.XCellAddressConverter.ASCII_CHARACTERS="ABCDEFGHIJKLMNOPQRSTUVWXYZ";e.XCellAddressConverter.create=function(){let t=new e.XCellAddressConverter;return t};e.XCellAddressConverter.prototype.convertIndicesToAddressString=function(t,r){let n=this.getColumnStringFromIndex(t);let o=e.XInteger.convertToString(r+1);return e.XStringUtils.concatenate2(n,o)};e.XCellAddressConverter.prototype.convertStringAddressToColumnIndex=function(t){let r=this.getColumnString(t);let n=e.XString.size(r);let o=0;for(let t=0;t<n;t++){let i=e.XString.getCharAt(r,t);let l=e.XDouble.convertToInt(e.XMath.pow(26,n-(t+1)));o=o+l*(i-64)}return o-1};e.XCellAddressConverter.prototype.convertStringAddressToRowIndex=function(t){e.XString.toUpperCase(t);let r=0;for(let n=0;n<e.XString.size(t);n++){let o=e.XString.getCharAt(t,n);if(!this.isLetter(o)){r=n;break}}return e.XInteger.convertFromString(e.XString.substring(t,r,e.XString.size(t)))-1};e.XCellAddressConverter.prototype.getColumnString=function(t){e.XString.toUpperCase(t);let r=0;for(let n=0;n<e.XString.size(t);n++){let o=e.XString.getCharAt(t,n);if(!this.isLetter(o)){r=n;break}}return e.XString.substring(t,0,r)};e.XCellAddressConverter.prototype.getColumnStringFromIndex=function(t){let r=t+1;let n="";while(r>0){let o=e.XMath.mod(t,26);let i=e.XString.substring(e.XCellAddressConverter.ASCII_CHARACTERS,o,o+1);n=e.XStringUtils.concatenate2(i,n);r=e.XMath.div(t,26)}return n};e.XCellAddressConverter.prototype.isLetter=function(e){return e>=65&&e<=90};e.XAdditiveOperatorExtractor=function(){};e.XAdditiveOperatorExtractor.prototype=new e.XAbstractTokenExtractor;e.XAdditiveOperatorExtractor.prototype._ff_c="XAdditiveOperatorExtractor";e.XAdditiveOperatorExtractor.create=function(t){let r=new e.XAdditiveOperatorExtractor;r.setString(t);return r};e.XAdditiveOperatorExtractor.prototype.extractInternal=function(t){let r=null;let n=e.XString.substring(t,0,1);if(e.XString.isEqual(n,"+")||e.XString.isEqual(n,"-")){this.increaseCursor();r=e.XCellEngineToken.create(e.XTokenTypes.ADDITIVE_OPERATOR,n)}return r};e.XCellCommaExtractor=function(){};e.XCellCommaExtractor.prototype=new e.XAbstractTokenExtractor;e.XCellCommaExtractor.prototype._ff_c="XCellCommaExtractor";e.XCellCommaExtractor.create=function(t){let r=new e.XCellCommaExtractor;r.setString(t);return r};e.XCellCommaExtractor.prototype.extractInternal=function(t){let r=null;let n=e.XString.substring(t,0,1);if(e.XString.isEqual(n,",")){this.increaseCursor();r=e.XCellEngineToken.create(e.XTokenTypes.COMMA,n)}return r};e.XCellEngineIdentifierExtractor=function(){};e.XCellEngineIdentifierExtractor.prototype=new e.XAbstractTokenExtractor;e.XCellEngineIdentifierExtractor.prototype._ff_c="XCellEngineIdentifierExtractor";e.XCellEngineIdentifierExtractor.create=function(t){let r=new e.XCellEngineIdentifierExtractor;r.setString(t);return r};e.XCellEngineIdentifierExtractor.prototype.extractInternal=function(t){let r=null;let n=e.XTokenTypes.IDENTIFIER;let o=0;let i=e.XString.substring(t,o,o+1);o++;if(this.isLetter(i)){while(this.isLetter(i)&&o<e.XString.size(t)){i=e.XString.substring(t,o,o+1);o++}if(!this.isNumber(i)){return null}while(this.isNumber(i)&&o<e.XString.size(t)){i=e.XString.substring(t,o,o+1);if(this.isNumber(i)){o++}}if(e.XString.isEqual(i,":")){n=e.XTokenTypes.RANGE_IDENTIFIER;o++;i=e.XString.substring(t,o,o+1);o++;while(this.isLetter(i)&&o<e.XString.size(t)){i=e.XString.substring(t,o,o+1);o++}if(!this.isNumber(i)){return null}while(this.isNumber(i)&&o<e.XString.size(t)){i=e.XString.substring(t,o,o+1);if(this.isNumber(i)){o++}}}this.setCursorPosition(this.getCursorPosition()+o);r=e.XCellEngineToken.create(n,e.XString.substring(t,0,o))}return r};e.XCellEngineIdentifierExtractor.prototype.isLetter=function(t){let r=e.XString.toUpperCase(t);let n=e.XString.getCharAt(r,0);return n>=65&&n<=90};e.XCellEngineIdentifierExtractor.prototype.isNumber=function(t){let r=e.XString.getCharAt(t,0);return r>=48&&r<=57};e.XCellFunctionCallExtractor=function(){};e.XCellFunctionCallExtractor.prototype=new e.XAbstractTokenExtractor;e.XCellFunctionCallExtractor.prototype._ff_c="XCellFunctionCallExtractor";e.XCellFunctionCallExtractor.create=function(t){let r=new e.XCellFunctionCallExtractor;r.setString(t);return r};e.XCellFunctionCallExtractor.prototype.extractInternal=function(t){let r=null;let n=false;let o=0;let i=e.XString.substring(t,o,o+1);o++;if(this.isLetter(i)){while(this.isLetter(i)&&o<e.XString.size(t)){i=e.XString.substring(t,o,o+1);if(e.XString.getCharAt(i,0)===40){n=true;break}o++}if(n){this.setCursorPosition(this.getCursorPosition()+o);r=e.XCellEngineToken.create(e.XTokenTypes.FUNCTION_NAME,e.XString.substring(t,0,o))}}return r};e.XCellFunctionCallExtractor.prototype.isLetter=function(t){let r=e.XString.toUpperCase(t);let n=e.XString.getCharAt(r,0);return n>=65&&n<=90};e.XMultiplicativeOperatorExtractor=function(){};e.XMultiplicativeOperatorExtractor.prototype=new e.XAbstractTokenExtractor;e.XMultiplicativeOperatorExtractor.prototype._ff_c="XMultiplicativeOperatorExtractor";e.XMultiplicativeOperatorExtractor.create=function(t){let r=new e.XMultiplicativeOperatorExtractor;r.setString(t);return r};e.XMultiplicativeOperatorExtractor.prototype.extractInternal=function(t){let r=null;let n=e.XString.substring(t,0,1);if(e.XString.isEqual(n,"*")||e.XString.isEqual(n,"/")){this.increaseCursor();r=e.XCellEngineToken.create(e.XTokenTypes.MULTIPLICATIVE_OPERATOR,n)}return r};e.XNumericTokenExtractor=function(){};e.XNumericTokenExtractor.prototype=new e.XAbstractTokenExtractor;e.XNumericTokenExtractor.prototype._ff_c="XNumericTokenExtractor";e.XNumericTokenExtractor.create=function(t){let r=new e.XNumericTokenExtractor;r.setString(t);r.m_isInteger=true;return r};e.XNumericTokenExtractor.prototype.m_isInteger=false;e.XNumericTokenExtractor.prototype.extractInternal=function(t){let r=null;let n=0;try{e.XInteger.convertFromString(e.XString.substring(t,n,n+1));this.increaseCursor();n++;while(!this.isEOF()){if(e.XString.isEqual(e.XString.substring(t,n,n+1),".")){this.m_isInteger=false;this.increaseCursor();n++}try{e.XInteger.convertFromString(e.XString.substring(t,n,n+1));this.increaseCursor();n++}catch(e){break}}let o=e.XString.substring(t,0,n);if(this.m_isInteger){r=e.XCellEngineToken.create(e.XTokenTypes.INTEGER,o)}else{r=e.XCellEngineToken.create(e.XTokenTypes.DOUBLE,o)}}catch(e){r=null}return r};e.XParenthesisExtractor=function(){};e.XParenthesisExtractor.prototype=new e.XAbstractTokenExtractor;e.XParenthesisExtractor.prototype._ff_c="XParenthesisExtractor";e.XParenthesisExtractor.create=function(t){let r=new e.XParenthesisExtractor;r.setString(t);return r};e.XParenthesisExtractor.prototype.extractInternal=function(t){let r=null;let n=e.XString.substring(t,0,1);if(e.XString.isEqual(n,"(")){this.increaseCursor();r=e.XCellEngineToken.create(e.XTokenTypes.OPEN_PARENTHESIS,n)}else if(e.XString.isEqual(n,")")){this.increaseCursor();r=e.XCellEngineToken.create(e.XTokenTypes.CLOSE_PARENTHESIS,n)}return r};e.XWhiteSpaceExtractor=function(){};e.XWhiteSpaceExtractor.prototype=new e.XAbstractTokenExtractor;e.XWhiteSpaceExtractor.prototype._ff_c="XWhiteSpaceExtractor";e.XWhiteSpaceExtractor.create=function(t){let r=new e.XWhiteSpaceExtractor;r.setString(t);return r};e.XWhiteSpaceExtractor.prototype.extractInternal=function(t){let r=0;let n=e.XString.substring(t,r,r+1);while(this.isWhiteSpace(n)){this.increaseCursor();r++;n=e.XString.substring(t,r,r+1)}return null};e.XWhiteSpaceExtractor.prototype.isWhiteSpace=function(t){return e.XString.isEqual(t," ")||e.XString.isEqual(t,"\t")||e.XString.isEqual(t,"\n")};e.XCellFormat=function(){};e.XCellFormat.prototype=new e.XObject;e.XCellFormat.prototype._ff_c="XCellFormat";e.XCellFormat.create=function(){let t=new e.XCellFormat;t.setupFormat();return t};e.XCellFormat.prototype.m_backgroundColor=null;e.XCellFormat.prototype.m_bold=false;e.XCellFormat.prototype.m_cellHorizontalAlignment=null;e.XCellFormat.prototype.m_fontSize=0;e.XCellFormat.prototype.m_italic=false;e.XCellFormat.prototype.m_numberFormatterSettings=null;e.XCellFormat.prototype.m_textColor=null;e.XCellFormat.prototype.addRightDigit=function(){let e=this.m_numberFormatterSettings.getMaxDigitsRight();if(e>=0){this.m_numberFormatterSettings.setMaxDigitsRight(e+1)}else{this.m_numberFormatterSettings.setMaxDigitsRight(1)}};e.XCellFormat.prototype.formatString=function(t){if(e.XStringUtils.isNumber(t)){let r=e.XDouble.convertFromString(t);return e.XNumberFormatter.formatDoubleToStringUsingSettings(r,this.m_numberFormatterSettings)}return t};e.XCellFormat.prototype.getBackgroundColor=function(){return this.m_backgroundColor};e.XCellFormat.prototype.getBold=function(){return this.m_bold};e.XCellFormat.prototype.getFontSize=function(){return this.m_fontSize};e.XCellFormat.prototype.getHorizontalAlignment=function(){return this.m_cellHorizontalAlignment};e.XCellFormat.prototype.getItalic=function(){return this.m_italic};e.XCellFormat.prototype.getTextColor=function(){return this.m_textColor};e.XCellFormat.prototype.removeRightDigit=function(){let e=this.m_numberFormatterSettings.getMaxDigitsRight();if(e>0){this.m_numberFormatterSettings.setMaxDigitsRight(e-1)}};e.XCellFormat.prototype.setBackgroundColor=function(e){this.m_backgroundColor=e};e.XCellFormat.prototype.setBold=function(e){this.m_bold=e};e.XCellFormat.prototype.setFontSize=function(e){this.m_fontSize=e};e.XCellFormat.prototype.setHorizontalAlignment=function(e){this.m_cellHorizontalAlignment=e};e.XCellFormat.prototype.setItalic=function(e){this.m_italic=e};e.XCellFormat.prototype.setTextColor=function(e){this.m_textColor=e};e.XCellFormat.prototype.setupFormat=function(){this.m_backgroundColor="#ffffff";this.m_textColor="#000000";this.m_bold=false;this.m_italic=false;this.m_fontSize=0;this.m_numberFormatterSettings=e.XNumberFormatterSettingsFactory.getInstance().create()};e.XCellAddress=function(){};e.XCellAddress.prototype=new e.XObject;e.XCellAddress.prototype._ff_c="XCellAddress";e.XCellAddress.create=function(t){let r=new e.XCellAddress;r.internalSetup();r.m_column=r.m_addressConverter.convertStringAddressToColumnIndex(t);r.m_row=r.m_addressConverter.convertStringAddressToRowIndex(t);return r};e.XCellAddress.createWithIndices=function(t,r){let n=new e.XCellAddress;n.internalSetup();n.m_column=r;n.m_row=t;return n};e.XCellAddress.prototype.m_addressConverter=null;e.XCellAddress.prototype.m_column=0;e.XCellAddress.prototype.m_row=0;e.XCellAddress.prototype.getAddressString=function(){return this.m_addressConverter.convertIndicesToAddressString(this.m_column,this.m_row)};e.XCellAddress.prototype.getColumn=function(){return this.m_column};e.XCellAddress.prototype.getRow=function(){return this.m_row};e.XCellAddress.prototype.internalSetup=function(){this.m_addressConverter=e.XCellAddressConverter.create()};e.XCellAddress.prototype.isEqualTo=function(e){let t=e;return this.m_row===t.m_row&&this.m_column===t.m_column};e.XCellAddress.prototype.releaseObject=function(){e.XObjectExt.release(this.m_addressConverter)};e.XCellAddressRange=function(){};e.XCellAddressRange.prototype=new e.XObject;e.XCellAddressRange.prototype._ff_c="XCellAddressRange";e.XCellAddressRange.createWithIndices=function(t,r,n,o){let i=new e.XCellAddressRange;i.m_rangeStart=e.XCellAddress.createWithIndices(t,n);i.m_rangeEnd=e.XCellAddress.createWithIndices(r,o);return i};e.XCellAddressRange.createWithString=function(t){let r=new e.XCellAddressRange;let n=e.XStringTokenizer.splitString(t,":");let o=n.size();r.m_rangeStart=e.XCellAddress.create(n.get(0));r.m_rangeEnd=o>1?e.XCellAddress.create(n.get(1)):e.XCellAddress.create(n.get(0));return r};e.XCellAddressRange.prototype.m_rangeEnd=null;e.XCellAddressRange.prototype.m_rangeStart=null;e.XCellAddressRange.prototype.getAddressString=function(){let t=this.m_rangeStart.getAddressString();if(this.getStartRow()!==this.getEndRow()||this.getStartColumn()!==this.getEndColumn()){t=e.XStringUtils.concatenate3(t,":",this.m_rangeEnd.getAddressString())}return t};e.XCellAddressRange.prototype.getEndColumn=function(){return this.m_rangeEnd.getColumn()};e.XCellAddressRange.prototype.getEndRow=function(){return this.m_rangeEnd.getRow()};e.XCellAddressRange.prototype.getEndingAddress=function(){return this.m_rangeEnd};e.XCellAddressRange.prototype.getStartColumn=function(){return this.m_rangeStart.getColumn()};e.XCellAddressRange.prototype.getStartRow=function(){return this.m_rangeStart.getRow()};e.XCellAddressRange.prototype.getStartingAddress=function(){return this.m_rangeStart};e.XSpreadsheet=function(){};e.XSpreadsheet.prototype=new e.XObject;e.XSpreadsheet.prototype._ff_c="XSpreadsheet";e.XSpreadsheet.create=function(){let t=new e.XSpreadsheet;t.setupSpreadsheet();return t};e.XSpreadsheet.prototype.m_baseProvider=null;e.XSpreadsheet.prototype.m_cellAccessor=null;e.XSpreadsheet.prototype.m_extraProviders=null;e.XSpreadsheet.prototype.addCellProvider=function(e,t){this.m_extraProviders.put(e,t)};e.XSpreadsheet.prototype.getCellAccessor=function(){return this.m_cellAccessor};e.XSpreadsheet.prototype.getCellAtAddress=function(e){return this.m_baseProvider.getCellAtAddress(e)};e.XSpreadsheet.prototype.getCellRangeWithAddress=function(e,t){return this.m_baseProvider.getCellRangeWithAddress(e,t)};e.XSpreadsheet.prototype.getCellRangeWithAddressRange=function(e){return this.m_baseProvider.getCellRangeWithAddressRange(e)};e.XSpreadsheet.prototype.getCells=function(){let e=this.m_baseProvider.getCells();let t=this.m_extraProviders.getKeysAsReadOnlyList().getIterator();while(t.hasNext()){let r=t.next();let n=r.getRow();let o=r.getColumn();for(let t=n;t-n<this.m_extraProviders.getByKey(r).getCells().size();t++){for(let i=o;i-o<this.m_extraProviders.getByKey(r).getCells().get(t-n).size();i++){e.get(t).get(i).setText(this.m_extraProviders.getByKey(r).getCells().get(t-n).get(i-o).getStringLiteral())}}}return e};e.XSpreadsheet.prototype.releaseObject=function(){this.m_baseProvider=e.XObjectExt.release(this.m_baseProvider);this.m_cellAccessor=e.XObjectExt.release(this.m_cellAccessor);this.m_extraProviders=e.XObjectExt.release(this.m_extraProviders)};e.XSpreadsheet.prototype.setupSpreadsheet=function(){this.m_baseProvider=e.XCellEngineCellProvider.create(this);this.m_cellAccessor=e.XSpreadsheetCellAccessor.create(this);this.m_extraProviders=e.XSimpleMap.create()};e.DfXCell=function(){};e.DfXCell.prototype=new e.XObject;e.DfXCell.prototype._ff_c="DfXCell";e.DfXCell.create=function(){let t=new e.DfXCell;t.setText("");t.setCellFormat(e.XCellFormat.create());return t};e.DfXCell.prototype.m_cellFormat=null;e.DfXCell.prototype.m_changed=false;e.DfXCell.prototype.m_stringLiteral=null;e.DfXCell.prototype.addRightDigit=function(){if(e.XStringUtils.isNumber(this.getStringRepresentation())){this.m_cellFormat.addRightDigit()}};e.DfXCell.prototype.evaluate=function(){return e.XStringValue.create(this.getStringLiteral())};e.DfXCell.prototype.getBackgroundColor=function(){return this.m_cellFormat.getBackgroundColor()};e.DfXCell.prototype.getBold=function(){return this.m_cellFormat.getBold()};e.DfXCell.prototype.getFontSize=function(){return this.m_cellFormat.getFontSize()};e.DfXCell.prototype.getFormattedString=function(){let e=this.getStringRepresentation();return this.m_cellFormat.formatString(e)};e.DfXCell.prototype.getHorizontalAlignment=function(){return this.m_cellFormat.getHorizontalAlignment()};e.DfXCell.prototype.getItalic=function(){return this.m_cellFormat.getItalic()};e.DfXCell.prototype.getStringLiteral=function(){return this.m_stringLiteral};e.DfXCell.prototype.getStringRepresentation=function(){return this.evaluate().getStringRepresentation()};e.DfXCell.prototype.getTextColor=function(){return this.m_cellFormat.getTextColor()};e.DfXCell.prototype.isChanged=function(){return this.m_changed};e.DfXCell.prototype.isEqualTo=function(e){let t=e;return t.evaluate().isEqualTo(t.evaluate())};e.DfXCell.prototype.releaseObject=function(){};e.DfXCell.prototype.removeRightDigit=function(){if(e.XStringUtils.isNumber(this.getStringRepresentation())){this.m_cellFormat.removeRightDigit()}};e.DfXCell.prototype.setBackgroundColor=function(e){this.m_cellFormat.setBackgroundColor(e)};e.DfXCell.prototype.setBold=function(e){this.m_cellFormat.setBold(e)};e.DfXCell.prototype.setCellFormat=function(e){this.m_cellFormat=e};e.DfXCell.prototype.setFontSize=function(e){this.m_cellFormat.setFontSize(e)};e.DfXCell.prototype.setHorizontalAlignment=function(e){this.m_cellFormat.setHorizontalAlignment(e)};e.DfXCell.prototype.setItalic=function(e){this.m_cellFormat.setItalic(e)};e.DfXCell.prototype.setStringLiteral=function(e){this.m_stringLiteral=e};e.DfXCell.prototype.setText=function(e){this.m_stringLiteral=e;this.m_changed=true};e.DfXCell.prototype.setTextColor=function(e){this.m_cellFormat.setTextColor(e)};e.DfXCell.prototype.updateTextFromLinkedObject=function(e){if(!this.m_changed){this.setText(e)}};e.XCellEngineCell=function(){};e.XCellEngineCell.prototype=new e.DfXCell;e.XCellEngineCell.prototype._ff_c="XCellEngineCell";e.XCellEngineCell.createWithSpreadsheet=function(t){let r=new e.XCellEngineCell;r.m_spreadsheet=t;r.setTextInternal("");r.setCellFormat(e.XCellFormat.create());return r};e.XCellEngineCell.prototype.m_formula=null;e.XCellEngineCell.prototype.m_spreadsheet=null;e.XCellEngineCell.prototype.evaluate=function(){if(e.notNull(this.m_formula)){let t=e.XSpreadsheetInterpreter.create(this.m_spreadsheet.getCellAccessor());return t.compile(this.m_formula).evaluate()}return e.XStringValue.create("")};e.XCellEngineCell.prototype.releaseObject=function(){e.XObjectExt.release(this.m_formula)};e.XCellEngineCell.prototype.setText=function(e){this.setTextInternal(e)};e.XCellEngineCell.prototype.setTextInternal=function(t){this.setStringLiteral(t);let r=e.XCellEngineParser.create();this.m_formula=r.parse(t)};e.XTokenTypes=function(){};e.XTokenTypes.prototype=new e.XConstant;e.XTokenTypes.prototype._ff_c="XTokenTypes";e.XTokenTypes.ADDITIVE_OPERATOR="ADDITIVE_OPERATOR";e.XTokenTypes.CLOSE_PARENTHESIS="CLOSE_PARENTHESIS";e.XTokenTypes.COMMA="COMMA";e.XTokenTypes.DOUBLE="DOUBLE";e.XTokenTypes.FUNCTION_NAME="FUNCTION_NAME";e.XTokenTypes.IDENTIFIER="IDENTIFIER";e.XTokenTypes.INTEGER="INTEGER";e.XTokenTypes.MULTIPLICATIVE_OPERATOR="MULTIPLICATIVE_OPERATOR";e.XTokenTypes.OPEN_PARENTHESIS="OPEN_PARENTHESIS";e.XTokenTypes.RANGE_IDENTIFIER="RANGE_IDENTIFIER";e.XTokenTypes.STRING="STRING";e.XRangeValue=function(){};e.XRangeValue.prototype=new e.XAbstractValue;e.XRangeValue.prototype._ff_c="XRangeValue";e.XRangeValue.create=function(t){let r=new e.XRangeValue;r.m_range=t;return r};e.XRangeValue.prototype.m_range=null;e.XRangeValue.prototype.getStringRepresentation=function(){return this.m_range.toString()};e.XRangeValue.prototype.getValueType=function(){return e.XValueType.LIST};e.XRangeValue.prototype.toRangeList=function(){return this.m_range};e.CellEngineModule=function(){};e.CellEngineModule.prototype=new e.DfModule;e.CellEngineModule.prototype._ff_c="CellEngineModule";e.CellEngineModule.s_module=null;e.CellEngineModule.getInstance=function(){if(e.isNull(e.CellEngineModule.s_module)){e.DfModule.checkInitialized(e.IoModule.getInstance());e.DfModule.checkInitialized(e.VisualizationAbstractModule.getInstance());e.CellEngineModule.s_module=e.DfModule.startExt(new e.CellEngineModule);e.DfModule.stopExt(e.CellEngineModule.s_module)}return e.CellEngineModule.s_module};e.CellEngineModule.prototype.getName=function(){return"ff3300.cell.engine"};e.CellEngineModule.getInstance();return e});
//# sourceMappingURL=ff3300.cell.engine.js.map