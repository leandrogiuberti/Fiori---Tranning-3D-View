/*!
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define(["sap/sac/df/firefly/ff2670.visualization.ui","sap/sac/df/firefly/ff3300.cell.engine"],function(e){"use strict";e.SpreadsheetModel=function(){};e.SpreadsheetModel.prototype=new e.XObject;e.SpreadsheetModel.prototype._ff_c="SpreadsheetModel";e.SpreadsheetModel.create=function(){let t=new e.SpreadsheetModel;t.m_spreadsheet=e.XSpreadsheet.create();t.m_selectedCellAddressRange=e.XCellAddressRange.createWithString("A1");return t};e.SpreadsheetModel.prototype.m_selectedCellAddressRange=null;e.SpreadsheetModel.prototype.m_spreadsheet=null;e.SpreadsheetModel.prototype.addCellProvider=function(e){this.m_spreadsheet.addCellProvider(this.m_selectedCellAddressRange.getStartingAddress(),e)};e.SpreadsheetModel.prototype.getAllCells=function(){return this.m_spreadsheet.getCells()};e.SpreadsheetModel.prototype.getCellAtAddress=function(e){return this.m_spreadsheet.getCellAtAddress(e)};e.SpreadsheetModel.prototype.getFirstSelectedCell=function(){return this.m_spreadsheet.getCellAtAddress(this.m_selectedCellAddressRange.getStartingAddress())};e.SpreadsheetModel.prototype.getSelectedCellAddress=function(){return this.m_selectedCellAddressRange};e.SpreadsheetModel.prototype.getSelectedCells=function(){return this.m_spreadsheet.getCellRangeWithAddressRange(this.m_selectedCellAddressRange)};e.SpreadsheetModel.prototype.setSelectedCellAddress=function(e){this.m_selectedCellAddressRange=e};e.SpreadsheetModel.prototype.setTextAtAddress=function(t,l){let r=e.XCellAddress.create(l);this.m_spreadsheet.getCellAtAddress(r).setText(t)};e.SpreadsheetRenderer=function(){};e.SpreadsheetRenderer.prototype=new e.XObject;e.SpreadsheetRenderer.prototype._ff_c="SpreadsheetRenderer";e.SpreadsheetRenderer.create=function(t,l){let r=new e.SpreadsheetRenderer;r.m_spreadsheetModel=l;r.m_table=t;r.m_genericRenderer=e.SacGridRendererFactory.createGridRenderer(t);return r};e.SpreadsheetRenderer.prototype.m_genericRenderer=null;e.SpreadsheetRenderer.prototype.m_spreadsheetModel=null;e.SpreadsheetRenderer.prototype.m_table=null;e.SpreadsheetRenderer.prototype.formatCell=function(e,t){t.getTableStyle().setFontColor(e.getTextColor());t.getTableStyle().setFillColor(e.getBackgroundColor());t.getTableStyle().setFontBold(e.getBold());t.getTableStyle().setFontItalic(e.getItalic());t.getTableStyle().setFontSize(e.getFontSize());t.getTableStyle().setHorizontalAlignment(e.getHorizontalAlignment())};e.SpreadsheetRenderer.prototype.getTableJson=function(){return this.m_genericRenderer.getTableJson()};e.SpreadsheetRenderer.prototype.render=function(){let e=this.m_spreadsheetModel.getAllCells();this.m_table.setMinCellWidth(98);for(let t=0;t<e.size();t++){let l;if(t>=this.m_table.getDataRowAmount()){l=this.m_table.newDataRow()}else{l=this.m_table.getRowList().get(t)}l.setHeight(24);for(let r=0;r<e.get(t).size();r++){let s;if(r>=l.getCells().size()){s=l.addNewCell()}else{s=l.getCells().get(r)}let o=e.get(t).get(r);s.setFormatted(o.getFormattedString());this.formatCell(o,s)}}this.m_table.setDataColumnsAmount(e.get(0).size());this.m_table.setDataRowAmount(e.size());this.m_table.setPreColumnsAmount(0);return this.m_genericRenderer.render()};e.SpreadsheetRenderer.prototype.setGridConfigration=function(e){this.m_genericRenderer.setGridConfigration(e)};e.SpreadsheetController=function(){};e.SpreadsheetController.prototype=new e.XObject;e.SpreadsheetController.prototype._ff_c="SpreadsheetController";e.SpreadsheetController.create=function(t,l){let r=new e.SpreadsheetController;r.m_uiModel=e.SpreadsheetModel.create();r.m_functionInput=t;r.m_addressInput=l;r.internalSetup();return r};e.SpreadsheetController.prototype.m_addressInput=null;e.SpreadsheetController.prototype.m_functionInput=null;e.SpreadsheetController.prototype.m_tableView=null;e.SpreadsheetController.prototype.m_uiModel=null;e.SpreadsheetController.prototype.addCellProvider=function(e){this.m_uiModel.addCellProvider(e)};e.SpreadsheetController.prototype.getCellAddress=function(t){let l=e.JsonParserFactory.newInstance();let r=l.parse(t).asList();let s=r.asList().get(0).asStructure().getIntegerByKey("startRow");let o=r.asList().get(0).asStructure().getIntegerByKey("startCol");let i=r.asList().get(0).asStructure().getIntegerByKey("endRow");let n=r.asList().get(0).asStructure().getIntegerByKey("endCol");let a=e.XCellAddressRange.createWithIndices(s,i,o,n);return a};e.SpreadsheetController.prototype.getModel=function(){return this.m_uiModel};e.SpreadsheetController.prototype.internalSetup=function(){this.m_functionInput.registerOnEnter(this);this.m_addressInput.setEnabled(false)};e.SpreadsheetController.prototype.onEnter=function(e){this.setCellText(this.m_functionInput.getValue())};e.SpreadsheetController.prototype.onSelectionChange=function(e){let t=e.getParameters().getByKey("selectionArea");let l=this.getCellAddress(t);this.m_tableView.analyzeSelectionEvent(e);this.m_uiModel.setSelectedCellAddress(l);this.m_functionInput.setValue(this.m_uiModel.getSelectedCells().get(0).get(0).getStringLiteral());this.m_functionInput.focus();this.m_addressInput.setValue(this.m_uiModel.getSelectedCellAddress().getAddressString())};e.SpreadsheetController.prototype.releaseObject=function(){this.m_uiModel=e.XObjectExt.release(this.m_uiModel)};e.SpreadsheetController.prototype.setCellText=function(e){this.m_uiModel.getFirstSelectedCell().setText(e);this.m_tableView.renderSpreadsheet()};e.SpreadsheetController.prototype.setTableView=function(e){this.m_tableView=e};e.SpreadsheetController.prototype.setTextAtAddress=function(e,t){this.m_uiModel.setTextAtAddress(e,t)};e.SacSpreadsheetClipboardHelper=function(){};e.SacSpreadsheetClipboardHelper.prototype=new e.SacTableClipboardHelper;e.SacSpreadsheetClipboardHelper.prototype._ff_c="SacSpreadsheetClipboardHelper";e.SacSpreadsheetClipboardHelper.createForSpreadsheet=function(t,l){let r=new e.SacSpreadsheetClipboardHelper;r.setupWithTable(t);r.setupModel(l);return r};e.SacSpreadsheetClipboardHelper.prototype.m_model=null;e.SacSpreadsheetClipboardHelper.prototype.getCellValueAt=function(t,l){return this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(t,l)).evaluate()};e.SacSpreadsheetClipboardHelper.prototype.pasteCells=function(t,l,r){let s=t.getIntegerByKey(e.SacTable.SELECTION_COL_MIN);let o=t.getIntegerByKey(e.SacTable.SELECTION_ROW_MIN);let i=t.getListByKey(e.SacTable.SELECTION_LIST);let n="";let a;for(let t=0;t<i.size();t++){let d=i.getStructureAt(t);let p=d.getIntegerByKey(e.SacTableConstants.C_N_COLUMN)-s+l;let c=d.getIntegerByKey(e.SacTableConstants.C_N_ROW)-o+r;let S;if(c<this.getTable().getHeaderRowList().size()){S=this.getTable().getHeaderRowList().get(c).getCells();if(p<S.size()){a=d.getByKey(e.SacTableConstants.C_SN_PLAIN);n=e.isNull(a)?"":a.getStringRepresentation();this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(c,p)).setText(n)}}else if(c-this.getTable().getHeaderRowList().size()<this.getTable().getRowList().size()){S=this.getTable().getRowList().get(c-this.getTable().getHeaderRowList().size()).getCells();if(p<S.size()){a=d.getByKey(e.SacTableConstants.C_SN_PLAIN);n=e.isNull(a)?"":a.getStringRepresentation();this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(c,p)).setText(n)}}}};e.SacSpreadsheetClipboardHelper.prototype.pasteLine=function(t,l,r,s){for(let o=0;o<s.size();o++){let i=r+o;let n=s.get(o);if(i<t.size()){this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(l,i)).setText(n)}}};e.SacSpreadsheetClipboardHelper.prototype.setupModel=function(e){this.m_model=e};e.SacSpreadsheetTable=function(){};e.SacSpreadsheetTable.prototype=new e.SacTable;e.SacSpreadsheetTable.prototype._ff_c="SacSpreadsheetTable";e.SacSpreadsheetTable.createWithModel=function(t){let l=new e.SacSpreadsheetTable;l.internalSetup();l.m_model=t;return l};e.SacSpreadsheetTable.prototype.m_linkedSelection=null;e.SacSpreadsheetTable.prototype.m_linkedTable=null;e.SacSpreadsheetTable.prototype.m_model=null;e.SacSpreadsheetTable.prototype.setupLinkedSelection=function(e,t){this.m_linkedSelection=t;this.m_linkedTable=e;this.updateLinkedSelection()};e.SacSpreadsheetTable.prototype.updateLinkedSelection=function(){if(e.notNull(this.m_linkedSelection)&&e.notNull(this.m_linkedTable)){let t=e.SacBasicTableClipboardHelper.create(this.m_linkedTable).copyCells(this.m_linkedSelection);let l=t.getIntegerByKey(e.SacTable.SELECTION_COL_MIN);let r=t.getIntegerByKey(e.SacTable.SELECTION_ROW_MIN);let s=t.getListByKey(e.SacTable.SELECTION_LIST);let o="";let i;for(let t=0;t<s.size();t++){let n=s.getStructureAt(t);let a=n.getIntegerByKey(e.SacTableConstants.C_N_COLUMN)-l;let d=n.getIntegerByKey(e.SacTableConstants.C_N_ROW)-r;let p;if(d<this.getHeaderRowList().size()){p=this.getHeaderRowList().get(d).getCells();if(a<p.size()){i=n.getByKey(e.SacTableConstants.C_SN_PLAIN);o=e.isNull(i)?"":i.getStringRepresentation();this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(d,a)).updateTextFromLinkedObject(o)}}else if(d-this.getHeaderRowList().size()<this.getRowList().size()){p=this.getRowList().get(d-this.getHeaderRowList().size()).getCells();if(a<p.size()){i=n.getByKey(e.SacTableConstants.C_SN_PLAIN);o=e.isNull(i)?"":i.getStringRepresentation();this.m_model.getCellAtAddress(e.XCellAddress.createWithIndices(d,a)).updateTextFromLinkedObject(o)}}}}};e.SpreadSheetTableView=function(){};e.SpreadSheetTableView.prototype=new e.DfUiContentView;e.SpreadSheetTableView.prototype._ff_c="SpreadSheetTableView";e.SpreadSheetTableView.create=function(t){let l=new e.SpreadSheetTableView;l.initView(t);return l};e.SpreadSheetTableView.prototype.m_abstractSacTable=null;e.SpreadSheetTableView.prototype.m_abstractTableRenderer=null;e.SpreadSheetTableView.prototype.m_cellAddressInput=null;e.SpreadSheetTableView.prototype.m_columnMin=0;e.SpreadSheetTableView.prototype.m_contentLayout=null;e.SpreadSheetTableView.prototype.m_controller=null;e.SpreadSheetTableView.prototype.m_currentSelectionElement=null;e.SpreadSheetTableView.prototype.m_formulaInput=null;e.SpreadSheetTableView.prototype.m_rowMin=0;e.SpreadSheetTableView.prototype.m_sacTable=null;e.SpreadSheetTableView.prototype.m_tableClipboardHelper=null;e.SpreadSheetTableView.prototype.addCellProvider=function(e){this.m_controller.addCellProvider(e);this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.addDecimalPlace=function(){this.setStyleOnCellRange(e=>{e.addRightDigit()});this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.analyseSelectionStructure=function(t){let l=t.getIntegerByKey(e.SacTableConstants.CCD_N_START_COL);let r=t.getIntegerByKey(e.SacTableConstants.CCD_N_END_COL);let s=t.getIntegerByKey(e.SacTableConstants.CCD_N_START_ROW);let o=t.getIntegerByKey(e.SacTableConstants.CCD_N_END_ROW);this.m_columnMin=e.XMath.min(l,r);this.m_rowMin=e.XMath.min(s,o)};e.SpreadSheetTableView.prototype.analyzeSelectionEvent=function(t){let l=t.getParameters().getStringByKey(e.UiEventParams.PARAM_SELECTION_AREA);if(e.XStringUtils.isNotNullAndNotEmpty(l)){let t=e.JsonParserFactory.createFromString(l);if(!this.trySetupSelection(t)){this.m_columnMin=-1;this.m_rowMin=-1}}else{this.m_columnMin=-1;this.m_rowMin=-1}};e.SpreadSheetTableView.prototype.buildViewUi=function(t){this.m_contentLayout=t.newControl(e.UiType.FLEX_LAYOUT);this.m_contentLayout.setDirection(e.UiFlexDirection.COLUMN);this.m_contentLayout.useMaxSpace();this.setupTopBar();this.m_controller=e.SpreadsheetController.create(this.m_formulaInput,this.m_cellAddressInput);this.m_controller.setTableView(this);this.m_sacTable=this.m_contentLayout.addNewItemOfType(e.UiType.SAC_TABLE_GRID);this.m_sacTable.useMaxSpace();this.m_sacTable.registerOnResize(this);this.m_sacTable.registerOnSelectionChange(this.m_controller);this.m_abstractSacTable=e.SacSpreadsheetTable.createWithModel(this.m_controller.getModel());this.m_abstractTableRenderer=e.SpreadsheetRenderer.create(this.m_abstractSacTable,this.m_controller.getModel());this.m_tableClipboardHelper=e.SacSpreadsheetClipboardHelper.createForSpreadsheet(this.m_abstractSacTable,this.m_controller.getModel());this.createExampleCells();this.renderSpreadsheet();t.setRoot(this.m_contentLayout)};e.SpreadSheetTableView.prototype.copyCells=function(){return this.m_tableClipboardHelper.copyCellsToString(this.m_currentSelectionElement)};e.SpreadSheetTableView.prototype.createExampleCells=function(){};e.SpreadSheetTableView.prototype.destroyView=function(){this.m_formulaInput=e.XObjectExt.release(this.m_formulaInput);this.m_cellAddressInput=e.XObjectExt.release(this.m_cellAddressInput);this.m_sacTable=e.XObjectExt.release(this.m_sacTable);this.m_abstractSacTable=e.XObjectExt.release(this.m_abstractSacTable);this.m_abstractTableRenderer=e.XObjectExt.release(this.m_abstractTableRenderer);this.m_controller=e.XObjectExt.release(this.m_controller);this.m_tableClipboardHelper=e.XObjectExt.release(this.m_tableClipboardHelper)};e.SpreadSheetTableView.prototype.getColumnMin=function(){return this.m_columnMin};e.SpreadSheetTableView.prototype.getCurrentSelectionElement=function(){return this.m_currentSelectionElement};e.SpreadSheetTableView.prototype.getGridControl=function(){return this.m_sacTable};e.SpreadSheetTableView.prototype.getRowMin=function(){return this.m_rowMin};e.SpreadSheetTableView.prototype.getTable=function(){return this.m_abstractSacTable};e.SpreadSheetTableView.prototype.onResize=function(t){let l=t.getOffsetWidth();let r=t.getOffsetHeight();if(l!==0&&r!==0){if(e.notNull(this.m_abstractSacTable)){this.m_abstractSacTable.setWidth(l);this.m_abstractSacTable.setHeight(r);this.m_sacTable.setModelJson(this.m_abstractTableRenderer.render())}}};e.SpreadSheetTableView.prototype.pasteCells=function(e){this.m_tableClipboardHelper.pasteString(e,this.m_columnMin,this.m_rowMin);this.m_sacTable.setModelJson(this.m_abstractTableRenderer.render())};e.SpreadSheetTableView.prototype.removeDecimalPlace=function(){this.setStyleOnCellRange(e=>{e.removeRightDigit()});this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.renderSpreadsheet=function(){let e=this.m_abstractTableRenderer.render();this.m_sacTable.setModelJson(e)};e.SpreadSheetTableView.prototype.setHorizontalAlignCenter=function(){this.setHorizontalAlignment(e.SacVisualizationHorizontalAlignment.CENTER)};e.SpreadSheetTableView.prototype.setHorizontalAlignLeft=function(){this.setHorizontalAlignment(e.SacVisualizationHorizontalAlignment.LEFT)};e.SpreadSheetTableView.prototype.setHorizontalAlignRight=function(){this.setHorizontalAlignment(e.SacVisualizationHorizontalAlignment.RIGHT)};e.SpreadSheetTableView.prototype.setHorizontalAlignment=function(e){this.setStyleOnCellRange(t=>{t.setHorizontalAlignment(e)});this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setSelectedCellBackgroundColor=function(t){let l=e.XStringUtils.concatenate2("#",t);this.setStyleOnCellRange(e=>{e.setBackgroundColor(l)});this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setSelectedCellBold=function(){this.toggleSelectedCellBold()};e.SpreadSheetTableView.prototype.setSelectedCellFontSize=function(e){this.setStyleOnCellRange(t=>{t.setFontSize(e)});this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setSelectedCellItalic=function(){this.toggleSelectedCellItalic()};e.SpreadSheetTableView.prototype.setSelectedCellTextColor=function(t){let l=e.XStringUtils.concatenate2("#",t);this.setStyleOnCellRange(e=>{e.setTextColor(l)});this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.setStyleOnCellRange=function(e){let t=this.m_controller.getModel().getSelectedCells();for(let l=0;l<t.size();l++){for(let r=0;r<t.get(l).size();r++){e(t.get(l).get(r))}}};e.SpreadSheetTableView.prototype.setupTopBar=function(){let t=this.m_contentLayout.addNewItemOfType(e.UiType.FLEX_LAYOUT);t.setDirection(e.UiFlexDirection.ROW);t.setAlignItems(e.UiFlexAlignItems.CENTER);t.useMaxWidth();t.setFlex("0 0 34px");t.setBackgroundColor(e.UiColor.GREY.newBrighterColor(.3));t.setBorderWidth(e.UiCssBoxEdges.create("0px 0px 1px 0px"));t.setBorderColor(e.UiColor.GREY);t.setBorderStyle(e.UiBorderStyle.SOLID);this.m_cellAddressInput=t.addNewItemOfType(e.UiType.INPUT);this.m_cellAddressInput.setTag("gdsSpreadsheetSelectedCellInput");this.m_cellAddressInput.setMargin(e.UiCssBoxEdges.create("0px 7px 0px 0px"));this.m_cellAddressInput.setFlex("0 0 100px");let l=t.addNewItemOfType(e.UiType.ICON);l.setTag("gdsSpreadsheetCancelIcon");l.setIconSize(e.UiCssLength.create("20px"));l.setIcon("decline");l.setColor(e.UiColor.RED);l.setMargin(e.UiCssBoxEdges.create("0px 7px"));let r=t.addNewItemOfType(e.UiType.ICON);r.setTag("gdsSpreadsheetEnterIcon");r.setIconSize(e.UiCssLength.create("20px"));r.setIcon("accept");r.setColor(e.UiColor.GREEN);r.setMargin(e.UiCssBoxEdges.create("0px 7px"));let s=t.addNewItemOfType(e.UiType.ICON);s.setIconSize(e.UiCssLength.create("20px"));s.setIcon("fx");s.setColor(e.UiColor.GREY);s.setMargin(e.UiCssBoxEdges.create("0px 7px"));s.setEnabled(false);this.m_formulaInput=t.addNewItemOfType(e.UiType.INPUT);this.m_formulaInput.setTag("gdsSpreadsheetFunctionInput")};e.SpreadSheetTableView.prototype.setupView=function(){};e.SpreadSheetTableView.prototype.toggleSelectedCellBold=function(){this.setStyleOnCellRange(e=>{e.setBold(!e.getBold())});this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.toggleSelectedCellItalic=function(){this.setStyleOnCellRange(e=>{e.setItalic(!e.getItalic())});this.renderSpreadsheet()};e.SpreadSheetTableView.prototype.trySetupSelection=function(t){this.m_currentSelectionElement=t;let l=false;if(e.notNull(t)){if(t.isStructure()){this.analyseSelectionStructure(t.asStructure());l=true}else if(t.isList()){let r=t.asList();if(e.XCollectionUtils.hasElements(r)){for(let e=0;e<r.size();e++){this.analyseSelectionStructure(r.getStructureAt(e))}l=true}}}return l};e.CellEngineUiModule=function(){};e.CellEngineUiModule.prototype=new e.DfModule;e.CellEngineUiModule.prototype._ff_c="CellEngineUiModule";e.CellEngineUiModule.s_module=null;e.CellEngineUiModule.getInstance=function(){if(e.isNull(e.CellEngineUiModule.s_module)){e.DfModule.checkInitialized(e.CellEngineModule.getInstance());e.CellEngineUiModule.s_module=e.DfModule.startExt(new e.CellEngineUiModule);e.DfModule.stopExt(e.CellEngineUiModule.s_module)}return e.CellEngineUiModule.s_module};e.CellEngineUiModule.prototype.getName=function(){return"ff3350.cell.engine.ui"};e.DfModule.checkInitialized(e.VisualizationUiModule.getInstance());e.DfModule.checkInitialized(e.CellEngineModule.getInstance());e.CellEngineUiModule.getInstance();return e});
//# sourceMappingURL=ff3350.cell.engine.ui.js.map