/*!
 * SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
 */
sap.ui.define(["sap/sac/df/firefly/ff2100.runtime"],function(e){"use strict";e.ComposableConstants={CHILD_RESOURCES_KEY:"childResources",CONTENT_KEY:"content",CONTENT_TYPE_KEY:"contentType",DEFAULT_VFS_URI:"fscomposable://EHS_CS_/composable-service/api/v1/vfs",DESCENDANTS_KEY:"descendants",FILE:"File",FIREFLY_COMPOSABLE_VFS_SERVICE_URL:"ff_composable_vfs_service_url",FOLDER:"Folder",IS_DIRECTORY_KEY:"isDirectory",LIST_DESCENDANTS_KEY:"listDescendants",METADATA_KEY:"metadata",RESOURCE_KEY:"resource",RESOURCE_NAME_KEY:"resourceName"};e.ComposableFileRequestListener=function(){};e.ComposableFileRequestListener.prototype=new e.XObject;e.ComposableFileRequestListener.prototype._ff_c="ComposableFileRequestListener";e.ComposableFileRequestListener.create=function(t){let o=new e.ComposableFileRequestListener;o.m_callback=t;return o};e.ComposableFileRequestListener.prototype.m_callback=null;e.ComposableFileRequestListener.prototype.onHttpFileProcessed=function(e,t,o){this.m_callback(e)};e.ComposableFileUtil={addCommonMetaData:function(t){t.putBoolean(e.XFileAttribute.IS_HIDDEN,false);t.putBoolean(e.XFileAttribute.IS_EXECUTABLE,false);t.putBoolean(e.XFileAttribute.SUPPORTS_CARTESIAN_FILTER,false);t.putBoolean(e.XFileAttribute.SUPPORTS_SEARCH,true);t.putBoolean(e.XFileAttribute.SUPPORTS_OFFSET,true);t.putBoolean(e.XFileAttribute.SUPPORTS_MAX_ITEMS,true);t.putBoolean(e.XFileAttribute.SUPPORTS_SINGLE_SORT,true)},addComposableAttributes:function(t,o){t.putString(e.XFileAttribute.FOLDER_ID,o.getStringByKey("resourceId"));t.putLong(e.XFileAttribute.CREATED_AT,o.getLongByKeyExt("createdAt",0));t.putString(e.XFileAttribute.CREATED_BY,o.getStringByKey("createdBy"));t.putLong(e.XFileAttribute.CHANGED_AT,o.getLongByKeyExt("modifiedAt",0));t.putString(e.XFileAttribute.CHANGED_BY,o.getStringByKey("modifiedBy"))}};e.ComposableFile=function(){};e.ComposableFile.prototype=new e.DfXFileProvider;e.ComposableFile.prototype._ff_c="ComposableFile";e.ComposableFile.create=function(t,o,s){let i=new e.ComposableFile;i.setupFile(t,o,s);let l=e.XString.isEqual(o.getRootDirectoryUri().getPath(),s.getPath());if(l){i.getProviderAttributes().putString(e.XFileAttribute.NODE_TYPE,"Folder")}i.setProviderIsExisting(true);o.getFileCache().put(i.getUri().getPathContainer().getPath(),i);return i};e.ComposableFile.prototype.getComposableFileSystem=function(){return this.m_fs};e.ComposableFile.prototype.getProviderMetadataAndAttributes=function(){let t=this.getProviderMetadata();let o=e.PrFactory.createStructure();o.putAll(t);o.putAll(this.getProviderAttributes());return o};e.ComposableFile.prototype.processProviderDelete=function(e,t,o){return this.getComposableFileSystem().processDelete(e,this,t,o)};e.ComposableFile.prototype.processProviderDeleteRecursive=function(e,t,o,s){return this.getComposableFileSystem().processDelete(e,this,t,o)};e.ComposableFile.prototype.processProviderFetchChildren=function(e,t,o,s){return this.getComposableFileSystem().processFetchChildren(e,this,t,o,s)};e.ComposableFile.prototype.processProviderFetchMetadata=function(e,t,o,s){return this.getComposableFileSystem().processFetchMetadata(e,this,t,o)};e.ComposableFile.prototype.processProviderIsExisting=function(e,t,o){return this.getComposableFileSystem().processIsExisting(e,this,t,o)};e.ComposableFile.prototype.processProviderLoad=function(e,t,o,s){return this.getComposableFileSystem().processLoad(e,this,t,o,s)};e.ComposableFile.prototype.processProviderMkdir=function(e,t,o,s,i){return this.getComposableFileSystem().processMkdir(e,this,t,o,s,i)};e.ComposableFile.prototype.processProviderRename=function(e,t,o,s){return this.getComposableFileSystem().processRename(e,this,t,o,s)};e.ComposableFile.prototype.processProviderSave=function(e,t,o,s,i,l,n){return this.getComposableFileSystem().processSave(e,this,t,o,s,i,l,n)};e.ComposableFile.prototype.setInternalMetadataAndAttributes=function(t){let o=t.getBooleanByKey(e.ComposableConstants.IS_DIRECTORY_KEY);let s=e.PrFactory.createStructure();e.ComposableFileUtil.addCommonMetaData(s);s.putString(e.XFileAttribute.DISPLAY_NAME,t.getStringByKey(e.ComposableConstants.RESOURCE_NAME_KEY));s.putBoolean(e.XFileAttribute.IS_DIRECTORY,o);s.putBoolean(e.XFileAttribute.IS_FILE,!o);s.putString(e.XFileAttribute.FILE_TYPE,o?e.XFileType.DIR.getName():e.XFileType.FILE.getName());s.putBoolean(e.XFileAttribute.SUPPORTS_RECURSIVE_LIST,o);let i=e.PrFactory.createStructure();e.ComposableFileUtil.addComposableAttributes(i,t);i.putString(e.XFileAttribute.NODE_TYPE,o?e.ComposableConstants.FOLDER:e.ComposableConstants.FILE);this.setProviderMetadata(s);this.setProviderAttributes(i)};e.ComposableFile.prototype.supportsProviderDelete=function(){return true};e.ComposableFile.prototype.supportsProviderDeleteRecursive=function(){return true};e.ComposableFile.prototype.supportsProviderFetchChildren=function(){return true};e.ComposableFile.prototype.supportsProviderIsExisting=function(){return true};e.ComposableFile.prototype.supportsProviderLoad=function(){return true};e.ComposableFile.prototype.supportsProviderMkdir=function(){return true};e.ComposableFile.prototype.supportsProviderRenameTo=function(){return true};e.ComposableFile.prototype.supportsProviderSave=function(){return true};e.ComposableFile.prototype.supportsProviderSize=function(){return true};e.SubSysFsComposablePrg=function(){};e.SubSysFsComposablePrg.prototype=new e.DfSubSysFilesystem;e.SubSysFsComposablePrg.prototype._ff_c="SubSysFsComposablePrg";e.SubSysFsComposablePrg.DEFAULT_PROGRAM_NAME="@SubSys.FileSystem.fscomposable";e.SubSysFsComposablePrg.prototype.m_composableFileSystems=null;e.SubSysFsComposablePrg.prototype.m_fs=null;e.SubSysFsComposablePrg.prototype.getAllInitializedFileSystems=function(){return this.m_composableFileSystems};e.SubSysFsComposablePrg.prototype.getFileSystem=function(e){return this.m_fs};e.SubSysFsComposablePrg.prototype.getFileSystemByUri=function(t){if(e.isNull(this.m_composableFileSystems)){this.m_composableFileSystems=e.XHashMapByString.create()}let o;if(e.XStringUtils.isNullOrEmpty(t.getHost())){let t=this.getProcess().getEnvironment().getStringByKey(e.ComposableConstants.FIREFLY_COMPOSABLE_VFS_SERVICE_URL);if(e.XStringUtils.isNullOrEmpty(t)){o=e.XUri.createFromUrl(e.ComposableConstants.DEFAULT_VFS_URI)}else{o=e.XUri.createFromUrl(t)}}else{o=e.XUri.createFromOther(t)}let s=o.getHost();let i;let l=this.m_composableFileSystems.getByKey(s);if(e.notNull(l)){i=l}else{o.removeTrailingSlash();i=e.ComposableFileSystem.createByHost(this.getProcess(),o.getUrl());this.m_composableFileSystems.put(s,i)}this.m_fs=i;return this.m_fs};e.SubSysFsComposablePrg.prototype.getProgramName=function(){return e.SubSysFsComposablePrg.DEFAULT_PROGRAM_NAME};e.SubSysFsComposablePrg.prototype.getProtocolType=function(){return e.ProtocolType.FS_COMPOSABLE};e.SubSysFsComposablePrg.prototype.newProgram=function(){let t=new e.SubSysFsComposablePrg;t.setup();return t};e.SubSysFsComposablePrg.prototype.processFetchFileSystem=function(t,o,s,i){if(this.getProcess().getConnectionPool()===null){this.getProcess().setEntity(e.ProcessEntity.CONNECTION_POOL,e.ConnectionPool.create(this.getProcess()))}return e.ComposableFsActionFetch.createAndRun(t,o,s,this,i)};e.SubSysFsComposablePrg.prototype.runProcess=function(){this.m_composableFileSystems=e.XHashMapByString.create();let t=this.getProcess();if(this.getProcess().getConnectionPool()===null){this.getProcess().setEntity(e.ProcessEntity.CONNECTION_POOL,e.ConnectionPool.create(this.getProcess()))}this.m_fs=e.ComposableFileSystem.create(t);this.activateSubSystem(null,e.SubSystemStatus.ACTIVE);return true};e.ComposableFileBaseAction=function(){};e.ComposableFileBaseAction.prototype=new e.SyncActionExt;e.ComposableFileBaseAction.prototype._ff_c="ComposableFileBaseAction";e.ComposableFileBaseAction.prototype.m_file=null;e.ComposableFileBaseAction.prototype.m_fileSystem=null;e.ComposableFileBaseAction.prototype.addResponseError=function(t){let o;if(e.isNull(t)){o="Response is null"}else{o=e.XStringUtils.concatenate2("Response format is not correct: ",t.getRootElementAsString())}this.addErrorExt(e.OriginLayer.IOLAYER,e.ErrorCodes.SYSTEM_IO_HTTP,o,null);this.log(o)};e.ComposableFileBaseAction.prototype.callListener=function(e,t,o,s){t.onHttpFileProcessed(e,o,s)};e.ComposableFileBaseAction.prototype.getConnection=function(e){return this.getProcess().getConnectionPool().getConnection(e)};e.ComposableFileBaseAction.prototype.getServiceUri=function(t){let o;if(e.XStringUtils.isNullOrEmpty(t.getUri().getHost())){o=e.XUri.createFromUrl(e.XStringUtils.concatenate2(this.m_fileSystem.getServiceUrl(),t.getUri().getPath()))}else{o=e.XUri.createFromOther(t.getUri())}if(o.getProtocolType()===this.m_fileSystem.getProtocolType()){o.setProtocolType(e.ProtocolType.HTTPS)}return o};e.ComposableFileBaseAction.prototype.releaseObjectInternal=function(){};e.ComposableFileBaseAction.prototype.sendRequest=function(t,o,s,i,l){let n=this.getConnection(o.getHost());let r=n.newRpcFunctionByUri(o);r.setServiceName(e.SystemServices.COMPOSABLE_SERVICE);let a=r.getRpcRequest();a.setMethod(s);if(s===e.HttpRequestMethod.HTTP_POST||s===e.HttpRequestMethod.HTTP_PUT){if(e.notNull(i)){if(i===e.ContentType.TEXT){a.setRequestContentType(e.ContentType.APPLICATION_JSON)}else{a.setRequestContentType(i)}}if(e.notNull(l)){if(!e.XStringUtils.isNullOrEmpty(l.getStringRepresentation())){if(i===e.ContentType.APPLICATION_JSON){a.setRequestStructure(l)}else{let t=e.JsonParserFactory.newInstance();let o=t.parse(l.getStringRepresentation());a.setRequestStructure(o.asStructure())}}}}r.processFunctionExecution(t,this,null)};e.ComposableFsActionFetch=function(){};e.ComposableFsActionFetch.prototype=new e.SyncActionExt;e.ComposableFsActionFetch.prototype._ff_c="ComposableFsActionFetch";e.ComposableFsActionFetch.createAndRun=function(t,o,s,i,l){let n=new e.ComposableFsActionFetch;n.m_uri=l;n.setupActionAndRun(t,o,s,i);return n};e.ComposableFsActionFetch.prototype.m_uri=null;e.ComposableFsActionFetch.prototype.callListener=function(e,t,o,s){t.onFileSystemFetched(e,o,s)};e.ComposableFsActionFetch.prototype.processSynchronization=function(e){let t=this.getActionContext().getFileSystemByUri(this.m_uri);this.setData(t);return false};e.ComposableContentType=function(){};e.ComposableContentType.prototype=new e.ContentType;e.ComposableContentType.prototype._ff_c="ComposableContentType";e.ComposableContentType.COMPOSABLE_DIRECTORY=null;e.ComposableContentType.COMPOSABLE_REQUEST=null;e.ComposableContentType.staticSetupComposableTypes=function(){e.ComposableContentType.COMPOSABLE_DIRECTORY=e.ContentType.createMime("application/vnd.sap.sac.dir",e.ContentType.APPLICATION_JSON);e.ComposableContentType.COMPOSABLE_REQUEST=e.ContentType.createMime("application/vnd.sap.sac.composablerequest+json",e.ContentType.APPLICATION_JSON)};e.ComposableFileSystem=function(){};e.ComposableFileSystem.prototype=new e.DfXFileSystem;e.ComposableFileSystem.prototype._ff_c="ComposableFileSystem";e.ComposableFileSystem.create=function(t){let o=new e.ComposableFileSystem;o.m_fileCache=e.XHashMapByString.create();o.setupProcessContext(t);return o};e.ComposableFileSystem.createByHost=function(t,o){let s=new e.ComposableFileSystem;s.m_serviceUrl=o;s.m_fileCache=e.XHashMapByString.create();s.setupProcessContext(t);return s};e.ComposableFileSystem.prototype.m_fileCache=null;e.ComposableFileSystem.prototype.m_rootFile=null;e.ComposableFileSystem.prototype.m_serviceUrl=null;e.ComposableFileSystem.prototype.getFileCache=function(){return this.m_fileCache};e.ComposableFileSystem.prototype.getProtocolType=function(){return e.ProtocolType.FS_COMPOSABLE};e.ComposableFileSystem.prototype.getServiceUrl=function(){return this.m_serviceUrl};e.ComposableFileSystem.prototype.newFile=function(t,o){let s=o.getPathContainer().getPath();let i=this.getFileCache().getByKey(s);if(e.isNull(i)){i=e.ComposableFile.create(t,this,o)}if(e.notNull(this.m_rootFile)&&e.XString.isEqual(o.getPath(),e.XUri.PATH_SEPARATOR)){let t=o.getHost();if(!e.XString.isEqual(t,this.m_rootFile.getUri().getHost())){this.m_rootFile=i}return this.m_rootFile}else if(e.XString.isEqual(o.getPath(),e.XUri.PATH_SEPARATOR)){this.m_rootFile=i}return i};e.ComposableFileSystem.prototype.processDelete=function(t,o,s,i){return e.ComposableFileDeleteAction.createAndRun(t,o,this,e.ComposableFileRequestListener.create(t=>{let o=t.getData();if(e.notNull(s)){s.onFileProviderDeleted(t,o,i)}}),i)};e.ComposableFileSystem.prototype.processFetchChildren=function(t,o,s,i,l){return e.ComposableFileFetchChildrenAction.createAndRun(t,o,this,e.ComposableFileRequestListener.create(t=>{let o=t.getData();if(e.notNull(s)){s.onFileProviderChildrenFetched(t,o,o.getProviderChildFiles(),o.getProviderChildrenResultset(),i)}}),i,l)};e.ComposableFileSystem.prototype.processFetchMetadata=function(t,o,s,i){return e.ComposableFileFetchMetadataAction.createAndRun(t,o,this,e.ComposableFileRequestListener.create(t=>{let o=t.getData();if(e.notNull(s)){s.onFileProviderFetchMetadata(t,o,o.getProviderMetadataAndAttributes(),i)}}),i)};e.ComposableFileSystem.prototype.processIsExisting=function(t,o,s,i){return e.ComposableFileExistsAction.createAndRun(t,o,this,e.ComposableFileRequestListener.create(t=>{let o=t.getData();if(e.notNull(s)){s.onFileProviderExistsCheck(t,o,o.getProviderIsExisting(),i)}}),i)};e.ComposableFileSystem.prototype.processLoad=function(t,o,s,i,l){return e.ComposableFileLoadAction.createAndRun(t,o,this,e.ComposableFileRequestListener.create(t=>{let o=t.getData();if(e.notNull(s)){s.onFileProviderLoaded(t,o,o.getProviderContent(),i)}}),i,l)};e.ComposableFileSystem.prototype.processMkdir=function(t,o,s,i,l,n){return e.ComposableFileMkdirAction.createAndRun(t,o,this,e.ComposableFileRequestListener.create(t=>{let o=t.getData();if(e.notNull(s)){s.onFileProviderDirectoryCreated(t,o,i)}}),i,l,n)};e.ComposableFileSystem.prototype.processRename=function(t,o,s,i,l){return e.ComposableFileRenameAction.createAndRun(t,o,this,e.ComposableFileRequestListener.create(t=>{let o=t.getData();if(e.notNull(s)){s.onFileProviderRenamed(t,o,i)}}),i,l)};e.ComposableFileSystem.prototype.processSave=function(t,o,s,i,l,n,r,a){return e.ComposableFileSaveAction.createAndRun(t,o,this,e.ComposableFileRequestListener.create(t=>{let o=t.getData();if(e.notNull(s)){s.onFileProviderSaved(t,o,l,i)}}),i,l,n,r,a)};e.ComposableFileDeleteAction=function(){};e.ComposableFileDeleteAction.prototype=new e.ComposableFileBaseAction;e.ComposableFileDeleteAction.prototype._ff_c="ComposableFileDeleteAction";e.ComposableFileDeleteAction.create=function(t,o,s,i,l){let n=new e.ComposableFileDeleteAction;n.m_file=o;n.m_fileSystem=s;n.setData(o);n.setupAction(t,i,l,s);return n};e.ComposableFileDeleteAction.createAndRun=function(t,o,s,i,l){let n=new e.ComposableFileDeleteAction;n.m_file=o;n.m_fileSystem=s;n.setData(o);n.setupActionAndRun(t,i,l,s);return n};e.ComposableFileDeleteAction.prototype.onFunctionExecuted=function(e,t,o){this.addAllMessages(e);if(e.isValid()){this.m_file.setProviderIsExisting(false);this.setData(this.m_file)}else{this.m_file.addAllMessages(e)}this.endSync()};e.ComposableFileDeleteAction.prototype.processSynchronization=function(t){let o=this.getServiceUri(this.m_file);this.sendRequest(t,o,e.HttpRequestMethod.HTTP_DELETE,null,null);return true};e.ComposableFileExistsAction=function(){};e.ComposableFileExistsAction.prototype=new e.ComposableFileBaseAction;e.ComposableFileExistsAction.prototype._ff_c="ComposableFileExistsAction";e.ComposableFileExistsAction.create=function(t,o,s,i,l){let n=new e.ComposableFileExistsAction;n.m_file=o;n.m_fileSystem=s;n.setData(o);n.setupAction(t,i,l,s);return n};e.ComposableFileExistsAction.createAndRun=function(t,o,s,i,l){let n=new e.ComposableFileExistsAction;n.m_file=o;n.m_fileSystem=s;n.setData(o);n.setupActionAndRun(t,i,l,s);return n};e.ComposableFileExistsAction.prototype.onFunctionExecuted=function(e,t,o){this.m_file.setProviderIsExisting(e.isValid());this.setData(this.m_file);this.endSync()};e.ComposableFileExistsAction.prototype.processSynchronization=function(t){let o=this.getServiceUri(this.m_file);this.sendRequest(t,o,e.HttpRequestMethod.HTTP_HEAD,null,null);return true};e.ComposableFileFetchChildrenAction=function(){};e.ComposableFileFetchChildrenAction.prototype=new e.ComposableFileBaseAction;e.ComposableFileFetchChildrenAction.prototype._ff_c="ComposableFileFetchChildrenAction";e.ComposableFileFetchChildrenAction.create=function(t,o,s,i,l,n){let r=new e.ComposableFileFetchChildrenAction;r.m_file=o;r.m_fileSystem=s;r.m_fileQuery=n;r.setData(o);r.setupAction(t,i,l,s);return r};e.ComposableFileFetchChildrenAction.createAndRun=function(t,o,s,i,l,n){let r=new e.ComposableFileFetchChildrenAction;r.m_file=o;r.m_fileSystem=s;r.m_fileQuery=n;r.setData(o);r.setupActionAndRun(t,i,l,s);return r};e.ComposableFileFetchChildrenAction.prototype.m_fileQuery=null;e.ComposableFileFetchChildrenAction.prototype.onFunctionExecuted=function(t,o,s){this.addAllMessages(t);if(t.isValid()){let t=o.getRootElement();if(e.notNull(t)&&t.isStructure()&&!t.asStructure().isEmpty()){let o=e.notNull(this.m_fileQuery)&&this.m_fileQuery.isRecursiveListEnabled()?e.ComposableConstants.DESCENDANTS_KEY:e.ComposableConstants.CHILD_RESOURCES_KEY;let s=t.asStructure().getListByKey(o);if(!s.isEmpty()){let t=e.XList.create();e.XCollectionUtils.forEach(s,o=>{let s=o.asStructure();let i=s.getStringByKey(e.ComposableConstants.RESOURCE_NAME_KEY);let l=s.getBooleanByKey(e.ComposableConstants.IS_DIRECTORY_KEY);let n;if(l){n=e.XUri.createChildDir(this.m_file.getUri(),i)}else{n=e.XUri.createChildFile(this.m_file.getUri(),i)}let r=e.ComposableFile.create(this.getProcess(),this.m_fileSystem,n);r.setInternalMetadataAndAttributes(s);t.add(r)});this.m_file.setProviderChildFiles(t,t.size())}else{this.m_file.setProviderChildFiles(e.XList.create(),0)}}else{this.addResponseError(o)}}else{this.m_file.addAllMessages(t)}this.endSync()};e.ComposableFileFetchChildrenAction.prototype.processSynchronization=function(t){let o=this.getServiceUri(this.m_file);if(e.notNull(this.m_fileQuery)&&this.m_fileQuery.isRecursiveListEnabled()){let t=e.XList.create();t.add(e.XNameValuePair.create(e.ComposableConstants.LIST_DESCENDANTS_KEY,"true"));t.add(e.XNameValuePair.create(e.ComposableConstants.IS_DIRECTORY_KEY,"false"));o.addQueryElements(t)}this.sendRequest(t,o,e.HttpRequestMethod.HTTP_GET,null,null);return true};e.ComposableFileFetchMetadataAction=function(){};e.ComposableFileFetchMetadataAction.prototype=new e.ComposableFileBaseAction;e.ComposableFileFetchMetadataAction.prototype._ff_c="ComposableFileFetchMetadataAction";e.ComposableFileFetchMetadataAction.create=function(t,o,s,i,l){let n=new e.ComposableFileFetchMetadataAction;n.m_file=o;n.m_fileSystem=s;n.setData(o);n.setupAction(t,i,l,s);return n};e.ComposableFileFetchMetadataAction.createAndRun=function(t,o,s,i,l){let n=new e.ComposableFileFetchMetadataAction;n.m_file=o;n.m_fileSystem=s;n.setData(o);n.setupActionAndRun(t,i,l,s);return n};e.ComposableFileFetchMetadataAction.prototype.onFunctionExecuted=function(e,t,o){this.endSync()};e.ComposableFileFetchMetadataAction.prototype.processSynchronization=function(e){return false};e.ComposableFileLoadAction=function(){};e.ComposableFileLoadAction.prototype=new e.ComposableFileBaseAction;e.ComposableFileLoadAction.prototype._ff_c="ComposableFileLoadAction";e.ComposableFileLoadAction.create=function(t,o,s,i,l,n){let r=new e.ComposableFileLoadAction;r.m_file=o;r.m_fileSystem=s;r.setData(o);r.setupAction(t,i,l,s);return r};e.ComposableFileLoadAction.createAndRun=function(t,o,s,i,l,n){let r=new e.ComposableFileLoadAction;r.m_file=o;r.m_fileSystem=s;r.setData(o);r.setupActionAndRun(t,i,l,s);return r};e.ComposableFileLoadAction.prototype.onFunctionExecuted=function(t,o,s){this.addAllMessages(t);if(t.isValid()){let t=o.getRootElement();if(e.notNull(t)&&t.isStructure()&&!t.asStructure().isEmpty()){let s=t.asStructure().getStructureByKey(e.ComposableConstants.RESOURCE_KEY);if(e.notNull(s)){let t=s.getStringByKey(e.ComposableConstants.CONTENT_TYPE_KEY);let o=e.ContentType.lookup(t);let i=e.XContent.createStringContent(o,s.getStringByKey(e.ComposableConstants.CONTENT_KEY));this.m_file.setProviderFileContent(i);this.m_file.setInternalMetadataAndAttributes(s);this.m_file.setProviderIsExisting(true)}else{this.addResponseError(o)}}else{this.addResponseError(o)}}else{this.m_file.addAllMessages(t)}this.endSync()};e.ComposableFileLoadAction.prototype.processSynchronization=function(t){let o=this.getServiceUri(this.m_file);this.sendRequest(t,o,e.HttpRequestMethod.HTTP_GET,null,null);return true};e.ComposableFileMkdirAction=function(){};e.ComposableFileMkdirAction.prototype=new e.ComposableFileBaseAction;e.ComposableFileMkdirAction.prototype._ff_c="ComposableFileMkdirAction";e.ComposableFileMkdirAction.create=function(t,o,s,i,l,n,r){let a=new e.ComposableFileMkdirAction;a.m_file=o;a.m_fileSystem=s;a.setData(o);a.setupAction(t,i,l,s);return a};e.ComposableFileMkdirAction.createAndRun=function(t,o,s,i,l,n,r){let a=new e.ComposableFileMkdirAction;a.m_file=o;a.m_fileSystem=s;a.setData(o);a.setupActionAndRun(t,i,l,s);return a};e.ComposableFileMkdirAction.prototype.onFunctionExecuted=function(t,o,s){this.addAllMessages(t);if(t.isValid()){let t=o.getRootElement();if(e.notNull(t)&&t.isStructure()&&!t.asStructure().isEmpty()){let s=t.asStructure().getStructureByKey(e.ComposableConstants.RESOURCE_KEY);if(e.notNull(s)){let t=this.m_file.getUri();this.m_fileSystem.getFileCache().remove(t.getPathContainer().getPath());let o=e.XUri.createParent(t);let i=e.XUri.createChildDir(o,s.getStringByKey(e.ComposableConstants.RESOURCE_NAME_KEY));this.m_file=e.ComposableFile.create(this.getProcess(),this.m_fileSystem,i);this.m_file.setInternalMetadataAndAttributes(s);this.setData(this.m_file)}else{this.addResponseError(o)}}else{this.addResponseError(o)}}else{this.m_file.addAllMessages(t)}this.endSync()};e.ComposableFileMkdirAction.prototype.processSynchronization=function(t){let o=this.getServiceUri(this.m_file);this.sendRequest(t,o,e.HttpRequestMethod.HTTP_POST,e.ComposableContentType.COMPOSABLE_DIRECTORY,null);return true};e.ComposableFileRenameAction=function(){};e.ComposableFileRenameAction.prototype=new e.ComposableFileBaseAction;e.ComposableFileRenameAction.prototype._ff_c="ComposableFileRenameAction";e.ComposableFileRenameAction.create=function(t,o,s,i,l,n){let r=new e.ComposableFileRenameAction;r.m_file=o;r.m_fileSystem=s;r.m_targetName=n;r.setData(o);r.setupAction(t,i,l,s);return r};e.ComposableFileRenameAction.createAndRun=function(t,o,s,i,l,n){let r=new e.ComposableFileRenameAction;r.m_file=o;r.m_fileSystem=s;r.m_targetName=n;r.setData(o);r.setupActionAndRun(t,i,l,s);return r};e.ComposableFileRenameAction.prototype.m_targetName=null;e.ComposableFileRenameAction.prototype.onFunctionExecuted=function(t,o,s){this.addAllMessages(t);if(t.isValid()){let t=o.getRootElement();if(e.notNull(t)&&t.isStructure()&&!t.asStructure().isEmpty()){let s=t.asStructure().getStructureByKey(e.ComposableConstants.RESOURCE_KEY);if(e.notNull(s)){this.m_file.setInternalMetadataAndAttributes(s);this.setData(this.m_file)}else{this.addResponseError(o)}}else{this.addResponseError(o)}}else{this.m_file.addAllMessages(t)}this.endSync()};e.ComposableFileRenameAction.prototype.processSynchronization=function(t){let o=this.getServiceUri(this.m_file);let s=e.XList.create();s.add(e.XNameValuePair.create("newName",this.m_targetName));o.addQueryElements(s);this.sendRequest(t,o,e.HttpRequestMethod.HTTP_PATCH,e.ComposableContentType.COMPOSABLE_DIRECTORY,null);return true};e.ComposableFileSaveAction=function(){};e.ComposableFileSaveAction.prototype=new e.ComposableFileBaseAction;e.ComposableFileSaveAction.prototype._ff_c="ComposableFileSaveAction";e.ComposableFileSaveAction.create=function(t,o,s,i,l,n,r,a,p){let c=new e.ComposableFileSaveAction;c.m_file=o;c.m_fileSystem=s;c.m_content=n;c.m_metadata=a;c.setData(o);c.setupAction(t,i,l,s);return c};e.ComposableFileSaveAction.createAndRun=function(t,o,s,i,l,n,r,a,p){let c=new e.ComposableFileSaveAction;c.m_file=o;c.m_fileSystem=s;c.m_content=n;c.m_metadata=a;c.setData(o);c.setupActionAndRun(t,i,l,s);return c};e.ComposableFileSaveAction.prototype.m_content=null;e.ComposableFileSaveAction.prototype.m_metadata=null;e.ComposableFileSaveAction.prototype.onFunctionExecuted=function(t,o,s){this.addAllMessages(t);if(t.isValid()){let t=o.getRootElement();if(e.notNull(t)&&t.isStructure()&&!t.asStructure().isEmpty()){let s=t.asStructure().getStructureByKey(e.ComposableConstants.RESOURCE_KEY);if(e.notNull(s)){let t=this.m_file.getUri();this.m_fileSystem.getFileCache().remove(t.getPathContainer().getPath());let o=e.XUri.createParent(t);let i=e.XUri.createChildFile(o,s.getStringByKey(e.ComposableConstants.RESOURCE_NAME_KEY));this.m_file=e.ComposableFile.create(this.getProcess(),this.m_fileSystem,i);this.m_file.setInternalMetadataAndAttributes(s);this.setData(this.m_file)}else{this.addResponseError(o)}}else{this.addResponseError(o)}}else{this.m_file.addAllMessages(t)}this.endSync()};e.ComposableFileSaveAction.prototype.processSynchronization=function(t){let o=this.getServiceUri(this.m_file);let s=e.PrFactory.createStructure();s.put(e.ComposableConstants.METADATA_KEY,e.PrFactory.createFromValue(this.m_metadata));s.put(e.ComposableConstants.CONTENT_KEY,e.PrFactory.createString(this.m_content.getString()));s.put(e.ComposableConstants.CONTENT_TYPE_KEY,e.PrFactory.createString(this.m_content.getContentType().toString()));this.sendRequest(t,o,e.HttpRequestMethod.HTTP_POST,e.ComposableContentType.COMPOSABLE_REQUEST,s);return true};e.ComposableFsModule=function(){};e.ComposableFsModule.prototype=new e.DfModule;e.ComposableFsModule.prototype._ff_c="ComposableFsModule";e.ComposableFsModule.COMPOSABLE_MODULE="ff2130.composable.fs";e.ComposableFsModule.s_module=null;e.ComposableFsModule.getInstance=function(){if(e.isNull(e.ComposableFsModule.s_module)){e.DfModule.checkInitialized(e.RuntimeModule.getInstance());e.ComposableFsModule.s_module=e.DfModule.startExt(new e.ComposableFsModule);e.ProgramRegistry.setProgramFactory(new e.SubSysFsComposablePrg);e.ComposableContentType.staticSetupComposableTypes();e.DfModule.stopExt(e.ComposableFsModule.s_module)}return e.ComposableFsModule.s_module};e.ComposableFsModule.prototype.getName=function(){return e.ComposableFsModule.COMPOSABLE_MODULE};e.ComposableFsModule.getInstance();return e});
//# sourceMappingURL=ff2130.composable.fs.js.map