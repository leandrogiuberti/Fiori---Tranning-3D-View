/*!
* SAPUI5
    (c) Copyright 2009-2021 SAP SE. All rights reserved
  
*/
sap.ui.define("sap/sac/df/model/Scenario",["sap/ui/base/Object","sap/sac/df/model/DataProvider","sap/sac/df/firefly/library"],function(t,e,r){"use strict";const i=t.extend("sap.sac.df.model.Scenario",{constructor:function(t,e,i){Object.assign(this,Object.getPrototypeOf(this));this._DataProvider=new sap.sac.df.model.DataProvider(t._Model,t.Name+"__"+e);this._ScenarioId=e;this._ScenarioExecutionID=i;this._DataProvider.getProperty=function(t){return this._DataProvider[t.substring(1)]}.bind(this);this._DataProvider.setProperty=function(t,e){return this._DataProvider[t.substring(1)]=e}.bind(this);setTimeout(()=>{this._DataProvider&&this._DataProvider.destroy&&this._DataProvider.destroy()},"20000");this._cloneDataProvider=function(){const e=t.getAutoFetchEnabled();t.setAutoFetchEnabled(false);return Promise.resolve(t._FFDataProvider.getActions().getLifecycleActions().cloneDataProvider(this._DataProvider.Name,false)).then(r=>{this._DataProvider._FFDataProvider=r;this._DataProvider._executeModelOperation(null,true);t.setAutoFetchEnabled(e);return this})};this._setResultSetSettings=function(){const t=this._DataProvider._getQueryModel().getSystemType();const e=this._DataProvider._getQueryModel().getVisualizationManager().getApplicationSettings();switch(t){case r.SystemType.BW:this._DataProvider._getQueryModel().getModelCapabilities().setSupportsCeScenarioParams(true);this._DataProvider._getQueryModel().addOptimizerHint(r.ExecutionEngine.BW,r.InAConstants.QY_HINT_SCENARIO_NAME,this._ScenarioId);this._DataProvider._getQueryModel().addOptimizerHint(r.ExecutionEngine.BW,r.InAConstants.QY_HINT_SCENARIO_EXECUTION_ID,this._ScenarioExecutionID);this._DataProvider._getQueryManager().setResultSetTransportEnabled(false);e.setMaxRows(-1);e.setMaxColumns(-1);e.setMinRowsFetch(0);e.setMinColumnsFetch(0);break}}}});i.prototype.getDataProvider=function(){return this._DataProvider};i.prototype.execute=function(){this._setResultSetSettings();return new Promise((t,e)=>{this._DataProvider._FFDataProvider.getEventing().getListenerForResultDataFetch().addConsumer(e=>{if(e.getStep()===r.OlapDataProviderResultDataFetchStep.QUERY_EXECUTED){t(this._DataProvider.destroy())}});this._DataProvider._FFDataProvider.getEventing().getListenerForError().addConsumer(t=>{e(t.getErrors())});this._DataProvider._invalidateState();this._DataProvider.setAutoFetchEnabled(true)})};return i});
//# sourceMappingURL=Scenario.js.map