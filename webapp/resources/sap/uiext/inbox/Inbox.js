/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
jQuery.sap.declare("sap.uiext.inbox.Inbox");jQuery.sap.require("sap.uiext.inbox.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.uiext.inbox.Inbox",{metadata:{deprecated:true,library:"sap.uiext.inbox",properties:{taskExecutionURLThemeValue:{type:"string",group:"Misc",defaultValue:null},handleBindings:{type:"boolean",group:"Misc",defaultValue:true},openCompletedTasks:{type:"boolean",group:"Misc",defaultValue:false}},events:{oDataRequestCompleted:{},refresh:{},taskAction:{},taskSelectionChange:{}}}});jQuery.sap.require("sap.uiext.inbox.InboxConstants");jQuery.sap.require("sap.uiext.inbox.TCMMetadata");jQuery.sap.require("sap.uiext.inbox.tcm.TCMModel");jQuery.sap.require("sap.uiext.inbox.InboxLink");jQuery.sap.require("sap.uiext.inbox.InboxTaskCategoryFilterList");jQuery.sap.require("sap.uiext.inbox.TaskInitialFilters");jQuery.sap.require("sap.uiext.inbox.InboxUtils");jQuery.sap.require("sap.uiext.inbox.SubstitutionRulesManager");jQuery.sap.require("sap.uiext.inbox.InboxFilters");jQuery.sap.require("sap.uiext.inbox.controller.InboxControllerFactory");jQuery.sap.require("sap.uiext.inbox.InboxDataManager");jQuery.sap.require("sap.ui.core.format.DateFormat");jQuery.sap.require("sap.ui.core.ListItem");jQuery.sap.require("sap.ui.core.HTML");jQuery.sap.require("sap.ui.core.Locale");jQuery.sap.require("sap.ui.core.Icon");jQuery.sap.require("sap.ui.core.IconPool");jQuery.sap.require("sap.ui.commons.layout.MatrixLayout");jQuery.sap.require("sap.ui.commons.Image");jQuery.sap.require("sap.ui.commons.ToggleButton");jQuery.sap.require("sap.ui.commons.DropdownBox");jQuery.sap.require("sap.ui.commons.SearchField");jQuery.sap.require("sap.ui.commons.Toolbar");jQuery.sap.require("sap.ui.commons.TextView");jQuery.sap.require("sap.ui.commons.Label");jQuery.sap.require("sap.ui.commons.Button");jQuery.sap.require("sap.ui.commons.ToolbarSeparator");jQuery.sap.require("sap.ui.commons.Link");jQuery.sap.require("sap.ui.commons.TextField");jQuery.sap.require("sap.ui.commons.layout.BorderLayout");jQuery.sap.require("sap.ui.commons.layout.HorizontalLayout");jQuery.sap.require("sap.ui.commons.layout.VerticalLayout");jQuery.sap.require("sap.ui.commons.RadioButtonGroup");jQuery.sap.require("sap.ui.commons.Dialog");jQuery.sap.require("sap.uiext.inbox.InboxFormattedTextView");jQuery.sap.require("sap.uiext.inbox.InboxToggleTextView");jQuery.sap.require("sap.ui.ux3.FacetFilter");jQuery.sap.require("sap.ui.ux3.FacetFilterList");jQuery.sap.require("sap.ui.ux3.OverlayContainer");jQuery.sap.require("sap.ui.table.Table");jQuery.sap.require("sap.ui.model.Sorter");jQuery.sap.require("sap.ui.model.Filter");sap.uiext.inbox.Inbox.prototype.init=function(){this.oTcmMetadata=new sap.uiext.inbox.TCMMetadata;this.oTCMModel=new sap.uiext.inbox.tcm.TCMModel;this.inboxUtils=sap.uiext.inbox.InboxUtils;this.constants=sap.uiext.inbox.InboxConstants;this.oDataManager=sap.uiext.inbox.InboxDataManager;this.oCore=sap.ui.getCore();this._oBundle=this.oCore.getLibraryResourceBundle("sap.uiext.inbox");var e=sap.ui.getCore().getConfiguration().getTheme();this._imgResourcePath=sap.ui.resource("sap.uiext.inbox","themes/"+e+"/img/");var t=jQuery.sap.getUriParameters();var i=this.constants.defaultView_URLParameter;var a=t.get(i);if(a===null){var o=this.inboxUtils.getCookieValue(i);this.defaultView=o!==undefined?o:this.constants.tableView}else{this.defaultView=jQuery.inArray(a,this.constants.inboxViews)===-1?this.constants.tableView:a;this.inboxUtils.setCookieValue(i,this.defaultView,1)}var s={};s.bAsyncValue=t.get(this.constants.async_URLParameter)==="true"?true:false;this.oController=new sap.uiext.inbox.controller.InboxControllerFactory(s).getController();this.oController.setView(this);var r=t.get("sap-ui-inbox-clientUpdate");if(r){r=r.toLowerCase()}if(r&&r==="true"){this.clientUpdate=true}this.sProviderHost="";this.bRefreshTaskTypes=true;this.selectedContexts=[];this.sTypeOfModel="";this.bpmSvcUrl="";var n=this.constants.tableViewRowCount_URLParameter;this.tableViewRowCountValue=t.get(n);var l=this.constants.rrViewRowCount_URLParameter;this.rrViewRowCountValue=t.get(l);this.applyTaskCategoryFilter=false;this.isSubstitutionEnabled=false;this.isSubstitutionRuleCreationSupported=false;this.isCustomAttributesEnabled=false;this.isCustomActionsEnabled=false;this.showTaskDescription=false;this.showTaskCategory=true;this.isBatchOperationSupported=true;this.isForwardActionEnabled=false;this.isCommentsEnabled=false;this.bOpenTaskUIInNewTab=true;this.bUseBatch=false;this.bAllowCustomAttributeSort=true;this.bShowNoDueDateFilter=false;this.loggedInUserName;this.loggedInUserDisplayName;this._substitutionPath="";this.sCollectionPath="TaskCollection";this.filtersToApply={};this.filterState={};this.resetMessages=true;this.httpMethodForAction="POST";this.currentView=this.defaultView;this.bRefreshStartFlag=false;this.oPendingSearchRequest=undefined;this.getDefaultTaskExecutionURLCallBack=function(e,t){var i=this.sCollectionPath+"(InstanceID='"+e+"',SAP__Origin='"+t+"')/UIExecutionLink?$format=json";var a=this.bpmSvcUrl+i;var o="";var s=this.getCoreModel();var r=this;var n={async:false,requestUri:a,method:"GET",headers:{Accept:"application/json","x-csrf-token":s.oHeaders["x-csrf-token"]}};OData.request(n,function(e,t){o=e.GUI_Link},function(t){if(t.response.statusCode==205){var i={statusCode:t.response.statusCode,statusText:t.response.statusText};s.fireRequestFailed(i)}else{var a=r.inboxUtils.getErrorMessageFromODataErrorObject(t);r.showMessage("error",r._oBundle.getText("INBOX_MSG_ERR_EXUI")+" "+e+"; "+a)}});if(o.search("HRMSS_LR_APPR_G")!=-1){var l=sap.ui.getCore().getConfiguration().getLanguage();o=o+"&sap-language="+l}return o};this.getTaskExecURLStatusCallBack=function(e,t){var i="";var a=this.bpmSvcUrl+this.sCollectionPath+"(InstanceID='"+e+"',SAP__Origin='"+t+"')?$format=json";var o=this.getCoreModel();var s=this;var r={async:false,requestUri:a,method:"GET",headers:{Accept:"application/json","x-csrf-token":o.oHeaders["x-csrf-token"]}};OData.request(r,function(e,t){i=e.Status},function(t){if(t.response.statusCode==205){var i={statusCode:t.response.statusCode,statusText:t.response.statusText};o.fireRequestFailed(i)}else{s.showMessage("error",s._oBundle.getText("INBOX_MSG_ERR_EXUI")+" "+e)}});return i};this.searchCallBack="";this.dynamicTaskTypeFilterCallBack="";this.getTaskExecutionURLCallBack=this.getDefaultTaskExecutionURLCallBack;this.lastRefreshedOnDateTime=new Date;this.vLayout=this.createInboxUI();this.vLayout.setParent(this);this.addAndRemoveSubstDropDowns();this.constants=sap.uiext.inbox.InboxConstants;this.lastRefreshedOnDateTime=new Date;this.bCustomAttributesVisible=false};sap.uiext.inbox.Inbox.prototype.exit=function(){this.vLayout.destroy();this.vLayout=null;function e(e){var t=sap.ui.getCore().byId(e);t&&t.destroy()}e(this.getId()+"--"+"dropdownCell1");e(this.getId()+"--"+"dropdownCell2");e(this.getId()+"--"+"dropdownCell3");e(this.getId()+"--"+"manageSubstitutionMI");e(this.getId()+"--"+"rrMainMatrixLayout");e(this.getId()+"--"+"separatorRRViewCell");if(this.oCustomActionToolPopup){e(this.oCustomActionToolPopup.getId())}if(this.oCustomActionToolPopupCommentsMand){e(this.oCustomActionToolPopupCommentsMand.getId())}this._oBundle=undefined;delete this.oCustomActionToolPopup;delete this.oCustomActionToolPopupCommentsMand};sap.uiext.inbox.Inbox.prototype.createAttributes=function(e,t){var i=this;if(e.name==="INBOX_FILTER_CATEGORY"){var a=new sap.uiext.inbox.InboxTaskCategoryFilterList(this.getId()+"--"+e.name);a.setSelectedKeys(["INBOX_FILTER_CATEGORY_TASKS"])}else{var a=new sap.ui.ux3.FacetFilterList(this.getId()+"--"+e.name)}a.setTitle(this._oBundle.getText(e.name));for(var o=0;o<e.attributes.length;o++){if(typeof e.attributes[o]=="string"||e.attributes[o].key!=undefined){var s;var r;if(e.attributes[o].key!=undefined){var n=e.attributes[o];s=i.inboxUtils.scrub(n.key);r=new sap.ui.core.ListItem(this.getId()+"--"+s,{text:e.attributes[o].value,key:e.attributes[o].key});if(n.sap__Origin){r.data("SAP__Origin",n.sap__Origin)}if(n.instanceID){r.data("InstanceID",n.instanceID)}}else{s=i.inboxUtils.scrub(e.attributes[o]);r=new sap.ui.core.ListItem(this.getId()+"--"+s,{text:this._oBundle.getText(e.attributes[o]),key:s})}a.addItem(r)}else{i.createAttributes(e.attributes[o],a)}}t.addList(a)};sap.uiext.inbox.Inbox.prototype.toggleFilterView=function(e,t){var i=t;var a=sap.ui.getCore().byId(i.getId()+"--"+"filterFacet");i.showBusyLoader();if(a===undefined){a=new sap.ui.ux3.FacetFilter(i.getId()+"--"+"filterFacet");var o=i.applyTaskCategoryFilter?i.constants.aDrillDownFilterMetadata:i.bShowNoDueDateFilter?i.constants.aFilterMetaDataWithNoDueDate:i.constants.aFilterMetaData;for(var s=0;s<o.length;s++){i.createAttributes(o[s],a)}var r=sap.ui.getCore().byId(i.getId()+"--"+"verticalLayoutContainer");r.insertContent(a,1);var n=a.getLists();for(var l=0;l<n.length;l++){if(n[l].getId()===i.getId()+"--"+"INBOX_FILTER_PRIORITY"){n[l].attachSelect(i,i.applyDrillDownFilterForPriority)}else if(n[l].getId()===i.getId()+"--"+"INBOX_FILTER_STATUS"){n[l].attachSelect(i,i.applyDrillDownFilterForStatus)}else if(n[l].getId()===i.getId()+"--"+"INBOX_FILTER_CREATION_DATE"){n[l].setMultiSelect(false);n[l].attachSelect(i,i.applyDrillDownFilterForDateTime)}else if(n[l].getId()===i.getId()+"--"+"INBOX_FILTER_TASK_TYPE"){n[l].attachSelect(i,i.applyDrillDownFilterForTaskType)}else if(n[l].getId()===i.getId()+"--"+"INBOX_FILTER_DUE_DATETIME"){n[l].setMultiSelect(false);n[l].attachSelect(i,i.applyDrillDownFilterForDueDate)}else if(n[l].getId()===i.getId()+"--"+"INBOX_FILTER_CATEGORY"){n[l].setMultiSelect(false);n[l].attachSelect(i,i.applyDrillDownFilterForTaskCategory)}}}var u=sap.ui.getCore().byId(i.getId()+"--"+"INBOX_FILTER_STATUS");if(sap.ui.getCore().byId(i.getId()+"--"+"filterComboBox2").getSelectedItemId()===i.getId()+"--"+"li_completedTasks"){if(u!=undefined){a.removeList(u)}if(d!==undefined){a.removeList(d)}}var d=sap.ui.getCore().byId(i.getId()+"--"+"INBOX_FILTER_CREATION_DATE");var p=sap.ui.getCore().byId(i.getId()+"--"+"INBOX_FILTER_DUE_DATETIME");var c=sap.ui.getCore().byId(i.getId()+"--"+"filterComboBox2").getSelectedItemId();if(c===i.getId()+"--"+"li_overdueTasks"||c===i.getId()+"--"+"li_escalatedTasks"){if(d!==undefined&&a.indexOfList(d)!==-1){a.removeList(d)}if(p!==undefined&&a.indexOfList(p)!==-1){a.removeList(p)}}var g=i._getComponent("filterViewButton");a.setVisible(g.getPressed());i.hideBusyLoader()};sap.uiext.inbox.Inbox.prototype.populateFilterButtonContainer=function(e){var t=new sap.ui.commons.layout.MatrixLayoutCell({id:this.getId()+"--"+"filterButtonCell"});var i=false;var a=new sap.ui.commons.ToggleButton(this.getId()+"--"+"filterViewButton",{icon:sap.uiext.inbox.InboxConstants.filterViewImage,pressed:false,tooltip:this._oBundle.getText("INBOX_BUTTON_FILTER_VIEW_TOOLTIP")});a.attachPress(this,this.toggleFilterView);a.addStyleClass("sapUiExtInboxToolBarContainerHeight");t.addContent(a);t.setPadding(sap.ui.commons.layout.Padding.None);e.createRow(t)};sap.uiext.inbox.Inbox.prototype.addAndRemoveSubstDropDowns=function(){var e=sap.ui.getCore().byId(this.getId()+"--"+"dropdownRow");var t=sap.ui.getCore().byId(this.getId()+"--"+"dropdownCell1");var i=sap.ui.getCore().byId(this.getId()+"--"+"dropdownCell2");var a=sap.ui.getCore().byId(this.getId()+"--"+"dropdownCell3");var o=sap.ui.getCore().byId(this.getId()+"--"+"manageSubstitutionMI");var s=sap.ui.getCore().byId(this.getId()+"--"+"rrManageSubstitutionMI");if(this.getSubstitutionEnabled()){e.addCell(t);e.addCell(i);e.addCell(a)}else{if(e!=undefined){e.removeCell(t);e.removeCell(a)}}var r=sap.ui.getCore().byId(this.getId()+"--"+"rrSettingsButton");var n=sap.ui.getCore().byId(this.getId()+"--"+"settingsButton");this._manageVisibilityOfSettingsButton(r);this._manageVisibilityOfSettingsButton(n)};sap.uiext.inbox.Inbox.prototype.populateDropDownContainer=function(e){var t=new sap.ui.commons.layout.MatrixLayoutRow(this.getId()+"--"+"dropdownRow");var i=new sap.ui.commons.layout.MatrixLayoutCell(this.getId()+"--"+"dropdownCell1");i.setPadding(sap.ui.commons.layout.Padding.None);var a=new sap.ui.commons.DropdownBox(this.getId()+"--"+"filterComboBox1",{tooltip:this._oBundle.getText("INBOX_TASKS_FILTER_DROPDOWN_TOOLTIP"),items:[new sap.ui.core.ListItem(this.getId()+"--"+"li_allTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ALL_TASKS")}),new sap.ui.core.ListItem(this.getId()+"--"+"li_myTasks",{text:this._oBundle.getText("INBOX_MY_TASKS_TEXT")}),new sap.ui.core.ListItem(this.getId()+"--"+"li_substitutedTasks",{text:this._oBundle.getText("SUBSTITUTION_INBOX_DROP_DOWN_VALUE_TASKS_ASSIGNED_TO_ME")})]});a.attachChange(this,this.applyDropDownFilter1);a.setValue(this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ALL_TASKS"));a.addStyleClass("sapUiExtInboxToolBarContainerHeight");a.addStyleClass("sapUiExtInboxComboBox");i.addContent(a);t.addCell(i);var o=new sap.ui.commons.layout.MatrixLayoutCell(this.getId()+"--"+"dropdownCell2");o.setPadding(sap.ui.commons.layout.Padding.None);var s=new sap.ui.commons.DropdownBox(this.getId()+"--"+"filterComboBox2",{tooltip:this._oBundle.getText("INBOX_TASKS_FILTER_DROPDOWN_TOOLTIP"),items:[new sap.ui.core.ListItem(this.getId()+"--"+"li_openTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_OPEN_TASKS")}),new sap.ui.core.ListItem(this.getId()+"--"+"li_completedTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_COMPLETED_TASKS")}),new sap.ui.core.ListItem(this.getId()+"--"+"li_overdueTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_OVERDUE_TASKS")}),new sap.ui.core.ListItem(this.getId()+"--"+"li_escalatedTasks",{text:this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ESCALATED_TASKS")})]});s.attachChange(this,this.applyDropDownFilter);s.setValue(this._oBundle.getText("INBOX_DROP_DOWN_VALUE_OPEN_TASKS"));s.addStyleClass("sapUiExtInboxToolBarContainerHeight");s.addStyleClass("sapUiExtInboxComboBox");o.addContent(s);t.addCell(o);var r=new sap.ui.commons.layout.MatrixLayoutCell(this.getId()+"--"+"dropdownCell3");r.setPadding(sap.ui.commons.layout.Padding.None);var n=new sap.ui.commons.DropdownBox(this.getId()+"--"+"filterComboBox3",{maxPopupItems:10});var l="";if(sap.ui.getCore().byId(this.getId()+"--"+"onBehalfOfListItem")===undefined){var l=new sap.ui.core.ListItem(this.getId()+"--"+"onBehalfOfListItem")}l.setText(this._oBundle.getText("SUBSTITUTION_INBOX_FILTER_ON_BEHALF_OF"));l.setKey("onBehalfOf");n.addItem(l);var u="";if(sap.ui.getCore().byId(this.getId()+"--"+"li_allUsers")===undefined){u=new sap.ui.core.ListItem(this.getId()+"--"+"li_allUsers")}u.setText(this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ALL_USERS"));u.setKey("allUsers");n.addItem(u);n.attachChange(this,this.applyDropDownFilter3);n.setValue(this._oBundle.getText("SUBSTITUTION_INBOX_FILTER_ON_BEHALF_OF"));n.addStyleClass("sapUiExtInboxToolBarContainerHeight");n.addStyleClass("sapUiExtInboxComboBox");n.setEnabled(false);r.addContent(n);t.addCell(r);e.addRow(t);this.addAndRemoveSubstDropDowns()};sap.uiext.inbox.Inbox.prototype.populateSearchFieldContainer=function(e){var t=new sap.ui.commons.layout.MatrixLayoutCell(this.getId()+"--"+"searchBoxCell");t.setPadding(sap.ui.commons.layout.Padding.None);var i=new sap.ui.commons.SearchField(this.getId()+"--"+"searchField",{enableListSuggest:false,enableClear:true,startSuggestion:0,tooltip:this._oBundle.getText("INBOX_SEARCH_TEXT")});i.addStyleClass("sapUiExtInboxSearchField");i.attachSuggest(this,function(e,t){if(e.getParameter("value")===""){t.resetSearchCriteria();t.applyFilterOnResponse(null)}});i.attachSearch(this,this.localSearch);t.addContent(i);e.createRow(t)};sap.uiext.inbox.Inbox.prototype.populateNotificationBar=function(){var e=new sap.ui.ux3.NotificationBar({id:this.getId()+"--"+"notificationBar",visibleStatus:"None"});var t=new sap.ui.ux3.Notifier({id:this.getId()+"--"+"messageNotifier",title:this._oBundle.getText("INBOX_NOTIFICATIONS"),messageSelected:function e(t){}});e.setMessageNotifier(t);e.addStyleClass("sapUiExtInboxNotificationBar");return e};sap.uiext.inbox.Inbox.prototype.populateToolBar=function(){var e=new sap.ui.commons.layout.MatrixLayout(this.getId()+"--"+"toolbarContainer",{layoutFixed:false,width:"100%",columns:6,widths:["1px","1px","1px","1px","100%","1px"]});var t=new sap.ui.commons.layout.MatrixLayout(this.getId()+"--"+"viewButtonsContainer",{layoutFixed:false});var i=new sap.ui.commons.layout.MatrixLayout(this.getId()+"--"+"filterButtonContainer",{layoutFixed:false});var a=new sap.ui.commons.layout.MatrixLayout(this.getId()+"--"+"refreshButtonContainer",{layoutFixed:false});var o=new sap.ui.commons.layout.MatrixLayout(this.getId()+"--"+"dropDownContainer",{layoutFixed:false});var s=new sap.ui.commons.Label(this.getId()+"--"+"emptyLabel",{text:""});var r=new sap.ui.commons.layout.MatrixLayout(this.getId()+"--"+"searchFieldContainer",{layoutFixed:false});e.createRow(t,o,i,a,s,r);this.populateViewButtonsContainer(t);this.populateDropDownContainer(o);this.populateFilterButtonContainer(i);this.populateRefreshButtonContainer(a);this.populateSearchFieldContainer(r);return e};sap.uiext.inbox.Inbox.prototype.populateViews=function(){var e=this;var t=sap.ui.getCore().byId(this.getId()+"--"+"verticalLayoutContainer");var i=new sap.ui.commons.Toolbar(this.getId()+"--"+"actionButtonsToolbarContainer");i.setDesign(sap.ui.commons.ToolbarDesign.Standard);i.addStyleClass("sapUiExtInboxActionButtonsToolbarContainer");if(sap.ui.getCore().byId(this.getId()+"--"+"openActionButton")===undefined){var a=new sap.ui.commons.Button(this.getId()+"--"+"openActionButton",{icon:this.constants.iconPool.getIconURI("open-folder"),text:this._oBundle.getText("INBOX_ACTION_BUTTON_OPEN"),enabled:false,tooltip:this._oBundle.getText("INBOX_ACTION_BUTTON_OPEN")});a.attachPress(this,function(t,i){e.showBusyLoader();e.populateTaskExecutionContent();e.hideBusyLoader()});i.addItem(a)}if(sap.ui.getCore().byId(this.getId()+"--"+"claimActionButton")===undefined){var o=new sap.ui.commons.Button(this.getId()+"--"+"claimActionButton",{icon:this.constants.iconPool.getIconURI("locked"),text:this._oBundle.getText("INBOX_ACTION_BUTTON_CLAIM"),enabled:false,tooltip:this._oBundle.getText("INBOX_ACTION_BUTTON_CLAIM"),visible:false});o.attachPress({inbox:e,view:e.constants.tableView,action:"Claim"},e.executeActionOnTask);o.setVisible(false);i.addItem(o)}if(sap.ui.getCore().byId(this.getId()+"--"+"releaseActionButton")===undefined){var s=new sap.ui.commons.Button(this.getId()+"--"+"releaseActionButton",{icon:this.constants.iconPool.getIconURI("unlocked"),text:this._oBundle.getText("INBOX_ACTION_BUTTON_RELEASE"),enabled:false,tooltip:this._oBundle.getText("INBOX_ACTION_BUTTON_RELEASE"),visible:false});s.attachPress({inbox:e,view:e.constants.tableView,action:"Release"},e.executeActionOnTask);s.setVisible(false);i.addItem(s)}if(sap.ui.getCore().byId(this.getId()+"--"+"forwardActionButton")===undefined){var r=new sap.ui.commons.Button(this.getId()+"--"+"forwardActionButton",{icon:this.constants.iconPool.getIconURI("open-command-field"),text:this._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD"),enabled:false,tooltip:this._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD"),visible:false});r.attachPress({inbox:e,view:e.constants.tableView,action:"Forward"},e._executeForwardAction);i.addItem(r)}if(sap.ui.getCore().byId(this.getId()+"--"+"settingsButton")===undefined){var n=new sap.ui.commons.Button(this.getId()+"--"+"settingsButton",{tooltip:this._oBundle.getText("INBOX_MANAGE_SUBSTITUTION_RULES_TOOLTIP"),icon:this.constants.iconPool.getIconURI("workflow-tasks"),iconHovered:this._imgResourcePath+sap.uiext.inbox.InboxConstants.settingsImageHover,iconSelected:this._imgResourcePath+sap.uiext.inbox.InboxConstants.settingsImageHover,lite:true});n.addStyleClass("sapUiExtInboxToolbarRight");n.addStyleClass("sapUiExtInboxSettingsButton");n.attachPress(e,e.onSubstitutionButtonPress);i.addItem(n)}t.addContent(i);if(e._getComponent("listViewTable")===undefined){var l=new sap.ui.table.Table(e.getId()+"--"+"listViewTable",{});l.attachFilter(function(t){t.preventDefault();var i=t.getParameter("column");var a=t.getParameter("value");e._applyFilterOnTableColumns(i,a);e._preserveTableSort()});l.setThreshold(1e4);l.addStyleClass("sapUiExtInboxCustomTable");l.setEditable(false);l.bDynamic=true;l.setBusyIndicatorDelay(0);var u=e._getCategoryMetadata();var d=u.properties.length;for(var p=0;p<d;p++){e._createTableColumnContent(p,u)}e.bSorted=false;l.attachSort(function(t){var i=t.getParameter("column");if(e._isCustomAttribute(i)){t.preventDefault();var a=i.data("customAttrName");var o=null;var s=null;var r=e.constants;var n=r.oTaskDefinitionCustomAttributesMap;var l=e._getComponent("INBOX_FILTER_TASK_TYPE");var u=l.getSelectedKeys();if(u){var d=u[0];var p=n[d];if(p){for(var c=0;c<p.length;c++){var g=p[c];if(g.Name==a){var o=g.Type;break}}}}if(o){s=t.getParameter("sortOrder")}e._applySortOnTableColumn(i,a,o,s)}else{var f=e._currentViewElement();if(f._originalKeys){var h=f.getBinding("rows");h.iLength=f._originalKeys.length}e.bSorted=true;e.resetSearchCriteria()}});l.attachRowSelectionChange(function(t){e._handleTableRowSelect(t)});l.clearSelection()}if(jQuery.sap.getUriParameters().get("inbox-width-limit")){if(!l.__iTableInboxSizeLimit){setTimeout(function(){l.__iTableInboxSizeLimit=l.$().width();l._ibx_orig_afterrendering=l.onAfterRendering;l.onAfterRendering=function(){this.$().css("max-width",this.__iTableInboxSizeLimit+"px");return this._ibx_orig_afterrendering.apply(this,arguments)};l.invalidate()},1e3)}}t.addContent(l);t.addContent(e.createTableRowSettingsContent());e.createRowRepeaterView()};sap.uiext.inbox.Inbox.prototype.addAction=function(e,t,i,a,o){var s=4;if(o===undefined){o=true}if(e&&t&&a&&i){var r=this._getActionButtonToolBarForTableView();var n=new sap.ui.commons.Button(this.getId()+"--"+e,{text:t,enabled:true,tooltip:i}).attachPress(a);r.insertItem(n,100)}else{if(arguments.length<s){console.error("Add Action failed: missing parameters")}}return this};sap.uiext.inbox.Inbox.prototype._handleTableRowSelect=function(e){var t=this.getCoreModel();var i=this;var a=[],o=[];var s=[];var r=[];var n=this._getComponent("listViewTable");var l=n.getSelectedIndices();var u=e.getParameters();var d={aSupportsClaim:[],aSupportsRelease:[],aSupportsForward:[]};jQuery.each(l,function(e,l){var u=n.getContextByIndex(l);a.push(t.getProperty("Status",u));var p=t.getProperty(i.constants.TaskDefinitionCollection.properties.taskDefnID,u);var c=t.getProperty(i.constants.sapOrigin,u);if(jQuery.inArray(p,s)===-1){s.push(t.getProperty(i.constants.TaskDefinitionCollection.properties.taskDefnID,u))}if(jQuery.inArray(c,o)===-1){o.push(c)}r.push(t.getProperty(i.constants.InstanceID,u));d.aSupportsClaim.push(t.getProperty("SupportsClaim",u));d.aSupportsRelease.push(t.getProperty("SupportsRelease",u));if(i.isForwardActionEnabled){d.aSupportsForward.push(t.getProperty("SupportsForward",u))}});this.disableActionButtonsOnMultiStatus(a,d,o);if(this.isCustomActionsEnabled){this._deleteCustomActionsForTableView();var p=this._isCompletedTasksSelected();if(s&&s.length===1&&!p){this._createCustomActionsOnTableRowSelect(r,o)}}this._handleForwardButtonVisibilityOnRowSelection(o,d);var c=[];jQuery.each(l,function(e,a){var o=n.getContextByIndex(a);var s=t.getProperty(i.constants.InstanceID,o);var r=t.getProperty(i.constants.sapOrigin,o);var l={};l["InstanceID"]=s;l["SAP__Origin"]=r;c.push(l)});this.fireTaskSelectionChange({taskUniqueIdentifiers:c})};sap.uiext.inbox.Inbox.prototype._createCustomActionsOnTableRowSelect=function(e,t){this._getCustomActionsDefinitionOnMultiSelect(e,t[0])};sap.uiext.inbox.Inbox.prototype._getCustomActionsDefinitionOnMultiSelect=function(e,t){var i=sap.uiext.inbox.InboxConstants.taskInstanceDecisionOptionsMap;var a=e.length;var o=[],s,r=[];for(var n=0;n<a;n++){s=i[e[n]];if(s){o.push(s)}else{r.push(e[n])}}var l=r.length;if(l<=1){this._getCustomActionsDefinition(r[0],t,o)}else{this._fetchCustomActionsOnMultiSelect(o,r,t)}};sap.uiext.inbox.Inbox.prototype._fetchCustomActionsOnMultiSelect=function(e,t,i){if(this.bUseBatch){this._fetchCustomActionsUsingBatch(e,t,i)}else{this._fetchCustomActionsUsingAsyncCall(t,i,e)}};sap.uiext.inbox.Inbox.prototype._fetchCustomActionsUsingBatch=function(e,t,i){var a=[];jQuery.each(t,function(e,t){var o={};o.InstanceID="'"+t+"'";o.SAP__Origin="'"+i+"'";a.push(o)});this.oDataManager.fireBatchRequest({sPath:this.constants.decisionOptionsFunctionImport,sMethod:"GET",sBatchGroupId:"fetchDecisionOptions",aUrlParameters:a,numberOfRequests:t.length,fnSuccess:jQuery.proxy(this._processCustomActionsBatchResponse,{oInbox:this,aAvailableCustomActionArrayList:e,aFetchCustomActionsFor:t}),fnError:jQuery.proxy(this._handleErrorOnBatchRequests,this)})};sap.uiext.inbox.Inbox.prototype._processCustomActionsBatchResponse=function(e,t){var i=e.__batchResponses;var a=0;jQuery.each(i,jQuery.proxy(function(e,t){if(t&&t.statusCode&&t.statusCode==200){this.oInbox.constants.taskInstanceDecisionOptionsMap[this.aFetchCustomActionsFor[a++]]=t.data.results;this.aAvailableCustomActionArrayList.push(t.data.results)}},this));this.oInbox._displayCustomActions([],this.aAvailableCustomActionArrayList)};sap.uiext.inbox.Inbox.prototype._createTableColumnContent=function(e,t){var i=this;var a=this._getComponent("listViewTable");if(t.properties[e]=="TaskTitle"){var o=i._getFirstColumnContentTemplate();var s=i._createTableColumn(e,t,"INBOX_TASK_TITLE_TOOLTIP",o);s.setWidth("330px");s.setFlexible(false);a.insertColumn(s,e)}else if(t.properties[e]=="CreatedOn"){var r=new sap.ui.commons.TextView({text:{formatter:i.inboxUtils.dateTimeFormat,path:t.properties[e]}});r.bindProperty("tooltip",t.properties[e],i.tooltipFormatForDateTime);var n=i._createTableColumn(e,t,"INBOX_START_DATE_TOOLTIP",r);n.setFlexible(true);a.insertColumn(n,e)}else if(t.properties[e]=="CreatedByName"){var l=new sap.ui.commons.TextView({text:{path:t.properties[e]}});l.bindProperty("tooltip",t.properties[e]);var u=i._createTableColumn(e,t,"INBOX_CREATED_BY_NAME_TOOLTIP",l);u.setFlexible(true);a.insertColumn(u,e)}else if(t.properties[e]=="CompletionDeadLine"){var d=new sap.ui.commons.TextView({text:{formatter:i.inboxUtils.dateTimeFormat,path:t.properties[e]}});d.bindProperty("tooltip",t.properties[e],i.tooltipFormatForDateTime);var p=i._createTableColumn(e,t,"INBOX_DUE_DATE_TOOLTIP",d);p.setFlexible(true);a.insertColumn(p,e)}else if(t.properties[e]=="Status"){var c=new sap.ui.commons.TextView;c.bindText({parts:[{path:"Status",type:new sap.ui.model.type.String},{path:"StatusText",type:new sap.ui.model.type.String}],formatter:function(e,t){return i._getTaskStatus(e,t)},useRawValues:true});var g=i._createTableColumn(e,t,"INBOX_STATUS_TOOLTIP",c);g.setFlexible(true);a.insertColumn(g,e)}else if(t.properties[e]=="Priority"){var f=new sap.ui.commons.TextView;f.bindProperty("text","Priority",function(e){if(e!=null&&e!=""&&e!=undefined){return i._oBundle.getText(i.constants.prioTooltip[e])}return""});var h=i._createTableColumn(e,t,"INBOX_PRIORITY_TOOLTIP",f);h.setFlexible(true);a.insertColumn(h,e)}};sap.uiext.inbox.Inbox.prototype._createTableColumn=function(e,t,i,a){var o=t.properties[e];var s=new sap.ui.table.Column({id:this.getId()+"--"+o}).setLabel(new sap.ui.commons.Label({text:this._oBundle.getText(t.propertiesLabel[e]),tooltip:this._oBundle.getText(i),design:sap.ui.commons.LabelDesign.Bold})).setTemplate(a).setSortProperty(o).data("ColumnType","StandardAttribute");var r=this.constants.TABLE_VIEW_TECH_NAMES;if(o!==r.INBOX_TABLE_VIEW_STATUS&&o!==r.INBOX_TABLE_VIEW_PRIORITY)s.setFilterProperty(o);return s};sap.uiext.inbox.Inbox.prototype.createTableRowSettingsContent=function(){var e=this;var t=new sap.ui.commons.layout.MatrixLayout(e.getId()+"--"+"tableRowSettingLayoutContainer");var i=new sap.ui.commons.SegmentedButton({id:e.getId()+"--"+"tableRowSettingsSegBtn",buttons:[new sap.ui.commons.Button({id:e.getId()+"--"+"table10RowsSegBtn",lite:true,text:"10",tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_TEN")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent"),new sap.ui.commons.Button({id:e.getId()+"--"+"table25RowsSegBtn",lite:true,text:"25",tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_TWENTYFIVE")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent"),new sap.ui.commons.Button({id:e.getId()+"--"+"table50RowsSegBtn",lite:true,text:"50",tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_FIFTY")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent")]});i.attachSelect(function(t){var i=parseInt(sap.ui.getCore().byId(t.getParameters().selectedButtonId).getText());var a=this.getButtons();var o=t.getParameters().selectedButtonId;for(var s=0;s<a.length;s++){var r=a[s];if(o!==r.getId()){r.addStyleClass("sapUiExtInboxSegmentedButtonTransparent");r.removeStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}else{r.removeStyleClass("sapUiExtInboxSegmentedButtonTransparent");r.addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}}e.setNoOfRowsOnTable(i)});if(e.tableViewRowCountValue!=null&&e.tableViewRowCountValue!=undefined){if(parseInt(e.tableViewRowCountValue)===10||parseInt(e.tableViewRowCountValue)===25||parseInt(e.tableViewRowCountValue)===50){i.fireSelect({selectedButtonId:e.getId()+"--"+"table"+parseInt(e.tableViewRowCountValue)+"RowsSegBtn"});i.setSelectedButton(e.getId()+"--"+"table"+parseInt(e.tableViewRowCountValue)+"RowsSegBtn");sap.ui.getCore().byId(i.getSelectedButton()).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}else{e.setNoOfRowsOnTable(parseInt(e.tableViewRowCountValue))}}else{i.setSelectedButton(e.getId()+"--"+"table10RowsSegBtn");sap.ui.getCore().byId(i.getSelectedButton()).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}var a=new sap.ui.commons.layout.BorderLayout(e.getId()+"--"+"tableBorderLayout",{width:"100%",height:"40px"});a.createArea(sap.ui.commons.layout.BorderLayoutAreaTypes.end,i);a.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.end,{size:"45%",contentAlign:"right",visible:true});t.createRow(new sap.ui.commons.TextView({text:" "}));t.createRow(a);return t};sap.uiext.inbox.Inbox.prototype.createRowRepeaterView=function(){var e=this;var t=sap.ui.getCore().byId(e.getId()+"--"+"verticalLayoutContainer");var i=sap.ui.getCore().byId(e.getId()+"--"+"tasksRowRepeater");if(!i){var a=new sap.ui.commons.layout.MatrixLayout({id:e.getId()+"--"+"rrMainMatrixLayout",layoutFixed:true,columns:3,width:"100%",widths:["9%","73%","18%"]});var o=new sap.ui.commons.layout.MatrixLayoutRow({id:e.getId()+"--"+"rrFirstRow"});a.addRow(o);var s=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"taskInitiatorImageCell",rowSpan:2,colSpan:1,hAlign:sap.ui.commons.layout.HAlign.Center,vAlign:sap.ui.commons.layout.VAlign.Middle});s.addStyleClass("sapUiExtInboxRRFirstRowStyle");var r=new sap.ui.commons.Image(e.getId()+"--"+"taskInitiatorImg");r.setWidth("52px");r.setHeight("52px");r.addStyleClass("sapUiExtInboxRowRepTaskInitiatorColor");r.bindProperty("tooltip","CreatedByName");r.bindProperty("src","CreatedBy",function(t){var i=this.getBindingContext();if(t){return e.inboxUtils.getUserMediaResourceURL(e.bpmSvcUrl,i.getProperty("SAP__Origin"),i.getProperty("CreatedBy"))}else{this.setVisible(false)}});s.addContent(r);var n=e._getComponent("taskInitiatorIcn");if(!n){n=new sap.ui.core.Icon({id:e.getId()+"--"+"taskInitiatorIcn",decorative:false,src:{parts:this.oController.getTaskInitiatorIconParts(e),formatter:this.oController.getTaskInitiatorIconFormatter(e)}})}n.setSize("52px").addStyleClass("sapUiExtInboxRowRepTaskInitiatorColor").bindProperty("tooltip","CreatedByName");s.addContent(n);o.addCell(s);var l=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"taskTitleCell",padding:sap.ui.commons.layout.Padding.Bottom});l.addStyleClass("sapUiExtInboxRRFirstRowStyle");var u=new sap.uiext.inbox.InboxLink(e.getId()+"--"+"rrViewTaskTitle");u.addStyleClass("sapUiExtInboxfontBold");u.addDelegate({onAfterRendering:function(){if(this.data("overDue")===true){this.addStyleClass("sapUiExtInboxRedColor")}}});u.bindProperty("text","TaskTitle",function(e){if(this.getBindingContext()===undefined)return undefined;else return e});u.bindProperty("overdue","CompletionDeadLine",function(t){return e._isOverDue(t)});u.bindProperty("tooltip","TaskTitle");u.bindProperty("enabled","Status",function(t){if(t==="COMMITTED"){this.addStyleClass("sapUiExtInboxLnkDsbl");return false}else if(e.getOpenCompletedTasks()===false&&t=="COMPLETED"){this.addStyleClass("sapUiExtInboxLnkDsbl");return false}this.removeStyleClass("sapUiExtInboxLnkDsbl");return true});u.attachPress(this,function(t,i){e.showBusyLoader();var a=t.getSource().getParent();var o=t.getSource().getBindingContext();var s=e.getCoreModel();var r=t.getSource().getParent().getParent().getParent();var n=[];var l=[];var u=[];var d=[];l.push(s.getProperty("InstanceID",o));u.push(s.getProperty("TaskTitle",o));d.push(s.getProperty("SAP__Origin",o));if(e.getTaskExecutionURLCallBack!=""&&e.getTaskExecutionURLCallBack!=undefined&&e.getTaskExecutionURLCallBack!==null){var p=e.getTaskExecutionURLCallBack(l[0],d[0]);if(p!==null&&p.replace(/\s/g,"").length>0){n.push(p)}}else{n.push("")}var c=t.getParameter("windowEvent");if(!c.ctrlKey&&!(c.button==1)&&!c.shiftKey&&!e.bOpenTaskUIInNewTab){i.populateTaskExecutionContent({aSelectedContexts:[o],arrayURLs:n,arrayIDs:l,arrayTitles:u,aTaskSAPOrigins:d,oRow:r});e.hideBusyLoader()}else{e.hideBusyLoader();var p=n[0];if(p!==null&&p.replace(/\s/g,"").length>0){sap.ui.require(["sap/ui/util/openWindow"],function(e){var t=e(p);if(t){t.focus()}});t.preventDefault()}}});l.addContent(u);o.addCell(l);var d=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"createdOnCell",padding:sap.ui.commons.layout.Padding.Both,hAlign:sap.ui.commons.layout.HAlign.End});d.addStyleClass("sapUiExtInboxRRFirstRowStyle");d.addStyleClass("sapUiExtInboxRRPaddingRight");var p=new sap.ui.commons.TextView(e.getId()+"--"+"rrViewCreatedOnDate");p.addStyleClass("sapUIExtInboxRRTextColourStyle");p.bindProperty("tooltip","CreatedOn",e.tooltipFormatForDateTime);p.bindProperty("text","CreatedOn",function(t){if(t!==null&&t!==""){return e.inboxUtils.dateTimeFormat(t)}});d.addContent(p);o.addCell(d);var c=new sap.ui.commons.layout.MatrixLayoutRow({id:e.getId()+"--"+"secondRow"});a.addRow(c);var g=new sap.ui.commons.layout.MatrixLayout({id:e.getId()+"--"+"taskDescriptnMatxLyt",layoutFixed:false});var f=new sap.uiext.inbox.InboxFormattedTextView({htmlText:{parts:this.oController.getTaskDetailsParts(),formatter:this.oController.getTaskDetailsFormatter(e)},maxLines:1});var h=new sap.uiext.inbox.InboxToggleTextView({showMore:{parts:this.oController.getExpandTaskDescriptionLinkParts(),formatter:this.oController.getExpandTaskDescriptionLinkFormatter(e)}}).setFTV(f).attachShowMoreClick(function(t){var i=this.getAggregation("fTV");if(t.getParameter("text")===e._oBundle.getText("INBOX_SHOW_MORE_TEXT")){i.setHtmlText(i.data("showMore"));i.removeClamp();i.data("clamped","false")}else{i.setMaxLines(1);i.setHtmlText(i.data("showLess"))}});var I=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"taskDesCell",hAlign:sap.ui.commons.layout.HAlign.Left,colSpan:1});I.addContent(h);g.createRow(I);var m=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"taskDescriptionCell",padding:sap.ui.commons.layout.Padding.None,colSpan:1});m.addContent(g);c.addCell(m);var b=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"statusCell",padding:sap.ui.commons.layout.Padding.End,hAlign:sap.ui.commons.layout.HAlign.End,vAlign:sap.ui.commons.layout.VAlign.Top});b.addStyleClass("sapUiExtInboxRRPaddingRight");var x=new sap.ui.commons.TextView(e.getId()+"--"+"rrViewStatus");x.addStyleClass("sapUIExtInboxRRTextColourStyle");x.bindProperty("text","Status",function(t){var i=e.getModel();var a=i.getProperty(sap.uiext.inbox.InboxConstants.PROPERTY_NAME_CUSTOM_STATUS,this.getBindingContext(),false);return e._getTaskStatus(t,a)});b.addContent(x);c.addCell(b);var y=new sap.ui.commons.layout.MatrixLayoutRow({id:e.getId()+"--"+"thirdRow"});a.addRow(y);var T=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"taskInitiatorNameCell",hAlign:sap.ui.commons.layout.HAlign.Center,vAlign:sap.ui.commons.layout.VAlign.Top,colSpan:1,rowSpan:2});var _=new sap.ui.commons.TextView(e.getId()+"--"+"taskInitiatorName",{design:sap.ui.commons.TextViewDesign.Small,wrapping:false,width:"90%"});_.setTextAlign(sap.ui.core.TextAlign.Center);_.setDesign(sap.ui.commons.TextViewDesign.Bold);_.bindProperty("text","CreatedByName");T.addContent(_);y.addCell(T);var C=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"actionLinksCell",padding:sap.ui.commons.layout.Padding.None,colSpan:1});var v=new sap.ui.commons.layout.MatrixLayout({id:e.getId()+"--"+"taskActionMatrixLayout",layoutFixed:false});var S=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"claimActionCell",hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Bottom,colSpan:1});var w=new sap.ui.commons.Link(e.getId()+"--"+"rrViewClaimAction",{tooltip:e._oBundle.getText("INBOX_ACTION_BUTTON_CLAIM"),visible:false,enabled:false});w.addStyleClass("sapUiExtInboxLnkNoUnderline");var A=new sap.ui.commons.Label({id:e.getId()+"--"+"dotSeparator",text:sap.uiext.inbox.InboxConstants.DOT,visible:false});A.addStyleClass("sapUIExtInboxDotSeperatorStyle");w.setText(e._oBundle.getText("INBOX_ACTION_BUTTON_CLAIM"));w.attachPress({inbox:e,view:e.constants.rowRepeaterView,action:"Claim"},e.executeActionOnTask);S.addContent(w);var B=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"releaseActionCell",hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Bottom,colSpan:1});var O=new sap.ui.commons.Link(e.getId()+"--"+"rrViewReleaseAction",{tooltip:e._oBundle.getText("INBOX_ACTION_BUTTON_RELEASE"),visible:false,enabled:false});O.addStyleClass("sapUiExtInboxLnkNoUnderline");O.setText(e._oBundle.getText("INBOX_ACTION_BUTTON_RELEASE"));O.attachPress({inbox:e,view:e.constants.rowRepeaterView,action:"Release"},e.executeActionOnTask);B.addContent(O);var R=new sap.ui.commons.Label({id:e.getId()+"--"+"dotSeparator2",visible:false,text:sap.uiext.inbox.InboxConstants.DOT});R.addStyleClass("sapUIExtInboxDotSeperatorStyle");var E=e._createForwardActionLinkCell();var F=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"customActionCell",hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Top,padding:sap.ui.commons.layout.Padding.None,colSpan:1});var D=new sap.ui.layout.HorizontalLayout(e.getId()+"--"+"hrLayoutForCustomActions");D.setVisible(false);F.addContent(D);D.bindProperty("visible","InstanceID",function(t){if(!e._isCompletedTasksSelected()){if(t){if(this.getContent()[0]){this.getContent()[0].setVisible(true)}var i=e.getCoreModel();var a=this.getBindingContext();var o=i.getProperty("SAP__Origin",a);var s;var r=this;function n(t){if(t&&t.length>0){if(r.getContent()[0])r.getContent()[0].setVisible(false);for(var i in t){(function(i){var a=new sap.ui.commons.Link;var o=t[i];a.data("key",o.DecisionKey);a.data("text",o.DecisionText);a.data("commentsMandatory",o.CommentMandatory);var s=!o.DecisionText?o.DecisionKey:o.DecisionText;a.setText(s);a.attachPress({inbox:e,view:e.constants.rowRepeaterView},jQuery.proxy(e._handleCustomActionClick,e));a.addStyleClass("sapUiExtInboxLnkNoUnderline");a.addStyleClass("sapUiExtInboxCustomActionLinkPadding");var n=new sap.ui.commons.Label({text:sap.uiext.inbox.InboxConstants.DOT,visible:true});n.addStyleClass("sapUiExtInboxCustomActionLinkPadding");n.addStyleClass("sapUIExtInboxDotSeperatorStyle");r.addContent(n);r.addContent(a)})(i)}}else{if(r.getContent()[0])r.getContent()[0].setVisible(false);r.setVisible(false)}}s=e._getCustomActionsDefinition(t,o,null,n)}else{this.destroyContent();var l=new sap.ui.core.Icon;l.setSrc(e.constants.iconPool.getIconURI("refresh"));this.addContent(l);return true}}});v.createRow(S,A,B,R,E,F);C.addContent(v);y.addCell(C);var L=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"segmentedButtonsCell",padding:sap.ui.commons.layout.Padding.None,hAlign:sap.ui.commons.layout.HAlign.End,colSpan:1});var P=e.createOtherActions(e);L.addContent(P);y.addCell(L);a.addStyleClass("sapUiExtInboxRowRepeaterLayoutBorder");var i=new sap.ui.commons.RowRepeater(e.getId()+"--"+"tasksRowRepeater",{numberOfRows:5});i.setBusyIndicatorDelay(0);i.setThreshold(1e4);i.setDesign(sap.ui.commons.RowRepeaterDesign.BareShell);i.addStyleClass("sapUiExtInboxBackgroundColour");i.addStyleClass("sapUiExtInboxRowRepeaterBorder")}var M=e.createRowRepeaterToolBar(e);M.setVisible(false);t.addContent(M);i.setVisible(false);t.addContent(i);var N=e.createRowRepeaterToolsContent(e);N.setVisible(false);t.addContent(N)};sap.uiext.inbox.Inbox.prototype.onSubstitutionButtonPress=function(e,t){var i=t;var a=sap.ui.getCore().byId(i.getId()+"--"+"substitutionRulesManager");var o=i.getCoreModel();if(a===undefined){a=new sap.uiext.inbox.SubstitutionRulesManager(i.getId()+"--"+"substitutionRulesManager");a.setParent(i);a.sUrl=o.sServiceUrl;a.bUseBatch=i.bUseBatch;a.oTCMModel=i.oTCMModel;a.oTcmMetadata=i.oTcmMetadata;a.oConfiguration=i.oConfiguration;a.isSubstitutionRuleCreationSupported=i.isSubstitutionRuleCreationSupported;a.oDataManager=i.oDataManager;var s=i.constants.SubstitutionProfileCollection;a.bSubstitutionProfileAvailable=i.oTcmMetadata._isEntitySet(s.name,s.entityType)}a.getSubstitutionRulesData(o);a.open()};sap.uiext.inbox.Inbox.prototype.populateTaskExecutionContent=function(e){var t=this;var i=false,a=0;this.showBusyLoader();var o="";if(this.getTaskExecutionURLThemeValue()!==undefined&&this.getTaskExecutionURLThemeValue()!==null&&this.getTaskExecutionURLCallBack===this.getDefaultTaskExecutionURLCallBack){o=this.getTaskExecutionURLThemeValue()}var s=sap.ui.getCore().byId(this.getId()+"--"+"taskExecUI");if(s!=undefined){s.destroy()}var r=0;var n,l,u,d,p,c,g=[],f=[],h,I;if(e===undefined||e===null)e=this.getnavigateTaskExecMetadata();if(e!=undefined){n=e.arrayURLs;l=e.arrayIDs;a=l.length;u=e.arrayTitles;p=e.aTaskSAPOrigins;c=e.aSelectedContexts;h=c;if(this.clientUpdate){I=e.oRow}}s=new sap.ui.ux3.OverlayContainer(this.getId()+"--"+"taskExecUI");s.setOpenButtonVisible(false);if(this.currentView===this.constants.tableView&&c){this.selectedContexts=c}s.attachClose({inBox:this,completedTaskContexts:g,changeContextValues:f,rrSelectedRow:I},function(e,i){var a=i.inBox,o=i.completedTaskContexts,s=i.changeContextValues;jQuery.sap.byId(t.getId()+"--"+"execURLFrame").attr("src","");a.resetSearchCriteria();if(a.clientUpdate){var n=i.rrSelectedRow;if(a.getTaskExecURLStatusCallBack!==""&&a.getTaskExecURLStatusCallBack!==undefined&&a.getTaskExecURLStatusCallBack!==null){var u=a.getTaskExecURLStatusCallBack(l[r],p[r]);if(u==="COMPLETED"){if(I){o.push({orow:I,context:h[r]})}else{o.push(h[r])}}else{if(I){s.push({row:I,context:h[r],keys:[{key:"Status",value:u}]})}else{s.push({context:h[r],keys:[{key:"Status",value:u}]})}}}a._refreshLocal(o,s)}else{a.applyFilterOnResponse(a.selectedContexts)}});if(a==1){i=true}var m=sap.ui.getCore().byId(this.getId()+"--"+"nxtBtnContainer");if(m===undefined&&!i){m=new sap.ui.commons.layout.MatrixLayout(this.getId()+"--"+"nxtBtnContainer",{layoutFixed:false,height:"95%",width:"100%"})}var b=sap.ui.getCore().byId(this.getId()+"--"+"prevIcon");if(b===undefined&&!i){b=new sap.ui.core.Icon({id:this.getId()+"--"+"prevIcon",src:sap.ui.core.IconPool.getIconURI("navigation-left-arrow"),size:"32px",color:"rgb(51,51,51)",activeBackgroundColor:"white",hoverColor:"rgb(238,238,238)",hoverBackgroundColor:"rgb(102,102,102)",width:"90%"}).addStyleClass("sapUiExtInboxNextPrevBtnDisabled");b.setSrc(sap.ui.core.IconPool.getIconURI("navigation-left-arrow"));b.setColor("#eeeeee").setHoverBackgroundColor("white");b.attachPress(function(e){if(b.getColor()!=="#eeeeee"){b.setColor("#eeeeee").setHoverBackgroundColor("white");x.setColor("#eeeeee").setHoverBackgroundColor("white");var i="";if(t.getTaskExecURLStatusCallBack!==""&&t.getTaskExecURLStatusCallBack!==undefined&&t.getTaskExecURLStatusCallBack!==null){i=t.getTaskExecURLStatusCallBack(l[r],p[r])}if(i==="COMPLETED"){if(t.clientUpdate){g.push(c[r])}n.splice(r,1);l.splice(r,1);h.splice(r,1)}else{if(t.clientUpdate){f.push({context:c[r],keys:[{key:"Status",value:i}]})}}r=r-1;if(n[r]===undefined){n[r]="";if(t.getTaskExecutionURLCallBack!==""&&t.getTaskExecutionURLCallBack!==undefined&&t.getTaskExecutionURLCallBack!==null){n[r]=t.getTaskExecutionURLCallBack(l[r],p[r])}}if(n[r]!==null&&n[r].replace(/\s/g,"").length>0){jQuery.sap.byId(t.getId()+"--"+"execURLFrame").attr("src",t.inboxUtils.appendThemingParameters(n[r],o)+"&sap-inbox-overlay=true")}}else{e.preventDefault()}})}var x=sap.ui.getCore().byId(this.getId()+"--"+"nextIcon");if(x===undefined&&!i){var x=new sap.ui.core.Icon({id:this.getId()+"--"+"nextIcon",src:sap.ui.core.IconPool.getIconURI("navigation-right-arrow"),size:"32px",color:"rgb(51,51,51)",activeBackgroundColor:"white",hoverColor:"rgb(238,238,238)",hoverBackgroundColor:"rgb(102,102,102)",width:"90%"}).addStyleClass("sapUiExtInboxNextPrevBtnDisabled");x.setSrc(sap.ui.core.IconPool.getIconURI("navigation-right-arrow"));if(l.length>1){x.setColor("#333333").setHoverBackgroundColor("rgb(102,102,102)")}else{x.setColor("#eeeeee").setHoverBackgroundColor("white")}x.attachPress(function(e){if(x.getColor()!=="#eeeeee"){b.setColor("#eeeeee").setHoverBackgroundColor("white");x.setColor("#eeeeee").setHoverBackgroundColor("white");var i="";if(t.getTaskExecURLStatusCallBack!==""&&t.getTaskExecURLStatusCallBack!==undefined&&t.getTaskExecURLStatusCallBack!==null){i=t.getTaskExecURLStatusCallBack(l[r],p[r])}if(i==="COMPLETED"){if(t.clientUpdate){g.push(c[r])}n.splice(r,1);l.splice(r,1);h.splice(r,1)}else{if(t.clientUpdate){f.push({context:c[r],keys:[{key:"Status",value:i}]})}r=r+1}if(n[r]===undefined){n[r]="";if(t.getTaskExecutionURLCallBack!==""&&t.getTaskExecutionURLCallBack!==undefined&&t.getTaskExecutionURLCallBack!==null){n[r]=t.getTaskExecutionURLCallBack(l[r],p[r])}}if(n[r]!==null&&n[r].replace(/\s/g,"").length>0){jQuery.sap.byId(t.getId()+"--"+"execURLFrame").attr("src",t.inboxUtils.appendThemingParameters(n[r],o)+"&sap-inbox-overlay=true")}}else{e.preventDefault()}})}var y=sap.ui.getCore().byId(this.getId()+"--"+"prevBtnContainer");if(y===undefined&&!i){y=new sap.ui.commons.layout.MatrixLayout(this.getId()+"--"+"prevBtnContainer",{layoutFixed:false,height:"95%",width:"100%"})}var T=new sap.ui.core.HTML(this.getId()+"--"+"execURLFrame",{content:"<iframe name='myframe' src='"+n[r]+o+"&sap-inbox-overlay=true"+"' scrolling='auto' id = '"+this.getId()+"--"+"execURLFrame"+"' style='position: absolute;height: 100%;width: 100%; border: none;'></iframe>"});var _=new sap.ui.commons.layout.BorderLayout(this.getId()+"--"+"taskExecBorderLayout",{width:"100%",height:"100%",top:new sap.ui.commons.layout.BorderLayoutArea({size:"20%",contentAlign:"center",visible:false,content:[new sap.ui.commons.TextView({text:"Task:"+u[r],design:sap.ui.commons.TextViewDesign.Bold})]}),center:new sap.ui.commons.layout.BorderLayoutArea({contentAlign:"left",visible:true,content:[T]})});if(!i){var C=sap.ui.getCore().byId(this.getId()+"--"+"traverseLabel");if(!C){C=new sap.ui.commons.Label(this.getId()+"--"+"traverseLabel")}var v=sap.ui.getCore().byId(this.getId()+"--"+"dummyLabel");if(!v){v=new sap.ui.commons.Label({id:this.getId()+"--"+"dummyLabel",visible:false})}m.createRow(x);y.createRow(b);var _=sap.ui.getCore().byId(this.getId()+"--"+"taskExecBorderLayout");_.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.begin,{size:"2%",contentAlign:"right",visible:true,content:[y,C]});_.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.end,{size:"2%",contentAlign:"right",visible:true,content:[m,v]})}s.addContent(_);T.attachAfterRendering(function(){jQuery.sap.byId(t.getId()+"--"+"execURLFrame").bind("load",function(e){var t=l.length;if(x){if(r!==t-1)x.setColor("#333333").setHoverBackgroundColor("rgb(102,102,102)");else x.setColor("#eeeeee").setHoverBackgroundColor("white")}if(b){if(r===0)b.setColor("#eeeeee").setHoverBackgroundColor("white");else b.setColor("#333333").setHoverBackgroundColor("rgb(102,102,102)")}if(C){C.setDesign(sap.ui.commons.LabelDesign.Bold);C.setWidth("85%");C.setText(r+1+"/"+l.length)}if(v){v.setDesign(sap.ui.commons.LabelDesign.Bold);v.setWidth("60%")}})});if(i&&n!==null&&!n[0]){this.hideBusyLoader()}else{s.open()}function S(e){var i;var a=jQuery.sap.byId(t.getId()+"--"+"taskExecUI");if(jQuery.browser.msie==true&&parseInt(jQuery.browser.version)<10){var o=JSON.parse(String(e.data))}else{o=e.data}if(jQuery.isArray(o)){jQuery.each(o,function(e,t){i=o[e];if(i.command==="resize"){a.css({margin:"auto"});if(!i.data.height){a.animate({width:i.data.width},"slow")}else if(!i.data.width){a.animate({height:i.data.height},"slow")}else a.animate({height:i.data.height,width:i.data.width},"slow")}})}}if(window.addEventListener){window.addEventListener("message",S,false)}else if(window.attachEvent){window.attachEvent("onmessage",S)}};sap.uiext.inbox.Inbox.prototype.createInboxUI=function(){var e=new sap.ui.commons.layout.VerticalLayout(this.getId()+"--"+"verticalLayoutContainer");if(sap.ui.getCore().byId(this.getId()+"--"+"toolbarContainer")===undefined){e.insertContent(this.populateToolBar(),0)}this.populateViews();if(sap.ui.getCore().byId(this.getId()+"--"+"notificationBar")===undefined){e.addContent(this.populateNotificationBar())}return e};sap.uiext.inbox.Inbox.prototype.openToolPopUp=function(e){var t=e;var i;var a=sap.ui.getCore().byId(t.getId()+"--"+"rowSettingsRBG");var o=sap.ui.getCore().byId(t.getId()+"--"+"sPopup");if(o===undefined){a=new sap.ui.commons.RadioButtonGroup(t.getId()+"--"+"rowSettingsRBG",{tooltip:"Select number of rows to be displayed on the Table",columns:3});var s=new sap.ui.core.Item({text:"10",key:"rows10"});a.addItem(s);s=new sap.ui.core.Item({text:"25",key:"rows25"});a.addItem(s);s=new sap.ui.core.Item({text:"50",key:"rows50"});a.addItem(s);o=new sap.ui.commons.Dialog(t.getId()+"--"+"sPopup",{title:e._oBundle.getText("INBOX_TABLE_SETTINGS_POPUP_TITLE"),content:[a],buttons:[new sap.ui.commons.Button({text:e._oBundle.getText("INBOX_BUTTON_OK_TEXT"),press:function(){t.setNoOfRowsOnTable(sap.ui.getCore().byId(t.getId()+"--"+"rowSettingsRBG").getSelectedItem().getText());o.close()}})]});o.setWidth("231px");o.setHeight("137px")}if(i===undefined){i=sap.ui.getCore().byId(t.getId()+"--"+"listViewTable").getVisibleRowCount()+""}if(i!=undefined&&a!=undefined){switch(i){case"10":a.setSelectedIndex(0);break;case"25":a.setSelectedIndex(1);break;case"50":a.setSelectedIndex(2);break}}o.open()};sap.uiext.inbox.Inbox.prototype.setSubstitutionEnabled=function(e,t){if(this.isSubstitutionEnabled!=e){this.isSubstitutionEnabled=e;this._substitutionPath=t;this.addAndRemoveSubstDropDowns()}};sap.uiext.inbox.Inbox.prototype._setColumnVisibility=function(e){if(e!==undefined&&e!==null){var t=this;var i=false;var a=sap.uiext.inbox.InboxConstants;var o=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");var s=this.getInvisibleCols(e);var r=o.getColumns();jQuery.each(r,function(e,i){jQuery.each(s,function(e,a){if(t.absId(i.getId())===sap.uiext.inbox.InboxConstants.TABLE_VIEW_TECH_NAMES[a])i.setVisible(false)})});this.resizeColumns()}};sap.uiext.inbox.Inbox.prototype.absId=function(e){return e.split("--")[1].replace(/^\s+|\s+$/g,"")};sap.uiext.inbox.Inbox.prototype.getInvisibleCols=function(e){var t=[];jQuery.each(e.columns,function(e,i){if(i.visibility===false)t.push(i.field)});return t};sap.uiext.inbox.Inbox.prototype.getColumnVisibility=function(){return this.colList};sap.uiext.inbox.Inbox.prototype.getSubstitutionEnabled=function(){return this.isSubstitutionEnabled};sap.uiext.inbox.Inbox.prototype.clearDrillDownFilter=function(){this.resetFilterView(true)};sap.uiext.inbox.Inbox.prototype.getTaskTableBinding=function(){var e=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");return e.getBinding("rows")};sap.uiext.inbox.Inbox.prototype.bindTaskExecutionURL=function(e,t){this.getTaskExecutionURLCallBack=e;this.getTaskExecURLStatusCallBack=t;return this};sap.uiext.inbox.Inbox.prototype.bindTaskTypeDynamicFilter=function(e){this.dynamicTaskTypeFilterCallBack=e;return this};sap.uiext.inbox.Inbox.prototype.bindSearch=function(e){this.searchCallBack=e;return this};sap.uiext.inbox.Inbox.prototype.bindSubstitutedUsers=function(e){var t=sap.ui.getCore().byId(this.getId()+"--"+"filterComboBox3");var i=t.getSelectedKey();var a=t.getValue();var o=sap.ui.getCore().byId(this.getId()+"--"+"onBehalfOfListItem");if(o===undefined){o=new sap.ui.core.ListItem(this.getId()+"--"+"onBehalfOfListItem")}o.setText(this._oBundle.getText("SUBSTITUTION_INBOX_FILTER_ON_BEHALF_OF"));o.setKey("onBehalfOf");o.setEnabled(false);var s=sap.ui.getCore().byId(this.getId()+"--"+"li_allUsers");if(s===undefined){s=new sap.ui.core.ListItem(this.getId()+"--"+"li_allUsers")}s.setText(this._oBundle.getText("INBOX_DROP_DOWN_VALUE_ALL_USERS"));s.setKey("allUsers");var r=e+"?$format=json&$skip=0&$top=100&$inlinecount=allpages";var n=this.bpmSvcUrl+r;var l="";var u=this.getCoreModel();var d=this;var p={async:false,requestUri:n,method:"GET",headers:{Accept:"application/json","x-csrf-token":u.oHeaders["x-csrf-token"]}};OData.request(p,function(e,r){if(e.results.length>0){if(t.getEnabled()===false){t.setEnabled(true)}t.removeAllItems();t.addItem(o);t.addItem(s);for(var n=0;n<e.results.length;n++){l+=e.results[n].DisplayName;var u=new sap.ui.core.ListItem;u.setKey(e.results[n].UniqueName);u.setText(e.results[n].DisplayName);t.addItem(u)}if(d.bRefreshStartFlag&&d.filtersToApply.dropDownFilter3){var p=false;for(var n=0;n<e.results.length;n++){if(e.results[n].UniqueName==i){p=true;t.setSelectedKey(i)}}if(!p){delete d.filtersToApply.dropDownFilter3;d.showMessage("error",d._oBundle.getText("INBOX_MSG_ERR_SUBSTITUTION_DELETED",[a]))}p=false}}else{t.setEnabled(false)}},function(e){if(e.response.statusCode==205){var t={statusCode:e.response.statusCode,statusText:e.response.statusText};u.fireRequestFailed(t)}else{d.showMessage("error",d._oBundle.getText("INBOX_MSG_ERR_EXUI")+this.id)}})};sap.uiext.inbox.Inbox.prototype.bindTaskTable=function(e,t){var i=new sap.uiext.inbox.InboxFilters;var a=new sap.uiext.inbox.InboxSecondaryFilters;i.setSecondaryFilter(t);this.bindTasks(e,i)};sap.uiext.inbox.Inbox.prototype.bindTasks=function(e,t,i){var a,o,s;if(t){a=t.getPrimaryFilter();o=t.getSecondaryFilter()}this.modelRefreshed=true;this.oModel=this.getModel();this.oController.setModel(this.oModel);this._handleTaskCategoryVisibility();this._setCommentsVisibility();this._initFlagsByModel();this.oDataManager.setModel(this.oModel);if(this.typeOfModel==="OData"){this._initODataModel()}else{this._bindTaskActions()}this.sCollectionPath=e;if(!/^\//.test(this.sCollectionPath))this.sCollectionPath="/"+this.sCollectionPath;this.oModel.attachRequestSent(this,function(e,t){var i=t._currentViewElement();i.setBusy(true);t._handleRequestSent(e)});this.oModel.attachRequestCompleted(this,function(e,t){var i=t._currentViewElement();i.setBusy(false);var a=e.getParameter("url");if(a&&a.indexOf("TaskCollection")>0){t._handleRequestCompleted(e)}});this.oModel.attachRequestFailed(this,function(e,t){var i=t._currentViewElement();i.setBusy(false);t._handleRequestFailed(e)});var r=this._initTableView();var n=this._initRowRepeaterView();var l=this._getComponent("rrMainMatrixLayout");var u=i?i:new sap.ui.model.Sorter("CreatedOn",true);this._applySortOnView(u);this.resetFilterView(false);this._selectInitialValueinDropDown(a);if(this.defaultView===this.constants.rowRepeaterView){var d=sap.ui.getCore().byId(this.getId()+"--"+"viewSelectionSegBtn");if(d!==undefined){var p=this.getId()+"--"+"rrViewSelectionButton";d.setSelectedButton(p);var c=sap.ui.getCore().byId(this.getId()+"--"+"rrViewSelectionButton");d.fireSelect({selectedButtonId:p,triggeredFrom:"initialView"})}}var g=sap.ui.getCore().byId(this.getId()+"--"+"filterViewButton");var f=g.$();var h=[],I;var m=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED");var b=this.filtersToApply.dropDownFilter;if(b===undefined){b=m}if(this.applyTaskCategoryFilter){if(this.filterOperatorCategoryTask===undefined){var x=this.inboxUtils._getCategoryFilter("TASK")}this.filtersToApply.taskCategory=x;h=this._addFilterToFilterMetadata(x,h)}var y=this.filtersToApply.neCompleted;if(o!=null){var T=o.getFilterObjects();I=T.filterOperatorMap;var _=I?!g.getPressed():g.getPressed();if(_){g.setPressed(!g.getPressed());g.firePress()}if(I){this.filtersToApply=T.filtersAppliedMap;h=this._selectFilterValuesinFacetFilterView(o,I,b)}else{h=this._addFilterToFilterMetadata(b,h);this.filtersToApply.dropDownFilter=b}if(y){var C=o.getFilterUIKeys();if(!(C.Status&&C.Status.length>0)){h=this._addFilterToFilterMetadata(y,h)}}}else{if(g.getPressed()){g.setPressed(!g.getPressed());g.firePress()}this.filtersToApply.dropDownFilter=b;h=this._addFilterToFilterMetadata(b,h);if(y){h=this._addFilterToFilterMetadata(y,h)}}var v=this._getBindingParameters();if(this.defaultView===this.constants.rowRepeaterView){n.bindRows({path:this.sCollectionPath,template:l,parameters:v,sorter:u,filters:h})}r.bindRows({path:this.sCollectionPath,parameters:v,sorter:u,filters:h});this.setToggleCustomAttributeBtnVisibilityStreamView(this.isCustomAttributesEnabled);return this};sap.uiext.inbox.Inbox.prototype.setToggleCustomAttributeBtnVisibilityStreamView=function(e){var t=this._getComponent("toggleCustomAttributes");if(e){t.setVisible(true)}};sap.uiext.inbox.Inbox.prototype.localSearch=function(e,t){if(t.searchCallBack!==""&&t.searchCallBack!==undefined){t.searchCallBack();return}var i=t.getCoreModel();var a=jQuery.trim(e.getParameter("query").toLowerCase());var o=t._currentViewElement();var s=[];t._resetStateBeforeSearch();s.push(t._getBindingKeysOnLocalSearch(a,i._original_data,o._originalKeys));if(t.currentView===t.constants.tableView&&t._isTableFiltered()){s.push(t._getCurrentBindingKeysForTableColumnFilters(i._original_data,o._originalKeys))}var r=t.inboxUtils._getUniqueArray(s);var n={};var l;for(var u in r){l=i._original_data[r[u]];n[r[u]]=l;if(l.Description){var d,p;var c=l.Description;if(c&&c.__list instanceof Array){d=c.__list[0];p=i.oData[d];if(p)n[d]=p}else{var g=c.__ref;if(c&&g){p=i.oData[g];if(p)n[g]=p}}}if(l.TaskDefinitionData){var f,h;var I=l.TaskDefinitionData;if(I&&I.__list instanceof Array){f=l.TaskDefinitionData.__list[0];h=i.oData[f];if(h)n[f]=h}else{var m=I.__ref;if(I&&m){h=i.oData[m];if(h)n[m]=h}}}}i.oData=n;var b=o.mBindingInfos["rows"];if(b&&b.binding){b.binding.iLength=r.length;b.binding.aKeys=r;t.currentView===t.constants.tableView?o.rerender():o.updateRows(false);o._updateBindingContexts(undefined,undefined,"change")}var x=o.getBinding("rows").iLength;t._updatePaginator(x);if(x<=0)t.showMessage("info",t._oBundle.getText("INBOX_MSG_FOR_NO_DATA"));else t.deleteMessage();t.fireODataRequestCompleted({bindingLength:x,appliedFilter:t._oBundle.getText("INBOX_SEARCH_RESULTS_TEXT")})};sap.uiext.inbox.Inbox.prototype._getBindingKeysOnLocalSearch=function(e,t,i){var a=[];for(var o in t){var s=t[o];var r=false;var n;var l;for(var u in i){if(o==i[u]){for(var d=0;d<this._getCategoryMetadata().properties.length;d++){l=this._getCategoryMetadata().properties[d];n=s[l];if(!n&&l==="TaskTitle"){n=this._oBundle.getText("INBOX_TASK_TITLE_NOTAVAILABLE_MSG")}if(n!=null){if(jQuery.type(n)==="date"){n=this.inboxUtils.dateTimeFormat(n)}if(l==="Priority"||l==="Status"){if(n=="VERY_HIGH")n=this._oBundle.getText("INBOX_FILTER_PRIORITY_VERY_HIGH");if(n=="HIGH")n=this._oBundle.getText("INBOX_FILTER_PRIORITY_HIGH");if(n=="MEDIUM")n=this._oBundle.getText("INBOX_FILTER_PRIORITY_MEDIUM");if(n=="LOW")n=this._oBundle.getText("INBOX_FILTER_PRIORITY_LOW");if(n=="READY")n=this._oBundle.getText("INBOX_FILTER_STATUS_READY");if(n=="RESERVED")n=this._oBundle.getText("INBOX_FILTER_STATUS_RESERVED");if(n=="IN_PROGRESS")n=this._oBundle.getText("INBOX_FILTER_STATUS_IN_PROGRESS")}n=n.toLowerCase();if(n.indexOf(e)>=0){r=true;break}}}if(!r){if(s.Description){var p=s.Description;r=this._getValuePresent(t,p,sap.uiext.inbox.InboxConstants.NAVIGATION_DESCRIPTION,e)}}if(!r){if(s.TaskDefinitionData){var c=s.TaskDefinitionData;r=this._getValuePresent(t,c,sap.uiext.inbox.InboxConstants.NAVIGATION_TASKDEFINITION,e)}}if(!r){if(s.CustomAttributeData){var g=s.CustomAttributeData.__list;if(g!==undefined){for(var f=0;f<g.length;f++){var h=g[f];var n=t[h].Value;if(n!=null||n!=undefined){n=n.toLowerCase();if(n.indexOf(e)>=0){r=true;break}}}}}}if(r){var I=o;a.push(I)}}}}return a};sap.uiext.inbox.Inbox.prototype.refresh=function(e){this.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype.applyFilterOnResponse=function(e,t){var i=this.getCoreModel();var a=this;this.showBusyLoader();var o;var s;var r=sap.ui.getCore().byId(this.getId()+"--"+"notificationBar");var n=sap.ui.getCore().byId(this.getId()+"--"+"messageNotifier");if(r!=undefined){n.destroyMessages();r.setVisibleStatus(sap.ui.ux3.NotificationBarStatus.Min)}if(a.currentView===a.constants.tableView){s=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");if(s!==undefined){if(e!=undefined&&e!=null){a.selectedContexts=e}else{a.selectedContexts=[]}o=s.getBinding("rows")}}else if(this.currentView===a.constants.rowRepeaterView){s=sap.ui.getCore().byId(this.getId()+"--"+"tasksRowRepeater");if(s!==undefined){s.gotoPage(1);var l=this._getComponent("rowRepeaterPaginator");if(l){l.destroy()}o=s.getBinding("rows")}}var u=[];if(o!=null&&o!=undefined){o.aApplicationFilters=[];for(var d in a.filtersToApply){var p=a.filtersToApply[d];if(jQuery.isArray(p)){u=u.concat(p)}else u.push(p)}if(this.currentView===a.constants.rowRepeaterView&&t){var c=o.oSorter;var g=a._getComponent("sortByFilterComboBox");var f=g.getSelectedItemId();if(f){var h=a.constants.mRRSortMap[a._removeParentID(f)];c=h?a._getComponent(h).getSorter():c}var I=a._getComponent("rrMainMatrixLayout");var m=a._getBindingParameters();if(this.clientUpdate===undefined){s.unbindRows();s.bindRows({path:a.sCollectionPath,template:I,parameters:m,sorter:c,filters:u});s.bRowsRebinded=true}else{o.filter(u);s.updateRows(false)}}else{o.filter(u)}}a.modelRefreshed=true;if(o){s._originalKeys=o.aKeys}this.hideBusyLoader()};sap.uiext.inbox.Inbox.prototype.refreshTaskList=function(e,t){t.bRefreshStartFlag=true;if(!t.getHandleBindings()){t.fireRefresh(e)}else{}var i=t.getCoreModel();var a=sap.ui.getCore().byId(t.getId()+"--"+"listViewTable");var o=sap.ui.getCore().byId(t.getId()+"--"+"tasksRowRepeater");var s;var r;var n=t.getlistTableSelectedIndices();var l=[];jQuery.each(n,function(e,t){r=a.getContextByIndex(t);l.push(r)});var u;if(t.currentView===sap.uiext.inbox.InboxConstants.tableView){u=a}else if(t.currentView===sap.uiext.inbox.InboxConstants.rowRepeaterView){u=o}if(u!=undefined){if(l!=undefined&&l!=null){t.selectedContexts=l}else{t.selectedContexts=[]}if(t.clientUpdate){u.getModel().refresh();t.modelRefreshed=true}else{var d=sap.ui.getCore().byId(t.getId()+"--"+"filterComboBox3");if(d!=undefined&&d.getEnabled()===true){t.bindSubstitutedUsers("/SubstitutedUsersCollection")}s=u.getBinding("rows");var p=[];if(s!=null){s.aApplicationFilters=[];for(var c in t.filtersToApply){var g=t.filtersToApply[c];if(jQuery.isArray(g)){p=p.concat(g)}else p.push(g)}s.filter(p)}}}t.modelRefreshed=true;u._originalKeys=u.getBinding("rows").aKeys;t.resetSearchCriteria();var f=sap.ui.getCore().byId(t.getId()+"--"+"refreshOnText");if(f){t.lastRefreshedOnDateTime=new Date;var h=t._getFormattedRefreshOnDateTime();f.setText(t._oBundle.getText("INBOX_TEXT_ON")+sap.uiext.inbox.InboxConstants.SPACE+h);f.setTooltip(t._getFormattedTooltipForLastRefreshedTime())}};sap.uiext.inbox.Inbox.prototype.applyDropDownFilter1=function(e,t){var i=e.getSource().getSelectedItemId();if(i===t.getId()+"--"+"li_substitutedTasks"){sap.ui.getCore().byId(t.getId()+"--"+"filterComboBox3").setEnabled(false);t.filtersToApply.dropDownFilter1=new sap.ui.model.Filter("IsSubstituted",sap.ui.model.FilterOperator.EQ,true);t.bindSubstitutedUsers("/SubstitutedUsersCollection");sap.ui.getCore().byId(t.getId()+"--"+"onBehalfOfListItem").setEnabled(false)}else{sap.ui.getCore().byId(t.getId()+"--"+"onBehalfOfListItem").setEnabled(true);sap.ui.getCore().byId(t.getId()+"--"+"filterComboBox3").setSelectedItemId(t.getId()+"--"+"onBehalfOfListItem");sap.ui.getCore().byId(t.getId()+"--"+"filterComboBox3").setEnabled(false);delete t.filtersToApply.dropDownFilter3;if(i===t.getId()+"--"+"li_allTasks"){delete t.filtersToApply.dropDownFilter1}else if(i===t.getId()+"--"+"li_myTasks"){t.filtersToApply.dropDownFilter1=new sap.ui.model.Filter("IsSubstituted",sap.ui.model.FilterOperator.EQ,false)}}t.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype.applyDropDownFilter3=function(e,t){var i=e.getSource().getSelectedItemId();if(i===t.getId()+"--"+"li_allUsers"){delete t.filtersToApply.dropDownFilter3}else{t.filtersToApply.dropDownFilter3=new sap.ui.model.Filter("SubstitutedUser",sap.ui.model.FilterOperator.EQ,sap.ui.getCore().byId(t.getId()+"--"+"filterComboBox3").getSelectedKey())}t.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype.applyDropDownFilter=function(e,t){var i=false;var a=e.getSource().getSelectedItemId();var o=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_STATUS");var s=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_CREATION_DATE");var r=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME");var n=sap.ui.getCore().byId(t.getId()+"--"+"filterFacet");t.resetSearchCriteria();if(a===t.getId()+"--"+"li_completedTasks"){i=true;t._deleteCustomActions();if(o!==undefined){t.storeFilterState("INBOX_FILTER_STATUS");n.removeList(o)}if(s!==undefined){t.storeFilterState("INBOX_FILTER_CREATION_DATE");n.removeList(s)}if(r!==undefined){t.storeFilterState("INBOX_FILTER_DUE_DATETIME");n.removeList(r)}delete t.filtersToApply.resStat;delete t.filtersToApply.readyStat;delete t.filtersToApply.InProStat;delete t.filtersToApply.neCompleted;delete t.filtersToApply.today;delete t.filtersToApply.last30;delete t.filtersToApply.last15;delete t.filtersToApply.last7;t.clearFiltersForDueDate();t.filtersToApply.dropDownFilter=[new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.EQ,"COMPLETED")]}if(a===t.getId()+"--"+"li_openTasks"){if(o!=undefined){n.addList(o);t.retrieveFilterState("INBOX_FILTER_STATUS")}if(s!=undefined&&n.indexOfList(s)===-1){n.addList(s);t.retrieveFilterState("INBOX_FILTER_CREATION_DATE")}if(r!==undefined&&n.indexOfList(r)===-1){n.addList(r);t.retrieveFilterState("INBOX_FILTER_DUE_DATETIME")}delete t.filtersToApply.neCompleted;if(t.filtersToApply.resStat===undefined&&t.filtersToApply.readyStat===undefined&&t.filtersToApply.InProStat===undefined){t.filtersToApply.dropDownFilter=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED")}else{delete t.filtersToApply.dropDownFilter}}if(a===t.getId()+"--"+"li_overdueTasks"){if(o!=undefined){n.addList(o);t.retrieveFilterState("INBOX_FILTER_STATUS")}if(s!=undefined&&n.indexOfList(s)!==-1){t.storeFilterState("INBOX_FILTER_CREATION_DATE");n.removeList(s)}if(r!==undefined&&n.indexOfList(r)!==-1){t.storeFilterState("INBOX_FILTER_DUE_DATETIME");n.removeList(r)}t.clearFiltersForDueDate();delete t.filtersToApply.today;delete t.filtersToApply.last30;delete t.filtersToApply.last15;delete t.filtersToApply.last7;var l=t.getFormattedDateTimeOff(0,true);t.filtersToApply.dropDownFilter=new sap.ui.model.Filter("CompletionDeadLine",sap.ui.model.FilterOperator.LT,l);if(t.filtersToApply.resStat===undefined&&t.filtersToApply.readyStat===undefined&&t.filtersToApply.InProStat===undefined&&t.filtersToApply.neCompleted===undefined){t.filtersToApply.neCompleted=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED")}}if(a===t.getId()+"--"+"li_escalatedTasks"){if(o!=undefined){n.addList(o);t.retrieveFilterState("INBOX_FILTER_STATUS")}if(s!=undefined&&n.indexOfList(s)!=-1){t.storeFilterState("INBOX_FILTER_CREATION_DATE");n.removeList(s)}if(r!==undefined&&n.indexOfList(r)!==-1){t.storeFilterState("INBOX_FILTER_DUE_DATETIME");n.removeList(r)}t.clearFiltersForDueDate();delete t.filtersToApply.today;delete t.filtersToApply.last30;delete t.filtersToApply.last15;delete t.filtersToApply.last7;t.filtersToApply.dropDownFilter=new sap.ui.model.Filter("IsEscalated",sap.ui.model.FilterOperator.EQ,true);if(t.filtersToApply.resStat===undefined&&t.filtersToApply.readyStat===undefined&&t.filtersToApply.InProStat===undefined&&t.filtersToApply.neCompleted===undefined){t.filtersToApply.neCompleted=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED")}}if(i==true){t.hideAllActionButtonsandLinks()}else{t.showAllActionButtonsandLinks()}var u=t._isDrillDownFilterSelected("TaskDefinitionID");t._deleteCustomActions(null);if(!i&&u){t.applyFilterOnResponse(null,true)}else{t.applyFilterOnResponse(null)}};sap.uiext.inbox.Inbox.prototype.clearFiltersForCategory=function(){delete this.filtersToApply.taskCategory;delete this.filtersToApply.todoCategory;delete this.filtersToApply.alertCategory;delete this.filtersToApply.notificationCategory};sap.uiext.inbox.Inbox.prototype.clearFiltersForPriority=function(){delete this.filtersToApply.lowPrio;delete this.filtersToApply.medPrio;delete this.filtersToApply.hiPrio;delete this.filtersToApply.veryhiPrio};sap.uiext.inbox.Inbox.prototype.clearFiltersForStatus=function(){delete this.filtersToApply.resStat;delete this.filtersToApply.readyStat;delete this.filtersToApply.InProStat;delete this.filtersToApply.neCompleted;if(this.filtersToApply.dropDownFilter!=undefined){if(this.filtersToApply["dropDownFilter"].sPath==="Status"&&this.filtersToApply["dropDownFilter"].sOperator==="NE"){delete this.filtersToApply.dropDownFilter}}};sap.uiext.inbox.Inbox.prototype.clearFiltersForDueDate=function(){delete this.filtersToApply.dueDateToday;delete this.filtersToApply.dueDatenext30;delete this.filtersToApply.dueDatenext15;delete this.filtersToApply.dueDatenext7;delete this.filtersToApply.noDueDate};sap.uiext.inbox.Inbox.prototype.clearFiltersForDateTime=function(){delete this.filtersToApply.today;delete this.filtersToApply.last30;delete this.filtersToApply.last15;delete this.filtersToApply.last7};sap.uiext.inbox.Inbox.prototype.clearFiltersForTaskType=function(){for(var e in this.filtersToApply){if(this.filtersToApply[e].sPath==="TaskDefinitionID"){delete this.filtersToApply[e]}}};sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForTaskCategory=function(e,t){var i,a,o,s;var r=sap.ui.getCore().byId(t.getId()+"--"+"filterFacet");var n=e.getParameter("selectedItems");t.resetSearchCriteria();t.clearFiltersForCategory();t._modifyTableColumnsOnFilterCategory();t._modifyFacetFilterOnFilterCategory();t.changeToolbarOnFilterCategory();for(var l=0;l<n.length;l++){switch(n[l].getId()){case t.getId()+"--"+"INBOX_FILTER_CATEGORY_TASKS":i=t.inboxUtils._getCategoryFilter("TASK",t.sProviderHost);t.filtersToApply["taskCategory"]=i;break;case t.getId()+"--"+"INBOX_FILTER_CATEGORY_TODO":a=t.inboxUtils._getCategoryFilter("Todo",t.sProviderHost);t.filtersToApply["todoCategory"]=a;break;case t.getId()+"--"+"INBOX_FILTER_CATEGORY_ALERT":o=t.inboxUtils._getCategoryFilter("Alert",t.sProviderHost);t.filtersToApply["alertCategory"]=o;break;case t.getId()+"--"+"INBOX_FILTER_CATEGORY_NOTIFICATION":s=t.inboxUtils._getCategoryFilter("Notification",t.sProviderHost);t.filtersToApply["notificationCategory"]=s;break}}t.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype._modifyFacetFilterOnFilterCategory=function(e){if(e){var t=this.constants.aDependentDrillDownFiltersBasedOnCategory.aFilterMetadataDefault}else{var t=this._getCategoryFilterMetadata()}var i=sap.ui.getCore().byId(this.getId()+"--"+"filterFacet");if(i!=undefined){var a=i.getLists();var o=[];for(var s=0;s<a.length;s++){var r=a[s];var n=this._removeParentID(r.getId());o.push(n);if(jQuery.inArray(n,t)===-1){this.storeFilterState(n);i.removeList(r);this._deleteRemovedFilter(n)}}for(var s=0;s<t.length;s++){if(jQuery.inArray(t[s],o)===-1){var l=sap.ui.getCore().byId(this.getId()+"--"+t[s]);if(l!=undefined&&i.indexOfList(l)===-1){i.insertList(l,s);this.retrieveFilterState(t[s])}}}}};sap.uiext.inbox.Inbox.prototype._deleteRemovedFilter=function(e){switch(e){case"INBOX_FILTER_CATEGORY":this.clearFiltersForCategory();break;case"INBOX_FILTER_TASK_TYPE":this.clearFiltersForTaskType();break;case"INBOX_FILTER_PRIORITY":this.clearFiltersForPriority();break;case"INBOX_FILTER_STATUS":this.clearFiltersForStatus();break;case"INBOX_FILTER_CREATION_DATE":this.clearFiltersForDateTime();break;case"INBOX_FILTER_DUE_DATETIME":this.clearFiltersForDueDate();break}};sap.uiext.inbox.Inbox.prototype._modifyTableColumnsOnFilterCategory=function(){var e=this._getComponent("listViewTable");var t=e.getColumns();var i=this._getCategoryMetadata();var a=[];for(var o=0;o<t.length;o++){var s=t[o];var r=this._removeParentID(s.getId());a.push(r);if(jQuery.inArray(r,i.properties)===-1){s.destroy()}}for(var o=0;o<i.properties.length;o++){if(jQuery.inArray(i.properties[o],a)===-1){this._createTableColumnContent(o,i)}}};sap.uiext.inbox.Inbox.prototype._getSelectedCategory=function(){var e=this._getComponent("INBOX_FILTER_CATEGORY");if(e!=null&&e.getSelectedKeys()!=null){return e.getSelectedKeys()[0]}};sap.uiext.inbox.Inbox.prototype._getCategoryMetadata=function(){if(this.applyTaskCategoryFilter){var e=this._getSelectedCategory();switch(e){case"INBOX_FILTER_CATEGORY_TASKS":return this.constants.mEntities.taskMetadata;break;case"INBOX_FILTER_CATEGORY_TODO":return this.constants.mEntities.todoMetadata;break;case"INBOX_FILTER_CATEGORY_ALERT":return this.constants.mEntities.alertMetadata;break;case"INBOX_FILTER_CATEGORY_NOTIFICATION":return this.constants.mEntities.notificationMetadata;break;default:return this.constants.mEntities.taskMetadata}}else{return this.constants.mEntities.taskMetadata}};sap.uiext.inbox.Inbox.prototype._getCategoryFilterMetadata=function(){var e=this._getSelectedCategory();var t=this.constants.aDependentDrillDownFiltersBasedOnCategory;switch(e){case"INBOX_FILTER_CATEGORY_TASKS":return t.aFilterMetadataForCategoryTask;break;case"INBOX_FILTER_CATEGORY_TODO":return t.aFilterMetadataForCategoryTodo;break;case"INBOX_FILTER_CATEGORY_ALERT":return t.aFilterMetadataForCategoryAlert;break;case"INBOX_FILTER_CATEGORY_NOTIFICATION":return t.aFilterMetadataForCategoryNotification;break;default:return t.aFilterMetadataForCategoryTask}};sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForPriority=function(e,t){var i,a,o,s;var r=e.getParameter("selectedItems");t.resetSearchCriteria();t.clearFiltersForPriority();for(var n=0;n<r.length;n++){switch(r[n].getId()){case t.getId()+"--"+"INBOX_FILTER_PRIORITY_LOW":if(this.filterOperatorPrioLow===undefined)i=t.inboxUtils._getPriorityFilters("LOW",t.sProviderHost);t.filtersToApply["lowPrio"]=i;break;case t.getId()+"--"+"INBOX_FILTER_PRIORITY_MEDIUM":if(a===undefined)a=t.inboxUtils._getPriorityFilters("MEDIUM",t.sProviderHost);t.filtersToApply["medPrio"]=a;break;case t.getId()+"--"+"INBOX_FILTER_PRIORITY_HIGH":if(o===undefined)o=t.inboxUtils._getPriorityFilters("HIGH",t.sProviderHost);t.filtersToApply["hiPrio"]=o;break;case t.getId()+"--"+"INBOX_FILTER_PRIORITY_VERY_HIGH":if(s===undefined)s=t.inboxUtils._getPriorityFilters("VERY_HIGH",t.sProviderHost);t.filtersToApply["veryhiPrio"]=s;break}}t.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForStatus=function(e,t){var i,a,o,s;t.resetSearchCriteria();t.clearFiltersForStatus();if(e.getParameter("all")){s=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED");t.filtersToApply["neCompleted"]=s}else{var r=e.getParameter("selectedItems");for(var n=0;n<r.length;n++){switch(r[n].getId()){case t.getId()+"--"+"INBOX_FILTER_STATUS_RESERVED":if(i===undefined)i=t.inboxUtils._getStatusFilters("RESERVED",t.sProviderHost);t.filtersToApply["resStat"]=i;break;case t.getId()+"--"+"INBOX_FILTER_STATUS_READY":if(a===undefined)a=t.inboxUtils._getStatusFilters("READY",t.sProviderHost);t.filtersToApply["readyStat"]=a;break;case t.getId()+"--"+"INBOX_FILTER_STATUS_IN_PROGRESS":if(o===undefined)o=t.inboxUtils._getStatusFilters("IN_PROGRESS",t.sProviderHost);t.filtersToApply["InProStat"]=o;break}}}t.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForDateTime=function(e,t){var i,a,o,s;var r=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DATETIME_TODAY");var n=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DATETIME_MONTH");var l=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DATETIME_15DAYS");var u=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DATETIME_WEEK");var d=e.getParameter("selectedItems");t.resetSearchCriteria();t.clearFiltersForDateTime();var p=sap.ui.getCore().byId(t.getId()+"--"+"filterComboBox2");var c=false;if(p.getSelectedItemId()===t.getId()+"--"+"li_completedTasks"){c=true}for(var g=0;g<d.length;g++){switch(d[g].getId()){case t.getId()+"--"+"INBOX_FILTER_DATETIME_TODAY":var f=t.getFormattedDateTimeOff(0,false);if(i===undefined){i=new sap.ui.model.Filter("CreatedOn",sap.ui.model.FilterOperator.GE,f)}t.filtersToApply["today"]=i;delete t.filtersToApply.last30;delete t.filtersToApply.last15;delete t.filtersToApply.last7;break;case t.getId()+"--"+"INBOX_FILTER_DATETIME_MONTH":var f=t.getFormattedDateTimeOff(30,false);if(a===undefined){a=new sap.ui.model.Filter("CreatedOn",sap.ui.model.FilterOperator.GE,f)}t.filtersToApply["last30"]=a;delete t.filtersToApply.today;delete t.filtersToApply.last15;delete t.filtersToApply.last7;break;case t.getId()+"--"+"INBOX_FILTER_DATETIME_15DAYS":var f=t.getFormattedDateTimeOff(15,false);if(o===undefined){o=new sap.ui.model.Filter("CreatedOn",sap.ui.model.FilterOperator.GE,f)}t.filtersToApply["last15"]=o;delete t.filtersToApply.today;delete t.filtersToApply.last30;delete t.filtersToApply.last7;break;case t.getId()+"--"+"INBOX_FILTER_DATETIME_WEEK":var f=t.getFormattedDateTimeOff(7,false);if(s===undefined){s=new sap.ui.model.Filter("CreatedOn",sap.ui.model.FilterOperator.GE,f)}t.filtersToApply["last7"]=s;delete t.filtersToApply.today;delete t.filtersToApply.last30;delete t.filtersToApply.last15;break}}t.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForTaskType=function(e,t){var i=t.constants;t.resetSearchCriteria();t.clearFiltersForTaskType();var a=t.typeOfModel==="OData";if(a&&t.currentView===t.constants.tableView){t._clearCustomAttributeSort()}if(!e.getParameter("all")){var o=e.getParameter("selectedItems");t.bRefreshTaskTypes=false;if(a){t._createCustomAttributes(o)}for(var s=0;s<o.length;s++){t.filtersToApply[o[s].getKey()]=new sap.ui.model.Filter("TaskDefinitionID",sap.ui.model.FilterOperator.EQ,decodeURIComponent(o[s].getKey()))}}else{if(t.isCustomActionsEnabled===true&&a){t._deleteCustomActions(null)}if(t.isCustomAttributesEnabled===true&&a){t._deleteCustomAttributeColumns(null);t._modifyListBindingForExpand(false,i.customAttributeNavigationParam)}}var r=t.currentView===t.constants.rowRepeaterView?true:false;t.applyFilterOnResponse(null,r)};sap.uiext.inbox.Inbox.prototype._getCustomAttributeMetaData=function(e,t,i,a){var o=this;var s=this.constants;var r=s.TaskDefinitionCollection;var n=s.oTaskDefinitionCustomAttributesMap;var l=n[e];if(!l){var u=this.bpmSvcUrl+s.forwardSlash+r.entityName+"("+r.properties.taskDefnID+"='"+e+"',"+s.sapOrigin+"='"+t+"')"+s.forwardSlash+r.navParam.customAttrDefn;var d=this.getCoreModel();var p={async:true,requestUri:u,method:"GET",headers:{Accept:s.acceptHeaderforJSON,"Accept-Language":sap.ui.getCore().getConfiguration().getLanguage(),"x-csrf-token":d.oHeaders["x-csrf-token"]}};OData.request(p,function(t,s){var r=t.results;var l=[];for(var u=0;u<r.length;u++){var d={};d.Name=r[u].Name;d.Type=r[u].Type;d.Label=r[u].Label;l.push(d)}n[e]=l;o._displayCustomAttributes(e,a,i)},function(e){o.showMessage("error",o._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ATTRIBUTES_FAILS"))})}else{o._displayCustomAttributes(e,a,i)}};sap.uiext.inbox.Inbox.prototype._displayCustomAttributes=function(e,t,i){var a=this.constants;var o=a.oTaskDefinitionCustomAttributesMap[e];if(this.currentView===this.constants.tableView){this._deleteCustomAttributeColumns(o);if(o){this._createCustomAttributeColumns(o)}}else{if(o&&o.length==0){this._addActionContentinRowRepeater(i,"customAttributes",this._createNoDataLabel(this._oBundle.getText("INBOX_MSG_NO_TASK_DETAILS")));return}var s=a.oTaskInstanceCustomAttributeValuesMap[t];if(s&&!jQuery.isEmptyObject(s)){this._addActionContentinRowRepeater(i,"customAttributes",this._createCustomAttributesLayoutForRRView(o,s,i))}}};sap.uiext.inbox.Inbox.prototype._getCustomAttributeData=function(e,t,i,a){var o=this;var s=this.constants;var r=s.TaskCollection;var n=s.oTaskInstanceCustomAttributeValuesMap;var l=n[e];if(!l){var u=s.forwardSlash+r.entityName+"("+r.properties.instanceID+"='"+e+"',"+s.sapOrigin+"='"+t+"')"+s.forwardSlash+r.navParam.customAttrValues;var d=this.bpmSvcUrl+u;var l={};var p=this.getCoreModel();var c={async:true,requestUri:d,method:"GET",headers:{Accept:s.acceptHeaderforJSON,"x-csrf-token":p.oHeaders["x-csrf-token"]}};OData.request(c,function(t,s){var r=t.results;if(r.length>0){l["numberOfAttributes"]=r.length;for(var u=0;u<r.length;u++){l[r[u].Name]=r[u].Value;n[e]=l}}else{n[e]=l}o._displayCustomAttributes(a,e,i)},function(e){o.showMessage("error",o._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ATTRIBUTES_FAILS"))})}};sap.uiext.inbox.Inbox.prototype._createCustomAttributeColumns=function(e){var t=this;var i=this._getComponent("listViewTable");var a=this.getCoreModel();var o="name",s=0;jQuery.each(e,function(e,a){var r=t._getComponent(t.inboxUtils.scrub(a.Name));var n=a.Type;var l=n&&jQuery.inArray(n.replace("class ",""),t.constants.rightAlignedTypes)!=-1?sap.ui.core.TextAlign.Right:sap.ui.core.TextAlign.Left;if(!r){r=new sap.ui.table.Column({id:t.getId()+"--"+t.inboxUtils.scrub(a.Name)}).data("customAttrName",a.Name).data("ColumnType","CustomAttribute").setFlexible(true).setLabel(new sap.ui.commons.Label({text:a.Label,tooltip:a.Label,design:sap.ui.commons.LabelDesign.Bold})).setTemplate(new sap.ui.commons.TextView({id:t.getId()+"--"+t.inboxUtils.scrub(a.Name)+"textView",text:{parts:t.oController.getCustomAttributeColumnParts(a.Name),formatter:t.oController.getCustomAttributeColumnFormatter(t)}}).data(o,a.Name).setTextAlign(l));if(t.oController.isFilterOnCustomAttributesSupported()){r.setFilterProperty(a.Name)}if(t.bAllowCustomAttributeSort){r.bindProperty("sortProperty","CustomAttributeData",function(e){return"CustomAttributeData/"+this.data("customAttrName")})}}else{if(i.indexOfColumn(r)===-1){var u=r.getLabel();if(u.getText()!==a.Label){u.setText(a.Label)}}}i.insertColumn(r,s+1);s++});this.resizeColumns()};sap.uiext.inbox.Inbox.prototype._deleteCustomAttributeColumns=function(e){var t=this._getComponent("listViewTable");var i=t.getColumns();for(var a=0;a<i.length;a++){var o=i[a];if(jQuery.inArray(this._removeParentID(o.getId()),this._getCategoryMetadata().properties)===-1){t.removeColumn(o);o.destroy()}}};sap.uiext.inbox.Inbox.prototype.applyDrillDownFilterForDueDate=function(e,t){var i,a,o,s,r,n;var l=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME_TODAY");var u=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME_MONTH");var d=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME_15DAYS");var p=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME_WEEK");var c=sap.ui.getCore().byId(t.getId()+"--"+"INBOX_FILTER_NO_DUE_DATETIME");t.resetSearchCriteria();t.clearFiltersForDueDate();if(!e.getParameter("all")){var g=e.getParameter("selectedItems");var f=new Date(0);for(var h=0;h<g.length;h++){switch(g[h].getId()){case t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME_TODAY":var I=t.getFormattedDueDateTimeOff(1);if(i===undefined){i=new sap.ui.model.odata.Filter("CompletionDeadLine",[{operator:sap.ui.model.FilterOperator.LE,value1:I},{operator:sap.ui.model.FilterOperator.GE,value1:f}],true)}t.filtersToApply["dueDateToday"]=i;delete t.filtersToApply.next30;delete t.filtersToApply.next15;delete t.filtersToApply.next7;delete t.filtersToApply.noDueDate;break;case t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME_MONTH":var I=t.getFormattedDueDateTimeOff(30);if(a===undefined){a=new sap.ui.model.odata.Filter("CompletionDeadLine",[{operator:sap.ui.model.FilterOperator.LE,value1:I},{operator:sap.ui.model.FilterOperator.GE,value1:f}],true)}t.filtersToApply["dueDatenext30"]=a;delete t.filtersToApply.dueDateToday;delete t.filtersToApply.next15;delete t.filtersToApply.next7;delete t.filtersToApply.noDueDate;break;case t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME_15DAYS":var I=t.getFormattedDueDateTimeOff(15);if(o===undefined){o=new sap.ui.model.odata.Filter("CompletionDeadLine",[{operator:sap.ui.model.FilterOperator.LE,value1:I},{operator:sap.ui.model.FilterOperator.GE,value1:f}],true)}t.filtersToApply["dueDatenext15"]=o;delete t.filtersToApply.dueDateToday;delete t.filtersToApply.next30;delete t.filtersToApply.next7;delete t.filtersToApply.noDueDate;break;case t.getId()+"--"+"INBOX_FILTER_DUE_DATETIME_WEEK":var I=t.getFormattedDueDateTimeOff(7);if(s===undefined){s=new sap.ui.model.odata.Filter("CompletionDeadLine",[{operator:sap.ui.model.FilterOperator.LE,value1:I},{operator:sap.ui.model.FilterOperator.GE,value1:f}],true)}t.filtersToApply["dueDatenext7"]=s;delete t.filtersToApply.dueDateToday;delete t.filtersToApply.next30;delete t.filtersToApply.next15;delete t.filtersToApply.noDueDate;break;case t.getId()+"--"+"INBOX_FILTER_NO_DUE_DATETIME":if(n===undefined){n=new sap.ui.model.Filter("CompletionDeadLine",sap.ui.model.FilterOperator.EQ,null)}t.filtersToApply["noDueDate"]=n;delete t.filtersToApply.dueDateToday;delete t.filtersToApply.next30;delete t.filtersToApply.next15;delete t.filtersToApply.next7;break}}}t.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype._getSelectedContextsBeforeRequest=function(){return this.selectedContexts};sap.uiext.inbox.Inbox.prototype._setVisibility=function(e,t){var i=this._getComponent(e);if(i){i.setVisible(t)}};sap.uiext.inbox.Inbox.prototype.changeToolbarOnFilterCategory=function(){var e=this._getComponent("settingsButton");var t=this._getSelectedCategory();switch(t){case"INBOX_FILTER_CATEGORY_TASKS":e.setEnabled(true);break;case"INBOX_FILTER_CATEGORY_TODO":e.setEnabled(false);break;case"INBOX_FILTER_CATEGORY_ALERT":e.setEnabled(false);break;case"INBOX_FILTER_CATEGORY_NOTIFICATION":e.setEnabled(false);break;default:e.setEnabled(true)}};sap.uiext.inbox.Inbox.prototype.showAllActions=function(){this._setVisibility("claimActionButton",true);this._setVisibility("releaseActionButton",true);this._setVisibility("openActionButton",true);this._setVisibility("forwardActionButton",true);this._setVisibility("rrViewClaimAction",true);this._setVisibility("rrViewReleaseAction",true);this._setVisibility("rrViewForwardAction",true);this._setVisibility("dotSeparator",true);this._setVisibility("dotSeparator2",true)};sap.uiext.inbox.Inbox.prototype.hideAllActionButtonsandLinks=function(){if(this.getOpenCompletedTasks()==false){this._setVisibility("openActionButton",false)}this._setVisibility("claimActionButton",false);this._setVisibility("releaseActionButton",false);this._setVisibility("forwardActionButton",false);this._setVisibility("rrViewClaimAction",false);this._setVisibility("rrViewReleaseAction",false);this._setVisibility("rrViewForwardAction",false);this._setVisibility("dotSeparator",false);this._setVisibility("dotSeparator2",false)};sap.uiext.inbox.Inbox.prototype.showAllActionButtonsandLinks=function(){if(this.typeOfModel==="OData"){var e=this.constants.ENTITY_NAME_TASK_COLLECTION;this._setVisibility("openActionButton",false);if(this.oTcmMetadata._isPropertyAvailable(e,"SupportsClaim")){this._setVisibility("claimActionButton",true);this._setVisibility("rrViewClaimAction",true)}if(this.oTcmMetadata._isPropertyAvailable(e,"SupportsRelease")){this._setVisibility("releaseActionButton",true);this._setVisibility("rrViewReleaseAction",true);this._setVisibility("dotSeparator",true)}if(this.oTcmMetadata._isPropertyAvailable(e,"SupportsForward")&&this.isForwardActionEnabled){this._setVisibility("forwardActionButton",true);this._setVisibility("dotSeparator2",true);this._setVisibility("rrViewForwardAction",true)}}else{this.showAllActions()}};sap.uiext.inbox.Inbox.prototype._handleActionButtonsEnable=function(e){if(e.length>0&&!(jQuery.inArray(false,e)>-1)){return true}else{return false}};sap.uiext.inbox.Inbox.prototype.disableActionButtonsOnMultiStatus=function(e,t){var i=this._getComponent("claimActionButton");var a=this._getComponent("releaseActionButton");var o=this._getComponent("forwardActionButton");var s=this._getComponent("openActionButton");var r=this._isCompletedTasksSelected();var n=this.getOpenCompletedTasks();var l=t.aSupportsClaim;var u=t.aSupportsForward;var d=t.aSupportsRelease;if(!n&&r){s.setVisible(false)}else{s.setVisible(true)}if(e.length>0&&!jQuery.inArray("COMPLETED",e)>-1){s.setEnabled(true)}else{if(this.getOpenCompletedTasks()==true){s.setEnabled(true)}else{s.setEnabled(false)}}i.setEnabled(this._handleActionButtonsEnable(l));a.setEnabled(this._handleActionButtonsEnable(d));o.setEnabled(this._handleActionButtonsEnable(u))};sap.uiext.inbox.Inbox.prototype.dateFormat=function(e,t){if(e!=undefined&&typeof e=="string"&&e!=""){var i;if(e.indexOf("Date")!=-1){i=new Date;i.setTime(e.substring(e.indexOf("(")+1,e.indexOf(")")))}else{i=new Date(e.substring(e.indexOf("'")+1,e.length-1))}e=i}if(e!=undefined&&e!=""){var a=sap.ui.core.format.DateFormat.getDateInstance({style:"medium"});if(t!==undefined&&t===false){a=sap.ui.core.format.DateFormat.getDateInstance({pattern:"MMM dd",style:"medium"})}return a.format(e)}return""};sap.uiext.inbox.Inbox.prototype.tooltipFormatForDateTime=function(e){if(e!=undefined&&typeof e=="string"&&e!=""){var t;if(e.indexOf("Date")!=-1){t=new Date;t.setTime(e.substring(e.indexOf("(")+1,e.indexOf(")")))}else{t=new Date(e.substring(e.indexOf("'")+1,e.length-1))}e=t}if(e!=undefined&&e!=""){var i=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"full"});return i.format(e)}return""};sap.uiext.inbox.Inbox.prototype.executeActionOnTask=function(e,t){var i=t.inbox;var a=t.view;var o=t.action;var s=o===i.constants.FORWARD?true:false;var r=s?t.forwardTo:"";i.showBusyLoader();var n,l,u;var d=[],p=[],c=[],g=[];var f=[];var h,I;var m,b;i.resetSearchCriteria();u=i.getCoreModel();if(a===i.constants.tableView){n=sap.ui.getCore().byId(i.getId()+"--"+"listViewTable");if(e.getSource())var x=i.getlistTableSelectedIndices();jQuery.each(x,function(e,t){l=n.getContextByIndex(t);p.push(l);m=u.getProperty("InstanceID",l);b=u.getProperty("SAP__Origin",l);d.push(m);c.push(b);if(e==0){h=m;I=b}else{h=h+";"+m;I=I+";"+b}})}else if(a===i.constants.rowRepeaterView){var y=e.getSource().getBindingContext();var T=e.getSource().getParent().getParent().getParent().getParent().getParent().getParent();m=u.getProperty("InstanceID",y);b=u.getProperty("SAP__Origin",y);d.push(m);c.push(b);h=m;I=b;p.push(y)}if(d!=null||d.length>0){var _,C,v,S;if(o==="Claim"){o="Claim"}if(o==="Release"){o="Release"}if(s){o="Forward"}var w=e.getParameters();w.action=o;w.selectedIDs=h;w.selectedSAPOrigins=I;w.selectedIDList=d;w.selectedSAPOriginList=c;w.selectedContextList=p;if(T){w.oRow=T}if(s){w.selectedForwardToUsers=r}i.fireTaskAction(w);if(i.clientUpdate===undefined&&i.typeOfModel!=="OData"){i.applyFilterOnResponse(p)}}i.resetMessages=false;if(i.clientUpdate){i.resetMessages=true}};sap.uiext.inbox.Inbox.prototype.defaultActionHandler=function(e,t){var i=t.constants;var a=e.getParameter("action");var o=e.getParameter("selectedIDs");var s=e.getParameter("selectedSAPOrigins");var r=e.getParameter("selectedIDList");var n=e.getParameter("selectedSAPOriginList");var l=e.getParameter("commentsList");var u=a===t.constants.FORWARD?true:false;var d=e.getParameter("selectedContextList");var p=e.getParameter("oRow");var c=e.getParameter("selectedForwardToUsers");var g=r.length;var f=g;if(g>1&&t.isBatchOperationSupported){var h=[];for(var I=0;I<g;I++){var m={};m.InstanceID="'"+r[I]+"'";m.SAP__Origin="'"+n[I]+"'";if(l&&l.length>0){m.Comments="'"+l[I]+"'"}if(u){m.ForwardTo="'"+e.getParameter("selectedForwardToUsers")+"'"}h.push(m)}var b=function(e,i){t.processTaskActionBatchResponse(d,e,a,c)};var x=function(e){t._handleErrorOnBatchRequests(e,a,f)};this.oDataManager.fireBatchRequest({sPath:a,sMethod:"POST",sBatchGroupId:"standardActionBatch",aUrlParameters:h,numberOfRequests:g,fnSuccess:b,fnError:x})}else{var y={};y.InstanceID=decodeURIComponent(o);y.SAP__Origin=s;if(u)y.ForwardTo=e.getParameter("selectedForwardToUsers");var b=function(e,i){if(t.clientUpdate){var o=[],s=[];t.hideBusyLoader();t.selectedContexts=d;var r=t._getAppliedStatusFilterValues();if(a==="Forward"||r.length>0&&jQuery.inArray(e.Status,r)===-1){if(p)o.push({orow:p,context:d[0]});else o.push(d[0])}s.push({context:d[0],keys:[{key:"Status",value:e.Status},{key:"IsEscalated",value:e.IsEscalated}]});t._refreshLocal(o,s,true)}if(t.clientUpdate===undefined)t.applyFilterOnResponse(d);if(a==="Forward")t.showMessage("success",t._oBundle.getText("INBOX_MSG_FORWARD_ACTION_SUCCESS",[e.TaskTitle,c]));else t.showMessage("success",t._oBundle.getText("INBOX_MSG_ACTION_SUCCESS",[a,e.TaskTitle]))};var x=function(e){t._handleErrorOnActionFailed(e,a,t.getCoreModel().getProperty("TaskTitle",d[0]))};t.oDataManager.callFunctionImport(a,{method:"POST",urlParameters:y,success:b,error:x},true)}};sap.uiext.inbox.Inbox.prototype.processTaskActionBatchResponse=function(e,t,i,a){var o=t.__batchResponses;var s,r,n,l,u,d;var p=0,c=0,g=[],f=[];for(s=0,l=o.length;s<l;s++){var h=o[s].__changeResponses;if(h){for(r=0,n=h.length;r<n;r++){var I=h[r];if(n===1){u=I.data.TaskDefinitionName}d=!(I.statusCode>=200&&I.statusCode<=202);if(d){p=p+1}else{c=c+1}}}else{p=p+1}}if(this.clientUpdate===undefined){this.applyFilterOnResponse(e)}this.displayMessageAfterExecutingAction(i,u,p,c,a)};sap.uiext.inbox.Inbox.prototype.displayMessageAfterExecutingAction=function(e,t,i,a,o){if(i>0){var s=i===1?this._oBundle.getText("INBOX_MSG_ACTION_FAILED",[e,i]):this._oBundle.getText("INBOX_MSG_ACTION_FAILED_MULTIPLE_TASKS",[e,i]);this.showMessage("error",s)}if(a===1){var r=e==="Forward"?this._oBundle.getText("INBOX_MSG_FORWARD_ACTION_SUCCESS",[t,o]):this._oBundle.getText("INBOX_MSG_ACTION_SUCCESS",[e,t]);this.showMessage("success",r)}if(a>1){this.showMessage("success",this._oBundle.getText("INBOX_MSG_ACTION_SUCCESS_MULTIPLE_TASKS",[e,a]))}};sap.uiext.inbox.Inbox.prototype.fillAttributes=function(){var e=this;var t=sap.ui.getCore().byId(this.getId()+"--"+"filterFacet");if(t!=undefined){var i=e.applyTaskCategoryFilter?e.constants.aDrillDownFilterMetadata[1].attributes:e.bShowNoDueDateFilter?e.constants.aFilterMetaDataWithNoDueDate[0].attributes:e.constants.aFilterMetaData[0].attributes;var a=e.applyTaskCategoryFilter?t.getLists()[1]:t.getLists()[0];if(a===undefined||a===null)return;var o=a.getItems();jQuery.each(o,function(t,o){var s=e.inboxUtils.inArray(o.getKey(),i);if(o.getKey()!="sapUiFacetFilter_ALL"){if(s===-1){a.removeItem(o)}else{i.splice(s,1)}}});if(i.length>0){jQuery.each(i,function(t,i){var o=e.inboxUtils.scrub(i.key);var s=sap.ui.getCore().byId(e.getId()+"--"+o);if(s===undefined)s=new sap.ui.core.ListItem(e.getId()+"--"+o,{text:i.value,key:i.key}).data("InstanceID",i.instanceID).data("SAP__Origin",i.sap__Origin);a.addItem(s)})}}};sap.uiext.inbox.Inbox.prototype.resetFilterView=function(e){var t;if(this.filtersToApply.dropDownFilter){t=this.filtersToApply.dropDownFilter}else if(this.filtersToApply.resStat!=undefined||this.filtersToApply.readyStat!=undefined||this.filtersToApply.InProStat!=undefined){t=new sap.ui.model.Filter("Status",sap.ui.model.FilterOperator.NE,"COMPLETED")}this.filtersToApply={};if(t!=undefined){this.filtersToApply.dropDownFilter=t}var i=this.bShowNoDueDateFilter?sap.uiext.inbox.InboxConstants.aFilterMetaDataWithNoDueDate:sap.uiext.inbox.InboxConstants.aFilterMetaData;for(var a=0;a<i.length;a++){var o=sap.ui.getCore().byId(this.getId()+"--"+i[a].name);if(o!=undefined)o.setSelectedKeys(["sapUiFacetFilter_ALL"])}if(e)this.applyFilterOnResponse(null)};sap.uiext.inbox.Inbox.prototype.getlistTableSelectedIndices=function(){var e=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");return e.getSelectedIndices()};sap.uiext.inbox.Inbox.prototype.getCoreModel=function(){if(!this._oModel){this._oModel=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable").getModel()}return this._oModel};sap.uiext.inbox.Inbox.prototype.getnavigateTaskExecMetadata=function(){var e=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");var t=[];var i=[];var a=[];var o=[];var s=[];var r=this.getlistTableSelectedIndices();var n=this.getCoreModel();jQuery.each(r,function(t,r){var l=e.getContextByIndex(r);s.push(l);i.push(n.getProperty("InstanceID",l));a.push(n.getProperty("TaskTitle",l));o.push(n.getProperty("SAP__Origin",l))});if(this.getTaskExecutionURLCallBack!=""&&this.getTaskExecutionURLCallBack!=undefined&&this.getTaskExecutionURLCallBack!==null){var l=this.getTaskExecutionURLCallBack(i[0],o[0]);if(l!==null&&l.replace(/\s/g,"").length>0){t.push(l)}}else{t.push("")}return{aSelectedContexts:s,arrayURLs:t,arrayIDs:i,arrayTitles:a,aTaskSAPOrigins:o}};sap.uiext.inbox.Inbox.prototype.getlistTableSelectedContexts=function(){var e=[];var t=this.getlistTableSelectedIndices();var i=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");jQuery.each(t,function(t,a){e.push(i.getContextByIndex(a))});return e};sap.uiext.inbox.Inbox.prototype.showBusyLoader=function(){sap.ui.core.BusyIndicator.show(0);var e=jQuery.sap.byId("busy_loader");e.css("position","absolute");e.css("top","50%");e.css("left","50%");e.css("display","");e.show();e.css("z-index",99)};sap.uiext.inbox.Inbox.prototype.hideBusyLoader=function(){sap.ui.core.BusyIndicator.hide();var e=jQuery.sap.byId("busy_loader");e.css("display","none");e.css("z-index",-1)};sap.uiext.inbox.Inbox.prototype.resetSearchCriteria=function(){var e=sap.ui.getCore().byId(this.getId()+"--"+"searchField");e.setValue("")};sap.uiext.inbox.Inbox.prototype.loadExecImages=function(){var e=this._imgResourcePath+sap.uiext.inbox.InboxConstants.prevBtnImage;var t=this._imgResourcePath+sap.uiext.inbox.InboxConstants.nxtBtnImage;jQuery.ajax({url:e,type:"GET",async:true,success:function(e,t,i){},error:function(e,t,i){}});jQuery.ajax({url:t,type:"GET",async:true,success:function(e,t,i){},error:function(e,t,i){}})};sap.uiext.inbox.Inbox.prototype.setNoOfRowsOnTable=function(e){var t=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");if(t!=undefined)t.setVisibleRowCount(parseInt(e))};sap.uiext.inbox.Inbox.prototype.showMessage=function(e,t){var i=this;var a=sap.ui.getCore().byId(this.getId()+"--"+"notificationBar");var o=sap.ui.getCore().byId(this.getId()+"--"+"messageNotifier");if(a!=undefined){a.setVisibleStatus(sap.ui.ux3.NotificationBarStatus.Default);var s=new Date;var r=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"medium"});var n=r.format(s);var l=new sap.ui.core.Message({text:t,timestamp:n});if(e==="success"){l.setLevel(sap.ui.core.MessageType.Success)}else if(e==="info"){l.setLevel(sap.ui.core.MessageType.Information)}else if(e==="error"){l.setLevel(sap.ui.core.MessageType.Error)}else if(e==="warning"){l.setLevel(sap.ui.core.MessageType.Warning)}o.addMessage(l);a.setMessageNotifier(o);jQuery.sap.delayedCall(0,this,function(){a._oItemNavigation.focusItem(1)})}};sap.uiext.inbox.Inbox.prototype.deleteMessage=function(e,t){if(t===undefined)t=this;var i=sap.ui.getCore().byId(t.getId()+"--"+"notificationBar");var a=sap.ui.ux3.NotificationBarStatus.Min;if(i!=undefined&&i.hasItems()){i.setVisibleStatus(a)}};sap.uiext.inbox.Inbox.prototype.getFormattedDateTimeOff=function(e,t){var i=new Date;i.setDate(i.getDate()-e);if(!t){i.setHours(0);i.setSeconds(0);i.setMinutes(i.getTimezoneOffset())}return i};sap.uiext.inbox.Inbox.prototype.getFormattedDueDateTimeOff=function(e){var t=new Date;t.setDate(t.getDate()+e);t.setHours(0);t.setSeconds(0);t.setMinutes(t.getTimezoneOffset());return t};sap.uiext.inbox.Inbox.prototype.refreshTaskTypes=function(){if(this.dynamicTaskTypeFilterCallBack){if(this.applyTaskCategoryFilter){this.constants.aDrillDownFilterMetadata[1].attributes=this.dynamicTaskTypeFilterCallBack()}else if(this.bShowNoDueDateFilter){this.constants.aFilterMetaDataWithNoDueDate[0].attributes=this.dynamicTaskTypeFilterCallBack()}else{this.constants.aFilterMetaData[0].attributes=this.dynamicTaskTypeFilterCallBack()}this.fillAttributes();return}var e=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");var t=[];var i={};var a;if(this.getHandleBindings()){var o=this._currentViewElement().getBinding("rows");var s=this._currentViewElement().getBinding("rows").getContexts(null,o.iLength);var r=this.getCoreModel();jQuery.each(s,function(e,o){a={key:r.getProperty("TaskDefinitionID",o),value:r.getProperty("TaskDefinitionName",o),sap__Origin:r.getProperty("SAP__Origin",o)};if(!i[a.key]){i[a.key]=true;t.push(a)}})}else{var n=this._currentViewElement().getBinding("rows");if(n&&n.oList){jQuery.each(n.oList,function(e,o){a={key:o.TaskDefinitionID,value:o.TaskDefinitionName};if(!i[a.key]){i[a.key]=true;t.push(a)}})}}if(t.length>0){if(this.applyTaskCategoryFilter){this.constants.aDrillDownFilterMetadata[1].attributes=t}else if(this.bShowNoDueDateFilter){this.constants.aFilterMetaDataWithNoDueDate[0].attributes=t}else{this.constants.aFilterMetaData[0].attributes=t}this.fillAttributes()}};sap.uiext.inbox.Inbox.prototype.onAfterRendering=function(){var e=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable").$();e.find("a:disabled").addClass("sapUiExtInboxLnkDsbl")};sap.uiext.inbox.Inbox.prototype._getComponent=function(e){return sap.ui.getCore().byId(this.getId()+"--"+e)};sap.uiext.inbox.Inbox.prototype._removeParentID=function(e){var t=this.getId();return e.replace(this.getId()+"--","")};sap.uiext.inbox.Inbox.prototype.populateViewButtonsContainer=function(e){var t=new sap.ui.commons.layout.MatrixLayoutCell({id:this.getId()+"--"+"segmentedButtonCell"});var i=new sap.ui.commons.SegmentedButton({id:this.getId()+"--"+"viewSelectionSegBtn",buttons:[new sap.ui.commons.Button({id:this.getId()+"--"+"tableViewSelectionButton",height:"20px",lite:true,icon:this.constants.tableViewImageSelected,iconHovered:this.constants.tableViewImageSelected,iconSelected:this.constants.tableViewImageSelected,tooltip:this._oBundle.getText("INBOX_LIST_VIEW_TOOLTIP")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected"),new sap.ui.commons.Button({id:this.getId()+"--"+"rrViewSelectionButton",height:"20px",lite:true,icon:this.constants.rrViewImageSelected,iconHovered:this.constants.rrViewImageSelected,iconSelected:this.constants.rrViewImageSelected,tooltip:this._oBundle.getText("INBOX_STREAM_VIEW_TOOLTIP")}).addStyleClass("sapUiExtInboxSegmentedButtonViewSelection")]});i.setSelectedButton(this.getId()+"--"+"tableViewSelectionButton");i.attachSelect(this,this.switchViews);i.addStyleClass("sapUiExtInboxToolBarContainerHeight");t.addContent(i);t.setPadding(sap.ui.commons.layout.Padding.None);e.createRow(t)};sap.uiext.inbox.Inbox.prototype.updateStylingOnSwitchingView=function(e,t){var i=t.getSource().getButtons();var a;for(var o=0;o<i.length;o++){a=i[o];if(e.getId()!=a.getId()){a.addStyleClass("sapUiExtInboxSegmentedButtonViewSelection");a.removeStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}else{a.removeStyleClass("sapUiExtInboxSegmentedButtonViewSelection");a.addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}}};sap.uiext.inbox.Inbox.prototype.switchViews=function(e,t){var i=t;i.resetSearchCriteria();var a=i.currentView;var o=sap.ui.getCore().byId(e.getSource().getSelectedButton());var s=i.getId()+"--"+"tableViewSelectionButton";var r=i.getId()+"--"+"rrViewSelectionButton";var n=sap.ui.getCore().byId(i.getId()+"--"+"listViewTable");var l=sap.ui.getCore().byId(i.getId()+"--"+"tableRowSettingLayoutContainer");var u=sap.ui.getCore().byId(i.getId()+"--"+"tasksRowRepeater");var d=sap.ui.getCore().byId(i.getId()+"--"+"verticalLayoutContainer");var p=sap.ui.getCore().byId(i.getId()+"--"+"actionButtonsToolbarContainer");var c=sap.ui.getCore().byId(i.getId()+"--"+"rrToolbar");var g=sap.ui.getCore().byId(i.getId()+"--"+"rowRepeaterToolsMatLayout");var f=sap.ui.getCore().byId(i.getId()+"--"+"rowRepeaterPaginator");var h=i._currentViewElement();var I=h.getBinding("rows");var m=false,b=true,x;var y=i.oModel instanceof sap.ui.model.json.JSONModel;i.updateStylingOnSwitchingView(o,e);if(i.applyTaskCategoryFilter){if(o.getId()==s){i._modifyFacetFilterOnFilterCategory()}else if(o.getId()==r){i._modifyFacetFilterOnFilterCategory(true)}}if(I&&I.sFilterParams&&I.sFilterParams.indexOf("TaskDefinitionID")!==-1){m=true;var T=i._getComponent("INBOX_FILTER_TASK_TYPE");x=T.getSelectedKeys()}if(i.clientUpdate&&i._isTaskDefinitionFilterApplied()){m=true;var T=i._getComponent("INBOX_FILTER_TASK_TYPE");x=T.getSelectedKeys()}if(o.getId()===s){i.currentView=i.constants.tableView;o.setIcon(i.constants.tableViewImageSelected);var _=sap.ui.getCore().byId(r);_.setIcon(i.constants.rrViewImageSelected);p.setVisible(true);n.setVisible(true);c.setVisible(false);u.setVisible(false);g.setVisible(false);l.setVisible(true);if(m&&x&&x.length===1){var C=T.getItems();var v=x[0];var S=[];for(var w=0;w<C.length;w++){if(v===C[w].getKey()){S.push(C[w]);break}}i._createCustomAttributes(S)}}if(o.getId()===r){i.currentView=i.constants.rowRepeaterView;if(i._isTableFiltered){i._removeTableFilters()}o.setIcon(i.constants.rrViewImageSelected);var A=sap.ui.getCore().byId(s);A.setIcon(i.constants.tableViewImageSelected);if(i.isCustomAttributesEnabled){var B=i._getComponent("customAttributesSegBtn");if(B&&!B.getVisible()){B.setVisible(true)}}p.setVisible(false);n.setVisible(false);l.setVisible(false);if(u.getModel()===undefined||u.getModel()===null){u.setModel(i.getModel())}c.setVisible(true);u.setVisible(true);g.setVisible(true);if(u.getBinding("rows")){var O=u.getBinding("rows").iLength;i._updatePaginator(O)}else{if(e.getParameters().triggeredFrom===undefined){var R=i._getComponent("rrMainMatrixLayout");var E=new sap.ui.model.Sorter("CreatedOn",true);var F=i._getFilterArray();if(i.isCustomActionsEnabled){i._deleteCustomActions();var D=i._isCompletedTasksSelected();if(!D&&m){if(x&&x.length===1){var C=T.getItems();var v=x[0];var L;for(var w=0;w<C.length;w++){if(v===C[w].getKey()){L=C[w].data("SAP__Origin");break}}}}}var P=i._getBindingParameters();u.bindRows({path:i.sCollectionPath,template:R,parameters:P,sorter:E,filters:F});b=false;if(y){var M=u.getBinding("rows").iLength;i._updatePaginator(M)}}}}if(window.history.replaceState){var N=window.location.search;var k=i.constants.defaultView_URLParameter;if(N.indexOf(k)!=-1){N=N.replace(k+"="+a,k+"="+i.currentView);var U=window.location.pathname.substring(window.location.pathname.lastIndexOf("/")+1);window.history.replaceState(null,null,U+N)}}i.inboxUtils.setCookieValue(i.constants.defaultView_URLParameter,i.currentView,1);if(b){if(i.isCustomActionsEnabled){i._deleteCustomActions();var D=i._isCompletedTasksSelected();if(!D&&m){if(x&&x.length===1){var C=T.getItems();var v=x[0];var L;for(var w=0;w<C.length;w++){if(v===C[w].getKey()){L=C[w].data("SAP__Origin");break}}}i.applyFilterOnResponse(null,true)}else{i.applyFilterOnResponse(null)}}else{if(e.getParameters().triggeredFrom===undefined){if(y&&i.currentView===i.constants.rowRepeaterView){i.applyFilterOnResponse(null,true)}else{i.applyFilterOnResponse(null)}}}}};sap.uiext.inbox.Inbox.prototype.createOtherActions=function(e){var t=e;var i=new sap.ui.commons.ToggleButton({id:t.getId()+"--"+"attachmentsSegBtn",visible:false,lite:true,icon:t._imgResourcePath+sap.uiext.inbox.InboxConstants.attachmentsImage,tooltip:this._oBundle.getText("INBOX_SHOW_ATTACHMENTS")}).bindProperty("visible","SupportsAttachments",function(e){if(e)return e;else return false}).attachPress(this,function(e,t){t._handleActionButtonToggleinRowRepeater(e)});var a=new sap.ui.commons.ToggleButton({id:t.getId()+"--"+"commentsSegBtn",visible:false,lite:true,icon:this.constants.commentsImage,tooltip:this._oBundle.getText("INBOX_SHOW_COMMENTS")}).addStyleClass("sapUiExtInboxRowRepCommentIconColor");var o=new sap.ui.commons.ToggleButton({id:t.getId()+"--"+"customAttributesSegBtn",enabled:true,pressed:false,lite:true,visible:false,tooltip:this._oBundle.getText("INBOX_SHOW_CUSTOM_ATTRIBUTES"),icon:this.constants.iconPool.getIconURI("expand")});o.bindProperty("visible",t.constants.TaskCollection.properties.instanceID,function(e){if(t.isCustomAttributesEnabled){return true}if(e&&t.bCustomAttributesVisible){var i=this.getId();var a=/\d+$/;var o=a.exec(i);var s=t.getCoreModel();var r=this.getBindingContext();var n=t.getModel().getProperty(t.constants.TaskDefinitionCollection.properties.taskDefnID,r);var l=t.getModel().getProperty(t.constants.TaskCollection.properties.instanceID,r);var u=t.getModel().getProperty(t.constants.sapOrigin,r);t._getCustomAttributeContentforRowRepeater(null,o[0],n,l,u);this.setIcon(t.constants.iconPool.getIconURI("collapse"));this.setTooltip(t._oBundle.getText("INBOX_HIDE_CUSTOM_ATTRIBUTES"));this.setPressed(true);return true}return false});var s=new sap.ui.commons.layout.MatrixLayoutCell(t.getId()+"--"+"rrCustomAttrButtonCell",{hAlign:sap.ui.commons.layout.HAlign.End});s.addContent(o);var r=new sap.ui.commons.layout.MatrixLayout(t.getId()+"--"+"rrOtherActionsMatLay",{layoutFixed:false,columns:4,width:"5%"});r.createRow(i,a,s);o.attachPress(this,function(e,t){t._handleActionButtonToggleinRowRepeater(e)});return r};sap.uiext.inbox.Inbox.prototype._isOverDue=function(e){if(e===undefined||e===null||e==="")return false;var t=(new Date).getTime();var i=e.getTime()-t<0?true:false;return i};sap.uiext.inbox.Inbox.prototype._currentView=function(){return this.currentView};sap.uiext.inbox.Inbox.prototype.createRowRepeaterToolBar=function(e){var t=e;var i=sap.ui.getCore().byId(this.getId()+"--"+"rrToolbar");var a=sap.ui.getCore().byId(this.getId()+"--"+"tasksRowRepeater");if(!i){var i=new sap.ui.commons.Toolbar(this.getId()+"--"+"rrToolbar");i.setDesign(sap.ui.commons.ToolbarDesign.Standard);i.addStyleClass("sapUiExtInboxActionButtonsToolbarContainer");var o=0;if(sap.ui.getCore().byId(this.getId()+"--"+"sortByLabel")===undefined){var s=new sap.ui.commons.Label(this.getId()+"--"+"sortByLabel",{text:this._oBundle.getText("INBOX_SORT_BY_LABEL")+sap.uiext.inbox.InboxConstants.COLON,design:sap.ui.commons.LabelDesign.Bold});i.insertItem(s,o)}var r=new sap.ui.commons.DropdownBox(this.getId()+"--"+"sortByFilterComboBox",{tooltip:this._oBundle.getText("INBOX_SORT_BY_LABEL"),items:[new sap.ui.core.ListItem(this.getId()+"--"+"li_creationDate",{text:this._oBundle.getText("INBOX_FILTER_CREATION_DATE"),tooltip:this._oBundle.getText("INBOX_SORT_BY_LABEL")+" "+this._oBundle.getText("INBOX_FILTER_CREATION_DATE")}),new sap.ui.core.ListItem(this.getId()+"--"+"li_taskTitle",{text:this._oBundle.getText("INBOX_TASK_TITLE"),tooltip:this._oBundle.getText("INBOX_SORT_BY_LABEL")+" "+this._oBundle.getText("INBOX_TASK_TITLE")}),new sap.ui.core.ListItem(this.getId()+"--"+"li_status",{text:this._oBundle.getText("INBOX_STATUS"),tooltip:this._oBundle.getText("INBOX_SORT_BY_LABEL")+" "+this._oBundle.getText("INBOX_STATUS")})]});r.setValue(this._oBundle.getText("INBOX_FILTER_CREATION_DATE"));r.addStyleClass("sapUiExtInboxRowRepeaterSortBy");var n=new sap.ui.commons.RowRepeaterSorter(this.getId()+"--"+"sortByStartDate",{sorter:new sap.ui.model.Sorter("CreatedOn",true)});var l=new sap.ui.commons.RowRepeaterSorter(this.getId()+"--"+"sortByTaskTitle",{sorter:new sap.ui.model.Sorter("TaskTitle",true)});var u=new sap.ui.commons.RowRepeaterSorter(this.getId()+"--"+"sortByStatus",{sorter:new sap.ui.model.Sorter("Status",true)});a.addSorter(n);a.addSorter(l);a.addSorter(u);r.attachChange(this,function(e,i){var o=i._getComponent("li_empty");if(this.indexOfItem(o)!==-1)this.removeItem(o);var s=e.getSource().getSelectedItemId();t.resetSearchCriteria();var r;if(s===i.getId()+"--"+"li_creationDate"){r=sap.ui.getCore().byId(t.getId()+"--"+"sortByStartDate").getSorter();r.bDescending=!r.bDescending;a.triggerSort(t.getId()+"--"+"sortByStartDate")}else if(s===i.getId()+"--"+"li_taskTitle"){r=sap.ui.getCore().byId(t.getId()+"--"+"sortByTaskTitle").getSorter();r.bDescending=!r.bDescending;a.triggerSort(t.getId()+"--"+"sortByTaskTitle")}else if(s===i.getId()+"--"+"li_status"){r=sap.ui.getCore().byId(t.getId()+"--"+"sortByStatus").getSorter();r.bDescending=!r.bDescending;a.triggerSort(t.getId()+"--"+"sortByStatus")}t._updateRowRepeaterSortImage(r.bDescending)});i.insertItem(r,o+1);var d=new sap.ui.commons.Button(this.getId()+"--"+"sortImage",{tooltip:this._oBundle.getText("INBOX_SORT_INDICATOR_DESC"),icon:sap.uiext.inbox.InboxConstants.sortDescImage});d.addStyleClass("sapUiExtInboxRefreshButtonHeight");d.attachPress(this,function(e,t){var i=t._getComponent("sortByFilterComboBox");var a=i.getSelectedItemId();var o=sap.ui.getCore().byId(t.getId()+"--"+"tasksRowRepeater");t.resetSearchCriteria();var s=t.constants.mRRSortMap[t._removeParentID(a)];var r=s?t._getComponent(s).getSorter():undefined;if(r){r.bDescending=!r.bDescending;o.triggerSort(t.getId()+"--"+s);t._updateRowRepeaterSortImage(r.bDescending);if(r.bDescending){this.setIcon(sap.uiext.inbox.InboxConstants.sortDescImage);this.setTooltip(t._oBundle.getText("INBOX_SORT_INDICATOR_DESC"))}else{this.setIcon(sap.uiext.inbox.InboxConstants.sortAscImage);this.setTooltip(t._oBundle.getText("INBOX_SORT_INDICATOR_ASC"))}}});i.insertItem(d,o+2);var p=sap.ui.getCore().byId(this.getId()+"--"+"toggleCustomAttributes");if(!p){var p=new sap.ui.commons.ToggleButton(this.getId()+"--"+"toggleCustomAttributes",{tooltip:this._oBundle.getText("INBOX_SHOW_ALL_CUSTOM_ATTRIBUTES"),icon:this.constants.iconPool.getIconURI("expand"),lite:true,visible:false,pressed:false});p.addStyleClass("sapUiExtInboxToggleButtonMarginRight");p.attachPress(t,t._toggleCustomAttributesVisibilityActionEvent);i.insertRightItem(p)}}return i};sap.uiext.inbox.Inbox.prototype.createRowRepeaterToolsContent=function(e){var t=e;var i=sap.ui.getCore().byId(t.getId()+"--"+"tasksRowRepeater");var a=new sap.ui.commons.layout.MatrixLayout(t.getId()+"--"+"rowRepeaterToolsMatLayout");var o=new sap.ui.commons.Paginator(t.getId()+"--"+"rowRepeaterPaginator");o.attachPage(t,function(e,t){t._handleRowRepeaterPaginatorClick(e)});var s=new sap.ui.commons.SegmentedButton({id:t.getId()+"--"+"rowRepeaterRowSettingsSegBtn",buttons:[new sap.ui.commons.Button({id:t.getId()+"--"+"5RowsSegBtn",lite:true,text:"5",tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_FIVE")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent"),new sap.ui.commons.Button({id:t.getId()+"--"+"10RowsSegBtn",lite:true,text:"10",tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_TEN")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent"),new sap.ui.commons.Button({id:t.getId()+"--"+"20RowsSegBtn",lite:true,text:"20",tooltip:this._oBundle.getText("INBOX_SET_NUMBER_OF_ROWS_TO")+" "+this._oBundle.getText("INBOX_NUMBER_TWENTY")}).addStyleClass("sapUiExtInboxSegmentedButtonTransparent")]});s.attachSelect(function(e){var a=parseInt(sap.ui.getCore().byId(e.getParameters().selectedButtonId).getText());var o=this.getButtons();for(var s=0;s<o.length;s++){o[s].removeStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}sap.ui.getCore().byId(e.getParameters().selectedButtonId).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected");i.setNumberOfRows(a);if(i.getBinding("rows")){var r=i.getBinding("rows").iLength;t._updatePaginator(r)}});if(t.rrViewRowCountValue!=null&&t.rrViewRowCountValue!=undefined){if(parseInt(t.rrViewRowCountValue)===5||parseInt(t.rrViewRowCountValue)===10||parseInt(t.rrViewRowCountValue)===20){s.fireSelect({selectedButtonId:t.getId()+"--"+parseInt(t.rrViewRowCountValue)+"RowsSegBtn"});s.setSelectedButton(t.getId()+"--"+parseInt(t.rrViewRowCountValue)+"RowsSegBtn");sap.ui.getCore().byId(s.getSelectedButton()).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}else{i.setNumberOfRows(parseInt(t.rrViewRowCountValue));if(i.getBinding("rows")){var r=i.getBinding("rows").iLength;t._updatePaginator(r)}}}else{s.setSelectedButton(t.getId()+"--"+"5RowsSegBtn");sap.ui.getCore().byId(s.getSelectedButton()).addStyleClass("sapUiExtInboxSegmentedButtonTransparentSelected")}var n=new sap.ui.commons.layout.MatrixLayoutCell(t.getId()+"--"+"separatorRRViewCell");var l=new sap.ui.commons.TextView({id:t.getId()+"--"+"separator",text:"|"});n.addContent(l);n.setPadding(sap.ui.commons.layout.Padding.None);var u=new sap.ui.commons.layout.BorderLayout(t.getId()+"--"+"borderLayout",{width:"100%",height:"40px"});u.createArea(sap.ui.commons.layout.BorderLayoutAreaTypes.center,o);u.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.center,{size:"55%",contentAlign:"right",visible:true});u.createArea(sap.ui.commons.layout.BorderLayoutAreaTypes.end,s);u.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.end,{size:"45%",contentAlign:"right",visible:true});a.createRow(new sap.ui.commons.TextView({text:" "}));a.createRow(u);return a};sap.uiext.inbox.Inbox.prototype._createCustomAttributesLayoutForRRView=function(e,t,i){var a=this;var o=this.getCoreModel();var s=1;var r=e.length;var n=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,width:"100%"});var l=new sap.ui.commons.layout.MatrixLayout;var u,d,p,c={size:"33.33%",overflowX:"hidden",overflowY:"hidden",contentAlign:"left",visible:true};jQuery.each(e,function(e,o){if(t[o.Name]){var n=a.getId()+"--"+"customattr"+"-label-"+"-row-"+i+"-index-"+(s-1);var g=a.getId()+"--"+"customattr"+"-value-"+"-row-"+i+"-index-"+(s-1);u=a.oCore.byId(n)||new sap.ui.commons.Label({id:n,text:o.Label}).data("customAttrName",o.Name);d=a.oCore.byId(g)||new sap.ui.commons.TextView({id:g}).data("customAttrName",o.Name);d.setText(t[o.Name]);u.setLabelFor(d);var f=a._createLabelValueMatrixLayout(u,d);var h=s%3;var I=h===1?sap.ui.commons.layout.BorderLayoutAreaTypes.begin:h===2?sap.ui.commons.layout.BorderLayoutAreaTypes.center:sap.ui.commons.layout.BorderLayoutAreaTypes.end;p=h===1?new sap.ui.commons.layout.BorderLayout({width:"100%",height:"18px"}):p;p.createArea(I,f);p.setAreaData(I,c);if(h===2&&s===r){p.createArea(sap.ui.commons.layout.BorderLayoutAreaTypes.end,new sap.ui.commons.TextView({text:" "}));p.setAreaData(sap.ui.commons.layout.BorderLayoutAreaTypes.end,c)}if(h===0||s===r){var m=new sap.ui.commons.layout.MatrixLayoutCell;m.addStyleClass("sapUiExtInboxPaddingBottom");m.addContent(p);l.createRow(m)}s++}});var g=(new sap.ui.commons.layout.MatrixLayoutCell).addContent(l).addStyleClass("sapUIExtInboxCustomAttributesBorder");n.createRow(g);return n};sap.uiext.inbox.Inbox.prototype._currentViewElement=function(){var e=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");var t=sap.ui.getCore().byId(this.getId()+"--"+"tasksRowRepeater");var i,a;if(this.currentView===sap.uiext.inbox.InboxConstants.tableView){a=e}else if(this.currentView===sap.uiext.inbox.InboxConstants.rowRepeaterView){a=t}return a};sap.uiext.inbox.Inbox.prototype._updatePaginator=function(e){var t=this._getComponent("rowRepeaterPaginator"),i=this._getComponent("rowRepeaterRowSettingsSegBtn"),a=this._getComponent("tasksRowRepeater");if(!t){var t=new sap.ui.commons.Paginator(this.getId()+"--"+"rowRepeaterPaginator");t.attachPage(this,function(e,t){t._handleRowRepeaterPaginatorClick(e)});var o=this._getComponent("borderLayout");if(o){var s=o.getCenter();if(s){s.addContent(t)}}}if(this.rrViewRowCountValue!=null&&this.rrViewRowCountValue!=undefined){t.setNumberOfPages(Math.ceil(e/parseInt(this.rrViewRowCountValue)))}else{var r=sap.ui.getCore().byId(i.getSelectedButton()).getText();t.setNumberOfPages(Math.ceil(e/r))}t.setCurrentPage(1);a.gotoPage(1)};sap.uiext.inbox.Inbox.prototype._createLabelValueMatrixLayout=function(e,t){e.addStyleClass("sapUiExtInboxCustomAttLabel").setWrapping(false);t.addStyleClass("sapUiExtInboxCustomAttValue").setWrapping(false);var i=new sap.ui.commons.layout.MatrixLayoutCell({hAlign:sap.ui.commons.layout.HAlign.Right,vAlign:sap.ui.commons.layout.VAlign.Top,padding:sap.ui.commons.layout.Padding.End,content:[e]});var a=new sap.ui.commons.layout.MatrixLayoutCell({hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Top,padding:sap.ui.commons.layout.Padding.Begin,content:[t]});return(new sap.ui.commons.layout.MatrixLayout).createRow(i,a)};sap.uiext.inbox.Inbox.prototype._getCustomActionsDefinition=function(e,t,i,a,o){var s=this;var r=sap.uiext.inbox.InboxConstants.taskInstanceDecisionOptionsMap;var n=r[e];if(n===undefined&&e){var l={InstanceID:"'"+decodeURIComponent(e)+"'",SAP__Origin:"'"+t+"'",$format:"json"};var u=function(t,l){s.selectedContexts=o;n=r[e]=t.results;if(a){a(n)}else{s._displayCustomActions(n,i)}};var d=function(e){s.showMessage("error",s._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ACTION_FAILS"))};this.oDataManager.readData(s.constants.decisionOptionsFunctionImport,{urlParameters:l,success:u,error:d})}else{if(a){a(n)}else{s._displayCustomActions(n,i)}}};sap.uiext.inbox.Inbox.prototype._fetchCustomActionsUsingAsyncCall=function(e,t,i,a){var o=this;var s=e.length+i.length;var r=[];var n=sap.uiext.inbox.InboxConstants.taskInstanceDecisionOptionsMap;jQuery.each(e,function(e,l){var u={InstanceID:"'"+decodeURIComponent(l)+"'",SAP__Origin:"'"+t+"'",$format:"json"};var d=function(e,t){o.selectedContexts=a;r=n[l]=e.results;i.push(r);if(i.length==s){o._displayCustomActions(r,i)}};var p=function(e){o.showMessage("error",o._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ACTION_FAILS"))};o.oDataManager.readData(o.constants.decisionOptionsFunctionImport,{urlParameters:u,success:d,error:p})})};sap.uiext.inbox.Inbox.prototype._displayCustomActions=function(e,t){this._deleteCustomActionsForTableView();if(e&&e.length>0){t.push(e)}function i(e){if(e.length==0)return[];else if(e.length==1)return e[0];var t=e[0];for(var i=1;i<e.length;i++){t=a(t,e[i])}return t}function a(e,t){var i=[];var a,o;var s=e.length;var r=t.length;for(a=0;a<s;a++){for(o=0;o<r;o++){if(e[a].DecisionKey===t[o].DecisionKey){i.push(e[a])}}}return i}var o=i(t);if(o&&o.length>0)this._createCustomActionsForTableView(o,true)};sap.uiext.inbox.Inbox.prototype._executeCustomAction=function(e,t){var i=e.data("key");var a=e.getText();var o=this;var s=this.currentView;var r,n,l;var u=[],d=[],p=[];var c=[];var g,f;var h=[];var I,m,b;o.resetSearchCriteria();var l=o.getCoreModel();if(s===o.constants.tableView){r=o._getComponent("listViewTable");var x=o.getlistTableSelectedIndices();jQuery.each(x,function(e,t){n=r.getContextByIndex(t);d.push(n);b=l.getProperty("TaskTitle",n);I=l.getProperty("InstanceID",n);m=l.getProperty("SAP__Origin",n);u.push(I);p.push(m);if(e==0){g=I;f=m}else{g=g+";"+I;f=f+";"+m}})}else if(s===o.constants.rowRepeaterView){var y=e.getBindingContext();b=l.getProperty("TaskTitle",n);I=l.getProperty("InstanceID",y);m=l.getProperty("SAP__Origin",y);u.push(I);p.push(m);g=I;f=m;d.push(y);var T=e.getParent().getParent().getParent().getParent().getParent().getParent()}var _,C,v,S,w,A;w=u.length;A=w;if(w>1&&o.isBatchOperationSupported){var B=[];for(var O=0;O<w;O++){var R={};R.InstanceID="'"+u[O]+"'";R.SAP__Origin="'"+p[O]+"'";R.DecisionKey="'"+i+"'";if(t){R.Comments="'"+jQuery.sap.encodeURL(t)+"'"}B.push(R)}var E=function(e,t){var i=e.__batchResponses;var s=e.TaskTitle;var r,n,l,u;var p=0,c=0,g=[],f=[];for(r=0,u=i.length;r<u;r++){var h=i[r].__changeResponses;if(h){for(n=0,l=h.length;n<l;n++){var I=h[n];var m=!(I.statusCode>=200&&I.statusCode<=202);if(m){p=p+1}else{c=c+1;if(o.clientUpdate){o.selectedContexts=d;var b=I.data;if(b.Status==="COMPLETED"){if(T){g.push({orow:T,context:d[r]})}else{g.push(d[r])}}}}}}}if(o.clientUpdate){o._refreshLocal(g)}if(o.clientUpdate===undefined){o.applyFilterOnResponse(d)}if(p>0){if(p===1){o.showMessage("error",o._oBundle.getText("INBOX_MSG_ACTION_FAILED",[a,s]))}else{o.showMessage("error",o._oBundle.getText("INBOX_MSG_ACTION_FAILED_MULTIPLE_TASKS",[a,p]))}}else{if(c>1){o.showMessage("success",o._oBundle.getText("INBOX_MSG_ACTION_SUCCESS_MULTIPLE_TASKS",[a,c]))}else{o.showMessage("success",o._oBundle.getText("INBOX_MSG_ACTION_SUCCESS",[a,s]))}}};var F=function(e){o._handleErrorOnBatchRequests(e,a,A)};this.oDataManager.fireBatchRequest({sPath:o.constants.decisionExecutionFunctionImport,sMethod:"POST",sBatchGroupId:"customActionBatch",aUrlParameters:B,numberOfRequests:w,fnSuccess:E,fnError:F})}else{var D={};D.InstanceID=decodeURIComponent(g);D.SAP__Origin=f;D.DecisionKey=i;if(t)D.Comments=t;var E=function(e,t){if(o.clientUpdate&&e.Status==="COMPLETED"){o.selectedContexts=d;if(T)o._refreshLocal([{orow:T,context:d[0]}]);else o._refreshLocal([d])}if(o.clientUpdate===undefined)o.applyFilterOnResponse(d);o.showMessage("success",o._oBundle.getText("INBOX_MSG_ACTION_SUCCESS",[a,e.TaskTitle]))};var F=function(e){o._handleErrorOnActionFailed(e,a,l.getProperty("TaskTitle",d[0]))};o.oDataManager.callFunctionImport(o.constants.decisionExecutionFunctionImport,{method:"POST",success:E,error:F,urlParameters:D},true)}o.resetMessages=false};sap.uiext.inbox.Inbox.prototype._deleteCustomActions=function(e){if(this.currentView===this.constants.tableView){this._deleteCustomActionsForTableView()}else if(this.currentView===this.constants.rowRepeaterView){this._deleteCustomActionsForRowRepeaterView()}};sap.uiext.inbox.Inbox.prototype._createCustomActionButtons=function(e,t){if(this.currentView===this.constants.tableView){this._createCustomActionsForTableView(e,t)}};sap.uiext.inbox.Inbox.prototype._deleteCustomActionsForTableView=function(e){var t=this;var i=this._getActionButtonToolBarForTableView();var a=i.getItems();for(var o=0;o<a.length;o++){var s=a[o];if(s instanceof sap.ui.commons.Button&&s.data("type")===t.constants.customAction){i.removeItem(s);s.destroy()}if(s instanceof sap.ui.commons.ToolbarSeparator&&s.data("separatorFor")===t.constants.customAction){i.removeItem(s);s.destroy()}}};sap.uiext.inbox.Inbox.prototype._createCustomActionsForTableView=function(e,t){var i=this;var a=this._getActionButtonToolBarForTableView();var o=e.length;var s=3;if(o>0){var r=new sap.ui.commons.ToolbarSeparator;r.data("separatorFor",i.constants.customAction);a.insertItem(r,s);s++}for(var n=0;n<o;n++){var l=e[n];var u=!l.DecisionText?l.DecisionKey:l.DecisionText;var d=new sap.ui.commons.Button(this.getId()+"--"+l.DecisionKey+"button",{text:u,enabled:t,tooltip:l.Description}).data("type",i.constants.customAction).data("key",l.DecisionKey).data("text",l.DecisionText).data("commentsMandatory",l.CommentMandatory);d.attachPress({inbox:i,view:i.constants.tableView},jQuery.proxy(i._handleCustomActionClick,this));a.insertItem(d,s);s++}};sap.uiext.inbox.Inbox.prototype._deleteCustomActionsForRowRepeaterView=function(e){var t=this;var i=this._getComponent("rrMainMatrixLayout");var a=this._getComponent("taskActionMatrixLayout");var o=a.getRows()[0];var s=o.getCells();for(var r=0;r<s.length;r++){var n=s[r];var l=n.getContent()[0];if(l instanceof sap.ui.commons.Link&&l.data("type")===t.constants.customAction||l instanceof sap.ui.commons.Label&&l.data("separatorFor")===t.constants.customAction){o.removeCell(n);n.destroy();l.destroy()}}};sap.uiext.inbox.Inbox.prototype._getActionButtonToolBarForTableView=function(){return this._getComponent("actionButtonsToolbarContainer")};sap.uiext.inbox.Inbox.prototype._modifyListBindingForExpand=function(e,t){var i=this.constants;var a,o;if(this.currentView===this.constants.tableView){a=sap.ui.getCore().byId(this.getId()+"--"+"listViewTable");if(a!==undefined){o=a.getBinding("rows")}}else if(this.currentView===this.constants.rowRepeaterView){a=sap.ui.getCore().byId(this.getId()+"--"+"tasksRowRepeater");if(a!==undefined){o=a.getBinding("rows")}}var s=o.mParameters;if(!s){o.mParameters={expand:""}}var r=o.mParameters.expand;if(!r){r=o.mParameters.expand=""}if(e){if(r){if(r.indexOf(i.customAttributeNavigationParam)===-1){if(r.length>0){r=r+","}r=r+t}}else{r=t}}else{if(r&&r.length>0){var n=r.indexOf(t);if(n>=0){r=r.charAt(n-1)===","?r.replace(","+t,""):r.replace(t,"")}}}if(r.length>0){o.mParameters.expand=r}else{delete o.mParameters.expand}function l(e){var t=[],i={expand:true,select:true};for(var a in e){if(a in i){t.push("$"+a+"="+jQuery.sap.encodeURL(e[a]))}}return t.join("&")}o.sCustomParams=l(o.mParameters)};sap.uiext.inbox.Inbox.prototype.populateRefreshButtonContainer=function(e){var t=this;var i=new sap.ui.commons.layout.MatrixLayoutCell({id:this.getId()+"--"+"refreshButtonCell"});var a=new sap.ui.commons.Button(this.getId()+"--"+"refreshButton",{tooltip:this._oBundle.getText("INBOX_REFRESH_BUTTON_TOOLTIP")});a.setIcon(sap.uiext.inbox.InboxConstants.refreshImage);a.attachPress(t,t.refreshTaskList);a.addStyleClass("sapUiExtInboxRefreshButtonHeight");i.addContent(a);i.setPadding(sap.ui.commons.layout.Padding.None);var o=new sap.ui.commons.layout.MatrixLayoutCell({id:this.getId()+"--"+"refreshedOnTextCell",vAlign:sap.ui.commons.layout.VAlign.Bottom,padding:sap.ui.commons.layout.Padding.Top});var s=new sap.ui.commons.Label(this.getId()+"--"+"refreshOnText");t.lastRefreshedOnDateTime=new Date;var r=t._getFormattedRefreshOnDateTime();s.setText(t._oBundle.getText("INBOX_TEXT_ON")+sap.uiext.inbox.InboxConstants.SPACE+r);s.setTooltip(t._getFormattedTooltipForLastRefreshedTime());s.addStyleClass("sapUiExtInboxRefreshedOnStyle");o.addContent(s);e.createRow(i,new sap.ui.commons.Label({text:sap.uiext.inbox.InboxConstants.SPACE}),o)};sap.uiext.inbox.Inbox.prototype._getFormattedRefreshOnDateTime=function(){var e=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"medium"});return e.format(this.lastRefreshedOnDateTime)};sap.uiext.inbox.Inbox.prototype._getFormattedTooltipForLastRefreshedTime=function(){var e=sap.ui.core.format.DateFormat.getDateTimeInstance({style:"medium"});return e.format(this.lastRefreshedOnDateTime)};sap.uiext.inbox.Inbox.prototype._createRRSettingsButton=function(){var e=this;var t=sap.ui.getCore().byId(this.getId()+"--"+"rrSettingsButton");if(!t){t=new sap.ui.commons.Button(e.getId()+"--"+"rrSettingsButton",{tooltip:e._oBundle.getText("INBOX_MANAGE_SUBSTITUTION_RULES_TOOLTIP"),icon:this.constants.iconPool.getIconURI("workflow-tasks"),iconHovered:this._imgResourcePath+sap.uiext.inbox.InboxConstants.settingsImageHover,iconSelected:this._imgResourcePath+sap.uiext.inbox.InboxConstants.settingsImageHover,lite:true});t.addStyleClass("sapUiExtInboxSettingsButton");t.attachPress(e,e.onSubstitutionButtonPress)}return t};sap.uiext.inbox.Inbox.prototype._executeForwardAction=function(e,t){var i=e.getSource();var a=t.inbox;var o=a.getId()+"--";var s=sap.ui.getCore().byId(o+"forwardTasksPopUp");var r=sap.ui.getCore().byId(o+"userTable");if(s===undefined){var n=new sap.ui.commons.layout.MatrixLayout({id:o+"dLayout",layoutFixed:true,width:"100%"});var l=new sap.ui.commons.SearchField({id:o+"oSearch",enableListSuggest:false,startSuggestion:0,tooltip:a._oBundle.getText("SUBSTIUTION_RULE_SEARCH_FOR_USERS"),editable:true,width:"100%"});l.addDelegate({onAfterRendering:function(){var e=sap.ui.getCore().byId(o+"oSearch-tf");e.prop("placeholder",a._oBundle.getText("INBOX_SEARCH_FOR_A_COLLEAGUE"))}});l.attachSearch(a,function(e,t){e.oParentSource=i;r.setBusy(true);t._handleSearchUsersClickforForward(e)});l.attachSuggest(a,function(e,t){if(e.getParameter("value")===""){r.clearSelection();r.bindRows("")}});n.createRow(l);var u={collection:"UserInfoCollection",propertiesLabel:[a._oBundle.getText("SUBSTITUTION_USERS_PICKLIST_LOGONID"),a._oBundle.getText("SUBSTITUTION_USERS_PICKLIST_NAME")],properties:["UniqueName","DisplayName"]};if(r===undefined){r=new sap.ui.table.Table(o+"userTable",{selectionMode:sap.ui.table.SelectionMode.Single})}r.setVisibleRowCount(5);r.attachRowSelectionChange(function(){if(r.getSelectedIndices().length!==0){sap.ui.getCore().byId(o+"forwardTasksPopUpFrwBtn").setEnabled(true)}else{sap.ui.getCore().byId(o+"forwardTasksPopUpFrwBtn").setEnabled(false)}});r.bDynamic=true;for(var d=0;d<=u.properties.length-1;d++){r.addColumn((new sap.ui.table.Column).setLabel(new sap.ui.commons.Label({text:u.propertiesLabel[d],design:sap.ui.commons.LabelDesign.Bold})).setTemplate(new sap.ui.commons.TextField({editable:false,value:{path:u.properties[d]}})))}var p=new sap.ui.commons.layout.VerticalLayout(o+"userDialogVLayout",{width:"100%"});p.insertContent(n,0);p.insertContent(r,1);var c;s=new sap.ui.commons.Dialog(o+"forwardTasksPopUp",{modal:true,title:a._oBundle.getText("INBOX_FORWARD_SELECTED_TASKS"),content:[p],buttons:[new sap.ui.commons.Button(o+"forwardTasksPopUpFrwBtn",{enabled:false,text:a._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD"),tooltip:a._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD_TOOLTIP"),press:function(e){var r=sap.ui.getCore().byId(o+"userTable");var n=r.getSelectedIndex();var l=r.getContextByIndex(n);var u=sap.ui.getCore().byId(o+"userTable").getModel();var d=u.getProperty("DisplayName",l);if(d===null)d="";c=u.getProperty("UniqueName",l);var p=new sap.ui.base.Event;p.oSource=i;p.mParameters={};a.executeActionOnTask(p,{inbox:a,view:t.view,action:"Forward",forwardTo:jQuery.sap.encodeURL(c),source:i});s.close()}})]})}s.setWidth("500px");s.open();s.attachClosed(a,function(e,t){s.destroy()});s.setInitialFocus(l)};sap.uiext.inbox.Inbox.prototype._getExpandParameters=function(){return this.oController.getExpandParameters()};sap.uiext.inbox.Inbox.prototype._getFilterArray=function(){var e=[];for(var t in this.filtersToApply){var i=this.filtersToApply[t];if(jQuery.isArray(i)){e=e.concat(i)}else e.push(i)}return e};sap.uiext.inbox.Inbox.prototype._getSelectedItemfromKey=function(e,t){var i=e.getItems();var a=t;var o;for(var s=0;s<i.length;s++){if(a===i[s].getKey()){return i[s]}}};sap.uiext.inbox.Inbox.prototype._resetFlags=function(){this.isSubstitutionEnabled=false;this.isCustomAttributesEnabled=false;this.isCustomActionsEnabled=false;this.showTaskDescription=false;this.showTaskCategory=false};sap.uiext.inbox.Inbox.prototype._createForwardActionLinkCell=function(){var e=this;var t=new sap.ui.commons.layout.MatrixLayoutCell({id:e.getId()+"--"+"forwardActionCell",hAlign:sap.ui.commons.layout.HAlign.Left,vAlign:sap.ui.commons.layout.VAlign.Bottom,colSpan:1});var i=new sap.ui.commons.Link(e.getId()+"--"+"rrViewForwardAction",{visible:false,enabled:false,tooltip:e._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD")});i.addStyleClass("sapUiExtInboxLnkNoUnderline");i.setText(e._oBundle.getText("INBOX_ACTION_BUTTON_FORWARD"));i.attachPress({inbox:e,view:e.constants.rowRepeaterView},e._executeForwardAction);t.addContent(i);return t};sap.uiext.inbox.Inbox.prototype._setInboxFiltersVisibility=function(e){if(e===false||e===true){sap.ui.getCore().byId(this.getId()+"--"+"filterViewButton").setVisible(e);sap.ui.getCore().byId(this.getId()+"--"+"filterComboBox1").setVisible(e);sap.ui.getCore().byId(this.getId()+"--"+"filterComboBox2").setVisible(e);sap.ui.getCore().byId(this.getId()+"--"+"filterComboBox3").setVisible(e)}};sap.uiext.inbox.Inbox.prototype._setInboxViewSelectionVisibility=function(e){if(e===false||e===true){sap.ui.getCore().byId(this.getId()+"--"+"tableViewImage").setVisible(e);sap.ui.getCore().byId(this.getId()+"--"+"rrViewImage").setVisible(e)}};sap.uiext.inbox.Inbox.prototype.resizeColumns=function(){var e=this;var t=0;var i=sap.ui.getCore().byId(e.getId()+"--"+"listViewTable");var a=i.getColumns();var o="";jQuery.each(a,function(t,i){if(e.absId(i.getId())==="TaskTitle"){o=i;return false}});if(o&&o.getVisible()===true&&(a.length&&100/a.length<25)){o.setWidth("20%");t=100/(a.length-1);jQuery.each(a,function(i,a){if(e.absId(a.getId())!=="TaskTitle"){a.setWidth(t+"%")}})}};sap.uiext.inbox.Inbox.prototype._isCompletedTasksSelected=function(){var e=this._getComponent("filterComboBox2");var t=false;if(e.getSelectedItemId()===this.getId()+"--"+"li_completedTasks"){t=true}return t};sap.uiext.inbox.Inbox.prototype._isDrillDownFilterSelected=function(e){var t=false;var i=this._currentViewElement();var a=i.getBinding("rows");if(a&&a.sFilterParams&&a.sFilterParams.indexOf(e)!==-1)t=true;return t};sap.uiext.inbox.Inbox.prototype._getDefaultSort=function(){if(!this._defaultSort){this._defaultSort=new sap.ui.model.Sorter("CreatedOn",true)}return this._defaultSort};sap.uiext.inbox.Inbox.prototype._clearCustomAttributeSort=function(){var e=this._getComponent("listViewTable");var t=e.getBinding("rows");if(t.sSortParams.indexOf(this.constants.customAttributeNavigationParam)!==-1){t.createSortParams(t.aSorters)}};sap.uiext.inbox.Inbox.prototype._updateViewElementsOnRequestCompleted=function(e){if(this.currentView===this.constants.tableView){this._updateTableOnRequestCompleted()}else if(this.currentView===this.constants.rowRepeaterView){this._updateRowRepeaterOnRequestCompleted(e)}};sap.uiext.inbox.Inbox.prototype._updateTableOnRequestCompleted=function(){if(this.clientUpdate&&this.currentView===this.constants.tableView){this._currentViewElement().clearSelection()}var e,t=[];var i={aSupportsClaim:[],aSupportsRelease:[],aSupportsForward:[]};var a=this._currentViewElement();var o=this.selectedContexts;var s=this._getTableIndicesByContext(o,a);var r=a.getModel();var n=this;jQuery.each(s,function(o,s){e=a.getContextByIndex(s);t.push(r.getProperty("Status",e));i.aSupportsClaim.push(r.getProperty("SupportsClaim",e));i.aSupportsRelease.push(r.getProperty("SupportsRelease",e));if(n.isForwardActionEnabled){i.aSupportsForward.push(r.getProperty("SupportsForward",e))}});this.inboxUtils.reselectRowsinTable(s,a);this.disableActionButtonsOnMultiStatus(t,i)};sap.uiext.inbox.Inbox.prototype._updateRowRepeaterOnRequestCompleted=function(e){this._updatePaginator(e)};sap.uiext.inbox.Inbox.prototype._getTableIndicesByContext=function(e,t){var i=[];var a=t.getBinding("rows");var o=a.getContexts(0,a.iLength);var s=t.getModel();var r=-1;jQuery.each(e,function(e,t){jQuery.each(o,function(e,i){if(t.sPath===i.sPath){r=e;return false}});if(r>-1){i.push(r)}});return i};sap.uiext.inbox.Inbox.prototype._isTaskDefinitionFilterApplied=function(){var e=this._currentViewElement();var t=e.getBinding("rows");if(this.clientUpdate){var i=false;var a=t.aFilters.concat(t.aApplicationFilters);if(a&&a.length>0){jQuery.each(a,function(e,t){if(t.sPath==="TaskDefinitionID"){i=true;return false}})}return i}return t.sFilterParams.indexOf("TaskDefinitionID")!==-1};sap.uiext.inbox.Inbox.prototype._handleRequestSent=function(e){if(this.bRefreshStartFlag){this.bRefreshStartFlag=false;var t=this._getComponent("refreshButton");t.setIcon(sap.uiext.inbox.InboxConstants.refreshImage)}};sap.uiext.inbox.Inbox.prototype._handleRequestCompleted=function(e){var t=0;var i=e.getParameters();if(i.url.indexOf(this.constants.UserInfoCollection)!==-1){return}else if(!i.success){if(this.currentView===this.constants.tableView){this._getComponent("listViewTable").getModel().updateBindings()}if(i.errorobject===undefined||i.errorobject!==undefined&&i.errorobject.statusCode===401){window.location.reload(true)}}else if(i.success){var a=this._getComponent("INBOX_FILTER_TASK_TYPE");var o=a?this._isInitialFilterAppliedforTaskType():false;if((o||!this._isTaskDefinitionFilterApplied())&&this.bRefreshTaskTypes){this.refreshTaskTypes()}if(o){if(this._setInitialFilterKeysforTaskType(a)){if(a&&a.getSelectedKeys()!==["sapUiFacetFilter_ALL"]){if(a.getSelectedKeys().length===1){var e=new sap.ui.base.Event;var s=a.getItems();e.mParameters={all:false,selectedItems:s};this.applyDrillDownFilterForTaskType(e,this)}}}}if(this.bSorted){var r=this._currentViewElement();r._originalKeys=r.getBinding("rows").aKeys;this.bSorted=false}this.bRefreshTaskTypes=true;t=this._getCurrentViewElementBindingLength();var r=this._currentViewElement();var n=r.bRowsRebinded;if(n===null||n===undefined||!r.bRowsRebinded){this._displayMessageOnRequestCompleted(t)}else{r.bRowsRebinded=false}}this.hideBusyLoader();this._updateViewElementsOnRequestCompleted(t);var l=this._getComponent("refreshButton");l.setIcon(this.constants.refreshImage);var u=e.getParameters();u.bindingLength=t;u.appliedFilter=this._getComponent("filterComboBox2").getValue();this.fireODataRequestCompleted(u);this._applySearch();if(this.currentView===this.constants.tableView&&this._isTableFiltered())this._preserveTableFilters();if(this.currentView===this.constants.tableView){this._preserveTableSort()}};sap.uiext.inbox.Inbox.prototype._applySearch=function(){var e=this._getComponent("searchField");var t=e.getValue();if(t!==""&&t!==null){e.fireSearch({query:t})}};sap.uiext.inbox.Inbox.prototype._displayMessageOnRequestCompleted=function(e){if(e<=0){this.showMessage("info",this._oBundle.getText("INBOX_MSG_FOR_NO_DATA"))}else{if(this.resetMessages===true){this.deleteMessage()}else{this.resetMessages=true}}};sap.uiext.inbox.Inbox.prototype._getCurrentViewElementBindingLength=function(){var e=this._currentViewElement();var t=e.getBinding("rows");return t.iLength};sap.uiext.inbox.Inbox.prototype._selectParentRowforElement=function(e){var t=-1;var i=jQuery.sap.byId(e);var a=i.closest(".sapUiTableCtrl>tbody>tr");if(a.length===1){t=parseInt(a.attr("data-sap-ui-rowindex"))}var o=this._getComponent("listViewTable");o.setSelectedIndex(t)};sap.uiext.inbox.Inbox.prototype._handleTaskTitleLinkPress=function(e){this.showBusyLoader();var t=this;this._selectParentRowforElement(e.getSource().getId());var i=e.getSource().getBindingContext();var a=this.getCoreModel();var o=[],s=[],r=[],n=[];s.push(a.getProperty("InstanceID",i));r.push(a.getProperty("TaskTitle",i));n.push(a.getProperty("SAP__Origin",i));if(this.getTaskExecutionURLCallBack!=""&&this.getTaskExecutionURLCallBack!=undefined&&this.getTaskExecutionURLCallBack!==null){var l=this.getTaskExecutionURLCallBack(s[0],n[0]);if(l!==null&&l.replace(/\s/g,"").length>0){o.push(l)}}else{o.push("")}var u=e.getParameter("windowEvent");if(!u.ctrlKey&&!(u.button==1)&&!u.shiftKey&&!this.bOpenTaskUIInNewTab){this.populateTaskExecutionContent({aSelectedContexts:[i],arrayURLs:o,arrayIDs:s,arrayTitles:r,aTaskSAPOrigins:n});this.hideBusyLoader()}else{this.hideBusyLoader();var d=o[0];if(d!==null&&d.replace(/\s/g,"").length>0){sap.ui.require(["sap/ui/util/openWindow"],function(e){var t=e(d);if(t){t.focus()}});e.preventDefault()}}};sap.uiext.inbox.Inbox.prototype._initFlagsByModel=function(){if(this.oModel instanceof sap.ui.model.json.JSONModel){this.typeOfModel="JSON";this.setHandleBindings(false);this._resetFlags()}else if(this.oModel instanceof sap.ui.model.odata.ODataModel||this.oModel instanceof sap.ui.model.odata.v2.ODataModel){this.typeOfModel="OData";this.attachTaskAction(this,this.defaultActionHandler);this.setHandleBindings(true)}else if(this.oModel instanceof sap.ui.model.xml.XMLModel){this.typeOfModel="xml";this.setHandleBindings(false);this._resetFlags()}};sap.uiext.inbox.Inbox.prototype._handleRequestFailed=function(e){var t=e.mParameters;if(t.message!=="Request aborted"&&t.statusCode!==undefined){this.showMessage("error",this._oBundle.getText("INBOX_MSG_NO_ODATA_SRVC"))}this.hideBusyLoader()};sap.uiext.inbox.Inbox.prototype._applySortOnView=function(e){var t=this.constants.mEntitiesToElements.taskMetadata;if(this.currentView===this.constants.tableView){this._applySortOnTableView(e,t)}else if(this.currentView===this.constants.rowRepeaterView){this._applySortOnRowRepeaterView(e,t)}};sap.uiext.inbox.Inbox.prototype._applySortOnTableView=function(e,t){var i=t.sap_inbox_list.columnsMap;var a=this._getComponent("listViewTable");var o=a.getColumns();for(var s=0,r=o.length;s<r;s++){o[s].setSorted(false)}if(e){var n,l;var u=e.sPath;if(u.indexOf(this.constants.customAttributeNavigationParam)!==-1){l=u.replace(this.constants.customAttributeNavigationParam,"");l=l.replace(/^\//,"")}else{var l=i[u]}var n=l?this._getComponent(l):undefined;if(n){var d=e.bDescending?sap.ui.table.SortOrder.Descending:sap.ui.table.SortOrder.Ascending;n.setSortOrder(d);n.setSorted(true)}}};sap.uiext.inbox.Inbox.prototype._applySortOnRowRepeaterView=function(e,t){var i=t.sap_inbox_stream.sorterMap;var a=this._getComponent("sortByFilterComboBox");if(e){var o,s;var r=e.sPath;var n=i[r];if(n){a.setSelectedItemId(this.getId()+"--"+n);this._updateRowRepeaterSortImage(e.bDescending);var n=this.constants.mRRSortMap[n];var l=this._getComponent(n).getSorter();if(l){l.bDescending=e.bDescending}}else{var u=this._getComponent("li_empty");if(!u)u=new sap.ui.core.ListItem(this.getId()+"--"+"li_empty",{text:this._oBundle.getText("")});a.insertItem(u,0);a.setSelectedItemId(this.getId()+"--"+"li_empty");var d=this._getComponent("sortImage");d.setVisible(false)}}};sap.uiext.inbox.Inbox.prototype._updateRowRepeaterSortImage=function(e){var t=this._getComponent("sortImage");t.setVisible(true);if(e){t.setIcon(this.constants.sortDescImage);t.setTooltip(this._oBundle.getText("INBOX_SORT_INDICATOR_DESC"))}else{t.setIcon(this.constants.sortAscImage);t.setTooltip(this._oBundle.getText("INBOX_SORT_INDICATOR_ASC"))}};sap.uiext.inbox.Inbox.prototype._getFirstColumnContentTemplate=function(){var e=this;var t=this._getComponent("firstColumnLayout");t=t||new sap.uiext.inbox.composite.InboxTaskTitleControl({id:e.getId()+"--"+"firstColumnLayout",categoryIconURI:{path:"InstanceID",formatter:function(t){if(t!==null){this.setTooltip(e._oBundle.getText(e.constants.taskCategoryToolTip["TASK"]));return e.constants.taskCategoryImages["TASK"]}}}});t.setTitleLink(this._createTaskLink());t.bindProperty("hasAttachments","HasAttachments",function(e){var t=e!=null?e:false;return t});t.bindProperty("hasComments","HasComments",function(e){var t=e!=null?e:false;return t});return t};sap.uiext.inbox.Inbox.prototype._createTaskCategoryImage=function(){var e=this;var t=e._getComponent("taskCategoryImg");if(!t){t=new sap.ui.core.Icon({id:e.getId()+"--"+"taskCategoryImg",decorative:false,size:"15px",enable:false}).addStyleClass("sapUiExtInboxMarginForTableColumnStyle")}if(this.clientUpdate){t.setSrc(e.constants.taskCategoryImages["TASK"])}else{t.bindProperty("src",e.constants.taskDefinitionNavigationParam,function(t){if(t!=null&&t!==""){var i=e.getCoreModel();var a=this.getBindingContext();var o=t[0];var s=i.oData[o];var r;if(s){r=s.Category;this.setVisible(true)}else{r=t.Category;this.setVisible(true)}r=r.toUpperCase();if(r=="TASK"||r=="NOTIFICATION"||r=="TODO"||r=="ALERT"){this.setTooltip(e._oBundle.getText(e.constants.taskCategoryToolTip[r]));return e.constants.taskCategoryImages[r]}}return e.constants.taskCategoryImage})}return t};sap.uiext.inbox.Inbox.prototype._createTaskLink=function(){var e=this;var t=(new sap.uiext.inbox.InboxLink).addStyleClass("sapUiExtInboxTaskTitleLink");t.addDelegate({onAfterRendering:function(){if(!this.getEnabled()){this.addStyleClass("sapUiExtInboxLnkDsbl")}}});var i=e._getCategoryMetadata().properties[0];t.bindProperty("text",i,function(e){if(this.getBindingContext()===undefined)return undefined;else return e});t.bindProperty("overdue","CompletionDeadLine",function(t){return e._isOverDue(t)});t.bindProperty("tooltip",i);t.bindProperty("enabled","Status",function(t){if(!e.getOpenCompletedTasks()&&t==="COMPLETED"){this.addStyleClass("sapUiExtInboxLnkDsbl");return false}this.removeStyleClass("sapUiExtInboxLnkDsbl");return true});t.attachPress(this,function(e,t){t._handleTaskTitleLinkPress(e)});return t};sap.uiext.inbox.Inbox.prototype._handleTaskCategoryVisibility=function(){if(!this.showTaskCategory){var e=this._getComponent("taskCategoryImg");if(e){e.setVisible(false)}}};sap.uiext.inbox.Inbox.prototype._setCommentsVisibility=function(){if(this.isCommentsEnabled){var e=this._getComponent("commentsSegBtn");e.bindProperty("visible","SupportsComments",function(e){if(e!=null&&e!==""){return e}return false});e.attachPress(this,function(e,t){t._handleActionButtonToggleinRowRepeater(e)})}};sap.uiext.inbox.Inbox.prototype._initTableView=function(){var e=this._getComponent("listViewTable");e.setModel(this.oModel);return e};sap.uiext.inbox.Inbox.prototype._initRowRepeaterView=function(){var e=this._getComponent("tasksRowRepeater");e.setModel(this.oModel);var t=this._getComponent("rrMainMatrixLayout");return e};sap.uiext.inbox.Inbox.prototype._createCustomAttributes=function(e){if(this.isCustomAttributesEnabled){if(e.length===1&&this.currentView===this.constants.tableView){if(!(this.oController instanceof sap.uiext.inbox.controller.InboxControllerAsync)){this._modifyListBindingForExpand(true,this.constants.customAttributeNavigationParam)}this._getCustomAttributeMetaData(e[0].getKey(),e[0].data("SAP__Origin"))}else{if(!(this.oController instanceof sap.uiext.inbox.controller.InboxControllerAsync)){this._modifyListBindingForExpand(false,this.constants.customAttributeNavigationParam)}this._deleteCustomAttributeColumns(null)}}};sap.uiext.inbox.Inbox.prototype._isCustomAttribute=function(e){if(e){if(e.data("ColumnType")=="CustomAttribute"){return true}}return false};sap.uiext.inbox.Inbox.prototype._selectInitialValueinDropDown=function(e){var t=this._getComponent("filterComboBox2");var i=e?e.getFilter():undefined;var a=i?i.key:"li_openTasks";a=this.getId()+"--"+a;if(t.getSelectedItemId()!==a){t.setSelectedItemId(a);var o=sap.ui.getCore().byId(a);t.fireChange({oSource:t,newValue:o.getText(),selectedItem:o})}};sap.uiext.inbox.Inbox.prototype._addFilterToFilterMetadata=function(e,t){if(jQuery.isArray(e)){t=t.concat(e)}else{t.push(e)}return t};sap.uiext.inbox.Inbox.prototype._selectFilterValuesinFacetFilterView=function(e,t,i){var a=e.getFilterUIKeys();var o=sap.ui.getCore().byId(this.getId()+"--"+"filterFacet");var s=sap.ui.getCore().byId(this.getId()+"--"+"INBOX_FILTER_PRIORITY");var r=sap.ui.getCore().byId(this.getId()+"--"+"INBOX_FILTER_STATUS");var n=sap.ui.getCore().byId(this.getId()+"--"+"INBOX_FILTER_CREATION_DATE");var l=sap.ui.getCore().byId(this.getId()+"--"+"INBOX_FILTER_TASK_TYPE");var u=sap.ui.getCore().byId(this.getId()+"--"+"INBOX_FILTER_DUE_DATETIME");var d=[];if(l&&o.indexOfList(l)!==-1&&a.TaskType&&a.TaskType.length>0){l.data("initialFilterKeysToSelect",a.TaskType);if(t.TaskType!==undefined&&t.TaskType.length>0){d.push(t.TaskType)}}else{this.clearFiltersForTaskType()}if(s&&o.indexOfList(s)!==-1&&a.Priority&&a.Priority.length>0){s.setSelectedKeys(a.Priority);if(t.Priority!==undefined&&t.Priority.length>0){d.push(t.Priority)}}else{this.clearFiltersForPriority()}if(r&&o.indexOfList(r)!==-1&&a.Status&&a.Status.length>0){r.setSelectedKeys(a.Status);if(t.Status!==undefined&&t.Status.length>0){if(i.sPath==="Status"&&i.sOperator==="NE"){i=undefined;delete this.filtersToApply.dropDownFilter}d.push(t.Status)}}else{this.clearFiltersForStatus()}if(n&&o.indexOfList(n)!==-1&&a.StartDate&&a.StartDate.length>0){n.setSelectedKeys(a.StartDate);if(t.StartDate!==undefined){d.push(t.StartDate)}}else{this.clearFiltersForDateTime()}if(u&&o.indexOfList(u)!==-1&&a.DueDate&&a.DueDate.length>0){u.setSelectedKeys(a.DueDate);if(t.DueDate!==undefined){d.push(t.DueDate)}}else{this.clearFiltersForDueDate()}var p=[];for(var c=0;c<d.length;c++){var g=d[c];p=this._addFilterToFilterMetadata(g,p)}if(i){p=this._addFilterToFilterMetadata(i,p);this.filtersToApply.dropDownFilter=i}return p};sap.uiext.inbox.Inbox.prototype._setInitialFilterKeysforTaskType=function(e){if(e.getItems().length>0&&e.data("initialFilterKeysToSelect")!=null){e.setSelectedKeys(e.data("initialFilterKeysToSelect"));e.data(null);return true}else{return false}};sap.uiext.inbox.Inbox.prototype._isInitialFilterAppliedforTaskType=function(){var e=this._getComponent("INBOX_FILTER_TASK_TYPE");return e?e.data("initialFilterKeysToSelect")!=null?true:false:false};sap.uiext.inbox.Inbox.prototype._getTaskStatus=function(e,t){if(e||t){var i=this.oTcmMetadata.serviceSupportsFilterOption;if(i&&t){return t}if(e){var a=sap.uiext.inbox.InboxConstants.statusMap[e];if(a){return this._oBundle.getText(a)}return e}}return""};sap.uiext.inbox.Inbox.prototype._manageVisibilityOfSettingsButton=function(e){if(e!=null){var t=false;if(this.getSubstitutionEnabled()){t=true}e.setVisible(t)}};sap.uiext.inbox.Inbox.prototype._handleRowRepeaterPaginatorClick=function(e){var t=e.getParameter("targetPage");var i=e.getParameter("srcPage");var a=this._getComponent("tasksRowRepeater");if(a){a.gotoPage(t)}};sap.uiext.inbox.Inbox.prototype._getCustomAttributeContentforRowRepeater=function(e,t,i,a,o){var s=this;if(this.currentView==="sap_inbox_stream"){if(e){var i=s.getModel().getProperty("TaskDefinitionID",e.getParent().getBindingContext());var a=s.getModel().getProperty("InstanceID",e.getParent().getBindingContext());var o=s.getModel().getProperty("SAP__Origin",e.getParent().getBindingContext())}var r=s.constants;var n=r.oTaskInstanceCustomAttributeValuesMap;var l=n[a];var u=r.oTaskDefinitionCustomAttributesMap;var d=u[i];if(l&&jQuery.isEmptyObject(l)||d&&d.length==0){this._addActionContentinRowRepeater(t,"customAttributes",this._createNoDataLabel(this._oBundle.getText("INBOX_MSG_NO_TASK_DETAILS")));return}if(!jQuery.isEmptyObject(l)&&d&&d.length>0){s._displayCustomAttributes(i,a,t)}else if(l&&!d){s._getCustomAttributeMetaData(i,o,t,a)}else if(!l&&d){s._getCustomAttributeData(a,o,t,i)}else{if(s.bUseBatch){var p,c;var g=r.TaskDefinitionCollection;var f=r.TaskCollection;p=r.forwardSlash+g.entityName+"("+g.properties.taskDefnID+"='"+i+"',"+r.sapOrigin+"='"+o+"')"+r.forwardSlash+g.navParam.customAttrDefn;c=r.forwardSlash+f.entityName+"("+f.properties.instanceID+"='"+a+"',"+r.sapOrigin+"='"+o+"')"+r.forwardSlash+f.navParam.customAttrValues;var h=jQuery.proxy(function(e,o){this._processCustomAtrributesBatchResponse(e,o,i,a,t)},s);s.oDataManager.fireBatchRequest({aPaths:[p,c],sMethod:"GET",sBatchGroupId:"customAttributesBatch",numberOfRequests:2,fnSuccess:h,fnError:function(e){s.showMessage("error",s._oBundle.getText("INBOX_MSG_FETCH_CUSTOM_ATTRIBUTES_FAILS"))}})}else{s._getCustomAttributeMetaData(i,o,t,a);s._getCustomAttributeData(a,o,t,i)}}}};sap.uiext.inbox.Inbox.prototype._processCustomAtrributesBatchResponse=function(e,t,i,a,o){var s=e.__batchResponses;var r=[];var n={};var l=s[0].data.results;for(var u=0;u<l.length;u++){var d={};d.Name=l[u].Name;d.Type=l[u].Type;d.Label=l[u].Label;r.push(d)}this.constants.oTaskDefinitionCustomAttributesMap[i]=r;var p=s[1].data.results;for(var u=0;u<p.length;u++){n[p[u].Name]=p[u].Value}this.constants.oTaskInstanceCustomAttributeValuesMap[a]=n;this._displayCustomAttributes(i,a,o)};sap.uiext.inbox.Inbox.prototype._getCommentsContentforRowRepeater=function(e,t){var i=this.getModel();var a=e.getParent().getBindingContext();var o=i.getProperty("InstanceID",a);var s=i.getProperty("SAP__Origin",a);var r=i.getProperty("Status",a).toUpperCase();var n=false;if(r==="COMPLETED"){var n=true}var l=this._getComponent("comments-"+t);if(!l){var l=new sap.uiext.inbox.composite.InboxTaskComments(this.getId()+"--"+"comments-"+t,{showFeeder:!n});l.attachCommentSubmit(this,this.handleCommentAdded);if(this.loggedInUserName){l.setFeederThumbnailSrc(this.inboxUtils.getUserMediaResourceURL(this.bpmSvcUrl,s,this.loggedInUserName))}}l.data("instanceID",o);l.data("SapOrigin",s);l.setShowHeader(false);l.showBusy(true);var u=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,width:"100%"});var d=new sap.ui.commons.layout.MatrixLayoutCell;d.addContent(l);d.addStyleClass("sapUIExtInboxCommentsBorder");u.createRow(d);this._addActionContentinRowRepeater(t,"comments",u);this._getComments(o,s,t)};sap.uiext.inbox.Inbox.prototype._handleActionButtonToggleinRowRepeater=function(e){var t=e.getSource(),i=e.getParameters().id;var a="tasksRowRepeater-";var o=i.indexOf(a)+a.length;var s=i.substring(o,i.length);var r=this._removeParentID(i).replace("-"+this.getId()+"--"+a+s,"");if(t.getPressed()){this.inboxUtils.deSelectOtherActionButtonsinStreamView(t);t.setTooltip(this._oBundle.getText(this.constants.mTooltipforActionButtonsinRR.hide[r]));var n,l;if(r==="customAttributesSegBtn"){t.setIcon("");t.setIcon(this.constants.iconPool.getIconURI("collapse"));n=this._getCustomAttributeContentforRowRepeater(t,s);l="customAttributes"}else if(r==="commentsSegBtn"){n=this._getCommentsContentforRowRepeater(t,s)}else if(r==="attachmentsSegBtn"){this._getAttachments(t,s)}this.data("previousSelection",i)}else{if(r==="customAttributesSegBtn"){t.setIcon("");t.setIcon(this.constants.iconPool.getIconURI("expand"))}t.setTooltip(this._oBundle.getText(this.constants.mTooltipforActionButtonsinRR.show[r]));this._removeActionContentinRowRepeater(s)}};sap.uiext.inbox.Inbox.prototype.handleCommentAdded=function(e,t){var i=e.getSource();var a=t.getCoreModel();var o=decodeURIComponent(this.data("instanceID"));var s=e.getParameter("text");var r=this.data("SapOrigin");var n={};n.InstanceID=o;n.SAP__Origin=r;n.Text=s;t.oDataManager.callFunctionImport(t.constants.addCommentFunctionImport,{method:"POST",urlParameters:n,success:function(e,a){var o=e.CreatedByName;var s=e.CreatedBy;var r=e.SAP__Origin;var n=t.loggedInUserName;o?i.setFeederSender(o):i.setFeederSender("");var l=new sap.uiext.inbox.composite.InboxComment(i.getId()+"-new-"+i.getComments().length,{text:e.Text,timestamp:t.tooltipFormatForDateTime(e.CreatedAt),createdBy:n,sapOrigin:r,sender:o,thumbnailSrc:t.inboxUtils.getUserMediaResourceURL(t.bpmSvcUrl,r,s)});i.addComment(l);t.showMessage("success",t._oBundle.getText("INBOX_MSG_COMMENT_ADD_SUCCESS"))},error:function(e){t.showMessage("error",t._oBundle.getText("INBOX_MSG_COMMENT_ADD_ERROR"))}})};sap.uiext.inbox.Inbox.prototype._getComments=function(e,t,i){var a=this.constants;var o=this;var s=a.TaskCollection;var r=a.forwardSlash+s.entityName+"("+s.properties.instanceID+"='"+e+"',"+a.sapOrigin+"='"+t+"')"+a.forwardSlash+s.navParam.comments;var n=this.bpmSvcUrl+r;var l=this.getCoreModel(),u=[];var d={async:true,requestUri:n,method:"GET",headers:{Accept:a.acceptHeaderforJSON,"x-csrf-token":l.oHeaders["x-csrf-token"]}};OData.request(d,function(e,t){u=e.results;if(u){o._displayComments(u,i)}},function(e){var t=o._getComponent("comments-"+i);t.showBusy(false);this.showMessage("error",this._oBundle.getText("INBOX_MSG_FETCH_COMMENTS_FAILS"))})};sap.uiext.inbox.Inbox.prototype._displayComments=function(e,t){var i=new sap.ui.model.json.JSONModel;i.setData(e);var a=this._getComponent("comments-"+t);a.setModel(i);var o=new sap.uiext.inbox.composite.InboxComment({sender:"{CreatedByName}",text:"{Text}",createdBy:"{CreatedBy}",sapOrigin:"{SAP__Origin}"});sap.uiext.inbox.composite.InboxComment.bpmSvcUrl=this.bpmSvcUrl;o.bindProperty("timestamp","CreatedAt",this.tooltipFormatForDateTime);a.showBusy(false);a.setShowHeader(true);a.bindAggregation("comments",{path:"/",template:o})};sap.uiext.inbox.Inbox.prototype._removeActionContentinRowRepeater=function(e){var t=this.getId()+"--"+"rrMainMatrixLayout"+"-"+this.getId()+"--"+"tasksRowRepeater-";var i=sap.ui.getCore().byId(t+e);if(i){var a=this.getId()+"--"+"lastRowOfRowRepeater-"+e;var o=sap.ui.getCore().byId(a);if(o){var s=this.getId()+"--"+"lastRowCell-"+e;var r=sap.ui.getCore().byId(s);if(r){r.removeAllContent()}i.removeRow(a)}}return i};sap.uiext.inbox.Inbox.prototype._addActionContentinRowRepeater=function(e,t,i){var a=this._removeActionContentinRowRepeater(e);if(a){var o=this.getId()+"--"+"lastRowOfRowRepeater-"+e;var s=sap.ui.getCore().byId(o);if(!s){s=new sap.ui.commons.layout.MatrixLayoutRow({id:o})}var r=this.getId()+"--"+"lastRowCell-"+e;var n=sap.ui.getCore().byId(r);if(!n){n=new sap.ui.commons.layout.MatrixLayoutCell({id:r,vAlign:sap.ui.commons.layout.VAlign.Middle,colSpan:2})}n.addStyleClass("sapUIExtInboxLastRowPadding");n.addContent(i);s.addCell(n);a.addRow(s)}};sap.uiext.inbox.Inbox.prototype._searchText=function(e,t){return e.toLowerCase().indexOf(t.toLowerCase())>=0?true:false};sap.uiext.inbox.Inbox.prototype._getValuePresent=function(e,t,i,a){var o,s,r;if(!t){return false}if(t.__list instanceof Array){s=t.__list[0]}else{s=t.__ref}r=e[s];if(s){var n=r?r[i]:"";if(n){return this._searchText(n,a)}}return false};sap.uiext.inbox.Inbox.prototype._searchUsers=function(e){var t=this;var i=this.oTCMModel.getFunctionImportHandler();var a=t.getId()+"--";var o=sap.ui.getCore().byId(a+"userTable");i.setServiceURL(this.bpmSvcUrl);i.setHeaders({Accept:this.constants.acceptHeaderforJSON,"x-csrf-token":this.oModel.oHeaders["x-csrf-token"]});var s=e.sSearchTerm;var r=e.iMaxResults;var n=e.sSAPOrigin;var l;this.oPendingSearchRequest=i.callSearchUsers({SearchPattern:jQuery.sap.encodeURL(s),MaxResults:r,SAP__Origin:n},function(e,i){l=e;t.displaySearchResults(l,r,o);o.setBusy(false);t.oPendingSearchRequest=undefined},function(e){o.setBusy(true);if(e.response!==undefined){t.showMessage("error",t._oBundle.getText("INBOX_MSG_NO_USER_FOUND",[s]));o.setBusy(false)}t.oPendingSearchRequest=undefined})};sap.uiext.inbox.Inbox.prototype.displaySearchResults=function(e,t,i){if(e){var a=new sap.ui.model.json.JSONModel;a.setData(e);i.clearSelection();i.setModel(a);i.bindRows("/results");if(e.results.length>0){i.setSelectedIndex(0);if(e.results.length===t){this.showMessage("warning",this._oBundle.getText("INBOX_TOP_MAX_USER",[t]))}}else if(e.results.length===0){this.showMessage("error",this._oBundle.getText("INBOX_MSG_FOR_NO_DATA"))}}};sap.uiext.inbox.Inbox.prototype._handleForwardButtonVisibilityOnRowSelection=function(e,t){var i=this._getComponent("forwardActionButton");var a=this._isCompletedTasksSelected();if(this.isForwardActionEnabled&&!a&&!jQuery.isEmptyObject(t.aSupportsForward)&&jQuery.inArray(false,t.aSupportsForward)===-1){i.setEnabled(true).data("SAP__Origin",e)}else{i.setEnabled(false)}};sap.uiext.inbox.Inbox.prototype.setConfiguration=function(e){this.oConfiguration=e};sap.uiext.inbox.Inbox.prototype._handleSearchUsersClickforForward=function(e){var t=e.oParentSource;var i=t.data("SAP__Origin");if(!i){var a=t.getBindingContext();i=this.getCoreModel().getProperty("SAP__Origin",a)}if(typeof i==="object"&&i.length>1){i=i[0]}var o=this.oConfiguration?this.oConfiguration.getSearchUersMaxLimit():100;if(this.oPendingSearchRequest!==undefined){this.oPendingSearchRequest.abort()}return this._searchUsers({sSearchTerm:jQuery.trim(this._getComponent("oSearch").getValue()),iMaxResults:o,sSAPOrigin:i})};sap.uiext.inbox.Inbox.prototype._bindTaskActionsProperties=function(e,t){e.setVisible(true);e.bindProperty("enabled",t)};sap.uiext.inbox.Inbox.prototype._bindTaskActions=function(e){var t=this._getComponent("claimActionButton");var i=this._getComponent("releaseActionButton");var a=this._getComponent("openActionButton");var o=this._getComponent("forwardActionButton");var s=this._getComponent("rrViewClaimAction");var r=this._getComponent("rrViewReleaseAction");var n=this._getComponent("rrViewForwardAction");if(this.typeOfModel==="OData"){var l=this.constants.ENTITY_NAME_TASK_COLLECTION;if(this.oTcmMetadata._isPropertyAvailable(l,"SupportsClaim")){this._bindTaskActionsProperties(t,"SupportsClaim");this._bindTaskActionsProperties(s,"SupportsClaim")}if(this.oTcmMetadata._isPropertyAvailable(l,"SupportsRelease")){this._bindTaskActionsProperties(i,"SupportsRelease");this._bindTaskActionsProperties(r,"SupportsRelease");this._setVisibility("dotSeparator",true)}if(this.oTcmMetadata._isPropertyAvailable(l,"SupportsForward")&&this.isForwardActionEnabled){this._bindTaskActionsProperties(o,"SupportsForward");this._bindTaskActionsProperties(n,"SupportsForward");this._setVisibility("dotSeparator2",true)}else if(!this.isForwardActionEnabled){var u=this._getComponent("taskActionMatrixLayout");var d=u.getRows()[0];var p=d.getCells()[3];var c=d.getCells()[4];d.removeCell(p);d.removeCell(c)}}else{this.showAllActions();s.bindProperty("enabled","SupportsClaim");r.bindProperty("enabled","SupportsRelease");if(this.isForwardActionEnabled){n.bindProperty("enabled","SupportsForward")}}};sap.uiext.inbox.Inbox.prototype._refreshLocal=function(e,t,i){if(this.currentView===this.constants.tableView){this._refreshLocalTableView(e,t,i)}else{this._refreshLocalRowRepeaterView(e,t,i)}var a=new sap.ui.base.Event;a.mParameters={url:"/TaskCollection"};this._handleRequestCompleted(a)};sap.uiext.inbox.Inbox.prototype._refreshLocalTableView=function(e,t,i){var a=this._currentViewElement();var o=a.getModel();var s=this._getTableIndicesByContext(e,a),r=this;if(e&&e.length>0){jQuery.each(e,function(e,t){r._deleteTaskEntry(t,o,s[e],a,i)});a.rerender()}if(t){this._changeTaskData(t,o,a)}};sap.uiext.inbox.Inbox.prototype._refreshLocalRowRepeaterView=function(e,t,i){var a=this._currentViewElement();var o=a.getModel();if(e&&e.length>0){var s=a.indexOfRow(e[0].orow);if(s>-1){this._deleteTaskEntry(e[0].context,o,s,a,i);a.updateRows(false)}}if(t){this._changeTaskData(t,o,a)}};sap.uiext.inbox.Inbox.prototype._deleteTaskEntry=function(e,t,i,a,o){if(!o){t.deleteCreatedEntry(e)}var s=a.mBindingInfos["rows"].binding;if(s){s.aKeys.splice(jQuery.inArray(e.getPath().substr(1),s.aKeys),1);s.iLength=s.iLength-1}};sap.uiext.inbox.Inbox.prototype._changeTaskData=function(e,t,i){var a=t.oData,o=this;jQuery.each(e,function(e,t){var s=t.context;var r=t.keys;var n=s.getPath().substr(1);var l=a[n];if(o._currentView()===o.constants.tableView){i.rerender()}jQuery.each(r,function(e,t){l[t.key]=t.value;if(l.Status==="RESERVED"){l.SupportsClaim=false;l.SupportsRelease=true}else if(l.Status==="READY"){l.SupportsClaim=true;l.SupportsRelease=false}});if(o._currentView()===o.constants.rowRepeaterView){i.updateRows(false)}})};sap.uiext.inbox.Inbox.prototype._getAppliedStatusFilterValues=function(e,t,i){var i=this._currentViewElement(),a=this._currentViewElement().getBinding("rows");var o=a.aFilters.concat(a.aApplicationFilters);if(a&&o&&o.length>0){var s=[];if(this.inboxUtils._hasFilter(o,"Status","EQ","READY")){s.push("READY")}if(this.inboxUtils._hasFilter(o,"Status","EQ","RESERVED")){s.push("RESERVED")}if(this.inboxUtils._hasFilter(o,"Status","EQ","IN_PROGRESS")){s.push("IN_PROGRESS")}return s}};sap.uiext.inbox.Inbox.prototype._handleErrorOnBatchRequests=function(e,t,i){this.hideBusyLoader();this.showMessage("error",this._oBundle.getText("INBOX_MSG_ACTION_FAILED_MULTIPLE_TASKS",[t,i]))};sap.uiext.inbox.Inbox.prototype._handleErrorOnActionFailed=function(e,t,i){this.hideBusyLoader();this.showMessage("error",this._oBundle.getText("INBOX_MSG_ACTION_FAILED",[t,i]))};sap.uiext.inbox.Inbox.prototype.storeFilterState=function(e){var t=this;var i=this.bShowNoDueDateFilter?this.constants.filterKeysMetaMapWithNoDueDate:this.constants.filterKeysMetaMap;var a=i[e];jQuery.each(a,function(i,a){if(t.filtersToApply[a]!=undefined){var o=t.filtersToApply[a];if(t.filterState[e]===undefined){t.filterState[e]={};t.filterState[e].filters={}}t.filterState[e].filters[a]=o}})};sap.uiext.inbox.Inbox.prototype.retrieveFilterState=function(e){var t=this;if(t.filterState[e]){var i=t.filterState[e].filters;jQuery.each(i,function(e,a){t.filtersToApply[e]=a;delete i[e]});delete t.filterState[e]}};sap.uiext.inbox.Inbox.prototype._toggleCustomAttributesVisibilityActionEvent=function(e,t){var i=e.getSource();var a=i.getPressed();t._toggleCustomAttributesIcon(i,a);i.setTooltip(t._oBundle.getText(a?"INBOX_HIDE_ALL_CUSTOM_ATTRIBUTES":"INBOX_SHOW_ALL_CUSTOM_ATTRIBUTES"));t.bCustomAttributesVisible=a;a?t._addCustomAttributes(t):t._removeCustomAttributes()};sap.uiext.inbox.Inbox.prototype._addCustomAttributes=function(e){var t=e._getComponent("tasksRowRepeater");var i=t.getRows();var a=e.getId();jQuery.each(i,function(t,i){e._updateActionButtonsContent(true,t);var a=e.getModel().getProperty(e.constants.TaskCollection.properties.instanceID,i.getBindingContext());var o=e.getModel().getProperty(e.constants.sapOrigin,i.getBindingContext());if(!(a&&o))return false;var s=e.getModel().getProperty(e.constants.TaskDefinitionCollection.properties.taskDefnID,i.getBindingContext());e._getCustomAttributeContentforRowRepeater(null,t,s,a,o)})};sap.uiext.inbox.Inbox.prototype._removeCustomAttributes=function(){var e=this._getComponent("tasksRowRepeater").getRows();var t=this;jQuery.each(e,function(e,i){t._removeActionContentinRowRepeater(e);t._updateActionButtonsContent(false,e)})};sap.uiext.inbox.Inbox.prototype._updateActionButtonsContent=function(e,t){var i=sap.ui.getCore().byId(this.getId()+"--customAttributesSegBtn-"+this.getId()+"--tasksRowRepeater-"+t);this.inboxUtils.deSelectOtherActionButtonsinStreamView(i);i.setPressed(e);i.setIcon("");i.setIcon(this.constants.iconPool.getIconURI(e?"collapse":"expand"));i.setTooltip(this._oBundle.getText(e?"INBOX_HIDE_CUSTOM_ATTRIBUTES":"INBOX_SHOW_CUSTOM_ATTRIBUTES"))};sap.uiext.inbox.Inbox.prototype._toggleCustomAttributesIcon=function(e,t){e.setIcon(sap.ui.core.IconPool.getIconURI(""));e.setIcon(this.constants.iconPool.getIconURI(t?"collapse":"expand"))};sap.uiext.inbox.Inbox.prototype._createNoDataLabel=function(e){var t=new sap.ui.commons.Label({text:e,tooltip:e,width:"100%",textAlign:sap.ui.core.TextAlign.Center});t.addStyleClass("sapUIExtInboxCustomAttributesBorder");return t};sap.uiext.inbox.Inbox.prototype.setOpenTaskUIInNewTab=function(e){this.bOpenTaskUIInNewTab=e};sap.uiext.inbox.Inbox.prototype._applySortOnTableColumn=function(e,t,i,a){this._resetStateBeforeSearch();var o=this.getCoreModel();var s=this._currentViewElement();var r=s._originalKeys;if(this._isTableFiltered(null)){r=this._getCurrentBindingKeysForTableColumnFilters(o._original_data,s._originalKeys,null)}var n=new Array;for(var l=0;l<r.length;l++){var u=o._original_data[r[l]];var d=u.CustomAttributeData.__list;var p=null;for(var c=0;c<d.length;c++){var g=d[c];if(g.indexOf(t)>0){p=o._original_data[g].Value;break}}var f={key:r[l],type:i,dir:a,val:p};n.push(f)}var h=function(e,t){var i={parse:function(e){if(!e||e.length==0)return NaN;var t=e.split(":");if(t.length!=3)return NaN;var i=parseInt(t[0]);if(isNaN(i))return NaN;var a=parseInt(t[1]);if(isNaN(a))return NaN;var o=parseInt(t[2]);var s=o.indexOf(".");if(s>=0)o=o.substring(0,s);var r=parseInt(o);if(isNaN(r))return NaN;return i*60*60+a*60+r}};var a={parse:function(e){var t=0;var i=0;var a=0;var o=new String(e);var s=o.indexOf("T");if(s>=0){o=o.substring(s+1,o.length);var r=o.indexOf("H");var n=o.indexOf("M");var l=o.indexOf("S");if(r>=0){t=o.substring(0,r);if(isNaN(t))t=0}if(n>=0){i=o.substring(r+1,n);if(isNaN(i))i=0}if(l>=0){a=o.substring(n+1,l);if(isNaN(a))a=0}}return t*60*60+i*60+a}};var o=e.type.toLowerCase();var s=e.dir.toLowerCase().indexOf("ascending")>=0?1:-1;if(o.indexOf("boolean")>=0){var r=(e.val+"").toLowerCase()=="true"?true:false;var n=(t.val+"").toLowerCase()=="true"?true:false;if(r==n)return 0;return s*(r?-1:1)}else if(o.indexOf("date")>=0||o.indexOf("time")>=0){var l=Date.parse(e.val);var u=Date.parse(t.val);if(isNaN(l)){l=i.parse(e.val)}if(isNaN(l)){l=a.parse(e.val)}if(isNaN(u)){u=i.parse(t.val)}if(isNaN(u)){u=a.parse(t.val)}if(l==u)return 0;return s*(l<u?-1:1)}else if(o.indexOf("decimal")>=0||o.indexOf("float")>=0||o.indexOf("integer")>=0||o.indexOf("long")>=0){var d=0;var p=0;if(isFinite(e.val)){d=Number(e.val);if(isNaN(d))d=0}if(isFinite(t.val)){p=Number(t.val);if(isNaN(p))p=0}if(d.valueOf()==p.valueOf())return 0;return s*(d.valueOf()<p.valueOf()?-1:1)}return s*(e.val+"").localeCompare(t.val+"")};n.sort(h);var I=new Array;for(var l=0;l<n.length;l++){I[I.length]=n[l].key}this._renderTableAfterSort(e,a,I,o._original_data,o)};sap.uiext.inbox.Inbox.prototype._applyFilterOnTableColumns=function(e,t){var i=t.toLowerCase();var a=this.getCoreModel();var o=this._currentViewElement();var s=[];var r=[];this._resetStateBeforeSearch();var n=this._getBindingKeysForTableColumnFilter(e,a._original_data,o._originalKeys,i);s.push(n);if(this._isTableFiltered(e)){s.push(this._getCurrentBindingKeysForTableColumnFilters(a._original_data,o._originalKeys,e))}var l=this._getLocalSearchText();if(l){s.push(this._getBindingKeysOnLocalSearch(l,a._original_data,o._originalKeys))}r=this.inboxUtils._getUniqueArray(s);e.setFiltered(!!i);e.setFilterValue(i);this._renderTableAfterSearch(r,a._original_data,a)};sap.uiext.inbox.Inbox.prototype._getBindingKeysForTableColumnFilter=function(e,t,i,a){var o=[];var s=e.getProperty("filterProperty");for(var r in i){var n=false;var l,u;for(var d in t){if(i[r]==d){var p=t[d];if(e.data("ColumnType")=="StandardAttribute"){for(var c=0;c<this._getCategoryMetadata().properties.length;c++){u=this._getCategoryMetadata().properties[c];if(u===s){var l=p[u];if(!l&&u==="TaskTitle"){l=this._oBundle.getText("INBOX_TASK_TITLE_NOTAVAILABLE_MSG")}if(l!=null){if(jQuery.type(l)==="date"){l=this.inboxUtils.dateTimeFormat(l)}l=l.toLowerCase();if(l.indexOf(a)>=0){n=true;break}}}}}else if(e.data("ColumnType")=="CustomAttribute"){var g=p.CustomAttributeData.__list;if(g!==undefined){for(var f=0;f<g.length;f++){var h=g[f];if(s&&h.indexOf(s)>0){var l=t[h].Value;if(l!=null||l!=undefined){l=l.toLowerCase();if(l.indexOf(a)>=0){n=true;break}}}}}}if(n){var I=d;o.push(I)}}}}return o};sap.uiext.inbox.Inbox.prototype._preserveTableFilters=function(){var e=this.getCoreModel();var t,i;var i=this._currentViewElement();this._resetStateBeforeSearch();var a=this._getCurrentBindingKeysForTableColumnFilters(e._original_data,i._originalKeys);if(a)this._renderTableAfterSearch(a,e._original_data,e)};sap.uiext.inbox.Inbox.prototype._preserveTableSort=function(){var e=this._getComponent("listViewTable");var t=e.getColumns();for(var i=0;i<t.length;i++){var a=t[i];if(a.getSorted()){if(this._isCustomAttribute(a)){a.sort(a.getSortOrder()===sap.ui.table.SortOrder.Descending,false)}}}};sap.uiext.inbox.Inbox.prototype._renderTableAfterSort=function(e,t,i,a,o){var s=this._currentViewElement();var r=s.mBindingInfos["rows"];var n={};for(var l in i){n[i[l]]=a[i[l]]}o.oData=n;if(r&&r.binding){r.binding.iLength=i.length;r.binding.aKeys=i;this.currentView===this.constants.tableView?s.rerender():s.updateRows(false)}var u=s.getBinding("rows").iLength;if(u<=0)this.showMessage("info",this._oBundle.getText("INBOX_MSG_FOR_NO_DATA"));else this.deleteMessage();var d=e.getParent();var p=d.getColumns();for(var l=0,c=p.length;l<c;l++){if(p[l]!==e){p[l].setProperty("sorted",false,true);p[l].setProperty("sortOrder",sap.ui.table.SortOrder.Ascending,true);p[l]._renderSortIcon();delete p[l]._oSorter}}e.setProperty("sorted",true,true);e.setProperty("sortOrder",t,true);e._oSorter=new sap.ui.model.Sorter(e.getSortProperty(),e.getSortOrder()===sap.ui.table.SortOrder.Descending);if(e._afterSort){e._afterSort()}e._renderSortIcon()};sap.uiext.inbox.Inbox.prototype._renderTableAfterSearch=function(e,t,i){var a=this._currentViewElement();var o=a.mBindingInfos["rows"];var s={};for(var r in e){s[e[r]]=t[e[r]]}i.oData=s;if(o&&o.binding){o.binding.iLength=e.length;o.binding.aKeys=e;this.currentView===this.constants.tableView?a.rerender():a.updateRows(false);a._updateBindingContexts(undefined,undefined,"change")}var n=a.getBinding("rows").iLength;if(n<=0)this.showMessage("info",this._oBundle.getText("INBOX_MSG_FOR_NO_DATA"));else this.deleteMessage();this.fireODataRequestCompleted({bindingLength:n,appliedFilter:this._oBundle.getText("INBOX_SEARCH_RESULTS_TEXT")})};sap.uiext.inbox.Inbox.prototype._getCurrentBindingKeysForTableColumnFilters=function(e,t,i){var a=this._getComponent("listViewTable");var o=a.getColumns();var s=[];var r,n,l;if(i){var u=i.getId();for(l=0;l<o.length;l++){var r=o[l];if(r.getFiltered()&&r.getId()!==u){var n=r.getFilterValue();s.push(this._getBindingKeysForTableColumnFilter(r,e,t,n))}}}else{for(l=0;l<o.length;l++){r=o[l];if(r.getFiltered()){n=r.getFilterValue();s.push(this._getBindingKeysForTableColumnFilter(r,e,t,n))}}}return this.inboxUtils._getUniqueArray(s)};sap.uiext.inbox.Inbox.prototype._isTableFiltered=function(e){var t=this._getComponent("listViewTable");var i=t.getColumns();if(e){var a=e.getId();jQuery.each(i,function(e,t){if(t.getId()===a){i.splice(e,1);return false}})}for(var o=0;o<i.length;o++){var s=i[o];if(s.getFiltered()){return true}}return false};sap.uiext.inbox.Inbox.prototype._getLocalSearchText=function(){var e=this._getComponent("searchField");var t=e.getValue();if(t!==""&&t!==null){t=t.toLowerCase();return t}return};sap.uiext.inbox.Inbox.prototype._removeTableFilters=function(){var e=this._getComponent("listViewTable");var t=e.getColumns();jQuery.each(t,function(e,t){if(t.getFiltered()){t.setFiltered(false);t.setFilterValue("")}})};sap.uiext.inbox.Inbox.prototype._resetStateBeforeSearch=function(){var e=this.getCoreModel();var t=this._currentViewElement();if(this.modelRefreshed){e._original_data=e.oData;this.modelRefreshed=false}if(!t._originalKeys){t._originalKeys=t.getBinding("rows").aKeys}};sap.uiext.inbox.Inbox.prototype._handleCustomActionClick=function(e,t){var i=e.getSource().data("commentsMandatory");var a=i==true?this.oCustomActionToolPopupCommentsMand:this.oCustomActionToolPopup;if(a&&a.getOpener()===e.getSource().getId()){var o=a.getContent()[0];if(o){o.setValue("");if(i==true){sap.ui.getCore().byId(this.getId()+"--"+"toolPopupButton-CommentsMand").setEnabled(false)}}a.isOpen()?a.close():a.open(sap.ui.core.Popup.Dock.BeginTop,sap.ui.core.Popup.Dock.BeginBottom)}else this._openCustomActionToolPopup(e.getSource(),t)};sap.uiext.inbox.Inbox.prototype._openCustomActionToolPopup=function(e,t){var i=e.data("key"),a=e.data("commentsMandatory"),o=this.getId()+"--"+"toolPopupButton",s=this.getId()+"--"+"addCommentsinCustomActionPopup";if(a==true){var r=this.oCore.byId(s+"-CommentsMand");var n=this.oCore.byId(o+"-CommentsMand")}else{var r=this.oCore.byId(s);var l=this.oCore.byId(o)}if(a==false){if(!l){l=new sap.ui.commons.Button(o,{press:jQuery.proxy(function(e){var t=r.getValue();var i=sap.ui.getCore().byId(this.oCustomActionToolPopup.getOpener());this._executeCustomAction(i,jQuery.sap._sanitizeHTML(t));this.oCustomActionToolPopup.close()},this)})}if(!this.oCustomActionToolPopup){r=new sap.ui.commons.TextArea(s).setWidth("300px");this.oCustomActionToolPopup=new sap.ui.ux3.ToolPopup(this.getId()+"--"+"customActionToolPopup",{inverted:false,content:[r],buttons:[l],title:this._oBundle.getText("INBOX_ADD_COMMENT"),autoClose:true})}this._resetCustomActionToolPopupContent(r,l,e.data("text"),i);this.oCustomActionToolPopup.setOpener(e);if(!this.oCustomActionToolPopup.isOpen()){this.oCustomActionToolPopup.open(sap.ui.core.Popup.Dock.BeginTop,sap.ui.core.Popup.Dock.BeginBottom)}}else if(a==true){if(!n){n=new sap.ui.commons.Button(o+"-CommentsMand",{press:jQuery.proxy(function(e){var t=r.getValue();var i=sap.ui.getCore().byId(this.oCustomActionToolPopupCommentsMand.getOpener());this._executeCustomAction(i,jQuery.sap._sanitizeHTML(t));this.oCustomActionToolPopupCommentsMand.close()},this)})}if(!this.oCustomActionToolPopupCommentsMand){r=new sap.ui.commons.TextArea(s+"-CommentsMand",{liveChange:function(e){var t=e.getSource().getLiveValue();t.trim().length>0?n.setEnabled(true):n.setEnabled(false)}}).setWidth("300px");this.oCustomActionToolPopupCommentsMand=new sap.ui.ux3.ToolPopup(this.getId()+"--"+"customActionToolPopup-CommentsMand",{inverted:false,content:[r],buttons:[n],title:this._oBundle.getText("INBOX_ADD_COMMENT"),autoClose:true})}n.setEnabled(false);this._resetCustomActionToolPopupContent(r,n,e.data("text"),i);this.oCustomActionToolPopupCommentsMand.setOpener(e);if(!this.oCustomActionToolPopupCommentsMand.isOpen()){this.oCustomActionToolPopupCommentsMand.open(sap.ui.core.Popup.Dock.BeginTop,sap.ui.core.Popup.Dock.BeginBottom)}}};sap.uiext.inbox.Inbox.prototype._resetCustomActionToolPopupContent=function(e,t,i,a){if(e){e.setValue("")}var o=i||a;t.setText(o);t.setTooltip(o);t.data("key",a)};sap.uiext.inbox.Inbox.prototype._getAttachments=function(e,t){var i=this;var a=e.getParent().getBindingContext();var o=this._getAttachmentsUrl(a);var s=this.getCoreModel();var r={async:true,requestUri:o,method:"GET",headers:{Accept:i.constants.acceptHeaderforJSON,"x-csrf-token":s.oHeaders["x-csrf-token"]}};OData.request(r,function(e,o){var s=e.results;i._displayAttachments(s,t,a)},function(e){i.showMessage("error",i._oBundle.getText("INBOX_MSG_FETCH_ATTACHMENTS_FAILS"))})};sap.uiext.inbox.Inbox.prototype._displayAttachments=function(e,t,i){var a=this;var o=this.getModel().getProperty("Status",i);var s=o==="COMPLETED";var r=sap.ui.Device.browser.msie&&sap.ui.Device.browser.version<10;var n=!(s||r);if(!n&&e&&e.length<1){this._addActionContentinRowRepeater(t,"attachments",this._createNoDataLabel(this._oBundle.getText("INBOX_MSG_FOR_NO_DATA")))}else{var l=new sap.ui.model.json.JSONModel(e);var u=this._createAttachmentContainer(t,i,n);u.setModel(l);var d=this._createAttachmentTileTemplate(s);u.bindAggregation("attachments",{path:"/",template:d});var p=new sap.ui.commons.layout.MatrixLayout({layoutFixed:true,width:"100%"});var c=new sap.ui.commons.layout.MatrixLayoutCell;c.addContent(u);c.addStyleClass("sapUIExtInboxCommentsBorder");p.createRow(c);this._addActionContentinRowRepeater(t,"attachments",p)}};sap.uiext.inbox.Inbox.prototype._createAttachmentContainer=function(e,t,i){var a=this;var o=this.getCoreModel();var s=this._getComponent("attachmentContainer-"+e);if(!s){s=new sap.uiext.inbox.composite.InboxAttachmentsTileContainer(this.getId()+"--"+"attachmentContainer-"+e,{showAddTile:i,uploadUrl:a._getAttachmentsUrl(t),uploadButtonPress:function(e){a._addParametersBeforeUpload(e);this.triggerUpload()},uploadSuccess:function(e){var t=this.getModel();t.oData.push(JSON.parse(e.getParameter("attachmentResponse")).d);t.checkUpdate(false);if(this.bTokenRefreshed)this.bTokenRefreshed=false;a.showMessage("success",a._oBundle.getText("INBOX_MSG_UPLOAD_ATTACHMENT_SUCCESS"))},uploadFailed:function(e){var t=e.getParameter("statusCode");if(t&&t==403){var i=e.getParameter("securityToken");if(!this.bTokenRefreshed&&i&&i.toLowerCase()=="required"){a.getCoreModel().refreshSecurityToken();this.bTokenRefreshed=true;var s=e.getParameter("headerParameters");this.removeUploadHeader("x-csrf-token");this.addUploadHeader("x-csrf-token",o.oHeaders["x-csrf-token"]);this.triggerUpload()}else{this.bTokenRefreshed=false;a.showMessage("error",a._oBundle.getText("INBOX_MSG_UPLOAD_ATTACHMENT_FAILURE"))}}else{this.bTokenRefreshed=false;a.showMessage("error",a._oBundle.getText("INBOX_MSG_UPLOAD_ATTACHMENT_FAILURE"))}}})}return s};sap.uiext.inbox.Inbox.prototype._createAttachmentTileTemplate=function(e){var t=this;var i=new sap.uiext.inbox.composite.InboxAttachmentTile({fileName:"{FileName}",createdBy:{parts:[{path:"CreatedByName"},{path:"CreatedBy"}],formatter:function(e,t){if(e&&e!=="")return e;else if(t&&t!=="")return t}},fileDescription:"{FileDisplayName}",creationDate:{path:"CreatedAt",formatter:function(e){return t.inboxUtils.dateTimeFormat(e,true)}},fileTypeIcon:{path:"mime_type",formatter:t.inboxUtils._getFileTypeIcon},fileSize:{path:"FileSize",formatter:t.inboxUtils._getFileSize},downloadUrl:{parts:[{path:"InstanceID"},{path:"SAP__Origin"},{path:"ID"}],formatter:function(e,i,a){return t.bpmSvcUrl+t._getAttachmentValueUrl(e,i,a)}},showDeleteButton:!e}).attachDeleteAttachment(this,this._deleteAttachment);return i};sap.uiext.inbox.Inbox.prototype._addParametersBeforeUpload=function(e){var t=e.getSource();var i=this;if(t.getIsFileSelected()){var a=this.getCoreModel();t.addUploadHeader("slug",t.getFileName());t.addUploadHeader("Content-Type",t.getFileType());t.addUploadHeader("Accept",this.constants.acceptHeaderforJSON);t.addUploadHeader("x-csrf-token",a.oHeaders["x-csrf-token"])}};sap.uiext.inbox.Inbox.prototype._deleteAttachment=function(e,t){var i=this;var a=this.getModel();var o=this.getBindingContext();var s=t.constants.TaskCollection;var r=a.getProperty("InstanceID",o);var n=a.getProperty("SAP__Origin",o);var l=a.getProperty("ID",o);var u=t._getAttachmentValueUrl(r,n,l);var d=t.getCoreModel();t.oDataManager.removeData(t._getAttachmentValueUrl(r,n,l),{success:function(e,i){var s=o.getPath().split("/");a.oData.splice(s[1],1);a.checkUpdate(false);t.showMessage("success",t._oBundle.getText("INBOX_MSG_DELETE_ATTACHMENT_SUCCESS"))},error:function(e){t.showMessage("error",t._oBundle.getText("INBOX_MSG_DELETE_ATTACHMENT_FAILURE"))}},true)};sap.uiext.inbox.Inbox.prototype._getAttachmentsUrl=function(e){var t=this.constants;var i=t.TaskCollection;var a=this.getModel();var o=a.getProperty("InstanceID",e);var s=a.getProperty("SAP__Origin",e);var r=this.bpmSvcUrl+t.forwardSlash+i.entityName+"("+i.properties.instanceID+"='"+o+"',"+t.sapOrigin+"='"+s+"')"+t.forwardSlash+t.attachmentCollection.navParam.attachment;return r};sap.uiext.inbox.Inbox.prototype._getAttachmentValueUrl=function(e,t,i){var a=this.constants;var o=a.TaskCollection;var s=a.attachmentCollection;var r=a.forwardSlash+s.entityName+"("+o.properties.instanceID+"='"+e+"',"+a.sapOrigin+"='"+t+"',"+s.properties.id+"='"+i+"')"+a.forwardSlash+s.navParam.value;return r};sap.uiext.inbox.Inbox.prototype._initODataModel=function(){var e=this;this.oModel.refreshSecurityToken(null,null,true);this.oModel.attachMetadataLoaded(function(t){var i=this.getServiceMetadata();if(this.sServiceUrl&&i){e.oTcmMetadata.setServiceMetadata(i)}e._bindTaskActions()});if(this.getHandleBindings()){this.bpmSvcUrl=this.oModel.sServiceUrl}};sap.uiext.inbox.Inbox.prototype._getBindingParameters=function(){var e={};var t=this._getExpandParameters();if(this.typeOfModel==="OData"){e.countMode=sap.ui.model.odata.CountMode.InlineRepeat;e.faultTolerant=true}if(t.length>0){e.expand=t}return e};
//# sourceMappingURL=Inbox.js.map