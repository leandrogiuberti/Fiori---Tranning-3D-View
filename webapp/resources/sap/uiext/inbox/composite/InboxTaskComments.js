/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
jQuery.sap.declare("sap.uiext.inbox.composite.InboxTaskComments");jQuery.sap.require("sap.uiext.inbox.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.uiext.inbox.composite.InboxTaskComments",{metadata:{library:"sap.uiext.inbox",properties:{feederSender:{type:"string",group:"Data",defaultValue:null},feederThumbnailSrc:{type:"sap.ui.core.URI",group:"Data",defaultValue:null},showFeeder:{type:"boolean",group:"Data",defaultValue:true},showHeader:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{comments:{type:"sap.uiext.inbox.composite.InboxComment",multiple:true,singularName:"comment"},busyIndicator:{type:"sap.uiext.inbox.composite.InboxBusyIndicator",multiple:false,visibility:"hidden"}},events:{commentSubmit:{}}}});jQuery.sap.require("sap.ui.core.theming.Parameters");jQuery.sap.require("sap.ui.ux3.Feeder");jQuery.sap.require("sap.uiext.inbox.composite.InboxBusyIndicator");sap.uiext.inbox.composite.InboxTaskComments.prototype.init=function(){this.maxComments=2;this.allComments=false;this.rb=sap.ui.getCore().getLibraryResourceBundle("sap.uiext.inbox");this.initCommentFeeder()};sap.uiext.inbox.composite.InboxTaskComments.prototype.initCommentFeeder=function(){if(!this.oCommentFeeder){this.oCommentFeeder=new sap.ui.ux3.Feeder(this.getId()+"-InboxTaskCommentFeeder",{type:sap.ui.ux3.FeederType.Comment,thumbnailSrc:this.getFeederThumbnailSrc()}).setParent(this);this.oCommentFeeder.attachEvent("submit",this.handleCommentFeederSubmit,this);this.showCommentFeeder=true}};sap.uiext.inbox.composite.InboxTaskComments.prototype.exit=function(){if(this.oCommentFeeder){this.oCommentFeeder.destroy();delete this.oCommentFeeder}this.rb=undefined;this.showCommentFeeder=undefined;this.oText=undefined};sap.uiext.inbox.composite.InboxTaskComments.prototype.onclick=function(e){var t=e.target.getAttribute("ID");if(t){switch(t){case this.getId()+"-all":this.showAllComments();break}}e.stopPropagation()};sap.uiext.inbox.composite.InboxTaskComments.prototype.onAfterRendering=function(){jQuery.sap.byId(this.getId()+"-InboxTaskCommentFeeder"+"-input").bind("keyup",this,this.keyupHandler)};sap.uiext.inbox.composite.InboxTaskComments.prototype.keyupHandler=function(e){var t=e.data;var o=t.getId()+"-InboxTaskCommentFeeder"+"-input";var n=jQuery.sap.byId(o).text();var i=500;if(n.length>i){jQuery.sap.byId(o).text(n.slice(0,i));t.placeCaretAtEnd(document.getElementById(o))}};sap.uiext.inbox.composite.InboxTaskComments.prototype.placeCaretAtEnd=function(e){e.focus();if(typeof window.getSelection!="undefined"&&typeof document.createRange!="undefined"){var t=document.createRange();t.selectNodeContents(e);t.collapse(false);var o=window.getSelection();o.removeAllRanges();o.addRange(t)}else if(typeof document.body.createTextRange!="undefined"){var n=document.body.createTextRange();n.moveToElementText(e);n.collapse(false);n.select()}};sap.uiext.inbox.composite.InboxTaskComments.prototype.showAllComments=function(){this.allComments=!this.allComments;var e=jQuery.sap.byId(this.getId()+" > section");if(e.length>0){var t=sap.ui.getCore().createRenderManager();this.getRenderer().renderComments(t,this);t.flush(e[0]);t.destroy()}};sap.uiext.inbox.composite.InboxTaskComments.prototype.handleCommentFeederSubmit=function(e){var t=this._sanitizeText(e.getParameter("text"));this.fireCommentSubmit({text:t})};sap.uiext.inbox.composite.InboxTaskComments.prototype.setFeederThumbnailSrc=function(e){this.setProperty("feederThumbnailSrc",e);if(this.oCommentFeeder){this.oCommentFeeder.setThumbnailSrc(e)}};sap.uiext.inbox.composite.InboxTaskComments.prototype.insertComment=function(e,t){this.insertAggregation("comments",e,t);this.initCommentFeeder();return this};sap.uiext.inbox.composite.InboxTaskComments.prototype.addComment=function(e){this.addAggregation("comments",e);this.initCommentFeeder();return this};sap.uiext.inbox.composite.InboxTaskComments.prototype._sanitizeText=function(e){var t=jQuery.sap._sanitizeHTML(e);return t.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')};sap.uiext.inbox.composite.InboxTaskComments.prototype.showBusy=function(e){if(e){var t=new sap.uiext.inbox.composite.InboxBusyIndicator;t.setBusy(true);this.setAggregation("busyIndicator",t)}else{this.destroyAggregation("busyIndicator")}};
//# sourceMappingURL=InboxTaskComments.js.map