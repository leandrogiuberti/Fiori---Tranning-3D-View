/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
jQuery.sap.declare("sap.uiext.inbox.composite.InboxAttachmentsTileContainer");jQuery.sap.require("sap.uiext.inbox.library");jQuery.sap.require("sap.ui.core.Control");sap.ui.core.Control.extend("sap.uiext.inbox.composite.InboxAttachmentsTileContainer",{metadata:{library:"sap.uiext.inbox",properties:{uploadUrl:{type:"string",group:"Misc",defaultValue:null},fileName:{type:"string",group:"Misc",defaultValue:null},fileType:{type:"string",group:"Misc",defaultValue:null},isFileSelected:{type:"boolean",group:"Misc",defaultValue:null},enteredDescription:{type:"string",group:"Misc",defaultValue:null},showAddTile:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{attachments:{type:"sap.uiext.inbox.composite.InboxAttachmentTile",multiple:true,singularName:"attachment"},firstTile:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},events:{uploadButtonPress:{},uploadSuccess:{},uploadFailed:{}}}});jQuery.sap.require("sap.uiext.inbox.composite.InboxAttachmentFileUploader");jQuery.sap.require("sap.uiext.inbox.InboxUtils");jQuery.sap.require("sap.ui.commons.MessageBox");sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.init=function(){var e=this;this.oUtils=sap.uiext.inbox.InboxUtils;this._oBundle=sap.ui.getCore().getLibraryResourceBundle("sap.uiext.inbox");this.oAddAttachmentTile=new sap.uiext.inbox.composite.InboxAddAttachmentTile;this.setAggregation("firstTile",this.oAddAttachmentTile);this.oUploadAttachmentTile=new sap.uiext.inbox.composite.InboxUploadAttachmentTile;this.oUploadAttachmentTile.getUploadButton().attachPress(function(t){e.getAggregation("firstTile").setBusy(true);e.fireUploadButtonPress()});this.oUploadAttachmentTile.getCancelButton().attachPress(function(t){e.resetFileUploader();e.resetFirstTile()});this.oFileUploader=new sap.uiext.inbox.composite.InboxAttachmentFileUploader({sendXHR:true,change:jQuery.proxy(function(t){this.oFileUploader.setUploadUrl(this.getUploadUrl());var i=this.oFileUploader.oFileUpload.files[0];if(i&&i.size===0){this.oFileUploader.setValue("");sap.ui.commons.MessageBox.alert(e._oBundle.getText("SIZE_ZERO_ATTACHMENT_ALERT"))}else{this.oUploadAttachmentTile.setFileName(i.name).setFileTypeIcon(this.oUtils._getFileTypeIcon(i.type));this.setAggregation("firstTile",this.oUploadAttachmentTile)}},this),uploadComplete:function(t){var i=t.getParameter("status");if(i&&i==201){e.fireUploadSuccess({attachmentResponse:t.getParameter("response"),statusCode:i,headerParameters:t.getParameter("headerParameters")})}else{e.fireUploadFailed({attachmentResponse:t.getParameter("response"),statusCode:i,securityToken:t.getParameter("x-csrf-token"),headerParameters:t.getParameter("headerParameters")})}e.resetFileUploader();e.resetFirstTile()}})};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.onclick=function(e){if(e.target.id===this.getAggregation("firstTile").getId()+"_textAddAttachment"){jQuery.sap.byId(this.oFileUploader.getId()+"-fu").trigger("click")}};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.getFileName=function(){if(this.getIsFileSelected()){return this.oFileUploader.oFileUpload.files[0].name}};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.getFileType=function(){if(this.getIsFileSelected()){return this.oFileUploader.oFileUpload.files[0].type}};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.addUploadHeader=function(e,t){this.oFileUploader.addHeaderParameter(new sap.ui.commons.FileUploaderParameter({name:e,value:t}))};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.getIsFileSelected=function(){return this.oFileUploader.oFileUpload.files.length>0};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.resetFileUploader=function(){this.oFileUploader.setValue("").destroyHeaderParameters()};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.resetFirstTile=function(){this.getAggregation("firstTile").setBusy(false);this.setAggregation("firstTile",this.oAddAttachmentTile)};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.triggerUpload=function(e){this.oFileUploader.upload()};sap.uiext.inbox.composite.InboxAttachmentsTileContainer.prototype.removeUploadHeader=function(e){var t=this;jQuery.each(this.oFileUploader.getHeaderParameters(),function(i,o){if(o.getName()===e)t.oFileUploader.removeHeaderParameter(o)})};
//# sourceMappingURL=InboxAttachmentsTileContainer.js.map