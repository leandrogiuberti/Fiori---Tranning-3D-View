/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["./BaseContainer","./CardsPanel","./ErrorPanel","./SpaceInsightsPanel","./TilesPanel","./utils/Device","./utils/InsightsUtils","./utils/placeholder/InsightsPlaceholder"],function(t,e,n,i,s,o,a,d){"use strict";function l(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const h=l(t);const r=l(e);const c=e["cardsContainerActionButtons"];const u=e["cardsContainerMenuItems"];const g=l(n);const f=l(i);const p=l(s);const m=s["tilesContainerActionButtons"];const _=s["tilesContainerMenuItems"];const C=o["DeviceType"];const P=a["sortMenuItems"];const E=d["getInsightsPlaceholder"];const I="sap.cux.home.TilesPanel";const H="sap.cux.home.CardsPanel";const L="sap.cux.home.SpaceInsightsPanel";const A=[_.REFRESH,u.REFRESH,_.ADD_APPS,_.EDIT_TILES,u.EDIT_CARDS,u.AI_INSIGHT_CARD,_.SHOW_MORE,u.SHOW_MORE,"settings"];const S=h.extend("sap.cux.home.InsightsContainer",{renderer:{...h.renderer,apiVersion:2},constructor:function t(e,n){h.prototype.constructor.call(this,e,n);this._isInitialRender=true},init:function t(){h.prototype.init.call(this);this.setProperty("title",this._i18nBundle?.getText("insights"));this.setProperty("enableSettings",true);this.setProperty("orientation","Vertical");this.panelLoaded={[I]:{loaded:undefined,count:0},[H]:{loaded:undefined,count:0},[L]:{loaded:undefined,count:0}};this.panelContext={};this.setTooltip(String(this._i18nBundle.getText("insights")));this.addCustomSetting("title",this._i18nBundle.getText("insightLayoutSectionTitle"));this.setTooltip(String(this._i18nBundle.getText("insightLayoutSectionTitle")))},load:function t(){if(this._isInitialRender){const t=this.getContent();t.forEach(t=>{this.panelContext[t.getMetadata().getName()]=t;this.addCommonMenuItems(t.getContainerMenuItems?.());this.addCommonActionButtons(t.getContainerActionButtons?.())});this._addContainerHeader();t.forEach(t=>{const e=t;e.handleHideHeader();e.attachHandleHidePanel(()=>this.handleHidePanel(e));e.attachHandleUnhidePanel(()=>this.unhidePanelIfHidden(e));void e.renderPanel()});this._isInitialRender=false}},handleHidePanel:function t(e){this.removeContent(e);const n=e.getMetadata().getName();this.handlePanelLoad(n,{loaded:false,count:0});const i=this._getLoadedPanelNames()||[];const s=this.getVisibleOrPendingPanels()||[];const o=i?.length;this._addContainerHeader();if(s.length===0||s.length===1&&s[0]===L){if(!this._errorPanel){this._errorPanel=new g(`${this.getId()}-errorPanel`,{messageTitle:this._i18nBundle.getText("noAppsTitle"),messageDescription:this._i18nBundle.getText("noInsightsMsg")});this._errorPanel.getData()}this.addAggregation("content",this._errorPanel)}else if(o===1){const t=this.getContent()[0];if(t&&!(t instanceof g)){t?.handleHideHeader()}}},_addContainerHeader:function t(){const e=this._getLoadedPanelNames();let n=[];let i=[];this.setProperty("title",this._i18nBundle?.getText("insights"));if(e.length===0||this.getContent()[0]instanceof g){n=[_.REFRESH,u.REFRESH,_.SHOW_MORE,u.SHOW_MORE];this._hideMenuItems(n);i=[m.SHOW_MORE,c.SHOW_MORE];this._hideActionButtons(i)}else if(e.length===1){const t=e[0];this.setProperty("title",`${this._i18nBundle?.getText("insights")} (${this.panelLoaded[t].count||0})`);if(this.panelContext[e[0]]instanceof p){n=[u.REFRESH,u.SHOW_MORE];i=[c.SHOW_MORE]}if(this.panelContext[e[0]]instanceof r){n=[_.REFRESH,_.SHOW_MORE];i=[m.SHOW_MORE]}if(this.panelContext[e[0]]instanceof f){this.setProperty("title",`${this.panelContext[e[0]].getTitle()} (${this.panelLoaded[t].count||0})`);n=[_.REFRESH,_.SHOW_MORE,"settings"];i=[m.SHOW_MORE]}this._hideMenuItems(n);this._hideActionButtons(i)}},_removeContainerHeader:function t(){this.setProperty("title","");this.getAggregation("menuItems")?.forEach(t=>this.toggleMenuListItem(t,false));this.getAggregation("actionButtons")?.forEach(t=>this.toggleActionButton(t,false));const e=this._getLoadedPanelNames();e.forEach(t=>{this.panelContext[t]?.handleAddHeader?.()})},_hideMenuItems:function t(e){const n=this.getAggregation("menuItems");n?.forEach(t=>{const n=e.some(e=>t.getId().includes(e));this.toggleMenuListItem(t,!n)})},_hideActionButtons:function t(e){const n=this.getAggregation("actionButtons");n?.forEach(t=>{const n=e.some(e=>t.getId().includes(e));this.toggleActionButton(t,!n)})},updatePanelsItemCount:function t(e,n){this.panelLoaded[n].count=e;const i=this._getLoadedPanelNames();if(i.length===1){const t=this.panelContext[i[0]]instanceof f;this.setProperty("title",`${t?this.panelContext[i[0]].getTitle():this._i18nBundle?.getText("insights")} (${e||0})`)}},unhidePanelIfHidden:function t(e){const n=this._getLayout();const i=n._getCurrentExpandedElementName();if(this._errorPanel){this.removeContent(this._errorPanel)}const s=(t,s)=>{if(!i||i===e.getProperty("fullScreenName")){if(this.panelLoaded[t].loaded===false){s();e.setVisible(true)}this.handlePanelLoad(t,{loaded:true,count:this.panelLoaded[t].count})}else{const i=()=>{s();e.setVisible(true);n.detachOnCollapse(i)};this.handlePanelLoad(t,{loaded:true,count:this.panelLoaded[t].count});n.attachOnCollapse(i)}};if(e instanceof p&&!this.panelLoaded[I].loaded){s(I,()=>this.insertContent(this.panelContext[I],0))}if(e instanceof r&&!this.panelLoaded[H].loaded){s(H,()=>this.addContent(this.panelContext[H]))}if(e instanceof f&&!this.panelLoaded[L].loaded){s(L,()=>this.addContent(this.panelContext[H]))}},_updateHeaderElements:function t(e){const n=this._getLoadedPanelNames();if(n.length>1){this._removeContainerHeader()}else{this._addContainerHeader();e.handleHideHeader()}},adjustLayout:function t(){if(this.getDeviceType()===C.Mobile){this.toggleActionButtons(false)}else{const t=this._getLoadedPanelNames();if(t.length<2){this.getAggregation("actionButtons")?.forEach(t=>{if(t.getId().includes(m.ADD_TILES)){this.toggleActionButton(t,true)}})}}this.getContent().forEach(t=>t._adjustLayout?.())},addCommonMenuItems:function t(e=[]){e.forEach(t=>this.addAggregation("menuItems",t));this._sortMenuItems(A)},addCommonActionButtons:function t(e=[]){e.forEach(t=>this.addAggregation("actionButtons",t))},handlePanelLoad:function t(e,n){if(this.panelLoaded[e].loaded!==n.loaded){this.panelLoaded[e]=n;this._updateHeaderElements(this.panelContext[e])}this.adjustLayout()},updateActionButton:function t(e,n,i){if(e?.getVisible()!==n||e?.getText()!==i){this.toggleActionButton(e,n);e?.setText(i);this._updateContainerHeader(this)}},updateMenuItem:function t(e,n,i){if(e?.getVisible()!==n||e?.getTitle()!==i){this.toggleMenuListItem(e,n);e?.setTitle(i);this._updateContainerHeader(this)}},_getLoadedPanelNames:function t(){return Object.keys(this.panelLoaded).filter(t=>this.panelLoaded[t].loaded)},getVisibleOrPendingPanels:function t(){return Object.keys(this.panelLoaded).filter(t=>this.panelLoaded[t].loaded!==false)},_sortMenuItems:function t(e){const n=this.getAggregation("menuItems");let i=P(e,n);this.removeAllAggregation("menuItems");i?.forEach(t=>this.addAggregation("menuItems",t))},getGenericPlaceholderContent:function t(){return E()},refreshData:function t(e){try{const t=this;const n=Object.values(t.panelContext).find(t=>t.getKey()===e);return Promise.resolve(n?.refreshData?.(true)).then(function(){})}catch(t){return Promise.reject(t)}}});return S});
//# sourceMappingURL=InsightsContainer.js.map