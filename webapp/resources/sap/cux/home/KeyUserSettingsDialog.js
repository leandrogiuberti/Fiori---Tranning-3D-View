/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/m/Button","sap/m/NavContainer","sap/m/Page","sap/ui/core/Element","sap/ui/core/EventBus","./BaseSettingsDialog","./changeHandler/LayoutHandler","./flexibility/Layout.flexibility"],function(e,t,n,s,i,a,o,r){"use strict";function c(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const h=typeof Symbol!=="undefined"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function l(e,t,n){if(!e.s){if(n instanceof u){if(n.s){if(t&1){t=n.s}n=n.v}else{n.o=l.bind(null,e,t);return}}if(n&&n.then){n.then(l.bind(null,e,t),l.bind(null,e,2));return}e.s=t;e.v=n;const s=e.o;if(s){s(e)}}}const u=function(){function e(){}e.prototype.then=function(t,n){const s=new e;const i=this.s;if(i){const e=i&1?t:n;if(e){try{l(s,1,e(this.v))}catch(e){l(s,2,e)}return s}else{return this}}this.o=function(e){try{const i=e.v;if(e.s&1){l(s,1,t?t(i):i)}else if(n){l(s,1,n(i))}else{l(s,2,i)}}catch(e){l(s,2,e)}};return s};return e}();function g(e){return e instanceof u&&e.s&1}function f(e,t,n){var s=-1,i,a;function o(r){try{while(++s<e.length&&(!n||!n())){r=t(s);if(r&&r.then){if(g(r)){r=r.v}else{r.then(o,a||(a=l.bind(null,i=new u,2)));return}}}if(i){l(i,1,r)}else{i=r}}catch(e){l(i||(i=new u),2,e)}}o();return i}const d=c(a);function p(e,t,n){if(typeof e[h]==="function"){var s=e[h](),i,a,o;function p(e){try{while(!(i=s.next()).done&&(!n||!n())){e=t(i.value);if(e&&e.then){if(g(e)){e=e.v}else{e.then(p,o||(o=l.bind(null,a=new u,2)));return}}}if(a){l(a,1,e)}else{a=e}}catch(e){l(a||(a=new u),2,e)}}p();if(s.return){var r=function(e){try{if(!i.done){s.return()}}catch(e){}return e};if(a&&a.then){return a.then(r,function(e){throw r(e)})}r()}return a}if(!("length"in e)){throw new TypeError("Object is not iterable")}var c=[];for(var d=0;d<e.length;d++){c.push(e[d])}return f(c,function(e){return t(c[e])},n)}const v=c(o);const y=r["CHANGE_TYPES"];const C=d.extend("sap.cux.home.KeyUserSettingsDialog",{metadata:{designtime:"not-adaptable-tree"},renderer:{apiVersion:2},init:function n(){d.prototype.init.call(this);this.controlMap=new Map;this.detailPageMap=new Map;this.setContentWidth("23.636rem");this.setContentHeight("23.33rem");this.setStretch(false);this.setShowHeader(false);this.addButton(new e(`${this.getId()}-dialog-save-btn`,{text:this._i18nBundle.getText("saveButton"),type:"Emphasized",press:this.saveChanges.bind(this)}));this.addButton(new e(`${this.getId()}-dialog-close-btn`,{text:this._i18nBundle.getText("XBUT_CLOSE"),type:"Transparent",press:this.handleCancel.bind(this)}));const s=`${this.getId()}-navContainer`;const a=new t(s);this.controlMap.set(s,a);this.addContent(this.controlMap.get(s));this._eventBus=i.getInstance();this._eventBus.subscribe("KeyUserChanges","disabledSaveBtn",(e,t,n)=>{this.getButtons()[0].setEnabled(!n?.disable)},this)},onBeforeRendering:function e(t){d.prototype.onBeforeRendering.call(this,t);const n=this.getNavContainer();n.removeAllPages();this.getPanels().forEach((e,t)=>{n.addPage(this.getPage(e,!t))});if(n.getPages()?.length){this.navigateToPage(n.getPages()[0])}},getPage:function e(t,i){const a=`${this.getId()}-${t.getId()}-page`;let o=this.controlMap.get(a);if(!o){const e=this.getNavContainer();o=new n(a,{title:t.getProperty("title"),showHeader:true,content:t.getAggregation("content"),backgroundDesign:"Transparent",showNavButton:i?false:true,navButtonPress:()=>e.back()});this.controlMap.set(a,o);const r=t.getAssociation("panel",null);const c=s.getElementById(r);const h=c?.getParent()?.getId();if(h){this.detailPageMap.set(h,o)}}return o},navigateToPage:function e(t){const n=t?.getId();const s=n?.substring(0,n.lastIndexOf("-page"));const i=this.getPanels().find(e=>s?.includes(e.getId()));i?.firePanelNavigated();const a=`${this.getId()}-navContainer`;const o=this.controlMap.get(a);if(t){o.to(t)}},getDetailsPage:function e(t){return this.detailPageMap.get(t)},hasDetailsPage:function e(t){return this.detailPageMap.has(t)},getNavContainer:function e(){const t=`${this.getId()}-navContainer`;return this.controlMap.get(t)},saveChanges:function e(){try{const e=this;return Promise.resolve(e.isValidChanges()).then(function(t){if(t){const t=e.getPanels();t.forEach(t=>{const n=t.getKeyUserChanges();if(n.length){e.createAndAddChanges(n);t.clearKeyUserChanges()}});t[1]?.onSaveClearChanges();e.close();v.resolve();v.clearChanges()}})}catch(e){return Promise.reject(e)}},isValidChanges:function e(){try{const e=this;let t=true;const n=e.getPanels()[1];const s=n?.getKeyUserChanges();const i=function(){if(Array.isArray(s)){return p(s,function(e){const s=function(){if(e.changeSpecificData.changeType===y.NEWS_FEED_URL){return Promise.resolve(n.isNewsChangesValid()).then(function(e){t=e})}}();if(s&&s.then)return s.then(function(){})})}}();return Promise.resolve(i&&i.then?i.then(function(){return t}):t)}catch(e){return Promise.reject(e)}},createAndAddChanges:function e(t){const n=[];t.forEach(e=>{n.push(e)});v.addChanges(n)},handleCancel:function e(){const t=this.getPanels();t.forEach(e=>{const t=e.getKeyUserChanges();if(t.length){e.clearKeyUserChanges()}});const n=this.getPanels()[1];n?.onCancelClearKeyUserChanges();v.resolve();v.clearChanges();this.close()}});return C});
//# sourceMappingURL=KeyUserSettingsDialog.js.map