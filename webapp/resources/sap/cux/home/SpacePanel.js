/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/f/GridContainer","sap/f/GridContainerSettings","sap/m/Button","sap/m/Dialog","sap/m/IllustratedMessageSize","sap/m/IllustratedMessageType","sap/m/Input","sap/m/Title","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/ui/core/Icon","sap/ui/core/theming/Parameters","sap/ushell/Config","sap/ushell/Container","./BaseAppPersPanel","./Group","./utils/Accessibility","./utils/CommonUtils","./utils/Constants"],function(t,e,o,n,i,s,r,a,l,p,c,u,d,g,h,f,_,m,y){"use strict";function b(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const I=typeof Symbol!=="undefined"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function v(t,e,o){if(!t.s){if(o instanceof A){if(o.s){if(e&1){e=o.s}o=o.v}else{o.o=v.bind(null,t,e);return}}if(o&&o.then){o.then(v.bind(null,t,e),v.bind(null,t,2));return}t.s=e;t.v=o;const n=t.o;if(n){n(t)}}}const A=function(){function t(){}t.prototype.then=function(e,o){const n=new t;const i=this.s;if(i){const t=i&1?e:o;if(t){try{v(n,1,t(this.v))}catch(t){v(n,2,t)}return n}else{return this}}this.o=function(t){try{const i=t.v;if(t.s&1){v(n,1,e?e(i):i)}else if(o){v(n,1,o(i))}else{v(n,2,i)}}catch(t){v(n,2,t)}};return n};return t}();function D(t){return t instanceof A&&t.s&1}function G(t,e,o){var n=-1,i,s;function r(a){try{while(++n<t.length&&(!o||!o())){a=e(n);if(a&&a.then){if(D(a)){a=a.v}else{a.then(r,s||(s=v.bind(null,i=new A,2)));return}}}if(i){v(i,1,a)}else{i=a}}catch(t){v(i||(i=new A),2,t)}}r();return i}const M=b(h);function P(t,e,o){if(typeof t[I]==="function"){var n=t[I](),i,s,r;function c(t){try{while(!(i=n.next()).done&&(!o||!o())){t=e(i.value);if(t&&t.then){if(D(t)){t=t.v}else{t.then(c,r||(r=v.bind(null,s=new A,2)));return}}}if(s){v(s,1,t)}else{s=t}}catch(t){v(s||(s=new A),2,t)}}c();if(n.return){var a=function(t){try{if(!i.done){n.return()}}catch(t){}return t};if(s&&s.then){return s.then(a,function(t){throw a(t)})}a()}return s}if(!("length"in t)){throw new TypeError("Object is not iterable")}var l=[];for(var p=0;p<t.length;p++){l.push(t[p])}return G(l,function(t){return e(l[t])},o)}const $=b(f);const C=_["getInvisibleText"];const S=m["filterVisualizations"];const T=m["getPageManagerInstance"];const w=y["MYHOME_PAGE_ID"];const B=()=>d.last("/core/shell/enablePersonalization")||d.last("/core/catalog/enabled");const x=M.extend("sap.cux.home.SpacePanel",{metadata:{library:"sap.cux.home",defaultAggregation:"apps",properties:{spaceId:{type:"string",group:"Data",defaultValue:""},title:{type:"string",group:"Misc",defaultValue:""}},aggregations:{apps:{type:"sap.cux.home.App",singularName:"app",multiple:true,visibility:"hidden"},groups:{type:"sap.cux.home.Group",singularName:"group",multiple:true,visibility:"hidden"}}},constructor:function t(e,o){M.prototype.constructor.call(this,e,o)},init:function t(){M.prototype.init.call(this);this.setProperty("key","spacePanel");this.pageManager=T(this);this.attachPersistDialog(()=>{if(this._selectedGroupId){void this._showGroupDetailDialog(this._selectedGroupId,false,this._selectedPageId)}})},loadApps:function t(){try{const e=this;function o(t){function o(){s=S(s);e.destroyAggregation("groups",true);const t=s.filter(t=>t.isSection);const o=e._generateGroups(t);e._setGroups(o);e.destroyAggregation("apps",true);const n=s.filter(t=>!t.isSection);const i=e.generateApps(n);e.setApps(i);if(e._selectedGroupId){void e._setGroupDetailDialogApps(e._selectedGroupId,e._selectedPageId)}}e.allSpaces=t;const i=e.allSpaces.find(t=>t.id===n);if(!i||i.children.length===0)e.setApps([]);let s=[];const r=function(){if(i&&i.children.length>0){const t=P(i.children,function(t){return Promise.resolve(e.appManagerInstance.fetchFavVizs(true,false,t.id)).then(function(t){s.push(...t)})});if(t&&t.then)return t.then(function(){})}}();return r&&r.then?r.then(o):o(r)}const n=e.getProperty("spaceId");const i=e.allSpaces;return Promise.resolve(i?o(i):Promise.resolve(e.pageManager.fetchAllAvailableSpaces()).then(o))}catch(s){return Promise.reject(s)}},_generateGroups:function t(e){return e.map((t,e)=>{const o=typeof t.BGColor==="object"&&"key"in t.BGColor?t.BGColor.key:t.BGColor;const n=new $(`${this.getId()}-group-${e}`,{title:t.title,bgColor:o,status:t.status,icon:t.icon,number:t.badge,groupId:t.id,pageId:t.pageId,press:this._handleGroupPress.bind(this)});t.menuItems?.forEach(t=>{n.addAggregation("menuItems",t)});return n})},_setGroups:function t(e){e.forEach(t=>{this.addAggregation("groups",t,true)})},navigateToAppFinder:function t(e,o=w){try{return Promise.resolve(g.getServiceAsync("Navigation")).then(function(t){const n={pageID:o};if(e){n.sectionID=e}return Promise.resolve(t.navigate({target:{shellHash:`Shell-appfinder?&/catalog/${JSON.stringify(n)}`}})).then(function(){})})}catch(t){return Promise.reject(t)}},_showGroupDetailDialog:function t(e,o=false,n=w){try{const t=this;const i=t._getGroup(e);if(!i){return Promise.resolve()}t._selectedGroupId=e;t._selectedPageId=n;const s=t._generateGroupDetailDialog();const r=t._controlMap.get(`${t.getId()}-detailDialog-toolbar-color`);r.setColor(u.get({name:i.getBgColor()}));return Promise.resolve(t._setGroupDetailDialogApps(e,n)).then(function(){s.open();t._setGroupNameControl(i.getTitle(),o)})}catch(t){return Promise.reject(t)}},_setGroupDetailDialogApps:function t(e,o=w){try{const t=this;const n=t._getGroup(e);const i=function(){if(n){return Promise.resolve(t.appManagerInstance.getSectionVisualizations(e,false,o)).then(function(o){let i=S(o);n.destroyAggregation("apps",true);const s=t.generateApps(i);const r=t._controlMap.get(`${t.getId()}-detailDialog-apps`);t._setAggregation(n,s,"apps");r.destroyItems();t._setAggregation(r,n.getApps().map(e=>t.getParent()._getAppTile(e)));t._applyGroupedAppsPersonalization(e);t._dispatchAppsLoadedEvent(s)})}}();return Promise.resolve(i&&i.then?i.then(function(){}):void 0)}catch(t){return Promise.reject(t)}},_applyGroupedAppsPersonalization:function t(e){const o=this._controlMap.get(`${this.getId()}-detailDialog-apps`);const n=o?.getItems()||[];void this._applyTilesPersonalization(n,e)},_dispatchAppsLoadedEvent:function t(e){const o=this._controlMap.get(`${this.getId()}-detailDialog-apps`);const n=o?.getItems()||[];this.getParent().fireEvent("appsLoaded",{apps:e,tiles:n})},_generateGroupDetailDialog:function i(){const s=`${this.getId()}-detailDialog`;if(!this._controlMap.get(s)){this._controlMap.set(`${s}-toolbar-color`,new c({id:`${s}-toolbar-color`,src:"sap-icon://color-fill",size:"1.25rem"}).addStyleClass("sapUiTinyMarginEnd"));this._controlMap.set(`${s}-toolbar-title`,new a({id:`${s}-toolbar-title`,visible:true}));const i=C(`${s}-toolbar-renameTitle`,this._i18nBundle.getText("renameGroup"));this._controlMap.set(`${s}-toolbar-renameTitle`,i);const u=new r({id:`${s}-toolbar-title-edit`,width:"13.75rem",visible:false,ariaLabelledBy:[`${s}-toolbar-renameTitle`]});this._controlMap.set(`${s}-toolbar-title-edit`,u);const d=new t({id:`${s}-apps`,layout:new e(`${s}-appsLayout`,{columnSize:"19rem",gap:"0.5rem"})}).addStyleClass("sapCuxAppsContainerBorder sapCuxAppsDetailContainerPadding");this._controlMap.set(`${s}-apps`,d);this._controlMap.set(`${s}-addAppsBtn`,new o(`${s}-addAppsBtn`,{text:this._i18nBundle.getText("addApps"),icon:"sap-icon://action",visible:B(),press:()=>{const t=this._selectedGroupId;this._closeGroupDetailDialog();this._selectedGroupId=t;void this.navigateToAppFinder(t,this._selectedPageId)}}));this._controlMap.set(s,new n(s,{content:this._controlMap.get(`${s}-apps`),contentWidth:"60.75rem",endButton:new o({id:`${s}-groupDetailCloseBtn`,text:this._i18nBundle.getText("XBUT_CLOSE"),press:this._closeGroupDetailDialog.bind(this)}),escapeHandler:this._closeGroupDetailDialog.bind(this),customHeader:new l(`${this.getId()}-toolbar`,{content:[this._controlMap.get(`${s}-toolbar-color`),this._controlMap.get(`${s}-toolbar-title`),this._controlMap.get(`${s}-toolbar-title-edit`),this._controlMap.get(`${s}-toolbar-renameTitle`),new p({id:`${this.getId()}-toolbarSpacer`}),this._controlMap.get(`${s}-addAppsBtn`)]})}).addStyleClass("sapCuxGroupDetailDialog"))}return this._controlMap.get(s)},_closeGroupDetailDialog:function t(){const e=this._controlMap.get(`${this.getId()}-detailDialog`);const o=this._getGroup(this._selectedGroupId);o?.destroyApps();this._selectedGroupId=undefined;e?.close()},_setGroupNameControl:function t(e,o){const n=this._controlMap.get(`${this.getId()}-detailDialog`);const i=this._controlMap.get(`${this.getId()}-detailDialog-toolbar-title`);const s=this._controlMap.get(`${this.getId()}-detailDialog-toolbar-title-edit`);s.setValue(e);i.setText(e);s?.setVisible(o);i?.setVisible(!o);if(o){n.setInitialFocus(s)}},_handleGroupPress:function t(e){const o=e.getParameter("groupId");const n=e.getParameter("pageId")||w;if(o){void this._showGroupDetailDialog(o,false,n)}},generateIllustratedMessage:function t(){const e=M.prototype.generateIllustratedMessage.call(this);e.setDescription(this._i18nBundle.getText("noFavAppsDescription"));e.setIllustrationSize(i.Small);e.setIllustrationType(s.AddingColumns);e.addAdditionalContent(new o(`${this.getId()}-errorMessage-addApps`,{text:this._i18nBundle.getText("addApps"),tooltip:this._i18nBundle.getText("addAppsTooltip"),icon:"sap-icon://action",visible:B(),press:()=>{void this.navigateToAppFinder()},type:"Emphasized"}));return e}});return x});
//# sourceMappingURL=SpacePanel.js.map