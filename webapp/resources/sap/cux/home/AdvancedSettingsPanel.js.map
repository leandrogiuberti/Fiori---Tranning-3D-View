{"version":3,"file":"AdvancedSettingsPanel.js","names":["sap","ui","define","Log","CardHelper","Button","CheckBox","CustomListItem","HBox","IconTabBar","IconTabFilter","Input","Label","sap_m_library","List","MessageStrip","MessageToast","ObjectStatus","OverflowToolbar","Panel","Text","Title","Toolbar","ToolbarSpacer","VBox","Element","EventBus","sap_ui_core_library","SimpleForm","JSONModel","FileUploader","Container","__BaseSettingsPanel","___utils_Accessibility","__AppManager","___utils_Constants","___utils_DataFormatUtils","___utils_Device","___utils_FESRUtil","__HttpHelper","__PageManager","__PersonalisationUtils","__UShellPersonalizer","_interopRequireDefault","obj","__esModule","default","_catch","body","recover","result","e","then","FlexAlignItems","ToolbarStyle","ValueState","BaseSettingsPanel","checkPanelExists","AppManager","SETTINGS_PANELS_KEYS","recycleId","calculateDeviceType","DeviceType","addFESRSemanticStepName","FESR_EVENTS","HttpHelper","PageManager","PersonalisationUtils","UShellPersonalizer","ImportExportType","BASE_URL","REPO_BASE_URL","EXPORT_API","MYINSIGHT_SECTION_ID","NewsAndPagesContainerName","AppsContainerlName","InsightsContainerName","PagePanelName","FavAppPanelName","RecommendedAppPanelName","TilesPanelName","CardsPanelName","AdvancedSettingsPanel","extend","metadata","events","sectionsImported","constructor","_constructor","id","settings","BaseSettingsPanel.prototype.constructor.call","this","init","_init","BaseSettingsPanel.prototype.init.call","setProperty","ADVANCED","_i18nBundle","getText","oEventBus","getInstance","oAppManagerInstance","oSectionsImported","oUserPersonalization","export","sections","fileName","sectionsSelected","error","import","selectedTab","showNoImport","oControlModel","addAggregation","getContent","addInnerContent","attachPanelNavigated","_this","oPageManagerInstance","getPersContainerId","_getPanel","getOwnerComponent","subscribe","channelId","eventId","data","customData","status","updateImportStatus","oDetailPage","getElementById","getProperty","layout","Mobile","_setRecommendationSettingsPanel","Promise","resolve","loadUserPersonalizationData","oImportBtn","setEnabled","enableDisableActions","setImportExportList","oExportMessage","setText","errorMessage","String","setType","errorType","oFileNameInput","setValue","oImportMessage","setVisible","reject","_setImportExportList","oExportList","destroy","setExportSectionList","_importExportPanel","addContent","oImportList","setImportSectionList","invalidate","_enableDisableActions","sType","oImportExportTab","setSelectedKey","IMPORT","oExportBtn","EXPORT","length","setExportImportValues","_setExportImportValues","_getContent","oContentVBox","getId","items","text","addStyleClass","_getImportExportPanel","headerToolbar","style","Clear","content","level","_getImportButton","_getExportButton","headerText","expanded","expandable","type","press","onImportPress","visible","PRESS","onExportPress","bind","_addInnerContent","backgroundDesign","selectedKey","oSelectedTab","select","onImportExportTabSelect","exportTab","key","SELECT","showIcon","exportText","fileInputContainer","alignItems","filenameLabel","labelFor","required","showColon","ariaLabelledBy","width","liveChange","onFileNameInputChange","value","addItem","importTab","importText","importSimpleForm","editable","labelSpanS","labelSpanM","fileUploader","tooltip","fileType","change","oEvent","onFileImport","maximumFileSize","sameFilenameAllowed","buttonText","classicImportTab","classicText","resetImportAppsNow","onResetImportApps","_setExportSectionList","exportSectionsList","growingThreshold","includeItemInSelection","setHeaderToolbar","setModel","bindItems","path","template","formatter","_isPanelAvailable","accDescription","parts","_formatAccDescription","onSectionsSelectionChange","selected","enabled","title","statusText","selectionText","instructionText","panelClassName","panelMappings","containerName","panelName","mapping","_setImportSectionList","importSectionsList","justifyContent","icon","state","_onSectionsSelectionChange","isImport","allSections","getItems","isSelected","innerCheckbox","isSectionSelected","some","oSection","getAggregation","getSelected","innerHbox","_onImportPress","_this2","attachEvent","setBusy","handleUserPersonalizationError","oExportData","_temp","importSections","aSelectedSections","bShowError","Error","oErr","_importSections","oImportData","sectionImportChain","aPromise","oSelectedSections","push","importApps","importTiles","importFavPages","reduce","chain","current","importCards","all","catch","oError","_importApps","apps","publish","groupInfo","_importTiles","tiles","_importFavPages","favouritePages","_importCards","cards","_updateImportStatus","sSectionTitle","errorState","sSectionId","find","oSec","undefined","Success","None","sectionTitles","Object","keys","imported","every","sTitle","fireEvent","resetImportModel","_resetImportModel","onOpen","getDeltaSectionViz","_getDeltaSectionViz","aImportedSections","_this3","_getSections","favSections","forEach","oImportedSection","aDelta","visualizations","filter","oImportViz","oViz","isBookmark","targetURL","vizId","getDeltaAuthSectionViz","_getDeltaAuthSectionViz","aDeltaSections","filterAuthSectionViz","_filterAuthSectionViz","aSections","_getCatalogApps","getServiceAsync","SearchableContent","getApps","includeAppsWithoutVisualizations","_filterAuthViz","aAppCatalog","aViz","aSectionViz","appCatalog","oAppCatalog","oSectionViz","oCatalogViz","target","action","semanticObject","displayFormatHint","map","filterAuthFavPages","_filterAuthFavPages","aFavPages","_exit","_this4","_temp3","_result","_temp2","fetchAllAvailablePages","aAvailablePages","oimportedPage","oAvailabePage","pageId","spaceId","_await$_this4$oPageMa","filterAuthCards","_filterAuthCards","aCards","_exit2","_temp5","_result2","_getParentApp","aAvailableApps","oCard","oApp","resolutionResult","applicationDependencies","name","parentAppId","_isNavigationSupported","oService","oParentApp","isNavigationSupported","aResponses","supported","_temp4","aServices","clientSideTargetResolution","Navigation","_oAdapter","_aInbounds","promise","aAuthCards","bIsNavigationSupported","_await$Promise$all$th","_onFileImport","files","getParameter","oFile","readFileContent","oFileContent","oEncodedFileContent","window","btoa","encodeURIComponent","replace","match","p1","fromCharCode","parseInt","Post","fileContent","oResponse","oImportDataString","JSON","parse","host","location","filterAuthorizedImportData","finally","_filterAuthorizedImportData","_this5","promises","isInsightsEnabled","_this5$isInsightsEnab","getInsightCards","aResponse","aAuthSections","aAuthFavPages","iInsightCardsCount","iTotalCardCount","Number","getImportedSections","getSelectedSections","_readFileContent","FileReader","reader","onload","event","blob","readAsText","_getPersonalizationData","_this6","_temp7","oPersonalizerInstance","read","_this6$oPersonalizerI","persData","_temp6","_UShellPersonalizer$g","_loadUserPersonalizationData","_this7","_this7$isInsightsEnab","_Promise$all","insightModel","favApps","insightTiles","insightCards","descriptorContent","personalization","aExportSections","refresh","_isInsightsEnabled","_exit3","_exit4","_getServiceAsync","message","_getSelectedSections","_isSectionSelected","sectionId","section","sec","_getImportedSections","oData","_this8","_temp9","isAppViz","oSections","panelClass","_this8$isInsightsEnab","_temp8","getDeltaFavPages","_getDeltaFavPages","aImportedFavPages","_this9","oImportedPage","oFavPage","_getInsightCards","_this0","_getServiceAsync2","cardHelperInstance","_getUserAllCardModel","oUserVisibleCardModel","aVisibleCards","visibility","_onExportPress","oExportFileName","oExportFileContent","getExportFileContent","require","File","save","stringify","show","_getExportFileContent","exportData","exportSections","oPersonalization","createdDate","Date","favoriteApps","filterNonSensitiveCards","_filterNonSensitiveCards","nonSensitiveCards","configuration","parameters","parameter","sensitiveProps","concat","getSensitiveProps","headerState","lineItemState","_getSensitiveProps","param","paramSensitiveProps","paramValue","sensitiveProp","ibnParams","_handleUserPersonalizationError","sErrorMsg","sErrorType","sDefaultErrorMsg","_onImportExportTabSelect","_onFileNameInputChange","sInputValue","trim","oInput","getSource","sValueState","sValueStateText","setValueState","setValueStateText","_onResetImportApps","_getRecommendationSettingsPanel","_this1","_recommendationSettingsPanel","panelId","showRecommendation","onRecommendationSettingChange","Center","_this10","recommendationSettingsPanel","_onRecommendationSettingChange","_this11","oPersData","write"],"sources":["AdvancedSettingsPanel.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\n\nimport Log from \"sap/base/Log\";\nimport CardHelper from \"sap/insights/CardHelper\";\nimport Button from \"sap/m/Button\";\nimport CheckBox, { CheckBox$SelectEvent } from \"sap/m/CheckBox\";\nimport CustomListItem from \"sap/m/CustomListItem\";\nimport HBox from \"sap/m/HBox\";\nimport IconTabBar, { IconTabBar$SelectEvent } from \"sap/m/IconTabBar\";\nimport IconTabFilter from \"sap/m/IconTabFilter\";\nimport Input, { Input$LiveChangeEvent } from \"sap/m/Input\";\nimport Label from \"sap/m/Label\";\nimport { FlexAlignItems, ToolbarStyle } from \"sap/m/library\";\nimport List from \"sap/m/List\";\nimport MessageStrip from \"sap/m/MessageStrip\";\nimport MessageToast from \"sap/m/MessageToast\";\nimport ObjectStatus from \"sap/m/ObjectStatus\";\nimport OverflowToolbar from \"sap/m/OverflowToolbar\";\nimport Page from \"sap/m/Page\";\nimport Panel from \"sap/m/Panel\";\nimport Text from \"sap/m/Text\";\nimport Title from \"sap/m/Title\";\nimport Toolbar from \"sap/m/Toolbar\";\nimport ToolbarSpacer from \"sap/m/ToolbarSpacer\";\nimport VBox from \"sap/m/VBox\";\nimport Component from \"sap/ui/core/Component\";\nimport Control from \"sap/ui/core/Control\";\nimport type { MetadataOptions } from \"sap/ui/core/Element\";\nimport Element from \"sap/ui/core/Element\";\nimport EventBus from \"sap/ui/core/EventBus\";\nimport { ValueState } from \"sap/ui/core/library\";\nimport MessageType from \"sap/ui/core/message/MessageType\";\nimport File from \"sap/ui/core/util/File\";\nimport SimpleForm from \"sap/ui/layout/form/SimpleForm\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport FileUploader, { FileUploader$ChangeEvent } from \"sap/ui/unified/FileUploader\";\nimport Container from \"sap/ushell/Container\";\nimport ClientSideTargetResolution from \"sap/ushell/services/ClientSideTargetResolution\";\nimport Navigation from \"sap/ushell/services/Navigation\";\nimport SearchableContent, { AppData } from \"sap/ushell/services/SearchableContent\";\nimport { $AdvancedSettingsPanelSettings } from \"./AdvancedSettingsPanel\";\nimport BaseSettingsPanel from \"./BaseSettingsPanel\";\nimport { IAppInbounds, IAppPersonalization, ISection, ISectionAndVisualization, IVisualization } from \"./interface/AppsInterface\";\nimport { ICard, ICardActionParameters, ICardHelper, ICardHelperInstance, ICardManifest } from \"./interface/CardsInterface\";\nimport { IPage } from \"./interface/PageSpaceInterface\";\nimport { checkPanelExists } from \"./utils/Accessibility\";\nimport AppManager from \"./utils/AppManager\";\nimport { SETTINGS_PANELS_KEYS } from \"./utils/Constants\";\nimport { recycleId } from \"./utils/DataFormatUtils\";\nimport { calculateDeviceType, DeviceType } from \"./utils/Device\";\nimport { addFESRSemanticStepName, FESR_EVENTS } from \"./utils/FESRUtil\";\nimport HttpHelper from \"./utils/HttpHelper\";\nimport PageManager from \"./utils/PageManager\";\nimport PersonalisationUtils from \"./utils/PersonalisationUtils\";\nimport UShellPersonalizer, { IPersonalizationData } from \"./utils/UshellPersonalizer\";\n\nexport enum ImportExportType {\n\tIMPORT = \"import\",\n\tEXPORT = \"export\"\n}\n\nexport interface IExportData {\n\tapps?: ISection[];\n\ttiles?: ISectionAndVisualization[];\n\tgroupInfo?: IAppPersonalization[];\n\thost?: string;\n\tsections?: ISection[];\n\tcreatedDate?: string;\n\tfavouritePages: ISectionAndVisualization[] | IPage[];\n\tcards?: ICardManifest[];\n\tpersonalization?: IPersonalizationData;\n}\ninterface IExportSections {\n\ttitle: string;\n\tselected: boolean | undefined;\n\tenabled: boolean | undefined;\n\tpanelClass: string;\n\tstatus?: ValueState;\n}\ntype SectionOrVisualization = ISectionAndVisualization[] | IVisualization[];\ninterface IExportImportFile {\n\thost?: string;\n\tcreatedDate?: Date;\n\tsections?: SectionOrVisualization | [];\n\tgroupInfo?: IAppPersonalization[] | IVisualization[] | [];\n\ttiles?: SectionOrVisualization;\n\tcards?: ICardManifest[];\n\tfavouritePages: IPage[] | ISectionAndVisualization[];\n\tapps?: ISection[] | [];\n}\ninterface ApiResponse {\n\tvalue: { fileContent: string }[];\n\t// Define other properties if present in ApiResponse\n}\n\nconst BASE_URL = \"/sap/opu/odata4/ui2/insights_srv/srvd/ui2/\";\nconst REPO_BASE_URL = BASE_URL + \"insights_cards_repo_srv/0001/\";\nconst EXPORT_API = REPO_BASE_URL + \"INSIGHTS_CARDS/com.sap.gateway.srvd.ui2.insights_cards_repo_srv.v0001.importExport?\";\nconst MYINSIGHT_SECTION_ID = \"AZHJGRIT78TG7Y65RF6EPFJ9U\";\n\nconst NewsAndPagesContainerName: string = \"sap.cux.home.NewsAndPagesContainer\";\nconst AppsContainerlName: string = \"sap.cux.home.AppsContainer\";\nconst InsightsContainerName: string = \"sap.cux.home.InsightsContainer\";\nconst PagePanelName: string = \"sap.cux.home.PagePanel\";\nconst FavAppPanelName: string = \"sap.cux.home.FavAppPanel\";\nconst RecommendedAppPanelName: string = \"sap.cux.home.RecommendedAppPanel\";\nconst TilesPanelName: string = \"sap.cux.home.TilesPanel\";\nconst CardsPanelName: string = \"sap.cux.home.CardsPanel\";\n\n/**\n *\n * Class for My Home Advanced Settings Panel.\n *\n * @extends BaseSettingsPanel\n *\n * @author SAP SE\n * @version 0.0.1\n * @since 1.121\n * @private\n *\n * @alias sap.cux.home.AdvancedSettingsPanel\n */\nexport default class AdvancedSettingsPanel extends BaseSettingsPanel {\n\tprivate oControlModel!: JSONModel;\n\tprivate oImportExportTab!: IconTabBar;\n\tprivate oFileNameInput!: Input;\n\tprivate oSelectedTab!: string | undefined;\n\tprivate oExportList!: List;\n\tprivate oImportList!: List;\n\tprivate oImportBtn!: Button;\n\tprivate oExportBtn!: Button;\n\tprivate oEventBus!: EventBus;\n\tprivate oAppManagerInstance!: AppManager;\n\tprivate oPageManagerInstance!: PageManager;\n\tprivate oPersonalizerInstance!: UShellPersonalizer;\n\tprivate cardHelperInstance!: ICardHelperInstance;\n\tprivate persData!: IPersonalizationData;\n\tprivate oContentVBox!: VBox;\n\tprivate oExportMessage!: MessageStrip;\n\tprivate oImportMessage!: MessageStrip;\n\tprivate oDetailPage!: Page;\n\tprivate oSectionsImported!: {\n\t\t[key: string]: boolean;\n\t};\n\tprivate oUserPersonalization!: {\n\t\texport: {\n\t\t\tdata?: IExportData;\n\t\t\tsections?: IExportSections[];\n\t\t\tfileName?: string;\n\t\t\tsectionsSelected?: boolean;\n\t\t\terror?: boolean;\n\t\t\terrorMessage?: string;\n\t\t\terrorType?: string;\n\t\t};\n\t\timport: {\n\t\t\tdata?: IExportData | IExportImportFile;\n\t\t\tsections?: IExportSections[];\n\t\t\tsectionsSelected?: boolean;\n\t\t\terror?: boolean;\n\t\t\terrorMessage?: string;\n\t\t\terrorType?: MessageType;\n\t\t};\n\t\tselectedTab: string;\n\t\tshowNoImport: boolean;\n\t};\n\n\tconstructor(id?: string | $AdvancedSettingsPanelSettings);\n\tconstructor(id?: string, settings?: $AdvancedSettingsPanelSettings);\n\tconstructor(id?: string, settings?: $AdvancedSettingsPanelSettings) {\n\t\tsuper(id, settings);\n\t}\n\n\tstatic readonly metadata: MetadataOptions = {\n\t\tevents: {\n\t\t\tsectionsImported: {}\n\t\t}\n\t};\n\tprivate _recommendationSettingsPanel!: Panel;\n\tprivate _importExportPanel!: Panel;\n\n\t/**\n\t * Init lifecycle method\n\t *\n\t * @public\n\t * @override\n\t */\n\tpublic init(): void {\n\t\tsuper.init();\n\n\t\t//setup panel\n\t\tthis.setProperty(\"key\", SETTINGS_PANELS_KEYS.ADVANCED);\n\t\tthis.setProperty(\"title\", this._i18nBundle.getText(\"advancedSettings\"));\n\t\tthis.setProperty(\"icon\", \"sap-icon://grid\");\n\t\tthis.oEventBus = EventBus.getInstance();\n\t\tthis.oAppManagerInstance = AppManager.getInstance();\n\t\tthis.oSectionsImported = {};\n\t\tthis.oUserPersonalization = {\n\t\t\texport: {\n\t\t\t\tsections: [],\n\t\t\t\tfileName: \"MY_HOME\",\n\t\t\t\tsectionsSelected: false,\n\t\t\t\terror: false\n\t\t\t},\n\t\t\timport: {\n\t\t\t\tsections: [],\n\t\t\t\tsectionsSelected: false,\n\t\t\t\terror: false\n\t\t\t},\n\t\t\tselectedTab: \"export\",\n\t\t\tshowNoImport: false\n\t\t};\n\t\tthis.oControlModel = new JSONModel(this.oUserPersonalization);\n\t\t//setup layout content\n\t\tthis.addAggregation(\"content\", this.getContent());\n\t\tthis.addInnerContent();\n\t\t//fired every time on panel navigation\n\t\tthis.attachPanelNavigated(() => {\n\t\t\tvoid (async () => {\n\t\t\t\tif (!this.oPageManagerInstance) {\n\t\t\t\t\tthis.oPageManagerInstance = PageManager.getInstance(\n\t\t\t\t\t\tPersonalisationUtils.getPersContainerId(this._getPanel()),\n\t\t\t\t\t\tPersonalisationUtils.getOwnerComponent(this._getPanel()) as Component\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// subscribe to all import events for all sections\n\t\t\t\tthis.oEventBus.subscribe(\n\t\t\t\t\t\"importChannel\",\n\t\t\t\t\t\"tilesImported\",\n\t\t\t\t\t(channelId?: string, eventId?: string, data?: object) => {\n\t\t\t\t\t\tconst customData = (data as { status: boolean }).status;\n\t\t\t\t\t\t//errorstate is false when import is successful\n\t\t\t\t\t\tthis.updateImportStatus(\"insightsTiles\", !customData);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t);\n\n\t\t\t\tthis.oEventBus.subscribe(\n\t\t\t\t\t\"importChannel\",\n\t\t\t\t\t\"appsImported\",\n\t\t\t\t\t(channelId?: string, eventId?: string, data?: object) => {\n\t\t\t\t\t\tconst customData = (data as { status: boolean }).status;\n\t\t\t\t\t\t//errorstate is false when import is successful\n\t\t\t\t\t\tthis.updateImportStatus(\"favApps\", !customData);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t);\n\n\t\t\t\tthis.oEventBus.subscribe(\n\t\t\t\t\t\"importChannel\",\n\t\t\t\t\t\"favPagesImported\",\n\t\t\t\t\t(channelId?: string, eventId?: string, data?: object) => {\n\t\t\t\t\t\tconst customData = (data as { status: boolean }).status;\n\t\t\t\t\t\t//errorstate is false when import is successful\n\t\t\t\t\t\tthis.updateImportStatus(\"pages\", !customData);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t);\n\n\t\t\t\tthis.oEventBus.subscribe(\n\t\t\t\t\t\"importChannel\",\n\t\t\t\t\t\"cardsImported\",\n\t\t\t\t\t(channelId?: string, eventId?: string, data?: object) => {\n\t\t\t\t\t\tconst customData = (data as { status: boolean }).status;\n\t\t\t\t\t\t//errorstate is false when import is successful\n\t\t\t\t\t\tthis.updateImportStatus(\"insightsCards\", !customData);\n\t\t\t\t\t},\n\t\t\t\t\tthis\n\t\t\t\t);\n\n\t\t\t\t//get the detailPage of advanced settingspanel\n\t\t\t\tthis.oDetailPage = Element.getElementById(this.getProperty(\"key\") + \"-detail-page\") as Page;\n\t\t\t\tconst layout = this._getPanel();\n\t\t\t\tif (checkPanelExists(layout, AppsContainerlName, RecommendedAppPanelName) && calculateDeviceType() !== DeviceType.Mobile) {\n\t\t\t\t\tvoid this._setRecommendationSettingsPanel();\n\t\t\t\t}\n\n\t\t\t\t//load user personalization data\n\t\t\t\tawait this.loadUserPersonalizationData();\n\n\t\t\t\t//import button set enabled/disabled based on sections selected\n\t\t\t\tthis.oImportBtn.setEnabled(this.oUserPersonalization.import.sectionsSelected);\n\t\t\t\tthis.enableDisableActions(this.oUserPersonalization.selectedTab as ImportExportType);\n\n\t\t\t\t//set export and import list\n\t\t\t\tthis.setImportExportList();\n\t\t\t\tthis.oExportMessage.setText(\n\t\t\t\t\tthis.oUserPersonalization.export.errorMessage ? String(this.oUserPersonalization.export.errorMessage) : \"\"\n\t\t\t\t);\n\t\t\t\tthis.oExportMessage.setType(this.oUserPersonalization.export.errorType as MessageType);\n\t\t\t\tthis.oExportMessage.setProperty(\"visible\", this.oUserPersonalization.export.error, true);\n\t\t\t\tthis.oFileNameInput.setValue(String(this.oUserPersonalization.export.fileName));\n\n\t\t\t\tthis.oImportMessage.setText(\n\t\t\t\t\tthis.oUserPersonalization.import.errorMessage ? String(this.oUserPersonalization.import.errorMessage) : \"\"\n\t\t\t\t);\n\t\t\t\tthis.oImportMessage.setType(this.oUserPersonalization.import.errorType as MessageType);\n\t\t\t\tthis.oImportMessage.setVisible(this.oUserPersonalization.import.error);\n\t\t\t})();\n\t\t});\n\t}\n\n\tprivate setImportExportList(): void {\n\t\tthis.oExportList?.destroy();\n\t\tthis.oExportList = this.setExportSectionList();\n\t\tthis._importExportPanel.addContent(this.oExportList);\n\t\tif (!this.oImportList) {\n\t\t\tthis.oImportList = this.setImportSectionList();\n\t\t\tthis._importExportPanel.addContent(this.oImportList);\n\t\t} else {\n\t\t\tthis.oImportList.invalidate();\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param sType selected tab type\n\t * Set import / export button enable property and selectedkey of importexport tab\n\t */\n\tprivate enableDisableActions(sType: ImportExportType): void {\n\t\tthis.oImportExportTab?.setSelectedKey(sType);\n\t\tthis.oImportBtn?.setVisible(sType === ImportExportType.IMPORT);\n\t\tthis.oExportBtn?.setVisible(sType === ImportExportType.EXPORT);\n\t\tif (this.oUserPersonalization.import.sectionsSelected && sType === ImportExportType.IMPORT) {\n\t\t\tthis.oImportBtn.setEnabled(true);\n\t\t} else {\n\t\t\tthis.oImportBtn.setEnabled(false);\n\t\t}\n\n\t\tif (\n\t\t\tsType === ImportExportType.EXPORT &&\n\t\t\tthis.oUserPersonalization.export.fileName &&\n\t\t\tthis.oUserPersonalization.export.sections?.length &&\n\t\t\tthis.oUserPersonalization.export.sectionsSelected\n\t\t) {\n\t\t\tthis.oExportBtn.setEnabled(true);\n\t\t} else {\n\t\t\tthis.oExportBtn.setEnabled(false);\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @param sType selected tab type\n\t * Set import/ export message values\n\t */\n\tprivate setExportImportValues(sType: ImportExportType): void {\n\t\tif (sType === ImportExportType.EXPORT) {\n\t\t\tthis.oExportMessage.setText(\n\t\t\t\tthis.oUserPersonalization.export.errorMessage ? String(this.oUserPersonalization.export.errorMessage) : \"\"\n\t\t\t);\n\t\t\tthis.oExportMessage.setType(this.oUserPersonalization.export.errorType as MessageType);\n\t\t\tthis.oExportMessage.setProperty(\"visible\", this.oUserPersonalization.export.error, true);\n\t\t} else if (sType === ImportExportType.IMPORT) {\n\t\t\tthis.oImportMessage.setText(\n\t\t\t\tthis.oUserPersonalization.import.errorMessage ? String(this.oUserPersonalization.import.errorMessage) : \"\"\n\t\t\t);\n\t\t\tthis.oImportMessage.setType(this.oUserPersonalization.import.errorType as MessageType);\n\t\t\tthis.oImportMessage.setProperty(\"visible\", this.oUserPersonalization.import.error);\n\t\t}\n\t}\n\n\t/**\n\t * Sets the outer content VBox for the Advanced Settings Panel.\n\t * @returns VBox\n\t */\n\tprivate getContent(): VBox {\n\t\tif (!this.oContentVBox) {\n\t\t\tthis.oContentVBox = new VBox(this.getId() + \"--idAdvancedVBox\", {\n\t\t\t\titems: [\n\t\t\t\t\tnew Text(this.getId() + \"--idPersonalizationSubheader\", {\n\t\t\t\t\t\ttext: this._i18nBundle.getText(\"advancedSettingsSubheader\")\n\t\t\t\t\t}).addStyleClass(\"sapUiSmallMarginBegin sapUiSmallMarginTop\"),\n\n\t\t\t\t\tthis._getImportExportPanel()\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\treturn this.oContentVBox;\n\t}\n\n\t/**\n\t * Returns the import/export panel.\n\t *\n\t * @private\n\t * @returns {Panel} The import/export panel.\n\t */\n\tprivate _getImportExportPanel() {\n\t\tif (!this._importExportPanel) {\n\t\t\tthis._importExportPanel = new Panel(`${this.getId()}-importExportPanel`, {\n\t\t\t\theaderToolbar: new OverflowToolbar(`${this.getId()}-importExportPanelToolbar`, {\n\t\t\t\t\tstyle: ToolbarStyle.Clear,\n\t\t\t\t\tcontent: [\n\t\t\t\t\t\tnew Title(`${this.getId()}-importExportPanelToolbarText`, {\n\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"importAndExportPanelHeader\"),\n\t\t\t\t\t\t\tlevel: \"H3\"\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tnew ToolbarSpacer(`${this.getId()}-importExportPanelToolbarSpacer`),\n\t\t\t\t\t\tthis._getImportButton(),\n\t\t\t\t\t\tthis._getExportButton()\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\theaderText: this._i18nBundle.getText(\"importAndExportPanelHeader\"),\n\t\t\t\texpanded: true,\n\t\t\t\texpandable: true,\n\t\t\t\tcontent: []\n\t\t\t}).addStyleClass(\"sapUiSmallMarginTop\");\n\t\t}\n\n\t\treturn this._importExportPanel;\n\t}\n\n\t/**\n\t * Returns the import button.\n\t *\n\t * @private\n\t * @returns {Button} import button.\n\t */\n\tprivate _getImportButton() {\n\t\tif (!this.oImportBtn) {\n\t\t\tthis.oImportBtn = new Button({\n\t\t\t\tid: `${this.getId()}-importBtn`,\n\t\t\t\ttext: this._i18nBundle.getText(\"import\"),\n\t\t\t\ttype: \"Transparent\",\n\t\t\t\tpress: () => {\n\t\t\t\t\tvoid this.onImportPress();\n\t\t\t\t},\n\t\t\t\tvisible: false\n\t\t\t});\n\t\t\taddFESRSemanticStepName(this._getImportButton(), FESR_EVENTS.PRESS, \"importBtn\");\n\t\t}\n\t\treturn this.oImportBtn;\n\t}\n\n\t/**\n\t * Returns the export button.\n\t *\n\t * @private\n\t * @returns {Button} export button.\n\t */\n\tprivate _getExportButton() {\n\t\tif (!this.oExportBtn) {\n\t\t\tthis.oExportBtn = new Button({\n\t\t\t\tid: `${this.getId()}-exportBtn`,\n\t\t\t\ttext: this._i18nBundle.getText(\"export\"),\n\t\t\t\ttype: \"Transparent\",\n\t\t\t\tpress: this.onExportPress.bind(this),\n\t\t\t\tvisible: true\n\t\t\t});\n\t\t\taddFESRSemanticStepName(this.oExportBtn, FESR_EVENTS.PRESS, \"exportBtn\");\n\t\t}\n\t\treturn this.oExportBtn;\n\t}\n\n\t/**\n\t * Returns the inner content for the Advanced Settings Panel.\n\t *\n\t * @private\n\t * @returns {Control} The control containing the Advanced Settings Panel content.\n\t */\n\tprivate addInnerContent(): void {\n\t\t//if not already initialised, create the import/export tab and inner controls\n\t\tif (!this.oImportExportTab) {\n\t\t\tthis.oImportExportTab = new IconTabBar(this.getId() + \"--idImportExportTab\", {\n\t\t\t\texpandable: false,\n\t\t\t\tbackgroundDesign: \"Transparent\",\n\t\t\t\tselectedKey: this.oSelectedTab ? this.oSelectedTab : \"export\",\n\t\t\t\tselect: this.onImportExportTabSelect.bind(this)\n\t\t\t});\n\n\t\t\tconst exportTab = new IconTabFilter(this.getId() + \"--idExportTab\", {\n\t\t\t\tkey: \"export\",\n\t\t\t\ttext: this._i18nBundle.getText(\"exportFile\")\n\t\t\t});\n\t\t\t// Add FESR for export tab\n\t\t\taddFESRSemanticStepName(exportTab, FESR_EVENTS.SELECT, \"exportTab\");\n\n\t\t\t//export tab content\n\t\t\tthis.oExportMessage = new MessageStrip(this.getId() + \"--idExportMessageStrip\", {\n\t\t\t\tshowIcon: true,\n\t\t\t\tvisible: false\n\t\t\t}).addStyleClass(\"sapUiNoMarginBegin sapUiTinyMarginBottom\");\n\t\t\tconst exportText = new Text(this.getId() + \"--idExportText\", { text: this._i18nBundle.getText(\"exportText\") }).addStyleClass(\n\t\t\t\t\"advancePadding\"\n\t\t\t);\n\t\t\tconst fileInputContainer = new HBox(this.getId() + \"--idFileInputContainer\", {\n\t\t\t\talignItems: \"Center\"\n\t\t\t}).addStyleClass(\"sapUiSmallMargin\");\n\t\t\tconst filenameLabel = new Label(this.getId() + \"--idFilenameLabel\", {\n\t\t\t\ttext: this._i18nBundle.getText(\"exportFileNameLabel\"),\n\t\t\t\tlabelFor: \"idTitleFilenameInput\",\n\t\t\t\trequired: true,\n\t\t\t\tshowColon: true\n\t\t\t}).addStyleClass(\"sapUiSmallMarginEnd\");\n\t\t\tthis.oFileNameInput = new Input(this.getId() + \"--idFileNameInput\", {\n\t\t\t\tariaLabelledBy: [`${this.getId()}--idExportText`, `${this.getId()}--idFilenameLabel`],\n\t\t\t\trequired: true,\n\t\t\t\twidth: \"13rem\",\n\t\t\t\tliveChange: this.onFileNameInputChange.bind(this),\n\t\t\t\tvalue: \"\"\n\t\t\t});\n\n\t\t\tfileInputContainer.addItem(filenameLabel);\n\t\t\tfileInputContainer.addItem(this.oFileNameInput);\n\n\t\t\texportTab.addContent(this.oExportMessage);\n\t\t\texportTab.addContent(exportText);\n\t\t\texportTab.addContent(fileInputContainer);\n\n\t\t\t//import tab\n\t\t\tconst importTab = new IconTabFilter(this.getId() + \"--idImportTab\", {\n\t\t\t\tkey: \"import\",\n\t\t\t\ttext: this._i18nBundle.getText(\"importFile\")\n\t\t\t});\n\t\t\t// Add FESR for import tab\n\t\t\taddFESRSemanticStepName(importTab, FESR_EVENTS.SELECT, \"importTab\");\n\n\t\t\t//import tab content\n\t\t\tthis.oImportMessage = new MessageStrip(this.getId() + \"--idImportMessageStrip\", {\n\t\t\t\ttext: \"{advsettings>/import/errorMessage}\",\n\t\t\t\ttype: \"{advsettings>/import/errorType}\",\n\t\t\t\tshowIcon: true,\n\t\t\t\tvisible: false\n\t\t\t}).addStyleClass(\"sapUiNoMarginBegin sapUiTinyMarginBottom\");\n\t\t\tconst importText = new Text(this.getId() + \"--idImportText\", { text: this._i18nBundle.getText(\"importText\") }).addStyleClass(\n\t\t\t\t\"advancePadding\"\n\t\t\t);\n\t\t\tconst importSimpleForm = new SimpleForm(this.getId() + \"--idImportSimpleForm\", {\n\t\t\t\teditable: true,\n\t\t\t\tlayout: \"ResponsiveGridLayout\",\n\t\t\t\tlabelSpanS: 4,\n\t\t\t\tlabelSpanM: 4\n\t\t\t});\n\t\t\tconst fileUploader = new FileUploader(this.getId() + \"--idImportFileUploader\", {\n\t\t\t\ttooltip: this._i18nBundle.getText(\"uploadImportFile\"),\n\t\t\t\tfileType: [\"txt\"],\n\t\t\t\tchange: (oEvent: FileUploader$ChangeEvent) => {\n\t\t\t\t\tvoid this.onFileImport(oEvent);\n\t\t\t\t},\n\t\t\t\tmaximumFileSize: 25,\n\t\t\t\tsameFilenameAllowed: true,\n\t\t\t\twidth: \"80%\",\n\t\t\t\tariaLabelledBy: [`${this.getId()}--idImportText`],\n\t\t\t\tbuttonText: this._i18nBundle.getText(\"importFileUploaderButton\")\n\t\t\t});\n\t\t\timportSimpleForm.addContent(fileUploader);\n\t\t\timportTab.addContent(this.oImportMessage);\n\t\t\timportTab.addContent(importText);\n\t\t\timportTab.addContent(importSimpleForm);\n\n\t\t\tconst classicImportTab = new IconTabFilter(this.getId() + \"--idClassicImportTab\", {\n\t\t\t\tkey: \"classicImport\",\n\t\t\t\ttext: this._i18nBundle.getText(\"classicImport\")\n\t\t\t});\n\t\t\t// Add FESR for classic import tab\n\t\t\taddFESRSemanticStepName(classicImportTab, FESR_EVENTS.SELECT, \"classicImportTab\");\n\t\t\tconst classicText = new Text(this.getId() + \"--idClassicImportText\", {\n\t\t\t\ttext: this._i18nBundle.getText(\"classicImportText\")\n\t\t\t}).addStyleClass(\"sapUiSmallMarginBottom advancePadding\");\n\t\t\tconst resetImportAppsNow = new Button(this.getId() + \"--resetImportAppsNow\", {\n\t\t\t\ttext: this._i18nBundle.getText(\"resetButton\"),\n\t\t\t\tpress: this.onResetImportApps.bind(this),\n\t\t\t\tariaLabelledBy: [`${this.getId()}--idClassicImportText`]\n\t\t\t}).addStyleClass(\"resetButtonPadding\");\n\t\t\taddFESRSemanticStepName(resetImportAppsNow, FESR_EVENTS.PRESS, \"resetImportApps\");\n\t\t\tclassicImportTab.addContent(classicText);\n\t\t\tclassicImportTab.addContent(resetImportAppsNow);\n\n\t\t\tthis.oImportExportTab.addItem(exportTab);\n\t\t\tthis.oImportExportTab.addItem(importTab);\n\t\t\tthis.oImportExportTab.addItem(classicImportTab);\n\t\t\tthis._importExportPanel.addContent(this.oImportExportTab);\n\t\t\tthis._importExportPanel.addContent(this.setExportSectionList());\n\t\t}\n\t}\n\n\t/**\n\t *\n\t * @returns {List} export section list\n\t */\n\tprivate setExportSectionList(): List {\n\t\tconst exportSectionsList = new List(`${this.getId()}--exportSectionsList`, {\n\t\t\twidth: \"calc(100% - 2rem)\",\n\t\t\tgrowingThreshold: 50,\n\t\t\tincludeItemInSelection: true,\n\t\t\tvisible: \"{= ${advsettings>/selectedTab} === 'export'}\"\n\t\t}).addStyleClass(\"sapUiSmallMarginBegin\");\n\t\tconst headerToolbar = new Toolbar(`${this.getId()}--exportSectionsListToolbar`, {\n\t\t\tcontent: [\n\t\t\t\tnew Title(this.getId() + \"--idExportSectionsListHeaderText\", {\n\t\t\t\t\ttext: this._i18nBundle.getText(\"sectionExportListHeader\"),\n\t\t\t\t\tlevel: \"H4\"\n\t\t\t\t}).addStyleClass(\"sectionTitle\")\n\t\t\t]\n\t\t});\n\t\texportSectionsList.setHeaderToolbar(headerToolbar);\n\t\t//set model for the list and bind items to path advsettings>/export/sections\n\t\texportSectionsList.setModel(this.oControlModel, \"advsettings\");\n\n\t\texportSectionsList.bindItems({\n\t\t\tpath: \"advsettings>/export/sections\",\n\t\t\ttemplate: new CustomListItem(`${this.getId()}--exportCustomListItem`, {\n\t\t\t\tvisible: {\n\t\t\t\t\tpath: \"advsettings>panelClass\",\n\t\t\t\t\tformatter: this._isPanelAvailable.bind(this)\n\t\t\t\t},\n\t\t\t\taccDescription: {\n\t\t\t\t\tparts: [{ path: \"advsettings>enabled\" }, { path: \"advsettings>selected\" }, { path: \"advsettings>title\" }],\n\t\t\t\t\tformatter: this._formatAccDescription.bind(this)\n\t\t\t\t},\n\t\t\t\tcontent: [\n\t\t\t\t\tnew HBox(recycleId(`${this.getId()}--exportContentBox`), {\n\t\t\t\t\t\talignItems: \"Center\",\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\tnew CheckBox(recycleId(`${this.getId()}--exportListItemCheck`), {\n\t\t\t\t\t\t\t\tselect: this.onSectionsSelectionChange.bind(this, false),\n\t\t\t\t\t\t\t\tselected: \"{advsettings>selected}\",\n\t\t\t\t\t\t\t\tenabled: \"{advsettings>enabled}\"\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tnew Text(recycleId(`${this.getId()}--exportListItemText`), { text: \"{advsettings>title}\" })\n\t\t\t\t\t\t],\n\t\t\t\t\t\twidth: \"100%\"\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t});\n\t\tthis.oExportList = exportSectionsList;\n\t\treturn exportSectionsList;\n\t}\n\n\t/**\n\t * Returns an accessibility description string for a list item.\n\t *\n\t * @param enabled Indicates if the checkbox is enabled.\n\t * @param selected Indicates if the checkbox is selected (checked).\n\t * @param title The title of the list item.\n\t * @returns The formatted accessibility description.\n\t */\n\tprivate _formatAccDescription(enabled: boolean, selected: boolean, title: string): string {\n\t\tconst statusText = !enabled ? `${this._i18nBundle.getText(\"checkboxDisabledText\")}.` : \"\";\n\n\t\tconst selectionText = selected\n\t\t\t? this._i18nBundle.getText(\"checkboxCheckedText\")\n\t\t\t: this._i18nBundle.getText(\"checkboxUnCheckedText\");\n\n\t\tconst instructionText = this._i18nBundle.getText(\"checkboxInstructionText\");\n\n\t\treturn `${statusText}${selectionText}. ${title}. ${instructionText}`;\n\t}\n\n\tprivate _isPanelAvailable(panelClassName: string): boolean {\n\t\tconst panelMappings: Record<string, { containerName: string; panelName: string }> = {\n\t\t\t[FavAppPanelName]: { containerName: AppsContainerlName, panelName: FavAppPanelName },\n\t\t\t[PagePanelName]: { containerName: NewsAndPagesContainerName, panelName: PagePanelName },\n\t\t\t[TilesPanelName]: { containerName: InsightsContainerName, panelName: TilesPanelName },\n\t\t\t[CardsPanelName]: { containerName: InsightsContainerName, panelName: CardsPanelName }\n\t\t};\n\n\t\tconst mapping = panelMappings[panelClassName];\n\t\tif (!mapping) return false;\n\t\tconst layout = this._getPanel();\n\t\treturn checkPanelExists(layout, mapping.containerName, mapping.panelName);\n\t}\n\n\t/**\n\t *\n\t * @returns {List} import section list\n\t */\n\tprivate setImportSectionList(): List {\n\t\tconst importSectionsList = new List(this.getId() + \"--idImportSectionsList\", {\n\t\t\twidth: \"calc(100% - 2rem)\",\n\t\t\tgrowingThreshold: 50,\n\t\t\tincludeItemInSelection: true,\n\t\t\tvisible:\n\t\t\t\t\"{= ${advsettings>/selectedTab} === 'import' && (${advsettings>/import/sections/length} > 0 || ${advsettings>/showNoImport})}\"\n\t\t}).addStyleClass(\"sapUiSmallMarginBegin\");\n\t\tconst headerToolbar = new Toolbar(this.getId() + \"--idImportSectionsListToolbar\", {\n\t\t\tcontent: [\n\t\t\t\tnew Title(`${this.getId()}--importSectionsListHeaderText`, {\n\t\t\t\t\ttext: this._i18nBundle.getText(\"sectionImportListHeader\")\n\t\t\t\t}).addStyleClass(\"sectionTitle\")\n\t\t\t]\n\t\t});\n\t\timportSectionsList.setHeaderToolbar(headerToolbar);\n\t\t//set model for the list and bind items to path advsettings>/import/sections\n\t\timportSectionsList.setModel(this.oControlModel, \"advsettings\");\n\t\timportSectionsList.bindItems({\n\t\t\tpath: \"advsettings>/import/sections\",\n\t\t\ttemplate: new CustomListItem(`${this.getId()}--importCustomListItem`, {\n\t\t\t\taccDescription: {\n\t\t\t\t\tpath: \"advsettings>title\",\n\t\t\t\t\tformatter: this._formatAccDescription.bind(this)\n\t\t\t\t},\n\t\t\t\tcontent: [\n\t\t\t\t\tnew HBox(`${this.getId()}--importListCheckBox`, {\n\t\t\t\t\t\tjustifyContent: \"SpaceBetween\",\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\tnew HBox(`${this.getId()}--importListItemCheckHBox`, {\n\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\tnew CheckBox(`${this.getId()}--importListItemCheck`, {\n\t\t\t\t\t\t\t\t\t\tselect: this.onSectionsSelectionChange.bind(this, true),\n\t\t\t\t\t\t\t\t\t\tselected: \"{advsettings>selected}\",\n\t\t\t\t\t\t\t\t\t\tenabled: \"{advsettings>enabled}\"\n\t\t\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\t\t\tnew Text(`${this.getId()}--importListItemText`, { text: \"{advsettings>title}\" }).addStyleClass(\n\t\t\t\t\t\t\t\t\t\t\"sapUiTinyMarginTop\"\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tnew HBox(`${this.getId()}--importStatusHBox`, {\n\t\t\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\t\t\tnew ObjectStatus(`${this.getId()}--importItemStatus`, {\n\t\t\t\t\t\t\t\t\t\ticon: \"{= ${advsettings>status} === 'Success' ? 'sap-icon://status-positive' : 'sap-icon://status-negative' }\",\n\t\t\t\t\t\t\t\t\t\tstate: \"{advsettings>status}\",\n\t\t\t\t\t\t\t\t\t\tvisible: \"{= ${advsettings>status} !== 'None'}\"\n\t\t\t\t\t\t\t\t\t}).addStyleClass(\"sapUiSmallMarginEnd sapUiTinyMarginTop\")\n\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t],\n\t\t\t\t\t\twidth: \"100%\"\n\t\t\t\t\t})\n\t\t\t\t]\n\t\t\t})\n\t\t});\n\n\t\treturn importSectionsList;\n\t}\n\n\t/**\n\t * Selection change event handler for export and import sections\n\t * @param isImport boolean value to check if import or export tab is selected\n\t */\n\tprivate onSectionsSelectionChange(isImport: boolean): void {\n\t\tconst allSections = isImport ? this.oImportList.getItems() : this.oExportList.getItems();\n\t\tlet isSelected = false;\n\t\tlet content, innerCheckbox;\n\t\tconst isSectionSelected = allSections.some(function (oSection) {\n\t\t\tif (!isImport) {\n\t\t\t\tcontent = oSection.getAggregation(\"content\") as Control[];\n\t\t\t\tinnerCheckbox = (content[0] as HBox).getItems()[0] as CheckBox;\n\t\t\t\tisSelected = innerCheckbox.getSelected();\n\t\t\t} else {\n\t\t\t\tcontent = oSection.getAggregation(\"content\") as Control[];\n\t\t\t\tconst innerHbox = (content[0] as HBox).getItems()[0] as HBox;\n\t\t\t\tinnerCheckbox = innerHbox.getItems()[0] as CheckBox;\n\t\t\t\tisSelected = innerCheckbox.getSelected();\n\t\t\t}\n\t\t\treturn isSelected;\n\t\t});\n\t\tthis.oControlModel.setProperty((isImport ? \"/import\" : \"/export\") + \"/sectionsSelected\", isSectionSelected);\n\t\tthis.enableDisableActions((isImport ? \"import\" : \"export\") as ImportExportType);\n\t}\n\n\t/**\n\t * Handler for import button press\n\t *\n\t */\n\tprivate async onImportPress(): Promise<void> {\n\t\tthis.attachEvent(\"sectionsImported\", () => {\n\t\t\tthis.oDetailPage.setBusy(false);\n\t\t\tthis.oControlModel.setProperty(\"/import/sectionsSelected\", false);\n\t\t});\n\t\tthis.oImportBtn.setEnabled(false);\n\t\tthis.oDetailPage.setBusy(true);\n\t\tthis.handleUserPersonalizationError(ImportExportType.IMPORT, false, \"\", \"\");\n\t\tconst oExportData = this.oUserPersonalization.import.data;\n\t\ttry {\n\t\t\tconst aSelectedSections = await this.importSections(oExportData);\n\t\t\tconst bShowError: boolean = aSelectedSections.some((oSection) => {\n\t\t\t\treturn oSection.status === ValueState.Error;\n\t\t\t});\n\t\t\tif (bShowError) {\n\t\t\t\tthis.handleUserPersonalizationError(\n\t\t\t\t\tImportExportType.IMPORT,\n\t\t\t\t\ttrue,\n\t\t\t\t\tString(this._i18nBundle.getText(\"userPersonalizationImportError\")),\n\t\t\t\t\t\"Warning\"\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.oControlModel.setProperty(\"/import/sections\", aSelectedSections);\n\t\t} catch (oErr: unknown) {\n\t\t\tLog.error(\"importpress\", String(oErr));\n\t\t\tthis.handleUserPersonalizationError(\n\t\t\t\tImportExportType.IMPORT,\n\t\t\t\ttrue,\n\t\t\t\tString(this._i18nBundle.getText(\"userPersonalizationImportError\")),\n\t\t\t\t\"Error\"\n\t\t\t);\n\t\t}\n\t}\n\n\t/**\n\t * Invokes import of apps,tiles,pages and cards data\n\t * @param oImportData import data\n\t * @returns Promise<IExportSections[]>\n\t */\n\tprivate importSections(oImportData?: IExportData | IExportImportFile): Promise<IExportSections[] | []> {\n\t\tconst sectionImportChain: (() => Promise<void>)[] = [];\n\t\tconst aPromise: Promise<void>[] = [];\n\t\tconst oSelectedSections = this.oControlModel.getProperty(\"/import/sections\") as IExportSections[];\n\n\t\tsectionImportChain.push(() => this.importApps(oImportData));\n\t\tsectionImportChain.push(() => this.importTiles(oImportData));\n\t\tsectionImportChain.push(() => this.importFavPages(oImportData));\n\n\t\t// Execute apps, tiles, and pages sequentially\n\t\taPromise.push(\n\t\t\tsectionImportChain.reduce((chain, current) => {\n\t\t\t\treturn chain.then(() => current());\n\t\t\t}, Promise.resolve())\n\t\t);\n\n\t\taPromise.push(this.importCards(oImportData));\n\n\t\treturn Promise.all(aPromise)\n\t\t\t.then(() => {\n\t\t\t\treturn oSelectedSections;\n\t\t\t})\n\t\t\t.catch((oError: Error) => {\n\t\t\t\tLog.error(\"import failed\", String(oError));\n\t\t\t\treturn [];\n\t\t\t});\n\t}\n\n\tprivate importApps(oImportData?: IExportData | IExportImportFile): Promise<void> {\n\t\treturn new Promise<void>((resolve) => {\n\t\t\tconst oSelectedSections = this.oControlModel.getProperty(\"/import/sections\") as IExportSections[];\n\t\t\tif (\n\t\t\t\toImportData?.apps &&\n\t\t\t\toImportData?.apps.length > 0 &&\n\t\t\t\tthis.isSectionSelected(oSelectedSections, String(this._i18nBundle.getText(\"favApps\")))\n\t\t\t) {\n\t\t\t\tthis.oSectionsImported[String(this._i18nBundle.getText(\"favApps\"))] = false;\n\t\t\t\tthis.oEventBus.publish(\"importChannel\", \"appsImport\", { apps: oImportData.apps, groupInfo: oImportData.groupInfo });\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\t// if no apps / apps selected then resolve the promise and mark the section as imported\n\t\t\t\tthis.oSectionsImported[String(this._i18nBundle.getText(\"favApps\"))] = true;\n\t\t\t\tthis.updateImportStatus(\"favApps\");\n\t\t\t\tresolve(); // Resolve the promise if condition doesn't meet\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate importTiles(oImportData?: IExportData | IExportImportFile): Promise<void> {\n\t\treturn new Promise<void>((resolve) => {\n\t\t\tconst oSelectedSections = this.oControlModel.getProperty(\"/import/sections\") as IExportSections[];\n\t\t\tif (\n\t\t\t\toImportData?.tiles &&\n\t\t\t\toImportData.tiles.length > 0 &&\n\t\t\t\tthis.isSectionSelected(oSelectedSections, String(this._i18nBundle.getText(\"insightsTiles\")))\n\t\t\t) {\n\t\t\t\tthis.oSectionsImported[String(this._i18nBundle.getText(\"insightsTiles\"))] = false;\n\t\t\t\tthis.oEventBus.publish(\"importChannel\", \"tilesImport\", oImportData.tiles);\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\t// if no tiles / tiles section not selected then resolve the promise and mark the section as imported\n\t\t\t\tthis.oSectionsImported[String(this._i18nBundle.getText(\"insightsTiles\"))] = true;\n\t\t\t\tthis.updateImportStatus(\"insightsTiles\");\n\t\t\t\tresolve(); // Resolve the promise if condition doesn't meet\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate importFavPages(oImportData?: IExportData | IExportImportFile): Promise<void> {\n\t\treturn new Promise<void>((resolve) => {\n\t\t\tconst oSelectedSections = this.oControlModel.getProperty(\"/import/sections\") as IExportSections[];\n\t\t\tif (\n\t\t\t\toImportData?.favouritePages &&\n\t\t\t\toImportData.favouritePages.length > 0 &&\n\t\t\t\tthis.isSectionSelected(oSelectedSections, String(this._i18nBundle.getText(\"pages\")))\n\t\t\t) {\n\t\t\t\tthis.oSectionsImported[String(this._i18nBundle.getText(\"pages\"))] = false;\n\t\t\t\tthis.oEventBus.publish(\"importChannel\", \"favPagesImport\", oImportData.favouritePages);\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\t// if no tiles / tiles section not selected then resolve the promise and mark the section as imported\n\t\t\t\tthis.oSectionsImported[String(this._i18nBundle.getText(\"pages\"))] = true;\n\t\t\t\tthis.updateImportStatus(\"pages\");\n\t\t\t\tresolve(); // Resolve the promise if condition doesn't meet\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate importCards(oImportData?: IExportData | IExportImportFile): Promise<void> {\n\t\treturn new Promise<void>((resolve) => {\n\t\t\tconst oSelectedSections = this.oControlModel.getProperty(\"/import/sections\") as IExportSections[];\n\t\t\tif (\n\t\t\t\toImportData?.cards &&\n\t\t\t\toImportData.cards.length > 0 &&\n\t\t\t\tthis.isSectionSelected(oSelectedSections, String(this._i18nBundle.getText(\"insightsCards\")))\n\t\t\t) {\n\t\t\t\tthis.oSectionsImported[String(this._i18nBundle.getText(\"insightsCards\"))] = false;\n\t\t\t\tthis.oEventBus.publish(\"importChannel\", \"cardsImport\", oImportData.cards);\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\t// if no tiles / tiles section not selected then resolve the promise and mark the section as imported\n\t\t\t\tthis.oSectionsImported[String(this._i18nBundle.getText(\"insightsCards\"))] = true;\n\t\t\t\tthis.updateImportStatus(\"insightsCards\");\n\t\t\t\tresolve(); // Resolve the promise if condition doesn't meet\n\t\t\t}\n\t\t});\n\t}\n\t/**\n\t *  Updates status of sections being imported\n\t *\t@param {string} sSectionTitle - section title\n\t * \t@param {boolean} errorState - error state\n\t * \t@returns {void}\n\t */\n\tprivate updateImportStatus(sSectionTitle: string, errorState?: boolean): void {\n\t\tconst sSectionId = String(this._i18nBundle.getText(sSectionTitle));\n\t\tconst oSelectedSections = this.oControlModel.getProperty(\"/import/sections\") as IExportSections[];\n\t\tconst oSection = oSelectedSections.find(function (oSec) {\n\t\t\treturn oSec.title === sSectionId;\n\t\t});\n\t\tif (oSection) {\n\t\t\tif (errorState !== undefined) {\n\t\t\t\toSection.status = errorState ? ValueState.Error : ValueState.Success;\n\t\t\t} else {\n\t\t\t\toSection.status = ValueState.None;\n\t\t\t}\n\t\t\t//if a section's status has become success then disable that particular section\n\t\t\tif (oSection.status === ValueState.Success) {\n\t\t\t\toSection.enabled = false;\n\t\t\t}\n\t\t}\n\t\tthis.oSectionsImported[sSectionId] = true;\n\t\tconst sectionTitles = Object.keys(this.oSectionsImported);\n\t\t// if every section has been imported successfully then fire sectionsimported\n\t\tconst imported = sectionTitles.every((sTitle) => {\n\t\t\treturn this.oSectionsImported[sTitle];\n\t\t});\n\t\tif (imported) {\n\t\t\tthis.fireEvent(\"sectionsImported\");\n\t\t}\n\t}\n\n\t/**\n\t *  Resets the import model values\n\t *  @param {boolean} onOpen - value to show if the reset call is happening while opening the dialog for the first time\n\t * \t@private\n\t */\n\tpublic resetImportModel(onOpen?: boolean): void {\n\t\tthis.oControlModel.setProperty(\"/import/sections\", []);\n\t\tthis.oControlModel.setProperty(\"/import/sectionsSelected\", false);\n\t\tthis.oControlModel.setProperty(\"/import/error\", false);\n\t\t// if called on settingsdialog open , reset value of selectedtab and fileUploader value\n\t\tif (onOpen) {\n\t\t\tthis.oControlModel.setProperty(\"/selectedTab\", \"export\");\n\t\t\t(Element.getElementById(this.getId() + \"--idImportFileUploader\") as FileUploader)?.setValue(\"\");\n\t\t}\n\t}\n\n\t/**\n\t * \tFind visualizations that are not already present in the favsections\n\t * @param aImportedSections\n\t * @returns {Promise<ISection[] | []>} aImportedSections\n\t */\n\tprivate async getDeltaSectionViz(aImportedSections: ISection[]): Promise<ISection[] | []> {\n\t\ttry {\n\t\t\tconst favSections: ISection[] = await this.oAppManagerInstance._getSections(true);\n\n\t\t\taImportedSections.forEach((oImportedSection) => {\n\t\t\t\tlet oSection: ISection | undefined;\n\t\t\t\tif (oImportedSection.default) {\n\t\t\t\t\toSection = favSections.find((oSec) => oSec.default);\n\t\t\t\t} else {\n\t\t\t\t\toSection = favSections.find((oSec) => oSec.id === oImportedSection.id);\n\t\t\t\t}\n\t\t\t\tif (oSection) {\n\t\t\t\t\t// find visualizations that are not already present in the favsections\n\t\t\t\t\tconst aDelta = oImportedSection.visualizations?.filter((oImportViz) => {\n\t\t\t\t\t\treturn oSection.visualizations?.every((oViz) =>\n\t\t\t\t\t\t\toViz.isBookmark ? oViz.targetURL !== oImportViz.targetURL : oViz.vizId !== oImportViz.vizId\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t\toImportedSection.visualizations = aDelta;\n\t\t\t\t}\n\t\t\t});\n\t\t\t// Remove Sections with no visualizations\n\t\t\taImportedSections = aImportedSections.filter((oSection) => oSection.visualizations && oSection.visualizations.length > 0);\n\t\t\treturn aImportedSections;\n\t\t} catch (error) {\n\t\t\tLog.error(\"Error occurred while fetching delta section visualizations:\" + String(error));\n\t\t\treturn []; // Return an empty array in case of error\n\t\t}\n\t}\n\n\tprivate getDeltaAuthSectionViz(aImportedSections: ISection[]): Promise<[] | ISection[]> {\n\t\t// Get delta visualization\n\t\tif (aImportedSections && aImportedSections.length) {\n\t\t\treturn this.getDeltaSectionViz(aImportedSections)\n\t\t\t\t.then((aDeltaSections: ISection[]) => {\n\t\t\t\t\t// Filter authorized section visualizations\n\t\t\t\t\treturn this.filterAuthSectionViz(aDeltaSections);\n\t\t\t\t})\n\t\t\t\t.catch((oError) => {\n\t\t\t\t\tLog.error(String(oError));\n\t\t\t\t\treturn [];\n\t\t\t\t});\n\t\t}\n\t\treturn Promise.resolve([]); // Return a promise resolving to void\n\t}\n\n\tprivate async filterAuthSectionViz(aSections: ISection[]): Promise<ISection[]> {\n\t\tconst _getCatalogApps = function () {\n\t\t\treturn Container.getServiceAsync<SearchableContent>(\"SearchableContent\").then(function (SearchableContent) {\n\t\t\t\treturn SearchableContent.getApps({ includeAppsWithoutVisualizations: false });\n\t\t\t});\n\t\t};\n\n\t\tconst _filterAuthViz = function (aAppCatalog: AppData[], aViz: IVisualization[] | undefined) {\n\t\t\tconst aSectionViz: IVisualization[] | undefined = [];\n\t\t\taViz?.forEach(function (oViz) {\n\t\t\t\tfor (let appCatalog of aAppCatalog) {\n\t\t\t\t\tconst oAppCatalog = appCatalog;\n\t\t\t\t\tconst oSectionViz = oAppCatalog.visualizations.find(function (oCatalogViz: IVisualization) {\n\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\toCatalogViz.vizId === oViz.vizId ||\n\t\t\t\t\t\t\t(oViz.isBookmark &&\n\t\t\t\t\t\t\t\toCatalogViz.target &&\n\t\t\t\t\t\t\t\toViz.target?.action === oCatalogViz.target.action &&\n\t\t\t\t\t\t\t\toViz.target?.semanticObject === oCatalogViz.target.semanticObject)\n\t\t\t\t\t\t);\n\t\t\t\t\t});\n\t\t\t\t\tif (oSectionViz) {\n\t\t\t\t\t\toSectionViz.displayFormatHint =\n\t\t\t\t\t\t\toViz.displayFormatHint !== \"standard\" ? String(oViz.displayFormatHint) : String(oSectionViz.displayFormatHint);\n\t\t\t\t\t\toSectionViz.id = String(oViz.id ?? oSectionViz.id);\n\t\t\t\t\t\taSectionViz.push(oViz.isBookmark ? oViz : oSectionViz);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn aSectionViz;\n\t\t};\n\n\t\treturn await _getCatalogApps().then(function (aAppCatalog) {\n\t\t\treturn aSections.map(function (oSection) {\n\t\t\t\toSection.visualizations = _filterAuthViz(aAppCatalog, oSection.visualizations);\n\t\t\t\treturn oSection;\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Filter authorized favorite pages\n\t *\n\t * @param {Array} aFavPages - array of favorite pages\n\t * @returns {Promise} resolves to an array of authorized pages\n\t */\n\tprivate async filterAuthFavPages(aFavPages: IPage[]): Promise<IPage[] | []> {\n\t\tif (aFavPages && aFavPages.length > 0) {\n\t\t\treturn await this.oPageManagerInstance.fetchAllAvailablePages().then(function (aAvailablePages) {\n\t\t\t\treturn aFavPages.filter(function (oimportedPage) {\n\t\t\t\t\treturn aAvailablePages.filter(function (oAvailabePage) {\n\t\t\t\t\t\treturn oAvailabePage.pageId === oimportedPage.pageId && oAvailabePage.spaceId === oimportedPage.spaceId;\n\t\t\t\t\t}).length;\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t\treturn Promise.resolve([]);\n\t}\n\n\t/**\n\t * Filter authorized cards\n\t *\n\t * @param {Array} aCards - array of cards\n\t * @returns {Promise} resolves to an array of authorized cards\n\t */\n\tprivate async filterAuthCards(aCards: ICardManifest[] | void): Promise<ICardManifest[] | undefined> {\n\t\tconst _getParentApp = function (aAvailableApps: IAppInbounds[], oCard: ICardManifest) {\n\t\t\treturn aAvailableApps.find(function (oApp) {\n\t\t\t\treturn (\n\t\t\t\t\toApp.resolutionResult &&\n\t\t\t\t\toApp.resolutionResult.applicationDependencies &&\n\t\t\t\t\toCard[\"sap.insights\"] &&\n\t\t\t\t\toApp.resolutionResult.applicationDependencies.name === oCard[\"sap.insights\"].parentAppId\n\t\t\t\t);\n\t\t\t});\n\t\t};\n\n\t\tconst _isNavigationSupported = function (oService: Navigation, oParentApp: IAppInbounds | undefined) {\n\t\t\tif (oParentApp) {\n\t\t\t\treturn oService\n\t\t\t\t\t.isNavigationSupported([\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\ttarget: {\n\t\t\t\t\t\t\t\tsemanticObject: oParentApp.semanticObject,\n\t\t\t\t\t\t\t\taction: oParentApp.action\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t])\n\t\t\t\t\t.then(function (aResponses) {\n\t\t\t\t\t\treturn aResponses[0].supported || false;\n\t\t\t\t\t});\n\t\t\t}\n\t\t\treturn Promise.resolve(false);\n\t\t};\n\n\t\tif (aCards && aCards.length > 0) {\n\t\t\treturn await Promise.all([\n\t\t\t\tContainer.getServiceAsync<ClientSideTargetResolution>(\"ClientSideTargetResolution\"),\n\t\t\t\tContainer.getServiceAsync<Navigation>(\"Navigation\")\n\t\t\t]).then(function (aServices: [ClientSideTargetResolution, Navigation]) {\n\t\t\t\tconst clientSideTargetResolution = aServices[0];\n\t\t\t\tconst Navigation = aServices[1];\n\t\t\t\tconst aAvailableApps = clientSideTargetResolution._oAdapter._aInbounds || [];\n\n\t\t\t\treturn aCards.reduce<Promise<ICardManifest[]>>(async (promise: Promise<ICardManifest[]>, oCard: ICardManifest) => {\n\t\t\t\t\tconst aAuthCards: ICardManifest[] = await promise;\n\t\t\t\t\tconst oParentApp = _getParentApp(aAvailableApps, oCard);\n\t\t\t\t\tconst bIsNavigationSupported = await _isNavigationSupported(Navigation, oParentApp);\n\t\t\t\t\tif (bIsNavigationSupported) {\n\t\t\t\t\t\taAuthCards.push(oCard);\n\t\t\t\t\t}\n\t\t\t\t\treturn aAuthCards;\n\t\t\t\t}, Promise.resolve([]));\n\t\t\t});\n\t\t}\n\t\treturn Promise.resolve([]);\n\t}\n\n\t/**\n\t * Handles change event for fileuploader on import file\n\t *\n\t * @returns {Promise} resolves to available import sections being shown\n\t */\n\tprivate onFileImport(oEvent: FileUploader$ChangeEvent): Promise<void> {\n\t\tthis.handleUserPersonalizationError(ImportExportType.IMPORT, false, \"\", \"\");\n\t\tthis.resetImportModel();\n\t\tthis.oDetailPage.setBusy(true);\n\n\t\tconst files = oEvent.getParameter(\"files\");\n\t\tconst oFile = files && (files[0] as File);\n\n\t\treturn this.readFileContent(oFile)\n\t\t\t.then((oFileContent) => {\n\t\t\t\t// btoa doesn't support the characters outside latin-1 range, so first encode to utf-8\n\t\t\t\tconst oEncodedFileContent = window.btoa(\n\t\t\t\t\tencodeURIComponent(oFileContent).replace(/%([0-9A-F]{2})/g, function (match, p1: string) {\n\t\t\t\t\t\treturn String.fromCharCode(parseInt(p1, 16)); // Convert p1 to a number using parseInt //String.fromCharCode(\"0x\" + p1);\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t\t\treturn HttpHelper.Post(EXPORT_API, { fileContent: oEncodedFileContent }).then((oResponse: unknown) => {\n\t\t\t\t\tif (oResponse && (oResponse as { error: string }).error) {\n\t\t\t\t\t\tthrow new Error((oResponse as { error: string }).error);\n\t\t\t\t\t}\n\t\t\t\t\tif (oResponse && (oResponse as { value: string[] }).value && (oResponse as { value: string[] }).value.length) {\n\t\t\t\t\t\tconst oImportDataString: string | undefined = (oResponse as ApiResponse).value[0].fileContent;\n\n\t\t\t\t\t\t// Parse the stringified JSON into the defined type\n\t\t\t\t\t\tconst oImportData = JSON.parse(oImportDataString) as IExportImportFile;\n\t\t\t\t\t\tif (oImportData.host === window.location.host) {\n\t\t\t\t\t\t\tconst aImportedSections = (oImportData.sections as ISection[]) || ([] as ISection[]);\n\t\t\t\t\t\t\taImportedSections.push({\n\t\t\t\t\t\t\t\tid: MYINSIGHT_SECTION_ID,\n\t\t\t\t\t\t\t\tvisualizations: (oImportData.tiles as IVisualization[]) || []\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t//filter authorized data\n\t\t\t\t\t\t\treturn this.filterAuthorizedImportData(aImportedSections, oImportData);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.handleUserPersonalizationError(\n\t\t\t\t\t\t\t\tImportExportType.IMPORT,\n\t\t\t\t\t\t\t\ttrue,\n\t\t\t\t\t\t\t\tString(this._i18nBundle.getText(\"importSourceErrorMessage\")),\n\t\t\t\t\t\t\t\t\"\"\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn Promise.resolve();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t\t.catch((oError) => {\n\t\t\t\tLog.error(String(oError));\n\t\t\t\tthis.handleUserPersonalizationError(ImportExportType.IMPORT, true, \"\", \"\");\n\t\t\t})\n\t\t\t.finally(() => {\n\t\t\t\tthis.oDetailPage.setBusy(false);\n\t\t\t\tthis.enableDisableActions(ImportExportType.IMPORT);\n\t\t\t});\n\t}\n\n\tprivate async filterAuthorizedImportData(aImportedSections: ISection[], oImportData: IExportImportFile): Promise<void> {\n\t\tlet promises: Promise<[] | ISection[] | IPage[] | ICardManifest[] | undefined | JSONModel>[] = [\n\t\t\tthis.getDeltaAuthSectionViz(aImportedSections),\n\t\t\tthis.filterAuthFavPages(oImportData.favouritePages)\n\t\t];\n\t\tif (await this.isInsightsEnabled()) {\n\t\t\tpromises.push(this.filterAuthCards(oImportData.cards));\n\t\t\tpromises.push(this.getInsightCards()); // check : send only cards count here as all cards are not required\n\t\t}\n\t\treturn Promise.all(promises).then(async (aResponse) => {\n\t\t\tconst aAuthSections = aResponse[0] as ISection[];\n\t\t\tconst aAuthFavPages = aResponse[1] as IPage[];\n\t\t\tconst aAuthCards = (aResponse[2] || []) as ICardManifest[];\n\t\t\tconst iInsightCardsCount = ((aResponse[3] as JSONModel)?.getProperty(\"/cardCount\") as number) || 0;\n\t\t\toImportData.apps = aAuthSections.filter(function (oSection) {\n\t\t\t\treturn oSection.id !== MYINSIGHT_SECTION_ID;\n\t\t\t});\n\t\t\toImportData.tiles =\n\t\t\t\t(\n\t\t\t\t\taAuthSections.find(function (oSection) {\n\t\t\t\t\t\treturn oSection.id === MYINSIGHT_SECTION_ID;\n\t\t\t\t\t}) || {}\n\t\t\t\t).visualizations || [];\n\t\t\toImportData.favouritePages = aAuthFavPages;\n\t\t\toImportData.cards = aAuthCards || [];\n\t\t\tconst iTotalCardCount = iInsightCardsCount + Number(aAuthCards?.length);\n\t\t\tif (iTotalCardCount > 99) {\n\t\t\t\tthis.handleUserPersonalizationError(\n\t\t\t\t\tImportExportType.IMPORT,\n\t\t\t\t\ttrue,\n\t\t\t\t\tString(this._i18nBundle.getText(\"importCardCountErrorMessage\")),\n\t\t\t\t\t\"\"\n\t\t\t\t);\n\t\t\t}\n\t\t\tlet aSections = await this.getImportedSections(oImportData, ImportExportType.IMPORT, iInsightCardsCount);\n\t\t\taSections = aSections.map(function (oSection) {\n\t\t\t\toSection.status = ValueState.None;\n\t\t\t\treturn oSection;\n\t\t\t});\n\t\t\tthis.oUserPersonalization.import.data = oImportData;\n\t\t\tthis.oControlModel.setProperty(\"/import/sections\", aSections);\n\t\t\tthis.oControlModel.setProperty(\"/import/sectionsSelected\", this.getSelectedSections(aSections).length > 0);\n\t\t\tthis.oControlModel.setProperty(\"/showNoImport\", aSections.length === 0);\n\t\t});\n\t}\n\n\tprivate readFileContent(oFile: File | undefined): Promise<string> {\n\t\treturn new Promise(function (resolve, reject) {\n\t\t\tif (oFile && window.FileReader) {\n\t\t\t\tconst reader = new FileReader();\n\t\t\t\treader.onload = function (event: ProgressEvent<FileReader>) {\n\t\t\t\t\tconst target = event.target as FileReader;\n\t\t\t\t\tresolve(target?.result as string);\n\t\t\t\t};\n\t\t\t\t// Convert oFile to Blob\n\t\t\t\tconst blob = oFile as unknown as Blob;\n\t\t\t\treader.readAsText(blob);\n\t\t\t} else {\n\t\t\t\treject(new Error(\"Error\"));\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate async _getPersonalizationData(): Promise<IPersonalizationData> {\n\t\tif (!this.oPersonalizerInstance) {\n\t\t\tthis.oPersonalizerInstance = await UShellPersonalizer.getInstance(\n\t\t\t\tPersonalisationUtils.getPersContainerId(this._getPanel()),\n\t\t\t\tPersonalisationUtils.getOwnerComponent(this._getPanel()) as Component\n\t\t\t);\n\t\t}\n\t\tthis.persData = (await this.oPersonalizerInstance.read()) || {};\n\t\treturn this.persData;\n\t}\n\n\tprivate async loadUserPersonalizationData(): Promise<void> {\n\t\tthis.oExportList.setBusy(true);\n\t\tconst persData = await this._getPersonalizationData();\n\n\t\tlet promises: (Promise<ISection[]> | Promise<JSONModel>)[] = [this.oAppManagerInstance._getSections(true)];\n\t\tif (await this.isInsightsEnabled()) {\n\t\t\tpromises.push(this.getInsightCards());\n\t\t}\n\n\t\t// load all sections, insight apps and cards\n\t\tconst [favSections, insightModel] = (await Promise.all(promises)) as [ISection[], JSONModel];\n\n\t\tconst aSections = favSections,\n\t\t\tfavApps = aSections.filter((oSection) => {\n\t\t\t\treturn oSection.id !== MYINSIGHT_SECTION_ID && oSection.visualizations?.length;\n\t\t\t});\n\n\t\tconst insightTiles =\n\t\t\taSections.find((oSection) => {\n\t\t\t\treturn oSection.id === MYINSIGHT_SECTION_ID;\n\t\t\t})?.visualizations || [];\n\n\t\tconst insightCards: ICardManifest[] =\n\t\t\tinsightModel && insightModel.getProperty(\"/visibleCards\")\n\t\t\t\t? (insightModel.getProperty(\"/visibleCards\") as ICard[]).map((oCard: ICard) => {\n\t\t\t\t\t\treturn oCard.descriptorContent;\n\t\t\t\t\t})\n\t\t\t\t: [];\n\t\tconst oExportData = {\n\t\t\tapps: favApps,\n\t\t\ttiles: insightTiles,\n\t\t\tfavouritePages: persData.favouritePages,\n\t\t\tcards: insightCards,\n\t\t\tpersonalization: persData\n\t\t} as IExportData;\n\t\tconst aExportSections = await this.getImportedSections(oExportData, ImportExportType.EXPORT, 0);\n\t\tthis.oUserPersonalization.export.data = oExportData;\n\t\tthis.oUserPersonalization.export.sections = aExportSections;\n\t\tthis.oUserPersonalization.export.sectionsSelected = this.getSelectedSections(aExportSections).length > 0;\n\t\tthis.oControlModel.refresh();\n\t\tthis.oExportList.setBusy(false);\n\t}\n\n\t/**\n\t * Checks if insights is enabled for the system\n\t *\n\t * @private\n\t * @returns {boolean}\n\t */\n\tprivate async isInsightsEnabled(): Promise<boolean> {\n\t\ttry {\n\t\t\tif (await (CardHelper as ICardHelper).getServiceAsync()) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn false;\n\t\t} catch (error) {\n\t\t\tLog.error(error instanceof Error ? error.message : String(error));\n\t\t\treturn false;\n\t\t}\n\t}\n\n\t/**\n\t * Returns selected sections out of provided sections\n\t *\n\t * @param {Array} aSections - array of sections to show in import/export\n\t * @returns {Array} array of selected sections\n\t */\n\tgetSelectedSections(aSections: IExportSections[]): IExportSections[] {\n\t\treturn (\n\t\t\taSections.filter(function (oSection) {\n\t\t\t\treturn oSection.selected && oSection.enabled;\n\t\t\t}) || []\n\t\t);\n\t}\n\n\t/**\n\t * Returns if section is selected\n\t *\n\t * @param {Array} oSections - import/export sections\n\t * @param {String} sSectionId - import/export section id\n\t * @returns {boolean} returns true if section is selected\n\t */\n\tisSectionSelected(sections: IExportSections[], sectionId: string): boolean {\n\t\tconst section = sections.find(function (sec) {\n\t\t\treturn sec.title === sectionId;\n\t\t});\n\t\treturn !!(section && section.selected && section.enabled);\n\t}\n\n\t/**\n\t * Returns import/export sections\n\t *\n\t * @param {object} oData - export/import data\n\t * @param {ImportExportType} sType - export/import type\n\t * @param {number} iInsightCardsCount - cards count\n\t * @returns {Array} array of import/export sections\n\t */\n\tprivate async getImportedSections(\n\t\toData: IExportData | IExportImportFile,\n\t\tsType: ImportExportType,\n\t\tiInsightCardsCount: number\n\t): Promise<IExportSections[]> {\n\t\tconst aFavPages =\n\t\t\t\t(sType === ImportExportType.IMPORT ? await this.getDeltaFavPages(oData.favouritePages) : oData.favouritePages) || [],\n\t\t\tisAppViz =\n\t\t\t\toData.apps &&\n\t\t\t\toData.apps.some(function (oSections) {\n\t\t\t\t\treturn oSections && oSections.visualizations && oSections.visualizations.length > 0;\n\t\t\t\t});\n\n\t\tconst sections = [\n\t\t\t{\n\t\t\t\ttitle: this._i18nBundle.getText(\"favApps\") as string,\n\t\t\t\tselected: isAppViz,\n\t\t\t\tenabled: isAppViz,\n\t\t\t\tpanelClass: FavAppPanelName\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: this._i18nBundle.getText(\"pages\") as string,\n\t\t\t\tselected: aFavPages?.length > 0,\n\t\t\t\tenabled: aFavPages?.length > 0,\n\t\t\t\tpanelClass: PagePanelName\n\t\t\t},\n\t\t\t{\n\t\t\t\ttitle: this._i18nBundle.getText(\"insightsTiles\") as string,\n\t\t\t\tselected: oData.tiles && oData.tiles.length > 0,\n\t\t\t\tenabled: oData.tiles && oData.tiles.length > 0,\n\t\t\t\tpanelClass: TilesPanelName\n\t\t\t}\n\t\t];\n\n\t\tif (await this.isInsightsEnabled()) {\n\t\t\tsections.push({\n\t\t\t\ttitle: this._i18nBundle.getText(\"insightsCards\") as string,\n\t\t\t\tselected: oData.cards && oData.cards.length > 0 && oData.cards.length + iInsightCardsCount <= 99,\n\t\t\t\tenabled: oData.cards && oData.cards.length > 0 && oData.cards.length + iInsightCardsCount <= 99,\n\t\t\t\tpanelClass: CardsPanelName\n\t\t\t});\n\t\t}\n\n\t\treturn sections;\n\t}\n\n\tprivate async getDeltaFavPages(aImportedFavPages: IPage[]): Promise<IPage[]> {\n\t\tconst persData = await this._getPersonalizationData();\n\t\tconst aFavPages = persData.favouritePages || [];\n\t\tif (aFavPages.length !== aImportedFavPages.length) {\n\t\t\treturn aImportedFavPages;\n\t\t}\n\t\treturn aImportedFavPages.filter(function (oImportedPage) {\n\t\t\treturn !aFavPages.find(function (oFavPage) {\n\t\t\t\treturn oImportedPage.pageId === oFavPage.pageId && oImportedPage.spaceId === oFavPage.spaceId;\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate async getInsightCards(): Promise<JSONModel> {\n\t\ttry {\n\t\t\tthis.cardHelperInstance = await (CardHelper as ICardHelper).getServiceAsync();\n\t\t\tconst oUserVisibleCardModel = await this.cardHelperInstance._getUserAllCardModel();\n\t\t\tconst aCards = oUserVisibleCardModel.getProperty(\"/cards\") as ICard[];\n\t\t\tconst aVisibleCards = aCards.filter(function (oCard: ICard) {\n\t\t\t\treturn oCard.visibility;\n\t\t\t});\n\t\t\toUserVisibleCardModel.setProperty(\"/visibleCards\", aVisibleCards);\n\t\t\treturn oUserVisibleCardModel;\n\t\t} catch (error) {\n\t\t\t// Handle any errors\n\t\t\tconsole.error(\"Error in getInsightCards:\", error);\n\t\t\tthrow error; // Re-throw the error to be handled by the caller\n\t\t}\n\t}\n\n\t/**\n\t * Handles export button press\n\t */\n\tprivate onExportPress(): void {\n\t\tthis.handleUserPersonalizationError(ImportExportType.EXPORT, false, \"\", \"\");\n\t\tconst oExportFileName = this.oControlModel.getProperty(\"/export/fileName\") as string,\n\t\t\taExportSections = this.oControlModel.getProperty(\"/export/sections\") as IExportSections[],\n\t\t\toExportData = this.oUserPersonalization.export.data;\n\t\tconst oExportFileContent = this.getExportFileContent(oExportData, aExportSections);\n\t\tsap.ui.require([\"sap/ui/core/util/File\"], (File: File) => {\n\t\t\ttry {\n\t\t\t\tFile.save(JSON.stringify(oExportFileContent), oExportFileName, \"txt\", \"text/plain\", \"utf-8\");\n\t\t\t\tMessageToast.show(String(this._i18nBundle.getText(\"userPersonalizationExportSuccess\")));\n\t\t\t} catch (error) {\n\t\t\t\tLog.error(error instanceof Error ? error.message : String(error));\n\t\t\t\tif (error instanceof Error && error?.name !== undefined && error.name !== \"AbortError\") {\n\t\t\t\t\t// Handle the error appropriately\n\t\t\t\t\tthis.handleUserPersonalizationError(ImportExportType.EXPORT, true, \"\", \"\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate getExportFileContent(exportData: IExportData | undefined, exportSections: IExportSections[]): IExportImportFile {\n\t\tconst oPersonalization = exportData?.personalization,\n\t\t\toExportFileContent = {\n\t\t\t\thost: window.location.host,\n\t\t\t\tcreatedDate: new Date(),\n\t\t\t\tsections: [] as ISectionAndVisualization[] | IVisualization[] | [],\n\t\t\t\tgroupInfo: [] as IAppPersonalization[] | IVisualization[] | [],\n\t\t\t\ttiles: [] as ISectionAndVisualization[] | IVisualization[] | [],\n\t\t\t\tcards: [] as ICardManifest[],\n\t\t\t\tfavouritePages: [] as IPage[] | []\n\t\t\t};\n\t\tif (this.isSectionSelected(exportSections, this._i18nBundle.getText(\"favApps\") as string)) {\n\t\t\toExportFileContent.sections = exportData?.apps || [];\n\t\t\toExportFileContent.groupInfo = oPersonalization?.favoriteApps || [];\n\t\t}\n\t\tif (this.isSectionSelected(exportSections, this._i18nBundle.getText(\"pages\") as string)) {\n\t\t\toExportFileContent.favouritePages = oPersonalization?.favouritePages || [];\n\t\t}\n\t\tif (this.isSectionSelected(exportSections, this._i18nBundle.getText(\"insightsTiles\") as string)) {\n\t\t\toExportFileContent.tiles = exportData?.tiles || [];\n\t\t}\n\t\tif (this.isSectionSelected(exportSections, this._i18nBundle.getText(\"insightsCards\") as string)) {\n\t\t\toExportFileContent.cards = this.filterNonSensitiveCards(exportData?.cards || []);\n\t\t}\n\t\treturn oExportFileContent;\n\t}\n\n\t/**\n\t * Filters out the sensitive cards from the import data\n\t *\n\t * @private\n\t * @param {ICardManifest[]} cards Array of card to filter out before import\n\t * @returns {ICardManifest[]} Array of filtered cards\n\t */\n\tprivate filterNonSensitiveCards(cards: ICardManifest[]): ICardManifest[] {\n\t\tconst nonSensitiveCards = [] as ICardManifest[];\n\n\t\tcards.forEach((oCard) => {\n\t\t\tif (oCard[\"sap.card\"]?.configuration?.parameters) {\n\t\t\t\tconst parameter = oCard[\"sap.card\"].configuration.parameters;\n\t\t\t\tlet sensitiveProps: string[] = [];\n\t\t\t\tsensitiveProps = sensitiveProps\n\t\t\t\t\t.concat(this.getSensitiveProps(parameter.headerState))\n\t\t\t\t\t.concat(this.getSensitiveProps(parameter.lineItemState))\n\t\t\t\t\t.concat(this.getSensitiveProps(parameter.state));\n\t\t\t\tif (sensitiveProps.length === 0) {\n\t\t\t\t\tnonSensitiveCards.push(oCard);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tnonSensitiveCards.push(oCard);\n\t\t\t}\n\t\t});\n\t\tif (cards.length !== nonSensitiveCards.length) {\n\t\t\tthis.handleUserPersonalizationError(\n\t\t\t\tImportExportType.EXPORT,\n\t\t\t\ttrue,\n\t\t\t\tString(this._i18nBundle.getText(\"exportSensitiveCardsErrorMessage\")),\n\t\t\t\t\"Warning\"\n\t\t\t);\n\t\t}\n\t\treturn nonSensitiveCards;\n\t}\n\n\t/**\n\t * Finds the sensitive properties and parameters\n\t *\n\t * @private\n\t * @param {({ value: string } | undefined)} param\n\t * @returns {string[]} Array of sensitive props as strings\n\t */\n\tprivate getSensitiveProps(param: { value: string } | undefined) {\n\t\tlet paramSensitiveProps: string[] = [];\n\t\tif (param?.value) {\n\t\t\tconst paramValue = JSON.parse(param.value) as { sensitiveProps: string[]; parameters: ICardActionParameters };\n\t\t\tconst sensitiveProp = paramValue.sensitiveProps || Object.keys(paramValue.parameters?.ibnParams?.sensitiveProps || {});\n\t\t\tif (sensitiveProp.length > 0) {\n\t\t\t\tparamSensitiveProps = paramSensitiveProps.concat(sensitiveProp);\n\t\t\t}\n\t\t}\n\t\treturn paramSensitiveProps;\n\t}\n\n\t/**\n\t * Handles user personalization error, shows the error msg and reset values\n\t *\n\t * @param {string} sType - type of import/export\n\t * @param {boolean} bShowError - flag to show or hide error msg\n\t * @param {string} sErrorMsg - error msg text\n\t * @param {string} sErrorType - error msg type\n\t */\n\tprivate handleUserPersonalizationError(sType: ImportExportType, bShowError: boolean, sErrorMsg: string, sErrorType: string): void {\n\t\tconst sDefaultErrorMsg = this._i18nBundle.getText(sType === ImportExportType.IMPORT ? \"importErrorMessage\" : \"exportErrorMessage\");\n\t\tthis.oControlModel.setProperty(\"/\" + sType + \"/error\", bShowError, undefined, true);\n\t\tthis.oControlModel.setProperty(\"/\" + sType + \"/errorMessage\", sErrorMsg || sDefaultErrorMsg, undefined, true);\n\t\tthis.oControlModel.setProperty(\"/\" + sType + \"/errorType\", sErrorType || \"Error\", undefined, true);\n\t\tthis.setExportImportValues(sType);\n\t}\n\n\t/**\n\t * Handles import/export tab select\n\t *\n\t * @param {object} oEvent - IconTabBarSeelect event\n\t */\n\tprivate onImportExportTabSelect(oEvent: IconTabBar$SelectEvent): void {\n\t\tconst selectedKey = oEvent.getParameter(\"selectedKey\");\n\t\tthis.oSelectedTab = selectedKey;\n\t\tthis.oControlModel.setProperty(\"/selectedTab\", selectedKey);\n\t\tthis.oExportList.setVisible(selectedKey === \"export\");\n\n\t\tthis.oImportBtn.setVisible(selectedKey === \"import\");\n\t\tthis.oExportBtn.setVisible(selectedKey === \"export\");\n\t\tthis.oImportBtn.setEnabled(this.oUserPersonalization.import.sectionsSelected);\n\t\tthis.oExportBtn.setEnabled(this.oUserPersonalization.export.sectionsSelected);\n\t\tthis.oExportBtn.setEnabled(\n\t\t\t!!(\n\t\t\t\tthis.oUserPersonalization.export.fileName &&\n\t\t\t\tthis.oUserPersonalization.export.sections &&\n\t\t\t\tthis.oUserPersonalization.export.sections.length > 0 &&\n\t\t\t\tthis.oUserPersonalization.export.sectionsSelected\n\t\t\t)\n\t\t);\n\t}\n\n\t/**\n\t * Handles export file name input change\n\t *\n\t * @param {object} oEvent - event\n\t */\n\tprivate onFileNameInputChange(oEvent: Input$LiveChangeEvent): void {\n\t\tconst sInputValue: string | undefined = oEvent.getParameter(\"value\")?.trim();\n\t\tconst oInput = oEvent.getSource();\n\t\tlet sValueState = ValueState.None; // Initialize with ValueState.None\n\t\tlet sValueStateText = \"\";\n\n\t\t// Validate based on constraints provided at input\n\t\tif (!sInputValue || !sInputValue.length) {\n\t\t\tsValueState = ValueState.Error;\n\t\t\tsValueStateText = String(this._i18nBundle.getText(\"invalidExportFileName\"));\n\t\t}\n\n\t\t//update value state\n\t\toInput.setValueState(sValueState);\n\t\toInput.setValueStateText(sValueStateText);\n\t\tthis.oControlModel.setProperty(\"/export/fileName\", sInputValue);\n\t\tthis.enableDisableActions(ImportExportType.EXPORT);\n\t}\n\n\tprivate onResetImportApps(): void {\n\t\tthis.oEventBus.publish(\"importChannel\", \"resetImported\");\n\t\tMessageToast.show(this._i18nBundle.getText(\"importAppsNowBtnEnabled\") as string);\n\t}\n\n\t/**\n\t * Generates the recommendation settings panel\n\t * @returns {Panel} recommendation settings panel\n\t * @private\n\t */\n\tprivate async _getRecommendationSettingsPanel() {\n\t\tconst persData = await this._getPersonalizationData();\n\t\tif (!this._recommendationSettingsPanel) {\n\t\t\tconst panelId = this.getId() + \"--recommendationSettingsPanel\";\n\t\t\tthis._recommendationSettingsPanel = new Panel(panelId, {\n\t\t\t\theaderToolbar: new OverflowToolbar(this.getId() + \"--idRecommenedPanelToolbar\", {\n\t\t\t\t\tcontent: [\n\t\t\t\t\t\tnew Title({\n\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"recommendationSettingsHeader\"),\n\t\t\t\t\t\t\tlevel: \"H3\"\n\t\t\t\t\t\t})\n\t\t\t\t\t]\n\t\t\t\t}),\n\t\t\t\texpanded: true,\n\t\t\t\texpandable: true,\n\t\t\t\tcontent: [\n\t\t\t\t\tnew Text({\n\t\t\t\t\t\tid: `${panelId}-container-subHeader`,\n\t\t\t\t\t\ttext: this._i18nBundle.getText(\"recommendationSettingsSubHeader\")\n\t\t\t\t\t}),\n\t\t\t\t\tnew HBox({\n\t\t\t\t\t\tid: `${panelId}-container`,\n\t\t\t\t\t\titems: [\n\t\t\t\t\t\t\tnew CheckBox({\n\t\t\t\t\t\t\t\tid: `${panelId}-container-checkBox`,\n\t\t\t\t\t\t\t\tselected: persData.showRecommendation ?? true,\n\t\t\t\t\t\t\t\tselect: (event) => this.onRecommendationSettingChange(event),\n\t\t\t\t\t\t\t\tariaLabelledBy: [`${panelId}-container-subHeader`, `${panelId}-container-label`]\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tnew Text({\n\t\t\t\t\t\t\t\tid: `${panelId}-container-label`,\n\t\t\t\t\t\t\t\ttext: this._i18nBundle.getText(\"recommendationSettingsCheckboxLabel\")\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t],\n\t\t\t\t\t\talignItems: FlexAlignItems.Center\n\t\t\t\t\t}).addStyleClass(\"sapUiSmallMarginTop\")\n\t\t\t\t]\n\t\t\t}).addStyleClass(\"sapUiSmallMarginTop\");\n\t\t}\n\t\treturn this._recommendationSettingsPanel;\n\t}\n\n\t/**\n\t * Adds recommendation settings panel to the content vbox, if recommendation feature is enabled\n\t * @returns {Promise<void>}\n\t * @private\n\t */\n\tprivate async _setRecommendationSettingsPanel() {\n\t\tthis.oDetailPage.setBusy(true);\n\t\tconst recommendationSettingsPanel = await this._getRecommendationSettingsPanel();\n\t\tif (recommendationSettingsPanel) {\n\t\t\tthis.oContentVBox.addItem(recommendationSettingsPanel);\n\t\t\tthis.oDetailPage.setBusy(false);\n\t\t}\n\t}\n\n\t/**\n\t * Handles recommendation setting change\n\t *\n\t * @param {CheckBox$SelectEvent} event - checkbox select event\n\t * @private\n\t */\n\tprivate async onRecommendationSettingChange(event: CheckBox$SelectEvent) {\n\t\tconst showRecommendation = event.getParameter(\"selected\");\n\t\tthis.oEventBus.publish(\"importChannel\", \"recommendationSettingChanged\", { showRecommendation });\n\t\tconst oPersData = await this._getPersonalizationData();\n\t\tvoid this.oPersonalizerInstance.write({ ...oPersData, showRecommendation });\n\t}\n}\n"],"mappings":"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","ignoreList":[]}