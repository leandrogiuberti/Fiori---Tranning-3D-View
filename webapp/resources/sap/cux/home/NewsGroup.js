/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/m/Button","sap/m/CustomListItem","sap/m/Dialog","sap/m/HBox","sap/m/Image","sap/m/Label","sap/m/library","sap/m/Link","sap/m/List","sap/m/ObjectStatus","sap/m/Text","sap/m/Title","sap/m/VBox","sap/ui/core/CustomData","sap/ui/core/Element","sap/ui/core/HTML","sap/ui/core/Icon","sap/ui/core/library","./BaseNewsItem","./library","./NewsItem","./utils/DataFormatUtils","./utils/FESRUtil"],function(e,t,s,i,n,o,a,l,r,d,u,c,w,g,p,h,m,I,N,y,x,T,$){"use strict";function f(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const D=a["FlexAlignItems"];const S=a["FlexRendertype"];const L=a["Priority"];const C=I["TitleLevel"];const b=f(N);const B=y["NewsType"];const G=f(x);const _=T["recycleId"];const P=$["addFESRSemanticStepName"];const F=$["FESR_EVENTS"];const v=b.extend("sap.cux.home.NewsGroup",{metadata:{library:"sap.cux.home",aggregations:{newsItems:{type:"sap.cux.home.NewsItem",singularName:"newsItem",multiple:true}}},constructor:function e(t,s){b.prototype.constructor.call(this,t,s)},init:function e(){b.prototype.init.call(this);this._oTile.attachPress(this,this.pressNewsItem.bind(this));this.createNewsGroupDialog()},pressNewsItem:function e(t){const s=t.getSource();if(!s.getProperty("pressEnabled")){return}void this.openNewsGroupDialog()},openNewsGroupDialog:function e(){try{const t=this;function s(){t.oNewsGroupDialog?.setTitle(t.getTitle());t.oNewsGroupImage?.setSrc(r);t.loadNewsDetails(u);t.oNewsList?.setBusy(false)}t.oNewsList?.setBusy(true);const i=t.getParent();const n=i.getProperty("customFileName");const o=n.split(".").pop()?.toLowerCase()==="csv";const a=i.getParent().getIsEndUserChange();const l=a.newsType||i.getProperty("type");const r=t.getImageUrl();const d=i.getPersDataNewsFeed();let u=[];let c;const w=i.getUrl();let g=l===B.Default;const p=function(){if(!g){const e={changeId:i.getCustomFeedKey(),title:t.getTitle(),showAllPreparationRequired:o?false:!d?true:d.showAllPreparationRequired};t.oNewsGroupDialog?.open();const s=a.isEndUser?w:i.getNewsFeedDetailsUrl(e);return Promise.resolve(i.getAuthNewsFeed(s,e.title)).then(function(e){u=e})}else{t.criticalStatus.setVisible(t.getPriority()===L.Medium);t.oNewsGroupDialog?.open();t.currentDefaultGroup=i.getCurrentNewsGroup(t.getId());u=t.currentDefaultGroup?._group_to_article||[];c=t.currentDefaultGroup?._group_to_image;if(c?.image_alt_text){t.oNewsGroupImage?.setAlt(c.image_alt_text)}}}();return Promise.resolve(p&&p.then?p.then(s):s(p))}catch(h){return Promise.reject(h)}},loadNewsDetails:function e(t){this.clearExistingNewsItems();const s=this.getParent();const i=s?.getNewsType()===B.Default;(t||[]).forEach((e,t)=>{const s=new G(_(`${this.getId()}--newsItem--${t}`),{title:i?e.title:e.Title.value,subTitle:i?e.subTitle:e.Description.value,footer:i?e.footer_text:"",imageUrl:i?this.getImageUrl():"",priority:i&&e.priority=="1"?L.Medium:L.None,priorityText:i&&e.priority=="1"?this._i18nBundle.getText("criticalNews"):""});this.addAggregation("newsItems",s);this.oNewsList?.addItem(this.generateNewsListTemplate(e,t))})},clearExistingNewsItems:function e(){this.oNewsList?.destroyAggregation("items",true);this.destroyAggregation("newsItems",true)},generateNewsListTemplate:function s(n,a){const r=this.getParent();const d=r?.getNewsType()===B.Default;if(!d){const s=new w(_(this.getId()+"--idNewsFieldsBox"+"--"+a)).addStyleClass("newsListItemContainer");(n?.expandFields||[]).forEach((e,t)=>{s.addItem(new i(_(this.getId()+"--idNewsFieldHBox--"+t),{items:[new o(_(this.getId()+"--idNewsFieldsLabel--"+t),{text:e.label+":",tooltip:e.label}),new u(_(this.getId()+"--idNewsFieldsValue--"+t),{text:e.value})]}).addStyleClass("newsListItemContainer"))});s.setVisible(false);const r=this._i18nBundle.getText("expand");const d=new e(`${this.getId()}--expand--${a}`,{text:r,press:this.handleShowNewsFeedDetails.bind(this),customData:new g({key:"index",value:a})});P(d,F.PRESS,r);return new t(_(`${this.getId()}--idNewsDetailItem--${a}`),{content:[new w(_(`${this.getId()}--newsList--${a}`),{items:[new c(_(`${this.getId()}--newsTitle--${a}`),{text:n.Title.value,titleStyle:"H6"}),new u(_(`${this.getId()}--newsText--${a}`),{text:n.Description.value}),new i(_(`${this.getId()}--newsHBox--${a}`),{items:[new o(_(`${this.getId()}--newsLabel--${a}`),{text:n.Type.label+":",tooltip:n.Type.label}),new u(_(`${this.getId()}--newsItemText--${a}`),{text:n.Type.value})]}).addStyleClass("newsListItemContainer"),new i(_(`${this.getId()}--newsListItemBox--${a}`),{items:[new o(_(`${this.getId()}--newsListItemLabel--${a}`),{text:this._i18nBundle.getText("readMoreLink")+":",tooltip:n.Link.value.label+""}),new l(_(`${this.getId()}--newsListItemLink--${a}`),{href:n.Link.value.value+"",text:n.Link.text,target:"_blank"})]}).addStyleClass("newsListItemContainer"),s,d]}).addStyleClass("newsListItemContainer")]}).addStyleClass("newsListItem")}else{return new t(_(`${this.getId()}--idDefaultNewsDetailItem--${a}`),{content:[new w(_(`${this.getId()}--defaultNewsItemVbox--${a}`),{renderType:S.Bare,items:[new i(_(`${this.getId()}--defaultNewsItemTitle--${a}`),{alignItems:D.Center,renderType:S.Bare,items:[new m(_(`${this.getId()}--newsPriorityIcon--${a}`),{src:"sap-icon://high-priority",width:"1rem",height:"1rem",size:"1rem",visible:n.priority==="1",tooltip:this._i18nBundle.getText("criticalNewsIcon")}).addStyleClass("newsCriticalIconColor"),new c(_(`${this.getId()}--newsTitle--${a}`),{text:n.title,titleStyle:C.H5})]}).addStyleClass("newsListItemContainer"),new c(_(`${this.getId()}--newsSubTitle--${a}`),{text:n.subTitle,visible:!!n.subTitle,titleStyle:C.H6}),new h(_(`${this.getId()}--defaultNewsItemHTML--${a}`),{content:`<div class="newsGroupHtmlContent">${n.description}</div>`})]}).addStyleClass("newsListItemContainer")]}).addStyleClass("newsListItem")}},createNewsGroupDialog:function t(){if(!this.oNewsGroupDialog){this.oNewsGroupImage=new n(_(`${this.getId()}-custNewsImage`),{width:"100%",height:"100%",src:"/resources/sap/cux/home/img/CustomNewsFeed/SupplyChain/3.jpg"}).addStyleClass("newsGroupDialogImage");this.oNewsList=new r(_(`${this.getId()}-custNewsList`)).addStyleClass("sapUiSmallMarginBottom");this.criticalStatus=new d(_(`${this.getId()}-newsDialogCriticalStatus`),{visible:false,text:this._i18nBundle.getText("criticalNews"),inverted:true,icon:"sap-icon://high-priority",state:"Warning"}).addStyleClass("newsGroupDialogPriorityStatus");let t=new w(_(`${this.getId()}-newsDialogPriorityVBox`),{renderType:S.Bare,height:"15rem",items:[this.oNewsGroupImage,this.criticalStatus]}).addStyleClass("newsDialogPriorityVBox");const i=new e(_(`${this.getId()}-custNewsFeedDetailsCloseBtn`),{text:this._i18nBundle.getText("XBUT_CLOSE"),press:this.closeNewsGroupDialog.bind(this),type:"Transparent"});P(i,F.PRESS,"newsDlgCloseBtn");this.oNewsGroupDialog=new s(_(`${this.getId()}-custNewsFeedDetailsDialog`),{title:this.getTitle()||"",contentWidth:"52rem",contentHeight:"calc(100% - 2.5rem)",content:[t,this.oNewsList],buttons:[i]});this.addDependent(this.oNewsGroupDialog)}},closeNewsGroupDialog:function e(){this.oNewsGroupDialog?.close()},handleShowNewsFeedDetails:function e(t){const s=t.getSource();const i=s.data("index");const n=p.getElementById(this.getId()+"--idNewsFieldsBox"+"--"+i);const o=n.getVisible();n.setVisible(!o);const a=o?this._i18nBundle.getText("expand"):this._i18nBundle.getText("collapse");s.setText(a);P(s,F.PRESS,a)}});return v});
//# sourceMappingURL=NewsGroup.js.map