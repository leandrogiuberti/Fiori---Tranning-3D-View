/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
sap.ui.define(["sap/m/List","sap/m/Page","sap/m/StandardListItem","sap/m/VBox","sap/ui/core/Element","sap/ui/core/EventBus","./BaseSettingsPanel","./flexibility/Layout.flexibility","./KeyUserNewsSettingsPanel","./KeyUserPagesSettingsPanel","./NewsPanel","./PagePanel","./utils/Constants","./utils/DataFormatUtils"],function(e,t,s,i,n,a,g,o,h,l,r,d,c,S){"use strict";function w(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}function P(e,t){try{var s=e()}catch(e){return t(e)}if(s&&s.then){return s.then(void 0,t)}return s}const p=w(g);const u=o["CHANGE_TYPES"];const f=w(h);const y=w(l);const I=w(r);const N=w(d);const m=c["KEYUSER_SETTINGS_PANELS_KEYS"];const b=S["recycleId"];const L=p.extend("sap.cux.home.KeyUserNewsPagesSettingsPanel",{metadata:{library:"sap.cux.home"},init:function e(){p.prototype.init.call(this);this.setProperty("key",m.NEWS_PAGES);this.setProperty("title",this._i18nBundle.getText("editNewsPages"));this._eventBus=a.getInstance();this._eventBus.subscribe("KeyUserChanges","addNewsPagesChanges",(e,t,s)=>{const{changes:i}=s;this.addNewsPagesChanges(i)},this);this.addAggregation("content",this.getContent());this.attachPanelNavigated(()=>this.loadSettings())},getContent:function e(){if(!this.wrapperVBox){this.wrapperVBox=new i(`${this.getId()}-wrapperVBox`)}return this.wrapperVBox},loadSettings:function e(){const t=this.getPanel();const s=n.getElementById(t);const i=s?.getParent();i.getContent()?.forEach(e=>{if(e instanceof I){this.newsPanel=e;this.wrapperVBox.addItem(this.getNewsSettingsList(e))}if(e instanceof N){this.pagePanel=e;this.wrapperVBox.addItem(this.getPageSettingsList(e))}})},newsVisibilityChangeHandler:function e(t){const s=t.getParameter("listItem");this.newsFeedVisibility=s?.getSelected();const i=this._getPanel();const n=i.getParent();const a=n.getParent();const g=this.getKeyUserChanges();const o=g.find(e=>e.changeSpecificData.changeType===u.NEWS_FEED_VISIBILITY);if(!this.newsFeedVisibility&&this.newsSettingsPanel){this.newsSettingsPanel.removeUrlMesageStrip()}if(!o){this.addKeyUserChanges({selectorControl:a,changeSpecificData:{changeType:u.NEWS_FEED_VISIBILITY,content:{isNewsFeedVisible:this.newsFeedVisibility}}})}else if(o.changeSpecificData.content.isNewsFeedVisible!==this.newsFeedVisibility){o.changeSpecificData.content.isNewsFeedVisible=this.newsFeedVisibility}},getNewsSettingsList:function t(i){const n=this._getPanel();const a=n.getParent();if(!this.newsSettingsList){this.newsSettingsList=new e(`${this.getId()}-news-settings-list`,{selectionChange:this.newsVisibilityChangeHandler.bind(this),mode:"MultiSelect"});this.standardListItem=new s(`${this.getId()}-newsSettingsStandardListItem`,{selected:n.getVisible(),press:this.navigateToNewsSettingsPage.bind(this),type:a.getIsEndUserChange().isEndUser?"Inactive":"Navigation",title:this._i18nBundle.getText("newsFeed")});this.newsSettingsList.addItem(this.standardListItem);this.newsSettingsList.setAssociation("panel",i)}else{if(this.newsFeedVisibility===undefined){this.standardListItem.setSelected(Boolean(n.getParent()?.getProperty("newsFeedVisibility"))&&Boolean(n.getProperty("newsAvailable")))}else{this.standardListItem.setSelected(this.newsFeedVisibility)}}return this.newsSettingsList},getPageSettingsList:function t(i){if(!this.pageSettingsList){this.pageSettingsList=new e(`${this.getId()}-page-settings-list`,{mode:"None",items:[new s(`${this.getId()}-pageSettingsList`,{selected:true,press:this.openPageSettingsDialog.bind(this),type:"Navigation",title:this._i18nBundle.getText("pageGroupHeader")})]});this.pageSettingsList.setAssociation("panel",i)}return this.pageSettingsList},onNavBack:function e(t){t?.back();if(!this.standardListItem.getSelected()){this.newsSettingsPanel?.removeUrlMesageStrip()}},navigateToNewsSettingsPage:function e(){const s=this.getParent()?.getNavContainer?.();if(!this.newsSettingsPage){this.newsSettingsPanel=new f(b(`${this.getId()}--news-settings-panel`));this.newsSettingsPanel.setAssociation("panel",this.newsPanel);this.newsSettingsPage=new t(`${this.getId()}-news-settings-page`,{title:this.newsSettingsPanel.getProperty("title"),showHeader:true,content:this.newsSettingsPanel.getAggregation("content"),backgroundDesign:"Transparent",showNavButton:true,navButtonPress:this.onNavBack.bind(this,s)})}s?.addPage(this.newsSettingsPage);s?.to(this.newsSettingsPage);this.newsSettingsPanel.firePanelNavigated()},openPageSettingsDialog:function e(){if(!this.pageSettingsPanel){this.pageSettingsPanel=new y(`${this.getId()}--pages-settings-panel`);this.pageSettingsPanel.setAssociation("panel",this.pagePanel);this.pageSettingsDialog=this.pageSettingsPanel.getAggregation("content")?.[0]}this.pageSettingsDialog?.open();this.pageSettingsPanel?.firePanelNavigated()},addNewsPagesChanges:function e(t){t.forEach(e=>{this.addKeyUserChanges(e)})},isNewsChangesValid:function e(){const t=this;return Promise.resolve(P(function(){return Promise.resolve(t.newsSettingsPanel?.isValidChanges(t.standardListItem.getSelected()))},function(){return true}))},onSaveClearChanges:function e(){this.newsFeedVisibility=undefined;this.newsSettingsPanel?.clearKeyUserChanges()},onCancelClearKeyUserChanges:function e(){const t=this._getPanel();this.newsFeedVisibility=undefined;this.standardListItem?.setSelected(t.getVisible());this.newsSettingsPanel?.clearNewsPanelChanges()}});return L});
//# sourceMappingURL=KeyUserNewsPagesSettingsPanel.js.map