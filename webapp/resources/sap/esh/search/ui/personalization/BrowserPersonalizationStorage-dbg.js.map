{"version":3,"file":"BrowserPersonalizationStorage-dbg.js","names":["sap","ui","define","Storage","___error_errors","Log","ESHUIError","BrowserPersonalizationStorage","create","prefix","Promise","resolve","storage","_oLogger","getLogger","constructor","type","debug","isSupported","Error","isStorageOfPersonalDataAllowed","save","getItem","key","get","setItem","data","JSON","stringify","put","err","serializationError","previous","error","message","deleteItem","remove"],"sources":["BrowserPersonalizationStorage.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport Storage from \"sap/ui/util/Storage\";\nimport { IKeyValueStore } from \"./PersonalizationStorage\";\nimport { ESHUIError } from \"../error/errors\";\nimport Log from \"sap/base/Log\";\n\nexport default class BrowserPersonalizationStorage implements IKeyValueStore {\n    static async create(prefix: string): Promise<BrowserPersonalizationStorage> {\n        return Promise.resolve(new BrowserPersonalizationStorage(prefix));\n    }\n\n    private storage: Storage;\n    private _oLogger = Log.getLogger(\"sap.esh.search.ui.personalization.BrowserPersonalizationStorage\");\n\n    constructor(\n        private prefix = \"default\",\n        type: \"local\" | \"session\" = \"local\"\n    ) {\n        this.prefix = prefix + \".Search.Personalization.\";\n        this._oLogger.debug(\"Using BrowserPersonalizationStorage with prefix: \" + this.prefix);\n        this.storage = new Storage(type);\n        if (!this.storage.isSupported()) {\n            throw new Error(`Storage of type ${type} is not supported by UI5 in this environment`);\n        }\n    }\n    isStorageOfPersonalDataAllowed(): boolean {\n        return true;\n    }\n\n    save(): Promise<unknown> {\n        return Promise.resolve();\n    }\n\n    getItem(key: string): unknown {\n        this._oLogger.debug(\"getItem: \" + this.prefix + key);\n        return this.storage.get(this.prefix + key);\n    }\n\n    setItem(key: string, data: unknown): boolean {\n        this._oLogger.debug(\"setItem: \" + this.prefix + key);\n        // officially this store only accepts data which can be serialized using JSON.stringify, see\n        // https://sapui5.hana.ondemand.com/#/api/module:sap/ui/util/Storage\n        try {\n            JSON.stringify(data);\n            return this.storage.put(this.prefix + key, data as string);\n        } catch (err) {\n            const serializationError = new ESHUIError(\"data with key '\" + key + \"' is not serializable\");\n            serializationError.previous = err;\n            this._oLogger.error(serializationError.message);\n        }\n    }\n\n    deleteItem(key: string): void {\n        this._oLogger.debug(\"deleteItem: \" + this.prefix + key);\n        this.storage.remove(this.prefix + key);\n    }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AAJAA,GAAA,CAAAC,EAAA,CAAAC,MAAA,uEAAAC,OAAA,EAAAC,eAAA,EAAAC,GAAA;EAAA;;EAAA,MAOSC,UAAU,GAAAF,eAAA;EAGJ,MAAMG,6BAA6B,CAA2B;IACzE,aAAaC,MAAMA,CAACC,MAAc,EAA0C;MACxE,OAAOC,OAAO,CAACC,OAAO,CAAC,IAAIJ,6BAA6B,CAACE,MAAM,CAAC,CAAC;IACrE;IAEQG,OAAO;IACPC,QAAQ,GAAGR,GAAG,CAACS,SAAS,CAAC,iEAAiE,CAAC;IAEnGC,WAAWA,CACCN,MAAM,GAAG,SAAS,EAC1BO,IAAyB,GAAG,OAAO,EACrC;MAAA,KAFUP,MAAM,GAANA,MAAM;MAGd,IAAI,CAACA,MAAM,GAAGA,MAAM,GAAG,0BAA0B;MACjD,IAAI,CAACI,QAAQ,CAACI,KAAK,CAAC,mDAAmD,GAAG,IAAI,CAACR,MAAM,CAAC;MACtF,IAAI,CAACG,OAAO,GAAG,IAAIT,OAAO,CAACa,IAAI,CAAC;MAChC,IAAI,CAAC,IAAI,CAACJ,OAAO,CAACM,WAAW,CAAC,CAAC,EAAE;QAC7B,MAAM,IAAIC,KAAK,CAAC,mBAAmBH,IAAI,8CAA8C,CAAC;MAC1F;IACJ;IACAI,8BAA8BA,CAAA,EAAY;MACtC,OAAO,IAAI;IACf;IAEAC,IAAIA,CAAA,EAAqB;MACrB,OAAOX,OAAO,CAACC,OAAO,CAAC,CAAC;IAC5B;IAEAW,OAAOA,CAACC,GAAW,EAAW;MAC1B,IAAI,CAACV,QAAQ,CAACI,KAAK,CAAC,WAAW,GAAG,IAAI,CAACR,MAAM,GAAGc,GAAG,CAAC;MACpD,OAAO,IAAI,CAACX,OAAO,CAACY,GAAG,CAAC,IAAI,CAACf,MAAM,GAAGc,GAAG,CAAC;IAC9C;IAEAE,OAAOA,CAACF,GAAW,EAAEG,IAAa,EAAW;MACzC,IAAI,CAACb,QAAQ,CAACI,KAAK,CAAC,WAAW,GAAG,IAAI,CAACR,MAAM,GAAGc,GAAG,CAAC;MACpD;MACA;MACA,IAAI;QACAI,IAAI,CAACC,SAAS,CAACF,IAAI,CAAC;QACpB,OAAO,IAAI,CAACd,OAAO,CAACiB,GAAG,CAAC,IAAI,CAACpB,MAAM,GAAGc,GAAG,EAAEG,IAAc,CAAC;MAC9D,CAAC,CAAC,OAAOI,GAAG,EAAE;QACV,MAAMC,kBAAkB,GAAG,IAAIzB,UAAU,CAAC,iBAAiB,GAAGiB,GAAG,GAAG,uBAAuB,CAAC;QAC5FQ,kBAAkB,CAACC,QAAQ,GAAGF,GAAG;QACjC,IAAI,CAACjB,QAAQ,CAACoB,KAAK,CAACF,kBAAkB,CAACG,OAAO,CAAC;MACnD;IACJ;IAEAC,UAAUA,CAACZ,GAAW,EAAQ;MAC1B,IAAI,CAACV,QAAQ,CAACI,KAAK,CAAC,cAAc,GAAG,IAAI,CAACR,MAAM,GAAGc,GAAG,CAAC;MACvD,IAAI,CAACX,OAAO,CAACwB,MAAM,CAAC,IAAI,CAAC3B,MAAM,GAAGc,GAAG,CAAC;IAC1C;EACJ;EAAC,OAAAhB,6BAAA;AAAA","ignoreList":[]}