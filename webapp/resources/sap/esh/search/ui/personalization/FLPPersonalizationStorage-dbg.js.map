{"version":3,"file":"FLPPersonalizationStorage-dbg.js","names":["sap","ui","define","Container","FLPPersonalizationStorage","create","service","getServiceAsync","container","getContainer","validity","Infinity","eshIsStorageOfPersonalDataAllowedKey","constructor","deletePersonalData","setIsStorageOfPersonalDataAllowed","isAllowed","setItem","isStorageOfPersonalDataAllowed","getItem","save","key","limitLength","getItemValue","data","oldData","JSON","stringify","setItemValue","deleteItem","slice"],"sources":["FLPPersonalizationStorage.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport ContextContainer from \"sap/ushell/services/PersonalizationV2/ContextContainer\";\nimport { IKeyValueStore } from \"./PersonalizationStorage\";\nimport Container from \"sap/ushell/Container\";\nimport PersonalizationV2 from \"sap/ushell/services/PersonalizationV2\";\n\nexport default class FLPPersonalizationStorage implements IKeyValueStore {\n    static async create(): Promise<FLPPersonalizationStorage> {\n        const service = (await Container.getServiceAsync(\"PersonalizationV2\")) as PersonalizationV2;\n        const container = await service.getContainer(\n            \"ushellSearchPersoServiceContainer\",\n            { validity: Infinity }, // store data forever\n            null\n        );\n        return new FLPPersonalizationStorage(container);\n    }\n\n    private readonly eshIsStorageOfPersonalDataAllowedKey = \"ESH-IsStorageOfPersonalDataAllowed\";\n\n    constructor(readonly container: ContextContainer) {}\n\n    async deletePersonalData(): Promise<void> {\n        //\n    }\n\n    setIsStorageOfPersonalDataAllowed(isAllowed: boolean): void {\n        this.setItem(this.eshIsStorageOfPersonalDataAllowedKey, isAllowed);\n    }\n\n    isStorageOfPersonalDataAllowed(): boolean {\n        const isAllowed = this.getItem(this.eshIsStorageOfPersonalDataAllowedKey);\n        if (typeof isAllowed === \"boolean\") {\n            return isAllowed;\n        }\n        return true;\n    }\n\n    save(): Promise<unknown> {\n        return this.container.save(0);\n    }\n\n    getItem(key: string): unknown {\n        key = this.limitLength(key);\n        return this.container.getItemValue(key);\n    }\n\n    setItem(key: string, data: unknown): boolean {\n        key = this.limitLength(key);\n        const oldData = this.getItem(key);\n        if (JSON.stringify(oldData) === JSON.stringify(data)) {\n            return true;\n        }\n        this.container.setItemValue(key, data as object);\n        this.save();\n        return true;\n    }\n\n    deleteItem(key: string): void {\n        this.container.deleteItem(key);\n    }\n\n    private limitLength(key: string): string {\n        return key.slice(-40);\n    }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AAJAA,GAAA,CAAAC,EAAA,CAAAC,MAAA,qCAAAC,SAAA;EAAA;;EAUe,MAAMC,yBAAyB,CAA2B;IACrE,aAAaC,MAAMA,CAAA,EAAuC;MACtD,MAAMC,OAAO,GAAI,MAAMH,SAAS,CAACI,eAAe,CAAC,mBAAmB,CAAuB;MAC3F,MAAMC,SAAS,GAAG,MAAMF,OAAO,CAACG,YAAY,CACxC,mCAAmC,EACnC;QAAEC,QAAQ,EAAEC;MAAS,CAAC;MAAE;MACxB,IACJ,CAAC;MACD,OAAO,IAAIP,yBAAyB,CAACI,SAAS,CAAC;IACnD;IAEiBI,oCAAoC,GAAG,oCAAoC;IAE5FC,WAAWA,CAAUL,SAA2B,EAAE;MAAA,KAA7BA,SAA2B,GAA3BA,SAA2B;IAAG;IAEnD,MAAMM,kBAAkBA,CAAA,EAAkB;MACtC;IAAA;IAGJC,iCAAiCA,CAACC,SAAkB,EAAQ;MACxD,IAAI,CAACC,OAAO,CAAC,IAAI,CAACL,oCAAoC,EAAEI,SAAS,CAAC;IACtE;IAEAE,8BAA8BA,CAAA,EAAY;MACtC,MAAMF,SAAS,GAAG,IAAI,CAACG,OAAO,CAAC,IAAI,CAACP,oCAAoC,CAAC;MACzE,IAAI,OAAOI,SAAS,KAAK,SAAS,EAAE;QAChC,OAAOA,SAAS;MACpB;MACA,OAAO,IAAI;IACf;IAEAI,IAAIA,CAAA,EAAqB;MACrB,OAAO,IAAI,CAACZ,SAAS,CAACY,IAAI,CAAC,CAAC,CAAC;IACjC;IAEAD,OAAOA,CAACE,GAAW,EAAW;MAC1BA,GAAG,GAAG,IAAI,CAACC,WAAW,CAACD,GAAG,CAAC;MAC3B,OAAO,IAAI,CAACb,SAAS,CAACe,YAAY,CAACF,GAAG,CAAC;IAC3C;IAEAJ,OAAOA,CAACI,GAAW,EAAEG,IAAa,EAAW;MACzCH,GAAG,GAAG,IAAI,CAACC,WAAW,CAACD,GAAG,CAAC;MAC3B,MAAMI,OAAO,GAAG,IAAI,CAACN,OAAO,CAACE,GAAG,CAAC;MACjC,IAAIK,IAAI,CAACC,SAAS,CAACF,OAAO,CAAC,KAAKC,IAAI,CAACC,SAAS,CAACH,IAAI,CAAC,EAAE;QAClD,OAAO,IAAI;MACf;MACA,IAAI,CAAChB,SAAS,CAACoB,YAAY,CAACP,GAAG,EAAEG,IAAc,CAAC;MAChD,IAAI,CAACJ,IAAI,CAAC,CAAC;MACX,OAAO,IAAI;IACf;IAEAS,UAAUA,CAACR,GAAW,EAAQ;MAC1B,IAAI,CAACb,SAAS,CAACqB,UAAU,CAACR,GAAG,CAAC;IAClC;IAEQC,WAAWA,CAACD,GAAW,EAAU;MACrC,OAAOA,GAAG,CAACS,KAAK,CAAC,CAAC,EAAE,CAAC;IACzB;EACJ;EAAC,OAAA1B,yBAAA;AAAA","ignoreList":[]}