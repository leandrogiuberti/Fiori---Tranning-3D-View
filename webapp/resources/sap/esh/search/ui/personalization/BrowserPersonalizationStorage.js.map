{"version":3,"file":"BrowserPersonalizationStorage.js","names":["sap","ui","define","Storage","___error_errors","Log","ESHUIError","BrowserPersonalizationStorage","create","prefix","Promise","resolve","storage","_oLogger","getLogger","constructor","type","this","debug","isSupported","Error","isStorageOfPersonalDataAllowed","save","getItem","key","get","setItem","data","JSON","stringify","put","err","serializationError","previous","error","message","deleteItem","remove"],"sources":["BrowserPersonalizationStorage.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport Storage from \"sap/ui/util/Storage\";\nimport { IKeyValueStore } from \"./PersonalizationStorage\";\nimport { ESHUIError } from \"../error/errors\";\nimport Log from \"sap/base/Log\";\n\nexport default class BrowserPersonalizationStorage implements IKeyValueStore {\n    static async create(prefix: string): Promise<BrowserPersonalizationStorage> {\n        return Promise.resolve(new BrowserPersonalizationStorage(prefix));\n    }\n\n    private storage: Storage;\n    private _oLogger = Log.getLogger(\"sap.esh.search.ui.personalization.BrowserPersonalizationStorage\");\n\n    constructor(\n        private prefix = \"default\",\n        type: \"local\" | \"session\" = \"local\"\n    ) {\n        this.prefix = prefix + \".Search.Personalization.\";\n        this._oLogger.debug(\"Using BrowserPersonalizationStorage with prefix: \" + this.prefix);\n        this.storage = new Storage(type);\n        if (!this.storage.isSupported()) {\n            throw new Error(`Storage of type ${type} is not supported by UI5 in this environment`);\n        }\n    }\n    isStorageOfPersonalDataAllowed(): boolean {\n        return true;\n    }\n\n    save(): Promise<unknown> {\n        return Promise.resolve();\n    }\n\n    getItem(key: string): unknown {\n        this._oLogger.debug(\"getItem: \" + this.prefix + key);\n        return this.storage.get(this.prefix + key);\n    }\n\n    setItem(key: string, data: unknown): boolean {\n        this._oLogger.debug(\"setItem: \" + this.prefix + key);\n        // officially this store only accepts data which can be serialized using JSON.stringify, see\n        // https://sapui5.hana.ondemand.com/#/api/module:sap/ui/util/Storage\n        try {\n            JSON.stringify(data);\n            return this.storage.put(this.prefix + key, data as string);\n        } catch (err) {\n            const serializationError = new ESHUIError(\"data with key '\" + key + \"' is not serializable\");\n            serializationError.previous = err;\n            this._oLogger.error(serializationError.message);\n        }\n    }\n\n    deleteItem(key: string): void {\n        this._oLogger.debug(\"deleteItem: \" + this.prefix + key);\n        this.storage.remove(this.prefix + key);\n    }\n}\n"],"mappings":";;;;;AAAAA,IAAAC,GAAAC,OAAA,kEAAAC,EAAAC,EAAAC,GAAA,mBAOSC,EAAUF,EAAA,cAGJ,MAAMG,EACjB,mBAAaC,CAAOC,GAChB,OAAOC,QAAQC,QAAQ,IAAIJ,EAA8BE,GAC7D,CAEQG,QACAC,SAAWR,EAAIS,UAAU,mEAEjCC,YACYN,EAAS,UACjBO,EAA4B,SAC9BC,KAFUR,SAGRQ,KAAKR,OAASA,EAAS,2BACvBQ,KAAKJ,SAASK,MAAM,oDAAsDD,KAAKR,QAC/EQ,KAAKL,QAAU,IAAIT,EAAQa,GAC3B,IAAKC,KAAKL,QAAQO,cAAe,CAC7B,MAAM,IAAIC,MAAM,mBAAmBJ,gDACvC,CACJ,CACAK,iCACI,OAAO,IACX,CAEAC,OACI,OAAOZ,QAAQC,SACnB,CAEAY,QAAQC,GACJP,KAAKJ,SAASK,MAAM,YAAcD,KAAKR,OAASe,GAChD,OAAOP,KAAKL,QAAQa,IAAIR,KAAKR,OAASe,EAC1C,CAEAE,QAAQF,EAAaG,GACjBV,KAAKJ,SAASK,MAAM,YAAcD,KAAKR,OAASe,GAGhD,IACII,KAAKC,UAAUF,GACf,OAAOV,KAAKL,QAAQkB,IAAIb,KAAKR,OAASe,EAAKG,EAC/C,CAAE,MAAOI,GACL,MAAMC,EAAqB,IAAI1B,EAAW,kBAAoBkB,EAAM,yBACpEQ,EAAmBC,SAAWF,EAC9Bd,KAAKJ,SAASqB,MAAMF,EAAmBG,QAC3C,CACJ,CAEAC,WAAWZ,GACPP,KAAKJ,SAASK,MAAM,eAAiBD,KAAKR,OAASe,GACnDP,KAAKL,QAAQyB,OAAOpB,KAAKR,OAASe,EACtC,EACH,OAAAjB,CAAA","ignoreList":[]}