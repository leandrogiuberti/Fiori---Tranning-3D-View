{"version":3,"file":"FLPPersonalizationStorage.js","names":["sap","ui","define","Container","FLPPersonalizationStorage","create","service","getServiceAsync","container","getContainer","validity","Infinity","eshIsStorageOfPersonalDataAllowedKey","constructor","this","deletePersonalData","setIsStorageOfPersonalDataAllowed","isAllowed","setItem","isStorageOfPersonalDataAllowed","getItem","save","key","limitLength","getItemValue","data","oldData","JSON","stringify","setItemValue","deleteItem","slice"],"sources":["FLPPersonalizationStorage.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport ContextContainer from \"sap/ushell/services/PersonalizationV2/ContextContainer\";\nimport { IKeyValueStore } from \"./PersonalizationStorage\";\nimport Container from \"sap/ushell/Container\";\nimport PersonalizationV2 from \"sap/ushell/services/PersonalizationV2\";\n\nexport default class FLPPersonalizationStorage implements IKeyValueStore {\n    static async create(): Promise<FLPPersonalizationStorage> {\n        const service = (await Container.getServiceAsync(\"PersonalizationV2\")) as PersonalizationV2;\n        const container = await service.getContainer(\n            \"ushellSearchPersoServiceContainer\",\n            { validity: Infinity }, // store data forever\n            null\n        );\n        return new FLPPersonalizationStorage(container);\n    }\n\n    private readonly eshIsStorageOfPersonalDataAllowedKey = \"ESH-IsStorageOfPersonalDataAllowed\";\n\n    constructor(readonly container: ContextContainer) {}\n\n    async deletePersonalData(): Promise<void> {\n        //\n    }\n\n    setIsStorageOfPersonalDataAllowed(isAllowed: boolean): void {\n        this.setItem(this.eshIsStorageOfPersonalDataAllowedKey, isAllowed);\n    }\n\n    isStorageOfPersonalDataAllowed(): boolean {\n        const isAllowed = this.getItem(this.eshIsStorageOfPersonalDataAllowedKey);\n        if (typeof isAllowed === \"boolean\") {\n            return isAllowed;\n        }\n        return true;\n    }\n\n    save(): Promise<unknown> {\n        return this.container.save(0);\n    }\n\n    getItem(key: string): unknown {\n        key = this.limitLength(key);\n        return this.container.getItemValue(key);\n    }\n\n    setItem(key: string, data: unknown): boolean {\n        key = this.limitLength(key);\n        const oldData = this.getItem(key);\n        if (JSON.stringify(oldData) === JSON.stringify(data)) {\n            return true;\n        }\n        this.container.setItemValue(key, data as object);\n        this.save();\n        return true;\n    }\n\n    deleteItem(key: string): void {\n        this.container.deleteItem(key);\n    }\n\n    private limitLength(key: string): string {\n        return key.slice(-40);\n    }\n}\n"],"mappings":";;;;;AAAAA,IAAAC,GAAAC,OAAA,kCAAAC,GAAA,aAUe,MAAMC,EACjB,mBAAaC,GACT,MAAMC,QAAiBH,EAAUI,gBAAgB,qBACjD,MAAMC,QAAkBF,EAAQG,aAC5B,oCACA,CAAEC,SAAUC,UACZ,MAEJ,OAAO,IAAIP,EAA0BI,EACzC,CAEiBI,qCAAuC,qCAExDC,YAAqBL,GAA6BM,KAA7BN,WAA8B,CAEnD,wBAAMO,GACF,CAGJC,kCAAkCC,GAC9BH,KAAKI,QAAQJ,KAAKF,qCAAsCK,EAC5D,CAEAE,iCACI,MAAMF,EAAYH,KAAKM,QAAQN,KAAKF,sCACpC,UAAWK,IAAc,UAAW,CAChC,OAAOA,CACX,CACA,OAAO,IACX,CAEAI,OACI,OAAOP,KAAKN,UAAUa,KAAK,EAC/B,CAEAD,QAAQE,GACJA,EAAMR,KAAKS,YAAYD,GACvB,OAAOR,KAAKN,UAAUgB,aAAaF,EACvC,CAEAJ,QAAQI,EAAaG,GACjBH,EAAMR,KAAKS,YAAYD,GACvB,MAAMI,EAAUZ,KAAKM,QAAQE,GAC7B,GAAIK,KAAKC,UAAUF,KAAaC,KAAKC,UAAUH,GAAO,CAClD,OAAO,IACX,CACAX,KAAKN,UAAUqB,aAAaP,EAAKG,GACjCX,KAAKO,OACL,OAAO,IACX,CAEAS,WAAWR,GACPR,KAAKN,UAAUsB,WAAWR,EAC9B,CAEQC,YAAYD,GAChB,OAAOA,EAAIS,OAAO,GACtB,EACH,OAAA3B,CAAA","ignoreList":[]}