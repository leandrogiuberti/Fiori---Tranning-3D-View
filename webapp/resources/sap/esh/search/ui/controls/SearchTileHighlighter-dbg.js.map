{"version":3,"file":"SearchTileHighlighter-dbg.js","names":["sap","ui","define","sap_esh_search_ui_SearchHelper","encodeXml","Hyphenation","Tester","SearchHelper","Highlighter","_softHyphenRegExp","tester","constructor","RegExp","setHighlightTerms","highlightTerms","highlight","tileView","node","getDomRef","oHyphenation","getInstance","isLanguageInitialized","initialize","then","doHighlight","bind","nodeType","window","Node","TEXT_NODE","highlightTextNode","i","childNodes","length","child","removeSoftHyphens","text","replace","testResult","test","textContent","bMatch","spanNode","document","createElement","innerHTML","sHighlightedText","boldTagUnescaper","parentNode","insertBefore","removeChild","__exports","__esModule"],"sources":["SearchTileHighlighter.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport { Tester } from \"sap/esh/search/ui/SearchHelper\";\nimport * as SearchHelper from \"sap/esh/search/ui/SearchHelper\";\nimport Control from \"sap/ui/core/Control\";\nimport encodeXml from \"sap/base/security/encodeXML\";\nimport Hyphenation from \"sap/ui/core/hyphenation/Hyphenation\";\n\n/**\n * @namespace sap.esh.search.ui.controls\n */\nexport class Highlighter {\n    private _softHyphenRegExp: RegExp;\n    tester: Tester;\n\n    constructor() {\n        this._softHyphenRegExp = new RegExp(\"[\\u00ad]\", \"g\");\n    }\n\n    setHighlightTerms(highlightTerms: string): void {\n        this.tester = new Tester(highlightTerms, \"sapUshellSearchHighlight\", true, \"or\");\n    }\n\n    highlight(tileView: Control): void {\n        const node = tileView.getDomRef();\n        if (!node) {\n            return;\n        }\n        const oHyphenation = Hyphenation.getInstance();\n        if (!oHyphenation.isLanguageInitialized()) {\n            oHyphenation.initialize().then(\n                function () {\n                    this.doHighlight(node);\n                }.bind(this),\n                function () {\n                    this.doHighlight(node);\n                }.bind(this)\n            );\n        } else {\n            this.doHighlight(node);\n        }\n    }\n\n    doHighlight(node: Element | ChildNode): HTMLElement {\n        if (node.nodeType === window.Node.TEXT_NODE) {\n            this.highlightTextNode(node);\n            return;\n        }\n        for (let i = 0; i < node.childNodes.length; ++i) {\n            const child = node.childNodes[i];\n            this.doHighlight(child);\n        }\n    }\n\n    removeSoftHyphens(text: string): string {\n        return text.replace(this._softHyphenRegExp, \"\");\n    }\n\n    highlightTextNode(node: Element | ChildNode): HTMLElement {\n        // check for match\n        const testResult = this.tester.test(this.removeSoftHyphens(node.textContent));\n        if (!testResult.bMatch) {\n            return;\n        }\n        // match -> replace dom node\n        const spanNode = document.createElement(\"span\");\n        spanNode.innerHTML = encodeXml(testResult.sHighlightedText);\n        SearchHelper.boldTagUnescaper(spanNode, \"sapUshellSearchHighlight\");\n        node.parentNode.insertBefore(spanNode, node);\n        node.parentNode.removeChild(node);\n    }\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AAJAA,GAAA,CAAAC,EAAA,CAAAC,MAAA,qHAAAC,8BAAA,EAAAC,SAAA,EAAAC,WAAA;EAAA;;EAAA,MAKSC,MAAM,GAAAH,8BAAA;EAAA,MACHI,YAAY,GAAAJ,8BAAA;EAKxB;AACA;AACA;EACO,MAAMK,WAAW,CAAC;IACbC,iBAAiB;IACzBC,MAAM;IAENC,WAAWA,CAAA,EAAG;MACV,IAAI,CAACF,iBAAiB,GAAG,IAAIG,MAAM,CAAC,UAAU,EAAE,GAAG,CAAC;IACxD;IAEAC,iBAAiBA,CAACC,cAAsB,EAAQ;MAC5C,IAAI,CAACJ,MAAM,GAAG,IAAIJ,MAAM,CAACQ,cAAc,EAAE,0BAA0B,EAAE,IAAI,EAAE,IAAI,CAAC;IACpF;IAEAC,SAASA,CAACC,QAAiB,EAAQ;MAC/B,MAAMC,IAAI,GAAGD,QAAQ,CAACE,SAAS,CAAC,CAAC;MACjC,IAAI,CAACD,IAAI,EAAE;QACP;MACJ;MACA,MAAME,YAAY,GAAGd,WAAW,CAACe,WAAW,CAAC,CAAC;MAC9C,IAAI,CAACD,YAAY,CAACE,qBAAqB,CAAC,CAAC,EAAE;QACvCF,YAAY,CAACG,UAAU,CAAC,CAAC,CAACC,IAAI,CAC1B,YAAY;UACR,IAAI,CAACC,WAAW,CAACP,IAAI,CAAC;QAC1B,CAAC,CAACQ,IAAI,CAAC,IAAI,CAAC,EACZ,YAAY;UACR,IAAI,CAACD,WAAW,CAACP,IAAI,CAAC;QAC1B,CAAC,CAACQ,IAAI,CAAC,IAAI,CACf,CAAC;MACL,CAAC,MAAM;QACH,IAAI,CAACD,WAAW,CAACP,IAAI,CAAC;MAC1B;IACJ;IAEAO,WAAWA,CAACP,IAAyB,EAAe;MAChD,IAAIA,IAAI,CAACS,QAAQ,KAAKC,MAAM,CAACC,IAAI,CAACC,SAAS,EAAE;QACzC,IAAI,CAACC,iBAAiB,CAACb,IAAI,CAAC;QAC5B;MACJ;MACA,KAAK,IAAIc,CAAC,GAAG,CAAC,EAAEA,CAAC,GAAGd,IAAI,CAACe,UAAU,CAACC,MAAM,EAAE,EAAEF,CAAC,EAAE;QAC7C,MAAMG,KAAK,GAAGjB,IAAI,CAACe,UAAU,CAACD,CAAC,CAAC;QAChC,IAAI,CAACP,WAAW,CAACU,KAAK,CAAC;MAC3B;IACJ;IAEAC,iBAAiBA,CAACC,IAAY,EAAU;MACpC,OAAOA,IAAI,CAACC,OAAO,CAAC,IAAI,CAAC5B,iBAAiB,EAAE,EAAE,CAAC;IACnD;IAEAqB,iBAAiBA,CAACb,IAAyB,EAAe;MACtD;MACA,MAAMqB,UAAU,GAAG,IAAI,CAAC5B,MAAM,CAAC6B,IAAI,CAAC,IAAI,CAACJ,iBAAiB,CAAClB,IAAI,CAACuB,WAAW,CAAC,CAAC;MAC7E,IAAI,CAACF,UAAU,CAACG,MAAM,EAAE;QACpB;MACJ;MACA;MACA,MAAMC,QAAQ,GAAGC,QAAQ,CAACC,aAAa,CAAC,MAAM,CAAC;MAC/CF,QAAQ,CAACG,SAAS,GAAGzC,SAAS,CAACkC,UAAU,CAACQ,gBAAgB,CAAC;MAC3DvC,YAAY,CAACwC,gBAAgB,CAACL,QAAQ,EAAE,0BAA0B,CAAC;MACnEzB,IAAI,CAAC+B,UAAU,CAACC,YAAY,CAACP,QAAQ,EAAEzB,IAAI,CAAC;MAC5CA,IAAI,CAAC+B,UAAU,CAACE,WAAW,CAACjC,IAAI,CAAC;IACrC;EACJ;EAAC,IAAAkC,SAAA;IAAAC,UAAA;EAAA;EAAAD,SAAA,CAAA3C,WAAA,GAAAA,WAAA;EAAA,OAAA2C,SAAA;AAAA","ignoreList":[]}