{"version":3,"file":"SearchNlqExplainBar.js","names":["sap","ui","define","__i18n","Toolbar","sap_m_library","Button","Popover","FormattedText","Link","ToolbarSpacer","MessageToast","_interopRequireDefault","obj","__esModule","default","i18n","PlacementType","ToolbarDesign","SearchNlqExplainBar","_aiPopover","_nlqViewAllPopover","_nlqExplainText","constructor","sId","settings","super","this","setProperty","Info","addStyleClass","assembleAiPopover","assembleNlqViewAllPopover","nlqExplainButton","getId","icon","tooltip","press","openBy","addContent","nlqExplainText","htmlText","parts","path","formatter","sFilterDesc","getText","result","replace","toolbarSpacer","nlqExplainFilterLink","text","setModel","getModel","assembleNlqFilterCopyButton","filterDescription","desc","popover","showHeader","content","placement","Bottom","staticText","closeButton","close","title","contentWidth","footer","design","Auto","nlqExplainFilterButton","type","domRef","getDomRef","textContent","trim","window","navigator","clipboard","writeText","then","show","catch","err","static","apiVersion"],"sources":["SearchNlqExplainBar.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport i18n from \"../i18n\";\nimport Toolbar, { $ToolbarSettings } from \"sap/m/Toolbar\";\nimport { PlacementType, ToolbarDesign } from \"sap/m/library\";\nimport Button from \"sap/m/Button\";\nimport Popover from \"sap/m/Popover\";\nimport FormattedText from \"sap/m/FormattedText\";\nimport Link from \"sap/m/Link\";\nimport ToolbarSpacer from \"sap/m/ToolbarSpacer\";\nimport MessageToast from \"sap/m/MessageToast\";\n\nexport default class SearchNlqExplainBar extends Toolbar {\n    private _aiPopover: Popover;\n    private _nlqViewAllPopover: Popover;\n    private _nlqExplainText!: FormattedText;\n\n    constructor(sId?: string, settings?: $ToolbarSettings) {\n        super(sId, settings);\n\n        // Set the blue bar style\n        this.setProperty(\"design\", ToolbarDesign.Info);\n        this.addStyleClass(\"sapUshellSearchNlqExplainBar\");\n\n        // Create popovers\n        this._aiPopover = this.assembleAiPopover();\n        this._nlqViewAllPopover = this.assembleNlqViewAllPopover();\n\n        const nlqExplainButton = new Button(this.getId() + \"-nlqExplainButton\", {\n            icon: \"sap-icon://ai\",\n            tooltip: \"{i18n>nlqExplainButtonTooltip}\",\n            press: () => {\n                this._aiPopover.openBy(nlqExplainButton);\n            },\n        });\n        nlqExplainButton.addStyleClass(\"sapUshellSearchNlqExplainButton\");\n        this.addContent(nlqExplainButton);\n\n        const nlqExplainText = new FormattedText(this.getId() + \"-nlqExplainText\", {\n            htmlText: {\n                parts: [{ path: \"/nlqResult/filterDescription\" }],\n                formatter: (sFilterDesc: string) => {\n                    if (!sFilterDesc) {\n                        return i18n.getText(\"nlqNoFilter\");\n                    }\n\n                    // Replace br tags with spaces\n                    let result = sFilterDesc.replace(/<br\\s*\\/?>/gi, \" \");\n                    // Remove all HTML tags except strong and em\n                    result = result.replace(/<(?!\\/?(?:strong|em)\\b)[^>]*>/gi, \"\");\n                    return result;\n                },\n            },\n        }).addStyleClass(\"sapUshellSearchNlqFilterFormattedTextEllipsis\");\n\n        // store the reference\n        this._nlqExplainText = nlqExplainText;\n        this.addContent(nlqExplainText);\n\n        const toolbarSpacer = new ToolbarSpacer(this.getId() + \"-nlqExplainToolbarSpacer\", {});\n        this.addContent(toolbarSpacer);\n\n        const nlqExplainFilterLink = new Link(this.getId() + \"-nlqExplainFilterLink\", {\n            text: \"View All\",\n            tooltip: \"{i18n>nlqExplainButtonTooltip}\",\n            press: () => {\n                this._nlqViewAllPopover.setModel(this.getModel());\n                this._nlqViewAllPopover.setModel(this.getModel(\"i18n\"), \"i18n\");\n                this._nlqViewAllPopover.openBy(nlqExplainFilterLink);\n            },\n        });\n        nlqExplainFilterLink.addStyleClass(\"sapUshellSearchNlqExplainLink\");\n        this.addContent(nlqExplainFilterLink);\n\n        this.assembleNlqFilterCopyButton();\n    }\n\n    private assembleNlqViewAllPopover(): Popover {\n        const filterDescription = new FormattedText({\n            htmlText: {\n                parts: [{ path: \"/nlqResult/filterDescription\" }],\n                formatter: (desc: string) => {\n                    if (!desc) {\n                        return i18n.getText(\"nlqNoFilter\");\n                    }\n\n                    return desc;\n                },\n            },\n        });\n        filterDescription.addStyleClass(\"sapUiSmallMargin\");\n\n        const popover = new Popover({\n            showHeader: false,\n            content: [filterDescription],\n            placement: PlacementType.Bottom,\n        });\n        popover.addStyleClass(\"sapUshellSearchNlqExplainPopover\");\n        return popover;\n    }\n\n    private assembleAiPopover(): Popover {\n        const staticText = new FormattedText({\n            htmlText:\n                \"Results on this page have been filtered by artificial intelligence (AI) technologies.<br>\" +\n                \"<br>Verify results before use.\",\n        });\n        staticText.addStyleClass(\"sapUiSmallMargin\");\n\n        const closeButton = new Button({\n            text: \"Close\",\n            press: () => {\n                this._aiPopover.close();\n            },\n        });\n\n        const popover = new Popover({\n            title: \"Created with AI\",\n            content: [staticText],\n            placement: PlacementType.Bottom,\n            contentWidth: \"400px\",\n            footer: new Toolbar({\n                design: ToolbarDesign.Auto,\n                content: [new ToolbarSpacer(), closeButton],\n            }),\n        });\n        popover.addStyleClass(\"sapUshellSearchNlqExplainPopover\");\n        return popover;\n    }\n\n    private assembleNlqFilterCopyButton(): void {\n        const nlqExplainFilterButton = new Button(this.getId() + \"-nlqExplainFilterCopyButton\", {\n            icon: \"sap-icon://copy\",\n            type: \"Transparent\",\n            tooltip: \"{i18n>nlqcopyText}\",\n            press: () => {\n                const domRef = this._nlqExplainText.getDomRef();\n                const text = (domRef?.textContent || \"\").replace(/\\s+/g, \" \").trim();\n\n                // Copy to clipboard\n                if (window.navigator.clipboard) {\n                    window.navigator.clipboard\n                        .writeText(text)\n                        .then(() => {\n                            MessageToast.show(\"Copied to clipboard\");\n                        })\n                        .catch((err) => {\n                            MessageToast.show(\"Copy failed: \" + err);\n                        });\n                } else {\n                    MessageToast.show(\"Clipboard API not available\");\n                }\n            },\n        });\n        this.addContent(nlqExplainFilterButton);\n    }\n\n    static renderer = {\n        apiVersion: 2,\n    };\n}\n"],"mappings":"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","ignoreList":[]}