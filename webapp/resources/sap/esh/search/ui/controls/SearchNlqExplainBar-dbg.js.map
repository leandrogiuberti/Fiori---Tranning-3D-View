{"version":3,"file":"SearchNlqExplainBar-dbg.js","names":["sap","ui","define","__i18n","Toolbar","sap_m_library","Button","Popover","FormattedText","Link","ToolbarSpacer","MessageToast","_interopRequireDefault","obj","__esModule","default","i18n","PlacementType","ToolbarDesign","SearchNlqExplainBar","_aiPopover","_nlqViewAllPopover","_nlqExplainText","constructor","sId","settings","setProperty","Info","addStyleClass","assembleAiPopover","assembleNlqViewAllPopover","nlqExplainButton","getId","icon","tooltip","press","openBy","addContent","nlqExplainText","htmlText","parts","path","formatter","sFilterDesc","getText","result","replace","toolbarSpacer","nlqExplainFilterLink","text","setModel","getModel","assembleNlqFilterCopyButton","filterDescription","desc","popover","showHeader","content","placement","Bottom","staticText","closeButton","close","title","contentWidth","footer","design","Auto","nlqExplainFilterButton","type","domRef","getDomRef","textContent","trim","window","navigator","clipboard","writeText","then","show","catch","err","renderer","apiVersion"],"sources":["SearchNlqExplainBar.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport i18n from \"../i18n\";\nimport Toolbar, { $ToolbarSettings } from \"sap/m/Toolbar\";\nimport { PlacementType, ToolbarDesign } from \"sap/m/library\";\nimport Button from \"sap/m/Button\";\nimport Popover from \"sap/m/Popover\";\nimport FormattedText from \"sap/m/FormattedText\";\nimport Link from \"sap/m/Link\";\nimport ToolbarSpacer from \"sap/m/ToolbarSpacer\";\nimport MessageToast from \"sap/m/MessageToast\";\n\nexport default class SearchNlqExplainBar extends Toolbar {\n    private _aiPopover: Popover;\n    private _nlqViewAllPopover: Popover;\n    private _nlqExplainText!: FormattedText;\n\n    constructor(sId?: string, settings?: $ToolbarSettings) {\n        super(sId, settings);\n\n        // Set the blue bar style\n        this.setProperty(\"design\", ToolbarDesign.Info);\n        this.addStyleClass(\"sapUshellSearchNlqExplainBar\");\n\n        // Create popovers\n        this._aiPopover = this.assembleAiPopover();\n        this._nlqViewAllPopover = this.assembleNlqViewAllPopover();\n\n        const nlqExplainButton = new Button(this.getId() + \"-nlqExplainButton\", {\n            icon: \"sap-icon://ai\",\n            tooltip: \"{i18n>nlqExplainButtonTooltip}\",\n            press: () => {\n                this._aiPopover.openBy(nlqExplainButton);\n            },\n        });\n        nlqExplainButton.addStyleClass(\"sapUshellSearchNlqExplainButton\");\n        this.addContent(nlqExplainButton);\n\n        const nlqExplainText = new FormattedText(this.getId() + \"-nlqExplainText\", {\n            htmlText: {\n                parts: [{ path: \"/nlqResult/filterDescription\" }],\n                formatter: (sFilterDesc: string) => {\n                    if (!sFilterDesc) {\n                        return i18n.getText(\"nlqNoFilter\");\n                    }\n\n                    // Replace br tags with spaces\n                    let result = sFilterDesc.replace(/<br\\s*\\/?>/gi, \" \");\n                    // Remove all HTML tags except strong and em\n                    result = result.replace(/<(?!\\/?(?:strong|em)\\b)[^>]*>/gi, \"\");\n                    return result;\n                },\n            },\n        }).addStyleClass(\"sapUshellSearchNlqFilterFormattedTextEllipsis\");\n\n        // store the reference\n        this._nlqExplainText = nlqExplainText;\n        this.addContent(nlqExplainText);\n\n        const toolbarSpacer = new ToolbarSpacer(this.getId() + \"-nlqExplainToolbarSpacer\", {});\n        this.addContent(toolbarSpacer);\n\n        const nlqExplainFilterLink = new Link(this.getId() + \"-nlqExplainFilterLink\", {\n            text: \"View All\",\n            tooltip: \"{i18n>nlqExplainButtonTooltip}\",\n            press: () => {\n                this._nlqViewAllPopover.setModel(this.getModel());\n                this._nlqViewAllPopover.setModel(this.getModel(\"i18n\"), \"i18n\");\n                this._nlqViewAllPopover.openBy(nlqExplainFilterLink);\n            },\n        });\n        nlqExplainFilterLink.addStyleClass(\"sapUshellSearchNlqExplainLink\");\n        this.addContent(nlqExplainFilterLink);\n\n        this.assembleNlqFilterCopyButton();\n    }\n\n    private assembleNlqViewAllPopover(): Popover {\n        const filterDescription = new FormattedText({\n            htmlText: {\n                parts: [{ path: \"/nlqResult/filterDescription\" }],\n                formatter: (desc: string) => {\n                    if (!desc) {\n                        return i18n.getText(\"nlqNoFilter\");\n                    }\n\n                    return desc;\n                },\n            },\n        });\n        filterDescription.addStyleClass(\"sapUiSmallMargin\");\n\n        const popover = new Popover({\n            showHeader: false,\n            content: [filterDescription],\n            placement: PlacementType.Bottom,\n        });\n        popover.addStyleClass(\"sapUshellSearchNlqExplainPopover\");\n        return popover;\n    }\n\n    private assembleAiPopover(): Popover {\n        const staticText = new FormattedText({\n            htmlText:\n                \"Results on this page have been filtered by artificial intelligence (AI) technologies.<br>\" +\n                \"<br>Verify results before use.\",\n        });\n        staticText.addStyleClass(\"sapUiSmallMargin\");\n\n        const closeButton = new Button({\n            text: \"Close\",\n            press: () => {\n                this._aiPopover.close();\n            },\n        });\n\n        const popover = new Popover({\n            title: \"Created with AI\",\n            content: [staticText],\n            placement: PlacementType.Bottom,\n            contentWidth: \"400px\",\n            footer: new Toolbar({\n                design: ToolbarDesign.Auto,\n                content: [new ToolbarSpacer(), closeButton],\n            }),\n        });\n        popover.addStyleClass(\"sapUshellSearchNlqExplainPopover\");\n        return popover;\n    }\n\n    private assembleNlqFilterCopyButton(): void {\n        const nlqExplainFilterButton = new Button(this.getId() + \"-nlqExplainFilterCopyButton\", {\n            icon: \"sap-icon://copy\",\n            type: \"Transparent\",\n            tooltip: \"{i18n>nlqcopyText}\",\n            press: () => {\n                const domRef = this._nlqExplainText.getDomRef();\n                const text = (domRef?.textContent || \"\").replace(/\\s+/g, \" \").trim();\n\n                // Copy to clipboard\n                if (window.navigator.clipboard) {\n                    window.navigator.clipboard\n                        .writeText(text)\n                        .then(() => {\n                            MessageToast.show(\"Copied to clipboard\");\n                        })\n                        .catch((err) => {\n                            MessageToast.show(\"Copy failed: \" + err);\n                        });\n                } else {\n                    MessageToast.show(\"Clipboard API not available\");\n                }\n            },\n        });\n        this.addContent(nlqExplainFilterButton);\n    }\n\n    static renderer = {\n        apiVersion: 2,\n    };\n}\n"],"mappings":"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","ignoreList":[]}