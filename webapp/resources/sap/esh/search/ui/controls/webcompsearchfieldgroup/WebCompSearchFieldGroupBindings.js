/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["sap/esh/search/ui/gen/ui5/webcomponents_fiori/dist/SearchScope","sap/esh/search/ui/gen/ui5/webcomponents_fiori/dist/SearchItem","sap/esh/search/ui/gen/ui5/webcomponents_fiori/dist/SearchItemGroup","sap/esh/search/ui/gen/ui5/webcomponents_fiori/dist/SearchItemShowMore","sap/ui/model/BindingMode","../../suggestions/SuggestionType","../../error/errors","../../SearchHelper","../../UIEvents","sap/ui/core/EventBus"],function(e,t,r,a,s,o,i,n,c,h){"use strict";function g(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const l=g(e);const u=g(t);const S=g(r);const p=g(a);const d=g(o);const m=o["isSearchSuggestion"];const f=i["ProgramError"];const b=g(c);function w(e,t){if(!t){t={SearchScope:l,SearchItem:u,SearchItemGroup:S,SearchItemShowMore:p}}const r=e;T(e);r.bindProperty("blocked",{parts:[{path:"/initializingObjSearch"}],formatter:e=>e});r.bindProperty("placeholder",{path:"/searchTermPlaceholder",mode:s.OneWay});r.bindAggregation("scopes",{path:"/dataSources",template:new t.SearchScope({text:"{labelPlural}",selected:{parts:["/uiFilter/dataSource/id","id"],formatter:(e,t)=>e===t}})});r.attachEvent("scopeChange",e=>{const t=e.mParameters.scope.getBindingContext().getObject();const a=r.getModel();a.setDataSource(t,false);setTimeout(()=>{r.focus()},200)});r.bindProperty("value",{path:"/uiFilter/searchTerm",mode:s.TwoWay});r.bindAggregation("items",{path:"/suggestions",factory:(r,a)=>e.createSuggestionItem(r,a,t)});r.bindProperty("open",{parts:["/suggestions/length"],formatter:e=>e>0});r.bindProperty("loading",{path:"/isBusySuggestions"});r.attachEvent("input",()=>{e.triggerSuggestions()});r.attachEvent("search",t=>{const a=t.getParameter("item");if(a){let r;try{r=a.getBindingContext().getObject()}catch(e){return}t.preventDefault();e.handleSuggestionItemSelected(r);return}if(r.getValue().length>0){e.triggerSearch()}})}function T(e){Object.assign(e,{createSuggestionItem(e,t,r){const a=t.getObject();switch(a.uiSuggestionType){case d.Header:return new r.SearchItemGroup({headerText:a.label});case d.DataSource:return new r.SearchItem({text:a.dataSource.label,scopeName:""});case d.App:return new r.SearchItem({text:a.title,icon:a.icon,scopeName:""});case d.SearchTermData:case d.SearchTermHistory:case d.SearchTermAI:if(a.isShowMoreApps){return this.createShowMoreAppsSuggestion(a,r)}return new r.SearchItem({text:a.searchTerm,scopeName:""});case d.Object:return new r.SearchItem({text:a.label1,description:a.label2,scopeName:""});case d.Search:return new r.SearchItem({text:"search suggestion:"+a.label,scopeName:""});default:throw new f(null,"Unknown suggestion type: "+a.uiSuggestionType)}},createShowMoreAppsSuggestion(e,t){const r=this.getModel();const a=new t.SearchItemShowMore({itemsToShowCount:e.totalCount});Object.assign(a,{onAfterRendering:()=>{if(!a.eshRegistered){a.getDomRef().addEventListener("click",()=>{r.abortSuggestions();r.setSearchBoxTerm(r.getLastSearchTerm(),false);e.titleNavigation.performNavigation()});a.getDomRef().addEventListener("keydown",t=>{if(t.keyCode!==13){return}r.abortSuggestions();r.setSearchBoxTerm(r.getLastSearchTerm(),false);e.titleNavigation.performNavigation()});a.eshRegistered=true}}});return a},handleSuggestionItemSelected(e){const t=this.getModel();t.abortSuggestions();switch(e.uiSuggestionType){case d.App:this.handleAppSuggestionItemSelected(e);break;case d.Search:case d.SearchTermData:case d.SearchTermHistory:case d.SearchTermAI:case d.Object:t.setSearchBoxTerm(t.getLastSearchTerm(),false);if(m(e)){e.titleNavigation.performNavigation()}break;case d.DataSource:t.setDataSource(e.dataSource,false);t.setSearchBoxTerm("",false);setTimeout(()=>{this.focus()},200);break;default:break}},handleAppSuggestionItemSelected(e){const t=this.getModel();let r=e.url;if(r[0]==="#"){if(r.indexOf("#Action-search")===0&&(r===n.getHashFromUrl()||r===decodeURIComponent(n.getHashFromUrl()))){t.setSearchBoxTerm(t.query.filter.searchTerm,false);t.setDataSource(t.query.filter.dataSource,false);t.notifySubscribers(b.ESHSearchFinished);h.getInstance().publish(b.ESHSearchFinished);return}if(window["hasher"]){if(r[1]===window.hasher.prependHash){r=r.slice(0,1)+r.slice(2)}window["hasher"].setHash(r)}else{window.location.href=r}t.setSearchBoxTerm("",false)}else{this.logRecentActivity(e);window.open(r,"_blank","noopener,noreferrer");t.setSearchBoxTerm("",false)}},triggerSuggestions(){const e=this.getModel();if(e.getSearchBoxTerm().length>0||e.config.bRecentSearches){e.doSuggestion()}else{e.abortSuggestions()}},triggerSearch(){const e=this.getModel();n.subscribeOnlyOnce("triggerSearch",b.ESHSearchFinished,function(){this.getModel().autoStartApp()},this);if(this.getValue().trim()===""&&e.config.isUshell){this.setValue("*")}this.navigateToSearchApp()},navigateToSearchApp(){const e=this.getModel();e.abortSuggestions();if(n.isSearchAppActive()||!e.config.isUshell){e.fireSearchQuery()}else{e.resetSearchResultItemMemory();const t=e.createSearchNavigationTargetCurrentState({updateUrl:true}).targetUrl;window.location.hash=t}},logRecentActivity(e){sap.ui.require(["sap/ushell/Config","sap/ushell/services/AppType"],function(t,r){const a=t.last("/core/shell/enableRecentActivity")&&t.last("/core/shell/enableRecentActivityLogging");if(a){const t={title:e.title,appType:r.URL,url:e.url,appId:e.url};window.sap.ushell.Container.getRenderer("fiori2").logRecentActivity(t)}})}})}var y={__esModule:true};y.createWebCompSearchFieldGroupBindings=w;y.addMethods=T;return y});
//# sourceMappingURL=WebCompSearchFieldGroupBindings.js.map