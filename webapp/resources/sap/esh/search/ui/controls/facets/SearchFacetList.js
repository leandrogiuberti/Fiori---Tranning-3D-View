/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../../i18n","sap/m/IconTabFilter","sap/m/Button","../../error/errors","./types/SearchFacetQuickSelectDataSource","./types/SearchFacetHierarchyDynamic","./types/SearchFacetHierarchyStatic","./types/tabbarfacet/SearchFacetBarChart","./types/tabbarfacet/SearchFacetPieChart","sap/ui/core/Control","./types/tabbarfacet/SearchFacetTabBar","../../eventlogging/UserEvents","../OpenShowMoreDialog","sap/m/library","./FacetTypeUI","./types/tabbarfacet/SearchFacetSimpleList","sap/m/FlexBox","sap/m/Label"],function(e,t,a,r,n,c,s,o,i,l,h,d,u,p,S,f,y,g){"use strict";function F(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const b=F(e);const w=F(r);const C=F(n);const B=F(c);const A=F(s);const m=F(o);const T=F(i);const D=F(h);const U=d["UserEventType"];const x=u["openShowMoreDialog"];const H=p["ButtonType"];const k=p["FlexAlignItems"];const I=p["FlexJustifyContent"];const M=S["FacetTypeUI"];const _=F(f);const v=l.extend("sap.esh.search.ui.controls.SearchFacetList",{renderer:{apiVersion:2,render(e,t){const a=t.getModel();e.openStart("div",t);e.class("sapUshellSearchFacetList");e.class("sapUshellSearchFacetFilter");e.openEnd();const r=t.getAggregation("facets");for(let a=0,n=r.length;a<n;a++){const n=r[a];t.renderSectionHeader(e,r,a);const c=n.getBindingContext().getObject();switch(c.facetType){case M.Attribute:n.switchFacetType(M.Attribute);n.attachSelectionChange(null,()=>{const e=t._getShowAllButton();const a=e.getDomRef();if(a){if(a instanceof HTMLElement){a.style.display="none"}}else{}});if(c.position<=499){n.addStyleClass("sapUshellSearchFacetSearchInAttribute")}e.renderControl(n);break;case M.DataSource:n.switchFacetType(M.DataSource);n.addStyleClass("sapUshellSearchFacetDataSource");e.renderControl(n);break;case M.QuickSelectDataSource:n.addStyleClass("sapUshellSearchFacetQuickSelectDataSource");e.renderControl(n);break;case M.Hierarchy:if(c.position<=499){n.addStyleClass("sapUshellSearchFacetSearchInAttribute")}n.addStyleClass("sapUshellSearchFacetHierarchyDynamic");e.renderControl(n);break;case M.HierarchyStatic:n.addStyleClass("sapUshellSearchFacetHierarchyStatic");e.renderControl(n);break;default:throw"program error: unknown facet type :"+c.facetType}}if(a.getDataSource()?.type==="BusinessObject"){const r=a.oFacetFormatter.hasDialogFacetsFromMetaData(a);const n=t.getModel().getProperty("/boCount")>0;if(r&&n){const a=t._getShowAllButton();if(a!==null){e.openStart("div",t.getId()+"-showAllFilters");e.openEnd();a.setModel(t.getModel("i18n"));a.addStyleClass("sapUshellSearchFacetListShowAllFilterBtn");a.addStyleClass("sapUshellSearchFacetFilterShowAllFilterBtn");e.renderControl(a);e.close("div")}}}e.close("div")}},metadata:{aggregations:{facets:{singularName:"facet",bindable:"bindable",multiple:true},_showAllBtn:{type:"sap.m.Button",multiple:false,visibility:"hidden"}}},constructor:function e(t,a){l.prototype.constructor.call(this,t,a);this.data("sap-ui-fastnavgroup","true",true);this.bindFacets()},bindFacets:function e(){if(!this.getBindingInfo("facets")){this.bindAggregation("facets",{path:"/facets",factory:(e,a)=>{const r=a.getObject();const n=a.getModel();const c=n.config;switch(r.facetType){case M.Attribute:{const a=new D(`${e}-attribute_facet`,{items:[new t({text:b.getText("facetList"),icon:"sap-icon://list",key:`list${e}`,content:new _(`list${e}`)}),new t({text:b.getText("facetBarChart"),icon:"sap-icon://horizontal-bar-chart",key:`barChart${e}`,content:new m(`barChart${e}`)}),new t({text:b.getText("facetPieChart"),icon:"sap-icon://pie-chart",key:`pieChart${e}`,content:new T(`pieChart${e}`)})]});a.addStyleClass("sapUshellSearchFacetIconTabBar");return a}case M.DataSource:{const e=new _((c?.id?c.id+"-":"")+"dataSourceFacet",{facetType:M.DataSource});if(c.exclusiveDataSource){e.setVisible(false)}return e}case M.QuickSelectDataSource:{const e=new C((c?.id?c.id+"-":"")+"sapUshellSearchFacetQuickSelectDataSource",{});return e}case M.Hierarchy:{const t=`${e}-hierarchy_facet`;const a=new B(t,{openShowMoreDialogFunction:x});return a}case M.HierarchyStatic:{const t=`${e}-hierarchyStatic_facet`;return new A(t,{})}default:{const e=new Error(`Program error: Unknown facet type: '${r.facetType}'`);throw new w.UnknownFacetType(e)}}}})}},getFirstFilterByFacet:function e(t){for(const e of t){const t=e.getBindingContext().getObject();if(t.facetType===M.Attribute||t.facetType===M.Hierarchy){return e}}},doRenderSectionHeader:function e(t,r,n,c){const s=[];const o=new g({text:r});o.addStyleClass("sapUshellSearchFacetSectionHeader");s.push(o);if(n){const e=this.getModel();let t=false;const r=e.getProperty("/uiFilter/rootCondition");if(r.hasFilters()){t=true;if(e.hasStaticHierarchyFacetFilterConditionOnly()){t=false}}else{t=false}const n=new a("",{icon:"sap-icon://clear-filter",tooltip:b.getText("resetFilterButton_tooltip"),type:H.Transparent,enabled:t,press:()=>{e.eventLogger.logEvent({type:U.CLEAR_ALL_FILTERS,dataSourceKey:e.getDataSource()?.id});e.resetFilterByFilterConditions(true)}});n.addStyleClass("sapUshellSearchFilterByResetButton");s.push(n)}const i=new y({justifyContent:I.SpaceBetween,alignItems:k.Center,items:s});if(c){i.addStyleClass(c)}t.renderControl(i)},renderSectionHeader:function e(t,a,r){const n=a[r];if(r===0){this.doRenderSectionHeader(t,b.getText("searchIn"),false,"sapUshellSearchInSection");return}if(this.getFirstFilterByFacet(a)===n){this.doRenderSectionHeader(t,b.getText("filterBy"),true);return}},onAfterRendering:function e(){const t=document.querySelector(".searchFacetList .searchFacet ul");if(t){t.setAttribute("role","tree");const e=t.querySelectorAll("li");e.forEach(e=>{e.setAttribute("role","treeitem")})}},_getShowAllButton:function e(){if(this.getAggregation("_showAllBtn")===null){const e=async()=>{const e=this.getModel();await x({searchModel:e,dimension:undefined,selectedTabBarIndex:0,tabBarItems:undefined,sourceControl:this})};const t=new a(`${this.getId()}-ShowMoreAll`,{text:"{showAllFilters}",press:e,visible:true});this.setAggregation("_showAllBtn",t)}return this.getAggregation("_showAllBtn")}});return v});
//# sourceMappingURL=SearchFacetList.js.map