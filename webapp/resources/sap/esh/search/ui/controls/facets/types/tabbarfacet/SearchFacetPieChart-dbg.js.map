{"version":3,"file":"SearchFacetPieChart-dbg.js","names":["sap","ui","define","__i18n","thirdpartyD3","Control","____FacetTypeUI","Element","_interopRequireDefault","obj","__esModule","default","i18n","FacetTypeUI","SearchFacetPieChart","extend","renderer","apiVersion","render","oRm","oControl","openStart","attr","openEnd","close","PieChart","metadata","properties","oSearchFacetDialog","type","aggregations","items","multiple","constructor","_constructor","sId","settings","Control.prototype.constructor.call","iMissingCnt","d3","getFacetIndex","_getFacetIndex","domElement","getDomRef","myIconTabBar","classList","contains","parentElement","iconTabBars","document","querySelectorAll","i","length","iconTabBar","item","getFacetIndexByIdForLargePieChart","_getFacetIndexByIdForLargePieChart","chartId","index","chartElem","getElementById","tabStrip","tabStripId","id","ar","Array","from","currentTabId","getPieChartIndexByFacetIndex","_getPieChartIndexByFacetIndex","facetIndex","selKey","previousFacetsWithPieChart","mlibContents","firstChild","match","getSumSelected","_getSumSelected","data","itemValue","integerValue","facetType","Attribute","j","value","selected","getDataForPieChart","_getDataForPieChart","model","res","group","currentFacetIndex","itemValueText","searchResultTotal","oData","count","overallTotal","pieChartTotal","filterCondition","dimension","facetTitle","label","filterLabel","valueLabel","tooltip","filtered","removed","fill","maxLabelLength","push","totalCount","percCoveredInPie","Math","round","percMissing","sizeOfWedge","getText","stroke","getDataForPieChartLarge","_getDataForPieChartLarge","facetItems","facetTotalCount","maxItemsToShow","facetAttribute","directUpdate","_directUpdate","piechartParent","options","model1","fewerData","application","getModel","getParent","pieChartParentClass","height","relevantContainerHeight","$","parent","chartElements","chart","update","isFacetPanel","_isFacetPanel","onAfterRendering","_onAfterRendering","that","className","getProperty","aAriaDesc","map","chartElement","setAttribute","join","selectedFacetItem","getBindingContext","getObject","title","closest","infoZeile","querySelector","oInfoZeile","setVisible","message","setText","rerender","isIE","navigator","appName","svg","svgArcs","svgLabels","oldArcs","clickedSegment","firstUpdate","xOrigin","yOrigin","tweenGenArc","tweenGenText","arcSequence","parentSelector","init","select","svgHeight","HTMLElement","offsetHeight","svgWidth","offsetWidth","r","min","backgroundWidth","backgroundHeight","width","innerRadius","outerRadius","tweenGen","Tweens","tweenGenSimple","tweenGenSimpleText","arcCalculator","generateHistoricalArcCalculator","animationduration","labelHideThreshold","easing","pieChartClass","color","strokewidth","strokewidthHover","padding4click","multipleselectable","field","createAttributeService","append","initTween","Tweens1","undefined","translateStr4Padding","tweenGenEcstasy","tweenGenLSD","d","a","svgGenerator","s1","startAngle","oldArc","endAngle","s2","interpolate","t","chartInstance","labelText","labelElement","childNodes","labelpositionBefore","Labelposition","getBBox","svgArcGen","centroid","coordinationBefore","x","y","labelpositionAfter","labelWidth","adjustLabelWidth","coordinationAfter","interpolateArray","translateStrBuilder","coordinate","tranlateStr","padding","xOldOrig","yOldOrig","apexAngle","xNewOrig","sin","yNewOrig","cos","tmp","translateStr","splitRadius","splitOuterRadius","splitInnerRadius","splitInterpolation","resizeInterpolation","unifyInterpolation","moveInterpolation","cls","attribute","initFunction","prototype","call","notAnimatedUpdate","arcs","selectAll","remove","totalValue","percentage","calculateNewArcsOnly","sel","getIdOfArc","exit","empty","path","style","strokeColor","hovered","strokeWidth","opacityValue","initial","each","hasChildNodes","removeChild","lastChild","text","enter","on","e","event","code","keyCode","which","target","__onclick","oEvent","click","pieupdateuionly","returnCode","translateStrLabel","labelposition","labelElem","getLabelElementtbyLabel","getBoundingClientRect","Object","keys","cnt","getNumberOfClickedSegments","dataObject","onDetailPageSelectionChangeCharts","removeFilterCondition","key","__data__","apply","addFilterCondition","transition","duration","ease","mouseover","mouseout","textsG","removeDeletedArcs","element","targetWidth","shadowElement","textElement","textLength","tmpText","substr","getArcsWithLabel","arcsWithLabel","arc","args","getArcElementtbyLabel","tmpArcs","createZeroArc","angle","insertAfter","insertIndex","newArc","beforeArc","splice","arcsGen","layout","pie","sort","getIndexById","add2arcSequence","addNewData2Sequence","getIndex","forEach","generateDefaultArcCalculator","DefaultArcCalculator","slice","b","newArcs","calculateArcs","insertMissingArcs","arcs1","arcs2","ic","arc1InsertIndex","arc2Index","arc2","arc1Index","arc1","determineInsertIndex","sequenceIndex","sequenceIndex2","pieChart","HistoricalArcCalculator","labelPaddingX","labelPaddingY","radiusPadding","labelHeight","outsetMin","outsetMax","outsetStep","startLabelWidth","d3centroid","svgBackground","debug","outset","max","placementSuccessful","iterations","optimizationDirection","c","calc","c1","c2","c1v","c2v","isNaN","centroidX","centroidY","isStartAngleOnRight","isEndAngleOnRight","leftBorder","rightBorder","perimeterRightBorder","perimeterLeftBorder","PI","upperLabelBorder","lowerLabelBorder","calcLeftBorder","abs","doesFitHeight","calcRightBorder","perimeterUpperRightBorder","calcPerimeterBorder","perimeterLowerRightBorder","perimeterUpperLeftBorder","perimeterLowerLeftBorder","oldLabelWidth","floor","labelShortened","xSpace","asymmetry","cNew","cOld","border","upper","lower","isLeftLabel","isLeftBorder","y1","y2","tan","sqrt","Sequence","maxIndex","objectMap","object","_pieChart","arc2SortIndex","found","arc1SortIndex"],"sources":["SearchFacetPieChart.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\n/* global $ */\nimport i18n from \"../../../../i18n\";\nimport * as thirdpartyD3 from \"sap/ui/thirdparty/d3\";\nimport Control, { $ControlSettings } from \"sap/ui/core/Control\";\nimport SearchModel from \"sap/esh/search/ui/SearchModel\";\nimport RenderManager from \"sap/ui/core/RenderManager\";\nimport Dialog from \"sap/m/Dialog\";\nimport { FacetTypeUI } from \"../../FacetTypeUI\";\nimport Facet from \"../../../../Facet\";\nimport Label from \"sap/m/Label\";\nimport Element from \"sap/ui/core/Element\";\n\nexport interface $PieChartSettings extends $ControlSettings {\n    // dimension-angle: \"$count\",\n    \"dimension-pie\": string;\n    backgroundWidth: number;\n    backgroundHeight: number;\n    width: number;\n    height: number;\n    innerRadius: number;\n    outerRadius: number;\n    tweenGen: () => void; // PieChart.Tweens.tweenGenSimple\n    tweenGenText: () => void; // PieChart.Tweens.tweenGenSimpleText,\n    arcCalculator: HistoricalArcCalculator | DefaultArcCalculator | HistoricalArcCalculator; // PieChart.generateHistoricalArcCalculator(), // PieChart.generateDefaultArcCalculator(), PieChart.generateHistoricalArcCalculator(),\n    animationduration: number;\n    labelHideThreshold: number;\n    easing: string; // \"linear\";\"poly(4)\";\"quad\";\"cubic\" (default);\"sin\";\"exp\";\"circle\";\"elastic(a, p)\";\"back(s)\";\"bounce\"\n    pieChartClass: string; // \"sap-piechart\"\n    pieChartParentClass: string; // \"sapUshellSearchFacetPieChart\"\n    color: string; // \"blue\"\n    strokewidth: number;\n    strokewidthHover: number;\n    padding4click: number;\n    multipleselectable: boolean; // if set to false(single selection mode) no hover effect will be provided when any segment already has been clicked\n    oSearchFacetDialog: Dialog;\n}\nexport interface PieChartItem {\n    filterCondition?: any;\n    dimension?: string;\n    label?: string;\n    selected?: boolean;\n    filterLabel?: string;\n    id?: string;\n    value?: any;\n    valueLabel?: string;\n    tooltip?: string;\n    filtered?: boolean;\n    removed?: boolean;\n    fill?: string; // i.e. \"#007CAA\";\n    stroke?: string;\n    maxLabelLength?: number;\n}\nexport type svgAttr = (property: string, value: any) => { attr: svgAttr; style: svgStyle };\nexport type svgStyle = (property: string, value: any) => void;\nexport type svgSelect = (selector: string) => { remove: () => void };\nexport type svgSelectAll = (selector: string) => { remove: () => void };\nexport type svgAppend = (selector: string) => { attr: svgAttr; remove: () => void };\n\nexport interface SvgBackground {\n    select: svgSelect;\n    selectAll: svgSelect;\n    append: svgAppend;\n}\n\nexport type PieChartItems = Array<PieChartItem>;\n\n/**\n * @namespace sap.esh.search.ui.controls\n */\nexport default class SearchFacetPieChart extends Control {\n    static readonly metadata = {\n        properties: {\n            oSearchFacetDialog: {\n                type: \"object\",\n            },\n        },\n        aggregations: {\n            items: {\n                type: \"sap.esh.search.ui.FacetItem\",\n                multiple: true, // default type is \"sap.ui.core.Control\", multiple is \"true\"\n            },\n        },\n    };\n    static d3: any; // sap.ui.thirdparty.d3\n\n    private PieChart: any;\n    private chartElements: PieChartItems;\n    private iMissingCnt = 0;\n\n    constructor(sId?: string, settings?: Partial<$PieChartSettings>) {\n        super(sId, settings);\n        SearchFacetPieChart.d3 = thirdpartyD3;\n    }\n\n    static isIE(): boolean {\n        // eslint-disable-next-line no-restricted-globals\n        if (navigator.appName === \"Microsoft Internet Explorer\") {\n            return true;\n        }\n        return false;\n    }\n\n    static renderer = {\n        apiVersion: 2,\n        render(oRm: RenderManager, oControl: SearchFacetPieChart): void {\n            // outer div\n            oRm.openStart(\"div\", oControl);\n            oRm.attr(\"role\", \"figure\");\n            oRm.openEnd();\n            // close SearchFacetPieChart div\n            oRm.close(\"div\");\n            oControl.PieChart = PieChart;\n        },\n    };\n\n    getFacetIndex(): number {\n        // navigate to parent with class sapUshellSearchFacetIconTabBar\n        let domElement = this.getDomRef();\n        let myIconTabBar;\n        while (domElement) {\n            if (domElement.classList.contains(\"sapUshellSearchFacetIconTabBar\")) {\n                myIconTabBar = domElement;\n                break;\n            }\n            domElement = domElement.parentElement;\n        }\n        if (!myIconTabBar) {\n            return -1;\n        }\n\n        const iconTabBars = document.querySelectorAll(\".sapUshellSearchFacetIconTabBar\");\n        for (let i = 0; i < iconTabBars.length; ++i) {\n            const iconTabBar = iconTabBars.item(i);\n            if (iconTabBar === myIconTabBar) {\n                return i;\n            }\n        }\n        return -1;\n    }\n\n    getFacetIndexByIdForLargePieChart(chartId: string): number {\n        let index = -1;\n        // get the tabStrip element by id, then its parent, then its parent\n        const chartElem = document.getElementById(chartId);\n        const tabStrip = chartElem?.parentElement?.parentElement;\n        if (!tabStrip) {\n            return -1;\n        }\n        const tabStripId = tabStrip.id; // e.g. \"__container6\"\n        // get all elements with class 'searchFacetLargeChartContainer'\n        const ar = Array.from(document.querySelectorAll(\".searchFacetLargeChartContainer\")) as HTMLElement[];\n        for (let i = 0; i < ar.length; i++) {\n            const currentTabId = ar[i].id;\n            if (currentTabId === tabStripId) {\n                index = i;\n                break;\n            }\n        }\n        return index;\n    }\n\n    getPieChartIndexByFacetIndex(facetIndex: number): number {\n        let selKey;\n        let index = -1;\n        let previousFacetsWithPieChart = 0;\n        const iconTabBars = document.querySelectorAll(\".sapUshellSearchFacetIconTabBar\");\n        for (let i = 0; i < facetIndex; i++) {\n            const iconTabBar = iconTabBars[i] as HTMLElement;\n            if (!iconTabBar) continue;\n            const mlibContents = iconTabBar.querySelectorAll(\".sapMLIBContent\");\n            if (mlibContents.length < 2) continue;\n            const firstChild = mlibContents[1].firstChild as HTMLElement | null;\n            if (!firstChild || !(\"id\" in firstChild)) continue;\n            selKey = (firstChild as HTMLElement).id;\n            if (selKey && selKey.match(/pieChart/) !== null) {\n                previousFacetsWithPieChart++;\n            }\n        }\n        index = previousFacetsWithPieChart;\n        return index;\n    }\n\n    getSumSelected(data): number {\n        let itemValue;\n        let integerValue = 0;\n        if (data) {\n            for (let i = 0; i < data.length; i++) {\n                if (data[i].facetType === FacetTypeUI.Attribute) {\n                    for (let j = 0; j < data[i].items.length; j++) {\n                        itemValue = data[i].items[j].value;\n                        if (itemValue && data[i].items[j].selected) {\n                            integerValue += itemValue;\n                        }\n                    }\n                }\n            }\n        }\n        return integerValue;\n    }\n\n    getDataForPieChart(data, model, facetIndex: number): Array<PieChartItems> {\n        const res: Array<PieChartItems> = [];\n        let group: PieChartItems = [];\n        let item: PieChartItem;\n        let itemValue = 0;\n        let currentFacetIndex = -1;\n        let itemValueText = \"\";\n        const searchResultTotal = model.oData.count;\n        let overallTotal;\n        let pieChartTotal = 0;\n        this.iMissingCnt = 0;\n        for (let i = 0; i < data.length; i++) {\n            if (data[i].facetType === FacetTypeUI.Attribute) {\n                currentFacetIndex++;\n                group = [];\n                pieChartTotal = 0;\n                for (let j = 0; j < data[i].items.length; j++) {\n                    item = {};\n                    itemValue = data[i].items[j].value;\n                    if (itemValue) {\n                        itemValueText = \"\" + itemValue;\n                        pieChartTotal += itemValue;\n                        item.filterCondition = data[i].items[j].filterCondition;\n                        item.dimension = data[i].items[j].facetTitle;\n                        item.label = data[i].items[j].label;\n                        item.selected = data[i].items[j].selected;\n                        item.filterLabel = data[i].items[j].label;\n                        item.id = data[i].items[j].label;\n                        item.value = itemValue;\n                        item.valueLabel = data[i].items[j].valueLabel;\n                        if (itemValueText) {\n                            item.tooltip = data[i].items[j].label + \": \" + itemValue;\n                        } else {\n                            item.tooltip = data[i].items[j].label;\n                        }\n                        item.filtered = false;\n                        item.removed = false;\n                        item.fill = \"#007CAA\"; // ToDo: Use color code\n                        item.maxLabelLength = 30;\n                        group.push(item);\n                    } else if (currentFacetIndex === facetIndex) {\n                        this.iMissingCnt++;\n                    }\n                }\n                // ############# add a new pie segment that just reflects the data NOT in the pie chart\n                if (typeof data[i].totalCount === \"number\") {\n                    overallTotal = data[i].totalCount;\n                } else {\n                    overallTotal = searchResultTotal;\n                }\n                const percCoveredInPie = Math.round((pieChartTotal / overallTotal) * 100);\n                let percMissing = 100 - percCoveredInPie;\n                if (percMissing > 0) {\n                    if (percMissing === 100) {\n                        percMissing = 99;\n                    }\n                    const sizeOfWedge = (18 * pieChartTotal) / 350; // 18 is 5% of 360°\n                    const label = `${percMissing}`;\n                    item = {};\n                    item.filterCondition = null;\n                    item.dimension = \"\";\n                    item.label = label;\n                    item.id = \"perc_missing\";\n                    item.value = sizeOfWedge;\n                    item.valueLabel = label;\n                    item.tooltip = i18n.getText(\"facetPieChartOverflowText\", [label]);\n                    item.filtered = false;\n                    item.removed = false;\n                    item.fill = \"transparent\";\n                    item.stroke = \"none\";\n                    item.maxLabelLength = 30;\n                    group.push(item);\n                    // #############\n                }\n\n                res.push(group);\n            }\n        }\n        return res;\n    }\n\n    getDataForPieChartLarge(\n        facetItems: any,\n        model: any,\n        facetTotalCount: number,\n        maxItemsToShow: number\n    ): PieChartItems {\n        const group: Array<PieChartItem> = [];\n        let itemValue = 0;\n        const searchResultTotal = model.oData.count;\n        let overallTotal;\n        let pieChartTotal = 0;\n        this.iMissingCnt = 0;\n        let item: PieChartItem;\n        for (let j = 0; j < facetItems.length; j++) {\n            if (j + 1 >= maxItemsToShow) {\n                break; // limit number of items to show\n            }\n            itemValue = facetItems[j].value;\n            if (itemValue) {\n                item = {};\n                pieChartTotal = pieChartTotal + itemValue;\n                item.filterCondition = facetItems[j].filterCondition;\n                item.dimension = facetItems[j].facetAttribute;\n                item.label = facetItems[j].label;\n                item.selected = facetItems[j].selected;\n                item.filterLabel = facetItems[j].label;\n                item.id = facetItems[j].label;\n                item.value = itemValue;\n                item.valueLabel = facetItems[j].valueLabel;\n                item.tooltip = facetItems[j].label + \"\\t: \" + itemValue;\n                item.filtered = false;\n                item.removed = false;\n                item.fill = \"#007CAA\"; // ToDo: Use color code\n                item.maxLabelLength = 30;\n                group.push(item);\n            }\n        }\n        // ############# add a new pie segment that just reflects the data NOT in the pie chart\n        if (facetItems.length > 0) {\n            if (typeof facetTotalCount === \"undefined\") {\n                overallTotal = searchResultTotal;\n            } else {\n                overallTotal = facetTotalCount;\n            }\n            const percCoveredInPie = Math.round((pieChartTotal / overallTotal) * 100);\n            let percMissing = 100 - percCoveredInPie;\n            if (percMissing > 0) {\n                if (percMissing === 100) {\n                    percMissing = 99;\n                }\n                const sizeOfWedge = (18 * pieChartTotal) / 350; // 18 is 5% of 360°\n                const label = `${percMissing}`;\n                item = {};\n                item.filterCondition = null;\n                item.dimension = facetItems[0].facetAttribute;\n                item.label = label;\n                item.selected = false;\n                item.filterLabel = label;\n                item.id = \"perc_missing\";\n                item.value = sizeOfWedge;\n                item.valueLabel = label;\n                item.tooltip = i18n.getText(\"facetPieChartOverflowText2\", [label, maxItemsToShow]);\n                item.filtered = false;\n                item.removed = false;\n                item.fill = \"transparent\";\n                item.stroke = \"none\";\n                item.maxLabelLength = 30;\n                group.push(item);\n                // #############\n            }\n        }\n        return group;\n    }\n\n    directUpdate(facetItems, piechartParent, model, facetTotalCount: number, options): void {\n        let model1;\n        const fewerData = [];\n        const maxItemsToShow = 20; // if needed, 19 items plus one segment for missing percentage of data\n        const application = null;\n        model1 = this.getModel();\n        if (!model1) {\n            model1 = this.getParent().getModel();\n        }\n        options.pieChartParentClass = \"sapUshellSearchFacetPieChartLarge\";\n        options.height = options.relevantContainerHeight;\n        $(piechartParent).parent().parent().parent().height();\n        this.chartElements = this.getDataForPieChartLarge(\n            facetItems,\n            model1,\n            facetTotalCount,\n            maxItemsToShow\n        );\n        const chart = new PieChart(piechartParent, options, application, model1);\n        for (let i = 0; i < maxItemsToShow; i++) {\n            if (this.chartElements[i]) {\n                fewerData.push(this.chartElements[i]);\n            }\n        }\n        chart.update(fewerData);\n    }\n\n    isFacetPanel(): boolean {\n        let domElement = this.getDomRef();\n        while (domElement) {\n            if (domElement.classList.contains(\"sapUshellSearchFacetTabBar\")) {\n                return true;\n            }\n            domElement = domElement.parentElement;\n        }\n        return false;\n    }\n    onAfterRendering(): void {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const that = this;\n        let data, chartElements, chart, piechartParent, facetIndex;\n        const application = null;\n        const settings: Partial<$PieChartSettings> = {};\n\n        const model = this.getModel();\n        if (model) {\n            piechartParent = document.getElementById(this[\"sId\"]);\n\n            // ensure that we are in the 'small pie chart'\n            if (this.isFacetPanel()) {\n                settings.pieChartParentClass = \"sapUshellSearchFacetPieChart\";\n                facetIndex = this.getFacetIndex();\n                if (piechartParent) {\n                    piechartParent.className = settings.pieChartParentClass;\n                }\n                data = this.getDataForPieChart(model.getProperty(\"/facets\"), model, facetIndex);\n                chartElements = data[facetIndex];\n                const aAriaDesc = chartElements.map((chartElement) => {\n                    return chartElement.tooltip;\n                });\n                this.getDomRef().setAttribute(\"aria-label\", aAriaDesc.join(\"; \"));\n                const selectedFacetItem = this.getBindingContext().getObject() as Facet;\n                this.getDomRef().setAttribute(\n                    \"data-test-id-facet-dimension-value\",\n                    `${selectedFacetItem.title}-${selectedFacetItem.dimension}`\n                );\n\n                chart = new this.PieChart(piechartParent, settings, application, model);\n                chart.update(chartElements);\n                // update infozeile\n                const iconTabBar = this.getDomRef().closest(\".sapUshellSearchFacetIconTabBar\");\n                let infoZeile: HTMLElement | null = null;\n                if (iconTabBar) {\n                    infoZeile = iconTabBar.querySelector(\".sapUshellSearchFacetInfoZeile\");\n                }\n                if (infoZeile) {\n                    const oInfoZeile = Element.getElementById(infoZeile.id) as Label;\n                    if (that.iMissingCnt > 0) {\n                        oInfoZeile.setVisible(true);\n                        const message = i18n.getText(\"infoZeileNumberMoreSelected\", [that.iMissingCnt]);\n                        oInfoZeile.setText(message);\n                        oInfoZeile.rerender();\n                    } else {\n                        oInfoZeile.setVisible(false);\n                    }\n                }\n            } else if (\n                piechartParent &&\n                (piechartParent as HTMLElement).className === \"largeChart2piechart\"\n            ) {\n                // pie chart\n                (piechartParent as HTMLElement).setAttribute(\"tabindex\", \"0\");\n            }\n        }\n    }\n}\n\n/*** PIE CHART ***/\nclass PieChart {\n    application;\n    parent: string;\n    model: SearchModel;\n    chartElements: Array<any>;\n    options: any;\n    svg: any;\n    svgArcs: {\n        selectAll: (path: string) => {\n            data: any;\n            each: (...args: Array<any>) => void;\n            remove: () => void;\n        };\n    };\n    svgLabels: {\n        selectAll: (g: any) => {\n            data: any;\n            each: (...args: Array<any>) => void;\n            remove: () => void;\n        };\n    };\n    oldArcs: Array<any>;\n    clickedSegment: any;\n    firstUpdate: boolean;\n    xOrigin: number;\n    yOrigin: number;\n    tweenGenArc: any;\n    tweenGenText: any;\n    arcSequence: Sequence;\n\n    constructor(parentSelector, settings: $PieChartSettings, application: any, model: SearchModel) {\n        this.init(parentSelector, settings, application, model);\n    }\n\n    init(parentSelector, settings: $PieChartSettings, application: any, model: SearchModel) {\n        this.parent = parentSelector;\n        this.application = application;\n        this.model = model;\n        this.chartElements = [];\n        const parent = SearchFacetPieChart.d3.select(parentSelector);\n        let svgHeight = parentSelector instanceof HTMLElement ? parentSelector.offsetHeight : 0;\n        const svgWidth = parentSelector instanceof HTMLElement ? parentSelector.offsetWidth : 0;\n        if (settings.height > svgHeight) {\n            svgHeight = settings.height;\n        }\n        const r = Math.min(svgWidth, svgHeight) / 2;\n        // initialize this.options\n        this.options = {\n            // dimension-angle: \"$count\",\n            \"dimension-pie\": \"YEAR\",\n            backgroundWidth: svgWidth,\n            backgroundHeight: svgHeight,\n            width: svgWidth,\n            height: svgHeight,\n            innerRadius: 0,\n            outerRadius: r * 0.8,\n            tweenGen: PieChart.Tweens.tweenGenSimple,\n            tweenGenText: PieChart.Tweens.tweenGenSimpleText,\n            arcCalculator: PieChart.generateHistoricalArcCalculator(this), // PieChart.generateDefaultArcCalculator(), PieChart.generateHistoricalArcCalculator(),\n            animationduration: 1500,\n            labelHideThreshold: 0.05,\n            easing: \"linear\", // \"linear\";\"poly(4)\";\"quad\";\"cubic\" (default);\"sin\";\"exp\";\"circle\";\"elastic(a, p)\";\"back(s)\";\"bounce\"\n            pieChartClass: \"sap-piechart\",\n            pieChartParentClass: \"sapUshellSearchFacetPieChart\",\n            color: \"blue\",\n            strokewidth: 1,\n            strokewidthHover: 3,\n            padding4click: 7,\n            multipleselectable: true, // if set to false(single selection mode) no hover effect will be provided when any segment already has been clicked\n            oSearchFacetDialog: null,\n        };\n        // move passed in options to this.options\n        if (settings) {\n            for (const field in settings) {\n                this.options[field] = settings[field];\n            }\n        }\n        this.createAttributeService(PieChart, \"innerRadius\", function () {\n            this.init();\n        });\n        this.createAttributeService(PieChart, \"outerRadius\", function () {\n            this.init();\n        });\n        this.createAttributeService(PieChart, \"tweenGen\", function () {\n            this.init();\n        });\n        this.createAttributeService(PieChart, \"tweenGenText\", function () {\n            this.init();\n        });\n        this.createAttributeService(PieChart, \"width\", function () {\n            this.init();\n        });\n        this.createAttributeService(PieChart, \"height\", function () {\n            this.init();\n        });\n        this.createAttributeService(PieChart, \"animationduration\");\n        this.createAttributeService(PieChart, \"labelHideThreshold\");\n        this.createAttributeService(PieChart, \"arcCalculator\");\n        // create global svg elements: parent.append\n        const xOrigin = Math.round(this.options.width / 2);\n        const yOrigin = Math.round(this.options.height / 2);\n        this.svg = parent\n            .append(\"svg:svg\")\n            .attr(\"width\", svgWidth)\n            .attr(\"height\", svgHeight)\n            .attr(\"id\", parentSelector.id + \"_svg\")\n            .append(\"svg:g\")\n            .attr(\"transform\", \"translate(\" + xOrigin + \",\" + yOrigin + \")\");\n        this.svgArcs = this.svg.append(\"svg:g\");\n        this.svgLabels = this.svg.append(\"svg:g\");\n        this.svg.attr(\"class\", this.options.pieChartClass);\n        // initialize svg size and tween functions\n        this.initTween();\n        this.oldArcs = [];\n        // stack of clicked segments\n        this.clickedSegment = {};\n        // mark init state as firstUpdate\n        this.firstUpdate = true;\n    }\n\n    getParent() {\n        return this.parent;\n    }\n\n    static Tweens = (function () {\n        const Tweens1 = {\n            tweenGenSimple: undefined,\n            tweenGenSimpleText: undefined,\n            translateStr4Padding: undefined,\n            tweenGenEcstasy: undefined,\n            tweenGenLSD: undefined,\n        };\n        // animation function generator: Simple\n        // ======================================================================\n        Tweens1.tweenGenSimple = function (d, i, a, innerRadius, outerRadius, svgGenerator) {\n            const s1 = {\n                startAngle: d.oldArc.startAngle,\n                endAngle: d.oldArc.endAngle,\n                innerRadius: innerRadius,\n                outerRadius: outerRadius,\n            };\n            const s2 = {\n                startAngle: d.startAngle,\n                endAngle: d.endAngle,\n                innerRadius: innerRadius,\n                outerRadius: outerRadius,\n            };\n            const j = SearchFacetPieChart.d3.interpolate(s1, s2);\n            return function (t) {\n                return svgGenerator(j(t));\n            };\n        };\n        // animation function generator: Simple Text\n        // ======================================================================\n        Tweens1.tweenGenSimpleText = function (d, i, a, innerRadius, outerRadius, chartInstance, filtered) {\n            let labelText = \" \";\n            if (\n                d.labelElement.childNodes[1] &&\n                d.labelElement.childNodes[1].childNodes[0] &&\n                d.labelElement.childNodes[1].childNodes[0].data\n            ) {\n                labelText = d.labelElement.childNodes[1].childNodes[0].data;\n            }\n            const labelpositionBefore = new Labelposition(\n                chartInstance.options.width,\n                chartInstance.options.height,\n                d.oldArc.startAngle,\n                d.oldArc.endAngle,\n                chartInstance.options.outerRadius,\n                d.labelElement.childNodes[1].getBBox().width,\n                d.labelElement.childNodes[1].getBBox().height,\n                chartInstance.svgArcGen(d).centroid(d),\n                labelText,\n                chartInstance.svg\n            );\n            labelpositionBefore.update();\n            const coordinationBefore = [labelpositionBefore.x, labelpositionBefore.y];\n            const labelpositionAfter = new Labelposition(\n                chartInstance.options.width,\n                chartInstance.options.height,\n                d.startAngle,\n                d.endAngle,\n                chartInstance.options.outerRadius,\n                d.labelElement.childNodes[1].getBBox().width,\n                d.labelElement.childNodes[1].getBBox().height,\n                chartInstance.svgArcGen(d).centroid(d),\n                labelText,\n                chartInstance.svg\n            );\n            labelpositionAfter.update();\n            // in case that label shall be cut\n            if (labelpositionAfter.labelWidth < d.labelElement.childNodes[1].getBBox().width) {\n                chartInstance.adjustLabelWidth(d.labelElement, labelpositionAfter.labelWidth);\n            }\n            const coordinationAfter = [labelpositionAfter.x, labelpositionAfter.y];\n            const j = SearchFacetPieChart.d3.interpolateArray(coordinationBefore, coordinationAfter);\n            const translateStrBuilder = function (coordinate) {\n                let tranlateStr;\n                if (filtered) {\n                    tranlateStr = Tweens1.translateStr4Padding(\n                        d.startAngle,\n                        d.endAngle,\n                        chartInstance.options.padding4click,\n                        coordinate[0],\n                        coordinate[1]\n                    );\n                } else {\n                    tranlateStr = \"translate(\" + coordinate + \")\";\n                }\n                return tranlateStr;\n            };\n            return function (t) {\n                return translateStrBuilder(j(t));\n            };\n        };\n        Tweens1.translateStr4Padding = function (startAngle, endAngle, padding, xOldOrig, yOldOrig) {\n            // cal origin of transformed coordinate system\n            // in case that startangle = 0\n            const apexAngle = endAngle - startAngle;\n            let xNewOrig = padding * Math.sin(apexAngle / 2);\n            let yNewOrig = -(padding * Math.cos(apexAngle / 2));\n            // rotate it by startAngle\n            const tmp = xNewOrig * Math.cos(startAngle) - yNewOrig * Math.sin(startAngle);\n            yNewOrig = xNewOrig * Math.sin(startAngle) + yNewOrig * Math.cos(startAngle);\n            xNewOrig = tmp;\n            const translateStr = \"translate(\" + (xOldOrig + xNewOrig) + \", \" + (yOldOrig + yNewOrig) + \")\";\n            return translateStr;\n        };\n        // animation function generator: Ecstasy\n        // ======================================================================\n        Tweens1.tweenGenEcstasy = function (d, i, a, innerRadius, outerRadius, svgGenerator) {\n            // split\n            const splitRadius = Math.round((innerRadius + outerRadius) / 2);\n            let splitOuterRadius;\n            let splitInnerRadius;\n            if (i % 2) {\n                splitOuterRadius = outerRadius;\n                splitInnerRadius = splitRadius;\n            } else {\n                splitOuterRadius = splitRadius;\n                splitInnerRadius = innerRadius;\n            }\n            let s1 = {\n                startAngle: d.oldArc.startAngle,\n                endAngle: d.oldArc.endAngle,\n                innerRadius: innerRadius,\n                outerRadius: outerRadius,\n            };\n            let s2 = {\n                startAngle: d.oldArc.startAngle,\n                endAngle: d.oldArc.endAngle,\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            const splitInterpolation = SearchFacetPieChart.d3.interpolate(s1, s2);\n            // move + resize\n            s1 = {\n                startAngle: d.oldArc.startAngle,\n                endAngle: d.oldArc.endAngle,\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            s2 = {\n                startAngle: d.startAngle,\n                endAngle: d.endAngle,\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            const resizeInterpolation = SearchFacetPieChart.d3.interpolate(s1, s2);\n            // unify\n            s1 = {\n                startAngle: d.startAngle,\n                endAngle: d.endAngle,\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            s2 = {\n                startAngle: d.startAngle,\n                endAngle: d.endAngle,\n                innerRadius: innerRadius,\n                outerRadius: outerRadius,\n            };\n            const unifyInterpolation = SearchFacetPieChart.d3.interpolate(s1, s2);\n            // assemble total animation function\n            return function (t) {\n                if (t <= 0.25) {\n                    return svgGenerator(splitInterpolation(t * 4));\n                }\n                if (t <= 0.75) {\n                    return svgGenerator(resizeInterpolation((t - 0.25) * 2));\n                }\n                return svgGenerator(unifyInterpolation((t - 0.75) * 4));\n            };\n        };\n        // animation function generator: LSD\n        // ======================================================================\n        Tweens1.tweenGenLSD = function (d, i, a, innerRadius, outerRadius, svgGenerator) {\n            // split\n            const splitRadius = Math.round((innerRadius + outerRadius) / 2);\n            let splitOuterRadius;\n            let splitInnerRadius;\n            if (i % 2) {\n                splitOuterRadius = outerRadius;\n                splitInnerRadius = splitRadius;\n            } else {\n                splitOuterRadius = splitRadius;\n                splitInnerRadius = innerRadius;\n            }\n            let s1 = {\n                startAngle: d.oldArc.startAngle,\n                endAngle: d.oldArc.endAngle,\n                innerRadius: innerRadius,\n                outerRadius: outerRadius,\n            };\n            let s2 = {\n                startAngle: d.oldArc.startAngle,\n                endAngle: d.oldArc.endAngle,\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            const splitInterpolation = SearchFacetPieChart.d3.interpolate(s1, s2);\n            // move\n            s1 = {\n                startAngle: d.oldArc.startAngle,\n                endAngle: d.oldArc.endAngle,\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            s2 = {\n                startAngle: d.startAngle,\n                endAngle: d.startAngle + (d.oldArc.endAngle - d.oldArc.startAngle),\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            const moveInterpolation = SearchFacetPieChart.d3.interpolate(s1, s2);\n            // resize\n            s1 = {\n                startAngle: d.startAngle,\n                endAngle: d.startAngle + (d.oldArc.endAngle - d.oldArc.startAngle),\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            s2 = {\n                startAngle: d.startAngle,\n                endAngle: d.endAngle,\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            const resizeInterpolation = SearchFacetPieChart.d3.interpolate(s1, s2);\n            // unify\n            s1 = {\n                startAngle: d.startAngle,\n                endAngle: d.endAngle,\n                innerRadius: splitInnerRadius,\n                outerRadius: splitOuterRadius,\n            };\n            s2 = {\n                startAngle: d.startAngle,\n                endAngle: d.endAngle,\n                innerRadius: innerRadius,\n                outerRadius: outerRadius,\n            };\n            const unifyInterpolation = SearchFacetPieChart.d3.interpolate(s1, s2);\n            // assemble total animation function\n            return function (t) {\n                if (t <= 0.25) {\n                    return svgGenerator(splitInterpolation(t * 4));\n                }\n                if (t <= 0.5) {\n                    return svgGenerator(moveInterpolation((t - 0.25) * 4));\n                }\n                if (t <= 0.75) {\n                    return svgGenerator(resizeInterpolation((t - 0.5) * 4));\n                }\n                return svgGenerator(unifyInterpolation((t - 0.75) * 4));\n            };\n        };\n        return Tweens1;\n    })();\n    // create attribute get and set services\n    // ======================================================================\n    createAttributeService(cls, attribute, initFunction?: () => void) {\n        cls.prototype[attribute] = function (value) {\n            if (value === null) {\n                return this.options[attribute];\n            }\n            this.options[attribute] = value;\n            if (initFunction) {\n                initFunction.call(this);\n            }\n            return this;\n        };\n    }\n    // initialization of tween function\n    // ======================================================================\n    initTween() {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const that = this;\n        that.xOrigin = Math.round(that.options.width / 2);\n        that.yOrigin = Math.round(that.options.height / 2);\n        // adjust size\n        that.svg.attr(\"width\", this.options.width).attr(\"height\", this.options.height);\n        // tween function generator: generates tween function for svg:path\n        this.tweenGenArc = function (d, i, a) {\n            return that.options.tweenGen(\n                d,\n                i,\n                a,\n                that.options.innerRadius,\n                that.options.outerRadius,\n                that.svgArcGen(d)\n            );\n        };\n        // tween function generator: generates tween function for svg:text\n        this.tweenGenText = function (d, i, a, filtered) {\n            return that.options.tweenGenText(\n                d,\n                i,\n                a,\n                that.options.innerRadius,\n                that.options.outerRadius,\n                that,\n                filtered\n            );\n        };\n    }\n    // update (draw) pie chart\n    // ======================================================================\n    update(data) {\n        this.notAnimatedUpdate(data);\n    }\n    notAnimatedUpdate(data) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const that = this;\n        let arcs = [];\n        if (!data) {\n            return;\n        }\n        this.chartElements = data;\n        // remove old elements\n        that.svgArcs.selectAll(\"path\").remove();\n        that.svgLabels.selectAll(\"g\").remove();\n        // ------------------------------------------------------------------\n        // 0. calculate percentage\n        // ------------------------------------------------------------------\n        let totalValue = 0;\n        for (let i = 0; i < data.length; ++i) {\n            totalValue += data[i].value;\n        }\n        for (let j = 0; j < data.length; ++j) {\n            data[j].percentage = data[j].value / totalValue;\n        }\n        // ------------------------------------------------------------------\n        // 1. arc calculation\n        // ------------------------------------------------------------------\n        arcs = this.options.arcCalculator.calculateNewArcsOnly(data);\n        // ------------------------------------------------------------------\n        // 2. update arcs\n        // ------------------------------------------------------------------\n        // data binding\n        let sel = this.svgArcs.selectAll(\"path\").data(arcs, PieChart.getIdOfArc);\n        // remove old arcs\n        if (!sel.exit().empty()) {\n            sel.exit().remove();\n        }\n        // change existing arcs + change size to zero for arcs to be removed and then remove them\n        if (!sel.empty()) {\n            sel.attr(\"d\", function (d) {\n                const path = that.svgArcGen(d);\n                return path(d);\n            })\n                .attr(\"transform\", function (d) {\n                    let translateStr;\n                    if (d.data.selected) {\n                        translateStr = PieChart.translateStr4Padding(\n                            d.startAngle,\n                            d.endAngle,\n                            that.options.padding4click,\n                            0,\n                            0\n                        );\n                    } else {\n                        translateStr = \"translate(0,0)\";\n                    }\n                    return translateStr;\n                })\n                .style(\"stroke\", function (d) {\n                    let strokeColor;\n                    if (d.data.stroke === \"none\") {\n                        strokeColor = d.data.stroke;\n                    } else if (d.data.selected || d.data.hovered) {\n                        strokeColor = \"#dadada\";\n                    } else {\n                        strokeColor = \"white\";\n                    }\n                    return strokeColor;\n                })\n                .style(\"stroke-width\", function (d) {\n                    let strokeWidth;\n                    if (d.data.selected || d.data.hovered) {\n                        strokeWidth = that.options.strokewidthHover;\n                    } else {\n                        strokeWidth = that.options.strokewidth;\n                    }\n                    return strokeWidth;\n                })\n                .style(\"opacity\", function (d) {\n                    let opacityValue;\n                    if (d.data.selected || d.data.hovered) {\n                        opacityValue = \"1\";\n                    } else if (d.data.initial) {\n                        opacityValue = \"0.75\";\n                    } else {\n                        opacityValue = \"0.5\";\n                    }\n                    return opacityValue;\n                })\n                .each(function (d) {\n                    while (this.hasChildNodes()) {\n                        this.removeChild(this.lastChild);\n                    }\n                    SearchFacetPieChart.d3\n                        .select(this)\n                        .append(\"svg:title\")\n                        .text(\"\" + d.data.tooltip);\n                });\n        }\n        // create new arcs\n        sel.enter()\n            .append(\"svg:path\")\n            .attr(\"data-label\", (d) => d.data.label)\n            .attr(\"transform\", function (d) {\n                let translateStr;\n                if (d.data.selected) {\n                    // in case that any clicked segments already existing (_onLarge,_onSmall, switch between bar and pie)\n                    that.clickedSegment[d.data.id] = this;\n                    translateStr = PieChart.translateStr4Padding(\n                        d.startAngle,\n                        d.endAngle,\n                        that.options.padding4click,\n                        0,\n                        0\n                    );\n                }\n                return translateStr;\n            })\n            .attr(\"shape-rendering\", \"geometricPrecision\")\n            .attr(\"tabindex\", \"0\")\n            .style(\"stroke\", function (d) {\n                let strokeColor;\n                if (d.data.stroke === \"none\") {\n                    strokeColor = d.data.stroke;\n                } else if (d.data.selected || d.data.hovered) {\n                    strokeColor = \"#dadada\";\n                } else {\n                    strokeColor = \"white\";\n                }\n                return strokeColor;\n            })\n            .style(\"stroke-width\", function (d) {\n                let strokeWidth;\n                if (d.data.selected || d.data.hovered) {\n                    strokeWidth = that.options.strokewidthHover;\n                } else {\n                    strokeWidth = that.options.strokewidth;\n                }\n                return strokeWidth;\n            })\n            .style(\"opacity\", function (d) {\n                let opacityValue;\n                if (d.data.selected || d.data.hovered) {\n                    opacityValue = \"1\";\n                } else if (d.data.initial) {\n                    opacityValue = \"0.75\";\n                } else {\n                    opacityValue = \"0.5\";\n                }\n                return opacityValue;\n            })\n            .attr(\"fill\", function (d) {\n                return d.data.fill;\n            })\n            .on(\"keydown\", function () {\n                const e = SearchFacetPieChart.d3.event;\n                const code = e.keyCode || e.which;\n                if (code == 32) {\n                    e.target.__onclick();\n                }\n            })\n            .on(\"click\", function (d, i) {\n                let oEvent;\n                if (d.data.click && d.data.pieupdateuionly === false) {\n                    const returnCode = d.data.click(d, i);\n                    if (!that.options.multipleselectable && !returnCode) {\n                        return;\n                    }\n                }\n                let translateStr, translateStrLabel;\n                let labelposition;\n                const labelElem = that.getLabelElementtbyLabel(d.data.label);\n                if (labelElem) {\n                    let labelText = \" \";\n                    if (\n                        labelElem.childNodes[1] &&\n                        labelElem.childNodes[1].childNodes[0] &&\n                        labelElem.childNodes[1].childNodes[0].data\n                    ) {\n                        labelText = labelElem.childNodes[1].childNodes[0].data;\n                    }\n                    labelposition = new Labelposition(\n                        that.options.width,\n                        that.options.height,\n                        d.startAngle,\n                        d.endAngle,\n                        that.options.outerRadius,\n                        labelElem.childNodes[1].getBoundingClientRect().width,\n                        labelElem.childNodes[1].getBoundingClientRect().height,\n                        that.svgArcGen(d).centroid(d),\n                        labelText,\n                        that.svg\n                    );\n                    labelposition.update();\n                    // in case that label shall be cut\n                    if (labelposition.labelWidth < labelElem.childNodes[1].getBoundingClientRect().width) {\n                        that.adjustLabelWidth(labelElem, labelposition.labelWidth);\n                    }\n                }\n                if (d.data.selected) {\n                    // already clicked,unclick\n                    if (!that.options.multipleselectable && Object.keys(that.clickedSegment).length > 0) {\n                        // delete existing segment from stack\n                        delete that.clickedSegment[d.data.id];\n                    }\n                    // back to old origin\n                    translateStr = \"translate(0,0)\";\n                    if (labelElem) {\n                        translateStrLabel = \"translate(\" + labelposition.x + \",\" + labelposition.y + \")\";\n                    }\n                    // ################################################### remove filter\n                    //  avr - remove filter\n                    // ###################################################\n                    d.data.selected = false; // avr hack for large pie chart\n                    if (that.options.oSearchFacetDialog) {\n                        oEvent = {}; // build object to pass to external fn\n                        oEvent.cnt = that.getNumberOfClickedSegments();\n                        oEvent.dataObject = d.data;\n                        that.options.oSearchFacetDialog.onDetailPageSelectionChangeCharts(oEvent);\n                    } else {\n                        that.model.removeFilterCondition(d.data.filterCondition, true);\n                    }\n                } else {\n                    // click (non animated)\n                    if (!that.options.multipleselectable) {\n                        // single selection mode, check whether already any segment was clicked\n                        if (Object.keys(that.clickedSegment).length > 0) {\n                            // not blank\n                            for (const key in that.clickedSegment) {\n                                // existing segment goes back to origin\n                                // simulate click event on it\n                                // log.debug(\"clicking new segments : \" + key + \"value: \" + that.clickedSegment[key]);\n                                const clickedSegment = that.clickedSegment[key];\n                                if (typeof clickedSegment.__onclick === \"function\") {\n                                    clickedSegment.__data__.data.pieupdateuionly = true;\n                                    clickedSegment.__onclick.apply(clickedSegment);\n                                }\n                                // delete existing segment from stack\n                                delete that.clickedSegment[key];\n                            }\n                        }\n                        if (Object.keys(that.clickedSegment).length < 1) {\n                            that.clickedSegment[d.data.id] = this;\n                        }\n                    }\n\n                    translateStr = PieChart.translateStr4Padding(\n                        d.startAngle,\n                        d.endAngle,\n                        that.options.padding4click,\n                        0,\n                        0\n                    );\n                    if (labelElem) {\n                        translateStrLabel = PieChart.translateStr4Padding(\n                            d.startAngle,\n                            d.endAngle,\n                            that.options.padding4click,\n                            labelposition.x,\n                            labelposition.y\n                        );\n                    }\n                    // ################################################### add filter\n                    //   avr - add new filter\n                    // ###################################################\n                    d.data.selected = true; // avr hack for large pie chart\n                    if (d.data.filterCondition) {\n                        if (that.options.oSearchFacetDialog) {\n                            oEvent = {}; // build object to pass to external fn\n                            oEvent.cnt = that.getNumberOfClickedSegments();\n                            oEvent.dataObject = d.data;\n                            that.options.oSearchFacetDialog.onDetailPageSelectionChangeCharts(oEvent);\n                        } else {\n                            that.model.addFilterCondition(d.data.filterCondition, true);\n                        }\n                    }\n                }\n                SearchFacetPieChart.d3\n                    .select(this)\n                    .transition()\n                    .duration(1000)\n                    .ease(SearchFacetPieChart.d3.ease(\"elastic\"))\n                    .attr(\"transform\", translateStr)\n                    .style(\"stroke\", (d) => {\n                        let strokeColor;\n                        if (d.data.stroke === \"none\") {\n                            strokeColor = d.data.stroke;\n                        } else if (d.data.selected) {\n                            strokeColor = \"#dadada\";\n                        } else {\n                            strokeColor = \"white\";\n                        }\n                        return strokeColor;\n                    })\n                    .style(\"stroke-width\", (d) => {\n                        let strokeWidth;\n                        if (d.data.selected) {\n                            strokeWidth = that.options.strokewidthHover;\n                        } else {\n                            strokeWidth = that.options.strokewidth;\n                        }\n                        return strokeWidth;\n                    })\n                    .style(\"opacity\", (d) => {\n                        let opacityValue;\n                        if (d.data.selected || d.data.hovered) {\n                            opacityValue = \"1\";\n                        } else if (d.data.initial) {\n                            opacityValue = \"0.75\";\n                        } else {\n                            opacityValue = \"0.5\";\n                        }\n                        return opacityValue;\n                    });\n                // transform corresponding label\n                const labelElement = that.getLabelElementtbyLabel(d.data.label);\n                if (labelElement) {\n                    SearchFacetPieChart.d3\n                        .select(labelElement)\n                        .transition()\n                        .duration(1000)\n                        .ease(SearchFacetPieChart.d3.ease(\"elastic\"))\n                        .attr(\"transform\", translateStrLabel);\n                }\n            })\n            .on(\"mouseover\", function (d, i) {\n                // no hover event for single selection mode when any segment already has been clicked\n                if (!that.options.multipleselectable && Object.keys(that.clickedSegment).length > 0) {\n                    return;\n                }\n                // no hover event for a clicked segment\n                if (d.data.selected || d.data.hovered) {\n                    return;\n                }\n                if (d.data.mouseover) {\n                    const returnCode = d.data.mouseover(d, i);\n                    if (!that.options.multipleselectable && !returnCode) {\n                        return;\n                    }\n                }\n            })\n            .on(\"mouseout\", function (d, i) {\n                if (d.data.selected) {\n                    SearchFacetPieChart.d3.select(this).style(\"opacity\", 1);\n                }\n                // no hover event for single selection mode when any segment already has been clicked\n                if (!that.options.multipleselectable && Object.keys(that.clickedSegment).length > 0) {\n                    return;\n                }\n                // no hover event for a clicked segment\n                if (d.data.selected) {\n                    return;\n                }\n                if (d.data.mouseout) {\n                    const returnCode = d.data.mouseout(d, i);\n                    if (!that.options.multipleselectable && !returnCode) {\n                        return;\n                    }\n                }\n            })\n            .attr(\"d\", (d) => {\n                const path = that.svgArcGen(d);\n                return path(d);\n            })\n            .append(\"svg:title\")\n            .text((d) => {\n                return \"\" + d.data.tooltip;\n            });\n        // ------------------------------------------------------------------\n        // 3. update labels of arcs\n        // ------------------------------------------------------------------\n        // data binding\n        sel = that.svgLabels.selectAll(\"g\").data(arcs, PieChart.getIdOfArc);\n        // remove\n        if (!sel.exit().empty()) {\n            sel.exit().remove();\n        }\n        // change existing labels + remove labels\n        if (!sel.empty()) {\n            sel.style(\"opacity\", function (d) {\n                if (d.removed || d.data.percentage < that.options.labelHideThreshold) {\n                    return 0;\n                }\n                return 1;\n            }).attr(\"transform\", function (d) {\n                let translateStr;\n                let labelposition;\n                if (this.childNodes[1] && this.childNodes[1].childNodes[0]) {\n                    labelposition = new Labelposition(\n                        that.options.width,\n                        that.options.height,\n                        d.startAngle,\n                        d.endAngle,\n                        that.options.outerRadius,\n                        this.getBoundingClientRect().width,\n                        this.getBoundingClientRect().height,\n                        that.svgArcGen(d).centroid(d),\n                        d.data.label,\n                        that.svg\n                    );\n                    // log.debug(\"non animation change/remove existing labels, text exists: \", this.childNodes[1].childNodes[0].data);\n                } else {\n                    labelposition = new Labelposition(\n                        that.options.width,\n                        that.options.height,\n                        d.startAngle,\n                        d.endAngle,\n                        that.options.outerRadius,\n                        this.getBoundingClientRect().width,\n                        this.getBoundingClientRect().height,\n                        that.svgArcGen(d).centroid(d),\n                        \" \",\n                        that.svg\n                    );\n                    // log.debug(\"non animation change/remove existing labels, no existing text \");\n                }\n                labelposition.update();\n                // in case that label shall be cut\n                if (labelposition.labelWidth < this.childNodes[1].getBoundingClientRect().width) {\n                    that.adjustLabelWidth(this, labelposition.labelWidth);\n                }\n                // translate all texts that.options.padding4arcs in outer direction\n                if (d.data.selected) {\n                    translateStr = PieChart.translateStr4Padding(\n                        d.startAngle,\n                        d.endAngle,\n                        that.options.padding4click,\n                        labelposition.x,\n                        labelposition.y\n                    );\n                } else {\n                    translateStr = \"translate(\" + labelposition.x + \",\" + labelposition.y + \")\";\n                }\n                return translateStr;\n            });\n        }\n        if (!sel.enter().empty()) {\n            // create new labels\n            const textsG = sel.enter().append(\"svg:g\").style(\"opacity\", 0);\n            textsG\n                .append(\"svg:text\")\n                .attr(\"class\", \"labelshadow\")\n                .attr(\"text-anchor\", \"middle\")\n                .text(function (d) {\n                    return \"\" + d.data.label;\n                })\n                .style(\"pointer-events\", \"none\");\n            textsG\n                .append(\"svg:text\")\n                .attr(\"class\", \"label\")\n                .attr(\"text-anchor\", \"middle\")\n                .text(function (d) {\n                    return \"\" + d.data.label;\n                })\n                .style(\"pointer-events\", \"none\");\n            textsG\n                .style(\"opacity\", function (d) {\n                    if (d.removed || d.data.percentage < that.options.labelHideThreshold) {\n                        return 0;\n                    }\n                    return 1;\n                })\n                .attr(\"transform\", function (d) {\n                    let translateStr;\n                    // log.debug(\"non animation new labels, text exists: \", this.childNodes[1].childNodes[0].data);\n                    const labelposition = new Labelposition(\n                        that.options.width,\n                        that.options.height,\n                        d.startAngle,\n                        d.endAngle,\n                        that.options.outerRadius,\n                        this.getBoundingClientRect().width,\n                        this.getBoundingClientRect().height,\n                        that.svgArcGen(d).centroid(d),\n                        d.data.label,\n                        that.svg\n                    );\n                    labelposition.update();\n                    // in case that label shall be cut\n                    if (labelposition.labelWidth < this.childNodes[1].getBoundingClientRect().width) {\n                        that.adjustLabelWidth(this, labelposition.labelWidth);\n                    }\n                    // translate all texts that.options.padding4arcs in outer direction\n                    if (d.data.selected) {\n                        translateStr = PieChart.translateStr4Padding(\n                            d.startAngle,\n                            d.endAngle,\n                            that.options.padding4click,\n                            labelposition.x,\n                            labelposition.y\n                        );\n                    } else {\n                        translateStr = \"translate(\" + labelposition.x + \",\" + labelposition.y + \")\";\n                    }\n                    return translateStr;\n                });\n        }\n        // save arcs for next update call (removed arcs are no longer needed)\n        that.oldArcs = PieChart.removeDeletedArcs(arcs);\n    }\n    getNumberOfClickedSegments(): number {\n        let cnt = 0;\n        const ar = this.chartElements;\n        for (let i = 0; i < ar.length; i++) {\n            if (ar[i].selected === true) {\n                cnt++;\n            }\n        }\n        return cnt;\n    }\n    // cut label to target widthl\n    // ======================================================================\n    adjustLabelWidth(element, targetWidth) {\n        const shadowElement = element.childNodes[0];\n        const textElement = element.childNodes[1];\n        // just remove all children when targetWidth is 0\n        if (targetWidth <= 0) {\n            shadowElement.childNodes[0].data = \"\";\n            textElement.childNodes[0].data = \"\";\n            return;\n        }\n        let textLength = shadowElement.childNodes[0].data.length;\n        shadowElement.childNodes[0].data += \"...\";\n        let tmpText = \"\";\n        while (shadowElement.getBBox().width > targetWidth) {\n            tmpText = shadowElement.childNodes[0].data;\n            tmpText = tmpText.substr(0, textLength - 1) + tmpText.substr(textLength, 3);\n            shadowElement.childNodes[0].data = tmpText;\n            textLength--;\n            if (textLength <= 0) {\n                shadowElement.childNodes[0].data = \"\";\n                break;\n            }\n        }\n        textElement.childNodes[0].data = shadowElement.childNodes[0].data;\n        // log.debug(\"label svg width:\", shadowElement.getBBox().width, \" label text: \", shadowElement.childNodes[0].data, \" targetWidth: \", targetWidth, \" original text: \", originalText, \" originBoundingWidth: \", originBoundingWidth);\n    }\n    // get arcs with label\n    // ======================================================================\n    getArcsWithLabel(arcs): Array<any> {\n        const arcsWithLabel = [];\n        for (let i = 0; i < arcs.length; ++i) {\n            const arc = arcs[i];\n            if (arc.data.percentage > this.options.labelHideThreshold) {\n                arcsWithLabel.push(arc);\n            }\n        }\n        return arcsWithLabel;\n    }\n    // function for generating the svg:path of the d attribute from an arc\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    svgArcGen(...args: Array<any>) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        const that = this;\n        const a = SearchFacetPieChart.d3.svg\n            .arc()\n            .innerRadius(function () {\n                return that.options.innerRadius;\n            })\n            .outerRadius(function () {\n                return that.options.outerRadius;\n            })\n            .startAngle((d) => {\n                return d.startAngle;\n            })\n            .endAngle((d) => {\n                return d.endAngle;\n            });\n        return a;\n    }\n    // get arc dom element by label\n    // ======================================================================\n    getArcElementtbyLabel(label) {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        let that = this; // ToDo, try to get rid of 'that' but take care, it is reassigned\n        that.svgArcs.selectAll(\"g\").each(function (data) {\n            if (data.data.label === label) {\n                // eslint-disable-next-line @typescript-eslint/no-this-alias\n                that = this;\n            }\n            return;\n        });\n        return that;\n    }\n    // get label element by label\n    // ======================================================================\n    getLabelElementtbyLabel(label): any {\n        // eslint-disable-next-line @typescript-eslint/no-this-alias\n        let that = this; // ToDo, try to get rid of 'that' but take care, it is reassigned\n        that.svgLabels.selectAll(\"g\").each(function (data) {\n            if (data.data.label === label) {\n                // eslint-disable-next-line @typescript-eslint/no-this-alias\n                that = this;\n            }\n        });\n        return that;\n    }\n    // helper: remove deleted arcs\n    // ======================================================================\n    static removeDeletedArcs(arcs) {\n        const tmpArcs = [];\n        for (let i = 0; i < arcs.length; ++i) {\n            const arc = arcs[i];\n            if (!arc.removed) {\n                tmpArcs.push(arc);\n            }\n        }\n        return tmpArcs;\n    }\n    // helper: create zero sized arc\n    // ======================================================================\n    static createZeroArc(angle, element) {\n        return {\n            startAngle: angle,\n            endAngle: angle,\n            data: element,\n            removed: true,\n        };\n    }\n    // helper: insert zero sized arc after insertIndex into arcs\n    // ======================================================================\n    insertAfter(arcs, insertIndex, arc) {\n        let newArc;\n        if (insertIndex >= 0) {\n            const beforeArc = arcs[insertIndex];\n            newArc = PieChart.createZeroArc(beforeArc.endAngle, arc.data);\n        } else {\n            newArc = PieChart.createZeroArc(0, arc.data);\n        }\n        newArc.oldArc = arc;\n        arcs.splice(insertIndex + 1, 0, newArc);\n    }\n    // helper: get id of arc\n    // ======================================================================\n    static getIdOfArc(arc) {\n        return arc.data.id;\n    }\n    // function for generating an arc from a element\n    // ======================================================================\n    static arcsGen = function () {\n        return SearchFacetPieChart.d3.layout\n            .pie()\n            .value(function (d) {\n                return d.value;\n            })\n            .sort(null);\n    };\n    // helper: get index of arc with given id in arcs\n    // ======================================================================\n    static getIndexById(arcs, id) {\n        for (let i = 0; i < arcs.length; ++i) {\n            const arc = arcs[i];\n            if (PieChart.getIdOfArc(arc) === id) {\n                return i;\n            }\n        }\n        return null;\n    }\n    // helper: add new data (if any) to arcSequence before sort (only for IE)\n    // ie sort has reverse order of parameter comparing to FF and Chrome\n    // ======================================================================\n    static add2arcSequence(data, arcSequence) {\n        if (SearchFacetPieChart.isIE()) {\n            const addNewData2Sequence = function (x) {\n                arcSequence.getIndex(x.id);\n            };\n            data.forEach(addNewData2Sequence);\n        }\n        return data;\n    }\n    // helper: get translate string of a arc with giving padding\n    // ======================================================================\n    static translateStr4Padding(startAngle, endAngle, padding, xOldOrig, yOldOrig) {\n        // cal origin of transformed coordinate system (in case startangle = 0)\n        const apexAngle = endAngle - startAngle;\n        let xNewOrig = padding * Math.sin(apexAngle / 2);\n        let yNewOrig = -(padding * Math.cos(apexAngle / 2));\n        // rotate it by startAngle\n        const tmp = xNewOrig * Math.cos(startAngle) - yNewOrig * Math.sin(startAngle);\n        yNewOrig = xNewOrig * Math.sin(startAngle) + yNewOrig * Math.cos(startAngle);\n        xNewOrig = tmp;\n        const translateStr = \"translate(\" + (xOldOrig + xNewOrig) + \", \" + (yOldOrig + yNewOrig) + \")\";\n        return translateStr;\n    }\n    // generator: default arc calculation\n    // ======================================================================\n    generateDefaultArcCalculator(): DefaultArcCalculator {\n        return new DefaultArcCalculator(this);\n    }\n    // calculate new arcs based on new data\n    // ======================================================================\n    calculateNewArcsOnly(data) {\n        // sort data\n        data = data.slice();\n        // ie sort has reverse order of parameter comparing to FF and Chrome\n        // new data has to be added (if any) to sequence at first, only necessary for IE\n        PieChart.add2arcSequence(data, this.arcSequence);\n        data.sort((a, b) => {\n            return this.arcSequence.getIndex(a.id) - this.arcSequence.getIndex(b.id);\n        });\n        // calculate new arcs based on new data\n        const newArcs = PieChart.arcsGen()(data);\n        return newArcs;\n    }\n    // calculate new arcs based on old arcs + new data\n    // ======================================================================\n    calculateArcs(oldArcs, data) {\n        const newArcs = PieChart.arcsGen()(data);\n        // insert new elements with size 0 (startAngle=endAngle) into old arcs\n        this.insertMissingArcs(oldArcs, newArcs, true);\n        // insert removed elements with size 0 (startAngle=endAngle) into new arcs\n        this.insertMissingArcs(newArcs, oldArcs, false);\n        return newArcs;\n    }\n    // insert arcs included in arcs2 but not in arcs1 into arcs1\n    // ======================================================================\n    insertMissingArcs(arcs1, arcs2, ic) {\n        let arc1InsertIndex = -1;\n        for (let arc2Index = 0; arc2Index < arcs2.length; ++arc2Index) {\n            const arc2 = arcs2[arc2Index];\n            const arc1Index = PieChart.getIndexById(arcs1, arc2.data.id);\n            let arc1;\n            if (arc1Index !== null) {\n                // --------------------------------------------------------\n                // 1) there is a corresponding arc in arcs1\n                // --------------------------------------------------------\n                arc1 = arcs1[arc1Index];\n                arc1.oldArc = arc2;\n                arc1InsertIndex = arc1Index;\n                continue;\n            } else {\n                // --------------------------------------------------------\n                // 2) no corresponding arc in arcs1 -> create zero sized arc\n                // --------------------------------------------------------\n                if (ic) {\n                    arc1InsertIndex = this.determineInsertIndex(arcs1, arc1InsertIndex, arcs2, arc2Index);\n                }\n                let newArc;\n                if (arc1InsertIndex >= 0) {\n                    const beforeArc = arcs1[arc1InsertIndex];\n                    newArc = PieChart.createZeroArc(beforeArc.endAngle, arc2.data);\n                } else {\n                    newArc = PieChart.createZeroArc(0, arc2.data);\n                }\n                newArc.oldArc = arc2;\n                arcs1.splice(arc1InsertIndex + 1, 0, newArc);\n                arc1InsertIndex++;\n            }\n        }\n    }\n    // determination of insertion index\n    // ======================================================================\n    determineInsertIndex(arcs1, arc1InsertIndex, arcs2, arc2Index) {\n        // determination is based on\n        // (1) historical information (this.arcSequence)\n        // (2) only arcs to be removed can be overtaken\n        // initialization\n        const arc2 = arcs2[arc2Index];\n        const sequenceIndex = this.arcSequence.getIndex(arc2.data.id);\n        let index;\n        // determine index\n        for (index = arc1InsertIndex + 1; index < arcs1.length; ++index) {\n            const sequenceIndex2 = this.arcSequence.getIndex(arcs1[index].data.id);\n            // exit condition based on historial information\n            if (sequenceIndex2 > sequenceIndex) {\n                break;\n            }\n            // exit condition: only arcs to be removed can be overtaken\n            if (PieChart.getIndexById(arcs2, arcs1[index].data.id) !== null) {\n                break;\n            }\n        }\n        return index - 1;\n    }\n    // generator: historical arc calculation\n    // ======================================================================\n    static generateHistoricalArcCalculator(pieChart: PieChart, ...args: Array<any>): HistoricalArcCalculator {\n        return new HistoricalArcCalculator(pieChart, args);\n    }\n}\n\n/*** LABEL POSITIO ***/\n// helper class for label positioning\n// ======================================================================\n\nclass Labelposition {\n    x: number;\n    y: number;\n    backgroundWidth: number;\n    backgroundHeight: number;\n    startAngle: number;\n    endAngle: number;\n    r: number; // radius\n    labelPaddingX: number;\n    labelPaddingY: number;\n    radiusPadding: number;\n    labelWidth: number;\n    labelHeight: number;\n    outsetMin: number;\n    outsetMax: number;\n    outsetStep: number;\n    apexAngle: number;\n    startLabelWidth: number;\n    d3centroid: any;\n    text: string;\n    svgBackground: SvgBackground;\n    translateStr: string;\n    debug: boolean;\n\n    constructor(\n        backgroundWidth: number,\n        backgroundHeight: number,\n        startAngle: number,\n        endAngle: number,\n        r: number,\n        labelWidth: number,\n        labelHeight: number,\n        d3centroid: any,\n        text: string,\n        svgBackground: SvgBackground\n    ) {\n        this.backgroundWidth = backgroundWidth;\n        this.backgroundHeight = backgroundHeight;\n        this.startAngle = startAngle;\n        this.endAngle = endAngle;\n        this.r = r;\n        this.labelPaddingX = 3;\n        this.labelPaddingY = 3;\n        this.radiusPadding = 4.24;\n        this.labelWidth = labelWidth + 2 * this.labelPaddingX;\n        this.labelHeight = labelHeight;\n        this.outsetMin = 0.3;\n        this.outsetMax = 1.2;\n        this.outsetStep = 0.025;\n        this.apexAngle = endAngle - startAngle;\n        this.startLabelWidth = this.labelWidth;\n        this.d3centroid = d3centroid;\n        this.text = text;\n        this.svgBackground = svgBackground;\n        this.debug = false;\n        this.labelHeight = this.labelHeight + 2 * this.labelPaddingY;\n        const xOrigin = Math.round(this.backgroundWidth / 2);\n        const yOrigin = Math.round(this.backgroundHeight / 2);\n        // translation to center\n        this.translateStr = \"translate(\" + xOrigin + \",\" + yOrigin + \")\";\n    }\n    update() {\n        // log.debug(\"\");\n        // log.debug(\"**** new calculation with parameters start:\", (this.startAngle * 360) / (2 * Math.PI), \" size:\", (this.apexAngle * 360) / (2 * Math.PI));\n        // log.debug(\"**** Labelwidth:\", this.labelWidth, \" d3centroid:\", this.d3centroid, \" label text:\", this.text);\n        let outset = Math.max(\n            this.outsetMin,\n            ((Math.sin(this.apexAngle / 2) / (this.apexAngle / 2)) * 2) / 3\n        ); // Outset for centroid (Schwerpunkt) of segment\n        let placementSuccessful = true;\n        let iterations = Math.max(100, this.labelWidth * 2, 1 / this.outsetStep);\n        let optimizationDirection = 0;\n        let c;\n        do {\n            placementSuccessful = true;\n            c = this.calc(outset, this.labelWidth);\n            if (outset > this.outsetMax || outset < this.outsetMin) {\n                // log.debug(\"outset became too small or too large. END\");\n                break;\n            }\n            if (this.labelWidth < 0) {\n                break;\n            }\n            // log.debug(\"outset\", outset);\n            let c1, c2, c1v, c2v;\n            if (optimizationDirection === 0) {\n                // direction not determined\n                /// calculate new proposed solution\n                c1 = this.calc(outset + this.outsetStep, this.labelWidth);\n                c2 = this.calc(outset - this.outsetStep, this.labelWidth);\n                /// value solutions\n                c1v = this.value(c1, c);\n                c2v = this.value(c2, c);\n                // log.debug(\"           current \", \" labelShortened\", c.labelShortened, \"labelWidth\", c.labelWidth, \"xSpace\", c.xSpace, \"asymmetry\", c.asymmetry, \" x:\", c.centroidX, \" y:\", c.centroidY);\n                // log.debug(\"           outset++\", \" labelShortened\", c1.labelShortened, \"labelWidth\", c1.labelWidth, \"xSpace\", c1.xSpace, \"asymmetry\", c1.asymmetry, \" value=>\", c1v, \" x:\", c1.centroidX, \" y:\", c.centroidY);\n                // log.debug(\"           outset--\", \" labelShortened\", c2.labelShortened, \"labelWidth\", c2.labelWidth, \"xSpace\", c2.xSpace, \"asymmetry\", c2.asymmetry, \"value=>\", c2v, \" x:\", c2.centroidX, \" y:\", c.centroidY);\n                if (c1v < c2v && c2v > 0.5) {\n                    // further inwards is better\n                    optimizationDirection = -1;\n                    // log.debug(\"           -> going inwards\");\n                    outset += this.outsetStep * optimizationDirection;\n                    placementSuccessful = false; // try again, we are not finished yet\n                } else if (c1v > 0.5 || c.labelWidth <= 0) {\n                    // outwards is better, or equal,   if text cannot be placed, try going outwards\n                    optimizationDirection = 1;\n                    // log.debug(\"           -> going outwards\");\n                    outset += this.outsetStep * optimizationDirection;\n                    placementSuccessful = false;\n                }\n            } else {\n                c1 = this.calc(outset + this.outsetStep * optimizationDirection, this.labelWidth);\n                c1v = this.value(c1, c);\n                // log.debug(\"           current \", \" labelShortened\", c.labelShortened, \"labelWidth\", c.labelWidth, \"xSpace\", c.xSpace, \"asymmetry\", c.asymmetry, \" x:\", c.centroidX, \" y:\", c.centroidY);\n                // log.debug(\"           outset+-\", \"labelShortened\", c1.labelShortened, \"labelWidth\", c1.labelWidth, \"xSpace\", c1.xSpace, \"asymmetry\", c1.asymmetry, \" value=>\", c1v, \" x:\", c1.centroidX, \" y:\", c.centroidY);\n                if (c1v > 0.5 || c.labelWidth <= 0) {\n                    outset += this.outsetStep * optimizationDirection;\n                    placementSuccessful = false;\n                }\n            }\n            iterations--;\n        } while (!placementSuccessful && iterations > 0 && !isNaN(outset));\n        c = this.calc(outset, this.labelWidth); // re-calculate just to draw debug lines correctly (otherwise they would be at the last tested position, not the final chosen)\n        /// this is the new result\n        this.labelWidth = c.labelWidth;\n        const x = c.x;\n        const y = c.y;\n        /// drawing\n        this.svgBackground.select(\"circle.centroid\").remove();\n        if (this.debug) {\n            this.svgBackground\n                .append(\"svg:circle\")\n                .attr(\"class\", \"centroid\")\n                .attr(\"cx\", c.centroidX)\n                .attr(\"cy\", c.centroidY)\n                .attr(\"r\", 2)\n                .style(\"fill\", \"blue\");\n        }\n        this.svgBackground.selectAll(\"line.helper\").remove();\n        if (this.debug) {\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"helper helper2\")\n                .attr(\"x1\", -this.backgroundWidth / 2)\n                .attr(\"x2\", this.backgroundWidth / 2)\n                .attr(\"y1\", y - this.labelHeight / 2)\n                .attr(\"y2\", y - this.labelHeight / 2);\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"helper helper2\")\n                .attr(\"x1\", -this.backgroundWidth / 2)\n                .attr(\"x2\", this.backgroundWidth / 2)\n                .attr(\"y1\", y + this.labelHeight / 2)\n                .attr(\"y2\", y + this.labelHeight / 2);\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"helper\")\n                .attr(\"x1\", 0)\n                .attr(\"y1\", 0)\n                .attr(\"x2\", Math.sin(this.startAngle) * (this.r + this.radiusPadding))\n                .attr(\"y2\", -Math.cos(this.startAngle) * (this.r + this.radiusPadding));\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"helper\")\n                .attr(\"x1\", 0)\n                .attr(\"y1\", 0)\n                .attr(\"x2\", Math.sin(this.endAngle) * (this.r + this.radiusPadding))\n                .attr(\"y2\", -Math.cos(this.endAngle) * (this.r + this.radiusPadding));\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"helper\")\n                .attr(\"x1\", Math.sin(this.startAngle) * (this.r + this.radiusPadding))\n                .attr(\"y1\", -Math.cos(this.startAngle) * (this.r + this.radiusPadding))\n                .attr(\"x2\", this.isStartAngleOnRight() ? this.backgroundWidth / 2 : -this.backgroundWidth / 2)\n                .attr(\"y2\", -Math.cos(this.startAngle) * (this.r + this.radiusPadding));\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"helper\")\n                .attr(\"x1\", Math.sin(this.endAngle) * (this.r + this.radiusPadding))\n                .attr(\"y1\", -Math.cos(this.endAngle) * (this.r + this.radiusPadding))\n                .attr(\"x2\", this.isEndAngleOnRight() ? this.backgroundWidth / 2 : -this.backgroundWidth / 2)\n                .attr(\"y2\", -Math.cos(this.endAngle) * (this.r + this.radiusPadding));\n        }\n        if (this.labelWidth < 2 * this.labelPaddingX) {\n            // label too short, it makes no sense to draw\n            this.labelWidth = 0; //this.startLabelWidth;\n        } else if (this.labelWidth < this.startLabelWidth) {\n            // label truncated;\n            this.labelWidth = this.labelWidth - 2 * this.labelPaddingX;\n        }\n        this.x = isNaN(x) ? 0 : x;\n        this.y = isNaN(x) ? 0 : y;\n        // log.debug(\"=======final x:\" + this.x + \" y:\" + this.y + \" labelwidth:\" + this.labelWidth);\n    }\n    calc(outset: number, labelWidth: number) {\n        let centroidX, centroidY, leftBorder, rightBorder, perimeterRightBorder, perimeterLeftBorder;\n        /// full circle?\n        if (this.startAngle - this.endAngle + 2 * Math.PI < 1e-9) {\n            centroidX = 0;\n            centroidY = 0;\n            rightBorder = this.backgroundWidth / 2;\n            leftBorder = -this.backgroundWidth / 2;\n            perimeterLeftBorder = -this.r;\n            perimeterRightBorder = this.r;\n            // log.debug(\"full circle -> placement at 0,0 regardless of outset\");\n        } else {\n            // Calculate Centroid\n            centroidX = Math.sin(this.apexAngle / 2) * this.r * outset; // calculation as if this.startAngle was 0\n            centroidY = Math.cos(this.apexAngle / 2) * -this.r * outset;\n            const tmp = centroidX * Math.cos(this.startAngle) - centroidY * Math.sin(this.startAngle); //rotate by this.startAngle\n            centroidY = centroidX * Math.sin(this.startAngle) + centroidY * Math.cos(this.startAngle); //rotate by this.startAngle\n            centroidX = tmp;\n            // log.debug(\"======Schwerpunkt x:\" + centroidX + \" y:\" + centroidY);\n            const upperLabelBorder = centroidY - this.labelHeight / 2;\n            const lowerLabelBorder = centroidY + this.labelHeight / 2;\n            leftBorder = Math.max(\n                this.calcLeftBorder(centroidX, upperLabelBorder),\n                this.calcLeftBorder(centroidX, lowerLabelBorder),\n                -this.backgroundWidth / 2\n            );\n            if (\n                Math.abs(this.startAngle - (this.endAngle % (2 * Math.PI))) > 1e-9 &&\n                centroidX > 0 &&\n                upperLabelBorder <= 0 &&\n                lowerLabelBorder >= 0\n            ) {\n                // label at \"mouth of Pacman\" (<\n                leftBorder = Math.max(leftBorder, 0);\n            }\n            // see if height fits\n            if (!this.doesFitHeight(leftBorder, upperLabelBorder, lowerLabelBorder, centroidX < 0, true)) {\n                leftBorder = this.backgroundWidth / 2;\n            }\n            rightBorder = Math.min(\n                this.calcRightBorder(centroidX, upperLabelBorder),\n                this.calcRightBorder(centroidX, lowerLabelBorder),\n\n                this.backgroundWidth / 2\n            );\n            if (\n                Math.abs(this.startAngle - (this.endAngle % (2 * Math.PI))) > 1e-9 &&\n                centroidX < 0 &&\n                upperLabelBorder <= 0 &&\n                lowerLabelBorder >= 0\n            ) {\n                // Pacman\n                rightBorder = Math.min(rightBorder, 0);\n            }\n            // see if height fits\n            if (!this.doesFitHeight(rightBorder, upperLabelBorder, lowerLabelBorder, centroidX < 0, false)) {\n                rightBorder = -this.backgroundWidth / 2;\n            }\n            let perimeterUpperRightBorder = this.calcPerimeterBorder(1, centroidY - this.labelHeight / 2);\n            if (perimeterUpperRightBorder < centroidX) {\n                perimeterUpperRightBorder = this.backgroundWidth / 2;\n            }\n            let perimeterLowerRightBorder = this.calcPerimeterBorder(1, centroidY + this.labelHeight / 2);\n            if (perimeterLowerRightBorder < centroidX) {\n                perimeterLowerRightBorder = this.backgroundWidth / 2;\n            }\n            perimeterRightBorder = Math.min(\n                perimeterUpperRightBorder,\n                perimeterLowerRightBorder,\n                rightBorder\n            );\n            let perimeterUpperLeftBorder = this.calcPerimeterBorder(-1, centroidY - this.labelHeight / 2);\n            if (perimeterUpperLeftBorder > centroidX) {\n                perimeterUpperLeftBorder = -this.backgroundWidth / 2;\n            }\n            let perimeterLowerLeftBorder = this.calcPerimeterBorder(-1, centroidY + this.labelHeight / 2);\n            if (perimeterLowerLeftBorder > centroidX) {\n                perimeterLowerLeftBorder = -this.backgroundWidth / 2;\n            }\n            perimeterLeftBorder = Math.max(perimeterUpperLeftBorder, perimeterLowerLeftBorder, leftBorder);\n            if (isNaN(perimeterRightBorder)) {\n                perimeterRightBorder = rightBorder;\n            }\n            if (isNaN(perimeterLeftBorder)) {\n                perimeterLeftBorder = leftBorder;\n            }\n        }\n        /// debug drawing\n        this.svgBackground.select(\"line.left\").remove();\n        this.svgBackground.select(\"line.right\").remove();\n        this.svgBackground.select(\"line.perimeterLeft\").remove();\n        this.svgBackground.select(\"line.perimeterRight\").remove();\n        if (this.debug) {\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"left\")\n                .attr(\"y1\", -this.backgroundHeight / 2)\n                .attr(\"y2\", this.backgroundHeight / 2)\n                .attr(\"x1\", leftBorder)\n                .attr(\"x2\", leftBorder);\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"right\")\n                .attr(\"y1\", -this.backgroundHeight / 2)\n                .attr(\"y2\", this.backgroundHeight / 2)\n                .attr(\"x1\", rightBorder)\n                .attr(\"x2\", rightBorder);\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"perimeterLeft\")\n                .attr(\"y1\", -this.backgroundHeight / 2)\n                .attr(\"y2\", this.backgroundHeight / 2)\n                .attr(\"x1\", perimeterLeftBorder)\n                .attr(\"x2\", perimeterLeftBorder);\n            this.svgBackground\n                .append(\"svg:line\")\n                .attr(\"class\", \"perimeterRight\")\n                .attr(\"y1\", -this.backgroundHeight / 2)\n                .attr(\"y2\", this.backgroundHeight / 2)\n                .attr(\"x1\", perimeterRightBorder)\n                .attr(\"x2\", perimeterRightBorder);\n        }\n        const oldLabelWidth = labelWidth;\n        labelWidth = Math.min(labelWidth, Math.floor(rightBorder - leftBorder));\n        // calculate x\n        let x = centroidX;\n        x = Math.max(x, perimeterLeftBorder + labelWidth / 2);\n        x = Math.min(x, perimeterRightBorder - labelWidth / 2);\n        if (\n            x - labelWidth / 2 < perimeterLeftBorder - 1e-9 ||\n            x + labelWidth / 2 > perimeterRightBorder + 1e-9\n        ) {\n            // centered\n            x = (perimeterLeftBorder + perimeterRightBorder) / 2;\n        }\n        if (centroidX >= 0) {\n            x = Math.max(x, leftBorder + labelWidth / 2);\n            x = Math.min(x, rightBorder - labelWidth / 2);\n        } else {\n            x = Math.min(x, rightBorder - labelWidth / 2);\n            x = Math.max(x, leftBorder - labelWidth / 2);\n        }\n        // calculate y\n        const y = centroidY;\n        // return coordinates and parameters of the placement\n        return {\n            x: x,\n            y: y,\n            labelWidth: labelWidth,\n            labelShortened: labelWidth !== oldLabelWidth,\n            xSpace: rightBorder - leftBorder,\n            centroidX: centroidX,\n            centroidY: centroidY,\n            asymmetry: Math.abs(x - centroidX),\n        };\n    }\n    /// value function - how good is the new proposed solution compared to the current?\n    value(cNew, cOld) {\n        if (cNew.labelWidth < 0) {\n            return -10000;\n        }\n        if (cNew.labelWidth < cOld.labelWidth) {\n            return -100;\n        }\n        if (cNew.labelWidth > cOld.labelWidth) {\n            return (cNew.labelWidth - cOld.labelWidth) * 1000;\n        }\n        if (cOld.labelShortened && cNew.labelWidth === cOld.labelWidth) {\n            return (cNew.xSpace - cOld.xSpace) * 100;\n        }\n        return 0;\n    }\n    doesFitHeight(border, upper, lower, isLeftLabel, isLeftBorder) {\n        let y1 = -Math.cos(this.startAngle) * (this.r + this.radiusPadding);\n        let y2 = -Math.cos(this.endAngle) * (this.r + this.radiusPadding);\n        if (Math.abs(this.startAngle - (this.endAngle % (2 * Math.PI))) < 1e-9) {\n            y1 = -this.backgroundHeight / 2;\n            y2 = this.backgroundHeight / 2;\n        } else if (border === 0) {\n            // for \"Pacman\" slices (<  >)\n            y1 = -this.backgroundHeight / 2;\n            y2 = this.backgroundHeight / 2;\n        } else if (border > 0) {\n            if (!this.isStartAngleOnRight()) {\n                y1 = -this.backgroundHeight / 2;\n            } else if (border <= Math.sin(this.startAngle) * (this.r + this.radiusPadding)) {\n                // intersection of edge with this.startAngle at radiale (or horizontal part)?\n                y1 = border / -Math.tan(this.startAngle);\n            }\n            if (!this.isEndAngleOnRight()) {\n                y2 = this.backgroundHeight / 2;\n            } else if (border <= Math.sin(this.endAngle) * (this.r + this.radiusPadding)) {\n                // intersection of edge with this.startAngle at radiale (or horizontal part)?\n                y2 = border / -Math.tan(this.endAngle);\n            }\n            if (isLeftLabel && !isLeftBorder && y1 >= lower) {\n                y1 = -this.backgroundHeight / 2;\n            }\n            if (isLeftLabel && !isLeftBorder && y2 <= upper) {\n                y2 = this.backgroundHeight / 2;\n            }\n        } else {\n            if (this.isStartAngleOnRight()) {\n                y1 = this.backgroundHeight / 2;\n            } else if (border > Math.sin(this.startAngle) * (this.r + this.radiusPadding)) {\n                // intersection of edge with this.startAngle at radiale (or horizontal part)?\n                y1 = border / -Math.tan(this.startAngle);\n            }\n            if (this.isEndAngleOnRight()) {\n                y2 = -this.backgroundHeight / 2;\n            } else if (border > Math.sin(this.endAngle) * (this.r + this.radiusPadding)) {\n                // intersection of edge with this.startAngle at radiale (or horizontal part)?\n                y2 = border / -Math.tan(this.endAngle);\n            }\n            if (!isLeftLabel && isLeftBorder && y2 >= lower) {\n                y2 = -this.backgroundHeight / 2;\n            }\n            if (!isLeftLabel && isLeftBorder && y1 <= upper) {\n                y1 = this.backgroundHeight / 2;\n            }\n        }\n        /// debug drawing\n        if (!isLeftBorder) {\n            this.svgBackground.selectAll(\".rightBorder\").remove();\n            if (this.debug) {\n                this.svgBackground\n                    .append(\"svg:rect\")\n                    .attr(\"class\", \"rightBorder\")\n                    .attr(\"x\", border - 3)\n                    .attr(\"y\", y1 - 3)\n                    .attr(\"width\", 6)\n                    .attr(\"height\", 6)\n                    .style(\"fill\", \"green\");\n                this.svgBackground\n                    .append(\"svg:circle\")\n                    .attr(\"class\", \"rightBorder\")\n                    .attr(\"cx\", border)\n                    .attr(\"cy\", y2)\n                    .attr(\"this.r\", 3)\n                    .style(\"fill\", \"green\");\n            }\n        } else {\n            this.svgBackground.selectAll(\".leftBorder\").remove();\n            if (this.debug) {\n                this.svgBackground\n                    .append(\"svg:rect\")\n                    .attr(\"class\", \"leftBorder\")\n                    .attr(\"x\", border - 3)\n                    .attr(\"y\", y1 - 3)\n                    .attr(\"width\", 6)\n                    .attr(\"height\", 6)\n                    .style(\"fill\", \"red\");\n                this.svgBackground\n                    .append(\"svg:circle\")\n                    .attr(\"class\", \"leftBorder\")\n                    .attr(\"cx\", border)\n                    .attr(\"cy\", y2)\n                    .attr(\"this.r\", 3)\n                    .style(\"fill\", \"red\");\n            }\n        }\n        /// does the text fit the height?\n        return upper >= Math.min(y1, y2) - 1e-9 && lower <= Math.max(y1, y2) + 1e-9;\n    }\n    ///// calculate left border\n    calcLeftBorder(x, y) {\n        let border = -this.backgroundWidth / 2;\n        if (Math.abs(this.startAngle - (this.endAngle % (2 * Math.PI))) < 1e-9) {\n            return border;\n        }\n        if (y <= 0) {\n            // upper half\n            if (y > -Math.cos(this.startAngle) * (this.r + this.radiusPadding)) {\n                // intersection with edge, this.startAngle at radial (or horizontal part)?\n                border = Math.tan(this.startAngle) * -y;\n            }\n        } else if (y < -Math.cos(this.endAngle) * (this.r + this.radiusPadding)) {\n            border = Math.tan(this.endAngle) * -y;\n        }\n        return border;\n    }\n    ///// calculate right border\n    calcRightBorder(x, y) {\n        let border = this.backgroundWidth / 2;\n        if (Math.abs(this.startAngle - (this.endAngle % (2 * Math.PI))) < 1e-9) {\n            return border;\n        }\n        if (y >= 0) {\n            // lower half\n            if (-y > Math.cos(this.startAngle) * (this.r + this.radiusPadding)) {\n                // intersection with edge, this.endAngle at radial (or horizontal part)?\n                border = Math.tan(this.startAngle) * -y;\n            }\n        } else if (-y < Math.cos(this.endAngle) * (this.r + this.radiusPadding)) {\n            border = Math.tan(this.endAngle) * -y;\n        }\n        return border;\n    }\n    // calculate Perimeter Border\n    calcPerimeterBorder(x, y) {\n        let border = x > 0 ? this.backgroundWidth / 2 : -this.backgroundWidth / 2;\n        border = Math.sqrt(this.r * this.r - y * y);\n        if (x < 0) {\n            border *= -1;\n        }\n        return border;\n    }\n    // check wether this.startAngle on right side\n    isStartAngleOnRight() {\n        return this.startAngle > 0 && this.startAngle <= ((2 * Math.PI) / 360) * 180;\n    }\n    // check wether this.endAngle on right side\n    isEndAngleOnRight() {\n        return this.endAngle % (2 * Math.PI) < ((2 * Math.PI) / 360) * 180;\n    }\n}\n\n/*** ARC CALCULATOR ***/\nclass Sequence {\n    maxIndex: number;\n    objectMap: any;\n    constructor(...args: Array<any>) {\n        this.init(args);\n    }\n    //  helper class for storing objects in order\n    //  ======================================================================\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    init(...args: Array<any>) {\n        this.maxIndex = 0;\n        this.objectMap = {};\n    }\n    // get index of object if it exists in map, otherwise add it to map and return newly created index\n    // actually this is also an add function\n    getIndex(object) {\n        let index = this.objectMap[object];\n        if (typeof index !== \"undefined\") {\n            return index;\n        }\n        index = this.maxIndex;\n        this.maxIndex++;\n        this.objectMap[object] = index;\n        return index;\n    }\n}\nclass HistoricalArcCalculator {\n    private _pieChart: PieChart;\n    constructor(pieChart: PieChart, ...args: Array<any>) {\n        this._pieChart = pieChart;\n        this.init(pieChart, args);\n    }\n    init(pieChart: PieChart, ...args: Array<any>) {\n        pieChart.arcSequence = new Sequence(args);\n    }\n    // calculate new arcs based on new data\n    // ======================================================================\n    calculateNewArcsOnly(data) {\n        // sort data\n        data = data.slice();\n        // ie sort has reverse order of parameter comparing to FF and Chrome\n        // new data has to be added (if any) to sequence at first, only necessary for IE\n        PieChart.add2arcSequence(data, this._pieChart.arcSequence);\n        // calculate new arcs based on new data\n        const newArcs = PieChart.arcsGen()(data);\n        return newArcs;\n    }\n    // calculate new arcs based on old arcs + new data\n    // ======================================================================\n    calculateArcs(oldArcs, data) {\n        // sort data\n        data = data.slice();\n        // ie sort has reverse order of parameter comparing to FF and Chrome\n        // new data has to be added (if any) to sequence at first, only necessary for IE\n        PieChart.add2arcSequence(data, this._pieChart.arcSequence);\n        data.sort(function (a, b) {\n            return this._pieChart.arcSequence.getIndex(a.id) - this._pieChart.arcSequence.getIndex(b.id);\n        });\n        // calculate new arcs based on new data\n        const newArcs = PieChart.arcsGen()(data);\n        // insert new elements with size 0 (startAngle=endAngle) into old arcs\n        this.insertMissingArcs(oldArcs, newArcs);\n        // insert removed elements with size 0 (startAngle=endAngle) into new arcs\n        this.insertMissingArcs(newArcs, oldArcs);\n        return newArcs;\n    }\n    // insert arcs included in arcs2 but not in arcs1 into arcs1\n    // ======================================================================\n    insertMissingArcs(arcs1, arcs2) {\n        let arc1Index = 0;\n        for (let arc2Index = 0; arc2Index < arcs2.length; ++arc2Index) {\n            const arc2 = arcs2[arc2Index];\n            const arc2SortIndex = this._pieChart.arcSequence.getIndex(arc2.data.id);\n            let arc1;\n            let found = false;\n            for (; arc1Index < arcs1.length; ++arc1Index) {\n                arc1 = arcs1[arc1Index];\n                const arc1SortIndex = this._pieChart.arcSequence.getIndex(arc1.data.id);\n                if (arc1SortIndex === arc2SortIndex) {\n                    found = true;\n                    break;\n                }\n                if (arc1SortIndex > arc2SortIndex) {\n                    break;\n                }\n            }\n            if (found) {\n                arc1.oldArc = arc2;\n            } else {\n                let newArc;\n                if (arc1Index - 1 >= 0 && arc1Index - 1 < arcs1.length) {\n                    const beforeArc = arcs1[arc1Index - 1];\n                    newArc = PieChart.createZeroArc(beforeArc.endAngle, arc2.data);\n                } else {\n                    newArc = PieChart.createZeroArc(0, arc2.data);\n                }\n                arcs1.splice(arc1Index, 0, newArc);\n                newArc.oldArc = arc2;\n            }\n            arc1Index++;\n        }\n    }\n}\nclass DefaultArcCalculator {\n    constructor(pieChart: PieChart, ...args: Array<any>) {\n        this.init(pieChart, args);\n    }\n    init(pieChart: PieChart, ...args: Array<any>) {\n        pieChart.arcSequence = new Sequence(args);\n    }\n}\n"],"mappings":"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","ignoreList":[]}