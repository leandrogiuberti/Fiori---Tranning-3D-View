{"version":3,"file":"SearchAdvancedCondition.js","names":["sap","ui","define","__i18n","HorizontalLayout","Button","sap_m_library","Input","Select","CheckBox","DateRangeSelection","InvisibleText","Item","Label","__SearchFacetDialogHelper","Element","_interopRequireDefault","obj","__esModule","default","i18n","ButtonType","SearchFacetDialogHelper","SearchAdvancedCondition","extend","renderer","apiVersion","metadata","properties","type","constructor","_constructor","sId","settings","HorizontalLayout.prototype.constructor.call","this","setAllowWrapping","allowWrapping","addStyleClass","content","contentFactory","contentItem","addContent","_contentFactory","options","oAdvancedCheckBox","select","oEvent","updateCountInfo","getDetailPage","getSource","oAdvancedCheckBoxLabel","getElementById","text","getText","addAriaLabelledBy","oOperatorLabel","oInputArea","oDeleteButton","oInputsingle","oSelect","width","change","onDateRangeSelectionChange","onAfterRendering","domRef","getDomRef","inputEls","querySelectorAll","forEach","input","setAttribute","setVisible","placeholder","liveChange","onAdvancedInputChange","tooltip","items","key","icon","Transparent","press","onDeleteButtonPress","oInputRangeFrom","onAdvancedNumberInputChange","oInputRangeTo","oLabelSeparator","addEventDelegate","length","srcControl","getParent","getContent","index","indexOfAggregation","value","getValue","setValue","_getDetailPage","oControl","hasStyleClass","_onDateRangeSelectionChange","oDateRangeSelection","oAdvancedCondition","oAdvancedConditionCheckBox","getDateValue","getSecondDateValue","setSelected","insertNewAdvancedCondition","_onAdvancedInputChange","oInput","_onDeleteButtonPress","deleteAdvancedCondition","_onAdvancedNumberInputChange","oAdvancedConditionRange","oAdvancedRangeFrom","oAdvancedRangeTo","injectSearchFacetDialogHelper","_SearchFacetDialogHelper","searchFacetDialogHelper"],"sources":["SearchAdvancedCondition.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport i18n from \"../i18n\";\nimport HorizontalLayout, { $HorizontalLayoutSettings } from \"sap/ui/layout/HorizontalLayout\";\nimport Button from \"sap/m/Button\";\nimport { ButtonType } from \"sap/m/library\";\nimport Input from \"sap/m/Input\";\nimport Select from \"sap/m/Select\";\nimport CheckBox from \"sap/m/CheckBox\";\nimport DateRangeSelection from \"sap/m/DateRangeSelection\";\nimport InvisibleText from \"sap/ui/core/InvisibleText\";\nimport Control from \"sap/ui/core/Control\";\nimport Item from \"sap/ui/core/Item\";\nimport Label from \"sap/m/Label\";\nimport SearchFacetDialogHelper from \"../SearchFacetDialogHelper\";\nimport Event from \"sap/ui/base/Event\";\nimport Element from \"sap/ui/core/Element\";\n\ninterface $SearchAdvancedConditionSettings extends $HorizontalLayoutSettings {\n    type: string;\n    allowWrapping: boolean;\n}\n\n/**\n * @namespace sap.esh.search.ui.controls\n */\nexport default class SearchAdvancedCondition extends HorizontalLayout {\n    static readonly metadata = {\n        properties: {\n            type: {\n                type: \"string\",\n            },\n        },\n    };\n\n    public static searchFacetDialogHelper: SearchFacetDialogHelper;\n\n    constructor(sId?: string, settings?: Partial<$SearchAdvancedConditionSettings>) {\n        super(sId, settings);\n\n        this.setAllowWrapping(settings?.allowWrapping);\n        this.addStyleClass(\"sapUshellSearchFacetDialogDetailPageCondition\");\n        if (settings?.type) {\n            const content = this.contentFactory(settings);\n            for (const contentItem of content) {\n                this.addContent(contentItem);\n            }\n        }\n    }\n\n    contentFactory(options: Partial<$SearchAdvancedConditionSettings>): Array<Control> {\n        const oAdvancedCheckBox = new CheckBox(\"\", {\n            select: (oEvent: Event) => {\n                SearchFacetDialogHelper.updateCountInfo(this.getDetailPage(oEvent.getSource() as Control));\n            },\n        }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionCheckBox\");\n        let oAdvancedCheckBoxLabel = Element.getElementById(\"advancedCheckBoxLabel\");\n        if (!oAdvancedCheckBoxLabel) {\n            oAdvancedCheckBoxLabel = new InvisibleText(\"advancedCheckBoxLabel\", {\n                text: i18n.getText(\"checkBox\"),\n            });\n        }\n        oAdvancedCheckBox.addAriaLabelledBy(\"advancedCheckBoxLabel\");\n        let oOperatorLabel = Element.getElementById(\"operatorLabel\");\n        if (!oOperatorLabel) {\n            oOperatorLabel = new InvisibleText(\"operatorLabel\", {\n                text: i18n.getText(\"operator\"),\n            });\n        }\n        let oInputArea, oDeleteButton, oInputsingle, oSelect;\n        switch (options.type) {\n            case \"timestamp\":\n            case \"date\":\n                oInputArea = new DateRangeSelection({\n                    width: \"86%\",\n                    change: (oEvent) => {\n                        this.onDateRangeSelectionChange(oEvent);\n                    },\n                }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionInput\");\n                oInputArea.onAfterRendering = function () {\n                    const domRef = this.getDomRef();\n                    if (domRef) {\n                        const inputEls = domRef.querySelectorAll(\"input\");\n                        inputEls.forEach((input) => {\n                            input.setAttribute(\"readonly\", \"readonly\");\n                        });\n                    }\n                };\n                break;\n            case \"string\":\n                oAdvancedCheckBox.setVisible(false);\n                oInputsingle = new Input({\n                    width: \"56%\",\n                    placeholder: i18n.getText(\"filterCondition\"),\n                    liveChange: (oEvent) => {\n                        this.onAdvancedInputChange(oEvent);\n                    },\n                }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionInput\");\n                oSelect = new Select({\n                    width: \"40%\",\n                    tooltip: i18n.getText(\"operator\"),\n                    items: [\n                        new Item({\n                            text: i18n.getText(\"equals\"),\n                            key: \"eq\",\n                        }),\n                        new Item({\n                            text: i18n.getText(\"beginsWith\"),\n                            key: \"bw\",\n                        }),\n                        new Item({\n                            text: i18n.getText(\"endsWith\"),\n                            key: \"ew\",\n                        }),\n                        new Item({\n                            text: i18n.getText(\"contains\"),\n                            key: \"co\",\n                        }),\n                    ],\n                }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionSelect\");\n                oSelect.addAriaLabelledBy(\"operatorLabel\");\n                oInputArea = new HorizontalLayout({\n                    allowWrapping: true,\n                    content: [oSelect, oInputsingle],\n                });\n                oDeleteButton = new Button({\n                    icon: \"sap-icon://sys-cancel\",\n                    type: ButtonType.Transparent,\n                    tooltip: i18n.getText(\"removeButton\"),\n                    press: (/*oEvent: Event*/) => {\n                        this.onDeleteButtonPress(/*oEvent*/);\n                    },\n                });\n                break;\n            case \"text\":\n                oAdvancedCheckBox.setVisible(false);\n                oInputsingle = new Input({\n                    width: \"56%\",\n                    placeholder: i18n.getText(\"filterCondition\"),\n                    liveChange: (oEvent) => {\n                        this.onAdvancedInputChange(oEvent);\n                    },\n                }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionInput\");\n                oSelect = new Select({\n                    width: \"40%\",\n                    tooltip: i18n.getText(\"operator\"),\n                    items: [\n                        new Item({\n                            text: i18n.getText(\"containsWords\"),\n                            key: \"co\",\n                        }),\n                    ],\n                }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionSelect\");\n                oSelect.addAriaLabelledBy(\"operatorLabel\");\n                oInputArea = new HorizontalLayout({\n                    allowWrapping: true,\n                    content: [oSelect, oInputsingle],\n                });\n                oDeleteButton = new Button({\n                    icon: \"sap-icon://sys-cancel\",\n                    type: ButtonType.Transparent,\n                    tooltip: i18n.getText(\"removeButton\"),\n                    press: (/*oEvent: Event*/) => {\n                        this.onDeleteButtonPress(/*oEvent*/);\n                    },\n                });\n                break;\n            case \"integer\":\n            case \"number\": {\n                const oInputRangeFrom = new Input(\"\", {\n                    width: \"46.5%\",\n                    placeholder: i18n.getText(\"fromPlaceholder\"),\n                    liveChange: (oEvent) => {\n                        this.onAdvancedNumberInputChange(oEvent);\n                    },\n                }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionInput\");\n                const oInputRangeTo = new Input(\"\", {\n                    width: \"46.5%\",\n                    placeholder: i18n.getText(\"toPlaceholder\"),\n                    liveChange: (oEvent) => {\n                        this.onAdvancedNumberInputChange(oEvent);\n                    },\n                }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionInput\");\n                const oLabelSeparator = new Label(\"\", {\n                    text: i18n.getText(\"threeDots\"),\n                }).addStyleClass(\"sapUshellSearchFacetDialogDetailPageConditionLabel\");\n                oInputArea = new HorizontalLayout(\"\", {\n                    allowWrapping: true,\n                    content: [oInputRangeFrom, oLabelSeparator, oInputRangeTo],\n                });\n                oInputArea.addEventDelegate({\n                    // workaround to set focus at right end position\n                    onAfterRendering: (oEvent) => {\n                        const length = oEvent.srcControl.getParent().getParent().getContent().length;\n                        const index = oEvent.srcControl\n                            .getParent()\n                            .getParent()\n                            .indexOfAggregation(\"content\", oEvent.srcControl.getParent());\n                        if (index === length - 2) {\n                            const value = oEvent.srcControl.getContent()[2].getValue();\n                            oEvent.srcControl.getContent()[2].setValue();\n                            oEvent.srcControl.getContent()[2].setValue(value);\n                        }\n                    },\n                });\n                break;\n            }\n            default:\n                break;\n        }\n        return [oAdvancedCheckBox, oInputArea, oDeleteButton];\n    }\n\n    getDetailPage(oControl: Control): Control {\n        if (\n            oControl.hasStyleClass &&\n            (oControl.hasStyleClass(\"sapUshellSearchFacetDialogDetailPageString\") ||\n                oControl.hasStyleClass(\"sapUshellSearchFacetDialogDetailPage\"))\n        ) {\n            return oControl;\n        } else {\n            return this.getDetailPage((oControl as any).getParent()); // ToDo\n        }\n    }\n\n    // event: date range selection box changed\n    onDateRangeSelectionChange(oEvent: Event): void {\n        const oDateRangeSelection: any = oEvent.getSource(); // ToDo\n        const oAdvancedCondition = oDateRangeSelection.getParent();\n        const oAdvancedConditionCheckBox = oAdvancedCondition.getContent()[0];\n        if (oDateRangeSelection.getDateValue() && oDateRangeSelection.getSecondDateValue()) {\n            oAdvancedConditionCheckBox.setSelected(true);\n            SearchFacetDialogHelper.insertNewAdvancedCondition(oAdvancedCondition, \"date\");\n            SearchFacetDialogHelper.updateCountInfo(oAdvancedCondition.getParent().getParent());\n        } else {\n            oAdvancedConditionCheckBox.setSelected(false);\n        }\n    }\n\n    // event: advanced string input box changed\n    onAdvancedInputChange(oEvent: Event): void {\n        const oInput = oEvent.getSource() as Input;\n        const oAdvancedCondition: any = oInput.getParent().getParent(); // ToDo\n        const oAdvancedConditionCheckBox = oAdvancedCondition.getContent()[0];\n        if (oInput.getValue()) {\n            oAdvancedConditionCheckBox.setSelected(true);\n            SearchFacetDialogHelper.updateCountInfo(this.getDetailPage(oAdvancedConditionCheckBox));\n        } else {\n            oAdvancedConditionCheckBox.setSelected(false);\n        }\n    }\n\n    // event: advanced condition delete button pressed\n    onDeleteButtonPress(/* oEvent: Event */): void {\n        SearchFacetDialogHelper.deleteAdvancedCondition(this);\n    }\n\n    // event: advanced number input box changed\n    onAdvancedNumberInputChange(oEvent: Event): void {\n        const oInput = oEvent.getSource() as Input;\n        const oAdvancedCondition: any = oInput.getParent().getParent();\n        const oAdvancedConditionCheckBox = oAdvancedCondition.getContent()[0] as CheckBox;\n        const oAdvancedConditionRange = oInput.getParent() as HorizontalLayout;\n        const oAdvancedRangeFrom = oAdvancedConditionRange.getContent()[0] as Input;\n        const oAdvancedRangeTo = oAdvancedConditionRange.getContent()[2] as Input;\n        if (oAdvancedRangeFrom.getValue() && oAdvancedRangeTo.getValue()) {\n            oAdvancedConditionCheckBox.setSelected(true);\n            SearchFacetDialogHelper.insertNewAdvancedCondition(oAdvancedCondition, \"number\");\n            SearchFacetDialogHelper.updateCountInfo(oAdvancedCondition.getParent().getParent());\n        } else {\n            oAdvancedConditionCheckBox.setSelected(false);\n        }\n    }\n\n    public static injectSearchFacetDialogHelper(_SearchFacetDialogHelper: SearchFacetDialogHelper): void {\n        SearchAdvancedCondition.searchFacetDialogHelper = _SearchFacetDialogHelper;\n    }\n\n    static renderer = {\n        apiVersion: 2,\n    };\n}\n"],"mappings":";;;;;AAAAA,IAAAC,GAAAC,OAAA,8QAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,GAAA,sBAAAC,EAAAC,GAAA,OAAAA,KAAAC,mBAAAD,EAAAE,UAAA,YAAAF,EAAAE,QAAAF,CAAA,OAKOG,EAAIJ,EAAAb,GAAA,MAGFkB,EAAUf,EAAA,oBASZgB,EAAuBN,EAAAF,GAS9B,MAGqBS,EAAgCnB,EAAgBoB,OAAA,sDA4P1DC,SAAW,CACdC,WAAY,GA5PAC,SAAW,CACvBC,WAAY,CACRC,KAAM,CACFA,KAAM,YAOlBC,YAAW,SAAAC,EAACC,EAAcC,GACtBC,6BAAAC,KAAMH,EAAKC,GAEXE,KAAKC,iBAAiBH,GAAUI,eAChCF,KAAKG,cAAc,iDACnB,GAAIL,GAAUJ,KAAM,CAChB,MAAMU,EAAUJ,KAAKK,eAAeP,GACpC,IAAK,MAAMQ,KAAeF,EAAS,CAC/BJ,KAAKO,WAAWD,EACpB,CACJ,CACJ,EAEAD,eAAc,SAAAG,EAACC,GACX,MAAMC,EAAoB,IAAIpC,EAAS,GAAI,CACvCqC,OAASC,IACLzB,EAAwB0B,gBAAgBb,KAAKc,cAAcF,EAAOG,iBAEvEZ,cAAc,yDACjB,IAAIa,EAAyBpC,EAAQqC,eAAe,yBACpD,IAAKD,EAAwB,CACzBA,EAAyB,IAAIxC,EAAc,wBAAyB,CAChE0C,KAAMjC,EAAKkC,QAAQ,aAE3B,CACAT,EAAkBU,kBAAkB,yBACpC,IAAIC,EAAiBzC,EAAQqC,eAAe,iBAC5C,IAAKI,EAAgB,CACjBA,EAAiB,IAAI7C,EAAc,gBAAiB,CAChD0C,KAAMjC,EAAKkC,QAAQ,aAE3B,CACA,IAAIG,EAAYC,EAAeC,EAAcC,EAC7C,OAAQhB,EAAQf,MACZ,IAAK,YACL,IAAK,OACD4B,EAAa,IAAI/C,EAAmB,CAChCmD,MAAO,MACPC,OAASf,IACLZ,KAAK4B,2BAA2BhB,MAErCT,cAAc,sDACjBmB,EAAWO,iBAAmB,WAC1B,MAAMC,EAAS9B,KAAK+B,YACpB,GAAID,EAAQ,CACR,MAAME,EAAWF,EAAOG,iBAAiB,SACzCD,EAASE,QAASC,IACdA,EAAMC,aAAa,WAAY,aAEvC,CACJ,EACA,MACJ,IAAK,SACD1B,EAAkB2B,WAAW,OAC7Bb,EAAe,IAAIpD,EAAM,CACrBsD,MAAO,MACPY,YAAarD,EAAKkC,QAAQ,mBAC1BoB,WAAa3B,IACTZ,KAAKwC,sBAAsB5B,MAEhCT,cAAc,sDACjBsB,EAAU,IAAIpD,EAAO,CACjBqD,MAAO,MACPe,QAASxD,EAAKkC,QAAQ,YACtBuB,MAAO,CACH,IAAIjE,EAAK,CACLyC,KAAMjC,EAAKkC,QAAQ,UACnBwB,IAAK,OAET,IAAIlE,EAAK,CACLyC,KAAMjC,EAAKkC,QAAQ,cACnBwB,IAAK,OAET,IAAIlE,EAAK,CACLyC,KAAMjC,EAAKkC,QAAQ,YACnBwB,IAAK,OAET,IAAIlE,EAAK,CACLyC,KAAMjC,EAAKkC,QAAQ,YACnBwB,IAAK,UAGdxC,cAAc,uDACjBsB,EAAQL,kBAAkB,iBAC1BE,EAAa,IAAIrD,EAAiB,CAC9BiC,cAAe,KACfE,QAAS,CAACqB,EAASD,KAEvBD,EAAgB,IAAIrD,EAAO,CACvB0E,KAAM,wBACNlD,KAAMR,EAAW2D,YACjBJ,QAASxD,EAAKkC,QAAQ,gBACtB2B,MAAOA,KACH9C,KAAK+C,yBAGb,MACJ,IAAK,OACDrC,EAAkB2B,WAAW,OAC7Bb,EAAe,IAAIpD,EAAM,CACrBsD,MAAO,MACPY,YAAarD,EAAKkC,QAAQ,mBAC1BoB,WAAa3B,IACTZ,KAAKwC,sBAAsB5B,MAEhCT,cAAc,sDACjBsB,EAAU,IAAIpD,EAAO,CACjBqD,MAAO,MACPe,QAASxD,EAAKkC,QAAQ,YACtBuB,MAAO,CACH,IAAIjE,EAAK,CACLyC,KAAMjC,EAAKkC,QAAQ,iBACnBwB,IAAK,UAGdxC,cAAc,uDACjBsB,EAAQL,kBAAkB,iBAC1BE,EAAa,IAAIrD,EAAiB,CAC9BiC,cAAe,KACfE,QAAS,CAACqB,EAASD,KAEvBD,EAAgB,IAAIrD,EAAO,CACvB0E,KAAM,wBACNlD,KAAMR,EAAW2D,YACjBJ,QAASxD,EAAKkC,QAAQ,gBACtB2B,MAAOA,KACH9C,KAAK+C,yBAGb,MACJ,IAAK,UACL,IAAK,SAAU,CACX,MAAMC,EAAkB,IAAI5E,EAAM,GAAI,CAClCsD,MAAO,QACPY,YAAarD,EAAKkC,QAAQ,mBAC1BoB,WAAa3B,IACTZ,KAAKiD,4BAA4BrC,MAEtCT,cAAc,sDACjB,MAAM+C,EAAgB,IAAI9E,EAAM,GAAI,CAChCsD,MAAO,QACPY,YAAarD,EAAKkC,QAAQ,iBAC1BoB,WAAa3B,IACTZ,KAAKiD,4BAA4BrC,MAEtCT,cAAc,sDACjB,MAAMgD,EAAkB,IAAIzE,EAAM,GAAI,CAClCwC,KAAMjC,EAAKkC,QAAQ,eACpBhB,cAAc,sDACjBmB,EAAa,IAAIrD,EAAiB,GAAI,CAClCiC,cAAe,KACfE,QAAS,CAAC4C,EAAiBG,EAAiBD,KAEhD5B,EAAW8B,iBAAiB,CAExBvB,iBAAmBjB,IACf,MAAMyC,EAASzC,EAAO0C,WAAWC,YAAYA,YAAYC,aAAaH,OACtE,MAAMI,EAAQ7C,EAAO0C,WAChBC,YACAA,YACAG,mBAAmB,UAAW9C,EAAO0C,WAAWC,aACrD,GAAIE,IAAUJ,EAAS,EAAG,CACtB,MAAMM,EAAQ/C,EAAO0C,WAAWE,aAAa,GAAGI,WAChDhD,EAAO0C,WAAWE,aAAa,GAAGK,WAClCjD,EAAO0C,WAAWE,aAAa,GAAGK,SAASF,EAC/C,KAGR,KACJ,CACA,QACI,MAER,MAAO,CAACjD,EAAmBY,EAAYC,EAC3C,EAEAT,cAAa,SAAAgD,EAACC,GACV,GACIA,EAASC,gBACRD,EAASC,cAAc,+CACpBD,EAASC,cAAc,yCAC7B,CACE,OAAOD,CACX,KAAO,CACH,OAAO/D,KAAKc,cAAeiD,EAAiBR,YAChD,CACJ,EAGA3B,2BAA0B,SAAAqC,EAACrD,GACvB,MAAMsD,EAA2BtD,EAAOG,YACxC,MAAMoD,EAAqBD,EAAoBX,YAC/C,MAAMa,EAA6BD,EAAmBX,aAAa,GACnE,GAAIU,EAAoBG,gBAAkBH,EAAoBI,qBAAsB,CAChFF,EAA2BG,YAAY,MACvCpF,EAAwBqF,2BAA2BL,EAAoB,QACvEhF,EAAwB0B,gBAAgBsD,EAAmBZ,YAAYA,YAC3E,KAAO,CACHa,EAA2BG,YAAY,MAC3C,CACJ,EAGA/B,sBAAqB,SAAAiC,EAAC7D,GAClB,MAAM8D,EAAS9D,EAAOG,YACtB,MAAMoD,EAA0BO,EAAOnB,YAAYA,YACnD,MAAMa,EAA6BD,EAAmBX,aAAa,GACnE,GAAIkB,EAAOd,WAAY,CACnBQ,EAA2BG,YAAY,MACvCpF,EAAwB0B,gBAAgBb,KAAKc,cAAcsD,GAC/D,KAAO,CACHA,EAA2BG,YAAY,MAC3C,CACJ,EAGAxB,oBAAmB,SAAA4B,IACfxF,EAAwByF,wBAAwB5E,KACpD,EAGAiD,4BAA2B,SAAA4B,EAACjE,GACxB,MAAM8D,EAAS9D,EAAOG,YACtB,MAAMoD,EAA0BO,EAAOnB,YAAYA,YACnD,MAAMa,EAA6BD,EAAmBX,aAAa,GACnE,MAAMsB,EAA0BJ,EAAOnB,YACvC,MAAMwB,EAAqBD,EAAwBtB,aAAa,GAChE,MAAMwB,EAAmBF,EAAwBtB,aAAa,GAC9D,GAAIuB,EAAmBnB,YAAcoB,EAAiBpB,WAAY,CAC9DQ,EAA2BG,YAAY,MACvCpF,EAAwBqF,2BAA2BL,EAAoB,UACvEhF,EAAwB0B,gBAAgBsD,EAAmBZ,YAAYA,YAC3E,KAAO,CACHa,EAA2BG,YAAY,MAC3C,CACJ,IAtPiBnF,EAwPH6F,8BAA6B,SAA7BA,EAA8BC,GACxC9F,EAAwB+F,wBAA0BD,CACtD,EAAC,OA1PgB9F,CAAuB","ignoreList":[]}