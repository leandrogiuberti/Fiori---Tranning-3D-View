/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../../i18n","./SearchText","./SearchRelatedObjectsToolbar","sap/m/Button","sap/m/library","sap/m/Label","sap/m/Text","sap/m/CheckBox","sap/ui/core/Icon","sap/ui/core/IconPool","sap/ui/core/InvisibleText","sap/ui/core/Control","sap/ui/base/ManagedObject","../../eventlogging/UserEvents","../../UIUtil","../SearchLink","../../sinaNexTS/sina/NavigationTarget","../../uiConstants","../../sinaNexTS/sina/AttributeFormatType"],function(e,t,i,s,a,r,n,l,o,c,d,h,u,p,g,m,f,y,b){"use strict";function I(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const S=I(e);const A=I(t);const L=I(i);const _=a["ButtonType"];const x=p["UserEventType"];const T=g["registerHandler"];const C=I(m);const R=f["NavigationTarget"];const D=y["initialValueUnicode"];const U=b["AttributeFormatType"];const E=h.extend("sap.esh.search.ui.controls.SearchResultListItem",{renderer:{apiVersion:2,render(e,t){t._renderer(e,t)}},metadata:{properties:{dataSource:"object",itemId:"string",title:"string",isTitleHighlighted:"boolean",titleDescription:"string",isTitleDescriptionHighlighted:"boolean",titleNavigation:"object",titleIconUrl:"string",titleInfoIconUrl:"string",titleInfoIconTooltip:"string",geoJson:"object",type:"string",imageUrl:"string",imageFormat:"string",imageNavigation:"object",attributes:{type:"object",multiple:true},navigationObjects:{type:"object",multiple:true},selected:"boolean",selectionEnabled:"boolean",customItemStyleClass:"string",expanded:"boolean",parentListItem:"object",additionalParameters:"object",positionInList:"int",resultSetId:"string",layoutCache:"object",countBreadcrumbsHiddenElement:"object"},aggregations:{_titleLink:{type:"sap.esh.search.ui.controls.SearchLink",multiple:false,visibility:"hidden"},_titleText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden"},_titleLinkDescription:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden"},_titleInfoIcon:{type:"sap.ui.core.Icon",multiple:false,visibility:"hidden"},_titleDelimiter:{type:"sap.m.Text",multiple:false,visibility:"hidden"},_typeText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden"},_typeLink:{type:"sap.esh.search.ui.controls.SearchLink",multiple:false,visibility:"hidden"},_typeLinkAriaDescription:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},_multiLineDescriptionText:{type:"sap.esh.search.ui.controls.SearchText",multiple:false,visibility:"hidden"},_selectionCheckBox:{type:"sap.m.CheckBox",multiple:false,visibility:"hidden"},_expandButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_attributeLabels:{type:"sap.m.Label",multiple:true,visibility:"hidden"},_attributeValues:{type:"sap.ui.core.Control",multiple:true,visibility:"hidden"},_attributeValuesWithoutWhyfoundHiddenTexts:{type:"sap.ui.core.InvisibleText",multiple:true,visibility:"hidden"},_relatedObjectActionsToolbar:{type:"sap.esh.search.ui.controls.SearchRelatedObjectsToolbar",multiple:false,visibility:"hidden"},_titleLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},_attributesLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"},_expandStateLabeledByText:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}}},constructor:function e(t,i){h.prototype.constructor.call(this,t,i);this._visibleAttributes=undefined;this._detailsArea=undefined;this._showExpandButton=false;this.setAggregation("_titleLink",new C(`${this.getId()}--titleLink`).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-Title").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));this.setAggregation("_titleText",new A(`${this.getId()}--titleText`,{wrapping:false}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-Title").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));this.setAggregation("_titleLinkDescription",new A(`${this.getId()}--titleLinkDescription`,{wrapping:false}).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));const a={src:{path:"titleInfoIconUrl"},tooltip:"{= ${titleInfoIconTooltip} ? ${titleInfoIconTooltip} : ${i18n>collectionShared} }"};const r=new o(`${this.getId()}--titleInfoIcon`,a);r.addStyleClass("sapUiSmallMarginEnd");this.setAggregation("_titleInfoIcon",r);r.addStyleClass("sapUshellSearchResultListItem-TitleInfoIcon");const c=new n(`${this.getId()}--titleDelimiter`,{text:"|"});c.addEventDelegate({onAfterRendering:()=>{const e=c.getDomRef();e?.setAttribute("aria-hidden","true")}});this.setAggregation("_titleDelimiter",c.addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleDelimiter").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));this.setAggregation("_typeText",new A(`${this.getId()}--typeText`).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleCategory").addStyleClass("sapUshellSearchResultListItem-MightOverflow"));this.setAggregation("_typeLinkAriaDescription",new d({text:S.getText("result_list_item_type_link_description")}));this.setAggregation("_typeLink",new C(`${this.getId()}--typeLink`).addStyleClass("sapUshellSearchResultListItem-HeaderEntry").addStyleClass("sapUshellSearchResultListItem-TitleCategoryLink").addStyleClass("sapUshellSearchResultListItem-MightOverflow").addAriaDescribedBy(this.getAggregation("_typeLinkAriaDescription")));this.setAggregation("_multiLineDescriptionText",new A(`${this.getId()}--multilineDescription`,{maxLines:5}).addStyleClass("sapUshellSearchResultListItem-MultiLineDescription").addStyleClass("sapUshellSearchResultListItem-MightOverflow").data("islongtext","true",true));this.setAggregation("_selectionCheckBox",new l(`${this.getId()}--selectionCheckbox`,{selected:{path:"selected"},select:e=>{this.setProperty("selected",e.getParameter("selected"),true);const t=this.getModel();t.updateMultiSelectionSelected()},enabled:{path:"/selectionEnabled"},visible:{path:"/resultviewSelectionVisibility"}}));this.setAggregation("_expandButton",new s(`${this.getId()}--expandButton`,{type:_.Transparent,press:()=>{this.toggleDetails()},visible:{parts:[{path:"/config/resultviewMasterDetailMode"}],formatter:e=>!e}}));this.setAggregation("_relatedObjectActionsToolbar",new L(`${this.getId()}--relatedObjectActionsToolbar`));this.setAggregation("_titleLabeledByText",new d);this.setAggregation("_attributesLabeledByText",new d);this.setAggregation("_expandStateLabeledByText",new d)},setProperty:function e(t,i,s){const a=h.prototype.setProperty.call(this,t,i,s);if(t==="selected")this._syncSelectionCssClass();return a},_renderer:function e(t,i){const s=this.getDomRef();const a=s?s.querySelector(".sapUshellSearchResultListItem-RelatedObjectsToolbar"):null;if(a&&window.getComputedStyle(a).display==="none"){const e=this.getModel();if(e.config.optimizeForValueHelp){a.style.display="block"}}this._registerItemPressHandler();this._resetPrecalculatedValues();this._renderContainer(t,i);this._renderAccessibilityInformation(t)},_renderContainer:function e(t,i){const s=this.getModel();t.openStart("div",this);if(this.getProperty("customItemStyleClass")){t.class(this.getProperty("customItemStyleClass"))}t.class("sapUshellSearchResultListItem-Container");if(this.getProperty("imageUrl")){t.class("sapUshellSearchResultListItem-WithImage")}if(this.getProperty("imageFormat")?.toLowerCase()==="documentthumbnail"){t.class("sapUshellSearchResultListItem-Document")}t.openEnd();this._renderContentContainer(t,i);if(!s.config.optimizeForValueHelp){this._renderExpandButtonContainer(t)}t.close("div")},_renderContentContainer:function e(t,i){t.openStart("div",i.getId()+"-content");t.class("sapUshellSearchResultListItem-Content");t.openEnd();this._renderTitleContainer(t,i);this._renderAttributesContainer(t);t.close("div")},_renderExpandButtonContainer:function e(t){t.openStart("div",this.getId()+"-expand-button-container");t.class("sapUshellSearchResultListItem-ExpandButtonContainer");t.openEnd();t.openStart("div",this.getId()+"-expand-button");t.class("sapUshellSearchResultListItem-ExpandButton");t.openEnd();let i,s;const a=this.getProperty("expanded");if(a){i=c.getIconURI("slim-arrow-up");s=S.getText("hideDetailBtn_tooltip")}else{i=c.getIconURI("slim-arrow-down");s=S.getText("showDetailBtn_tooltip")}const r=this.getAggregation("_expandButton");r.setIcon(i);r.setTooltip(s);r.addEventDelegate({onAfterRendering:()=>{this.setAriaExpandedState()}});t.renderControl(r);t.close("div");t.close("div")},_renderTitleContainer:function e(t,i){const s=this.getModel();if(!s.config.optimizeForValueHelp){t.openStart("div",this.getId()+"-title-and-image-container");t.class("sapUshellSearchResultListItem-TitleAndImageContainer");t.openEnd()}t.openStart("div",this.getId()+"-title-container");t.class("sapUshellSearchResultListItem-TitleContainer");if(s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-TitleContainerValueHelp")}t.openEnd();this._renderCheckbox(t);const a=(e,t)=>{const i=e.getAggregation("icon");if(i instanceof o){i.addStyleClass("sapUshellSearchResultListItem-Clickable")}else if(this.getProperty("titleIconUrl")){const i=new o(`${this.getId()}--titleIcon`,{src:u.escapeSettingsValue(this.getProperty("titleIconUrl"))});i?.addStyleClass("sapUshellSearchResultListItem-Clickable");e.setIcon(i);setTimeout(()=>{if(!this.isHierarchyItem()&&this.supportsDragAndDrop(e,t)){const e=i?.getDomRef();if(e){e["draggable"]=false}}},100)}};const r=this.getProperty("titleNavigation");let n=this.getProperty("title");let l;if(!n||n.trim().length===0){n=E.noValue;l=this.getAggregation("_titleText");a(l,s)}else if(!r&&!this.isHierarchyItem()){l=this.getAggregation("_titleText");this.adjustCssDragAndDrop(l,s);a(l,s)}else{l=this.getAggregation("_titleLink");l.setNavigationTarget(r);l.setIcon(this.getProperty("titleIconUrl"));if(this.isHierarchyItem()){setTimeout(()=>{if(this.supportsDragAndDrop(l,s)){if(l.getDomRef()?.children.length>0&&l.getDomRef()?.children[0]["tagName"]==="A"){l.getDomRef().children[0]["draggable"]=false}else{l.getDomRef()["draggable"]=false}this.addStyleClass("sapUshellSearchResultListItem-NotDraggableNotClickable")}},100)}else{setTimeout(()=>{if(this.supportsDragAndDrop(l,s)){l.getDomRef()["draggable"]=false}},100)}}l.setText(n);if(this.getProperty("isTitleHighlighted")){l.addStyleClass("sapUshellSearchResultItem-AttributeValueHighlighted")}t.renderControl(l);if(i.getProperty("titleInfoIconUrl")){const e=i.getAggregation("_titleInfoIcon");if(e){if(s.config.optimizeForValueHelp){e.addStyleClass("sapUshellSearchResultListItem-TitleInfoIconValueHelp")}this.adjustCssDragAndDrop(e,s);t.renderControl(e)}}if(!s.config.optimizeForValueHelp){const e=this.getProperty("titleDescription");if(e&&e.trim().length>0){const i=this.getAggregation("_titleLinkDescription");i.setText(e);if(this.getProperty("isTitleDescriptionHighlighted")){i.addStyleClass("sapUshellSearchResultItem-AttributeValueHighlighted")}t.renderControl(i)}}if(s.config.optimizeForValueHelp){this._renderRelatedObjectsToolbar(t)}else if(!s.config.exclusiveDataSource){const e=this.getAggregation("_titleDelimiter");t.renderControl(e);if(s.getDataSource()===this.getProperty("dataSource")){const e=this.getAggregation("_typeText");e.setText(this.getProperty("type"));t.renderControl(e)}else{const e=this.getModel().getProperty("/uiFilter").clone();e.setDataSource(this.getProperty("dataSource"));const i=s.createSearchNavigationTarget(e,this.getProperty("type"));const a=this.getAggregation("_typeLink");a.setNavigationTarget(i);a.setText(this.getProperty("type"));a.setTooltip(S.getText("searchInDataSourceTooltip",[this.getProperty("dataSource").labelPlural]));t.renderControl(this.getAggregation("_typeLinkAriaDescription"));t.renderControl(a)}}t.close("div");if(!s.config.optimizeForValueHelp){this._renderImageForPhone(t);t.close("div")}},_renderCheckbox:function e(t){t.openStart("div",this.getId()+"-checkbox-expand-container");t.class("sapUshellSearchResultListItem-CheckboxExpandContainer");t.openEnd();t.openStart("div",this.getId()+"-checkbox-container");t.class("sapUshellSearchResultListItem-CheckboxContainer");t.openEnd();t.openStart("div",this.getId()+"-checkbox-alignment-container");t.class("sapUshellSearchResultListItem-CheckboxAlignmentContainer");t.openEnd();const i=this.getAggregation("_selectionCheckBox");t.renderControl(i);t.close("div");t.close("div");t.close("div")},_renderImageForPhone:function e(t){if(this.getProperty("imageUrl")){t.openStart("div",this.getId()+"-title-image");t.class("sapUshellSearchResultListItem-TitleImage");if(this.getProperty("imageFormat")===U.Round){t.class("sapUshellSearchResultListItem-ImageContainerRound")}t.openEnd();t.openStart("div",this.getId()+"-image-container-aligmnent-helper");t.class("sapUshellSearchResultListItem-ImageContainerAlignmentHelper");t.openEnd();t.close("div");t.openStart("img",this.getId()+"-image-1");t.class("sapUshellSearchResultListItem-Image");t.attr("src",this.getProperty("imageUrl"));t.openEnd();t.close("div");t.close("div")}},_renderImageForDocument:function e(t){if(this.getProperty("imageFormat")&&this.getProperty("imageFormat").toLowerCase()==="documentthumbnail"){const e=this.getProperty("imageNavigation");const i=e?e.targetUrl:"";if(typeof this._zoomIcon!=="undefined"){this._zoomIcon.destroy()}this._zoomIcon=new o("",{src:c.getIconURI("search"),useIconTooltip:false});this._zoomIcon.addStyleClass(`${this.getId()}--zoomIcon`);this._zoomIcon.addStyleClass("sapUshellSearchResultListItem-DocumentThumbnailZoomIcon");const s=this.getProperty("imageUrl");t.openStart("div",this.getId()+"-document-thumbnail-container");t.class("sapUshellSearchResultListItem-DocumentThumbnailContainer");t.openEnd();if(i&&i.length>0){t.openStart("a",this.getId()+"-document-thumbnail-border-1");t.attr("href",i);t.class("sapUshellSearchResultListItem-DocumentThumbnailBorder");t.openEnd();t.openStart("div",this.getId()+"-document-thumbnail-dogear-1");t.class("sapUshellSearchResultListItem-DocumentThumbnail-DogEar");t.openEnd();t.close("div");t.renderControl(this._zoomIcon);if(s&&s.length>0){t.openStart("img",this.getId()+"-document-thumbnail-1");t.class("sapUshellSearchResultListItem-DocumentThumbnail");t.attr("src",this.getProperty("imageUrl"));t.openEnd();t.close("img")}t.close("a")}else{t.openStart("div",this.getId()+"-document-thumbnail-border-2");t.class("sapUshellSearchResultListItem-DocumentThumbnailBorder");t.openEnd();t.openStart("div",this.getId()+"-document-thumbnail-dogear-2");t.class("sapUshellSearchResultListItem-DocumentThumbnail-DogEar");t.openEnd();t.close("div");t.renderControl(this._zoomIcon);if(s&&s.length>0){t.openStart("img",this.getId()+"-document-thumbnail-2");t.class("sapUshellSearchResultListItem-DocumentThumbnail");t.attr("src",this.getProperty("imageUrl"));t.openEnd();t.close("img")}t.close("div")}t.close("div")}},_cutDescrAttributeOutOfAttributeList:function e(){const t=this.getProperty("attributes");for(let e=0;e<t.length;e++){const i=t[e];if(i.longtext){t.splice(e,1);this.setProperty("attributes",t);return i}}return undefined},_renderMultiLineDescription:function e(t){const i=this.getModel();if(this.getProperty("imageFormat")?.toLowerCase()==="documentthumbnail"){const e=this._cutDescrAttributeOutOfAttributeList();if(e?.value?.length>0){const s=this.getAggregation("_multiLineDescriptionText");s.setText(e.value);if(e.whyfound){s.data("ishighlighted","true",true)}else{s.data("ishighlighted","false",true)}if(e.valueWithoutWhyfound){const i=new d({});i.setText(e.valueWithoutWhyfound);s.data("tooltippedBy",i.getId(),true);s.addEventDelegate({onAfterRendering:()=>{const e=s.getDomRef();if(e){e.setAttribute("aria-describedby",e.getAttribute("data-tooltippedby")||"")}}});this.addAggregation("_attributeValuesWithoutWhyfoundHiddenTexts",i,true);t.renderControl(i)}this.adjustCssDragAndDrop(s,i);t.renderControl(s)}else{t.openStart("div",this.getId()+"-multiline-description");t.class("sapUshellSearchResultListItem-MultiLineDescription");t.openEnd();t.close("div")}}},_renderAttributesContainer:function e(t){const i=this.getModel();t.openStart("div",this.getId()+"-attribute-expand-container");t.class("sapUshellSearchResultListItem-AttributesExpandContainer");if(i.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-AttributesExpandContainerValueHelp")}const s=this.getProperty("expanded");if(s){t.class("sapUshellSearchResultListItem-AttributesExpanded")}t.openEnd();t.openStart("div",this.getId()+"-attributes-and-actions");t.class("sapUshellSearchResultListItem-AttributesAndActions");t.openEnd();if(!i.config.optimizeForValueHelp){this._renderImageForDocument(t);this._renderMultiLineDescription(t)}t.openStart("ul",this.getId()+"-attributes");t.class("sapUshellSearchResultListItem-Attributes");t.openEnd();const a=this.getProperty("attributes");if(!i.config.optimizeForValueHelp){this._renderImageAttribute(t,a.length===0)}this._renderAllAttributes(t,a);if(!i.config.optimizeForValueHelp){t.openStart("li",this.getId()+"-expand-spacer-attribute");t.class("sapUshellSearchResultListItem-ExpandSpacerAttribute");t.attr("aria-hidden","true");t.openEnd();t.close("li")}t.close("ul");if(!i.config.optimizeForValueHelp){this._renderRelatedObjectsToolbar(t)}t.close("div");t.close("div")},_renderAllAttributes:function e(t,i){const s=this.getModel();if(i.length===0){t.openStart("li",this.getId()+"-generic-attribute-1");t.class("sapUshellSearchResultListItem-GenericAttribute");if(s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-GenericAttributeValueHelp")}t.class("sapUshellSearchResultListItem-MainAttribute");t.class("sapUshellSearchResultListItem-EmptyAttributePlaceholder");t.attr("aria-hidden","true");t.openEnd();t.close("li");return}let a;let n;let l;let c;let h,p,g;let m;let f;const y=this.getProperty("layoutCache")||{};this.setProperty("layoutCache",y,true);if(!y.attributes){y.attributes={}}let b=0,I=0;let S=4;let L=3;let _=[0,0,0];let x=[0,0,0,0];let T=2;let D=2;let U;const v=this.getProperty("imageFormat")&&this.getProperty("imageFormat").toLowerCase()==="documentthumbnail";const P=this.getProperty("imageUrl")&&!v&&!s.config.optimizeForValueHelp;if(v&&!s.config.optimizeForValueHelp){S=L=2;_=x=[0,0];T=D=4}let w=S*_.length;let H=L*x.length;if(P){w--;H--;_[0]++;x[0]++}this.destroyAggregation("_attributeLabels");this.destroyAggregation("_attributeValues");this.destroyAggregation("_attributeValuesWithoutWhyfoundHiddenTexts");const F=e=>()=>{const e=this.getDomRef();if(e){const t=e.getAttribute("data-tooltippedby");if(t){e.setAttribute("aria-describedby",t)}else{e.removeAttribute("aria-describedby")}}};for(b=0;!(T<=0&&D<=0)&&b<i.length;b++){a=i[b];const e=this.getModel();if(e.config.optimizeForValueHelp&&!a.whyfound){continue}if(v&&I>=4){break}if(a.isTitle){continue}if(w<=0&&H<=0&&!a.whyfound){continue}n=a.name;l=a.value;if(n===undefined||l===undefined){continue}if(!l||l.trim().length===0){l=E.noValue}if(a.longtext===undefined||a.longtext===null||a.longtext===""){g=false}else{g=true}c=a.valueWithoutWhyfound;let s=-1,O=-1,k={desktop:1,tablet:1};const V=y.attributes[a.key]||{};y.attributes[a.key]=V;t.openStart("li",this.getId()+"-generic-attribute-2-"+b);t.class("sapUshellSearchResultListItem-GenericAttribute");if(e.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-GenericAttributeValueHelp")}t.class("sapUshellSearchResultListItem-MainAttribute");if(g){U=V.longTextColumnNumber||this._howManyColumnsToUseForLongTextAttribute(c);V.longTextColumnNumber=U;k=U;t.class("sapUshellSearchResultListItem-LongtextAttribute")}if(w<=0){if(a.whyfound&&T>0){t.class("sapUshellSearchResultListItem-WhyFoundAttribute-Desktop");T--}else{t.class("sapUshellSearchResultListItem-DisplayNoneAttribute-Desktop")}}if(H<=0){if(a.whyfound&&D>0){t.class("sapUshellSearchResultListItem-WhyFoundAttribute-Tablet");D--}else{t.class("sapUshellSearchResultListItem-DisplayNoneAttribute-Tablet")}}if(g&&P&&_[0]===1){O=0;U=V.longTextColumnNumber.desktop<S?V.longTextColumnNumber.desktop:S-1;_[0]+=U;w-=U}else{for(let e=0;e<_.length;e++){if(_[e]+k.desktop<=S){_[e]+=k.desktop;w-=k.desktop;O=e;break}}}if(O<0){O=_.length}if(g&&P&&x[0]===1){s=0;U=V.longTextColumnNumber.tablet<L?V.longTextColumnNumber.tablet:L-1;x[0]+=U;H-=U}else{for(let e=0;e<x.length;e++){if(x[e]+k.tablet<=L){x[e]+=k.tablet;H-=k.tablet;s=e;break}}}if(s<0){s=x.length}t.class("sapUshellSearchResultListItem-OrderTablet-"+s);t.class("sapUshellSearchResultListItem-OrderDesktop-"+O);if(g){t.attr("data-sap-searchresultitem-attributeweight-desktop",k.desktop);t.attr("data-sap-searchresultitem-attributeweight-tablet",k.tablet)}t.openEnd();h=new r(`${this.getId()}--attr${b}_labelText`,{displayOnly:true,showColon:true});h.setText(n);h.addStyleClass("sapUshellSearchResultListItem-AttributeKey");h.addStyleClass("sapUshellSearchResultListItem-MightOverflow");this.adjustCssDragAndDrop(h,e);t.renderControl(h);t.openStart("span",this.getId()+"-attribute-value-container-"+b);t.class("sapUshellSearchResultListItem-AttributeValueContainer");if(e.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-AttributeValueContainerValueHelp")}t.openEnd();if(a.defaultNavigationTarget instanceof R){const e=a.defaultNavigationTarget;p=new C(`${this.getId()}--attr${b}_defNavTarget_Link`,{navigationTarget:null,wrapping:false,tooltip:u.escapeSettingsValue(a.tooltip||"")});p.setNavigationTarget(e);p.setText(l);p.addStyleClass("sapUshellSearchResultListItem-AttributeLink");p.setIcon(a.iconUrl)}else{p=new A(`${this.getId()}--attr${b}_noDefNavTarget_Text`);p.setText(l);f=undefined;if(a.iconUrl){f=new o(`${this.getId()}--attr${b}_itemAttributeIcon`,{src:u.escapeSettingsValue(a.iconUrl)});f.addStyleClass("sapUshellSearchResultListItem-AttributeIcon")}if(f){p.setIcon(f)}}p.addStyleClass("sapUshellSearchResultListItem-AttributeValue");p.addStyleClass("sapUshellSearchResultListItem-MightOverflow");if(a.whyfound){p.data("ishighlighted","true",true);p.addStyleClass("sapUshellSearchResultItem-AttributeValueHighlighted")}if(g){p.data("islongtext","true",true)}if(c&&!(p instanceof C&&p.getTooltip())){m=new d({});m.addStyleClass("sapUshellSearchResultListItem-AttributeValueContainer-HiddenText");m.setText(c);p.data("tooltippedBy",m.getId(),true);p.addEventDelegate({onAfterRendering:F(p)});this.addAggregation("_attributeValuesWithoutWhyfoundHiddenTexts",m,true);t.renderControl(m)}this.adjustCssDragAndDrop(p,e);t.renderControl(p);t.close("span");t.close("li");this.addAggregation("_attributeLabels",h,true);this.addAggregation("_attributeValues",p,true);I++}if(P){const e=S-_[0];const i=L-x[0];if(e>0||i>0){t.openStart("li",this.getId()+"-generic-attribute-3");t.class("sapUshellSearchResultListItem-GenericAttribute");if(s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-GenericAttributeValueHelp")}t.class("sapUshellSearchResultListItem-MainAttribute");t.class("sapUshellSearchResultListItem-OrderTablet-0");t.class("sapUshellSearchResultListItem-OrderDesktop-0");t.attr("data-sap-searchresultitem-attributeweight-desktop",e);t.attr("data-sap-searchresultitem-attributeweight-tablet",i);t.openEnd();t.close("li")}}},_howManyColumnsToUseForLongTextAttribute:function e(t){if(t.length<50){return{tablet:1,desktop:1}}if(t.length<85){return{tablet:2,desktop:2}}if(t.length<135){return{tablet:3,desktop:3}}return{tablet:3,desktop:4}},_renderImageAttribute:function e(t,i){const s=this.getModel();if(!this.getProperty("imageUrl")||this.getProperty("imageFormat")&&this.getProperty("imageFormat").toLowerCase()==="documentthumbnail"){return}t.openStart("li",this.getId()+"-generic-attribute-4");t.class("sapUshellSearchResultListItem-GenericAttribute");if(s.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-GenericAttributeValueHelp")}t.class("sapUshellSearchResultListItem-ImageAttribute");if(i){t.class("sapUshellSearchResultListItem-LonelyImageAttribute")}t.openEnd();t.openStart("div",this.getId()+"-image-container");t.class("sapUshellSearchResultListItem-ImageContainer");if(this.getProperty("imageFormat")===U.Round){t.class("sapUshellSearchResultListItem-ImageContainerRound")}t.openEnd();if(this.getProperty("imageUrl")){t.openStart("img",this.getId()+"-image-2");t.class("sapUshellSearchResultListItem-Image");if(this.getProperty("imageFormat")===U.Round){}t.attr("src",this.getProperty("imageUrl"));t.openEnd();t.close("img")}if(this.getProperty("imageFormat")!=="round"){t.openStart("div",this.getId()+"-image-container-aligment-helper");t.class("sapUshellSearchResultListItem-ImageContainerAlignmentHelper");t.openEnd();t.close("div")}t.close("div");t.close("li")},_renderRelatedObjectsToolbar:function e(t){const i=this.getProperty("navigationObjects");if(!i||i.length===0){return}this._showExpandButton=true;const s=this.getAggregation("_relatedObjectActionsToolbar");s.setProperty("navigationObjects",i);s.setProperty("positionInList",this.getProperty("positionInList"));t.renderControl(s)},_renderAccessibilityInformation:function e(t){const i=this.getProperty("parentListItem");if(i){this._renderAriaDescriptionElementForTitle(t,true,true);this._renderAriaDescriptionElementForAttributes(t,true);this._renderAriaDescriptionElementForCollapsedOrExpandedState(t,true);i.addEventDelegate({onAfterRendering:()=>{this._addAriaDescriptionToParentListElement(i,true);T("acc-listitem-focusin",[i.getDomRef()],"focusin",e=>{const s=e.relatedTarget;if(s?.classList.contains("sapUshellSearchResultListItem")||s?.closest(".sapUshellSearchResultListItemApps")&&!s.classList.contains("sapUshellResultListMoreFooter")){this._renderAriaDescriptionElementForTitle(t,false,false);this._renderAriaDescriptionElementForAttributes(t,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(t,false);this._addAriaDescriptionToParentListElement(i,false)}else{this._renderAriaDescriptionElementForTitle(t,true,false);this._renderAriaDescriptionElementForAttributes(t,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(t,false);this._addAriaDescriptionToParentListElement(i,true)}})},onsapspace:e=>{if(e["target"]===e["currentTarget"]){this.toggleDetails()}},onsapenter:e=>{if(e["target"]===e["currentTarget"]){const e=this.getProperty("titleNavigation");if(e instanceof R){e.performNavigation()}}}})}},getAccessibilityInfo:function e(...t){let i={};if(h.prototype.getAccessibilityInfo){i=h.prototype.getAccessibilityInfo.apply(this,t)||i}i["description"]="";return i},_renderAriaDescriptionElementForTitle:function e(t,i,s){this._searchResultListPrefix=this._searchResultListPrefix||S.getText("result_list_announcement_screenreaders");let a=this.getProperty("title")+", "+this.getProperty("type")+".";if(i){a=this._searchResultListPrefix+" "+a}const r=this.getAggregation("_titleLabeledByText");if(r){r.setText(a)}if(s&&t){t.renderControl(r)}},_renderAriaDescriptionElementForAttributes:function e(t,i){const s=this.getAggregation("_attributesLabeledByText");const a=this.getDomRef();if(!a){return}const r=a.querySelectorAll(".sapUshellSearchResultListItem-Attributes .sapUshellSearchResultListItem-MainAttribute");let n;if(r.length===0){n=S.getText("result_list_item_aria_no_attributes")}else{n=S.getText("result_list_item_aria_has_attributes");r.forEach(e=>{const t=e.offsetParent!==null&&e.getAttribute("aria-hidden")!=="true";if(t){const t=e.querySelector(".sapUshellSearchResultListItem-AttributeKey");const i=t?t.textContent:"";const s=e.querySelector(".sapUshellSearchResultListItem-AttributeValueContainer");let a=s&&s.querySelector(".sapUshellSearchResultListItem-AttributeValueContainer-HiddenText");if(!a){a=s}const r=a?a.textContent:"";n+=S.getText("result_list_item_aria_attribute_and_value",[i,r])}})}if(s){s.setText(n)}if(i&&t){t.renderControl(s)}},_renderAriaDescriptionElementForCollapsedOrExpandedState:function e(t,i){const s=this.getAggregation("_expandStateLabeledByText");let a;const r=this.getAggregation("_expandButton");if(!r){return}const n=r.getDomRef();if(n&&window.getComputedStyle(n).visibility!=="hidden"){if(this.isShowingDetails()){a=S.getText("result_list_item_aria_expanded");const e=this.getProperty("navigationObjects");if(Array.isArray(e)&&e.length>0){a=S.getText("result_list_item_aria_has_links")+a}}else{a=S.getText("result_list_item_aria_collapsed")}}s.setText(a);if(i&&t){t.renderControl(s)}},_addAriaDescriptionToParentListElement:function e(t,i){const s=this.getAggregation("_titleLabeledByText");if(!s){return}let a=s.getId();if(i){const e=this.getProperty("countBreadcrumbsHiddenElement");if(e){a+=" "+e.getId()}}const r=this.getAggregation("_attributesLabeledByText");a+=" "+r.getId();const n=this.getAggregation("_expandStateLabeledByText");a+=" "+n.getId();const l=t.getDomRef();if(l){l.setAttribute("aria-labelledby",a)}},_getExpandAreaObjectInfo:function e(){const t=this.getModel();const i=this.getDomRef();if(!i){throw new Error("DOM reference not found")}const s=this.getDomRef();s?.classList.add("sapUshellSearchResultListItem-AttributesPrepareExpansion");const a=i.querySelector(".sapUshellSearchResultListItem-AttributesExpandContainer");const r=i.querySelector(".sapUshellSearchResultListItem-RelatedObjectsToolbar");let n=false;if(r&&window.getComputedStyle(r).display==="none"&&!t.config.optimizeForValueHelp){r.style.display="block";n=true}const l=a?a.offsetHeight:0;const o=i.querySelector(".sapUshellSearchResultListItem-AttributesAndActions")?.offsetHeight||0;i.classList.remove("sapUshellSearchResultListItem-AttributesPrepareExpansion");if(r&&n){r.style.display=""}const c=this._getElementsInExpandArea();const d=200;const h=d/10;const u={resultListItem:this.getDomRef(),attributesExpandContainer:a,currentHeight:l,expandedHeight:o,elementsToFadeInOrOut:c,expandAnimationDuration:d,fadeInOrOutAnimationDuration:h,relatedObjectsToolbar:r};return u},_getElementsInExpandArea:function e(){const t=this.getDomRef();const i=[];if(!t){return i}t.classList.add("sapUshellSearchResultListItem-AttributesPrepareExpansion");const s=Array.from(t.querySelectorAll(".sapUshellSearchResultListItem-GenericAttribute:not(.sapUshellSearchResultListItem-ImageAttribute)"));if(s.length>0){const e=s[0].getBoundingClientRect().top;s.forEach(t=>{if(t.getBoundingClientRect().top>e){i.push(t)}})}t.classList.remove("sapUshellSearchResultListItem-AttributesPrepareExpansion");return i},_syncSelectionCssClass:function e(){const t=this.getProperty("selected");if(t){this.addStyleClass("sapUshellSearchResultListItem-Selected")}else{this.removeStyleClass("sapUshellSearchResultListItem-Selected")}},isShowingDetails:function e(){const t=this._getExpandAreaObjectInfo();if(t.currentHeight<t.expandedHeight){return false}return true},showDetails:function e(){if(this.isShowingDetails()){return}const t=this._getExpandAreaObjectInfo();let i;if(t?.attributesExpandContainer){i=t.attributesExpandContainer}if(t.relatedObjectsToolbar){const e=t?.relatedObjectsToolbar;if(e){e.style.opacity="0";e.style.display="block"}}const s=this.getAggregation("_relatedObjectActionsToolbar");if(s){s.layoutToolbarElements()}const a=this.getDomRef();if(a){a.classList.add("sapUshellSearchResultListItem-AttributesPrepareExpansion")}let r;if(t?.relatedObjectsToolbar){r=t.relatedObjectsToolbar}const n=t.elementsToFadeInOrOut;const l=t.expandedHeight;const o=t.expandAnimationDuration;const d=t.fadeInOrOutAnimationDuration;if(i){i.style.transition=`height ${o}ms`;i.style.height=`${l}px`}n.forEach(e=>{e.style.transition=`opacity ${d}ms`;e.style.opacity="1"});if(r){r.style.transition=`opacity ${o}ms`;setTimeout(()=>{r.style.opacity="1"},o/2)}setTimeout(()=>{this.setProperty("expanded",true,true);if(i){i.classList.add("sapUshellSearchResultListItem-AttributesExpanded")}n.forEach(e=>{e.style.opacity="";e.style.transition=""});const e=this.getDomRef();if(e){e.classList.remove("sapUshellSearchResultListItem-AttributesPrepareExpansion")}if(r){r.style.display="";r.style.opacity="";r.style.transition=""}const t=this.getAggregation("_expandButton");if(t){t.setTooltip(S.getText("hideDetailBtn_tooltip"));t.setIcon(c.getIconURI("slim-arrow-up"))}this._renderAriaDescriptionElementForAttributes(undefined,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false)},o)},hideDetails:function e(){if(!this.isShowingDetails()){return}const t=this._getExpandAreaObjectInfo();const i=t.elementsToFadeInOrOut;const s=t.expandAnimationDuration;const a=t.fadeInOrOutAnimationDuration;let r=false;let n;if(t?.attributesExpandContainer){n=t.attributesExpandContainer}let l;if(t?.relatedObjectsToolbar){l=t.relatedObjectsToolbar}if(l){l.style.transition=`opacity ${s/2}ms`;l.style.opacity="0"}const o=this.getDomRef();let d=0;if(o){const e=o.querySelector(".sapUshellSearchResultListItem-MainAttribute");const t=o.querySelector(".sapUshellSearchResultListItem-ExpandSpacerAttribute");if(e){d+=e.offsetHeight}if(t){d+=t.offsetHeight}}const h=e=>{if(e.propertyName==="height"){if(n){n.removeEventListener("transitionend",h)}clearTimeout(u);if(!r){i.forEach(e=>{e.style.opacity="0"})}if(n){n.classList.remove("sapUshellSearchResultListItem-AttributesExpanded");n.style.height="";n.style.transition=""}i.forEach(e=>{e.style.opacity="";e.style.transition=""});if(l){l.style.opacity="";l.style.transition=""}this.setProperty("expanded",false,true);const e=this.getAggregation("_expandButton");if(e){e.setTooltip(S.getText("showDetailBtn_tooltip"));e.setIcon(c.getIconURI("slim-arrow-down"))}this._renderAriaDescriptionElementForAttributes(undefined,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false)}};if(n){n.addEventListener("transitionend",h);n.style.transition=`height ${s}ms`;n.style.height=`${d}px`}const u=setTimeout(()=>{r=true;i.forEach(e=>{e.style.transition=`opacity ${a}ms`;e.style.opacity="0"})},s-a)},toggleDetails:function e(){let t;const i=this.getModel();if(this.isShowingDetails()){t=x.ITEM_HIDE_DETAILS;this.hideDetails()}else{t=x.ITEM_SHOW_DETAILS;this.showDetails()}i.eventLogger.logEvent({type:t,itemPosition:this.getProperty("positionInList"),executionId:this.getProperty("resultSetId"),dataSourceKey:i.getDataSource().id})},onAfterRendering:function e(){this._showOrHideExpandButton();this._renderAriaDescriptionElementForTitle(undefined,false,false);this._renderAriaDescriptionElementForAttributes(undefined,false);this._renderAriaDescriptionElementForCollapsedOrExpandedState(undefined,false);this._syncSelectionCssClass()},resizeEventHappened:function e(){this._showOrHideExpandButton();const t=this.getAggregation("_titleLink");const i=this.getAggregation("_titleText");const s=t.getDomRef()?t:i;const a=this.getModel();if(this.supportsDragAndDrop(t,a)){if(a.config.optimizeForValueHelp){const e=s.getDomRef();e.draggable=false}}},isHierarchyItem:function e(){return this.getProperty("titleIconUrl")==="sap-icon://folder-blank"},supportsDragAndDrop:function e(t,i){return typeof i.getSearchCompositeControlInstanceByChildControl(t)!=="undefined"&&i.getSearchCompositeControlInstanceByChildControl(t).getDragDropConfig().length>0},_getPhoneSize:function e(){return 767},_resetPrecalculatedValues:function e(){this._visibleAttributes=undefined;this._detailsArea=undefined;this._showExpandButton=false},_showOrHideExpandButton:function e(){const t=this.getDomRef();if(!t){return}const i=t.querySelector(".sapUshellSearchResultListItem-ExpandButtonContainer");if(!i){return}const s=window.getComputedStyle(i).visibility!=="hidden";let a=false;const r=this.getProperty("imageFormat")?.toLowerCase()==="documentthumbnail";if(!r){const e=t.querySelectorAll(".sapUshellSearchResultListItem-RelatedObjectsToolbar");a=e.length>0}if(!r&&!a){const e=this._getElementsInExpandArea();if(e.length>0){a=true}}if(s&&!a){i.style.visibility="hidden";i.setAttribute("aria-hidden","true");this.setAriaExpandedState()}else if(!s&&a){i.style.visibility="";i.removeAttribute("aria-hidden");this.setAriaExpandedState()}},setAriaExpandedState:function e(){const t=this.getAggregation("_expandButton");if(!t){return}const i=t.getDomRef();const s=this.getDomRef();let a=null;const r=this.getProperty("parentListItem");if(r){a=r.getDomRef()}else if(s){a=s.closest("li")}const n=s?.querySelector(".sapUshellSearchResultListItem-ExpandButtonContainer");if(n&&window.getComputedStyle(n).visibility==="hidden"){if(i){i.removeAttribute("aria-expanded")}if(a){a.removeAttribute("aria-expanded")}}else{const e=this.getProperty("expanded");if(i){i.setAttribute("aria-expanded",e?"true":"false")}if(a){a.setAttribute("aria-expanded",e?"true":"false")}}},_registerItemPressHandler:function e(){const t=this.getProperty("parentListItem");if(t){t.attachPress(e=>{this._performTitleNavigation({event:e})});this._registerItemPressHandler=()=>{}}},_performTitleNavigation:function e(t){const i=this.getProperty("titleNavigation");if(i instanceof R){i.performNavigation({event:t?.event})}},adjustCssDragAndDrop:function e(t,i){setTimeout(()=>{if(typeof i.getSearchCompositeControlInstanceByChildControl(t)!=="undefined"&&i.getSearchCompositeControlInstanceByChildControl(t).getDragDropConfig().length>0){t.addStyleClass("sapUshellSearchResultListItem-SupportsDragAndDrop")}})}});E.noValue=D;return E});
//# sourceMappingURL=SearchResultListItem.js.map