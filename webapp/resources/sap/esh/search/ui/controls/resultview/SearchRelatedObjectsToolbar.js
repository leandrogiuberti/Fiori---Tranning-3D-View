/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../../i18n","sap/m/Toolbar","sap/m/library","sap/m/Button","sap/m/ToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/ActionSheet","sap/ui/core/InvisibleText","sap/ui/core/IconPool","sap/ui/core/delegate/ItemNavigation","sap/ui/core/Control","../../sinaNexTS/sina/NavigationTarget","../SearchLink"],function(t,e,o,s,i,a,n,r,l,c,d,g,h){"use strict";function p(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const u=p(t);const f=o["ToolbarDesign"];const b=o["ButtonType"];const m=o["PlacementType"];const y=g["NavigationTarget"];const _=p(h);const v=d.extend("sap.esh.search.ui.controls.SearchRelatedObjectsToolbar",{renderer:{apiVersion:2,render(t,e){t.openStart("div",e);t.class("sapUshellSearchResultListItem-RelatedObjectsToolbar");const o=e.getModel();if(o.config.optimizeForValueHelp){t.class("sapUshellSearchResultListItem-RelatedObjectsToolbarValueHelp")}t.openEnd();t.renderControl(e.getAggregation("_ariaDescriptionForLinks"));e._renderToolbar(t,e);t.close("div")}},metadata:{properties:{itemId:"string",navigationObjects:{type:"object",multiple:true},positionInList:"int"},aggregations:{_relatedObjectActionsToolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"},_ariaDescriptionForLinks:{type:"sap.ui.core.InvisibleText",multiple:false,visibility:"hidden"}}},constructor:function t(o,s){d.prototype.constructor.call(this,o,s);const i=new e(`${this.getId()}--toolbar`,{design:f.Solid});i.data("sap-ui-fastnavgroup","false",true);i.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Toolbar");i.addEventDelegate({onAfterRendering:this.layoutToolbarElements.bind(this)});this.setAggregation("_relatedObjectActionsToolbar",i);this.setAggregation("_ariaDescriptionForLinks",new r({text:u.getText("result_list_item_aria_has_more_links")}));window.addEventListener("resize",()=>{this.layoutToolbarElements()})},exit:function t(...e){if(d.prototype.exit){d.prototype.exit.apply(this,e)}this._overFlowActionSheet?.destroy()},_renderToolbar:function t(e,o){const r=o.getModel();const c=o.getAggregation("_relatedObjectActionsToolbar");c.destroyContent();if(r.config.optimizeForValueHelp){c.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-ToolbarValueHelp")}const d=o.getProperty("navigationObjects");if(Array.isArray(d)&&d.length>0){const t=d.map((t,e)=>{const s=new _(`${o.getId()}--link_${e}`,{text:t?.text||"",navigationTarget:t,layoutData:new i({shrinkable:false})});s.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element");return s});const g=new a;g.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Spacer");c.addContent(g);t.forEach(t=>{c.addContent(t)});this._overFlowButton=new s(`${this.getId()}--overflowButton`,{icon:l.getIconURI("overflow")});this._overFlowButton.addStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-OverFlowButton");if(r.config.optimizeForValueHelp){this._overFlowButton.addStyleClass("sapUiSmallMarginBegin");this._overFlowButton.addStyleClass("sapUiTinyMarginEnd");this._overFlowButton.setType(b.Transparent)}c.addContent(this._overFlowButton);if(!this._overFlowActionSheet){this._overFlowActionSheet=new n(`${this.getId()}--actionSheet`,{placement:m.Top})}this._overFlowButton.attachPress(()=>{if(this._overFlowActionSheet.isOpen()){this._overFlowActionSheet.close()}else{this._overFlowActionSheet.openBy(this._overFlowButton)}});e.renderControl(c)}},onAfterRendering:function t(){if(this.getAggregation("_relatedObjectActionsToolbar")){this._addAriaInformation()}},layoutToolbarElements:function t(){if(this.isDestroyed()||this.isDestroyStarted()){return}const e=this.getAggregation("_relatedObjectActionsToolbar");if(!(this.getDomRef()&&e.getDomRef())){return}const o=this.getAggregation("_relatedObjectActionsToolbar").getDomRef();const i=o.offsetWidth;if(getComputedStyle(this.getDomRef()).display==="none"||getComputedStyle(o).display==="none"){return}this.toolbarWidth=i;const a=this._overFlowButton.getDomRef();a.style.display="none";let n=0;const r=(t,e)=>{if(e instanceof y){e.performNavigation({event:t})}};const l=Array.from(o.querySelectorAll(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element"));let c;for(let t=0;t<l.length;t++){c=l[t];c.style.display="";const e=c.offsetWidth+parseInt(getComputedStyle(c).marginLeft)+parseInt(getComputedStyle(c).marginRight);const o=n+e;if(o>i){a.style.display="";const e=a.offsetWidth+parseInt(getComputedStyle(a).marginLeft)+parseInt(getComputedStyle(a).marginRight);for(;t>=0;t--){c=l[t];n-=c.offsetWidth+parseInt(getComputedStyle(c).marginLeft)+parseInt(getComputedStyle(c).marginRight);if(n+e<=i){break}}const o=this.getProperty("navigationObjects");this._overFlowActionSheet.destroyButtons();t=t>=0?t:0;for(;t<l.length;t++){c=l[t];c.style.display="none";const e=o[t];const i=new s({text:e?.text||""});i.attachPress(e,r);this._overFlowActionSheet.addButton(i)}break}n=o}if(this._overFlowActionSheet.getButtons().length===l.length){}else{this._setupItemNavigation()}},_setupItemNavigation:function t(){if(!this._theItemNavigation){this._theItemNavigation=new c(null,[]);this["addDelegate"](this._theItemNavigation)}this._theItemNavigation.setCycling(false);this._theItemNavigation.setRootDomRef(this.getDomRef());const e=[];const o=this.getAggregation("_relatedObjectActionsToolbar");const s=o.getContent();s.filter(t=>t.hasStyleClass("sapUshellSearchResultListItem-RelatedObjectsToolbar-Element")).forEach(t=>{const o=t.getDomRef();if(o&&!o.hasAttribute("tabindex")){let e="-1";if(t["getPressed"]&&t["getPressed"]()){e="0"}o.setAttribute("tabindex",e)}e.push(o)});const i=this._overFlowButton.getDomRef();i?.setAttribute("tabindex","-1");e.push(i);this._theItemNavigation.setItemDomRefs(e)},_addAriaInformation:function t(){const e=this.getAggregation("_relatedObjectActionsToolbar").getDomRef();const o=Array.from(e.querySelectorAll(".sapUshellSearchResultListItem-RelatedObjectsToolbar-Element"));const s=this._overFlowButton.getDomRef();const i=s.offsetParent!==null;if(o.length>0||i){const t=this.getAggregation("_ariaDescriptionForLinks").getId();o.forEach(function(e){let o=e.getAttribute("aria-describedby")||"";o+=" "+t;e.setAttribute("aria-describedby",o)});if(i){let e=s.getAttribute("aria-describedby")||"";e+=" "+t;s.setAttribute("aria-describedby",e)}}}});return v});
//# sourceMappingURL=SearchRelatedObjectsToolbar.js.map