{"version":3,"file":"SinaObjectSuggestionFormatter.js","names":["sap","ui","define","___sinaNexTS_sina_SearchResultSetItemAttribute","___sinaNexTS_sina_AttributeType","SearchResultSetItemAttribute","AttributeType","Formatter","assembleLabel1","sinaSuggestion","title","isHighlighted","attribute","titleAttributes","object","i","length","metadata","type","ImageUrl","push","valueHighlighted","label","join","assembleLabel2","label1IsHighlighted","detailAttributes","this","getFirstHighlightedAttribute","getFirstStringAttribute","attributes","sortOrder","Date","Double","GeoJson","ImageBlob","Integer","String","Time","Timestamp","slice","sort","a1","a2","assembleNavigation","defaultNavigationTarget","navigationTarget","target","assembleImageUrl","aAttributes","concat","sina","imageUrl","value","imageExists","imageIsCircular","format","AttributeFormatType","Round","exists","suggestionProvider","suggestion","label1","label2","titleNavigation","core","extend","position","addSuggestion"],"sources":["SinaObjectSuggestionFormatter.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport SearchModel from \"sap/esh/search/ui/SearchModel\";\nimport { SearchResultSetItemAttribute } from \"../sinaNexTS/sina/SearchResultSetItemAttribute\";\nimport { UISinaObjectSuggestion } from \"./SuggestionType\";\nimport { NavigationTarget } from \"../sinaNexTS/sina/NavigationTarget\";\nimport { AttributeType } from \"../sinaNexTS/sina/AttributeType\";\n\nexport default class Formatter {\n    private assembleLabel1(sinaSuggestion: UISinaObjectSuggestion): {\n        label: string;\n        isHighlighted: boolean;\n    } {\n        const title = [];\n        let isHighlighted = false;\n        let attribute;\n        const titleAttributes = sinaSuggestion.object.titleAttributes;\n        for (let i = 0; i < titleAttributes.length; ++i) {\n            attribute = titleAttributes[i];\n            if (attribute.metadata?.type === AttributeType.ImageUrl) {\n                continue;\n            }\n            title.push(attribute.valueHighlighted);\n            if (attribute.isHighlighted) {\n                isHighlighted = true;\n            }\n        }\n        return {\n            label: title.join(\" \"),\n            isHighlighted: isHighlighted,\n        };\n    }\n\n    private assembleLabel2(label1IsHighlighted: boolean, sinaSuggestion: UISinaObjectSuggestion): string {\n        const detailAttributes = sinaSuggestion.object.detailAttributes;\n        let attribute;\n\n        if (detailAttributes.length === 0) {\n            return \"\";\n        }\n\n        if (!label1IsHighlighted) {\n            attribute = this.getFirstHighlightedAttribute(detailAttributes);\n            if (attribute) {\n                return attribute.valueHighlighted;\n            }\n        }\n\n        attribute = this.getFirstStringAttribute(detailAttributes);\n        if (attribute) {\n            return attribute.label + \": \" + attribute.valueHighlighted;\n        }\n\n        return \"\";\n    }\n\n    private getFirstHighlightedAttribute(attributes) {\n        for (let i = 0; i < attributes.length; ++i) {\n            const attribute = attributes[i];\n            if (attribute.isHighlighted) {\n                return attribute;\n            }\n        }\n    }\n\n    private getFirstStringAttribute(attributes) {\n        const sortOrder = {\n            Date: 40,\n            Double: 70,\n            GeoJson: 130,\n            ImageBlob: 120,\n            ImageUrl: 110,\n            Integer: 60,\n            String: 10,\n            Time: 50,\n            Timestamp: 30,\n        };\n        if (attributes.length === 0) {\n            return null;\n        }\n        attributes = attributes.slice();\n        attributes.sort(function (a1, a2) {\n            return sortOrder[a1.metadata.type] - sortOrder[a2.metadata.type];\n        });\n        const attribute = attributes[0];\n        if (sortOrder[attribute.metadata.type] > 100) {\n            return null;\n        }\n        return attribute;\n    }\n\n    private assembleNavigation(sinaSuggestion: UISinaObjectSuggestion): null | NavigationTarget {\n        if (!sinaSuggestion.object.defaultNavigationTarget) {\n            return null;\n        }\n        const navigationTarget = sinaSuggestion.object.defaultNavigationTarget;\n        navigationTarget.target = \"_blank\"; // open in new window\n        return navigationTarget;\n    }\n\n    private assembleImageUrl(sinaSuggestion: UISinaObjectSuggestion): {\n        imageUrl?: string;\n        imageExists?: true;\n        imageIsCircular?: boolean;\n        exists?: false;\n    } {\n        const aAttributes = sinaSuggestion.object.detailAttributes.concat(\n            sinaSuggestion.object.titleAttributes\n        );\n        for (let i = 0; i < aAttributes.length; ++i) {\n            const attribute = aAttributes[i];\n            if (\n                attribute instanceof SearchResultSetItemAttribute &&\n                attribute.metadata.type === attribute.sina.AttributeType.ImageUrl\n            ) {\n                return {\n                    imageUrl: attribute.value,\n                    imageExists: true,\n                    imageIsCircular:\n                        attribute.metadata.format &&\n                        attribute.metadata.format === sinaSuggestion.sina.AttributeFormatType.Round,\n                };\n            }\n        }\n        return {\n            exists: false,\n        };\n    }\n\n    public format(\n        suggestionProvider: {\n            model: SearchModel;\n            addSuggestion: (\n                suggestion: Partial<\n                    UISinaObjectSuggestion & {\n                        label1: string;\n                        label2: string;\n                        titleNavigation: null | NavigationTarget;\n                    }\n                >\n            ) => void;\n        },\n        sinaSuggestion: UISinaObjectSuggestion\n    ): void {\n        // create suggestion\n        const suggestion: Partial<\n            UISinaObjectSuggestion & {\n                label1: string;\n                label2: string;\n                titleNavigation: null | NavigationTarget;\n            }\n        > = sinaSuggestion;\n\n        // assemble label\n        const label1 = this.assembleLabel1(sinaSuggestion);\n        suggestion.label1 = label1.label;\n\n        // assemble second label (second line in UI)\n        suggestion.label2 = this.assembleLabel2(label1.isHighlighted, sinaSuggestion);\n\n        // assemble navigation target\n        suggestion.titleNavigation = this.assembleNavigation(sinaSuggestion);\n\n        // assemble image url\n        const imageUrl = this.assembleImageUrl(sinaSuggestion);\n        sinaSuggestion.sina.core.extend(suggestion, imageUrl);\n\n        // position\n        suggestion.position = sinaSuggestion.position;\n\n        // add\n        suggestionProvider.addSuggestion(suggestion);\n    }\n}\n"],"mappings":"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","ignoreList":[]}