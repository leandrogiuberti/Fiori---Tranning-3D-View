/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../sinaNexTS/sina/DataSourceType","./SuggestionType","./SinaObjectSuggestionFormatter","../flp/BackendSystem","../flp/FrontendSystem","sap/ui/Device","sap/ushell/Container"],function(t,e,s,i,o,n,a){"use strict";function r(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const g=t["DataSourceType"];const u=r(e);const c=e["Type"];const l=r(s);const h=r(i);const S=r(o);class p{model;suggestionHandler;suggestionLimit;sinaNext;suggestionQuery;transactionsDS;suggestionStartingCharacters;suggestionFormatter=new l;transactionSuggestions=[];constructor(t){this.model=t.model;this.suggestionHandler=t.suggestionHandler;this.suggestionLimit=n.system.phone?5:7;this.sinaNext=this.model.sinaNext;this.suggestionQuery=this.sinaNext.createSuggestionQuery();this.transactionsDS=this.sinaNext.createDataSource({id:"CD$ALL~ESH_TRANSACTION~",label:"Transactions",type:g.BusinessObject});this.suggestionStartingCharacters=this.model.config.suggestionStartingCharacters}abortSuggestions(){this.suggestionQuery.abort()}getUrl(t){let e="#Shell-startGUI?sap-ui2-tcode="+t;const s=h.getSystem(this.model);if(s&&!s.equals(S.getSystem())){e=`#Shell-startGUI?sap-system=sid(${s.id})&sap-ui2-tcode=${t}`}return e}async getSuggestions(t){if(!this.model.config.searchBusinessObjects){return Promise.resolve([])}const e=this.model.getDataSource();const s=this.model.userCategoryManager;const i=s?.isFavActive()&&s?.getCategory("MyFavorites")?.includeApps;if(e!==this.model.allDataSource&&e!==this.model.appDataSource&&!(e===this.model.favDataSource&&i)){return Promise.resolve([])}t=t.clone();let o=t.searchTerm;if(o.toLowerCase().indexOf("/n")===0||o.toLowerCase().indexOf("/o")===0){o=o.slice(2);t.searchTerm=o}this.transactionSuggestions=[];if(o.length<this.suggestionStartingCharacters){return Promise.resolve([])}this.prepareSuggestionQuery(t);const n=await this.suggestionQuery.getResultSetAsync();const r=n.items;for(const e of r){const s={uiSuggestionType:c.Transaction,dataSource:this.transactionsDS,position:u.properties.Transaction.position,key:e.object.attributesMap.TCODE.value,searchTerm:t.searchTerm,url:this.getUrl(e.object.attributesMap.TCODE.value),icon:"sap-icon://generate-shortcut",label:e.object.attributesMap.TCDTEXT.valueHighlighted,type:e.type,calculationMode:e.calculationMode,object:e.object,sina:e.sina};const i=await a.getServiceAsync("CrossApplicationNavigation");const o=await i.isNavigationSupported([{target:{shellHash:s.url}}]);if(o[0].supported){this.suggestionFormatter.format(this,s)}}const g=this.suggestionHandler.getSuggestionLimit(c.Transaction);this.transactionSuggestions=this.transactionSuggestions.slice(0,g);return this.transactionSuggestions}addSuggestion(t){this.transactionSuggestions.push(t)}prepareSuggestionQuery(t){this.suggestionQuery.resetResultSet();this.suggestionQuery.setFilter(t);this.suggestionQuery.setDataSource(this.transactionsDS);this.suggestionQuery.setTypes([this.sinaNext.SuggestionType.Object]);this.suggestionQuery.setCalculationModes([this.sinaNext.SuggestionCalculationMode.Data]);this.suggestionQuery.setTop(10)}}return p});
//# sourceMappingURL=TransactionSuggestionProvider.js.map