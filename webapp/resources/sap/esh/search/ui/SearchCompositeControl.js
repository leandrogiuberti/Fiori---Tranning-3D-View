/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["./error/ErrorHandler","./i18n","sap/ui/model/resource/ResourceModel","./controls/searchfieldgroup/SearchFieldGroup","sap/esh/search/ui/SearchModel","sap/esh/search/ui/controls/SearchLayoutResponsive","./controls/resultview/SearchResultContainer","./controls/resultview/SearchCountBreadcrumbs","sap/esh/search/ui/controls/SearchFilterBar","sap/esh/search/ui/controls/SearchNlqExplainBar","sap/esh/search/ui/SearchHelper","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/layout/VerticalLayout","sap/ui/model/BindingMode","sap/m/Button","sap/m/library","sap/m/Bar","sap/m/OverflowToolbarLayoutData","sap/m/OverflowToolbar","sap/m/ViewSettingsItem","sap/m/MessagePopover","sap/m/MessageItem","sap/m/VBox","./error/errors","sap/base/Log","sap/m/IllustratedMessage","sap/m/IllustratedMessageType","sap/m/IllustratedMessageSize","sap/esh/search/ui/error/errors","sap/ui/core/ResizeHandler","sap/ui/core/routing/HashChanger","./controls/OpenShowMoreDialog","./UIEvents","./SearchCompositeControlDragDropConfig","sap/base/assert","./controls/facets/SearchFacetList","sap/ui/core/Element","./compositecontrol/ToolbarAssembler","./compositecontrol/ResultViewsAssembler","./controls/SearchSelectionBar","./controls/resultview/SearchResultPanel","sap/m/ActionSheet","sap/m/Dialog","./sinaNexTS/core/core","./controls/webcompsearchfieldgroup/WebCompSearchFieldGroupBindings","sap/esh/search/ui/gen/ui5/webcomponents_fiori/dist/Search","sap/m/ToolbarSpacer","./SelectionMode"],function(e,t,r,s,o,n,i,a,l,c,u,h,d,p,f,g,S,y,m,C,b,M,w,D,I,R,T,B,V,F,v,E,P,x,H,N,A,L,U,_,G,O,z,W,$,k,j,q,Q){"use strict";function J(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const K=J(e);const X=J(t);const Y=J(s);const Z=J(i);const ee=J(a);const te=S["ButtonType"];const re=S["ToolbarDesign"];const se=S["PlacementType"];const oe=S["OverflowToolbarPriority"];const ne=S["FlexJustifyContent"];const ie=I["ProgramError"];const ae=P["openShowMoreDialog"];const le=J(x);const ce=S["BarDesign"];const ue=J(H);const he=J(A);const de=J(U);const pe=J(_);const fe=J(G);const ge=J(O);const Se=k["createWebCompSearchFieldGroupBindings"];const ye=J(j);const me=Q["SelectionMode"];const Ce=p.extend("sap.esh.search.ui.SearchCompositeControl",{renderer:{apiVersion:2},metadata:{library:"sap.esh.search.ui",dnd:{draggable:true,droppable:false},properties:{cssClass:{type:"string"},searchTerm:{type:"string",group:"Misc",defaultValue:""},searchOnStart:{type:"boolean",group:"Behavior",defaultValue:true},filterRootCondition:{type:"object",group:"Misc"},sinaConfiguration:{type:"object",group:"Misc"},dataSource:{type:"string",group:"Misc"},exclusiveDataSource:{type:"string",group:"Misc"},resultViewTypes:{type:"string[]",group:"Misc",defaultValue:["searchResultList","searchResultTable"]},resultViewType:{type:"string",group:"Misc",defaultValue:"searchResultList"},resultViewSettings:{settings:{resultViewTypes:"string[]",resultViewType:"string"},group:"Misc",defaultValue:{resultViewTypes:["searchResultList","searchResultTable"],resultViewType:"searchResultList"}},resultviewMasterDetailMode:{type:"boolean",group:"Misc",defaultValue:false},tabStripsFormatter:{type:"function",group:"Misc"},folderMode:{type:"boolean",group:"Misc",defaultValue:false},folderModeForInitialSearch:{type:"boolean",group:"Misc",defaultValue:false},autoAdjustResultViewTypeInFolderMode:{type:"boolean",group:"Misc",defaultValue:false},enableQueryLanguage:{type:"boolean",group:"Misc",defaultValue:false},applicationComponent:{type:"string",group:"Misc",defaultValue:"HAN-AS-INA-UI"},facetPanelResizable:{type:"boolean",group:"Misc",defaultValue:true},facetPanelWidthInPercent:{type:"float",group:"Misc",defaultValue:25},getCustomNoResultScreen:{type:"function",group:"Misc"},getSearchInputPlaceholderLabel:{type:"function",group:"Misc"},searchInputLocation:{type:"string",group:"Misc",defaultValue:"Top"},overwriteBrowserTitle:{type:"boolean",group:"Misc"},defaultDataSource:{type:"string",group:"Misc"},optimizeForValueHelp:{type:"boolean",group:"Misc"},filterDataSources:{type:"function",group:"Misc"},facets:{type:"boolean",group:"Misc",defaultValue:true},facetVisibility:{type:"boolean",group:"Misc",defaultValue:false},facetToggleButtonLocation:{type:"string",group:"Misc",defaultValue:"Begin"},enableCharts:{type:"boolean",group:"Misc",defaultValue:false},boSuggestions:{type:"boolean",group:"Misc",defaultValue:false},displayFacetPanelInCaseOfNoResults:{type:"boolean",group:"Misc",defaultValue:false},updateUrl:{type:"boolean",group:"Misc",defaultValue:true},renderSearchUrl:{type:"function",group:"Misc"},isSearchUrl:{type:"function",group:"Misc"},parseSearchUrlParameters:{type:"function",group:"Misc"},quickSelectDataSources:{type:"object",group:"Misc"},selectionChange:{type:"function",group:"Misc"},initAsync:{type:"function",group:"Misc"},enableMultiSelectionResultItems:{type:"boolean",group:"Misc",defaultValue:false},resultviewSelectionMode:{type:"string",group:"Misc",defaultValue:"None",values:[{name:"None",key:"None"},{name:"OneItem",key:"OneItem"},{name:"MultipleItems",key:"MultipleItems"}]},showSelectionToggleButton:{type:"boolean",group:"Misc",defaultValue:false},pageSize:{type:"int",group:"Misc",defaultValue:10},formatFilterBarText:{type:"function",group:"Misc"},isFilterBarVisible:{type:"function",group:"Misc"},eventConsumers:{singularName:"eventConsumer",multiple:true,group:"Misc"},searchTermLengthLimit:{type:"int",group:"Misc",defaultValue:1e3},limitAjaxRequests:{type:"boolean",group:"Misc",defaultValue:true}},aggregations:{content:{singularName:"content",multiple:true}},events:{searchStarted:{},searchFinished:{},selectionChanged:{},resultViewTypeChanged:{},showResultDetail:{}}},constructor:function e(t,s){this.isHashChangedAttached=false;const n=K.getInstance({label:t});let i;let a=false;try{const e=Ce.unifyInputParameters(t,s);t=e.sId;s=e.settings;N(s?.applicationComponent!==undefined&&s?.applicationComponent!=="",`Provide property 'applicationComponent' (example: "LOD-ANA-LS").\nRelevant for SAP partners and SAP, the "Application Component" you expect customers to create incidents.`);N(s.exclusiveDataSource===undefined||s.exclusiveDataSource===""||(s.dataSource===undefined||s.dataSource==="")&&(s.defaultDataSource===undefined||s.defaultDataSource===""),`Property 'exclusiveDataSource' is provided ('${s.exclusiveDataSource}').\nDo NOT provide properties 'dataSource' or 'defaultDataSource'.`);i=s["model"]||s["searchModel"];if(!i){i=new o({configuration:s})}else{i.config.id=t}n.setSearchModel(i);const l=Ce.getUI5ControlSettings(i.config);p.prototype.constructor.call(this,t,l);this.errorHandler=n;this._oLogger=R.getLogger("sap.esh.search.ui.SearchCompositeControl");this.addStyleClass("sapUshellSearchInputHelpPage");this.addStyleClass("sapElisaSearchCompositeControl");if(i.config.optimizeForValueHelp){this.addStyleClass("sapUshellSearchInputHelpPageValueHelp")}this.setModelInternal(i);this.setModelInternal(i.publicSearchModel,i.publicSearchModel.modelName);this.setModelInternal(new r({bundle:X}),"i18n");const c=this;this.oFocusHandler=new u.SearchFocusHandler(c);i.focusHandler=this.oFocusHandler;this.toolbarAssembler=new de(c);this.resultViewsAssembler=new pe(c);i.config.performanceLogger?.enterMethod({name:"createContent"},{isSearch:true});a=true;this.createContent();i.config.performanceLogger?.leaveMethod({name:"createContent"});a=false;this.oSearchCompositeControlDragDropConfig=new ue({eshComp:this});v.register(this,()=>{this._resizeHandler()});this._onHashChangedHandler=()=>{this.closePopovers()};if(!this.isHashChangedAttached){E.getInstance().attachEvent("hashChanged",this._onHashChangedHandler,this);this.isHashChangedAttached=true}this.initSearchPromise=this.initSearch()}catch(e){n.onError(e);throw e}finally{if(a){i.config.performanceLogger?.leaveMethod({name:"createContent"});a=false}}},getPublicSina:function e(){return this.getModelInternal().sinaNext.getPublicSina()},getModel:function e(t){const r=(new Error).stack;if(t!==undefined||r.includes("._setModelInternal")||r.includes("setModelInternal")||r.includes("onAllSearchFinished")||r.includes(".updateBindingContext")||r.includes(".updatePropertyValue")||r.includes("addContent")){}else{N(false,`The main model of this control is private.\nTo access the public search model, call function 'getPublicSearchModel' or bind to it (model name 'publicSearchModel').\nThe main model of this control is private and cannot be accessed (for internal use, see function 'getSearchModelInternal').`)}return this.getModelInternal(t)},setModel:function e(t,r){const s=this.getModelInternal();if(!r){N(false,`Main model cannot be set (for internal use, see function 'setModelInternal').`);return this}else if(r===s?.publicSearchModel?.modelName){N(false,`Model cannot be set, name '${s?.publicSearchModel?.modelName}' is reserved for public search model (for internal use, see function 'setModelInternal').`);return this}else{return p.prototype.setModel.call(this,t,r)}},setModelInternal:function e(t,r){return p.prototype.setModel.call(this,t,r)},browserHasValidSearchUrl:function e(){const t=this.getModelInternal();if(!t.config.isSearchUrl(u.getHashFromUrl())){return false}const r=u.getUrlParameters();if($.isEmptyObject(r)){return false}return true},initSearch:async function e(){const t=this.getModelInternal();t.config.performanceLogger?.enterMethod({name:"init search"},{isSearch:true});await t.initAsync();if(t.config.updateUrl&&this.browserHasValidSearchUrl()){await t.searchUrlParser.parse()}else if(this.getProperty("searchOnStart")&&!t.config.isUshell){await this.search()}if(t){t.config.performanceLogger?.leaveMethod({name:"init search"})}},exit:function e(){if(this.isHashChangedAttached){E.getInstance().detachEvent("hashChanged",this._onHashChangedHandler,this);this.isHashChangedAttached=false}if(this.oFilterBar){this.oFilterBar.destroy()}if(this.noResultScreen){this.noResultScreen.destroy()}if(this.noResultScreenFolder){this.noResultScreenFolder.destroy()}this.searchResultTable?.tablePersonalizer?.destroyControllerAndDialog();if(this["oFacetDialog"]){this["oFacetDialog"].destroy();this["oFacetDialog"]=null}const t=this.getModelInternal();t.unsubscribe(le.ESHSearchStarted,this.onAllSearchStarted,this);t.unsubscribe(le.ESHSearchFinished,this.onAllSearchFinished,this);t.unsubscribe(le.ESHSelectionChanged,this.onSelectionChanged,this);t.unsubscribe(le.ESHShowResultDetail,this.onShowResultDetail,this)},createContent:function e(){const t=this.getModelInternal();if(!t.config.isUshell){this.oSearchFieldGroup=this.createSearchFieldGroup()}if(t?.subscribe){if(!this.subscribeDone_SearchStarted){t.subscribe(le.ESHSearchStarted,this.onAllSearchStarted,this);this.subscribeDone_SearchStarted=true}if(!this.subscribeDone_SearchFinished){t.subscribe(le.ESHSearchFinished,this.onAllSearchFinished,this);this.subscribeDone_SearchFinished=true}if(!this.subscribeDone_SelectionChanged){t.subscribe(le.ESHSelectionChanged,this.onSelectionChanged,this);this.subscribeDone_SelectionChanged=true}if(!this.subscribeDone_ResultViewTypeChanged){t.subscribe(le.ESHResultViewTypeChanged,this.onResultViewTypeChanged,this);this.subscribeDone_SelectionChanged=true}if(!this.subscribeDone_ShowResultDetail){t.subscribe(le.ESHShowResultDetail,this.onShowResultDetail,this);this.subscribeDone_ShowResultDetail=true}}this.oFilterButton=this.toolbarAssembler.assembleFilterButton();this.oDataSourceTabBar=this.toolbarAssembler.assembleDataSourceTabBar();const r=this.toolbarAssembler.assembleGenericButtonsToolbar();let s;if(t?.config?.showSelectionToggleButton===true&&t?.config?.resultviewSelectionMode!==me.None){this.oSelectionButton=this.toolbarAssembler.assembleResultviewSelectionButton()}if(t?.config?.facetToggleButtonLocation==="End"){s=[new q,this.oDataSourceTabBar];this.oGenericItemsToolbar=r.toolbar;this.oGenericItemsToolbar.addContent(this.oFilterButton)}else{s=[this.oFilterButton,this.oDataSourceTabBar];this.oGenericItemsToolbar=r.toolbar}this.oGenericItemsToolbar.addContent(this.oSelectionButton);const o=s.concat(this.oGenericItemsToolbar);this.oSearchBar=new C(this.getId()+"-searchBar",{width:"100%",visible:{parts:[{path:"/count"}],formatter:e=>e!==0||t?.config?.showSearchBarForNoResults},content:o,design:re.Transparent});this.oSearchBar.addStyleClass("sapUshellSearchBar");if(r.hasCustomButtons){this.oDataSourceTabBar.addStyleClass("sapUshellSearchBarHasCustomButtons")}else{this.oDataSourceTabBar.removeStyleClass("sapUshellSearchBarHasCustomButtons")}if(t.config.optimizeForValueHelp){this.oSearchBar.addStyleClass("sapUshellSearchBarValueHelp")}this.oNlqExplainBar=new c(this.getId()+"-nlqExplainBar",{visible:{parts:[{path:"/nlqResult/success"},{path:"/isBusy"}],formatter:(e,t)=>{const r=this.getModelInternal().config;return!!e&&!t&&r.aiNlqExplainBar}}});this.oFilterBar=new l(this.getId()+"-searchFilterBar");this.createSearchPage(this.getId())},createSearchFieldGroup:function e(){const t=this.getModelInternal();if(t.config.isWebCompSearchFieldGroupEnabled()){return this.createWebCompSearchFieldGroup()}else{return this.createClassicSearchFieldGroup()}},createWebCompSearchFieldGroup:function e(){const t=new ye("searchFieldInShell");Se(t);return t},createClassicSearchFieldGroup:function e(){const t=this.getModelInternal();const r=new Y(this.getId()+"-searchInputHelpPageSearchFieldGroup");if(t.config.exclusiveDataSource){r.setSelectActive(false)}r.setCancelButtonActive(false);r.addStyleClass("sapUshellSearchInputHelpPageSearchFieldGroup");r.input.setShowValueHelp(false);t.setProperty("/inputHelp",r.input);if(t.config.optimizeForValueHelp){r.setActionsMenuButtonActive(true);r.setSelectQsDsActive(true);r.addStyleClass("sapUiTinyMarginBegin");r.addStyleClass("sapUiTinyMarginEnd")}return r},onAfterRendering:function e(){const t=this?.getModelInternal();if(t?.subscribe){if(!this.subscribeDone_SearchStarted){t.subscribe(le.ESHSearchStarted,this.onAllSearchStarted,this);this.subscribeDone_SearchStarted=true}if(!this.subscribeDone_SearchFinished){t.subscribe(le.ESHSearchFinished,this.onAllSearchFinished,this);this.subscribeDone_SearchFinished=true}if(!this.subscribeDone_SelectionChanged){t.subscribe(le.ESHSelectionChanged,this.onSelectionChanged,this);this.subscribeDone_SelectionChanged=true}if(!this.subscribeDone_ResultViewTypeChanged){t.subscribe(le.ESHResultViewTypeChanged,this.onResultViewTypeChanged,this);this.subscribeDone_ResultViewTypeChanged=true}if(!this.subscribeDone_ShowResultDetail){t.subscribe(le.ESHShowResultDetail,this.onShowResultDetail,this);this.subscribeDone_ShowResultDetail=true}}},isShowMoreFooterVisible:function e(){const t=this.getModelInternal();return t.getProperty("/boCount")>t.getProperty("/boResults").length},assignDragDropConfig:function e(){this.oSearchCompositeControlDragDropConfig.assignDragDropConfig()},addDragDropConfig:function e(t){return this.oSearchCompositeControlDragDropConfig.addDragDropConfig(t)},insertDragDropConfig:function e(t,r){return this.oSearchCompositeControlDragDropConfig.insertDragDropConfig(t,r)},indexOfDragDropConfig:function e(t){return this.oSearchCompositeControlDragDropConfig.indexOfDragDropConfig(t)},getDragDropConfig:function e(){return this.oSearchCompositeControlDragDropConfig.getDragDropConfig()},removeDragDropConfig:function e(t){return this.oSearchCompositeControlDragDropConfig.removeDragDropConfig(t)},removeAllDragDropConfig:function e(){return this.oSearchCompositeControlDragDropConfig.removeAllDragDropConfig()},destroyDragDropConfig:function e(){return this.oSearchCompositeControlDragDropConfig.destroyDragDropConfig()},onAllSearchStarted:function e(){this.fireEvent("searchStarted")},onAllSearchFinished:function e(){const t=this.getModelInternal();this.assignDragDropConfig();this.chooseNoResultScreen();this.oFocusHandler.setFocus();if(t.config.isUshell){const e=L.getElementById("viewPortContainer");if(e?.switchState){e.switchState("Center")}}this.fireEvent("searchFinished");setTimeout(()=>{this.adjustSearchbarCustomGenericButtonWidth()},0)},onSelectionChanged:function e(){this.fireEvent("selectionChanged")},onResultViewTypeChanged:function e(){this.fireEvent("resultViewTypeChanged")},onShowResultDetail:function e(){this.fireEvent("showResultDetail")},createSearchPage:function e(t){const r=this.getModelInternal();this.oFilterBar.bindProperty("visible",{parts:[{path:"/count"},{path:"/facetVisibility"},{path:"/uiFilter/rootCondition"}],formatter:(e,t,s)=>{let o=false;if(!t&&s&&s.hasFilters()){o=true}if(s&&r.hasStaticHierarchyFacetFilterConditionOnly()){o=false}if(s&&typeof r.config.isFilterBarVisible==="function"){try{if(!r.config.isFilterBarVisible(s)){o=false}}catch(e){const t=new F.ConfigurationExitError("isFilterBarVisible",r.config.applicationComponent,e);this.errorHandler.onError(t)}}return o}});this.oFooter=this.createFooter(this.getId());if(this.oFooter){this.oFooter.bindProperty("visible",{parts:[{path:"/errors/length"}],formatter:e=>{const t=e>0?true:false;return t}})}this.searchContainer=this.createSearchContainer(t);let s=[];if(this.oSearchFieldGroup&&r?.config?.searchInputLocation==="Top"){s.push(this.oSearchFieldGroup)}s=s.concat([this.oSearchBar,this.oNlqExplainBar,this.oFilterBar,this.searchContainer,this.oFooter]);for(const e of s){this.addContent(e)}this.setWidth("100%")},createNoResultScreen:function e(t,r){const s=[];const o=V.Auto;let n;let i;let a;if(r==="folder"){n={parts:[{path:"/queryFilter/searchTerm"}],formatter:e=>X.getText("no_results_info_1_folderEmpty",[e])};i=X.getText("no_results_info_2_folderEmpty");a=B.EmptyList}else{n={parts:[{path:"/queryFilter/searchTerm"}],formatter:e=>X.getText("no_results_info_1",[e])};i=X.getText("no_results_info_2");a=B.NoSearchResults}const l={title:n,description:i,illustrationSize:o,illustrationType:a,additionalContent:s};let c;if(r==="folder"){c=`${t}-searchContainerResultsView-noResultFolderScreen`}else{c=`${t}-searchContainerResultsView-noResultScreen`}const u=new T(`${c}-searchContainerResultsView-noResultScreen-illustratedMessage`,l).addStyleClass("sapElisaNoResultScreen");u.addStyleClass("sapUiMediumMarginTop");const h=new D(`${c}-searchContainerResultsView-noResultScreen`,{items:u,width:"100%",justifyContent:ne.Center,visible:{parts:[{path:"/count"},{path:"/isBusy"},{path:"/firstSearchWasExecuted"}],formatter:function(e,t,r){return e===0&&!t&&r}}});if(r==="folder"){this.noResultScreenFolder=h}else{this.noResultScreen=h}return h},createSearchContainer:function e(t){const r=this.getModelInternal();this.countBreadcrumbsHiddenElement=this.resultViewsAssembler.assembleCountBreadcrumbsHiddenElement();this.resultView=this.resultViewsAssembler.assembleResultView(t);this.oSearchCountBreadcrumbs=new ee(this.getId()+"-SearchCountBreadcrumbs").addStyleClass("sapElisaSearchContextBarContent");this.oContextBar=new y(this.getId()+"-searchContextBar",{contentLeft:this.oSearchCountBreadcrumbs,design:{parts:[{path:"/isFolderMode"}],formatter:e=>{if(r.config.folderMode===true&&e===true){this.oContextBar.addStyleClass("sapElisaSearchContextBarFolderMode")}else{this.oContextBar.removeStyleClass("sapElisaSearchContextBarFolderMode")}return ce.Auto}}}).addStyleClass("sapElisaSearchContextBar");this.oSearchSelectionBar=new fe(this.getId()+"-searchSelectionBar");this.oContextBarContainer=new p("",{content:[this.oSearchSelectionBar,this.oContextBar]});this.oContextBarContainer.enhanceAccessibilityState=function(e,t){t["role"]="heading";t["level"]=2};this.oContextBarContainer.addStyleClass("sapElisaSearchContextBarContainer");this.oContextBarContainer.addStyleClass("sapUiNoMarginBegin");this.oContextBarContainer.addStyleClass("sapUiNoMarginEnd");this.oSearchResultContainer=new Z(`${t}-searchContainerResultsView`);this.oSearchResultContainer.setNoResultScreen(this.createNoResultScreen(t,"default"));this.resultView.push(this.oSearchResultContainer.getNoResultScreen());this.resultView.forEach(e=>{this.oSearchResultContainer.addContent(e)});this.oSearchResultPanel=new ge(`${t}-searchResultPanel`,{fixContent:[this.oContextBarContainer],flexContent:this.oSearchResultContainer});const s={resultPanelContent:this.oSearchResultPanel,searchIsBusy:{path:"/isBusy"},busyDelay:{path:"/busyDelay"},facetPanelResizable:r.config.facetPanelResizable,facetPanelWidthInPercent:r.config.facetPanelWidthInPercent,facetPanelContent:new he(`${this.getId()}-SearchFacetList`),showFacets:{parts:[{path:"/facetVisibility"}],formatter:e=>{if(!e){return false}return true}}};const o=new n(`${this.getId()}-searchLayout`,s).addStyleClass("sapUshellSearchLayout");return o},isSearchFieldGroupLocatedInsideSearchComposite:function e(t){if(typeof t==="undefined"||t===null){return false}else if(t.classList){if(t.classList.contains("sapUshellSearchInputHelpPage")){return true}else if(typeof t.parentNode!=="undefined"){return this.isSearchFieldGroupLocatedInsideSearchComposite(t.parentNode)}else{console.error("function: isSearchFieldGroupLocatedInsideSearchComposite: Element has no property 'parentNode' but has property 'classlist'");return false}}else if(t.nodeType===Node.DOCUMENT_NODE){return false}else{console.error("function: isSearchFieldGroupLocatedInsideSearchComposite: Element has no property 'classlist'");return false}},adjustSearchbarCustomGenericButtonWidth:function e(){if(this.getDomRef()===null){return}if(this.oFilterButton.getVisible()&&this.oFilterButton.getDomRef()===null){return}const t=window.document.getElementById(this.getDomRef().id).getBoundingClientRect();const r=this.oFilterButton.getVisible()?window.document.getElementById(this.oFilterButton.getDomRef().id).getBoundingClientRect().width:0;let s=0;if(this.oDataSourceTabBar.getVisible()){const e=this.oDataSourceTabBar.getItems().reduce((e,t)=>e+t["getText"]().length,0);if(e<20){this.oDataSourceTabBar.addStyleClass("searchDataSourceTabStripBarTinyItemsTextLength");this.oDataSourceTabBar.removeStyleClass("searchDataSourceTabStripBarMediumItemsTextLength")}else if(e<45){this.oDataSourceTabBar.addStyleClass("searchDataSourceTabStripBarMediumItemsTextLength");this.oDataSourceTabBar.removeStyleClass("searchDataSourceTabStripBarTinyItemsTextLength")}else{this.oDataSourceTabBar.removeStyleClass("searchDataSourceTabStripBarTinyItemsTextLength");this.oDataSourceTabBar.removeStyleClass("searchDataSourceTabStripBarMediumItemsTextLength")}const t=this.oDataSourceTabBar.getDomRef();if(t?.id){s=window.document.getElementById(t.id).getBoundingClientRect().width}else{}}const o=t.width-r-s;const n=this.convertPixelToRem(o);if(s===0){if(n<30){this.oGenericItemsToolbar.setWidth(`${n-1.1}rem`)}else{this.oGenericItemsToolbar.setWidth(`${n-3}rem`)}}else{this.oGenericItemsToolbar.setWidth(`${n-2.75}rem`)}},_resizeHandler:function e(){setTimeout(()=>this.adjustSearchbarCustomGenericButtonWidth(),0)},convertPixelToRem:function e(t){return t/parseFloat(getComputedStyle(document.documentElement).fontSize)},createFooter:function e(t){const r=this.getModelInternal();this.oErrorPopover=new M(t+"-"+be+++"-"+"-searchMessagePopover",{placement:se.Top});this.oErrorPopover.setModel(r);r.setProperty("/messagePopoverControlId",this.oErrorPopover.getId());this.oErrorPopover.bindAggregation("items",{path:"/errors",factory:()=>{const e=new w("",{type:"{type}",title:"{title}",description:"{description}"});return e}});const s=new g(this.getId()+"-searchErrorButton",{icon:d.getIconURI("alert"),text:{parts:[{path:"/errors/length"}],formatter:function(e){return e}},visible:{parts:[{path:"/errors/length"}],formatter:e=>e>0,mode:f.OneWay},type:te.Emphasized,tooltip:X.getText("errorBtn"),press:()=>{if(this.oErrorPopover.isOpen()){this.oErrorPopover.close()}else{this.oErrorPopover.setVisible(true);this.oErrorPopover.openBy(s)}}});s.addStyleClass("sapUiSmallMarginBegin");s["addDelegate"]({onAfterRendering:()=>{const e=this.getModelInternal();if(!e.getProperty("/isErrorPopovered")){s.firePress();e.setProperty("/isErrorPopovered",true)}}});s.setLayoutData(new m("",{priority:oe.NeverOverflow}));const o=new C(this.getId()+"-searchFooter",{content:[s]});o.addStyleClass("sapUiTinyMarginTop");return o},chooseNoResultScreen:function e(){const t=this.getModelInternal();let r;if(typeof t?.config?.getCustomNoResultScreen==="function"){try{const e=t.config.getCustomNoResultScreen(t.getDataSource(),t);if(e&&e.isDestroyed()){const e=new F.ConfigurationExitError("getCustomNoResultScreen",t.config.applicationComponent,new Error(`The 'no results screen' instance provided by exit 'getCustomNoResultScreen' is already destroyed.\nWe have switched to standard 'no results screen'.\nFor stability reasons, we are destroying old instances with each roundtrip unless custom 'no results screen' instance stays the same.\nThis is needed to keep a cleaned-up dom with no ghost instances (i.e. still described to events).`));this.errorHandler.onError(e);r=this.oSearchResultContainer.getNoResultScreen()}const s=this.oSearchResultContainer.getNoResultScreen();if(s!==this.noResultScreenFolder&&s!==this.noResultScreen&&s!==e){if(s instanceof h){s.destroy()}}r=e}catch(e){const s=new F.ConfigurationExitError("getCustomNoResultScreen",t.config.applicationComponent,e);this.errorHandler.onError(s);r=this.oSearchResultContainer.getNoResultScreen()}}if(!r){if(t.getProperty("/isFolderMode")){if(!this.noResultScreenFolder){this.noResultScreenFolder=this.createNoResultScreen(this.getId(),"folder")}r=this.noResultScreenFolder}else{r=this.noResultScreen}}this.oSearchResultContainer.setNoResultScreen(r)},openSortDialog:function e(){this.sortDialog.unbindAggregation("sortItems",false);this.sortDialog.bindAggregation("sortItems",{path:"/sortableAttributes",factory:()=>new b("",{key:{path:"key"},text:{path:"name"},selected:{path:"selected"}})});this.sortDialog.open()},openShowMoreDialog:function e(t){ae({searchModel:this.getModelInternal(),dimension:t,selectedTabBarIndex:0,tabBarItems:undefined,sourceControl:this})},parseURL:function e(){this.getModelInternal().parseURL();return this},getPublicSearchModel:function e(){return this.getModelInternal("publicSearchModel")},getResultviewMasterDetailMode:function e(){const t=this.getModelInternal();if(typeof t==="undefined"||typeof t.config==="undefined"){return undefined}return t.getProperty("/config/resultviewMasterDetailMode")},setResultviewMasterDetailMode:function e(t){const r=this.getModelInternal();if(typeof r==="undefined"||typeof r.config==="undefined"){return this}r.setProperty("/config/resultviewMasterDetailMode",t);return this},getResultviewSelectionMode:function e(){const t=this.getModelInternal();if(typeof t==="undefined"||typeof t.config==="undefined"){return undefined}return t.getProperty("/config/resultviewSelectionMode")},setResultviewSelectionMode:function e(t){const r=this.getModelInternal();if(typeof r==="undefined"||typeof r.config==="undefined"){return this}r.setProperty("/config/resultviewSelectionMode",t);return this},getModelInternal:function e(t){return p.prototype.getModel.call(this,t)},getSearchResultSet:function e(){let t;const r=this.getModelInternal();if(typeof r["resultSet"]==="undefined"||r["resultSet"]===null){t={items:[]}}else{t=this.getModelInternal("publicSearchModel").getProperty("/results")}return t},getResultViewTypes:function e(){const t=this.getModelInternal();return t?.getResultViewTypes()},setResultViewTypes:function e(t){const r=this.getModelInternal();if(typeof t==="undefined"){throw Error("Search Result View Type Error In SearchCompositeControl:\n\n"+"The function parameter 'resultViewTypes' is mandatory.\n"+'Valid example: setResultViewTypes(["searchResultList"])')}else if(typeof r==="undefined"||typeof r.config==="undefined"){return this}this.setResultViewSettings({resultViewTypes:t,resultViewType:r.getResultViewType()});return this},getResultViewType:function e(){const t=this.getModelInternal();return t?.getResultViewType()},setResultViewType:function e(t){const r=this.getModelInternal();if(typeof t==="undefined"){throw Error("Search Result View Type Error In SearchCompositeControl:\n\n"+"The function parameter 'resultlViewType' is mandatory.\n"+'Valid example: setResultViewType("searchResultList")')}else if(typeof r==="undefined"||typeof r.config==="undefined"){return this}this.setResultViewSettings({resultViewTypes:r.getResultViewTypes(),resultViewType:t});return this},getResultViewSettings:function e(){const t=this.getModelInternal();if(t){return{resultViewTypes:t.getResultViewTypes(),resultViewType:t.getResultViewType()}}},setResultViewSettings:function e(t){const r=this.getModelInternal();if(typeof t==="undefined"){throw Error("Search Result View Type Error In SearchCompositeControl:\n\n"+"The function parameter 'resultlViewSettings' is mandatory.\n"+'Valid example: setResultViewSettings({resultViewTypes: ["searchResultList", "searchResultTable"], resultViewType: "searchResultList"})')}else if(typeof r==="undefined"||typeof r.config==="undefined"){return this}if(typeof t.resultViewTypes==="undefined"||typeof t.resultViewType==="undefined"){throw Error("Search Result View Type Error In SearchCompositeControl:\n\n"+"One of properties of function parameter is undefined.\n"+'Valid example: setResultViewSettings({resultViewTypes: ["searchResultList", "searchResultTable"], resultViewType: "searchResultList"})')}r.calculateResultViewSwitchVisibility({resultViewTypes:t.resultViewTypes,resultViewType:t.resultViewType});this.showMoreFooter.setVisible(this.isShowMoreFooterVisible());r.enableOrDisableMultiSelection();this.search();this.assignDragDropConfig();return this},getControllerName:function e(){return"sap.esh.search.ui.container.Search"},getCssClass:function e(){return this._cssClass},setCssClass:function e(t){if(t&&!this.hasStyleClass(t)){this._cssClass=t;this.addStyleClass(t)}return this},getDataSource:function e(){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();const t=e.getDataSource();return t.id}},setDataSource:function e(t,r,s){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();e.setDataSourceById(t,r,s)}return this},resetDataSource:async function e(t=true){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();return e.resetDataSource(t)}return this},search:async function e(t=false,r=true){const s=this.getModelInternal();if(t){s.invalidateQuery()}if(r){return s.fireSearchQuery()}},resetSearch:async function e(){const t=this.getModelInternal();t.resetQuery();this.retriggerSearch()},retriggerSearch:async function e(){this.search(true,true)},invalidateSearchResultCache:async function e(){this.search(true,false)},getSearchTerm:function e(){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();return e.getSearchBoxTerm()}return Ce.getMetadata().getPropertyDefaults()["searchTerm"]},setSearchTerm:function e(t,r){if(typeof this.getModelInternal()!=="undefined"){const e=this.getModelInternal();e.setSearchBoxTerm(t,r)}return this},getConfig:function e(){if(this.getModelInternal()){const e=this.getModelInternal();return e.config}return},getFilter:function e(){if(this.getModelInternal()){const e=this.getModelInternal();return e.getProperty("/uiFilter")}return},getFilterRootCondition:function e(){if(this.getModelInternal()){const e=this.getModelInternal();return e.getFilterRootCondition()}return Ce.getMetadata().getPropertyDefaults()["filterRootCondition"]},updateStaticHierarchyFacet:async function e(){const t=this.getModelInternal();const r=this.getDataSource();const s=t.sinaNext.getDataSource(r).getStaticHierarchyAttributeMetadata().id;if(s){const e=t.getProperty("/facets").filter(e=>e.attributeId===s);if(e.length>0){await(e[0]?.updateTree())}}},recalculateSearchInputPlaceholder:function e(){if(this.getModelInternal()){const e=this.getModelInternal();e.setProperty("/searchTermPlaceholder",e.calculatePlaceholder())}},setFilterRootCondition:function e(t,r){if(this.getModelInternal()){const e=this.getModelInternal();e.setFilterRootCondition(t,r)}return this},renderSearchUrlFromParameters:function e(t,r,s){const o=this.getModelInternal();if(!o){throw new ie(null,"cannot construct URL because model is undefined")}return o.createSearchNavigationTarget({top:t,filter:r,encodeFilter:s,updateUrl:true}).targetUrl},createSearchNavigationTarget:function e(t,r){const s=this.getModelInternal();return s.createSearchNavigationTarget(t,r)},createStaticHierarchySearchNavigationTarget:function e(t,r,s,o){const n=this.getModelInternal();return n.sinaNext.createStaticHierarchySearchNavigationTarget(t,r,s,o)},addEventConsumer:function e(t){const r=this.getModelInternal();r?.eventLogger?.addConsumer(t)},getEventConsumers:function e(){const t=this.getModelInternal();return t?.eventLogger?.consumers},setEventConsumers:function e(t){const r=this.getModelInternal();r?.eventLogger?.setConsumers(t);return this},closePopovers:function e(){const t=document.getElementsByClassName("sapMDialogOpen")||[];for(const e of t){const t=L?.getElementById(e.id);if(t&&t?.getParent()?.getId()?.endsWith("search-result-table-personalizer-resetBtn")){const e=t?.getButtons()||[];for(const t of e){if(t?.getType()===te.Default){t?.firePress();break}}}}const r=["sapUshellSearchFacetDialog","sapUshellSearchResultSortDialog","sapUshellSearchResultTablePersonalizationDialog","sapUshellSearchResultExportDialog","sapUshellSearchResultShareActionSheet","bookmarkDialog","sapUshellSearchMessageBox"];for(const e of r){const t=document.getElementsByClassName(e)[0]||document.getElementById(e);const r=L?.getElementById(t?.id);if(r){if(r instanceof W){const e=r?.getButtons()||[];for(const t of e){if(t?.getType()===te.Default){t?.firePress();break}}}if(r instanceof z){r?.close()}}}},getInitializationStatus:async function e(){const t=await this.getModelInternal().getInitializationStatus();if(!t.success){return t}try{await this.initSearchPromise}catch(e){return{success:false,error:e}}return{success:true}},getStaticHierarachyFilters:function e(){const t=this.getModelInternal();return t.getStaticHierarchyFilterConditions()},hasStaticHierarchyFacetFilterConditionOnly:function e(){const t=this.getModelInternal();return t.hasStaticHierarchyFacetFilterConditionOnly()},clearObjectSelection:function e(){const t=this.getModelInternal();if(t){t.resetKeyStore()}}});Ce.eshCompCounter=0;Ce.getUI5ControlSettings=function e(t){const r={};const s=Ce.getMetadata().getProperties();for(const e in s){if(typeof t[e]==="undefined"){continue}r[e]=t[e]}const o=Ce.getMetadata().getEvents();for(const e in o){if(typeof t[e]==="undefined"){continue}r[e]=t[e]}return r};Ce.unifyInputParameters=function e(t,r){if(typeof t!=="string"&&t!==undefined&&r===undefined){r=t;t=r&&r.id}else if(typeof r==="undefined"){r={}}if(typeof t==="string"&&t.length>0){r.id=t}if(!t||t.length===0){t="eshComp"+"GenId_"+Ce.eshCompCounter++;r.id=t}if(typeof t==="string"&&t.length>0&&typeof r.id!=="undefined"){if(t!==r.id){throw new Error("Constructor of component 'sap.esh.search.ui.SearchCompositeControl' has failed\n\n"+"sId and mSettings.id are not the same. It is sufficient to set either 'id' (sId) or 'settings.id' (mSettings.id).")}}return{sId:t,settings:r}};let be=1;return Ce});
//# sourceMappingURL=SearchCompositeControl.js.map