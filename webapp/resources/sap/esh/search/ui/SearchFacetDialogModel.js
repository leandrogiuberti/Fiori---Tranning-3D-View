/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["./i18n","sap/m/MessageBox","./SearchModel","sap/ui/core/library","./hierarchydynamic/SearchHierarchyDynamicFacet","./SearchFacetDialogHelperDynamicHierarchy"],function(t,e,i,r,s,a){"use strict";function o(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const n=o(t);const c=o(i);const l=r["TextDirection"];const h=o(s);const u=a["createFilterFacetItemForDynamicHierarchy"];class F extends c{aFilters;chartQuery;searchModel;constructor(t){super({searchModel:t.searchModel,configuration:t.searchModel.config});this.searchModel=t.searchModel;this.aFilters=[]}prepareFacetList(){const t=this.getDataSource();this.setProperty("/facetDialog",this.oFacetFormatter.getDialogFacetsFromMetaData(t,this));this.initialFillFiltersForDynamicHierarchyFacets()}initialFillFiltersForDynamicHierarchyFacets(){const t=this.getProperty("/uiFilter");const e=this.getProperty("/facetDialog");for(const i of e){if(!(i instanceof h)){continue}const e=t.rootCondition.getAttributeConditions(i.attributeId);for(const t of e){const e=t;const r=u(i,e);this.aFilters.push(r)}}}facetDialogSingleCall(t){this.chartQuery.dimension=t.sAttribute;this.chartQuery.top=t.sAttributeLimit;this.chartQuery.setNlq(this.searchModel.isNlqActive());return this.chartQuery.getResultSetAsync().then(e=>{let i;if(t.bInitialFilters){i=this.oFacetFormatter.getDialogFacetsFromChartQuery(e,this,this.chartQuery.dimension)}else{i=this.oFacetFormatter.getDialogFacetsFromChartQuery(e,this,this.chartQuery.dimension,this.aFilters)}this.setProperty(t.sBindingPath+"/items",i.items);this.setProperty(t.sBindingPath+"/items",i.items);if(typeof e?.facetTotalCount==="number"){this.setProperty(t.sBindingPath+"/facetTotalCount",e.facetTotalCount)}},t=>{const i=n.getText("searchError");const r=t.message;e.error(r,{title:i,actions:e.Action.OK,onClose:null,styleClass:"sapUshellSearchMessageBox",initialFocus:null,textDirection:l.Inherit})})}resetChartQueryFilterConditions(){if(this.chartQuery){this.chartQuery.resetConditions()}const t=this.getStaticHierarchyFilterConditions();if(t.length>0){for(const e of t){this.chartQuery.autoInsertCondition(e)}}}hasFilterCondition(t){for(let e=0;e<this.aFilters.length;e++){if(this.aFilters[e].filterCondition.equals&&this.aFilters[e].filterCondition.equals(t)){return true}}return false}hasFilter(t){const e=t.filterCondition;return this.hasFilterCondition(e)}addFilter(t){if(!this.hasFilter(t)){this.aFilters.push(t)}}removeFilter(t){const e=t.filterCondition;for(let t=0;t<this.aFilters.length;t++){if(this.aFilters[t].filterCondition.equals&&this.aFilters[t].filterCondition.equals(e)){this.aFilters.splice(t,1);return}}}changeFilterAdvaced(t,e){const i=t.filterCondition;for(let t=0;t<this.aFilters.length;t++){if(this.aFilters[t].filterCondition.equals&&this.aFilters[t].filterCondition.equals(i)){this.aFilters[t].advanced=e;return}}}addFilterCondition(t){this.chartQuery.filter.autoInsertCondition(t)}getAttributeDataType(t){switch(t.dataType){case"Integer":return"integer";case"Double":return"number";case"Timestamp":return"timestamp";case"Date":return"date";case"String":if(t.matchingStrategy===this.sinaNext.MatchingStrategy.Text){return"text"}return"string";default:return"string"}}destroy(){super.destroy();this.oFacetFormatter.destroy()}}return F});
//# sourceMappingURL=SearchFacetDialogModel.js.map