/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["./i18n","sap/m/p13n/Popup","sap/m/p13n/SelectionPanel","sap/ui/core/Core","./error/ErrorHandler"],function(e,t,s,n,a){"use strict";function l(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const o=l(e);const i=l(a);class r{model;table;p13nPanel;p13nPopup;resetPerformed=false;constructor(e){this.model=e}initialize(e){try{this.table=e;if(!this.p13nPopup){this.createPopup()}this.p13nPanel.attachChange(()=>{this.resetPerformed=false;this.updateOkButtonState()})}catch(e){const t=i.getInstance();t.onError(e)}}updateTableColumns(e){if(e){this.model.setTableColumns(this.model.getTableInitialColumns(),true)}else{const e=this.p13nPanel.getP13nData(false);const t=this.model.getTableColumns(false);const s=[];for(const n of e){for(const e of t){if(e.p13NColumnName===n.name){e.visible=n.visible;s.push(e);break}}}this.model.setTableColumns(s,true)}}updateP13NColumns(e){const t=e?this.model.getTableInitialColumns():this.model.getTableColumns(false);const s=t.map(e=>({name:e.p13NColumnName,label:e.name,visible:e.visible}));this.p13nPanel.setP13nData(s)}createPopup(){this.p13nPanel=new s({showHeader:false});this.p13nPopup=new t(this.table.getId()+"-personalizer",{title:o.getText("personalizeTable"),panels:[this.p13nPanel],warningText:o.getText("resetColumns"),reset:()=>{this.updateP13NColumns(true);this.updateOkButtonState();this.resetPerformed=true},close:e=>{if(e.getParameter("reason")==="Ok"){this.updateTableColumns(this.resetPerformed);this.table.update()}this.resetPerformed=false}});this.p13nPopup.addStyleClass("sapUshellSearchResultTablePersonalizationDialog")}updateOkButtonState(){const e=this.p13nPanel.getP13nData(false);const t=e.filter(e=>e.visible).length;const s=this.table.getId()+"-personalizer-confirmBtn";const a=n.byId(s);if(a){const e=t>0;a.setEnabled(e);a.setTooltip(e?"":o.getText("noColumnsSelectedTooltip"))}}openDialog(){this.updateP13NColumns(false);this.p13nPopup.open(null);this.updateOkButtonState()}destroyControllerAndDialog(){this.p13nPopup.destroyPanels();this.p13nPopup.destroy()}}return r});
//# sourceMappingURL=SearchResultTableP13NPersonalizer.js.map