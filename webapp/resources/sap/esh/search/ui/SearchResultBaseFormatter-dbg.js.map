{"version":3,"file":"SearchResultBaseFormatter-dbg.js","names":["sap","ui","define","__ErrorHandler","__i18n","_interopRequireDefault","obj","__esModule","default","ErrorHandler","i18n","SearchResultBaseFormatter","model","errorHandler","constructor","getInstance","formatSortAttributes","sortAttributes","sina","sinaNext","datasource","getDataSource","attributesMetadata","dataSourceMap","id","Array","isArray","length","i","attribute","isSortable","push","name","label","key","attributeId","compareAttributes","a","b","sort","unshift","getText","orderBy","getOrderBy","selected"],"sources":["SearchResultBaseFormatter.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport ErrorHandler from \"./error/ErrorHandler\";\nimport i18n from \"./i18n\";\nimport SearchModel from \"sap/esh/search/ui/SearchModel\";\nimport { AttributeMetadata } from \"./sinaNexTS/sina/AttributeMetadata\";\n\nexport interface SortAttribute {\n    attributeId: string; // ID of unformatted attribute, for dialog-attribute mapping\n    name: string; // UI5 sort dialog item label\n    key: string; // UI5 sort dialog item key\n    selected: boolean;\n}\n\nexport default abstract class SearchResultBaseFormatter {\n    model: SearchModel;\n    protected errorHandler: ErrorHandler;\n\n    constructor(model: SearchModel) {\n        this.model = model;\n        this.errorHandler = ErrorHandler.getInstance();\n    }\n\n    /*\n     * ===================================\n     * format attributes for search result sort dialog\n     * ===================================\n     */\n    formatSortAttributes(): Array<SortAttribute> {\n        const sortAttributes = [];\n        const sina = this.model.sinaNext;\n        const datasource = this.model.getDataSource();\n        const attributesMetadata = sina.dataSourceMap[datasource.id].attributesMetadata;\n\n        if (!Array.isArray(attributesMetadata) || attributesMetadata.length === 0) {\n            return [];\n        }\n\n        // sortable attributes\n        for (let i = 0; i < attributesMetadata.length; i++) {\n            const attribute = attributesMetadata[i] as AttributeMetadata;\n            if (attribute.isSortable) {\n                sortAttributes.push({\n                    name: attribute.label,\n                    key: \"searchSortAttributeKey\" + i,\n                    attributeId: attribute.id,\n                });\n            }\n        }\n\n        const compareAttributes = (a, b) => {\n            if (a.name < b.name) {\n                return -1;\n            }\n            if (a.name > b.name) {\n                return 1;\n            }\n            return 0;\n        };\n\n        sortAttributes.sort(compareAttributes);\n\n        // default sort attribute, server ranking\n        sortAttributes.unshift({\n            name: i18n.getText(\"defaultRank\"),\n            key: \"searchSortAttributeKeyDefault\",\n            attributeId: \"DEFAULT_SORT_ATTRIBUTE\",\n        });\n\n        // set selected\n        let orderBy = this.model.getOrderBy().orderBy;\n        if (typeof orderBy === \"undefined\") {\n            orderBy = \"DEFAULT_SORT_ATTRIBUTE\";\n        }\n        for (let i = 0; i < sortAttributes.length; i++) {\n            if (sortAttributes[i].attributeId === orderBy) {\n                sortAttributes[i].selected = true;\n            } else {\n                sortAttributes[i].selected = false;\n            }\n        }\n\n        return sortAttributes;\n    }\n}\n"],"mappings":"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","ignoreList":[]}