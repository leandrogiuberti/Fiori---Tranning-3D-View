{"version":3,"file":"SearchResultBaseFormatter.js","names":["sap","ui","define","__ErrorHandler","__i18n","_interopRequireDefault","obj","__esModule","default","ErrorHandler","i18n","SearchResultBaseFormatter","model","errorHandler","constructor","this","getInstance","formatSortAttributes","sortAttributes","sina","sinaNext","datasource","getDataSource","attributesMetadata","dataSourceMap","id","Array","isArray","length","i","attribute","isSortable","push","name","label","key","attributeId","compareAttributes","a","b","sort","unshift","getText","orderBy","getOrderBy","selected"],"sources":["SearchResultBaseFormatter.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport ErrorHandler from \"./error/ErrorHandler\";\nimport i18n from \"./i18n\";\nimport SearchModel from \"sap/esh/search/ui/SearchModel\";\nimport { AttributeMetadata } from \"./sinaNexTS/sina/AttributeMetadata\";\n\nexport interface SortAttribute {\n    attributeId: string; // ID of unformatted attribute, for dialog-attribute mapping\n    name: string; // UI5 sort dialog item label\n    key: string; // UI5 sort dialog item key\n    selected: boolean;\n}\n\nexport default abstract class SearchResultBaseFormatter {\n    model: SearchModel;\n    protected errorHandler: ErrorHandler;\n\n    constructor(model: SearchModel) {\n        this.model = model;\n        this.errorHandler = ErrorHandler.getInstance();\n    }\n\n    /*\n     * ===================================\n     * format attributes for search result sort dialog\n     * ===================================\n     */\n    formatSortAttributes(): Array<SortAttribute> {\n        const sortAttributes = [];\n        const sina = this.model.sinaNext;\n        const datasource = this.model.getDataSource();\n        const attributesMetadata = sina.dataSourceMap[datasource.id].attributesMetadata;\n\n        if (!Array.isArray(attributesMetadata) || attributesMetadata.length === 0) {\n            return [];\n        }\n\n        // sortable attributes\n        for (let i = 0; i < attributesMetadata.length; i++) {\n            const attribute = attributesMetadata[i] as AttributeMetadata;\n            if (attribute.isSortable) {\n                sortAttributes.push({\n                    name: attribute.label,\n                    key: \"searchSortAttributeKey\" + i,\n                    attributeId: attribute.id,\n                });\n            }\n        }\n\n        const compareAttributes = (a, b) => {\n            if (a.name < b.name) {\n                return -1;\n            }\n            if (a.name > b.name) {\n                return 1;\n            }\n            return 0;\n        };\n\n        sortAttributes.sort(compareAttributes);\n\n        // default sort attribute, server ranking\n        sortAttributes.unshift({\n            name: i18n.getText(\"defaultRank\"),\n            key: \"searchSortAttributeKeyDefault\",\n            attributeId: \"DEFAULT_SORT_ATTRIBUTE\",\n        });\n\n        // set selected\n        let orderBy = this.model.getOrderBy().orderBy;\n        if (typeof orderBy === \"undefined\") {\n            orderBy = \"DEFAULT_SORT_ATTRIBUTE\";\n        }\n        for (let i = 0; i < sortAttributes.length; i++) {\n            if (sortAttributes[i].attributeId === orderBy) {\n                sortAttributes[i].selected = true;\n            } else {\n                sortAttributes[i].selected = false;\n            }\n        }\n\n        return sortAttributes;\n    }\n}\n"],"mappings":";;;;;AAAAA,IAAAC,GAAAC,OAAA,2CAAAC,EAAAC,GAAA,sBAAAC,EAAAC,GAAA,OAAAA,KAAAC,mBAAAD,EAAAE,UAAA,YAAAF,EAAAE,QAAAF,CAAA,OAKOG,EAAYJ,EAAAF,GAAA,MACZO,EAAIL,EAAAD,GAWI,MAAeO,EAC1BC,MACUC,aAEVC,YAAYF,GACRG,KAAKH,MAAQA,EACbG,KAAKF,aAAeJ,EAAaO,aACrC,CAOAC,uBACI,MAAMC,EAAiB,GACvB,MAAMC,EAAOJ,KAAKH,MAAMQ,SACxB,MAAMC,EAAaN,KAAKH,MAAMU,gBAC9B,MAAMC,EAAqBJ,EAAKK,cAAcH,EAAWI,IAAIF,mBAE7D,IAAKG,MAAMC,QAAQJ,IAAuBA,EAAmBK,SAAW,EAAG,CACvE,MAAO,EACX,CAGA,IAAK,IAAIC,EAAI,EAAGA,EAAIN,EAAmBK,OAAQC,IAAK,CAChD,MAAMC,EAAYP,EAAmBM,GACrC,GAAIC,EAAUC,WAAY,CACtBb,EAAec,KAAK,CAChBC,KAAMH,EAAUI,MAChBC,IAAK,yBAA2BN,EAChCO,YAAaN,EAAUL,IAE/B,CACJ,CAEA,MAAMY,EAAoBA,CAACC,EAAGC,KAC1B,GAAID,EAAEL,KAAOM,EAAEN,KAAM,CACjB,OAAQ,CACZ,CACA,GAAIK,EAAEL,KAAOM,EAAEN,KAAM,CACjB,OAAO,CACX,CACA,OAAO,GAGXf,EAAesB,KAAKH,GAGpBnB,EAAeuB,QAAQ,CACnBR,KAAMvB,EAAKgC,QAAQ,eACnBP,IAAK,gCACLC,YAAa,2BAIjB,IAAIO,EAAU5B,KAAKH,MAAMgC,aAAaD,QACtC,UAAWA,IAAY,YAAa,CAChCA,EAAU,wBACd,CACA,IAAK,IAAId,EAAI,EAAGA,EAAIX,EAAeU,OAAQC,IAAK,CAC5C,GAAIX,EAAeW,GAAGO,cAAgBO,EAAS,CAC3CzB,EAAeW,GAAGgB,SAAW,IACjC,KAAO,CACH3B,EAAeW,GAAGgB,SAAW,KACjC,CACJ,CAEA,OAAO3B,CACX,EACH,OAAAP,CAAA","ignoreList":[]}