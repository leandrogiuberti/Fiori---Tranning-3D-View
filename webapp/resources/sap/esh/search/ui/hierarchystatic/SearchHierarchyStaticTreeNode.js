/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../eventlogging/UserEvents","../tree/TreeNode"],function(t,e){"use strict";function i(t){return t&&t.__esModule&&typeof t.default!=="undefined"?t.default:t}const r=t["UserEventType"];const o=i(e);class a extends o{hasFilter;icon;constructor(t){super(t);this.icon=t.icon;this.getData().facet=t.facet}async setExpanded(t,e){await super.setExpanded(t,false);this.getData().facet.mixinFilterNodes();if(e){this.getTreeNodeFactory().updateUI()}}async toggleFilter(){const t=this.getData().facet;if(!this.hasFilter){this.setFilter(true)}else{this.setFilter(false)}await t.activateFilters()}setFilter(t){const e=this.getData().facet;const i=e.sina.createSimpleCondition({operator:e.sina.ComparisonOperator.DescendantOf,attribute:e.attributeId,attributeLabel:e.title,value:this.id,valueLabel:this.label});const o=e.model.getProperty("/uiFilter");if(t){this.removeExistingFilters();if(e.model.config.searchInAreaOverwriteMode){e.model.config.resetQuickSelectDataSourceAll(e.model)}e.model.setSearchBoxTerm("",false);e.model.resetFilterByFilterConditions(false);o.autoInsertCondition(i);const t={type:r.STATIC_FACET_SELECT,clickedValue:this.id,clickedLabel:this.label,clickedPosition:-1,dataSourceKey:e.model.getDataSource().id};e.model.eventLogger.logEvent(t)}else{o.autoRemoveCondition(i)}}removeExistingFilters(){const t=this.getData().facet;const e=t.model.getProperty("/uiFilter");const i=e.rootCondition.getAttributeConditions(t.attributeId);for(const t of i){e.autoRemoveCondition(t)}}async fetchChildTreeNodesImpl(){const t=t=>{for(let e=0;e<t.attributes.length;++e){const i=t.attributes[e];if(i.id===r.attributeId){return i.value}}};const e=t=>{const e=[];for(let i=0;i<t.titleAttributes.length;++i){const r=t.titleAttributes[i];if(!r.value.startsWith("sap-icon://")){e.push(r.valueFormatted)}}return e.join(" ")};const i=t=>{for(let e=0;e<t.attributes.length;++e){const i=t.attributes[e];if(typeof i.value==="string"&&i.value.startsWith("sap-icon://")){return i.value}}return"sap-icon://none"};const r=this.getData().facet;const o=r.sina.createFilter({dataSource:r.dataSource});o.autoInsertCondition(r.sina.createSimpleCondition({attribute:r.attributeId,value:this.id,operator:r.sina.ComparisonOperator.ChildOf}));const a=r.sina.createSearchQuery({filter:o,top:500});const s=await a.getResultSetAsync();if(s.hasErrors()){s.getErrors().forEach(t=>r.model.errorHandler.onError(t))}const n=[];for(let o=0;o<s.items.length;++o){const a=s.items[o];const l=r.treeNodeFactory.createTreeNode({facet:r,id:t(a),label:e(a),icon:i(a),expandable:!a.attributesMap.HASHIERARCHYNODECHILD||a.attributesMap.HASHIERARCHYNODECHILD.value==="true"});n.push(l)}return n}updateNodePath(t,e){if(t[e].id!==this.id){throw new Error("program error")}if(e+1>=t.length){return}const i=t[e+1];let r=this.getChildTreeNodeById(i.id);if(!r){const t=this.getData().facet;r=t.treeNodeFactory.createTreeNode({facet:t,id:i.id,label:i.label});this.addChildTreeNode(r)}r.updateNodePath(t,e+1)}}return a});
//# sourceMappingURL=SearchHierarchyStaticTreeNode.js.map