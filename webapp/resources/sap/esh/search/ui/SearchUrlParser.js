/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["./SearchUrlParserInav2","./SearchHelper","./i18n","sap/m/MessageBox","./error/ErrorHandler","./sinaNexTS/core/core"],function(e,r,t,s,a,o){"use strict";function i(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const l=i(e);const n=i(t);const c=i(a);class d{model;urlParserInav2;errorHandler;constructor(e){this.model=e.model;this.urlParserInav2=new l(e);this.errorHandler=c.getInstance()}async parse(e=true){try{if(!this.model.config.isSearchUrl(r.getHashFromUrl())){return Promise.resolve(undefined)}}catch(e){this.errorHandler.onError(e);return Promise.resolve(undefined)}if(!r.hasher.hasChanged()){return Promise.resolve(undefined)}await this.model.initAsync();if(!this.model.sinaNext){return}let t=r.getUrlParameters();if(o.isEmptyObject(t)){return undefined}if(t.datasource||t.searchterm){if(!t.datasource||this.isJson(t.datasource)){return this.urlParserInav2.parseUrlParameters(t)}}try{t=this.model.config.parseSearchUrlParameters(t)}catch(e){this.errorHandler.onError(e);return}if(t.datasource&&!this.isJson(t.datasource)&&t.searchterm){this.parseSimplifiedUrlParameters(t)}else{this.parseUrlParameters(t)}this.model.setProperty("/searchTermPlaceholder",this.model.calculatePlaceholder());this.model.calculateSearchButtonStatus();if(e){this.model.fireSearchQuery({deserialization:true})}}isJson(e){return e.indexOf("{")>=0&&e.indexOf("}")>=0}parseSimplifiedUrlParameters(e){if(e.top){const r=parseInt(e.top,10);this.model.setTop(r,false)}const r=this.model.sinaNext.createFilter();r.setSearchTerm(e.searchterm);let t=this.model.sinaNext.getDataSource(e.datasource);if(!t){t=this.model.sinaNext.allDataSource}r.setDataSource(t);this.model.setProperty("/uiFilter",r);this.model.setDataSource(r.dataSource,false,false)}parseUrlParameters(e){if(e.top){const r=parseInt(e.top,10);this.model.setTop(r,false)}if(e.orderby&&e.sortorder){const r={orderBy:e.orderby,sortOrder:e.sortorder};this.model.setOrderBy(r,false)}else{this.model.resetOrderBy(false)}let r;if(e.filter){try{const t=JSON.parse(e.filter);r=this.model.sinaNext.parseFilterFromJson(t);this.model.setProperty("/uiFilter",r);this.model.setDataSource(r.dataSource,false,false)}catch(e){s.show(n.getText("searchUrlParsingErrorLong")+"\n("+e.toString()+")",{icon:s.Icon.ERROR,title:n.getText("searchUrlParsingError"),actions:[s.Action.OK],styleClass:"sapUshellSearchMessageBox"})}}}}return d});
//# sourceMappingURL=SearchUrlParser.js.map