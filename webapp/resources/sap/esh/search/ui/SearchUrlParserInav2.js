/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["sap/m/MessageBox","./error/errors","./i18n"],function(e,t,a){"use strict";function r(e){return e&&e.__esModule&&typeof e.default!=="undefined"?e.default:e}const o=r(t);const s=r(a);function i(e){if(e&&e.conditions){return true}return false}class n{model;constructor(e){this.model=e.model}async parseUrlParameters(t){if(t.top){const e=parseInt(t.top,10);this.model.setTop(e,false)}let a=this.model.sinaNext.allDataSource;if(t.datasource){const r=JSON.parse(t.datasource);const i=r.ObjectName.value;switch(r.Type){case"Category":if(i==="$$ALL$$"){a=this.model.sinaNext.allDataSource}else{a=this.model.sinaNext.getDataSource(i);if(!a){a=this.model.sinaNext.createDataSource({type:this.model.sinaNext.DataSourceType.Category,id:i,label:r.label,labelPlural:r.labelPlural})}}break;case"BusinessObject":a=this.model.sinaNext.getDataSource(i);if(!a){a=this.model.sinaNext.allDataSource;delete t.filter;e.show(s.getText("searchUrlParsingErrorLong")+"\n(Unknow datasource "+i+")",{icon:e.Icon.ERROR,title:s.getText("searchUrlParsingError"),actions:[e.Action.OK],styleClass:"sapUshellSearchMessageBox"})}break;default:{const e=new Error("Unknown datasource type "+r.Type);throw new o.UnknownDataSourceType(e)}}}await this.model.sinaNext.loadMetadata(a);const r={dataSource:a};let i;if(t.filter){try{const e=JSON.parse(t.filter);i=this.parseCondition(r,e)}catch(t){i=this.model.sinaNext.createComplexCondition();e.show(s.getText("searchUrlParsingErrorLong")+"\n("+t.toString()+")",{icon:e.Icon.ERROR,title:s.getText("searchUrlParsingError"),actions:[e.Action.OK],styleClass:"sapUshellSearchMessageBox"})}}else{i=this.model.sinaNext.createComplexCondition()}const n=this.model.sinaNext.createFilter({dataSource:a,searchTerm:t.searchterm,rootCondition:i});this.model.setProperty("/uiFilter",n);this.model.setDataSource(n.dataSource,false)}parseCondition(e,t){if(i(t)){return this.parseComplexCondition(e,t)}return this.parseSimpleCondition(e,t)}parseComplexCondition(e,t){const a=[];for(let r=0;r<t.conditions.length;++r){const o=t.conditions[r];a.push(this.parseCondition(e,o))}return this.model.sinaNext.createComplexCondition({operator:t.operator,conditions:a,valueLabel:t.label})}parseSimpleCondition(e,t){e.attribute=t.attribute;return this.model.sinaNext.createSimpleCondition({attribute:t.attribute,attributeLabel:t.attributeLabel,value:this.parseValue(e,t.value),valueLabel:t.valueLabel||t.label,operator:this.parseOperator(e,t.operator)})}parseValue(e,t){const a=e.dataSource.getAttributeMetadata(e.attribute);return this.model.sinaNext.inav2TypeConverter.ina2Sina(a.type,t)}parseOperator(e,t){switch(t){case"=":return this.model.sinaNext.ComparisonOperator.Eq;case">":return this.model.sinaNext.ComparisonOperator.Gt;case">=":return this.model.sinaNext.ComparisonOperator.Ge;case"<":return this.model.sinaNext.ComparisonOperator.Lt;case"<=":return this.model.sinaNext.ComparisonOperator.Le;default:throw"Unknown operator "+t}}}return n});
//# sourceMappingURL=SearchUrlParserInav2.js.map