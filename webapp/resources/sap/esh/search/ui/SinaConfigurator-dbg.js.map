{"version":3,"file":"SinaConfigurator-dbg.js","names":["sap","ui","define","___SearchConfigurationSettings","Log","___sinaNexTS_core_Log","___navigationtrackers_CustomNavigationTracker","___navigationtrackers_EventLoggerNavigationTracker","ResourceBundle","UI5NumberFormat","UI5DateFormat","__i18n","Localization","_interopRequireDefault","obj","__esModule","default","sinaParameters","Severity","generateCustomNavigationTracker","generateEventLoggerNavigationTracker","i18n","SinaConfigurator","model","loadedResourceBundles","constructor","Map","configure","sinaConfigurations","resultSinaConfigurations","sinaConfiguration","push","configureSina","configureLogging","configureCommonParameters","configureNavigationTrackers","configureGetTextFromResourceBundle","configureFormatLibrary","configureGetText","configureLanguage","configurationOptions","normalizeConfiguration","configureNavigationTracking","subProviders","map","subProviderConfiguration","provider","url","config","isUshell","cf","getLanguage","getLanguageFunction","navigationTrackers","parameterName","NumberFormat","DateFormat","sinaUI5Log","getLogger","logTarget","debug","info","warn","warning","error","sinaLogLevel","ERROR","getLevel","Level","ALL","TRACE","DEBUG","INFO","WARNING","WARN","logLevel","getTextFromResourceBundle","key","resourceBundle","has","get","create","set","getText","bind","__exports"],"sources":["SinaConfigurator.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport { sinaParameters } from \"./SearchConfigurationSettings\";\nimport { AvailableProviders, SinaConfiguration } from \"./sinaNexTS/sina/SinaConfiguration\";\nimport Log from \"sap/base/Log\";\nimport { Severity } from \"./sinaNexTS/core/Log\";\nimport SearchModel from \"./SearchModel\";\nimport { generateCustomNavigationTracker } from \"./navigationtrackers/CustomNavigationTracker\";\nimport { generateEventLoggerNavigationTracker } from \"./navigationtrackers/EventLoggerNavigationTracker\";\nimport ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport UI5NumberFormat from \"sap/ui/core/format/NumberFormat\";\nimport UI5DateFormat from \"sap/ui/core/format/DateFormat\";\nimport i18n from \"./i18n\";\nimport Localization from \"sap/base/i18n/Localization\";\n\ninterface ConfigurationOptions {\n    configureGetTextFromResourceBundle?: boolean;\n    configureLogging?: boolean;\n    configureCommonParameters?: boolean;\n    configureNavigationTrackers?: boolean;\n    configureFormatLibrary?: boolean;\n    configureGetText?: boolean;\n    configureLanguage?: boolean;\n}\n\nexport class SinaConfigurator {\n    model: SearchModel;\n    loadedResourceBundles: Map<string, ResourceBundle>;\n\n    constructor(model) {\n        this.model = model;\n        this.loadedResourceBundles = new Map();\n    }\n\n    configure(sinaConfigurations: Array<SinaConfiguration | AvailableProviders>): Array<SinaConfiguration> {\n        const resultSinaConfigurations = [];\n        for (const sinaConfiguration of sinaConfigurations) {\n            resultSinaConfigurations.push(\n                this.configureSina(sinaConfiguration, {\n                    configureLogging: true,\n                    configureCommonParameters: true,\n                    configureNavigationTrackers: true,\n                    configureGetTextFromResourceBundle: true,\n                    configureFormatLibrary: true,\n                    configureGetText: true,\n                    configureLanguage: true,\n                })\n            );\n        }\n        return resultSinaConfigurations;\n    }\n\n    configureSina(\n        sinaConfiguration: SinaConfiguration | AvailableProviders,\n        configurationOptions: ConfigurationOptions\n    ) {\n        sinaConfiguration = this.normalizeConfiguration(sinaConfiguration);\n        if (configurationOptions.configureCommonParameters) {\n            this.configureCommonParameters(sinaConfiguration);\n        }\n        if (configurationOptions.configureFormatLibrary) {\n            this.configureFormatLibrary(sinaConfiguration);\n        }\n        if (configurationOptions.configureLogging) {\n            this.configureLogging(sinaConfiguration);\n        }\n        if (configurationOptions.configureNavigationTrackers) {\n            this.configureNavigationTracking(sinaConfiguration);\n        }\n        if (configurationOptions.configureGetTextFromResourceBundle) {\n            this.configureGetTextFromResourceBundle(sinaConfiguration);\n        }\n        if (configurationOptions.configureGetText) {\n            this.configureGetText(sinaConfiguration);\n        }\n        if (configurationOptions.configureLanguage) {\n            this.configureLanguage(sinaConfiguration);\n        }\n        if (sinaConfiguration.subProviders) {\n            sinaConfiguration.subProviders = sinaConfiguration.subProviders.map((subProviderConfiguration) =>\n                this.configureSina(subProviderConfiguration, {\n                    configureNavigationTrackers: true,\n                })\n            );\n        }\n        return sinaConfiguration;\n    }\n\n    normalizeConfiguration(sinaConfiguration: SinaConfiguration | AvailableProviders): SinaConfiguration {\n        if (typeof sinaConfiguration === \"string\") {\n            return { provider: sinaConfiguration, url: \"\" };\n        }\n        return sinaConfiguration;\n    }\n\n    private configureLanguage(sinaConfiguration: SinaConfiguration) {\n        if (this.model.config.isUshell && typeof (sap as any).cf === \"undefined\") {\n            // is ushell but not cFLP / workzone (which defines sap.cf global)\n            // which does not have a sap-usercontext cookie to determine the users language\n            // do nothing, language setting will be done by ushell\n            return;\n        }\n        if (!sinaConfiguration.getLanguage) {\n            const getLanguageFunction = () => Localization.getLanguage();\n            sinaConfiguration[\"getLanguage\"] = getLanguageFunction;\n        }\n    }\n\n    configureNavigationTracking(sinaConfiguration: SinaConfiguration) {\n        sinaConfiguration.navigationTrackers = sinaConfiguration.navigationTrackers || [];\n        sinaConfiguration.navigationTrackers.push(generateCustomNavigationTracker(this.model));\n        sinaConfiguration.navigationTrackers.push(generateEventLoggerNavigationTracker(this.model));\n    }\n\n    configureCommonParameters(sinaConfiguration: SinaConfiguration) {\n        for (const parameterName of sinaParameters) {\n            if (!sinaConfiguration[parameterName]) {\n                sinaConfiguration[parameterName] = this.model.config[parameterName];\n            }\n        }\n    }\n\n    configureFormatLibrary(sinaConfiguration: SinaConfiguration) {\n        sinaConfiguration.NumberFormat = UI5NumberFormat;\n        sinaConfiguration.DateFormat = UI5DateFormat;\n    }\n\n    configureLogging(sinaConfiguration: SinaConfiguration) {\n        const sinaUI5Log = Log.getLogger(\"sap.esh.search.ui.sina\");\n        // log target\n        sinaConfiguration.logTarget = {\n            debug: sinaUI5Log.debug,\n            info: sinaUI5Log.info,\n            warn: sinaUI5Log.warning,\n            error: sinaUI5Log.error,\n        };\n        // map UI5 loglevel to Sina loglevel:\n        let sinaLogLevel = Severity.ERROR;\n        switch (sinaUI5Log.getLevel()) {\n            case Log.Level.ALL:\n            case Log.Level.TRACE:\n            case Log.Level.DEBUG:\n                sinaLogLevel = Severity.DEBUG;\n                break;\n            case Log.Level.INFO:\n                sinaLogLevel = Severity.INFO;\n                break;\n            case Log.Level.WARNING:\n                sinaLogLevel = Severity.WARN;\n                break;\n        }\n        sinaConfiguration.logLevel = sinaLogLevel;\n    }\n\n    configureGetTextFromResourceBundle(sinaConfiguration: SinaConfiguration) {\n        sinaConfiguration.getTextFromResourceBundle = async (url: string, key: string): Promise<string> => {\n            let resourceBundle: ResourceBundle;\n            if (this.loadedResourceBundles.has(url)) {\n                resourceBundle = this.loadedResourceBundles.get(url);\n            } else {\n                resourceBundle = await ResourceBundle.create({ url: url });\n                this.loadedResourceBundles.set(url, resourceBundle);\n            }\n            return resourceBundle.getText(key);\n        };\n    }\n\n    configureGetText(sinaConfiguration: SinaConfiguration) {\n        sinaConfiguration.getText = i18n.getText.bind(i18n);\n    }\n}\n"],"mappings":"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","ignoreList":[]}