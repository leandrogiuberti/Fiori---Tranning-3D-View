/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../core/core","../core/errors","../core/util","./AttributeType","./AttributeFormatType","./AttributeGroupTextArrangement","./DataSourceType","./MatchingStrategy","./LogicalOperator","./ComparisonOperator","./FacetType","./SuggestionCalculationMode","./SuggestionType","./SortOrder","./ConditionType","../providers/tools/cds/CDSAnnotationsParser","../providers/tools/sors/NavigationTargetGenerator","./SearchResultSet","./SearchResultSetItem","./SearchResultSetItemAttribute","./ObjectSuggestion","./SearchQuery","./ChartQuery","./SuggestionQuery","./DataSourceQuery","./Filter","./ComplexCondition","./SimpleCondition","./AttributeMetadata","./AttributeGroupMetadata","./AttributeGroupMembership","./SearchResultSetItemAttributeGroup","./SearchResultSetItemAttributeGroupMembership","./SearchTermSuggestion","./SearchTermAndDataSourceSuggestion","./DataSourceSuggestion","./SuggestionResultSet","./ChartResultSet","./DataSourceResultSet","./ChartResultSetItem","./DataSourceResultSetItem","./Capabilities","./Configuration","./NavigationTarget","./DataSource","./UserCategoryDataSource","../providers/tools/ItemPostParser","../providers/tools/fiori/SuvNavTargetResolver","../providers/tools/fiori/FioriIntentsResolver","./formatters/ResultValueFormatter","./formatters/NavtargetsInResultSetFormatter","./formatters/HierarchyResultSetFormatter","./FilteredDataSource","../providers/inav2/Provider","../providers/abap_odata/Provider","./HierarchyQuery","./HierarchyNode","./HierarchyResultSet","../providers/inav2/typeConverter","./HierarchyNodePath","./HierarchyDisplayType","./formatters/SuggestionResultValueFormatter","./SearchTermAISuggestion","./PublicSina"],function(t,e,r,a,i,s,o,c,n,u,h,S,l,y,g,m,p,d,b,F,f,C,R,v,A,D,T,O,_,j,I,N,w,M,P,H,G,Q,L,x,E,J,B,V,U,k,$,z,q,K,W,X,Y,Z,tt,et,rt,at,it,st,ot,ct,nt,ut){"use strict";const ht=a["AttributeType"];const St=i["AttributeFormatType"];const lt=s["AttributeGroupTextArrangement"];const yt=o["DataSourceSubType"];const gt=o["DataSourceType"];const mt=c["MatchingStrategy"];const pt=n["LogicalOperator"];const dt=u["ComparisonOperator"];const bt=h["FacetType"];const Ft=S["SuggestionCalculationMode"];const ft=l["SuggestionType"];const Ct=y["SortOrder"];const Rt=g["ConditionType"];const vt=m["CDSAnnotationsParser"];const At=p["NavigationTargetGenerator"];const Dt=d["SearchResultSet"];const Tt=b["SearchResultSetItem"];const Ot=F["SearchResultSetItemAttribute"];const _t=f["ObjectSuggestion"];const jt=C["SearchQuery"];const It=R["ChartQuery"];const Nt=v["SuggestionQuery"];const wt=A["DataSourceQuery"];const Mt=D["Filter"];const Pt=T["ComplexCondition"];const Ht=O["SimpleCondition"];const Gt=_["AttributeMetadata"];const Qt=j["AttributeGroupMetadata"];const Lt=I["AttributeGroupMembership"];const xt=N["SearchResultSetItemAttributeGroup"];const Et=w["SearchResultSetItemAttributeGroupMembership"];const Jt=M["SearchTermSuggestion"];const Bt=P["SearchTermAndDataSourceSuggestion"];const Vt=H["DataSourceSuggestion"];const Ut=G["SuggestionResultSet"];const kt=Q["ChartResultSet"];const $t=L["DataSourceResultSet"];const zt=x["ChartResultSetItem"];const qt=E["DataSourceResultSetItem"];const Kt=J["Capabilities"];const Wt=B["Configuration"];const Xt=V["NavigationTarget"];const Yt=U["DataSource"];const Zt=k["UserCategoryDataSource"];const te=$["ItemPostParser"];const ee=z["SuvNavTargetResolver"];const re=q["FioriIntentsResolver"];const ae=K["ResultValueFormatter"];const ie=W["NavtargetsInResultSetFormatter"];const se=X["HierarchyResultSetFormatter"];const oe=Y["FilteredDataSource"];const ce=Z["Provider"];const ne=tt["Provider"];const ue=et["HierarchyQuery"];const he=rt["HierarchyNode"];const Se=at["HierarchyResultSet"];const le=st["HierarchyNodePath"];const ye=ot["HierarchyDisplayType"];const ge=ct["SuggestionResultValueFormatter"];const me=e["ESHNoBusinessObjectDatasourceError"];const pe=nt["SearchTermAISuggestion"];const de=ut["PublicSina"];class be{errorList=[];inav2TypeConverter;provider;createSearchNavigationTarget;createSearchQuery;createChartQuery;createHierarchyQuery;createSuggestionQuery;createDataSourceQuery;createFilter;createComplexCondition;createSimpleCondition;createHierarchyNode;createHierarchyNodePath;_createAttributeMetadata;_createAttributeGroupMetadata;_createAttributeGroupMembership;_createSearchResultSetItemAttribute;_createSearchResultSetItemAttributeGroup;_createSearchResultSetItemAttributeGroupMembership;_createSearchResultSetItem;_createSearchResultSet;_createSearchTermSuggestion;_createSearchTermAISuggestion;_createSearchTermAndDataSourceSuggestion;_createDataSourceSuggestion;_createObjectSuggestion;_createSuggestionResultSet;_createChartResultSet;_createHierarchyResultSet;_createChartResultSetItem;_createDataSourceResultSetItem;_createCapabilities;_createConfiguration;_createNavigationTarget;createNavigationTarget;_createSorsNavigationTargetGenerator;_createFioriIntentsResolver;_createCDSAnnotationsParser;_createItemPostParser;_createSuvNavTargetResolver;searchResultSetFormatters;suggestionResultSetFormatters;chartResultSetFormatters;metadataFormatters;dataSources;dataSourceMap;allDataSource;DataSourceType;HierarchyDisplayType;DataSourceSubType;isDummyProvider;configurationPromise;capabilities;core;errors;util;SortOrder;ComparisonOperator;LogicalOperator;AttributeGroupTextArrangement;AttributeType;AttributeFormatType;FacetType;SuggestionType;ConditionType;SuggestionCalculationMode;MatchingStrategy;configuration;publicSina;constructor(a){this.core=t;this.errors=e;this.util=r;this.inav2TypeConverter=it;this.provider=a;this.createSearchQuery=this.createSinaObjectFactory(jt);this.createChartQuery=this.createSinaObjectFactory(It);this.createHierarchyQuery=this.createSinaObjectFactory(ue);this.createSuggestionQuery=this.createSinaObjectFactory(Nt);this.createDataSourceQuery=this.createSinaObjectFactory(wt);this.createFilter=this.createSinaObjectFactory(Mt);this.createComplexCondition=this.createSinaObjectFactory(Pt);this.createSimpleCondition=this.createSinaObjectFactory(Ht);this.createHierarchyNode=this.createSinaObjectFactory(he);this.createHierarchyNodePath=this.createSinaObjectFactory(le);this._createAttributeMetadata=this.createSinaObjectFactory(Gt);this._createAttributeGroupMetadata=this.createSinaObjectFactory(Qt);this._createAttributeGroupMembership=this.createSinaObjectFactory(Lt);this._createSearchResultSetItemAttribute=this.createSinaObjectFactory(Ot);this._createSearchResultSetItemAttributeGroup=this.createSinaObjectFactory(xt);this._createSearchResultSetItemAttributeGroupMembership=this.createSinaObjectFactory(Et);this._createSearchResultSetItem=this.createSinaObjectFactory(Tt);this._createSearchResultSet=this.createSinaObjectFactory(Dt);this._createSearchTermSuggestion=this.createSinaObjectFactory(Jt);this._createSearchTermAISuggestion=this.createSinaObjectFactory(pe);this._createSearchTermAndDataSourceSuggestion=this.createSinaObjectFactory(Bt);this._createDataSourceSuggestion=this.createSinaObjectFactory(Vt);this._createObjectSuggestion=this.createSinaObjectFactory(_t);this._createSuggestionResultSet=this.createSinaObjectFactory(Ut);this._createChartResultSet=this.createSinaObjectFactory(kt);this._createHierarchyResultSet=this.createSinaObjectFactory(Se);this._createChartResultSetItem=this.createSinaObjectFactory(zt);this._createDataSourceResultSetItem=this.createSinaObjectFactory(qt);this._createCapabilities=this.createSinaObjectFactory(Kt);this._createConfiguration=this.createSinaObjectFactory(Wt);this._createNavigationTarget=this.createSinaObjectFactory(Xt);this.createNavigationTarget=this.createSinaObjectFactory(Xt);this._createSorsNavigationTargetGenerator=this.createSinaObjectFactory(At);this._createFioriIntentsResolver=this.createSinaObjectFactory(re);this._createCDSAnnotationsParser=this.createSinaObjectFactory(vt);this._createItemPostParser=this.createSinaObjectFactory(te);this._createSuvNavTargetResolver=this.createSinaObjectFactory(ee);this.searchResultSetFormatters=[];this.suggestionResultSetFormatters=[];this.chartResultSetFormatters=[];this.metadataFormatters=[];this.dataSources=[];this.dataSourceMap={};this.allDataSource=this.createDataSource({id:"All",label:"All",type:gt.Category});this.DataSourceType=gt;this.DataSourceSubType=yt;this.HierarchyDisplayType=ye;this.AttributeGroupTextArrangement=lt;this.AttributeType=ht;this.AttributeFormatType=St;this.FacetType=bt;this.SuggestionType=ft;this.ConditionType=Rt;this.SuggestionCalculationMode=Ft;this.SortOrder=Ct;this.MatchingStrategy=mt;this.ComparisonOperator=dt;this.LogicalOperator=pt}getPublicSina(){if(this.publicSina){return this.publicSina}this.publicSina=new de(this);return this.publicSina}hasErrors(){return this.errorList.length>0}getErrors(){return this.errorList}addError(t){this.errorList.push(t)}addErrors(t){this.errorList.push(...t)}initInternalSearchResultSetFormatters(t){this.searchResultSetFormatters.push(new ie);this.searchResultSetFormatters.push(new ae({ui5NumberFormat:t.NumberFormat,ui5DateFormat:t.DateFormat}));this.searchResultSetFormatters.push(new se)}initInternalSuggestionResultValueFormatter(t){this.suggestionResultSetFormatters.push(new ge({ui5NumberFormat:t.NumberFormat,ui5DateFormat:t.DateFormat}))}async initAsync(t){this.configuration=t;this.isDummyProvider=t.provider.indexOf("dummy")>-1;this.provider.label=t.label;this.initInternalSearchResultSetFormatters(t);this.initInternalSuggestionResultValueFormatter(t);try{await this.initCustomFormattersAsync(t)}catch(t){throw new e.SinaConfigurationError("_evaluateConfigurationAsync",t)}t.sina=this;let r=await this.provider.initAsync(t);r=r||{capabilities:null};this.capabilities=r.capabilities||this._createCapabilities({sina:this});try{await this._formatMetadataAsync()}catch(t){throw new e.SinaConfigurationError("metadataformatter(s)->formatAsync",t)}if(t.initAsync){try{await t.initAsync(this)}catch(t){throw new e.SinaConfigurationError("configuration->initAsync",t)}}if(this.getBusinessObjectDataSources().length===0&&!this.isDummyProvider){throw new me}}_formatMetadataAsync(){return t.executeSequentialAsync(this.metadataFormatters,function(t){return t.formatAsync({dataSources:this.dataSources})}.bind(this))}async initCustomFormattersAsync(t){const e=[];if(t.searchResultSetFormatters){for(let r=0;r<t.searchResultSetFormatters.length;++r){const a=t.searchResultSetFormatters[r];this.searchResultSetFormatters.push(a);if(a.initAsync){e.push(a.initAsync())}}}if(t.suggestionResultSetFormatters){for(let r=0;r<t.suggestionResultSetFormatters.length;++r){const a=t.suggestionResultSetFormatters[r];this.suggestionResultSetFormatters.push(a);if(a.initAsync){e.push(a.initAsync())}}}if(t.chartResultSetFormatters){for(let r=0;r<t.chartResultSetFormatters.length;++r){const a=t.chartResultSetFormatters[r];this.chartResultSetFormatters.push(a);if(a.initAsync){e.push(a.initAsync())}}}if(t.metadataFormatters){for(let r=0;r<t.metadataFormatters.length;++r){const a=t.metadataFormatters[r];this.metadataFormatters.push(a);if(a.initAsync){e.push(a.initAsync())}}}return Promise.all(e)}async loadMetadata(t){if(this.provider instanceof ce){if(this.provider.loadMetadata){return this.provider.loadMetadata(t)}}return Promise.resolve()}createDataSourceMap(t){const e={};for(let r=0;r<t.length;++r){const a=t[r];e[a.id]=a}return e}createSinaObjectFactory(t){return function(e){e=e??{sina:this};e.sina=this;try{return new t(e)}finally{delete e.sina}}}_createDataSourceResultSet(t){const e=this.removeHierarchyDataSources(t.items,t=>t.dataSource);t.items=e;const r=new $t(t);r.sina=this;return r}isNeededCache={};removeHierarchyDataSources(t,e){const r=t=>{const e=this.isNeededCache[t.id];if(typeof e!=="undefined"){return e}for(const e of this.dataSources){for(const r of e.attributesMetadata){if(r.hierarchyName===t.hierarchyName&&r.hierarchyDisplayType===ye.HierarchyResultView){this.isNeededCache[t.id]=true;return true}}}this.isNeededCache[t.id]=false;return false};for(let a=0;a<t.length;a++){const i=t[a];const s=e(i);if(!s.isHierarchyDataSource){continue}if(!r(s)){t.splice(a,1);a--}}return t}createDataSource(t){t.sina=this;let r;switch(t.type){case gt.BusinessObject:switch(t.subType){case yt.Filtered:r=new oe(t);break;default:r=new Yt(t)}break;case gt.UserCategory:r=new Zt(t);break;default:r=new Yt(t)}if(this.dataSourceMap[r.id]){throw new e.CanNotCreateAlreadyExistingDataSourceError(r.id)}this._addDataSource(r);return r}_createDataSource(t){return this.createDataSource(t)}_addDataSource(t){if(t.type===gt.BusinessObject&&t.subType===yt.Filtered){let e=-1;for(let t=this.dataSources.length-1;t>=1;--t){const r=this.dataSources[t];if(r.type===gt.BusinessObject&&r.subType===yt.Filtered){e=t;break}}if(e>=0){this.dataSources.splice(e+1,0,t)}else{this.dataSources.push(t)}}else{this.dataSources.push(t)}this.dataSourceMap[t.id]=t}getAllDataSource(){return this.allDataSource}getBusinessObjectDataSources(){const t=[];for(let e=0;e<this.dataSources.length;++e){const r=this.dataSources[e];if(!r.hidden&&r.type===gt.BusinessObject&&r.subType!==yt.Filtered){t.push(r)}}return this.removeHierarchyDataSources(t,t=>t)}getDataSource(t){return this.dataSourceMap[t]}async getConfigurationAsync(t={}){if(this.provider instanceof ce||this.provider instanceof ne){if(this.configurationPromise&&!t.forceReload){return this.configurationPromise}this.configurationPromise=this.provider.getConfigurationAsync();return this.configurationPromise}return Promise.resolve(this._createConfiguration({personalizedSearch:false,isPersonalizedSearchEditable:false}))}logUserEvent(t){this.provider.logUserEvent(t)}getDebugInfo(){return this.provider.getDebugInfo()}dataSourceFromJson(t){return Yt.fromJson(t,this)}parseSimpleConditionFromJson(e){let a;if(t.isObject(e.value)){a=r.dateFromJson(e.value)}else{a=e.value}let i;if(e.userDefined){i=true}else{i=false}let s;if(e.dynamic){s=true}else{s=false}return this.createSimpleCondition({operator:e.operator,attribute:e.attribute,value:a,attributeLabel:e.attributeLabel,valueLabel:e.valueLabel,userDefined:i,isDynamicValue:s})}parseComplexConditionFromJson(t){const e=[];for(let r=0;r<t.conditions.length;++r){const a=t.conditions[r];e.push(this.parseConditionFromJson(a))}let r;if(t.userDefined){r=true}else{r=false}return this.createComplexCondition({operator:t.operator,conditions:e,attributeLabel:t.attributeLabel,valueLabel:t.valueLabel,userDefined:r})}parseConditionFromJson(t){switch(t.type){case Rt.Simple:return this.parseSimpleConditionFromJson(t);case Rt.Complex:return this.parseComplexConditionFromJson(t);default:throw new e.UnknownConditionTypeError(t.type)}}parseFilterFromJson(t){const r=this.parseConditionFromJson(t.rootCondition);if(r instanceof Pt){return this.createFilter({searchTerm:t?.searchTerm,rootCondition:r,dataSource:this.dataSourceFromJson(t.dataSource)})}else{throw new e.OnlyComplexConditionAllowedError}}parseNavigationTargetFromJson(t){return this.createNavigationTarget(t)}createStaticHierarchySearchNavigationTarget(t,e,r,a,i){if(!i){i=r.hierarchyAttribute;if(!i){const t=r.getHierarchyDataSource();if(t&&t.hierarchyAttribute){i=t.hierarchyAttribute}else{return null}}}const s=new Mt({dataSource:r,searchTerm:"",sina:this});if(t!=="$$ROOT$$"){const r=new Ht({attribute:i,operator:dt.DescendantOf,value:t,valueLabel:e});s.autoInsertCondition(r)}return this.createSearchNavigationTarget(s,a||"Children Folders")}getHierarchyDataSource(t){const e=this.dataSources;for(let r=0;r<e.length;++r){const a=e[r];if(a.type!==this.DataSourceType.BusinessObject){continue}if(!a.isHierarchyDataSource){continue}if(t===a.hierarchyName){return a}}}}var Fe={__esModule:true};Fe.Sina=be;return Fe});
//# sourceMappingURL=Sina.js.map