{"version":3,"file":"ItemParser-dbg.js","names":["sap","ui","define","____sina_SinaObject","util","typeConverter","____sina_AttributeType","___tools_WhyfoundProcessor","SinaObject","AttributeType","WhyfoundProcessor","ItemParser","provider","suvNavTargetResolver","constructor","sina","_createSuvNavTargetResolver","parse","searchQuery","data","ResultList","SearchResults","Promise","resolve","itemsData","results","parseItems","itemProms","i","length","itemData","itemProm","parseItem","push","all","j","allAttributes","titleAttributes","titleDescriptionAttributes","attributes","detailAttributes","semanticObjectTypeAttributes","fallbackDefaultNavigationTarget","dataSource","getDataSource","DataSourceId","attributeData","metadata","attribute","semanticObjectType","score","Number","Score","suvHighlightTerms","suvAttribute","suvAttributeName","suvUrlAttribute","suvMimeTypeAttribute","suvAttributes","whyFounds","whyFoundProcessor","Attributes","getAttributeMetadata","Id","_createSearchResultSetItemAttribute","id","label","value","odata2Sina","type","Value","valueFormatted","Timestamp","undefined","ValueFormatted","valueHighlighted","Snippet","isHighlighted","indexOf","groups","appendRemovingDuplicates","extractHighlightedTerms","suvThumbnailAttribute","suvTargetUrlAttribute","suvTargetMimeTypeAttribute","usage","Navigation","mainNavigation","createNavigationTarget","text","targetUrl","target","Detail","Title","TitleDescription","attributeMetadataMap","_private","name","descriptionAttribute","_isVisible","sort","a1","a2","displayOrder","resolveSuvNavTargets","searchResultSetItem","_createSearchResultSetItem","defaultNavigationTarget","navigationTargets","allAttributesMap","itemPostParser","_createItemPostParser","ungrouppedDetailAttributes","postResultSetItem","postParseResultSetItem","_pushAdditionalWhyFounds","processAdditionalWhyfoundAttributes","isDescription","Array","isArray","group","_isInTamplate","template","nameInTemplate","_getNameInGroup","includes","attributesInGroup","nameInGroup","HitAttributes","_isUngrouppedDetailAttribute","k","__exports","__esModule"],"sources":["ItemParser.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport { SinaObject } from \"../../sina/SinaObject\";\nimport * as util from \"../../core/util\";\nimport * as typeConverter from \"./typeConverter\";\nimport { AttributeType } from \"../../sina/AttributeType\";\nimport { SuvAttribute, SuvNavTargetResolver } from \"../tools/fiori/SuvNavTargetResolver\";\nimport { Provider, OdataEDMType } from \"./Provider\";\nimport { SearchResultSetItemAttributeBase } from \"../../sina/SearchResultSetItemAttributeBase\";\nimport { WhyfoundProcessor } from \"../tools/WhyfoundProcessor\";\nimport { SearchQuery } from \"../../sina/SearchQuery\";\nimport { SearchResultSetItem } from \"../../sina/SearchResultSetItem\";\n\n// import { ObjectSuggestion } from \"../../sina/ObjectSuggestion\";\n\nexport interface ABAPOdataSearchResponse {\n    DataSourceId: string;\n    Attributes: { results: Array<AttributesResult> };\n    HitAttributes: { results: Array<HitAttributesResult> };\n    Score: string;\n}\n\nexport interface AttributesResult {\n    Boosted: boolean;\n    Id: string;\n    Name: string;\n    Snippet: string;\n    Value: string;\n    ValueFormatted: string;\n}\nexport interface HitAttributesResult {\n    EDMType: OdataEDMType | \"\";\n    Id: string;\n    Name: string;\n    Snippet: string;\n}\n\nexport class ItemParser extends SinaObject {\n    provider: Provider;\n    suvNavTargetResolver: SuvNavTargetResolver;\n\n    constructor(provider: Provider) {\n        super();\n        this.provider = provider;\n        this.sina = provider.sina;\n        this.suvNavTargetResolver = this.sina._createSuvNavTargetResolver();\n    }\n\n    public parse(searchQuery: SearchQuery, data): Promise<Array<SearchResultSetItem>> {\n        if (data.ResultList.SearchResults === null) {\n            return Promise.resolve([]);\n        }\n        const itemsData = data.ResultList.SearchResults.results;\n        return this.parseItems(itemsData);\n    }\n\n    public parseItems(itemsData: Array<ABAPOdataSearchResponse>): Promise<Array<SearchResultSetItem>> {\n        const itemProms = [];\n        for (let i = 0; i < itemsData.length; ++i) {\n            const itemData = itemsData[i];\n            const itemProm = this.parseItem(itemData);\n            itemProms.push(itemProm);\n        }\n        return Promise.all(itemProms);\n    }\n\n    public async parseItem(itemData: ABAPOdataSearchResponse): Promise<SearchResultSetItem> {\n        let j;\n        const allAttributes = {}; // all server attributes (response attributes, hit attributes, ...)\n        const titleAttributes = [];\n        const titleDescriptionAttributes = [];\n        const attributes = [];\n        const detailAttributes = [];\n        const semanticObjectTypeAttributes = [];\n        let fallbackDefaultNavigationTarget;\n        const dataSource = this.sina.getDataSource(itemData.DataSourceId);\n        let attributeData, metadata, attribute, semanticObjectType;\n        const score = Number(itemData.Score) / 100;\n        const suvHighlightTerms = [];\n        let suvAttribute, suvAttributeName, suvUrlAttribute, suvMimeTypeAttribute;\n        const suvAttributes: { [key: string]: SuvAttribute } = {};\n        let whyFounds = {};\n\n        const whyFoundProcessor = new WhyfoundProcessor(this.sina);\n\n        for (j = 0; j < itemData.Attributes.results.length; j++) {\n            attributeData = itemData.Attributes.results[j];\n            metadata = dataSource.getAttributeMetadata(attributeData.Id);\n\n            attribute = this.sina._createSearchResultSetItemAttribute({\n                id: attributeData.Id,\n                label: metadata.label,\n                value: typeConverter.odata2Sina(metadata.type, attributeData.Value),\n                valueFormatted:\n                    metadata.type === AttributeType.Timestamp ? undefined : attributeData.ValueFormatted,\n                // Problem: Backend is not able to format timestamp value according to browser time zone.\n                // Solution: ignore server timestamp valueFomatted and format raw value in ResultValueFormatter\n                valueHighlighted: attributeData.Snippet,\n                isHighlighted:\n                    attributeData.Snippet.indexOf(\"<b>\") > -1 && attributeData.Snippet.indexOf(\"</b>\") > -1,\n                metadata: metadata,\n                groups: [],\n            });\n\n            // envalue valueFormatted in ResultValueFormatter.js\n            //attribute.valueFormatted = attributeData.ValueFormatted;\n            //attribute.valueHighlighted = attributeData.Snippet || attributeData.ValueFormatted;\n\n            allAttributes[attribute.id] = attribute;\n\n            // collect highlight terms needed for creation of suv viewer link\n            util.appendRemovingDuplicates(\n                suvHighlightTerms,\n                util.extractHighlightedTerms(attribute.valueHighlighted)\n            );\n\n            if (metadata.suvUrlAttribute && metadata.suvMimeTypeAttribute) {\n                suvUrlAttribute = allAttributes[metadata.suvUrlAttribute] || metadata.suvUrlAttribute.id;\n                suvMimeTypeAttribute =\n                    allAttributes[metadata.suvMimeTypeAttribute] || metadata.suvMimeTypeAttribute.id;\n                suvAttributes[attributeData.Id] = {\n                    suvThumbnailAttribute: attribute,\n                    suvTargetUrlAttribute: suvUrlAttribute,\n                    suvTargetMimeTypeAttribute: suvMimeTypeAttribute,\n                };\n            }\n\n            if (metadata.usage.Navigation) {\n                if (metadata.usage.Navigation.mainNavigation) {\n                    fallbackDefaultNavigationTarget = this.sina.createNavigationTarget({\n                        text: attribute.value,\n                        targetUrl: attribute.value,\n                        target: \"_blank\",\n                    });\n                }\n            }\n\n            attributes.push(attribute);\n            if (metadata.usage.Detail) {\n                detailAttributes.push(attribute);\n            }\n\n            if (metadata.usage.Title) {\n                titleAttributes.push(attribute);\n            }\n            if (metadata.usage.TitleDescription) {\n                titleDescriptionAttributes.push(attribute);\n            }\n\n            semanticObjectType = dataSource.attributeMetadataMap[attribute.id]._private.semanticObjectType;\n\n            if (semanticObjectType && semanticObjectType.length > 0) {\n                semanticObjectTypeAttributes.push({\n                    name: semanticObjectType,\n                    value: attribute.value,\n                    type: attribute.metadata.type,\n                });\n            }\n\n            // push response attributes (highlighted and not visible) to whyFounds\n            if (\n                attribute.isHighlighted ||\n                (attribute.descriptionAttribute && attribute.descriptionAttribute.isHighlighted)\n            ) {\n                if (!this._isVisible(metadata) && typeof whyFounds[attribute.id] === \"undefined\") {\n                    // this._isVisible means:\n                    // attribute is used as title or title description or detail, or\n                    // attribute is in Template of ancestor group attribute, that is used as title or title description or detail\n                    whyFounds[attribute.id] = [attribute.valueHighlighted];\n                }\n            }\n        }\n\n        for (suvAttributeName in suvAttributes) {\n            suvAttribute = suvAttributes[suvAttributeName];\n            if (typeof suvAttribute.suvTargetUrlAttribute === \"string\") {\n                suvAttribute.suvTargetUrlAttribute = allAttributes[suvAttribute.suvTargetUrlAttribute];\n            }\n            if (typeof suvAttribute.suvTargetMimeTypeAttribute === \"string\") {\n                suvAttribute.suvTargetMimeTypeAttribute =\n                    allAttributes[suvAttribute.suvTargetMimeTypeAttribute];\n            }\n            if (!(suvAttribute.suvTargetUrlAttribute || suvAttribute.suvTargetMimeTypeAttribute)) {\n                delete suvAttributes[suvAttributeName];\n            }\n        }\n\n        // sort attributes\n        titleAttributes.sort(function (a1, a2) {\n            return a1.metadata.usage.Title.displayOrder - a2.metadata.usage.Title.displayOrder;\n        });\n\n        detailAttributes.sort(function (a1, a2) {\n            return a1.metadata.usage.Detail.displayOrder - a2.metadata.usage.Detail.displayOrder;\n        });\n\n        this.suvNavTargetResolver.resolveSuvNavTargets(dataSource, suvAttributes, suvHighlightTerms);\n\n        const searchResultSetItem = this.sina._createSearchResultSetItem({\n            dataSource: dataSource,\n            attributes: attributes,\n            titleAttributes: titleAttributes,\n            titleDescriptionAttributes: titleDescriptionAttributes,\n            detailAttributes: detailAttributes,\n            defaultNavigationTarget: fallbackDefaultNavigationTarget,\n            navigationTargets: [],\n            score: score,\n        });\n        searchResultSetItem._private.allAttributesMap = allAttributes;\n        searchResultSetItem._private.semanticObjectTypeAttributes = semanticObjectTypeAttributes;\n\n        const itemPostParser = this.sina._createItemPostParser({\n            searchResultSetItem: searchResultSetItem,\n        });\n\n        const ungrouppedDetailAttributes = searchResultSetItem.detailAttributes;\n        const postResultSetItem = await itemPostParser.postParseResultSetItem();\n        whyFounds = this._pushAdditionalWhyFounds(itemData, whyFounds, ungrouppedDetailAttributes); // push request attributes (highlighted and not visible) to whyFounds\n        return await whyFoundProcessor.processAdditionalWhyfoundAttributes(whyFounds, postResultSetItem);\n    }\n\n    // check single attribute is visible (stand-alone or in group attribute)\n    _isVisible(metadata): boolean {\n        if (\n            typeof metadata.usage.Title !== \"undefined\" ||\n            typeof metadata.usage.Detail !== \"undefined\" ||\n            typeof metadata.isDescription !== \"undefined\"\n        ) {\n            return true;\n        }\n\n        if (Array.isArray(metadata.groups)) {\n            // const isVisible = false;\n            for (let i = 0; i < metadata.groups.length; i++) {\n                const group = metadata.groups[i].group;\n                if (this._isVisible(group) && this._isInTamplate(metadata.id, group)) {\n                    return true;\n                }\n            }\n            return false;\n        }\n\n        return false;\n    }\n\n    // check child attribute in template of group attribute\n    _isInTamplate(id, group): boolean {\n        if (group.template && group.attributes && group.attributes.length > 0) {\n            const nameInTemplate = this._getNameInGroup(id, group.attributes);\n            if (nameInTemplate && group.template.includes(\"{\" + nameInTemplate + \"}\")) {\n                return true;\n            }\n        }\n        return false;\n    }\n\n    // get child attribute's alias name used in template of group attribute\n    // eslint-disable-next-line\n    _getNameInGroup(id: string, attributesInGroup: any): string | undefined {\n        for (let i = 0; i < attributesInGroup.length; i++) {\n            if (attributesInGroup[i].attribute.id === id) {\n                return attributesInGroup[i].nameInGroup;\n            }\n        }\n        return undefined;\n    }\n\n    // push highlighted request attribute\n\n    private _pushAdditionalWhyFounds(\n        itemData: ABAPOdataSearchResponse,\n        whyFounds: Record<string, Array<string>>,\n        ungrouppedDetailAttributes: Array<SearchResultSetItemAttributeBase>\n    ): Record<string, Array<string>> {\n        if (itemData.HitAttributes && Array.isArray(itemData.HitAttributes.results)) {\n            for (let i = 0; i < itemData.HitAttributes.results.length; i++) {\n                const attributeData = itemData.HitAttributes.results[i];\n                if (\n                    typeof whyFounds[attributeData.Id] === \"undefined\" &&\n                    !this._isUngrouppedDetailAttribute(attributeData.Id, ungrouppedDetailAttributes)\n                ) {\n                    // avoid duplicated whyfounds:\n                    // attribute is a response attribute + highlighted + visible\n                    // and it is a request attribute + highlighted (hitAttribute)\n                    whyFounds[attributeData.Id] = [attributeData.Snippet];\n                }\n            }\n        }\n        return whyFounds;\n    }\n\n    // check attribute (hitAttribue) has been already in ungroupped detail attribute set\n    // eslint-disable-next-line\n    _isUngrouppedDetailAttribute(id: string, ungrouppedDetailAttributes: Array<any>): boolean {\n        for (let k = 0; k < ungrouppedDetailAttributes.length; k++) {\n            if (id === ungrouppedDetailAttributes[k].id) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\n"],"mappings":"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","ignoreList":[]}