{"version":3,"file":"ajax.js","names":["sap","ui","define","____core_AjaxClient","___ajaxErrorFactory","___ajaxTemplates","____core_defaultAjaxErrorFactory","AjaxClient","ajaxErrorFactory","isSearchRequest","isChartRequest","isValueHelperRequest","isSuggestionRequest","isObjectSuggestionRequest","isNavigationEvent","createDefaultAjaxErrorFactory","_removeActAsQueryPart","node","SubFilters","undefined","ActAsQueryPart","i","length","this","createAjaxClient","properties","defaults","csrf","errorFactories","errorFormatters","requestNormalization","payload","NotToRecord","d","QueryOptions","ClientSessionID","ClientCallTimestamp","ClientServiceName","ClientLastExecutionID","payloadString","JSON","stringify","headString","endString","headIndex","indexOf","endIndex","substring","insertedString","slice","join","parse","Filter","Object","assign","client","__exports","__esModule"],"sources":["ajax.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport { AjaxClientProperties } from \"../../core/AjaxClient\";\nimport { AjaxClient } from \"../../core/AjaxClient\";\nimport { ajaxErrorFactory } from \"./ajaxErrorFactory\";\nimport {\n    isSearchRequest,\n    searchRequest,\n    isChartRequest,\n    chartRequest,\n    isValueHelperRequest,\n    valueHelperRequest,\n    isSuggestionRequest,\n    suggestionRequest,\n    isObjectSuggestionRequest,\n    objectSuggestionRequest,\n    isNavigationEvent,\n    InavigationEvent,\n} from \"./ajaxTemplates\";\nimport { createDefaultAjaxErrorFactory } from \"../../core/defaultAjaxErrorFactory\";\n\nconst _removeActAsQueryPart = function (node) {\n    if (node.SubFilters !== undefined) {\n        // not a leaf\n        delete node.ActAsQueryPart;\n        for (let i = 0; i < node.SubFilters.length; i++) {\n            this._removeActAsQueryPart(node.SubFilters[i]);\n        }\n    }\n};\n\nexport function createAjaxClient(properties?: AjaxClientProperties): AjaxClient {\n    const defaults: AjaxClientProperties = {\n        csrf: true,\n        errorFactories: [ajaxErrorFactory, createDefaultAjaxErrorFactory()],\n        errorFormatters: [],\n        requestNormalization: function (\n            payload:\n                | typeof searchRequest\n                | typeof chartRequest\n                | typeof valueHelperRequest\n                | typeof suggestionRequest\n                | typeof objectSuggestionRequest\n                | InavigationEvent\n        ) {\n            if (payload === null) {\n                return \"\";\n            }\n            if (isNavigationEvent(payload)) {\n                return {\n                    NotToRecord: true,\n                };\n            }\n            if (\n                isSearchRequest(payload) ||\n                isChartRequest(payload) ||\n                isValueHelperRequest(payload) ||\n                isSuggestionRequest(payload) ||\n                isObjectSuggestionRequest(payload)\n            ) {\n                delete payload.d.QueryOptions.ClientSessionID;\n                delete payload.d.QueryOptions.ClientCallTimestamp;\n                delete payload.d.QueryOptions.ClientServiceName;\n                delete payload.d.QueryOptions.ClientLastExecutionID;\n\n                // insert \"ExcludedDataSources\" in payload\n                // properties' ordering is important in stringified payload\n                // \"ExcludedDataSources\" should follow \"DataSources\"\n                // find \"DataSources\":[...], and insert \"ExcludedDataSources\" after\n                let payloadString = JSON.stringify(payload); // object -> string\n\n                const headString = '\"DataSources\":[';\n\n                const endString = \"]\";\n                const headIndex = payloadString.indexOf(headString);\n                const endIndex =\n                    headIndex + payloadString.substring(headIndex).indexOf(endString) + endString.length;\n\n                const insertedString = ',\"ExcludedDataSources\":[]';\n                payloadString = [\n                    payloadString.slice(0, endIndex),\n                    insertedString,\n                    payloadString.slice(endIndex),\n                ].join(\"\");\n                payload = JSON.parse(payloadString); // string -> object\n                if (\n                    (\n                        payload as\n                            | typeof searchRequest\n                            | typeof chartRequest\n                            | typeof valueHelperRequest\n                            | typeof suggestionRequest\n                            | typeof objectSuggestionRequest\n                    ).d.Filter &&\n                    (isSearchRequest(payload) ||\n                        isChartRequest(payload) ||\n                        isValueHelperRequest(payload) ||\n                        isSuggestionRequest(payload) ||\n                        isObjectSuggestionRequest(payload))\n                ) {\n                    _removeActAsQueryPart(payload.d.Filter);\n                }\n            }\n            return payload;\n        },\n        //csrfByPassCache: true\n    };\n    properties = Object.assign({}, defaults, properties);\n\n    const client = new AjaxClient(properties);\n    return client;\n}\n"],"mappings":";;;;;AAAAA,IAAAC,GAAAC,OAAA,+GAAAC,EAAAC,EAAAC,EAAAC,GAAA,mBAMSC,EAAUJ,EAAA,oBACVK,EAAgBJ,EAAA,0BAErBK,EAAeJ,EAAA,yBAEfK,EAAcL,EAAA,wBAEdM,EAAoBN,EAAA,8BAEpBO,EAAmBP,EAAA,6BAEnBQ,EAAyBR,EAAA,mCAEzBS,EAAiBT,EAAA,2BAGZU,EAA6BT,EAAA,iCAEtC,MAAMU,EAAwB,SAAUC,GACpC,GAAIA,EAAKC,aAAeC,UAAW,QAExBF,EAAKG,eACZ,IAAK,IAAIC,EAAI,EAAGA,EAAIJ,EAAKC,WAAWI,OAAQD,IAAK,CAC7CE,KAAKP,sBAAsBC,EAAKC,WAAWG,GAC/C,CACJ,CACJ,EAEO,SAASG,EAAiBC,GAC7B,MAAMC,EAAiC,CACnCC,KAAM,KACNC,eAAgB,CAACpB,EAAkBO,KACnCc,gBAAiB,GACjBC,qBAAsB,SAClBC,GAQA,GAAIA,IAAY,KAAM,CAClB,MAAO,EACX,CACA,GAAIjB,EAAkBiB,GAAU,CAC5B,MAAO,CACHC,YAAa,KAErB,CACA,GACIvB,EAAgBsB,IAChBrB,EAAeqB,IACfpB,EAAqBoB,IACrBnB,EAAoBmB,IACpBlB,EAA0BkB,GAC5B,QACSA,EAAQE,EAAEC,aAAaC,uBACvBJ,EAAQE,EAAEC,aAAaE,2BACvBL,EAAQE,EAAEC,aAAaG,yBACvBN,EAAQE,EAAEC,aAAaI,sBAM9B,IAAIC,EAAgBC,KAAKC,UAAUV,GAEnC,MAAMW,EAAa,kBAEnB,MAAMC,EAAY,IAClB,MAAMC,EAAYL,EAAcM,QAAQH,GACxC,MAAMI,EACFF,EAAYL,EAAcQ,UAAUH,GAAWC,QAAQF,GAAaA,EAAUrB,OAElF,MAAM0B,EAAiB,4BACvBT,EAAgB,CACZA,EAAcU,MAAM,EAAGH,GACvBE,EACAT,EAAcU,MAAMH,IACtBI,KAAK,IACPnB,EAAUS,KAAKW,MAAMZ,GACrB,GAEQR,EAMFE,EAAEmB,SACH3C,EAAgBsB,IACbrB,EAAeqB,IACfpB,EAAqBoB,IACrBnB,EAAoBmB,IACpBlB,EAA0BkB,IAChC,CACEf,EAAsBe,EAAQE,EAAEmB,OACpC,CACJ,CACA,OAAOrB,CACX,GAGJN,EAAa4B,OAAOC,OAAO,CAAC,EAAG5B,EAAUD,GAEzC,MAAM8B,EAAS,IAAIhD,EAAWkB,GAC9B,OAAO8B,CACX,CAAC,IAAAC,EAAA,CAAAC,WAAA,MAAAD,EAAAhC,mBAAA,OAAAgC,CAAA","ignoreList":[]}