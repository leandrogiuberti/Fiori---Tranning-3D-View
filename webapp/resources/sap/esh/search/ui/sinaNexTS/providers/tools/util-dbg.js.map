{"version":3,"file":"util-dbg.js","names":["sap","ui","define","____core_Log","Log","handleError","fetcher","parser","doHandleError","error","serverError","name","response","dataJSON","resultSet","addError","parseError","log","warn","e","__exports","__esModule"],"sources":["util.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport { ServerError } from \"../../core/errors\";\nimport { Log } from \"../../core/Log\";\nimport { ResultSet } from \"../../sina/ResultSet\";\n\ntype Fetcher<ResponseType> = () => Promise<ResponseType>;\ntype Parser<ResultSetType extends ResultSet, ResponseType> = (\n    response: ResponseType\n) => Promise<ResultSetType>;\n\nexport async function handleError<ResultSetType extends ResultSet, ResponseDataType>(\n    fetcher: Fetcher<ResponseDataType>,\n    parser: Parser<ResultSetType, ResponseDataType>\n): Promise<ResultSetType> {\n    //\n    async function doHandleError(error: Error): Promise<ResultSetType> {\n        let serverError: ServerError;\n        switch (error.name) {\n            case \"ServerError\":\n                serverError = error as ServerError;\n                if (!serverError.response.dataJSON) {\n                    throw error;\n                }\n                try {\n                    const resultSet = await parser(serverError.response.dataJSON as ResponseDataType);\n                    resultSet.addError(error);\n                    return resultSet;\n                } catch (parseError) {\n                    const log = new Log(\"error handle util\");\n                    log.warn(\"Error while parsing error response: \" + parseError);\n                    throw error;\n                }\n            default:\n                throw error;\n        }\n    }\n    let response: ResponseDataType;\n    try {\n        response = await fetcher();\n    } catch (e) {\n        return await doHandleError(e);\n    }\n    return await parser(response);\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AAJAA,GAAA,CAAAC,EAAA,CAAAC,MAAA,+BAAAC,YAAA;EAAA;;EAAA,MAMSC,GAAG,GAAAD,YAAA;EAQL,eAAeE,WAAWA,CAC7BC,OAAkC,EAClCC,MAA+C,EACzB;IACtB;IACA,eAAeC,aAAaA,CAACC,KAAY,EAA0B;MAC/D,IAAIC,WAAwB;MAC5B,QAAQD,KAAK,CAACE,IAAI;QACd,KAAK,aAAa;UACdD,WAAW,GAAGD,KAAoB;UAClC,IAAI,CAACC,WAAW,CAACE,QAAQ,CAACC,QAAQ,EAAE;YAChC,MAAMJ,KAAK;UACf;UACA,IAAI;YACA,MAAMK,SAAS,GAAG,MAAMP,MAAM,CAACG,WAAW,CAACE,QAAQ,CAACC,QAA4B,CAAC;YACjFC,SAAS,CAACC,QAAQ,CAACN,KAAK,CAAC;YACzB,OAAOK,SAAS;UACpB,CAAC,CAAC,OAAOE,UAAU,EAAE;YACjB,MAAMC,GAAG,GAAG,IAAIb,GAAG,CAAC,mBAAmB,CAAC;YACxCa,GAAG,CAACC,IAAI,CAAC,sCAAsC,GAAGF,UAAU,CAAC;YAC7D,MAAMP,KAAK;UACf;QACJ;UACI,MAAMA,KAAK;MACnB;IACJ;IACA,IAAIG,QAA0B;IAC9B,IAAI;MACAA,QAAQ,GAAG,MAAMN,OAAO,CAAC,CAAC;IAC9B,CAAC,CAAC,OAAOa,CAAC,EAAE;MACR,OAAO,MAAMX,aAAa,CAACW,CAAC,CAAC;IACjC;IACA,OAAO,MAAMZ,MAAM,CAACK,QAAQ,CAAC;EACjC;EAAC,IAAAQ,SAAA;IAAAC,UAAA;EAAA;EAAAD,SAAA,CAAAf,WAAA,GAAAA,WAAA;EAAA,OAAAe,SAAA;AAAA","ignoreList":[]}