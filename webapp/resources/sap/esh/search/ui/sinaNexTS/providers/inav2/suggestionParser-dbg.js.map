{"version":3,"file":"suggestionParser-dbg.js","names":["sap","ui","define","____sina_SuggestionCalculationMode","pivotTableParser","SuggestionCalculationMode","SuggestionParser","provider","sina","constructor","parseSuggestions","query","data","parse","suggestions","suggestion","parentSuggestion","i","cells","length","cell","$$Attribute$$","$$Term$$","Scope","$$DataSource$$","parseSearchTermSuggestion","parseSearchTermAndDataSourceSuggestion","filter","dataSource","childSuggestions","push","parseDataSourceSuggestion","getDataSource","Value","clone","setDataSource","_createDataSourceSuggestion","calculationMode","Data","label","ValueFormatted","parseCalculationMode","setSearchTerm","_createSearchTermSuggestion","searchTerm","_createSearchTermAndDataSourceSuggestion","scope","History","suggestionQuery","suggestionParser","__exports","__esModule"],"sources":["suggestionParser.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport { Sina } from \"../../sina/Sina\";\nimport { SuggestionCalculationMode } from \"../../sina/SuggestionCalculationMode\";\nimport { Provider } from \"./Provider\";\nimport * as pivotTableParser from \"./pivotTableParser\";\n\nclass SuggestionParser {\n    provider: Provider;\n    sina: Sina;\n\n    constructor(provider) {\n        this.provider = provider;\n        this.sina = provider.sina;\n    }\n\n    parseSuggestions(query, data) {\n        data = pivotTableParser.parse(data);\n        const suggestions = [];\n        let suggestion;\n        let parentSuggestion;\n\n        for (let i = 0; i < data.cells.length; i++) {\n            suggestion = null;\n            const cell = data.cells[i];\n            if (cell.$$Attribute$$ !== \"$$AllAttributes$$\") {\n                continue;\n            }\n            switch (cell.$$Term$$.Scope) {\n                case \"SearchHistory\":\n                    if (cell.$$DataSource$$ === \"$$AllDataSources$$\") {\n                        suggestion = this.parseSearchTermSuggestion(query, cell);\n                    }\n                    break;\n                case \"ObjectData\":\n                    if (cell.$$DataSource$$ === \"$$AllDataSources$$\") {\n                        suggestion = this.parseSearchTermSuggestion(query, cell);\n                        parentSuggestion = suggestion;\n                    } else {\n                        suggestion = this.parseSearchTermAndDataSourceSuggestion(query, cell);\n                        if (\n                            suggestion &&\n                            suggestion.filter.dataSource !== parentSuggestion.filter.dataSource\n                        ) {\n                            parentSuggestion.childSuggestions.push(suggestion);\n                        }\n                        suggestion = null;\n                    }\n                    break;\n                case \"DataSources\":\n                    if (cell.$$DataSource$$ === \"$$AllDataSources$$\") {\n                        suggestion = this.parseDataSourceSuggestion(query, cell);\n                    }\n                    break;\n            }\n            if (suggestion) {\n                suggestions.push(suggestion);\n            }\n        }\n        return suggestions;\n    }\n\n    parseDataSourceSuggestion(query, cell) {\n        const dataSource = this.sina.getDataSource(cell.$$Term$$.Value);\n        if (!dataSource) {\n            return null;\n        }\n        const filter = query.filter.clone();\n        filter.setDataSource(dataSource);\n        return this.sina._createDataSourceSuggestion({\n            calculationMode: SuggestionCalculationMode.Data,\n            dataSource: dataSource,\n            label: cell.$$Term$$.ValueFormatted,\n        });\n    }\n\n    parseSearchTermSuggestion(query, cell) {\n        const calculationMode = this.parseCalculationMode(cell.$$Term$$.Scope);\n        const filter = query.filter.clone();\n        filter.setSearchTerm(cell.$$Term$$.Value);\n        return this.sina._createSearchTermSuggestion({\n            searchTerm: cell.$$Term$$.Value,\n            calculationMode: calculationMode,\n            filter: filter,\n            label: cell.$$Term$$.ValueFormatted,\n        });\n    }\n\n    parseSearchTermAndDataSourceSuggestion(query, cell) {\n        const calculationMode = this.parseCalculationMode(cell.$$Term$$.Scope);\n        const filter = query.filter.clone();\n        filter.setSearchTerm(cell.$$Term$$.Value);\n        const dataSource = this.sina.getDataSource(cell.$$DataSource$$);\n        if (!dataSource) {\n            return null;\n        }\n        filter.setDataSource(dataSource);\n        return this.sina._createSearchTermAndDataSourceSuggestion({\n            searchTerm: cell.$$Term$$.Value,\n            dataSource: dataSource,\n            calculationMode: calculationMode,\n            filter: filter,\n            label: cell.$$Term$$.ValueFormatted,\n        });\n    }\n\n    parseCalculationMode(scope) {\n        switch (scope) {\n            case \"SearchHistory\":\n                return SuggestionCalculationMode.History;\n            case \"ObjectData\":\n                return SuggestionCalculationMode.Data;\n        }\n    }\n}\n\nexport function parse(provider, suggestionQuery, data) {\n    const suggestionParser = new SuggestionParser(provider);\n    return suggestionParser.parseSuggestions(suggestionQuery, data);\n}\n"],"mappings":"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","ignoreList":[]}