/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["./definitions"],function(e){"use strict";
/** Copyright 2019 SAP SE or an SAP affiliate company. All rights reserved. */const t=e["Term"];const a=e["Phrase"];const r=e["Expression"];const s=e["SearchQueryLogicalOperator"];const o=e["CustomFunction"];const i=e["FilterFunction"];const n=e["LogicalOperator"];const c=e["SEARCH_DEFAULTS"];const f=e["escapeQuery"];var p=function(e){e[e["Term"]=0]="Term";e[e["Phrase"]=1]="Phrase";return e}(p||{});const u=(e={})=>{if(e.metadataCall){let t=e.resourcePath?e.resourcePath:"/$metadata";if(e.metadataObjects){if(e.metadataObjects.entitySets){t+="/EntitySets("+e.metadataObjects.entitySets+")"}else{if(e.metadataObjects.format){t+="?$format="+e.metadataObjects.format}if(e.metadataObjects.collectionReference){t+="#"+e.metadataObjects.collectionReference}if(e.metadataObjects.contextEntitySet&&e.metadataObjects.primitiveTyp){t+="#"+e.metadataObjects.contextEntitySet+"("+e.metadataObjects.primitiveTyp+")"}else if(e.metadataObjects.contextEntitySet){t+="#"+e.metadataObjects.contextEntitySet}else if(e.metadataObjects.primitiveTyp){t+="#"+e.metadataObjects.primitiveTyp}}}return{path:t,parameters:{}}}let t="/$all";if(e.resourcePath){t=e.resourcePath}if(e?.suggestTerm){t+=`/${encodeURIComponent("GetSuggestion(term='"+e.suggestTerm.replace(/'/g,"''")+"')")}`}if(e.eshParameters){const a=[];for(const t of Object.keys(e.eshParameters)){a.push(t+"='"+encodeURIComponent(e.eshParameters[t])+"'")}if(a.length>0){t+="("+a.join(",")+")"}}const a=new r({operator:n.and,items:[]});if(!e){e={query:c.query,scope:c.scope,$select:[],facets:[]}}else{if(!e.query){e.query=c.query}if(!e.$select){e.$select=[]}if(!e.facets){e.facets=[]}}if(e.oDataFilter){a.items.push(e.oDataFilter)}if(a.items.length>0){e.oDataFilter=a}const s=t;let p=e.scope?"SCOPE:"+e.scope:"";if(e.searchQueryFilter){const t=e.searchQueryFilter.toStatement().trim();if(t.length>0){if(p!==""){p+=" "}p+=t}}if(e.freeStyleText){if(p!==""){p+=" "}const t=m(e.freeStyleText);p+=t.toStatement()}if(e.query&&e.query!==""){if(p!==""){p+=" "}p+=f(e.query)}const u={};for(const t of Object.keys(e)){switch(t){case"query":if(e.$apply){break}let a=p===""?"":"filter(Search.search(query='"+p+"')";if(e.oDataFilter&&e.oDataFilter.items.length>0){a+=" and "+e.oDataFilter.toStatement()}if(p!==""){a+=")"}if(e.groupby&&e.groupby.properties&&e.groupby.properties.length>0){a+=`/groupby((${e.groupby.properties.join(",")})`;if(e.groupby.aggregateCountAlias&&e.groupby.aggregateCountAlias!==""){a+=`,aggregate($count as ${e.groupby.aggregateCountAlias})`}a+=")"}if(a!==""){u.$apply=a}break;case"$orderby":if(e.$orderby&&e.$orderby.length>0){u.$orderby=e.$orderby.map(e=>e.order?`${e.key} ${e.order}`:e.key).join(",")}break;case"facets":if(e.facets&&e.facets.length>0){u[t]=e.facets.join(",")}break;case"$select":if(e.$select&&e.$select.length>0){u[t]=e.$select.join(",")}break;case"facetroot":if(e.facetroot&&e.facetroot.length>0){u.facetroot=e.facetroot.map(e=>e.toStatement()).join(",")}break;case"$top":case"$skip":case"$count":case"whyfound":case"estimate":case"wherefound":case"facetlimit":case"valuehierarchy":case"filteredgroupby":u[t]=e[t];break;case"dynamicview":if(e.dynamicview){u[t]=e.dynamicview.map(e=>e.toStatement()).join(" ")}break;case"$apply":if(e[t]instanceof o||e[t]instanceof i){let a=e[t].toStatement();if(e.groupby&&e.groupby.properties&&e.groupby.properties.length>0){a+=`/groupby((${e.groupby.properties.join(",")})`;if(e.groupby.aggregateCountAlias&&e.groupby.aggregateCountAlias!==""){a+=`,aggregate($count as ${e.groupby.aggregateCountAlias})`}a+=")"}u[t]=a}break;default:break}}return{path:s,parameters:u}};const l=e=>{const t=u(e);const a=Object.keys(t.parameters).map(function(e){return encodeURIComponent(e)+"="+encodeURIComponent(t.parameters[e])}).join("&");if(a&&a!==""){return`${t.path}?${a}`}return t.path};const m=e=>{const o=[];let i="";let n=p.Term;for(let r=0;r<e.length;r++){const s=e[r];if(s==='"'){if(n==p.Term){if(e.substring(r+1).indexOf('"')>=0){o.push(new t({term:i.trim()}));n=p.Phrase;i=""}else{o.push(new t({term:(i+e.substring(r)).trim()}));i="";break}}else{o.push(new a({phrase:i}));n=p.Term;i=""}}else{i+=e[r]}}if(i.length>0){o.push(new t({term:i.trim()}))}return new r({operator:s.TIGHT_AND,items:o})};var g={__esModule:true};g.createEshSearchQuery=u;g.getEshSearchQuery=l;g.parseFreeStyleText=m;return g});
//# sourceMappingURL=utils.js.map