{"version":3,"file":"Provider-dbg.js","names":["sap","ui","define","____core_errors","____core_util","____sina_ComparisonOperator","____sina_ComplexCondition","____sina_SearchQuery","____sina_SearchResultSetItemAttribute","____sina_SimpleCondition","____sina_UserCategoryDataSource","___AbstractProvider","___template","___template2","ForcedBySearchTermTestError","NotImplementedError","escapeRegExp","ComparisonOperator","ComplexCondition","SearchQuery","SearchResultSetItemAttribute","SimpleCondition","UserCategoryDataSource","AbstractProvider","template","template2","Provider","dataSourceIds","All","Urban_Legends","Folklorists","Publications","Scientists","Mysterious_Sightings","id","searchQuery","templateProvider","constructor","initAsync","properties","sina","document","location","href","indexOf","demoRoot","_init","res","Promise","resolve","capabilities","_createCapabilities","fuzzy","getSuggestionList","templateData","listAsString","_stringify","regexp","RegExp","matches","match","map","m","replace","singleWords","toString","split","concat","filter","item","pos","o","cache","s","JSON","stringify","key","value","undefined","push","applyFilters","items","newItemsArray","rootCondition","conditions","length","dataSource","subDataSources","find","subDataSource","toBeDimensionValuePairsArray","toBeDimensionsArray","condition","attribute","operator","fits","g","h","i","fitsArray","j","k","detailAttributes","detailAttribute","checkFilterValueMatch","titleAttributes","titleAttribute","fitsArray2","uniqueDimensionsArray","n","dimension","p","itemValue","filterValue","filterOperator","Co","toLowerCase","includes","Eq","Ne","Gt","Ge","Lt","Le","adjustHighlights","searchTerm","attrMetadataType","neverFound","titleHighlighted","addHighlight","title","detailAttr","metadata","type","valueHighlighted","valueFormatted","titleAttr","hText","pos1","pos2","newHText","substring","addSuvLinkToSearchResultItem","searchResultItem","suvPath","searchTermsArray","suvNavTargetResolver","_createSuvNavTargetResolver","suvAttributes","obj","suvThumbnailAttribute","suvTargetMimeTypeAttribute","suvTargetUrlAttribute","resolveSuvNavTargets","executeSearchQuery","resultSet","itemsRoot","items1","searchResultSetItemArray","items2","searchResultSetItemArray2","itemsAll","items3","searchResultSetItemArray3","dataSourceId","dataSourceType","facets1","generateFacets","forcedBySearchTerm","_createSearchResultSet","facets","query","totalCount","DataSourceType","UserCategory","forEach","measureValue","measureValueFormatted","totalCount1","totalCount2","totalCount3","finalItems","skip","top","executeHierarchyQuery","executeSuggestionQuery","searchAbleItems","suggestionTerms","suggestionsMatchingSearchterm","suggestions","createSuggestionItem","term","calculationMode","SuggestionCalculationMode","Data","clone","setSearchTerm","_createSearchTermSuggestion","label","_createSuggestionResultSet","executeChartQuery","chartResultSetItems","whichChart","getChartResultSetItemsForLocations","resultSetItemsArray","locations","chartResultSetItem","attrs","_createChartResultSetItem","filterCondition","createSimpleCondition","attributeLabel","dimensionValueFormatted","getChartResultSetItemsForPublications","publication","publications","getSientistOrFolkloristFacet","scientisOrFolklorist","scientisOrFolklorists","getTopFacetOnly","allDataSource","dataSourceItems","_createDataSourceResultSetItem","dataSources","labelPlural","dataSourceFacets","_createDataSourceResultSet","facetTotalCount","calculateFacets","chartResultSetArray","chartResultSet","gen","createFilter","_createChartResultSet","createChartQuery","info","charAt","toUpperCase","slice","__exports","__esModule"],"sources":["Provider.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport { ForcedBySearchTermTestError, NotImplementedError } from \"../../core/errors\";\nimport { escapeRegExp } from \"../../core/util\";\nimport { Capabilities } from \"../../sina/Capabilities\";\nimport { ChartQuery } from \"../../sina/ChartQuery\";\nimport { ChartResultSet } from \"../../sina/ChartResultSet\";\nimport { ComparisonOperator } from \"../../sina/ComparisonOperator\";\nimport { ComplexCondition } from \"../../sina/ComplexCondition\";\nimport { FacetResultSet } from \"../../sina/FacetResultSet\";\nimport { HierarchyQuery } from \"../../sina/HierarchyQuery\";\nimport { HierarchyResultSet } from \"../../sina/HierarchyResultSet\";\nimport { SearchQuery } from \"../../sina/SearchQuery\";\nimport { SearchResultSet } from \"../../sina/SearchResultSet\";\nimport { SearchResultSetItem } from \"../../sina/SearchResultSetItem\";\nimport { SearchResultSetItemAttribute } from \"../../sina/SearchResultSetItemAttribute\";\nimport { SimpleCondition } from \"../../sina/SimpleCondition\";\nimport { Sina } from \"../../sina/Sina\";\nimport { SuggestionQuery } from \"../../sina/SuggestionQuery\";\nimport { SuggestionResultSet } from \"../../sina/SuggestionResultSet\";\nimport { UserCategoryDataSource } from \"../../sina/UserCategoryDataSource\";\nimport { AbstractProvider } from \"../AbstractProvider\";\nimport { SuvAttribute } from \"../tools/fiori/SuvNavTargetResolver\";\nimport { ITemplate } from \"./ITemplate\";\nimport { createTemplate as template } from \"./template\";\nimport { createTemplate as template2 } from \"./template2\";\n\ntype ValueType =\n    | unknown\n    | Date\n    | number\n    | {\n          type: string;\n          value: string;\n      };\n\nexport class Provider extends AbstractProvider {\n    static readonly dataSourceIds = {\n        All: \"All\",\n        Urban_Legends: \"Urban_Legends\",\n        Folklorists: \"Folklorists\",\n        Publications: \"Publications\",\n        Scientists: \"Scientists\",\n        Mysterious_Sightings: \"Mysterious_Sightings\",\n    };\n    readonly id: string;\n    searchQuery: SearchQuery;\n    templateProvider: (oContext: Provider) => ITemplate;\n\n    constructor() {\n        super();\n        this.id = \"sample\";\n    }\n\n    async initAsync(properties: { sina: Sina }): Promise<{ capabilities: Capabilities }> {\n        this.sina = properties.sina;\n        this.templateProvider = template; // the newer template, folklorists\n        if (document.location.href.indexOf(\"use=sample1\") > 0) {\n            this.templateProvider = template2; // the original template, scientists\n        }\n        const demoRoot: ITemplate = this.templateProvider(this);\n        demoRoot._init(demoRoot);\n        const res = Promise.resolve({\n            capabilities: this.sina._createCapabilities({\n                fuzzy: false,\n            }),\n        });\n\n        return res;\n    }\n\n    private getSuggestionList(templateData) {\n        const listAsString = this._stringify(templateData);\n        /* eslint no-useless-escape:0 */\n        const regexp = new RegExp('\"valueFormatted\":\"([^{/]+?)\",\"valueHighlighted', \"g\");\n        let matches = listAsString.match(regexp).map((m) => m.replace(regexp, \"$1\"));\n        const singleWords = matches.toString().split(/\\W/);\n        matches = matches.concat(singleWords);\n        // remove duplicates\n        matches = matches.filter(function (item, pos) {\n            if (item !== \"\") {\n                return matches.indexOf(item) == pos;\n            }\n        });\n        return matches;\n    }\n\n    private _stringify(o): string {\n        let cache = [];\n        const s = JSON.stringify(o, function (key, value) {\n            if (typeof value === \"object\" && value !== null) {\n                if (cache.indexOf(value) !== -1) {\n                    // circular reference found, discard key\n                    return undefined;\n                }\n                // Store value in our collection\n                cache.push(value);\n            }\n            return value;\n        });\n        cache = null; // enable garbage collection\n        return s;\n    }\n\n    private applyFilters(\n        items: Array<SearchResultSetItem>,\n        searchQuery: SearchQuery\n    ): Array<SearchResultSetItem> {\n        const newItemsArray = [];\n        if (searchQuery.filter.rootCondition instanceof SimpleCondition) {\n            // quick select data source, nothing to do here\n        } else {\n            if (\n                (searchQuery.filter.rootCondition as ComplexCondition).conditions.length === 0 ||\n                (searchQuery.filter.rootCondition as ComplexCondition).conditions[0] instanceof\n                    SimpleCondition ||\n                ((searchQuery.filter.rootCondition as ComplexCondition).conditions[0] instanceof\n                    ComplexCondition &&\n                    ((searchQuery.filter.rootCondition as ComplexCondition).conditions[0] as ComplexCondition)\n                        .conditions.length === 0)\n            ) {\n                // return only items whose dataSource Id is included in subDataSources\n                if (searchQuery.filter.dataSource instanceof UserCategoryDataSource) {\n                    const subDataSources = (searchQuery.filter.dataSource as UserCategoryDataSource)\n                        .subDataSources;\n                    if (subDataSources) {\n                        return items.filter((item) =>\n                            subDataSources.find((subDataSource) => subDataSource.id === item.dataSource.id)\n                        );\n                    }\n                } /* else if (\"quick select data source\") {\n                     ToDo\n                } */\n                return items;\n            }\n        }\n\n        interface filterDataSimple {\n            attribute: string;\n            operator: ComparisonOperator;\n            value: ValueType;\n            fits: boolean;\n        }\n\n        const toBeDimensionValuePairsArray: Array<filterDataSimple> = [];\n        const toBeDimensionsArray = [];\n        if (searchQuery.filter.rootCondition instanceof SimpleCondition /* quick select data source */) {\n            const condition: SimpleCondition = searchQuery.filter.rootCondition;\n            toBeDimensionValuePairsArray.push({\n                attribute: condition.attribute,\n                operator: condition.operator,\n                value: condition.value,\n                fits: false,\n            });\n            toBeDimensionsArray.push(condition.attribute);\n        } else {\n            for (\n                let g = 0;\n                g < (searchQuery.filter.rootCondition as ComplexCondition).conditions.length;\n                g++\n            ) {\n                const conditions = (\n                    (searchQuery.filter.rootCondition as ComplexCondition).conditions[g] as ComplexCondition\n                ).conditions as Array<SimpleCondition>;\n                if (conditions) {\n                    for (let h = 0; h < conditions.length; h++) {\n                        toBeDimensionValuePairsArray.push({\n                            attribute: conditions[h].attribute,\n                            value: conditions[h].value,\n                            operator: conditions[h].operator,\n                            fits: false,\n                        });\n                        toBeDimensionsArray.push(conditions[h].attribute);\n                    }\n                }\n            }\n        }\n        let fits = false;\n        for (let i = 0; i < items.length; i++) {\n            // compare items with collected to-be-valid conditions\n            const item = items[i];\n            const fitsArray = [];\n            for (let j = 0; j < toBeDimensionValuePairsArray.length; j++) {\n                fits = false;\n                for (let k = 0; k < item.detailAttributes.length; k++) {\n                    // loop thru all detailAttributes of item\n                    const detailAttribute = item.detailAttributes[k];\n                    if (detailAttribute instanceof SearchResultSetItemAttribute) {\n                        if (\n                            detailAttribute.id === toBeDimensionValuePairsArray[j].attribute &&\n                            this.checkFilterValueMatch(\n                                detailAttribute.value,\n                                toBeDimensionValuePairsArray[j].value,\n                                toBeDimensionValuePairsArray[j].operator\n                            )\n                        ) {\n                            fits = true;\n                        }\n                    }\n                }\n                for (let m = 0; m < item.titleAttributes.length; m++) {\n                    // loop thru all titleAttributes of item\n                    const titleAttribute = item.titleAttributes[m];\n                    if (titleAttribute instanceof SearchResultSetItemAttribute) {\n                        if (\n                            titleAttribute.id === toBeDimensionValuePairsArray[j].attribute &&\n                            this.checkFilterValueMatch(\n                                titleAttribute.value,\n                                toBeDimensionValuePairsArray[j].value,\n                                toBeDimensionValuePairsArray[j].operator\n                            )\n                        ) {\n                            fits = true;\n                        }\n                    }\n                }\n                toBeDimensionValuePairsArray[j].fits = fits;\n                fitsArray.push(fits);\n            }\n            if (fitsArray.toString().match(/false/) === null) {\n                newItemsArray.push(item);\n            } else {\n                // see if there is one 'true' match for each unique dimension, if so we can still add item\n                const fitsArray2 = [];\n                const uniqueDimensionsArray = toBeDimensionsArray.filter(function (item, pos) {\n                    return toBeDimensionsArray.indexOf(item) == pos;\n                });\n                for (let n = 0; n < uniqueDimensionsArray.length; n++) {\n                    fits = false;\n                    const dimension = uniqueDimensionsArray[n];\n                    for (let p = 0; p < toBeDimensionValuePairsArray.length; p++) {\n                        if (\n                            toBeDimensionValuePairsArray[p].attribute === dimension &&\n                            toBeDimensionValuePairsArray[p].fits === true\n                        ) {\n                            fits = true;\n                            break;\n                        }\n                    }\n                    fitsArray2.push(fits);\n                }\n                if (fitsArray2.toString().match(/false/) === null) {\n                    newItemsArray.push(item);\n                }\n            }\n        }\n\n        return newItemsArray;\n    }\n\n    private checkFilterValueMatch(\n        itemValue: ValueType,\n        filterValue: ValueType,\n        filterOperator: ComparisonOperator\n    ): boolean {\n        switch (filterOperator) {\n            case ComparisonOperator.Co: {\n                return (itemValue as string)\n                    .toLowerCase()\n                    .includes((filterValue as string).toLowerCase() as string);\n            }\n            case ComparisonOperator.Eq: {\n                return filterValue === itemValue;\n            }\n            case ComparisonOperator.Ne: {\n                return filterValue !== itemValue;\n            }\n            case ComparisonOperator.Gt: {\n                return filterValue > itemValue;\n            }\n            case ComparisonOperator.Ge: {\n                return filterValue >= itemValue;\n            }\n            case ComparisonOperator.Lt: {\n                return filterValue < itemValue;\n            }\n            case ComparisonOperator.Le: {\n                return filterValue <= itemValue;\n            }\n            default: {\n                return itemValue === filterValue;\n            }\n        }\n        return false;\n    }\n\n    private adjustHighlights(items: Array<SearchResultSetItem>, searchTerm: string): Array<unknown> {\n        const newItemsArray = [];\n        let attrMetadataType = \"\";\n        for (let i = 0; i < items.length; i++) {\n            const item = items[i] as any;\n            let neverFound = true;\n            attrMetadataType = \"\";\n            item.titleHighlighted = this.addHighlight(item.title, searchTerm);\n\n            if (item.titleHighlighted !== item.title) {\n                neverFound = false;\n            }\n            for (let j = 0; j < items[i].detailAttributes.length; j++) {\n                const detailAttr = items[i].detailAttributes[j] as SearchResultSetItemAttribute;\n                attrMetadataType = detailAttr.metadata.type;\n                if (attrMetadataType === \"String\" || attrMetadataType === \"Integer\") {\n                    detailAttr.valueHighlighted = this.addHighlight(detailAttr.valueFormatted, searchTerm);\n                    if (detailAttr.valueHighlighted !== detailAttr.valueFormatted) {\n                        neverFound = false;\n                    }\n                }\n            }\n            for (let k = 0; k < items[i].titleAttributes.length; k++) {\n                const titleAttr = items[i].titleAttributes[k] as SearchResultSetItemAttribute;\n                attrMetadataType = titleAttr.metadata.type;\n                if (\n                    attrMetadataType === \"String\" ||\n                    attrMetadataType === \"Integer\" ||\n                    attrMetadataType === \"ImageUrl\"\n                ) {\n                    titleAttr.valueHighlighted = this.addHighlight(titleAttr.valueFormatted, searchTerm);\n                    if (titleAttr.valueHighlighted !== titleAttr.valueFormatted) {\n                        neverFound = false;\n                    }\n                }\n            }\n            if (neverFound === false || searchTerm === \"*\" || searchTerm === \"\") {\n                newItemsArray.push(item);\n            }\n        }\n        return newItemsArray;\n    }\n\n    private addHighlight(hText: string, searchTerm: string): string {\n        if (typeof hText !== \"string\" || typeof searchTerm !== \"string\") {\n            return hText;\n        }\n        const pos1 = hText.toLowerCase().indexOf(searchTerm.toLowerCase());\n        if (pos1 > -1) {\n            const pos2 = pos1 + searchTerm.length;\n            const newHText =\n                hText.substring(0, pos1) +\n                \"<b>\" +\n                hText.substring(pos1, pos2) +\n                \"</b>\" +\n                hText.substring(pos2);\n            return newHText;\n        }\n        return hText;\n    }\n\n    addSuvLinkToSearchResultItem(\n        searchResultItem: SearchResultSetItem,\n        suvPath: string,\n        searchTermsArray: Array<string>\n    ): void {\n        const suvNavTargetResolver = this.sina._createSuvNavTargetResolver();\n        if (!suvPath) {\n            suvPath =\n                \"/resources/sap/esh/search/ui/sinaNexTS/providers/sample/docs/folklorist_authors_and_publications.suv\";\n        }\n        if (!searchTermsArray) {\n            searchTermsArray = [];\n        }\n        const suvAttributes: { [key: string]: SuvAttribute } = {};\n        suvAttributes.obj = {\n            suvThumbnailAttribute: searchResultItem,\n            suvTargetMimeTypeAttribute: {\n                value: \"application/vnd.sap.universal-viewer+suv\",\n            },\n            suvTargetUrlAttribute: {\n                value: suvPath,\n            },\n        };\n        suvNavTargetResolver.resolveSuvNavTargets(null, suvAttributes, searchTermsArray);\n    }\n\n    async executeSearchQuery(searchQuery: SearchQuery): Promise<SearchResultSet> {\n        this.searchQuery = searchQuery;\n        return new Promise((resolve) => {\n            let resultSet;\n\n            const itemsRoot = this.templateProvider(this);\n            const items1 = itemsRoot.searchResultSetItemArray;\n            const items2 = itemsRoot.searchResultSetItemArray2;\n            let itemsAll = items1.concat(items2);\n            let items3;\n            if (itemsRoot.searchResultSetItemArray3) {\n                items3 = itemsRoot.searchResultSetItemArray3;\n                itemsAll = itemsAll.concat(items3);\n            }\n\n            const searchTerm = searchQuery.filter.searchTerm;\n            const dataSourceId = searchQuery.filter.dataSource.id;\n            const dataSourceType = searchQuery.filter.dataSource.type;\n            const facets1 = this.generateFacets(searchQuery);\n\n            if (searchTerm === ForcedBySearchTermTestError.forcedBySearchTerm) {\n                throw new ForcedBySearchTermTestError();\n            }\n\n            let items;\n\n            if (\n                dataSourceId === Provider.dataSourceIds.Scientists ||\n                dataSourceId === Provider.dataSourceIds.Folklorists\n            ) {\n                items = this.adjustHighlights(items1, searchTerm);\n                items = this.applyFilters(items, searchQuery);\n                resultSet = this.sina._createSearchResultSet({\n                    items: items,\n                    facets: facets1,\n                    query: searchQuery,\n                    title: \"\",\n                    totalCount: items.length,\n                });\n            } else if (\n                dataSourceId === Provider.dataSourceIds.Mysterious_Sightings ||\n                dataSourceId === Provider.dataSourceIds.Urban_Legends\n            ) {\n                items = this.adjustHighlights(items2, searchTerm);\n                items = this.applyFilters(items, searchQuery);\n                resultSet = this.sina._createSearchResultSet({\n                    items: items,\n                    facets: facets1,\n                    query: searchQuery,\n                    title: \"\",\n                    totalCount: items.length,\n                });\n            } else if (dataSourceId === \"Publications\") {\n                items = this.adjustHighlights(items3, searchTerm);\n                items = this.applyFilters(items, searchQuery);\n                resultSet = this.sina._createSearchResultSet({\n                    items: items,\n                    facets: facets1,\n                    query: searchQuery,\n                    title: \"\",\n                    totalCount: items.length,\n                });\n            } else if (\n                dataSourceId === Provider.dataSourceIds.All ||\n                dataSourceType === this.sina.DataSourceType.UserCategory\n            ) {\n                // initalize measureValue for all facet items, necessary for filtering out superfluous items (My Favorites)\n                facets1[0].items.forEach((item) => {\n                    item.measureValue = 0;\n                    item.measureValueFormatted = \"\";\n                }); // calculate total counts for each sub branch of 'all'\n                items = this.adjustHighlights(items1, searchTerm);\n                items = this.applyFilters(items, searchQuery);\n                const totalCount1 = items.length;\n\n                items = this.adjustHighlights(items2, searchTerm);\n                items = this.applyFilters(items, searchQuery);\n                const totalCount2 = items.length;\n                let totalCount3 = 0;\n                if (items3) {\n                    items = this.adjustHighlights(items3, searchTerm);\n                    items = this.applyFilters(items, searchQuery);\n                    totalCount3 = items.length;\n                }\n\n                facets1[0].items[0].measureValue = totalCount1; // scientists\n                facets1[0].items[0].measureValueFormatted = \"\" + totalCount1;\n\n                facets1[0].items[1].measureValue = totalCount2; // mysterious sightings\n                facets1[0].items[1].measureValueFormatted = \"\" + totalCount2;\n\n                if (items3 && facets1[0].items.length > 2) {\n                    facets1[0].items[2].measureValue = totalCount3; // publications\n                    facets1[0].items[2].measureValueFormatted = \"\" + totalCount3;\n                }\n                // delete facet items where measureValue <= 0 (result items were filtered out)\n                facets1[0].items = facets1[0].items.filter((item) => item.measureValue > 0);\n\n                // proceed to insert facets into resultSet\n                items = this.adjustHighlights(itemsAll, searchTerm);\n                items = this.applyFilters(items, searchQuery);\n\n                // top/skip\n                const finalItems = [];\n                for (\n                    let i = searchQuery.skip;\n                    i < searchQuery.skip + searchQuery.top && i < items.length;\n                    i++\n                ) {\n                    finalItems.push(items[i]);\n                }\n\n                // final results\n                resultSet = this.sina._createSearchResultSet({\n                    items: finalItems,\n                    facets: facets1,\n                    query: searchQuery,\n                    title: \"\",\n                    totalCount: items.length,\n                });\n            }\n\n            resolve(resultSet);\n        });\n    }\n\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    executeHierarchyQuery(query: HierarchyQuery): Promise<HierarchyResultSet> {\n        throw new NotImplementedError();\n    }\n\n    async executeSuggestionQuery(query: SuggestionQuery): Promise<SuggestionResultSet> {\n        const searchTerm = query.filter.searchTerm;\n        const demoRoot = this.templateProvider(this);\n        const searchAbleItems = demoRoot.searchResultSetItemArray\n            .concat(demoRoot.searchResultSetItemArray2)\n            .concat(demoRoot.searchResultSetItemArray3);\n        const suggestionTerms = this.getSuggestionList(searchAbleItems); // \"Sally Spring, Galapagos, Female, Barry Williamson, Off East Cyprus, Male, Conrad Atkinson, Baalbek, Lebanon,Roger Murdoch, Wycliffe Well\"\n        // limit suggestion terms to what matches start of search term\n        const regexp = new RegExp(`^${escapeRegExp(searchTerm)}`, \"gi\");\n        const suggestionsMatchingSearchterm = suggestionTerms.filter((s) => s.match(regexp));\n        //if (suggestionsMatchingSearchterm.length === 0) {\n        //    suggestionsMatchingSearchterm = suggestionTerms;\n        //}\n        const suggestions = [];\n\n        const createSuggestionItem = (term) => {\n            const calculationMode = this.sina.SuggestionCalculationMode.Data;\n            const filter = query.filter.clone();\n            filter.setSearchTerm(term);\n            return this.sina._createSearchTermSuggestion({\n                searchTerm: term,\n                calculationMode: calculationMode,\n                filter: filter,\n                label: term,\n            });\n        };\n        for (let i = 0; i < suggestionsMatchingSearchterm.length; i++) {\n            suggestions.push(createSuggestionItem(suggestionsMatchingSearchterm[i]));\n        }\n\n        const resultSet = this.sina._createSuggestionResultSet({\n            title: \"Suggestions\",\n            query: query,\n            items: suggestions,\n        });\n\n        return new Promise(function (resolve) {\n            resolve(resultSet);\n        });\n    }\n\n    async executeChartQuery(query: ChartQuery): Promise<ChartResultSet> {\n        const chartResultSetItems = this.generateFacets(query);\n        let whichChart = 1; // scientists\n        if (query.dimension === \"LOCATION\" || chartResultSetItems.length === 1) {\n            whichChart = 0;\n        }\n        return new Promise(function (resolve) {\n            resolve(chartResultSetItems[whichChart] as ChartResultSet);\n        });\n    }\n\n    getChartResultSetItemsForLocations(resultSetItemsArray) {\n        const chartResultSetItems = [];\n        let location;\n        const locations = [];\n        let chartResultSetItem, i, j, k, attrs;\n        for (i = 0; i < resultSetItemsArray.length; i++) {\n            attrs = resultSetItemsArray[i].detailAttributes;\n            for (j = 0; j < attrs.length; j++) {\n                if (attrs[j].id === \"LOCATION\") {\n                    location = attrs[j].value;\n                    if (locations.indexOf(location) === -1) {\n                        // new location\n                        locations.push(location);\n                        chartResultSetItem = this.sina._createChartResultSetItem({\n                            filterCondition: this.sina.createSimpleCondition({\n                                attribute: \"LOCATION\",\n                                attributeLabel: \"Location\",\n                                operator: this.sina.ComparisonOperator.Eq,\n                                value: location,\n                            }),\n                            dimensionValueFormatted: location,\n                            measureValue: 1,\n                            measureValueFormatted: \"1\",\n                        });\n\n                        chartResultSetItems.push(chartResultSetItem);\n                    } else {\n                        // add to measureValue\n                        for (k = 0; k < chartResultSetItems.length; k++) {\n                            if (chartResultSetItems[k].filterCondition.value === location) {\n                                chartResultSetItems[k].measureValue = chartResultSetItems[k].measureValue + 1;\n                                chartResultSetItems[k].measureValueFormatted =\n                                    \"\" + chartResultSetItems[k].measureValue;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return chartResultSetItems;\n    }\n\n    getChartResultSetItemsForPublications(resultSetItemsArray) {\n        const chartResultSetItems = [];\n        let publication;\n        const publications = [];\n        let chartResultSetItem, i, j, k, attrs;\n        for (i = 0; i < resultSetItemsArray.length; i++) {\n            attrs = resultSetItemsArray[i].detailAttributes;\n            for (j = 0; j < attrs.length; j++) {\n                if (attrs[j].id === \"PUBLICATION\") {\n                    publication = attrs[j].value;\n                    if (publications.indexOf(publication) === -1) {\n                        // new location\n                        publications.push(publication);\n                        chartResultSetItem = this.sina._createChartResultSetItem({\n                            filterCondition: this.sina.createSimpleCondition({\n                                attribute: \"PUBLICATION\",\n                                attributeLabel: \"Publication\",\n                                operator: this.sina.ComparisonOperator.Eq,\n                                value: publication,\n                            }),\n                            dimensionValueFormatted: publication,\n                            measureValue: 1,\n                            measureValueFormatted: \"1\",\n                        });\n\n                        chartResultSetItems.push(chartResultSetItem);\n                    } else {\n                        // add to measureValue\n                        for (k = 0; k < chartResultSetItems.length; k++) {\n                            if (chartResultSetItems[k].filterCondition.value === publication) {\n                                chartResultSetItems[k].measureValue = chartResultSetItems[k].measureValue + 1;\n                                chartResultSetItems[k].measureValueFormatted =\n                                    \"\" + chartResultSetItems[k].measureValue;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return chartResultSetItems;\n    }\n\n    getSientistOrFolkloristFacet(searchQuery: SearchQuery | ChartQuery, resultSetItemsArray) {\n        let scientisOrFolklorist;\n        const scientisOrFolklorists = [];\n        let chartResultSetItem, i, j, k, attrs, dimension;\n        const chartResultSetItems = [];\n        for (i = 0; i < resultSetItemsArray.length; i++) {\n            attrs = resultSetItemsArray[i].titleAttributes; // for folklorists and scientists\n            if (\n                searchQuery.filter.dataSource.id === Provider.dataSourceIds.Mysterious_Sightings ||\n                searchQuery.filter.dataSource.id === Provider.dataSourceIds.Urban_Legends ||\n                searchQuery.filter.dataSource.id === Provider.dataSourceIds.Publications\n            ) {\n                attrs = resultSetItemsArray[i].detailAttributes;\n            }\n            for (j = 0; j < attrs.length; j++) {\n                if (attrs[j].id === \"SCIENTIST\" || attrs[j].id === \"FOLKLORIST\") {\n                    scientisOrFolklorist = attrs[j].value;\n                    dimension = attrs[j].id;\n                    if (scientisOrFolklorists.indexOf(scientisOrFolklorist) === -1) {\n                        // this particular scientist is not listed yet\n                        scientisOrFolklorists.push(scientisOrFolklorist);\n                        chartResultSetItem = this.sina._createChartResultSetItem({\n                            filterCondition: this.sina.createSimpleCondition({\n                                attribute: attrs[j].id,\n                                attributeLabel: attrs[j].label,\n                                operator: this.sina.ComparisonOperator.Eq,\n                                value: scientisOrFolklorist,\n                            }),\n                            dimensionValueFormatted: scientisOrFolklorist,\n                            measureValue: 1,\n                            measureValueFormatted: \"1\",\n                        });\n\n                        chartResultSetItems.push(chartResultSetItem);\n                    } else {\n                        // add to measureValue\n                        for (k = 0; k < chartResultSetItems.length; k++) {\n                            if (chartResultSetItems[k].filterCondition.value === scientisOrFolklorist) {\n                                chartResultSetItems[k].measureValue = chartResultSetItems[k].measureValue + 1;\n                                chartResultSetItems[k].measureValueFormatted =\n                                    \"\" + chartResultSetItems[k].measureValue;\n                            }\n                        }\n                    }\n                }\n            }\n        }\n        return [chartResultSetItems, dimension];\n    }\n\n    getTopFacetOnly(searchQuery: SearchQuery) {\n        const dataSource = searchQuery.filter.sina.allDataSource;\n        const dataSourceItems = [\n            this.sina._createDataSourceResultSetItem({\n                dataSource: searchQuery.filter.sina.dataSources[1],\n                dimensionValueFormatted: dataSource.labelPlural,\n                measureValue: 4,\n                measureValueFormatted: \"4\", // 4 scientists currently\n            }),\n            this.sina._createDataSourceResultSetItem({\n                dataSource: searchQuery.filter.sina.dataSources[2],\n                dimensionValueFormatted: dataSource.labelPlural,\n                measureValue: 5,\n                measureValueFormatted: \"5\", // 5 sightings currently\n            }),\n        ];\n        if (searchQuery.filter.sina.dataSources[3]) {\n            dataSourceItems[2] = this.sina._createDataSourceResultSetItem({\n                dataSource: searchQuery.filter.sina.dataSources[3],\n                dimensionValueFormatted: dataSource.labelPlural,\n                measureValue: 1,\n                measureValueFormatted: \"1\", // 1 publication currently\n            });\n        }\n\n        const dataSourceFacets = [\n            this.sina._createDataSourceResultSet({\n                title: searchQuery.filter.dataSource.label,\n                items: dataSourceItems,\n                query: searchQuery,\n                facetTotalCount: undefined,\n            }),\n        ];\n        return dataSourceFacets;\n    }\n\n    generateFacets(searchQuery: SearchQuery | ChartQuery): Array<FacetResultSet> {\n        if (\n            searchQuery.filter.dataSource.id === Provider.dataSourceIds.All ||\n            searchQuery.filter.dataSource.type === this.sina.DataSourceType.UserCategory ||\n            (searchQuery instanceof SearchQuery &&\n                (searchQuery.calculateFacets === undefined || searchQuery.calculateFacets === false))\n        ) {\n            return this.getTopFacetOnly(searchQuery as SearchQuery);\n        }\n        const chartResultSetArray = [];\n        let chartResultSet;\n        const gen = this.templateProvider(this);\n\n        const filter = this.sina.createFilter({\n            searchTerm: this.searchQuery.filter.searchTerm,\n            dataSource: this.searchQuery.filter.dataSource,\n            rootCondition: this.searchQuery.filter.rootCondition.clone(),\n        });\n        let chartResultSetItems = [];\n        let resultSetItemsArray;\n\n        // get the right resultsetitems\n        if (searchQuery.filter.dataSource.id === Provider.dataSourceIds.Publications) {\n            resultSetItemsArray = gen.searchResultSetItemArray3;\n        } else if (\n            searchQuery.filter.dataSource.id === Provider.dataSourceIds.Scientists ||\n            searchQuery.filter.dataSource.id === Provider.dataSourceIds.Folklorists\n        ) {\n            resultSetItemsArray = gen.searchResultSetItemArray;\n        } else if (\n            searchQuery.filter.dataSource.id === Provider.dataSourceIds.Urban_Legends ||\n            searchQuery.filter.dataSource.id === Provider.dataSourceIds.Mysterious_Sightings\n        ) {\n            resultSetItemsArray = gen.searchResultSetItemArray2;\n        }\n\n        //  Location Facet\n        if (\n            searchQuery.filter.dataSource.id === Provider.dataSourceIds.Scientists ||\n            searchQuery.filter.dataSource.id === Provider.dataSourceIds.Mysterious_Sightings\n        ) {\n            chartResultSetItems = this.getChartResultSetItemsForLocations(resultSetItemsArray);\n\n            chartResultSet = this.sina._createChartResultSet({\n                items: chartResultSetItems,\n                query: this.sina.createChartQuery({\n                    filter: filter,\n                    dimension: \"LOCATION\",\n                }),\n                title: \"Locations\",\n                facetTotalCount: undefined,\n            });\n            chartResultSetArray.push(chartResultSet);\n        }\n\n        // Scientist or Folklorist Facet\n        const info = this.getSientistOrFolkloristFacet(searchQuery, resultSetItemsArray);\n        chartResultSetItems = info[0];\n        const dimension = info[1];\n\n        chartResultSet = this.sina._createChartResultSet({\n            items: chartResultSetItems,\n            query: this.sina.createChartQuery({\n                filter: filter,\n                dimension: dimension,\n            }),\n            title: dimension.charAt(0).toUpperCase() + dimension.slice(1).toLowerCase() + \"s\",\n            facetTotalCount: undefined,\n        });\n        chartResultSetArray.push(chartResultSet);\n\n        return chartResultSetArray;\n    }\n}\n"],"mappings":"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","ignoreList":[]}