/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../../../core/util","../../../core/core","./JoinConditions","../../../sina/SinaObject"],function(t,e,i,n){"use strict";const a=i["JoinConditions"];const o=n["SinaObject"];class r extends o{active;getPropertyMetadata;urlPrefix;navigationTargetTemplatesInitialized;navigationTargetTemplatesMap;objectTypeMap;ignoredSemanticObjectTypes;constructor(t){super(t);this.active=this.checkActive();this.getPropertyMetadata=t.getPropertyMetadata;this.urlPrefix=t.urlPrefix;this.navigationTargetTemplatesInitialized=false;this.navigationTargetTemplatesMap={};this.objectTypeMap={};this.ignoredSemanticObjectTypes={LastChangedByUser:true,CreationDate:true,CreatedByUser:true}}checkActive(){const e=t.getUrlParameter("sors");if(e==="true"){return true}return false}cleanup(){this.objectTypeMap=null}registerObjectType(t){if(!this.active){return}const e={type:t.type,label:t.label,propertyMap:{}};this.objectTypeMap[t.type]=e;for(let i=0;i<t.properties.length;++i){const n=t.properties[i];const a=this.getPropertyMetadata(n);this.filterSemanticObjectType(a);e.propertyMap[a.name]=a}}filterSemanticObjectType(t){if(this.ignoredSemanticObjectTypes[t.semanticObjectType]){delete t.semanticObjectType}}finishRegistration(){if(!this.active){return}this.calculateNavigationTargetTemplates()}calculateNavigationTargetTemplates(){if(this.navigationTargetTemplatesInitialized){return}const t=this.collectJoinConditions();this.navigationTargetTemplatesMap=this.createNavTargetTemplatesFromJoinConditions(t);this.cleanup();this.navigationTargetTemplatesInitialized=true}createNavTargetTemplatesFromJoinConditions(t){const e={};for(const i in t){const n=t[i];const a=[];for(const t in n){const e=n[t];if(!e){continue}a.push(...e.generateNavigationTargetTemplates())}if(a.length!==0){e[i]=a}}return e}collectJoinConditions(){const t=this.createIndex();const i={};for(const n in this.objectTypeMap){const a=this.collectJoinConditionsForObjectType(t,n);if(!e.isEmptyObject(a)){i[n]=a}}return i}collectJoinConditionsForObjectType(t,e){const i={};const n=this.objectTypeMap[e];const o=function(t){let n=i[t];if(!n){n=new a({sina:this.sina,navigationTargetGenerator:this,sourceObjectType:e,targetObjectType:t});i[t]=n}return n}.bind(this);for(const e in n.propertyMap){const i=n.propertyMap[e];const a=i.semanticObjectType;if(!i.response){continue}if(!a){continue}const r=t[a];for(const t in r){if(t===n.type){continue}const i=this.objectTypeMap[t];const s=r[t];for(const n in s){const r=i.propertyMap[n];if(!r.request){continue}const s=o(t);s.add({sourcePropertyName:e,targetPropertyName:n,semanticObjectType:a})}}}return i}createIndex(){const t={};for(const e in this.objectTypeMap){this.createIndexForObjectType(t,e)}return t}createIndexForObjectType(t,e){const i=this.objectTypeMap[e];for(const e in i.propertyMap){const n=i.propertyMap[e];const a=n.semanticObjectType;if(!a){continue}let o=t[a];if(!o){o={};t[a]=o}let r=o[i.type];if(!r){r={};o[i.type]=r}let s=r[e];if(!s){s=true;r[e]=true}}}formatItem(t){const e=function(t,e){for(let i=0;i<e.length;++i){const n=e[i];t[n.id]=n}};const i={};e(i,t.detailAttributes);e(i,t.titleAttributes);return i}generateNavigationTargetsForItem(t){const e=this.navigationTargetTemplatesMap[t.dataSource.id];if(!e){return undefined}const i=this.formatItem(t);const n=[];for(let t=0;t<e.length;++t){const a=e[t];const o=a.generate(i);if(!o){continue}n.push(o)}return n}generateNavigationTargets(t){if(!this.active){return}for(let e=0;e<t.items.length;++e){const i=t.items[e];const n=this.generateNavigationTargetsForItem(i);i.setNavigationTargets(n)}}}var s={__esModule:true};s.NavigationTargetGenerator=r;return s});
//# sourceMappingURL=NavigationTargetGenerator.js.map