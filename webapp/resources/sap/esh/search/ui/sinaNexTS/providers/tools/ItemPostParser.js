/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../../sina/SinaObject","../../sina/AttributeType","../abap_odata/Provider"],function(t,e,s){"use strict";const i=t["SinaObject"];const a=e["AttributeType"];const r=s["Provider"];class n extends i{_searchResultSetItem;_dataSource;_allAttributesMap;_intentsResolver;constructor(t){super(t);this._searchResultSetItem=t.searchResultSetItem;this._dataSource=t.searchResultSetItem.dataSource;this._allAttributesMap=t.searchResultSetItem._private.allAttributesMap;this._intentsResolver=this.sina._createFioriIntentsResolver({sina:t.sina})}async postParseResultSetItem(){const t=this.enhanceResultSetItemWithNavigationTargets();this.enhanceResultSetItemWithGroups();return t}async enhanceResultSetItemWithNavigationTargets(){const t=this;const e=t._dataSource._private.semanticObjectType;const s=t._searchResultSetItem._private.semanticObjectTypeAttributes;const i=t._dataSource.system?.id?.split(".")[0];const a=t._dataSource.system?.id?.split(".")[1];const r=await t._intentsResolver.resolveIntents({semanticObjectType:e,semanticObjectTypeAttributes:s,systemId:i,client:a,fallbackDefaultNavigationTarget:t._searchResultSetItem.defaultNavigationTarget});const n=r&&r.defaultNavigationTarget;const u=r&&r.navigationTargets;let o=[];if(n){o.push(n);t._searchResultSetItem.setDefaultNavigationTarget(n)}if(u){t._searchResultSetItem.setNavigationTargets(u);o=[...o,...u]}this.enhanceNavigationTargetsWithContentProviderId(o);return t._searchResultSetItem}enhanceNavigationTargetsWithContentProviderId(t){if(!(this.sina.provider instanceof r)){return}if(!this.sina.provider.contentProviderId){return}for(const e of t){e.targetUrl+="&sap-app-origin-hint="+this.sina.provider.contentProviderId}}enhanceResultSetItemWithGroups(){const t=this._searchResultSetItem.dataSource.attributesMetadata;for(let e=0;e<t.length;e++){const s=t[e];if(s.type===a.Group){const t=this._addAttributeGroup(s);t.parent=this._searchResultSetItem;if(s.usage.Detail){this._searchResultSetItem.detailAttributes.push(t)}if(s.usage.Title){this._searchResultSetItem.titleAttributes.push(t)}if(s.usage.TitleDescription){this._searchResultSetItem.titleDescriptionAttributes.push(t)}}}this.sortAttributes()}sortAttributes(){const t=function(t){return function(e,s){const i=e.metadata.usage&&e.metadata.usage[t]?e.metadata.usage[t].displayOrder:undefined;const a=s.metadata.usage&&s.metadata.usage[t]?s.metadata.usage[t].displayOrder:undefined;if(i===undefined||a===undefined){if(a!==undefined){return 1}return-1}return i-a}};this._searchResultSetItem.titleAttributes.sort(t("Title"));this._searchResultSetItem.titleDescriptionAttributes.sort(t("TitleDescription"));this._searchResultSetItem.detailAttributes.sort(t("Detail"))}_addAttributeGroup(t){const e=this.sina._createSearchResultSetItemAttributeGroup({id:t.id,metadata:t,label:t.label,template:t.template,attributes:[],groups:[],displayAttributes:t.displayAttributes||[]});let s,i;if(t._private){s=t._private.parentAttribute;i=t._private.childAttribute}for(let r=0;r<t.attributes.length;r++){const n=t.attributes[r];const u=n.attribute;let o;if(u.type===a.Group){o=this._addAttributeGroup(u)}else{o=this._allAttributesMap[u.id]}if(o){const t=this.sina._createSearchResultSetItemAttributeGroupMembership({group:e,attribute:o,metadata:n});e.attributes.push(t);o.groups.push(t)}if(u==s){e._private.parentAttribute=o}else if(u==i){e._private.childAttribute=o}}return e}}var u={__esModule:true};u.ItemPostParser=n;return u});
//# sourceMappingURL=ItemPostParser.js.map