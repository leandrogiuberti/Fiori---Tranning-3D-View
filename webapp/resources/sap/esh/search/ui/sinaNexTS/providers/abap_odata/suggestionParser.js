/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["../../sina/SearchResultSetItemAttribute","../../sina/SuggestionCalculationMode"],function(e,t){"use strict";const r=e["SearchResultSetItemAttribute"];const s=t["SuggestionCalculationMode"];class a{provider;sina;itemParser;constructor(e,t){this.provider=e;this.sina=e.sina;this.itemParser=t}parseObjectSuggestions(e,t){if(!t.d.ObjectSuggestions||!t.d.ObjectSuggestions.SearchResults||!t.d.ObjectSuggestions.SearchResults.results){return[]}const r=[];const s=t.d.ObjectSuggestions.SearchResults.results;for(let e=0;e<s.length;++e){const t=s[e];r.push(this.parseObjectSuggestion(t))}return Promise.all(r)}parseObjectSuggestion(e){return this.itemParser.parseItem(e).then(function(e){this.fillValueHighlighted(e);const t=e.titleAttributes.filter(e=>e instanceof r).map(function(e){return e.valueFormatted}).join(" ");return this.sina._createObjectSuggestion({calculationMode:s.Data,label:t,object:e})}.bind(this))}fillValueHighlighted(e){const t=function(e){if(!e){return}for(let t=0;t<e.length;++t){const r=e[t];if(!r.valueHighlighted){r.valueHighlighted=r.valueFormatted}}};t(e.detailAttributes);t(e.titleAttributes)}parseRegularSuggestions(e,t){const r=[];let s;let a;const i=[];let n;let c;if(!t.d.Suggestions||!t.d.Suggestions.results){return[]}const o=t.d.Suggestions.results;for(let t=0;t<o.length;t++){s=null;n=o[t];switch(n.Type){case"H":s=this.parseSearchTermSuggestion(e,n);break;case"A":s=this.parseSearchTermAndDataSourceSuggestion(e,n);s.cell=n;break;case"M":s=this.parseDataSourceSuggestion(e,n);break}if(s){if(s.type===this.sina.SuggestionType.SearchTermAndDataSource){if(i[s.searchTerm]===undefined){c=this._getParentCell(s.cell);a=this.parseSearchTermSuggestion(e,c);i[s.searchTerm]=a}delete s.cell;i[s.searchTerm].childSuggestions.push(s)}else{r.push(s)}}}Object.keys(i).forEach(function(e){r.push(i[e])});return r}parseDataSourceSuggestion(e,t){const r=s.Data;const a=this.sina.getDataSource(t.FromDataSource);if(!a){return null}const i=e.filter.clone();i.setDataSource(a);return this.sina._createDataSourceSuggestion({calculationMode:r,dataSource:a,label:t.SearchTermsHighlighted})}parseSearchTermSuggestion(e,t){const r=this.parseCalculationMode(t.Type);const s=e.filter.clone();s.setSearchTerm(t.SearchTerms);return this.sina._createSearchTermSuggestion({searchTerm:t.SearchTerms,calculationMode:r,filter:s,label:t.SearchTermsHighlighted})}parseSearchTermAndDataSourceSuggestion(e,t){const r=this.parseCalculationMode(t.Type);const s=e.filter.clone();s.setSearchTerm(t.SearchTerms);const a=this.sina.getDataSource(t.FromDataSource);if(!a){return null}s.setDataSource(a);return this.sina._createSearchTermAndDataSourceSuggestion({searchTerm:t.SearchTerms,dataSource:a,calculationMode:r,filter:s,label:t.SearchTermsHighlighted})}parseCalculationMode(e){switch(e){case"H":return s.History;case"A":case"M":return s.Data}}_getParentCell(e){const t=e;t.FromDataSource="<All>";t.FromDataSourceAttribute="";t.Type="A";return t}}var i={__esModule:true};i.SuggestionParser=a;return i});
//# sourceMappingURL=suggestionParser.js.map