{"version":3,"file":"HashChangeHandler.js","names":["sap","ui","define","___eventlogging_TechnicalEvents","__SearchModel","_interopRequireDefault","obj","__esModule","default","TechnicalEventType","SearchModel","HashChangeHandler","handle","async","hashChangeInfo","this","sourceUrlArray","oldShellHash","push","oldAppSpecificRoute","substring","_createSearchModel","event","type","HASH_CHANGE","targetUrl","newShellHash","systemAndClient","_getSID","indexOf","searchModel","sinaNext","logUserEvent","initializedPromise","getModelSingleton","initBusinessObjSearch","systemId","client","url","window","location","href","systemBegin","systemEnd","systemInUrl","split","length"],"sources":["HashChangeHandler.ts"],"sourcesContent":["/*!\n * SAPUI5\n * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.\n * \n */\nimport { TechnicalEventType } from \"./eventlogging/TechnicalEvents\";\nimport SearchModel from \"./SearchModel\";\n\n// track navigation\n// model class for track navigation\n// =======================================================================\n\nconst HashChangeHandler = {\n    handle: async function (hashChangeInfo: {\n        newShellHash: string;\n        oldShellHash?: string;\n        oldAppSpecificRoute?: string;\n    }): Promise<void> {\n        this.sourceUrlArray = [];\n        if (hashChangeInfo.oldShellHash !== null) {\n            this.sourceUrlArray.push(hashChangeInfo.oldShellHash);\n        }\n        if (hashChangeInfo.oldAppSpecificRoute !== null) {\n            if (hashChangeInfo.oldAppSpecificRoute.substring(0, 2) === \"&/\") {\n                // remove first special parameter indicator \"&/\"\n                this.sourceUrlArray.push(hashChangeInfo.oldAppSpecificRoute.substring(2));\n            } else {\n                this.sourceUrlArray.push(hashChangeInfo.oldAppSpecificRoute);\n            }\n        }\n\n        await this._createSearchModel();\n        const event = {\n            type: TechnicalEventType.HASH_CHANGE,\n            sourceUrlArray: this.sourceUrlArray,\n            targetUrl: \"#\" + hashChangeInfo.newShellHash,\n            systemAndClient: this._getSID(),\n        };\n        if (event.targetUrl.indexOf(\"=\") !== -1) {\n            this.searchModel.sinaNext.logUserEvent(event);\n        }\n    },\n\n    _createSearchModel: async function (): Promise<void> {\n        if (this.initializedPromise) {\n            return this.initializedPromise;\n        }\n        // get search model and call init\n        this.searchModel = SearchModel.getModelSingleton({}, \"flp\");\n        this.initializedPromise = this.searchModel.initBusinessObjSearch();\n        return this.initializedPromise;\n    },\n\n    _getSID: function (): {\n        systemId: string;\n        client: string;\n    } {\n        // extract System and Client from sap-system=sid(BE1.001)\n        const systemAndClient = {\n            systemId: \"\",\n            client: \"\",\n        };\n        const url = window.location.href;\n        const systemBegin = url.indexOf(\"sap-system=sid(\");\n\n        if (systemBegin !== -1) {\n            const systemEnd = url.substring(systemBegin).indexOf(\")\");\n            if (systemEnd !== -1) {\n                const systemInUrl = url.substring(systemBegin + 15, systemBegin + systemEnd);\n                if (systemInUrl.split(\".\").length === 2) {\n                    systemAndClient.systemId = systemInUrl.split(\".\")[0];\n                    systemAndClient.client = systemInUrl.split(\".\")[1];\n                }\n            }\n        }\n        return systemAndClient;\n    },\n};\n\nexport default HashChangeHandler;\n"],"mappings":";;;;;AAAAA,IAAAC,GAAAC,OAAA,4DAAAC,EAAAC,GAAA,sBAAAC,EAAAC,GAAA,OAAAA,KAAAC,mBAAAD,EAAAE,UAAA,YAAAF,EAAAE,QAAAF,CAAA,OAKSG,EAAkBN,EAAA,4BACpBO,EAAWL,EAAAD,GAMlB,MAAMO,EAAoB,CACtBC,OAAQC,eAAgBC,GAKpBC,KAAKC,eAAiB,GACtB,GAAIF,EAAeG,eAAiB,KAAM,CACtCF,KAAKC,eAAeE,KAAKJ,EAAeG,aAC5C,CACA,GAAIH,EAAeK,sBAAwB,KAAM,CAC7C,GAAIL,EAAeK,oBAAoBC,UAAU,EAAG,KAAO,KAAM,CAE7DL,KAAKC,eAAeE,KAAKJ,EAAeK,oBAAoBC,UAAU,GAC1E,KAAO,CACHL,KAAKC,eAAeE,KAAKJ,EAAeK,oBAC5C,CACJ,OAEMJ,KAAKM,qBACX,MAAMC,EAAQ,CACVC,KAAMd,EAAmBe,YACzBR,eAAgBD,KAAKC,eACrBS,UAAW,IAAMX,EAAeY,aAChCC,gBAAiBZ,KAAKa,WAE1B,GAAIN,EAAMG,UAAUI,QAAQ,QAAU,EAAG,CACrCd,KAAKe,YAAYC,SAASC,aAAaV,EAC3C,CACJ,EAEAD,mBAAoBR,iBAChB,GAAIE,KAAKkB,mBAAoB,CACzB,OAAOlB,KAAKkB,kBAChB,CAEAlB,KAAKe,YAAcpB,EAAYwB,kBAAkB,CAAC,EAAG,OACrDnB,KAAKkB,mBAAqBlB,KAAKe,YAAYK,wBAC3C,OAAOpB,KAAKkB,kBAChB,EAEAL,QAAS,WAKL,MAAMD,EAAkB,CACpBS,SAAU,GACVC,OAAQ,IAEZ,MAAMC,EAAMC,OAAOC,SAASC,KAC5B,MAAMC,EAAcJ,EAAIT,QAAQ,mBAEhC,GAAIa,KAAiB,EAAG,CACpB,MAAMC,EAAYL,EAAIlB,UAAUsB,GAAab,QAAQ,KACrD,GAAIc,KAAe,EAAG,CAClB,MAAMC,EAAcN,EAAIlB,UAAUsB,EAAc,GAAIA,EAAcC,GAClE,GAAIC,EAAYC,MAAM,KAAKC,SAAW,EAAG,CACrCnB,EAAgBS,SAAWQ,EAAYC,MAAM,KAAK,GAClDlB,EAAgBU,OAASO,EAAYC,MAAM,KAAK,EACpD,CACJ,CACJ,CACA,OAAOlB,CACX,GACF,OAEahB,CAAiB","ignoreList":[]}