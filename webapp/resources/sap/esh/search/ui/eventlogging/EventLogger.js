/*!
 * SAPUI5
 * Copyright (c) 2025 SAP SE or an SAP affiliate company. All rights reserved.
 * 
 */
sap.ui.define(["sap/base/Log","sap/esh/search/ui/eventlogging/UsageAnalyticsConsumerSina","sap/esh/search/ui/flp/UsageAnalyticsConsumerFlp"],function(e,t,s){"use strict";class n{consumers=[];searchModel;sinaNext;log=e.getLogger("sap.esh.search.ui.eventlogging.EventLogger");static userEventNumber=0;static technicalEventNumber=0;static sessionId=(new Date).getTime().toString();constructor(e){this.searchModel=e.searchModel;this.sinaNext=e.sinaNext;for(const t of e.eventConsumers){this.addConsumer(t)}}async initAsync(){try{if(this.searchModel.config.isUshell){const e=new s;await e.initAsync();this.addConsumer(e)}}catch(e){this.log.debug("Couldn't initialize flp user event consumer",e)}try{const e=new t(this.sinaNext);await e.initAsync();this.addConsumer(e)}catch(e){this.log.debug("Couldn't initialize sina user event consumer",e)}}addConsumer(e){this.consumers.push(e);this.log.debug(`[${e.label}] Event consumer added`)}setConsumers(e){for(const t of e){this.addConsumer(t)}}logEvent(e){e.sessionId=n.sessionId;e.timeStamp=e.timeStamp??(new Date).getTime().toString();e.eventNumber=n.userEventNumber++;for(let t=0;t<this.consumers.length;++t){const s=this.consumers[t];try{s.logEvent(e);this.log.debug(`[${e.eventNumber}|${e.sessionId}|${s.label}] Logged user event ${e.type} - payload ${JSON.stringify(e,null,2)}`)}catch(t){this.log.debug(`[${s.label}] Error while logging user event ${e.type}`,t.stack||t)}}}logTechnicalEvent(e){e.sessionId=n.sessionId;e.timeStamp=e.timeStamp??(new Date).getTime().toString();e.eventNumber=n.technicalEventNumber++;for(let t=0;t<this.consumers.length;++t){const s=this.consumers[t];try{if(typeof s.logTechnicalEvent==="function"){s.logTechnicalEvent(e);this.log.debug(`[${e.eventNumber}|${e.sessionId}|${s.label}] Logged technical event ${e.type} - payload ${JSON.stringify(e,null,2)}`)}else{s.logEvent(e);this.log.debug(`[${e.eventNumber}|${e.sessionId}|${s.label}] WARNING: event ${e.type} will soon be removed from logEvent() callback, implement logTechnicalEvent() callback in your event consumer to continue receiving this event`)}}catch(t){this.log.debug(`[${s.label}] Error while logging technical event ${e.type}`,t.stack||t)}}}}return n});
//# sourceMappingURL=EventLogger.js.map