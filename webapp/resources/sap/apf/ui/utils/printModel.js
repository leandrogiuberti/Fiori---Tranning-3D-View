/* (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/core/constants","sap/apf/core/utils/filter","sap/apf/ui/utils/formatter","sap/apf/utils/exportToGlobal","sap/viz/ui5/types/legend/Common"],function(e,t,r,o,i){"use strict";function a(e){this.oUiApi=e.uiApi;this.oCoreApi=e.oCoreApi;this.oFilterIdHandler=e.oFilterIdHandler}a.prototype.constructor=a;function n(e,t,o,i,a,n){var l=new r({getEventCallback:e.oUiApi.getEventCallback.bind(e.oUiApi),getTextNotHtmlEncoded:e.oCoreApi.getTextNotHtmlEncoded,getExits:e.oUiApi.getCustomFormatExit()},t);var s=l.getFormattedValue(o,a);var p=l.getFormattedValue(o,n);var g=e.oCoreApi.getTextNotHtmlEncoded(i,[s,p]);return g}function l(e){var r=e.oUiApi.getSmartFilterForPrint();var o=[];if(r!==undefined&&r!==null){var i=r.getFilterData();var a=r.getAnalyticalParameters();if(a&&a.length>0){a.forEach(function(t){var r=i[t.fieldName];var a=t.fieldNameOData;e.oCoreApi.getMetadataFacade().getProperty(a).done(function(t){o.push({sFilterName:a,sFilterValue:n(e,t,a,"EQ",r)})})})}var l=r.getFilters();if(l.length>0){var s=t.transformUI5FilterToInternal(e.oCoreApi.getMessageHandler(),l[0]);for(var p in i){var g="";var u=s.getFilterTermsForProperty(p);if(u.length>0){e.oCoreApi.getMetadataFacade().getProperty(p).done(function(t){for(var r=0;r<u.length;r++){g+=n(e,t,p,u[r]["operator"],u[r]["value"],u[r]["highValue"]);if(r!==u.length-1){g+=", "}}o.push({sFilterName:p,sFilterValue:g})})}}}}return o}function s(e){var t,r="",o;var i,a,n=[],l=[],s=[];i=e.oUiApi.getFacetFilterForPrint();if(i){a=i.getLists();for(t=0;t<a.length;t++){r=a[t].getTitle();s=a[t].getSelectedItems();if(s.length>0){l=p(s);if(r!==undefined&&r!==null){o="";for(var g=0;g<l.length;g++){if(g!==l.length-1){o+=l[g]+", "}else{o+=l[g]}}n.push({sFilterName:r,sFilterValue:o})}}else{n.push({sFilterName:r,sFilterValue:e.oCoreApi.getTextNotHtmlEncoded("noSelectionInFilter")})}}}return n}function p(e){var t=[];e.forEach(function(e){t.push(e.getText())});return t}function g(e){var t=e.oFilterIdHandler.getAllInternalIds();var r,o=[],i;if(t.length>0){for(i=0;i<t.length;i++){r=e.oFilterIdHandler.get(t[i]).getExpressions();o.push(r[0])}}return o}function u(e,t){var o=[],i,a,n="",l,s,p;var g=[];for(i=0;i<t.length;i++){for(a=0;a<t[i].length;a++){e.oCoreApi.getMetadataFacade().getProperty(t[i][a].name).done(function(t){p=t;n="";g=[];n=t.label;s=new r({getEventCallback:e.oUiApi.getEventCallback.bind(e.oUiApi),getTextNotHtmlEncoded:e.oCoreApi.getTextNotHtmlEncoded,getExits:e.oUiApi.getCustomFormatExit()},t)});g.push(s.getFormattedValue(p.name,t[i][a].value));if(n!==undefined&&n!==null){l="";for(var a=0;a<g.length;a++){if(a!==g.length-1){l+=g[a]+", "}else{l+=g[a]}}o.push({sFilterName:n,sFilterValue:l})}}}return o}function f(t){var r=t.oUiApi.getEventCallback(e.eventTypes.printTriggered);var o=u(t,g(t));if(r!==undefined){var i={getTextNotHtmlEncoded:t.oCoreApi.getTextNotHtmlEncoded};o=r.apply(i,g(t))}return o}function d(e){var t,r,o;var i=s(e);r=l(e);t=f(e);o=t.concat(r,i);return o}a.prototype.getFiltersToPrint=function(){var e=this;var t=d(e);return t};a.prototype.getHeaderForFirstPage=function(){return this.oUiApi.getLayoutView().getController().oSavedPathName.getText()};a.prototype.getApplicationName=function(){var e;var t=this.applicationConfig.appName;if(!t){e=this.oCoreApi.createMessageObject({code:"6003",aParameters:["sAppName"]});this.oCoreApi.putMessage(e)}return t};a.prototype.setApplicationConfig=function(e){this.applicationConfig=e};a.prototype.getRepresentationForPrint=function(e){var t;var r;var o;var i;var a=this.oCoreApi.getTextNotHtmlEncoded(e.title);var n=e.getSelectedRepresentation();var l=n.bIsAlternateView?n.toggleInstance:n;if(l&&l.titleControl&&l.titleControl.oParent){o=l.titleControl.oParent.getItems();if(o&&o.length>1){for(r=0;r<o.length;r++){if(o[r].getMetadata()._sClassName==="sap.m.HBox"){i=o[r];i.setVisible(false)}}}}t=l.getPrintContent(a);return t.oRepresentation};o("sap.apf.ui.utils.PrintModel",a);return a});
//# sourceMappingURL=printModel.js.map