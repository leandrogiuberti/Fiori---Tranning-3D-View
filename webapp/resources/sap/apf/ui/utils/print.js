/*
 * ! SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/ui/utils/constants","sap/apf/ui/utils/formatter","sap/apf/ui/utils/printView","sap/apf/ui/utils/printModel","sap/apf/utils/exportToGlobal","sap/base/util/isEmptyObject","sap/ui/Device","sap/ui/layout/VerticalLayout","sap/ui/thirdparty/jquery"],function(t,e,n,i,r,a,o,s,jQuery){"use strict";function l(e){"use strict";var r=e.oCoreApi;var l=e.uiApi;var u=null;var p=new i(e);var d=new n(e,p);this.oPrintLayout={};function f(t){if(!a(t.oPrintLayout)){t.oPrintLayout.removeContent()}jQuery("#apfPrintArea").remove();jQuery("body").append('<div id="apfPrintArea"></div>');l.createApplicationLayout(false).then(function(t){t.setBusy(true)})}this.doPrint=function(t){t=t||0;r.getApplicationConfigProperties().done(function(e){p.setApplicationConfig(e);var n,i,a;var o=2e3,l=this;p.nStepRenderCount=0;u=r.getSteps();p.nNoOfSteps=u.length;this.oPrintLayout=new s({id:"idAPFPrintLayout"});f(this);a=new s({id:"idAPFPrintFirstPageLayout",content:[d.getHeaderForFirstPage(),d.getPrintLayoutForFacetFiltersAndFooters()]}).addStyleClass("filterLayout");this.oPrintLayout.addContent(a);for(n=0;n<u.length;n++){i=parseInt(n,10)+1;this.oPrintLayout.addContent(d.getPrintLayoutForEachStep(u[n],i,u.length))}this.oPrintLayout.placeAt("apfPrintArea");c(l.oPrintLayout,o,t)}.bind(this))};function c(t,e,n){new Promise(function(t){setTimeout(function(){t()},e)}).then(function(){P(t);if(n==1){y(n)}else{y()}h(t);return l.createApplicationLayout(false)}).then(function(t){t.setBusy(false)})}function h(e){var n,i;var r,a;for(var o=0;o<jQuery("#apfPrintArea").siblings().length;o++){jQuery("#apfPrintArea").siblings()[o].hidden=false}for(var s=0;s<u.length;s++){n=u[s].getSelectedRepresentation();n=n.bIsAlternateView?n.toggleInstance:n;if(n&&n.titleControl&&n.titleControl.oParent){r=n.titleControl.oParent.getItems();if(r&&r.length>1){for(var l=0;l<r.length;l++){if(r[l].getMetadata()._sClassName==="sap.m.HBox"){a=r[l];a.setVisible(true)}}}}if(n.type!==t.representationTypes.TREE_TABLE_REPRESENTATION&&n.type!==t.representationTypes.TABLE_REPRESENTATION){i=e.getContent()[s+1].getContent()[1].getContent()[0];i.destroy();i=null}}e.destroy();e=null;jQuery("div[id^=idAPFStepLayout]").remove();jQuery("#apfPrintArea").remove()}function y(t){t=t||0;var e=o.system.tablet;var n=o.os.ios;if(e===true&&n===true){var i=jQuery("html").clone();var r=jQuery(i).find("body");jQuery(r).children("div").each(function(t,e){if(jQuery(e).attr("id")==="apfPrintArea"){jQuery(e).show()}else{jQuery(e).remove()}});jQuery(jQuery(i).find("body")).html(jQuery(r.html()));var a="<html>"+jQuery(i).html()+"</html>";var s=window.open("","_blank","width=300,height=300");s.opener=null;s.document.write(a);s.print()}else{if(t==0){var l=window.open("","_blank","height=600,width=700");var u=document.getElementById("apfPrintArea").innerHTML;l.opener=null;l.document.write("<html><head><title>Analysis Path Framework</title>");l.document.write("</head><body >");l.document.write(u);l.document.write("</body></html>");l.document.close();l.print();l.close()}else{window.print()}}}function P(t){var e=t.getDomRef();jQuery("#apfPrintArea").empty();jQuery("#apfPrintArea").append(jQuery(e).html());for(var n=0;n<jQuery("#apfPrintArea").siblings().length;n++){jQuery("#apfPrintArea").siblings()[n].hidden=true}}}r("sap.apf.ui.utils.Print",l);return l});
//# sourceMappingURL=print.js.map