/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2018 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/mvc/Controller","sap/apf/utils/trace","sap/ui/Device"],function(t,e,i){"use strict";return t.extend("sap.apf.ui.reuse.controller.analysisPath",{refreshAnalysisPath:function(t){if(this.getView().getCarouselView().getController().oCoreApi.getSteps().length<2){this.getView().getCarouselView().getController().getView().moveDownButton.setEnabled(false);this.getView().getCarouselView().getController().getView().moveUpButton.setEnabled(false)}this.getView().getCarouselView().getController().showStepChartChartAfterUpdate()},isOpenPath:false,isNewPath:false,isBackNavigation:false,bLastValidState:false,onInit:function(){this.oCoreApi=this.getView().getViewData().oCoreApi;this.oUiApi=this.getView().getViewData().uiApi;if(i.system.desktop){this.getView().addStyleClass("sapUiSizeCompact")}},refresh:function(t){e.logCall("AnalysisPath.refresh"," inx=",t);function i(){var e=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());if(e>t){var i=this.oUiApi.getStepContainer();i.stepLayout.setBusy(true)}}i.bind(this)();if(!this.oCoreApi.isDirty()&&this.oCoreApi.getSteps().length!==0){this.oCoreApi.setDirtyState(true);this.oUiApi.getLayoutView().getController().setPathTitle()}e.logReturn("refresh")},updateCustomListView:function(t,e,i){this.getView().getCarouselView().getController().updateCustomListView(t,e,i)},callBackForUpdatePath:function(t,i){e.logCall("AnalysisPath.callBackForUpdatePath"," changed?",i," chart=",t.getSelectedRepresentation().chart?t.getSelectedRepresentation().chart.sId:"NULL");try{var a=this.oCoreApi.getSteps().indexOf(t);if(a===0){this.refreshAnalysisPath(a)}this.updateCurrentStep(t,a,i);this.updateCustomListView(t,a,i)}catch(t){window.console.error("sap.apf .. analysisPath.controller catch exception: ",t);window.console.trace("trace ")}e.logReturn("callBackForUpdatePath")},callBackForUpdatePathAndSetLastStepAsActive:function(t,i){e.logCall("AnalysisPath.callBackForUpdatePathAndSetLastStepAsActive"," changed?",i," chart=",t.getSelectedRepresentation().chart?t.getSelectedRepresentation().chart.sId:"NULL");try{var a=this.oCoreApi.getSteps().indexOf(t);if(a===0){var s=this.oCoreApi.getSteps()[this.oCoreApi.getSteps().length-1];this.oCoreApi.setActiveStep(s);this.refreshAnalysisPath()}this.updateCurrentStep(t,a,i);this.updateCustomListView(t,a,i);this.oUiApi.getLayoutView().setBusy(false)}catch(t){window.console.error("sap.apf .. analysisPath.controller catch exception: ",t);window.console.trace("trace ")}e.logReturn("AnalysisPath.callBackForUpdatePathAndSetLastStepAsActive")},getIsOpenPath:function(){return this.isOpenPath===true?true:false},setIsOpenPath:function(t){this.isOpenPath=t?true:false},updateCurrentStep:function(t,i,a){e.logCall("AnalysisPath.updateCurrentStep",", inx=",i,", changed?",a,", #core.path=",this.oCoreApi.getSteps().length);try{var s=this.oCoreApi.getSteps().indexOf(this.oCoreApi.getActiveStep());var o=i===s;e.log("updateCurrentStep",", isOpenPath=",this.isOpenPath,", nActiveIndex=",s);if(o){this.drawMainChart(a,o)}if(this.isOpenPath&&this.oCoreApi.getSteps().indexOf(t)===this.oCoreApi.getSteps().length-1){this.oUiApi.getLayoutView().setBusy(false);this.isOpenPath=false}if(this.isBackNavigation&&this.oCoreApi.getSteps().indexOf(t)===this.oCoreApi.getSteps().length-1){this.oUiApi.getLayoutView().setBusy(false);this.isBackNavigation=false}if(this.bLastValidState&&this.oCoreApi.getSteps().indexOf(t)===this.oCoreApi.getSteps().length-1){this.oUiApi.getLayoutView().setBusy(false);this.bLastValidState=false}this.isNewPath=false}catch(t){window.console.error("sap.apf .. analysisPath.controller catch exception: ",t);window.console.trace("trace ")}e.logReturn("updateCurrentStep",", isOpenPath="+this.isOpenPath)},drawMainChart:function(t,i){e.logCall("AnalysisPath.drawMainChart");var a=this.oUiApi.getStepContainer();a.getController().drawStepContent(t,i);e.logReturn("drawMainChart")},navigateToStep:function(t){this.getView().getCarouselView().getController().changeActiveStep(t)},apfDestroy:function(){e.logCall("AnalysisPath.apfDestroy ******");this.getView().getToolbar().getController().apfDestroy();this.getView().getCarouselView().getController().apfDestroy()}})});
//# sourceMappingURL=analysisPath.controller.js.map