/*!
 * SAP APF Analysis Path Framework
 * 
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/utils/trace","sap/ui/Device","sap/ui/core/Fragment","sap/ui/core/mvc/Controller","sap/ui/model/json/JSONModel"],function(e,t,i,a,s){"use strict";return a.extend("sap.apf.ui.reuse.controller.pathGallery",{onInit:function(){this.oCoreApi=this.getView().getViewData().oInject.oCoreApi;this.oUiApi=this.getView().getViewData().oInject.uiApi;this.oSerializationMediator=this.getView().getViewData().oInject.oSerializationMediator;if(t.system.desktop){this.getView().addStyleClass("sapUiSizeCompact")}},openPathGallery:async function(){if(this.oDialog){this.oDialog.destroy()}this.oDialog=await i.load({type:"JS",name:"sap.apf.ui.reuse.fragment.pathGallery",controller:this});var e=new s;var a=this.getPathGalleryData();e.setData(a);this.oDialog.setModel(e);if(t.system.desktop){this.oDialog.addStyleClass("sapUiSizeCompact")}this.oDialog.setInitialFocus(this.oDialog);this.oDialog.open()},getPathGalleryData:function(){var e=this;var t=this.getView().getViewData()?this.getView().getViewData().jsonData:{};var i=function(){var t={steps:e.oCoreApi.getStepTemplates()};return t};if(t.GalleryElements.length!==0){var a=t.GalleryElements;var s=i();var o,r,n,l;for(o=0;o<a.length;o++){for(r=0;r<a[o].StructuredAnalysisPath.steps.length;r++){for(n=0;n<s.steps.length;n++){var p=a[o].StructuredAnalysisPath.steps[r].stepId;var u=a[o].StructuredAnalysisPath.steps[r].selectedRepresentationId;if(p===s.steps[n].id){for(l in s.steps[n].getRepresentationInfo()){if(u===s.steps[n].getRepresentationInfo()[l].representationId){t.GalleryElements[o].StructuredAnalysisPath.steps[r].imgSrc=s.steps[n].getRepresentationInfo()[l].picture;t.GalleryElements[o].StructuredAnalysisPath.steps[r].title=e.oCoreApi.getTextNotHtmlEncoded(s.steps[n].title.key)}}}}}}}return t},openPath:function(t,i,a){e.log("pathGallery.openPath",", ",a,", guid",i,"***********************");var s=this;var o;var r=s.oUiApi.getAnalysisPath().getCarouselView();this.oDialog.setBusy(true);this.oUiApi.getAnalysisPath().getCarouselView().oController.removeAllThumbnails();s.oSerializationMediator.openPath(i,function(s){return function(n,l,p){var u=s.oUiApi.getLayoutView().getController();var h=s.oUiApi.getAnalysisPath().getController();e.log("pathGallery.openPath continuation",", activeStepindex=",a,", guid=",i);if(p===undefined&&typeof n==="object"){h.setIsOpenPath(true);s.oUiApi.contextChanged();h.refresh(-1);s.oCoreApi.updatePath(h.callBackForUpdatePath.bind(h));s.oCoreApi.setDirtyState(false);u.setPathTitle();if(s.oDialog!==undefined){s.oDialog.close()}r.rerender();s.oUiApi.getLayoutView().setBusy(false)}else{o=s.oCoreApi.createMessageObject({code:"6008",aParameters:[t]});o.setPrevious(p);s.oUiApi.getLayoutView().setBusy(false);s.oCoreApi.putMessage(o)}}}(this),a)}})});
//# sourceMappingURL=pathGallery.controller.js.map