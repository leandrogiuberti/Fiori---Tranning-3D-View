/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2018 SAP SE. All rights reserved
 */
sap.ui.define(["sap/apf/modeler/ui/controller/representationDimension.controller","sap/apf/modeler/ui/utils/constants","sap/apf/modeler/ui/utils/textManipulator"],function(e,t,r){"use strict";return e.extend("sap.apf.modeler.ui.controller.representationLegend",{getAllPropertiesAsPromise:function(){var e=this,a,o,n,i,s=[];var d=e.oStepPropertyMetadataHandler.oStep;var p=t;var l=jQuery.Deferred();e.oStepPropertyMetadataHandler.getEntityTypeMetadataAsPromise().done(function(t){d.getConsumablePropertiesForRepresentation(e.oRepresentation.getId()).done(function(d){a=d.consumable;a.forEach(function(r){if(e.oStepPropertyMetadataHandler.getPropertyMetadata(t,r)){i=e.oStepPropertyMetadataHandler.getPropertyMetadata(t,r)["aggregation-role"];if(i===p.aggregationRoles.DIMENSION){s.push(r)}}});o=e.getSelectedProperty();if(o!==e.oTextReader("none")&&o!==undefined){n=s.indexOf(o)!==-1?s:s.concat(o);s=d.available.indexOf(o)!==-1?n:s.concat(r.addPrefixText([o],e.oTextReader));o=d.available.indexOf(o)!==-1?o:r.addPrefixText([o],e.oTextReader)[0]}s.splice(0,0,e.oTextReader("none"));l.resolve({aAllProperties:s,sSelectedKey:o})})});return l.promise()},removeProperties:function(){var e=this;e.getView().getViewData().oRepresentationHandler.getActualLegends().forEach(function(t){e.oRepresentation.removeDimension(t.sProperty)})},enableDisableLabelDisplayOptionTypeAsPromise:function(){var e=jQuery.Deferred();var a,o=this;var n=o.byId("idLabelDisplayOptionType");var i=r.removePrefixText(o.byId("idPropertyType").getSelectedKey(),o.oTextReader(t.texts.NOTAVAILABLE));o.oStepPropertyMetadataHandler.getEntityTypeMetadataAsPromise().done(function(t){var r=o.oStepPropertyMetadataHandler.hasTextPropertyOfDimension(t,i);if(i===o.oTextReader("none")){n.setEnabled(false);e.resolve();return}n.setEnabled(true);for(a=0;a<n.getItems().length;a++){n.getItems()[a].setEnabled(true);if(a>0&&!r){n.getItems()[a].setEnabled(false)}}e.resolve()});return e.promise()},addPropertyAsPromise:function(){var e=jQuery.Deferred();var r=this,a,o=[];var n=r.oStepPropertyMetadataHandler.oStep;var i=t;r.oStepPropertyMetadataHandler.getEntityTypeMetadataAsPromise().done(function(t){n.getConsumablePropertiesForRepresentation(r.oRepresentation.getId()).done(function(n){n.consumable.forEach(function(e){if(r.oStepPropertyMetadataHandler.getPropertyMetadata(t,e)){a=r.oStepPropertyMetadataHandler.getPropertyMetadata(t,e)["aggregation-role"];if(a===i.aggregationRoles.DIMENSION){o.push(e)}}});r.getView().fireEvent(i.events.ADDPROPERTY,{sProperty:o[0],sContext:r.getView().getViewData().oPropertyTypeData.sContext});r.oConfigurationEditor.setIsUnsaved();e.resolve()})});return e.promise()}})});
//# sourceMappingURL=representationLegend.controller.js.map