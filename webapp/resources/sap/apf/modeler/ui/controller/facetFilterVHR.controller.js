/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2014 SAP AG. All rights reserved
 */
sap.ui.define(["sap/apf/modeler/ui/controller/requestOptions","sap/apf/modeler/ui/utils/constants","sap/apf/modeler/ui/utils/nullObjectChecker","sap/apf/modeler/ui/utils/optionsValueModelBuilder","sap/apf/modeler/ui/utils/textManipulator","sap/ui/layout/GridData"],function(e,t,i,r,a,n){"use strict";var l=e.extend("sap.apf.modeler.ui.controller.facetFilterVHR",{setDisplayText:function(){var e=this;var t=e.getView().getViewData().oTextReader;e.byId("idSourceLabel").setText(t("vhSource"));e.byId("idEntityLabel").setText(t("vhEntity"));e.byId("idSelectPropertiesLabel").setText(t("vhSelectProperties"));e.byId("idOptionalRequestFieldLabel").setText(t("ffAlias"))},clearVHRFields:function(e){var t=this;t.clearSource();t.addOrRemoveMandatoryFieldsAndRequiredFlag(false,e);t.setDetailData()},onBeforeRendering:function(){var e=this;var t=new n({span:"L6 M6 S6"});e.byId("idOptionalRequestField").setLayoutData(t);e.byId("idOptionalRequestFieldLabel").setVisible(true);e.byId("idOptionalRequestField").setVisible(true);e.byId("idOptionalRequestField").setForceSelection(false)},onAfterRendering:function(){var e=this;e.addOrRemoveMandatoryFieldsAndRequiredFlag(true)},fireRelevantEvents:function(e){var i=this,r;var n=i.getView().getViewData().oTextReader;if(e.getSource()===i.byId("idSource")){i.getView().fireEvent(t.events.facetFilter.UPDATEPROPERTIES)}if(e.getSource()!==i.byId("idOptionalRequestField")){r=[a.removePrefixText(i.byId("idOptionalRequestField").getSelectedKey(),n(t.texts.NOTAVAILABLE))];i.updateOptionalRequestFieldProperty(r)}if(i.oParentObject.getUseSameRequestForValueHelpAndFilterResolution()){i.getView().fireEvent(t.events.facetFilter.USESAMEASVHR)}},setOptionalRequestFieldProperty:function(){var e=this;var t=[],a,n;t=e.byId("idSelectProperties").getSelectedKeys();n=e.oParentObject.getAlias();if(i.checkIsNotNullOrUndefinedOrBlank(n)){a=e.validateSelectedValues(e,[n],t);n=a.aSelectedValues[0]}var l=r.convert(t);e.byId("idOptionalRequestField").setModel(l);e.byId("idOptionalRequestField").setSelectedKey(n)},updateOptionalRequestFieldProperty:function(e){var t=this;t.oParentObject.setAlias(undefined);if(i.checkIsNotNullOrUndefinedOrBlank(e[0])){t.oParentObject.setAlias(e[0])}},removeOptionalRequestFieldProperty:function(e){var t=this;if(i.checkIsNotNullOrUndefinedOrBlank(e[0])){t.oParentObject.setAlias(undefined)}},addOrRemoveMandatoryFieldsAndRequiredFlag:function(e,t){var i=this;if(e===false&&t===undefined){return}i.byId("idSourceLabel").setRequired(e);i.byId("idEntityLabel").setRequired(e);i.byId("idSelectPropertiesLabel").setRequired(e);if(e){i.viewValidator.addFields(["idSource","idEntity","idSelectProperties"])}else{i.viewValidator.removeFields(["idSource","idEntity","idSelectProperties"])}},getSource:function(){var e=this;return e.oParentObject.getServiceOfValueHelp()},getAllEntitiesAsPromise:function(e){var t=this;return t.oConfigurationEditor.getAllEntitySetsOfServiceAsPromise(e)},getEntity:function(){var e=this;return e.oParentObject.getEntitySetOfValueHelp()},getAllEntitySetPropertiesAsPromise:function(e,t){var i=this;return i.oConfigurationEditor.getAllPropertiesOfEntitySetAsPromise(e,t)},clearSource:function(){var e=this;e.oParentObject.setServiceOfValueHelp(undefined);e.clearEntity()},clearEntity:function(){var e=this;e.oParentObject.setEntitySetOfValueHelp(undefined);e.clearSelectProperties()},clearSelectProperties:function(){var e=this;var t=e.oParentObject.getSelectPropertiesOfValueHelp();t.forEach(function(t){e.oParentObject.removeSelectPropertyOfValueHelp(t)});e.clearOptionalRequestFieldProperty()},removeSelectProperties:function(e){var t=this;e.forEach(function(e){t.oParentObject.removeSelectPropertyOfValueHelp(e)})},clearOptionalRequestFieldProperty:function(){var e=this;e.oParentObject.setAlias(undefined)},updateSource:function(e){var t=this;t.oParentObject.setServiceOfValueHelp(e)},updateEntity:function(e){var t=this;t.oParentObject.setEntitySetOfValueHelp(e)},updateSelectProperties:function(e){var t=this;t.removeSelectProperties(t.oParentObject.getSelectPropertiesOfValueHelp());e.forEach(function(e){t.oParentObject.addSelectPropertyOfValueHelp(e)})},getSelectProperties:function(){var e=this;return e.oParentObject.getSelectPropertiesOfValueHelp()},getOptionalRequestFieldProperty:function(){var e=this;return[e.oParentObject.getAlias()]},getValidationState:function(){var e=this;return e.viewValidator.getValidationState()}});return l},true);
//# sourceMappingURL=facetFilterVHR.controller.js.map