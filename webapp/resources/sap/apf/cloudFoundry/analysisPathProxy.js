/*!
 * SAP APF Analysis Path Framework
 *
 * (c) Copyright 2012-2018 SAP SE. All rights reserved
 */
sap.ui.define(["sap/apf/cloudFoundry/utils","sap/apf/utils/exportToGlobal"],function(a,s){"use strict";var t=function(s){var t=s.instances.messageHandler;var e=s.instances.coreApi;var n=s.manifests.manifest;var i=n["sap.app"].dataSources;var r=i&&i["apf.runtime.analysisPaths"]&&i["apf.runtime.analysisPaths"].uri;var u={"Content-Type":"application/json; charset=utf-8"};var c=a.resolveUri.bind(this,s.instances.coreApi);this.openPath=function(a,s){var e=c(r+"/"+a+"?$select=AnalysisPathName,SerializedAnalysisPath");y({method:"GET",url:e,dataType:"json",success:function(a){var t={AnalysisPathName:a.analysisPath.analysisPathName,SerializedAnalysisPath:JSON.parse(a.analysisPath.serializedAnalysisPath)};s({path:t,status:"successful"},d())},error:function(s,e,n,i){var r=l(s,"5252",[a],i,t);t.putMessage(r)},headers:u})};this.createPath=function(a,s,e){var n=o();if(n===undefined){s({status:"failed"},undefined,t.createMessageObject({code:5075}));return}var i=h(e);var l={analysisPathName:a,analyticalConfiguration:n,structuredAnalysisPath:JSON.stringify(i),serializedAnalysisPath:JSON.stringify(e)};y({method:"POST",url:c(r),data:JSON.stringify(l),dataType:"json",success:function(a){s({AnalysisPath:a.analysisPath,status:"successful"},d())},error:function(a,e,n,i){var r=f(a,i,t);s({status:"failed"},undefined,r)},headers:u})};this.modifyPath=function(a,s,e,n){var i=h(n);var l={analysisPathName:s,structuredAnalysisPath:JSON.stringify(i),serializedAnalysisPath:JSON.stringify(n)};y({method:"PUT",url:c(r+"/"+a),data:JSON.stringify(l),dataType:"json",success:function(){e({AnalysisPath:a,status:"successful"},d())},error:function(a,s,n,i){var r=f(a,i,t);e({status:"failed"},undefined,r)},headers:u})};this.deletePath=function(a,s){y({method:"DELETE",url:c(r+"/"+a),success:function(){s({status:"successful"},d())},error:function(a,e,n,i){var r=f(a,i,t);s({status:"failed"},undefined,r)}})};this.readPaths=function(a){function s(a){var s=[];if(a.analysisPaths!==null){a.analysisPaths.forEach(function(a){s.push({AnalysisPath:a.analysisPath,AnalysisPathName:a.analysisPathName,LastChangeUTCDateTime:a.lastChangeUtcDateTime,StructuredAnalysisPath:JSON.parse(a.structuredAnalysisPath)})})}return s}var e=o();if(e===undefined){a({status:"failed"},undefined,t.createMessageObject({code:5075}));return}var n=c(r+"?$select=AnalysisPath,AnalysisPathName,LastChangeUtcDateTime,StructuredAnalysisPath&$filter=(AnalyticalConfiguration%20eq%20'"+e+"')");y({url:n,dataType:"json",success:function(t){var e=s(t);a({paths:e,status:"successful"},d())},error:function(s,e,n,i){var r=f(s,i,t);a({status:"failed"},undefined,r)},headers:u})};function d(){return undefined}function l(a,s,t,e,n){var i=n.createMessageObject({code:s,aParameters:t});var r=f(a,e,n);i.setPrevious(r);return i}function f(a,s,t){var e=t.createMessageObject({code:"5214",aParameters:[a.status,a.statusText]});if(s){e.setPrevious(s)}return e}function o(){var a=e.getStartParameterFacade().getAnalyticalConfigurationId();return a&&a.configurationId}function h(a){var s=[];var t=a.path.steps;t.forEach(function(a){s.push({stepId:a.stepId,selectedRepresentationId:a.binding.selectedRepresentationId})});return{steps:s,indexOfActiveStep:a.path.indicesOfActiveSteps[0]}}function y(a){s.instances.ajaxHandler.send(a)}};s("sap.apf.cloudFoundry.AnalysisPathProxy",t);return t},true);
//# sourceMappingURL=analysisPathProxy.js.map