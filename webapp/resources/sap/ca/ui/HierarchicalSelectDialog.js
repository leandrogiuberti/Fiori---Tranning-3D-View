/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.ca.ui.HierarchicalSelectDialog");jQuery.sap.require("sap.ca.ui.library");jQuery.sap.require("sap.m.Dialog");sap.m.Dialog.extend("sap.ca.ui.HierarchicalSelectDialog",{metadata:{deprecated:true,library:"sap.ca.ui",defaultAggregation:"items",aggregations:{items:{type:"sap.ca.ui.HierarchicalSelectDialogItem",multiple:true,singularName:"item"}},events:{select:{},cancel:{}}}});jQuery.sap.require("sap.ca.ui.utils.resourcebundle");jQuery.sap.require("sap.m.NavContainer");sap.ca.ui.HierarchicalSelectDialog.prototype.init=function(){sap.m.Dialog.prototype.init.apply(this);this.addStyleClass("sapCaUiHSD");this._oNavContainer=new sap.m.NavContainer(this.getId()+"hsAppContainer",{pages:[]});this._pageIdx=0;sap.m.Dialog.prototype.addContent.apply(this,[this._oNavContainer]);this.setEndButton(new sap.m.Button({text:sap.ca.ui.utils.resourcebundle.getText("hsd.cancelButton"),press:jQuery.proxy(function(){this.close();this.fireCancel()},this),width:"100%"}));this.setShowHeader(false);this.setContentWidth("250px");this.setContentHeight("350px");this.attachAfterOpen(function(){this._oNavContainer.backToTop();var e=this._oNavContainer.getPages();var t;for(t=0;t<e.length;++t){var a=e[t];var i=sap.ui.getCore().byId(a.getId()+"-searchfield");if(i){i.clear()}}})};sap.ca.ui.HierarchicalSelectDialog.prototype.addContent=function(e){if(e instanceof sap.ca.ui.HierarchicalSelectDialogItem){this.addItem(e)}else{jQuery.sap.log.error("Only sap.ca.ui.HierarchicalSelectDialogItem are authorized in HierarchicalSelectDialog, also please use the items aggregation")}};sap.ca.ui.HierarchicalSelectDialog.prototype.addItem=function(e){this.insertItem(e,this.getItems().length)};sap.ca.ui.HierarchicalSelectDialog.prototype.insertItem=function(e,t){var a=this.getId()+"p"+this._pageIdx;var i=e.getTitle();var s=e.getEntityName();var r=e.getListItemTemplate();var n=this.getId()+"p"+(this._pageIdx+1);var o=this._getPageContent(a,n,s,r);var l=new sap.m.Page(a,{title:i,content:o});var c=new sap.ui.core.CustomData({key:"list",value:o});var p=new sap.ui.core.CustomData({key:"itemTemplate",value:r});l.setSubHeader(new sap.m.Bar({contentMiddle:[new sap.m.SearchField(l.getId()+"-searchfield",{placeholder:sap.ca.ui.utils.resourcebundle.getText("hsd.searchTextField"),width:"100%",liveChange:this._onSearchItem,customData:[c,p]})]}));if(this._pageIdx!=0){l.setShowNavButton(true);l.attachNavButtonPress(jQuery.proxy(this._onNavigateBack,this));l.onBeforeShow=function(e){jQuery.each(e.data,function(e,t){l.setBindingContext(t,e)})}}else{this._oNavContainer.setInitialPage(l)}if(this._pageIdx>0){var u=this.getItems();u[u.length-1].getListItemTemplate().setType(sap.m.ListType.Navigation)}this._oNavContainer.addPage(l);this._pageIdx++;this.insertAggregation("items",e,t);return this};sap.ca.ui.HierarchicalSelectDialog.prototype._onSearchItem=function(e){var t=e.getParameter("newValue");var a=e.getSource().data("itemTemplate");var i=e.getSource().data("list").getBinding("items");if(t!==null&&t!==""){var s=a.getMetadata().getProperties();var r=[];jQuery.each(s,function(e,i){var s=a.getBindingInfo(e);if(s!=null){r.push(new sap.ui.model.Filter(s.binding.getPath(),sap.ui.model.FilterOperator.Contains,t))}});i.filter(new sap.ui.model.Filter(r,false))}else{i.filter(null)}};sap.ca.ui.HierarchicalSelectDialog.prototype._getPageContent=function(e,t,a,i){var s=new sap.m.List(e+"list");var r=new sap.ui.core.CustomData({key:"pageId",value:t});i.setType(sap.m.ListType.Active);i.setIconInset(true);i.attachPress(jQuery.proxy(this._onItemSelected,this));i.addCustomData(r);s.bindItems(a,i);return s};sap.ca.ui.HierarchicalSelectDialog.prototype._onNavigateBack=function(e,t,a){this._oNavContainer.back()};sap.ca.ui.HierarchicalSelectDialog.prototype._onItemSelected=function(e){var t=e.getSource();var a=t.data("pageId");var i=this._oNavContainer.getPage(a);if(i){i.setTitle(t.getTitle());this._oNavContainer.to(a,"slide",t.oBindingContexts)}else{this.fireSelect({selectedItem:t});this.close()}};
//# sourceMappingURL=HierarchicalSelectDialog.js.map