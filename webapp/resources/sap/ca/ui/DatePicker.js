/*!
 * SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2014 SAP SE. All rights reserved
 */
jQuery.sap.declare("sap.ca.ui.DatePicker");jQuery.sap.require("sap.ca.ui.library");jQuery.sap.require("sap.m.InputBase");sap.m.InputBase.extend("sap.ca.ui.DatePicker",{metadata:{deprecated:true,library:"sap.ca.ui",properties:{firstDayOffset:{type:"int",group:"Data",defaultValue:0},dateValue:{type:"string",group:"Misc",defaultValue:null}}}});jQuery.sap.require("sap.me.Calendar");jQuery.sap.require("sap.ca.ui.utils.resourcebundle");jQuery.sap.require("sap.ca.ui.model.type.Date");sap.ca.ui.DatePicker.prototype.init=function(){if(sap.m.InputBase.prototype.init){sap.m.InputBase.prototype.init.apply(this,arguments)}this.dateObj=null;this._oCalendar=new sap.me.Calendar({firstDayOffset:this.getFirstDayOffset(),tapOnDate:jQuery.proxy(function(e){if(!this._dateType){this._setUpDateType()}var t=e.getParameters().date;this.dateObj=new Date(t);var a=this._dateType.formatValue(t,"string");this.setDateValue(a);this.setProperty("value",a);this._lastValue=a;this.fireChange(false);this._closeCalendar()},this)});this._oCalendar.setEnableMultiselection(false);this._oCalendar.setDayHeight(45);this._datePickerCancelBtn=new sap.m.Button({text:sap.ca.ui.utils.resourcebundle.getText("dialog.cancel"),width:"100%",press:jQuery.proxy(function(){this._closeCalendar()},this)});if(jQuery.device.is.phone){this._oDatePickerDialogMobile=new sap.m.Dialog({title:sap.ca.ui.utils.resourcebundle.getText("datepicker.title"),leftButton:this._datePickerCancelBtn,stretchOnPhone:true,content:[this._oCalendar]})}else{this._oDatePickerPopoverDesktop=new sap.m.ResponsivePopover({title:sap.ca.ui.utils.resourcebundle.getText("datepicker.title"),placement:sap.m.PlacementType.Auto,enableScrolling:false,contentWidth:"20rem",contentHeight:"390px",content:[this._oCalendar]})}this.addStyleClass("sapCaUiDatePicker")};sap.ca.ui.DatePicker.prototype._setUpDateType=function(){var e=true;var t=this.getBindingInfo("value");if(t){var a=t.type;if(a&&a instanceof sap.ca.ui.model.type.Date){this._dateType=a;e=false}}if(e){this._dateType=new sap.ca.ui.model.type.Date}};sap.ca.ui.DatePicker.prototype.setValue=function(e){if(e!=this.getValue()){this.dateObj=null}sap.m.InputBase.prototype.setValue.call(this,e)};sap.ca.ui.DatePicker.prototype.setFirstDayOffset=function(e){this._oCalendar.setProperty("firstDayOffset",e,true);this.setProperty("firstDayOffset",e)};sap.ca.ui.DatePicker.prototype.fireChange=function(e){if(!this._dateType){this._setUpDateType()}var t=this.getValue();var a=this._validateDate(t);if(e||e===undefined){this.dateObj=a}this.setDateValue(a);var i=null;if(a){i=this._toDateStringYYYYMMDD(a)}this.fireEvent("change",{newValue:t,newYyyymmdd:i,invalidValue:a?false:true});return this};sap.ca.ui.DatePicker.prototype.exit=function(){if(sap.m.InputBase.prototype.exit){sap.m.InputBase.prototype.exit.apply(this)}if(this._oDatePickerPopoverDesktop){this._oDatePickerPopoverDesktop.destroy()}if(this._oDatePickerDialogMobile){this._oDatePickerDialogMobile.destroy()}if(this._datePickerCancelBtn){this._datePickerCancelBtn.destroy()}if(this._oCalendarIcon){this._oCalendarIcon.destroy()}};sap.ca.ui.DatePicker.prototype._closeCalendar=function(){if(jQuery.device.is.phone){this._oDatePickerDialogMobile.close()}else{this._oDatePickerPopoverDesktop.close()}};sap.ca.ui.DatePicker.prototype._getCalendarIcon=function(){if(!this._oCalendarIcon){var e=sap.ui.core.IconPool.getIconURI("appointment-2");this._oCalendarIcon=sap.ui.core.IconPool.createControlByURI({id:this.getId()+"__ci",src:e,press:jQuery.proxy(this._calendarIconPress,this)});this._oCalendarIcon.addStyleClass("sapMInputValHelpInner").addStyleClass("sapCaUiGreyIcon")}if(this.getEnabled()&&this.getEditable()){return this._oCalendarIcon}return null};sap.ca.ui.DatePicker.prototype._calendarIconPress=function(){if(this.getEditable()){if(!this._dateType){this._setUpDateType()}var e=this.getValue();var t=this._validateDate(e);this.setProperty("dateValue",t,true);if(t){this.dateObj=t}if(t){this._oCalendar.toggleDatesSelection(this._oCalendar.getSelectedDates(),false);this._oCalendar.setCurrentDate(this.dateObj);this._oCalendar.toggleDatesSelection([this.dateObj],true)}else{this._oCalendar.toggleDatesSelection(this._oCalendar.getSelectedDates(),false)}if(jQuery.device.is.phone){this._oDatePickerDialogMobile.open()}else{this._oDatePickerPopoverDesktop.openBy(this._oCalendarIcon)}}};sap.ca.ui.DatePicker.prototype._validateDate=function(e){if(!e){return e}var t=null;try{t=this._dateType.parseValue(e,"string")}catch(e){}return t};sap.ca.ui.DatePicker.prototype._toDateStringYYYYMMDD=function(e){var t=new Date(e);var a=""+t.getFullYear();var i=""+(t.getMonth()+1);var s=""+t.getDate();while(a.length<4){a="0"+a}while(i.length<2){i="0"+i}while(s.length<2){s="0"+s}return a+i+s};sap.ca.ui.DatePicker.prototype.getDate=function(){return this.dateObj};
//# sourceMappingURL=DatePicker.js.map