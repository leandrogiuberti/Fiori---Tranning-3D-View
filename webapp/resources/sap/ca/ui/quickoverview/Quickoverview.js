/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("sap.ca.ui.quickoverview.Quickoverview");jQuery.sap.require("sap.ui.base.Object");jQuery.sap.require("sap.ca.ui.utils.resourcebundle");sap.ca.ui.quickoverview.QuickviewUtils=function(){var e="initstuff";return{getAttrValue:function(e,i){if(!e){return""}var a=e.indexOf("{");var t=e.indexOf("}");if(a>-1&&i){var r=e;r=r.substring(a+1);r=r.substring(0,t-1);r=r.replace(/\//g,".");var o=r.substring(0,1);if(o==="."){r=r.substring(1)}var n=i.getData()[r];return n}else{return e}}}}();sap.ca.ui.quickoverview.QuickviewBase=function(){var e="qvPopover";var i="qvView";var a="qvBackBtn";var t="qvTitle";var r="qvNavCnt";var o=jQuery.sap.uid()+"-p1";var n="38rem";var v=null;var s=function(){return"sap.ca.ui.quickoverview.Quickview"};var u=function(){var e=sap.ui.getCore().byId(a);var i=sap.ui.getCore().byId(r);e.setVisible(i.getCurrentPage().sId!==i.getInitialPage())};var c=function(e,i,a,t){e.setModel(i.oModel);var r=e.getController();l(r,i,t);var o=r.configureView();f(i.title,a,i.popoverHeight);var n=i.afterQvConfigured;if(typeof n=="function"){n(o.oQvView,o.oSubView)}};var f=function(i,a,r){if(!i){i=sap.ca.ui.utils.resourcebundle.getText("Quickoverview.popovertitle")}var o=sap.ui.getCore().byId(t);o.setText(i);a.setTitle(i);var v=r;if(!v){v=n}var s=sap.ui.getCore().byId(e);s.setContentHeight(v);a.qvHeight=v};var g=function(e){var i=sap.ui.getCore().byId(t);i.setText(e.getTitle())};var p=function(i){var a=sap.ui.getCore().byId(e);a.setContentHeight(i.qvHeight)};var l=function(e,i,a){var t="";e.viewConfig={};e.viewConfig.headerNoIcon=i.headerNoIcon?i.headerNoIcon:false;e.viewConfig.headerTitle=i.headerTitle?i.headerTitle:t;e.viewConfig.headerSubTitle=i.headerSubTitle?i.headerSubTitle:t;e.viewConfig.headerImgURL=i.headerImgURL?i.headerImgURL:t;e.viewConfig.subViewName=i.subViewName?i.subViewName:t;e.viewConfig.quickOverview=a;e.viewConfig.beforeExtNav=i.beforeExtNav?i.beforeExtNav:t;e.viewConfig.beforeExtNavSubHdr=i.beforeExtNavSubHdr?i.beforeExtNavSubHdr:t};var d=function(){var i=e;var v=sap.ui.getCore().byId(i);if(!v){var s=new sap.m.NavContainer(r,{initialPage:o,height:"100%",pages:[new sap.m.Page(o,{showHeader:false,enableScrolling:true,content:[new sap.ui.view({id:"qvView",viewName:"sap.ca.ui.quickoverview.Quickview",type:sap.ui.core.mvc.ViewType.XML})]})]});var c=function(e){var i;if(e.mParameters.isBack){i=e.mParameters.fromId;var a=this.getPage(i);if(a){a.destroy();this.removePage(i)}g(this.getPage(e.mParameters.toId));p(this.getPage(e.mParameters.toId))}else if(e.mParameters.isBackToTop){var t=this.getPages().length;for(var r=t-1;r>-1;r--){i=this.getPages()[r].sId;if(i!==this.getInitialPage()){this.getPage(i).destroy();this.removePage(i)}}}u()};s.attachAfterNavigate(c);var f=new sap.m.Button({id:a,icon:"sap-icon://nav-back",visible:false,tap:function(){var e=sap.ui.getCore().byId(r);e.back()}});var l=new sap.m.Label({id:t,visible:true});var d=new sap.m.Bar({translucent:false,contentLeft:f,contentMiddle:l});v=new sap.m.ResponsivePopover(i,{customHeader:d,showHeader:true,placement:sap.m.PlacementType.Right,verticalScrolling:false,contentWidth:"20em",contentHeight:n,content:s});var w=function(){var e=sap.ui.getCore().byId(r);e.backToTop();u()};v.attachAfterClose(w);var b=jQuery.sap.getModulePath("sap/ca/ui")+"/themes/base/QuickOverview.css";jQuery.sap.includeStyleSheet(b)}return v};return{initQVPopover:function(e){var i=d()},openQVPopover:function(a,t,r,n){var v=sap.ui.getCore().byId(i);var s=sap.ui.getCore().byId(o);c(v,t,s,n);try{var u=sap.ui.getCore().byId(e);if(!r){u.setOffsetX(0);u.setOffsetY(0);u.setPlacement(sap.m.PlacementType.Horizontal)}else{u.setOffsetX(r.offsetX);u.setOffsetY(r.offsetY);u.setPlacement(r.placement)}u.openBy(a)}catch(e){}},navQVPopover:function(e,i){var a=new sap.ui.view({viewName:"sap.ca.ui.quickoverview.Quickview",type:sap.ui.core.mvc.ViewType.XML});var t=new sap.m.Page({showHeader:false,enableScrolling:true,content:[a]});c(a,e,t,i);var o=sap.ui.getCore().byId(r);o.addPage(t);o.to(t.getId(),"show")}}}();sap.ui.base.Object.extend("sap.ca.ui.quickoverview.Quickoverview",{iControlType:0,oConfig:{},oParentCard:undefined,oSourceControl:undefined,constructor:function(e,i,a){if(!e)return;this.oInitialConfig=e;sap.ca.ui.quickoverview.QuickviewBase.initQVPopover(this.oParentCard)},openBy:function(e,i){if(!this.oInitialConfig)return;this.oSourceControl=e;sap.ca.ui.quickoverview.QuickviewBase.openQVPopover(e,this.oInitialConfig,i,this);return},navigateTo:function(e){sap.ca.ui.quickoverview.QuickviewBase.navQVPopover(e,this)}});
//# sourceMappingURL=Quickoverview.js.map