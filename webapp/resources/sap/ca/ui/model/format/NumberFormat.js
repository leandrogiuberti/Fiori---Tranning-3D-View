/*
 * Copyright (C) 2009-2014 SAP SE or an SAP affiliate company. All rights reserved
 */
jQuery.sap.declare("sap.ca.ui.model.format.NumberFormat");jQuery.sap.require("sap.ui.core.LocaleData");jQuery.sap.require("sap.ca.ui.model.format.FormatHelper");jQuery.sap.require("sap.ca.ui.utils.resourcebundle");sap.ca.ui.model.format.NumberFormat=function(){throw new Error};sap.ca.ui.model.format.NumberFormat.oValueInfo={oDefaultFormatOptions:{style:"standard"}};sap.ca.ui.model.format.NumberFormat.getInstance=function(a,e){return this.createInstance(a,e,this.oValueInfo)};sap.ca.ui.model.format.NumberFormat.createInstance=function(a,e,t){var r=jQuery.sap.newObject(this.prototype);if(a instanceof sap.ui.core.Locale){e=a;a=undefined}if(!e){e=sap.ui.getCore().getConfiguration().getFormatSettings().getFormatLocale()}r.oLocale=e;r.oLocaleData=sap.ui.core.LocaleData.getInstance(e);r.oFormatOptions=jQuery.extend(false,{},t.oDefaultFormatOptions,a);r.oFormatOptions.formatStyle="standard";r.init();return r};sap.ca.ui.model.format.NumberFormat.prototype.init=function(){};sap.ca.ui.model.format.NumberFormat.prototype.format=function(a){var e="";var t="format_"+this.oFormatOptions.style;if(this[t]){e=this[t](a)}else{e=this.format_standard(a)}return e};sap.ca.ui.model.format.NumberFormat.prototype.format_standard=function(a){var e=sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions,this.oLocale);return sap.ca.ui.model.format.FormatHelper.formatNumber(a,e)};sap.ca.ui.model.format.NumberFormat.prototype.format_short=function(a){var e;var t;var r;function o(a){var r;if(!t){t=sap.ui.core.LocaleData.getInstance(e.locale)._get("decimalFormat-short");if(!t){var o=new sap.ui.core.Locale("en");t=sap.ui.core.LocaleData.getInstance(o)._get("decimalFormat-short")}}if(t){var i=1;while(Math.abs(a)>=i*10&&i<1e14){i=i*10}var m=t[i.toString()+"-other"];r={};if(!m||m=="0"){r.magnitude=1}else{r.formatString=m;var s=m.match(/0+\.*0*/);if(s){r.valueSubString=s[0];var n=r.valueSubString.indexOf(".");if(n==-1){r.decimals=0;r.magnitude=i*Math.pow(10,1-r.valueSubString.length)}else{r.decimals=r.valueSubString.length-n-1;r.magnitude=i*Math.pow(10,1-n)}}else{r.magnitude=1}}}return r}var i=sap.ca.ui.model.format.FormatHelper.toNumeric(a);if(!isFinite(i)){return""}var m="";e=sap.ca.ui.model.format.FormatHelper.getFormatOptions(this.oFormatOptions,this.oLocale);r=o(i);if(!r){return this.format_standard(a)}var s=i/r.magnitude;var n={};n.shortRounding=e.shortRounding;n.rounding=e.rounding;if(r.magnitude==1){n.formatStyle="standard";n.decimals=e.decimals}else if(e.shortDecimals){n.formatStyle="short";n.shortDecimals=e.shortDecimals}else{n.formatStyle="short";n.shortDecimals=r.decimals}s=sap.ca.ui.model.format.FormatHelper.roundNumber(s,n);r=o(s*r.magnitude);if(!r||r.magnitude==1){m=this.format_standard(a)}else{s=sap.ca.ui.model.format.FormatHelper.roundNumber(i/r.magnitude,n);if(!e.shortDecimals){e.shortDecimals=r.decimals}e.formatStyle="short";m=sap.ca.ui.model.format.FormatHelper.formatNumber(s,e);m=r.formatString.replace(r.valueSubString,m);m=m.replace(/'.'/g,".")}return m};sap.ca.ui.model.format.NumberFormat.prototype.parse=function(a){var e=sap.ui.core.format.NumberFormat.getInstance(this.oFormatOptions,this.oLocale);if(e.oFormatOptions.groupingSeparator=="Â "){a=a.replace(/ /g,e.oFormatOptions.groupingSeparator)}return e.parse(a)};sap.ca.ui.model.format.NumberFormat.prototype.format_percentage=function(a){var e,t;if(this.oFormatOptions.decimals===undefined){this.oFormatOptions.decimals=0}var r=sap.ca.ui.model.format.FormatHelper.toNumeric(a);r=r*100;var o=this.format_standard(r);var i=sap.ui.core.LocaleData.getInstance(this.oLocale)._get("percentFormat");if(!i){t=new sap.ui.core.Locale("en");i=sap.ui.core.LocaleData.getInstance(t)._get("percentFormat")}var m=i["standard"];if(m===undefined||m==""){e=o;jQuery.sap.log.error("no percent format available for the current locale")}else{var s=/[\.0,#]+/;var n=m.replace(s,o);var u=sap.ui.core.LocaleData.getInstance(this.oLocale)._get("symbols-latn-percentSign");if(!u){t=new sap.ui.core.Locale("en");u=sap.ui.core.LocaleData.getInstance(t)._get("symbols-latn-percentSign")}e=n.replace(/\u0025/,u)}return e};
//# sourceMappingURL=NumberFormat.js.map