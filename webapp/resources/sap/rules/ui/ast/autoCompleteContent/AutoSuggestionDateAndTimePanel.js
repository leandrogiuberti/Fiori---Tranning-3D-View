sap.ui.define(["sap/ui/thirdparty/jquery","../../library","sap/ui/core/Control","sap/m/List","sap/m/Dialog","sap/m/Button","sap/m/DatePicker","sap/m/DateTimePicker","sap/m/TimePicker","sap/ui/model/json/JSONModel","sap/m/library","sap/ui/core/CustomData","sap/ui/model/Sorter","sap/ui/core/LocaleData","sap/rules/ui/Constants","sap/rules/ui/AstExpressionBasic","sap/rules/ui/services/AstExpressionLanguage","sap/base/i18n/Formatting","sap/base/i18n/date/CalendarType","sap/ui/core/format/DateFormat","sap/m/Link","sap/m/Panel","sap/m/ToolbarSpacer","sap/ui/core/Lib","sap/ui/core/Element","./AutoSuggestionDateAndTimePanelRenderer"],function(jQuery,e,t,a,s,i,n,r,o,u,l,d,p,h,c,g,D,m,T,f,y,_,B,x,v,w){"use strict";var b=l.ListMode;var C=t.extend("sap.rules.ui.ast.autoCompleteContent.AutoSuggestionDateAndTimePanel",{metadata:{library:"sap.rules.ui",properties:{reference:{type:"object",defaultValue:null},data:{type:"object",defaultValue:null},dialogOpenedCallbackReference:{type:"object",defaultValue:null},vocabularyInfo:{type:"object",defaultValue:null}},aggregations:{PanelLayout:{type:"sap.m.Panel",multiple:false}},associations:{astExpressionLanguage:{type:"sap.rules.ui.services.AstExpressionLanguage",multiple:false,singularName:"astExpressionLanguage"}},events:{}},init:function(){this.needCreateLayout=true;this.oBundle=x.getResourceBundleFor("sap.rules.ui.i18n");this.vocabularyInfo=this.getVocabularyInfo();this.autoSuggestionData=this.getData();var e=m.getLanguageTag();var t=h.getInstance(e);this.oFormatDate=f.getInstance({pattern:t.getDatePattern("short"),calendarType:T.Gregorian},e)},onBeforeRendering:function(){this._reference=this.getReference();this._dialogOpenedCallbackReference=this.getDialogOpenedCallbackReference();if(this.needCreateLayout){var e=this._createLayout();this.setAggregation("PanelLayout",e,true);this.needCreateLayout=false}},_createDateTimeDialog:function(){var e=this;var t=m.getLanguageTag();var a=h.getInstance(t);var o=a.getDatePattern("medium");var u=a.getTimePattern("medium");var l=o+" "+u;if(this.dateContext){this._dateBusinessDataType=this.dateContext}if(this._dateBusinessDataType==="D"){this.control=new n({width:"auto",type:"Date",valueFormat:o})}if(this._dateBusinessDataType==="U"){var e=this;this.control=new r({width:"auto",valueFormat:l})}this._oSelectNewDateDialog=new s({title:this.oBundle.getText("calendarTitle"),content:[this.control],beginButton:new i({text:this.oBundle.getText("okBtn"),enabled:true,press:function(t){var a=this._updateText(this.control);t.oSource.mProperties.value="'"+a+"'";e._reference(t);e._setModal(false);e._oSelectNewDateDialog.close()}.bind(this)}),endButton:new i({text:this.oBundle.getText("clsBtn"),press:function(){e._setModal(false);e._oSelectNewDateDialog.close()}.bind(this)})});this._dialogOpenedCallbackReference(true);this._setModal(true);this._oSelectNewDateDialog.open()},_updateText:function(e){var t=e._getInputValue();var a=this._getValidValue(t);return a},_getValidValue:function(e){var t,a;if(this.dateContext){this._dateBusinessDataType=this.dateContext}if(this._dateBusinessDataType==="D"){t=new Date(e);a=f.getDateInstance({pattern:"yyyy-MM-dd"});return a.format(t)}else if(this._dateBusinessDataType==="U"){t=new Date(e);a=f.getDateTimeInstance({pattern:"yyyy-MM-dd'T'HH:mm:ss.sss'Z'"});return a.format(t)}return e},_setModal:function(e){var t=v.getElementById("popover");if(t){t.setModal(e)}},_getDataBusinessDataType:function(){this._dateBusinessDataType="";this.businessDataTypeList=this.getData().businessDataTypeList;for(var e in this.businessDataTypeList){if(this.businessDataTypeList[e]==="D"){this._dateBusinessDataType="D";this.showDate=true}if(this.businessDataTypeList[e]==="U"){this._dateBusinessDataType="U";this.showTimeStamp=true}}if(this.showDate&&this.showTimeStamp){this.showDateAndTimeStamp=true}},_createLayout:function(){var e=this;this._getDataBusinessDataType();if(this._dateBusinessDataType!=""&&!this.showDateAndTimeStamp){return this._createEitherDateOrTimeBasedOnType()}else{return this._createBothDateAndTime()}},_createEitherDateOrTimeBasedOnType:function(){var e=this;if(this._dateBusinessDataType==="D"){this.textContent=this.oBundle.getText("select_date")}else if(this._dateBusinessDataType==="U"){this.textContent=this.oBundle.getText("select_date_time")}this.content=new y({wrapping:true,text:this.textContent,press:function(t){e._createDateTimeDialog()}});var t=new _({expandable:false,expanded:true,content:[this.content],width:"auto"});return t},_createBothDateAndTime:function(){var e=this;this.dateContent=new y({wrapping:true,text:this.oBundle.getText("select_date"),press:function(t){e.dateContext="D";e._createDateTimeDialog()}});this.toolBarSpacer=new B({width:"1em"});this.timeContent=new y({wrapping:true,text:this.oBundle.getText("select_date_time"),press:function(t){e.dateContext="U";e._createDateTimeDialog()}});var t=new _({headerText:this.oBundle.getText("dateTimePanelTitle"),expandable:true,expanded:false,width:"auto"});t.addContent(this.dateContent);t.addContent(this.toolBarSpacer);t.addContent(this.timeContent);return t},renderer:w});return C},true);
//# sourceMappingURL=AutoSuggestionDateAndTimePanel.js.map