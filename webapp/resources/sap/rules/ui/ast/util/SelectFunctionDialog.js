sap.ui.define(["sap/ui/core/Control","sap/m/List","sap/ui/model/json/JSONModel","sap/rules/ui/ast/constants/Constants","sap/rules/ui/parser/infrastructure/util/utilsBase","sap/rules/ui/ast/util/utilsBase","sap/m/Select","sap/ui/layout/GridData","sap/ui/core/ListItem","sap/m/ColumnListItem","sap/ui/layout/HorizontalLayout","sap/m/library","sap/m/Button","sap/ui/core/IconPool","sap/m/TextArea","sap/m/Table","sap/m/Column","sap/m/Text","sap/ui/layout/form/SimpleForm","sap/m/Label","sap/m/Dialog","sap/ui/core/Lib","sap/ui/core/Element"],function(e,t,a,s,n,i,o,r,l,c,d,u,b,h,p,f,g,_,S,v,O,I,y){"use strict";var T;var F=function(){this.oBundle=I.getResourceBundleFor("sap.rules.ui.i18n");this.functionLabelDisplay="";this.functionLabel="";this._selectFunctionSelected="";this._whereExpressionId="";this.dataObjectId="";this._count=0;this.dataObjectLabel="";this.dataObjectIdSelected="";this.enableCountField=true;this.sortOrder=[{name:s.NOSORT,label:this.oBundle.getText("no_sorting")},{name:s.SORTASC,label:this.oBundle.getText("sort_ascending")},{name:s.SORTDESC,label:this.oBundle.getText("sort_descending")}];this.selectedData=[{attributeSelected:"",sortOrder:s.NOSORT,cancelButton:false,addButton:true}];this.enabledData={enabled:false};this.dataObjectIdData={dataObjectId:""}};F.prototype._filterSelectFunction=function(e){var t=[];if(e&&e.selection){for(var a=0;a<e.selection.length;a++){if(e.selection[a].name!==s.SORTASC&&e.selection[a].name!==s.SORTDESC&&e.selection[a].name!==s.BOTTOM){t.push(e.selection[a])}}return{selection:t}}};F.prototype._createFunctionSelectionDropDown=function(e,t){var n=this;e=this._filterSelectFunction(e);var i=new a(e);this.functionSelect=new o({width:"200px",selectedKey:this._selectFunctionSelected,forceSelection:false,showSecondaryValues:true,layoutData:new r({span:"L3 M3 S12"}),ariaLabelledBy:t,change:function(e){n._selectFunctionSelected=e.getSource().getSelectedItem().getText();if(n._selectFunctionSelected===s.SELECT||n._selectFunctionSelected===s.FIRST){n._countField.setEnabled(false);n._countField.setValue("");n._count=""}else{n._countField.setEnabled(true)}if(n.dataObjectId&&n._selectFunctionSelected&&(n._count||n._selectFunctionSelected===s.SELECT||n._selectFunctionSelected===s.FIRST)){n.functionLabelDisplay=n._count?n._selectFunctionSelected+"("+n.dataObjectLabel+","+n._count+")":n._selectFunctionSelected+"("+n.dataObjectLabel+")";n.functionLabel=n._count?n._selectFunctionSelected+"("+n.dataObjectId+","+n._count+")":n._selectFunctionSelected+"("+n.dataObjectId+")";n.functionLabelField.setValue(n.functionLabelDisplay);if(n._selectFunctionSelected!==s.SELECT&&n._count>0||this.oModel.getData().selectionData[0].attributeSelected!==""&&n._selectFunctionSelected===s.SELECT||n._selectFunctionSelected===s.FIRST&&n.dataObjectId){this.applyButton.setEnabled(true)}else{this.applyButton.setEnabled(false)}this.astExpressionBasicForWhere.setEditable(true)}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("")}}.bind(this)}).addStyleClass("sapAstExpressionDialogField");this.functionSelect.setModel(i);this.functionSelect.bindItems({path:"/selection",template:new l({text:"{name}",key:"{name}",additionalText:"{label}"})});return this.functionSelect};F.prototype._getAttributeAstExpressionBasic=function(e,t){var a=this;this.astExpressionBasicForAttribute=new t({astExpressionLanguage:this._oAstExpressionLanguage,enableAggregateFunctionWhereClause:true,value:"{attributeSelected}",dataObjectInfo:"{/dataObjectIdData/dataObjectId}",isAttributeContext:true,editable:"{/enabledData/enabled}",ariaLabelledBy:e,change:function(e){var t=parseInt(e.getSource().getBindingContext().sPath.split("/")[2]);a._AttributeExpressionId=e.getParameter("newValue");var n=a.oModel.getData().selectionData;if(this._attributeAlreadySelected(n)){e.oSource.setValueState("Error");e.oSource.setValueStateText(this.oBundle.getText("duplicateAttribute"))}else{e.oSource.setValueState("None")}if(a._AttributeExpressionId){n[t].attributeSelected=a._AttributeExpressionId.trim()}var i=a._setDataObjectInfoForWhereConditionAutoSuggestion();a.astExpressionBasicForWhere.setDataObjectInfo(i);if(a._selectFunctionSelected!==s.SELECT&&a._count>0||this.oModel.getData().selectionData[0].attributeSelected!==""&&a._selectFunctionSelected===s.SELECT||a._selectFunctionSelected===s.FIRST&&a.dataObjectId){this.applyButton.setEnabled(true)}else{this.applyButton.setEnabled(false)}this.astExpressionBasicForWhere.setValue("");this._whereExpressionId=""}.bind(this)});this.astExpressionBasicForAttribute.addStyleClass("sapAstExpressionDialog");return this.astExpressionBasicForAttribute};F.prototype._attributeAlreadySelected=function(e){var t=0;for(var a in e){if(e[a].attributeSelected.trim()===this._AttributeExpressionId.trim()){t++}}if(t>1){return true}return false};F.prototype._tableColumnsFactory=function(e){var t=this;var a=new c({cells:[t._getAttributeAstExpressionBasic("selectAttributeLabelId"+t.selectLabelUUID,e),new o({enabled:"{/enabledData/enabled}",items:{path:"/sortOrder",template:new l({key:"{name}",text:"{label}"})},change:function(e){var a=parseInt(e.getSource().getBindingContext().sPath.split("/")[2]);t._sortOrder=e.getSource().getSelectedItem().getKey();t.oModel.getData().selectionData[a].sortOrder=t._sortOrder}.bind(this),selectedKey:"{sortOrder}",width:"200px",tooltip:t.oBundle.getText("sort_attributes_tooltip")}).addStyleClass("sapAstExpressionDialogField sapAstExpressionSortSelect"),new d({content:[new b({type:u.ButtonType.Transparent,icon:h.getIconURI("sys-cancel"),visible:"{cancelButton}",enabled:"{/enabledData/enabled}",press:function(e){var t=e.getSource().getParent().getParent().getBindingContextPath().split("/")[2];this._removeColumnFromJsonModel(parseInt(t))}.bind(this)}),new b({type:u.ButtonType.Transparent,icon:h.getIconURI("add"),visible:"{addButton}",enabled:"{/enabledData/enabled}",press:function(e){var t=e.getSource().getParent().getParent().getBindingContextPath().split("/")[2];this._addColumnToJsonModel(parseInt(t))}.bind(this)})]})]});return a};F.prototype._addColumnToJsonModel=function(e){var t={attributeSelected:"",sortOrder:s.NOSORT,cancelButton:true,addButton:true};this.selectedData.splice(e+1,0,t);if(this.selectedData.length>1){this.selectedData[0].cancelButton=true}this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData})};F.prototype._removeColumnFromJsonModel=function(e){this.selectedData.splice(e,1);if(this.selectedData.length===1){this.selectedData[0].cancelButton=false}this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData});var t=this._setDataObjectInfoForWhereConditionAutoSuggestion();this.astExpressionBasicForWhere.setDataObjectInfo(t);this.astExpressionBasicForWhere.setValue("");this._whereExpressionId=""};F.prototype._getSuggestionsForTheGivenInput=function(e){var t=this._oAstExpressionLanguage.getTokensForGivenStringInput(e);var a=this._oAstExpressionLanguage.convertTokensToUiModelForAutoSuggestion(t);var s={};s.AttributeContext=true;s.OperationsContext=false;var n=this._oAstExpressionLanguage.getSuggesstions(a,s);return n};F.prototype._createDataObjectDropDown=function(e){var t=this;var n=this._getSuggestionsForTheGivenInput("");var i=n.autoComplete.categories;var c=new a(i);this.vocabularySelect=new o({width:"200px",selectedKey:this.dataObjectIdSelected,forceSelection:false,ariaLabelledBy:e,layoutData:new r({span:"L3 M3 S12"}),change:function(e){t.dataObjectIdSelected=e.getSource().getSelectedItem().getKey();t.dataObjectId="/"+e.getSource().getSelectedItem().getKey();t.dataObjectLabel=e.getSource().getSelectedItem().getText();if(t.dataObjectId){t.oModel.getData().dataObjectIdData.dataObjectId=t.dataObjectId;t.oModel.getData().enabledData.enabled=true}this.selectedData=[{attributeSelected:"",sortOrder:s.NOSORT,cancelButton:false,addButton:true}];var a=t._setDataObjectInfoForWhereConditionAutoSuggestion();t.astExpressionBasicForWhere.setDataObjectInfo(a);if(t.dataObjectId&&t._selectFunctionSelected&&(t._count||t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST)){t.functionLabelDisplay=t._count?t._selectFunctionSelected+"("+t.dataObjectLabel+","+t._count+")":t._selectFunctionSelected+"("+t.dataObjectLabel+")";t.functionLabel=t._count?t._selectFunctionSelected+"("+t.dataObjectId+","+t._count+")":t._selectFunctionSelected+"("+t.dataObjectId+")";t.functionLabelField.setValue(t.functionLabelDisplay);if(t._selectFunctionSelected!==s.SELECT&&t._count>0||this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST&&t.dataObjectId){this.applyButton.setEnabled(true)}else{this.applyButton.setEnabled(false)}this.astExpressionBasicForWhere.setValue("");this._whereExpressionId="";this.astExpressionBasicForWhere.setEditable(true)}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("")}t._bindAttributes()}.bind(this)}).addStyleClass("sapAstExpressionDialogField");this.vocabularySelect.setModel(c);this.vocabularySelect.bindItems({path:"/terms",template:new l({text:"{label}",key:"{id}"})});var d=n.autoComplete.categories.vocabularyRules;for(var u in d){var b=new l({text:d[u].label,key:d[u].id});this.vocabularySelect.addItem(b)}return this.vocabularySelect};F.prototype._bindAttributes=function(){this.oModel=new a;this.oModel.setData({sortOrder:this.sortOrder,selectionData:this.selectedData,enabledData:this.enabledData,dataObjectIdData:this.dataObjectIdData});this.conditionsTable.setModel(this.oModel)};F.prototype._createWhereAstExpressionBasic=function(e,t){var a=this;this.astExpressionBasicForWhere=new t({astExpressionLanguage:this._oAstExpressionLanguage,enableAggregateFunctionWhereClause:true,value:this._whereExpressionId,editable:"{/value}",dataObjectInfo:this._setDataObjectInfoForWhereConditionAutoSuggestion(),ariaLabelledBy:e,change:function(e){a._whereExpressionId=e.getParameter("newValue")}.bind(this)});this.astExpressionBasicForWhere.addStyleClass("sapAstExpressionDialog");return this.astExpressionBasicForWhere};F.prototype._setDataObjectInfoForWhereConditionAutoSuggestion=function(){if(this.dataObjectId){var e=this._returnDataObjectBasedOnCommonAssociationReferenceAndType(this.dataObjectId,this._getSelectedAttributeJsons());return this._selectFunctionSelected+"("+s.FILTER+"("+e+","}};F.prototype._createFunctionLabel=function(){this.functionLabelField=new p({value:this.functionLabelDisplay,enabled:false,width:"100%"}).addStyleClass("sapAstExpressionDialogTextField");return this.functionLabelField};F.prototype._clearData=function(){this.functionLabelDisplay="";this.functionLabel="";this._selectFunctionSelected="";this._whereExpressionId="";this.dataObjectId="";this._count="";this.dataObjectLabel="";this.dataObjectIdSelected="";this.enableCountField=false;this.attributeJson={};this.sortOrder=[{name:s.NOSORT,label:this.oBundle.getText("no_sorting")},{name:s.SORTASC,label:this.oBundle.getText("sort_ascending")},{name:s.SORTDESC,label:this.oBundle.getText("sort_descending")}];this.selectedData=[{attributeSelected:"",sortOrder:s.NOSORT,cancelButton:false,addButton:true}];this.enabledData={enabled:false};this.dataObjectIdData={dataObjectId:""}};F.prototype._createTable=function(e){var t=this;this.conditionsTable=new f({backgroundDesign:u.BackgroundDesign.Solid,showSeparators:u.ListSeparators.None,columns:[new g({width:"50%"}).setStyleClass("sapAstAttributeColumn"),new g({width:"25%"}).setStyleClass("sapAstSortColumn"),new g({width:"20%"})]}).addStyleClass("sapAstAttributeTable");this._bindAttributes();var a=t._tableColumnsFactory(e);this.conditionsTable.bindItems("/selectionData",a);return this.conditionsTable};F.prototype._createCountField=function(e){var t=this;this._countField=new p({value:t._count,enabled:this.enableCountField,ariaLabelledBy:e,layoutData:new r({span:"L1 M1 S12"}),change:function(e){t._count=e.getSource().getValue();if(t.dataObjectId&&t._selectFunctionSelected&&(t._count||t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST)){t.functionLabelDisplay=t._count?t._selectFunctionSelected+"("+t.dataObjectLabel+","+t._count+")":t._selectFunctionSelected+"("+t.dataObjectLabel+")";t.functionLabel=t._count?t._selectFunctionSelected+"("+t.dataObjectId+","+t._count+")":t._selectFunctionSelected+"("+t.dataObjectId+")";t.functionLabelField.setValue(t.functionLabelDisplay);if(t._selectFunctionSelected!==s.SELECT&&t._count>0||this.oModel.getData().selectionData[0].attributeSelected!==""&&t._selectFunctionSelected===s.SELECT||t._selectFunctionSelected===s.FIRST&&t.dataObjectId){this.applyButton.setEnabled(true)}else{this.applyButton.setEnabled(false)}this.astExpressionBasicForWhere.setEditable(true)}else{this.applyButton.setEnabled(false);this.astExpressionBasicForWhere.setEditable(false);this.astExpressionBasicForWhere.setValue("");this.functionLabelField.setValue("")}}.bind(this)}).addStyleClass("sapAstSelectCountField sapAstExpressionDialogTextField");return this._countField};F.prototype._convertFunctionLabelToText=function(e,t){this.termsProvider=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider;var a=this.termsProvider.getTermNameFromASTNodeReference(e);t=t.replace(e,a);return t};F.prototype._createSelectFunctionDialog=function(e,t,a,n,i){var o=this;var l=0;this._clearData();this.selectLabelUUID=this._createUUId();this.oBundle=I.getResourceBundleFor("sap.rules.ui.i18n");this._oAstExpressionLanguage=a;sap.ui.require(["sap/rules/ui/AstExpressionBasic"],a=>{if(i){this._selectFunctionSelected=i.function;this._whereExpressionId=i.filter;this.dataObjectId=i.dataObject;this.functionLabel=i.functionLabel;this.dataObjectIdSelected=i.dataObject.replace("/","");this.attributeJson=i.attributes;if(i.count){this._count=i.count;this.enableCountField=true}o.functionLabelDisplay=this._convertFunctionLabelToText(i.dataObject,i.functionLabel);if(this.dataObjectId){var c=this._returnDataObjectBasedOnCommonAssociationoReferenceSelection(i.doVocabId,i.attributes);this.attributeJson=this._addTableIdFromAttribute(i.attributes,c,this.dataObjectId);this.dataObjectIdData.dataObjectId=this.dataObjectId;this.enabledData.enabled=true;this.termsProvider=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider;this.dataObjectLabel=this.termsProvider.getTermNameFromASTNodeReference(this.dataObjectId)}if(!jQuery.isEmptyObject(this.attributeJson)){this.selectedData=[];for(var d in this.attributeJson){var u={attributeSelected:"",sortOrder:s.NOSORT,cancelButton:true,addButton:true};u.attributeSelected=d;u.sortOrder=this.attributeJson[d];this.selectedData.push(u);l++}if(l===1){this.selectedData[0].cancelButton=false}}if(this._selectFunctionSelected===s.SELECT){this.enableCountField=false}}var h=o._createFunctionSelectionDropDown(e,"selectFunctionSelectionLabelId",+o.selectLabelUUID);var p=new _({text:"Count",tooltip:"Count",textAlign:"End",layoutData:new r({span:"L1 M1 S12"})});var f=new _({text:o.oBundle.getText("vocabulary"),tooltip:o.oBundle.getText("vocabulary"),textAlign:"End",layoutData:new r({span:"L2 M2 S12"})});var g=o._createTable(a);var I=o._createWhereAstExpressionBasic("selectWhereLabelId"+o.selectLabelUUID,a);var y=o._createFunctionLabel();var T=new S({layout:"ResponsiveGridLayout",editable:true,content:[new v("selectFunctionSelectionLabelId"+o.selectLabelUUID,{text:o.oBundle.getText("function"),tooltip:o.oBundle.getText("function"),labelFor:h.getId()}),h,p,o._createCountField(p.getId()),f,o._createDataObjectDropDown(f.getId(),a),new v("selectAttributeLabelId"+o.selectLabelUUID,{text:o.oBundle.getText("attributes"),tooltip:o.oBundle.getText("attributes"),labelFor:g.getId()}).addStyleClass("sapAstAttributeLabel"),g,new v("selectWhereLabelId"+o.selectLabelUUID,{text:o.oBundle.getText("where"),tooltip:o.oBundle.getText("where"),labelFor:I.getId()}),I,new v({text:o.oBundle.getText("function_label"),tooltip:o.oBundle.getText("function_label"),labelFor:y.getId()}),y]});var F=new O({title:this.oBundle.getText("selectFunctionTitle"),contentWidth:"800px",showHeader:true,draggable:true,beforeClose:function(){n(false)},content:[T],buttons:[this.applyButton=new b({text:this.oBundle.getText("apply"),tooltip:this.oBundle.getText("applyChangesBtnTooltip"),press:function(e){var a=o._createJson();e.getSource().mProperties={value:o.functionLabel,jsonData:a};t(e);o._setModal(false);F.close();F.destroy()}}),new b({text:this.oBundle.getText("cancel"),tooltip:this.oBundle.getText("cancelBtnTooltip"),press:function(e){o._setModal(false);F.close();F.destroy()}})]}).addStyleClass("sapUiSizeCompact");o._setModal(true);F.open()})};F.prototype._setModal=function(e){var t=y.getElementById("popover");if(t){t.setModal(e)}};F.prototype._getSelectedAttributeJsons=function(){var e="";var t="";var a={};for(var s=0;s<this.oModel.getData().selectionData.length;s++){if(this.oModel.getData().selectionData[s].attributeSelected!==""){e=this.oModel.getData().selectionData[s].attributeSelected;t=this.oModel.getData().selectionData[s].sortOrder;a[e]=t}}return a};F.prototype._returnDataObjectBasedOnCommonAssociationoReferenceSelection=function(e,t){var a="";var s="";if(e&&Object.keys(t).length!==0&&t.constructor===Object){var n=Object.keys(t)[0];a=e+n.replace(".","");if(Object.keys(t).length>1){for(var i in t){s=e+i.replace(".","");var o=a.split("/");var r=s.split("/");if(o.length>2&&r.length>2){a="";for(var l=1;l<(o<r?o.length:r.length);l++){if(o[l]===r[l]){a+="/"+o[l]}}}}}else{var o=a.split("/");a="";for(var l=1;l<o.length-1;l++){a+="/"+o[l]}}if(this._hasAssociationId(a)||this._hasReferenceId(a)){return a}}if(!this.includes(e,"/")){e="/"+e}return e};F.prototype._returnDataObjectBasedOnCommonAssociationReferenceAndType=function(e,t){var a="";var s="";if(e&&Object.keys(t).length!==0&&t.constructor===Object){var n=Object.keys(t)[0];a=e+n.replace(".","");if(Object.keys(t).length>1){for(var i in t){s=e+i.replace(".","");var o=a.split("/");var r=s.split("/");if(o.length>2&&r.length>2){a="";for(var l=1;l<(o<r?o.length:r.length);l++){if(o[l]===r[l]){a+="/"+o[l]}}}}}else{var o=a.split("/");a="";for(var l=1;l<o.length-1;l++){a+="/"+o[l]}}if(this._hasAssociationId(a)||this._hasReferenceId(a)){return this._returnDataObjectBasedOnType(a)}}return e};F.prototype._returnDataObjectBasedOnType=function(e){var t=e;if(t){var a=t.split("/");var s=a[1];var n=0;var i;var o="";if(a.length>2){for(var r=2;r<a.length;r++){s+="."+a[r];i=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s);if(i&&i._dataObjectType==="AO"&&i._cardinality==="1..n"){n=r}else if(i&&i._dataObjectType==="R"&&i._isDataObjectTable){n=r}}if(n>0){for(var r=1;r<=n;r++){o+="/"+a[r]}}}if(o){return o}else{return"/"+a[1]}}};F.prototype._hasAssociationId=function(e){var t=e;if(t){var a=t.split("/");var s=a[1];if(a.length>2){for(var n=2;n<a.length;n++){s+="."+a[n]}}if(this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s)&&this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s)._dataObjectType==="AO"){return true}}return false};F.prototype._hasReferenceId=function(e){var t=e;if(t){var a=t.split("/");var s=a[1];if(a.length>2){for(var n=2;n<a.length;n++){s+="."+a[n]}}if(this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s)&&this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(s)._dataObjectType==="R"){return true}}return false};F.prototype._returnTableIdForAttributesBasedOnType=function(e){if(e){var t=e.split("/");var a=t[1];var s=0;var n;var i="";if(t.length>2){for(var o=2;o<t.length;o++){a+="."+t[o];n=this._oAstExpressionLanguage._astBunldeInstance.TermsProvider.TermsProvider.getTermByTermId(a);if(n&&n._dataObjectType==="AO"&&n._cardinality==="1..n"){s=o}else if(n&&n._dataObjectType==="R"&&n._isDataObjectTable){s=o}}if(s>0){for(var o=2;o<=s;o++){i+="/"+t[o]}}}return i}};F.prototype._addAssociationIdToWhere=function(e,t){var a="";var s;if(e){s=e.split(" ");for(var n=0;n<s.length;n++){if(s[n].indexOf("./")!==-1){s[n]="."+s[n].replace(/\./,t)}a+=s[n]+" "}return a.trim()}return e};F.prototype._removetableIdFromAttribute=function(e,t,a){var s="";var n;var i={};var o=this._returnTableIdForAttributesBasedOnType(t);if(a&&Object.keys(e).length!==0&&e.constructor===Object&&o){var r=Object.keys(e);for(var l=0;l<r.length;l++){var c=r[l];var d=e[c];c=c.replace(o,"");i[c]=d}return i}return e};F.prototype._removeAssociationIdToWhere=function(e){var t="";var a;if(e){a=e.split(" ");for(var s=0;s<a.length;s++){if(a[s].indexOf("./")!==-1){var n=a[s].split("/");a[s]="./"+n[n.length-1]}t+=a[s]+" "}return t.trim()}return e};F.prototype._addTableIdFromAttribute=function(e,t,a){var s="";var n;var i={};var o=this._returnTableIdForAttributesBasedOnType(t);if(a&&Object.keys(e).length!==0&&e.constructor===Object&&o){var r=Object.keys(e);for(var l=0;l<r.length;l++){var c=r[l];var d=e[c];c="."+c.replace(/\./,o);i[c]=d}return i}return e};F.prototype._createJson=function(){var e=this._getSelectedAttributeJsons();var t=this._whereExpressionId;var a=this._returnDataObjectBasedOnCommonAssociationoReferenceSelection(this.dataObjectId,e);var s=this._returnDataObjectBasedOnCommonAssociationReferenceAndType(this.dataObjectId,e);e=this._removetableIdFromAttribute(e,a,this.dataObjectId);var n={function:this._selectFunctionSelected,filter:t,functionLabel:this.functionLabel,dataObject:this.dataObjectId,attributes:e,doVocabId:s};if(this._count){n["count"]=this._count}return n};F.prototype.includes=function(e,t){var a=false;if(e.indexOf(t)!==-1){a=true}return a};F.prototype._createUUId=function(){this.infraUtils=new i.utilsBaseLib;return this.infraUtils.createUUID()};return{getInstance:function(){T=new F;return T}}},true);
//# sourceMappingURL=SelectFunctionDialog.js.map