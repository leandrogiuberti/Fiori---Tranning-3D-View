(function(){var e=CodeMirror.Pos;function n(n,i,r,o){this.atOccurrence=false;this.doc=n;if(o==null&&typeof i=="string")o=false;r=r?n.clipPos(r):e(0,0);this.pos={from:r,to:r};if(typeof i!="string"){if(!i.global)i=new RegExp(i.source,i.ignoreCase?"ig":"g");this.matches=function(t,r){if(t){i.lastIndex=0;var o=n.getLine(r.line).slice(0,r.ch),s=0,l,f;for(;;){i.lastIndex=s;var h=i.exec(o);if(!h)break;l=h;f=l.index;s=l.index+(l[0].length||1);if(s==o.length)break}var c=l&&l[0].length||0;if(!c){if(f==0&&o.length==0){l=undefined}else if(f!=n.getLine(r.line).length){c++}}}else{i.lastIndex=r.ch;var o=n.getLine(r.line),l=i.exec(o);var c=l&&l[0].length||0;var f=l&&l.index;if(f+c!=o.length&&!c)c=1}if(l&&c)return{from:e(r.line,f),to:e(r.line,f+c),match:l}}}else{var s=i;if(o)i=i.toLowerCase();var l=o?function(e){return e.toLowerCase()}:function(e){return e};var f=i.split("\n");if(f.length==1){if(!i.length){this.matches=function(){}}else{this.matches=function(r,o){if(r){var f=n.getLine(o.line).slice(0,o.ch),h=l(f);var c=h.lastIndexOf(i);if(c>-1){c=t(f,h,c);return{from:e(o.line,c),to:e(o.line,c+s.length)}}}else{var f=n.getLine(o.line).slice(o.ch),h=l(f);var c=h.indexOf(i);if(c>-1){c=t(f,h,c)+o.ch;return{from:e(o.line,c),to:e(o.line,c+s.length)}}}}}}else{var h=s.split("\n");this.matches=function(t,i){var r=f.length-1;if(t){if(i.line-(f.length-1)<n.firstLine())return;if(l(n.getLine(i.line).slice(0,h[r].length))!=f[f.length-1])return;var o=e(i.line,h[r].length);for(var s=i.line-1,c=r-1;c>=1;--c,--s)if(f[c]!=l(n.getLine(s)))return;var a=n.getLine(s),u=a.length-h[0].length;if(l(a.slice(u))!=f[0])return;return{from:e(s,u),to:o}}else{if(i.line+(f.length-1)>n.lastLine())return;var a=n.getLine(i.line),u=a.length-h[0].length;if(l(a.slice(u))!=f[0])return;var g=e(i.line,u);for(var s=i.line+1,c=1;c<r;++c,++s)if(f[c]!=l(n.getLine(s)))return;if(n.getLine(s).slice(0,h[r].length)!=f[r])return;return{from:g,to:e(s,h[r].length)}}}}}}n.prototype={findNext:function(){return this.find(false)},findPrevious:function(){return this.find(true)},find:function(n){var t=this,i=this.doc.clipPos(n?this.pos.from:this.pos.to);function r(n){var i=e(n,0);t.pos={from:i,to:i};t.atOccurrence=false;return false}for(;;){if(this.pos=this.matches(n,i)){this.atOccurrence=true;return this.pos.match||true}if(n){if(!i.line)return r(0);i=e(i.line-1,this.doc.getLine(i.line-1).length)}else{var o=this.doc.lineCount();if(i.line==o-1)return r(o);i=e(i.line+1,0)}}},from:function(){if(this.atOccurrence)return this.pos.from},to:function(){if(this.atOccurrence)return this.pos.to},replace:function(n){if(!this.atOccurrence)return;var t=CodeMirror.splitLines(n);this.doc.replaceRange(t,this.pos.from,this.pos.to);this.pos.to=e(this.pos.from.line+t.length-1,t[t.length-1].length+(t.length==1?this.pos.from.ch:0))}};function t(e,n,t){if(e.length==n.length)return t;for(var i=Math.min(t,e.length);;){var r=e.slice(0,i).toLowerCase().length;if(r<t)++i;else if(r>t)--i;else return i}}CodeMirror.defineExtension("getSearchCursor",function(e,t,i){return new n(this.doc,e,t,i)});CodeMirror.defineDocExtension("getSearchCursor",function(e,t,i){return new n(this,e,t,i)})})();
//# sourceMappingURL=searchcursor.js.map