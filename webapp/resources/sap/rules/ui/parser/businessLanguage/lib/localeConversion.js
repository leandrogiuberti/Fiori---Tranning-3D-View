sap.ui.define(["sap/rules/ui/parser/infrastructure/locale/lib/moment_JS_min","sap/rules/ui/parser/businessLanguage/lib/parseUtils","sap/rules/ui/parser/businessLanguage/lib/constants","sap/rules/ui/parser/businessLanguage/lib/numberConversion","sap/rules/ui/parser/infrastructure/errorHandling/hrfException"],function(r,e,a,l,t){"use strict";var n=new e.parseUtilsLib;var i="YYYY-MM-DD";var s=["D/M/YYYY","D-M-YYYY","D.M.YYYY"];var o="HH:mm:ss.SSSSSS";var u=["H:mm:ss","TH:mm:ss"];var m="YYYY-MM-DD HH:mm:ss.SSSSSS";var f=["YYYY-MM-DD HH:mm:ss","D/M/YYYY H:mm:ss","D-M-YYYY H:mm:ss","D.M.YYYY H:mm:ss","D/M/YYYYTH:mm:ss","D-M-YYYYTH:mm:ss","D.M.YYYYTH:mm:ss"];var c={toUTC:"toUTC",toTimeZone:"toTimeZone"};var v={"DD.MM.YYYY":null,"D.M.Y":null,"DD.MM.YY":null,"D.M.YY":null,"D.M.YY.":null,"D.MM.YY":null,"D.MM.Y":null,"D.M.Y.":null,"DD.MM.Y":null,"DD.MM.Y.":null,"DD.MM.YY.":null,"DD. MM. YY":null,"DD.MM.YY Г.":null,"YYYY.MM.DD":null,"YY. M. D.":null,"Y. MM. DD.":null,"Y.MM.DD":null,"Y.MM.DD.":null,"DD-MM-YY":null,"DD-MM-YYYY":null,"MM-DD-YYYY":null,"YYYY-MM-DD":null,"Y-MM-DD":null,"DD-MM-Y":null,"DD/MM/Y":null,"D/M/Y":null,"DD/MM/YY":null,"D/M/YY":null,"MM/DD/YY":null,"M/D/YY":null,"DD/MM/YYYY":null,"MM/DD/YYYY":null,"YYYY/MM/DD":null,"Y/M/D":null,"Y/MM/DD":null,"M/D/Y":null};var Y={"hh:mm:ss a":null,"hh:mm:ss A":null,"h:mm:ss a":null,"h:mm:ss A":null,"H:mm:ss":null,"HH:mm:ss":null,"ah:mm:ss":null,"kl. HH:mm:ss":null,"KK:mm:ss A":null,"KK:mm:ss a":null,"h:mm:ss a":null};var p={"123,456,789.00":null,"123.456.789,00":null,"123456789,00":null};var M=function(r){var e=r;if(e.charAt(0)==="'"&&e.charAt(e.length-1)==="'"){e=e.slice(1,e.length-1)}return e};var D=function(r,e){if(r===null){return e}if(e===null){return r.toUpperCase()}return r.toUpperCase()+" "+e};var d=function(r,e){var a=null;var l=r;var t=null;var n=l.slice(9);if(e.indexOf("KK")===0){a=l.slice(0,8);if(n==="pm"||n==="PM"){t=a.split(":");t[0]=parseInt(t[0],10)+12;a=t.join(":")}}return a};var E=function(r,e){var a=null;var l=r;var t=null;var n=null;var i=null;t=l.split(":");n=parseInt(t[0],10);if(n>11){n-=12;i=e.endsWith("A")?"PM":"pm"}else{i=e.endsWith("A")?"AM":"am"}t[0]=n;a=t.join(":");a=a+" "+i;return a};var O=function(r,e,a){var l={str:r,dateFormat:e,timeFormat:a};if(a){var t=a.indexOf("z");if(t>=0){l.timeFormat=a.substring(0,t-1)}}if(l.dateFormat&&(l.str.indexOf("г")>=0&&l.dateFormat.indexOf("г")>=0||l.str.indexOf("Ð³")>=0&&l.dateFormat.indexOf("Ð³")>=0)){var n=l.str.indexOf("г");var i=l.dateFormat.indexOf("г");if(n<0){n=l.str.indexOf("Ð");i=l.dateFormat.indexOf("Ð")}l.str=l.str.slice(0,n-1)+(l.timeFormat!==null?l.str.slice(n+2):"");l.dateFormat=l.dateFormat.slice(0,i-1)}if(l.timeFormat&&(l.str.indexOf("下午")>=0||l.str.indexOf("上午")>=0)&&l.timeFormat.indexOf("a")===0){if(l.str.indexOf("下午")>=0){l.str=l.str.replace("下午","")+" pm"}else{l.str=l.str.replace("上午","")+" am"}l.timeFormat=l.timeFormat.replace("a","")+" a"}if(l.timeFormat&&l.str.indexOf("kl. ")>=0&&l.timeFormat.indexOf("kl. ")===0){l.str=l.str.replace("kl. ","");l.timeFormat=l.timeFormat.replace("kl. ","")}if(a&&a.indexOf("KK")===0&&(r.toLowerCase().indexOf("pm")!==-1||r.toLowerCase().indexOf("am")!==-1)){l.str=d(r,a);l.timeFormat="HH:mm:ss"}return l};var T=function(e,a,l){var t=M(e);var n=null;var i="";var s=O(t,a,l);i=D(s.dateFormat,s.timeFormat);n=r.moment(s.str,i,true);return n};var g=function(e,a){var l=null;var t=M(e);if(a&&a.length>0){l=r.moment(t,a,true)}return l};var x=function(e,a,l){var t=null;var n=M(e);t=r.moment(n,a,true);if(!t.isValid()){t=g(e,l)}return t};var h=function(r,e,a){var l={};l.key="error_in_expression_unsupported_locale_settings";l.args=[r,e];n.handleError(l.key,l.args,a);throw new t.HrfException};var F=function(r){function e(e){if(!e.hasOwnProperty(a.propertiesEnum.number)){h("Number format",null,r)}if(!e.number.hasOwnProperty(a.propertiesEnum.groupSeparator)){h("Group separator",null,r)}if(!e.number.hasOwnProperty(a.propertiesEnum.decimalSeparator)){h("Decimal separator",null,r)}var l=e[a.propertiesEnum.number][a.propertiesEnum.groupSeparator];l=l===" "?"":l;var t=e[a.propertiesEnum.number][a.propertiesEnum.decimalSeparator];var n="123"+l+"456"+l+"789"+t+"00";if(!p.hasOwnProperty(n)){h("Number format",n,r)}}var l=r.flags;if(!l.locale.hasOwnProperty(a.propertiesEnum.localeSettings)||!l.locale.localeSettings){h("Date format",null,r)}var t=l.locale.localeSettings;if(!t.hasOwnProperty(a.propertiesEnum.dateFormat)||!t.dateFormat){h("Date format",null,r)}var n=t.dateFormat;if(!v.hasOwnProperty(n.toUpperCase())){h("Date format",n,r)}if(!t.hasOwnProperty(a.propertiesEnum.timeFormat)||!t.timeFormat){h("Time format",null,r)}var i=t.timeFormat;var s=i.indexOf("z");if(s>=0){i=i.substring(0,s-1)}if(!Y.hasOwnProperty(i)){h("Time format",t.timeFormat,r)}e(t)};var S=function(r){var e=r.flags;if(!e||!e.hasOwnProperty(a.propertiesEnum.locale)){return false}F(r);return true};var P=function(r){var e=r.flags;var l={};l.isLocaleExists=S(r);l.isCodeText=l.isLocaleExists&&e.locale.hasOwnProperty(a.propertiesEnum.convert)&&e.locale.convert.hasOwnProperty(a.propertiesEnum.target)&&e.locale.convert.target===a.DISPLAY_TEXT;return l};var b=function(r){return r.isLocaleExists&&!r.isCodeText};var w=function(r){return!r.isLocaleExists||r.isCodeText};var H=function(r,e){switch(e){case c.toUTC:return-1*Number(r);default:return Number(r)}};var C=function(r,e,a){if(!r.isValid()||!e||!a){return}var l=H(e,a);r.add(l,"Minutes")};var _=function(r,e){var a=null;var l="";var t=false;var n=e.flags;var o=P(e);if(b(o)){l=n.locale.localeSettings.dateFormat.replace("z","");a=T(r,l,null)}if(w(o)&&(!a||!a.isValid())){a=x(r,i,s)}if(a){t=a.isValid()}return t};var y=function(r,e){var a=null;var l="";var t="";var n=false;var i=e.flags;var s=P(e);if(b(s)){l=i.locale.localeSettings.dateFormat.replace("z","");t=i.locale.localeSettings.timeFormat;a=T(r,l,t)}if(w(s)&&(!a||!a.isValid())){a=x(r,m,f)}if(a){n=a.isValid()}return n};var L=function(r,e){var a=null;var l="";var t=false;var n=e.flags;var i=P(e);if(b(i)){l=n.locale.localeSettings.timeFormat;a=T(r,null,l)}if(w(i)&&(!a||!a.isValid())){a=x(r,o,u)}if(a){t=a.isValid()}return t};var k=function(r,e){var a=e;var l="";var t="";if(e&&(e.indexOf("г")>=0||e.indexOf("Ð³")>=0)){var n=e.indexOf("г");if(n<0){n=e.indexOf("Ð")}l=e.substr(n-1,3);a=e.slice(0,n-1)}t=r.format(a.toUpperCase())+l;return t};var A=function(r,e){var a=e;var l="";var t="";var n=null;if(e.indexOf("KK")===0){n=r.format("HH:mm:ss");t=E(n,e)}else{if(e.indexOf("a")===0){l=r.hour()>=12?"下午":"上午";a=a.replace("a","")}if(e.indexOf("kl. ")===0){l="kl. ";a=a.replace("kl. ","")}t=l+r.format(a)}return t};var I=function(r,e,a,l,t,n,i,s,o){var u=null;var m="";var f="";u=T(r,e,a);if(!u.isValid()&&i){u=x(r,n,i)}if(u.isValid()){C(u,s,o);if(l){m=k(u,l)}if(t){var c=t;var v=c.indexOf("z");if(v>=0){c=c.substring(0,v-1)}f=A(u,c);m+=(l?" ":"")+f}}return m};var U=function(r){return r.locale.hasOwnProperty(a.propertiesEnum.convert)&&r.locale.convert.hasOwnProperty(a.propertiesEnum.source)&&r.locale.convert.source===a.CODE_TEXT&&r.locale.convert.hasOwnProperty(a.propertiesEnum.target)&&r.locale.convert.target===a.DISPLAY_TEXT};var V=function(r){return r.locale.hasOwnProperty(a.propertiesEnum.convert)&&r.locale.convert.hasOwnProperty(a.propertiesEnum.source)&&r.locale.convert.source===a.DISPLAY_TEXT&&r.locale.convert.hasOwnProperty(a.propertiesEnum.target)&&r.locale.convert.target===a.CODE_TEXT};var K=function(r,e,t){var n="";var v="";var Y=null;var p=null;var M=0;var D=e.flags;var d=P(e);if(b(d)){n=D.locale.localeSettings.dateFormat.replace("z","");v=D.locale.localeSettings.timeFormat;if(D.locale.localeSettings.timeZoneOffset){M=D.locale.localeSettings.timeZoneOffset}}switch(t){case a.TYPE_DATE:if(n!==""){p=I(r,n,null,i,null,i,s,null,null)}else{Y=x(r,i,s);if(Y.isValid){p=Y.format(i)}}break;case a.TYPE_TIME:if(v!==""){p=I(r,null,v,null,o,o,u,M,c.toUTC)}else{Y=x(r,o,u);if(Y.isValid){p=Y.format(o)}}break;case a.TYPE_TIMESTAMP:if(n!==""&&v!==""){p=I(r,n,v,i,o,m,f,M,c.toUTC)}else{Y=x(r,m,f);if(Y.isValid){p=Y.format(m)}}break;case a.TYPE_NUMERIC:p=l.convertNumber(r,D);break}if(t!==a.TYPE_NUMERIC){p=p&&p.indexOf("'")!==0?"'"+p+"'":p}return p};var N=function(r,e,t){var n=e.flags;var v="";var Y="";var p=0;var M="";var D=null;if(S(e)){v=n.locale.localeSettings.dateFormat.replace("z","");Y=n.locale.localeSettings.timeFormat;if(n.locale.localeSettings.timeZoneOffset){p=n.locale.localeSettings.timeZoneOffset}if(n.locale.hasOwnProperty(a.propertiesEnum.convert)&&n.locale.convert.hasOwnProperty(a.propertiesEnum.target)){M=n.locale.convert.target}}if(M===a.CODE_TEXT){D=K(r,e,t)}else if(M===a.DISPLAY_TEXT){switch(t){case a.TYPE_DATE:D=I(r,i,null,v,null,i,s,null,null);break;case a.TYPE_TIME:D=I(r,null,o,null,Y,o,u,p,c.toTimeZone);break;case a.TYPE_TIMESTAMP:D=I(r,i,o,v,Y,m,f,p,c.toTimeZone);break;case a.TYPE_NUMERIC:D=l.convertNumber(r,n);break}}if(t!==a.TYPE_NUMERIC){D=D&&D.indexOf("'")!==0?"'"+D+"'":D}return D};return{isLocaleExistsInFlags:S,isLocaleConversionFromCodeText:U,isLocaleConversionFromDisplayText:V,isDateStr:_,isTimestampStr:y,isTimeStr:L,convertToHanaLocaleFormat:K,convertLocaleFormat:N}},true);
//# sourceMappingURL=localeConversion.js.map