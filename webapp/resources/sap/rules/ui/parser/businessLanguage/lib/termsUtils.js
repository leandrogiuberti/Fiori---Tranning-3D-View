sap.ui.define(["sap/rules/ui/parser/businessLanguage/lib/constants","sap/rules/ui/parser/businessLanguage/lib/parseUtils","sap/rules/ui/parser/businessLanguage/lib/parseModel","sap/rules/ui/parser/businessLanguage/lib/utils","sap/rules/ui/parser/businessLanguage/lib/parserTokens","sap/rules/ui/parser/businessLanguage/lib/vocabularyUtils","sap/base/Log"],function(e,r,t,s,n,i,a){"use strict";var o=new r.parseUtilsLib;var u=new t.parseModelLib;var p=new i.vocabularyUtilsLib;var l=new s;function m(){}m.prototype.TermInfo=function(){try{this.init=function(){this.start=null;this.end=null;this.type=n.NAVIGATION;this.key=null;this.term=null;this.expression=null;this.isCalculatedType=false;this.isSet=function(){return this.isCalculatedType}};this.init();this.setKey=function(){var e=u.getModelManger();this.key=e.expression.substring(this.start,this.end)};this.calculateTermType=function(){var r=u.getModelManger();if(!r.vocaRTServ){return}this.isCalculatedType=true;this.setKey();var t=r.getCurrentNavigationObject(this.key);if(t===null){t=o.getNavigationObjectFromPath(this.term,this.key,r)}var s=o.getNavigationObjectType(t);if(s!==null){this.type=s}else{if(r[e.propertiesEnum.unknownTokens].hasOwnProperty(this.key)){r[e.propertiesEnum.unknownTokens][this.key]++}else{r[e.propertiesEnum.unknownTokens][this.key]=1}}}}catch(e){a.error("TermnInfo failure - \n"+e)}};m.prototype.setTerm=function(){var e=u.getModelManger();var r=e.terms;r[r.length-1].calculateTermType();e.clearCurrentTerm()};m.prototype.createTerm=function(e,r,t){this.getTermMode();var s=u.getModelManger();s.setCurrentTerm(t);var n=new this.TermInfo;n.start=e;n.end=r;n.term=t;s.terms.push(n)};m.prototype.updateTerm=function(e,r){var t=u.getModelManger();t.setCurrentTerm(r);var s=t.terms;s[s.length-1].term=r;s[s.length-1].end=e};m.prototype.updateTermsTokenType=function(e){var r=u.getModelManger();var t=r.terms;if(l.isEmptyArray(t)){return}if(!t[t.length-1].isSet()){this.setTerm();o.updateTokenType(t[t.length-1],r)}var s,n=0;for(s=0;s<e.length&&n<t.length;s++){if(e[s].start===t[n].start){e[s].type=t[n].type;e[s].setText(t[n].key);n++}}r.clearTermsArray()};m.prototype.getTermMode=function(){var r=null;var t=u.getModelManger();var s=null;if(!t[e.propertiesEnum.termMode]&&t.vocaRTServ){s=t.vocaRTServ.getTermModes();if(t.hasOwnProperty(e.propertiesEnum.flags)&&t[e.propertiesEnum.flags].hasOwnProperty(e.propertiesEnum.termMode)){if(t[e.propertiesEnum.flags][e.propertiesEnum.termMode].hasOwnProperty(e.propertiesEnum.convert)&&t[e.propertiesEnum.flags][e.propertiesEnum.termMode][e.propertiesEnum.convert].hasOwnProperty(e.propertiesEnum.source)){r=t[e.propertiesEnum.flags][e.propertiesEnum.termMode][e.propertiesEnum.convert]}}if(r){t[e.propertiesEnum.termMode]=r[e.propertiesEnum.source]}else if(s.indexOf("byDescription")>-1){t[e.propertiesEnum.termMode]=e.DISPLAY_TEXT}else{t[e.propertiesEnum.termMode]=e.CODE_TEXT}}if(t[e.propertiesEnum.termMode]){return t[e.propertiesEnum.termMode]}return null};m.prototype.isTermPrefix=function(e){var r=u.getModelManger();return p.isTermPrefix(e,r.vocaRTServ,r.vocabulary,this.getTermMode())};return{termsUtilsLib:m}},true);
//# sourceMappingURL=termsUtils.js.map