sap.ui.define(["sap/rules/ui/parser/businessLanguage/lib/constants","sap/rules/ui/parser/AST/lib/bundleAst"],function(e,t){"use strict";var n=RulesAPI_Ast;var a=n.astNodes;var r="all";var l="exists in";var i="not exists in";var o="between";var s="not between";u.operatorsMap={"+":a.BinaryExprNode.operator.plus,"-":a.BinaryExprNode.operator.minus,"*":a.BinaryExprNode.operator.mult,"/":a.BinaryExprNode.operator.div,and:a.LogicalExprNode.operator.and,or:a.LogicalExprNode.operator.or,"=":a.RelationalExprNode.operator.isEqual,"is equal to":a.RelationalExprNode.operator.isEqual,"!=":a.RelationalExprNode.operator.isNotEqual,"is not equal to":a.RelationalExprNode.operator.isNotEqual,">":a.RelationalExprNode.operator.isGreater,"is greater than":a.RelationalExprNode.operator.isGreater,">=":a.RelationalExprNode.operator.isGreaterEqual,"is greater equal than":a.RelationalExprNode.operator.isGreaterEqual,"<":a.RelationalExprNode.operator.isLess,"is less than":a.RelationalExprNode.operator.isLess,"<=":a.RelationalExprNode.operator.isLessEqual,"is less equal than":a.RelationalExprNode.operator.isLessEqual,average:a.AggFunctionNode.aggFunction.avg,count:a.AggFunctionNode.aggFunction.count,"count distinct":a.AggFunctionNode.aggFunction.countDistinct,max:a.AggFunctionNode.aggFunction.max,min:a.AggFunctionNode.aggFunction.min,sum:a.AggFunctionNode.aggFunction.sum,contains:a.FunctionNode.functionName.contains,"not contains":a.FunctionNode.functionName.notContains,ends:a.FunctionNode.functionName.endsWith,"not ends":a.FunctionNode.functionName.notEndsWith,"exists in":a.FunctionNode.functionName.existsIn,"not exists in":a.FunctionNode.functionName.notExistsIn,between:a.FunctionNode.functionName.isBetween,"not between":a.FunctionNode.functionName.isNotBetween,"is in the last":a.FunctionNode.functionName.isInTheLast,"is not in the last":a.FunctionNode.functionName.isNotInTheLast,"is in the next":a.FunctionNode.functionName.isInTheNext,"is not in the next":a.FunctionNode.functionName.isNotInTheNext,"is like":a.FunctionNode.functionName.isLike,"is not like":a.FunctionNode.functionName.isNotLike,starts:a.FunctionNode.functionName.startsWith,"not starts":a.FunctionNode.functionName.notStartsWith,concatenate:a.FunctionNode.functionName.concatenate};function u(t){var n;var c;var d;var g;var p;var h;var v;var f;var N;var y;this.newAST={};this.lastAggrNode=null;function A(e,t,n){if(n){return new a.UOMLiteralNode(n.value,e,n.constant)}return new a.LiteralNode(t,e)}function m(e){var t=null;if(e.hasOwnProperty("getCompoundValue")){t=e.getCompoundValue()}return t}function E(e){var t=e.getValue();var n=e.getValueType();var a=m(e);return A.call(this,n,t,a)}function O(e){var t={};t.businessType=e.getAttributeType();t.isCollection=e.getIsCollection();t.rootObject=e.getRootObject();t.attribute=e.getAttribute();t.associations=e.getAssociationsArray();t.modifiers=e.getModifiers();return t}function w(e){var t=null;var n=O(e);t=new a.IdentifierNode(n);return t}function C(e,t){var n;var a=[];var r;var l=null;a.push(t);for(n=0;n<e.valuesArray.length;n++){r=e.valuesArray[n];l=g.call(this,r);a.push(l)}return a}function T(e,t,n){var a=null;if(n&&n.value){switch(n.value){case i:case l:case o:case s:a=C.call(this,e,t);break}}return a}function x(t,n,a){var r=null;var l=t.getType();if(l===e.objectNamesEnum.setOfValues){r=T.call(this,t,n,a)}return r}function F(t){var n;var a=false;n=t.getType();if(n===e.objectNamesEnum.setOfValues){a=true}return a}function b(e){var t=null;if(e.hasOwnProperty("getQuantity")===true&&e.getQuantity()!==null){t=E.call(this,e.getQuantity())}return t}function S(e){var t;var n=null;var r=[];if(e.hasOwnProperty("getGroupByArray")&&e.getGroupByArray()!==null){n=new a.GroupClauseNode;r=e.getGroupByArray();for(t=0;t<r.length;t++){n.addChild(w.call(this,r[t]))}}return n}function R(e){var t=null;var n=null;if(e.hasOwnProperty("getOrderBy")===true&&e.getOrderBy()!==null){n=w.call(this,e.getOrderBy())}if(n){if(e.hasOwnProperty("getOperator")&&e.getOperator()!==null){t=new a.OrderClauseNode(e.getOperator().getOriginalValue())}else{t=new a.OrderClauseNode(null)}t.addChild(n)}return t}function P(e,t){var n=null;var r=null;var l=null;var i=null;var o=null;n=w.call(this,e.getNavigationPredicateDetails());this.lastAggrNode.addChild(n);if(e.hasOwnProperty("getFilterClause")){r=new a.FilterClauseNode;r.addChild(c.call(this,e.getFilterClause()));n.addChild(r)}if(t!==null){l=S.call(this,t);if(l){this.lastAggrNode.addChild(l)}o=R.call(this,t);if(o){n.addChild(o)}i=b.call(this,t);if(i){n.addChild(i)}}return this.lastAggrNode}function L(t){var n;var a=null;if(t!==null){n=t.getType();if(t.hasOwnProperty("getOriginalValue")){a=t.getOriginalValue().toLowerCase()}else{if(n===e.objectNamesEnum.collectionOperatorOption){a="collect"}else if(t.getAggregationOperator().getValue()!==r){a=t.getAggregationOperator().getValue().toLowerCase()}}}return a}h=function(e){var t=null;var n=null;var r=null;var l=null;var i=null;var o=null;var s=null;var c;if(e.hasOwnProperty("getAggregationOption")){s=e.getAggregationOption();o=L(s);if(o!==null){l=new a.AggFunctionNode(u.operatorsMap[o]);this.lastAggrNode=l}}if((o===null||o==="collect")&&(e.hasOwnProperty("getSelection")&&e.getSelection()!==null)){c=e.getSelection()}else{if(e.hasOwnProperty("getCompoundSelection")&&e.getCompoundSelection()!==null){t=h.call(this,e.getCompoundSelection());if(l&&!(t instanceof a.AggFunctionNode)){l.addChild(t);return l}return t}c=e.getSelection()}if(c.hasOwnProperty("getFilterClause")||s!==null&&s.hasOwnProperty("getGroupByArray")&&s.getGroupByArray()!==null){return P.call(this,c,s)}i=w.call(this,c.getNavigationPredicateDetails());if(l){l.addChild(i)}if(s!==null&&i){r=R.call(this,s);n=b.call(this,s);if(r){i.addChild(r)}if(n){i.addChild(n)}}if(l){return l}return i};p=function(t){var n=t.getType();var a=null;switch(n){case e.objectNamesEnum.simpleSelection:a=E.call(this,t);break;case e.objectNamesEnum.compoundSelection:a=h.call(this,t,null);break}return a};g=function(t){var n=0;var a=null;var r;var l;var i=0;var o;if(Array.isArray(t.selectionsArray)){n=t.selectionsArray.length;o=t.selectionsArray[i].getType();if(o===e.objectNamesEnum.selectionClause){r=g.call(this,t.selectionsArray[i]);i++}else if(o===e.objectNamesEnum.advanceFunction){r=N.call(this,t.selectionsArray[i]);i++}else{r=p.call(this,t.selectionsArray[i]);i++}while(i<n){a={};a.value=t.selectionsArray[i].getValue().trim();a.type=t.selectionsArray[i].getType();i++;o=t.selectionsArray[i].getType();if(o===e.objectNamesEnum.selectionClause){l=g.call(this,t.selectionsArray[i]);i++}else{l=p.call(this,t.selectionsArray[i]);i++}r=v.call(this,r,l,a)}return r}return null};var M=function e(t){return t===">"||t==="<"||t==="="||t==="!="||t===">="||t==="<="};v=function t(n,r,l){var i;var o;if(l&&l.type&&l.value){if(l.type===e.objectNamesEnum.arithmeticOperator){if(n!==null&&r!==null){i=new a.BinaryExprNode(u.operatorsMap[l.value])}else{if(n===null&&r!==null){i=new a.UnaryExprNode(u.operatorsMap[l.value])}}}else if(l.type===e.objectNamesEnum.advanceFunction){i=new a.FunctionNode(u.operatorsMap[l.value])}else if(l.type===e.objectNamesEnum.operatorOption){if(M(l.value)){i=new a.RelationalExprNode(u.operatorsMap[l.value])}else{i=new a.FunctionNode(u.operatorsMap[l.value])}}else{i=new a.LogicalExprNode(u.operatorsMap[l.value])}}if(n!==null){if(i){if(Array.isArray(n)){for(o=0;o<n.length;o++){i.addChild(n[o])}}else{i.addChild(n)}}else{return n}}if(r!==null){if(i){if(Array.isArray(r)){for(o=0;o<r.length;o++){i.addChild(r[o])}}else{i.addChild(r)}}else{return r}}return i};d=function t(n){var r=null,l=null;var i=null,o=null;var s=null;if(n.hasOwnProperty("getSelectionOperator")){s={};s.value=n.getSelectionOperator().getValue().trim();s.type=n.getSelectionOperator().getType()}l=n.getLeftSelectionClause();o=g.call(this,l);if(n.hasOwnProperty("getRightSelectionClause")){r=n.getRightSelectionClause();if(r.getType()===e.objectNamesEnum.complexStatement){i=new a.BracketsExprNode;i.addChild(c.call(this,r.getModel()))}else if(F(r)){o=x.call(this,r,o,s)}else{i=g.call(this,r)}}return v.call(this,o,i,s)};n=function t(n){var r=n.getType();var l=null;var i=null;var o=null;switch(r){case e.objectNamesEnum.simpleStatement:l=d.call(this,n);break;case e.objectNamesEnum.complexStatement:i=f.call(this,n.getModel().statementsArray,o);l=new a.BracketsExprNode;l.addChild(i);break}return l};var B=function t(a,r){var l;var i=[];var o=null;var s=null;var u=null;var c=[];for(l=1;l<r.length;l=l+2){s=o?o.value:null;o={};o.value=r[l].getValue().trim();o.type=r[l].getType();u=n.call(this,r[l+1]);if(o.value===e.STATEMENT_OPERATOR.OR.string){i.push(a);a=u}else if(o.value===e.STATEMENT_OPERATOR.AND.string){if(s===null||o.value!==s){c=[];c.push(a);c.push(u);a=c}else{a.push(u)}}}if(i.length===0&&Array.isArray(a)&&a.length>0){i.push(a)}return i};var j=function t(n){var r=new a.LogicalExprNode(u.operatorsMap[e.STATEMENT_OPERATOR.AND.string]);var l;for(l=0;l<n.length;l++){r.addChild(n[l])}return r};var V=function t(n){var r;var l;var i=n.length;var o=null;if(i>1){o=new a.LogicalExprNode(u.operatorsMap[e.STATEMENT_OPERATOR.OR.string]);for(r=0;r<i;r++){if(Array.isArray(n[r])){l=j.call(this,n[r]);o.addChild(l)}else{o.addChild(n[r])}}}else{if(Array.isArray(n[0])){l=j.call(this,n[0]);o=l}}return o};f=function e(t,a){var r=0;var l=null;var i=[];if(Array.isArray(t)){r=t.length;l=n.call(this,t[0]);if(r>1){i=B.call(this,l,t);l=V.call(this,i)}}return l};y=function e(t){var n;var a=[];var r;var l=null;for(n=0;n<t.length;n++){r=t[n];l=g.call(this,r);a.push(l)}return a};N=function e(t){var n=t.params;var a=y.call(this,n);var r={};r.value=t.getName();r.type=t.getType();return v.call(this,a,null,r)};c=function e(t){return f.call(this,t.statementsArray,null)};this.newAST=t?c.call(this,t):null}u.prototype.getSerializeAST=function e(){var t;t=this.newAST?this.newAST.serialize():"";return t};u.prototype.getAST=function e(){return this.newAST};return{ASTConvertor:u}},true);
//# sourceMappingURL=ASTConvertor.js.map