/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ui/comp/p13n/P13nConditionPanelBase","sap/ui/comp/odata/ODataType","sap/ui/model/odata/type/Currency","sap/ui/model/odata/type/Unit","sap/base/strings/whitespaceReplacer","sap/ui/model/FilterOperator"],function(e,t,r,n,i,a,o,u){"use strict";var s={CHAR_FIGURE_SPACE:" ",CHAR_PUNCTUATION_SPACE:" ",MAX_CURRENCY_DIGITS:3,getFormattedExpressionFromDisplayBehaviour:function(e,t,r){return s.getFormatterFunctionFromDisplayBehaviour(e)(t,r)},getFormatterFunctionFromDisplayBehaviour:function(e,t,r){var n=t?"Whitespace":"";var i=r?"OverrideNoData":"";if(i){switch(e){case"descriptionAndId":return s["_get"+i+"TextFormatterForDescriptionAndId"].bind(r);case"idAndDescription":return s["_get"+i+"TextFormatterForIdAndDescription"].bind(r);case"descriptionOnly":return s["_get"+i+"TextFormatterForDescriptionOnly"].bind(r);default:return s["_get"+i+"TextFormatterForIdOnly"].bind(r)}}switch(e){case"descriptionAndId":return s["_get"+n+i+"TextFormatterForDescriptionAndId"];case"idAndDescription":return s["_get"+n+i+"TextFormatterForIdAndDescription"];case"descriptionOnly":return s["_get"+n+i+"TextFormatterForDescriptionOnly"];default:return s["_get"+n+i+"TextFormatterForIdOnly"]}},_processText:function(e,t){if(t){return e}return e.secondText?e.firstText+" ("+e.secondText+")":e.firstText},_getTextFormatterForDescriptionAndId:function(e,t,r){return s._processText({firstText:t?t:e,secondText:t?e:undefined},r)},_getTextFormatterForIdAndDescription:function(e,t,r){return s._processText({firstText:e,secondText:t?t:undefined},r)},_getTextFormatterForDescriptionOnly:function(e,t,r){return s._processText({firstText:t,secondText:undefined},r)},_getTextFormatterForIdOnly:function(e,t,r){return s._processText({firstText:e,secondText:undefined},r)},_getWhitespaceTextFormatterForDescriptionAndId:function(e,t,r){return o(s._getTextFormatterForDescriptionAndId.apply(s,arguments))},_getWhitespaceTextFormatterForIdAndDescription:function(e,t,r){return o(s._getTextFormatterForIdAndDescription.apply(s,arguments))},_getWhitespaceTextFormatterForDescriptionOnly:function(e,t,r){return o(s._getTextFormatterForDescriptionOnly.apply(s,arguments))},_getWhitespaceTextFormatterForIdOnly:function(e,t,r){return o(s._getTextFormatterForIdOnly.apply(s,arguments))},_getOverrideNoDataTextFormatterForDescriptionAndId:function(e,t,r){if(e==""&&t==""){return this.getNotAssignedText()}return s._getTextFormatterForDescriptionAndId.apply(s,arguments)},_getOverrideNoDataTextFormatterForIdAndDescription:function(e,t,r){if(e==""&&t==""){return this.getNotAssignedText()}return s._getTextFormatterForIdAndDescription.apply(s,arguments)},_getOverrideNoDataTextFormatterForDescriptionOnly:function(e,t,r){if(t==""){return this.getNotAssignedText()}return s._getTextFormatterForDescriptionOnly.apply(s,arguments)},_getOverrideNoDataTextFormatterForIdOnly:function(e,t,r){if(e==""){return this.getNotAssignedText()}return s._getTextFormatterForIdOnly.apply(s,arguments)},getTextsFromDisplayBehaviour:function(e,t,r){return s.getFormatterFunctionFromDisplayBehaviour(e)(t,r,true)},getFormattedRangeText:function(e,t,n,i){return r.getFormatedConditionText(e,t,n,i)},_initialiseCurrencyFormatter:function(){if(!s._oCurrencyFormatter){s._oCurrencyFormatter=e.getCurrencyInstance({showMeasure:false})}if(!s._fAmountCurrencyFormatter){s._fAmountCurrencyFormatter=function(e,t){var r,n;r=s._oCurrencyFormatter.format(e,t);n=s._oCurrencyFormatter.oLocaleData.getCurrencyDigits(t);return s._applyPadding(r,n,s.MAX_CURRENCY_DIGITS)}}},_getUnitFormatter:function(t,r){const n={showMeasure:false,maxFractionDigits:3,minFractionDigits:0,preserveDecimals:t};if(!isNaN(r)){r=parseInt(r)}if(r>=0&&r<=3){n.maxFractionDigits=n.minFractionDigits=r}return e.getUnitInstance(n)},_applyPadding:function(e,t,r){var n;if(typeof e!=="string"){return""}if(t===0&&r>0){e+=s.CHAR_PUNCTUATION_SPACE}n=r-t;if(n){e=e.padEnd(e.length+n,s.CHAR_FIGURE_SPACE)}return e},_getFractionDigitDifference:function(e,t,r,n){if(!t){return 0}var i=t.indexOf(e.oOutputFormat.oFormatOptions.decimalSeparator);if(i<0){return 0}var a=t.substr(i+1).length;if(a<=n&&a>r){return a-r}if(a>n&&r<n){return n-r}return 0},getAmountCurrencyFormatter:function(e){var t=0,r,n;s._initialiseCurrencyFormatter();return function(i,a,o){var u,c;if(i===undefined||i===null||a==="*"){return""}if(!o){return s._fAmountCurrencyFormatter(i,a)}if(!n){n=o;t=s._getMaxCurrencyFractionDigits(n);if(!r){r=s._getCurrencyInstance(e)}}c=n&&n[a]?n[a].UnitSpecificScale:s._oCurrencyFormatter.oLocaleData.getCurrencyDigits(a);u=r.formatValue([i,a||null,n],"string");if(e){c+=s._getFractionDigitDifference(r,u,c,t)}return s._applyPadding(u,c,t)}},_getMaxCurrencyFractionDigits:function(e){var t=0;for(var r in e){if(e[r].UnitSpecificScale&&e[r].UnitSpecificScale>t){t=e[r].UnitSpecificScale}}return t},_getCurrencyInstance:function(e){return new i({showMeasure:false,preserveDecimals:e})},getCurrencySymbolFormatter:function(){s._initialiseCurrencyFormatter();if(!s._fCurrencySymbolFormatter){s._fCurrencySymbolFormatter=function(e){if(!e||e==="*"){return""}return s._oCurrencyFormatter.oLocaleData.getCurrencySymbol(e)}}return s._fCurrencySymbolFormatter},getMeasureUnitFormatter:function(e,t){const r=s._getUnitFormatter(e,t);var n=0,i,a;return function(t,o,u){if(t===undefined||t===null||o==="*"){return""}if(u){if(!a){a=u;n=s._getMaxMeasureUnitFractionDigit(a);if(!i){i=s._getUnitInstance(e,n)}}t=i.formatValue([t,o,a],"string");var c=a[o]?.UnitSpecificScale!=null?a[o].UnitSpecificScale:n;if(e){c+=s._getFractionDigitDifference(i,t,c,n)}return s._applyPadding(t,c,n)}return r.format(t,o)+s.CHAR_FIGURE_SPACE}},getInlineMeasureUnitFormatter:function(e){var t=0,r,n;if(!s._fInlineMeasureFormatter){s._fInlineMeasureFormatter=function(e,t){if(e===undefined||e===null||t==="*"){return""}if(!t){return e}return e+s.CHAR_FIGURE_SPACE+t}}return function(i,a,o){if(o){if(!n){n=o;t=s._getMaxMeasureUnitFractionDigit(n);if(!r){r=s._getUnitInstance(e,t)}}i=r.formatValue([i,a,n],"string");return i+s.CHAR_FIGURE_SPACE+a}return s._fInlineMeasureFormatter(i,a)}},_getUnitInstance:function(e,t){return new a({showMeasure:false,preserveDecimals:e,maxFractionDigits:t})},_getMaxMeasureUnitFractionDigit:function(e){let t=0;for(const n in e){var r=e[n].UnitSpecificScale;if(r>3){r=3}if(t<3&&r>t&&r<=3){t=r}}return t},_extractCompositeKey:function(e){if(!e){return}const t=/\(([^]+)\)/;const r=t.exec(e);if(r&&r[1]){const e=r[1].split(",").reduce(function(e,t){const[r,n]=t.split("=");if(r&&n){const t=n.startsWith("guid")?n.replace(/'$/g,""):n.replace(/^'|'$/g,"");e[r]=t}return e},{});return e}},getInlineAmountFormatter:function(e){var t,r;s._initialiseCurrencyFormatter();if(!s._fInlineAmountFormatter){s._fInlineAmountFormatter=function(e,t){var r;if(e===undefined||e===null||t==="*"){return""}r=s._oCurrencyFormatter.format(e,t);return r+s.CHAR_FIGURE_SPACE+t}}return function(n,i,a){if(n===undefined||n===null||i==="*"){return""}if(!a){return s._fInlineAmountFormatter(n,i)}if(!r){r=a;if(!t){t=s._getCurrencyInstance(e)}}var o=t.formatValue([n,i||null,r],"string");return o+s.CHAR_FIGURE_SPACE+i}},getInlineGroupFormatterFunction:function(e,t,r,i,a,o){var u=e.type==="Edm.String"&&!e.isCalendarDate&&!e.isDigitSequence;if(e.unit){return s.getRelevantUnitFormatterFunction(o,e,i)}else if(!t&&(u||e.displayBehaviour!=="idOnly")&&e.description){const t=s.getFormatterFunctionFromDisplayBehaviour(e.displayBehaviour,a);if(e.isDigitSequence&&e.modelType){return function(r,n){const i=e.modelType.formatValue(r,"string");return t(i,n)}}return t}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"&&r&&r["UTC"]){var c={displayFormat:"Date"};var f={isCalendarDate:e.isCalendarDate};var m=n.getType(e.type,r,c,f);return function(e){return m.formatValue(e,"string")}}else if(e.modelType){return function(t){return e.modelType.formatValue(t,"string")}}},getWidth:function(e,t,r){var n=e.maxLength||e.precision,i,a;if(!t){t=30}if(!r){r=3;a=true}if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.isCalendarDate){n="9em"}else if(n){if(e.type==="Edm.String"&&e.description&&e.displayBehaviour&&(e.displayBehaviour==="descriptionAndId"||e.displayBehaviour==="descriptionOnly")){n="Max"}if(n==="Max"){n=t+""}i=parseInt(n);if(!isNaN(i)){i+=.75;if(i>t){i=t}else if(i<r){i=r}n=i+"em"}else{n=null}}if(!n){if(e.type==="Edm.Boolean"){if(a){r+=.25}n=r+"em"}else{n=t+"em"}}return n},getEdmTimeFromDate:function(e){if(!s._oTimeFormat){s._oTimeFormat=t.getTimeInstance({pattern:"'PT'HH'H'mm'M'ss'S'"})}return s._oTimeFormat.format(e)},parseFilterNumericIntervalData:function(e){var t=[],r=e.match(RegExp("^(-?[^-]*)-(-?[^-]*)$"));if(r&&r.length>=2){t.push(r[1]);t.push(r[2])}return t},parseDateTimeOffsetInterval:function(e){var t=e.split("-"),r=[e],n=0;if(t.length%2===0){r=[];for(var i=0;i<t.length/2;i++){n=e.indexOf("-",++n)}r.push(e.substr(0,n).replace(/\s+/g,""));r.push(e.substr(n+1).replace(/\s+/g,""))}return r},_getFilterType:function(e){if(e.isFiscalDate){return"date"}else if(e.isCalendarType&&e.calendarType){return"date"}else if(e.isDigitSequence){return"numc"}else if(n.isNumeric(e.type)){return"numeric"}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"){return"date"}else if(e.type==="Edm.DateTimeOffset"){return"datetime"}else if(e.type==="Edm.String"){if(e.isCalendarDate){return"stringdate"}return"string"}else if(e.type==="Edm.Guid"){return"guid"}else if(e.type==="Edm.Boolean"){return"boolean"}else if(e.type==="Edm.Time"){return"time"}return undefined},getWhitespaceReplacer:function(e){return e?o:undefined},getDateTimeWithTimezoneFormatter:function(e){if(!e&&!s._oDateTimeWithTimezone){s._oDateTimeWithTimezone=t.getDateTimeWithTimezoneInstance()}return function(r,n){if(!r){return""}return e?t.getDateTimeWithTimezoneInstance(e).format(r,n):s._oDateTimeWithTimezone.format(r,n)}},getRelevantUnitFormatterFunction:function(e,t,r){var n,i=t.isCurrencyField,a=i?s.getInlineAmountFormatter(r):s.getInlineMeasureUnitFormatter(r);if(e){if(i){e.requestCurrencyCodes().then(function(e){n=e})}else{e.requestUnitsOfMeasure().then(function(e){n=e})}}return function(e,r){if(!n){if(i){return a(e,r)}if(t.modelType){e=t.modelType.formatValue(e,"string")}return a(e,r)}return a(e,r,n)}},adaptMilliseconds:function(e,t,r){if(t&&t>3){var n=t-3,i="9".repeat(n);if(r===u.BT||r===u.NB){e.appendFractionalSeconds2(i)}else if(r===u.LT||r===u.LE){e.appendFractionalSeconds1(i)}}return e}};return s},true);
//# sourceMappingURL=FormatUtil.js.map