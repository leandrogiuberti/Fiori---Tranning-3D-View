/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/base/i18n/Localization","sap/ui/comp/library","sap/m/library","sap/base/util/deepExtend","sap/ui/core/Locale","sap/ui/core/date/UI5Date"],function(e,t,r,n,a,i){"use strict";var o=t.personalization.ChangeType;var u=t.personalization.AggregationRole;var s=t.personalization.TableType;var l=t.personalization.ColumnType;var f={getColumnKeys:function(e){if(!e||!e.length){return[]}return e.map(function(e){return this.getColumnKey(e)},this)},sortItemsByText:function(t,r){var n;try{var n=new a(e.getLanguageTag()).toString();if(typeof window.Intl!=="undefined"){var i=window.Intl.Collator(n,{numeric:true});t.sort(function(e,t){return i.compare(e[r],t[r])})}else{t.sort(function(e,t){return e[r].localeCompare(t[r],n,{numeric:true})})}}catch(e){}},getUnionOfAttribute:function(e,t){var r=[];var n=function(e){if(r.indexOf(e)<0){r.push(e)}};for(var a in e){var i=e[a];if(!i[t]){continue}i[t].forEach(n)}return r},getUnionOfColumnKeys:function(e){var t=[];var r=function(e){t=t.concat(e.map(function(e){return e.columnKey}));t=t.filter(function(e,r){return t.indexOf(e)===r})};for(var n in e){for(var a in e[n]){if(!Array.isArray(e[n][a])){continue}r(e[n][a])}}return t},copy:function(e){if(e instanceof Array){return n([],e)}else{return n({},e)}},sort:function(e,t){var r=this.copy(t);r.sort(function(t,r){var n=t[e].toLocaleLowerCase();var a=r[e].toLocaleLowerCase();if(n<a){return-1}if(n>a){return 1}return 0});return r},removeEmptyProperty:function(e){for(var t in e){if(e[t]===null||e[t]===undefined){delete e[t]}}return e},semanticEqual:function(e,t){if(!e||!t){return false}for(var r in e){if(e[r]!==t[r]){return false}}return true},hasChangedType:function(e){for(var t in e){if(e[t]===o.ModelChanged||e[t]===o.TableChanged){return true}}return false},isNamespaceChanged:function(e,t){if(e[t]){return e[t]===o.ModelChanged||e[t]===o.TableChanged}return false},createArrayFromString:function(e){if(!e){return[]}var t=[];var r=e.split(",");r.forEach(function(e){if(e!==""){t.push(e.trim())}});return t},getIndexByKey:function(e,t,r){if(!r||!r.length){return-1}var n=-1;r.some(function(r,a){if(r[e]!==undefined&&r[e]===t){n=a;return true}});return n},getColumnKey:function(e){return this._getCustomProperty(e,"columnKey")||e.getId()},getColumnType:function(e){return this._getCustomProperty(e,"type")},hasSortableColumns:function(e){for(var t in e){if(f.isSortable(e[t])){return true}}return false},hasGroupableColumns:function(e){for(var t in e){if(f.isGroupable(e[t])){return true}}return false},hasFilterableColumns:function(e){for(var t in e){if(f.isFilterable(e[t])){return true}}return false},hasAggregatableColumns:function(e){for(var t in e){if(f.isAggregatable(e[t])){return true}}return false},isGroupable:function(e){if(e&&e.isA("sap.ui.table.AnalyticalColumn")){return e.isGroupableByMenu()||this._getCustomProperty(e,"isGroupable")}if(e&&e.isA("sap.m.Column")){return this.isSortable(e)}return false},isSortable:function(e){if(e.getSortProperty){return!!e.getSortProperty()}return!!this._getCustomProperty(e,"sortProperty")},isFilterable:function(e){if(e.getFilterProperty){return!!e.getFilterProperty()}return!!this._getCustomProperty(e,"filterProperty")},isAggregatable:function(e){if(e.getAggregationRole){return e.getAggregationRole()===u.Dimension||e.getAggregationRole()===u.Measure}return false},getArrayElementByKey:function(e,t,r){if(!r||!r.length){return null}var n=null;r.some(function(r){if(r[e]!==undefined&&r[e]===t){n=r;return true}});return n},isColumnIgnored:function(e,t){if(!t){return false}return t.indexOf(this.getColumnKey(e))>-1},createSort2Json:function(e,t,r,n){if(this.getTableBaseType(e)!==s.Table&&this.getTableType(e)!==s.ChartWrapper){return}this.addSortPersistentData(this._mapTable2P13nSortJson(e),{sort:{sortItems:t}},r,n)},addSortPersistentData:function(e,t,r,n){var a=[];e.sort.sortItems.forEach(function(e){if(!e.isSorted||r.indexOf(e.columnKey)>-1){return}t.sort.sortItems.push({columnKey:e.columnKey,operation:e.operation});a.push(e.columnKey)});if(n){n.forEach(function(e){if(a.indexOf(e.name)>-1||!e.sorted){return}t.sort.sortItems.push({columnKey:e.name,operation:e.sortOrder,initiallyNotVisibleColumn:true})})}},_mapTable2P13nSortJson:function(e){return{sort:{sortItems:e.getColumns().map(function(e){var t=e.getSortOrder()!=="None";if(!e.getSorted()){t=false}return{columnKey:f.getColumnKey(e),isSorted:t,operation:e.getSortOrder()}})}}},getTableType:function(e){switch(e&&e.getMetadata().getName()){case"sap.ui.comp.personalization.ChartWrapper":return s.ChartWrapper;case"sap.ui.comp.personalization.SelectionWrapper":return s.SelectionWrapper;case"sap.m.Table":return s.ResponsiveTable;case"sap.ui.table.AnalyticalTable":return s.AnalyticalTable;case"sap.ui.table.TreeTable":return s.TreeTable;case"sap.ui.table.Table":return s.Table}return null},getTableBaseType:function(e){switch(this.getTableType(e)){case s.ChartWrapper:return s.ChartWrapper;case s.SelectionWrapper:return s.SelectionWrapper;case s.ResponsiveTable:return s.ResponsiveTable;case s.AnalyticalTable:case s.Table:case s.TreeTable:return s.Table}return null},getColumnBaseType:function(e){switch(e&&e.getMetadata().getName()){case"sap.ui.comp.personalization.ColumnWrapper":return l.ColumnWrapper;case"sap.m.Column":return l.ResponsiveColumn;case"sap.ui.table.AnalyticalColumn":case"sap.ui.table.Column":return l.TableColumn}return null},_getCustomProperty:function(e,t){var r=this._getCustomData(e);if(!r||!t){return null}return r[t]},_getCustomData:function(e){if(!e){return null}var t=e.data("p13nData");if(typeof t==="string"){try{t=JSON.parse(t);e.data("p13nData",t)}catch(e){}}return t},getColumnKeysOfType:function(e,t){var r=[];for(var n in t){if(this.getColumnType(t[n])===e){r.push(n)}}return r},getColumnKeysOfFiscalTypeFields:function(e){return Object.values(e).reduce((e,t)=>{var r=this._getCustomData(t);if(r?.typeInstance?.sFiscalType){return e.concat(r.columnKey)}return e},[])},convertFilters:function(e,t){if(e&&e.filter&&e.filter.filterItems){var r=this.getColumnKeysOfType("date",t);var n=this.getColumnKeysOfType("time",t);var a=this.getColumnKeysOfType("datetime",t);e.filter.filterItems.forEach(function(e){var o=t&&t[e.columnKey];if(r.indexOf(e.columnKey)>-1||n.indexOf(e.columnKey)>-1||a.indexOf(e.columnKey)>-1){if(o&&o.data("p13nData")&&o.data("p13nData").edmType==="Edm.String"){return}if(e.value1&&typeof e.value1==="string"){e.value1=i.getInstance(e.value1)}if(e.value2&&typeof e.value2==="string"){e.value2=i.getInstance(e.value2)}}})}},convertSelectOptions:function(e,t){if(e&&e.SelectOptions){var r=this.getColumnKeysOfType("date",t);var n=this.getColumnKeysOfType("time",t);var a=this.getColumnKeysOfType("datetime",t);var o=this.getColumnKeysOfFiscalTypeFields(t);r=r.filter(function(e){return o.indexOf(e)===-1});e.SelectOptions.forEach(function(e){e.Ranges.forEach(function(t){if(r.indexOf(e.PropertyName)>-1||n.indexOf(e.PropertyName)>-1||a.indexOf(e.PropertyName)>-1){if(t.Low&&typeof t.Low==="string"){t.Low=i.getInstance(t.Low)}if(t.High&&typeof t.High==="string"){t.High=i.getInstance(t.High)}}})})}}};return f},true);
//# sourceMappingURL=Util.js.map