/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/core/Lib"],function(e,t,n,i,o){"use strict";var r=e.extend("sap.ui.comp.personalization.SelectionController",{constructor:function(n,i){e.apply(this,arguments);this.setType(t.P13nPanelType.selection);this.setItemType(t.P13nPanelType.selection+"Items")},metadata:{events:{afterSelectionModelDataChange:{}}}});r.prototype.getColumn2Json=function(e,t,n){return{columnKey:t,text:e.getLabel(),visible:e.getSelected()}};r.prototype.getColumn2JsonTransient=function(e,t,n,i){return{columnKey:t,text:n,href:e.getHref(),internalHref:e.getInternalHref(),target:e.getTarget(),press:e.getPress(),description:e.getDescription()}};r.prototype.syncJson2Table=function(e){this.fireBeforePotentialTableChange();this.fireAfterPotentialTableChange()};r.prototype.retrieveAdaptationUI=function(e){return new Promise(function(e){sap.ui.require(["sap/ui/mdc/p13n/panels/LinkSelectionPanel"],function(t){var n=this.getAdaptationData();var i=new t({showHeader:true,enableCount:true,fieldColumn:o.getResourceBundleFor("sap.ui.mdc").getText("info.SELECTION_DIALOG_COLUMNHEADER_WITHOUT_COUNT"),linkPressed:this.getTable().getPress(),enableReorder:false});i.setP13nData(n);this.oPanel=i;var r;i.attachChange(function(e){var t=this.getControlDataReduce();r=e.getSource().getP13nData().map(function(e,t){return{columnKey:e.name,visible:e.visible}});t.selection.selectionItems=r;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})}.bind(this));e(i)}.bind(this))}.bind(this))};r.prototype._transformAdaptationData=function(t,n){var i=e.prototype._transformAdaptationData.apply(this,arguments);i.text=n.text;i.href=n.href;i.internalHref=n.internalHref?n.internalHref:undefined;i.visible=t.visible;i.description=n.description;i.label=n.name;return i};r.prototype.getChangeType=function(e,t){return this.getChangeData(e,t)?n.personalization.ChangeType.ModelChanged:n.personalization.ChangeType.Unchanged};r.prototype.getChangeData=function(e,t){if(!t||!t.selection||!t.selection.selectionItems){return null}var n={selection:i.copy(e.selection)};if(this._isSemanticEqual(e,t)){return null}var o=[];n.selection.selectionItems.forEach(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.selection.selectionItems);if(i.semanticEqual(e,n)){o.push(e);return}for(var r in e){if(r==="columnKey"||!n){continue}if(e[r]===n[r]){delete e[r]}}if(Object.keys(e).length<2){o.push(e)}});o.forEach(function(e){var t=i.getIndexByKey("columnKey",e.columnKey,n.selection.selectionItems);n.selection.selectionItems.splice(t,1)});return n};r.prototype.getUnionData=function(e,t){var n=i.copy(e);if(!t||!t.selection||!t.selection.selectionItems){return n.selection?{selection:i.copy(n.selection)}:null}if(!n||!n.selection||!n.selection.selectionItems){return{selection:i.copy(t.selection)}}var o=this.createControlDataStructure();n.selection.selectionItems.forEach(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.selection.selectionItems);if(n){if(n.visible!==undefined){e.visible=n.visible}}o.selection.selectionItems.push(e)});return o};r.prototype._isSemanticEqual=function(e,t){var n=function(e,t){if(e.visible===true&&(t.visible===false||t.visible===undefined)){return-1}else if((e.visible===false||e.visible===undefined)&&t.visible===true){return 1}else if(e.visible===true&&t.visible===true){return 0}else if((e.visible===false||e.visible===undefined)&&(t.visible===false||t.visible===undefined)){if(e.columnKey<t.columnKey){return-1}else if(e.columnKey>t.columnKey){return 1}else{return 0}}};var o=i.copy(e.selection.selectionItems).sort(n);var r=i.copy(t.selection.selectionItems).sort(n);return!o.some(function(e,t){if(!i.semanticEqual(e,r[t])){return true}})};r.prototype.getResetWarningText=function(){return o.getResourceBundleFor("sap.ui.mdc").getText("info.SELECTION_DIALOG_RESET_WARNING")};return r});
//# sourceMappingURL=SelectionController.js.map