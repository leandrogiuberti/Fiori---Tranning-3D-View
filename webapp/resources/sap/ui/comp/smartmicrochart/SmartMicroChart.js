/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/comp/providers/ChartProvider","sap/suite/ui/microchart/library","sap/m/library","sap/ui/core/CustomData","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/base/Log","./SmartMicroChartRenderer","sap/ui/comp/smartmicrochart/SmartLineMicroChart","sap/ui/comp/smartmicrochart/SmartAreaMicroChart","sap/ui/comp/smartmicrochart/SmartBulletMicroChart","sap/ui/comp/smartmicrochart/SmartRadialMicroChart","sap/ui/comp/smartmicrochart/SmartStackedBarMicroChart","sap/ui/comp/smartmicrochart/SmartColumnMicroChart","sap/ui/comp/smartmicrochart/SmartHarveyBallMicroChart"],function(t,a,e,i,r,o,s,n,h,l,c,u,p,d,m){"use strict";var g=i.Size;var M=t.extend("sap.ui.comp.smartmicrochart.SmartMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartMicroChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},freeText:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:n});M.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false};M.prototype.setChartType=function(){return this};M.prototype.getChartType=function(){return this.getAggregation("_chart").getChartType()};M.prototype.propagateProperties=function(){if(t.prototype.propagateProperties){t.prototype.propagateProperties.apply(this,arguments)}this._initializeMetadata()};M.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");if(t){if(t.getMetadata().hasProperty("height")){t.setHeight(this.getHeight(),true)}if(t.getMetadata().hasProperty("width")){t.setWidth(this.getWidth(),true)}if(t.getMetadata().hasProperty("size")){t.setSize(this.getSize(),true)}e._passParentContextToChild(this,t);if(t.getMetadata().hasProperty("showLabel")){t.setShowLabel(this.getShowLabel(),true)}if(t.getMetadata().hasAssociation("chartTitle")){t.setAssociation("chartTitle",this.getChartTitle(),true)}if(t.getMetadata().hasAssociation("chartDescription")){t.setAssociation("chartDescription",this.getChartDescription(),true)}if(t.getMetadata().hasAssociation("unitOfMeasure")){t.setAssociation("unitOfMeasure",this.getUnitOfMeasure(),true)}if(t.getMetadata().hasAssociation("freeText")){t.setAssociation("freeText",this.getFreeText(),true)}}};M.prototype.setSize=function(t){if(this.getSize()!==t){this.setProperty("size",t)}return this};M.prototype.addAriaLabelledBy=function(t){this.addAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").addAriaLabelledBy(t);return this};M.prototype.removeAriaLabelledBy=function(t){this.removeAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").removeAriaLabelledBy(t);return this};M.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this};M.prototype._initializeMetadata=function(){if(!this._bIsInitialized){var t=this.getModel();if(t&&(t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"||t.getMetadata().getName()==="sap.ui.model.odata.ODataModel")){if(!this._bMetaModelLoadAttached){t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this));this._bMetaModelLoadAttached=true}}else if(t){this._onMetadataInitialized()}}};M.prototype._createChartProvider=function(){var t=this.getEntitySet(),e=this.getModel();if(e&&t){this._oChartProvider=new a({entitySet:t,model:e,chartQualifier:this.data("chartQualifier")})}};M.prototype._onMetadataInitialized=function(){var t,a;this._bMetaModelLoadAttached=false;if(!this._bIsInitialized){this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._bIsInitialized=true;this._createInnerChart()}else{t=this.data("chartQualifier");a=this._oChartProvider.getChartDataPointMetadata();if(a){a=t?a.additionalAnnotations[t]:a.primaryAnnotation;if(a){this._bIsInitialized=true;this._createInnerChartFromDataPoint(a)}else{s.error("There is no UI.Chart annotation nore DataPoint annotation. We cannot initialize SmartMicroChart.")}}else{s.error("There is no UI.Chart annotation nore DataPoint annotation. We cannot initialize SmartMicroChart.")}}}}};M.prototype._createInnerChartFromDataPoint=function(t){var a=t.Visualization.EnumMember;if(o._isBulletVizualizationType(a)){this._buildSmartBulletMicroChart()}else{s.error("Only Bullet chart can be initialize with just DataPoint annotation. Type: "+a+" is not a Bullet chart type.");return}this.invalidate()};M.prototype._createInnerChart=function(){if(!this._checkChartMetadata()){s.error("Created annotations not valid. Please review the annotations and metadata.");return}var t=this._oChartViewMetadata.chartType;switch(t){case"line":case"area":var a=this._oChartViewMetadata.annotation.ChartType.EnumMember.split("/").pop().toLowerCase();if(a==="area"){this._buildSmartAreaMicroChart()}else if(a==="line"){this._buildSmartLineMicroChart()}else{s.error("Not supported chart type used.");return}break;case"bullet":this._buildSmartBulletMicroChart();break;case"donut":this._buildSmartRadialMicroChart();break;case"stacked_bar":this._buildSmartStackedBarMicroChart();break;case"column":this._buildSmartColumnMicroChart();break;case"pie":this._buildSmartHarveyBallMicroChart();break;default:s.error("Not supported chart type used.");return}this.invalidate()};M.prototype._buildSmartLineMicroChart=function(){this._buildSmartMicroChart(h)};M.prototype._buildSmartAreaMicroChart=function(){this._buildSmartMicroChart(l)};M.prototype._buildSmartBulletMicroChart=function(){this._buildSmartMicroChart(c)};M.prototype._buildSmartRadialMicroChart=function(){this._buildSmartMicroChart(u)};M.prototype._buildSmartStackedBarMicroChart=function(){this._buildSmartMicroChart(p)};M.prototype._buildSmartColumnMicroChart=function(){this._buildSmartMicroChart(d)};M.prototype._buildSmartHarveyBallMicroChart=function(){this._buildSmartMicroChart(m)};M.prototype._buildSmartMicroChart=function(t){var a=new t({entitySet:this.getEntitySet(),chartBindingPath:this.getChartBindingPath(),initialize:[this._onChartInitialized,this],customData:[new r({key:"chartQualifier",value:this.data("chartQualifier")})]});if(a.getMetadata().hasProperty("enableAutoBinding")){a.setProperty("enableAutoBinding",this.getEnableAutoBinding(),true)}this.setAggregation("_chart",a,true)};M.prototype._onChartInitialized=function(){this.fireInitialize()};M.prototype._checkChartMetadata=function(){if(this._oChartViewMetadata.chartType&&this._oChartViewMetadata.annotation&&this._oChartViewMetadata.annotation.ChartType&&this._oChartViewMetadata.annotation.ChartType.EnumMember&&this._oChartViewMetadata.annotation.ChartType.EnumMember.length>0){return true}else{return false}};M.prototype.getAccessibilityInfo=function(){var t={};var a=this.getAggregation("_chart");if(a&&a.getAccessibilityInfo){t=a.getAccessibilityInfo()}return t};M.prototype._isResponsive=function(){return this.getSize()===g.Responsive};return M});
//# sourceMappingURL=SmartMicroChart.js.map