/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/Lib","sap/ui/core/date/UI5Date","sap/ui/thirdparty/jquery","sap/ui/comp/config/condition/Type","sap/ui/Device","sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/m/Input","sap/m/Text","sap/ui/core/ListItem","sap/m/Label","sap/ui/core/date/UniversalDate","sap/ui/core/format/DateFormat","sap/ui/comp/config/condition/NullableInteger","sap/base/Log","sap/ui/core/date/UniversalDateUtils","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/m/DynamicDateFormat","sap/m/DynamicDateOption","sap/m/DynamicDateValueHelpUIType","sap/m/StandardDynamicDateOption","sap/ui/comp/util/DateTimeUtil","sap/ui/dom/jquery/cursorPos","sap/ui/core/Core","sap/ui/model/type/Date","sap/ui/model/type/Integer","sap/ui/model/odata/type/String"],function(e,t,jQuery,a,n,i,r,o,l,s,u,p,g,f,T,d,v,c,E,D,y,I,h,N,A,m,S,O,R){"use strict";var _=i.ValueState,F=Object.keys(o.StandardDynamicDateRangeKeys).concat(["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS","NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"]);var C=a.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(e,t,n){a.apply(this,[e,t,n]);this.oDateFormat=t&&t._oDateFormatSettings?t._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this._maxIntValue=1e4;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;var i=this.oFieldMetadata&&this.oFieldMetadata.name,o=t&&t._oAdditionalConfiguration&&(t._oAdditionalConfiguration.getControlConfigurationByKey(e)||i&&t._oAdditionalConfiguration.getControlConfigurationByKey(i));this._bSingleFilterRestriction=n&&n.filterRestriction===r.smartfilterbar.FilterType.single&&(t._bUseDateRangeType||o&&(o.conditionType===this.getName()||typeof o.conditionType==="object"&&o.conditionType.module===this.getName()));this._bDTOffset=n&&n.filterRestriction===r.smartfilterbar.FilterType.interval&&n.type==="Edm.DateTimeOffset";this._customSemanticOperation=null}});C.prototype.applySettings=function(e){a.prototype.applySettings.apply(this,arguments);if(e&&e.ignoreTime){this._bIgnoreTime=e.ignoreTime}};C.setStartTime=function(e){e=C.toUniversalDate(e);return v.resetStartTime(e)};C.setEndTime=function(e,t){e=C.toUniversalDate(e);if(!t){return v.resetEndTime(e)}else{return v.resetStartTime(e)}};C.setMilliseconds=function(e){e=C.toUniversalDate(e);e.setMilliseconds(999);return e.oDate};C.toUniversalDate=function(e){if(e instanceof Date){return g.getInstance(e)}if(!e){return g.getInstance()}if(!(e instanceof g)){return C.toUniversalDate(t.getInstance(e))}return e};C.getWeekStartDate=function(e){return v.getWeekStartDate(e)};C.getMonthStartDate=function(e){return v.getMonthStartDate(e)};C.getQuarterStartDate=function(e){return v.getQuarterStartDate(e)};C.getYearStartDate=function(e){return v.getYearStartDate(e)};C.getDateRange=function(e,t,a,n,i){if(a===true){n=true;a=null}if(!a){a=new g}else{a=new g(a)}if(n){switch(t){case"DAY":break;case"WEEK":a=v.getWeekStartDate(a);break;case"MONTH":a=v.getMonthStartDate(a);break;case"QUARTER":a=v.getQuarterStartDate(a);break;case"YEAR":a=v.getYearStartDate(a);break}}if(!i&&e>0){if(e!==0&&!isNaN(e)){var r=-1;switch(t){case"DAY":a.setDate(a.getDate()+r);break;case"WEEK":a.setDate(a.getDate()+r*7);break;case"MONTH":a.setMonth(a.getMonth()+r);break;case"QUARTER":a.setMonth(a.getMonth()+r*3);break;case"YEAR":a.setFullYear(a.getFullYear()+r);break}}}return v.getRange(e,t,a,false)};C.getTextField=function(e,t){var n=a._createStableId(e,"text");if(t){return new s(n,{text:{parts:[{path:"$smartEntityFilter>value1",type:new S({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})},{path:"$smartEntityFilter>value2",type:new S({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})}],formatter:(e,t)=>`${e} - ${t}`}})}else{return new s(n,{text:{path:"$smartEntityFilter>value1",type:new S({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})}})}};C.getIntField=function(e){return new l(a._createStableId(e,"field"),{value:{path:"$smartEntityFilter>value1",type:new T({},{minimum:0,maximum:e._maxIntValue})},textAlign:"End",width:"100%"})};C.getIntFromToField=function(e,t,n){var i=new p({text:a.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);var r=e._createIntFromToControl(e,"fieldFrom","value1");i.setLabelFor(r);t.push(r);i=new p({text:a.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);var o=e._createIntFromToControl(e,"fieldTo","value2");i.setLabelFor(o);t.push(o);e._setIntControlBinding(r,n,"value1");e._setIntControlBinding(o,n,"value2")};C.ControlFactory=function(e,t,n){if(n.type==="range"){var i=C.getTextField(e,n.display!=="start");i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);return}if(n.type==="int"){var i=C.getIntField(e);t.push(i);if(n.descriptionTextKeys){i.setFieldWidth("auto");i.bindProperty("description",{path:"$smartEntityFilter>value1",type:new O,formatter:function(){var e=n.descriptionTextKeys[0];var t=n.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return a.getTranslatedText(e)}else{return a.getTranslatedText(t||e)}}})}}if(n.type==="[int,int]"){C.getIntFromToField(e,t,n)}};C._defaultOnChangeHandler=function(e,t){if(e.toLowerCase()===this.languageText.toLowerCase()){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("inputstate","NONE",t.getContext());if(this.category.indexOf("FIXED")!==0){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};C._IntOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("{0}")>=0){var a=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$","i");if(e.match(a)){var e=e.match(a)[1];if(e){var n=parseInt(e);if(!isNaN(n)&&n<=t._maxIntValue){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",n);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};C._DefaultFilterSuggestItem=function(e,t,a){var n=false;if(this.languageText.toLowerCase().startsWith(e.toLowerCase())){n=true}else{var i=this.languageText.split(" ");for(var r=0;r<i.length;r++){var o=i[r];if(o.toLowerCase().startsWith(e.toLowerCase())){n=true}}}t.setAdditionalText(this.textValue);t.setText(this.languageText);return n};C._HideFilterSuggestItem=function(e,t,a){return false};C._IntFilterSuggestItem=function(e,t,n){if(!this.basicLanguageText){this.basicLanguageText=n.basicLanguageText}if(!this.basicLanguageText){this.basicLanguageText=this.languageText||a.getTranslatedText(this.textKey)}var i=this.basicLanguageText.indexOf("{0}");var r;var o;if(i>=0){r=this.basicLanguageText.slice(0,i).trim();o=this.basicLanguageText.slice(i+3).trim()}var l=e.split(" ");if(l.length<1||l.length>3){return false}var s=false;var u;var p=function(e){return!!e.match(/(^[0-9]+$)/)&&parseInt(e)>=0};if(r.toLowerCase().startsWith(l[0].toLowerCase())){if(l[1]){if(p(l[1])){u=l[1];if(l[2]){if(o.toLowerCase().startsWith(l[2].toLowerCase())){s=true}}else{s=true}}}else{s=true}}else if(p(l[0])&&l.length<3){u=l[0];if(l[1]){if(o.toLowerCase().startsWith(l[1].toLowerCase())){s=true}}else{s=true}}else if(o.toLowerCase().startsWith(l[0].toLowerCase())&&l.length==1){s=true}if(s&&u){var g;switch(this.category){case"DYNAMIC.DATE.INT":g="DAY";break;case"DYNAMIC.WEEK.INT":g="WEEK";break;case"DYNAMIC.MONTH.INT":g="MONTH";break;case"DYNAMIC.QUARTER.INT":g="QUARTER";break;case"DYNAMIC.YEAR.INT":g="YEAR";break;default:g="DAY";break}var f=parseInt(u),T=true;if(!n._maxIntValue){n._maxIntValue=n.getControls(n.key)[0].getBindingInfo("value").type.oConstraints.maximum}if(f>n._maxIntValue){s=false}if(this.key.startsWith("LAST")){f=f*-1;T=false}var d;if(this.getDateRange){var v=this.getDateRange({operation:this.key,value1:f});d=[v.value1,v.value2]}else{d=C.getDateRange(f,g,true,T,T)}var c=n._getDateFormatter(true);if(Math.abs(f)===1&&this.singulareBasicLanguageText){t.setText(this.singulareBasicLanguageText);if(g!=="DAY"){t.setAdditionalText(c.format(d[0])+" - "+c.format(d[1]))}else{t.setAdditionalText(c.format(d[0]))}}else{t.setText(n._fillNumberToText(this.basicLanguageText,u));t.setAdditionalText(c.format(d[0])+" - "+c.format(d[1]))}t._value1=parseInt(u)}else{t.setAdditionalText(null);t.setText(this.languageText);t._value1=null}return s};C._DefaultOnItemSelected=function(e,t,a){a.oModel.setProperty("/condition/operation",this.key);if("value1"in this){a.oModel.setProperty("/condition/value1",t._value1)}if("value2"in this){a.oModel.setProperty("/condition/value2",t._value2)}a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};C._IntOnItemSelected=function(e,t,a){var n=t._value1;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};C.getFixedRangeOperation=function(e,t,a,n,i,r){return Object.assign({textKey:t,filterSuggestItem:i||C._DefaultFilterSuggestItem,onItemSelected:C._DefaultOnItemSelected,getControls:C.ControlFactory},C._getFixedRangeOperation(e,a,n,r))};C._getFixedRangeOperation=function(e,t,a,n){return{key:e,category:t,order:n||100,defaultValues:a||null,type:"range",display:"range"}};C.createSingleIntRangeOperation=function(e,t,a,n,i,r,o,l){return Object.assign({textKey:t,singularTextKey:a,zeroNumberTextKey:l,descriptionTextKeys:r,onChange:C._IntOnChangeHandler,filterSuggestItem:C._IntFilterSuggestItem,onItemSelected:C._IntOnItemSelected,getControls:C.ControlFactory},C._createSingleIntRangeOperation(e,n,i,o))};C._createSingleIntRangeOperation=function(e,t,a,n){return{key:e,category:t,order:n,defaultValues:[a],value1:null,type:"int",_getInitialValues:function(e){return[e.value1,e.value2]}}};C.Operations={DATERANGE:{key:"DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null},DATE:{key:"DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null},FROM:{key:"FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null},TO:{key:"TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null},LASTDAYS:C._createSingleIntRangeOperation("LASTDAYS","DYNAMIC.DATE.INT",1,4),LASTWEEKS:C._createSingleIntRangeOperation("LASTWEEKS","DYNAMIC.WEEK.INT",1,8),LASTMONTHS:{key:"LASTMONTHS",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int"},LASTQUARTERS:{key:"LASTQUARTERS",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int"},LASTYEARS:{key:"LASTYEARS",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int"},NEXTDAYS:{key:"NEXTDAYS",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int"},NEXTWEEKS:{key:"NEXTWEEKS",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int"},NEXTMONTHS:{key:"NEXTMONTHS",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int"},NEXTQUARTERS:{key:"NEXTQUARTERS",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int"},NEXTYEARS:{key:"NEXTYEARS",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int"},SPECIFICMONTH:{key:"SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var e=new g;return[e.getMonth()]},value1:null},YESTERDAY:{key:"YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return v.ranges.yesterday()},type:"range",display:"start"},TODAY:{key:"TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return v.ranges.today()},type:"range",display:"start"},TOMORROW:{key:"TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var e=v.ranges.tomorrow();return e},type:"range",display:"start"},THISWEEK:C._getFixedRangeOperation("THISWEEK","FIXED.WEEK",function(){return v.ranges.currentWeek("Default")},6),LASTWEEK:C._getFixedRangeOperation("LASTWEEK","FIXED.WEEK",function(){return v.ranges.lastWeek("Default")},7),LAST2WEEKS:C._getFixedRangeOperation("LAST2WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-2,"Default")},-1),LAST3WEEKS:C._getFixedRangeOperation("LAST3WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-3,"Default")},-1),LAST4WEEKS:C._getFixedRangeOperation("LAST4WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-4,"Default")},-1),LAST5WEEKS:C._getFixedRangeOperation("LAST5WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-5,"Default")},-1),NEXTWEEK:C._getFixedRangeOperation("NEXTWEEK","FIXED.WEEK",function(){return v.ranges.nextWeek("Default")},9),NEXT2WEEKS:C._getFixedRangeOperation("NEXT2WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(2,"Default")},-1),NEXT3WEEKS:C._getFixedRangeOperation("NEXT3WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(3,"Default")},-1),NEXT4WEEKS:C._getFixedRangeOperation("NEXT4WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(4,"Default")},-1),NEXT5WEEKS:C._getFixedRangeOperation("NEXT5WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(5,"Default")},-1),THISMONTH:C._getFixedRangeOperation("THISMONTH","FIXED.MONTH",function(){return v.ranges.currentMonth()},12),LASTMONTH:C._getFixedRangeOperation("LASTMONTH","FIXED.MONTH",function(){return v.ranges.lastMonth()},13),NEXTMONTH:C._getFixedRangeOperation("NEXTMONTH","FIXED.MONTH",function(){return v.ranges.nextMonth()},15),THISQUARTER:C._getFixedRangeOperation("THISQUARTER","FIXED.QUARTER",function(){return v.ranges.currentQuarter()},17),LASTQUARTER:C._getFixedRangeOperation("LASTQUARTER","FIXED.QUARTER",function(){return v.ranges.lastQuarter()},18),NEXTQUARTER:C._getFixedRangeOperation("NEXTQUARTER","FIXED.QUARTER",function(){return v.ranges.nextQuarter()},20),YEARTODATE:C._getFixedRangeOperation("YEARTODATE","FIXED.YEAR",function(){return v.ranges.yearToDate()},31),THISYEAR:C._getFixedRangeOperation("THISYEAR","FIXED.YEAR",function(){return v.ranges.currentYear()},26),LASTYEAR:C._getFixedRangeOperation("LASTYEAR","FIXED.YEAR",function(){return v.ranges.lastYear()},27),NEXTYEAR:C._getFixedRangeOperation("NEXTYEAR","FIXED.YEAR",function(){return v.ranges.nextYear()},29),QUARTER1:C._getFixedRangeOperation("QUARTER1","FIXED.QUARTER",function(){return v.ranges.quarter(1)},22),QUARTER2:C._getFixedRangeOperation("QUARTER2","FIXED.QUARTER",function(){return v.ranges.quarter(2)},23),QUARTER3:C._getFixedRangeOperation("QUARTER3","FIXED.QUARTER",function(){return v.ranges.quarter(3)},24),QUARTER4:C._getFixedRangeOperation("QUARTER4","FIXED.QUARTER",function(){return v.ranges.quarter(4)},25),TODAYFROMTO:{key:"TODAYFROMTO",category:"DYNAMIC.DATE.INT",order:3.3,defaultValues:[1,1],type:"[int,int]",display:"int",value1:null,value2:null}};C.SingleParameterOperations={DATE:Object.assign({},C.Operations.DATE,{defaultOperation:true}),YESTERDAY:C.Operations.YESTERDAY,TODAY:C.Operations.TODAY,TOMORROW:C.Operations.TOMORROW,FIRSTDAYWEEK:{key:"FIRSTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"FIRSTDAYWEEK",values:[]},"Default")}},LASTDAYWEEK:{key:"LASTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"LASTDAYWEEK",values:[]},"Default")}},FIRSTDAYMONTH:{key:"FIRSTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"FIRSTDAYMONTH",values:[]})}},LASTDAYMONTH:{key:"LASTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"LASTDAYMONTH",values:[]})}},FIRSTDAYQUARTER:{key:"FIRSTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"FIRSTDAYQUARTER",values:[]})}},LASTDAYQUARTER:{key:"LASTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"LASTDAYQUARTER",values:[]})}},FIRSTDAYYEAR:{key:"FIRSTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"FIRSTDAYYEAR",values:[]})}},LASTDAYYEAR:{key:"LASTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"LASTDAYYEAR",values:[]})}}};C.SingleOperations=Object.assign({},C.SingleParameterOperations,{NODATE:{key:"NODATE",operator:"NODATE",category:"DATERANGETYPE_NODATECATEGORY",type:"nodate",order:100,textKey:"DATERANGETYPE_NODATE",value1:null,defaultValues:[null]}});C.NewDynamicDateRangeOperations={DATETOYEAR:{key:"DATETOYEAR",category:"FIXED.YEAR",type:"range",display:"range",defaultValues:function(){return(new h).toDates({operator:"DATETOYEAR",values:[]})}},LASTDAYSINCLUDED:{key:"LASTDAYSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},LASTWEEKSINCLUDED:{key:"LASTWEEKSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},LASTMONTHSINCLUDED:{key:"LASTMONTHSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},LASTQUARTERSINCLUDED:{key:"LASTQUARTERSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},LASTYEARSINCLUDED:{key:"LASTYEARSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTDAYSINCLUDED:{key:"NEXTDAYSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTWEEKSINCLUDED:{key:"NEXTWEEKSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTMONTHSINCLUDED:{key:"NEXTMONTHSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTQUARTERSINCLUDED:{key:"NEXTQUARTERSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTYEARSINCLUDED:{key:"NEXTYEARSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NODATE:{key:"NODATE",operator:"NODATE",category:"DATERANGETYPE_NODATECATEGORY",type:"nodate",order:100,textKey:"DATERANGETYPE_NODATE",value1:null,defaultValues:[null]}};C.DTOffsetOperations=Object.assign({NEXTMINUTES:{key:"NEXTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},NEXTHOURS:{key:"NEXTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},LASTMINUTES:{key:"LASTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},LASTHOURS:{key:"LASTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},LASTMINUTESINCLUDED:{key:"LASTMINUTESINCLUDED",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},LASTHOURSINCLUDED:{key:"LASTHOURSINCLUDED",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},NEXTMINUTESINCLUDED:{key:"NEXTMINUTESINCLUDED",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},NEXTHOURSINCLUDED:{key:"NEXTHOURSINCLUDED",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]}},C.Operations,C.NewDynamicDateRangeOperations,{DATERANGE:Object.assign({},C.Operations.DATERANGE,{defaultOperation:false}),DATETIME:{key:"DATETIME",category:"DYNAMIC.DATETIME",type:"range",display:"range",value1:null,value2:null,defaultValues:[null]},DATETIMERANGE:{key:"DATETIMERANGE",category:"DYNAMIC.DATETIMERANGE",type:"range",display:"range",defaultOperation:true,value1:null,value2:null,defaultValues:[null,null]}});C.prototype.getControls=function(e){var t=[];if(!e){return}if(!e.getControls){e.getControls=C.ControlFactory}e.getControls(this,t,e);return t};C.prototype.setIgnoreTime=function(e){this._bIgnoreTime=e};a.prototype.getIgnoreTime=function(e){return this._bIgnoreTime};C.prototype.getDefaultValues=function(e){if(!e){return[]}var t=e.defaultValues||[];if(typeof t==="function"){t=e.defaultValues()}var a=this.getCondition(),n=t[0]||null,i=t[1]||null;if(e.key==="DATERANGE"&&a&&a.value1&&a.value2&&(a.value1 instanceof Date&&a.value2 instanceof Date||a.value1.oDate&&a.value2.oDate)){n=a.value1.oDate||a.value1;i=a.value2.oDate||a.value2}else{if(n instanceof Date){n=new g(n)}if(i instanceof Date){i=new g(i)}}return[n,i]};C.prototype.getOperations=function(){if(this.oFieldMetadata?.isParameter&&this._bSingleFilterRestriction){return this.getSingleParameterOperations()}if(this._bSingleFilterRestriction){return this.getSingleOperations()}if(this._bDTOffset){return this.getDTOffsetOperations()}var e=[];var t=Object.assign({},C.Operations,C.NewDynamicDateRangeOperations);for(var a in t){var n=t[a];if(this._filterOperation(n)){e.push(n)}}return e};C.prototype.getSingleParameterOperations=function(){var e=[];for(var t in C.SingleParameterOperations){var a=C.SingleParameterOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};C.prototype.getSingleOperations=function(){var e=[];for(var t in C.SingleOperations){var a=C.SingleOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};C.prototype.getDTOffsetOperations=function(){var e=[];for(var t in C.DTOffsetOperations){var a=C.DTOffsetOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};C.prototype._updateOperation=function(e){a.prototype._updateOperation.apply(this,[e]);if(e.languageText&&!e.basicLanguageText){e.basicLanguageText=e.languageText;if(!e.singulareBasicLanguageText&&e.singularTextKey){e.singulareBasicLanguageText=this.getTranslatedText(e.singularTextKey)}if(!e.zeroNumberLanguageText&&e.zeroNumberTextKey){e.zeroNumberLanguageText=this.getTranslatedText(e.zeroNumberTextKey)}e.languageText=this._fillNumberToText(e.languageText)}if(e.display){var t=this.getDefaultValues(e);var n=this._getDateFormatter(false);if(e.display==="start"&&t[0]!==null){e.textValue=n.format(t[0].oDate)}else if(e.display==="range"&&t&&t[0]&&t[1]){e.textValue=n.format(t[0].oDate)+" - "+n.format(t[1].oDate)}}e.suggestText=e.languageText};C.prototype.isValidCondition=function(){var e=this.getCondition(),t=this.getOperation(e.operation);if(t&&e&&e.key&&e.operation){if("value1"in t&&"value2"in t){return"value1"in e&&e.value1!==null&&"value2"in e&&e.value2!==null}else if("value1"in t){return"value1"in e&&e.value1!==null}else if("value2"in t){return"value2"in e&&e.value2!==null}else if(!("value1"in t)&&!("value2"in t)){return true}}return false};C.prototype.hasSemanticDate=function(e){var t=this.getOperations();if(e.ranges[0].semantic&&e.ranges[0].semantic.operation){var a=0;for(a=0;a<t.length;a++){if(t[a].key.indexOf(e.ranges[0].semantic.operation)!==-1){return true}}return false}};C.prototype.hasCustomSemanticDate=function(e){return e.ranges[0]&&e.ranges[0].semantic&&e.ranges[0].semantic.operation&&e.ranges[0].semantic.operation!==this.getDefaultOperation().key};C.prototype.providerDataUpdated=function(e,t){};C.prototype.initialize=function(e){if(!e){e={}}a.prototype.initialize.apply(this,[e]);this.oModel.suspend();var n=Object.assign({},e,true),i,r;this.oLastJson=n;var o=(new g).getCalendarType();if(!e.conditionTypeInfo){if(e.ranges&&e.ranges.length==1){var l;if(this.hasSemanticDate(e)&&!this._bSingleFilterRestriction){l=e.ranges[0].semantic.operation;if(e.ranges[0].semantic.value1||e.ranges[0].semantic.value1==0){i=e.ranges[0].semantic.value1}if(e.ranges[0].semantic.value2||e.ranges[0].semantic.value2==0){r=e.ranges[0].semantic.value2}if(this.getDefaultOperation().key===l){var s=this.getOperation(l),u=s&&s._getInitialValues?s._getInitialValues(e):null;if(!u){u=this.getDefaultValues(s)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==e.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==e.ranges[0].value2){l="DATERANGE"}}}else if(this.hasSemanticDate(e)&&this._bSingleFilterRestriction){l=e.ranges[0].semantic.operation;if(e.ranges[0].semantic.value1||e.ranges[0].semantic.value1==0){i=e.ranges[0].semantic.value1}e.ranges[0].value2=null;if(e.ranges[0].semantic.value2||e.ranges[0].semantic.value2==0){r=null}if(this.getDefaultOperation().key===l){var s=this.getOperation(l),u=s&&s._getInitialValues?s._getInitialValues(e):null;if(!u){u=this.getDefaultValues(s)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==e.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==e.ranges[0].value2){l="DATE"}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()===i){i=e.ranges[0].value1?e.ranges[0].value1:e.ranges[0].semantic.value1}}}else if(this.hasCustomSemanticDate(e)){this._customSemanticOperation=e.ranges[0].semantic.operation;if(this._bSingleFilterRestriction){l="DATE"}else{l="DATERANGE"}}else if(this._bSingleFilterRestriction){l="DATE"}else{l="DATERANGE"}if(e.ranges[0].operation==="GE"){l="FROM"}if(e.ranges[0].operation==="LE"){l="TO"}e.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:l,value1:i||i==0?i:e.ranges[0].value1,value2:r||r==0?r:e.ranges[0].value2,calendarType:o}}}else{var s=this.getDefaultOperation(),p=s?s.key:"";if(e.value1){var f=e.value1}if(e.value2){var T=e.value2}e.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:p,calendarType:o}};if(f){e.conditionTypeInfo.data.value1=f}if(T){e.conditionTypeInfo.data.value2=T}else if(e.conditionTypeInfo.data.operation==="DATERANGE"){e.conditionTypeInfo.data.operation="DATE"}}}if(e.conditionTypeInfo){e=e.conditionTypeInfo}if(e.name&&e.data){if(e.name!==this.getName()){d.debug("ConditionType "+this.getName()+" tries to deserialize data from "+e.name)}e=e.data}if(!e.operation){return}if(this.getOperation(e.operation)&&this.getOperation(e.operation).order<0){var c=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(e.operation);if(c>=0){e.operation="LASTWEEKS";e.value1=c+2}c=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(e.operation);if(c>=0){e.operation="NEXTWEEKS";e.value1=c+2}}var E=this.getOperation(e.operation);if(!E){if(this.getAsync()){this.setPending(true);var D=this,y=function(e){if(e.getParameter("pending")===false){D.oFilterProvider.detachPendingChange(y);D.initialize(D.oLastJson)}};this.oFilterProvider.attachPendingChange(y);this.oModel.resume();return}}var I;if(o!==e.calendarType&&(e.calendarType==="Islamic"||o==="Islamic")&&e.operation==="SPECIFICMONTH"){e.operation="DATERANGE";var h=parseInt(e.value1),N=g.getInstance(t.getInstance(),e.calendarType);N.setMonth(h);N=v.getMonthStartDate(N);I=v.getRange(0,"MONTH",N);e.value1=I[0].oDate.toISOString();e.value2=I[1].oDate.toISOString()}var A=this.getConditionContext().getObject();if(!e.value2&&e.operation==="DATERANGE"){e.operation="DATE"}A.operation=e.operation;A.key=e.key;A.value1=null;A.value2=null;var m,S=this.oFieldMetadata&&this.oFieldMetadata.ui5Type;if(S&&S.isA(R.getMetadata().getName())){m=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));S=m}if(e.operation==="DATERANGE"){if(typeof e.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){e.value1=S.formatValue(e.value1)}else{e.value1=e.value1===""?null:new g(e.value1).oDate}}if(typeof e.value2==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){e.value2=S.formatValue(e.value2)}else{e.value2=e.value2===""?null:new g(e.value2).oDate}}A.value1=e.value1;A.value2=e.value2}else if(["DATE","FROM","TO"].indexOf(e.operation)!==-1){if(typeof e.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){e.value1=S.formatValue(e.value1)}else{e.value1=e.value1===""?null:new g(e.value1).oDate}}A.value1=e.value1}else if(["DATETIME","DATETIMERANGE"].indexOf(e.operation)!==-1){if(typeof e.value1==="string"){e.value1=e.value1===""?null:new g(e.value1).oDate}A.value1=e.value1;if(typeof e.value2==="string"){e.value2=e.value2===""?null:new g(e.value2).oDate}A.value2=e.value2}else if(["LASTMINUTES","LASTHOURS","LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTMINUTES","NEXTHOURS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(e.operation)>-1){A.value1=e.value1}else if(e.operation==="SPECIFICMONTH"){A.value1=e.value1+""}else if(e.operation==="TODAYFROMTO"){A.value1=e.value1;A.value2=e.value2}else{E=this.getOperation(e.operation);I=E&&E._getInitialValues?E._getInitialValues(e):null;if(!I){I=this._getValuesFromCurrentOperation(e)}if(!I){I=this.getDefaultValues(E)}A.value1=I[0];A.value2=I[1]}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);this._setDDROperation.call(this,e);if(m){m.destroy()}};C.prototype._getValuesFromCurrentOperation=function(e){var t=[];if(Number.isInteger(e.value1)){t.push(e.value1)}if(Number.isInteger(e.value2)){t.push(e.value2)}if(t.length>0){return t}return null};C.prototype.serialize=function(e,t){var a={},n=this.getCondition();if(!n.operation){return null}var i=this.getOperation(n.operation);if(!i||!("value1"in i)){n.value1=null}if(!i||!("value2"in i)){n.value2=null}n.calendarType=(new g).getCalendarType();a.conditionTypeInfo={name:this.getName(),data:n};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(e){this._updateProvider(a,true,t)}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,a,false,t),0)}return a};C.prototype.updateFilters=function(){if(!this._bDTOffset||!this.oConditionContext?.oModel?.oData?.condition?.value1){return}var e={},t=this.getCondition();if(!t.operation){return}var a=this.getOperation(t.operation);if(!a||!("value1"in a)){t.value1=null}if(!a||!("value2"in a)){t.value2=null}t.calendarType=(new g).getCalendarType();e.conditionTypeInfo={name:this.getName(),data:t};e.ranges=this.getFilterRanges();e.items=[];this.oFilterProvider?.oModel?.setProperty("/"+this.sFieldName,e)};C.prototype._updateProvider=function(e,t,a){e.ranges=this.getFilterRanges();e.items=[];var n=false;var i=0;var r=0;var o=0;var l=this.oModel.getData(),s=l.currentoperation;if(e&&s){this._clearModelInputState(e,s)}if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"&&e.ranges[0]){var u,p=this.oFieldMetadata.ui5Type;if(p.isA(R.getMetadata().getName())){u=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));p=u}if(!s.type||!s.type.includes("int")){e.conditionTypeInfo.data.value1=p.parseValue(e.conditionTypeInfo.data.value1);e.conditionTypeInfo.data.value2=p.parseValue(e.conditionTypeInfo.data.value2)}e.ranges[0].value1=p.parseValue(e.ranges[0].value1);if(e.ranges[0].value2){e.ranges[0].value2=p.parseValue(e.ranges[0].value2)}if(u){u.destroy()}}if(s&&s.languageText){var g=s.languageText;if(this._isIntIntInterval(s)){if(e.conditionTypeInfo.data.value1!=null&&e.conditionTypeInfo.data.value1!==""&&e.conditionTypeInfo.data.value2!=null&&e.conditionTypeInfo.data.value2!==""){g=this._formatIntIntInterval(s,e)}}else if(this._isIntInterval(s)){if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){g=this._formatIntInterval(s,e)}else if(this._bSuggestItemSelected){g=this._fillNumberToText(s.basicLanguageText);var f=s.basicLanguageText.indexOf("{0}");i=f+1;r=f;o=f+1;n=true}else{g=""}}else if(this._isFixedRange(s)){g=this._formatFixedRange(s,s.textValue)}else{if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var T=this._calculateDateRangeValueText(s,e);var d=T.value;n=T.bSetCursor;if(d){g=this._formatFixedRange(s,d);i=g.length-1}else{g=""}}else{g=""}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",g);if(n&&this._oInput){this._oInput.$("inner").cursorPos(i);if(r<o){this._oInput.selectText(r,o)}this._oInput._lastValue=""}}if(this.oFilterProvider&&this.oFilterProvider.oModel){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,e);this.oFilterProvider.setFilterData({},false,this.sFieldName,true);if(a&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange()}}};C.prototype.getFilterRanges=function(){var e,a=this.getCondition(),n=[],i;if(this._bSingleFilterRestriction){if(a.operation!=="NODATE"){a.operation="EQ"}delete a.value2}else if(a.operation==="LASTMINUTES"){if(!isNaN(a.value1)){n=v.ranges.lastMinutes(a.value1)}n[0]?.setMilliseconds(0);n[0]?.setSeconds(0);a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTMINUTESINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastMinutes(a.value1-1)}n[0]?.setMilliseconds(0);n[0]?.setSeconds(0);n[1]?.setSeconds(59);a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTHOURS"){if(!isNaN(a.value1)){n=v.ranges.lastHours(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTHOURSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastHours(a.value1-1)}n[0]?.setMinutes(0);n[0]?.setMilliseconds(0);n[0]?.setSeconds(0);a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTDAYS"){if(!isNaN(a.value1)){n=v.ranges.lastDays(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTDAYSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastDays(a.value1-1)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="LASTWEEKS"){if(!isNaN(a.value1)){n=v.ranges.lastWeeks(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTWEEKSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastWeeks(a.value1-1,this.sCalendarWeekNumbering)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="LASTMONTHS"){if(!isNaN(a.value1)){n=v.ranges.lastMonths(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTMONTHSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastMonths(a.value1-1)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="LASTQUARTERS"){if(!isNaN(a.value1)){n=v.ranges.lastQuarters(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTQUARTERSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastQuarters(a.value1-1)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="LASTYEARS"){if(!isNaN(a.value1)){n=v.ranges.lastYears(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTYEARSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastYears(a.value1-1)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="NEXTMINUTES"){if(!isNaN(a.value1)){n=v.ranges.nextMinutes(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTMINUTESINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextMinutes(a.value1-1)}n[0]?.setMilliseconds(0);n[0]?.setSeconds(0);n[1]?.setSeconds(59);a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTHOURS"){if(!isNaN(a.value1)){n=v.ranges.nextHours(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTHOURSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextHours(a.value1-1)}n[1]?.setMinutes(59,59);a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTDAYS"){if(!isNaN(a.value1)){n=v.ranges.nextDays(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTDAYSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextDays(a.value1-1)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="NEXTWEEKS"){if(!isNaN(a.value1)){n=v.ranges.nextWeeks(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTWEEKSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextWeeks(a.value1-1,this.sCalendarWeekNumbering)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="NEXTMONTHS"){if(!isNaN(a.value1)){n=v.ranges.nextMonths(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTMONTHSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextMonths(a.value1-1)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="NEXTQUARTERS"){if(!isNaN(a.value1)){n=v.ranges.nextQuarters(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTQUARTERSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextQuarters(a.value1-1)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="NEXTYEARS"){if(!isNaN(a.value1)){n=v.ranges.nextYears(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTYEARSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextYears(a.value1-1)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="SPECIFICMONTH"){var r=parseInt(a.value1),o=new g;if(Number.isFinite(r)){o.setDate(1);o.setMonth(r);o=v.getMonthStartDate(o);n=v.getRange(0,"MONTH",o);a.value1=n[0];a.value2=n[1]}}else if(a.operation==="TODAYFROMTO"){if(!isNaN(parseInt(a.value1))){a.value1=this._getTodayFromToValueFrom(a.value1)}if(!isNaN(parseInt(a.value2))){a.value2=this._getTodayFromToValueTo(a.value2)}}else{var l=this.getOperation(a.operation);if(l&&l.getDateRange){i=l.getDateRange(a);if(!i){return[]}a.value1=i&&i.value1?i.value1:null;a.value2=i&&i.value2?i.value2:null}}if(a.value1 instanceof g){a.value1=a.value1.oDate}if(a.value2 instanceof g){a.value2=a.value2.oDate}if(a.operation==="DATE"){if(!(this.isValidCondition()&&a.value1)){return[]}a.operation="BT";a.value2=a.value1;a.value1=C.setStartTime(a.value1).oDate;a.value2=C.setEndTime(a.value2,this._bIgnoreTime,this._Precision).oDate}else if(a.operation==="FROM"){if(!(this.isValidCondition()&&a.value1)){return[]}a.operation="GE";delete a.value2;a.value1=C.setStartTime(a.value1,this._bIgnoreTime).oDate}else if(a.operation==="TO"){if(!(this.isValidCondition()&&a.value1)){return[]}a.operation="LE";delete a.value2;a.value1=C.setEndTime(a.value1,this._bIgnoreTime).oDate}else if(this._bSingleFilterRestriction){if(a.operation==="NODATE"){a.operation="EQ";a.value1=null}else if(!(this.isValidCondition()&&a.value1)){return[]}}else if(a.operation==="DATETIME"){if(!(this.isValidCondition()&&a.value1)){return[]}a.operation="BT";a.value2=a.value2?C.setMilliseconds(a.value2):null}else if(a.operation==="DATETIMERANGE"||a.operation==="LASTMINUTES"||a.operation==="LASTHOURS"||a.operation==="NEXTHOURS"||a.operation==="NEXTMINUTES"||a.operation==="LASTMINUTESINCLUDED"||a.operation==="LASTHOURSINCLUDED"||a.operation==="NEXTMINUTESINCLUDED"||a.operation==="NEXTHOURSINCLUDED"){if(!(this.isValidCondition()&&a.value1&&a.value2)){return[]}a.operation="BT"}else if(a.operation==="NODATE"){a.operation="EQ";a.value1=null}else{if(i){a.operation=i.operation;a.value1=a.value1?C.setStartTime(a.value1).oDate:null;a.value2=a.value2?C.setEndTime(a.value2,this._bIgnoreTime).oDate:null}else{if(!(this.isValidCondition()&&a.value1&&a.value2)){return[]}if(!this._bDTOffset||this._bDTOffset&&a.operation.indexOf("INCLUDED")===-1&&a.operation.indexOf("NEXT")===-1){a.value1=C.setStartTime(a.value1).oDate}a.operation="BT";a.value2=C.setEndTime(a.value2,this._bIgnoreTime).oDate}}a.exclude=false;a.keyField=a.key;delete a.key;if(a.value2){if(typeof a.value1.getTime==="function"&&typeof a.value2.getTime==="function"&&a.value1.getTime()>a.value2.getTime()){e=a.value2;a.value2=a.value1;a.value1=e}}return[a]};C.prototype.getTokenText=function(){return""};C.prototype.getName=function(){return this.getMetadata().getName()};C.prototype.getType=function(){return"Edm.Date"};C.prototype._bindValueState=function(e){e.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return _.Error}else{return _.None}}})};C.prototype.initializeFilterItem=function(){return this._initializeFilterItemNew.apply(this,arguments)};C.prototype._getDateFormatter=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:e};if(JSON.stringify(t)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(t);this._oDateFormatter=f.getInstance(t)}return this._oDateFormatter};C.prototype._fillNumberToText=function(e,t,a){var n="X",i="Y";if(t||t===0){n=String(t)}if(a||a===0){i=String(a);if(t<0){n="("+n+")"}if(a<0){i="("+i+")"}}e=e.replace("{0}",n);e=e.replace("{1}",i);return e};C.prototype._setIntControlBinding=function(e,t,n){e.setFieldWidth("auto");e.bindProperty("description",{path:"$smartEntityFilter>"+n,type:new O,formatter:function(){var e=t.descriptionTextKeys[0];var n=t.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return a.getTranslatedText(e)}else{return a.getTranslatedText(n||e)}}})};C.prototype._createIntFromToControl=function(e,t,n){return new l(a._createStableId(e,t),{value:{path:"$smartEntityFilter>"+n,type:new T({},{minimum:-e._maxIntValue,maximum:e._maxIntValue})},textAlign:"End",width:"100%"})};C.prototype._isValidFromToPeriod=function(e,t){if(!e&&e!==0||isNaN(e)){return false}if(!t&&t!==0||isNaN(t)){return false}if(e<-this._maxIntValue||e>this._maxIntValue){return false}if(t<-this._maxIntValue||t>this._maxIntValue){return false}if(e<0&&Math.abs(e)>Math.abs(t)||e===0&&t<0||t<0&&Math.abs(t)>Math.abs(e)||t===0&&e<0||e<0&&t<0){return false}return true};C.prototype._getTodayFromToValueFrom=function(e){if(e<0){var t=v.getRange(-1*e,"DAY")[1];t.setHours(0,0,0);return t}return v.getRange(-e,"DAY")[0]};C.prototype._getTodayFromToValueTo=function(e){if(e<0){var t=v.getRange(e,"DAY")[0];t.setHours(23,59,59);return t}return v.getRange(e,"DAY")[1]};C.prototype._getInputValueState=function(){if(this._oInput){return this._oInput.getValueState()}};C.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}a.prototype.destroy.apply(this,arguments)};C.prototype._initializeFilterItemNew=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:false};this.sCalendarWeekNumbering=this.oFilterProvider&&this.oFilterProvider._oCalendarWeekSettings?this.oFilterProvider._oCalendarWeekSettings:undefined;this._oInput=new c(a._createStableId(this),{name:this.sFieldName,formatter:D.getInstance({date:t}),enableGroupHeaders:!this._bSingleFilterRestriction,calendarWeekNumbering:this.sCalendarWeekNumbering,standardOptions:{path:"$smartEntityFilter>/operations",formatter:function(e){return e.reduce(function(e,t){if(F.includes(t.key)){e.push(t.key)}return e},[])}},change:this._onDDRChange.bind(this)});if(this.oFieldMetadata&&this.oFieldMetadata["com.sap.vocabularies.Common.v1.DocumentationRef"]){this.oFilterProvider._setControlDocumentationRef(this._oInput,this.oFieldMetadata["com.sap.vocabularies.Common.v1.DocumentationRef"])}this._createCustomDDOptions(this.getOperations());if(e!=="mdcFilterPanel"){this._oInput.setValue(this._getDefaultValueDDR())}this._bindValueState(this._oInput);this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};C.prototype.updateOperations=function(){var e=this.getOperations();for(var t=0;t<e.length;t++){this._updateOperation(e[t])}this._createCustomDDOptions(e);this.oModel.setProperty("operations",e,this.getContext(),true);if(this._customSemanticOperation){var a=e.find(function(e){return e.key===this._customSemanticOperation}.bind(this));if(a){this.setOperation(this._customSemanticOperation);this._customSemanticOperation=null}}return};C.prototype.setCondition=function(e){a.prototype.setCondition.apply(this,arguments);this._setDDROperation.call(this,e);return this};C.prototype._onDDRChange=function(e){var t,a,n=e.getParameter("value"),i=e.getParameter("valid");if(this.oModel.bSuspended){this.oModel.resume()}if(i&&n){var r=this._getOptionName(n.operator);t=this.getOperation(r);a=this._prepareDDRValues(t,n,r);this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation",r);this.oModel.setProperty("/condition/value1",a[0]);this.oModel.setProperty("/condition/value2",a[1])}else if(i){t=this.getOperation("DATERANGE");this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation","DATERANGE");this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}e.getSource().setValueStateText("");this.oModel.setProperty("inputstate",i?"NONE":"ERROR",this.getContext())};C.prototype._getDefaultValueDDR=function(){var e=this.getDefaultOperation(),t=e&&e.key;if(!this._getDDROption(t)){return null}var a=typeof e.defaultValues==="function"?e.defaultValues():e.defaultValues;if(!F.includes(t)){t=this._getCustomDDOptionName(t)}if(Array.isArray(a)&&a.length>0&&a[0]!==null){return{operator:t,values:a}}return null};C.prototype._getDDROption=function(e){if(!this._oInput){return null}if(F.includes(e)){return this._oInput.getOption(e)}if(e==="NODATE"){return this._oInput.getOption(e)}return this._oInput.getOption(this._getCustomDDOptionName(e))};C.prototype._getCustomDDOptionName=function(e){return this.sFieldName+"__custom__"+e};C.prototype._getOptionName=function(e){var t=e.split("__custom__");if(t.length>1){return t[1]}return t[0]};C.prototype._createCustomDDOptions=function(e){if(!this._oInput){return}var t=this._oInput.getValue();this._oInput.destroyAggregation("customOptions");e.forEach(this._createCustomDDOption,this);if(t&&!this._getDDROption(this._getOptionName(t.operator))){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}};C.prototype._createCustomDDOption=function(t){if(F.includes(t.key)){return}var a;var n=typeof t.category==="object"?t.category.key:t.category;if(n.toLowerCase().startsWith("fixed")||t.type==="range"){a=this._createCustomFixedDDOption(t)}else if(t.type==="nodate"){a=this._createNoDateDDOption(t)}else{a=this._createCustomDynamicDDOption(t)}a.getGroupHeader=function(){if(typeof t.category==="object"){var a=t.category.bundle;var n=t.category.key;if(e.getResourceBundleFor(a).hasText(n)){return e.getResourceBundleFor(a).getText(n)}}if(e.getResourceBundleFor("sap.ui.comp").hasText(t.category)){return e.getResourceBundleFor("sap.ui.comp").getText(t.category)}if(e.getResourceBundleFor("sap.m").hasText(t.category)){return e.getResourceBundleFor("sap.m").getText(t.category)}return e.getResourceBundleFor("sap.m").getText("DDR_OPTIONS_GROUP_0")};a.getGroup=function(){return t.order};this._oInput.addAggregation("customOptions",a)};C.prototype._createNoDateDDOption=function(e){const t=e.key,n=y.extend(t,{metadata:{library:"sap.ui.comp"},getText:function(){return a.getTranslatedText(e.textKey)},getValueHelpUITypes:function(){return[]},format:function(){return a.getTranslatedText("DATERANGETYPE_NODATE_TEXT")},toDates:function(){return[]},parse:function(t){if(t===a.getTranslatedText("DATERANGETYPE_NODATE_TEXT")||t===a.getTranslatedText("DATERANGETYPE_NODATE")){return e}return null}});return new n({key:t})};C.prototype._createCustomFixedDDOption=function(e){var t=this._getCustomDDOptionName(e.key);var n=this;var i=y.extend(t,{metadata:{library:"sap.ui.comp"},getText:function(){return e.languageText||a.getTranslatedText(e.textKey)},getValueHelpUITypes:function(){return[]},enhanceFormattedValue:function(){if(!n.getOperation(n._getOptionName(e.key))){return false}var t=typeof e.category==="object"?e.category.key:e.category;if(t.toUpperCase().startsWith("FIXED.")&&e.type==="int"){return false}return true},format:this._customDDOptionFormatter.bind(this),toDates:function(t){var a=e.defaultValues;if(typeof a==="function"){a=a()}if(t&&a.length>0&&!(a[0]instanceof Date)){var i=n.oModel.getProperty("",n.oConditionContext),r=i.operation,o=a[0],l=a[1];i.operation=n._getOptionName(t.operator);i.value1=!isNaN(a[0])?parseInt(a[0]):a[0];i.value2=!isNaN(a[1])?parseInt(a[1]):a[1];var s=n.getFilterRanges();i.operation=r;i.value1=o;i.value2=l;if(s.length===0){return[]}return[s[0].value1]}return a},parse:function(t){var n=e.basicLanguageText||e.languageText||a.getTranslatedText(e.textKey);if(t&&n&&n.toLowerCase().startsWith(t.toLowerCase())){return{operator:this.getKey(),values:this.toDates()}}return null}});return new i({key:t})};C.prototype._createCustomDynamicDDOption=function(e){var t=this._getCustomDDOptionName(e.key);var n=this;var i=y.extend(t,{metadata:{library:"sap.ui.comp"},getText:function(){var t=e.languageText||a.getTranslatedText(e.textKey);if(t.indexOf("{0}")>=0){return n._fillNumberToText(t)}return t},getValueHelpUITypes:function(){if(e.type==="int"){return[new I({type:"int"})]}else if(e.type==="[int,int]"){return[new I({type:"int"}),new I({type:"int"})]}},createValueHelpUI:function(t,a){t.aControlsByParameters={};t.aControlsByParameters[this.getKey()]=[];n.setControls([]);var i=n.getControls(e),r=e.defaultValues.length,o=e.defaultValues;if(typeof o==="function"){o=o()}i.forEach(function(e){if(!e.getValue()&&o&&o[0]){if(typeof o==="function"){o=o()}e.setValue(o[0]);o.shift();n.oModel.suspend();n.oModel.setProperty("/condition/value"+(r-o.length),e.getValue())}if(typeof a==="function"){e.attachChange(function(){a(this)},this)}t.aControlsByParameters[this.getKey()].push(e)},this);n.setControls(i);return i},format:this._customDDOptionFormatter.bind(this),toDates:function(e){var t=n.oModel.getProperty("",n.oConditionContext),a=t.operation,i=t.value1,r=t.value2;t.operation=n._getOptionName(e.operator);t.value1=!isNaN(e.values[0])?parseInt(e.values[0]):e.values[0];t.value2=!isNaN(e.values[1])?parseInt(e.values[1]):e.values[1];var o=n.getFilterRanges();t.operation=a;t.value1=i;t.value2=r;if(o.length===0){return[]}return[o[0].value1,o[0].value2]},parse:function(t){var a=new u({key:e.key}),i=e.filterSuggestItem.call(e,t,a,n);if(i){return{operator:this.getKey(),values:[a._value1,a._value2||null]}}return null},validateValueHelpUI:function(e){var t=function(e){var t=e.getValue(),a=this._maxIntValue,n=-this._maxIntValue;if(!t&&t!==0||isNaN(t)){return false}if(r&&r.getBindingInfo("value")&&r.getBindingInfo("value").type&&r.getBindingInfo("value").type.oConstraints){if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("minimum")){n=r.getBindingInfo("value").type.oConstraints.minimum}if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("maximum")){a=r.getBindingInfo("value").type.oConstraints.maximum}}if(t<n||t>a){return false}return true};var a=this.getValueHelpUITypes();for(var i=0;i<a.length;i++){var r=e.aControlsByParameters[this.getKey()][i];switch(a[i].getType()){case"int":return t.call(n,r);case"month":case"date":case"daterange":if(!r.getSelectedDates()||r.getSelectedDates().length==0){return false}break;case"options":if(r.getSelectedIndex()<0){return false}break}}return true}});return new i({key:t})};C.prototype._customDDOptionFormatter=function(e){var t=this._getOptionName(e.operator),a=this.getOperation(t);if(!a){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null);return""}var n=this._prepareDDRValues(a,e,t);var i={conditionTypeInfo:{data:{value1:n[0],value2:n[1]}}};if(a.languageText){var r=a.languageText;if(this._isIntIntInterval(a)){if(i.conditionTypeInfo.data.value1!=null&&i.conditionTypeInfo.data.value1!==""&&i.conditionTypeInfo.data.value2!=null&&i.conditionTypeInfo.data.value2!==""){r=this._formatIntIntInterval(a,i)}}else if(this._isIntInterval(a)){if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){r=this._formatIntInterval(a,i)}else{r=""}}else if(this._isFixedRange(a)){r=this._formatFixedRange(a,a.textValue)}else{if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){var o=this._calculateDateRangeValueText(a,i);var l=o.value;if(l){r=this._formatFixedRange(a,l)}else{r=""}}else{r=""}}}return r};C.prototype._isIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0};C.prototype._formatIntInterval=function(e,t){if(t.conditionTypeInfo.data.value1===0&&e.zeroNumberTextKey){return e.zeroNumberLanguageText}if(t.conditionTypeInfo.data.value1===1&&e.singulareBasicLanguageText){return e.singulareBasicLanguageText}return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1)};C.prototype._isIntIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0&&e.basicLanguageText.indexOf("{1}")>=0};C.prototype._formatIntIntInterval=function(e,t){return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1,t.conditionTypeInfo.data.value2)};C.prototype._isFixedRange=function(e){return e.textValue};C.prototype._formatFixedRange=function(e,t){return e.languageText};C.prototype._calculateDateRangeValueText=function(e,t){var a=t.conditionTypeInfo.data.value1;var n=t.conditionTypeInfo.data.value2;var i;var r=false;if((typeof a==="number"||typeof a==="string"&&!isNaN(parseInt(a)))&&e.valueList){i=e.valueList[a].text}else if(a instanceof Date){var o=this._getDateFormatter(false);if(t.conditionTypeInfo.data.operation!=="DATERANGE"&&(a&&!n)){i=o.format(a)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&n){i=o.format(a)+" - "+o.format(n)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&!n){i=o.format(a)+" - ";r=true}else{i=""}}else{i=t.conditionTypeInfo.data.value1}return{value:i,bSetCursor:r}};C.prototype._convertUniversalDateToDate=function(e){return e.map(function(e){if(e.getJSDate){return e.getJSDate()}return e})};C.prototype._clearModelInputState=function(e,t){if(t.type==="[int,int]"&&this._isValidFromToPeriod(e.conditionTypeInfo.data.value1,e.conditionTypeInfo.data.value2)){this.oModel.setProperty("inputstate","NONE",this.getContext())}else if(t.type==="int"&&e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){this.oModel.setProperty("inputstate","NONE",this.getContext())}else if(this._isFixedRange(t)){this.oModel.setProperty("inputstate","NONE",this.getContext())}else if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var a=this._calculateDateRangeValueText(t,e);if(a.value){this.oModel.setProperty("inputstate","NONE",this.getContext())}}};C.prototype._prepareDDRValues=function(e,t,a){if(a==="SPECIFICMONTH"){return[].concat(t.values)}if(a==="NODATE"){return[0]}var n=typeof e.category==="object"?e.category.key:e.category;if(e.type==="int"&&!n.toUpperCase().startsWith("FIXED.")){return[parseInt(t.values[0]),null]}if(e.type==="[int,int]"){return[parseInt(t.values[0]),parseInt(t.values[1])]}var i=this._oInput.toDates(t);if(this._bDTOffset&&(a==="DATETIME"||a==="DATETIMERANGE")){if(i[0]){i[0]=N.localToUiTimezone(i[0].oDate)}if(i[1]){i[1]=N.localToUiTimezone(i[1].oDate);i[1]=C.setMilliseconds(i[1])}}return this._convertUniversalDateToDate(i)};C.prototype._setDDROperation=function(e){if(this._oInput&&e.key&&e.operation){var t=[];if(e.value1||e.value1===0){t[0]=e.value1;if(e.value2||e.value2===0){t[1]=e.value2}}var a=this._getDDROption(e.operation),n=this.getOperation(e.operation),i=function(e,t){if(!e){return false}if(e.hasOwnProperty("value1")&&!t[0]&&t[0]!==0){return false}if(e.hasOwnProperty("value2")&&!t[1]&&t[1]!==0){return false}return true};if(this._bDTOffset&&(a.getKey()==="DATETIME"||a.getKey()==="DATETIMERANGE")){if(t[0]){t[0]=N.uiTimezoneToLocal(t[0])}if(t[1]){t[1]=N.uiTimezoneToLocal(t[1]);t[1]=C.setMilliseconds(t[1])}}if(i(n,t)){this._oInput.setValue({key:e.key,operator:a.getKey(),values:t})}else{this._oInput.setValue(null);this._oInput._oInput.setValue(null)}}};return C});
//# sourceMappingURL=DateRangeType.js.map