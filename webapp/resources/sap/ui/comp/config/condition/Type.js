/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/date/UI5Date","sap/ui/base/EventProvider","sap/ui/model/json/JSONModel","sap/ui/core/date/UniversalDate","sap/ui/core/Core","sap/ui/core/Lib"],function(t,e,o,i,n,r){"use strict";var a=e.extend("sap.ui.comp.config.condition.Type",{constructor:function(t,i,n){e.call(this);this.oFilterProvider=i;var r={condition:{operation:"",value1:null,value2:null,key:t},operations:[],controls:[],currentoperation:{},pending:false};this.oModel=new o(r);var a=this.oModel.checkUpdate;this.oModel.suspend=function(){this.bSuspended=true;this.checkUpdate=function(){}};this.oModel.resume=function(){this.bSuspended=false;this.checkUpdate=a;this.checkUpdate()};this.oContext=this.oModel.getContext("/");this.oConditionContext=this.oModel.getContext("/condition");this.sFieldName=t;var s=this.oModel.bindProperty("operation",this.oConditionContext),l=this;s.attachChange(function(){var t=l.oModel.getProperty("operation",l.getConditionContext()),e=l.getOperation(t);if(e){e=Object.assign({},e);if(!l.bIgnoreBindingChange){var o=l.getDefaultValues(e);if(l._bSingleFilterRestriction&&o[0]){l.setDefaultValues(o[0].oDate,o[1])}else{l.setDefaultValues(o[0],o[1])}}}l.setControls([]);l.setControls(l.getControls(e));if(e){if(e.getValueList){e.valueList=e.getValueList()}l.oModel.setProperty("/currentoperation",e)}if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var u=this.oModel.bindProperty("value1",this.oConditionContext);u.attachChange(function(){if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var p=this.oModel.bindProperty("value2",this.oConditionContext);p.attachChange(function(){if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var d=this.oModel.bindProperty("pending",this.oContext);d.attachChange(function(){if(l.bAsync){if(l._iPendingTimer){clearTimeout(l._iPendingTimer)}l._iPendingTimer=setTimeout(l["fireEvent"].bind(l,"PendingChange",{oSource:l,pending:l.oModel.getProperty("/pending")}),10)}});this.oFieldMetadata=n;this.oOperationFilter=null;this.bAsync=false}});a._createStableId=function(t,e){if(t&&t.oFilterProvider&&t.oFieldMetadata){return t.oFilterProvider._createFilterControlId(t.oFieldMetadata)+(e?e:"")}else{return undefined}};a.getTranslatedText=function(t,e,o){if(typeof t==="object"){e=t.bundle;t=t.key}if(!e){e="sap.ui.comp"}return r.getResourceBundleFor(e).getText(t,o)||t};a.prototype.getTranslatedText=a.getTranslatedText;a.prototype.applySettings=function(e){if(e&&e.defaultOperation){this._sSettingsDefaultOperation=e.defaultOperation;if(e.values){this._defaultDate=e.values}}if(e&&e.defaultDate&&!e.defaultOperation){var o=t.getInstance(e.defaultDate);if(o instanceof Date){this._sSettingsDefaultOperation="DATE";this._defaultDate=e.defaultDate}}if(e&&e.operations&&e.operations.filter){this.oOperationFilter=e.operations.filter}else{this.oOperationFilter=null}};a.prototype.getParent=function(){return this.oFilterProvider._oSmartFilter};a.prototype.getModel=function(){return this.oModel};a.prototype.getConditionContext=function(){return this.oConditionContext};a.prototype.setDefaultValues=function(t,e){this.oModel.setProperty("value1",t,this.getConditionContext(),true);this.oModel.setProperty("value2",e,this.getConditionContext(),true)};a.prototype.getContext=function(){return this.oContext};a.prototype.getControls=function(t){return[]};a.prototype.getOperations=function(){return[]};a.prototype.isPending=function(){return this.getModel().getProperty("pending",this.getContext())};a.prototype.attachPendingChange=function(t){this.attachEvent("PendingChange",t)};a.prototype.detachPendingChange=function(t){this.detachEvent("PendingChange",t)};a.prototype.setPending=function(t){if(this.bAsync){this.getModel().setProperty("pending",t,this.getContext())}};a.prototype._filterOperation=function(t){if(!this.oOperationFilter){return true}var e=Array.isArray(this.oOperationFilter)?this.oOperationFilter:[this.oOperationFilter],o;e.some(function(e){if(!e.path){return false}var i=t[e.path];var n=e.exclude||false;var r;if(e.contains&&i){r=typeof e.contains==="string"?e.contains.split(","):e.contains;o=n;for(var a=0;a<r.length;a++){if(n&&i.indexOf(r[a])>-1){o=false;return true}else if(!n&&i.indexOf(r[a])>-1){o=true;return true}}}if(e.equals&&i){r=typeof e.equals==="string"?e.equals.split(","):e.equals;o=n;for(var a=0;a<r.length;a++){if(n&&i===r[a]){o=false;return true}else if(!n&&i===r[a]){o=true;return true}}}return false});return o};a.prototype._updateOperation=function(t){if(!t.textValue){t.textValue=""}if(!t.languageText&&t.textKey){t.languageText=this.getTranslatedText(t.textKey)}};a.prototype.updateOperations=function(){this.oModel.setProperty("operations",[],this.getContext())};a.prototype.getOperation=function(t){var e=this.oModel.getProperty("operations",this.getContext())||[];for(var o=0;o<e.length;o++){if(t===e[o].key){return e[o]}}return null};a.prototype.getDefaultOperation=function(){var t=this.getOperations();if(!t||t.length===0){return null}for(var e=0;e<t.length;e++){if(this._sSettingsDefaultOperation===t[e].key){if(this._defaultDate&&t[e].key==="DATE"){t[e].defaultValues=[new i(this._defaultDate).oDate];this._defaultDate=null}if(t[e].defaultValues&&this._defaultDate){if(Array.isArray(t[e].defaultValues)&&Array.isArray(this._defaultDate)){if(t[e].defaultValues.length<=this._defaultDate.length){t[e].defaultValues=this._defaultDate}else if(this._defaultDate.length===1){t[e].defaultValues[0]=this._defaultDate[0]}this._defaultDate=null}}return t[e]}if(!this._sSettingsDefaultOperation&&t[e].defaultOperation){if(!this._defaultDate&&t[e].key==="DATE"&&t[e].defaultValues&&t[e].defaultValues[0]){t[e].defaultValues=[null]}return t[e]}}return t[0]};a.prototype.setControls=function(t){var e=this.oModel.getProperty("controls",this.getContext());var o;if(e){for(o=0;o<e.length;o++){e[o].destroy()}}this.oModel.setProperty("controls",t,this.getContext());if(t){for(o=0;o<t.length;o++){t[o].setBindingContext(this.getConditionContext(),"$smartEntityFilter")}}};a.prototype.setOperation=function(t){var e=this.getOperation(t);if(e){this.setCondition({operation:e.key,key:this.sFieldName,value1:e.defaultValues[0]||null,value2:e.defaultValues[1]||null});this.getModel().checkUpdate(true)}else{}};a.prototype.isValidCondition=function(){return false};a.prototype.setCondition=function(t){this.oModel.setProperty("key",t.key,this.oConditionContext);this.oModel.setProperty("operation",t.operation,this.oConditionContext);this.oModel.setProperty("value1",t.value1,this.oConditionContext);this.oModel.setProperty("value2",t.value2,this.oConditionContext);this.oModel.setProperty("tokenText",this.getTokenText(t),this.oConditionContext);return this};a.prototype.setAsync=function(t){this.bAsync=t};a.prototype.getAsync=function(t){return this.bAsync};a.prototype.initialize=function(t){this.updateOperations()};a.prototype.serialize=function(){};a.prototype.validate=function(t){this._bForceError=t!==false;var e,o=this.getModel().getProperty("inputstate",this.getContext())||"NONE";if(!this.isPending()&&this.oFieldMetadata&&this.oFieldMetadata.isMandatory&&(!this.isValidCondition()||o!=="NONE")&&this._bForceError){e=this.oFieldMetadata.control;if(e&&e.setValueStateText){e.setValueStateText(this.getTranslatedText("MANDATORY_FIELD_WITH_LABEL_ERROR","sap.ui.comp",[this.oFieldMetadata.label]))}this.getModel().setProperty("inputstate","ERROR",this.getContext());return false}this.getModel().setProperty("inputstate","NONE",this.getContext());return true};a.prototype.getCondition=function(){var t=Object.assign({},this.oModel.getProperty("",this.oConditionContext));return t};a.prototype.providerDataUpdated=function(t,e){};a.prototype.getFilter=function(t){return null};a.prototype.getFilterRanges=function(t){return null};a.prototype.getTokenText=function(t){return""};a.prototype.getName=function(){return this.getMetadata().getName()};a.prototype.getType=function(){return"Edm"};a.prototype.destroy=function(){this.setControls([]);e.prototype.destroy.apply(this,arguments)};return a});
//# sourceMappingURL=Type.js.map