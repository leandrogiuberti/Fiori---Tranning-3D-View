//@ui5-bundle sap/ui/comp/library-preload.js
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/ControlConfigurationBase", ["sap/ui/core/Element"],function(e){"use strict";const t=e.extend("sap.ui.comp.config.ControlConfigurationBase",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},conditionType:{type:"any",group:"Misc",defaultValue:null}}}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/FilterControlConfiguration", ["sap/ui/comp/config/ControlConfigurationBase"],function(i){"use strict";const o=i.extend("sap.ui.comp.config.FilterControlConfiguration",{metadata:{library:"sap.ui.comp"}});return o});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/condition/DateRangeType", ["sap/ui/core/Lib","sap/ui/core/date/UI5Date","sap/ui/thirdparty/jquery","sap/ui/comp/config/condition/Type","sap/ui/Device","sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/m/Input","sap/m/Text","sap/ui/core/ListItem","sap/m/Label","sap/ui/core/date/UniversalDate","sap/ui/core/format/DateFormat","sap/ui/comp/config/condition/NullableInteger","sap/base/Log","sap/ui/core/date/UniversalDateUtils","sap/m/DynamicDateRange","sap/m/DynamicDateUtil","sap/m/DynamicDateFormat","sap/m/DynamicDateOption","sap/m/DynamicDateValueHelpUIType","sap/m/StandardDynamicDateOption","sap/ui/comp/util/DateTimeUtil","sap/ui/dom/jquery/cursorPos","sap/ui/core/Core","sap/ui/model/type/Date","sap/ui/model/type/Integer","sap/ui/model/odata/type/String"],function(e,t,jQuery,a,n,i,r,o,l,s,u,p,g,f,T,d,v,c,E,D,y,I,h,N,A,m,S,O,R){"use strict";var _=i.ValueState,F=Object.keys(o.StandardDynamicDateRangeKeys).concat(["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS","NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"]);var C=a.extend("sap.ui.comp.config.condition.DateRangeType",{constructor:function(e,t,n){a.apply(this,[e,t,n]);this.oDateFormat=t&&t._oDateFormatSettings?t._oDateFormatSettings:{UTC:true};this._bIgnoreTime=false;this._maxIntValue=1e4;this.bMandatory=this.oFieldMetadata?this.oFieldMetadata.isMandatory:false;var i=this.oFieldMetadata&&this.oFieldMetadata.name,o=t&&t._oAdditionalConfiguration&&(t._oAdditionalConfiguration.getControlConfigurationByKey(e)||i&&t._oAdditionalConfiguration.getControlConfigurationByKey(i));this._bSingleFilterRestriction=n&&n.filterRestriction===r.smartfilterbar.FilterType.single&&(t._bUseDateRangeType||o&&(o.conditionType===this.getName()||typeof o.conditionType==="object"&&o.conditionType.module===this.getName()));this._bDTOffset=n&&n.filterRestriction===r.smartfilterbar.FilterType.interval&&n.type==="Edm.DateTimeOffset";this._customSemanticOperation=null}});C.prototype.applySettings=function(e){a.prototype.applySettings.apply(this,arguments);if(e&&e.ignoreTime){this._bIgnoreTime=e.ignoreTime}};C.setStartTime=function(e){e=C.toUniversalDate(e);return v.resetStartTime(e)};C.setEndTime=function(e,t){e=C.toUniversalDate(e);if(!t){return v.resetEndTime(e)}else{return v.resetStartTime(e)}};C.setMilliseconds=function(e){e=C.toUniversalDate(e);e.setMilliseconds(999);return e.oDate};C.toUniversalDate=function(e){if(e instanceof Date){return g.getInstance(e)}if(!e){return g.getInstance()}if(!(e instanceof g)){return C.toUniversalDate(t.getInstance(e))}return e};C.getWeekStartDate=function(e){return v.getWeekStartDate(e)};C.getMonthStartDate=function(e){return v.getMonthStartDate(e)};C.getQuarterStartDate=function(e){return v.getQuarterStartDate(e)};C.getYearStartDate=function(e){return v.getYearStartDate(e)};C.getDateRange=function(e,t,a,n,i){if(a===true){n=true;a=null}if(!a){a=new g}else{a=new g(a)}if(n){switch(t){case"DAY":break;case"WEEK":a=v.getWeekStartDate(a);break;case"MONTH":a=v.getMonthStartDate(a);break;case"QUARTER":a=v.getQuarterStartDate(a);break;case"YEAR":a=v.getYearStartDate(a);break}}if(!i&&e>0){if(e!==0&&!isNaN(e)){var r=-1;switch(t){case"DAY":a.setDate(a.getDate()+r);break;case"WEEK":a.setDate(a.getDate()+r*7);break;case"MONTH":a.setMonth(a.getMonth()+r);break;case"QUARTER":a.setMonth(a.getMonth()+r*3);break;case"YEAR":a.setFullYear(a.getFullYear()+r);break}}}return v.getRange(e,t,a,false)};C.getTextField=function(e,t){var n=a._createStableId(e,"text");if(t){return new s(n,{text:{parts:[{path:"$smartEntityFilter>value1",type:new S({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})},{path:"$smartEntityFilter>value2",type:new S({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})}],formatter:(e,t)=>`${e} - ${t}`}})}else{return new s(n,{text:{path:"$smartEntityFilter>value1",type:new S({style:e.oDateFormat.style,pattern:e.oDateFormat.pattern})}})}};C.getIntField=function(e){return new l(a._createStableId(e,"field"),{value:{path:"$smartEntityFilter>value1",type:new T({},{minimum:0,maximum:e._maxIntValue})},textAlign:"End",width:"100%"})};C.getIntFromToField=function(e,t,n){var i=new p({text:a.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELFROM")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);var r=e._createIntFromToControl(e,"fieldFrom","value1");i.setLabelFor(r);t.push(r);i=new p({text:a.getTranslatedText("CONDITION_DATERANGETYPE_DATERANGE_LABELTO")});i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);var o=e._createIntFromToControl(e,"fieldTo","value2");i.setLabelFor(o);t.push(o);e._setIntControlBinding(r,n,"value1");e._setIntControlBinding(o,n,"value2")};C.ControlFactory=function(e,t,n){if(n.type==="range"){var i=C.getTextField(e,n.display!=="start");i.addStyleClass("sapUiCompFilterBarCTPaddingTop");t.push(i);return}if(n.type==="int"){var i=C.getIntField(e);t.push(i);if(n.descriptionTextKeys){i.setFieldWidth("auto");i.bindProperty("description",{path:"$smartEntityFilter>value1",type:new O,formatter:function(){var e=n.descriptionTextKeys[0];var t=n.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return a.getTranslatedText(e)}else{return a.getTranslatedText(t||e)}}})}}if(n.type==="[int,int]"){C.getIntFromToField(e,t,n)}};C._defaultOnChangeHandler=function(e,t){if(e.toLowerCase()===this.languageText.toLowerCase()){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("inputstate","NONE",t.getContext());if(this.category.indexOf("FIXED")!==0){t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}return false};C._IntOnChangeHandler=function(e,t){if(this.basicLanguageText.indexOf("{0}")>=0){var a=new RegExp(this.basicLanguageText.replace("+","\\+").replace("{0}","([a-zA-Z0-9_]+)")+"$","i");if(e.match(a)){var e=e.match(a)[1];if(e){var n=parseInt(e);if(!isNaN(n)&&n<=t._maxIntValue){t.oModel.setProperty("/condition/operation",this.key);t.oModel.setProperty("/condition/value1",n);t.oModel.setProperty("inputstate","NONE",t.getContext())}else{t.oModel.setProperty("inputstate","ERROR",t.getContext())}return true}}}return false};C._DefaultFilterSuggestItem=function(e,t,a){var n=false;if(this.languageText.toLowerCase().startsWith(e.toLowerCase())){n=true}else{var i=this.languageText.split(" ");for(var r=0;r<i.length;r++){var o=i[r];if(o.toLowerCase().startsWith(e.toLowerCase())){n=true}}}t.setAdditionalText(this.textValue);t.setText(this.languageText);return n};C._HideFilterSuggestItem=function(e,t,a){return false};C._IntFilterSuggestItem=function(e,t,n){if(!this.basicLanguageText){this.basicLanguageText=n.basicLanguageText}if(!this.basicLanguageText){this.basicLanguageText=this.languageText||a.getTranslatedText(this.textKey)}var i=this.basicLanguageText.indexOf("{0}");var r;var o;if(i>=0){r=this.basicLanguageText.slice(0,i).trim();o=this.basicLanguageText.slice(i+3).trim()}var l=e.split(" ");if(l.length<1||l.length>3){return false}var s=false;var u;var p=function(e){return!!e.match(/(^[0-9]+$)/)&&parseInt(e)>=0};if(r.toLowerCase().startsWith(l[0].toLowerCase())){if(l[1]){if(p(l[1])){u=l[1];if(l[2]){if(o.toLowerCase().startsWith(l[2].toLowerCase())){s=true}}else{s=true}}}else{s=true}}else if(p(l[0])&&l.length<3){u=l[0];if(l[1]){if(o.toLowerCase().startsWith(l[1].toLowerCase())){s=true}}else{s=true}}else if(o.toLowerCase().startsWith(l[0].toLowerCase())&&l.length==1){s=true}if(s&&u){var g;switch(this.category){case"DYNAMIC.DATE.INT":g="DAY";break;case"DYNAMIC.WEEK.INT":g="WEEK";break;case"DYNAMIC.MONTH.INT":g="MONTH";break;case"DYNAMIC.QUARTER.INT":g="QUARTER";break;case"DYNAMIC.YEAR.INT":g="YEAR";break;default:g="DAY";break}var f=parseInt(u),T=true;if(!n._maxIntValue){n._maxIntValue=n.getControls(n.key)[0].getBindingInfo("value").type.oConstraints.maximum}if(f>n._maxIntValue){s=false}if(this.key.startsWith("LAST")){f=f*-1;T=false}var d;if(this.getDateRange){var v=this.getDateRange({operation:this.key,value1:f});d=[v.value1,v.value2]}else{d=C.getDateRange(f,g,true,T,T)}var c=n._getDateFormatter(true);if(Math.abs(f)===1&&this.singulareBasicLanguageText){t.setText(this.singulareBasicLanguageText);if(g!=="DAY"){t.setAdditionalText(c.format(d[0])+" - "+c.format(d[1]))}else{t.setAdditionalText(c.format(d[0]))}}else{t.setText(n._fillNumberToText(this.basicLanguageText,u));t.setAdditionalText(c.format(d[0])+" - "+c.format(d[1]))}t._value1=parseInt(u)}else{t.setAdditionalText(null);t.setText(this.languageText);t._value1=null}return s};C._DefaultOnItemSelected=function(e,t,a){a.oModel.setProperty("/condition/operation",this.key);if("value1"in this){a.oModel.setProperty("/condition/value1",t._value1)}if("value2"in this){a.oModel.setProperty("/condition/value2",t._value2)}a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};C._IntOnItemSelected=function(e,t,a){var n=t._value1;a.oModel.setProperty("/condition/operation",this.key);a.oModel.setProperty("/condition/value1",n);a.oModel.setProperty("inputstate","NONE",a.getContext());a._bSuggestItemSelected=true};C.getFixedRangeOperation=function(e,t,a,n,i,r){return Object.assign({textKey:t,filterSuggestItem:i||C._DefaultFilterSuggestItem,onItemSelected:C._DefaultOnItemSelected,getControls:C.ControlFactory},C._getFixedRangeOperation(e,a,n,r))};C._getFixedRangeOperation=function(e,t,a,n){return{key:e,category:t,order:n||100,defaultValues:a||null,type:"range",display:"range"}};C.createSingleIntRangeOperation=function(e,t,a,n,i,r,o,l){return Object.assign({textKey:t,singularTextKey:a,zeroNumberTextKey:l,descriptionTextKeys:r,onChange:C._IntOnChangeHandler,filterSuggestItem:C._IntFilterSuggestItem,onItemSelected:C._IntOnItemSelected,getControls:C.ControlFactory},C._createSingleIntRangeOperation(e,n,i,o))};C._createSingleIntRangeOperation=function(e,t,a,n){return{key:e,category:t,order:n,defaultValues:[a],value1:null,type:"int",_getInitialValues:function(e){return[e.value1,e.value2]}}};C.Operations={DATERANGE:{key:"DATERANGE",category:"DYNAMIC.DATERANGE",order:2,defaultOperation:true,defaultValues:[null,null],value1:null,value2:null},DATE:{key:"DATE",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null},FROM:{key:"FROM",category:"DYNAMIC.DATE",order:0,defaultValues:[null],value1:null},TO:{key:"TO",category:"DYNAMIC.DATE",order:1,defaultValues:[null],value1:null},LASTDAYS:C._createSingleIntRangeOperation("LASTDAYS","DYNAMIC.DATE.INT",1,4),LASTWEEKS:C._createSingleIntRangeOperation("LASTWEEKS","DYNAMIC.WEEK.INT",1,8),LASTMONTHS:{key:"LASTMONTHS",category:"DYNAMIC.MONTH.INT",order:14,defaultValues:[1],value1:null,type:"int"},LASTQUARTERS:{key:"LASTQUARTERS",category:"DYNAMIC.QUARTER.INT",order:19,defaultValues:[1],value1:null,type:"int"},LASTYEARS:{key:"LASTYEARS",category:"DYNAMIC.YEAR.INT",order:28,defaultValues:[1],value1:null,type:"int"},NEXTDAYS:{key:"NEXTDAYS",category:"DYNAMIC.DATE.INT",order:5,defaultValues:[1],value1:null,type:"int"},NEXTWEEKS:{key:"NEXTWEEKS",category:"DYNAMIC.WEEK.INT",order:10,defaultValues:[1],value1:null,type:"int"},NEXTMONTHS:{key:"NEXTMONTHS",category:"DYNAMIC.MONTH.INT",order:16,defaultValues:[1],value1:null,type:"int"},NEXTQUARTERS:{key:"NEXTQUARTERS",category:"DYNAMIC.QUARTER.INT",order:21,defaultValues:[1],value1:null,type:"int"},NEXTYEARS:{key:"NEXTYEARS",category:"DYNAMIC.YEAR.INT",order:30,defaultValues:[1],value1:null,type:"int"},SPECIFICMONTH:{key:"SPECIFICMONTH",category:"DYNAMIC.MONTH",order:11,defaultValues:function(){var e=new g;return[e.getMonth()]},value1:null},YESTERDAY:{key:"YESTERDAY",category:"FIXED.DATE",order:3.1,defaultValues:function(){return v.ranges.yesterday()},type:"range",display:"start"},TODAY:{key:"TODAY",category:"FIXED.DATE",order:3,defaultValues:function(){return v.ranges.today()},type:"range",display:"start"},TOMORROW:{key:"TOMORROW",category:"FIXED.DATE",order:3.2,defaultValues:function(){var e=v.ranges.tomorrow();return e},type:"range",display:"start"},THISWEEK:C._getFixedRangeOperation("THISWEEK","FIXED.WEEK",function(){return v.ranges.currentWeek("Default")},6),LASTWEEK:C._getFixedRangeOperation("LASTWEEK","FIXED.WEEK",function(){return v.ranges.lastWeek("Default")},7),LAST2WEEKS:C._getFixedRangeOperation("LAST2WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-2,"Default")},-1),LAST3WEEKS:C._getFixedRangeOperation("LAST3WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-3,"Default")},-1),LAST4WEEKS:C._getFixedRangeOperation("LAST4WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-4,"Default")},-1),LAST5WEEKS:C._getFixedRangeOperation("LAST5WEEKS","FIXED.WEEK",function(){return v.ranges.lastWeeks(-5,"Default")},-1),NEXTWEEK:C._getFixedRangeOperation("NEXTWEEK","FIXED.WEEK",function(){return v.ranges.nextWeek("Default")},9),NEXT2WEEKS:C._getFixedRangeOperation("NEXT2WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(2,"Default")},-1),NEXT3WEEKS:C._getFixedRangeOperation("NEXT3WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(3,"Default")},-1),NEXT4WEEKS:C._getFixedRangeOperation("NEXT4WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(4,"Default")},-1),NEXT5WEEKS:C._getFixedRangeOperation("NEXT5WEEKS","FIXED.WEEK",function(){return v.ranges.nextWeeks(5,"Default")},-1),THISMONTH:C._getFixedRangeOperation("THISMONTH","FIXED.MONTH",function(){return v.ranges.currentMonth()},12),LASTMONTH:C._getFixedRangeOperation("LASTMONTH","FIXED.MONTH",function(){return v.ranges.lastMonth()},13),NEXTMONTH:C._getFixedRangeOperation("NEXTMONTH","FIXED.MONTH",function(){return v.ranges.nextMonth()},15),THISQUARTER:C._getFixedRangeOperation("THISQUARTER","FIXED.QUARTER",function(){return v.ranges.currentQuarter()},17),LASTQUARTER:C._getFixedRangeOperation("LASTQUARTER","FIXED.QUARTER",function(){return v.ranges.lastQuarter()},18),NEXTQUARTER:C._getFixedRangeOperation("NEXTQUARTER","FIXED.QUARTER",function(){return v.ranges.nextQuarter()},20),YEARTODATE:C._getFixedRangeOperation("YEARTODATE","FIXED.YEAR",function(){return v.ranges.yearToDate()},31),THISYEAR:C._getFixedRangeOperation("THISYEAR","FIXED.YEAR",function(){return v.ranges.currentYear()},26),LASTYEAR:C._getFixedRangeOperation("LASTYEAR","FIXED.YEAR",function(){return v.ranges.lastYear()},27),NEXTYEAR:C._getFixedRangeOperation("NEXTYEAR","FIXED.YEAR",function(){return v.ranges.nextYear()},29),QUARTER1:C._getFixedRangeOperation("QUARTER1","FIXED.QUARTER",function(){return v.ranges.quarter(1)},22),QUARTER2:C._getFixedRangeOperation("QUARTER2","FIXED.QUARTER",function(){return v.ranges.quarter(2)},23),QUARTER3:C._getFixedRangeOperation("QUARTER3","FIXED.QUARTER",function(){return v.ranges.quarter(3)},24),QUARTER4:C._getFixedRangeOperation("QUARTER4","FIXED.QUARTER",function(){return v.ranges.quarter(4)},25),TODAYFROMTO:{key:"TODAYFROMTO",category:"DYNAMIC.DATE.INT",order:3.3,defaultValues:[1,1],type:"[int,int]",display:"int",value1:null,value2:null}};C.SingleParameterOperations={DATE:Object.assign({},C.Operations.DATE,{defaultOperation:true}),YESTERDAY:C.Operations.YESTERDAY,TODAY:C.Operations.TODAY,TOMORROW:C.Operations.TOMORROW,FIRSTDAYWEEK:{key:"FIRSTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"FIRSTDAYWEEK",values:[]},"Default")}},LASTDAYWEEK:{key:"LASTDAYWEEK",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"LASTDAYWEEK",values:[]},"Default")}},FIRSTDAYMONTH:{key:"FIRSTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"FIRSTDAYMONTH",values:[]})}},LASTDAYMONTH:{key:"LASTDAYMONTH",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"LASTDAYMONTH",values:[]})}},FIRSTDAYQUARTER:{key:"FIRSTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"FIRSTDAYQUARTER",values:[]})}},LASTDAYQUARTER:{key:"LASTDAYQUARTER",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"LASTDAYQUARTER",values:[]})}},FIRSTDAYYEAR:{key:"FIRSTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"FIRSTDAYYEAR",values:[]})}},LASTDAYYEAR:{key:"LASTDAYYEAR",category:"FIXED.DATE",type:"range",display:"start",defaultValues:function(){return(new h).toDates({operator:"LASTDAYYEAR",values:[]})}}};C.SingleOperations=Object.assign({},C.SingleParameterOperations,{NODATE:{key:"NODATE",operator:"NODATE",category:"DATERANGETYPE_NODATECATEGORY",type:"nodate",order:100,textKey:"DATERANGETYPE_NODATE",value1:null,defaultValues:[null]}});C.NewDynamicDateRangeOperations={DATETOYEAR:{key:"DATETOYEAR",category:"FIXED.YEAR",type:"range",display:"range",defaultValues:function(){return(new h).toDates({operator:"DATETOYEAR",values:[]})}},LASTDAYSINCLUDED:{key:"LASTDAYSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},LASTWEEKSINCLUDED:{key:"LASTWEEKSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},LASTMONTHSINCLUDED:{key:"LASTMONTHSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},LASTQUARTERSINCLUDED:{key:"LASTQUARTERSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},LASTYEARSINCLUDED:{key:"LASTYEARSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTDAYSINCLUDED:{key:"NEXTDAYSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTWEEKSINCLUDED:{key:"NEXTWEEKSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTMONTHSINCLUDED:{key:"NEXTMONTHSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTQUARTERSINCLUDED:{key:"NEXTQUARTERSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NEXTYEARSINCLUDED:{key:"NEXTYEARSINCLUDED",category:"DYNAMIC.DATE.INT",type:"int",value1:null,defaultValues:[null]},NODATE:{key:"NODATE",operator:"NODATE",category:"DATERANGETYPE_NODATECATEGORY",type:"nodate",order:100,textKey:"DATERANGETYPE_NODATE",value1:null,defaultValues:[null]}};C.DTOffsetOperations=Object.assign({NEXTMINUTES:{key:"NEXTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},NEXTHOURS:{key:"NEXTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},LASTMINUTES:{key:"LASTMINUTES",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},LASTHOURS:{key:"LASTHOURS",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},LASTMINUTESINCLUDED:{key:"LASTMINUTESINCLUDED",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},LASTHOURSINCLUDED:{key:"LASTHOURSINCLUDED",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]},NEXTMINUTESINCLUDED:{key:"NEXTMINUTESINCLUDED",category:"DYNAMIC.MINUTE.INT",type:"int",value1:null,defaultValues:[null]},NEXTHOURSINCLUDED:{key:"NEXTHOURSINCLUDED",category:"DYNAMIC.HOUR.INT",type:"int",value1:null,defaultValues:[null]}},C.Operations,C.NewDynamicDateRangeOperations,{DATERANGE:Object.assign({},C.Operations.DATERANGE,{defaultOperation:false}),DATETIME:{key:"DATETIME",category:"DYNAMIC.DATETIME",type:"range",display:"range",value1:null,value2:null,defaultValues:[null]},DATETIMERANGE:{key:"DATETIMERANGE",category:"DYNAMIC.DATETIMERANGE",type:"range",display:"range",defaultOperation:true,value1:null,value2:null,defaultValues:[null,null]}});C.prototype.getControls=function(e){var t=[];if(!e){return}if(!e.getControls){e.getControls=C.ControlFactory}e.getControls(this,t,e);return t};C.prototype.setIgnoreTime=function(e){this._bIgnoreTime=e};a.prototype.getIgnoreTime=function(e){return this._bIgnoreTime};C.prototype.getDefaultValues=function(e){if(!e){return[]}var t=e.defaultValues||[];if(typeof t==="function"){t=e.defaultValues()}var a=this.getCondition(),n=t[0]||null,i=t[1]||null;if(e.key==="DATERANGE"&&a&&a.value1&&a.value2&&(a.value1 instanceof Date&&a.value2 instanceof Date||a.value1.oDate&&a.value2.oDate)){n=a.value1.oDate||a.value1;i=a.value2.oDate||a.value2}else{if(n instanceof Date){n=new g(n)}if(i instanceof Date){i=new g(i)}}return[n,i]};C.prototype.getOperations=function(){if(this.oFieldMetadata?.isParameter&&this._bSingleFilterRestriction){return this.getSingleParameterOperations()}if(this._bSingleFilterRestriction){return this.getSingleOperations()}if(this._bDTOffset){return this.getDTOffsetOperations()}var e=[];var t=Object.assign({},C.Operations,C.NewDynamicDateRangeOperations);for(var a in t){var n=t[a];if(this._filterOperation(n)){e.push(n)}}return e};C.prototype.getSingleParameterOperations=function(){var e=[];for(var t in C.SingleParameterOperations){var a=C.SingleParameterOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};C.prototype.getSingleOperations=function(){var e=[];for(var t in C.SingleOperations){var a=C.SingleOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};C.prototype.getDTOffsetOperations=function(){var e=[];for(var t in C.DTOffsetOperations){var a=C.DTOffsetOperations[t];if(this._filterOperation(a)){e.push(a)}}return e};C.prototype._updateOperation=function(e){a.prototype._updateOperation.apply(this,[e]);if(e.languageText&&!e.basicLanguageText){e.basicLanguageText=e.languageText;if(!e.singulareBasicLanguageText&&e.singularTextKey){e.singulareBasicLanguageText=this.getTranslatedText(e.singularTextKey)}if(!e.zeroNumberLanguageText&&e.zeroNumberTextKey){e.zeroNumberLanguageText=this.getTranslatedText(e.zeroNumberTextKey)}e.languageText=this._fillNumberToText(e.languageText)}if(e.display){var t=this.getDefaultValues(e);var n=this._getDateFormatter(false);if(e.display==="start"&&t[0]!==null){e.textValue=n.format(t[0].oDate)}else if(e.display==="range"&&t&&t[0]&&t[1]){e.textValue=n.format(t[0].oDate)+" - "+n.format(t[1].oDate)}}e.suggestText=e.languageText};C.prototype.isValidCondition=function(){var e=this.getCondition(),t=this.getOperation(e.operation);if(t&&e&&e.key&&e.operation){if("value1"in t&&"value2"in t){return"value1"in e&&e.value1!==null&&"value2"in e&&e.value2!==null}else if("value1"in t){return"value1"in e&&e.value1!==null}else if("value2"in t){return"value2"in e&&e.value2!==null}else if(!("value1"in t)&&!("value2"in t)){return true}}return false};C.prototype.hasSemanticDate=function(e){var t=this.getOperations();if(e.ranges[0].semantic&&e.ranges[0].semantic.operation){var a=0;for(a=0;a<t.length;a++){if(t[a].key.indexOf(e.ranges[0].semantic.operation)!==-1){return true}}return false}};C.prototype.hasCustomSemanticDate=function(e){return e.ranges[0]&&e.ranges[0].semantic&&e.ranges[0].semantic.operation&&e.ranges[0].semantic.operation!==this.getDefaultOperation().key};C.prototype.providerDataUpdated=function(e,t){};C.prototype.initialize=function(e){if(!e){e={}}a.prototype.initialize.apply(this,[e]);this.oModel.suspend();var n=Object.assign({},e,true),i,r;this.oLastJson=n;var o=(new g).getCalendarType();if(!e.conditionTypeInfo){if(e.ranges&&e.ranges.length==1){var l;if(this.hasSemanticDate(e)&&!this._bSingleFilterRestriction){l=e.ranges[0].semantic.operation;if(e.ranges[0].semantic.value1||e.ranges[0].semantic.value1==0){i=e.ranges[0].semantic.value1}if(e.ranges[0].semantic.value2||e.ranges[0].semantic.value2==0){r=e.ranges[0].semantic.value2}if(this.getDefaultOperation().key===l){var s=this.getOperation(l),u=s&&s._getInitialValues?s._getInitialValues(e):null;if(!u){u=this.getDefaultValues(s)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==e.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==e.ranges[0].value2){l="DATERANGE"}}}else if(this.hasSemanticDate(e)&&this._bSingleFilterRestriction){l=e.ranges[0].semantic.operation;if(e.ranges[0].semantic.value1||e.ranges[0].semantic.value1==0){i=e.ranges[0].semantic.value1}e.ranges[0].value2=null;if(e.ranges[0].semantic.value2||e.ranges[0].semantic.value2==0){r=null}if(this.getDefaultOperation().key===l){var s=this.getOperation(l),u=s&&s._getInitialValues?s._getInitialValues(e):null;if(!u){u=this.getDefaultValues(s)}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()!==e.ranges[0].value1||u[1]&&u[1].oDate&&u[1].oDate.toISOString()!==e.ranges[0].value2){l="DATE"}if(u[0]&&u[0].oDate&&u[0].oDate.toISOString()===i){i=e.ranges[0].value1?e.ranges[0].value1:e.ranges[0].semantic.value1}}}else if(this.hasCustomSemanticDate(e)){this._customSemanticOperation=e.ranges[0].semantic.operation;if(this._bSingleFilterRestriction){l="DATE"}else{l="DATERANGE"}}else if(this._bSingleFilterRestriction){l="DATE"}else{l="DATERANGE"}if(e.ranges[0].operation==="GE"){l="FROM"}if(e.ranges[0].operation==="LE"){l="TO"}e.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:l,value1:i||i==0?i:e.ranges[0].value1,value2:r||r==0?r:e.ranges[0].value2,calendarType:o}}}else{var s=this.getDefaultOperation(),p=s?s.key:"";if(e.value1){var f=e.value1}if(e.value2){var T=e.value2}e.conditionTypeInfo={name:this.getName(),data:{key:this.sFieldName,operation:p,calendarType:o}};if(f){e.conditionTypeInfo.data.value1=f}if(T){e.conditionTypeInfo.data.value2=T}else if(e.conditionTypeInfo.data.operation==="DATERANGE"){e.conditionTypeInfo.data.operation="DATE"}}}if(e.conditionTypeInfo){e=e.conditionTypeInfo}if(e.name&&e.data){if(e.name!==this.getName()){d.debug("ConditionType "+this.getName()+" tries to deserialize data from "+e.name)}e=e.data}if(!e.operation){return}if(this.getOperation(e.operation)&&this.getOperation(e.operation).order<0){var c=["LAST2WEEKS","LAST3WEEKS","LAST4WEEKS","LAST5WEEKS"].indexOf(e.operation);if(c>=0){e.operation="LASTWEEKS";e.value1=c+2}c=["NEXT2WEEKS","NEXT3WEEKS","NEXT4WEEKS","NEXT5WEEKS"].indexOf(e.operation);if(c>=0){e.operation="NEXTWEEKS";e.value1=c+2}}var E=this.getOperation(e.operation);if(!E){if(this.getAsync()){this.setPending(true);var D=this,y=function(e){if(e.getParameter("pending")===false){D.oFilterProvider.detachPendingChange(y);D.initialize(D.oLastJson)}};this.oFilterProvider.attachPendingChange(y);this.oModel.resume();return}}var I;if(o!==e.calendarType&&(e.calendarType==="Islamic"||o==="Islamic")&&e.operation==="SPECIFICMONTH"){e.operation="DATERANGE";var h=parseInt(e.value1),N=g.getInstance(t.getInstance(),e.calendarType);N.setMonth(h);N=v.getMonthStartDate(N);I=v.getRange(0,"MONTH",N);e.value1=I[0].oDate.toISOString();e.value2=I[1].oDate.toISOString()}var A=this.getConditionContext().getObject();if(!e.value2&&e.operation==="DATERANGE"){e.operation="DATE"}A.operation=e.operation;A.key=e.key;A.value1=null;A.value2=null;var m,S=this.oFieldMetadata&&this.oFieldMetadata.ui5Type;if(S&&S.isA(R.getMetadata().getName())){m=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));S=m}if(e.operation==="DATERANGE"){if(typeof e.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){e.value1=S.formatValue(e.value1)}else{e.value1=e.value1===""?null:new g(e.value1).oDate}}if(typeof e.value2==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){e.value2=S.formatValue(e.value2)}else{e.value2=e.value2===""?null:new g(e.value2).oDate}}A.value1=e.value1;A.value2=e.value2}else if(["DATE","FROM","TO"].indexOf(e.operation)!==-1){if(typeof e.value1==="string"){if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"){e.value1=S.formatValue(e.value1)}else{e.value1=e.value1===""?null:new g(e.value1).oDate}}A.value1=e.value1}else if(["DATETIME","DATETIMERANGE"].indexOf(e.operation)!==-1){if(typeof e.value1==="string"){e.value1=e.value1===""?null:new g(e.value1).oDate}A.value1=e.value1;if(typeof e.value2==="string"){e.value2=e.value2===""?null:new g(e.value2).oDate}A.value2=e.value2}else if(["LASTMINUTES","LASTHOURS","LASTDAYS","LASTWEEKS","LASTMONTHS","LASTQUARTERS","LASTYEARS","NEXTMINUTES","NEXTHOURS","NEXTDAYS","NEXTWEEKS","NEXTMONTHS","NEXTQUARTERS","NEXTYEARS"].indexOf(e.operation)>-1){A.value1=e.value1}else if(e.operation==="SPECIFICMONTH"){A.value1=e.value1+""}else if(e.operation==="TODAYFROMTO"){A.value1=e.value1;A.value2=e.value2}else{E=this.getOperation(e.operation);I=E&&E._getInitialValues?E._getInitialValues(e):null;if(!I){I=this._getValuesFromCurrentOperation(e)}if(!I){I=this.getDefaultValues(E)}A.value1=I[0];A.value2=I[1]}this.bIgnoreBindingChange=true;this.oModel.resume();delete this.bIgnoreBindingChange;this.serialize(true,false);this._setDDROperation.call(this,e);if(m){m.destroy()}};C.prototype._getValuesFromCurrentOperation=function(e){var t=[];if(Number.isInteger(e.value1)){t.push(e.value1)}if(Number.isInteger(e.value2)){t.push(e.value2)}if(t.length>0){return t}return null};C.prototype.serialize=function(e,t){var a={},n=this.getCondition();if(!n.operation){return null}var i=this.getOperation(n.operation);if(!i||!("value1"in i)){n.value1=null}if(!i||!("value2"in i)){n.value2=null}n.calendarType=(new g).getCalendarType();a.conditionTypeInfo={name:this.getName(),data:n};if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}if(e){this._updateProvider(a,true,t)}else{this.iChangeTimer=setTimeout(this._updateProvider.bind(this,a,false,t),0)}return a};C.prototype.updateFilters=function(){if(!this._bDTOffset||!this.oConditionContext?.oModel?.oData?.condition?.value1){return}var e={},t=this.getCondition();if(!t.operation){return}var a=this.getOperation(t.operation);if(!a||!("value1"in a)){t.value1=null}if(!a||!("value2"in a)){t.value2=null}t.calendarType=(new g).getCalendarType();e.conditionTypeInfo={name:this.getName(),data:t};e.ranges=this.getFilterRanges();e.items=[];this.oFilterProvider?.oModel?.setProperty("/"+this.sFieldName,e)};C.prototype._updateProvider=function(e,t,a){e.ranges=this.getFilterRanges();e.items=[];var n=false;var i=0;var r=0;var o=0;var l=this.oModel.getData(),s=l.currentoperation;if(e&&s){this._clearModelInputState(e,s)}if(this.oFieldMetadata&&this.oFieldMetadata.type==="Edm.String"&&e.ranges[0]){var u,p=this.oFieldMetadata.ui5Type;if(p.isA(R.getMetadata().getName())){u=this.oFilterProvider._getType(Object.assign({},this.oFieldMetadata,{isCalendarDate:true,ui5Type:null}));p=u}if(!s.type||!s.type.includes("int")){e.conditionTypeInfo.data.value1=p.parseValue(e.conditionTypeInfo.data.value1);e.conditionTypeInfo.data.value2=p.parseValue(e.conditionTypeInfo.data.value2)}e.ranges[0].value1=p.parseValue(e.ranges[0].value1);if(e.ranges[0].value2){e.ranges[0].value2=p.parseValue(e.ranges[0].value2)}if(u){u.destroy()}}if(s&&s.languageText){var g=s.languageText;if(this._isIntIntInterval(s)){if(e.conditionTypeInfo.data.value1!=null&&e.conditionTypeInfo.data.value1!==""&&e.conditionTypeInfo.data.value2!=null&&e.conditionTypeInfo.data.value2!==""){g=this._formatIntIntInterval(s,e)}}else if(this._isIntInterval(s)){if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){g=this._formatIntInterval(s,e)}else if(this._bSuggestItemSelected){g=this._fillNumberToText(s.basicLanguageText);var f=s.basicLanguageText.indexOf("{0}");i=f+1;r=f;o=f+1;n=true}else{g=""}}else if(this._isFixedRange(s)){g=this._formatFixedRange(s,s.textValue)}else{if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var T=this._calculateDateRangeValueText(s,e);var d=T.value;n=T.bSetCursor;if(d){g=this._formatFixedRange(s,d);i=g.length-1}else{g=""}}else{g=""}}this._bSuggestItemSelected=false;this.oModel.setProperty("/formattedText",g);if(n&&this._oInput){this._oInput.$("inner").cursorPos(i);if(r<o){this._oInput.selectText(r,o)}this._oInput._lastValue=""}}if(this.oFilterProvider&&this.oFilterProvider.oModel){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,e);this.oFilterProvider.setFilterData({},false,this.sFieldName,true);if(a&&this.oFilterProvider._oSmartFilter){this.oFilterProvider._oSmartFilter.fireFilterChange()}}};C.prototype.getFilterRanges=function(){var e,a=this.getCondition(),n=[],i;if(this._bSingleFilterRestriction){if(a.operation!=="NODATE"){a.operation="EQ"}delete a.value2}else if(a.operation==="LASTMINUTES"){if(!isNaN(a.value1)){n=v.ranges.lastMinutes(a.value1)}n[0]?.setMilliseconds(0);n[0]?.setSeconds(0);a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTMINUTESINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastMinutes(a.value1-1)}n[0]?.setMilliseconds(0);n[0]?.setSeconds(0);n[1]?.setSeconds(59);a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTHOURS"){if(!isNaN(a.value1)){n=v.ranges.lastHours(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTHOURSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastHours(a.value1-1)}n[0]?.setMinutes(0);n[0]?.setMilliseconds(0);n[0]?.setSeconds(0);a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTDAYS"){if(!isNaN(a.value1)){n=v.ranges.lastDays(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTDAYSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastDays(a.value1-1)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="LASTWEEKS"){if(!isNaN(a.value1)){n=v.ranges.lastWeeks(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTWEEKSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastWeeks(a.value1-1,this.sCalendarWeekNumbering)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="LASTMONTHS"){if(!isNaN(a.value1)){n=v.ranges.lastMonths(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTMONTHSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastMonths(a.value1-1)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="LASTQUARTERS"){if(!isNaN(a.value1)){n=v.ranges.lastQuarters(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTQUARTERSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastQuarters(a.value1-1)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="LASTYEARS"){if(!isNaN(a.value1)){n=v.ranges.lastYears(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="LASTYEARSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.lastYears(a.value1-1)}a.value1=n[0];a.value2=g.getInstance(t.getInstance())}else if(a.operation==="NEXTMINUTES"){if(!isNaN(a.value1)){n=v.ranges.nextMinutes(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTMINUTESINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextMinutes(a.value1-1)}n[0]?.setMilliseconds(0);n[0]?.setSeconds(0);n[1]?.setSeconds(59);a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTHOURS"){if(!isNaN(a.value1)){n=v.ranges.nextHours(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTHOURSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextHours(a.value1-1)}n[1]?.setMinutes(59,59);a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTDAYS"){if(!isNaN(a.value1)){n=v.ranges.nextDays(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTDAYSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextDays(a.value1-1)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="NEXTWEEKS"){if(!isNaN(a.value1)){n=v.ranges.nextWeeks(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTWEEKSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextWeeks(a.value1-1,this.sCalendarWeekNumbering)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="NEXTMONTHS"){if(!isNaN(a.value1)){n=v.ranges.nextMonths(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTMONTHSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextMonths(a.value1-1)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="NEXTQUARTERS"){if(!isNaN(a.value1)){n=v.ranges.nextQuarters(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTQUARTERSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextQuarters(a.value1-1)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="NEXTYEARS"){if(!isNaN(a.value1)){n=v.ranges.nextYears(a.value1)}a.value1=n[0];a.value2=n[1]}else if(a.operation==="NEXTYEARSINCLUDED"){if(!isNaN(a.value1)){n=v.ranges.nextYears(a.value1-1)}a.value1=g.getInstance(t.getInstance());a.value2=n[1]}else if(a.operation==="SPECIFICMONTH"){var r=parseInt(a.value1),o=new g;if(Number.isFinite(r)){o.setDate(1);o.setMonth(r);o=v.getMonthStartDate(o);n=v.getRange(0,"MONTH",o);a.value1=n[0];a.value2=n[1]}}else if(a.operation==="TODAYFROMTO"){if(!isNaN(parseInt(a.value1))){a.value1=this._getTodayFromToValueFrom(a.value1)}if(!isNaN(parseInt(a.value2))){a.value2=this._getTodayFromToValueTo(a.value2)}}else{var l=this.getOperation(a.operation);if(l&&l.getDateRange){i=l.getDateRange(a);if(!i){return[]}a.value1=i&&i.value1?i.value1:null;a.value2=i&&i.value2?i.value2:null}}if(a.value1 instanceof g){a.value1=a.value1.oDate}if(a.value2 instanceof g){a.value2=a.value2.oDate}if(a.operation==="DATE"){if(!(this.isValidCondition()&&a.value1)){return[]}a.operation="BT";a.value2=a.value1;a.value1=C.setStartTime(a.value1).oDate;a.value2=C.setEndTime(a.value2,this._bIgnoreTime,this._Precision).oDate}else if(a.operation==="FROM"){if(!(this.isValidCondition()&&a.value1)){return[]}a.operation="GE";delete a.value2;a.value1=C.setStartTime(a.value1,this._bIgnoreTime).oDate}else if(a.operation==="TO"){if(!(this.isValidCondition()&&a.value1)){return[]}a.operation="LE";delete a.value2;a.value1=C.setEndTime(a.value1,this._bIgnoreTime).oDate}else if(this._bSingleFilterRestriction){if(a.operation==="NODATE"){a.operation="EQ";a.value1=null}else if(!(this.isValidCondition()&&a.value1)){return[]}}else if(a.operation==="DATETIME"){if(!(this.isValidCondition()&&a.value1)){return[]}a.operation="BT";a.value2=a.value2?C.setMilliseconds(a.value2):null}else if(a.operation==="DATETIMERANGE"||a.operation==="LASTMINUTES"||a.operation==="LASTHOURS"||a.operation==="NEXTHOURS"||a.operation==="NEXTMINUTES"||a.operation==="LASTMINUTESINCLUDED"||a.operation==="LASTHOURSINCLUDED"||a.operation==="NEXTMINUTESINCLUDED"||a.operation==="NEXTHOURSINCLUDED"){if(!(this.isValidCondition()&&a.value1&&a.value2)){return[]}a.operation="BT"}else if(a.operation==="NODATE"){a.operation="EQ";a.value1=null}else{if(i){a.operation=i.operation;a.value1=a.value1?C.setStartTime(a.value1).oDate:null;a.value2=a.value2?C.setEndTime(a.value2,this._bIgnoreTime).oDate:null}else{if(!(this.isValidCondition()&&a.value1&&a.value2)){return[]}if(!this._bDTOffset||this._bDTOffset&&a.operation.indexOf("INCLUDED")===-1&&a.operation.indexOf("NEXT")===-1){a.value1=C.setStartTime(a.value1).oDate}a.operation="BT";a.value2=C.setEndTime(a.value2,this._bIgnoreTime).oDate}}a.exclude=false;a.keyField=a.key;delete a.key;if(a.value2){if(typeof a.value1.getTime==="function"&&typeof a.value2.getTime==="function"&&a.value1.getTime()>a.value2.getTime()){e=a.value2;a.value2=a.value1;a.value1=e}}return[a]};C.prototype.getTokenText=function(){return""};C.prototype.getName=function(){return this.getMetadata().getName()};C.prototype.getType=function(){return"Edm.Date"};C.prototype._bindValueState=function(e){e.bindProperty("valueState",{path:"$smartEntityFilter>inputstate",formatter:function(){if(this.getBinding("valueState").getValue()==="ERROR"){return _.Error}else{return _.None}}})};C.prototype.initializeFilterItem=function(){return this._initializeFilterItemNew.apply(this,arguments)};C.prototype._getDateFormatter=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:e};if(JSON.stringify(t)!==this._sFormatSettings){this._sFormatSettings=JSON.stringify(t);this._oDateFormatter=f.getInstance(t)}return this._oDateFormatter};C.prototype._fillNumberToText=function(e,t,a){var n="X",i="Y";if(t||t===0){n=String(t)}if(a||a===0){i=String(a);if(t<0){n="("+n+")"}if(a<0){i="("+i+")"}}e=e.replace("{0}",n);e=e.replace("{1}",i);return e};C.prototype._setIntControlBinding=function(e,t,n){e.setFieldWidth("auto");e.bindProperty("description",{path:"$smartEntityFilter>"+n,type:new O,formatter:function(){var e=t.descriptionTextKeys[0];var n=t.descriptionTextKeys[1];if(this.getBinding("description").getValue()===1){return a.getTranslatedText(e)}else{return a.getTranslatedText(n||e)}}})};C.prototype._createIntFromToControl=function(e,t,n){return new l(a._createStableId(e,t),{value:{path:"$smartEntityFilter>"+n,type:new T({},{minimum:-e._maxIntValue,maximum:e._maxIntValue})},textAlign:"End",width:"100%"})};C.prototype._isValidFromToPeriod=function(e,t){if(!e&&e!==0||isNaN(e)){return false}if(!t&&t!==0||isNaN(t)){return false}if(e<-this._maxIntValue||e>this._maxIntValue){return false}if(t<-this._maxIntValue||t>this._maxIntValue){return false}if(e<0&&Math.abs(e)>Math.abs(t)||e===0&&t<0||t<0&&Math.abs(t)>Math.abs(e)||t===0&&e<0||e<0&&t<0){return false}return true};C.prototype._getTodayFromToValueFrom=function(e){if(e<0){var t=v.getRange(-1*e,"DAY")[1];t.setHours(0,0,0);return t}return v.getRange(-e,"DAY")[0]};C.prototype._getTodayFromToValueTo=function(e){if(e<0){var t=v.getRange(e,"DAY")[0];t.setHours(23,59,59);return t}return v.getRange(e,"DAY")[1]};C.prototype._getInputValueState=function(){if(this._oInput){return this._oInput.getValueState()}};C.prototype.destroy=function(){if(this.iChangeTimer){clearTimeout(this.iChangeTimer);delete this.iChangeTimer}a.prototype.destroy.apply(this,arguments)};C.prototype._initializeFilterItemNew=function(e){var t={style:this.oDateFormat.style,pattern:this.oDateFormat.pattern,strictParsing:false};this.sCalendarWeekNumbering=this.oFilterProvider&&this.oFilterProvider._oCalendarWeekSettings?this.oFilterProvider._oCalendarWeekSettings:undefined;this._oInput=new c(a._createStableId(this),{name:this.sFieldName,formatter:D.getInstance({date:t}),enableGroupHeaders:!this._bSingleFilterRestriction,calendarWeekNumbering:this.sCalendarWeekNumbering,standardOptions:{path:"$smartEntityFilter>/operations",formatter:function(e){return e.reduce(function(e,t){if(F.includes(t.key)){e.push(t.key)}return e},[])}},change:this._onDDRChange.bind(this)});if(this.oFieldMetadata&&this.oFieldMetadata["com.sap.vocabularies.Common.v1.DocumentationRef"]){this.oFilterProvider._setControlDocumentationRef(this._oInput,this.oFieldMetadata["com.sap.vocabularies.Common.v1.DocumentationRef"])}this._createCustomDDOptions(this.getOperations());if(e!=="mdcFilterPanel"){this._oInput.setValue(this._getDefaultValueDDR())}this._bindValueState(this._oInput);this._oInput.setBindingContext(this.getContext(),"$smartEntityFilter");this._oInput.setModel(this.getModel(),"$smartEntityFilter");this.bFireFilterChange=false;this.getModel().checkUpdate(true);this.bFireFilterChange=true;return this._oInput};C.prototype.updateOperations=function(){var e=this.getOperations();for(var t=0;t<e.length;t++){this._updateOperation(e[t])}this._createCustomDDOptions(e);this.oModel.setProperty("operations",e,this.getContext(),true);if(this._customSemanticOperation){var a=e.find(function(e){return e.key===this._customSemanticOperation}.bind(this));if(a){this.setOperation(this._customSemanticOperation);this._customSemanticOperation=null}}return};C.prototype.setCondition=function(e){a.prototype.setCondition.apply(this,arguments);this._setDDROperation.call(this,e);return this};C.prototype._onDDRChange=function(e){var t,a,n=e.getParameter("value"),i=e.getParameter("valid");if(this.oModel.bSuspended){this.oModel.resume()}if(i&&n){var r=this._getOptionName(n.operator);t=this.getOperation(r);a=this._prepareDDRValues(t,n,r);this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation",r);this.oModel.setProperty("/condition/value1",a[0]);this.oModel.setProperty("/condition/value2",a[1])}else if(i){t=this.getOperation("DATERANGE");this.oModel.setProperty("/currentoperation",t);this.oModel.setProperty("/condition/operation","DATERANGE");this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}e.getSource().setValueStateText("");this.oModel.setProperty("inputstate",i?"NONE":"ERROR",this.getContext())};C.prototype._getDefaultValueDDR=function(){var e=this.getDefaultOperation(),t=e&&e.key;if(!this._getDDROption(t)){return null}var a=typeof e.defaultValues==="function"?e.defaultValues():e.defaultValues;if(!F.includes(t)){t=this._getCustomDDOptionName(t)}if(Array.isArray(a)&&a.length>0&&a[0]!==null){return{operator:t,values:a}}return null};C.prototype._getDDROption=function(e){if(!this._oInput){return null}if(F.includes(e)){return this._oInput.getOption(e)}if(e==="NODATE"){return this._oInput.getOption(e)}return this._oInput.getOption(this._getCustomDDOptionName(e))};C.prototype._getCustomDDOptionName=function(e){return this.sFieldName+"__custom__"+e};C.prototype._getOptionName=function(e){var t=e.split("__custom__");if(t.length>1){return t[1]}return t[0]};C.prototype._createCustomDDOptions=function(e){if(!this._oInput){return}var t=this._oInput.getValue();this._oInput.destroyAggregation("customOptions");e.forEach(this._createCustomDDOption,this);if(t&&!this._getDDROption(this._getOptionName(t.operator))){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null)}};C.prototype._createCustomDDOption=function(t){if(F.includes(t.key)){return}var a;var n=typeof t.category==="object"?t.category.key:t.category;if(n.toLowerCase().startsWith("fixed")||t.type==="range"){a=this._createCustomFixedDDOption(t)}else if(t.type==="nodate"){a=this._createNoDateDDOption(t)}else{a=this._createCustomDynamicDDOption(t)}a.getGroupHeader=function(){if(typeof t.category==="object"){var a=t.category.bundle;var n=t.category.key;if(e.getResourceBundleFor(a).hasText(n)){return e.getResourceBundleFor(a).getText(n)}}if(e.getResourceBundleFor("sap.ui.comp").hasText(t.category)){return e.getResourceBundleFor("sap.ui.comp").getText(t.category)}if(e.getResourceBundleFor("sap.m").hasText(t.category)){return e.getResourceBundleFor("sap.m").getText(t.category)}return e.getResourceBundleFor("sap.m").getText("DDR_OPTIONS_GROUP_0")};a.getGroup=function(){return t.order};this._oInput.addAggregation("customOptions",a)};C.prototype._createNoDateDDOption=function(e){const t=e.key,n=y.extend(t,{metadata:{library:"sap.ui.comp"},getText:function(){return a.getTranslatedText(e.textKey)},getValueHelpUITypes:function(){return[]},format:function(){return a.getTranslatedText("DATERANGETYPE_NODATE_TEXT")},toDates:function(){return[]},parse:function(t){if(t===a.getTranslatedText("DATERANGETYPE_NODATE_TEXT")||t===a.getTranslatedText("DATERANGETYPE_NODATE")){return e}return null}});return new n({key:t})};C.prototype._createCustomFixedDDOption=function(e){var t=this._getCustomDDOptionName(e.key);var n=this;var i=y.extend(t,{metadata:{library:"sap.ui.comp"},getText:function(){return e.languageText||a.getTranslatedText(e.textKey)},getValueHelpUITypes:function(){return[]},enhanceFormattedValue:function(){if(!n.getOperation(n._getOptionName(e.key))){return false}var t=typeof e.category==="object"?e.category.key:e.category;if(t.toUpperCase().startsWith("FIXED.")&&e.type==="int"){return false}return true},format:this._customDDOptionFormatter.bind(this),toDates:function(t){var a=e.defaultValues;if(typeof a==="function"){a=a()}if(t&&a.length>0&&!(a[0]instanceof Date)){var i=n.oModel.getProperty("",n.oConditionContext),r=i.operation,o=a[0],l=a[1];i.operation=n._getOptionName(t.operator);i.value1=!isNaN(a[0])?parseInt(a[0]):a[0];i.value2=!isNaN(a[1])?parseInt(a[1]):a[1];var s=n.getFilterRanges();i.operation=r;i.value1=o;i.value2=l;if(s.length===0){return[]}return[s[0].value1]}return a},parse:function(t){var n=e.basicLanguageText||e.languageText||a.getTranslatedText(e.textKey);if(t&&n&&n.toLowerCase().startsWith(t.toLowerCase())){return{operator:this.getKey(),values:this.toDates()}}return null}});return new i({key:t})};C.prototype._createCustomDynamicDDOption=function(e){var t=this._getCustomDDOptionName(e.key);var n=this;var i=y.extend(t,{metadata:{library:"sap.ui.comp"},getText:function(){var t=e.languageText||a.getTranslatedText(e.textKey);if(t.indexOf("{0}")>=0){return n._fillNumberToText(t)}return t},getValueHelpUITypes:function(){if(e.type==="int"){return[new I({type:"int"})]}else if(e.type==="[int,int]"){return[new I({type:"int"}),new I({type:"int"})]}},createValueHelpUI:function(t,a){t.aControlsByParameters={};t.aControlsByParameters[this.getKey()]=[];n.setControls([]);var i=n.getControls(e),r=e.defaultValues.length,o=e.defaultValues;if(typeof o==="function"){o=o()}i.forEach(function(e){if(!e.getValue()&&o&&o[0]){if(typeof o==="function"){o=o()}e.setValue(o[0]);o.shift();n.oModel.suspend();n.oModel.setProperty("/condition/value"+(r-o.length),e.getValue())}if(typeof a==="function"){e.attachChange(function(){a(this)},this)}t.aControlsByParameters[this.getKey()].push(e)},this);n.setControls(i);return i},format:this._customDDOptionFormatter.bind(this),toDates:function(e){var t=n.oModel.getProperty("",n.oConditionContext),a=t.operation,i=t.value1,r=t.value2;t.operation=n._getOptionName(e.operator);t.value1=!isNaN(e.values[0])?parseInt(e.values[0]):e.values[0];t.value2=!isNaN(e.values[1])?parseInt(e.values[1]):e.values[1];var o=n.getFilterRanges();t.operation=a;t.value1=i;t.value2=r;if(o.length===0){return[]}return[o[0].value1,o[0].value2]},parse:function(t){var a=new u({key:e.key}),i=e.filterSuggestItem.call(e,t,a,n);if(i){return{operator:this.getKey(),values:[a._value1,a._value2||null]}}return null},validateValueHelpUI:function(e){var t=function(e){var t=e.getValue(),a=this._maxIntValue,n=-this._maxIntValue;if(!t&&t!==0||isNaN(t)){return false}if(r&&r.getBindingInfo("value")&&r.getBindingInfo("value").type&&r.getBindingInfo("value").type.oConstraints){if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("minimum")){n=r.getBindingInfo("value").type.oConstraints.minimum}if(r.getBindingInfo("value").type.oConstraints.hasOwnProperty("maximum")){a=r.getBindingInfo("value").type.oConstraints.maximum}}if(t<n||t>a){return false}return true};var a=this.getValueHelpUITypes();for(var i=0;i<a.length;i++){var r=e.aControlsByParameters[this.getKey()][i];switch(a[i].getType()){case"int":return t.call(n,r);case"month":case"date":case"daterange":if(!r.getSelectedDates()||r.getSelectedDates().length==0){return false}break;case"options":if(r.getSelectedIndex()<0){return false}break}}return true}});return new i({key:t})};C.prototype._customDDOptionFormatter=function(e){var t=this._getOptionName(e.operator),a=this.getOperation(t);if(!a){this._oInput.setValue(null);this._oInput._oInput.setValue(null);this.oModel.setProperty("/currentoperation",null);this.oModel.setProperty("/condition/value1",null);this.oModel.setProperty("/condition/value2",null);return""}var n=this._prepareDDRValues(a,e,t);var i={conditionTypeInfo:{data:{value1:n[0],value2:n[1]}}};if(a.languageText){var r=a.languageText;if(this._isIntIntInterval(a)){if(i.conditionTypeInfo.data.value1!=null&&i.conditionTypeInfo.data.value1!==""&&i.conditionTypeInfo.data.value2!=null&&i.conditionTypeInfo.data.value2!==""){r=this._formatIntIntInterval(a,i)}}else if(this._isIntInterval(a)){if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){r=this._formatIntInterval(a,i)}else{r=""}}else if(this._isFixedRange(a)){r=this._formatFixedRange(a,a.textValue)}else{if(i.conditionTypeInfo.data.value1!==null&&i.conditionTypeInfo.data.value1!==""){var o=this._calculateDateRangeValueText(a,i);var l=o.value;if(l){r=this._formatFixedRange(a,l)}else{r=""}}else{r=""}}}return r};C.prototype._isIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0};C.prototype._formatIntInterval=function(e,t){if(t.conditionTypeInfo.data.value1===0&&e.zeroNumberTextKey){return e.zeroNumberLanguageText}if(t.conditionTypeInfo.data.value1===1&&e.singulareBasicLanguageText){return e.singulareBasicLanguageText}return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1)};C.prototype._isIntIntInterval=function(e){return e.basicLanguageText.indexOf("{0}")>=0&&e.basicLanguageText.indexOf("{1}")>=0};C.prototype._formatIntIntInterval=function(e,t){return this._fillNumberToText(e.basicLanguageText,t.conditionTypeInfo.data.value1,t.conditionTypeInfo.data.value2)};C.prototype._isFixedRange=function(e){return e.textValue};C.prototype._formatFixedRange=function(e,t){return e.languageText};C.prototype._calculateDateRangeValueText=function(e,t){var a=t.conditionTypeInfo.data.value1;var n=t.conditionTypeInfo.data.value2;var i;var r=false;if((typeof a==="number"||typeof a==="string"&&!isNaN(parseInt(a)))&&e.valueList){i=e.valueList[a].text}else if(a instanceof Date){var o=this._getDateFormatter(false);if(t.conditionTypeInfo.data.operation!=="DATERANGE"&&(a&&!n)){i=o.format(a)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&n){i=o.format(a)+" - "+o.format(n)}else if(t.conditionTypeInfo.data.operation==="DATERANGE"&&a&&!n){i=o.format(a)+" - ";r=true}else{i=""}}else{i=t.conditionTypeInfo.data.value1}return{value:i,bSetCursor:r}};C.prototype._convertUniversalDateToDate=function(e){return e.map(function(e){if(e.getJSDate){return e.getJSDate()}return e})};C.prototype._clearModelInputState=function(e,t){if(t.type==="[int,int]"&&this._isValidFromToPeriod(e.conditionTypeInfo.data.value1,e.conditionTypeInfo.data.value2)){this.oModel.setProperty("inputstate","NONE",this.getContext())}else if(t.type==="int"&&e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){this.oModel.setProperty("inputstate","NONE",this.getContext())}else if(this._isFixedRange(t)){this.oModel.setProperty("inputstate","NONE",this.getContext())}else if(e.conditionTypeInfo.data.value1!==null&&e.conditionTypeInfo.data.value1!==""){var a=this._calculateDateRangeValueText(t,e);if(a.value){this.oModel.setProperty("inputstate","NONE",this.getContext())}}};C.prototype._prepareDDRValues=function(e,t,a){if(a==="SPECIFICMONTH"){return[].concat(t.values)}if(a==="NODATE"){return[0]}var n=typeof e.category==="object"?e.category.key:e.category;if(e.type==="int"&&!n.toUpperCase().startsWith("FIXED.")){return[parseInt(t.values[0]),null]}if(e.type==="[int,int]"){return[parseInt(t.values[0]),parseInt(t.values[1])]}var i=this._oInput.toDates(t);if(this._bDTOffset&&(a==="DATETIME"||a==="DATETIMERANGE")){if(i[0]){i[0]=N.localToUiTimezone(i[0].oDate)}if(i[1]){i[1]=N.localToUiTimezone(i[1].oDate);i[1]=C.setMilliseconds(i[1])}}return this._convertUniversalDateToDate(i)};C.prototype._setDDROperation=function(e){if(this._oInput&&e.key&&e.operation){var t=[];if(e.value1||e.value1===0){t[0]=e.value1;if(e.value2||e.value2===0){t[1]=e.value2}}var a=this._getDDROption(e.operation),n=this.getOperation(e.operation),i=function(e,t){if(!e){return false}if(e.hasOwnProperty("value1")&&!t[0]&&t[0]!==0){return false}if(e.hasOwnProperty("value2")&&!t[1]&&t[1]!==0){return false}return true};if(this._bDTOffset&&(a.getKey()==="DATETIME"||a.getKey()==="DATETIMERANGE")){if(t[0]){t[0]=N.uiTimezoneToLocal(t[0])}if(t[1]){t[1]=N.uiTimezoneToLocal(t[1]);t[1]=C.setMilliseconds(t[1])}}if(i(n,t)){this._oInput.setValue({key:e.key,operator:a.getKey(),values:t})}else{this._oInput.setValue(null);this._oInput._oInput.setValue(null)}}};return C});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/condition/NullableInteger", ["sap/ui/model/type/Integer"],function(e){"use strict";var t=e.extend("sap.ui.model.type.NullableInteger",{parseValue:function(t,i){if(this.getPrimitiveType(i)=="string"){if(t===""){return null}}return e.prototype.parseValue.apply(this,arguments)}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/config/condition/Type", ["sap/ui/core/date/UI5Date","sap/ui/base/EventProvider","sap/ui/model/json/JSONModel","sap/ui/core/date/UniversalDate","sap/ui/core/Core","sap/ui/core/Lib"],function(t,e,o,i,n,r){"use strict";var a=e.extend("sap.ui.comp.config.condition.Type",{constructor:function(t,i,n){e.call(this);this.oFilterProvider=i;var r={condition:{operation:"",value1:null,value2:null,key:t},operations:[],controls:[],currentoperation:{},pending:false};this.oModel=new o(r);var a=this.oModel.checkUpdate;this.oModel.suspend=function(){this.bSuspended=true;this.checkUpdate=function(){}};this.oModel.resume=function(){this.bSuspended=false;this.checkUpdate=a;this.checkUpdate()};this.oContext=this.oModel.getContext("/");this.oConditionContext=this.oModel.getContext("/condition");this.sFieldName=t;var s=this.oModel.bindProperty("operation",this.oConditionContext),l=this;s.attachChange(function(){var t=l.oModel.getProperty("operation",l.getConditionContext()),e=l.getOperation(t);if(e){e=Object.assign({},e);if(!l.bIgnoreBindingChange){var o=l.getDefaultValues(e);if(l._bSingleFilterRestriction&&o[0]){l.setDefaultValues(o[0].oDate,o[1])}else{l.setDefaultValues(o[0],o[1])}}}l.setControls([]);l.setControls(l.getControls(e));if(e){if(e.getValueList){e.valueList=e.getValueList()}l.oModel.setProperty("/currentoperation",e)}if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var u=this.oModel.bindProperty("value1",this.oConditionContext);u.attachChange(function(){if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var p=this.oModel.bindProperty("value2",this.oConditionContext);p.attachChange(function(){if(!l.bIgnoreBindingChange){l.serialize(false,l.bFireFilterChange)}});var d=this.oModel.bindProperty("pending",this.oContext);d.attachChange(function(){if(l.bAsync){if(l._iPendingTimer){clearTimeout(l._iPendingTimer)}l._iPendingTimer=setTimeout(l["fireEvent"].bind(l,"PendingChange",{oSource:l,pending:l.oModel.getProperty("/pending")}),10)}});this.oFieldMetadata=n;this.oOperationFilter=null;this.bAsync=false}});a._createStableId=function(t,e){if(t&&t.oFilterProvider&&t.oFieldMetadata){return t.oFilterProvider._createFilterControlId(t.oFieldMetadata)+(e?e:"")}else{return undefined}};a.getTranslatedText=function(t,e,o){if(typeof t==="object"){e=t.bundle;t=t.key}if(!e){e="sap.ui.comp"}return r.getResourceBundleFor(e).getText(t,o)||t};a.prototype.getTranslatedText=a.getTranslatedText;a.prototype.applySettings=function(e){if(e&&e.defaultOperation){this._sSettingsDefaultOperation=e.defaultOperation;if(e.values){this._defaultDate=e.values}}if(e&&e.defaultDate&&!e.defaultOperation){var o=t.getInstance(e.defaultDate);if(o instanceof Date){this._sSettingsDefaultOperation="DATE";this._defaultDate=e.defaultDate}}if(e&&e.operations&&e.operations.filter){this.oOperationFilter=e.operations.filter}else{this.oOperationFilter=null}};a.prototype.getParent=function(){return this.oFilterProvider._oSmartFilter};a.prototype.getModel=function(){return this.oModel};a.prototype.getConditionContext=function(){return this.oConditionContext};a.prototype.setDefaultValues=function(t,e){this.oModel.setProperty("value1",t,this.getConditionContext(),true);this.oModel.setProperty("value2",e,this.getConditionContext(),true)};a.prototype.getContext=function(){return this.oContext};a.prototype.getControls=function(t){return[]};a.prototype.getOperations=function(){return[]};a.prototype.isPending=function(){return this.getModel().getProperty("pending",this.getContext())};a.prototype.attachPendingChange=function(t){this.attachEvent("PendingChange",t)};a.prototype.detachPendingChange=function(t){this.detachEvent("PendingChange",t)};a.prototype.setPending=function(t){if(this.bAsync){this.getModel().setProperty("pending",t,this.getContext())}};a.prototype._filterOperation=function(t){if(!this.oOperationFilter){return true}var e=Array.isArray(this.oOperationFilter)?this.oOperationFilter:[this.oOperationFilter],o;e.some(function(e){if(!e.path){return false}var i=t[e.path];var n=e.exclude||false;var r;if(e.contains&&i){r=typeof e.contains==="string"?e.contains.split(","):e.contains;o=n;for(var a=0;a<r.length;a++){if(n&&i.indexOf(r[a])>-1){o=false;return true}else if(!n&&i.indexOf(r[a])>-1){o=true;return true}}}if(e.equals&&i){r=typeof e.equals==="string"?e.equals.split(","):e.equals;o=n;for(var a=0;a<r.length;a++){if(n&&i===r[a]){o=false;return true}else if(!n&&i===r[a]){o=true;return true}}}return false});return o};a.prototype._updateOperation=function(t){if(!t.textValue){t.textValue=""}if(!t.languageText&&t.textKey){t.languageText=this.getTranslatedText(t.textKey)}};a.prototype.updateOperations=function(){this.oModel.setProperty("operations",[],this.getContext())};a.prototype.getOperation=function(t){var e=this.oModel.getProperty("operations",this.getContext())||[];for(var o=0;o<e.length;o++){if(t===e[o].key){return e[o]}}return null};a.prototype.getDefaultOperation=function(){var t=this.getOperations();if(!t||t.length===0){return null}for(var e=0;e<t.length;e++){if(this._sSettingsDefaultOperation===t[e].key){if(this._defaultDate&&t[e].key==="DATE"){t[e].defaultValues=[new i(this._defaultDate).oDate];this._defaultDate=null}if(t[e].defaultValues&&this._defaultDate){if(Array.isArray(t[e].defaultValues)&&Array.isArray(this._defaultDate)){if(t[e].defaultValues.length<=this._defaultDate.length){t[e].defaultValues=this._defaultDate}else if(this._defaultDate.length===1){t[e].defaultValues[0]=this._defaultDate[0]}this._defaultDate=null}}return t[e]}if(!this._sSettingsDefaultOperation&&t[e].defaultOperation){if(!this._defaultDate&&t[e].key==="DATE"&&t[e].defaultValues&&t[e].defaultValues[0]){t[e].defaultValues=[null]}return t[e]}}return t[0]};a.prototype.setControls=function(t){var e=this.oModel.getProperty("controls",this.getContext());var o;if(e){for(o=0;o<e.length;o++){e[o].destroy()}}this.oModel.setProperty("controls",t,this.getContext());if(t){for(o=0;o<t.length;o++){t[o].setBindingContext(this.getConditionContext(),"$smartEntityFilter")}}};a.prototype.setOperation=function(t){var e=this.getOperation(t);if(e){this.setCondition({operation:e.key,key:this.sFieldName,value1:e.defaultValues[0]||null,value2:e.defaultValues[1]||null});this.getModel().checkUpdate(true)}else{}};a.prototype.isValidCondition=function(){return false};a.prototype.setCondition=function(t){this.oModel.setProperty("key",t.key,this.oConditionContext);this.oModel.setProperty("operation",t.operation,this.oConditionContext);this.oModel.setProperty("value1",t.value1,this.oConditionContext);this.oModel.setProperty("value2",t.value2,this.oConditionContext);this.oModel.setProperty("tokenText",this.getTokenText(t),this.oConditionContext);return this};a.prototype.setAsync=function(t){this.bAsync=t};a.prototype.getAsync=function(t){return this.bAsync};a.prototype.initialize=function(t){this.updateOperations()};a.prototype.serialize=function(){};a.prototype.validate=function(t){this._bForceError=t!==false;var e,o=this.getModel().getProperty("inputstate",this.getContext())||"NONE";if(!this.isPending()&&this.oFieldMetadata&&this.oFieldMetadata.isMandatory&&(!this.isValidCondition()||o!=="NONE")&&this._bForceError){e=this.oFieldMetadata.control;if(e&&e.setValueStateText){e.setValueStateText(this.getTranslatedText("MANDATORY_FIELD_WITH_LABEL_ERROR","sap.ui.comp",[this.oFieldMetadata.label]))}this.getModel().setProperty("inputstate","ERROR",this.getContext());return false}this.getModel().setProperty("inputstate","NONE",this.getContext());return true};a.prototype.getCondition=function(){var t=Object.assign({},this.oModel.getProperty("",this.oConditionContext));return t};a.prototype.providerDataUpdated=function(t,e){};a.prototype.getFilter=function(t){return null};a.prototype.getFilterRanges=function(t){return null};a.prototype.getTokenText=function(t){return""};a.prototype.getName=function(){return this.getMetadata().getName()};a.prototype.getType=function(){return"Edm"};a.prototype.destroy=function(){this.setControls([]);e.prototype.destroy.apply(this,arguments)};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/delegates/FlexibilityDelegate", ["sap/ui/base/Object","sap/ui/rta/plugin/annotations/AnnotationTypes","sap/ui/comp/delegates/Label","sap/ui/comp/delegates/TextArrangement"],function(e,t,n,a){"use strict";var i=e.extend("sap.ui.comp.delegates.FlexibilityDelegate",{constructor:function(){e.apply(this,arguments)}});i.getTextArrangementDelegate=function(){return{isEnabled:true,changeType:"textArrangement",title:"TEXTARRANGEMENT_RTA_DIALOG_TITLE",type:t.ValueListType,annotation:"textArrangement",delegate:a,additionalInfoKey:"TEXTARRANGEMENT_RTA_CONTEXT_MENU_INFO"}};i.getLabelDelegate=function(e){const a=new n(e);return Object.assign({isEnabled:true,changeType:"annotationRename",title:e?.singleRename?"RENAME_RTA_LABEL_ACTION":"LABEL_RTA_DIALOG_TITLE",type:t.StringType,annotation:"label",delegate:a,objectTemplateInfo:{templateAsString:'{"String": "%%placeholder%%"}',placeholder:"%%placeholder%%"},additionalInfoKey:"LABEL_RTA_CONTEXT_MENU_INFO"},e)};return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/delegates/Label", ["sap/ui/base/Object","sap/ui/comp/odata/MetadataAnalyser"],function(e,t){"use strict";const n=e.extend("sap.ui.comp.delegates.Label",{constructor:function(t){e.apply(this,arguments);this.bSingle=t?.singleRename}});const a=(e,n,a)=>{const o=new t(e),i=o.getFieldsByEntitySetName(n)?.filter(e=>e.visible&&(!a||a===e.name));return i?.map(e=>({propertyName:e.name,annotationPath:`/dataServices/schema/0/entityType/[\${name}==='${e.entityName}']/property/[\${name}==='${e.name}']/com.sap.vocabularies.Common.v1.Label`,currentValue:e.fieldLabel}))};n.prototype.getAnnotationsChangeInfo=function(e){let t;const n=e.getFlexConfig()?.entitySetName;if(e&&e.isA("sap.ui.comp.smartform.GroupElement")&&this.bSingle){const n=e._getFieldRelevantForLabel();t=n?.getControlFactory()?.getEdmProperty()?.name}return{serviceUrl:e.getModel().getServiceUrl(),properties:a(e.getModel(),n,t)}};return n});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/delegates/TextArrangement", ["sap/ui/comp/library","sap/ui/base/Object","sap/ui/comp/odata/MetadataAnalyser"],function(e,t,a){"use strict";const n=t.extend("sap.ui.comp.delegates.TextArrangement",{constructor:function(){t.apply(this,arguments)}});const i=e.smartfield.DisplayBehaviour.descriptionOnly,s=e.smartfield.DisplayBehaviour.descriptionAndId;const r=(e,t)=>{if(!t){return false}const a=t.annotation?.Parameters.find(t=>t.LocalDataProperty?.PropertyPath===e&&t.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut");const n=a?.ValueListProperty?.String;if(!n){return false}const i=t?.valueListFields.find(e=>e.name===n);return!!i["com.sap.vocabularies.Common.v1.Text"]};const o=e=>{const t=e["com.sap.vocabularies.Common.v1.Text"];let a=e["com.sap.vocabularies.UI.v1.TextArrangement"]?.EnumMember.split("/").pop();if(!a&&t){a=t["com.sap.vocabularies.UI.v1.TextArrangement"]?.EnumMember.split("/").pop()}return a};const m=function(e){const t=new a(e.getModel()),n={idOnly:"TextSeparate",descriptionAndId:"TextFirst",idAndDescription:"TextLast",descriptionOnly:"TextOnly"},m=["Edm.String"],l=[],c=e.getFlexConfig(),p=t.getFieldsByEntitySetName(c.entitySetName);p?.forEach(function(e){if(m.includes(e.type)){l.push({item:e,valueList:t.getValueListAnnotationLazy(e.fullName)})}});return new Promise(function(e,p){Promise.all(l.map(async e=>({...e,valueList:await e.valueList}))).then(l=>{const p=[];l?.forEach(function(e){const l=e.item,u={},y=e?.valueList?.primaryValueListAnnotation,v=a.isCurrencyCode(l)||a.isUnitOfMeasure(l);let T;const d=l["com.sap.vocabularies.Common.v1.Text"];if(m.includes(l.type)&&!v&&l.visible&&(d||y)){const e=a.hasTextArrangementAnnotation(l);let m,v;if(y&&y.valueListFields.length>0){v=a.hasTextArrangementAnnotation(y.valueListFields[0]);m=r(l.name,y)}const f=t.getTextArrangementValue(t.getEntityTypeNameFromEntitySetName(c.entitySetName));if(e||v||d||m){if(e){T=o(l)}else if(v){T=o(y)}else if(f){T=n[f]}else if(d||m){if(l["com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]||l["sap:value-list"]==="fixed-values"){T=n[i]}else{T=n[s]}}u.propertyName=l["sap:label"]||l["com.sap.vocabularies.Common.v1.Label"]?.String;if(d){u.annotationPath=`/dataServices/schema/0/entityType/[\${name}==='${l.entityName}']/property/[\${name}==='${l.name}']/com.sap.vocabularies.Common.v1.Text/com.sap.vocabularies.UI.v1.TextArrangement`}else{u.annotationPath=`/dataServices/schema/0/entityType/[\${name}==='${l.entityName}']/property/[\${name}==='${l.name}']/com.sap.vocabularies.UI.v1.TextArrangement`}u.currentValue={EnumMember:"com.sap.vocabularies.UI.v1.TextArrangementType/"+T};p.push(u)}}});e(p)})})};n.getAnnotationsChangeInfo=async function(t){const a={[e.TextArrangementType.TextOnly]:"Text Only",[e.TextArrangementType.TextFirst]:"Text First",[e.TextArrangementType.TextLast]:"Text Last",[e.TextArrangementType.TextSeparate]:"ID Only"},n=await m(t);return{serviceUrl:t.getModel().getServiceUrl(),properties:n,possibleValues:Object.keys(a).map(e=>({key:{EnumMember:e},text:a[e]})),preSelectedProperty:""}};return n});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterBar", ["sap/base/i18n/Localization","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/library","sap/ui/core/Control","sap/ui/core/ResizeHandler","sap/m/Button","sap/m/Label","sap/m/Title","sap/m/Text","sap/m/AssociativeOverflowToolbar","sap/m/ToolbarSpacer","sap/ui/Device","sap/ui/comp/state/UIState","./VariantConverterFrom","./VariantConverterTo","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/comp/smartvariants/SmartVariantManagement","sap/m/library","sap/ui/model/json/JSONModel","./FilterGroupItem","./FilterBarRenderer","sap/base/Log","sap/base/util/merge","sap/ui/core/ShortcutHintsMixin","sap/base/util/Deferred","sap/m/delegate/ValueStateMessage","sap/m/ToolbarSeparator","sap/ui/layout/form/Form"],function(e,t,i,r,a,n,s,o,l,h,d,u,g,f,p,_,c,m,F,A,y,I,v,V,b,S,B,C,T){"use strict";var R=r.ValueState;var D=i.getResourceBundleFor("sap.ui.comp").getText("SEARCH_FIELD_VALIDATION_WARNING_MESSAGE");var M=r.TextAlign;var E=r.TitleLevel;var N=F.ButtonType;var T;var L=a.extend("sap.ui.comp.filterbar.FilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/filterbar/FilterBar.designtime",properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:""},advancedMode:{type:"boolean",group:"Misc",defaultValue:false},expandAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},searchEnabled:{type:"boolean",group:"Misc",defaultValue:true,deprecated:true},filterBarExpanded:{type:"boolean",group:"Misc",defaultValue:true},considerGroupTitle:{type:"boolean",group:"Misc",defaultValue:false},showAllFilters:{type:"boolean",group:"Misc",defaultValue:false},showClearButton:{type:"boolean",group:"Misc",defaultValue:false,deprecated:true},showRestoreButton:{type:"boolean",group:"Misc",defaultValue:true},showGoOnFB:{type:"boolean",group:"Misc",defaultValue:true},showRestoreOnFB:{type:"boolean",group:"Misc",defaultValue:false},showClearOnFB:{type:"boolean",group:"Misc",defaultValue:false},showGoButton:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},deltaVariantMode:{type:"boolean",group:"Misc",defaultValue:true},filterContainerWidth:{type:"string",group:"Misc",defaultValue:"12rem"},useToolbar:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:""},showFilterConfiguration:{type:"boolean",group:"Misc",defaultValue:true},useSnapshot:{type:"boolean",group:"Misc"},isRunningInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false},disableSearchMatchesPatternWarning:{type:"boolean",group:"Misc",defaultValue:false},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:E.Auto}},aggregations:{filterItems:{type:"sap.ui.comp.filterbar.FilterItem",multiple:true,singularName:"filterItem"},filterGroupItems:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"filterGroupItem"},content:{type:"sap.ui.core.Control",multiple:true},_parameters:{type:"sap.ui.comp.filterbar.FilterGroupItem",multiple:true,singularName:"_parameter",visibility:"hidden"},_toolbar:{type:"sap.m.AssociativeOverflowToolbar",multiple:false,visibility:"hidden"},_headerTitle:{type:"sap.m.Title",multiple:false,visibility:"hidden"},_variantManagement:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},_basicSearch:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},_searchButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_hideShowButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_clearButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_restoreButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_filtersButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_showAllFiltersButton:{type:"sap.m.Button",multiple:false,visibility:"hidden"},_hintText:{type:"sap.m.Text",multiple:false,visibility:"hidden"}},defaultAggregation:"content",associations:{basicSearch:{type:"sap.m.SearchField",multiple:false}},events:{cancel:{},reset:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},search:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"},firedFromFilterBar:{type:"boolean"}}},beforeVariantSave:{parameters:{context:{type:"string"}}},beforeVariantFetch:{},afterVariantLoad:{parameters:{context:{type:"string"},executeOnSelect:{type:"boolean"}}},filterChange:{parameters:{added:{type:"sap.ui.core.Control"},deleted:{type:"sap.ui.core.Control"},filterItem:{type:"sap.ui.comp.filterbar.FilterGroupItem"}}},clear:{parameters:{selectionSet:{type:"sap.ui.core.Control[]"}}},initialise:{},initialized:{},afterVariantSave:{},filtersDialogClosed:{parameters:{context:{type:"string"}}},filtersDialogBeforeOpen:{},filtersDialogSearch:{},filtersDialogCancel:{},filtersDialogSearchForFilters:{parameters:{newValue:{type:"string"}}},assignedFiltersChanged:{}}},renderer:I});L.INTERNAL_GROUP="__$INTERNAL$";L.prototype.init=function(){a.prototype.init.apply(this,arguments);this._filterGroupItemChange=this._filterGroupItemChange.bind(this);this._filterItemChange=this._filterItemChange.bind(this,null);this._onLocalizationChanged=this._onLocalizationChanged.bind(this);this._oVariantManagement=null;this._oCollectiveSearch=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._mAdvancedAreaFilterFlat=[];this._aOrderedFilterItems=[];this._aAdaptFilterItems=[];this._mAdvancedAreaHiddenFilters=[];this._mAdaptFiltersDialogInitialItemsOrder=[];this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._bIsInitialized=false;this._bSearchFiredFromFilterBar=false;this._bMoveTriggered=false;this._bDelegateAdded=false;this._oInitializedDeferred=new S;this._aFields=null;this._oBasicSearchField=null;this._oVariant={};this._oSelectedVariantBase=null;this._filterChangeSemaphore=true;this._triggerFilterChangeState=true;this._fRegisteredFilterChangeHandlers=null;this._fInitialiseVariants=null;this._bHostedVariantManagement=false;this._bFiltersDialogForKeyUser=false;this._nMaxFiltersByDefault=7;this._bResetFiltersDialogTriggered=false;this._oRb=i.getResourceBundleFor("sap.ui.comp");this._createVariantLayout();this._createButtons();this._createHeaderTitle();this._createToolbar();this.oModel=new A({});this.setModel(this.oModel,"FilterBar");this._oHintText=new h({text:this._oRb.getText("FILTER_BAR_NO_FILTERS_ON_FB"),textAlign:M.Center}).addStyleClass("sapUiCompFilterBarHint");this.setAggregation("_hintText",this._oHintText);if(this._isTablet()||this._isPhone()){this.setFilterBarExpanded(false)}this.getMetadata().addPublicMethods("getInitializedPromise");this._oClearButtonOnFB=this._getClearButton();e.attachChange(this._onLocalizationChanged)};L.prototype.onBeforeRendering=function(){const e=!!this._mAdvancedAreaFilter;a.prototype.onBeforeRendering.apply(this,arguments);this._updateHideShowButtonText();this._updateHeaderTitle();this._updateToolbarText();this._getClearButton().setVisible(this.getShowClearOnFB());this._getRestoreButton().setVisible(this.getShowRestoreOnFB());this._calcVisibilityFiltersButton();this._calcVisibilityHideShowButton();this._calcVisibilityGoButton();this._calcVisibilityVariant();this._calcVisibilityBasicSearch();this._calcVisibilitySeparator();this._getClearButton().setEnabled(e);this._getRestoreButton().setEnabled(e);this._getFiltersButton().setEnabled(e);this._getHideShowButton().setEnabled(e);this._getSearchButton().setEnabled(this.getSearchEnabled());this._suspendSuggestionBindingOnhiddenItems();this._deregisterResizeHandlers()};L.prototype.onAfterRendering=function(e){a.prototype.onAfterRendering.apply(this,arguments);this._applyAttributes();this._registerResizeHandlers();this._onResize()};L.prototype._registerResizeHandlers=function(){const e=this.$("item-buttons").get(0);this._iResizeHandlerId=n.register(this,this._onResize.bind(this));if(e){this._iButtonsAreaResizeHandlerId=n.register(e,this._onResize.bind(this))}};L.prototype._deregisterResizeHandlers=function(){if(this._iResizeHandlerId){n.deregister(this._iResizeHandlerId);this._iResizeHandlerId=null}if(this._iButtonsAreaResizeHandlerId){n.deregister(this._iButtonsAreaResizeHandlerId);this._iButtonsAreaResizeHandlerId=null}};L.prototype._suspendSuggestionBindingOnhiddenItems=function(){this.getFilterGroupItems().forEach(e=>{const t=e.getControl();if(!t){return}const i=this._getControlBoundAggregationName(t);if(e.getVisible()){t.getBinding(i)?.resume()}else{t.getBinding(i)?.suspend()}})};L.prototype._getControlBoundAggregationName=function(e){if(e.isBound("items")){return"items"}if(e.isBound("suggestionItems")){return"suggestionItems"}if(e.isBound("suggestionRows")){return"suggestionRows"}};L.prototype._onResize=function(){if(!this.getAdvancedMode()||this.getIsRunningInValueHelpDialog()){this._onNonAdvancedModeResize()}else if(this.getAdvancedMode()){this._onAdvancedModeResize()}};L.prototype._onAdvancedModeResize=function(){const e=this.getDomRef();if(!e){return}e.classList.remove("sapUiCompFilterBarTablet");e.classList.remove("sapUiCompFilterBarDesktop");if(e.offsetWidth>605&&e.offsetWidth<=1024){e.classList.add("sapUiCompFilterBarTablet")}if(e.offsetWidth>1024){e.classList.add("sapUiCompFilterBarDesktop")}};L.prototype._onNonAdvancedModeResize=function(){const e=16,t=this.getDomRef(),i=t?.querySelector(".sapUiCompFilterBarButtons"),r=t?.querySelector(".sapUiCompFilterBarBasicSearch"),a=t?.querySelectorAll(".sapUiCompFilterBarItem"),n=a?.length>0?a[0]:r,s=a?.length>0?a[a.length-1]:r;if(!n||!s||!i||t?.offsetHeight===0){return}const o=i.getBoundingClientRect(),l=n.getBoundingClientRect(),h=s.getBoundingClientRect();let d="";if(o.x-e>=h.x+h.width){d=`margin-top: -${h.height}px`}if(h.width<l.width){d=""}i.style=d;if(l.y===h.y){t.classList.add("sapUiCompFilterBarOneLine")}else{t.classList.remove("sapUiCompFilterBarOneLine")}};L.prototype.getShowAllFiltersButton=function(){return this._getShowAllFiltersButton()};L.prototype._getMaxItemWidth=function(){var e,t,i=this.getFilterContainerWidth();["rem","%","px","em"].some(function(t){var r=i.indexOf(t);if(r>0){i=i.substring(0,r);e=t;return true}return false});if(e){t=parseInt(i);if(!isNaN(t)){t*=2;return t+e}}};L.prototype._hasAnyVisibleFiltersOnFB=function(){var e=this._retrieveVisibleAdvancedItems();for(var t=0;t<e.length;t++){if(e[t].filterItem.getVisibleInFilterBar()){return true}}return false};L.prototype._hasRelevantFilters=function(){var e,t=null,i;if(!this._mAdvancedAreaFilter||Object.keys(this._mAdvancedAreaFilter)<1){return false}if(this.getAdvancedMode()){for(t in this._mAdvancedAreaFilter){var r=this._mAdvancedAreaFilter[t];if(r&&r.items){for(e=0;e<r.items.length;e++){i=r.items[e];if(i){if(this._determineVisibility(i.filterItem)){return true}}}}}return false}return true};L.prototype.getVariantManagement=function(){return this._oVariantManagement};L.prototype._updateHideShowButtonText=function(){let e=this.getFilterBarExpanded()?"FILTER_BAR_HIDE":"FILTER_BAR_SHOW";if(this.getAdvancedMode()){e=this.getFilterBarExpanded()?"FILTER_BAR_VH_HIDE_FILTERS":"FILTER_BAR_VH_SHOW_FILTERS"}this._getHideShowButton().setText(this._oRb.getText(e))};L.prototype._calcVisibilityBasicSearch=function(){let e=true;if(!this._oBasicSearchField){return}if(!this._isNewFilterBarDesign()&&this._isPhone()&&!this.getAdvancedMode()){e=false}this._oBasicSearchField.setVisible(e)};L.prototype._calcVisibilitySeparator=function(){const e=this.getAggregation("_headerTitle"),t=this._oVariantManagement;let i=false;if(this._oBasicSearchField&&!this._isPhone()&&!this.getIsRunningInValueHelpDialog()&&(e?.getVisible()||t?.getVisible())){i=true}this._oSeparator.setVisible(i)};L.prototype._calcVisibilityVariant=function(){if(!this._oVariantManagement||this.getAssociation("smartVariant")){return false}let e=true;if(this._possibleToChangeVariantManagement()&&(this.getAdvancedMode()||!this.getPersistencyKey())){e=false}this._oVariantManagement.setVisible(e)};L.prototype._calcVisibilityFiltersButton=function(){this._getFiltersButton().setVisible(!this.getAdvancedMode()&&this.getShowFilterConfiguration())};L.prototype._calcVisibilityHideShowButton=function(){if(this.getAdvancedMode()&&!this._isPhone()){this._getHideShowButton().setVisible(this._hasRelevantFilters())}else if(this._isPhone()){this._getHideShowButton().setVisible(false)}};L.prototype._calcVisibilityGoButton=function(){var e=this.getShowGoOnFB();if(e&&!this._isPhone()&&this.isLiveMode&&this.isLiveMode()){e=false}this._getSearchButton().setVisible(e)};L.prototype.setShowGoButton=function(e){return this.setShowGoOnFB(e)};L.prototype.getShowGoButton=function(){return this.getShowGoOnFB()};L.prototype.hideGoButton=function(){this._getSearchButton().setVisible(false)};L.prototype.restoreGoButton=function(){this._getSearchButton().setVisible(this.getShowGoOnFB())};L.prototype.isCurrentVariantStandard=function(){var e;if(this._oVariantManagement){e=this._oVariantManagement.getCurrentVariantId();if(e===""){return true}return e===this._oVariantManagement.getStandardVariantKey()}return undefined};L.prototype.setCurrentVariantId=function(e,t){if(this._oVariantManagement){this._oVariantManagement.setCurrentVariantId(e,t)}};L.prototype.getCurrentVariantId=function(){var e="";if(this._oVariantManagement){e=this._oVariantManagement.getCurrentVariantId()}return e};L.prototype.getDataSuiteFormat=function(e){return this._getDataSuiteFormat(e,null)};L.prototype._getDataSuiteFormat=function(e,t){var i=null,r,a,n,s,o;if(this._oVariantManagement){r=this.getCurrentVariantId();if(this.getFilterDataAsString){n=this._determineVariantFiltersInfo(e,true);if(this.getFilterContextUrl){o=this.getFilterContextUrl()}if(this.getParameterContextUrl){s=this.getParameterContextUrl()}a=this.getFilterDataAsString(e);if(a){var l=new _;i=l.convert(r,n,a,this,t,s,o)}}}return i};L.prototype.getBasicSearchName=function(){var e=null;if(this._oBasicSearchField&&this.getEntitySet){e="$"+this.getEntitySet()+".basicSearch"}return e};L.prototype.getBasicSearchValue=function(){return this._getBasicSearchValue()};L.prototype.setUiStateAsVariant=function(e,t){var i={replace:true,strictMode:true};this.setUiState(e,i);this.fireAfterVariantLoad(t,false);this._applyVisibility(e.getSelectionVariant())};L.prototype._applyVisibility=function(e){var t=function(e){if(e&&e.getVisible()&&!e.getHiddenFilter()){if(!e.getVisibleInFilterBar()){e.setVisibleInFilterBar(true)}if(!e.getPartOfCurrentVariant()){e.setPartOfCurrentVariant(true)}}};if(this._bIsInitialized){for(var i in this._mAdvancedAreaFilter){if(i){this._mAdvancedAreaFilter[i].items.forEach(function(e){if(e&&e.filterItem&&e.filterItem.getMandatory()){t(e.filterItem)}else if(e&&e.filterItem){if(e.filterItem.getVisibleInFilterBar()){e.filterItem.setVisibleInFilterBar(false)}(function(){if(e.filterItem.getPartOfCurrentVariant()){if(i===L.INTERNAL_GROUP){e.filterItem.setPartOfCurrentVariant(true)}else{e.filterItem.setPartOfCurrentVariant(false)}}})()}})}}if(e&&e.Parameters){e.Parameters.forEach(function(e){var i=this.determineFilterItemByName(e.PropertyName);t(i)}.bind(this))}if(e&&e.SelectOptions){e.SelectOptions.forEach(function(e){var i=this.determineFilterItemByName(e.PropertyName);t(i)}.bind(this))}}};L.prototype.getUiState=function(e){var t,i,r=false,a=null,n,s;if(e){r=e.allFilters===true}i=this._getDataSuiteFormat(r,"13.0");t=new f;t.selectionVariant=JSON.parse(i);t.setSelectionVariant(t.selectionVariant);var o=t.getSelectionVariant();if(o){if(this.getModelData&&this.getModelData()){a=this.getModelData()}s=f.calcSemanticDates(o,a);t.setSemanticDates(s);n=f.calculateValueTexts(o,a);t.setValueTexts(n);window.sessionStorage.setItem(this.getId(),JSON.stringify(n));window.sessionStorage.setItem("semanticDates",JSON.stringify(s))}return t};L.prototype.setUiState=function(e,t){var i,r,a=null,n=false,s=true,o;if(t&&typeof t.replace==="boolean"){n=t.replace}if(t&&typeof t.strictMode==="boolean"){s=t.strictMode}if(e){a=e.getSelectionVariant();if(a){r=JSON.stringify(a)}i=e.getValueTexts();o=e.getSemanticDates()}if(!i){i=JSON.parse(window.sessionStorage.getItem(this.getId()))}if(!o){o=JSON.parse(window.sessionStorage.getItem("semanticDates"))}this._setDataSuiteFormat(r,n,s,i,o);this._enhanceFilterItemsWithTextValue(i,a)};L.prototype.getDescriptionForKeys=function(e){};L.prototype._enhanceFilterItemsWithTextValue=function(e,t){var i=f.determineFiltersWithOnlyKeyValues(e,t,[this.getBasicSearchName()]);this.getDescriptionForKeys(i)};L.prototype.setDataSuiteFormat=function(e,t){this._setDataSuiteFormat(e,t,true)};L.prototype._setDataSuiteFormat=function(e,t,i,r,a){var n,s,o;if(e){n=new p;s=n.convert(e,this,i);if(s){this._clearErrorState();if(s.variantId&&this._oVariantManagement){if(this._bIsInitialized){if(this._oVariantManagement.isPageVariant()){this._oVariantManagement._selectVariant(s.variantId,"DATA_SUITE")}else{this._setFilterVisibility(s.variantId)}}this._oVariantManagement.setInitialSelectionKey(s.variantId)}if(s.payload&&(t||Object.keys(JSON.parse(s.payload)).length>0)&&this.setFilterDataAsString){o=s.payload;if(r){o=f.enrichWithValueTexts(o,r)}if(a){o=f.enrichWithSemanticDates(o,a)}this.setFilterDataAsString(o,t)}if(s.basicSearch&&this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(s.basicSearch);this.fireAssignedFiltersChanged()}}}};L.prototype._setFilterVisibility=function(e){if(this._oVariantManagement.getSelectionKey()!==e){this._oVariantManagement.setInitialSelectionKey(e);var t=this._getStandardVariant();if(t){var i=this._oVariantManagement.getVariantContent(this,e);if(i&&i.filterbar){if(i.hasOwnProperty("version")){i=this.mergeVariant(t,i)}this._reapplyVisibility(i.filterbar)}}}};L.prototype.applySettings=function(e){a.prototype.applySettings.apply(this,arguments);if(this._possibleToChangeVariantManagement()){if(e&&e.customData){for(var t=0;t<e.customData.length;t++){var i=e.customData[t];if(i&&i.mProperties&&i.mProperties.key==="pageVariantPersistencyKey"){this._oVariantManagement.setPersistencyKey(i.mProperties.value);this._oVariantManagement.setVisible(true);this._bHostedVariantManagement=true}}}}if(e&&e.persistencyKey){this._bHostedVariantManagement=true}};L.prototype._possibleToChangeVariantManagement=function(){return this._oVariantManagement&&!this._oVariantManagement.isPageVariant()};L.prototype.clearVariantSelection=function(){if(this._oVariantManagement){this._oVariantManagement.clearVariantSelection()}};L.prototype.setSearchButtonEmphType=function(e){};L.prototype.setSimplifiedMode=function(e){};L.prototype.getSimplifiedMode=function(){return!this.getAdvancedMode()};L.prototype.setExpandAdvancedArea=function(e){return this.setFilterBarExpanded(e)};L.prototype.getExpandAdvancedArea=function(){return this.getFilterBarExpanded()};L.prototype._isNewFilterBarDesign=function(){if(this.getAdvancedMode()){return false}if(!this.getUseToolbar()){return true}return false};L.prototype._setCollectiveSearch=function(e){const t=this.getAggregation("_toolbar");if(!t||!this.getAdvancedMode()){return}if(this._oVariantManagement){t.removeContent(this._oVariantManagement);this._unregisterVariantManagement(this._oVariantManagement);this._oVariantManagement=null}if(this._oCollectiveSearch){t.removeContent(this._oCollectiveSearch)}this._oCollectiveSearch=e;if(this._oCollectiveSearch){t.insertContent(this._oCollectiveSearch,t.indexOfContent(this.getAggregation("_headerTitle"))+1)}};L.prototype.setBasicSearch=function(e){const i=this.getAggregation("_toolbar");this.setAssociation("basicSearch",e,true);if(typeof e==="string"){e=t.getElementById(e)}if(e&&!e.getParent()){i.insertContent(e,i.indexOfContent(this._oSeparator)+1)}this._oBasicSearchField=e;if(e&&e.getParent()){return}this.setAggregation("_basicSearch",e);if(e){const t=e.setParent;const r=this;e.setParent=function(){t.apply(this,arguments);if(e.getParent()!==r||e.getParent()===r&&e.sParentAggregationName==="content"){i.removeContent(e)}}}return this};L.prototype._getBasicSearchValue=function(){if(this._oBasicSearchField&&this._oBasicSearchField.getValue){return this._oBasicSearchField.getValue()}return null};L.prototype.addFilterItem=function(e){var i,r,a,n;if(!e){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem' may not be null nor empty")}i=e.getName();if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.name' may not be null nor empty")}r=e._getControl();if(!r){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterItem()"+" Expected argument 'oFilterItem.control' may not be null nor empty")}this.addAggregation("filterItems",e,true);if(!this._aBasicAreaSelection){this._aBasicAreaSelection=[]}var s={control:e._getControl(),filterItem:e};this._aBasicAreaSelection.push(s);n=e.getId()+"__filterGroupItem";a=t.getElementById(n);if(!a){a=new y(e.getId()+"__filterGroupItem",{label:e.getLabel(),controlTooltip:e.getControlTooltip(),name:e.getName(),mandatory:e.getMandatory(),visible:e.getVisible(),visibleInFilterBar:e.getVisibleInFilterBar(),partOfCurrentVariant:true,control:e._getControl(),groupName:L.INTERNAL_GROUP,groupTitle:"",hiddenFilter:e.getHiddenFilter(),entitySetName:e.getEntitySetName(),entityTypeName:e.getEntityTypeName()})}if(e.data("isCustomField")){a.data("isCustomField",true)}e.attachChange(this._filterItemChange);this.addFilterGroupItem(a);return this};L.prototype.addFilterGroupItem=function(e){var t,i,r;if(!e){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItem()"+" Expected argument 'oFilterGroupItem' may not be null nor empty")}this.addAggregation("filterGroupItems",e);i=e.getGroupName();if(!i){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" GroupName may not be null nor empty")}t=e.getName();if(!t){throw new Error("sap.ui.comp.filterbar.FilterBar.prototype.addFilterGroupItems()"+" Name may not be null nor empty")}if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={}}if(!this._mAdvancedAreaFilter[i]){this._mAdvancedAreaFilter[i]={};this._mAdvancedAreaFilter[i].filterItem=null;this._mAdvancedAreaFilter[i].items=[]}if(!this._mAdvancedAreaFilter[i].items){this._mAdvancedAreaFilter[i].items=[]}if(!this._mAdvancedAreaFilter[i].filterItem){this._mAdvancedAreaFilter[i].filterItem=e}r={control:e._getControl(),filterItem:e};if(this.getAdvancedMode()||e.getVisibleInFilterBar()){e.setVisibleInFilterBar(true)}else{e.setVisibleInFilterBar(false)}this._mAdvancedAreaFilter[i].items.push(r);if(!e.getHiddenFilter()){this._prepareFilterItemAndLabel(e);if(e.getVisibleInFilterBar()){e.setPartOfCurrentVariant(e.getVisibleInFilterBar())}e.attachChange(this._filterGroupItemChange)}this._mAdvancedAreaFilterFlat=[];return this};L.prototype.removeFilterItem=function(e){var t,i,r,a,n=this.getFilterItems(),s=this.getFilterGroupItems();if(!n||!n.length){return null}i=this._getRemovedItemAsObject(e,n);if(!i){return null}i.detachChange(this._filterItemChange);for(t=0;t<this._aBasicAreaSelection.length;t++){if(this._aBasicAreaSelection[t].filterItem.getId()===i.getId()){this._aBasicAreaSelection.splice(t,1);if(this._aBasicAreaSelection.length===0){this._aBasicAreaSelection=null}break}}this.removeAggregation("filterItems",i,true);r=i.getId()+"__filterGroupItem";a=this._getRemovedItemAsObject(r,s);this._removeFilterGroupItem(a);return i};L.prototype.removeFilterGroupItem=function(e){var t,i=this.getFilterGroupItems();if(!i||!i.length){return null}t=this._getRemovedItemAsObject(e,i);if(!t){return null}return this._removeFilterGroupItem(t)};L.prototype._getRemovedItemAsObject=function(e,t){var i,r;if(typeof e==="string"){for(i=0;i<t.length;i++){if(t[i].getId()===e){r=t[i];break}}}if(typeof e==="number"){if(e<0||e>=t.length){v.warning("sap.ui.comp.filterbar.FilterBar.prototype.removeFilterGroupItems() is called with invalid index "+e)}else{r=t[e]}}if(typeof e==="object"){r=e}return r};L.prototype._removeFilterGroupItem=function(e){var t,i,r,a=e.getGroupName();e.detachChange(this._filterGroupItemChange);this.removeAggregation("filterGroupItems",e,true);if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[a]&&this._mAdvancedAreaFilter[a].items){i=this._mAdvancedAreaFilter[a];for(t=0;t<i.items.length;t++){r=i.items[t];if(r.filterItem.getId()===e.getId()){i.items.splice(t,1);if(i.filterItem.getId()===e.getId()){if(i.items.length){i.filterItem=i.items[0].filterItem}else{delete this._mAdvancedAreaFilter[a]}}break}}if(this.getFilterGroupItems().length===0){this._mAdvancedAreaFilter=null}}return e};L.prototype._addParameter=function(e){var t,i,r=false,a=L.INTERNAL_GROUP;e._setParameter(true);e.setVisibleInFilterBar(true);e.setPartOfCurrentVariant&&e.setPartOfCurrentVariant(true);this.addAggregation("_parameters",e,true);i={control:e._getControl(),filterItem:e};if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={}}if(!this._mAdvancedAreaFilter[a]){this._mAdvancedAreaFilter[a]={};this._mAdvancedAreaFilter[a].filterItem=null}if(!this._mAdvancedAreaFilter[a].items){this._mAdvancedAreaFilter[a].items=[]}for(t=0;t<this._mAdvancedAreaFilter[a].items.length;t++){var n=this._mAdvancedAreaFilter[a].items[t];if(n.filterItem._isParameter()){continue}this._mAdvancedAreaFilter[a].items.splice(t,0,i);r=true;break}if(!r){this._mAdvancedAreaFilter[a].items.push(i)}this._prepareFilterItemAndLabel(e);e.attachChange(this._filterGroupItemChange.bind(this));return this};L.prototype._filterItemChange=function(e,t){var i,r,a,n;if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.filterbar.FilterItem")){a=t.getParameter("propertyName");if(a==="visibleInFilterBar"||a==="visible"||a==="label"||a==="labelTooltip"||a==="controlTooltip"||a==="mandatory"){i=this._determineItemByName(t.oSource.getName(),L.INTERNAL_GROUP);if(i&&i.filterItem){if(a==="visible"){r=t.oSource.getVisible();i.filterItem.setVisible(r)}else if(a==="visibleInFilterBar"){r=t.oSource.getVisibleInFilterBar();var s=this._checkChangePossibleVisibleInFilterBar(i.filterItem,r);if(s){i.filterItem.setVisibleInFilterBar(r)}else{t.oSource.setVisibleInFilterBar(true)}}else if(a==="label"){i.filterItem.setLabel(t.oSource.getLabel())}else if(a==="labelTooltip"){i.filterItem.setLabelTooltip(t.oSource.getLabelTooltip())}else if(a==="controlTooltip"){n=this.determineControlByFilterItem(i.filterItem,true);if(n&&n.setTooltip){n.setTooltip(i.filterItem.getControlTooltip())}}else if(a==="mandatory"){r=t.oSource.getMandatory();i.filterItem.setMandatory(r)}}}}};L.prototype._filterGroupItemChange=function(e){var t;var i;if(e&&e.oSource){i=e.getParameter("propertyName");if(i==="visibleInFilterBar"||i==="visible"){t=this._determineItemByName(e.oSource.getName(),e.oSource.getGroupName());if(t){if(i==="visibleInFilterBar"){var r=e.oSource.getVisibleInFilterBar();var a=r;var n=this._checkChangePossibleVisibleInFilterBar(e.oSource,r);if(!n){e.oSource.setVisibleInFilterBar(true);a=true}if(a){e.oSource.setPartOfCurrentVariant(true)}if(!r&&!this._isFilterItemInBasicGroup(t.filterItem)){e.oSource.setPartOfCurrentVariant(false)}}else if(i==="visible"){if(!this._oAdaptFiltersDialog){if(!this.getAdvancedMode()){this.fireAssignedFiltersChanged()}}}}}else if(i==="groupTitle"){if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[e.oSource.getGroupName()]){this._adaptGroupTitle(e.oSource.getGroupName())}}else if(i==="label"){if(!this._oAdaptFiltersDialog){this._adaptGroupTitleForFilter(e.oSource)}}else if(i==="mandatory"){this._mandatoryFilterItemChange(e.oSource)}else if(i==="partOfCurrentVariant"&&this.ensureLoadedValueHelpList){var s=this.determineFilterItemByName(e.oSource.getName());if(s&&s.getPartOfCurrentVariant&&s.getPartOfCurrentVariant()){this.ensureLoadedValueHelpList(e.oSource.getName())}}}};L.prototype._checkChangePossibleVisibleInFilterBar=function(e,t){if(e&&e.getMandatory()&&!t){var i=this._hasFilterValue(e);if(!i){e.setVisibleInFilterBar(true);return false}}return true};L.prototype._hasFilterValue=function(e){var t;if(!this._getTriggerFilterChangeState()&&this.getAllFiltersWithValues){t=this.getAllFiltersWithValues()}else{t=this._getFiltersWithValues()}return this._checkFilterForValue(t,e)};L.prototype._adaptGroupTitleForFilter=function(e){var t;var i;if(e&&!e.getHiddenFilter()){t=e.getLabel();i=e.getLabelControl(this.getId());if(this.getConsiderGroupTitle()){if(i&&e.getGroupTitle()){i.setText(t+" ("+e.getGroupTitle()+")")}}else{i.setText(t)}}};L.prototype._adaptGroupTitle=function(e){var t;var i;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[e]&&this._mAdvancedAreaFilter[e].items){for(t=0;t<this._mAdvancedAreaFilter[e].items.length;t++){i=this._mAdvancedAreaFilter[e].items[t];if(i&&i){this._adaptGroupTitleForFilter(i.filterItem)}}}};L.prototype.registerGetFiltersWithValues=function(e){this._fRegisterGetFiltersWithValues=e;return this};L.prototype.registerFetchData=function(e){this._fRegisteredFetchData=e;return this};L.prototype.registerApplyData=function(e){this._fRegisteredApplyData=e;return this};L.prototype._isTINAFScenario=function(){if(this._oVariantManagement){return true}else{if(this._oCollectiveSearch&&this.getAdvancedMode()){return true}return false}};L.prototype.fireInitialise=function(){if(this._isTINAFScenario()){this._createVisibleFilters();if(this.getAdvancedMode()){this._ensureFilterLoaded(null)}this._fireInitialiseEvent()}else{this._initializeVariantManagement()}};L.prototype.variantsInitialized=function(){this.fireInitialized();this._oInitializedDeferred.resolve()};L.prototype.fireInitialized=function(){this.fireEvent("initialized");this._mAdvancedAreaFilterFlat=this._getAllFilterItemsFlat();this._oInitializedDeferred.resolve()};L.prototype.getInitializedPromise=function(){return this._oInitializedDeferred.promise};L.prototype._initializeVariantManagement=function(){this._createVisibleFilters();if(this._oVariantManagement&&this.getPersistencyKey()){if(this._isTINAFScenario()){this._oVariantManagement.initialise(this._initialiseVariants,this)}}else{this._fireInitialiseEvent()}};L.prototype._fireInitialiseEvent=function(){try{this.fireEvent("initialise")}catch(e){v.error("error during initialise event handling - "+e.message)}this._bIsInitialized=true;this.fireAssignedFiltersChanged()};L.prototype._initialiseVariants=function(){this._fireInitialiseEvent();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false)}};L.prototype.fireAfterVariantLoad=function(e,t){this._aAdaptFilterItems=[];this._oSelectedVariantBase=null;var i={context:e,executeOnSelect:t};try{this.fireEvent("afterVariantLoad",i)}catch(e){v.error("error during 'afterVariantLoad' event handling - "+e.message)}};L.prototype.fireBeforeVariantSave=function(e){var t={context:e};var i=this._getConsiderFilterChanges();if(e){this._setConsiderFilterChanges(false)}this.fireEvent("beforeVariantSave",t);if(e){this._setConsiderFilterChanges(i)}};L.prototype.destroyFilterGroupItems=function(){var e=this.getFilterGroupItems();this._destroyItems(e);return this};L.prototype.destroyFilterItems=function(){var e=this.getFilterItems();this._destroyItems(e);return this};L.prototype.removeAllFilterItems=function(){var e,t=this.getFilterItems();if(t&&t.length){for(e=0;e<t.length;e++){this.removeFilterItem(t[e])}}return t};L.prototype.removeAllFilterGroupItems=function(){var e,t=[],i=this.getFilterGroupItems();if(i&&i.length){for(e=0;e<i.length;e++){t.push(i[e]);this.removeFilterGroupItem(i[e])}}return t};L.prototype.removeAllFilters=function(){this.removeAllFilterItems&&this.removeAllFilterItems();this.removeAllFilterGroupItems();this.removeBasicSearch()};L.prototype.removeBasicSearch=function(){this.setBasicSearch(null)};L.prototype.getAllFilterItems=function(e){var t,i=null;var r=[];var a,n;if(!e){this._ensureFilterLoaded(null)}if(this._mAdvancedAreaFilter){for(i in this._mAdvancedAreaFilter){if(i){a=this._mAdvancedAreaFilter[i];if(a.items){for(t=0;t<a.items.length;t++){n=a.items[t];if(n&&n.filterItem&&n.filterItem.getVisible()){if(e){if(n.filterItem.getVisibleInFilterBar()||this._checkIfFilterHasValue(n.filterItem.getName())||n.filterItem.data("isCustomField")&&this._checkIfCustomControlFilterHasValue(n)){r.push(n.filterItem)}}else{r.push(n.filterItem)}}}}}}}return r};L.prototype._checkIfFilterHasValue=function(e){return false};L.prototype._checkIfCustomControlFilterHasValue=function(e){return false};L.prototype._clearErrorState=function(){this._resetFiltersInErrorValueState()};L.prototype.getAggregation=function(e){if(e=="filterGroupItems"&&!this.__bDeleteMode){this._ensureFilterLoaded(null)}return a.prototype.getAggregation.apply(this,arguments)};L.prototype._getFilterInformation=function(){return[]};L.prototype._isFilterBarContext=function(){return true};L.prototype._createVisibleFilters=function(){this._getFilters()};L.prototype._getFilters=function(){var e=[],t=this._oFilterProvider&&this._oFilterProvider.getModel()&&this._oFilterProvider.getModel().getData();if(t){e=Object.keys(t).filter(function(e){return this._checkIfFilterHasValue(e)}.bind(this))}this._aFields=this._getFilterInformation();var i,r;if(this._aFields&&this._aFields.length>0){if(!this._mAdvancedAreaFilter){this._mAdvancedAreaFilter={};if(!this.getAdvancedMode()){this._mAdvancedAreaFilter[L.INTERNAL_GROUP]={};this._mAdvancedAreaFilter[L.INTERNAL_GROUP].filterItem=null;this._mAdvancedAreaFilter[L.INTERNAL_GROUP].items=null}}for(i=0;i<this._aFields.length;i++){r=this._aFields[i];if(r.groupName!==L.INTERNAL_GROUP){if(!this._mAdvancedAreaFilter[r.groupName]){this._mAdvancedAreaFilter[r.groupName]={};this._mAdvancedAreaFilter[r.groupName].groupTitle=r.groupTitle;this._mAdvancedAreaFilter[r.groupName].filterItem=null;this._mAdvancedAreaFilter[r.groupName].items=[]}}if(r.visibleInAdvancedArea||r.groupName===L.INTERNAL_GROUP||e.includes(r.name)){this._instanciateFilterItem(r)}}}};L.prototype.isVisibleInFilterBarByName=function(e){var t,i=this._getFilterMetadata(e);if(i&&i.factory){if(i.hasOwnProperty("visibleInAdvancedArea")&&i.visibleInAdvancedArea||i.groupName===L.INTERNAL_GROUP){return true}}else{t=this.determineFilterItemByName(e);if(t){return t.getVisibleInFilterBar()}}return false};L.prototype._getFilterMetadata=function(e){if(this._aFields){for(var t=0;t<this._aFields.length;t++){if(this._aFields[t].fieldName===e){return this._aFields[t]}}}return null};L.prototype.getNonVisibleCustomFilterNames=function(){if(this._aFields.length>0){return this._getLazyNonVisibleCustomFilterNames()}else{return this._getNonVisibleCustomFilterNames()}};L.prototype._getLazyNonVisibleCustomFilterNames=function(){var e=this,t=[];this._aFields.forEach(function(i){if(i.factory){if(i.isCustomFilterField&&!i.visibleInAdvancedArea){t.push(i.fieldName)}}else if(e._isNonVisibleCustomFilterNamesByName(i.fieldName,i.groupName)){t.push(i.fieldName)}});return t};L.prototype._isNonVisibleCustomFilterNamesByName=function(e,t){var i,r;if(this._mAdvancedAreaFilter&&this._mAdvancedAreaFilter[t]&&this._mAdvancedAreaFilter[t].items){for(i=0;i<this._mAdvancedAreaFilter[t].items.length;i++){r=this._mAdvancedAreaFilter[t].items[i];if(r.filterName&&r.filterItem.getName()===e){return this._isNonVisibleCustomFilterNamesByFilter(r.filterItem)}}}return false};L.prototype._isNonVisibleCustomFilterNamesByFilter=function(e){if(e.data("isCustomField")&&!e.getVisibleInFilterBar()){return true}return false};L.prototype._getNonVisibleCustomFilterNames=function(){var e=this,t=[],i=this.getAllFilterItems();if(i){i.forEach(function(i){if(e._isNonVisibleCustomFilterNamesByFilter(i)){t.push(i.getName())}})}return t};L.prototype._ensureFilterLoaded=function(e){var t,i,r;if(this._aFields&&this._aFields.length>0){for(i=0;i<this._aFields.length;i++){r=this._aFields[i];if(!r.factory){continue}if(e){for(t=0;t<e.length;t++){if(r.fieldName===e[t].name){if(r.groupName===e[t].group){this._instanciateFilterItem(r);break}else if(r.groupEntityType===e[t].group){this._instanciateFilterItem(r)}}}}else{this._instanciateFilterItem(r)}}if(!e){this._aFields=[]}this._mAdvancedAreaFilterFlat=this._getAllFilterItemsFlat()}};L.prototype._instanciateFilterItem=function(e){var t=e.factory;if(t){delete e.factory;t.call(e)}};L.prototype._destroyItems=function(e){if(e&&e.length){for(var t=0;t<e.length;t++){e[t].destroy()}}};L.prototype._reapplyVisibility=function(e,t){var i,r=null;var a;var n=[];if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){var s=this._mAdvancedAreaFilter[r];if(s&&s.items){for(i=0;i<s.items.length;i++){a=s.items[i];if(a&&a.filterItem){this._setPersVisibility(e,a.filterItem,n,t)}}}}}}return n};L.prototype._setPersVisibility=function(e,t,i,r){var a,n;if(t&&!t.getHiddenFilter()){a=t.getGroupName();n=this._checkForFilterInfo(e,t);if(this._isTINAFScenario()){if(n){t.setVisibleInFilterBar(n.visibleInFilterBar);if(n.hasOwnProperty("visible")){t.setVisible(n.visible)}}else{t.setVisibleInFilterBar(false)}}else{if(n&&n.visibleInFilterBar!==undefined){t.setVisibleInFilterBar(n.visibleInFilterBar)}else{if(a!==L.INTERNAL_GROUP&&n&&n.group===a){t.setVisibleInFilterBar(n!==null)}}}if(t){var s=this.determineControlByFilterItem(t,true);if(!r&&s&&s.getValueState&&s.getValueState()!==R.None){s.setValueState(R.None)}if(n&&n.hasOwnProperty("partOfCurrentVariant")&&!n.partOfCurrentVariant){i.push(t)}}}};L.prototype._checkForFilterInfo=function(e,t){var i,r,a=t.getName(),n=[t.getGroupName(),t.getEntitySetName(),t.getEntityTypeName()];var s=[];if(e&&e.length){for(i=0;i<e.length;i++){if(e[i].name===a){if(n.indexOf(e[i].group)>-1){s.push(e[i])}}}}if(s.length===1){return s[0]}else if(s.length>1){for(r=0;r<n.length;r++){for(i=0;i<s.length;i++){if(s[i].group===n[r]){return s[i]}}}}return null};L.prototype._createVariantManagement=function(){var e=new m(this.getId()+"-variant",{});var t=new c({type:"filterBar",keyName:"persistencyKey"});t.setControl(this);e.addPersonalizableControl(t);e.initialise(function(){},this);e.addStyleClass("sapUiCompFilterBarMarginLeft");return e};L.prototype.fireAssignedFiltersChanged=function(){this.fireEvent("assignedFiltersChanged")};L.prototype.retrieveFiltersWithValuesAsText=function(){var e,t,i=this.retrieveFiltersWithValues(),r,a=this.getBasicSearchValue();if(a&&i){i.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"))}if(!i||i.length===0){e=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO")}else if(i&&i.length===1){if(!this._isPhone()){e=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER",[i.length,i[0]])}else{e=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_MOBILE",[i.length])}}else{if(!this._isPhone()){r=Math.min(5,i.length);t="";for(var n=0;n<r;n++){t+=i[n];if(n<r-1){t+=", "}}e=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS",[i.length,t]);if(r<i.length){e+=", ..."}}else{e=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[i.length])}}return e};L.prototype.retrieveFiltersWithValuesAsTextExpanded=function(){var e,t="",i=this.retrieveFiltersWithValues(),r=this.getBasicSearchValue(),a=this.retrieveNonVisibleFiltersWithValues();if(a.length>0){t=" "+this._oRb.getText("FILTER_BAR_ASSIGNED_HIDDEN_FILTERS",[a.length])}if(r&&i){i.splice(0,0,this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_SEARCH_TERM"))}if(i.length===0){e=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_ZERO")}else if(i.length===1){if(!this._isPhone()){e=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_EXPANDED",[i.length]);e+=t}else{e=this._oRb.getText("FILTER_BAR_ASSIGNED_ONE_FILTER_MOBILE",[i.length]);e+=t}}else{if(!this._isPhone()){e=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_EXPANDED",[i.length]);e+=t}else{e=this._oRb.getText("FILTER_BAR_ASSIGNED_FILTERS_MOBILE",[i.length]);e+=t}}return e};L.prototype.retrieveFiltersWithValues=function(){var e,t=[];var i=this._getFiltersWithValues();if(i){for(e=0;e<i.length;e++){if(i[e].getHiddenFilter()){continue}if(i[e].getVisible()&&i[e].getPartOfCurrentVariant()){t.push(i[e].getLabel())}}}return t};L.prototype.retrieveNonVisibleFiltersWithValues=function(){var e,t=[],i,r=this._getFiltersWithValues();if(r){for(e=0;e<r.length;e++){i=r[e];if(i.getHiddenFilter()){continue}if(i.getVisible()&&!i.getVisibleInFilterBar()&&i.getPartOfCurrentVariant&&i.getPartOfCurrentVariant()){t.push(i.getLabel())}}}return t};L.prototype._getFiltersWithValues=function(){if(this._fRegisterGetFiltersWithValues){try{return this._fRegisterGetFiltersWithValues()}catch(e){v.error("callback for obtaining the filter count throws an exception")}}return null};L.prototype._getFiltersWithValuesCount=function(){var e=0;var t=this.retrieveFiltersWithValues();e=t.length;if(this._oBasicSearchField&&this._oBasicSearchField.getValue&&this._oBasicSearchField.getValue()){e++}return e};L.prototype._checkFilterForValue=function(e,t){var i;if(e){for(i=0;i<e.length;i++){if(e[i]===t){return true}}}return false};L.prototype._hasMandatoryFields=function(){return this.getFilterGroupItems().some(function(e){return e.getMandatory()})};L.prototype._toggleHideShow=function(){if(this._hasAnyVisibleFiltersOnFB()){this.setFilterBarExpanded(!this.getFilterBarExpanded())}if(this.isPropertyInitial("showAllFilters")){this.setShowAllFilters(this._hasMandatoryFields())}};L.prototype._updateHeaderTitle=function(){const e=this.getHeader(),t=this.getAggregation("_headerTitle");if(!t){return}t.setVisible(!!e);t.setText(e);t.setLevel(this.getHeaderLevel())};L.prototype._updateToolbarText=function(){if(this.bPreventUpdateToolbarText){return}var e=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS":"FILTER_BAR_ACTIVE_FILTERS";var t=this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_ZERO":"FILTER_BAR_ACTIVE_FILTERS_ZERO";var i=this._getFiltersWithValuesCount();var r=i?this._oRb.getText(e,[i]):this._oRb.getText(t);this._getFiltersButton().setText(r)};L.prototype._selectionChangedInFilterDialogByValue=function(e,t){t.setVisibleInFilterBar(e);if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}this._bDirtyViaDialog=true;if(e){this._aAddedFilters.push(t)}else{this._bFilterRemoved=true}this._oFilterToFocus=this._calculateFilterToFocus(t)};L.prototype._onLocalizationChanged=function(){this._oRb=i.getResourceBundleFor("sap.ui.comp");this.destroyAggregation("_searchButton");this.destroyAggregation("_hideShowButton");this.destroyAggregation("_clearButton");this.destroyAggregation("_restoreButton");this.destroyAggregation("_filtersButton");this.destroyAggregation("_showAllFiltersButton");this._createButtons();this.invalidate()};L.prototype._calculateFilterToFocus=function(e){const t=this._oAdaptFiltersDialogModel.getProperty("/items");if(this._aAddedFilters.length===0){if(this._bFilterRemoved){this._bFilterRemoved=false;return this._retrieveVisibleAdvancedItems()[0]?.control}else{return null}}if(this._bFilterRemoved){this._bFilterRemoved=false;return this._oFilterToFocus}if(this._aAddedFilters.length===1){return this._aAddedFilters[0]}const i=t.findIndex(e=>e.name===this._oFilterToFocus.getName());const r=t.findIndex(t=>t.name===e.getName());return r<i?e:this._oFilterToFocus};L.prototype._onLiveChangeValidateSymbols=function(e){var t=new RegExp("[\\w][*][\\w]"),i=new RegExp("[+]"),r=e.getSource(),a=r.getValue(),n=t.test(a)||i.test(a);this._onSymbolsValidationSetValueState.call(this,n,r)};L.prototype._onSymbolsValidationSetValueState=function(e,t){var i=t._oValueStateMessage,r="sapMSFContentWrapperWarning";if(e&&!t.hasStyleClass(r)&&t.setValueState===undefined){t.addStyleClass(r);t.getValueState=function(){return R.Warning};i.open()}else if(!e&&t.hasStyleClass(r)&&t.setValueState===undefined){t.getValueState=function(){return R.None};i.close();t.removeStyleClass(r)}else if(e&&t.getValueState&&t.getValueState()===R.None){t.setValueState(R.Warning);t.setValueStateText(D)}else if(!e&&t.getValueState()===R.Warning){t.setValueState(R.None)}};L.prototype._mandatoryFilterChange=function(e){if(!e){return}var t=e.getParameters();if(!t||!t.oSource){return}var i=this._determineByControl(t.oSource);if(i){this._mandatoryFilterItemChange(i.filterItem)}};L.prototype._mandatoryFilterItemChange=function(e){if(e){if(!e.getMandatory()){return}var t=this._hasFilterValue(e);if(!e.getVisibleInFilterBar()&&!t){e.setVisibleInFilterBar(true)}}};L.prototype._isPhone=function(){return!!g.system.phone};L.prototype._isTablet=function(){return!!(g.system.tablet&&!g.system.desktop)};L.prototype.fireSearch=function(e){if(this._bOKFiltersDialogTriggered&&this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.close()}else if(this._oAdaptFiltersDialog){this._bEnterPressedLeadsToSearch=true}this.fireEvent("search",e)};L.prototype._variantSave=function(e){this._oVariant={};this.fireBeforeVariantSave()};L.prototype._afterVariantSave=function(e){this._aOrderedFilterItems=this._aAdaptFilterItems;this._aAdaptFilterItems=[];this.fireAfterVariantSave()};L.prototype._filterSetInErrorState=function(e){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialog.isOpen()){if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}this._bDirtyViaDialog=true}};L.prototype._cancelFilterDialog=function(e){if(e&&this._oVariantManagement){this._bDirtyViaDialog=this._oVariantManagement._bSaveCanceled}if(!this.getPersistencyKey()&&this.getUseSnapshot()===false){this.fireCancel();return}if(this._oInitialVariant&&this._oInitialVariant.content&&this._bDirtyViaDialog){var t=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(t);this.applyVariant(this._oInitialVariant.content,"CANCEL");if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantKey(this._oInitialVariant.key)}this._oVariantManagement.currentVariantSetModified(this._oInitialVariant.modified)}this.fireCancel()}};L.prototype._resetFiltersInErrorValueState=function(){var e;e=this._retrieveCurrentSelectionSet(true,true);e.forEach(function(e){if(e.control&&e.control.setValueState&&e.control.getValueState){if(e.control.getValueState()===R.Error){if(e.control.isA("sap.m.DynamicDateRange")){e.control.setValue(null)}else if(e.control.setValue){e.control.setValue("")}e.control.setValueState(R.None)}}})};L.prototype.setContentWidth=function(e){if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentWidth(e+"px")}};L.prototype.setContentHeight=function(e){if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.setContentHeight(e+"px")}};L.prototype.addAdaptFilterDialogCustomContent=function(e){this._mCustomViewInfo={item:e.item,search:e.search,selectionChange:e.selectionChange,filterSelect:e.filterSelect,content:e.content}};L.prototype._createStructureForAdaptFiltersDialog=function(){var e,t,i={filtersOnFilterBar:{},allFilters:[]};var r,a=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();if(this._mAdvancedAreaFilter){for(var n in this._mAdvancedAreaFilter){if(n){e=this._mAdvancedAreaFilter[n];if(e.items){for(var s=0;s<e.items.length;s++){t=e.items[s];r=this._checkFilterForValue(a,t.filterItem);if(t.filterItem.getVisibleInFilterBar()){i.filtersOnFilterBar[t.filterItem.getName()]=t.filterItem}var o=t.filterItem.getGroupName()?t.filterItem.getGroupName():L.INTERNAL_GROUP;var l=o===L.INTERNAL_GROUP?this._oRb.getText("FILTER_BAR_BASIC_GROUP"):t.filterItem.getGroupTitle();var h=t.filterItem.getControlTooltip()?t.filterItem.getControlTooltip():"";i.allFilters.push({name:t.filterItem.getName(),label:t.filterItem.getLabel(),group:o,groupLabel:l,tooltip:h,visibleInDialog:t.filterItem.getVisible(),filterItem:t.filterItem,active:r,required:t.filterItem.getMandatory()})}}}}if(i.allFilters.length>0){var d=[],u=this._aAdaptFilterItems.length>0?this._aAdaptFilterItems:this._aOrderedFilterItems;if(u.length>0){u.forEach(function(e,t){d[e.name]=t});i.allFilters.sort(function(e,t){return d[e.name]-d[t.name]})}}}return i};L.prototype._getAllFilterItemsFlat=function(){var e,t,i,r=[];if(this._mAdvancedAreaFilter){for(var a in this._mAdvancedAreaFilter){if(a){e=this._mAdvancedAreaFilter[a];if(e.items){for(var n=0;n<e.items.length;n++){t=e.items[n];i=t.filterItem;var s=i.getGroupName()?i.getGroupName():L.INTERNAL_GROUP;var o=s===L.INTERNAL_GROUP?this._oRb.getText("FILTER_BAR_BASIC_GROUP"):i.getGroupTitle();var l=i.getControlTooltip()?i.getControlTooltip():"";r.push({name:i.getName(),label:i.getLabel(),group:s,groupLabel:o,tooltip:l,visibleInDialog:i.getVisible(),filterItem:i,required:i.getMandatory()})}}}}if(r.length>0){var h=[],d=this._aOrderedFilterItems;d.forEach(function(e,t){h[e.name]=t});r.sort(function(e,t){return h[e.name]-h[t.name]})}}return r};L.prototype._restoreControls=function(e,t){var i,r;if(this._fRegisteredFilterChangeHandlers){this.detachFilterChange(this._fRegisteredFilterChangeHandlers);this._fRegisteredFilterChangeHandlers=null}if(this._mAdvancedAreaFilter){for(var a in this._mAdvancedAreaFilter){if(a){i=this._mAdvancedAreaFilter[a];if(i.items){for(var n=0;n<i.items.length;n++){r=i.items[n];if(r.filterItem&&!r.filterItem.getHiddenFilter()&&r.control){if(r.contentReplaced){r.contentReplaced=undefined;var s=r.filterItem._getControl();if(s&&s.getValueState){if(t&&s.getValueState()!=r.control.getValueState()){r.control.setValueState(s.getValueState())}}s.destroy();r.filterItem._oLabel.setLabelFor&&r.filterItem._oLabel.setLabelFor(r.control);r.filterItem.setControl(r.control);if(this._isPhone()||this._isTablet()){r.control.sName=r.filterItem.getName();r.control._onAfterInputRenderingDelegate={onAfterRendering:function(e){this._applyInputModeAttribute(e.srcControl,e.srcControl.sName)},sName:r.filterItem.getName()};r.control.addDelegate(r.control._onAfterInputRenderingDelegate,this)}}r.filterItem.detachChange(e)}}}}}}};L.prototype._expandGroup=function(e){if(this._oAdaptFiltersDialog&&this._oAdaptFiltersDialogModel&&this._oAdaptFiltersPanel&&e&&e.filterItem){var t=e.filterItem.getGroupName()?e.filterItem.getGroupName():L.INTERNAL_GROUP;var i=this._oAdaptFiltersDialogModel.getData().itemsGrouped;for(var r=0;r<i.length;r++){if(i[r].group===t){for(var a=0;a<i[r].items.length;a++){if(i[r].items[a].name===e.filterItem.getName()){this._oAdaptFiltersPanel.setGroupExpanded(i[r].items[a].group,true);return}}return}}}};var P,O;L.prototype._getEntitiesLazy=function(){if(P&&O){return Promise.resolve()}this.setBusy(true);return i.load("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder","sap/ui/mdc/p13n/panels/AdaptFiltersPanel"],function(t,i){P=t;O=i;e();this.setBusy(false)}.bind(this))}.bind(this))}.bind(this))};L.prototype._filtersButtonPressed=function(){this._getFiltersButton().focus();this.showAdaptFilterDialog()};L.prototype._checkAssignedFilters=function(){if(this._oAdaptFiltersDialog){var e=this.getAllFiltersWithValues?this.getAllFiltersWithValues():this._getFiltersWithValues();var t=this._oAdaptFiltersDialogModel.getData().items;for(var i=0;i<t.length;i++){if(t[i].hasOwnProperty("filterItem")){var r=this._checkFilterForValue(e,t[i].filterItem);if(t[i].active!==r){t[i].active=r}}}}};L.prototype.showAdaptFilterDialogForKeyUser=function(e,t){this._bFiltersDialogForKeyUser=true;this._fGetDataForKeyUser=t;return this.showAdaptFilterDialog().then(function(){this._oAdaptFiltersDialog._oPopup&&this._oAdaptFiltersDialog._oPopup.addStyleClass(e);P.addRTACustomFieldButton(this._oAdaptFiltersDialog._oPopup)}.bind(this))};L.prototype._createKeyUserChange=function(){var e=[];if(this._bOKFiltersDialogTriggered&&this._oVariantManagement&&this._oVariantManagement.isA("sap.ui.comp.smartvariants.SmartVariantManagement")&&this._oVariantManagement.getVisible()&&this._oVariantManagement._getPersoController()){e=[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]}return e};L.prototype.showAdaptFilterDialog=function(e){return new Promise(function(t){this._getEntitiesLazy().then(function(){var r;if(!this._oAdaptFiltersDialog){r=new A;r.setSizeLimit(0);var a=function(e,t){for(var i=0;i<e.length;i++){if(e[i].group===t){var r=e[i].items;for(var a=0;a<r.length;a++){if(r[a].filterItem&&r[a].filterItem.getVisible()){if(!e[i].groupVisible){e[i].groupVisible=true}return}}if(e[i].groupVisible){e[i].groupVisible=false}return}}};var n=function(e){if(e&&e.oSource&&e.oSource.isA("sap.ui.comp.filterbar.FilterItem")){var t=e.getParameter("propertyName");if(this._oAdaptFiltersDialogModel&&t){var i=this._oAdaptFiltersDialogModel.getData().items;for(var r=0;r<i.length;r++){if(i[r].hasOwnProperty("filterItem")&&i[r].filterItem===e.oSource){if(t==="visible"){var n=e.oSource.getVisible();if(i[r].visibleInDialog!=n){i[r].visibleInDialog=n;a(this._oAdaptFiltersDialogModel.getData().itemsGrouped,i[r].group);this._oAdaptFiltersDialogModel.checkUpdate();break}}else if(t==="visibleInFilterBar"){i[r].visible=e.oSource.getVisibleInFilterBar();this._oAdaptFiltersDialogModel.checkUpdate();break}}}}}}.bind(this);this._ensureFilterLoaded(null);var s=this._createStructureForAdaptFiltersDialog();var o=this;var l=P.prepareAdaptationData(s.allFilters,function(e,t){V(e,t);var i=true;if(!t.filterItem||t.filterItem.getHiddenFilter()){o._mAdvancedAreaHiddenFilters.push(e);i=false}e.visible=!!s.filtersOnFilterBar[t.name];return i},true);P.sortP13nData({visible:"visible",position:"position"},l.items);this._oAdaptFiltersDialogModel=new A;this._oAdaptFiltersDialogModel.setSizeLimit(1e3);this._oAdaptFiltersDialogModel.setData(l);this._mAdaptFiltersDialogInitialItemsOrder=[].concat(this._oAdaptFiltersDialogModel.getData().items,this._mAdvancedAreaHiddenFilters);var h=this._oAdaptFiltersDialogModel.getData().items;for(var d=0;d<h.length;d++){if(h[d].hasOwnProperty("filterItem")){h[d].filterItem.attachChange(n)}}this._fRegisteredFilterChangeHandlers=function(e){this._mandatoryFilterChange(e)}.bind(this);this.attachFilterChange(this._fRegisteredFilterChangeHandlers);var u=function(e,t){if(e&&e.filterItem&&e.filterItem.getVisibleInFilterBar()!==t){this._selectionChangedInFilterDialogByValue(t,e.filterItem)}}.bind(this);var g=function(e){var t,i,r,a,n=e.getParameter("item"),s=e.getParameter("reason"),o=s==="Add"||s==="SelectAll"||s==="RangeSelect";if(s==="SelectAll"||s==="DeselectAll"){if(this._oAdaptFiltersPanel.getCurrentViewKey()===this._oAdaptFiltersPanel.GROUP_KEY){i=e.getParameter("item").group;r=this._oAdaptFiltersDialogModel.getProperty("/itemsGrouped").filter(function(e){return e.group===i})[0].items}else{r=this._oAdaptFiltersDialogModel.getProperty("/items")}for(t=0;t<r.length;t++){n=r[t];if(!o&&this._shouldBeVisible(n)){a="/items/"+t;this._oAdaptFiltersDialogModel.setProperty(a+"/visible",true)}else{u(n,o)}}}else if(s==="RangeSelect"&&n){if(this._oAdaptFiltersPanel.getCurrentViewKey()===this._oAdaptFiltersPanel.LIST_KEY){for(t=0;t<n.length;t++){var l=n[t];if(!o&&this._shouldBeVisible(l)){a="/items/"+t;this._oAdaptFiltersDialogModel.setProperty(a+"/visible",true)}else{u(l,o)}}}}else if((s==="Add"||s==="Remove")&&n){if(!o&&this._shouldBeVisible(n)){n.visible=true}else{u(n,o)}}else if(s==="Move"){this._bDirtyViaDialog=true;this._bMoveTriggered=true}this._oAdaptFiltersPanel.setP13nData(this._oAdaptFiltersDialogModel.getData())}.bind(this);var f=new O({enableReorder:true});f.getView(f.GROUP_KEY).getContent().attachChange(g);f.getView(f.LIST_KEY).getContent().attachChange(g);this._oAdaptFiltersPanel=f;f.setItemFactory(function(e){var t,i,a,n;n=e.getObject();if(!n){return undefined}a=this._determineItemByName(n.name,n.group);if(!a||!a.filterItem||!a.control){return undefined}t=a.control;if(!a.contentReplaced&&a.filterItem._getControl()===t){a.contentReplaced=true;const e={cloneChildren:true,cloneBindings:false};if(t.isA("sap.ui.comp.smartfilterbar.SFBMultiComboBox")){e.cloneBindings=true}else if(t.isA("sap.m.MultiComboBox")){e.cloneChildren=false;e.cloneBindings=true}i=t.clone("",[],e);a.filterItem._oLabel.setLabelFor&&a.filterItem._oLabel.setLabelFor(i);i.setModel(r);a.filterItem.setControl(i)}return t}.bind(this));this.fireFiltersDialogBeforeOpen({newDialog:true});if(this._mCustomViewInfo&&this._mCustomViewInfo.item&&this._mCustomViewInfo.item.getKey()){f.addCustomView(this._mCustomViewInfo);f.switchView(e?e:f.getDefaultView())}sap.ui.require(["sap/m/p13n/Popup"],function(e){var r=new e(this.getId()+"-adapt-filters",{panels:[f],title:this._oRb.getText(this._isNewFilterBarDesign()?"FILTER_BAR_ADAPT_FILTERS_DIALOG":"FILTER_BAR_ADV_FILTERS_DIALOG"),reset:this.getShowRestoreButton()&&!this._fGetDataForKeyUser?this._dialogRestore.bind(this):null,warningText:i.getResourceBundleFor("sap.m").getText("p13n.RESET_WARNING_TEXT"),close:function(e){if(e.getParameter("reason")==="Ok"){this._bOKFiltersDialogTriggered=true}else{this._dialogCancel(this._oAdaptFiltersDialog)}if(this._bOKFiltersDialogTriggered&&typeof this._clearErroneusControlValues==="function"){this._clearErroneusControlValues()}this._restoreControls(n,!this._bOKFiltersDialogTriggered);if(!this._bOKFiltersDialogTriggered){this._cancelFilterDialog(false)}if(this._bOKFiltersDialogTriggered){this._aAdaptFilterItems=this._oAdaptFiltersDialogModel.getProperty("/items");this._mAdvancedAreaFilterFlat=this._aAdaptFilterItems;this._aAdaptFilterItems=[].concat(this._aAdaptFilterItems,this._mAdvancedAreaHiddenFilters);this._mAdvancedAreaFilter=this._mapReorderedFilterItemsInGroups(this._aAdaptFilterItems);this._bMoveTriggered=false;this._mAdvancedAreaHiddenFilters=[]}else{this._aAdaptFilterItems=[]}if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}this._applyAttributes();this._oAdaptFiltersDialogModel=null;this._oAdaptFiltersPanel=null;this._oVariant={};this._oInitialVariant=null;this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null;this._fGetDataForKeyUser=null;if((this._bOKFiltersDialogTriggered&&this._bDirtyViaDialog||this._bResetFiltersDialogTriggered)&&!this._bEnterPressedLeadsToSearch){if(!this.isLiveMode||!this.isLiveMode()){this.fireFilterChange()}}this._bEnterPressedLeadsToSearch=false;this._bResetFiltersDialogTriggered=false;this.fireFiltersDialogClosed({context:this._bOKFiltersDialogTriggered?"SEARCH":"CANCEL"});setTimeout(function(){if(!this._oFilterToFocus||this._bFiltersDialogForKeyUser){this._bFiltersDialogForKeyUser=false;return}this._oFilterToFocus.getControl?this._oFilterToFocus.getControl()?.focus():this._oFilterToFocus.focus()}.bind(this),301)}.bind(this)});r._getIdPrefix=function(){return"-dialog"};this._oAdaptFiltersDialog=r;this._oAdaptFiltersDialog.setParent(this);this._oVariant.content=this.fetchVariant();if(this._oVariantManagement){this._oVariant.key=this._oVariantManagement.getSelectionKey();this._oVariant.modified=this._oVariantManagement.currentVariantGetModified()}this._oInitialVariant={};V(this._oInitialVariant,this._oVariant);this._bOKFiltersDialogTriggered=false;this._bDirtyViaDialog=false;this._bEnterPressedLeadsToSearch=false;if(this.$().closest(".sapUiSizeCompact").length>0){this._oAdaptFiltersDialog.addStyleClass("sapUiSizeCompact")}this._oAdaptFiltersDialog.isPopupAdaptationAllowed=function(){return false};const a={enableReset:this._hasChanges(),confirm:{text:this._oRb.getText("FILTER_BAR_OK")}};this._oAdaptFiltersDialog.open(undefined,a);this._aAddedFilters=[];this._oFilterToFocus=undefined;t()}.bind(this));f.setP13nModel(this._oAdaptFiltersDialogModel);return}t()}.bind(this))}.bind(this))};L.prototype._hasChanges=function(){return!!this._oVariantManagement?.currentVariantGetModified()};L.prototype._mapReorderedFilterItemsInGroups=function(e){var t=[];e.forEach(function(e){if(!t[e.group]){t[e.group]={};t[e.group].filterItem=null;t[e.group].items=[]}if(!t[e.group].items){t[e.group].items=[]}t[e.group].items.push(this._mAdvancedAreaFilter[e.group].items.find(function(t){return t.filterItem===e.filterItem}));if(!t[e.group].filterItem){t[e.group].filterItem=e.filterItem}}.bind(this));return t};L.prototype._reorderItemsInAdvancedAreaFilter=function(){var e,t;e=this._createStructureForAdaptFiltersDialog();t=e.allFilters;this._mAdvancedAreaFilterFlat=t;this._mAdvancedAreaFilter=this._mapReorderedFilterItemsInGroups(t)};L.prototype.isDialogOpen=function(){return this._oAdaptFiltersDialog};L.prototype._dialogCancel=function(e){if(e){this._bOKFiltersDialogTriggered=false;this.fireFiltersDialogCancel()}};L.prototype._dialogRestore=function(){this.reset();if(this._oVariantManagement&&this._oVariantManagement.getVisible()&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(false)}if(this._oAdaptFiltersPanel){var e=[],t=this._oAdaptFiltersDialogModel.getData();if(this._bMoveTriggered&&this._mAdaptFiltersDialogInitialItemsOrder.length>0){this._mAdaptFiltersDialogInitialItemsOrder.forEach(function(t,i){e[t.name]=i});t.items.sort(function(t,i){return e[t.name]-e[i.name]})}else{this._aOrderedFilterItems.forEach(function(t,i){e[t.name]=i});t.items.sort(function(t,i){return e[t.name]-e[i.name]});P.sortP13nData({visible:"visible",position:"position"},t.items)}this._oAdaptFiltersPanel.setP13nData(t)}this._bDirtyViaDialog=false;this._bResetFiltersDialogTriggered=true};L.prototype._getSearchButton=function(){return this.getAggregation("_searchButton")};L.prototype._getHideShowButton=function(){return this.getAggregation("_hideShowButton")};L.prototype._getClearButton=function(){return this.getAggregation("_clearButton")};L.prototype._getRestoreButton=function(){return this.getAggregation("_restoreButton")};L.prototype._getFiltersButton=function(){return this.getAggregation("_filtersButton")};L.prototype._getShowAllFiltersButton=function(){return this.getAggregation("_showAllFiltersButton")};L.prototype._createButtons=function(){const e=new s(this.getId()+"-btnGo",{visible:this.getShowGoOnFB(),text:this._oRb.getText("FILTER_BAR_GO"),type:N.Emphasized}).addStyleClass("sapUiCompFilterBarPaddingRightBtn");e.addEventDelegate({ontouchstart:()=>{this.bPreventUpdateToolbarText=true},ontouchend:()=>{this.bPreventUpdateToolbarText=false;this._updateToolbarText();this.fireAssignedFiltersChanged()}});b.addConfig(e,{event:"search",message:this._oRb.getText("FILTER_BAR_GO_BTN_SHORTCUT_HINT"),addAccessibilityLabel:true},this);e.attachPress(()=>{e.focus();this._searchFromFilterBar()});this.setAggregation("_searchButton",e);const t=new s(this.getId()+"-btnShowHide",{text:this._oRb.getText("FILTER_BAR_HIDE"),type:N.Transparent,enabled:false}).addStyleClass("sapUiCompFilterBarPaddingRightBtn");t.attachPress(()=>{this._toggleHideShow()});this.setAggregation("_hideShowButton",t);const i=new s(this.getId()+"-btnClear",{visible:this.getShowClearOnFB(),text:this._oRb.getText("FILTER_BAR_CLEAR"),type:N.Transparent,enabled:false}).addStyleClass("sapUiCompFilterBarPaddingRightBtn");i.attachPress(()=>{this.clear();if(this.isLiveMode&&this.isLiveMode()){this._searchFromFilterBar()}});this.setAggregation("_clearButton",i);const r=new s(this.getId()+"-btnRestore",{visible:this.getShowRestoreOnFB(),text:this._oRb.getText("FILTER_BAR_RESTORE"),type:N.Transparent,enabled:false}).addStyleClass("sapUiCompFilterBarPaddingRightBtn");r.attachPress(()=>{this.reset();if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(false)}});this.setAggregation("_restoreButton",r);const a=new s(this.getId()+"-btnFilters",{visible:this.getShowFilterConfiguration(),text:this._oRb.getText("FILTER_BAR_ACTIVE_FILTERS_ZERO"),type:N.Transparent,enabled:false});a.attachPress(()=>{this._filtersButtonPressed()});this.setAggregation("_filtersButton",a);const n=new s(this.getId()+"-btnShowAll",{text:this._oRb.getText("FILTER_BAR_VH_SHOW_ALL"),type:N.Transparent,press:this._toggleAllFilters.bind(this)});this.setAggregation("_showAllFiltersButton",n)};L.prototype._shouldSkipRenderButtons=function(){return this.getUseToolbar()};L.prototype._getButtons=function(){return[this.getAggregation("_searchButton"),this.getAggregation("_clearButton"),this.getAggregation("_restoreButton"),this.getAggregation("_filtersButton")]};L.prototype._createHeaderTitle=function(){const e=new l(`${this.getId()}-HeadText`,{level:this.getHeaderLevel()});e.addStyleClass("sapMH4Style");e.addStyleClass("sapUiCompSmartChartHeader");this.setAggregation("_headerTitle",e)};L.prototype._toggleAllFilters=function(){var e,t;this.setShowAllFilters(!this.getShowAllFilters());this._getShowAllFiltersButton().setVisible(!this.getShowAllFilters());if(!this._bDelegateAdded&&this.getFilterGroupItems()){e=this.getFilterGroupItems()[this._nMaxFiltersByDefault]._getControl();t={onAfterRendering:function(){e.focus()}};e.addDelegate(t,this);this._bDelegateAdded=true}};L.prototype._shouldSkipRenderFilters=function(e){return this.getIsRunningInValueHelpDialog()&&this._nMaxFiltersByDefault===e&&!this.getShowAllFilters()};L.prototype._shouldRenderAdvancedLayout=function(){return this.getAdvancedMode()&&!this.getIsRunningInValueHelpDialog()};L.prototype._createVariantLayout=function(){this._oVariantManagement=this._createVariantManagement();this.setAggregation("_variantManagement",this._oVariantManagement);if(this._possibleToChangeVariantManagement()){this._oVariantManagement.setVisible(false)}this._registerVariantManagement();return this._oVariantManagement};L.prototype._createToolbar=function(){const e=new d(`${this.getId()}-toolbar`);this._oToolbarSpacer=new u;this._oSeparator=(new C).addStyleClass("sapUiTinyMarginEnd");e.addContent(this.getAggregation("_headerTitle"));e.addContent(this._oVariantManagement);e.addContent(this._oSeparator);e.addContent(this._oToolbarSpacer);e.addContent(this._getSearchButton());e.addContent(this._getHideShowButton());e.addContent(this._getClearButton());e.addContent(this._getRestoreButton());e.addContent(this._getFiltersButton());e.addStyleClass("sapUiCompFilterBarToolbar");this.setAggregation("_toolbar",e)};L.prototype._replaceVariantManagement=function(e){if(this._oVariantManagement){this._unregisterVariantManagement();const e=this.getAggregation("_toolbar");if(e&&e.getContent(this._oVariantManagement)){e.removeContent(this._oVariantManagement)}this._oVariantManagement.destroy()}this._oVariantManagement=e;this._registerVariantManagement()};L.prototype._prepareFilterItemAndLabel=function(e){var t=e._getControl();if(!t){v.error("no Control obtained");return null}var i=e.getLabelControl(this.getId());if(!i){v.error("no Label obtained");return null}this._adaptGroupTitleForFilter(e);this._connectLabelAndControl(e,t,i)};L.prototype._connectLabelAndControl=function(e,t,i){if(t.setWidth){t.setWidth("100%")}if(!i){return}if(!i.hasStyleClass("sapUiCompFilterLabel")){i.addStyleClass("sapUiCompFilterLabel")}if(e&&t){i.setLabelFor(t)}if(e.getControlTooltip()&&t.setTooltip){t.setTooltip(e.getControlTooltip())}};L.prototype._groupsWithVisibleFilters=function(){var e,t,i=this._mAdvancedAreaFilter;if(this._mAdvancedAreaFilter&&Object.keys(this._mAdvancedAreaFilter).length>1){i={};for(var r in this._mAdvancedAreaFilter){if(r&&this._mAdvancedAreaFilter[r]&&this._mAdvancedAreaFilter[r].items){e=this._mAdvancedAreaFilter[r].items.length;for(var a=0;a<this._mAdvancedAreaFilter[r].items.length;a++){t=this._mAdvancedAreaFilter[r].items[a].filterItem;if(t&&(t.getHiddenFilter()||!t.getVisible())){e--}}if(e){i[r]={}}}}}return i};L.prototype._setTriggerFilterChangeState=function(e){this._triggerFilterChangeState=e};L.prototype._getTriggerFilterChangeState=function(){return this._triggerFilterChangeState};L.prototype._setConsiderFilterChanges=function(e){this._filterChangeSemaphore=e};L.prototype._getConsiderFilterChanges=function(){return this._filterChangeSemaphore};L.prototype.fireFilterChange=function(e){if(!this.bPreventUpdateToolbarText){this._updateToolbarText();this.fireAssignedFiltersChanged()}if(!this._getTriggerFilterChangeState()){return}if(this._getConsiderFilterChanges()&&this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){this._oVariantManagement.currentVariantSetModified(true)}if(this._oAdaptFiltersDialog&&!this._oAdaptFiltersDialog.isOpen()){return}if(this._oAdaptFiltersDialog){this._bDirtyViaDialog=true;this._checkAssignedFilters();this._oAdaptFiltersDialog.getResetButton?.()?.setEnabled(true)}this.fireEvent("filterChange",e)};L.prototype._notifyAboutChangedFilters=function(e,t){var i,r=this._determineByControl(t);if(e){i={added:t,filterItem:r}}else{i={deleted:t,filterItem:r}}this.fireFilterChange(i)};L.prototype._determineVariantFiltersInfo=function(e,t){var i;var r=null,a,n;var s=[];if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){if(this._mAdvancedAreaFilter[r].items){for(i=0;i<this._mAdvancedAreaFilter[r].items.length;i++){a=this._mAdvancedAreaFilter[r].items[i];if(e||a.filterItem.getVisible()){n={group:a.filterItem.getGroupName(),name:a.filterItem.getName(),partOfCurrentVariant:a.filterItem.getPartOfCurrentVariant(),visibleInFilterBar:a.filterItem.getVisibleInFilterBar(),visible:a.filterItem.getVisible()};if(t||this._considerFilter(n)){s.push(n)}}}}}}}return s};L.prototype.mergeVariant=function(e,t){var i={};V(i,t);i.filterbar=[];i.filterBarVariant={};V(i.filterbar,e.filterbar);V(i.filterBarVariant,e.filterBarVariant);if(t&&t.hasOwnProperty("version")){i.filterbar=this._mergeVariantFields(i.filterbar,t.filterbar);i.filterBarVariant=t.filterBarVariant}return i};L.prototype._mergeVariantFields=function(e,t){var i;t.forEach(function(t){for(i=0;i<e.length;i++){if(e[i].group===t.group&&e[i].name===t.name){e.splice(i,1);break}}});return e.concat(t)};L.prototype._isDeltaHandling=function(){return this.getDeltaVariantMode()};L.prototype._getStandardVariant=function(){return this._oVariantManagement.getStandardVariant(this)};L.prototype._considerFilter=function(e){if(!this._isDeltaHandling()){return true}var t=null;var i=this._getStandardVariant();if(i&&i.filterbar){for(var r=0;r<i.filterbar.length;r++){if(i.filterbar[r].group===e.group&&i.filterbar[r].name===e.name){t=i.filterbar[r];break}}}if(!t){if(!e.partOfCurrentVariant){return false}return true}if(t.partOfCurrentVariant!==e.partOfCurrentVariant||t.visibleInFilterBar!==e.visibleInFilterBar||t.visible!==e.visible){return true}return false};L.prototype._determineVisibility=function(e){var t=false;if(e){t=e.getVisible()&&(e.getVisibleInFilterBar()||this._checkIfFilterHasValue(e.getName()));t=t&&!e.getHiddenFilter()}return t};L.prototype._retrieveVisibleAdvancedItems=function(){var e,t=null,i;var r=[];if(this._mAdvancedAreaFilter){for(t in this._mAdvancedAreaFilter){if(t){if(this._mAdvancedAreaFilter[t]&&this._mAdvancedAreaFilter[t].items){for(e=0;e<this._mAdvancedAreaFilter[t].items.length;e++){i=this._mAdvancedAreaFilter[t].items[e];if(i){if(this._determineVisibility(i.filterItem)){r.push(i)}}}}}}}return r};L.prototype._retrieveCurrentSelectionSet=function(e,t){var i,r,a,n=[];var s=this._retrieveVisibleAdvancedItems();for(i=0;i<s.length;i++){r=s[i];if(r.control&&r.filterItem&&(t||!r.filterItem._isParameter())){if(e){a={name:s[i].filterItem.getName(),control:s[i].control}}else{a=s[i].control}n.push(a)}}return n};L.prototype.search=function(){this.fireSearch({selectionSet:this._retrieveCurrentSelectionSet(false),firedFromFilterBar:this._bSearchFiredFromFilterBar});this._bSearchFiredFromFilterBar=false;return true};L.prototype._searchFromFilterBar=function(){this._bSearchFiredFromFilterBar=true;this.search.apply(this,arguments)};L.prototype.clear=function(){var e={};e.selectionSet=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(e.selectionSet);this._clearErrorState();this.fireClear(e);this.fireAssignedFiltersChanged()};L.prototype._deleteValidatingTokenFlag=function(e){e.forEach(function(e){if(e.hasOwnProperty("__bValidatingToken")){delete e.__bValidatingToken}})};L.prototype.reset=function(){var e={};e.selectionSet=this._retrieveCurrentSelectionSet(false);this.fireReset(e);this._resetVariant()};L.prototype._resetVariant=function(){var e=null,t=null;this._resetFiltersInErrorValueState();var i=this._retrieveCurrentSelectionSet(false);this._deleteValidatingTokenFlag(i);if(this._oVariantManagement){var r=this._oVariantManagement.getSelectionKey()||this._oVariantManagement.getStandardVariantKey();if(r){e=this._oVariantManagement.getVariantContent(this,r);if(this._oVariant){this._oVariant.content=e;this._oVariant.modified=false;if(this.getPersistencyKey()&&this._oInitialVariant){this._oInitialVariant.content=e;this._oInitialVariant.modified=false;this._oInitialVariant.key=r}}if(!this.getPersistencyKey()&&this.getUseSnapshot()===undefined&&this._oInitialVariant&&this._oInitialVariant.content){t=this._oInitialVariant.content}if(e||t){this.applyVariant(e||t,"RESET")}if(this._oSelectedVariantBase&&this._isFilterBarContext()){this.applyVariant(this._oSelectedVariantBase,"RESET")}}}};L.prototype._removeValuesForNonPartOfCurrentVariants=function(e){};L.prototype._removeEmptyFilters=function(e){return e};L.prototype._applyVariant=function(e,t,i,r){var a,n=null,s,o=false,l=[];if(e){if(i){s=this._getTriggerFilterChangeState();this._setTriggerFilterChangeState(false)}this._setConsiderFilterChanges(false);a=e.filterBarVariant;n=e.filterbar;if(this._oFilterProvider){this._oFilterProvider._setSingleInputsTextArrangementData(JSON.parse(e.singleInputsTextArrangementData||"{}"));this._oFilterProvider._setInputsWithCompositeKeysData(JSON.parse(e.inputsWithCompositeKeysData||"{}"))}l=e.orderedFilterItems?JSON.parse(e.orderedFilterItems):[];if(!l.length){l=this._mAdvancedAreaFilterFlat}if(Array.isArray(n)&&n.length){this._ensureFilterLoaded(n.filter(function(e){return e.visibleInFilterBar}))}this._applyVariantFields(a,r);var h=this._reapplyVisibility(n,t==="CANCEL");this._removeValuesForNonPartOfCurrentVariants(h);if(this._oBasicSearchField&&this._oBasicSearchField.setValue){this._oBasicSearchField.setValue(e.basicSearch||"")}if(e.executeOnSelection){o=e.executeOnSelection}this._aOrderedFilterItems=l;this._reorderItemsInAdvancedAreaFilter();this.fireAfterVariantLoad(t,o);this._setConsiderFilterChanges(true);this.fireAssignedFiltersChanged();if(o||this.getLiveMode&&this.getLiveMode()){this._searchFromFilterBar()}else if(t!=="CANCEL"){this._clearErrorState()}if(i){this._setTriggerFilterChangeState(s)}if((!t||t==="RESET")&&this._isFilterBarContext()){this._oSelectedVariantBase=e}}};L.prototype._fetchVariantFiltersData=function(e){if(this._fRegisteredFetchData){try{return this._fRegisteredFetchData(e)}catch(e){v.error("callback for fetching data throws an exception")}}else{v.warning("no callback for fetch data supplied")}return null};L.prototype._applyVariantFields=function(e,t){if(this._fRegisteredApplyData){try{return this._fRegisteredApplyData(e,t)}catch(e){v.error("callback for applying data throws an exception")}}else{v.warning("no callback for apply data supplied")}};L.prototype._isStandardVariant=function(){var e=this.getCurrentVariantId();if(!e){return true}if(this._oVariantManagement){if(e===this._oVariantManagement.getStandardVariantKey()){return true}if(this._oVariantManagement._oStandardVariant===null){return true}}return false};L.prototype.isCurrentVariantExecuteOnSelectEnabled=function(){if(this._oVariantManagement&&!this._oVariantManagement.getInErrorState()){var e=this.getCurrentVariantId();if(!e){return this._oVariantManagement.getExecuteOnSelectForStandardVariant()}var t=this._oVariantManagement.getItemByKey(e);if(t){return t.getExecuteOnSelect()}}return false};L.prototype.fetchVariant=function(){var e,t={},i,r,a=[];if(this._isDeltaHandling()){if(!this._isStandardVariant()){t.version="V3"}}this.fireBeforeVariantFetch();e=this._determineVariantFiltersInfo(true,!t.version);t.filterbar=!e?[]:e;var n=function(e){e.forEach(function(e){a.push({name:e.name,group:e.group})})};if(this._aAdaptFilterItems&&this._aAdaptFilterItems.length>0){n(this._aAdaptFilterItems);t.orderedFilterItems=JSON.stringify(a)}else{if(this._aOrderedFilterItems.length>0){n(this._aOrderedFilterItems)}else{this._mAdvancedAreaFilterFlat=this._getAllFilterItemsFlat();n(this._mAdvancedAreaFilterFlat)}t.orderedFilterItems=JSON.stringify(a)}r=this._fetchVariantFiltersData(t.version);t.filterBarVariant=this._removeEmptyFilters(r);t.singleInputsTextArrangementData=JSON.stringify(this._oFilterProvider?this._oFilterProvider._getSingleInputsTextArrangementData():{});t.inputsWithCompositeKeysData=JSON.stringify(this._oFilterProvider?this._oFilterProvider._getInputsWithCompositeKeysData():{});i=this._getBasicSearchValue();if(i){t.basicSearch=i}if(this._oVariant&&this._oVariant.content){this._oVariant.content=t}if(!this._oSelectedVariantBase||this._oSelectedVariantBase===null){this._oSelectedVariantBase=t}return t};L.prototype.applyVariant=function(e,t,i){if(e.hasOwnProperty("version")){e=this.mergeVariant(this._getStandardVariant(),e,t)}this._applyVariant(e,t,i,e.version);this.invalidate()};L.prototype.determineMandatoryFilterItems=function(){var e;var t=[];var i=this._retrieveVisibleAdvancedItems();for(e=0;e<i.length;e++){if(i[e].filterItem.getMandatory()===true){if(i[e].control){t.push(i[e].filterItem)}}}return t};L.prototype.determineAsyncFilters=function(e){var t,i,r,a=[],n=this.getAllFilterItems(true);for(t=0;t<n.length;t++){r=n[t];i=this.determineControlByFilterItem(r,true);if(i&&i.isA("sap.m.ComboBox")&&i.getDomRef()!==null&&!r.data("isCustomField")){if(e.bAll){a.push(r)}else if(e.bNonMandatory&&!r.getMandatory()){a.push(r)}else if(e.bMandatory&&r.getMandatory()){a.push(r)}}}return a};L.prototype.determineControlByFilterItem=function(e,t){var i,r=null;var a,n;if(!e||!t&&e._isParameter()){return null}if(this._aBasicAreaSelection){for(i=0;i<this._aBasicAreaSelection.length;i++){a=this._aBasicAreaSelection[i];if(e===a.filterItem){return a.control}}}if(this._mAdvancedAreaFilter){for(r in this._mAdvancedAreaFilter){if(r){n=this._mAdvancedAreaFilter[r];if(n&&n.items){for(i=0;i<n.items.length;i++){a=n.items[i];if((t||!a.filterItem._isParameter())&&e===a.filterItem){return a.control}}}}}}return null};L.prototype.determineControlByName=function(e,t){var i=this._determineEnsuredItemByName(e,t);if(i&&i.filterItem&&!i.filterItem._isParameter()){return i.control}return null};L.prototype.determineLabelByName=function(e,t){var i=this._determineEnsuredItemByName(e,t);if(i&&i.filterItem){return i.filterItem._oLabel}return null};L.prototype._determineEnsuredItemByName=function(e,t){if(!t){t=this._determineGroupNameByName(e)}this._ensureFilterLoaded([{name:e,group:t}]);return this._determineItemByName(e,t)};L.prototype._determineGroupNameByName=function(e){if(this._aFields){for(var t=0;t<this._aFields.length;t++){if(this._aFields[t].fieldName===e){return this._aFields[t].groupName}}}var i=this._determineFilterItemByName(e);if(i){var r=i.getGroupName();if(r!==L.INTERNAL_GROUP){return r}}return null};L.prototype._determineItemByName=function(e,t){var i;var r,a;var n=t;if(!e){return null}if(!n){n=L.INTERNAL_GROUP}if(this._mAdvancedAreaFilter){a=this._mAdvancedAreaFilter[n];if(a&&a.items){for(i=0;i<a.items.length;i++){r=a.items[i];if(r&&r.filterItem&&r.filterItem.getName()===e){return r}}}}return null};L.prototype.determineFilterItemByName=function(e,t){var i;if(t){i=this._determineEnsuredItemByName(e,t)}else{i=this._determineEnsuredItemByName(e)}if(i&&i.filterItem){return i.filterItem}return null};L.prototype._determineFilterItemByName=function(e){var t,i;if(this._mAdvancedAreaFilter){for(t in this._mAdvancedAreaFilter){i=this._determineItemByName(e,t);if(i){return i.filterItem}}}return null};L.prototype._determineByControl=function(e){var t=null,i;if(this._mAdvancedAreaFilter){for(t in this._mAdvancedAreaFilter){if(t){var r=this._mAdvancedAreaFilter[t];if(r&&r.items){for(i=0;i<r.items.length;i++){if(r.items[i]&&r.items[i].control===e){return r.items[i]}}}}}}return null};L.prototype._applyAttributes=function(){if(this._isPhone()||this._isTablet()){var e=this.getAllFilterItems(true);if(e.length>0){for(var t=0;t<e.length;t++){var i=e[t],r=i._getControl(),a=i.getName();this._applyInputModeAttribute(r,a)}}}};L.prototype._applyInputModeAttribute=function(e,t){if(this._oFilterProvider&&this._oFilterProvider._aFilterBarNumericFieldMetadata&&this._oFilterProvider._aFilterBarNumericFieldMetadata.indexOf(t)!==-1){var i=e.getDomRef("inner");if(i){i.setAttribute("inputmode","decimal");i.setAttribute("pattern","[0-9]+([.,][0-9]+)?")}}};L.prototype._destroyLazyFilterControl=function(){var e,t;if(this._aFields&&this._aFields.length>0){if(this._aFields&&this._aFields.length>0){for(e=0;e<this._aFields.length;e++){t=this._aFields[e];if(t.factory){if(t.control){t.control.destroy()}}}}}};L.prototype._removeInputRenderingDelegate=function(){var e,t,i;if(this._mAdvancedAreaFilter){for(t in this._mAdvancedAreaFilter){if(t&&this._mAdvancedAreaFilter[t]&&this._mAdvancedAreaFilter[t].items){for(e=0;e<this._mAdvancedAreaFilter[t].items.length;e++){i=this._mAdvancedAreaFilter[t].items[e];if(i&&i.control&&i.control._onAfterInputRenderingDelegate){i.control.removeDelegate(i.control._onAfterInputRenderingDelegate)}}}}}};L.prototype._destroyFilterControls=function(){if(!this.getAdvancedMode()){this._destroyLazyFilterControl()}this._removeInputRenderingDelegate()};L.prototype._registerVariantManagement=function(){if(this._oVariantManagement){this._oVariantManagement.attachSave(this._variantSave,this);this._oVariantManagement.attachAfterSave(this._afterVariantSave,this)}};L.prototype._unregisterVariantManagement=function(){if(this._oVariantManagement){if(this._fInitialiseVariants){this._oVariantManagement.detachInitialise(this._fInitialiseVariants);this._fInitialiseVariants=null}this._oVariantManagement.detachSave(this._variantSave,this);this._oVariantManagement.detachAfterSave(this._afterVariantSave,this);if((!this.getUseToolbar()||this.getAdvancedMode())&&!this._oVariantManagement.getDomRef()){this._oVariantManagement.destroy()}}};L.prototype.showFilterDialog=function(){if(!this._oAdaptFiltersDialog){this.showAdaptFilterDialog()}};L.prototype.addFilterDialogContent=function(e){if(this._oAdaptFiltersDialog){return e}return null};L.prototype.getFilterDialogContent=function(){if(this._oAdaptFiltersDialog){return new T}return null};L.prototype.setShowOldFilterDialog=function(){};L.prototype._getFilterControlById=function(e){for(var t in this._mAdvancedAreaFilter){var i=this._mAdvancedAreaFilter[t];for(var r=0;r<i.items.length;r++){var a=i.items[r];if(a.control&&a.control.getId()===e){return a.control}}}return null};L.prototype._getFilterControlByIndex=function(e){var t=0;for(var i in this._mAdvancedAreaFilter){var r=this._mAdvancedAreaFilter[i];for(var a=0;a<r.items.length;a++){var n=r.items[a];if(n.filterItem.getVisibleInFilterBar()){if(t===e){return n.control}t++}}}};function w(e,t){var i=e.filter(function(e){return e.getText()===t});return i.length>0}L.prototype._getFilterControlByLabel=function(e){for(var t in this._mAdvancedAreaFilter){var i=this._mAdvancedAreaFilter[t];for(var r=0;r<i.items.length;r++){var a=i.items[r];if(a.control){if(w(a.control.getLabels(),e)){return a.control}}}}};L.prototype._isFilterItemInBasicGroup=function(e){return e&&!e.getGroupName()||e.getGroupName()===L.INTERNAL_GROUP};L.prototype._shouldBeVisible=function(e){return e.filterItem.getMandatory()&&!this._hasFilterValue(e.filterItem)||e.name==="_BASIC_SEARCH_FIELD"};L.prototype.exit=function(){a.prototype.exit.apply(this,arguments);this._unregisterVariantManagement();this._destroyFilterControls();window.sessionStorage.removeItem(this.getId());window.sessionStorage.removeItem("semanticDates");if(this._oAdaptFiltersDialog){this._oAdaptFiltersDialog.destroy();this._oAdaptFiltersDialog=null}if(this._oAdaptFiltersDialogModel){this._oAdaptFiltersDialogModel=null}if(this._oAdaptFiltersPanel){this._oAdaptFiltersPanel=null}if(this.oModel){this.oModel.destroy();this.oModel=null}if(this._oToolbarSpacer){this._oToolbarSpacer.destroy();this._oToolbarSpacer=null}if(this._oSeparator){this._oSeparator.destroy();this._oSeparator=null}this._aFields=null;this._aBasicAreaSelection=null;this._mAdvancedAreaFilter=null;this._oVariantManagement=null;this._oCollectiveSearch=null;this._oVariant=null;this._fRegisteredFetchData=null;this._fRegisteredApplyData=null;this._fRegisterGetFiltersWithValues=null;this._fRegisteredFilterChangeHandlers=null;this._oBasicSearchField=null;this._bSearchFiredFromFilterBar=false;this._bFiltersDialogForKeyUser=false;this._oInitializedDeferred=null;this._bDelegateAdded=false;e.detachChange(this._onLocalizationChanged)};return L});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterBarRenderer", [],function(){"use strict";var e={apiVersion:2};e.render=function(e,t){e.openStart("div",t);e.class("sapUiCompFilterBar");e.class(t._isPhone()?"sapUiCompFilterBarPhone":"sapUiCompFilterBarNonPhone");if(t.getUseToolbar()){e.class("sapUiCompFilterBarWithToolbar")}if(!t.getAdvancedMode()){e.class("sapContrastPlus")}e.openEnd();this.renderToolbar(e,t);if(t._shouldRenderAdvancedLayout()){this.renderAdvancedFilterItems(e,t)}else{this.renderFilterItems(e,t)}this.renderHintText(e,t);this.renderContent(e,t);e.close("div")};e.renderToolbar=function(e,t){if(!t.getUseToolbar()){e.cleanupControlWithoutRendering(t.getAggregation("_toolbar"));return}e.renderControl(t.getAggregation("_toolbar"))};e.renderHintText=function(e,t){if(t.getAdvancedMode()||t._isPhone()||t._hasAnyVisibleFiltersOnFB()||!t.getUseToolbar()){e.cleanupControlWithoutRendering(t.getAggregation("_hintText"));return}e.renderControl(t.getAggregation("_hintText"))};e.renderContent=function(e,t){var r=t.getContent();if(!r.length){return}e.openStart("div");e.class("sapUiCompFilterBarContent");e.openEnd();r.forEach(e.renderControl);e.close("div")};e.renderFilterItems=function(e,t){if(!t.getFilterBarExpanded()&&t.getUseToolbar()){return}const r=t._mAdvancedAreaFilterFlat.length?t._mAdvancedAreaFilterFlat:t._getAllFilterItemsFlat();e.openStart("div",`${t.getId()}-items`);e.class("sapUiCompFilterBarItems");e.openEnd();this.renderBasicSearch(e,t);const n=function(e){const t=e.filterItem;if(!t.getVisible()||!t.getVisibleInFilterBar()||t.getHiddenFilter()){return true}return false};const i=r.filter(n).length;let o=0;for(let i=0;i<r.length;i++){const l=i-o;if(t._shouldSkipRenderFilters(l)){break}if(n(r[i])){o++;continue}this.renderFilterItem(e,t,r[i].filterItem)}const l=Math.max(4,r.length-1);for(let n=0;n<l;n++){if(r[n]?.filterItem?.getVisibleInFilterBar()){this.renderFilterItemSpacer(e,t)}}this.renderButtons(e,t);this.renderShowAllButton(e,t,r.length-i);e.close("div")};e.renderFilterItem=function(e,t,r){e.openStart("div",r);if(t._shouldRenderAdvancedLayout()){e.class("sapUiCompFilterBarAdvancedItem")}else{e.class("sapUiCompFilterBarItem");this.setContainerWidth(e,t)}e.openEnd();if(r.getAggregation("_debug")){e.openStart("div");e.openEnd();e.renderControl(r.getAggregation("_debug"))}e.renderControl(r._oLabel);if(r.getAggregation("_debug")){e.close("div")}e.openStart("div");e.class("sapUiCompFilterBarItemEmptyDiv");e.openEnd();e.close("div");e.renderControl(r._getControl());e.close("div")};e.renderFilterItemSpacer=function(e,t){e.openStart("div");e.class("sapUiCompFilterBarItemSpacer");this.setContainerWidth(e,t);e.openEnd();e.close("div")};e.renderBasicSearch=function(e,t){const r=t._oBasicSearchField;if(!r||t.getUseToolbar()||r.getParent()!==t||r.getParent()===t&&r.sParentAggregationName==="content"){return}e.openStart("div",`${t.getId()}-item-basicSearch`);e.class("sapUiCompFilterBarBasicSearch");this.setContainerWidth(e,t);e.openEnd();e.renderControl(t._oBasicSearchField);e.close("div")};e.renderButtons=function(e,t){if(t._shouldSkipRenderButtons()){return}e.openStart("div",`${t.getId()}-item-buttons`);e.class("sapUiCompFilterBarButtons");e.openEnd();t._getButtons().forEach(e.renderControl);e.close("div")};e.renderShowAllButton=function(e,t,r){if(!t.getIsRunningInValueHelpDialog()||t.getShowAllFilters()||r<=t._nMaxFiltersByDefault){return}e.openStart("div",`${t.getId()}-showAll-container`);e.class("sapUiCompFilterBarButtons");e.openEnd();e.renderControl(t.getAggregation("_showAllFiltersButton"));e.close("div")};e.setContainerWidth=function(e,t){const r=t.getFilterContainerWidth();if(r!=="12rem"){e.style("flex-basis",r);e.style("max-width",t.getUseToolbar()?r:t._getMaxItemWidth())}};e.renderAdvancedFilterItems=function(e,t){const r=t._mAdvancedAreaFilterFlat.length?t._mAdvancedAreaFilterFlat:t._getAllFilterItemsFlat(),n=t._groupsWithVisibleFilters()??{},i=Object.keys(n).length;if(!r?.length||!t.getFilterBarExpanded()){return}e.openStart("div",`${t.getId()}-items`);e.class("sapUiCompFilterBarAdvancedItems");if(i<=2){e.class("sapUiCompFilterBarAdvancedItemsTwoGroups")}e.openEnd();if(i===1){this.renderAdvancedFilterItemsSingleGroup(e,t,r)}else{this.renderAdvancedFilterItemsMultiGroups(e,t,r,i)}e.close("div")};e.renderAdvancedFilterItemsSingleGroup=function(e,t,r){const n=r.length;let i=[0,Math.ceil(n/2)],o=[Math.ceil(n/2)-1,n-1];if(n<=2){i=[0];o=[n-1]}for(let l=0;l<n;l++){const n=r[l],s=n.filterItem;if(i.includes(l)){e.openStart("div");e.class("sapUiCompFilterBarAdvancedGroup");e.openEnd()}if(s.getVisible()&&s.getVisibleInFilterBar()&&!s.getHiddenFilter()){this.renderFilterItem(e,t,s)}if(o.includes(l)){e.close("div")}}};e.renderAdvancedFilterItemsMultiGroups=function(e,t,r,n){let i;for(let o=0;o<r.length;o++){const l=r[o],s=r[o+1],a=l.group,d=l.groupLabel,c=l.filterItem;if(i!==a){i=a;e.openStart("div");e.class("sapUiCompFilterBarAdvancedGroup");e.openEnd();if(a!=="__$INTERNAL$"&&n>1){e.openStart("h5");e.class("sapUiCompFilterBarAdvancedGroupHeader");e.openEnd();e.text(d);e.close("h5")}}if(c.getVisible()&&c.getVisibleInFilterBar()&&!c.getHiddenFilter()){this.renderFilterItem(e,t,c)}if(!s||i!==s.group){e.close("div")}}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterGroupItem", ["./FilterItem","sap/ui/comp/library"],function(e,t){"use strict";var i=e.extend("sap.ui.comp.filterbar.FilterGroupItem",{metadata:{library:"sap.ui.comp",properties:{groupTitle:{type:"string",group:"Misc",defaultValue:null},groupName:{type:"string",group:"Misc",defaultValue:null},visibleInAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{_debug:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}}}});i.prototype.init=function(){this.setVisibleInAdvancedArea(false);this.setVisibleInFilterBar(false);this._setParameter(false)};i.prototype._setParameter=function(e){this._bIsParameter=e};i.prototype.setGroupTitle=function(e){this.setProperty("groupTitle",e);this.fireChange({propertyName:"groupTitle"});return this};i.prototype.setVisibleInAdvancedArea=function(e){this.setVisibleInFilterBar(e);return this};i.prototype.getVisibleInAdvancedArea=function(){return this.getVisibleInFilterBar()};i.prototype._getControl=function(){return this.getControl.apply(this,arguments)};i.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments)};return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/FilterItem", ["sap/m/Label","sap/ui/core/Element","sap/ui/comp/util/IdentifierUtil"],function(t,e,r){"use strict";var o=e.extend("sap.ui.comp.filterbar.FilterItem",{metadata:{library:"sap.ui.comp",properties:{label:{type:"string",group:"Misc",defaultValue:null},name:{type:"string",group:"Misc",defaultValue:null},mandatory:{type:"boolean",group:"Misc",defaultValue:false},visible:{type:"boolean",group:"Misc",defaultValue:true},labelTooltip:{type:"string",group:"Misc",defaultValue:null},controlTooltip:{type:"string",group:"Misc",defaultValue:null},partOfCurrentVariant:{type:"boolean",group:"Misc",defaultValue:true},visibleInFilterBar:{type:"boolean",group:"Misc",defaultValue:true},hiddenFilter:{type:"boolean",group:"Misc",defaultValue:false},entitySetName:{type:"string",group:"Misc",defaultValue:null},entityTypeName:{type:"string",group:"Misc",defaultValue:null}},aggregations:{control:{type:"sap.ui.core.Control",multiple:false},_label:{type:"sap.m.Label",multiple:false,visibility:"hidden"}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});o.prototype.init=function(){this._oLabel=null;this._bIsParameter=false;this._sControlId=null};o.prototype.setControl=function(t){if(t&&t.getId){this._sControlId=t.getId()}this.setAggregation("control",t);return this};o.prototype.getControl=function(){var t=this.getAggregation("control");if(t){return t}if(this._sControlId===null){return null}return e.getElementById(this._sControlId)};o.prototype._getControl=function(){return this.getControl.apply(this,arguments)};o.prototype._isParameter=function(){return this._bIsParameter};o.prototype.setVisible=function(t){this.setProperty("visible",t);this.fireChange({propertyName:"visible"});return this};o.prototype.setVisibleInFilterBar=function(t){this.setProperty("visibleInFilterBar",t);this.fireChange({propertyName:"visibleInFilterBar"});return this};o.prototype.setPartOfCurrentVariant=function(t){if(t){this.fireChange({propertyName:"partOfCurrentVariant"})}return this};o.prototype.getPartOfCurrentVariant=function(){return true};o.prototype._getGroupName=function(){var t="";if(this.getGroupName){t=r.replace(this.getGroupName())}return t};o.prototype._getName=function(){var t=r.replace(this.getName());var e=this._getGroupName();if(e){t=e+"-"+t}return t};o.prototype._createLabelControl=function(e){var r=this.getLabel();var o="filterItem-"+this._getName();if(e){o=e+"-"+o}var i=new t({id:o,required:this.getMandatory(),textAlign:"Begin"});i.setText(r);i.setTooltip(this.getLabelTooltip());this.setAggregation("_label",i);return i};o.prototype.setMandatory=function(t){this.setProperty("mandatory",t);if(this._oLabel){this._oLabel.setRequired(t)}this.fireChange({propertyName:"mandatory"});return this};o.prototype.setLabel=function(t){this.setProperty("label",t);if(this._oLabel){this._oLabel.setText(t)}this.fireChange({propertyName:"label"});return this};o.prototype.setLabelTooltip=function(t){this.setProperty("labelTooltip",t);if(this._oLabel){this._oLabel.setTooltip(t)}this.fireChange({propertyName:"labelTooltip"});return this};o.prototype.setControlTooltip=function(t){this.setProperty("controlTooltip",t);this.fireChange({propertyName:"controlTooltip"});return this};o.prototype.getLabelControl=function(t){if(!this._oLabel){this._oLabel=this._createLabelControl(t)}return this._oLabel};o.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);if(this._oLabel&&!this._oLabel.bIsDestroyed){this._oLabel.destroy()}if(this._getControl()&&!this._getControl().bIsDestroyed){this._getControl().destroy()}var t=this.getId()+"__filterGroupItem",r=e.getElementById(t);if(r){e.prototype.destroy.apply(r,arguments);if(r._oLabel&&!r._oLabel.bIsDestroyed){r._oLabel.destroy()}r._oLabel=null}this._oLabel=null;this._sQuickinfo=null};return o});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/VariantConverterFrom", ["sap/ui/comp/library","sap/ui/core/date/UI5Date","sap/ui/comp/util/DateTimeUtil","sap/m/DatePicker","sap/m/DateRangeSelection","sap/base/Log","sap/ui/core/format/DateFormat"],function(e,t,i,a,r,n,l){"use strict";var o=e.ANALYTICAL_PARAMETER_PREFIX;var s=e.smartfilterbar.FilterType;var f=e.valuehelpdialog.ValueHelpRangeOperation;var c=function(){};c.prototype.convert=function(e,t,i){var a=null,r=null,n;if(e){this._bStrictMode=i;n=JSON.parse(e);if(t&&t.getFilterBarViewMetadata&&n){this._sBasicSearchName=null;this._sBasicSearchValue=null;if(t.getBasicSearchName){this._sBasicSearchName=t.getBasicSearchName()}a={};if(n.Parameters){this._addParameters(n.Parameters,t,a)}if(n.SelectOptions){this._addSelectOptions(n.SelectOptions,t,a)}r={payload:null,variantId:null};r.payload=JSON.stringify(a);if(n.SelectionVariantID){r.variantId=n.SelectionVariantID}if(this._sBasicSearchValue){r.basicSearch=this._sBasicSearchValue}}}return r};c.prototype.retrieveVariantId=function(e){var t=null;var i;if(e){i=JSON.parse(e);if(i&&i.SelectionVariantID){t=i.SelectionVariantID}}return t};c.prototype._getParameterMetaData=function(e,t,i){if(this._bStrictMode){return this._getParameterMetaDataStrictMode(e,t)}return this._getParameterMetaDataNonStrictMode(e,t,i)};c.prototype._getFilter=function(e,t){var i,a,r,n;n=t.getFilterBarViewMetadata();if(n){for(i=0;i<n.length;i++){r=n[i];for(a=0;a<r.fields.length;a++){if(e===r.fields[a].fieldName){return r.fields[a]}}}}return null};c.prototype._getParameter=function(e,t){var i,a;if(t.getAnalyticalParameters){a=t.getAnalyticalParameters();if(a){for(i=0;i<a.length;i++){if(e===a[i].fieldName){return a[i]}}}}return null};c.prototype._getParameterWithInnerPrefix=function(e,t){var i=e;if(e.indexOf(o)!==0){i=o+e}return this._getParameter(i,t)};c.prototype._getParameterMetaDataStrictMode=function(e,t){var i=this._getExactFilterParameterMatch(e,t);if(i){return i}return null};c.prototype._getParameterMetaDataNonStrictMode=function(e,t,i){var a,r,n,l,s=e,f=false,c=function(){return f&&s===l||!f&&s!==l};if(e.indexOf(o)===0){s=e.substr(o.length);f=true}if(s.indexOf("P_")===0){r=s;n=s.substr(2)}else{r="P_"+s;n=s}if(s!==r){l=r}else if(s!==n){l=n}a=this._getExactParameterMatch(s,t);if(a){return a}a=this._getExactParameterMatch(l,t);if(a){return a}if(c()){a=this._getFilter(n,t);if(a){return a}}return null};c.prototype._getExactParameterMatch=function(e,t){var i;i=this._getParameterWithInnerPrefix(e,t);if(i){return i}return null};c.prototype._getExactFilterParameterMatch=function(e,t){var i,a;i=this._getFilter(e,t);if(i){return i}a=this._getParameterWithInnerPrefix(e,t);if(a){return a}return null};c.prototype._addParameters=function(e,t,i){var a;var r,l;var o;for(a=0;a<e.length;a++){l=e[a].PropertyValue;r=e[a].PropertyName;if(this._sBasicSearchName&&r===this._sBasicSearchName){this._sBasicSearchValue=l;continue}o=this._getParameterMetaData(r,t,true);if(o){t.determineControlByName(r);this._addAccordingMetaData(i,t,o,l)}else{n.error("neither metadata nor custom information for filter '"+r+"'")}}};c.prototype._addSelectOptions=function(e,t,i){var a;var r,l;var o,s;for(a=0;a<e.length;a++){r=e[a].PropertyName;l=e[a].Ranges;if(this._sBasicSearchName&&r===this._sBasicSearchName){if(l&&l.length>0){this._sBasicSearchValue=l[0].Low}continue}t.determineControlByName(r);o=this._getParameterMetaData(r,t,false);if(o){s=o.control;this._addRangesAccordingMetaData(i,t,o,l,s)}else{n.error("neither metadata nor custom information for filter '"+r+"'")}}};c.convertOption=function(e,t,i){var a;switch(e){case"CP":a=f.Contains;if(t){var r=t.indexOf("*");var l=t.lastIndexOf("*");if(r>-1){if(r===0&&l!==t.length-1){a=f.EndsWith;t=t.substring(1,t.length)}else if(r!==0&&l===t.length-1){a=f.StartsWith;t=t.substring(0,t.length-1)}else{t=t.substring(1,t.length-1)}}}break;case"EQ":var o=i?.type;if(o){var s=o==="Edm.String"?true:false}if(!s&&t===""||t===null){a=f.Empty;t=null}else{a=e}break;case"BT":case"LE":case"GE":case"GT":case"LT":a=e;break;default:n.error("Suite Option is not supported '"+e+"'");a=undefined;t=undefined}return{op:a,v:t}};c.prototype._getYearMonthDatePattern=function(e){var t=e.match(/^([0-9]{4})([0-9]{2})([0-9]{2})$/);if(t){return[t[1],t[2],t[3]]}};c.prototype._getTimeZoneFormat=function(e){return e.split(/[\s+-]/)[0]};c.prototype._createDateObject=function(e){var i,a,r,n,l,o,s,f;if(!e){return}i=e.split(".");a=i[0];r=i[1];if(r){r=this._getTimeZoneFormat(r)}l=a.split("T");f=l[0].split("-");if(f.length===1){n=this._getYearMonthDatePattern(f[0]);if(n){f=n}}if(l.length<2){o=t.getInstance(f[0],f[1]-1,f[2])}else{s=l[1].split(":");o=t.getInstance(f[0],f[1]-1,f[2],s[0],s[1],s[2],r?r:0)}o.setFullYear(f[0]);return o};c.prototype._addRangesAccordingMetaData=function(e,t,o,u,d,m){var h,p;var g=function(e,t,a,r){if(t&&t.isInUTCMode&&a.indexOf("PT")===-1&&e.filterType==="date"){if(t.isInUTCMode()){a=a.split("T")[0]+"T00:00:00"}else if(!t.isInUTCMode()&&a.split("T").length===1){a+="T00:00:00"}}if(a.indexOf("Z")!==a.length-1){if(t&&t.isInUTCMode&&!t.isInUTCMode()){r=i.localToUtc(this._createDateObject(a)).toJSON()}else{r=this._createDateObject(a).toJSON()}}else{n.error("Property '"+e.fieldName+"' was added with zulu time zone information.")}return r}.bind(this);var v=function(e){var t=l.getTimeInstance({pattern:"'PT'hh'H'mm'M'ss'S'"});return t.parse(e)};var _=function(e){var i=e;if(e&&o){if(o.filterType==="numeric"){if(o.type==="Edm.Decimal"||o.type==="Edm.Float"||o.type==="Edm.Double"||o.type==="Edm.Single"){i=parseFloat(e)}else{i=parseInt(e)}}else{switch(o.type){case"Edm.DateTime":i=g(o,t,e,i);break;case"Edm.Time":if(e.indexOf("PT")===0){i=v(e)}else{i=g(o,t,e,i)}break;case"Edm.String":if(o.isCalendarDate&&!o.calendarType&&!(o.filterType==="stringdate"&&o.controlType==="date")){i=g(o,t,e,i)}break;case"Edm.DateTimeOffset":i=e;break;case"Edm.Date":var a=e.split("T"),r=a[1];if(r){r=this._getTimeZoneFormat(r)}i=r?a[0]+"T"+r:e;break;default:i=e;break}}}return i};var y=function(t,i){var a,r,n;for(a=0;a<i.length;a++){n=c.convertOption(i[a].Option,i[a].Low);if(n&&n.op){r={exclude:i[a].Sign==="E",operation:n.op,keyField:t,value1:_(n.v),value2:_(i[a].High)};if(!e[t]){e[t]={ranges:[],items:[],value:null}}e[t].ranges.push(r)}}};var S=function(e){for(var t=0;t<e.length;t++){if(e[t].Sign==="E"){return true}}return false};if(u&&u.length>0){if(o.isCustomFilterField){if(!e._CUSTOM){e._CUSTOM={}}if(Array.isArray(u)&&u.length>1){e._CUSTOM[o.fieldName]=u.map(function(e){return e.Low})}else{e._CUSTOM[o.fieldName]=u[0].Low}return}if(o.conditionType){for(h=0;h<u.length;h++){if(!u[h].High){u[h].High=u[h].Low}}y(o.fieldName,u);return}if(o.filterRestriction===s.single){if(!u[0].Low&&d&&d instanceof a){e[o.fieldName]=null}else{e[o.fieldName]=_(u[0].Low)}}else if(o.filterRestriction===s.interval){if(d&&d instanceof r){if(u[0].Low&&u[0].High){e[o.fieldName]={low:_(u[0].Low),high:_(u[0].High)}}else if(u[0].Low&&!u[0].High){e[o.fieldName]={low:_(u[0].Low),high:_(u[0].Low)}}else if(!u[0].Low&&u[0].High){e[o.fieldName]={low:_(u[0].High),high:_(u[0].High)}}else{e[o.fieldName]={low:null,high:null}}}else{if(o.type==="Edm.Time"){y(o.fieldName,u)}else if(o.type==="Edm.DateTimeOffset"&&u[0].Option==="EQ"){e[o.fieldName]={low:u[0].Low===undefined?null:_(u[0].Low),high:null}}else{e[o.fieldName]={low:u[0].Low===undefined?null:_(u[0].Low),high:u[0].High===undefined?null:_(u[0].High)}}}}else if(o.filterRestriction===s.multiple){e[o.fieldName]={ranges:[],items:[],value:null};var T=o.type==="Edm.DateTimeOffset"||o.isCalendarDate||o.type==="Edm.DateTime"||o.type==="Edm.Time";var M=d&&d.isA("sap.m.MultiInput")&&S(u);if(d&&!T&&(d.isA("sap.m.MultiComboBox")||d.isA("sap.m.MultiInput"))&&!M){var N;for(h=0;h<u.length;h++){N=_(u[h].Low);if(u[h].Option==="EQ"&&N===""){p={op:u[h].Option,v:N}}else{p=c.convertOption(u[h].Option,N)}if(p.op===f.EQ){e[o.fieldName].items.push({key:_(p.v)})}}}else{y(o.fieldName,u)}}else{y(o.fieldName,u)}n.warning("potential reduced information for filter '"+o.fieldName+"'")}else{n.warning("no Ranges-section found for filter '"+o.fieldName+"'")}};c.prototype._addAccordingMetaData=function(e,t,i,a){var r=i.type==="Edm.DateTime"?"":a;var n=[{Sign:"I",Low:a,High:r,Option:"EQ"}];this._addRangesAccordingMetaData(e,t,i,n)};return c},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/filterbar/VariantConverterTo", ["sap/ui/comp/library","sap/ui/core/date/UI5Date","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/odata/ODataType","sap/ui/comp/util/FormatUtil","sap/ui/core/format/DateFormat","sap/ui/core/format/TimezoneUtil","sap/base/Log"],function(e,a,t,i,n,r,l,s){"use strict";var o=e.smartfilterbar.FilterType;var u=e.valuehelpdialog.ValueHelpRangeOperation;var g=e.ANALYTICAL_PARAMETER_PREFIX;var d=function(){};d.prototype.convert=function(e,a,t,i,n,r,l){var s,o,u,g,f=null,p,h;var c={SelectionVariantID:e};if(r){c.ParameterContextUrl=r}if(l){c.FilterContextUrl=l}this._sAPILevel=n;if(t&&a){u=JSON.parse(t);if(u){s=this._getFields(a);if(s&&s.length>0){for(o=0;o<s.length;o++){this._convertField(c,s[o],u,i)}}if(u._CUSTOM){if(typeof u._CUSTOM==="string"){g=JSON.parse(u._CUSTOM)}else{g=u._CUSTOM}for(f in g){if(f){if(Array.isArray(g[f])&&g[f].length>1){this._addArrayOfSingleValues(c,f,g[f])}else{this._addSingleValue(c,f,d._getValue(g[f],true))}}}}if(i&&i.getBasicSearchName){p=i.getBasicSearchName();if(p){h=i.getBasicSearchValue();this._addSingleValue(c,p,d._getValue(h,true))}}}}return JSON.stringify(c)};d.prototype._getParameterMetaData=function(e,a){var t,i,n;var r=a.getFilterBarViewMetadata();if(r){for(t=0;t<r.length;t++){n=r[t];for(i=0;i<n.fields.length;i++){if(e===n.fields[i].fieldName){return n.fields[i]}}}}if(a.getAnalyticalParameters){var l=a.getAnalyticalParameters();if(l){for(i=0;i<l.length;i++){if(e===l[i].fieldName){return l[i]}}}}return null};d.prototype._convertField=function(e,a,t,r){var l,s,u=null,g,f,p,h;if(t&&a&&e){l=t[a];if(l||l===0){f=this._getParameterMetaData(a,r);if(f){if(f.isCustomFilterField){return}var c=r.getUseDateRangeType()&&(f.type==="Edm.DateTime"&&f.displayFormat==="Date"||f.type==="Edm.String"&&f.isCalendarDate)||t[a]&&t[a].conditionTypeInfo&&t[a].conditionTypeInfo.name&&t[a].conditionTypeInfo.name==="sap.ui.comp.config.condition.DateRangeType";if(f.filterRestriction===o.single&&(!c||f.isParameter)){s=l.value===undefined?l:l.value;s=d._getValueWithMetadata(r,f,s,true);this._addSingleValue(e,a,s);if(c&&f.isParameter){if(t&&a&&e&&t[a]&&t[a].conditionTypeInfo){var l=t[a];if(l.ranges&&l.ranges.length>0){g=d.addRangeEntry(e,a);d.addRanges(g,l.ranges,r,f)}}}}else if(f.filterRestriction===o.interval){if(l.conditionTypeInfo){this._convertFieldByValue(e,a,t,r,f)}else{g=d.addRangeEntry(e,a);if(f.type==="Edm.DateTime"&&!l.high){l.high=l.low}else if(f.type==="Edm.String"&&!l.high){u="EQ"}if(f.type==="Edm.Time"){this._addRangeMultipleRangeValues(r,f,g,l.ranges,true)}else if(f.type==="Edm.DateTimeOffset"&&!l.high){u="BT";p=n.parseDateTimeOffsetInterval(l.low);if(p&&p.length===2&&p[0]){p[0]=f.ui5Type.parseValue(p[0],"string");if(p.length===2){p[1]=f.ui5Type.parseValue(p[1],"string")}h={low:p[0],high:p[1]};this._addRangeLowHigh(r,f,g,h,u)}else{u="EQ";h={low:l.low,high:null};if(p[0].indexOf("Z")<0){h.low=f.ui5Type.parseValue(p[0],"string")}this._addRangeLowHigh(r,f,g,h,u)}}else if(i.isNumeric(f.type)&&!l.high){p=n.parseFilterNumericIntervalData(l.low);if(p&&p.length===2&&p[0]){this._addRangeLowHigh(r,f,g,{low:p[0],high:p[1]},"BT")}else{this._addRangeLowHigh(r,f,g,l,"EQ")}}else{this._addRangeLowHigh(r,f,g,l,u)}}}else if(f.filterRestriction===o.multiple){g=d.addRangeEntry(e,a);if(l.items&&l.items.length>0){this._addRangeMultipleSingleValues(r,f,g,l.items)}else if(l.ranges&&l.ranges.length>0){this._addRangeMultipleRangeValues(r,f,g,l.ranges,l.conditionTypeInfo?true:false)}else{this._addRangeSingleValue(g,l.value)}}else{this._convertFieldByValue(e,a,t,r,f)}}else{this._convertFieldByValue(e,a,t,r,f)}}}};d.prototype._convertFieldByValue=function(e,a,t,i,n){var r;var l;if(t&&a&&e){r=t[a];if(r){if(r.conditionTypeInfo){if(r.ranges&&r.ranges.length>0){l=d.addRangeEntry(e,a);d.addRanges(l,r.ranges,i,n)}}else if(r.ranges!==undefined&&r.items!==undefined&&r.value!==undefined){l=d.addRangeEntry(e,a);if(r.ranges&&r.ranges.length>0){d.addRanges(l,r.ranges,i,n)}if(r.items&&r.items.length>0){this._addRangeMultipleSingleValues(i,n,l,r.items)}if(r.value){this._addRangeSingleValue(l,d._getValueWithMetadata(i,n,r.value))}}else if(r.items!==undefined&&r.items&&r.items.length>0){l=d.addRangeEntry(e,a);this._addRangeMultipleSingleValues(i,n,l,r.items)}else if(r.low!==undefined&&r.low&&r.high!==undefined&&r.high){l=d.addRangeEntry(e,a);this._addRangeLowHigh(i,n,l,r)}else if(r.value!==undefined&&r.value){this._addSingleValue(e,a,r.value)}else if(r){this._addSingleValue(e,a,r)}}}};d.addRangeEntry=function(e,a){var t={PropertyName:a,Ranges:[]};if(!e.SelectOptions){e.SelectOptions=[]}e.SelectOptions.push(t);return t.Ranges};d.addRanges=function(e,a,t,i){var n,r,l,s;for(var o=0;o<a.length;o++){n=a[o].exclude?"E":"I";l=d._getValueWithMetadata(t,i,a[o].value1,true);s=null;if(a[o].operation===u.BT){s=d._getValueWithMetadata(t,i,a[o].value2)}l=d._prepareLowValue(a[o].operation,l);r=d._prepareOptionValue(a[o].operation,l);if(r){e.push({Sign:n,Option:r,Low:l,High:s})}}};d.addP13nRanges=function(e,a,t,i,n){var r,l,s,o;for(var g=0;g<a.length;g++){r=a[g].exclude?"E":"I";s=""+a[g].value1;o=null;if(a[g].operation===u.BT){o=""+a[g].value2}if(["date","datetime","time"].includes(t)){s=d._processP13NDateValue(a[g].value1,t,i,n);o=d._processP13NDateValue(a[g].value2,t,i,n)}s=d._prepareLowValue(a[g].operation,s);l=d._prepareOptionValue(a[g].operation,s);e.push({Sign:r,Option:l,Low:s,High:o})}};d._processP13NDateValue=function(e,i,n,r){if(!e||r){return e}if(typeof e==="string"){e=a.getInstance(e)}if(n&&(i==="date"||i==="time")){e=t.localToUtc(e)}if(i==="datetime"){return e.toISOString()}return e.toISOString().slice(0,-1)};d._prepareLowValue=function(e,a){switch(e){case u.Contains:if(a){a="*"+a+"*"}break;case u.StartsWith:if(a){a=a+"*"}break;case u.EndsWith:if(a){a="*"+a}break;case u.Empty:a="";break;case u.EQ:case u.BT:case u.LE:case u.GE:case u.GT:case u.LT:break;default:s.error("ValueHelpRangeOperation is not supported '"+e+"'");return}return a};d._prepareOptionValue=function(e,a){var t;switch(e){case u.Contains:case u.StartsWith:case u.EndsWith:t="CP";break;case u.Empty:t="EQ";break;case u.EQ:case u.BT:case u.LE:case u.GE:case u.GT:case u.LT:t=e;break;default:s.error("ValueHelpRangeOperation is not supported '"+e+"'");return}return t};d.prototype._addRangeMultipleSingleValues=function(e,a,t,i){for(var n=0;n<i.length;n++){t.push({Sign:"I",Option:"EQ",Low:d._getValueWithMetadata(e,a,i[n].key,true),High:null})}};d.prototype._addRangeMultipleRangeValues=function(e,a,t,i,n){for(var r=0;r<i.length;r++){t.push({Sign:i[r].exclude?"E":"I",Option:n?"BT":"EQ",Low:d._getValueWithMetadata(e,a,i[r].value1,true),High:n?d._getValueWithMetadata(e,a,i[r].value2):null})}};d.prototype._addRangeSingleValue=function(e,a){e.push({Sign:"I",Option:"EQ",Low:d._getValue(a,true),High:null})};d.prototype._addRangeLowHigh=function(e,a,t,i,n){var r=n||"BT";t.push({Sign:"I",Option:r,Low:d._getValueWithMetadata(e,a,i.low,true),High:d._getValueWithMetadata(e,a,i.high)})};d.prototype._addParamaterSingleValue=function(e,a,t){if(!e.Parameters){e.Parameters=[]}e.Parameters.push({PropertyName:a,PropertyValue:t})};d.prototype._createRangeSingleValue=function(e,a,t){var i=d.addRangeEntry(e,a);this._addRangeSingleValue(i,t)};d.prototype._addSingleValue=function(e,a,t){var i;if(this._sAPILevel){i=a.split(g);if(i.length>1){this._addParamaterSingleValue(e,i[i.length-1],t)}else{this._createRangeSingleValue(e,a,t)}}else{this._addParamaterSingleValue(e,a,t)}};d.prototype._addArrayOfSingleValues=function(e,a,t){var i=d.addRangeEntry(e,a);t.forEach(function(e){i.push({Sign:"I",Option:"EQ",Low:d._getValue(e,true),High:null})})};d.prototype._getFields=function(e){var a=[];if(e){for(var t=0;t<e.length;t++){a.push(e[t].name)}}return a};d._getValue=function(e,a){if(e===null||e===undefined||e===""){return a?"":null}return""+e};d._getValueWithMetadata=function(e,i,n,r){if(n===null||n===undefined||n===""){return r?"":null}else if(e&&i){if(i.type==="Edm.DateTime"||i.type==="Edm.Time"){if(i.isParameter&&n.oData){n=n.oData}if(i.isParameter&&!n.oData&&n.ranges&&n.ranges[0]&&n.ranges[0].value1){n=n.ranges[0].value1}if(e&&e.isInUTCMode&&e.isInUTCMode()){n=t.localToUtc(a.getInstance(n)).toJSON()}if(n.indexOf("Z")===n.length-1){n=n.substr(0,n.length-1)}}else if(i.type==="Edm.DateTimeOffset"){var l=e&&e._oFilterProvider&&e._oFilterProvider._getFilterTimeZone(i.name);if(l){n=t.toTimezone(n,l).toJSON()}else{n=a.getInstance(n).toJSON()}}}return""+n};return d},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/Constants", function(){"use strict";var r="sapui5.history.";var t="ui5.";var e="__sapui5_suggestion_order";var i=5;var n="__sapui5_forced_visible_suggestion";return{getHistoryPrefix:function(){return r},getShortHistoryPrefix:function(){return t},getSuggestionsGroupPropertyName:function(){return e},getForcedVisiblePropertyName:function(){return n},getMaxHistoryItems:function(){return i}}});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryAppDataService", ["sap/base/i18n/Localization","sap/ui/base/Object","./Constants","./Utils","./HistoryGlobalDataService"],function(t,e,i,a,n){"use strict";var r="en";var s;var o=e.extend("sap.ui.comp.historyvalues.HistoryAppDataService",{constructor:function(){e.apply(this,arguments);this._initialize()}});o.prototype._initialize=function(){this._initializeAppContainerId=this._initializeAppContainerId.bind(this);this._initializeAppData=this._initializeAppData.bind(this);this._sContainerId="";this._oPersonalizer=null;this._sAppId="";this._oData={};this._oDataReadyPromise=this._getHistoryGlobalDataService().then(t=>t.getApps()).then(this._initializeAppContainerId).then(this._initializeAppData)};o.prototype._getHistoryGlobalDataService=function(){return n.getInstance()};o.prototype._initializeAppContainerId=function(t){return a.getAppInfo().then(e=>{this._sAppId=i.getHistoryPrefix()+e.id;this._sContainerId=t[this._sAppId];if(!this._sContainerId){this._createAndSaveContainerId(t)}return this._sContainerId})};o.prototype._initializeAppData=function(){return this._getPersonalizer().then(t=>t.getPersData()).then(function(t){this._oData=t||this._getDefaultData();return this._oData}.bind(this))};o.prototype._getPersonalizer=function(){if(this._oPersonalizer){return Promise.resolve(this._oPersonalizer)}const t=sap.ui.require("sap/ushell/Container");return t.getServiceAsync("PersonalizationV2").then(async t=>{const e={keyCategory:t.constants.keyCategory.FIXED_KEY,writeFrequency:t.constants.writeFrequency.LOW,clientStorageAllowed:false,validity:Infinity},a={container:this._sContainerId,item:i.getHistoryPrefix()+"appData"};this._oPersonalizer=await t.getPersonalizer(a,e);return this._oPersonalizer})};o.prototype._createAndSaveContainerId=function(t){this._sContainerId=this._createContainerId();t[this._sAppId]=this._sContainerId;this._getHistoryGlobalDataService().then(e=>e.setApps(t))};o.prototype._createContainerId=function(){var t="xxxxxxxx.xxxx.4xxx.yxxx.xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=Math.random()*16|0;if(t==="y"){e=e&3|8}return e.toString(16)});return i.getShortHistoryPrefix()+t};o.prototype._getDefaultData=function(){return{}};o.prototype._isDataReady=function(){return this._oDataReadyPromise};o.prototype._getHistoryEnabled=function(){return this._getHistoryGlobalDataService().then(t=>t.getHistoryEnabled())};o.prototype.getFieldData=function(t){return this._isDataReady().then(this._getHistoryEnabled.bind(this)).then(function(e){if(!e){return[]}var a=[],n=this._getLanguage();if(this._isDefaultLanguage(n)){a=this._oData[t]||[]}else{var r=i.getHistoryPrefix()+n;if(!this._oData[r]){a=[]}else{a=this._oData[r][t]||[]}}return a.slice()}.bind(this))};o.prototype.setFieldData=function(t,e){return this._isDataReady().then(this._getHistoryEnabled.bind(this)).then(function(a){if(!a){return false}var n=this._getLanguage();if(this._isDefaultLanguage(n)){this._oData[t]=e}else{var r=i.getHistoryPrefix()+n;if(!this._oData[r]){this._oData[r]={}}this._oData[r][t]=e}return this._getPersonalizer().then(t=>t.setPersData(this._oData))}.bind(this))};o.prototype._getLanguage=function(){var e=t.getLanguage()||r;var i=e.match(/[a-z]+/i);if(i[0]){e=i[0].toLowerCase()}return e};o.prototype._isDefaultLanguage=function(t){return t===r};o.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this._sContainerId="";this._oPersonalizer=null;this._sAppId="";this._oData={};this._oDataReadyPromise=null};return{getInstance:function(){if(!s){s=new o}return Promise.all([s._isDataReady(),a.getAppInfo()]).then(t=>{const[,e]=t;const a=i.getHistoryPrefix()+e.id;if(s._sAppId!==a){s.destroy();s=new o}return s._isDataReady().then(()=>s)})}}});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryGlobalDataService", ["sap/ui/base/Object","./Constants"],function(t,e){"use strict";var i;var n=t.extend("sap.ui.comp.historyvalues.HistoryGlobalDataService",{constructor:function(){t.apply(this,arguments);this._initialize()}});n.prototype._initialize=function(){this._initializeHistoryData=this._initializeHistoryData.bind(this);this._sContainerId=e.getHistoryPrefix()+"HistorySettings";this._sItemId=e.getHistoryPrefix()+"settings";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=this._getPersonalizer().then(t=>t.getPersData()).then(this._initializeHistoryData)};n.prototype._initializeHistoryData=function(t){this._oData=t||this._getDefaultData();return Object.assign({},this._oData)};n.prototype._getPersonalizer=function(){if(this._oPersonalizer){return Promise.resolve(this._oPersonalizer)}const t=sap.ui.require("sap/ushell/Container");return t.getServiceAsync("PersonalizationV2").then(async t=>{const e={keyCategory:t.constants.keyCategory.FIXED_KEY,writeFrequency:t.constants.writeFrequency.LOW,clientStorageAllowed:false,validity:Infinity},i={container:this._sContainerId,item:this._sItemId};this._oPersonalizer=await t.getPersonalizer(i,e);return this._oPersonalizer})};n.prototype._getDefaultData=function(){return{historyEnabled:true,apps:{}}};n.prototype._isDataReady=function(){return this._oDataReadyPromise};n.prototype.getHistoryEnabled=function(){return this._isDataReady().then(function(){return this._oData.historyEnabled}.bind(this))};n.prototype.setHistoryEnabled=function(t){return this._isDataReady().then(function(){this._oData.historyEnabled=t;return this._getPersonalizer().then(t=>t.setPersData(this._oData))}.bind(this))};n.prototype.getApps=function(){return this._isDataReady().then(function(){return Object.assign({},this._oData.apps)}.bind(this))};n.prototype.setApps=function(t){return this._isDataReady().then(function(){this._oData.apps=t;return this._getPersonalizer().then(t=>t.setPersData(this._oData))}.bind(this))};n.prototype.deleteHistory=function(){return this._isDataReady().then(function(){var t=this._oData,e=t.apps,i=sap.ui.require("sap/ushell/Container");return i.getServiceAsync("PersonalizationV2").then(t=>{const i=Object.values(e).map(function(e){return t.deleteContainer(e)});return Promise.all(i)})}.bind(this))};n.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._sContainerId="";this._sItemId="";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=null};return{getInstance:function(){if(!i){i=new n}return Promise.resolve(i)}}});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryOptOutProvider", ["sap/ui/base/Object","sap/ui/core/IconPool","./HistoryGlobalDataService","./Constants","./Utils","sap/m/Dialog","sap/m/MessageBox","sap/m/FlexBox","sap/m/VBox","sap/m/HBox","sap/m/Switch","sap/m/Button","sap/m/Label","sap/ui/core/Lib"],function(t,e,o,i,s,n,a,l,r,u,_,h,c,y){"use strict";var p;var H=t.extend("sap.ui.comp.historyvalues.HistoryOptOutProvider",{metadata:{library:"sap.ui.comp"},constructor:function(){t.apply(this,arguments);this._initialize()}});H.prototype._initialize=function(){this._oRB=y.getResourceBundleFor("sap.ui.comp");this._oDialog=null;this._oHistoryEnabledSwitch=null;this._oHistoryEnabledLabel=null;this._oDeleteHistoryButton=null;this._oDeleteHistoryLabel=null;this._oSaveButton=null;this._oCancelButton=null;this._oDialogLayout=null;this._oHistoryEnabledLayout=null;this._oDeleteHistoryLayout=null};H.prototype._createOptOutUserProfileEntry=function(){var t=sap.ui.require("sap/ushell/Container");return t.getServiceAsync("Extension").then(t=>{const o={text:this._oRB.getText("HISTORY_SETTING_TITLE"),icon:e.getIconURI("history"),press:function(){this._createDialogContent();this._createLayouts();this._createDialog();this._getHistoryGlobalDataService().then(t=>t.getHistoryEnabled()).then(function(t){this._oHistoryEnabledSwitch.setState(t);if(!t){this._oHistoryEnabledSwitch.setState(t)}this._oDialog.open()}.bind(this))}.bind(this)},i={controlType:"sap.m.Button",bIsVisible:true,bCurrentState:true};return t.createUserAction(o,i).then(t=>{if(this._oAction){this._oAction.destroy();this._oAction=null}this._oAction=t;t.showForCurrentApp();return t})})};H.prototype._createDialogContent=function(){this._createHistoryEnabledSwitch();this._createHistoryEnabledLabel();this._createDeleteHistoryButton();this._createDeleteHistoryLabel();this._createSaveButton();this._createCancelButton()};H.prototype._createLayouts=function(){this._oHistoryEnabledLayout=new u({alignItems:"Center",items:[this._oHistoryEnabledLabel,this._oHistoryEnabledSwitch]});this._oDeleteHistoryLayout=new l({alignItems:"Center",items:[this._oDeleteHistoryLabel,this._oDeleteHistoryButton]});this._oDialogLayout=new r({items:[this._oHistoryEnabledLayout,this._oDeleteHistoryLayout]}).addStyleClass("sapUiSmallMargin")};H.prototype._createDialog=function(){this._oDialog=new n(i.getHistoryPrefix()+"optOutDialog",{title:this._oRB.getText("HISTORY_SETTING_TITLE"),content:[this._oDialogLayout],buttons:[this._oSaveButton,this._oCancelButton]});this._oDialog.attachAfterClose(this._onOptOutDialogAfterClose,this)};H.prototype._createHistoryEnabledSwitch=function(){this._oHistoryEnabledSwitch=new _};H.prototype._createHistoryEnabledLabel=function(){this._oHistoryEnabledLabel=new c({text:this._oRB.getText("HISTORY_SETTING_ENABLE_TRACKING_DESCRIPTION")}).addStyleClass("sapUiSmallMarginEnd")};H.prototype._createDeleteHistoryButton=function(){this._oDeleteHistoryButton=new h({busyIndicatorDelay:0,text:this._oRB.getText("HISTORY_SETTING_DELETE_BUTTON")});this._oDeleteHistoryButton.attachPress(this._onDeleteHistoryPress,this)};H.prototype._createDeleteHistoryLabel=function(){this._oDeleteHistoryLabel=new c({text:this._oRB.getText("HISTORY_SETTING_DELETE_DESCRIPTION")}).addStyleClass("sapUiSmallMarginEnd")};H.prototype._createSaveButton=function(){this._oSaveButton=new h({text:this._oRB.getText("HISTORY_SETTING_SAVE")});this._oSaveButton.attachPress(this._onSavePress,this)};H.prototype._createCancelButton=function(){this._oCancelButton=new h({text:this._oRB.getText("HISTORY_SETTING_CANCEL")});this._oCancelButton.attachPress(this._onCancelPress,this)};H.prototype._getHistoryGlobalDataService=function(){return o.getInstance()};H.prototype._onOptOutDialogAfterClose=function(){this._oDialog.destroy()};H.prototype._onDeleteHistoryPress=function(t){var e=t.getSource();e.setBusy(true);this._getHistoryGlobalDataService().then(t=>t.deleteHistory()).then(function(){e.setBusy(false)})};H.prototype._onSavePress=function(){a.confirm(this._oRB.getText("HISTORY_SETTING_CONFIRM"),{onClose:function(t){if(t=="CANCEL"){return}this._getHistoryGlobalDataService().then(t=>t.setHistoryEnabled(this._oHistoryEnabledSwitch.getState())).then(function(){window.location.reload()})}.bind(this)})};H.prototype._onCancelPress=function(){this._oDialog.close()};H.prototype.exit=function(){if(this._oDialog){this._oDialog.destroy();this._oDialog=null}this._oRB=null;this._oHistoryEnabledSwitch=null;this._oHistoryEnabledLabel=null;this._oDeleteHistoryButton=null;this._oDeleteHistoryLabel=null;this._oSaveButton=null;this._oCancelButton=null;this._oDialogLayout=null;this._oHistoryEnabledLayout=null;this._oDeleteHistoryLayout=null};return{createOptOutSettingPage:function(){return s.getAppInfo().then(function(t){if(t.homePage===true){return}if(!p){p=new H}p._createOptOutUserProfileEntry();return p})},getInstance:function(){if(!p){p=new H}return p}}});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/HistoryValuesProvider", ["sap/ui/base/EventProvider","sap/base/util/values","./Constants","./HistoryGlobalDataService","./HistoryAppDataService","sap/ui/core/Element"],function(t,e,o,i,n,r){"use strict";var a=t.extend("sap.ui.comp.providers.HistoryValuesProvider",{metadata:{library:"sap.ui.comp",events:{fieldUpdated:{parameters:{fieldData:{type:"Array"}}}}},constructor:function(e,o){t.apply(this,arguments);this._initialize(e,o)}});a.prototype._initialize=function(t,e){this._oControl=t;this._sFieldName=e};a.prototype._getHistoryGlobalDataService=function(){return i.getInstance()};a.prototype._getHistoryAppDataService=function(){return n.getInstance()};a.prototype.attachChangeListener=function(){if(this._oControl.isA("sap.m.MultiInput")){this._oControl.attachTokenUpdate(this._onMultiInputChange,this);return}if(this._oControl.isA("sap.m.MultiComboBox")){this._oControl.attachSelectionChange(this._onMultiComboBoxChange,this);return}if(this._oControl.isA("sap.m.Input")){this._oControl.attachSuggestionItemSelected(this._suggestionItemSelected,this);return}if(this._oControl.isA("sap.m.ComboBox")){this._oControl.attachChange(this._onComboBoxChange,this);return}};a.prototype._detachChangeListener=function(){if(this._oControl.isA("sap.m.MultiInput")){this._oControl.detachTokenUpdate(this._onMultiInputChange,this);return}if(this._oControl.isA("sap.m.MultiComboBox")){this._oControl.detachSelectionChange(this._onMultiComboBoxChange,this);return}if(this._oControl.isA("sap.m.Input")){this._oControl.detachSuggestionItemSelected(this._suggestionItemSelected,this);return}if(this._oControl.isA("sap.m.ComboBox")){this._oControl.detachChange(this._onComboBoxChange,this);return}};a.prototype._onMultiInputChange=function(t){var e=t.getParameter("type"),o=t.getParameter("addedTokens");if(e==="added"){var i=o.reduce(function(t,e){var o=e.data("row");if(o){return t.concat(o)}return t},[]);this.setFieldData(i)}};a.prototype._onMultiComboBoxChange=function(t){var e=t.getParameter("selected"),o=t.getParameter("changedItem");if(e&&o){var i=o.getBindingContext("list").getObject();this._processSingleValueControl(i)}};a.prototype._suggestionItemSelected=function(t){var e=r.getElementById(t.getSource().getSelectedRow());if(e){var o=e.getBindingContext("list").getObject();this._processSingleValueControl(o)}};a.prototype._onComboBoxChange=function(t){var e=t.getParameter("value"),o=t.getParameter("newValue"),i=t.getSource().getSelectedItem();if(e&&o&&i){var n=i.getBindingContext("list").getObject();this._processSingleValueControl(n)}};a.prototype._processSingleValueControl=function(t){if(t){this.setFieldData([t])}};a.prototype._processDateValues=function(t){return Object.keys(t).reduce(function(e,o){if(typeof t[o]==="object"&&Object.prototype.toString.call(t[o])==="[object Date]"){e[o]="/Date("+t[o].getTime()+")/"}else{e[o]=t[o]}return e},{})};a.prototype._getDistinct=function(t){var o={},i=[];t.forEach(function(t){var n=e(t).join();if(!o[n]){i.push(t);o[n]=true}},this);return i};a.prototype._getItemId=function(t){if(!t){return null}var e=t.lastIndexOf("(");return t.slice(e)};a.prototype.getFieldData=function(){return this._getHistoryAppDataService().then(t=>t.getFieldData(this._sFieldName))};a.prototype.setFieldData=function(t){t=t.reduce(function(t,e){var i=this._getItemId(e.__metadata&&e.__metadata.id);e=Object.assign({},e);if(i){e=Object.assign({__ui5_id:i},e)}delete e.__metadata;delete e[o.getForcedVisiblePropertyName()];delete e[o.getSuggestionsGroupPropertyName()];e=this._processDateValues(e);t.push(e);return t}.bind(this),[]);return this._getHistoryAppDataService().then(t=>t.getFieldData(this._sFieldName)).then(function(e){var i=o.getMaxHistoryItems(),n=this._getDistinct(t.concat(e));n=n.slice(0,i);this.fireEvent("fieldUpdated",{fieldData:n});return this._getHistoryAppDataService().then(t=>t.setFieldData(this._sFieldName,n))}.bind(this))};a.prototype.getHistoryEnabled=function(){return this._getHistoryGlobalDataService().then(t=>t.getHistoryEnabled())};a.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);if(this._oControl){this._detachChangeListener();this._oControl=null}this._sFieldName="";this._oDataReadyPromise=null};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/historyvalues/Utils", [],function(){"use strict";return{getAppInfo:function e(){const n=sap.ui.require("sap/ushell/Container");return n.getServiceAsync("AppLifeCycle").then(e=>{const n=e.getCurrentApplication(),t={};let i,p;if(n){i=n.componentInstance;t.homePage=n.homePage}if(i){p=i.getManifest()}if(p){t.id=p["sap.app"].id}return t})}}});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/library", ["sap/ui/base/DataType","sap/ui/core/Lib","sap/ui/core/library","sap/m/library","sap/ui/mdc/library"],function(a,e,t,r,i){"use strict";var o=e.init({apiVersion:2,name:"sap.ui.comp",version:"1.141.0",dependencies:["sap.ui.core","sap.m","sap.ui.mdc"],...{interactionDocumentation:true},designtime:"sap/ui/comp/designtime/library.designtime",types:["sap.ui.comp.smartfield.ControlProposalType","sap.ui.comp.smartfield.ControlContextType","sap.ui.comp.smartfield.ControlType","sap.ui.comp.smartchart.SelectionMode","sap.ui.comp.smartfield.DisplayBehaviour","sap.ui.comp.smartfield.JSONType","sap.ui.comp.smartfield.CriticalityRepresentationType","sap.ui.comp.smartfield.TextInEditModeSource","sap.ui.comp.smartfield.Importance","sap.ui.comp.smartfield.ValueHelpTitleSource","sap.ui.comp.TextArrangementType","sap.ui.comp.smarttable.TableType","sap.ui.comp.smarttable.ExportType","sap.ui.comp.smarttable.InfoToolbarBehavior","sap.ui.comp.smartlist.ListType","sap.ui.comp.personalization.AggregationRole","sap.ui.comp.personalization.ResetType","sap.ui.comp.personalization.ChangeType","sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation","sap.ui.comp.smartfilterbar.SelectOptionSign","sap.ui.comp.smartfilterbar.DisplayBehaviour","sap.ui.comp.smartfilterbar.FilterType","sap.ui.comp.smartfilterbar.ControlType","sap.ui.comp.smartfilterbar.MandatoryType","sap.ui.comp.smartform.SmartFormValidationMode","sap.ui.comp.smartform.Importance"],interfaces:["sap.ui.comp.smartform.SmartFormLayout","sap.ui.comp.IFormGroupElement","sap.ui.comp.IDropDownTextArrangement"],controls:["sap.ui.comp.filterbar.FilterBar","sap.ui.comp.navpopover.NavigationPopover","sap.ui.comp.navpopover.Panel","sap.ui.comp.navpopover.SmartLink","sap.ui.comp.smartchart.SmartChart","sap.ui.comp.smartfield.SmartField","sap.ui.comp.smartfield.SmartLabel","sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smartform.SmartForm","sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container","sap.ui.comp.smartmicrochart.SmartAreaMicroChart","sap.ui.comp.smartmicrochart.SmartLineMicroChart","sap.ui.comp.smartmicrochart.SmartBulletMicroChart","sap.ui.comp.smartmicrochart.SmartDeltaMicroChart","sap.ui.comp.smartmicrochart.SmartRadialMicroChart","sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart","sap.ui.comp.smartmicrochart.SmartComparisonMicroChart","sap.ui.comp.smartmicrochart.SmartColumnMicroChart","sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart","sap.ui.comp.smartmicrochart.SmartMicroChart","sap.ui.comp.smarttable.SmartTable","sap.ui.comp.smartlist.SmartList","sap.ui.comp.valuehelpdialog.ValueHelpDialog","sap.ui.comp.transport.TransportDialog","sap.ui.comp.variants.EditableVariantItem","sap.ui.comp.variants.VariantManagement","sap.ui.comp.smartvariants.SmartVariantManagement","sap.ui.comp.smartvariants.SmartVariantManagementUi2"],elements:["sap.ui.comp.filterbar.FilterGroupItem","sap.ui.comp.filterbar.FilterItem","sap.ui.comp.navpopover.LinkData","sap.ui.comp.navpopover.SemanticObjectController","sap.ui.comp.smartfield.Configuration","sap.ui.comp.smartfield.ControlProposal","sap.ui.comp.smartfield.ObjectStatus","sap.ui.comp.smartfilterbar.ControlConfiguration","sap.ui.comp.smartfilterbar.GroupConfiguration","sap.ui.comp.smartfilterbar.SelectOption","sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.ui.comp.smartform.SemanticGroupElement","sap.ui.comp.smartform.Layout","sap.ui.comp.smartvariants.PersonalizableInfo","sap.ui.comp.variants.VariantItem","sap.ui.comp.navpopover.NavigationContainer","sap.ui.comp.smartvariants.SmartVariantManagementAdapter"],extensions:{flChangeHandlers:{"sap.ui.comp.smartform.SmartForm":"sap/ui/comp/smartform/flexibility/SmartForm","sap.ui.comp.smartform.Group":{hideControl:"default",unhideControl:"default",renameGroup:"sap/ui/comp/smartform/flexibility/changes/RenameGroup",addField:"sap/ui/comp/smartform/flexibility/changes/AddField",addFields:"sap/ui/comp/smartform/flexibility/changes/AddFields",addMultiEditField:"sap/ui/comp/smartmultiedit/flexibility/changes/AddMultiEditFields"},"sap.ui.comp.smartform.GroupElement":{hideControl:"default",unhideControl:"sap/ui/comp/smartform/flexibility/changes/UnhideControl",renameField:"sap/ui/comp/smartform/flexibility/changes/RenameField"},"sap.ui.comp.navpopover.NavigationContainer":{addLink:{changeHandler:"sap/ui/comp/navpopover/flexibility/LinkFlex",layers:{USER:true}},removeLink:{changeHandler:"sap/ui/comp/navpopover/flexibility/LinkFlex",layers:{USER:true}}},"sap.ui.comp.navpopover.Panel":"sap/ui/comp/navpopover/flexibility/Panel","sap.ui.comp.smarttable.SmartTable":{ToolbarContentMove:"sap/ui/comp/smarttable/flexibility/ToolbarContentMove"}},"sap.ui.support":{publicRules:true}}})||o;o.DEFAULT_DISPLAY_BEHAVIOUR="descriptionAndId";o.ANALYTICAL_PARAMETER_PREFIX="$Parameter.";o.STANDARD_VARIANT_NAME="STANDARD";o.smartform=o.smartform||{};o.smartform.inheritCostomDataToFields=function(a){var e=a.getKey();var t={startsWith:{strings:["sap.ui.fl"],compareFunction:function(a){return e.startsWith(a)}},wholeString:{strings:["sap-ui-custom-settings"],compareFunction:function(a){return e==a}}};var r=true;Object.keys(t).forEach(function(a){if(r&&t[a].strings.some(t[a].compareFunction)){r=false;return true}});return r};o.TextArrangementType={TextFirst:"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst",TextLast:"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast",TextSeparate:"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate",TextOnly:"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"};o.ValueHelpDeprecationCode={DeprecatedCode:"W",RevokedCode:"E",ValidCode:""};o.smartchart=o.smartchart||{};o.smartchart.SelectionMode={Multi:"MULTIPLE",Single:"SINGLE",None:"NONE"};a.registerEnum("sap.ui.comp.smartchart.SelectionMode",o.smartchart.SelectionMode);o.smartfield=o.smartfield||{};o.smartfield.ControlType={auto:"auto",dropDownList:"dropDownList",input:"input",datePicker:"datePicker",checkBox:"checkBox",selection:"selection"};a.registerEnum("sap.ui.comp.smartfield.ControlType",o.smartfield.ControlType);o.smartfield.DisplayBehaviour={auto:"auto",descriptionOnly:"descriptionOnly",descriptionAndId:"descriptionAndId",idAndDescription:"idAndDescription",idOnly:"idOnly",TrueFalse:"TrueFalse",OnOff:"OnOff",YesNo:"YesNo"};a.registerEnum("sap.ui.comp.smartfield.DisplayBehaviour",o.smartfield.DisplayBehaviour);o.smartfield.JSONType={String:"String",Date:"Date",Float:"Float",Integer:"Integer",Boolean:"Boolean",DateTime:"DateTime"};a.registerEnum("sap.ui.comp.smartfield.JSONType",o.smartfield.JSONType);o.smartfield.ControlContextType={None:"",ResponsiveTable:"responsiveTable",Form:"form",Table:"table",SmartFormGrid:"smartFormGrid"};a.registerEnum("sap.ui.comp.smartfield.ControlContextType",o.smartfield.ControlContextType);o.smartfield.ControlProposalType={None:"",ObjectNumber:"ObjectNumber",ObjectIdentifier:"ObjectIdentifier"};a.registerEnum("sap.ui.comp.smartfield.ControlProposalType",o.smartfield.ControlProposalType);o.smartfield.CriticalityRepresentationType={WithoutIcon:"WithoutIcon",WithIcon:"WithIcon"};a.registerEnum("sap.ui.comp.smartfield.CriticalityRepresentationType",o.smartfield.CriticalityRepresentationType);o.smarttable=o.smarttable||{};o.smarttable.TableType={Table:"Table",ResponsiveTable:"ResponsiveTable",AnalyticalTable:"AnalyticalTable",TreeTable:"TreeTable"};a.registerEnum("sap.ui.comp.smarttable.TableType",o.smarttable.TableType);o.smarttable.InfoToolbarBehavior={Auto:"Auto",On:"On",Off:"Off"};a.registerEnum("sap.ui.comp.smarttable.InfoToolbarBehavior",o.smarttable.InfoToolbarBehavior);o.smartfield.TextInEditModeSource={None:"None",NavigationProperty:"NavigationProperty",ValueList:"ValueList",ValueListNoValidation:"ValueListNoValidation",ValueListWarning:"ValueListWarning"};a.registerEnum("sap.ui.comp.smartfield.TextInEditModeSource",o.smartfield.TextInEditModeSource);o.smartfield.Importance={High:"High",Medium:"Medium",Low:"Low"};a.registerEnum("sap.ui.comp.smartfield.Importance",o.smartfield.Importance);o.smartfield.ValueHelpTitleSource={Property:"Property",ValueList:"ValueList"};a.registerEnum("sap.ui.comp.smartfield.ValueHelpTitleSource",o.smartfield.ValueHelpTitleSource);o.smarttable.ExportType={GW:"GW",UI5Client:"UI5Client",UI5ClientPDF:"UI5ClientPDF"};a.registerEnum("sap.ui.comp.smarttable.ExportType",o.smarttable.ExportType);o.smartlist=o.smartlist||{};o.smartlist.ListType={List:"List",Tree:"Tree"};a.registerEnum("sap.ui.comp.smartlist.ListType",o.smartlist.ListType);o.personalization=o.personalization||{};o.personalization.ResetType={ResetFull:"ResetFull",ResetPartial:"ResetPartial"};o.personalization.AggregationRole={Dimension:"Dimension",Measure:"Measure",NotDimeasure:"NotDimeasure"};a.registerEnum("sap.ui.comp.personalization.AggregationRole",o.personalization.AggregationRole);o.personalization.ChangeType={Unchanged:"Unchanged",ModelChanged:"ModelChanged",TableChanged:"TableChanged"};o.personalization.TableType={ResponsiveTable:"ResponsiveTable",Table:"Table",AnalyticalTable:"AnalyticalTable",TreeTable:"TreeTable",ChartWrapper:"ChartWrapper",SelectionWrapper:"SelectionWrapper"};o.personalization.ColumnType={ResponsiveColumn:"ResponsiveColumn",TableColumn:"TableColumn",ColumnWrapper:"ColumnWrapper"};o.smartfilterbar=o.smartfilterbar||{};o.smartfilterbar.FilterType={auto:"auto",single:"single",multiple:"multiple",interval:"interval",searchExpression:"searchExpression"};a.registerEnum("sap.ui.comp.smartfilterbar.FilterType",o.smartfilterbar.FilterType);o.smartfilterbar.ControlType={auto:"auto",input:"input",dropDownList:"dropDownList",date:"date",dateTimePicker:"dateTimePicker"};a.registerEnum("sap.ui.comp.smartfilterbar.ControlType",o.smartfilterbar.ControlType);o.smartfilterbar.MandatoryType={auto:"auto",mandatory:"mandatory",notMandatory:"notMandatory"};a.registerEnum("sap.ui.comp.smartfilterbar.MandatoryType",o.smartfilterbar.MandatoryType);o.smartfilterbar.DisplayBehaviour={auto:"auto",descriptionOnly:"descriptionOnly",descriptionAndId:"descriptionAndId",idAndDescription:"idAndDescription",idOnly:"idOnly"};a.registerEnum("sap.ui.comp.smartfilterbar.DisplayBehaviour",o.smartfilterbar.DisplayBehaviour);o.smartfilterbar.SelectOptionSign={I:"I",include:"I",E:"E",exclude:"E"};a.registerEnum("sap.ui.comp.smartfilterbar.SelectOptionSign",o.smartfilterbar.SelectOptionSign);o.navpopover=o.navpopover||{};o.navpopover.ChangeHandlerType={addLink:"addLink",removeLink:"removeLink",moveLink:"moveLink"};o.smartvariants=o.smartvariants||{};o.smartvariants.ChangeHandlerType={addFavorite:"addFavorite",removeFavorite:"removeFavorite"};o.valuehelpdialog=o.valuehelpdialog||{};o.valuehelpdialog.ValueHelpRangeOperation={BT:"BT",EQ:"EQ",Contains:"Contains",StartsWith:"StartsWith",EndsWith:"EndsWith",LT:"LT",LE:"LE",GT:"GT",GE:"GE",Initial:"Initial",Empty:"Empty"};a.registerEnum("sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation",o.valuehelpdialog.ValueHelpRangeOperation);o.smartform.SmartFormValidationMode={Standard:"Standard",Async:"Async"};a.registerEnum("sap.ui.comp.smartform.SmartFormValidationMode",o.smartform.SmartFormValidationMode);o.smartform.Importance={High:"High",Medium:"Medium",Low:"Low"};a.registerEnum("sap.ui.comp.smartform.Importance",o.smartform.Importance);o.filterbar=o.filterbar||{};o.numericEdmTypes=["Edm.Int64","Edm.Decimal","Edm.Double","Edm.Single","Edm.Int32","Edm.Int16","Edm.Byte","Edm.SByte"];return o});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/ContactDetailsController", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/layout/form/SimpleForm","sap/m/Title","sap/m/Label","sap/m/Text","sap/m/Image","sap/m/Link","sap/ui/base/ManagedObjectObserver","sap/ui/comp/odata/MetadataAnalyser","sap/base/Log","sap/ui/layout/library","sap/ui/core/library","sap/base/util/merge"],function(e,t,r,n,o,i,a,s,p,u,d,l,c,f,m){"use strict";var h=f.TitleLevel;var v=c.form.SimpleFormLayout;var b=t.extend("sap.ui.comp.navpopover.ContactDetailsController",{metadata:{library:"sap.ui.comp"}});b.prototype.init=function(){this._oObserver=null};b.prototype.exit=function(){if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}};b.prototype.getBindingPath4ContactAnnotation=function(e,t,r){if(t===undefined||t===null||!e){return Promise.resolve(null)}if(!this.getModel()){return Promise.resolve(null)}if(!this.getModel().getMetaModel()){return Promise.resolve(null)}var n=this.getModel().getMetaModel();return n.loaded().then(function(){var o;try{n.getMetaContext(e)}catch(t){l.error("sap.ui.comp.navpopover.ContactDetailsController.getBindingPath4ContactAnnotation: binding path '"+e+"' is not valid. Error has been caught: "+t);return null}try{o="/"+t+"('"+r+"')";n.getMetaContext(o);return o}catch(e){}try{o=t?e+"/"+t:e;n.getMetaContext(o);return o}catch(r){l.error("sap.ui.comp.navpopover.ContactDetailsController.getBindingPath4ContactAnnotation: the path of sContactAnnotationPath '"+e+"/"+t+"' is not valid. Error has been caught: "+r);return null}})};b.prototype.getContactDetailsAnnotation=function(e){if(!e){return null}var t=new d(this.getModel());var r=t.getContactAnnotation(e);if(!r){return null}return r};b.prototype.getContactDetailsContainers=function(e){var t=this.getContactDetailsAnnotation(e);if(!t){return[]}var i=[];var a=[];var s=[];var p;this._oObserver=new u(function(e){if(e.type==="property"&&e.name==="visible"){var t=false;for(var r=1;r<p.getContent().length;r++){if(p.getContent()[r].getLabelFor&&p.getContent()[r].getLabelFor()){continue}if(p.getContent()[r].getVisible()){t=true}}p.setVisible(t)}});var d=r.getResourceBundleFor("sap.ui.comp");this.addProperty2ExpandAndSelect("photo",t,e,a,s);this._addPhoto("photo",t,e,i,this._oObserver);this.addProperty2ExpandAndSelect("fn",t,e,a,s);this._addLabeledText("fn",d.getText("POPOVER_CONTACT_SECTION_NAME"),t,e,i,this._oObserver);this.addProperty2ExpandAndSelect("role",t,e,a,s);this._addLabeledText("role",d.getText("POPOVER_CONTACT_SECTION_ROLE"),t,e,i,this._oObserver);this.addProperty2ExpandAndSelect("title",t,e,a,s);this._addLabeledText("title",d.getText("POPOVER_CONTACT_SECTION_JOBTITLE"),t,e,i,this._oObserver);this.addProperty2ExpandAndSelect("org",t,e,a,s);this._addLabeledText("org",d.getText("POPOVER_CONTACT_SECTION_DEPARTMENT"),t,e,i,this._oObserver);this._addEmails(t,e,a,s,i,this._oObserver);this._addTels(t,e,a,s,i,this._oObserver);this._addAddresses(t,e,a,s,i,this._oObserver);if(!i.length){return[]}i.splice(0,0,new o({text:r.getResourceBundleFor("sap.ui.comp").getText("POPOVER_CONTACT_SECTION_TITLE"),level:h.H2}));p=new n({maxContainerCols:1,editable:false,layout:v.ResponsiveGridLayout,content:i});p.addStyleClass("sapuicompContactDetailsForm");this._requestData(p,e,a,s);return[p]};b.prototype._addPhoto=function(e,t,r,n,o){if(!t[e]){return}var i=r+"/"+t[e].Path;if(this.isPropertyHidden(i)){return}var a=new s({src:{path:i},visible:{path:i,formatter:function(e){return!!e}},decorative:false});a.addStyleClass("sapUiIcon");a.addStyleClass("navigationPopoverThumbnail");o.observe(a,{properties:["visible"]});n.push(a)};b.prototype._addLabeledText=function(e,t,r,n,o,s){if(!r[e]){return}var p=n+"/"+r[e].Path;if(this.isPropertyHidden(p)){return}var u=new a({text:{path:p},visible:{path:p,formatter:function(e){return!!e}}});var d=new i({text:t,labelFor:u.getId()});s.observe(u,{properties:["visible"]});o.push(d);o.push(u)};b.prototype._addEmails=function(e,t,n,o,i,a){if(!e.email||!e.email.length){return}var s=r.getResourceBundleFor("sap.ui.comp");var p=m([],e.email);p.filter(function(e){return!e.processed&&e.type&&(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1||e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/work")>-1)}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("address",e,t,n,o);this._addLabeledEmail("address",s.getText("POPOVER_CONTACT_SECTION_EMAIL"),e,t,i,a);e.processed=true},this)};b.prototype._addTels=function(e,t,n,o,i,a){if(!e.tel||!e.tel.length){return}var s=r.getResourceBundleFor("sap.ui.comp");var p=m([],e.tel);p.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/work")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,n,o);this._addLabeledTel("uri",s.getText("POPOVER_CONTACT_SECTION_PHONE"),e,t,i,a);e.processed=true},this);p.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/cell")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,n,o);this._addLabeledTel("uri",s.getText("POPOVER_CONTACT_SECTION_MOBILE"),e,t,i,a);e.processed=true},this);p.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/fax")>-1}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1){return 1}return 0}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,n,o);this._addLabeledTel("uri",s.getText("POPOVER_CONTACT_SECTION_FAX"),e,t,i,a);e.processed=true},this);p.filter(function(e){return!e.processed&&e.type&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.PhoneType/preferred")>-1}).forEach(function(e){this.addProperty2ExpandAndSelect("uri",e,t,n,o);this._addLabeledTel("uri",s.getText("POPOVER_CONTACT_SECTION_PHONE"),e,t,i,a);e.processed=true},this)};b.prototype._addAddresses=function(e,t,n,o,i,a){if(!e.adr||!e.adr.length){return}var s=r.getResourceBundleFor("sap.ui.comp");var p=m([],e.adr);p.filter(function(e){return!e.processed&&e.type&&(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1||e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/work")>-1)}).sort(function(e,t){if(e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return-1}if(t.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")>-1&&e.type.EnumMember.indexOf("com.sap.vocabularies.Communication.v1.ContactInformationType/preferred")<0){return 1}return 0}).forEach(function(e){this._addLabeledAddress(s.getText("POPOVER_CONTACT_SECTION_ADR"),e,t,n,o,i,a);e.processed=true},this)};b.prototype._addLabeledAddress=function(e,t,r,n,o,s,p){var u=[];["street","code","locality","region","country"].forEach(function(e){this.addProperty2ExpandAndSelect(e,t,r,n,o);var i;if(t[e]){i=r+"/"+t[e].Path}u.push(i&&!this.isPropertyHidden(i)?{path:i}:{path:"$notExisting"})},this);if(!u.length){return}var d=new a({text:{parts:u,formatter:function(e,t,r,n,o){var i=[];if(e){i.push(e)}if(t&&r){i.push(t+" "+r)}else{if(t){i.push(t)}if(r){i.push(r)}}if(n){i.push(n)}if(o){i.push(o)}return i.join(", ")}},visible:{parts:u,formatter:function(e,t,r,n,o){return!!(e||t||r||n||o)}}});var l=new i({text:e,labelFor:d.getId()});p.observe(d,{properties:["visible"]});s.push(l);s.push(d)};b.prototype._addLabeledTel=function(e,t,r,n,o,a){if(!r[e]||!n){return}var s=n+"/"+r[e].Path;if(this.isPropertyHidden(s)){return}var u=new p({href:{path:s,formatter:function(e){return e?"tel:"+e:e}},text:{path:s},visible:{path:s,formatter:function(e){return!!e}}});var d=new i({text:t,labelFor:u.getId()});a.observe(u,{properties:["visible"]});o.push(d);o.push(u)};b.prototype._addLabeledEmail=function(e,t,r,n,o,a){if(!r[e]||!n){return}var s=n+"/"+r[e].Path;if(this.isPropertyHidden(s)){return}var u=new p({href:{path:s,formatter:function(e){return e?"mailto:"+e:e}},text:{path:s},visible:{path:s,formatter:function(e){return!!e}}});var d=new i({text:t,labelFor:u.getId()});a.observe(u,{properties:["visible"]});o.push(d);o.push(u)};b.prototype.addProperty2ExpandAndSelect=function(e,t,r,n,o){if(!t[e]||!r){return}var i=r+"/"+t[e].Path;if(!i){return}if(i.indexOf("/")!==0){throw"sap.ui.comp.navpopover.ContactDetailsController.addProperty2ExpandAndSelect: the path of sBindingPathOfProperty '"+i+"' is not valid."}var a=i.split("/");a.shift();a.shift();var s=a.join("/");if(s){o.push(s)}a.pop();var p=a.join("/");if(!p){return}var u=n.filter(function(e){return e===p});if(!u.length){n.push(p)}};b.prototype.isPropertyHidden=function(e){var t;if(!this.getModel()){l.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the model does not exist");return false}if(!this.getModel().getMetaModel()){l.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the model should be the ODataModel");return false}try{t=this.getModel().getMetaModel().getMetaContext(e)}catch(t){l.error("sap.ui.comp.navpopover.ContactDetailsController.isPropertyHidden: the path of property path '"+e+"' is not valid. Error has been caught: "+t);return false}var r=t.getProperty(t.getPath());return d.isHidden(r)};b.prototype._requestData=function(e,t,r,n){var o={};if(r.length){o.expand=r.join(",")}if(n.length){o.select=n.join(",")}var i="/"+t.split("/")[1];e.bindObject({path:i,parameters:o,events:{change:function(){e.invalidate()}}})};return b});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Factory", ["sap/ui/comp/library","sap/base/Log"],function(e,n){"use strict";var i={getUShellContainer:function(){return sap.ui.require("sap/ushell/Container")},getService:function(e,i){if(!i){n.warning("sap.ui.comp.navpopover.Factory: calling getService synchronously should not be done as it's deprecated.");return null}return this.getServiceAsync(e)},getServiceAsync:function(e){const i=this.getUShellContainer();if(!i){return Promise.resolve(null)}switch(e){case"CrossApplicationNavigation":n.warning("sap.ui.comp.navpopover.Factory: Service 'CrossApplicationNavigation' should not be used as it's deprecated.");return i.getServiceAsync("CrossApplicationNavigation");case"URLParsing":return i.getServiceAsync("URLParsing");case"Navigation":return i.getServiceAsync("Navigation");default:return Promise.resolve(null)}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/FakeFlpConnector", ["sap/ui/thirdparty/jquery","./Factory"],function(jQuery,e){"use strict";function t(){}function r(e){return{parseShellHash:function(t){var r=function(e){var r=e.filter(function(e){return e.intent===t});return r[0]};for(var n in e){var i=r(e[n].links);if(i){return{semanticObject:n,action:i.action}}}return{semanticObject:null,action:null}}}}function n(e){return{getHref:function(e){if(!e||!e.target||!e.target.shellHash){return Promise.resolve(null)}return Promise.resolve(e.target.shellHash)},getSemanticObjects:function(){var t=[];for(var r in e){t.push(r)}return Promise.resolve(t)},getLinks:function(t){var r=[];if(!Array.isArray(t)){r=e[t.semanticObject]?e[t.semanticObject].links:[]}else{t.forEach(function(t){r.push(e[t.semanticObject]?e[t.semanticObject].links:[])})}return Promise.resolve(r)},getPrimaryIntent:function(t,r){let n=null;const i=e[t]?.links;if(i===undefined){return Promise.resolve(n)}let c=i.filter(e=>e.tags?.includes("primaryAction"));if(c.length===0){c=i.filter(e=>e.action==="displayFactSheet")}if(c.length===0){return Promise.resolve(n)}n=c.sort((e,t)=>{if(e.intent===t.intent){return 0}return e.intent<t.intent?-1:1})[0];return Promise.resolve(n)}}}t.enableFakeConnector=function(r){if(t.getServiceReal){return}t.getServiceReal=e.getService;t.getServiceAsyncReal=e.getServiceAsync;e.getService=t._createFakeService(r);e.getServiceAsync=t=>e.getService(t,true)};t._createFakeService=function(e){return function(i,c){switch(i){case"URLParsing":return c?Promise.resolve(r(e)):r(e);case"Navigation":return c?Promise.resolve(n(e)):n(e);default:return t.getServiceReal(i)}}};t.disableFakeConnector=function(){if(t.getServiceReal){e.getService=t.getServiceReal;e.getServiceAsync=t.getServiceAsyncReal;t.getServiceReal=undefined;t.getServiceAsyncReal=undefined}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/FlexConnector", ["sap/ui/comp/library","sap/ui/comp/navpopover/flexibility/LinkFlex","sap/base/Log","sap/ui/core/Lib"],function(t,e,n,a){"use strict";var r=t.navpopover.ChangeHandlerType;return{createAndSaveChangesForControl:function(t,e,n){if(!t.length&&!e.length){return Promise.resolve()}return this._createChangesForControl(e.concat(t),n).then(function(t){return this._saveChangesForControl(n,t)}.bind(this),function(t){return Promise.reject(t)})},_getControlPersonalizationWriteAPI:function(){return a.load({name:"sap.ui.fl"}).then(function(){return new Promise(function(t){sap.ui.require(["sap/ui/fl/write/api/ControlPersonalizationWriteAPI"],function(e){t(e)})})})},discardChangesForControl:function(t){return this._getControlPersonalizationWriteAPI().then(function(e){return e.reset({selectors:[t]})})},_saveChangesForControl:function(t,e){return this._getControlPersonalizationWriteAPI().then(function(n){return n.save({selector:t,changes:e})})},_createChangesForControl:function(t,e){if(!t.length){return[]}var n=[];t.forEach(function(t){var a={selectorElement:e,changeSpecificData:{changeType:t.visible?r.addLink:r.removeLink,content:t,isUserDependent:true}};n.push(a)});return this._getControlPersonalizationWriteAPI().then(function(t){return t.add({changes:n})})},activateApplyChangeStatistics:function(){var t=this;this.aStatistics=[];var n=function(e,n){if(t.aStatistics.findIndex(function(t){return t.stableId===n.getId()&&t.changeId===e.getId()})<0){var a=n.getAvailableActions().find(function(t){return t.getKey()===e.getContent().key});t.aStatistics.push({stableId:n.getId(),changeId:e.getId(),layer:e.getLayer(),key:e.getContent().key,text:a?a.getText():"",changeType:e.getChangeType()})}};var a=function(e){t.aStatistics=t.aStatistics.filter(function(t){return t.layer!==e})};var r=e.applyChange.bind(e);e.applyChange=function(t,e,a){n(t,e);r(t,e,a)};var i=e.discardChangesOfLayer.bind(e);e.discardChangesOfLayer=function(t,e){a(t);i(t,e)}},_formatStatistic:function(t){var e=t.layer;switch(t.layer){case"VENDOR":e=""+e;break;case"CUSTOMER":e="        "+e;break;case"USER":e="                "+e;break;default:e=""+e}var n;switch(t.changeType){case r.addLink:n="On";break;case r.removeLink:n="Off";break;default:n=""}return{formattedLayer:e,formattedValue:n}},printStatisticAll:function(){if(!this.aStatistics){n.info("Please activate with sap.ui.comp.navpopover.FlexConnector.activateApplyChangeStatistics()");return}var t=this;n.info("idx - VENDOR ------------ CUSTOMER ----------- USER --------------------------------------");this.aStatistics.forEach(function(e,a){var r=t._formatStatistic(e);n.info(a+" "+e.stableId+" "+r.formattedLayer+" '"+e.text+"' "+r.formattedValue)})}}},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/LinkData", ["sap/ui/comp/library","sap/ui/mdc/link/LinkItem"],function(e,t){"use strict";var i=t.extend("sap.ui.comp.navpopover.LinkData",{metadata:{library:"sap.ui.comp",properties:{target:{type:"string",defaultValue:null},visible:{type:"boolean",defaultValue:true},isSuperiorAction:{type:"boolean"},visibleChangedByUser:{type:"boolean"}}}});i.prototype.getJson=function(){return{key:this.getKey(),href:this.getHref(),internalHref:this.getInternalHref(),text:this.getText(),target:this.getTarget(),description:this.getDescription(),visible:this.getVisible(),press:this.getPress(),isSuperiorAction:this.getIsSuperiorAction()}};i.convert2Json=function(e){return e.map(function(e){return e.getJson()})};i.prototype.setIsSuperiorAction=function(e){return this.setInitiallyVisible(e)};return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Log", ["sap/base/i18n/Localization","sap/ui/base/Object","sap/ui/core/Locale","sap/ui/thirdparty/jquery"],function(t,e,n,jQuery){"use strict";var i=e.extend("sap.ui.comp.navpopover.Log",{constructor:function(){this.reset()}});i.prototype.reset=function(){this._oLog={semanticObjects:[],intents:[]};return this};i.prototype.createSemanticObjectStructure=function(t){this._oLog.semanticObjects[t]={attributes:{},intents:[]}};i.prototype.addIntent=function(t){this._oLog.intents.push(t);return this};i.prototype.addSemanticObjectAttribute=function(t,e,n){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}this._oLog.semanticObjects[t].attributes[e]=n;return this};i.prototype.addSemanticObjectIntent=function(t,e){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}this._oLog.semanticObjects[t].intents.push(e);return this};i.prototype.updateSemanticObjectAttributes=function(t,e,n){if(!this._oLog.semanticObjects[t]){this.createSemanticObjectStructure(t)}var i,r;var o=Object.keys(n);for(var s in n){if(this._oLog.semanticObjects[t].attributes[s]){i=this._oLog.semanticObjects[t].attributes[s].transformations;r=i[i.length-1];if(n[s]!==r["value"]){this._oLog.semanticObjects[t].attributes[s].transformations.push({value:n[s],description:" Value of the attribute has been changed in an event handler.",reason:" Is changed in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."})}}else{this.addSemanticObjectAttribute(t,s,{transformations:[{value:n[s],description:" The attribute has been added in an event handler.",reason:" Is added in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."}]})}}for(var a in e){if(o.indexOf(a)<0&&this._oLog.semanticObjects[t].attributes[a]){this._oLog.semanticObjects[t].attributes[a].transformations.push({value:undefined,description:" The attribute has been removed in an event handler.",reason:" Is removed in the event handler of the event BeforePopoverOpens for the SmartLink control. Please check the implementation if the result is not what you expected."})}}return this};i.prototype.getFormattedText=function(){var e=function(t){return typeof t==="string"?"'"+t+"'":t};var i=function(t,n){var i={value:" "+n+" : ",description:""};t.forEach(function(t,n){i.value=i.value+(n>0?"    ":"")+e(t["value"]);i.description=i.description+"   "+t["description"]+"\n";if(t["reason"]){i.description=i.description+"   "+t["reason"]+"\n"}});return i};var r=function(t){var e="";t.forEach(function(t){e+=" '"+t.text+"' : "+t.intent+"\n"});return e};var o=function(e){try{var i=new n(t.getLanguageTag()).toString();if(typeof window.Intl!=="undefined"){var r=window.Intl.Collator(i,{numeric:true});e.sort(function(t,e){return r.compare(t,e)})}else{e.sort(function(t,e){return t.localeCompare(e,i,{numeric:true})})}}catch(t){}};var s="";for(var a in this._oLog.semanticObjects){s=s+"\n"+" "+a+"\n";if(jQuery.isEmptyObject(this._oLog.semanticObjects[a].attributes)){s+="   No semantic attributes available for semantic object "+a+". Please be aware "+"that without semantic attributes no URL parameters can be created.\n"}else{var c=Object.keys(this._oLog.semanticObjects[a].attributes);o(c);for(var u=0;u<c.length;u++){var h=c[u];var b=i(this._oLog.semanticObjects[a].attributes[h].transformations,h);s+=b.value+"\n";s+=b.description}}if(this._oLog.semanticObjects[a].intents.length){s+="\nIntents returned by FLP for semantic object "+a+":\n";s+=r(this._oLog.semanticObjects[a].intents)}}if(this._oLog.intents.length){s+="\nIntents returned by event handler:\n";s+=r(this._oLog.intents)}return s};return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationContainer", ["sap/m/Link","sap/ui/core/Control","sap/m/VBox","sap/m/HBox","sap/m/Button","sap/m/Title","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/library","sap/m/Image","sap/m/Text","sap/ui/layout/form/SimpleForm","./Factory","./LinkData","sap/ui/model/json/JSONModel","./Util","sap/ui/layout/HorizontalLayout","sap/ui/layout/VerticalLayout","sap/ui/layout/library","sap/ui/comp/personalization/Util","sap/ui/base/ManagedObjectObserver","sap/m/FlexItemData","sap/ui/model/BindingMode","sap/m/library","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/SelectionWrapper","sap/ui/comp/personalization/ColumnWrapper","sap/base/Log","sap/ui/core/CustomData","sap/ui/core/Component"],function(e,t,i,n,a,o,r,s,l,p,u,v,c,g,h,f,d,b,m,y,A,_,P,C,k,I,L,x,N,S){"use strict";var w=m.form.SimpleFormLayout;var M=C.FlexJustifyContent;var D=C.ButtonType;var H=l.TitleLevel;var z=i.extend("sap.ui.comp.navpopover.NavigationContainer",{metadata:{library:"sap.ui.comp",properties:{mainNavigationId:{type:"string",group:"Misc",defaultValue:null},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true}},aggregations:{availableActions:{type:"sap.ui.comp.navpopover.LinkData",multiple:true,singularName:"availableAction"},mainNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false}},associations:{extraContent:{type:"sap.ui.core.Control",multiple:false},component:{type:"sap.ui.core.Element",multiple:false},control:{type:"sap.ui.core.Control",multiple:false}},events:{navigate:{},beforePopoverOpen:{},afterPopoverClose:{}}},renderer:{apiVersion:2}});z.prototype.init=function(){i.prototype.init.call(this);var e=new h({mainNavigationLink:{title:undefined,subtitle:undefined,href:undefined,target:undefined},availableActions:[],enableAvailableActionsPersonalization:undefined,extraContent:undefined,initialAvailableActions:[]});e.setDefaultBindingMode(P.TwoWay);e.setSizeLimit(1e3);this.setModel(e,"$sapuicompNavigationContainer");this._oObserver=new A(this._observeChanges.bind(this));this._oAvailableActionsObserver=new A(this._observeAvailableActionsChanges.bind(this));this._oAvailableActionsObserver.observe(this,{aggregations:["availableActions"]});this.oPersonalizationController=null};z.prototype.applySettings=function(){i.prototype.applySettings.apply(this,arguments);this._createContent()};z.prototype.exit=function(e){if(this._getInternalModel()){this._getInternalModel().destroy()}if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}if(this._oAvailableActionsObserver){this._oAvailableActionsObserver.disconnect();this._oAvailableActionsObserver=null}this._oDefaultExtraConent=null;this._oSeparator=null};z.prototype.openSelectionDialog=function(e,t,i,n,a,o){this.fireBeforePopoverOpen();return this._getFlexRuntimeInfoAPI().then(function(n){return n.waitForChanges({element:this}).then(function(){return new Promise(function(n){var r=this._getInternalModel();var s=f.getStorableAvailableActions(r.getProperty("/initialAvailableActions"));var l=f.getStorableAvailableActions(r.getProperty("/availableActions")).map(function(e){return{columnKey:e.key,visible:e.visible}});var p=new I({press:function(e){this._onLinkPress(e)}.bind(this),columns:s.map(function(t){return new L({label:t.text,selected:t.visible,href:e?undefined:t.href,internalHref:e?undefined:t.internalHref,target:t.target,description:t.description,customData:new N({key:"p13nData",value:{columnKey:t.key}})})})});p._container=this;if(!this.oPersonalizationController){this.oPersonalizationController=new k({resetToInitialTableState:true,table:p,setting:{selection:{visible:true,payload:{callbackSaveChanges:function(e){var t=e&&e.selection&&e.selection.selectionItems||[];if(i){i(t.map(function(e){return{key:e.columnKey,visible:e.visible}}));return Promise.resolve(true)}var n=[];var a=[];t.forEach(function(e){if(e.visible===true){n.push({key:e.columnKey,visible:e.visible})}else{a.push({key:e.columnKey,visible:e.visible})}});return z._saveChanges(n,a,this).then(function(){return true})}.bind(this)}}},dialogConfirmedReset:function(){z._discardChanges(this)}.bind(this),dialogAfterClose:function(){this.fireAfterPopoverClose();n()}.bind(this)})}this.oPersonalizationController.setPersonalizationData({selection:{selectionItems:l}});this.oPersonalizationController.openDialog({contentWidth:"28rem",contentHeight:"35rem",styleClass:""+a,showReset:t,selection:{visible:true}}).then(function(){var e=this.oPersonalizationController._oDialog;if(o){o.addDependent(e)}n()}.bind(this))}.bind(this))}.bind(this))}.bind(this))};z._discardChanges=function(e){return new Promise(function(t){s.load({name:"sap.ui.fl"}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(i){return i.discardChangesForControl(e).then(function(){return t(true)},function(e){x.error("Changes could not be discarded in LRep: "+e);return t(false)})})})})};z._saveChanges=function(e,t,i){return new Promise(function(n){s.load({name:"sap.ui.fl"}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(a){return a.createAndSaveChangesForControl(e,t,i).then(function(){return n(true)},function(e){x.error("Changes could not be saved in LRep: "+e);return n(false)})})})})};z.prototype.getDirectLink=function(){var e=this._getInternalModel();if(e.getProperty("/extraContent")){return null}if(e.getProperty("/mainNavigationLink/href")&&!e.getProperty("/availableActions").length){return this._oHeaderArea.getItems()[0].getContent()}if(e.getProperty("/availableActions").length===1&&!e.getProperty("/mainNavigationLink/href")){return this._oActionArea.getItems()[0].getItems()[0]}return null};z.prototype.hasContent=function(){var e=this._getInternalModel();return!!e.getProperty("/mainNavigationLink/href")||!!e.getProperty("/availableActions").length||!!e.getProperty("/extraContent")};z.prototype.setExtraContent=function(e){this.setAssociation("extraContent",e);if(!e){return this}var t=this._getInternalModel();if(t.getProperty("/extraContent")){this.removeItem(1)}if(typeof e==="string"){e=r.getElementById(e)}this.insertItem(e,1);t.setProperty("/extraContent",e);return this};z.prototype.setMainNavigationId=function(e){this.setProperty("mainNavigationId",e,true);var t=this._getInternalModel();if(typeof e==="string"){t.setProperty("/mainNavigationLink/title",e)}return this};z.prototype.setMainNavigation=function(e){this.setAggregation("mainNavigation",e,true);if(!e){return this}var t=this._getInternalModel();if(e.getHref()){t.setProperty("/mainNavigationLink/href",e.getHref());t.setProperty("/mainNavigationLink/internalHref",e.getInternalHref());t.setProperty("/mainNavigationLink/target",e.getTarget())}if(!t.getProperty("/mainNavigationLink/title")&&t.getProperty("/mainNavigationLink/title")!==""){t.setProperty("/mainNavigationLink/title",e.getText())}t.setProperty("/mainNavigationLink/subtitle",e.getDescription());return this};z.prototype.setEnableAvailableActionsPersonalization=function(e){this.setProperty("enableAvailableActionsPersonalization",e,true);this._getInternalModel().setProperty("/enableAvailableActionsPersonalization",e);return this};z.prototype.onAfterRenderingActionForm=function(){var e=this._getInternalModel();var t=e.getProperty("/extraContent")?e.getProperty("/extraContent").$()[0]:undefined;if(t&&t.scrollHeight>t.clientHeight){this.setFitContainer(false).setJustifyContent(M.Start)}};z.prototype._getFlexRuntimeInfoAPI=function(){return s.load({name:"sap.ui.fl"}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){e(t)})})})};z.prototype._createContent=function(){this.addStyleClass("navigationPopover");this._oHeaderArea=this._createHeaderArea();this._oDefaultExtraConent=new v({layout:w.ResponsiveGridLayout,content:[new o({text:s.getResourceBundleFor("sap.ui.comp").getText("POPOVER_MSG_NO_CONTENT")})]});this._oDefaultExtraConent.addStyleClass("navigationPopoverDefaultExtraContent");this._oSeparator=new i({visible:false});this._oSeparator.addStyleClass("navigationPopoverSeparator");this._oActionArea=new i({items:{path:"/availableActions",templateShareable:false,factory:function(t,n){var a=new e({visible:"{visible}",text:"{text}",href:"{href}",target:"{target}",press:n.getProperty("press"),wrapping:true});var o=new N({key:"internalHref",value:"{internalHref}"});a.addCustomData(o);this._oObserver.observe(a,{bindings:["visible"],properties:["visible"]});return new i({visible:"{visible}",layoutData:new _({styleClass:n.getProperty("description")?"navigationPopoverAvailableLinkGroup":"navigationPopoverAvailableLinkWithoutGroup"}),items:[a,new u({visible:"{visible}",text:"{description}"})]})}.bind(this)}});this._oActionArea.addEventDelegate({onAfterRendering:this.onAfterRenderingActionForm.bind(this)});this._oActionArea.addStyleClass("navigationPopoverAvailableLinks");this._oPersonalizationButton=new n({visible:{parts:[{path:"/enableAvailableActionsPersonalization"}],formatter:function(e){return!!e}},justifyContent:"End",items:new a({type:D.Transparent,text:s.getResourceBundleFor("sap.ui.comp").getText("POPOVER_DEFINE_LINKS"),press:function(e){this.openSelectionDialog(false,true,undefined,true,undefined,e.getSource())}.bind(this)})});this._oPersonalizationButton.addStyleClass("navigationPopoverPersonalizationButton");this.setFitContainer(true);this.setJustifyContent(M.Start);this.addItem(this._oHeaderArea).addItem(this._getInternalModel().getProperty("/extraContent")||this._oDefaultExtraConent).addItem(this._oSeparator).addItem(this._oActionArea).addItem(this._oPersonalizationButton);this._oHeaderArea.setModel(this._getInternalModel());this._oSeparator.setModel(this._getInternalModel());this._oActionArea.setModel(this._getInternalModel());this._oPersonalizationButton.setModel(this._getInternalModel())};z.prototype._createHeaderArea=function(){var e=this._createTitle();var t=this._createSubTitle();var n=new i({items:[e,t],visible:{path:"/mainNavigationLink/title",formatter:function(e){return!!e}}});n.addStyleClass("navigationPopoverTitleH1");n.addStyleClass("navigationPopoverHeader");return n};z.prototype._createSubTitle=function(){var e=new u({text:{path:"/mainNavigationLink/subtitle"},visible:{path:"/mainNavigationLink/subtitle",formatter:function(e){return!!e}}});return e};z.prototype._createTitle=function(){var t=new e({href:{path:"/mainNavigationLink/href"},text:{path:"/mainNavigationLink/title"},target:{path:"/mainNavigationLink/target"},visible:{path:"/mainNavigationLink/title",formatter:function(e){return!!e}},enabled:{path:"/mainNavigationLink/href",formatter:function(e){return!!e}},press:this._onLinkPress.bind(this),wrapping:true});var i=new N({key:"internalHref",value:"{/mainNavigationLink/internalHref}"});t.addCustomData(i);var n=new o({level:H.Auto,content:t});n.addStyleClass("sapFontHeader5Size");this._oObserver.observe(n,{bindings:["visible"],properties:["visible"]});return n};z.prototype._getControl=function(){var e=this.getAssociation("control");if(typeof e==="string"){e=r.getElementById(e)}return e};z.prototype._onLinkPress=function(e){var t=e.getId()==="press"?e.getSource():e.getParameters().getSource();var i=e.getParameters().ctrlKey||e.getParameters().metaKey;if(t.getTarget()!=="_blank"&&!i){e.preventDefault();this.fireNavigate({text:t.getText(),href:t.getHref(),internalHref:t.data("internalHref")})}};z.prototype._getComponent=function(){var e=this.getComponent();if(typeof e==="string"){e=S.getComponentById(e)}return e};z.prototype._observeAvailableActionsChanges=function(e){var t;if(e.object.isA("sap.ui.comp.navpopover.NavigationContainer")){switch(e.name){case"availableActions":t=this._getInternalModel();var i=e.child?[e.child]:e.children;i.forEach(function(i){switch(e.mutation){case"insert":if(!i||!i.isA("sap.ui.comp.navpopover.LinkData")){return}i.setPress(this._onLinkPress.bind(this));this._oAvailableActionsObserver.observe(i,{properties:["visible"]});t.setProperty("/initialAvailableActions/"+this.indexOfAvailableAction(i)+"/",i.getJson());t.setProperty("/availableActions/"+this.indexOfAvailableAction(i)+"/",i.getJson());break;case"remove":x.error("Deletion of AvailableActions is not supported");break;default:x.error("Mutation '"+e.mutation+"' is not supported jet.")}}.bind(this));break;default:x.error("The '"+e.name+"' of NavigationContainer is not supported yet.")}}else if(e.object.isA("sap.ui.comp.navpopover.LinkData")){switch(e.name){case"visible":var n=e.object;t=this._getInternalModel();var a=-1;t.getProperty("/availableActions").some(function(e,t){if(n.getKey()===e.key){a=t;return true}});if(a<0){x.error("The available action with key '"+n.getKey()+"' does not exist in availableActions.")}if(n.getVisibleChangedByUser()){t.setProperty("/availableActions/"+a+"/visible",n.getVisible())}else{t.setProperty("/initialAvailableActions/"+a+"/visible",n.getVisible());t.setProperty("/availableActions/"+a+"/visible",n.getVisible())}break;default:x.error("The '"+e.name+"' of LinkData is not supported yet.")}}};z.prototype._observeChanges=function(e){if((e.type==="property"||e.type==="binding")&&e.name==="visible"){var t=this._getInternalModel().getProperty("/availableActions");var i=t.filter(function(e){return e.visible===true});this._oSeparator.setVisible(i.length>0||!!this._getInternalModel().getProperty("/enableAvailableActionsPersonalization"));this._oActionArea.setVisible(i.length>0);if(this.hasContent()&&!this._getInternalModel().getProperty("/extraContent")){this._oDefaultExtraConent.setVisible(false)}}};z.prototype._getInternalModel=function(){return this.getModel("$sapuicompNavigationContainer")};return z});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationPopover", ["sap/m/Link","sap/m/ResponsivePopover","sap/m/Button","sap/m/Title","sap/m/Image","sap/m/Text","sap/m/VBox","sap/m/HBox","./Factory","./LinkData","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/model/json/JSONModel","sap/ui/base/ManagedObjectObserver","sap/m/FlexItemData","sap/ui/model/BindingMode","sap/ui/Device","sap/m/library","sap/base/Log","sap/ui/core/CustomData","sap/ui/core/Component"],function(t,e,n,i,a,o,r,s,l,p,h,g,u,v,c,d,f,b,y,m,A){"use strict";var P=b.PlacementType;var C=b.FlexJustifyContent;var _=b.ButtonType;var x=e.extend("sap.ui.comp.navpopover.NavigationPopover",{metadata:{library:"sap.ui.comp",properties:{semanticObjectName:{type:"string",group:"Misc",defaultValue:null},semanticAttributes:{type:"object",group:"Misc",defaultValue:null},appStateKey:{type:"string",group:"Misc",defaultValue:null},mainNavigationId:{type:"string",group:"Misc",defaultValue:null},availableActionsPersonalizationText:{type:"string",group:"Misc",defaultValue:undefined}},aggregations:{availableActions:{type:"sap.ui.comp.navpopover.LinkData",multiple:true,singularName:"availableAction"},mainNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData",multiple:false}},associations:{source:{type:"sap.ui.core.Control",multiple:false},extraContent:{type:"sap.ui.core.Control",multiple:false},component:{type:"sap.ui.core.Element",multiple:false}},events:{targetsObtained:{},navigate:{parameters:{text:{type:"string"},href:{type:"string"}}},availableActionsPersonalizationPress:{}}},renderer:{apiVersion:2}});x.prototype.init=function(){e.prototype.init.call(this);var t=new u({mainNavigationLink:{title:undefined,subtitle:undefined,href:undefined,target:undefined},ownNavigation:undefined,availableActions:[],availableActionsPersonalizationText:undefined,extraContent:undefined});t.setDefaultBindingMode(d.TwoWay);t.setSizeLimit(1e3);this.setModel(t,"$sapuicompNavigationPopover");this._bUseExternalContent=false;this.addStyleClass("navigationPopover");this.setContentWidth("380px");this.setHorizontalScrolling(false);this.setShowHeader(f.system.phone);this.setPlacement(P.Auto);this._oObserver=null};x.prototype.applySettings=function(t){if(t&&t.customData&&t.customData.getProperty("key")==="useExternalContent"){this._bUseExternalContent=true}this._createContent();e.prototype.applySettings.apply(this,arguments)};x.prototype.exit=function(t){if(this._getInternalModel()){this._getInternalModel().destroy()}if(this._oObserver){this._oObserver.disconnect();this._oObserver=null}e.prototype.exit.apply(this,arguments)};x.prototype.retrieveNavTargets=async function(){y.warning("sap.ui.comp.navpopover.NavigationPopover#retrieveNavTargets called. This function is deprecated since UI5 version 1.42!");var t=await l.getServiceAsync("CrossApplicationNavigation");var e=await l.getServiceAsync("URLParsing");if(!t||!e){y.error("Service 'CrossApplicationNavigation' could not be obtained");this.fireTargetsObtained();return}var n=this;this.setMainNavigation(null);this.setOwnNavigation(null);this.removeAllAvailableActions();var i=t.getLinks({semanticObject:this.getSemanticObjectName(),params:this.getSemanticAttributes(),appStateKey:this.getAppStateKey(),ui5Component:this._getComponent(),sortResultOnTexts:true});i.done(function(i){if(!i||!i.length){n.fireTargetsObtained();return}var a=t.hrefForExternal();if(a&&a.indexOf("?")!==-1){a=a.split("?")[0]}i.forEach(function(t){if(t.intent.indexOf(a)===0){n.setOwnNavigation(new p({href:t.intent,text:t.text}));return}var i=e.parseShellHash(t.intent);if(i.action&&i.action==="displayFactSheet"){n.setMainNavigation(new p({href:t.intent,text:g.getResourceBundleFor("sap.ui.comp").getText("POPOVER_FACTSHEET")}));return}n.addAvailableAction(new p({href:t.intent,text:t.text}))});n.fireTargetsObtained()});i.fail(function(){y.error("'retrieveNavTargets' failed")})};x.prototype.show=function(t){var e=t||this._getControl();if(!e){y.error("no source assigned");return}this.openBy(e)};x.prototype.getDirectLink=function(){if(this._bUseExternalContent){return this.getContent()[0].getDirectLink()}var t=this._getInternalModel();if(t.getProperty("/extraContent")){return null}if(t.getProperty("/mainNavigationLink/href")&&!t.getProperty("/availableActions").length){return this._oHeaderArea.getItems()[0]}if(t.getProperty("/availableActions").length===1&&!t.getProperty("/mainNavigationLink/href")){return this._oActionArea.getItems()[0].getItems()[0]}return null};x.prototype.hasContent=function(){if(this._bUseExternalContent){return this.getContent()[0].hasContent()}var t=this._getInternalModel();return!!t.getProperty("/mainNavigationLink/href")||!!t.getProperty("/availableActions").length||!!t.getProperty("/extraContent")};x.prototype.setMainNavigationId=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setProperty("mainNavigationId",t,true);var e=this._getInternalModel();if(typeof t==="string"){e.setProperty("/mainNavigationLink/title",t)}return this};x.prototype.setAvailableActionsPersonalizationText=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setProperty("availableActionsPersonalizationText",t,true);var e=this._getInternalModel();e.setProperty("/availableActionsPersonalizationText",t);return this};x.prototype.setExtraContent=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var e=this._getInternalModel();if(e.getProperty("/extraContent")){this._getContentContainer().removeItem(1)}if(typeof t==="string"){t=h.getElementById(t)}this._getContentContainer().insertItem(t,1);this.setAssociation("extraContent",t);e.setProperty("/extraContent",t);return this};x.prototype.setMainNavigation=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.setAggregation("mainNavigation",t,true);if(!t){return this}var e=this._getInternalModel();if(t.getHref()){e.setProperty("/mainNavigationLink/href",t.getHref());e.setProperty("/mainNavigationLink/internalHref",t.getInternalHref());e.setProperty("/mainNavigationLink/target",t.getTarget())}if(!e.getProperty("/mainNavigationLink/title")&&e.getProperty("/mainNavigationLink/title")!==""){e.setProperty("/mainNavigationLink/title",t.getText())}e.setProperty("/mainNavigationLink/subtitle",t.getDescription());return this};x.prototype.addAvailableAction=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.addAggregation("availableActions",t);if(!t){return this}t.setPress(this._onLinkPress.bind(this));var e=this._getInternalModel();e.setProperty("/availableActions/"+this.indexOfAvailableAction(t)+"/",t.getJson());return this};x.prototype.insertAvailableAction=function(t,e){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}this.insertAggregation("availableActions",t,e);if(!t){return this}t.setPress(this._onLinkPress.bind(this));var n=this._getInternalModel();this.getAvailableActions().forEach(function(t,e){n.setProperty("/availableActions/"+e+"/",t.getJson())});return this};x.prototype.removeAvailableAction=function(t){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var e=this.indexOfAvailableAction(t);if(e>-1){var n=this._getInternalModel();n.getData().availableActions.splice(e,1);n.refresh(true)}t=this.removeAggregation("availableActions",t);return t};x.prototype.removeAllAvailableActions=function(){if(this._bUseExternalContent){throw"The API should not be used in case that the external content has been set"}var t=this.removeAllAggregation("availableActions");var e=this._getInternalModel();e.setProperty("/availableActions",[]);e.refresh(true);return t};x.prototype.onAfterRenderingActionForm=function(){var t=this._getInternalModel();var e=t.getProperty("/extraContent")?t.getProperty("/extraContent").$()[0]:undefined;if(e&&e.scrollHeight>e.clientHeight){this._getContentContainer().setFitContainer(false).setJustifyContent(C.Start)}};x.prototype._createContent=function(){if(this._bUseExternalContent){return}var e=this;var i=new t({href:{path:"/mainNavigationLink/href"},text:{path:"/mainNavigationLink/title"},target:{path:"/mainNavigationLink/target"},visible:{path:"/mainNavigationLink/title",formatter:function(t){return!!t}},enabled:{path:"/mainNavigationLink/href",formatter:function(t){return!!t}},press:this._onLinkPress.bind(this),wrapping:true});var a=new m({key:"internalHref",value:"/mainNavigationLink/internalHref"});i.addCustomData(a);i.addStyleClass("sapFontHeader5Size");var l=new o({text:{path:"/mainNavigationLink/subtitle"},visible:{path:"/mainNavigationLink/subtitle",formatter:function(t){return!!t}}});this._oHeaderArea=new r({items:[i,l],visible:{path:"/mainNavigationLink/title",formatter:function(t){return!!t}}});this._oHeaderArea.addStyleClass("navigationPopoverTitleH1");this._oHeaderArea.addStyleClass("navigationPopoverHeader");this._oHeaderArea.setModel(this._getInternalModel());this._oObserver=new v(function(t){if(t.type==="property"&&t.name==="visible"){var e=this._getInternalModel().getProperty("/availableActions").filter(function(t){return t.visible===true});p.setVisible(e.length>0||this._getInternalModel().getProperty("/enableAvailableActionsPersonalization"));this._oActionArea.setVisible(e.length>0)}}.bind(this));var p=new r;p.setModel(this._getInternalModel());p.addStyleClass("navigationPopoverSeparator");this._oActionArea=new r({items:{path:"/availableActions",templateShareable:false,factory:function(e,n){var i=new t({visible:"{visible}",text:"{text}",href:"{href}",target:"{target}",press:n.getProperty("press"),wrapping:true});var a=new m({key:"internalHref",value:"{internalHref}"});i.addCustomData(a);this._oObserver.observe(i,{properties:["visible"]});return new r({visible:"{visible}",layoutData:new c({styleClass:n.getProperty("description")?"navigationPopoverAvailableLinkGroup":"navigationPopoverAvailableLinkWithoutGroup"}),items:[i,new o({visible:"{visible}",text:"{description}"})]})}.bind(this)}});this._oActionArea.addEventDelegate({onAfterRendering:this.onAfterRenderingActionForm.bind(this)});this._oActionArea.addStyleClass("navigationPopoverAvailableLinks");this._oActionArea.setModel(this._getInternalModel());this._oPersonalizationButton=new s({visible:{parts:[{path:"/enableAvailableActionsPersonalization"}],formatter:function(t){return!!t}},justifyContent:"End",items:new n({type:_.Transparent,text:{path:"/availableActionsPersonalizationText"},press:function(){e.fireAvailableActionsPersonalizationPress()}})});this._oPersonalizationButton.setModel(this._getInternalModel());this._oPersonalizationButton.addStyleClass("navigationPopoverPersonalizationButton");var h=new r({fitContainer:true,justifyContent:C.Start,items:[this._oHeaderArea]});if(this._getInternalModel().getProperty("/extraContent")){h.addItem(this._getInternalModel().getProperty("/extraContent"))}h.addItem(p).addItem(this._oActionArea).addItem(this._oPersonalizationButton);this.addContent(h)};x.prototype._onLinkPress=function(t){this.fireNavigate({text:t.getSource().getText(),href:t.getSource().getHref(),internalHref:t.getSource().data("internalHref")})};x.prototype._getControl=function(){var t=this.getAssociation("source");if(typeof t==="string"){t=h.getElementById(t)}return t};x.prototype._getComponent=function(){var t=this.getComponent();if(typeof t==="string"){t=A.getComponentById(t)}return t};x.prototype._getContentContainer=function(){return this.getContent()[0]};x.prototype._getInternalModel=function(){return this.getModel("$sapuicompNavigationPopover")};return x});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/NavigationPopoverHandler", ["sap/ui/core/Element","sap/ui/core/Lib","sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/base/ManagedObject","./SemanticObjectController","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode","sap/ui/core/Control","./Factory","./NavigationPopover","./Util","sap/m/VBox","./LinkData","sap/m/MessageBox","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","./NavigationContainer","./ContactDetailsController","./Log","sap/ui/core/InvisibleText","sap/ui/core/CustomData","sap/base/Log","sap/base/util/isPlainObject","sap/ui/core/Component","sap/base/util/merge","sap/base/strings/whitespaceReplacer"],function(t,e,jQuery,i,n,a,o,r,s,l,c,p,u,g,v,d,f,m,b,h,y,P,A,C,N,_,O){"use strict";var S=n.extend("sap.ui.comp.navpopover.NavigationPopoverHandler",{metadata:{library:"sap.ui.comp",properties:{semanticObject:{type:"string",defaultValue:null},additionalSemanticObjects:{type:"string[]",defaultValue:[]},semanticObjectController:{type:"any",defaultValue:null},fieldName:{type:"string",defaultValue:null},semanticObjectLabel:{type:"string",defaultValue:null},mapFieldToSemanticObject:{type:"boolean",defaultValue:true},contactAnnotationPath:{type:"string",defaultValue:undefined},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true},beforeNavigationCallback:{type:"function"},navigationTargetsObtainedCallback:{type:"function"}},aggregations:{_popover:{type:"sap.ui.comp.navpopover.NavigationPopover",multiple:false,visibility:"hidden"}},associations:{control:{type:"sap.ui.core.Control",multiple:false}},events:{beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},innerNavigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}}}}});S.prototype.init=function(){this._oPopover=null;this._oContactDetailsController=new b;var t=new o({semanticObject:undefined,semanticAttributes:undefined,appStateKey:undefined,mainNavigationId:undefined,navigationTarget:{mainNavigation:undefined,enableAvailableActionsPersonalization:undefined,extraContent:undefined},availableActions:[]});t.setDefaultBindingMode(r.TwoWay);t.setSizeLimit(1e3);this.setModel(t,"$sapuicompNavigationPopoverHandler");this._oRTANavigationHandling={enabled:false,initialValue:undefined};this._oLog=A.getLevel()>=A.Level.INFO?new h:undefined};S.prototype.applySettings=function(t){n.prototype.applySettings.apply(this,arguments);this._setSemanticAttributes(this._calculateSemanticAttributes(null))};S.prototype.openPopover=function(t){var e=this;return this._getPopover().then(function(i){var n=i.getDirectLink();if(n){e._fireInnerNavigate({text:n.getText(),href:n.getHref(),internalHref:n.data("internalHref")});e._destroyPopover();return}i.show(t)})};S.prototype.getSemanticObjectValue=function(){var t=this._getSemanticAttributes();if(t){return t[this.getSemanticObject()][this.getSemanticObject()]}return undefined};S.prototype.getNavigationPopoverStableId=function(){var e=t.getElementById(this.getControl());if(!e){A.error("NavigationPopoverHandler: Stable ID could not be determined because the control is undefined");return undefined}var i=this._getComponent(e);if(!i){A.error("NavigationPopoverHandler: Stable ID could not be determined because the app component is not defined for control '"+e.getId()+"'");return undefined}var n=this.getModel("$sapuicompNavigationPopoverHandler").getProperty("/semanticObject");if(!n){A.error("NavigationPopoverHandler: Stable ID could not be determined because no default semantic object is defined");return undefined}var a=[n].concat(this.getAdditionalSemanticObjects());p.sortArrayAlphabetical(a);var o=a.join("--");return i.createId("sapuicompnavpopoverNavigationPopover---"+o)};S.prototype.updateBindingContext=function(){var t=this.getBindingContext("$sapuicompNavigationPopoverHandler");s.prototype.updateBindingContext.apply(this,arguments);var e=this.getBindingContext("$sapuicompNavigationPopoverHandler");if(e&&e!==t){this._setSemanticAttributes(this._calculateSemanticAttributes(null));this._destroyPopover()}};S.prototype.setSemanticObject=function(t){this._destroyPopover();this.setProperty("semanticObject",t);this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/semanticObject",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype._setSemanticAttributes=function(t){this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/semanticAttributes",t)};S.prototype._getSemanticAttributes=function(){return this.getModel("$sapuicompNavigationPopoverHandler").getProperty("/semanticAttributes")};S.prototype.setEnableAvailableActionsPersonalization=function(t){this.setProperty("enableAvailableActionsPersonalization",t);this.getModel("$sapuicompNavigationPopoverHandler").setProperty("/navigationTarget/enableAvailableActionsPersonalization",t);return this};S.prototype.setFieldName=function(t){this.setProperty("fieldName",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype.setControl=function(t){this.setAssociation("control",t);this.setModel(t.getModel());this._destroyPopover();this._updateSemanticObjectController();this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype.setMapFieldToSemanticObject=function(t){this.setProperty("mapFieldToSemanticObject",t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype.setSemanticObjectController=function(t){this._updateSemanticObjectController(t);this._setSemanticAttributes(this._calculateSemanticAttributes(null));return this};S.prototype.exit=function(){this._oContactDetailsController.destroy();this._destroyPopover();if(this.getSemanticObjectController()){this.getSemanticObjectController().unregisterControl(this)}if(this.getModel("$sapuicompNavigationPopoverHandler")){this.getModel("$sapuicompNavigationPopoverHandler").destroy()}this._oRTANavigationHandling=undefined};S.prototype._initModel=function(){var i=this;var n;var a=this.getSemanticObject();var o=this.getAdditionalSemanticObjects();var r=p.getContactAnnotationPath(this,this.getSemanticObjectController());var s=t.getElementById(this.getControl());if(!s){A.error("sap.ui.comp.navpopover.NavigationPopoverHandler: No control provided, popover cannot be attached.")}var l=s&&s.getBindingContext()?s.getBindingContext().getPath():null;if(!l){A.warning("sap.ui.comp.navpopover.NavigationPopoverHandler: Binding Context is null. Please be aware that without binding context no semantic attributes can be calculated. Without semantic attributes no URL parameters can be created.")}var c=this.getModel();var u=this._getComponent(s);var v=s&&s.getId();var d,f,m;if(this._oLog){this._oLog.reset()}return e.load({name:"sap.ui.fl"}).then(function(){return p.retrieveSemanticObjectMapping(i.getFieldName(),c,l)}).then(function(t){i._setSemanticAttributes(i._calculateSemanticAttributes(t,i._oLog));n=i._getSemanticAttributes();return i._fireBeforePopoverOpens(n,a,v,i._oLog)}).then(function(t){n=t.semanticAttributes;i._setSemanticAttributes(n);f=i.getSemanticObjectValue();d=s&&s._getTextOfDom&&s._getTextOfDom()||i.getSemanticObjectValue();i.getModel("$sapuicompNavigationPopoverHandler").setProperty("/appStateKey",t.appStateKey);return p.retrieveNavigationTargets(a,o,t.appStateKey,u,n,d,i.getFieldName(),c,l,i._oLog)}).then(function(t){m=t;i._oContactDetailsController.setModel(c);return i._oContactDetailsController.getBindingPath4ContactAnnotation(l,r,f)}).then(function(t){var e=i._oContactDetailsController.getContactDetailsContainers(t);return i._fireNavigationTargetsObtained(d,a,n,v,e,m,i._oLog)}).then(function(t){var e=t.availableActions;var n=[];if(e){e.forEach(function(t){if(t.getText()){t.setText(O(t.getText()))}if(t.getHref()){t.setInternalHref(t.getHref());n.push(i._convertToExternal(t.getHref()).then(function(e){t.setHref(e)}))}})}var a=t.mainNavigation;if(a){if(a.getDescription()){a.setDescription(O(a.getDescription()))}if(a.getText()){a.setText(O(a.getText()))}if(a.getHref()){a.setInternalHref(a.getHref());n.push(i._convertToExternal(a.getHref()).then(function(t){a.setHref(t)}))}}if(t.mainNavigationId){t.mainNavigationId=O(t.mainNavigationId)}return Promise.all(n).then(function(){var n=i.getModel("$sapuicompNavigationPopoverHandler");n.setProperty("/mainNavigationId",t.mainNavigationId);n.setProperty("/navigationTarget/mainNavigation",a);n.setProperty("/navigationTarget/extraContent",t.extraContent);n.setProperty("/availableActions",i._updateVisibilityOfAvailableActions(g.convert2Json(e)));n.setProperty("/navigationTarget/enableAvailableActionsPersonalization",i._getEnableAvailableActionsPersonalization(n.getProperty("/availableActions")));if(A.getLevel()>=A.Level.TRACE){A.info("sap.ui.comp.NavigationPopoverHandler: calculation of semantic attributes\n---------------------------------------------\nBelow you can see detailed information regarding semantic attributes which have been calculated for one or more semantic objects defined in a SmartLink control. Semantic attributes are used to create the URL parameters. Additionally you can see all links containing the URL parameters.\n"+i._getLogFormattedText())}})})};S.prototype._initPopover=function(){var e=this;return this._initModel().then(function(){var i=e.getModel("$sapuicompNavigationPopoverHandler");var n=e._createPopover();n.setModel(i,"$sapuicompNavigationPopoverHandler");var a=t.getElementById(e.getControl());if(a){a.addDependent(n)}return n})};S.prototype._initNavigationContainer=function(){var e=this;return this._initModel().then(function(){var i=e.getModel("$sapuicompNavigationPopoverHandler");var n=e._createNavigationContainer();n.setModel(i,"$sapuicompNavigationPopoverHandler");var a=t.getElementById(e.getControl());if(a){a.addDependent(n)}return n})};S.prototype._getPopover=function(){if(!this._oPopover){return this._initPopover()}else{return Promise.resolve(this._oPopover)}};S.prototype._getNavigationContainer=function(){return this._initNavigationContainer().then(function(t){return t})};S.prototype._destroyPopover=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};S.prototype._createPopover=function(){if(this._oPopover){return this._oPopover}var t=this._createNavigationContainer();this._oPopover=new c({customData:new P({key:"useExternalContent"}),content:[t],title:"{$sapuicompNavigationPopoverHandler>/mainNavigationId}",source:this.getControl(),beforeClose:function(){this.removeAllContent().forEach(function(t){t.destroy()})},afterClose:this._destroyPopover.bind(this),ariaLabelledBy:t.getExtraContent()||t._oHeaderArea.getItems()[0].getContent().getId()});this.setAggregation("_popover",this._oPopover);return this._oPopover};S.prototype._createNavigationContainer=function(){var e=this.getNavigationPopoverStableId();if(!e){A.error("NavigationPopoverHandler: Due to undefined stable ID the button of action personalization is set to disabled")}var i=t.getElementById(e);if(i){if(i.getParent()&&i.getParent().getParent()&&i.getParent().getParent().isA("sap.ui.comp.navpopover.NavigationPopover")){i.getParent().getParent().close();if(!i.isDestroyed()){i.destroy()}}else{A.error("Duplicate ID '"+e+"'. The instance of NavigationContainer should be destroyed first in order to avoid duplicate creation of NavigationContainer with stable ID.");throw"Duplicate ID"}}var n=this.getModel("$sapuicompNavigationPopoverHandler");return new m(e,{mainNavigationId:"{$sapuicompNavigationPopoverHandler>/mainNavigationId}",mainNavigation:n.getProperty("/navigationTarget/mainNavigation"),availableActions:{path:"$sapuicompNavigationPopoverHandler>/availableActions",templateShareable:false,template:new g({key:"{$sapuicompNavigationPopoverHandler>key}",href:"{$sapuicompNavigationPopoverHandler>href}",internalHref:"{$sapuicompNavigationPopoverHandler>internalHref}",text:"{$sapuicompNavigationPopoverHandler>text}",target:"{$sapuicompNavigationPopoverHandler>target}",description:"{$sapuicompNavigationPopoverHandler>description}",visible:"{$sapuicompNavigationPopoverHandler>visible}"})},extraContent:n.getProperty("/navigationTarget/extraContent")?n.getProperty("/navigationTarget/extraContent").getId():undefined,component:this._getComponent(t.getElementById(this.getControl())),enableAvailableActionsPersonalization:"{$sapuicompNavigationPopoverHandler>/navigationTarget/enableAvailableActionsPersonalization}",beforePopoverOpen:function(){if(this._oPopover){this._oPopover.setModal(true)}}.bind(this),afterPopoverClose:function(){if(this._oPopover){this._oPopover.setModal(false)}}.bind(this),navigate:this._onNavigate.bind(this),control:this.getControl()})};S.prototype._convertToExternal=function(t){return l.getServiceAsync("Navigation").then(function(e){if(!e){return Promise.resolve(t)}return e.getHref({target:{shellHash:t}},this._getComponent())}.bind(this))};S.prototype._fireBeforePopoverOpens=function(t,e,i,n){var a=this;return new Promise(function(o){var r={semanticAttributes:t,appStateKey:undefined};if(!a.hasListeners("beforePopoverOpens")){o(r);return}var s=function(t){var e=Object.keys(t).filter(function(e){return!jQuery.isEmptyObject(t[e])});return!!e.length};a.fireBeforePopoverOpens({originalId:i,semanticObject:e,semanticAttributes:!jQuery.isEmptyObject(t[e])?t[e]:null,semanticAttributesOfSemanticObjects:s(t)?t:null,setSemanticAttributes:function(t,i){i=i||e;r.semanticAttributes=r.semanticAttributes||{};if(n){n.updateSemanticObjectAttributes(i,r.semanticAttributes[i],t)}r.semanticAttributes[i]=t},setAppStateKey:function(t){r.appStateKey=t},open:function(){return o(r)}})})};S.prototype._fireNavigationTargetsObtained=async function(t,e,i,n,a,o,r){var s=this;const l=(t,e)=>{e??=t;const i=e.mainNavigationId;if(i!==undefined&&i!==null){t.mainNavigationId=i}const n=e.mainNavigation;if(n!==undefined){t.mainNavigation=n;if(r&&n){r.addIntent({text:n.getText(),intent:n.getHref()})}}const a=e.actions;if(a){a.forEach(function(t){if(t.getKey()===undefined){A.error("'key' attribute of 'availableAction' '"+t.getText()+"' is undefined. Links without 'key' can not be persisted.");A.warning("The 'visible' attribute of 'availableAction' '"+t.getText()+"' is set to 'true'");t.setVisible(true)}if(r&&t){r.addIntent({text:t.getText(),intent:t.getHref()})}});t.availableActions=a}const o=e.extraContent;if(o){t.extraContent=o}return t};const c={mainNavigationId:t,extraContent:a.length?new u({items:a}):undefined};const p={mainNavigation:o.mainNavigation,actions:o.availableActions,ownNavigation:o.ownNavigation,popoverForms:a,semanticObject:e,semanticAttributes:i?i[e]:i,originalId:n};const v=this.getNavigationTargetsObtainedCallback();if(v){if(s.hasListeners("navigationTargetsObtained")){s.fireNavigationTargetsObtained({...p,show:function(){A.warning(`sap.ui.comp.navpopover.NavigationPopoverHandler: "navigationTargetsObtained" event handling will be ignored as "navigationTargetsObtainedCallback" property is set.`)}})}const t={...p,...c};const e=await v(t);return l(t,e)}return new Promise(function(t){const e={...o,...c};if(!s.hasListeners("navigationTargetsObtained")){t(e);return}s.fireNavigationTargetsObtained({...p,show:function(i,n,a,o){if(arguments.length>0&&!(typeof i==="string"||n instanceof g||Array.isArray(a))&&o===undefined){o=a;a=n;n=i;i=undefined}return t(l(e,{mainNavigationId:i,mainNavigation:n,actions:a,extraContent:o}))}})})};S.prototype._onNavigate=function(t){var e=t.getParameters();this._fireInnerNavigate({text:e.text,href:e.href,internalHref:e.internalHref})};S.prototype._fireInnerNavigate=function(e){var i=t.getElementById(this.getControl());var n=this.getSemanticObject();var a=this._getSemanticAttributes();if(this.getAdditionalSemanticObjects().length>0){var o=this.getAdditionalSemanticObjects().find(function(t){return e.href.includes(t)});if(o){n=o}}var r={text:e.text,href:e.href,originalId:i?i.getId():undefined,semanticObject:n,semanticAttributes:a?a[n]:a};if(this.getBeforeNavigationCallback()){this.getBeforeNavigationCallback()(_({},r)).then(function(t){if(t===true){r.internalHref=e.internalHref;this.fireInnerNavigate(r);if(!this.getSemanticObjectController()){p.navigate(e.internalHref)}}}.bind(this))}else{r.internalHref=e.internalHref;this.fireInnerNavigate(r);if(!this.getSemanticObjectController()){p.navigate(e.internalHref)}}};S.prototype._getComponent=function(t){if(!t){return null}var e=t.getParent();while(e){if(e instanceof N){if(e&&e.getAppComponent){e=e.getAppComponent()}return e}e=e.getParent()}return N.getComponentById(N.getOwnerIdFor(t))};S.prototype.getAppComponent=function(){return this._getComponent(t.getElementById(this.getControl()))};S.prototype._getBindingContextObject=function(){var e=t.getElementById(this.getControl());var i=this.getBindingContext()||e&&e.getBindingContext();return i?i.getObject(i.getPath()):null};S.prototype._getLogFormattedText=function(){return this._oLog?this._oLog.getFormattedText():"No logging data available"};S.prototype._calculateSemanticAttributes=function(t,e){var i=this._getBindingContextObject();var n=this.getFieldName();var a=this;var o=["",this.getSemanticObject()].concat(this.getAdditionalSemanticObjects());var r={};o.forEach(function(o){r[o]={};var s=a._getMappingRules(o,t,i);for(var l in i){var c=null,p=null;if(e&&o){c={transformations:[]};e.addSemanticObjectAttribute(o,l,c)}if(i[l]===undefined||i[l]===null){if(c){c.transformations.push({value:i[l],description:" Undefined and null values have been removed in NavigationPopoverHandler."})}continue}if(C(i[l])){if(c){c.transformations.push({value:i[l],description:" Plain objects has been removed in NavigationPopoverHandler."})}continue}var u=s[l];if(c&&l!==u){p=t?{value:undefined,description:" The attribute "+l+" has been renamed to "+u+" in NavigationPopoverHandler.",reason:" A com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation is defined for semantic object "+o+" with source attribute "+l+" and target attribute "+u+". You can modify the annotation if the mapping result is not what you expected."}:{value:undefined,description:" The attribute "+l+" has been renamed to "+u+" in NavigationPopoverHandler.",reason:" The property mapFieldToSemanticObject is set to true. Attribute "+l+" is mapped to "+u+". (semantic object is "+a.getSemanticObject()+", field name is "+a.getFieldName()+"). If this is not what you expected, you can set the property to false or define a com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation."}}var g=i[l];if(r[o][u]){if(i[n]){if(u===s[a.getFieldName()]){g=i[n]}else{A.error("The attribute "+l+" can not be renamed to the attribute "+u+" due to a clash situation. This can lead to wrong navigation later on.")}}}r[o][u]=g;if(c){c.transformations.push({value:i[l],description:" The attribute "+l+" with the value "+i[l]+" is taken from the binding context in NavigationPopoverHandler."});if(p){c.transformations.push(p);e.addSemanticObjectAttribute(o,u,{transformations:[{value:g,description:" The attribute "+u+" with the value "+g+" has been added due to a mapping rule regarding the attribute "+l+" in NavigationPopoverHandler."}]})}}}});return r};S.prototype._getMappingRules=function(t,e,i){var n=this.getMapFieldToSemanticObject();if(this.getSemanticObjectController()&&this.getSemanticObjectController().getMapFieldToSemanticObject()!==undefined){n=this.getSemanticObjectController().getMapFieldToSemanticObject()}var a;var o={};if(e){for(a in e[t]){if(typeof e[t][a]==="string"){o[a]=e[t][a]}}}else if(n){if(this.getSemanticObjectController()){var r=this.getSemanticObjectController().getFieldSemanticObjectMap();for(a in r){o[a]=r[a]}}if(this.getFieldName()&&this.getSemanticObject()){o[this.getFieldName()]=this.getSemanticObject()}}for(a in i){if(!o.hasOwnProperty(a)){o[a]=a}}return o};S.prototype._updateSemanticObjectController=function(e){var i=this.getProperty("semanticObjectController");var n=t.getElementById(this.getControl());e=e||this.getSemanticObjectController()||this._getSemanticObjectControllerOfControl(n);if(e&&n&&e.isControlRegistered(n)){e.unregisterControl(this)}if(e!==i&&i){i.unregisterControl(this)}this.setProperty("semanticObjectController",e);if(e&&!e.isControlRegistered(n)){e.registerControl(this)}};S.prototype._getSemanticObjectControllerOfControl=function(t){if(!t){return undefined}var e;var i=t.getParent();while(i){if(i.getSemanticObjectController){e=i.getSemanticObjectController();if(e){this.setSemanticObjectController(e);break}}i=i.getParent()}return e};S.prototype._updateVisibilityOfAvailableActions=function(t){var e=this._oRTANavigationHandling.initialValue===undefined?this._getEnableAvailableActionsPersonalization(t):this._oRTANavigationHandling.initialValue;if(!e){return t}var i=p.getStorableAvailableActions(t);var n=i.some(function(t){return!!t.isSuperiorAction});i.forEach(function(e){if(t.length>10){e.visible=false}if(n){e.visible=false}if(e.isSuperiorAction){e.visible=true}});if(t.every(function(t){return!t.visible})){if(t[0]){t[0].visible=true}if(t[1]){t[1].visible=true}if(t[2]){t[2].visible=true}}return t};S.prototype._getEnableAvailableActionsPersonalization=function(t){var e=p.getStorableAvailableActions(t);if(e.length===0){return false}var i=this.getEnableAvailableActionsPersonalization();if(this.getSemanticObjectController()&&this.getSemanticObjectController().getEnableAvailableActionsPersonalization()&&this.getSemanticObjectController().getEnableAvailableActionsPersonalization()[this.getFieldName()]!==undefined){i=this.getSemanticObjectController().getEnableAvailableActionsPersonalization()[this.getFieldName()]}return i};return S});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Panel", ["sap/ui/mdc/link/PanelRenderer","sap/ui/mdc/link/Panel","sap/ui/comp/personalization/LinkPanelController","sap/m/p13n/Engine","sap/ui/mdc/mixin/AdaptationMixin"],(e,n,t,i,r)=>{"use strict";const a=n.extend("sap.ui.comp.navpopover.Panel",{renderer:e});a.prototype._registerP13n=function(){i.getInstance().register(this,{controller:{LinkItems:new t({control:this})}});r.call(a.prototype);i.getInstance().defaultProviderRegistry.attach(this,"Global")};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SemanticObjectController", ["sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/core/Element","./Factory","sap/ui/model/json/JSONModel","sap/ui/comp/odata/MetadataAnalyser","sap/ui/model/BindingMode","sap/base/Log","sap/base/util/merge","./Util"],function(jQuery,t,e,i,n,a,o,r,s,c){"use strict";let p;var g=e.extend("sap.ui.comp.navpopover.SemanticObjectController",{metadata:{library:"sap.ui.comp",properties:{ignoredFields:{type:"string",group:"Misc",defaultValue:null},prefetchNavigationTargets:{type:"boolean",group:"Misc",defaultValue:false},fieldSemanticObjectMap:{type:"object",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null},contactAnnotationPaths:{type:"object",defaultValue:null},enableAvailableActionsPersonalization:{type:"object",defaultValue:null},mapFieldToSemanticObject:{type:"boolean"},forceLinkRendering:{type:"object",defaultValue:null},beforeNavigationCallback:{type:"function"},replaceSmartLinkNavigationTargetsObtained:{type:"boolean",defaultValue:false},navigationTargetsObtainedCallback:{type:"function"}},events:{navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}},prefetchDone:{parameters:{semanticObjects:{type:"object"}}}}}});g.oSemanticObjects={};g.oNavigationTargetActions={};g.bHasPrefetchedDistinctSemanticObjects=false;g.bHasPrefetchedNavigationTargetActions=false;g.oPromise=null;g.oPromiseActions=null;g.prototype.init=function(){g.prefetchDistinctSemanticObjects();this._proxyOnBeforePopoverOpens=this._onBeforePopoverOpens.bind(this);this._proxyOnTargetsObtained=this._onTargetsObtained.bind(this);if(!this._proxyOnNavigate){this._proxyOnNavigate=this._onNavigate.bind(this)}this._aRegisteredControls=[]};g.prototype.isControlRegistered=function(t){return this._aRegisteredControls.indexOf(t)>-1};g.prototype.registerControl=function(t){let e=t&&t.isA("sap.ui.comp.navpopover.SmartLink");if(t&&t.isA("sap.ui.comp.navpopover.NavigationPopoverHandler")){e=true}if(!e){r.warning("sap.ui.comp.navpopover.SemanticObjectController: "+(t&&t.getMetadata?t.getMetadata():"parameter")+" is neither of SmartLink nor of NavigationPopoverHandler instance");return}if(!e){r.warning("sap.ui.comp.navpopover.SemanticObjectController: "+(t?.getMetadata?.()||"parameter")+" is not of SmartLink instance");return}if(this.isControlRegistered(t)){return}if(t.attachBeforePopoverOpens){t.attachBeforePopoverOpens(this._proxyOnBeforePopoverOpens)}if(t.attachNavigationTargetsObtained){t.attachNavigationTargetsObtained(this._proxyOnTargetsObtained)}if(t.isA("sap.ui.comp.navpopover.NavigationPopoverHandler")&&t.attachInnerNavigate){t.attachInnerNavigate(this._proxyOnNavigate)}this._aRegisteredControls.push(t)};g.prototype.unregisterControl=function(t){if(!t){return}if(!this.isControlRegistered(t)){return}if(t.detachBeforePopoverOpens){t.detachBeforePopoverOpens(this._proxyOnBeforePopoverOpens)}if(t.detachNavigationTargetsObtained){t.detachNavigationTargetsObtained(this._proxyOnTargetsObtained)}if(t.isA("sap.ui.comp.navpopover.NavigationPopoverHandler")&&t.detachInnerNavigate){t.detachInnerNavigate(this._proxyOnNavigate)}this._aRegisteredControls.splice(this._aRegisteredControls.indexOf(t),1)};g.prototype.setEnableAvailableActionsPersonalization=function(t){this.setProperty("enableAvailableActionsPersonalization",t,true);return this};g.prototype._onBeforePopoverOpens=function(t){var e=t.getParameters();if(this.hasListeners("beforePopoverOpens")){this.fireBeforePopoverOpens({semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,semanticAttributesOfSemanticObjects:e.semanticAttributesOfSemanticObjects,setSemanticAttributes:e.setSemanticAttributes,setAppStateKey:e.setAppStateKey,originalId:e.originalId,open:e.open})}else{e.open()}};g.prototype._onTargetsObtained=function(t){const e=t.getParameters();if(!this.hasListeners("navigationTargetsObtained")){e.show();return}this.fireNavigationTargetsObtained({mainNavigation:e.mainNavigation,actions:e.actions,ownNavigation:e.ownNavigation,popoverForms:e.popoverForms,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes,originalId:e.originalId,show:e.show})};g.prototype._onNavigate=function(t){if(t){var e=t.getParameters();var i={text:e.text,href:e.href,originalId:e.originalId,semanticObject:e.semanticObject,semanticAttributes:e.semanticAttributes};if(this.getBeforeNavigationCallback()&&!t.getSource().getBeforeNavigationCallback()){this.getBeforeNavigationCallback()(s({},i)).then(function(t){if(t===true){this.fireNavigate(e);c.navigate(e.internalHref)}}.bind(this))}else{this.fireNavigate(e);c.navigate(e.internalHref)}}};g.prototype.setIgnoredState=function(t){r.error("SemanticObjectController.setIgnoredState is deprecated as of version 1.42!")};g.prototype.setPrefetchNavigationTargets=function(t){this.setProperty("prefetchNavigationTargets",t);if(t!==true){return this}r.error("sap.ui.comp.navpopover.SemanticObjectController: Please be aware that in case of a large amount of semantic objects the performance may suffer significantly and the received links will be created out of context");var e=this;g.getDistinctSemanticObjects().then(function(t){g.getNavigationTargetActions(t).then(function(t){e.firePrefetchDone({semanticObjects:t})})});return this};g.prototype.getFieldSemanticObjectMap=function(){var t=this.getProperty("fieldSemanticObjectMap");if(t){return t}if(!this.getEntitySet()){r.warning("sap.ui.comp.navpopover.SemanticObjectController: FieldSemanticObjectMap is not set on SemanticObjectController, retrieval without EntitySet not possible");return null}var e=new a(this.getModel());t=e.getFieldSemanticObjectMap(this.getEntitySet());if(t){this.setProperty("fieldSemanticObjectMap",t,true)}return t};g.prototype.getEntitySet=function(){var t=this.getProperty("entitySet");if(t){return t}var e=this.getParent();while(e){if(e.getEntitySet){t=e.getEntitySet();if(t){this.setProperty("entitySet",t,true);break}}e=e.getParent()}return t};g.prototype.hasSemanticObjectLinks=function(t){return g.hasDistinctSemanticObject([t],g.oSemanticObjects)};g.prefetchDistinctSemanticObjects=function(){g.getJSONModel();if(!g.bHasPrefetchedDistinctSemanticObjects){g.getDistinctSemanticObjects()}};g.prototype._getDistinctSemanticObjects=function(){return g.getDistinctSemanticObjects()};g.getDistinctSemanticObjects=function(){if(g.bHasPrefetchedDistinctSemanticObjects){return Promise.resolve(g.oSemanticObjects)}if(!g.oPromise){g.oPromise=i.getServiceAsync("Navigation").then(function(t){if(!t){r.error("sap.ui.comp.navpopover.SemanticObjectController: Service 'Navigation' could not be obtained");g.bHasPrefetchedDistinctSemanticObjects=true;return{}}return t.getSemanticObjects().then(function(t){t.forEach(function(t){g.oSemanticObjects[t]={}});var e=g.getJSONModel();e.setProperty("/distinctSemanticObjects",g.oSemanticObjects);g.bHasPrefetchedDistinctSemanticObjects=true;return g.oSemanticObjects},function(){r.error("sap.ui.comp.navpopover.SemanticObjectController: getSemanticObjects() of service 'Navigation' failed");g.bHasPrefetchedDistinctSemanticObjects=true;return{}})})}return g.oPromise};g.prototype._getNavigationTargetActions=function(t){return g.getNavigationTargetActions(t)};g.getNavigationTargetActions=function(t){if(g.bHasPrefetchedNavigationTargetActions){return Promise.resolve(g.oNavigationTargetActions)}if(!g.oPromiseLinks){var e=i.getServiceAsync("Navigation");var n=i.getServiceAsync("URLParsing");g.oPromiseLinks=Promise.all([e,n]).then(function(e){var i=e[0];var n=e[1];if(!i||!n){r.error("sap.ui.comp.navpopover.SemanticObjectController: Service 'Navigation' or 'URLParsing' could not be obtained");g.bHasPrefetchedNavigationTargetActions=true;return{}}var a=Object.keys(t);var o=a.map(function(t){return{semanticObject:t}});return i.getLinks(o).then(function(t){a.forEach(function(e,i){g.oNavigationTargetActions[e]=[];t[i].forEach(function(t){var i=n.parseShellHash(t.intent);if(i&&i.semanticObject===e){g.oNavigationTargetActions[e].push(i.action)}})});var e=g.getJSONModel();e.setProperty("/navigationTargetActions",g.oNavigationTargetActions);g.bHasPrefetchedNavigationTargetActions=true;return g.oNavigationTargetActions},function(){r.error("sap.ui.comp.navpopover.SemanticObjectController: getLinks() of service 'Navigation' failed");g.bHasPrefetchedNavigationTargetActions=true;return{}})})}return g.oPromiseLinks};g.hasDistinctSemanticObject=function(t,e){return t.some(function(t){return!!e[t]})};g.getJSONModel=function(){if(p&&!jQuery.isEmptyObject(p.getData())){return p}p=new n({distinctSemanticObjects:{}});p.setDefaultBindingMode(o.OneTime);p.setSizeLimit(1e3);return p};g.destroyDistinctSemanticObjects=function(){g.oSemanticObjects={};g.oNavigationTargetActions={};g.oPromise=null;g.oPromiseActions=null;g.bHasPrefetchedDistinctSemanticObjects=false;g.bHasPrefetchedNavigationTargetActions=false;if(p){p.destroy()}};return g});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SmartLink", ["./SmartLinkFieldInfo","./SemanticObjectController","sap/base/Log","sap/ui/comp/navpopover/SmartLinkDelegate","./SmartLinkRenderer","sap/ui/model/json/JSONModel","sap/ui/comp/navpopover/Util","sap/m/Link","sap/m/library"],function(t,e,n,i,o,r,a,s,p){"use strict";var l=p.EmptyIndicatorMode;var g=s.extend("sap.ui.comp.navpopover.SmartLink",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/navpopover/SmartLink.designtime",properties:{semanticObject:{type:"string",defaultValue:null},additionalSemanticObjects:{type:"string[]",defaultValue:[]},semanticObjectController:{type:"any",defaultValue:null},fieldName:{type:"string",defaultValue:null},semanticObjectLabel:{type:"string",defaultValue:null},createControlCallback:{type:"function",defaultValue:null},mapFieldToSemanticObject:{type:"boolean",defaultValue:true},contactAnnotationPath:{type:"string",defaultValue:undefined},ignoreLinkRendering:{type:"boolean",defaultValue:false},enableAvailableActionsPersonalization:{type:"boolean",defaultValue:true},forceLinkRendering:{type:"boolean",defaultValue:false},uom:{type:"string",defaultValue:undefined},beforeNavigationCallback:{type:"function"},enabled:{type:"boolean",group:"Behavior",defaultValue:true},wrapping:{type:"boolean",group:"Appearance",defaultValue:false},navigationTargetsObtainedCallback:{type:"function"}},aggregations:{innerControl:{type:"sap.ui.core.Control",multiple:false}},events:{beforePopoverOpens:{parameters:{semanticObject:{type:"string"},semanticAttributes:{type:"object"},semanticAttributesOfSemanticObjects:{type:"object"},setSemanticAttributes:{type:"function"},setAppStateKey:{type:"function"},originalId:{type:"string"},open:{type:"function"}}},navigationTargetsObtained:{parameters:{mainNavigation:{type:"sap.ui.comp.navpopover.LinkData"},actions:{type:"sap.ui.comp.navpopover.LinkData[]"},ownNavigation:{type:"sap.ui.comp.navpopover.LinkData"},popoverForms:{type:"sap.ui.layout.form.SimpleForm[]"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"},show:{type:"function"}}},innerNavigate:{parameters:{text:{type:"string"},href:{type:"string"},semanticObject:{type:"string"},semanticAttributes:{type:"object"},originalId:{type:"string"}}}}},renderer:o});g.prototype.init=function(){e.prefetchDistinctSemanticObjects();this._bIsTriggerable=false;const t=new r({mainNavigationLink:{title:undefined,subtitle:undefined,href:undefined,internalHref:undefined,target:undefined},semanticAttributes:null,appStateKey:null,extraContent:undefined});this.setModel(t,"$sapuicompSmartLink");this.attachPress(this._onLinkPressed,this);this.addStyleClass("sapUiCompSmartLink");this.setText(this.getText());s.prototype.init.apply(this,arguments)};g.prototype.applySettings=function(t){s.prototype.applySettings.apply(this,arguments);this.addDependent(this.getFieldInfo())};g.prototype.exit=function(){if(this.getSemanticObjectController()){this.getSemanticObjectController().unregisterControl(this)}};g.prototype.clone=function(){let t=this._getFieldInfo();if(t){t.detachEvent("dataUpdate",this._handleInfoDataUpdate.bind(this))}const e=s.prototype.clone.apply(this,arguments);t=this._getFieldInfo(e);if(t){e._applyFieldInfoHandling(t)}if(this._bIsTriggerable){e._bIsTriggerable=this._bIsTriggerable}return e};g.prototype.setText=function(t){if(this._isRenderingInnerControl()){this.setProperty("text",t,true)}else{s.prototype.setText.call(this,t)}return this};g.prototype.onBeforeRendering=function(){s.prototype.onBeforeRendering.apply(this,arguments);if(!this.getSemanticObjectController()){var t=this._getSemanticObjectControllerOfParent();if(t){this.setSemanticObjectController(t)}}};g.prototype.onAfterRendering=function(){s.prototype.onAfterRendering.apply(this,arguments);const t=this.getDomRef();if(!this.getText()&&this.getEmptyIndicatorMode()===l.Off){t.setAttribute("aria-hidden",true)}else if(t.getAttribute("aria-hidden")){t.removeAttribute("aria-hidden")}};g.prototype.getAccessibilityInfo=function(){const t=this.getEnabled()?s.prototype.getAccessibilityInfo.apply(this,arguments):{description:this.getText()||this.getHref()||""};if(t.description===undefined){t.description=""}if(this.getUom()&&t.description&&t.description!==""&&!t.description.includes(this.getUom())){t.description+=this.getUom()}return t};g.prototype.setSemanticObjectController=function(t){if(t&&!t.isA("sap.ui.comp.navpopover.SemanticObjectController")){n.warning("Warning: setSemanticObjectController() has to be an object of sap.ui.comp.navpopover.SemanticObjectController instances",this);return this}var e=this.getProperty("semanticObjectController");if(e===t){return this}if(e){e.unregisterControl(this)}this.setProperty("semanticObjectController",t,true);if(t){if(t.getReplaceSmartLinkNavigationTargetsObtained()){if(this.hasListeners("navigationTargetsObtained")&&t.hasListeners("navigationTargetsObtained")){this.mEventRegistry.navigationTargetsObtained.forEach(function(t){this.detachNavigationTargetsObtained(t.fFunction)}.bind(this))}if(t.getNavigationTargetsObtainedCallback()){this.setNavigationTargetsObtainedCallback(t.getNavigationTargetsObtainedCallback())}}t.registerControl(this);if(!this.getBeforeNavigationCallback()){this.setBeforeNavigationCallback(t.getBeforeNavigationCallback())}}this._determineEnabled();return this};g.prototype.setSemanticObject=function(t){this.setProperty("semanticObject",t);this._determineEnabled();return this};g.prototype.setAdditionalSemanticObjects=function(t){this.setProperty("additionalSemanticObjects",t);this._determineEnabled();return this};g.prototype.setContactAnnotationPath=function(t){this.setProperty("contactAnnotationPath",t);this._determineEnabled();return this};g.prototype.setIgnoreLinkRendering=function(t){this.setProperty("ignoreLinkRendering",t);this._determineEnabled();return this};g.prototype.setFieldName=function(t){this.setProperty("fieldName",t);this._determineEnabled();return this};g.prototype.getInnerControlValue=function(){if(this._isRenderingInnerControl()){var t=this._getInnerControl();if(t){if(t.getText){return t.getText()}if(t.getValue){return t.getValue()}}}return this.getText()};g.prototype.getNavigationPopoverHandler=function(){throw new Error("Function is depracted due to missing NavigationPopoverHandler "+this)};g.prototype.getFieldInfo=function(){let e=this._getFieldInfo();if(!e){const n=this.getId();e=new t(n+"-nsl",{sourceControl:n});this._applyFieldInfoHandling(e)}return e};g.prototype.getExtraContent=function(){const t=this._getInternalModel();return t.getProperty("/extraContent")};g.prototype.getMainNavigation=function(){const t=this._getInternalModel();return t.getProperty("/mainNavigationLink")};g.prototype.getMainNavigationId=function(){const t=this._getInternalModel();return t.getProperty("/mainNavigationId")};g.prototype._getFieldInfo=function(t){if(!t){t=this}return t.getDependents().find(t=>t.isA("sap.ui.comp.navpopover.SmartLinkFieldInfo"))};g.prototype._applyFieldInfoHandling=function(t){this.attachEvent("modelContextChange",this._handleModelContextChange);t.attachEvent("dataUpdate",this._handleInfoDataUpdate.bind(this))};g.prototype._handlePress=function(t){if(this.getUom()&&t.target.localName==="span"){var e=this.getDomRef()?this.getDomRef():t.target.parentElement;t.target=e}s.prototype._handlePress.apply(this,arguments)};g.prototype.onsapenter=g.prototype._handlePress;g.prototype.onclick=g.prototype._handlePress;g.prototype._handleModelContextChange=function(){this.getFieldInfo().fireDataUpdate()};g.prototype._handleInfoDataUpdate=async function(){await this._updateEnabled()};g.prototype._getTextOfDom=function(){if(!this.getDomRef()){return""}if(this.$().find("span").length===2){return this.$().find("span")[0].textContent+this.$().find("span")[1].textContent}else{return this.$()[0].textContent}};g.prototype._getEnabled=function(){return this.getEnabled()&&this._bIsTriggerable};g.prototype._onLinkPressed=function(t){this.getFieldInfo().open(this,t)};g.prototype._onNavigationTargetsObtained=function(t){if(!this.hasListeners("navigationTargetsObtained")){t.show();return}this.fireNavigationTargetsObtained(t)};g.prototype._onBeforePopoverOpens=function(t){if(!this.hasListeners("beforePopoverOpens")){t.open();return}this.fireBeforePopoverOpens(t)};g.prototype._isRenderingInnerControl=function(){return this.getIgnoreLinkRendering()&&this._getInnerControl()!==null};g.prototype._getInnerControl=function(){var t=this.getAggregation("innerControl");if(t){return t}var e=this.getCreateControlCallback();if(e){t=e();this.setAggregation("innerControl",t,true);return t}return null};g.prototype._getSemanticObjectControllerOfParent=function(){var t;var e=this.getParent();while(e){if(e.getSemanticObjectController){t=e.getSemanticObjectController();if(t){this.setSemanticObjectController(t);break}}e=e.getParent()}return t};g.prototype._getInternalModel=function(){const t=this.getModel("$sapuicompSmartLink");return t};g.prototype._setMainNavigation=function(t){if(t===undefined){return}const e=this._getInternalModel();if(t===null){e.setProperty("/mainNavigationLink/href",null);e.setProperty("/mainNavigationLink/internalHref",null);e.setProperty("/mainNavigationLink/target",null);e.setProperty("/mainNavigationLink/subtitle",null);return}if(!e.getProperty("/mainNavigationLink/title")&&e.getProperty("/mainNavigationLink/title")!==""){e.setProperty("/mainNavigationLink/title",t.getText())}e.setProperty("/mainNavigationLink/href",t.getHref());e.setProperty("/mainNavigationLink/internalHref",t.getInternalHref());e.setProperty("/mainNavigationLink/target",t.getTarget());e.setProperty("/mainNavigationLink/subtitle",t.getDescription())};g.prototype._setMainNavigationId=function(t){if(t===undefined){return}const e=this._getInternalModel();if(t===null){e.setProperty("/mainNavigationId",null);e.setProperty("/mainNavigationLink/title",null);return}e.setProperty("/mainNavigationId",t);e.setProperty("/mainNavigationLink/title",t)};g.prototype._setExtraContent=function(t){const e=this._getInternalModel();e.setProperty("/extraContent",t)};g.prototype._setAppStateKey=function(t){if(t===undefined){return}const e=this._getInternalModel();e.setProperty("/appStateKey",t)};g.prototype._getAppStateKey=function(){const t=this._getInternalModel();return t.getProperty("/appStateKey")};g.prototype._setSemanticAttributes=function(t){const e=this._getInternalModel();e.setProperty("/semanticAttributes",t)};g.prototype._getSemanticAttributes=function(){const t=this._getInternalModel();return t.getProperty("/semanticAttributes")};g.prototype._updateEnabled=async function(){const t=this.getFieldInfo();const e=await t.isTriggerable();this.setEnabled(e);this._bIsTriggerable=e};g.prototype._determineEnabled=function(){const t=this._getFieldInfo();if(t){this.getFieldInfo().fireDataUpdate()}};return g});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SmartLinkDelegate", ["sap/ui/mdc/LinkDelegate","sap/ui/mdc/enums/LinkType","sap/base/Log","./Util","sap/base/strings/whitespaceReplacer","sap/ui/core/Component","sap/base/util/isPlainObject","./ContactDetailsController","./Factory","sap/m/VBox","sap/ui/mdc/library","sap/base/util/merge","sap/ui/mdc/link/LinkItem","sap/m/Title","sap/m/Link","sap/m/library","sap/ui/core/CustomData","sap/m/Text","sap/ui/comp/personalization/Util","sap/ui/core/library","sap/ui/mdc/link/Panel","./SemanticObjectController","./LinkData","sap/base/util/isEmptyObject","sap/ui/core/Element","sap/ui/core/Lib"],(t,e,n,i,a,o,r,s,c,l,g,m,u,d,f,p,b,v,S,h,k,y,L,C,_,A)=>{"use strict";const O=Object.assign({},t);O.fetchLinkType=async t=>{const n=O._getSmartLink(t);const i=await O._isSmartLinkEnabled(n);const a={initialType:{type:i?e.Popover:e.Text,directLink:undefined},runtimeType:O._getRuntimeLinkType(t)};return Promise.resolve(a)};O.fetchAdditionalContent=async t=>{const e=O._getSmartLink(t);const i=_.getElementById(e.sId);if(!i){n.error("sap.ui.comp.navpopover.SmartLinkDelegate: No control provided, popover cannot be attached.")}const a=await O._retrieveAdditionalContent(t);return a};const I=t=>t.getHref?.()??t.href;const j=t=>t.getText?.()??t.text;const N=t=>{if(t.getInternalHref!==undefined){return t.getInternalHref()}return t.data?.("internalHref")??t.internalHref};O.beforeNavigationCallback=function(t,e){const n=O._getSmartLink(t);const i=e.getSource();const a=n?.getSemanticObjectController();const o=n?.getBeforeNavigationCallback()||a?.getBeforeNavigationCallback();if(!o){return Promise.resolve(true)}let r=n?.getSemanticObject();const s=n.getAdditionalSemanticObjects();if(s?.length>0){const t=s.find(t=>I(i).includes(t));if(t&&t.trim().length>0){r=t}}const c=n?._getSemanticAttributes();const l=N(i);const g={text:j(i),href:I(i),originalId:n?.getParent()?.isA("sap.m.ObjectIdentifier")?n.getParent().getId():n?.getId(),semanticObject:r,semanticAttributes:c?c[r]:c};return o(m({},g)).then(t=>{if(t){n?.fireInnerNavigate({...g,internalHref:l});a?.fireNavigate({...g,internalHref:l})}return t})};O.getPanelId=function(t){const e=O._getSmartLink(t);if(!e){n.error("SmartLinkDelegate: Stable ID could not be determined because the control is undefined");return undefined}const a=O._getComponent(e);if(!a){n.error("SmartLinkDelegate: Stable ID could not be determined because the app component is not defined for control '"+e.getId()+"'");return undefined}const o=e.getSemanticObject();if(!o){n.error("SmartLinkDelegate: Stable ID could not be determined because no default semantic object is defined");return undefined}const r=[o].concat(e.getAdditionalSemanticObjects());i.sortArrayAlphabetical(r);const s=r.join("--");return a.createId("sapuicompnavpopoverNavigationPopover---"+s)};O.fetchPopoverTitle=function(t,e){const n=O._getSmartLink(t);const i=n.getMainNavigationId();const a=O._getLabelledByControl(e);return Promise.resolve({sTitle:i,oLabelledByControl:a})};O._getLabelledByControl=function(t){return t._getAdditionalContentArea().getItems()[0].getItems()[0].getItems()[0].getContent()};O.getSemanticObjectValue=function(t){const e=t.getSemanticObject();const n=t._getSemanticAttributes();if(n&&e&&n[e]){return n[e][e]}return undefined};O.onLinkPressed=async function(t,e){const n=e.getSource();const i=O._getSmartLink(t);const a=i.getSemanticObjectController();const o=e.getParameters().ctrlKey||e.getParameters().metaKey;const r=!!(i.getBeforeNavigationCallback()||a?.getBeforeNavigationCallback());const s=n?.getTarget()==="_blank"||o;if(s){return}e.preventDefault();const c=n?.getCustomData()&&n.getCustomData()[0]?.getValue();const l=c?n.getCustomData()[0].getValue():n.getHref();if(r){const n=await t._beforeNavigationCallback(e);if(n){k.navigate(l)}}else{k.navigate(l)}};O.fetchNavigationTargets=async(t,e)=>{const a=O._getSmartLink(t);const o=a.getSemanticObject();const r=o;const s=a.getAdditionalSemanticObjects();const c=_.getElementById(a.sId);if(!c){n.error("sap.ui.comp.navpopover.SmartLinkDelegate: No control provided, popover cannot be attached.")}const l=e?.getPath()??null;if(!l){n.warning("sap.ui.comp.navpopover.SmartLinkDelegate: Binding Context is null. Please be aware that without binding context no semantic attributes can be calculated. Without semantic attributes no URL parameters can be created.")}const g=a.getModel();const m=O._getComponent(c);await A.load({name:"sap.ui.fl"});let u=c&&c._getTextOfDom&&c._getTextOfDom()||O.getSemanticObjectValue(a);const d=a._getSemanticAttributes();a._setSemanticAttributes(d);u=c&&c._getTextOfDom&&c._getTextOfDom()||O.getSemanticObjectValue(a);const f=a._getAppStateKey();return i.retrieveNavigationTargets(r,s,f,m,d,u,a.getFieldName(),g,l)};O._getNavgationInfo=function(t,e){const n=O._getSmartLink(t);const i=n?._getSemanticAttributes();const a=n?.getSemanticObject();const o={originalId:n?.getId(),semanticObject:a,semanticAttributes:i?i[a]:i,text:j(e),href:I(e),internalHref:N(e)};return o};O._retrieveAdditionalContent=async t=>{const e=O._getSmartLink(t);const n=e.getModel()||t.getModel();const a=new s;a.setModel(n);const o=e.getBindingContext()||t._getControlBindingContext();const r=o?.getPath()??null;const c=i.getContactAnnotationPath(e,e.getSemanticObjectController());const l=O.getSemanticObjectValue(e);const g=O._getMainNavigationContent(e);if(c==undefined){return[g]}await A.load({name:"sap.ui.fl"});const m=await a.getBindingPath4ContactAnnotation(r,c,l);const u=a.getContactDetailsContainers(m);a.destroy();return[g,u]};O._getMainNavigationContent=t=>{const e=t._getInternalModel();const n=new f({href:"{$sapuicompSmartLink>/mainNavigationLink/href}",text:"{$sapuicompSmartLink>/mainNavigationLink/title}",target:"{$sapuicompSmartLink>/mainNavigationLink/target}",visible:{path:"$sapuicompSmartLink>/mainNavigationLink/title",formatter:t=>!!t},enabled:{path:"$sapuicompSmartLink>/mainNavigationLink/href",formatter:t=>!!t},press:e=>{O.onLinkPressed(t.getFieldInfo(),e)}});const i=new b({key:"internalHref",value:"{$sapuicompSmartLink>/mainNavigationLink/internalHref}"});n.addCustomData(i);const a=new d({level:h.TitleLevel.Auto,content:n});a.addStyleClass("sapFontHeader5Size");const o=new v({text:"{$sapuicompSmartLink>/mainNavigationLink/subtitle}",visible:{path:"$sapuicompSmartLink>/mainNavigationLink/subtitle",formatter:t=>!!t}});const r=new l({items:[a,o],visible:{path:"$sapuicompSmartLink>/mainNavigationLink/title",formatter:t=>!!t}});r.addStyleClass("mdcbaseinfoPanelTitleH1");r.addStyleClass("mdcbaseinfoPanelHeader");const s=new l({fitContainer:true,justifyContent:p.FlexJustifyContent.Start,items:[r]});s.setModel(e,"$sapuicompSmartLink");return s};O._transformNavigationTargets=t=>{const{availableActions:e,mainNavigation:n}=t;const i=[];if(e){e.forEach(t=>{if(t.getText()){t.setText(a(t.getText()))}if(t.getHref()){t.setInternalHref(t.getHref());i.push(O._convertToExternal(t.getHref()).then(e=>{t.setHref(e)}))}})}if(n){if(n.getDescription()){n.setDescription(a(n.getDescription()))}if(n.getText()){n.setText(a(n.getText()))}if(n.getHref()){n.setInternalHref(n.getHref());i.push(O._convertToExternal(n.getHref()).then(t=>{n.setHref(t)}))}}return Promise.all(i).then(()=>{t.availableActions=e;t.mainNavigation=n;if(t.mainNavigationId){t.mainNavigationId=a(t.mainNavigationId)}return t})};O._updateVisibilityOfAvailableActions=(t,e)=>{if(!O._getEnableAvailableActionsPersonalization(t,e)){return t.map(t=>{t.setInitiallyVisible(true);return t})}const n=i.getStorableAvailableActions(t);const a=n.some(t=>!!t.getInitiallyVisible());n.forEach(e=>{const n=e.getInitiallyVisible();if(t.length>10){e.setInitiallyVisible(false)}if(a){e.setInitiallyVisible(false)}if(n){e.setInitiallyVisible(true)}});if(t.every(t=>!t.getInitiallyVisible())){if(t[0]){t[0].setInitiallyVisible(true)}if(t[1]){t[1].setInitiallyVisible(true)}if(t[2]){t[2].setInitiallyVisible(true)}}return t};O._getEnableAvailableActionsPersonalization=(t,e)=>{const n=i.getStorableAvailableActions(t);if(n.length===0){return false}const a=O._getSmartLink(e);let o=a.getEnableAvailableActionsPersonalization();const r=a.getFieldName();const s=a.getSemanticObjectController()?.getEnableAvailableActionsPersonalization();if(s&&s[r]!==undefined){o=s[r]}return o};O._getComponent=t=>{if(!t){return null}let e=t.getParent();while(e){if(e instanceof o){if(e&&e.getAppComponent){e=e.getAppComponent()}return e}e=e.getParent()}return o.getComponentById(o.getOwnerIdFor(t))};O._calculateSemanticAttributes=(t,e,i)=>{const a=O._getSmartLink(e);const o=i?.getObject(i.getPath())??null;const s=a.getSemanticObject();const c=a.getAdditionalSemanticObjects();const l=a.getFieldName();const g=["",s].concat(c);const m={};g.forEach(i=>{m[i]={};const c=O._getMappingRules(i,t,o,e);for(const e in o){const g={transformations:[]};let u=null;if(o[e]===undefined||o[e]===null){if(g){g.transformations.push({value:o[e],description:" Undefined and null values have been removed in SmartLinkDelegate."})}continue}if(r(o[e])){if(g){g.transformations.push({value:o[e],description:" Plain objects has been removed in SmartLinkDelegate."})}continue}const d=c[e];if(g&&e!==d){u=t?{value:undefined,description:" The attribute "+e+" has been renamed to "+d+" in SmartLinkDelegate.",reason:` A com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation is defined for semantic object ${i}\n\t\t\t\t\t\t\t with source attribute ${e} and target attribute ${d}.\n\t\t\t\t\t\t\t You can modify the annotation if the mapping result is not what you expected.`}:{value:undefined,description:" The attribute "+e+" has been renamed to "+d+" in SmartLinkDelegate.",reason:" The property mapFieldToSemanticObject is set to true. Attribute "+e+" is mapped to "+d+". (semantic object is "+s+", field name is "+a.getFieldName()+"). If this is not what you expected, you can set the property to false or define a com.sap.vocabularies.Common.v1.SemanticObjectMapping annotation."}}let f=o[e];if(m[i][d]){if(o[l]){if(d===c[a.getFieldName()]){f=o[l]}else{n.error("The attribute "+e+" can not be renamed to the attribute "+d+" due to a clash situation. This can lead to wrong navigation later on.")}}}m[i][d]=f;if(g){g.transformations.push({value:o[e],description:" The attribute "+e+" with the value "+o[e]+" is taken from the binding context in SmartLinkDelegate."});if(u){g.transformations.push(u)}}}});return m};O._getMappingRules=(t,e,n,i)=>{const a=O._getSmartLink(i);const o=!!a.getSemanticObjectController()?.getMapFieldToSemanticObject();const r=o?a.getSemanticObjectController().getMapFieldToSemanticObject():a.getMapFieldToSemanticObject();let s;const c={};if(e){for(s in e[t]){if(typeof e[t][s]==="string"){c[s]=e[t][s]}}}else if(r){if(a.getSemanticObjectController()){const t=a.getSemanticObjectController().getFieldSemanticObjectMap();for(s in t){c[s]=t[s]}}if(a.getFieldName()&&a.getSemanticObject()){c[a.getFieldName()]=a.getSemanticObject()}}for(s in n){if(!c.hasOwnProperty(s)){c[s]=s}}return c};O._fireBeforePopoverOpens=(t,e,n,i)=>{const a=O._getSmartLink(i);return new Promise(i=>{const o={semanticAttributes:t,appStateKey:undefined};if(!a.hasListeners("beforePopoverOpens")){i(o);return}const r=t=>{const e=Object.keys(t).filter(e=>!C(t[e]));return!!e.length};const s={originalId:n,semanticObject:e,semanticAttributes:!C(t[e])?t[e]:null,semanticAttributesOfSemanticObjects:r(t)?t:null,setSemanticAttributes:(t,n)=>{n=n||e;o.semanticAttributes=o.semanticAttributes||{};o.semanticAttributes[n]=t},setAppStateKey:t=>{o.appStateKey=t},open:()=>i(o)};const c=a._onBeforePopoverOpens.bind(a);c(s)})};O._fireNavigationTargetsObtained=(t,e,i,a,o,r,s)=>new Promise(c=>{const g=O._getSmartLink(s);const m={mainNavigationId:t,extraContent:o.length?new l({items:o}):undefined};const u={mainNavigation:r.mainNavigation,actions:r.availableActions,ownNavigation:r.ownNavigation,popoverForms:o,semanticObject:e,semanticAttributes:i?i[e]:i,originalId:a};const d=g.hasListeners("navigationTargetsObtained");const f=g._onNavigationTargetsObtained.bind(g);const p=g.getNavigationTargetsObtainedCallback();if(p){if(d){f({...u,show:function(){n.warning(`sap.ui.comp.navpopover.SmartLinkDelegate: "navigationTargetsObtained" event handling will be ignored as "navigationTargetsObtainedCallback" property is set.`)}})}const t={...u,...m};p(t).then(e=>{c(O._applyResults(t,e))});return}const b={...m,...r};if(!d){c(b);return}f({...u,show:function(t,e,n,i){if(arguments.length>0&&!(typeof t==="string"||e instanceof L||Array.isArray(n))&&i===undefined){i=n;n=e;e=t;t=undefined}c(O._applyResults(b,{mainNavigationId:t,mainNavigation:e,actions:n,extraContent:i}))}})});O._applyResults=(t,e)=>{e??=t;const{mainNavigationId:i,mainNavigation:a,actions:o,extraContent:r}=e;if(i!==undefined&&i!==null){t.mainNavigationId=i}if(a!==undefined){t.mainNavigation=a}if(o){o.forEach(function(t){if(t.getKey()===undefined){n.error("'key' attribute of 'availableAction' '"+t.getText()+"' is undefined. Links without 'key' can not be persisted.");n.warning("The 'visible' attribute of 'availableAction' '"+t.getText()+"' is set to 'true'");t.setVisible(true)}});t.availableActions=o}else{t.availableActions=t.actions??t.availableActions}if(r){t.extraContent=r}return t};O._convertToExternal=async t=>{const e=await c.getServiceAsync("Navigation");if(!e){return t}const n=await e.getHref({target:{shellHash:t}},O._getComponent());return n};O._updateInnerControl=t=>{if(t.getAggregation("innerControl")){return}const e=t._getInnerControl();if(!e){return}const n=e.clone("display");t.setContentDisplay(n)};O._getRuntimeLinkType=async t=>{const n=O._getSmartLink(t);const i=await O._isSmartLinkEnabled(n);return{type:i?e.Popover:e.Text,directLink:undefined}};O._isSmartLinkEnabled=async t=>{const e=t.getSemanticObjectController();const n=i.getForceLinkRendering(t,e);const a=t.getProperty("ignoreLinkRendering");const o=i.getContactAnnotationPath(t,t.getSemanticObjectController());const r=e?.getIgnoredFields();const s=r!==undefined&&S.createArrayFromString(r).includes(t.getFieldName());if(s){return false}if(a){O._updateInnerControl(t);return false}if(n){return true}const c=[t.getSemanticObject(),...t.getAdditionalSemanticObjects()];const l=await y.getDistinctSemanticObjects();const g=y.hasDistinctSemanticObject(c,l);if(!g&&!o){return false}return true};O._getParent=t=>t.getParent()?t.getParent():_.getElementById(t.getAssociation("sourceControl"));O._getSmartLink=t=>{const e=t.getParent();return e};return O});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SmartLinkFieldInfo", ["sap/ui/mdc/Link","./Util","./Panel","sap/ui/mdc/link/Panel","sap/ui/layout/form/SimpleForm","sap/m/Title","sap/ui/core/Lib","sap/ui/layout/library"],(t,e,n,i,o,a,s,r)=>{"use strict";const{ResponsiveGridLayout:l}=r.form.SimpleFormLayout;const c=t.extend("sap.ui.comp.navpopover.SmartLinkFieldInfo",{metadata:{properties:{delegate:{type:"object",defaultValue:{name:"sap/ui/comp/navpopover/SmartLinkDelegate",payload:{}}}}}});c.prototype.init=function(){t.prototype.init.apply(this,arguments)};c.prototype.open=async function(t,e){const n=this.getParent();let i=n.getFieldName();if(!i?.length){const t=n.getBinding("text");if(t){if(t.getBindings){i=t.getBindings()[0].getPath()}else{i=t.getPath()}}n.setFieldName(i)}t=t?t:n;if(!t){throw new Error("sap.ui.comp.navpopover.SmartLinkFieldInfo: popover can not be open because the control is undefined")}const o=this.getPopover();if(o&&o.isOpen()){return Promise.resolve()}if(!this._oGetContentPromise){this._oGetContentPromise=this.getContent(()=>this.getPopover())}const a=await this._oGetContentPromise;if(!this._oGetContentPromise){a.destroy();return Promise.resolve()}const s=await this.checkDirectNavigation(e);if(s===false){const e=await this._createPopover(a);if(e){e.openBy(t);e.attachAfterOpen(()=>{this.firePopoverAfterOpen()});e.attachAfterClose(()=>{this._oGetContentPromise=undefined})}}else{a.destroy();this._oGetContentPromise=undefined}return Promise.resolve()};c.prototype.getContent=async function(t){if(!this.awaitControlDelegate()){throw new Error("sap.ui.comp.navpopover.SmartLinkFieldInfo: control delegate is not set - could not load LinkItems from delegate.")}const i=this.getParent();const o=this._getSourceControl();const a=o.getId?.()??o;const s=i.getSemanticObject();const r=await this.awaitControlDelegate();const l=this._getControlBindingContext();const c=l?.getPath()??null;const p=i.getModel();const g=await e.retrieveSemanticObjectMapping(i.getFieldName(),p,c);i._setSemanticAttributes(r._calculateSemanticAttributes(g,this,l));let f=i._getSemanticAttributes();const h=await r._fireBeforePopoverOpens(f,s,a,this);f=h.semanticAttributes;const u=h.appStateKey;i._setSemanticAttributes(f);i._setAppStateKey(u);const m=this.retrieveAdditionalContent();const d=r.fetchNavigationTargets(this,l);const v=await Promise.all([d,m]);const[_,y]=v;const P=y.length===2?y[1]:[];const C=i._getTextOfDom&&i._getTextOfDom()||r.getSemanticObjectValue(i);let b=await r._fireNavigationTargetsObtained(C,s,f,a,P,_,this);b=await r._transformNavigationTargets(b);i._setMainNavigation(b.mainNavigation);i._setMainNavigationId(b.mainNavigationId);const w=b.availableActions??[];const N=r._updateVisibilityOfAvailableActions(w,this);i._setExtraContent(b.extraContent);if(b.extraContent){y[1]=b.extraContent}this._setConvertedLinkItems(w);const S=this._getInternalModel().getProperty("/linkItems");if(y.length===1&&!S.length){y.push(this._getNoContent())}const x=await this._getContent(N,y,t,n);x.setEnablePersonalization(r._getEnableAvailableActionsPersonalization(w,this));return x};c.prototype._getNoContent=function(){const t=new o({layout:l,content:[new a({text:s.getResourceBundleFor("sap.ui.mdc").getText("info.POPOVER_MSG_NO_CONTENT")})]});t.addStyleClass("mdcbaseinfoPanelDefaultAdditionalContent");return t};c.prototype.checkDirectNavigation=async function(t){const e=this.getParent();const n=this._getInternalModel().getProperty("/linkItems");const o=e.getExtraContent();if(o||n.length>1){return false}const a=e.getMainNavigation();const s=async n=>{t.oSource=n;const o=await this._beforeNavigationCallback(t);if(o){i.navigate(n.internalHref??n.href);const t={text:n.text??n.title,href:n.href,internalHref:n.internalHref};e.fireInnerNavigate(t)}return o};if(n.length===1&&!a.href?.length){return await s(n[0])}if(n.length===0&&a.href?.length){return await s(a)}return false};c.prototype.exit=function(){t.prototype.exit.apply(this,arguments);this._oGetContentPromise=undefined;this.getPopover()?.destroy()};return c});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/SmartLinkRenderer", ["sap/ui/core/Renderer","sap/m/LinkRenderer","sap/base/strings/whitespaceReplacer","sap/m/library"],function(e,t,r,n){"use strict";var i=n.EmptyIndicatorMode;var a=e.extend(t);a.apiVersion=2;a.render=function(e,r){var n=true;if(r.getIgnoreLinkRendering()){var i=r._getInnerControl();if(i){e.openStart("div",r);e.openEnd();e.renderControl(i);e.close("div");n=false}}if(n){if(!r.getAriaLabelledBy()||Array.isArray(r.getAriaLabelledBy())&&r.getAriaLabelledBy().length==0){r.addAriaLabelledBy(r)}t.render.apply(this,arguments)}};a.writeText=function(e,t){var r=t.getUom();var n=t.getEmptyIndicatorMode()!==i.Off&&!t.getText();if(!r){this._writeText(e,t,n);return}this._writeTextWithUom(e,r,t,n)};a._writeTextWithUom=function(e,t,r,n){t=t.padStart(6,"");e.openStart("span");e.openEnd();this._writeText(e,r,n);e.close("span");e.openStart("span");if(n){e.class("sapMEmptyIndicator");e.class("sapMLnkDsbl")}e.style("display","inline-flex");e.style("min-width","2.5em");e.style("width","3.0em");e.style("justify-content","end");e.openEnd();e.text(t);e.close("span")};a._writeText=function(e,n,i){var a=r(n.getText());if(i){t.renderEmptyIndicator(e,n)}else{e.text(a)}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/Util", ["sap/base/i18n/Localization","sap/ui/comp/library","./Factory","./LinkData","sap/ui/core/Lib","sap/ui/core/Locale","sap/base/Log"],function(t,e,n,i,r,a,o){"use strict";var c={getContactAnnotationPath:function(t,e){var n=t?t.getContactAnnotationPath():undefined;if(n===undefined&&e&&e.getContactAnnotationPaths()&&e.getContactAnnotationPaths()[t.getFieldName()]!==undefined){n=e.getContactAnnotationPaths()[t.getFieldName()]}return n},getForceLinkRendering:function(t,e){if(!t){return undefined}return t.getForceLinkRendering()||!!(e&&e.getForceLinkRendering()&&e.getForceLinkRendering()[t.getFieldName()])},getStorableAvailableActions:function(t){return t?t.filter(function(t){if(!t){return false}if(t.getKey&&t.getKey()!==undefined){return true}return t.key!==undefined}):[]},sortArrayAlphabetical:function(e){var n;try{n=new a(t.getLanguageTag()).toString();if(typeof window.Intl!=="undefined"){var i=window.Intl.Collator(n,{numeric:true});e.sort(function(t,e){return i.compare(t,e)})}else{e.sort(function(t,e){return t.localeCompare(e,n,{numeric:true})})}}catch(t){}},retrieveNavigationTargets:async function(t,e,a,c,s,u,l,f,v,g){const m={mainNavigation:undefined,ownNavigation:undefined,availableActions:[]};const[p,b]=await Promise.all([n.getServiceAsync("Navigation"),n.getServiceAsync("URLParsing")]);if(!p||!b){o.error("Service 'Navigation' or 'URLParsing' could not be obtained");return m}const d=[t].concat(e.filter(e=>e!==t));const h=d.map(function(t){return{semanticObject:t,params:s?s[t]:undefined,appStateKey:a,ui5Component:c,sortResultsBy:"text"}});const y=await p.getLinks(h);if(!y||!y.length){return m}const P=await p.getPrimaryIntent(t,h[0]);const O=P?b.parseShellHash(P.intent):null;const S=await this.retrieveSemanticObjectUnavailableActions(l,f,v);let A=await p.getHref();if(A&&A.indexOf("?")!==-1){A=A.split("?")[0]}if(A){A+="?"}const j=function(t,e){return!!S&&!!S[t]&&S[t].indexOf(e)>-1};y[0].forEach(t=>{const e=b.parseShellHash(t.intent);const n=this._getKey(e);const a=t.intent.indexOf(A)===0;const o=j(e.semanticObject,e.action);if(!a&&o){return}const c=new i({key:n,href:t.intent,visible:true,isSuperiorAction:this._isSuperiorAction(t)});c.setText(t.text);if(a){m.ownNavigation=c;return}if(O?.action&&e?.action&&e.action===O.action){c.setText(r.getResourceBundleFor("sap.ui.comp").getText("POPOVER_FACTSHEET"));m.mainNavigation=c}else{m.availableActions.push(c)}if(g){g.addSemanticObjectIntent(e.semanticObject,{text:c.text,intent:c.intent})}});if(!m.mainNavigation&&typeof u==="string"){var C=new i({visible:true});C.setText(u);m.mainNavigation=C}var x=[];for(var _=1;_<d.length;_++){x=x.concat(y[_])}x.forEach(t=>{var e=b.parseShellHash(t.intent);if(j(e.semanticObject,e.action)){return}var n=new i({key:this._getKey(e),href:t.intent,visible:true,isSuperiorAction:this._isSuperiorAction(t)});n.setText(t.text);m.availableActions.push(n);if(g){g.addSemanticObjectIntent(e.semanticObject,{text:t.text,intent:t.intent})}});return m},_getKey:t=>t.semanticObject&&t.action?t.semanticObject+"-"+t.action:undefined,_isSuperiorAction:t=>t.tags&&t.tags.indexOf("superiorAction")>-1,retrieveSemanticObjectMapping:function(t,e,n){return this._getEntityTypeAnnotationOfProperty(t,e,n).then(function(t){if(!t){return Promise.resolve(null)}if(!t[0]["com.sap.vocabularies.Common.v1.SemanticObjectMapping"]){return Promise.resolve(null)}var i=this._getSemanticObjectMappingsOfProperty(t[0],this._getSemanticObjectsOfProperty(t[0],e,n));var r={};for(var a in i){r[i[a].name]=i[a].mapping}return Promise.resolve(r)}.bind(this))},retrieveSemanticObjectUnavailableActions:function(t,e,n){return this._getEntityTypeAnnotationOfProperty(t,e,n).then(function(t){if(!t){return Promise.resolve(null)}if(!t[0]["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]){return Promise.resolve(null)}var i=this._getSemanticObjectUnavailableActionsOfProperty(t[0],this._getSemanticObjectsOfProperty(t[0],e,n));var r={};for(var a in i){r[i[a].name]=i[a].unavailableActions}return Promise.resolve(r)}.bind(this))},oNavigationPromise:undefined,navigate:function(t){if(t.indexOf("#")===0&&n.getUShellContainer()){var e=this;if(!e.oNavigationPromise){e.oNavigationPromise=n.getServiceAsync("Navigation").then(function(n){n.navigate({target:{shellHash:t.substring(1)}});e.oNavigationPromise=undefined})}}else{window.location.href=t}},_getEntityTypeAnnotationOfProperty:function(t,e,n){if(!t){return Promise.resolve(null)}if(!e||!e.getMetaModel()){return Promise.resolve(null)}var i=e.getMetaModel();return i.loaded().then(function(){var e;try{e=i.getMetaContext(n)}catch(t){o.error("sap.ui.comp.navpopover.Util._getEntityTypeAnnotationOfProperty: binding path '"+n+"' is not valid. Error has been caught: "+t);return Promise.resolve(null)}if(!e){return Promise.resolve(null)}var r=e.getProperty(e.getPath());if(!r.property){return Promise.resolve(null)}var a=r.property.filter(function(e){return e.name===t});if(a.length!==1){return Promise.resolve(null)}return Promise.resolve(a)})},_getSemanticObjectsOfProperty:function(t,e,n){var i={};for(var r in t){var a=r.split("#")[0];var o=r.split("#")[1]||"";if(a.startsWith("com.sap.vocabularies.Common.v1.SemanticObject")&&a.endsWith("com.sap.vocabularies.Common.v1.SemanticObject")){i[o]={name:t[r]["Path"]?e.getProperty(n+"/"+t[r]["Path"]):t[r]["String"],mapping:undefined}}}return i},_getSemanticObjectMappingsOfProperty:function(t,e){var n=function(t){var e={};if(Array.isArray(t)){t.forEach(function(t){e[t.LocalProperty.PropertyPath]=t.SemanticObjectProperty.String})}return e};for(var i in t){var r=i.split("#")[0];var a=i.split("#")[1]||"";if(r.startsWith("com.sap.vocabularies.Common.v1.SemanticObjectMapping")&&r.endsWith("com.sap.vocabularies.Common.v1.SemanticObjectMapping")){if(e[a]){e[a].mapping=n(t[i])}}}return e},_getSemanticObjectUnavailableActionsOfProperty:function(t,e){var n=function(t){var e=[];if(Array.isArray(t)){t.forEach(function(t){e.push(t.String)})}return e};for(var i in t){var r=i.split("#")[0];var a=i.split("#")[1]||"";if(r.startsWith("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")&&r.endsWith("com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions")){if(e[a]){e[a].unavailableActions=n(t[i])}}}return e}};return c},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/flexibility/LinkFlex", ["sap/base/util/isEmptyObject","sap/base/Log","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t,n){"use strict";var i={};var r="visible";i.applyChange=function(n,i,o){var a=n.getContent();if(e(a)){t.error("Change does not contain sufficient information to be applied");return Promise.reject("Change does not contain sufficient information to be applied")}var s=i.getAvailableActions().find(function(e){return e.getKey()===a.key});if(!s){t.error("Item with key "+a.key+" not found in the availableAction aggregation");return Promise.reject("Item with key "+a.key+" not found in the availableAction aggregation")}var f=o.modifier;return Promise.resolve().then(f.getProperty.bind(f,s,r)).then(function(e){f.setProperty(s,"visibleChangedByUser",n.getLayer()==="USER");f.setVisible(s,a.visible);n.setRevertData({key:a.key,originalValue:e})})};i.completeChangeContent=function(t,n,i){if(e(n.content)){throw new Error("oSpecificChangeInfo.content should be filled")}if(!n.content.key){throw new Error("In oSpecificChangeInfo.content.key attribute is required")}if(n.changeType==="addLink"){if(n.content.visible!==true){throw new Error("In oSpecificChangeInfo.content.visible attribute should be 'true'")}}else if(n.changeType==="removeLink"){if(n.content.visible!==false){throw new Error("In oSpecificChangeInfo.content.visible attribute should be 'false'")}}t.setContent(n.content)};i.revertChange=function(n,i,r){var o=n.getContent();if(e(o)){t.error("Change does not contain sufficient information to be applied");return false}var a=i.getAvailableActions().find(function(e){return e.getKey()===o.key});if(!a){t.error("Item with key "+o.key+" not found in the availableAction aggregation");return false}var s=n.getRevertData();if(s){r.modifier.setProperty(a,"visibleChangedByUser",n.getLayer()==="USER");r.modifier.setVisible(a,s.originalValue);n.resetRevertData()}else{t.error("Attempt to revert an unapplied change.")}};i.getCondenserInfo=function(e){return{affectedControl:{id:e.getContent().key,idIsLocal:true},uniqueKey:r,classification:n.Reverse}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/navpopover/flexibility/Panel.flexibility", ["sap/base/util/isEmptyObject","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/changeHandler/HideControl","sap/ui/fl/changeHandler/UnhideControl","sap/ui/mdc/flexibility/Panel.flexibility"],function(e,n,t,o,i){"use strict";const r="visible";const a=(n,t,o)=>{if(e(t.content)){throw new Error("mSpecificChangeInfo.content should be filled")}if(!t.content.key){throw new Error("In mSpecificChangeInfo.content.key attribute is required")}if(t.changeType==="addLink"){if(t.content.visible!==true){throw new Error("In mSpecificChangeInfo.content.visible attribute should be 'true'")}}else if(t.changeType==="removeLink"){if(t.content.visible!==false){throw new Error("In mSpecificChangeInfo.content.visible attribute should be 'false'")}}n.setContent(t.content)};const c=e=>({affectedControl:{id:e.getContent().key,idIsLocal:true},uniqueKey:r,classification:n.Reverse});return{createChanges:function(e,n){const t=n.filter(e=>!Element.getElementById(e.id));const o={};return t.reduce((e,n)=>{if(!o[n.id]){o[n.id]=true;e.push(n)}return e},[]).map(n=>({selectorElement:e,changeSpecificData:{changeType:"addLink",content:{selector:n.id}}}))},addLink:{layers:{USER:true},changeHandler:{applyChange:function(e,n,t){const r=e.getContent();r.selector??={id:r.key,idIsLocal:false};const a=t.modifier;let c=a.bySelector(r.selector,t.appComponent,t.view);if(c){o.applyChange(e,c,t)}else{i.createItem.changeHandler.applyChange(e,n,t).then(()=>{c=a.bySelector(r.key,t.appComponent,t.view);o.applyChange(e,c,t)})}},revertChange:function(e,n,t){const r=e.getRevertData();if(r){const n=e.getContent();const i=t.modifier;const r=i.bySelector(n.key,t.appComponent,t.view);o.revertChange(e,r,t);return}i.createItem.changeHandler.revertChange(e,n,t)},completeChangeContent:function(e,n,t){a(e,n,t)},getCondenserInfo:c}},removeLink:{layers:{USER:true},changeHandler:{applyChange:function(e,n,o){const i=e.getContent();const r=o.modifier;const a=r.bySelector(i.key,o.appComponent,o.view);t.applyChange(e,a,o)},revertChange:function(e,n,o){const i=e.getContent();const r=o.modifier;const a=r.bySelector(i.key,o.appComponent,o.view);if(a){t.revertChange(e,a,o)}},completeChangeContent:function(e,n,t){a(e,n,t)},getCondenserInfo:c}}}},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/AnalyticalAnalyser", ["sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/library"],function(t,e){"use strict";var i=function(e){t.apply(this,arguments)};i.prototype=Object.create(t.prototype);Object.assign(i,t);i.prototype.getVLEntitySets=function(e){var i,a,n,r,o,s,p=t.prototype.getVLEntitySets.apply(this,arguments),y=Array.isArray(p)&&p[0];if(!y&&typeof e==="string"&&this._containsNavigation(e)){r=e.split("/");o=r[0];s=r[1];i=this._oMetaModel.getODataEntitySet(o);if(i&&this.isSemanticParameters(i.entityType)&&s){a=this._oMetaModel.getODataEntityType(i.entityType);n=this._oMetaModel.getODataAssociationSetEnd(a,s);if(n){y=this._oMetaModel.getODataEntitySet(n.entitySet)}}}return[y,i]};i.prototype.getVLProperty=function(i,a){var n,r,o,s,p=a[1];if(i&&p&&this.isSemanticParameters(p.entityType)){o=this._containsNavigation(i.String);if(o){n=i.String.split("/");r=n[1];if(r){s=e.ANALYTICAL_PARAMETER_PREFIX+r}}}if(!s){s=t.prototype.getVLProperty.call(this,i)}return s};i.prototype._containsNavigation=function(t){return typeof t==="string"&&t.indexOf("/")>0&&!t.endsWith("/")};i.prototype.isSemanticParameters=function(t){var e;if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(t);if(e){return e["sap:semantics"]==="parameters"}}return false};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/CalendarFormat", ["sap/ui/comp/odata/PeriodDateFormat"],function(e){"use strict";var a=e.extend("sap.ui.comp.odata.CalendarFormat",{metadata:{library:"sap.ui.comp"},constructor:function(a,t){e.apply(this,arguments)}});a.getDateInstance=function(e){return new a(null,e)};a.prototype.getName=function(){return"sap.ui.comp.odata.CalendarFormat"};a.oRegexFormatPatterns={year:/[1-9][0-9]{3}/,period:/[0-9]{3}/,quarter:/[1-4]/,week:/0[1-9]|[1-4][0-9]|5[0-3]/,day:/366|3[0-6][0-9]|[1-2][0-9][0-9]|[1-9][0-9]|[1-9]/,month:/0[1-9]|1[0-2]/};a.oRegexParsePatterns={year:/[0-9]{1,4}/,period:/[0-9]{1,3}/,quarter:/[1-4]/,week:/[0-9]{1,2}/,day:/[1-9]/,month:/[0-9]{1,2}/};a.prototype.oSymbols={"":"",y:{format:a.oRegexFormatPatterns.year,parse:a.oRegexParsePatterns.year},Y:{format:a.oRegexFormatPatterns.year,parse:a.oRegexParsePatterns.year},M:{format:a.oRegexFormatPatterns.month,parse:a.oRegexParsePatterns.month},L:{format:a.oRegexFormatPatterns.month,parse:a.oRegexParsePatterns.month},Q:{format:a.oRegexFormatPatterns.quarter,parse:a.oRegexParsePatterns.quarter},W:{format:a.oRegexFormatPatterns.week,parse:a.oRegexParsePatterns.week},D:{format:a.oRegexFormatPatterns.day,parse:a.oRegexParsePatterns.day},d:{format:a.oRegexFormatPatterns.day,parse:a.oRegexParsePatterns.day}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/CalendarMetadata", [],function(){"use strict";var e=["com.sap.vocabularies.Common.v1.IsCalendarDate","com.sap.vocabularies.Common.v1.IsCalendarYear","com.sap.vocabularies.Common.v1.IsCalendarWeek","com.sap.vocabularies.Common.v1.IsCalendarMonth","com.sap.vocabularies.Common.v1.IsCalendarQuarter","com.sap.vocabularies.Common.v1.IsCalendarYearWeek","com.sap.vocabularies.Common.v1.IsCalendarYearMonth","com.sap.vocabularies.Common.v1.IsCalendarYearQuarter"];var a={isDate:function(a){return this._isDefaultTrue(a[e[0]])},isYear:function(a){return this._isDefaultTrue(a[e[1]])},isWeek:function(a){return this._isDefaultTrue(a[e[2]])},isMonth:function(a){return this._isDefaultTrue(a[e[3]])},isQuarter:function(a){return this._isDefaultTrue(a[e[4]])},isYearWeek:function(a){return this._isDefaultTrue(a[e[5]])},isYearMonth:function(a){return this._isDefaultTrue(a[e[6]])},isYearQuarter:function(a){return this._isDefaultTrue(a[e[7]])},isCalendarValue:function(a){return this._isMatching(a,e)},_isMatching:function(e,a){var r=false;for(var n=0;n<a.length;n++){if(this._isDefaultTrue(e[a[n]])){r=true;break}}return r},_isDefaultTrue:function(e){if(e){return e.Bool?e.Bool!=="false":true}return false},updateViewMetadata:function(e){var a=this.getCalendarAnnotationType(e);if((a==="IsCalendarYearQuarter"||a==="IsCalendarYearWeek"||a==="IsCalendarYearMonth")&&e.maxLength){e.maxLength=(parseInt(e.maxLength)+1).toString()}return e},getCalendarAnnotationType:function(a){for(var r=1;r<e.length;r++){var n=a[e[r]];var t=e[r].split(".");if(n&&n.Bool!=="false"&&t){return t[t.length-1]}}return null}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ChartMetadata", [],function(){"use strict";var a={"com.sap.vocabularies.UI.v1.ChartType/Column":"column","com.sap.vocabularies.UI.v1.ChartType/ColumnStacked":"stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnDual":"dual_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStackedDual":"dual_stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStacked100":"100_stacked_column","com.sap.vocabularies.UI.v1.ChartType/ColumnStackedDual100":"100_dual_stacked_column","com.sap.vocabularies.UI.v1.ChartType/Bar":"bar","com.sap.vocabularies.UI.v1.ChartType/BarStacked":"stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarDual":"dual_bar","com.sap.vocabularies.UI.v1.ChartType/BarStackedDual":"dual_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStacked100":"100_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/BarStackedDual100":"100_dual_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/Area":"area","com.sap.vocabularies.UI.v1.ChartType/AreaStacked":"stacked_column","com.sap.vocabularies.UI.v1.ChartType/AreaStacked100":"100_stacked_column","com.sap.vocabularies.UI.v1.ChartType/HorizontalArea":"bar","com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked":"stacked_bar","com.sap.vocabularies.UI.v1.ChartType/HorizontalAreaStacked100":"100_stacked_bar","com.sap.vocabularies.UI.v1.ChartType/Line":"line","com.sap.vocabularies.UI.v1.ChartType/LineDual":"dual_line","com.sap.vocabularies.UI.v1.ChartType/Combination":"combination","com.sap.vocabularies.UI.v1.ChartType/CombinationStacked":"stacked_combination","com.sap.vocabularies.UI.v1.ChartType/CombinationDual":"dual_combination","com.sap.vocabularies.UI.v1.ChartType/CombinationStackedDual":"dual_stacked_combination","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationStacked":"horizontal_stacked_combination","com.sap.vocabularies.UI.v1.ChartType/Pie":"pie","com.sap.vocabularies.UI.v1.ChartType/Donut":"donut","com.sap.vocabularies.UI.v1.ChartType/Scatter":"scatter","com.sap.vocabularies.UI.v1.ChartType/Bubble":"bubble","com.sap.vocabularies.UI.v1.ChartType/Radar":"line","com.sap.vocabularies.UI.v1.ChartType/HeatMap":"heatmap","com.sap.vocabularies.UI.v1.ChartType/TreeMap":"treemap","com.sap.vocabularies.UI.v1.ChartType/Waterfall":"waterfall","com.sap.vocabularies.UI.v1.ChartType/Bullet":"bullet","com.sap.vocabularies.UI.v1.ChartType/VerticalBullet":"vertical_bullet","com.sap.vocabularies.UI.v1.ChartType/HorizontalWaterfall":"horizontal_waterfall","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationDual":"dual_horizontal_combination","com.sap.vocabularies.UI.v1.ChartType/HorizontalCombinationStackedDual":"dual_horizontal_stacked_combination"};var e="dual_column,dual_stacked_column,100_stacked_column,100_dual_stacked_column,bar,dual_bar,dual_stacked_bar,100_dual_stacked_bar,area,stacked_bar,100_stacked_bar,dual_line,stacked_combination,dual_stacked_combination,horizontal_stacked_combination,pie,donut,heatmap,treemap,bullet,horizontal_waterfall,dual_horizontal_combination,dual_horizontal_stacked_combination";var o={"com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis1":"axis1","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis2":"axis2","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis3":"axis3","com.sap.vocabularies.UI.v1.ChartMeasureRoleType/Axis4":"axis4"};var r={"com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category":"category","com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Series":"series","com.sap.vocabularies.UI.v1.ChartDimensionRoleType/Category2":"category2"};var t=["AcceptanceRangeLowValue","AcceptanceRangeHighValue","ToleranceRangeLowValue","ToleranceRangeHighValue","DeviationRangeLowValue","DeviationRangeHighValue"];var i={mCriticalityType:{},mImprovementDirectionType:{},getChartType:function(e){return a[e]},getIgnoredChartTypesForTimeSeries:function(){return e},getAnnotationChartType:function(e){for(var o in a){if(a[o]===e){return o}}},getMeasureRole:function(a){return o[a]},getAnnotationMeasureRole:function(a){for(var e in o){if(o[e]===a){return e}}},getDimensionRole:function(a){return r[a]},getAnnotationDimensionRole:function(a){for(var e in r){if(r[e]===a){return e}}},getCriticalityThresholds:function(){return t},calculateConstantValue:function(a){var e=a?a.Decimal||a.Int||a.String:undefined;return Number(e)},calculateValue:function(a){var e=a?a.Decimal||a.Int||a.String:undefined;return e},getValueCriticality:function(a){return a["com.sap.vocabularies.UI.v1.ValueCriticality"]||null},getCriticalityType:function(a){return i.mCriticalityType[a]},getImprovementDirectionType:function(a){return i.mImprovementDirectionType[a]},feedWithChartLibrary:function(a,e){if(!i.chartLibrary){i.chartLibrary=a;var o=a.coloring.ImprovementDirectionType;i.mCriticalityType={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":e.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":e.Negative,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":e.Critical,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":e.Positive};i.mImprovementDirectionType={"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Target":o.Target,"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Maximize":o.Maximize,"com.sap.vocabularies.UI.v1.ImprovementDirectionType/Minimize":o.Minimize}}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ComboBox", ["sap/m/ComboBox","sap/m/ComboBoxRenderer","sap/ui/comp/util/ComboBoxUtils"],function(e,t,r){"use strict";var o=e.extend("sap.ui.comp.odata.ComboBox",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IDropDownTextArrangement"],properties:{textArrangement:{type:"string",group:"Misc",defaultValue:""}},events:{selectedKeyChange:{parameters:{selectedKey:{type:"string"}}}}},renderer:t});o.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);this._processSelectedKeyChange()};o.prototype._processSelectedKeyChange=function(){var e,t,r=this.getSelectedKey();if(r!==this._sKey){e=this.getKeys();t=this.getItemByKey(""+r);if(t&&e.indexOf(r)!==-1){this.fireSelectedKeyChange({selectedKey:r});this._sKey=r}}};o.prototype.setValue=function(t){var o=this.getSelectedKey(),s=this.getItemByKey(""+o),i=this.getTextArrangement();if(i&&s!==null){t=r.formatDisplayBehaviour(s,i)}return e.prototype.setValue.call(this,t)};return o});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/CriticalityMetadata", [],function(){"use strict";var i={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":0,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":1,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":2,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":3,0:0,1:1,2:2,3:3};var t={0:"None",1:"Error",2:"Warning",3:"Success"};var r={0:null,1:"sap-icon://error",2:"sap-icon://alert",3:"sap-icon://sys-enter-2"};var a={getCriticalityState:function(r){if(typeof r==="string"){r=i[r]}return t[r]},getCriticalityIcon:function(t){if(typeof t==="string"){t=i[t]}return r[t]},getShowCriticalityIcon:function(i){return i==="com.sap.vocabularies.UI.v1.CriticalityRepresentationType/WithoutIcon"?false:true}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/FiscalFormat", ["sap/ui/comp/odata/PeriodDateFormat"],function(e){"use strict";var a=e.extend("sap.ui.comp.odata.FiscalFormat",{metadata:{library:"sap.ui.comp"},constructor:function(a,r){e.apply(this,arguments)}});a.getDateInstance=function(e){return new a(null,e)};a.prototype.getName=function(){return"sap.ui.comp.odata.FiscalFormat"};a.oRegexFormatPatterns={year:/[1-9][0-9]{3}/,period:/[0-9]{3}/,quarter:/[1-4]/,week:/0[1-9]|[1-4][0-9]|5[0-3]/,day:/371|370|3[0-6][0-9]|[1-2][0-9][0-9]|[1-9][0-9]|[1-9]/};a.oRegexParsePatterns={year:/[0-9]{1,4}/,period:/[0-9]{1,3}/,quarter:/[1-4]/,week:/[0-9]{1,2}/,day:/[1-9]/};a.prototype.oSymbols={"":"",y:{format:a.oRegexFormatPatterns.year,parse:a.oRegexParsePatterns.year},Y:{format:a.oRegexFormatPatterns.year,parse:a.oRegexParsePatterns.year},P:{format:a.oRegexFormatPatterns.period,parse:a.oRegexParsePatterns.period},W:{format:a.oRegexFormatPatterns.week,parse:a.oRegexParsePatterns.week},d:{format:a.oRegexFormatPatterns.day,parse:a.oRegexParsePatterns.day},Q:{format:a.oRegexFormatPatterns.quarter,parse:a.oRegexParsePatterns.quarter},q:{format:a.oRegexFormatPatterns.quarter,parse:a.oRegexParsePatterns.quarter}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/FiscalMetadata", [],function(){"use strict";var a={isFiscalValue:function(a){for(var s=0;s<this.aAnnotations.length;s++){if(this.isTermDefaultTrue(a[this.aAnnotations[s]])){return true}}return false},isFiscalYear:function(a){return this.isTermDefaultTrue(a["com.sap.vocabularies.Common.v1.IsFiscalYear"])},isFiscalYearPeriod:function(a){return this.isTermDefaultTrue(a["com.sap.vocabularies.Common.v1.IsFiscalYearPeriod"])},getFiscalAnnotationType:function(a){for(var s=0;s<this.aAnnotations.length;s++){var e=a[this.aAnnotations[s]];var o=this.aAnnotations[s].split(".");if(e&&e.Bool!=="false"&&o){return o[o.length-1]}}return null},isTermDefaultTrue:function(a){if(a){return a.Bool?a.Bool!=="false":true}return false},updateViewMetadata:function(a){var s=this.getFiscalAnnotationType(a);if(s==="IsFiscalYearPeriod"||s==="IsFiscalYearQuarter"||s==="IsFiscalYearWeek"){a.maxLength=(parseInt(a.maxLength)+1).toString()}return a},aAnnotations:["com.sap.vocabularies.Common.v1.IsFiscalYear","com.sap.vocabularies.Common.v1.IsFiscalPeriod","com.sap.vocabularies.Common.v1.IsFiscalYearPeriod","com.sap.vocabularies.Common.v1.IsFiscalQuarter","com.sap.vocabularies.Common.v1.IsFiscalYearQuarter","com.sap.vocabularies.Common.v1.IsFiscalWeek","com.sap.vocabularies.Common.v1.IsFiscalYearWeek","com.sap.vocabularies.Common.v1.IsDayOfFiscalYear"]};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/MetadataAnalyser", ["./ODataType","sap/ui/comp/odata/FiscalMetadata","sap/ui/model/odata/AnnotationHelper","sap/m/library","sap/base/Log","sap/ui/comp/odata/CalendarMetadata"],function(t,e,i,n,a,o){"use strict";var r={"com.sap.vocabularies.Common.v1.FilterExpressionType/SingleInterval":"interval","com.sap.vocabularies.Common.v1.FilterExpressionType/MultiValue":"multi-value","com.sap.vocabularies.Common.v1.FilterExpressionType/SingleValue":"single-value"};var s={"com.sap.vocabularies.UI.v1.SelectionRangeOptionType/EQ":"EQ","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/BT":"BT","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/CP":"CP","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/LE":"LE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/GE":"GE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NE":"NE","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NB":"NB","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/NP":"NP","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/GT":"GT","com.sap.vocabularies.UI.v1.SelectionRangeOptionType/LT":"LT"};var l={"com.sap.vocabularies.UI.v1.SelectionRangeSignType/I":"I","com.sap.vocabularies.UI.v1.SelectionRangeSignType/E":"E"};var u=n.P13nConditionOperation;var p=function(t){if(typeof t==="object"){this.oModel=t}else{this._sResourceRootUri=t}this._oMetadata=null;if(!this.oModel&&this._sResourceRootUri){a.error("Analyzing metadata cannot be done without an ODataModel!");return}if(this.oModel){this._oMetaModel=this.oModel.getMetaModel()}if(this._oMetaModel){this._oMetadata=this._oMetaModel.getProperty("/")}if(this._oMetadata&&this._oMetadata.dataServices){this._oSchemaDefinition=this._oMetadata.dataServices.schema[0]}};p.hierarchyType={nodeFor:1,nodeExternalKeyFor:2,parentNodeFor:3,levelFor:4,drillStateFor:5,nodeDescendantCountFor:6};p.prototype.getNamespace=function(){if(this._oSchemaDefinition){return this._oSchemaDefinition.namespace}};p.prototype.getSchemaDefinition=function(){return this._oSchemaDefinition};p.prototype.getEntityContainerAttribute=function(t){var e=null,i;if(this._oMetaModel&&t){if(t.indexOf("sap:")<0){t="sap:"+t}i=this._oMetaModel.getODataEntityContainer();e=i[t]||null}return e};p.prototype.getEntityLabelByEntityTypeName=function(t){var e=this._getEntityDefinition(t),i,n="";if(e){i=e["com.sap.vocabularies.Common.v1.Label"];if(i&&i.String){n=i.String}}return n};p.prototype._getEntityDefinition=function(t){var e=null;if(t){e=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(t))}return e};p.prototype._getComplexTypeDefinition=function(t){var e=null;if(t){e=this._oMetaModel.getODataComplexType(this._getFullyQualifiedNameForEntity(t))}return e};p.prototype._getNameOfPropertyUsingComplexType=function(t,e){var i;if(this._oSchemaDefinition){i=this._oSchemaDefinition.namespace}if(t&&e&&i){var n=i+"."+e;var a=this._getEntityDefinition(t);if(a){var o=a.property;if(o&&o.length){var r=0;for(r=0;r<o.length;r++){var s=o[r];if(s&&s.type===n){return s.name}}}}}return null};p.prototype.removeNamespace=function(t){var e,i=t;if(t){e=t.lastIndexOf(".")+1}if(e>0){i=t.substring(e)}return i};p.prototype.getEntityTypeNameFromEntitySetName=function(t){var e=null,i=null;if(this._oMetaModel){e=this._oMetaModel.getODataEntitySet(t);if(e){i=e.entityType}}return i};p.prototype.getEntitySetNameFromEntityTypeName=function(t){var e,i,n,a,o,r;if(this._oMetaModel&&t){e=this._getFullyQualifiedNameForEntity(t);i=this._oMetaModel.getODataEntityContainer();if(i&&e){n=i.entitySet;o=n.length;for(a=0;a<o;a++){r=n[a];if(r.entityType===e){break}r=null}if(r){return r.name}}}return null};p.prototype.getKeysByEntitySetName=function(t){var e=null,i=null;if(!this._oMetaModel){return undefined}i=this.getEntityTypeNameFromEntitySetName(t);if(i){e=this.getKeysByEntityTypeName(i)}return e};p.prototype.getKeysByEntityTypeName=function(t){var e=null,i=null,n,a=0,o=null;if(!this._oMetaModel){return undefined}o=this._getEntityDefinition(t);if(o){if(o.key){i=o.key.propertyRef;if(i){a=i.length;e=[];for(n=0;n<a;n++){e.push(i[n].name)}}}}return e};p.prototype.getFieldsByEntitySetName=function(t){var e=null,i,n=null;if(!this._oMetaModel){return undefined}i=this._oMetaModel.getODataEntitySet(t);if(i){n=i.entityType}if(n){e=this.getFieldsByEntityTypeName(n);this._enrichEntitySetMetadata(e,i)}return e};p.prototype._enrichEntitySetMetadata=function(t,e){var i,n,a,o,r,s;a=this._getNonSortableFields(e);o=this._getNonFilterableFields(e);r=this._getRequiredFilterFields(e);s=this._getFilterExpressionRestriction(e);i=t.length;while(i--){n=t[i];n.sortable=!(a.indexOf(n.name)>-1);n.filterable=!(o.indexOf(n.name)>-1);n.requiredFilterField=r.indexOf(n.name)>-1;n.filterRestriction=s[n.name]}};p.prototype._extractPropertyPathsFromAnnotation=function(t,e){var i=[],n,a,o;if(t&&e){n=t[e]}if(n){a=n.length;while(a--){o=n[a].PropertyPath;if(o){i.push(o)}}}return i};p.prototype._getNonSortableFields=function(t){var e;if(t){e=t["Org.OData.Capabilities.V1.SortRestrictions"]}return this._extractPropertyPathsFromAnnotation(e,"NonSortableProperties")};p.prototype._getNonFilterableFields=function(t){var e;if(t){e=t["Org.OData.Capabilities.V1.FilterRestrictions"]}return this._extractPropertyPathsFromAnnotation(e,"NonFilterableProperties")};p.prototype._getRequiredFilterFields=function(t){var e;if(t){e=t["Org.OData.Capabilities.V1.FilterRestrictions"]}return this._extractPropertyPathsFromAnnotation(e,"RequiredProperties")};p.prototype._getFilterExpressionRestriction=function(t){var e={},i,n,a,o,s;if(t){var l=t["Org.OData.Capabilities.V1.FilterRestrictions"];if(l){i=l["FilterExpressionRestrictions"];if(i){for(var u=0;u<i.length;u++){o=i[u].Property;s=i[u].AllowedExpressions;if(s&&s.String){switch(s.String){case"SingleValue":e[o.PropertyPath]="single-value";break;case"MultiValue":e[o.PropertyPath]="multi-value";break;case"SingleRange":e[o.PropertyPath]="interval";break;case"SearchExpression":e[o.PropertyPath]="search-expression";break;default:}}}}}if(i==undefined){i=t["com.sap.vocabularies.Common.v1.FilterExpressionRestrictions"];if(i){n=i.length;while(n--){a=i[n];if(a){o=a.Property;s=a.AllowedExpressions;if(o&&s&&o.PropertyPath&&s.EnumMember){e[o.PropertyPath]=r[s.EnumMember]}}}}}}return e};p.prototype._isFilterable=function(t,e){var i,n=true;if(e){i=this._getNonFilterableFields(e);n=!(i.indexOf(t.name)>-1)}if(n){n=!(t["sap:filterable"]==="false")}return n};p.isHiddenFilter=function(t){return!!t["com.sap.vocabularies.UI.v1.HiddenFilter"]&&p.isTermDefaultTrue(t["com.sap.vocabularies.UI.v1.HiddenFilter"])};p.isHidden=function(t){return!!t["com.sap.vocabularies.UI.v1.Hidden"]&&p.isTermDefaultTrue(t["com.sap.vocabularies.UI.v1.Hidden"])};p.prototype.getFieldsByEntityTypeName=function(t){var e;if(!this._oMetaModel){return undefined}e=this._getEntityDefinition(t);return this._getFieldsByEntityDefinition(e)};p.prototype.getFieldsByComplexTypeName=function(t,e){var i;if(!this._oMetaModel){return undefined}i=this._getComplexTypeDefinition(t);return this._getFieldsByEntityDefinition(i,e)};p.prototype.getAllEntityTypeNames=function(){if(!this._oMetaModel){return undefined}var t=this._oSchemaDefinition;if(t.entityType&&t.entityType.length>0){var e=0;var i=[];for(e=0;e<t.entityType.length;e++){i.push(t.entityType[e].name)}return i}return null};p.prototype.getFieldSemanticObjectMap=function(t){var e=this.getFieldsByEntitySetName(t);if(!e){return null}var i={},n,a=e.length;for(n=0;n<a;n++){var o=e[n];var r=this.getSemanticObjectAnnotation(o.fullName);if(r&&r.semanticObject){i[o.name]=r.semanticObject}}return i};p.prototype._getFieldsByEntityDefinition=function(t,e){var i=null,n=null,a=0,o=0,r,s;if(t){n=t.property}if(n){i=[];o=n.length;for(a=0;a<o;a++){r=n[a];if(r){s=this._parseV4PropertyAnnotations(r,t,e);this._determineHierarchyInformation(s,r);this._determineFilterAndSortInformation(s,r,null);i.push(s)}}}return i};p.prototype.getPropertyContextByPath=function(t){var e,i,n,a,o;if(t&&this._oMetaModel){e=t.split("/");i=this._oMetaModel.getODataEntityType(e[0])||this._oMetaModel.getODataComplexType(e[0]);n=e[1];a=this._oMetaModel.getODataProperty(i,n,true);if(a){o=this._oMetaModel.createBindingContext(a)}}return o};p.getDisplayFormat=function(t){var e=t["sap:display-format"];if(e){return e}};p.isCalendarDate=function(t){return p.isPropertyStringType(t)&&p.isTermDefaultTrue(t["com.sap.vocabularies.Common.v1.IsCalendarDate"])};p.isFiscalDate=function(t){return e.isFiscalValue(t)};p.isCalendarType=function(t){return o.isCalendarValue(t)};p.getTimezonePropertyPath=function(t){if(t["type"]!=="Edm.DateTimeOffset"){return undefined}var e=t["com.sap.vocabularies.Common.v1.Timezone"];return e?e.Path:undefined};p.getIsTimezoneProperty=function(t){if(t["type"]!=="Edm.String"){return undefined}return t["com.sap.vocabularies.Common.v1.IsTimezone"]&&t["com.sap.vocabularies.Common.v1.IsTimezone"].Bool!=="false"};p.hasValueListRelevantQualifiers=function(t){var e=false;if(t&&t["com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"]){e=true}return e};p.getAggregationRole=function(t){if(t["com.sap.vocabularies.Analytics.v1.Dimension"]){return"dimension"}if(t["com.sap.vocabularies.Analytics.v1.Measure"]){return"measure"}return undefined};p.getLinkDisplayFormat=function(t){if(p.isEmailAddress(t)){return"EmailAddress"}if(p.isPhoneNumber(t)){return"PhoneNumber"}if(p.isURL(t)){return"URL"}return""};p.getValueListMode=function(t){if(p.isValueListWithFixedValues(t)){return"fixed-values"}var e=t["sap:value-list"];if(e){return e}return""};p.isTermTrue=function(t){return!!t&&t.Bool==="true"};p.isPropertyStringType=function(t){return!!t&&t.type==="Edm.String"};p.isTermDefaultTrue=function(t){if(t){return t.Bool?t.Bool!=="false":true}return false};p.isNullable=function(t){return!(t&&t.nullable==="false")};p.isSkippingMeasuredQuantityCheck=function(t){var e="com.sap.vocabularies.UI.v1.DoNotCheckScaleOfMeasuredQuantity";return p.isTermTrue(t[e])};p.isDigitSequence=function(t){return p.isPropertyStringType(t)&&p.isTermDefaultTrue(t["com.sap.vocabularies.Common.v1.IsDigitSequence"])};p.isUpperCase=function(t){return p.isPropertyStringType(t)&&p.isTermDefaultTrue(t["com.sap.vocabularies.Common.v1.IsUpperCase"])};p.isEmailAddress=function(t){return p.isPropertyStringType(t)&&p.isTermDefaultTrue(t["com.sap.vocabularies.Communication.v1.IsEmailAddress"])};p.isPhoneNumber=function(t){return p.isPropertyStringType(t)&&p.isTermDefaultTrue(t["com.sap.vocabularies.Communication.v1.IsPhoneNumber"])};p.isURL=function(t){return p.isPropertyStringType(t)&&(p.isTermDefaultTrue(t["Org.OData.Core.V1.IsURL"])||p.isTermDefaultTrue(t["Org.OData.Core.V1.IsUrl"]))};p.isValueList=function(t){var e="com.sap.vocabularies.Common.v1.ValueList";return!!(t&&(t["sap:value-list"]||t[e]))};p.isRecommendationList=function(t){return!!(t&&t["com.sap.vocabularies.UI.v1.RecommendationList"])};p.isCurrencyCode=function(t){return!!(t&&t["sap:semantics"]==="currency-code")};p.isUnitOfMeasure=function(t){return!!(t&&t["sap:semantics"]==="unit-of-measure")};p.isValueListWithFixedValues=function(t){var e="com.sap.vocabularies.Common.v1.ValueListWithFixedValues";return p.isTermTrue(t[e])};p.hasImportance=function(t){return!!(t&&t["com.sap.vocabularies.UI.v1.Importance"])};p.prototype._parseProperty=function(t,e,i){var n=this._parseV4PropertyAnnotations(t,e,i);this._determineHierarchyInformation(n,t);this._determineFilterAndSortInformation(n,t,null);return n};p.prototype._parseV4PropertyAnnotations=function(t,e,i){var n=Object.assign({},t);var a=t["com.sap.vocabularies.Common.v1.Label"];if(a){n.fieldLabel=a.String}a=t["com.sap.vocabularies.Common.v1.QuickInfo"];if(a){n.quickInfo=a.String}n.displayFormat=p.getDisplayFormat(t);n.isDigitSequence=p.isDigitSequence(t);n.isURL=p.isURL(t);n.isEmailAddress=p.isEmailAddress(t);n.isPhoneNumber=p.isPhoneNumber(t);n.isUpperCase=p.isUpperCase(t);n.isCalendarDate=p.isCalendarDate(t);n.isCalendarType=p.isCalendarType(t);n.calendarType=o.getCalendarAnnotationType(t);n.isFiscalDate=p.isFiscalDate(t);n.timezone=p.getTimezonePropertyPath(t);n.isTimezone=p.getIsTimezoneProperty(t);n.aggregationRole=p.getAggregationRole(t);a=t["Org.OData.Measures.V1.ISOCurrency"];if(a){n.isCurrencyField=true;n.isMeasureField=true;n.unit=a.Path}a=t["Org.OData.Measures.V1.Unit"];if(a){n.isMeasureField=true;n.unit=a.Path}a=t["com.sap.vocabularies.Common.v1.Text"];if(a){n.description=a.Path;n.displayBehaviour=this.getTextArrangementValue(a)}else if(t["com.sap.vocabularies.UI.v1.TextArrangement"]){n.displayBehaviour=this.getTextArrangementValue(t)}a=t["com.sap.vocabularies.UI.v1.IsImageURL"]||t["com.sap.vocabularies.UI.v1.IsImageUrl"];n.isImageURL=p.isTermDefaultTrue(a);n.entityName=e.name;n.parentPropertyName=i;n.fullName=this._getFullyQualifiedNameForField(t.name,e);a=t["com.sap.vocabularies.Common.v1.FieldControl"];n.visible=!(a&&(a.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"||a.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Inapplicable"));n.visible=n.visible&&!p.isHidden(t);n.hiddenFilter=p.isHiddenFilter(t);if(t["defaultValue"]!==undefined){n.defaultPropertyValue=t["defaultValue"]}a=t["com.sap.vocabularies.Common.v1.FilterDefaultValue"];if(a){n.defaultFilterValue=this._getDefaultValues(t.type,a,t)}return n};p.prototype._determineHierarchyInformation=function(t,e){var i={field:null,type:null};if(e["sap:hierarchy-node-for"]!=null){i.field=e["sap:hierarchy-node-for"];i.type=p.hierarchyType.nodeFor}if(e["sap:hierarchy-node-external-key-for"]!=null){i.field=e["sap:hierarchy-node-external-key-for"];i.type=p.hierarchyType.nodeExternalKeyFor}if(e["sap:hierarchy-parent-node-for"]!=null){i.field=e["sap:hierarchy-parent-node-for"];i.type=p.hierarchyType.parentNodeFor}if(e["sap:hierarchy-level-for"]!=null){i.field=e["sap:hierarchy-level-for"];i.type=p.hierarchyType.levelFor}if(e["sap:hierarchy-drill-state-for"]!=null){i.field=e["sap:hierarchy-drill-state-for"];i.type=p.hierarchyType.drillStateFor}if(e["sap:hierarchy-node-descendant-count-for"]!=null){i.field=e["sap:hierarchy-node-descendant-count-for"];i.type=p.hierarchyType.nodeDescendantCountFor}if(i.type!=null){t.hierarchy=i}};p.prototype._determineFilterAndSortInformation=function(t,e,i){if(i){this._enrichEntitySetMetadata([t],i)}if(t.filterable==undefined||t.filterable){t.filterable=e["sap:filterable"]!=="false"}if(!t.filterRestriction&&e["sap:filter-restriction"]){t.filterRestriction=e["sap:filter-restriction"]}if(!t.requiredFilterField){t.requiredFilterField=e["sap:required-in-filter"]==="true"}if(t.sortable==undefined||t.sortable){t.sortable=e["sap:sortable"]!=="false"}};p.prototype._getDefaultValues=function(e,i,n){var o=null,r=t.getDefaultValueTypeName(e);if(i[r]){o=i[r]}else{a.error("default value for "+n.name+" expected through the property "+r)}return o};p.prototype.extractNavigationPropertyField=function(t,e){var i,n,a,o,r,s,l,u=null;if(e&&t){i="/"+e+"/";o=t.split("/");r=o.pop();s=o.join("/");if(s&&r){n=this._oMetaModel.getMetaContext(i+s);if(n){l=this._oMetaModel.getProperty(n.getPath())}}if(l){a=this._oMetaModel.getODataProperty(l,r)}if(a){u=this._parseV4PropertyAnnotations(a,l,s);u.name=t;var p=this._oMetaModel.getODataEntitySet(e);this._determineFilterAndSortInformation(u,a,p);u.name=a.name}}return u};p.prototype.getAllFilterableFieldNamesByEntityTypeName=function(t){var e,i,n,a,o,r,s;r=[];e=this.getAllFilterableFieldsByEntityTypeName(t);if(e&&e.length){n=e.length;for(i=0;i<n;i++){s=e[i];if(s.fields&&s.fields.length){o=s.fields.length;for(a=0;a<o;a++){r.push(s.fields[a].name)}}}}return r};p.prototype._mapSeparateNavigationProperties=function(t){var e={};t.forEach(function(t){var i=t.split("/"),n=i.shift(),a=i.shift();if(!Array.isArray(e[n])){e[n]=[]}if(a){e[n].push(a)}});return e};p.prototype._getAllFilterableFieldsByEntity=function(t,e,i,n){var a=[],o,r,s,l,u,p,f,c,m={},d,y=n&&n.some(t=>t.includes("/"));if(y){m=this._mapSeparateNavigationProperties(n)}if(!this._oMetaModel||!t){return undefined}if(e){r=this._oMetaModel.getODataEntitySet(t);if(r){o=this._getEntityDefinition(r.entityType)}}else{o=this._getEntityDefinition(t)}if(o){a.push(this._getFilterableFieldsFromEntityDefinition(o,undefined,r));s=this._getFilterableAssociations(o,r);for(l in s){if(!n||n.indexOf(l)>-1||y&&Object.keys(m).includes(l)){c=s[l];if(e){u=this._oMetaModel.getODataAssociationSetEnd(o,l);if(u.entitySet){f=this._oMetaModel.getODataEntitySet(u.entitySet)}}p=this._getEntityDefinition(c);if(p){if(i&&p["sap:semantics"]==="parameters"){continue}if(y){d=this._getFilterableFieldsFromEntityDefinition(p,l,f);const t=l;if(m[t]&&m[t].length>0){d.fields=d.fields.filter(function(e){return m[t].includes(e.name)})}a.push(d)}else{a.push(this._getFilterableFieldsFromEntityDefinition(p,l,f))}}}}}return a};p.prototype._getAllFilterableFieldsByEntityForAllEndpoints=function(t,e,i,n){var a=[],o,r,s,l,u,p,f,c;if(!this._oMetaModel||!t){return undefined}if(e){r=this._oMetaModel.getODataEntitySet(t);if(r){o=this._getEntityDefinition(r.entityType)}}else{o=this._getEntityDefinition(t)}if(o){a.push(this._getFilterableFieldsFromEntityDefinition(o,undefined,r));s=this._getAssociations(o,r,true,true);for(l in s){if(!n||n.indexOf(l)>-1){c=s[l];if(e){u=this._oMetaModel.getODataAssociationSetEnd(o,l);if(u.entitySet){f=this._oMetaModel.getODataEntitySet(u.entitySet)}}p=this._getEntityDefinition(c);if(p){if(i&&p["sap:semantics"]==="parameters"){continue}a.push(this._getFilterableFieldsFromEntityDefinition(p,l,f))}}}}return a};p.prototype.getAllFilterableFieldsByEntitySetName=function(t,e,i){if(!this._oMetaModel){return undefined}return this._getAllFilterableFieldsByEntity(t,true,e,i)};p.prototype.getAllFilterableFieldsByEntityTypeName=function(t){if(!this._oMetaModel){return undefined}return this._getAllFilterableFieldsByEntity(t)};p.prototype._getFilterableFieldsFromEntityDefinition=function(t,e,i){var n={},o=[],r=[],s=null,l,u,p,f=null;if(!this._oMetaModel||!t){return undefined}if(!i){a.error("mandatory parameter 'oEntitySet' not set or null.")}else{l=t["com.sap.vocabularies.Common.v1.Label"];if(l){n.groupLabel=l.String}n.groupEntitySetName=i.name;n.groupEntityTypeName=t.name;n.groupName=e;s=this._getFieldsByEntityDefinition(t,e);if(i){this._enrichEntitySetMetadata(s,i)}p=s.length;for(u=0;u<p;u++){f=s[u];if(f.filterable){if(f.visible){f.groupEntitySet=n.groupEntitySetName;f.groupEntityType=n.groupEntityTypeName;o.push(f)}else{r.push(f)}}}}n.fields=o;n.hiddenFields=r;return n};p.prototype._getFullyQualifiedNameForField=function(t,e){var i,n,a=t;if(e){i=e.namespace;n=e.name}if(i&&n){a=i+"."+n+"/"+t}return a};p.prototype.getFieldNameByFullyQualifiedFieldName=function(t){var e,i;e=this.removeNamespace(t);i=e.indexOf("/");e=e.substring(i+1);return e};p.prototype._getFilterableAssociations=function(t,e){return this._getAssociations(t,e,true,false)};p.prototype._getAssociations=function(t,e,i,n){var a={},o=null,r=null,s,l=0,u=null;if(!this._oMetaModel||!t){return undefined}o=t.navigationProperty;if(o&&o.length){l=o.length;for(s=0;s<l;s++){r=o[s];if(i){if(!this._isFilterable(r,e)||p.isHiddenFilter(r)){continue}}u=this._oMetaModel.getODataAssociationEnd(t,r.name);if(!u||u.type===t.namespace+"."+t.name){continue}if(n||u.multiplicity==="1"||u.multiplicity==="0..1"){if(a[r.name]===undefined){a[r.name]=u.type}}}}return a};p.prototype.getParametersByEntitySetName=function(t){var e,i,n,a,o,r,s,l,u,p,f;f=this._oMetaModel.getODataEntitySet(t);if(f){u=this._getEntityDefinition(f.entityType)}i=this._getAssociations(u,null,false,false);for(a in i){r=i[a];l=this._oMetaModel.getODataAssociationSetEnd(u,a);if(l.entitySet){p=this._getEntityDefinition(r);if(p){if(p["sap:semantics"]==="parameters"&&p.key){e={entitySetName:l.entitySet,parameters:[],navPropertyName:""};for(var c=0;c<p.key.propertyRef.length;c++){e.parameters.push(p.key.propertyRef[c].name)}n=this._getAssociations(p,null,false,true);for(o in n){s=n[o];if(s===f.entityType){e.navPropertyName=o;break}}return e}}}}return null};p.prototype.getValueListAnnotationLazy=function(t,e,i){var n,a,o,r,s={additionalAnnotations:[],additionalAnnotationsWithPVQualifier:[]},l,u,f,c,m;r=new Promise(function(r,d){if(t&&this._oMetaModel){c=this.getPropertyContextByPath(t);f=t.split("/");u=f[1];if(c){n=c.getObject&&c.getObject();if(i&&i["sap:value-list"]){n["sap:value-list"]=i["sap:value-list"]}if(e&&p.hasValueListRelevantQualifiers(n)){o=this.oModel.getContext(e);a=this.getODataRelevantValueLists(c,o)}else{a=this._oMetaModel.getODataValueLists(c)}a.then(function(t){for(m in t){l={annotation:t[m]};if(l.annotation){this._enrichValueHelpAnnotation(l,u);if(!l.annotation["PresentationVariantQualifier"]){if(!m){s.primaryValueListAnnotation=l}else{s.additionalAnnotations.push(l)}l.qualifier=m}else{if(!m){s.primaryValueListAnnotationWithPVQualifier=l}else{l.qualifier=m;s.additionalAnnotationsWithPVQualifier.push(l)}}}}if(!s.primaryValueListAnnotation){s.primaryValueListAnnotation=s.additionalAnnotations.shift()}r(s)}.bind(this),d);return}}d()}.bind(this));return r};p.prototype._getFunctionImportValueListAnnotationLazy=function(t,e,i,n){var a=e["com.sap.vocabularies.Common.v1.ValueList"];if(a){return this.getValueListAnnotationFromFunctionImport({"":a},e.name)}return this._loadValueListAnnotationForFunctionImport(t.name,e.name,i,n,e)};p.prototype.getValueListAnnotationFromFunctionImport=function(t,e){var i,n,a,o;i=new Promise(function(i,r){if(t){o=this.getValueListAnnotationForFunctionImport(t,e);if(!o?.primaryValueListAnnotation){r()}n=o.primaryValueListAnnotation;a=this.formatValueListFunctionImport(n,e);return i(a)}r()}.bind(this));return i};p.prototype._loadValueListAnnotationForFunctionImport=function(t,e,i,n,o){var r={additionalAnnotations:[]},s,l=this._oMetaModel?.getFunctionImportParameterContext(t,e);if(l){s=l.getPath()}var u=new Promise(function(t,u){if(s&&this._oMetaModel){var p=this._oMetaModel.getODataValueLists(l);p.then(function(i){r=this.formatValueListFunctionImport(i,e);t(r)}.bind(this)).catch(function(e){a.warning("_loadValueListAnnotationForFunctionImport oValueListsFunctionImportPromise",e);var r=this.getValueListAnnotationLazy(i,n,o);r.then(function(e){t(e)})}.bind(this),u);return}u()}.bind(this));return u};p.prototype.formatValueListFunctionImport=function(t,e){var i={additionalAnnotations:[],additionalAnnotationsWithPVQualifier:[]},n,a;for(a in t){n={annotation:t[a]};if(n.annotation){this._enrichValueHelpAnnotation(n,e);if(!n.annotation["PresentationVariantQualifier"]){if(!a){i.primaryValueListAnnotation=n}else{i.additionalAnnotations.push(n)}n.qualifier=a}else{if(!a){i.primaryValueListAnnotationWithPVQualifier=n}else{n.qualifier=a;i.additionalAnnotationsWithPVQualifier.push(n)}}}}if(!i.primaryValueListAnnotation){i.primaryValueListAnnotation=i.additionalAnnotations.shift()}return i};p.prototype.getODataRelevantValueLists=function(t,e){return this._oMetaModel.getODataValueLists(t).then(function(i){var n,a={},o=this._getODataValueListRelevantQualifiers(t,e),r=Array.isArray(o)&&o.length>0;for(n in i){if(r&&o.indexOf(n)!==-1){a[n]=i[n]}}return a}.bind(this))};p.prototype._getODataValueListRelevantQualifiers=function(t,e){var i,n=e.getModel(),a=t.getObject(),o=a["com.sap.vocabularies.Common.v1.ValueListRelevantQualifiers"];if(Array.isArray(o)&&n!==undefined){i=o.filter(function t(i){var a,o,r,s,l=false,u=i["If"],p=i["String"];if(p||p===""){l=true}else if(this._isBooleanStatement(u)){o=u[0]["Path"];s=n.getObject(o,e);if(s===true){l=true}}else if(u){a=u[0]["Eq"];o=a[0]["Path"];r=a[1]["String"];s=n.getObject(o,e);if(r===s){l=true}}return l}.bind(this)).map(function t(e){var i,n=e["If"],a=e["String"];if(a||a===""){i=a}else if(n){i=n[1]&&n[1]["String"]}return i})}return i};p.prototype._isBooleanStatement=function(t){var e=false;if(t&&t[0]&&t[0]["Eq"]===undefined&&t[0]["Path"]!==undefined){e=true}return e};p.prototype.getValueListAnnotationForFunctionImport=function(t,e){var i={additionalAnnotations:[]},n,a;for(a in t){n={annotation:t[a]};if(n.annotation){this._enrichValueHelpAnnotation(n,e);if(!a){i.primaryValueListAnnotation=n}else{n.qualifier=a;i.additionalAnnotations.push(n)}}}return i};p.prototype.getValueListAnnotation=function(t){var e={additionalAnnotations:[]},i,n,a,o,r,s;if(t&&this._oMetaModel){a=t.split("/");o=this._oMetaModel.getODataEntityType(a[0])||this._oMetaModel.getODataComplexType(a[0]);r=this._oMetaModel.getODataProperty(o,a[1]);if(r){n=r.name;for(var l in r){if(l==="com.sap.vocabularies.Common.v1.ValueList"||l.indexOf("com.sap.vocabularies.Common.v1.ValueList#")>-1){s=null;i={annotation:r[l]};a=l.split("#");if(a.length===2){s=a[1]}if(i.annotation){this._enrichValueHelpAnnotation(i,n);if(!s){e.primaryValueListAnnotation=i}else{i.qualifier=s;e.additionalAnnotations.push(i)}}}}}}return e};p.prototype._getRecommendationListAnnotation=function(t){var e=t.split("/"),i=this._oMetaModel.getODataEntityType(e[0])||this._oMetaModel.getODataComplexType(e[0]),n=e[1],a=this._oMetaModel.getODataProperty(i,n,true),o=this._oMetaModel.createBindingContext(a),r=o.getObject();return r["com.sap.vocabularies.UI.v1.RecommendationList"]};p.prototype._enrichValueHelpAnnotation=function(t,e){var i,n,a,o,r=[],s,l={},u={},f={},c,m,d,y=[],h=[],g,v,b,M,_,F,S=0,T=0,P=0,D=0,E,A=[],O=[];if(t&&t.annotation){i=t.annotation;if(i){n=i["SearchSupported"];t.isSearchSupported=n?n.Bool==="true":false;n=i["CollectionPath"];if(n){t.valueListEntitySetName=n.String;a=this.getVLEntitySets(t.valueListEntitySetName);o=a[0];if(o){t.valueListEntityName=o.entityType;t.valueListEntitySetName=o.name;t.semantics=o["sap:semantics"];r=this.getKeysByEntitySetName(o.name);y=this.getFieldsByEntitySetName(o.name)}}n=i["Label"];if(n){t.valueListTitle=n.String}g=i["Parameters"];if(y&&g){S=g.length}for(T=0;T<S;T++){F=g[T];b=undefined;M=undefined;_=undefined;v=F["ValueListProperty"];b=this.getVLProperty(v,a);v=F["LocalDataProperty"];if(v){M=v.PropertyPath}v=F["Constant"];if(v){_=v[Object.keys(v)[0]]}c=false;if(F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterIn"){c=true}m=false;if(F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"||F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterOut"){m=true}d=false;if(F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterConstant"){d=true}if(F.InitialValueIsSignificant&&F.InitialValueIsSignificant.Bool==="true"&&(F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterIn"||F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterConstant")){O.push(b)}if(c){l[M]=b}if(m){u[M]=b}if(d){f[b]=_}if(m||F.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterDisplayOnly"){D=y.length;while(D--){if(y[D].name===b){h.push(y[D]);break}}}if(!s&&m&&M===e){s=b}if(p.hasImportance(F)&&this._getImportanceAnnotation(F)==="High"){for(P=0;P<y.length;P++){E=y[P];if(E.name===b){A.push(E);break}}}}}t.inParams=l;t.outParams=u;t.constParams=f;t.fields=y;t.valueListFields=h;t.aHighImportanceFields=A;t.keys=r;t.keyField=s;t.descriptionField=this.getDescriptionFieldName(t.keyField,t.valueListEntitySetName);t.deprecationCodeField=this.getDeprecationCodeFieldName(y);t.aInitialValueIsSignificantFields=O}};p.prototype.getVLEntitySets=function(t){var e;if(this._oMetaModel){e=this._oMetaModel.getODataEntitySet(t)}return[e]};p.prototype.getVLProperty=function(t){var e;if(t){e=t.String}return e};p.prototype._enrichRecommendationListAnnotation=function(t){var e={},i=[],n,a;e.annotation=t;a=t["CollectionPath"];if(a){e.path=a.String}a=t["RankProperty"];if(a){e.rankProperty=a.String}a=t["Binding"];if(a){i=a}if(this._oMetaModel&&e.path){n=this._oMetaModel.getODataEntitySet(e.path)}if(n){e.entityName=n.name;e.keys=this.getKeysByEntitySetName(n.name);e.fields=this.getFieldsByEntitySetName(n.name);e.rankField=e.fields.filter(function(t){return t.name===e.rankProperty})}i=i.map(function(t){var i=0;while(i<e.fields.length){if(e.fields[i].name===t.RecommendationListProperty.String){return e.fields[i]}i++}return false});e.fieldsToDisplay=i.concat(e.rankField);return e};p.prototype.getDescriptionFieldName=function(t,e){var i,n=0,a,o,r;if(typeof t==="object"){o=t}else{i=this.getFieldsByEntitySetName(e);if(i){a=i.length;for(n=0;n<a;n++){o=i[n];if(o.name===t){break}o=null}}}if(o&&o["com.sap.vocabularies.Common.v1.Text"]){r=o["com.sap.vocabularies.Common.v1.Text"].Path}return r};p.prototype.getDeprecationCodeFieldName=function(t){var e=0,i,n,a;for(e=0,i=t.length;e<i;e++){n=t[e];if(p.isTermDefaultTrue(n["com.sap.vocabularies.CodeList.v1.IsConfigurationDeprecationCode"])){a=n.name;break}}return a};p.prototype.getIsSearchSupported=function(t){var e=false,i;if(t){i=t.SearchSupported;if(i&&i.Bool==="true"){e=true}}return e};p.prototype.getValueListSemantics=function(t){var e,i,n;if(t){e=t["CollectionPath"]?t["CollectionPath"].String:undefined}if(e){i=this._oMetaModel.getODataEntitySet(e);if(i){n=i["sap:semantics"]}}return n};p.prototype.getLineItemAnnotation=function(t,e){var i,n,a,o;if(t&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(t);if(i){n="com.sap.vocabularies.UI.v1.LineItem";if(e){n+="#"+e}a=i[n];if(a){o={annotation:a};this._enrichAnnotationWithUIDataField(o,a)}}}return o};p.prototype.isSemanticAggregation=function(t){var e;if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(t);if(e){return e["sap:semantics"]==="aggregate"}}return false};p.prototype.getPresentationVariantAnnotation=function(t,e){var i,n,a,o,r,s,l,u,p;if(t&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(t);if(i){n="com.sap.vocabularies.UI.v1.PresentationVariant";if(e){n+="#"+e}a=i[n];if(a){s={annotation:a,requestAtLeastFields:[],sortOrderFields:[],groupByFields:[],maxItems:undefined};if(a.Visualizations){o=a.Visualizations.length;for(r=0;r<o;r++){p=a.Visualizations[r].AnnotationPath;if(!l&&(p==="@com.sap.vocabularies.UI.v1.LineItem"||p.indexOf("@com.sap.vocabularies.UI.v1.LineItem#")>-1)){l=i[p.substring(1)];s.lineItemAnnotation={annotation:l};this._enrichAnnotationWithUIDataField(s.lineItemAnnotation,l)}else if(!u&&(p==="@com.sap.vocabularies.UI.v1.Chart"||p.indexOf("@com.sap.vocabularies.UI.v1.Chart#")>-1)){u=i[p.substring(1)];s.chartAnnotation={annotation:u,semantics:i["sap:semantics"]};this._enrichChartAnnotation(s.chartAnnotation,u)}if(l&&u){break}}}if(a.RequestAtLeast){o=a.RequestAtLeast.length;for(r=0;r<o;r++){s.requestAtLeastFields.push(a.RequestAtLeast[r].PropertyPath)}}if(a.SortOrder){o=a.SortOrder.length;for(r=0;r<o;r++){s.sortOrderFields.push({name:a.SortOrder[r].Property.PropertyPath,descending:a.SortOrder[r].Descending?a.SortOrder[r].Descending.Bool==="true":false})}}if(a.GroupBy){o=a.GroupBy.length;for(r=0;r<o;r++){s.groupByFields.push(a.GroupBy[r].PropertyPath)}}if(a.MaxItems){s.maxItems=a.MaxItems.Int}}}}return s};p.prototype._getPresentationVariantQualifierForVHD=function(t){var e,i,n,a,o;if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(t);i="com.sap.vocabularies.UI.v1.PresentationVariant";for(o in e){if(o.indexOf(i+"#")>-1){a=o.split("#");if(a.length===2){n=a[1]}}}}return n||""};p.prototype._enrichChartAnnotation=function(t,e){var i,n,a;if(t&&e){t.measureFields=[];t.dimensionFields=[];t.measureAttributes={};t.dimensionAttributes={};if(e.ChartType&&e.ChartType.EnumMember){t.chartType=e.ChartType.EnumMember}if(e.Measures){n=e.Measures.length;for(i=0;i<n;i++){t.measureFields.push(e.Measures[i].PropertyPath)}}if(e.MeasureAttributes){n=e.MeasureAttributes.length;for(i=0;i<n;i++){a=e.MeasureAttributes[i];if(a.Measure){t.measureAttributes[a.Measure.PropertyPath]={role:a.Role?a.Role.EnumMember:null,dataPoint:a.DataPoint?a.DataPoint.AnnotationPath:null}}}}if(e.Dimensions){n=e.Dimensions.length;for(i=0;i<n;i++){t.dimensionFields.push(e.Dimensions[i].PropertyPath)}}if(e.DimensionAttributes){n=e.DimensionAttributes.length;for(i=0;i<n;i++){a=e.DimensionAttributes[i];if(a.Dimension){t.dimensionAttributes[a.Dimension.PropertyPath]={role:a.Role?a.Role.EnumMember:null,hierarchyLevel:a.HierarchyLevel?a.HierarchyLevel.Int:0}}}}}};p.prototype.getChartAnnotation=function(t,e){var i,n,a,o;if(t&&this._oMetaModel){i=this._oMetaModel.getODataEntityType(t);if(i){o="com.sap.vocabularies.UI.v1.Chart";if(e){o+="#"+e}n=i[o];if(n){a={annotation:n,semantics:i["sap:semantics"]};this._enrichChartAnnotation(a,n)}}}return a};p.prototype.getDataPointAnnotation=function(t){var e,i,n,a,o,r={};if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(t);if(e){for(i in e){if(i==="com.sap.vocabularies.UI.v1.DataPoint"||i.indexOf("com.sap.vocabularies.UI.v1.DataPoint#")>-1){n=null;o=e[i];a=i.split("#");if(a.length===2){n=a[1]}if(o){if(n){if(!r.additionalAnnotations){r.additionalAnnotations={}}r.additionalAnnotations[n]=o}else{r.primaryAnnotation=o}}}}}}return r};p.prototype.getFieldGroupAnnotation=function(t){var e,i,n,a,o,r,s=[];if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(t));if(e){for(var l in e){if(l==="com.sap.vocabularies.UI.v1.FieldGroup"||l.indexOf("com.sap.vocabularies.UI.v1.FieldGroup#")>-1){i=null;o=e[l];n=l.split("#");if(n.length===2){i=n[1]}if(o){r={annotation:o};if(i){r.groupName=i}a=o["Label"];if(a){r.groupLabel=a.String}a=o["Data"];if(a){this._enrichAnnotationWithUIDataField(r,a)}s.push(r)}}}}}return s};p.prototype.getConnectedFieldsAnnotation=function(t){var e,i,n,a,o,r,s=[];if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(t));if(e){for(var l in e){if(l==="com.sap.vocabularies.UI.v1.ConnectedFields"||l.indexOf("com.sap.vocabularies.UI.v1.ConnectedFields#")>-1){i=null;o=e[l];n=l.split("#");if(n.length===2){i=n[1]}if(o){r={annotation:o};if(i){r.groupName=i}a=o["Label"];if(a){r.groupLabel=a.String}r.fields=[];r.criticality={};a=o["Data"];if(a){for(var u in a){const t=a[u];if(t.RecordType!=="com.sap.vocabularies.UI.v1.DataField"){continue}r.fields.push(u);if(t.Criticality){r.criticality[u]=this._extractCriticalityInfo(t.Criticality,t)}}}s.push(r)}}}}}return s};p.prototype.getFieldGroupsByFilterFacetsAnnotation=function(t){var e,i,n,a,o,r=this.getFieldGroupAnnotation(t);o=r;if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(t));if(e){for(var s in e){if(s==="com.sap.vocabularies.UI.v1.FilterFacets"||s.indexOf("com.sap.vocabularies.UI.v1.FilterFacets#")>-1){o=[];a=e[s];if(a){for(var l=0;l<a.length;l++){i=a[l].Target.AnnotationPath.split("#");if(i.length===2){n=i[1]}if(n){r.some(function(t){if(t.groupName===n){if(a[l].Label){t.groupLabel=a[l].Label.String}o.push(t);return true}return false})}}}}}}}return o};p.prototype._enrichAnnotationWithUIDataField=function(t,e){var i=[],n={},a={},o={},r={},s={},l={},u,p,f,c=0,m=0;if(t&&e){c=e.length;i=[];a={};for(m=0;m<c;m++){f=e[m];if(f&&(f.RecordType==="com.sap.vocabularies.UI.v1.DataField"||f.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")){p=null;u=f["Value"];if(u){p=u.Path}if(p){i.push(p);u=f["Url"];if(u){n[p]=this._extractURLInfo(u)}u=f["Label"];if(u&&u.String){a[p]=u.String}if(this._getHiddenAnnotation(f)){r[p]=true}o[p]=this._getImportanceAnnotation(f);u=f["Criticality"];if(u){s[p]=this._extractCriticalityInfo(u,f)}const t=this._getWidthAnnotation(f);if(t){l[p]=t}}}}t.fields=i;t.urlInfo=n;t.labels=a;t.hidden=r;t.importance=o;t.criticality=s;t.width=l}};p.prototype._extractCriticalityInfo=function(t,e){var i,n;if(t.Path||t.EnumMember){i={};i["path"]=t.Path;i["criticalityType"]=t.EnumMember;n=e["CriticalityRepresentation"];if(n){if(n.Path){i["criticalityRepresentationPath"]=n.Path}else if(n.EnumMember){i["criticalityRepresentationType"]=n.EnumMember}}}return i};p.prototype._extractURLInfo=function(t){var e,n,a,o;if(t){if(t.Apply&&t.Apply.Name==="odata.fillUriTemplate"){e={urlTarget:undefined,parameters:[]};if(!this._oDummyAnnotationHelperContext){this._oDummyAnnotationHelperContext=this._oMetaModel.createBindingContext("/")}if(this._oDummyAnnotationHelperContext){e.urlTarget=i.format(this._oDummyAnnotationHelperContext,t)}n=t.Apply.Parameters;a=n&&n.length?n.length:0;while(a--){o=n[a];if(o&&o.Type==="LabeledElement"&&o.Value&&o.Value.Path){e.parameters.push(o.Value.Path)}}}else if(t.Path){e={urlPath:t.Path}}}return e};p.prototype.updateDataFieldDefault=function(t){var e=t&&t["com.sap.vocabularies.UI.v1.DataFieldDefault"],i;if(e&&(e.RecordType==="com.sap.vocabularies.UI.v1.DataField"||e.RecordType==="com.sap.vocabularies.UI.v1.DataFieldWithUrl")){i=e["Label"];if(i&&i.String){t.label=i.String}i=e["Criticality"];if(i){t.criticalityInfo=this._extractCriticalityInfo(i,e)}i=e["Url"];if(i){t.urlInfo=this._extractURLInfo(i)}t.width=this._getWidthAnnotation(e);t.importance=this._getImportanceAnnotation(e)}};p.prototype.getSelectionVariantAnnotationList=function(t){var e,i,n,a=[],o;if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(t));if(e){for(var r in e){if(r==="com.sap.vocabularies.UI.v1.SelectionVariant"||r.indexOf("com.sap.vocabularies.UI.v1.SelectionVariant#")>-1){n="";i=e[r];o=r.split("#");if(o.length===2){n=o[1]}if(i){a.push({qualifier:n,annotation:i})}}}}}return a};p.prototype.getSelectionPresentationVariantAnnotationList=function(t){var e,i,n,a,o,r,s,l=null,u=null,p=null,f=[],c;if(t&&this._oMetaModel){i=this._oMetaModel.getODataEntitySet(t);if(i){n=this._oMetaModel.getODataEntityType(i.entityType)}e=[i,n];var m=function(t,e){return e.filter(function(e){return e.qualifier===t})[0]};var d=this.getEntityTypeNameFromEntitySetName(t);var y=this;e.forEach(function(t){if(t){for(var e in t){if(e==="com.sap.vocabularies.UI.v1.SelectionPresentationVariant"||e.indexOf("com.sap.vocabularies.UI.v1.SelectionPresentationVariant#")>-1){o="";a=t[e];c=e.split("#");if(c.length===2){o=c[1]}if(a){l=null;if(a.Text&&a.Text.String){l=a.Text.String}if(a.SelectionVariant&&a.SelectionVariant.Path){s=a.SelectionVariant.Path;r="";c=s.split("#");if(c.length===2){r=c[1]}if(n[s.substring(1)]){var i=m(r,y.getSelectionVariantAnnotationList(d));u={qualifier:r,annotation:i?i.annotation:undefined}}}if(a.PresentationVariant&&a.PresentationVariant.Path){s=a.PresentationVariant.Path;r="";c=s.split("#");if(c.length===2){r=c[1]}if(n[s.substring(1)]){p={qualifier:r,annotation:y.getPresentationVariantAnnotation(d,r)}}}f.push({qualifier:o,text:l,annotation:a,selectionVariant:u,presentationVariant:p})}}}}})}return f};p.prototype.getSelectionFieldsAnnotation=function(t){var e,i,n,a,o;if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(this._getFullyQualifiedNameForEntity(t));if(e){i=e["com.sap.vocabularies.UI.v1.SelectionFields"];if(i){o={annotation:i,selectionFields:[]};n=i.length;for(a=0;a<n;a++){o.selectionFields.push(i[a].PropertyPath)}}}}return o};p.prototype.getSemanticKeyAnnotation=function(t){var e,i,n,a,o;if(t&&this._oMetaModel){e=this._oMetaModel.getODataEntityType(t);if(e){i=e["com.sap.vocabularies.Common.v1.SemanticKey"];if(i){o={annotation:i,semanticKeyFields:[]};n=i.length;for(a=0;a<n;a++){o.semanticKeyFields.push(i[a].PropertyPath)}}}}return o};p.resolveEditableFieldFor=function(t){var e=t&&t["com.sap.vocabularies.Common.v1.EditableFieldFor"];return e&&e.PropertyPath};p.isPotentiallySensitive=function(t){return this.isTermTrue(t["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"])};p.prototype._getHiddenAnnotation=function(t){var e=t["com.sap.vocabularies.UI.v1.Hidden"];return e&&e.Bool!=="false"&&!e.Path};p.prototype._getImportanceAnnotation=function(t){var e=null,i;i=t["com.sap.vocabularies.UI.v1.Importance"];if(i){e=i.EnumMember}switch(e){case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":return"Medium";case"com.sap.vocabularies.UI.v1.ImportanceType/Low":return"Low";default:return"High"}};p.prototype._getWidthAnnotation=function(t){var e=null,i,n,a=/\d*\.?\d+(px|em|rem)/gi;i=t["com.sap.vocabularies.HTML5.v1.CssDefaults"];if(i){n=i.width;if(n&&n.String&&a.test(n.String)){e=n.String}}return e};p.prototype.getTextArrangementValue=function(t){var e,i,n,a,o;if(t&&this._oMetaModel){if(typeof t==="string"){t=this._getFullyQualifiedNameForEntity(t);e=t.split("/");if(e.length>1){i=this._oMetaModel.getODataEntityType(e[0])||this._oMetaModel.getODataComplexType(e[0]);n=this._oMetaModel.getODataProperty(i,e[1])}else{n=this._oMetaModel.getODataEntityType(t)||this._oMetaModel.getODataComplexType(t)}}else{n=t}if(n){a=n["com.sap.vocabularies.UI.v1.TextArrangement"]||n["com.sap.vocabularies.Common.v1.Text"]&&n["com.sap.vocabularies.Common.v1.Text"]["com.sap.vocabularies.UI.v1.TextArrangement"]}if(a){switch(a.EnumMember){case"com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst":o="descriptionAndId";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextLast":o="idAndDescription";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate":o="idOnly";break;case"com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly":o="descriptionOnly";break;default:o=undefined;break}}}return o};p.prototype.getSemanticObjectAnnotation=function(t){var e,i,n,a;if(t&&this._oMetaModel){e=t.split("/");i=this._oMetaModel.getODataEntityType(e[0])||this._oMetaModel.getODataComplexType(e[0]);n=this._oMetaModel.getODataProperty(i,e[1]);if(n){a=n["com.sap.vocabularies.Common.v1.SemanticObject"]}return this._prepareSemanticObjectAnnotationFromProperty(a)}return null};p.prototype.getSemanticObjectsFromAnnotation=function(t){if(!t||!this._oMetaModel){return null}var e=t.split("/");var i=this._oMetaModel.getODataEntityType(e[0])||this._oMetaModel.getODataComplexType(e[0]);return p.getSemanticObjectsFromProperty(this._oMetaModel.getODataProperty(i,e[1]))};p.getSemanticObjectsFromProperty=function(t){var e={defaultSemanticObject:undefined,additionalSemanticObjects:[]};for(var i in t){if(i==="com.sap.vocabularies.Common.v1.SemanticObject"){e.defaultSemanticObject=t[i]["Path"]?p._getSemanticObjectBindingPath(t[i]["Path"]):t[i]["String"]}else if(i.startsWith("com.sap.vocabularies.Common.v1.SemanticObject#")){e.additionalSemanticObjects.push(t[i]["String"])}}return e.defaultSemanticObject||e.additionalSemanticObjects.length>0?e:undefined};p._getSemanticObjectBindingPath=function(t){return"{"+t+"}"};p.prototype.getSemanticObjectAnnotationFromProperty=function(t){var e;if(t){e=t["com.sap.vocabularies.Common.v1.SemanticObject"];return this._prepareSemanticObjectAnnotationFromProperty(e)}return null};p.prototype._prepareSemanticObjectAnnotationFromProperty=function(t){var e,i;if(t){e=t["Path"]?p._getSemanticObjectBindingPath(t["Path"]):t["String"];if(e){i={annotation:t};i.semanticObject=e}}return i};p.prototype.getContactAnnotation=function(t){var e=this._oMetaModel.getMetaContext(t);var i=e.getProperty(e.getPath());return i["com.sap.vocabularies.Communication.v1.Contact"]};p.prototype._getFullyQualifiedNameForEntity=function(t){var e,i;if(!t){return undefined}if(t.indexOf(".")>-1){return t}if(this._oSchemaDefinition){e=this._oSchemaDefinition.namespace}if(e&&!(t.indexOf(e)>-1)){i=e+"."+t}else{i=t}return i};p.prototype.getMultiUnitBehaviorEnabled=function(){var t=this._oMetaModel&&this._oMetaModel.getODataEntityContainer();return p.isTermDefaultTrue(t&&t["com.sap.vocabularies.Common.v1.ApplyMultiUnitBehaviorForSortingAndFiltering"])};p.prototype.getPDFSupportedAnnotation=function(){var t=this._oMetaModel&&this._oMetaModel.getODataEntityContainer(true);var e=this._oMetaModel.getObject(t+"/com.sap.vocabularies.PDF.v1.Features");var i={};for(var n in e){var a=e[n];if(a.Bool){i[n]=a.Bool==="true"}else if(a.String){i[n]=a.String}else if(a.Int){i[n]=parseInt(a.Int)}}return e?i:undefined};p.getSelectionRangeOptionType=function(t){return s[t]};p.getSelectionRangeSignType=function(t){return l[t]};p.hasTextArrangementAnnotation=function(t){if(t["com.sap.vocabularies.UI.v1.TextArrangement"]||t["com.sap.vocabularies.Common.v1.Text"]&&t["com.sap.vocabularies.Common.v1.Text"]["com.sap.vocabularies.UI.v1.TextArrangement"]){return true}return false};p.isNumber=function(t){return!!t&&(t.type==="Edm.Decimal"||t.type==="Edm.Double"||t.type==="Edm.Int16"||t.type==="Edm.Int32"||t.type==="Edm.Int64"||t.type==="Edm.Byte"||t.type==="Edm.Single"||t.type==="Edm.String"&&this.isDigitSequence(t))};p._getSearchExpressionTypeOperations=function(){var t={},e=p._getSearchExpressionType();t[e]=p._getSearchExpressionRangeOperationsKeys();return t};p._getSearchExpressionRangeOperationsKeys=function(){return[u.Contains,u.StartsWith,u.EndsWith]};p._getSearchExpressionType=function(){return"string"};p.prototype.destroy=function(){this.oModel=null;this._oMetaModel=null;this._oMetadata=null;this._oSchemaDefinition=null;this._sResourceRootUri=null;this.bIsDestroyed=true;this._oDummyAnnotationHelperContext=null};return p},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataModelUtil", ["sap/ui/core/Lib","sap/ui/model/odata/v2/ODataModel"],function(e,t){"use strict";var a={handleModelInit:function(e,a,i){var o=false,n;if(e&&!e._bMetaModelLoadAttached&&a){n=e.getModel();if(n){if(n.getMetadata()&&n instanceof t){o=true}else if(n.bLoadMetadataAsync||n.getServiceMetadata&&!n.getServiceMetadata()){o=true}e._bMetaModelLoadAttached=true;if(o&&n.getMetaModel()&&n.getMetaModel().loaded){var l=!!i;if(!l){n.getMetaModel().loaded().then(a.bind(e))}else{this._getFlexRuntimeInfoAPI().then(function(t){var o;if(!t.isFlexSupported({element:e})){o=Promise.resolve()}else if(typeof i==="boolean"){o=t.waitForChanges({element:e})}else{o=t.waitForChanges({complexSelectors:i})}Promise.all([n.getMetaModel().loaded(),o]).then(a.bind(e))})}}else{a.apply(e)}}}},_getFlexRuntimeInfoAPI:function(){return e.load("sap.ui.fl").then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){e(t)})})})}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataModelUtilSync", ["sap/ui/core/Lib","sap/ui/model/odata/v2/ODataModel"],function(e,t){"use strict";var a={handleModelInit:function(e,a,n){var i=false,o;if(e&&!e._bMetaModelLoadAttached&&a){o=e.getModel();if(o){if(o.getMetadata()&&o instanceof t){i=true}else if(o.bLoadMetadataAsync||o.getServiceMetadata&&!o.getServiceMetadata()){i=true}e._bMetaModelLoadAttached=true;if(i&&o.getMetaModel()&&o.getMetaModel().loaded){var l=!!n;if(!l){return o.getMetaModel().loaded().then(a.bind(e))}else{return this._waitForFlexChanges(o,e,a,n)}}else{a.apply(e)}}}return Promise.resolve()},_waitForFlexChanges:function(e,t,a,n){return this._getFlexRuntimeInfoAPI().then(i=>this._flexRuntimeInfoAPIHandler(i,e,t,a,n))},_getFlexRuntimeInfoAPI:function(){return e.load("sap.ui.fl").then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(t){e(t)})})})},_flexRuntimeInfoAPIHandler:function(e,t,a,n,i){var o;if(!e.isFlexSupported({element:a})){o=Promise.resolve()}else if(typeof i==="boolean"){o=e.waitForChanges({element:a})}else{o=e.waitForChanges({complexSelectors:i})}return Promise.all([t.getMetaModel().loaded(),o]).then(n.bind(a))}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/ODataType", ["sap/ui/model/odata/type/Boolean","sap/ui/model/odata/type/Byte","sap/ui/model/odata/type/DateTime","sap/ui/model/odata/type/DateTimeOffset","sap/ui/model/odata/type/Decimal","sap/ui/model/odata/type/Double","sap/ui/model/odata/type/Single","sap/ui/model/odata/type/Guid","sap/ui/model/odata/type/Int16","sap/ui/model/odata/type/Int32","sap/ui/model/odata/type/Int64","sap/ui/model/odata/type/SByte","sap/ui/model/odata/type/String","sap/ui/model/odata/type/Time","sap/ui/comp/odata/type/StringDate","sap/ui/comp/odata/type/FiscalDate","sap/ui/comp/odata/type/NumericText","sap/ui/model/odata/type/DateTimeWithTimezone","sap/ui/comp/odata/type/CalendarDate"],function(e,t,a,i,d,m,n,u,o,r,l,p,s,E,y,f,D,T,c){"use strict";var I={"Edm.Boolean":e,"Edm.Byte":t,"Edm.DateTime":a,"Edm.DateTimeOffset":i,"Edm.Decimal":d,"Edm.Double":m,"Edm.Float":n,"Edm.Guid":u,"Edm.Int16":o,"Edm.Int32":r,"Edm.Int64":l,"Edm.SByte":p,"Edm.Single":n,"Edm.String":s,"Edm.Time":E};var g={"Edm.Boolean":"Bool","Edm.Byte":"Int","Edm.DateTime":"Date","Edm.DateTimeOffset":"DateTimeOffset","Edm.Decimal":"Decimal","Edm.Double":"Float","Edm.Float":"Float","Edm.Guid":"Guid","Edm.Int16":"Int","Edm.Int32":"Int","Edm.Int64":"Int","Edm.SByte":"Int","Edm.Single":"Float","Edm.String":"String","Edm.Time":"TimeOfDay"};var S={"Edm.Byte":true,"Edm.Decimal":true,"Edm.Double":true,"Edm.Float":true,"Edm.Int16":true,"Edm.Int32":true,"Edm.Int64":true,"Edm.SByte":true,"Edm.Single":true};var B={"Edm.DateTime":true,"Edm.DateTimeOffset":true,"Edm.Time":true};var F={getType:function(e,t,a,i){var d=null,m;if(i){if(i.isCalendarType&&i.calendarType){return new c(t,a,{calendarType:i.calendarType})}if(typeof i==="boolean"||i.isCalendarDate){return new y(t)}if(i.isFiscalDate&&i.fiscalType){return new f(t,a,{fiscalType:i.fiscalType})}if(a&&a.isDigitSequence){return new D(t,a)}if(i.isTimezone){return new T(t)}}m=I[e];if(m){d=new m(t,a)}return d},isNumeric:function(e){return S[e]?true:false},isDateOrTime:function(e){return B[e]?true:false},getDefaultValueTypeName:function(e){return g[e]},getTypeName:function(e){if(e.indexOf("Edm.")===0){return e.substring(4)}return e}};return F},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/PeriodDateFormat", ["sap/base/i18n/Formatting","sap/ui/base/Object","sap/ui/core/Locale","sap/ui/core/LocaleData"],function(t,e,o,s){"use strict";var r=e.extend("sap.ui.comp.odata.PeriodDateFormat",{metadata:{library:"sap.ui.comp"},constructor:function(r,a){e.call(this,r,a);var i,n,l,p,u=new o(t.getLanguageTag()),f=s.getInstance(u),m=t.getCustomLocaleData(),h=/(m|y)(?:.*)(\W)(m|y)/i,g=m["dateFormats-short"];this.oFormatOptions=a;if(this.oFormatOptions.format.length>4){i="yM"}else if(this.oFormatOptions.format==="PPP"){i="M"}else{i=this.oFormatOptions.format}if(g&&i==="yM"){p=g.match(h).splice(1).join("");if(p){n=p}}else{n=f.getCustomDateTimePattern(i,this.oFormatOptions.calendarType)}n=n.replace(/([\u4e00-\u9faf\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uffef])+/gi,"");if(this.oFormatOptions.format.length>4){n=n.replace(/y+/i,this.oFormatOptions.format.slice(0,this.oFormatOptions.format.lastIndexOf("Y")+1));n=n.replace(/m+/i,this.oFormatOptions.format.slice(this.oFormatOptions.format.lastIndexOf("Y")+1))}else if(this.oFormatOptions.format==="PPP"){n="PPP"}l=this.parseCldrDatePattern(n);this.oFormatOptions.pattern=l.length>1?n:"";this._setFormatRegex(l);this._setParseRegex(l);this._setValidationRegex(l)}});r.getDateInstance=function(t){return new r(null,t)};r.prototype.getPattern=function(){return this.oFormatOptions.pattern};r.prototype.getRegExPattern=function(){return this.sFormatRegExPattern};r.prototype.getTemplate=function(){return this.sFormatRegExGroups};r.prototype._setFormatRegex=function(t){var e=[],o=[],s,r,a,i,n;for(n=0;n<t.length;n++){s=t[n];r=s.symbol||"";a=this.oSymbols[r].format;if(r===""){o[n]=s.value}else if(r==="y"||r==="Y"){e.unshift("("+a.source+")");o[n]="$"+1}else{e.push("("+a.source+")");i=t.some(function(t){return t.symbol==="y"||t.symbol==="Y"});o[n]=i?"$"+2:"$"+1}}this.sFormatRegExPattern=new RegExp(e.join(""));this.sFormatRegExGroups=o.join("")};r.prototype._setParseRegex=function(t){var e,o,s,r,i,n=[],l={},p=0;for(r=0;r<t.length;r++){e=t[r];o=e.symbol||"";s=this.oSymbols[o].parse;if(o===""){n.push("\\D+?")}else{n.push("("+s.source+")");i=++p;l[i]=e}}this.sParseRegExPattern=new RegExp("^"+n.join("")+"$");this.fnParseRegExReplacer=function(){var t,e,o=[];for(var s in l){t=l[s];e=arguments[s];if(e.length<t.digits){if(t.symbol==="y"||t.symbol==="Y"){e=a(e)}else{e=e.padStart(t.digits,"0")}}if(t.symbol==="y"||t.symbol==="Y"){o.unshift(e)}else{o.push(e)}}return o.join("")}};r.prototype._setValidationRegex=function(t){var e,o,s,r,a=[];for(e=0;e<t.length;e++){o=t[e];s=o.symbol||"";r=this.oSymbols[s].format;if(s===""){continue}else if(s==="y"||s==="Y"){a.unshift(r.source)}else{a.push(r.source)}}this.sValidationRegExPattern=new RegExp("^("+a.join(")(")+")$")};r.prototype.parseCldrDatePattern=function(t){var e,o,s,r,a=[];for(e=0;e<t.length;e++){o=t[e];if(s!==o){r={}}else{r.digits+=1;continue}if(typeof this.oSymbols[o]==="undefined"){r.value=o;r.type="text"}else{r.symbol=o;r.digits=1}s=o;a.push(r)}return a};r.prototype.format=function(t){if(t==null||typeof t!=="string"){return""}return t.replace(this.sFormatRegExPattern,this.sFormatRegExGroups)};r.prototype.parse=function(t){if(t){return t.replace(this.sParseRegExPattern,this.fnParseRegExReplacer)}return null};r.prototype.validate=function(t){return this.sValidationRegExPattern.test(t)};r.oRegexFormatPatterns={};r.oRegexParsePatterns={};r.prototype.oSymbols={};r.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this._oAnnotationValidationRegexPattern=null};function a(t){var e,o=Number.parseInt(t),s=(new Date).getUTCFullYear(),r=Math.floor(s/100);e=r*100+o-s;if(t.length===3){o+=Math.floor((r-1)/10)*1e3}else if(e<-70){o+=(r+1)*100}else if(e<30){o+=r*100}else{o+=(r-1)*100}return o}return r});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/SideEffects", [],function(){"use strict";var e=function(){};e.prototype.getSideEffects=function(e,t,r){var i={};if(r){if(e){if(r.entitySet){i.entitySet=this._getForPath(r.entitySet,e)}if(r.entityType){i.entityType=this._getForPath(r.entityType,e)}}if(t&&r.complexType){i.complexType=this._getForPath(r.complexType,t)}}return i};e.prototype._getForPath=function(e,t){var r,i,o={};for(r in e){if(r.indexOf&&r.indexOf("com.sap.vocabularies.Common.v1.SideEffects")===0){i=e[r];if(this._checkSourceProperties(i,t)){o[r]=i}if(this._checkSourceEntities(i,t)){o[r]=i}}}return o};e.prototype._checkSourceProperties=function(e,t){var r,i;if(e.SourceProperties){i=e.SourceProperties.length;for(r=0;r<i;r++){if(e.SourceProperties[r].PropertyPath===t){return true}}}return false};e.prototype._checkSourceEntities=function(e,t){var r,i;if(e.SourceEntities&&e.SourceEntities.Collection){i=e.SourceEntities.Collection.length;for(r=0;r<i;r++){if(e.SourceEntities.Collection[r].NavigationPropertyPath===t){return true}}}else if(e.SourceEntities&&Array.isArray(e.SourceEntities)){i=e.SourceEntities.length;for(r=0;r<i;r++){if(e.SourceEntities[r].NavigationPropertyPath===t){return true}}}return false};e.prototype.destroy=function(){};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/CalendarDate", ["sap/base/i18n/date/CalendarType","sap/ui/core/Lib","sap/ui/comp/smartfield/type/String","sap/ui/comp/odata/type/NumericText","sap/ui/comp/odata/CalendarFormat","sap/ui/model/ValidateException"],function(e,t,a,r,s,i){"use strict";var o=a.extend("sap.ui.comp.odata.type.CalendarDate",{constructor:function(t,i,n){a.call(this,t,i);if(this.oConstraints&&this.oConstraints.isDigitSequence){r.call(this,t,i)}this.sCalendarType=n.calendarType;this.formatter=s.getDateInstance(Object.assign({format:o.CalendarDateFormatter[this.sCalendarType],calendarType:e.Gregorian},t))}});o.prototype.parseValue=function(e){if(e===""){return null}if(this.oConstraints&&this.oConstraints.isDigitSequence){return this.formatter.parse(r.prototype.parseValue.apply(this,arguments))}return this.formatter.parse(a.prototype.parseValue.apply(this,arguments))};o.prototype.formatValue=function(e){var t;if(this.oConstraints&&this.oConstraints.isDigitSequence){var s=Array.from(arguments),i=true;s.push(i);t=r.prototype.formatValue.apply(this,s)}else{t=a.prototype.formatValue.apply(this,arguments)}if(t===null){return null}return this.formatter.format(t)};o.prototype.validateValue=function(e){try{a.prototype.validateValue.apply(this,arguments)}catch(t){if(!this.formatter.validate(e)){throw new i(this.getErrorMessage(this.sCalendarType))}}if(e===null){return}if(!this.formatter.validate(e)){throw new i(this.getErrorMessage(this.sCalendarType))}};o.prototype.destroy=function(){a.prototype.destroy.apply(this,arguments);if(this.formatter){this.formatter.destroy();this.formatter=null}};o.prototype.getErrorMessage=function(e){var a;this.iFullYear=this.iFullYear||(new Date).getFullYear().toString();switch(e){case"IsCalendarYear":a=this.iFullYear;break;case"IsCalendarQuarter":a="1 - 4";break;case"IsCalendarYearQuarter":a=this.iFullYear+"1";break;case"IsCalendarWeek":a="01";break;case"IsCalendarYearWeek":a=this.iFullYear+"01";break;case"IsCalendarMonth":a="01 - 12";break;case"IsCalendarYearMonth":a=this.iFullYear+"01";break;default:a=this.iFullYear}return t.getResourceBundleFor("sap.ui.comp").getText("CALENDAR_VALIDATION_FAILS",[this.formatValue(a,"string")])};o.CalendarDateFormatter={IsCalendarYear:"YYYY",IsCalendarWeek:"WW",IsCalendarMonth:"MM",IsCalendarQuarter:"Q",IsCalendarYearWeek:"YYYYWW",IsCalendarYearMonth:"YYYYMM",IsCalendarYearQuarter:"YYYYQ"};o.prototype.getName=function(){return"sap.ui.comp.odata.type.CalendarDate"};o.prototype.getFormatter=function(){return this.formatter};return o});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/FiscalDate", ["sap/base/i18n/date/CalendarType","sap/ui/core/Lib","sap/ui/comp/smartfield/type/String","sap/ui/comp/odata/type/NumericText","sap/ui/comp/odata/FiscalFormat","sap/ui/model/ValidateException"],function(t,e,a,r,s,i){"use strict";var o=a.extend("sap.ui.comp.odata.type.FiscalDate",{constructor:function(e,i,l){a.call(this,e,i);if(this.oConstraints&&this.oConstraints.isDigitSequence){r.call(this,e,i)}this.sFiscalType=this._getFiscalType(l);this.formatter=s.getDateInstance(Object.assign({format:o.FiscalDateFormatter[this.sFiscalType],calendarType:t.Gregorian},e))}});o.prototype.parseValue=function(t){if(t===""){return null}if(this.oConstraints&&this.oConstraints.isDigitSequence){return this.formatter.parse(r.prototype.parseValue.apply(this,arguments))}return this.formatter.parse(a.prototype.parseValue.apply(this,arguments))};o.prototype.formatValue=function(t){var e;if(this.oConstraints&&this.oConstraints.isDigitSequence){var s=Array.from(arguments),i=true;s.push(i);e=r.prototype.formatValue.apply(this,s)}else{e=a.prototype.formatValue.apply(this,arguments)}if(e===null){return null}return this.formatter.format(e)};o.prototype.validateValue=function(t){try{a.prototype.validateValue.apply(this,arguments)}catch(e){if(!this.formatter.validate(t)){throw new i(this.getErrorMessage(this.sFiscalType))}}if(t===null){return}if(!this.formatter.validate(t)){throw new i(this.getErrorMessage(this.sFiscalType))}};o.prototype.destroy=function(){a.prototype.destroy.apply(this,arguments);if(this.formatter){this.formatter.destroy();this.formatter=null}};o.prototype.getErrorMessage=function(t){var a;this.iFullYear=this.iFullYear||(new Date).getFullYear().toString();switch(t){case"IsFiscalYear":a=this.iFullYear;break;case"IsFiscalPeriod":a="001";break;case"IsFiscalYearPeriod":a=this.iFullYear+"001";break;case"IsFiscalQuarter":a="1";break;case"IsFiscalYearQuarter":a=this.iFullYear+"1";break;case"IsFiscalWeek":a="01";break;case"IsFiscalYearWeek":a=this.iFullYear+"01";break;case"IsDayOfFiscalYear":a="1";break;case"IsFiscalYearVariant":break;default:a=this.iFullYear}return e.getResourceBundleFor("sap.ui.comp").getText("FISCAL_VALIDATION_FAILS",[this.formatValue(a,"string")])};o.FiscalDateFormatter={IsFiscalYear:"YYYY",IsFiscalPeriod:"PPP",IsFiscalYearPeriod:"YYYYPPP",IsFiscalQuarter:"Q",IsFiscalYearQuarter:"YYYYQ",IsFiscalWeek:"WW",IsFiscalYearWeek:"YYYYWW",IsDayOfFiscalYear:"d",IsFiscalYearVariant:""};o.prototype.getName=function(){return"sap.ui.comp.odata.type.FiscalDate"};o.prototype.getFormatter=function(){return this.formatter};o.prototype._getFiscalType=function(t){var e="com.sap.vocabularies.Common.v1.";if(t.anotationType&&t.anotationType.indexOf(e)!=-1){return t.anotationType.replace(e,"")}return t.fiscalType};return o});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/NumericText", ["sap/ui/core/Core","sap/ui/core/library","sap/ui/comp/smartfield/type/String"],function(t,e,o){"use strict";var r=o.extend("sap.ui.comp.odata.type.NumericText",{constructor:function(t,e){if(t&&t.isStringNullable){t=Object.assign({parseKeepsEmptyString:true},t)}o.call(this,t,e);this.oZerosRegex=new RegExp("^[0]*$")}});r.prototype.parseValue=function(t,e,r){if(this.oZerosRegex.test(t)&&!r){if(typeof this.oFieldControl==="function"){this.oFieldControl(t,e)}if(this.oFormatOptions&&(this.oFormatOptions.bFixedKey||this.oFormatOptions.textArrangement)){return t}if(this.oFormatOptions&&this.oFormatOptions.parseKeepsEmptyString){return""}return null}return o.prototype.parseValue.apply(this,arguments)};r.prototype.formatValue=function(t,e,r){if(this.oZerosRegex.test(t)){if(this.oFormatOptions&&this.oFormatOptions?.bFixedKey){return t}if(this.oFormatOptions&&this.oFormatOptions.textArrangement&&t.toString().length!==1){return t}if(r){return"0"}return""}if(t===null&&this.oFormatOptions&&this.oFormatOptions.isStringNullable){return null}return o.prototype.formatValue.apply(this,arguments)};r.prototype.getName=function(){return"sap.ui.comp.odata.type.NumericText"};r.prototype.destroy=function(){o.prototype.destroy.apply(this,arguments)};return r});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/odata/type/StringDate", ["sap/base/i18n/date/CalendarType","sap/ui/model/SimpleType","sap/ui/core/format/DateFormat","sap/ui/model/ValidateException"],function(t,e,a,r){"use strict";var i=e.extend("sap.ui.comp.odata.type.StringDate",{constructor:function(r){e.apply(this,[r]);this.sName="sap.ui.comp.odata.type.StringDate";r=Object.assign({},r,{UTC:false});this.displayFormatter=a.getDateInstance(r);this.parseFormatter=a.getDateInstance({UTC:false,pattern:"yyyyMMdd",calendarType:t.Gregorian,strictParsing:true})}});i.prototype.parseValue=function(t,e){if(t===""){t=null}if(t!=null&&t!=""){var a=e==="string"?this.parseFormatter.parse(t,true):t;t=this.parseFormatter.format(a)}return t};i.prototype.formatValue=function(t,e){if(t===null||t===undefined||t==""){return null}if(!(t instanceof Date)){t=this.parseFormatter.parse(t)}if(e==="string"){return this.displayFormatter.format(t)}return t};i.prototype.validateValue=function(t){if(t!=null){var e=this.parseFormatter.parse(t);if(!e){throw new r(t+" is not a valid date")}}};return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nAnyFilterItem", ["sap/m/library","./P13nFilterItem"],function(e,a){"use strict";var t=a.extend("sap.ui.comp.p13n.P13nAnyFilterItem",{metadata:{library:"sap.ui.comp",properties:{value1:{type:"any",group:"Misc",defaultValue:null},value2:{type:"any",group:"Misc",defaultValue:null}}}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nConditionPanel", ["./P13nConditionPanelBase","sap/m/library","sap/ui/core/Lib","sap/ui/core/library","sap/ui/core/date/UI5Date","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/Device","sap/ui/core/InvisibleText","sap/ui/core/InvisibleMessage","sap/ui/core/ResizeHandler","sap/ui/core/Item","sap/ui/core/ListItem","sap/ui/model/odata/type/Boolean","sap/ui/model/type/String","sap/ui/model/odata/type/String","sap/ui/model/type/Date","sap/ui/model/type/Time","sap/ui/model/odata/type/DateTime","sap/ui/model/type/Float","sap/ui/layout/Grid","sap/ui/layout/GridData","sap/m/Button","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/Text","sap/m/SearchField","sap/m/CheckBox","sap/m/ComboBox","sap/m/Select","sap/m/Label","sap/m/Input","sap/m/DatePicker","sap/m/TimePicker","sap/m/DateTimePicker","sap/base/Log","sap/ui/comp/odata/type/StringDate","sap/ui/comp/p13n/P13nOperationsHelper","./P13nConditionPanelRenderer","sap/ui/model/json/JSONModel","sap/ui/model/Sorter"],function(e,t,i,a,n,o,s,r,l,d,p,u,g,c,h,y,f,_,m,C,S,v,I,T,F,b,x,O,L,D,V,E,P,w,k,M,N,K,A,B,R,G){"use strict";var H=t.ButtonType,U=t.P13nConditionOperation,z=t.P13nConditionOperationType,j=a.ValueState,X=[U.BT,U.EQ,U.LE,U.LT,U.GE,U.GT,U.NotBT,U.NotEQ,U.NotLE,U.NotLT,U.NotGE,U.NotGT],W=a.InvisibleMessageMode,q=t.OverflowToolbarPriority,Q=a.TextAlign,Y=t.ToolbarDesign;var J=e.extend("sap.ui.comp.p13n.P13nConditionPanel",{metadata:{library:"sap.ui.comp",properties:{defaultOperation:{type:"string",group:"Misc",defaultValue:null},_calendarWeekSettings:{type:"string",group:"Misc",defaultValue:"",visibility:"hidden"},_showCurrentDateButton:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"}}},renderer:B});J.prototype.init=function(){this._oRbComp=i.getResourceBundleFor("sap.ui.comp");e.prototype.init.apply(this);this._oOperationsHelper=new A};J.prototype.onBeforeRendering=function(){if(!this._oInvisibleMessage){this._oInvisibleMessage=d.getInstance()}};J.prototype.setOperations=function(e,t,i){var a=i?z.Exclude:z.Include;t=t||"default";if(this._oTypeOperations[t]===undefined){this._oTypeOperations[t]={}}this._oTypeOperations[t][a]=e;this._updateAllOperations()};J._createKeyFieldTypeInstance=function(e){var t;if(!e.typeInstance){switch(e.type){case"boolean":e.typeInstance=new c;break;case"numc":if(!(e.formatSettings&&e.formatSettings.isDigitSequence)){N.error("sap.ui.comp.p13n.P13nConditionPanel","NUMC type support requires isDigitSequence==true!");e.formatSettings=Object.assign({},e.formatSettings,{isDigitSequence:true})}t=e.formatSettings;if(e.maxLength){t=Object.assign({},t,{maxLength:e.maxLength})}if(!t.maxLength){N.error("sap.ui.comp.p13n.P13nConditionPanel","NUMC type suppport requires maxLength!")}e.typeInstance=new y({},t);break;case"date":e.typeInstance=new f(Object.assign({},e.formatSettings,{strictParsing:true}),{});break;case"time":e.typeInstance=new _(Object.assign({},e.formatSettings,{strictParsing:true}),{});break;case"datetime":e.typeInstance=new m(Object.assign({},e.formatSettings,{strictParsing:true}),{displayFormat:"Date"});var i=e.typeInstance;if(!i.oFormat){i.formatValue(n.getInstance(),"string")}if(i.oFormat){i.oFormat.oFormatOptions.UTC=false}break;case"stringdate":e.typeInstance=new K(Object.assign({},e.formatSettings,{strictParsing:true}));break;case"numeric":if(e.precision||e.scale){t={};if(e.precision){t["maxIntegerDigits"]=parseInt(e.precision)}if(e.scale){t["maxFractionDigits"]=parseInt(e.scale)}}e.typeInstance=new C(t);break;default:var a=e.formatSettings;if(e.maxLength){a=Object.assign({},a,{maxLength:e.maxLength})}e.typeInstance=new h({},a);break}}};J.prototype.setKeyFields=function(e){this._aKeyFields=e;this._aKeyFields.forEach(function(e){J._createKeyFieldTypeInstance(e)},this);this._updateKeyFieldItems(this._oConditionsGrid,true);this._updateAllConditionsEnableStates();this._createAndUpdateAllKeyFields();this._updateAllOperations();this._updateConditionFields()};J.prototype.setValues=function(e,t){t=t||"default";this._oTypeValues[t]=e};J.prototype.addOperation=function(e,t,i){var a=i?z.Exclude:z.Include;t=t||"default";if(this._oTypeOperations[t]===undefined){this._oTypeOperations[t]={}}if(this._oTypeOperations[t][a]===undefined){this._oTypeOperations[t][a]=[]}this._oTypeOperations[t][a].push(e);this._updateAllOperations()};J.prototype.getOperations=function(e,t){var i,a,n,o;e=e||"default";if(t!==undefined){i=t?z.Exclude:z.Include;o=this._oTypeOperations[e]&&this._oTypeOperations[e][i]||[]}else{a=this._oTypeOperations[e]&&this._oTypeOperations[e][z.Include]||[];n=this._oTypeOperations[e]&&this._oTypeOperations[e][z.Exclude]||[];o=a.concat(n)}return o};J.prototype._updatePaginatorToolbar=function(){if(this._sConditionType!=="Filter"||this.getMaxConditions()!=="-1"){return}var e=this._aConditionKeys.length;var t=1+Math.floor(Math.max(0,e-1)/this._iConditionPageSize);var i=1+Math.floor(this._iFirstConditionIndex/this._iConditionPageSize);var a=this.getParent();if(!this._oPaginatorToolbar){if(e>this._iConditionPageSize){this._createPaginatorToolbar();this.insertAggregation("content",this._oPaginatorToolbar,0);this._onGridResize()}else{if(a&&a.getMetadata().getName()==="sap.m.Panel"){if(this._sOrgHeaderText==undefined){this._sOrgHeaderText=a.getHeaderText()}}return}}this._oPrevButton.setEnabled(this._iFirstConditionIndex>0);this._oNextButton.setEnabled(this._iFirstConditionIndex+this._iConditionPageSize<e);if(a&&a.setHeaderToolbar){if(!a.getHeaderToolbar()){this.removeAggregation("content",this._oPaginatorToolbar);a.setHeaderToolbar(this._oPaginatorToolbar);a.attachExpand(e=>{this._setToolbarElementVisibility(e.getSource().getExpanded()&&this._bPaginatorButtonsVisible)})}}if(a&&a.getMetadata().getName()==="sap.m.Panel"){if(this._sOrgHeaderText==undefined){this._sOrgHeaderText=a.getHeaderText()}var n=this._sOrgHeaderText+(e>0?" ("+e+")":"");this._oHeaderText.setText(n)}else{this._oHeaderText.setText(e+" Conditions")}this._oPageText.setText(i+"/"+t);this._bPaginatorButtonsVisible=this._bPaginatorButtonsVisible||t>1;this._setToolbarElementVisibility(this._bPaginatorButtonsVisible);if(i>t){this._iFirstConditionIndex-=Math.max(0,this._iConditionPageSize);this._clearConditions();this._fillConditions()}var o=0;this._oConditionsGrid.getContent().forEach(function(e){if(e.select.getSelected()){o++}},this);if(t==i&&e-this._iFirstConditionIndex>o){this._clearConditions();this._fillConditions()}};J.prototype._setToolbarElementVisibility=function(e){this._oPrevButton.setVisible(e);this._oNextButton.setVisible(e);this._oPageText.setVisible(e);this._oFilterField.setVisible(false);this._setLayoutVisible(this._oAddButton,e);this._setLayoutVisible(this._oRemoveAllButton,e)};J.prototype._unregisterResizeHandler=function(){if(this._sContainerResizeListener){p.deregister(this._sContainerResizeListener);this._sContainerResizeListener=null}};J.prototype._registerResizeHandler=function(){if(this.getContainerQuery()){this._sContainerResizeListener=p.register(this._oConditionsGrid,this._onGridResize.bind(this));this._onGridResize()}};J.prototype._handleAddCondition=function(e,t,i,a){let n,o;if(i){n=this._createConditionRow(this._oConditionsGrid,undefined,null,0)}else{o=e.getContent().indexOf(t);n=this._createConditionRow(e,undefined,null,o+1,a)}this._changeField(n);setTimeout(function(){if(n.keyField.getVisible()){n.keyField.focus();return}if(n.operation.getVisible()){n.operation.focus()}},500);this._updatePaginatorToolbar()};J.prototype._handleRemoveCondition=function(e,t){var i=e.getContent().indexOf(t);this._removeCondition(e,t);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false)}if(i>=0){i=Math.min(i,e.getContent().length-1);var t=e.getContent()[i];setTimeout(function(){t.remove.focus()},500)}this._updatePaginatorToolbar()};J.prototype._createPaginatorToolbar=function(){this._bPaginatorButtonsVisible=false;var e=this;this._oPrevButton=new I({icon:s.getIconURI("navigation-left-arrow"),tooltip:this._oRb.getText("p13n.PREVIOUS"),visible:true,press:function(t){e._iFirstConditionIndex=Math.max(0,e._iFirstConditionIndex-e._iConditionPageSize);e._clearConditions();e._fillConditions()},layoutData:new F({priority:q.NeverOverflow})});this._oNextButton=new I({icon:s.getIconURI("navigation-right-arrow"),tooltip:this._oRb.getText("p13n.NEXT"),visible:true,press:function(t){e._iFirstConditionIndex+=e._iConditionPageSize;e._clearConditions();e._fillConditions()},layoutData:new F({priority:q.NeverOverflow})});this._oRemoveAllButton=new I({text:this._oRb.getText("CONDITIONPANEL_REMOVE_ALL"),visible:true,press:function(){e._aConditionKeys.forEach(function(e){this.fireDataChange({key:e,index:0,operation:"remove",newData:null})},e);this._iFirstConditionIndex=0;e.removeAllConditions()},layoutData:new F({priority:q.Low})});this._oAddButton=new I({icon:s.getIconURI("add"),visible:true,press:function(t){e._focusFirstFE();e._oInvisibleMessage.announce(e._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_CONDITION_ADDED"),W.Polite);e._handleAddCondition(this.oTargetGrid,e.oConditionGrid,true)},layoutData:new F({priority:q.Low}),ariaDescribedBy:this._oInvisibleTextOperatorAddButton});this._oHeaderText=new x({wrapping:false,layoutData:new F({priority:q.NeverOverflow})});this._oPageText=new x({wrapping:false,textAlign:Q.Center,layoutData:new F({priority:q.NeverOverflow})});this._oFilterField=new O({width:"12rem",layoutData:new F({priority:q.High})});this._oPaginatorToolbar=new T({height:"3rem",design:Y.Transparent,content:[this._oHeaderText,new b,this._oFilterField,this._oPrevButton,this._oPageText,this._oNextButton,this._oRemoveAllButton,this._oAddButton]})};J.prototype._getCurrentKeyFieldItem=function(e){if(e.getSelectedKey&&e.getSelectedKey()){var t=e.getSelectedKey();var i=this._aKeyFields;for(var a in i){var n=i[a];if(n.key===t){return n}}}return null};J.prototype._createConditionRow=function(e,t,i,a,n){var o,s=this,r=new R;if(a===undefined){a=e.getContent().length}var l=new S({width:"100%",defaultSpan:"L12 M12 S12",hSpacing:1,vSpacing:0,containerQuery:this.getContainerQuery()}).data("_key",i);for(var d in this._aConditionsFields){var p;var u=this._aConditionsFields[d];switch(u["Control"]){case"CheckBox":p=new L({enabled:false,layoutData:new v({span:u["Span"+this._sConditionType]})});this._setLayoutVisible(p,false);if(u["ID"]==="showIfGrouped"){p.setEnabled(true);p.setText(u["Label"]);p.attachSelect(function(){s._changeField(l)});p.setSelected(t?t.showIfGrouped:true)}else{if(t){p.setSelected(true);p.setEnabled(true)}}break;case"ComboBox":if(u["ID"]==="keyField"){p=new D({width:"100%",ariaLabelledBy:this._oInvisibleTextField});var g=p.setSelectedKey.bind(p);p.setSelectedKey=function(e){g(e);var t=s.getValidationExecutor();if(t){t()}};var c=p.setSelectedItem.bind(p);p.setSelectedItem=function(e){c(e);var t=s.getValidationExecutor();if(t){t()}};p.setLayoutData(new v({span:u["Span"+this._sConditionType]}));this._fillKeyFieldListItems(p,this._aKeyFields);if(p.attachSelectionChange){p.attachSelectionChange(function(t){var i=s.getValidationExecutor();if(i){i()}s._handleSelectionChangeOnKeyField(e,l)})}if(p.attachChange){p.attachChange(function(t){l.keyField.close();s._handleChangeOnKeyField(e,l)})}if(p.setSelectedItem){if(t){p.setSelectedKey(t.keyField);this._aKeyFields.forEach(function(e,i){var a=e.key;if(a===undefined){a=e}if(t.keyField===a){p.setSelectedItem(p.getItems()[i])}},this)}else{if(this.getUsePrevConditionSetting()&&!this.getAutoReduceKeyFieldItems()){if(a>0&&!i&&n){o=e.getContent()[a-1];if(o.keyField.getSelectedKey()){p.setSelectedKey(o.keyField.getSelectedKey())}else{if(!p.getSelectedItem()&&p.getItems().length>0){p.setSelectedItem(p.getItems()[0])}}}else{this._aKeyFields.some(function(e,t){if(e.isDefault){p.setSelectedItem(p.getItems()[t]);return true}if(!p.getSelectedItem()&&e.type!=="boolean"){p.setSelectedItem(p.getItems()[t])}},this);if(!p.getSelectedItem()&&p.getItems().length>0){p.setSelectedItem(p.getItems()[0])}}}else{this._aKeyFields.forEach(function(e,t){if(e.isDefault){p.setSelectedItem(p.getItems()[t])}},this)}}}}if(u["ID"]==="operation"){p=new D({width:"100%",ariaLabelledBy:this._oInvisibleTextOperator,layoutData:new v({span:u["Span"+this._sConditionType]})});p.addEventDelegate({onmouseup:function(){if(!this.isOpen()){this.showItems()}}},p);p.setFilterFunction(function(){return true});p.setModel(r);p.attachChange(function(t){s._validateOperationValue(t);s._handleChangeOnOperationField(e,l)});l[u["ID"]]=p;this._updateOperationItems(e,l);var h=this._getCurrentKeyFieldItem(l.keyField),y=this._getRelevantOperations(h);if(t){var f=this.getCurrentOparation(t);y.some(function(e){if(f===e){p.setSelectedKey(e);return true}},this)}else{if(this.getUsePrevConditionSetting()){if(a>0&&i===null){var o=e.getContent()[a-1],_=o.operation.getSelectedKey()||y[0];p.setSelectedKey(_)}else{if(this.getDefaultOperation()){p.setSelectedKey(this.getDefaultOperation())}else{p.setSelectedKey(y[0])}}}}}if(p.getSelectedItem&&p.getSelectedItem()&&p.getMetadata()._sUIDToken!=="box"){p.setTooltip(p.getSelectedItem().getTooltip())}break;case"TextField":var m=this._getCurrentKeyFieldItem(l.keyField);p=this._createValueField(m,u,l);p.oTargetGrid=e;if(p.addAriaLabelledBy){p.addAriaLabelledBy(this._oInvisibleTextOperatorInputValue)}if(t&&t[u["ID"]]!==undefined){var C=t[u["ID"]];if(p instanceof V){if(typeof C==="boolean"){p.setSelectedIndex(C?2:1)}}else if(C!==null&&l.oType){if(typeof C==="string"&&l.oType.getName()==="sap.ui.comp.odata.type.StringDate"){p.setValue(C)}else{var I=l&&l.operation&&X.indexOf(l.operation.getSelectedKey())!==-1;if(typeof C==="string"&&["String","sap.ui.model.odata.type.String","sap.ui.model.odata.type.Decimal"].indexOf(l.oType.getName())==-1){try{C=l.oType.parseValue(C,"string",I);p.setValue(l.oType.formatValue(C,"string",I))}catch(e){N.error("sap.ui.comp.p13n.P13nConditionPanel","Value '"+C+"' does not have the expected type format for "+l.oType.getName()+".parseValue()")}}else{p.setValue(l.oType.formatValue(C,"string",I));if(p.isA("sap.m.ComboBox")){if(C===""){p.getModel().attachEventOnce("batchRequestCompleted",function(e){e.setSelectedItem(e.getItems()[0])}.bind(null,p))}else{p.setSelectedKey(C)}}}}}else{p.setValue(C)}}break;case"Label":p=new E({text:u["Text"]+":",visible:this.getShowLabel(),layoutData:new v({span:u["Span"+this._sConditionType]})}).addStyleClass("conditionLabel");p.oTargetGrid=e;break}l[u["ID"]]=p;l.addContent(p)}this._addButtons(l,e);e.insertContent(l,a);this._updateOperationItems(e,l);this._changeOperationValueFields(e,l);this._updateAllConditionsEnableStates();this._updateConditionButtons(e);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false)}if(this._sLayoutMode){this._updateLayout({name:this._sLayoutMode})}if(t){var T=this._getFormatedConditionText(t.operation,t.value1,t.value2,t.exclude,t.keyField,t.showIfGrouped);t._oGrid=l;t.value=T;this._oConditionsMap[i]=t}var F=l.operation.getSelectedKey();if(F==="BT"&&l.value1.setMinDate&&l.value2.setMaxDate){var b=l.value1.getDateValue();var x=l.value2.getDateValue();this._updateMinMaxDate(l,b,x)}else{this._updateMinMaxDate(l,null,null)}return l};J.prototype._fillOperationListItems=function(e,t,i){var a={items:[]};if(i==="_STRING_"||i==="_TEXT_"){i=""}if(i==="_TIME_"||i==="_DATETIME_"||i==="_STRINGDATE_"){i="_DATE_"}if(i==="_BOOLEAN_"||i==="_NUMC_"){i=""}e.destroyItems();if(t&&t.length>0){t.forEach(function(e){var t=this._oRb.getText("CONDITIONPANEL_OPTION"+i+e,undefined,true);if(t===undefined||t.startsWith("CONDITIONPANEL_OPTION")){t=this._oRb.getText("CONDITIONPANEL_OPTION"+e)}a.items.push({key:e,text:t,sorter:this._oOperationsHelper.isExcludeType(e)?this._oRbComp.getText("VALUEHELPDLG_EXCLUDE"):this._oRbComp.getText("VALUEHELPDLG_INCLUDE"),tooltip:t})}.bind(this));e.getModel().setData(a);e.bindAggregation("items",{path:"/items",sorter:new G("sorter",true,true),template:new g({key:"{key}",text:"{text}"}),templateShareable:false})}};J.prototype._validateOperationValue=function(e){var t=e.getSource(),i=t.getSelectedKey(),a=t.getValue();if(!i&&a){t.setValueState(j.Error);t.setValueStateText(this._oRbComp.getText("VALUEHELPDLG_VALUE_NOT_EXIST",[a]))}else{t.setValueState(j.None)}};J.prototype._fillKeyFieldListItems=function(e,t){e.destroyItems();for(var i in t){var a=t[i];e.addItem(new g({key:a.key,text:a.text,tooltip:a.tooltip}))}this._setLayoutVisible(e,e.getItems().length>1)};J.prototype._updateOperationItems=function(e,t){var i=this._getCurrentKeyFieldItem(t.keyField);var a=i&&i.type||"";var n=t.operation;var o=n.getSelectedItem();var s=this._getRelevantOperations(i);if(i?.typeInstance?.oFormat?.type==="datetime"){a="datetime"}this._fillOperationListItems(n,s,a?"_"+a.toUpperCase()+"_":"");if(o&&n.getItemByKey(o.getKey())){n.setSelectedKey(o.getKey())}else{n.setSelectedItem(n.getItems()[1])}this._sConditionType="Filter";if(s[0]===U.Ascending||s[0]===U.Descending){this._sConditionType="Sort"}if(s[0]===U.GroupAscending||s[0]===U.GroupDescending){this._sConditionType="Group"}this._adjustValue1Span(t)};J.prototype._updateKeyFieldItems=function(e,t,i,a){var n=e.getContent().length;var o;var s={};if(!t){for(o=0;o<n;o++){var r=e.getContent()[o].keyField;var l=r.getSelectedKey();if(l!=null&&l!==""){s[l]=true}}}for(o=0;o<n;o++){var r=e.getContent()[o].keyField;var d=e.getContent()[o].select;var p=r.getSelectedKey();var u=0;var c=this._aKeyFields;if(r!==a){if(i){u=c.length-1}else{r.destroyItems()}for(u;u<c.length;u++){var h=c[u];if(h.key==null||h.key===""||!s[h.key]||h.key===p){r.addItem(new g({key:h.key,text:h.text,tooltip:h.tooltip}))}}this._setLayoutVisible(r,r.getItems().length>1)}if(p){r.setSelectedKey(p)}else if(r.getItems().length>0){r.setSelectedItem(r.getItems()[0])}if(!d.getSelected()){this._aKeyFields.some(function(e,t){if(e.isDefault){r.setSelectedItem(r.getItems()[t]);return true}if(!r.getSelectedItem()){if(e.type!=="boolean"){r.setSelectedItem(r.getItems()[t])}}},this)}if(r.getSelectedItem()){r.setTooltip(r.getSelectedItem().getTooltip())}}};J.prototype._adjustValue1Span=function(e){if(this._sConditionType==="Filter"&&e.value1&&e.operation){var t=e.operation;var i=this._aConditionsFields[5]["Span"+this._sConditionType];var a=t.getSelectedKey();if(a!==U.BT&&a!==U.NotBT){i=this._aKeyFields.length>1?"L5 M11 S10":"XL8 L8 M8 S10"}var n=e.value1.getLayoutData();if(n.getSpan()!==i){n.setSpan(i)}}};J.prototype._changeField=function(e,t){var i=e.keyField.getSelectedKey();if(e.keyField.getSelectedItem()){e.keyField.setTooltip(e.keyField.getSelectedItem().getTooltip())}else{e.keyField.setTooltip(null)}var a=e.operation.getSelectedKey();var n=this._oOperationsHelper.isExcludeType(a);a=n?this._oOperationsHelper.getCorrespondingIncludeOperation(a):a;if(e.operation.getSelectedItem()){e.operation.setTooltip(e.operation.getSelectedItem().getTooltip())}else{e.operation.setTooltip(null)}var o=function(e,t,i){var a,n,o=e.getParent();if(e.getDateValue&&!e.isA("sap.m.TimePicker")&&t.getName()!=="sap.ui.comp.odata.type.StringDate"){n=e.getDateValue();if(t&&n){if(i&&i.getParameter("valid")||e.isValidValue()){a=t.formatValue(n,"string")}else{a=""}}}else{a=this._getValueTextFromField(e);n=a;if(e.isA("sap.m.Select")&&a===this._oRbComp.getText("NO_BOOLEAN_VALUE_SELECTED")){n=a=""}if(t&&t.getName()==="sap.ui.comp.odata.type.StringDate"){a=t.formatValue(n,"string")}else if(t&&a){try{var s=o&&o.operation&&X.indexOf(o.operation.getSelectedKey())!==-1;n=t.parseValue(a,"string",s);var r=this._getCurrentKeyFieldItem(o.keyField);if(r&&r.type==="numc"&&!s&&n===null){a=t.formatValue(n,"string",s);e.setValue(a)}t.validateValue(n);if(e.isA("sap.m.ComboBox")&&!e.getSelectedKey()||i&&e.getId()==i.getSource().getId()&&o.operation.getSelectedKey()===U.BT&&(this._isInvalidFiscalRange(o)||this._isFieldNumeric(o)&&this._isInvalidRange(o))){a=""}}catch(e){N.error("sap.ui.comp.p13n.P13nConditionPanel","not able to parse value "+a+" with type "+t.getName());a=""}}}return[n,a]}.bind(this);var s=o(e.value1,e.oType,t);var r=s[0],l=s[1];s=o(e.value2,e.oType,t);var d=s[0],p=s[1];if(this._hasSecondValue(a)){this._updateMinMaxDate(e,r,d)}else{this._updateMinMaxDate(e,null,null)}var u=this._getCurrentKeyFieldItem(e.keyField);if(u&&u.type==="numc"){if([U.Contains,U.EndsWith].indexOf(a)!=-1){r=e.oType.formatValue(r,"string")}}var g=e.showIfGrouped.getSelected();var c=e.select;var h="";var y;if(i===""||i==null){i=null;y=this._getKeyFromConditionGrid(e);this._removeConditionFromMap(y);this._enableCondition(e,false);var f=this._getIndexOfCondition(e);if(c.getSelected()){c.setSelected(false);c.setEnabled(false);this._bIgnoreSetConditions=true;this.fireDataChange({key:y,index:f,operation:"remove",newData:null});this._bIgnoreSetConditions=false}return}this._enableCondition(e,true);h=this._getFormatedConditionText(a,l,p,n,i,g);var _={value:h,exclude:n,operation:a,keyField:i,value1:r,value2:this._hasSecondValue(a)?d:null,showIfGrouped:g};y=this._getKeyFromConditionGrid(e);if(h!==""||e.value1.isA("sap.m.ComboBox")){c.setSelected(true);c.setEnabled(true);var m="update";if(!this._oConditionsMap[y]){m="add"}this._oConditionsMap[y]=_;if(m==="add"){this._aConditionKeys.splice(this._getIndexOfCondition(e),0,y)}e.data("_key",y);this.fireDataChange({key:y,index:this._getIndexOfCondition(e),operation:m,newData:_})}else if(this._oConditionsMap[y]!==undefined){this._removeConditionFromMap(y);e.data("_key",null);var f=this._getIndexOfCondition(e);if(c.getSelected()){c.setSelected(false);c.setEnabled(false);this._bIgnoreSetConditions=true;this.fireDataChange({key:y,index:f,operation:"remove",newData:null});this._bIgnoreSetConditions=false}}this._updatePaginatorToolbar()};J.prototype._getConditions=function(e){return{index:this._iConditions,key:this._createConditionKey(),exclude:this._oOperationsHelper.isExcludeType(e.oOperation),operation:e.oOperation,keyField:e.oKeyField,value1:e.oPastedValue,value2:null}};J.prototype._isFieldNumeric=function(e){var t=this._getCurrentKeyFieldItem(e.keyField),i=t.type;return!!(i==="numc"||i==="numeric")};J.prototype._isFiscalField=function(e){var t=this._getCurrentKeyFieldItem(e.keyField);return t.typeInstance&&t.typeInstance.isA("sap.ui.comp.odata.type.FiscalDate")};J.prototype._isInvalidRange=function(e){var t=e.value1.getValue(),i=e.value2.getValue();return!!(t&&i&&Number(e.oType.parseValue(t,"string"))>Number(e.oType.parseValue(i,"string")))};J.prototype._isInvalidFiscalRange=function(e){var t,i,a,n,o=e.value1.getValue(),s=e.value2.getValue(),r=this._getCurrentKeyFieldItem(e.keyField),l=r.typeInstance&&r.typeInstance.sFiscalType;if(!this._isFiscalField(e)||!o||!s){return false}if(l==="IsFiscalYearPeriod"||l==="IsFiscalYearQuarter"||l==="IsFiscalYearWeek"){if(o.indexOf("/")!==-1&&s.indexOf("/")!==-1){t=o.split("/")[0];a=s.split("/")[0];i=o.split("/")[1];n=s.split("/")[1];return i===n?t>a:i>n}}else{return parseFloat(o)>parseFloat(s)}};J.prototype._validateAndFormatFieldValue=function(e){var t=e.oSource;var i=t.getParent();var a;var n=this._oRbComp.getText("VALUEHELPVALDLG_FIELD_RANGE_MESSAGE"),o=i&&i.operation&&X.indexOf(i.operation.getSelectedKey())!==-1;if(t.getDateValue&&e){a=e.getParameter("value");var s=e.getParameter("valid");this._makeFieldValid(t,s);return}else{a=t.getValue&&t.getValue()}if(!i){return}if(this.getDisplayFormat()==="UpperCase"&&a){a=a.toUpperCase();t.setValue(a)}if(i.oType&&a){try{var r=i.oType.parseValue(a,"string",o);i.oType.validateValue(r);this._makeFieldValid(t,true);a=i.oType.formatValue(r,"string",o);t.setValue(a);if(i.operation.getSelectedKey()===U.BT){if(this._isFieldNumeric(i)&&this._isInvalidRange(i,e)||this._isInvalidFiscalRange(i,e)){this._makeFieldValid(t,false,n)}else{this._makeFieldValid(i.value1,true);this._makeFieldValid(i.value2,true)}}}catch(e){var l=e.message;this._makeFieldValid(t,false,l)}}else{this._makeFieldValid(t,true)}};J.prototype._changeOperationValueFields=function(t,i){e.prototype._changeOperationValueFields.apply(this,arguments);var a=i.getContent().length,n=i.remove,o=i.indexOfContent(n),s=a-1;if(o!==s){i.insertContent(n,s)}};J.prototype._updateLayout=function(e){};J.prototype._updateConditionFields=function(){this._aConditionsFields=this._createConditionsFields()};J.prototype._focusFirstFE=function(){const e=document.getElementById(this.getId()+"-firstfe");if(e&&e.focus){e.focus()}};J.prototype._addButtons=function(e,t){var i=this;var a=new I({type:H.Transparent,icon:s.getIconURI("decline"),tooltip:this._oRb.getText("CONDITIONPANEL_REMOVE"+(this._sAddRemoveIconTooltipKey?"_"+this._sAddRemoveIconTooltipKey:"")+"_TOOLTIP"),press:function(){i._focusFirstFE();if(!(i._getConditionsCount()===1&&!e.value1.getValue())){i._oInvisibleMessage.announce(i._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_CONDITION_REMOVED"),W.Polite)}i._handleRemoveCondition(this.oTargetGrid,e)},layoutData:new v({span:"XL1 L1 M1 S1"})});a.oTargetGrid=t;e.addContent(a);e["remove"]=a;var n=new I({text:this._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_ADD"),press:function(){i._focusFirstFE();i._oInvisibleMessage.announce(i._oRbComp.getText("VALUEHELPDLG_CONDITIONPANEL_CONDITION_ADDED"),W.Polite);i._handleAddCondition(this.oTargetGrid,e,false,true)},layoutData:new v({span:"XL2 L3 M3 S3",indent:"XL9 L8 M8 S7",linebreak:true}),ariaDescribedBy:i._oInvisibleTextOperatorAddButton});n.oTargetGrid=t;n.addStyleClass("conditionAddBtnFloatRight");n.addStyleClass("conditionAddBtnMarginTop");e.addContent(n);e["add"]=n};J.prototype.getCurrentOparation=function(e){return e.exclude?this._oOperationsHelper.getCorrespondingExcludeOperation(e.operation):e.operation};J.prototype._hasSecondValue=function(t){return e.prototype._hasSecondValue.apply(this,arguments)||t===U.NotBT};J.prototype._hasNoValues=function(t){return e.prototype._hasNoValues.apply(this,arguments)||t===U.NotEmpty};J.prototype._createConditionsFields=function(){return[{ID:"select",Label:"",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"CheckBox",Value:""},{ID:"keyFieldLabel",Text:"Sort By",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"Label"},{ID:"keyField",Label:"",SpanFilter:"L3 M5 S10",SpanSort:"L5 M5 S12",SpanGroup:"L4 M4 S12",Control:"ComboBox"},{ID:"operationLabel",Text:"Sort Order",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"Label"},{ID:"operation",Label:"",SpanFilter:this._aKeyFields.length>1?"L3 M6 S10":"XL3 L3 M3 S10",SpanSort:r.system.phone?"L5 M5 S8":"L5 M5 S9",SpanGroup:"L2 M5 S10",Control:"ComboBox"},{ID:"value1",Label:this._sFromLabelText,SpanFilter:this._aKeyFields.length>1?"L3 M10 S10":"XL4 L4 M4 S10",SpanSort:"L3 M10 S10",SpanGroup:"L3 M10 S10",Control:"TextField",Value:""},{ID:"value2",Label:this._sToLabelText,SpanFilter:this._aKeyFields.length>1?"L2 M10 S10":"XL4 L4 M4 S10",SpanSort:"L2 M10 S10",SpanGroup:"L2 M10 S10",Control:"TextField",Value:""},{ID:"showIfGrouped",Label:this._sShowIfGroupedLabelText,SpanFilter:"L1 M10 S10",SpanSort:"L1 M10 S10",SpanGroup:"L3 M4 S9",Control:"CheckBox",Value:"false"}]};J.prototype._getConditionsGridAtPosition=function(e){var t=this._oConditionsGrid.getContent();if(e>=t.length){return null}return t[e]};J.prototype._getConditionsCount=function(){var e=this._oConditionsGrid.getContent();return e.length};J.prototype.fireDataChange=function(e){var t,i=e.newData;if(i){t=i.operation;i.operation=this._oOperationsHelper.isExcludeType(t)?this._oOperationsHelper.getCorrespondingIncludeOperation(t):t}return o.prototype.fireEvent.call(this,"dataChange",e)};J.prototype._makeFieldValid=function(e,t,i,a){if(a){var n=e.getSelectedItem();if(!n){e.setValueState(j.Error)}else{e.setValueState(j.None)}}else if(t){e.setValueState(j.None);e.setValueStateText("")}else{e.setValueState(j.Warning);e.setValueStateText(i?i:this._sValidationDialogFieldMessage)}};J.prototype._getRelevantOperations=function(e){var t,i=e&&e.typeInstance,a=i&&e.typeInstance.oConstraints&&e.typeInstance.oConstraints.isDigitSequence,n=i&&(e.typeInstance.sFiscalType==="IsFiscalPeriod"||e.typeInstance.sFiscalType==="IsFiscalYearPeriod"),o,s;if(a&&n){o="numcFiscal"}else if(e?.typeInstance?.oConstraints?.isDateOnly){o="date"}else{o=e?.type}s=e&&e.type&&this.getOperations(o);if(e&&e.operations){t=e.operations}else if(Array.isArray(s)&&s.length>0){t=s}else{t=this.getOperations("default")}return t};J.prototype._handleComboBoxChangeEvent=function(e,t){var i=t.getSource();this._makeFieldValid(i,true,undefined,true);if(i.getValueState()===j.None){this._changeField(e)}};J.prototype._createValueField=function(e,t,i){var a,n,o=this,s,r,l={value:t["Value"],width:"100%",placeholder:t["Label"],change:function(e){o._validateAndFormatFieldValue(e);o._changeField(i,e)},layoutData:new v({span:t["Span"+this._sConditionType]})};if(e&&e.typeInstance){var d=e.typeInstance;n=this._findConfig(d,"ctrl");if(n==="DateTimePicker"&&d.getMetadata().getName()==="sap.ui.model.odata.type.DateTime"){if(!(d.oConstraints&&d.oConstraints.isDateOnly)){N.error("sap.ui.comp.p13n.P13nConditionPanel","sap.ui.model.odata.type.DateTime without displayFormat = Date is not supported!");d.oConstraints=Object.assign({},d.oConstraints,{isDateOnly:true})}n="DatePicker"}i.oType=d;if(n=="select"){var p=[];var g=e.values||this._oTypeValues[n]||["",d.formatValue(false,"string"),d.formatValue(true,"string")];g.forEach(function(e,t){p.push(new u({key:t.toString(),text:e.toString()||this._oRbComp.getText("NO_BOOLEAN_VALUE_SELECTED")}))}.bind(this));l={width:"100%",items:p,change:function(){o._changeField(i);o._makeFieldValid(a,true)},layoutData:new v({span:t["Span"+this._sConditionType]})};a=new V(l)}else if(n=="TimePicker"){if(d.oFormatOptions&&d.oFormatOptions.style){l.displayFormat=d.oFormatOptions.style}a=new k(l)}else if(n=="DateTimePicker"){if(d.oFormatOptions&&d.oFormatOptions.style){l.displayFormat=d.oFormatOptions.style}s=this.getProperty("_calendarWeekSettings");if(s){l.calendarWeekNumbering=s}r=this.getProperty("_showCurrentDateButton");if(r){l.showCurrentDateButton=r}a=new M(l)}else if(n==="DatePicker"){if(d.oFormatOptions){l.displayFormat=d.oFormatOptions.style||d.oFormatOptions.pattern;if(d.isA("sap.ui.comp.odata.type.StringDate")){l.valueFormat="yyyyMMdd"}}s=this.getProperty("_calendarWeekSettings");if(s){l.calendarWeekNumbering=s}r=this.getProperty("_showCurrentDateButton");if(r){l.showCurrentDateButton=r}a=new w(l)}else{var c=this.data("dropdownFields");a=new P(l);if(c){for(var h=0;h<c.length;h++){if(c[h].name===e.key){l={width:"100%",items:[],change:this._handleComboBoxChangeEvent.bind(this,i),layoutData:new v({span:t["Span"+this._sConditionType]})};a=new D(l);break}}}if(this._fSuggestCallback){e=this._getCurrentKeyFieldItem(i.keyField);if(e&&e.key){var y=this._fSuggestCallback(a,e.key);if(y){a._oSuggestProvider=y}}}}}else{i.oType=null;a=new P(l)}if(n!=="boolean"&&n!=="enum"&&a){a.onpaste=function(e){var t;if(window.clipboardData){t=window.clipboardData.getData("Text")}else{t=e.originalEvent.clipboardData.getData("text/plain")}var i=e.srcControl.getParent();var a=t.split(/\r\n|\r|\n/g);if(a&&a[a.length-1].trim()===""){a.pop()}var n=i.operation;var s=n.getSelectedKey();if(a&&a.length>1&&s!=="BT"){setTimeout(function(){var e=a?a.length:0;var t=o._getCurrentKeyFieldItem(i.keyField);var n=i.operation;for(var s=0;s<e;s++){if(o._aConditionKeys.length>=o._getMaxConditionsAsNumber()){break}var r=a[s].trim();if(r){var l;if(t.typeInstance){try{l=t.typeInstance.parseValue(r,"string");t.typeInstance.validateValue(l)}catch(e){N.error("sap.ui.comp.p13n.P13nConditionPanel.onPaste","not able to parse value "+r+" with type "+t.typeInstance.getName());r="";l=null}if(!l){continue}}var d={index:o._iConditions,key:o._createConditionKey(),exclude:o.getExclude()||o._oOperationsHelper.isExcludeType(n.getSelectedKey()),operation:n.getSelectedKey(),keyField:t.key,value1:l,value2:null};o._addCondition2Map(d);o.fireDataChange({key:d.key,index:d.index,operation:"add",newData:d})}}o._clearConditions();o._fillConditions()},0)}}}if(e&&e.maxLength&&a.setMaxLength){var f=-1;if(typeof e.maxLength==="string"){f=parseInt(e.maxLength)}if(typeof e.maxLength==="number"){f=e.maxLength}if(f>0&&(!a.getShowSuggestion||!a.getShowSuggestion())){a.setMaxLength(f)}}var _={onAfterRendering:function(e){var t=e.srcControl.getDomRef("inner");if(t){t.setAttribute("inputmode","decimal");t.setAttribute("pattern","[0-9]+([.,][0-9]+)?")}}};if(e&&(e.type==="numeric"||e.type==="numc")&&(this._isPhone()||this._isTablet())){a.addDelegate(_,this)}return a};J.prototype._enableCondition=function(e,t){var i=this._getCurrentKeyFieldItem(e.keyField);i&&i.type==="boolean"?e.operation.setEnabled(false):e.operation.setEnabled(t);e.value1.setEnabled(t);e.value2.setEnabled(t);e.showIfGrouped.setEnabled(t)};J.prototype._getValueTextFromField=function(e){if(e instanceof V){return e.getSelectedItem()?e.getSelectedItem().getText():""}if(e.isA("sap.m.ComboBox")){return e.getSelectedItem()?e.getSelectedItem().getKey():""}return e.getValue()};J.prototype._isPhone=function(){return!!r.system.phone};J.prototype._isTablet=function(){return!!(r.system.tablet&&!r.system.desktop)};return J});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nConditionPanelBase", ["sap/m/library","sap/ui/core/Lib","sap/ui/core/library","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/Device","sap/ui/core/InvisibleText","sap/ui/core/ResizeHandler","sap/ui/core/Item","sap/ui/core/ListItem","sap/ui/model/odata/type/Boolean","sap/ui/model/type/String","sap/ui/model/odata/type/String","sap/ui/model/type/Date","sap/ui/model/type/Time","sap/ui/model/odata/type/DateTime","sap/ui/model/type/Float","sap/ui/layout/library","sap/ui/layout/Grid","sap/ui/layout/GridData","sap/ui/layout/HorizontalLayout","sap/m/Button","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/Text","sap/m/SearchField","sap/m/CheckBox","sap/m/ComboBox","sap/m/Select","sap/m/Label","sap/m/Input","sap/m/DatePicker","sap/m/TimePicker","sap/m/DateTimePicker","sap/base/Log","sap/ui/thirdparty/jquery","./P13nOperationsHelper","./P13nConditionPanelBaseRenderer"],function(e,t,i,o,a,n,s,r,l,d,p,u,h,g,_,f,y,c,m,C,v,S,T,b,I,F,x,V,D,L,M,O,P,k,A,w,jQuery,E,N){"use strict";var R=i.ValueState;var G=e.ButtonType;var K=e.ToolbarDesign;var B=i.TextAlign;var H=e.OverflowToolbarPriority;var U=e.P13nConditionOperation;var z=o.extend("sap.ui.comp.p13n.P13nConditionPanelBase",{metadata:{library:"sap.ui.comp",properties:{maxConditions:{type:"string",group:"Misc",defaultValue:"-1"},exclude:{type:"boolean",group:"Misc",defaultValue:false},containerQuery:{type:"boolean",group:"Misc",defaultValue:false},autoAddNewRow:{type:"boolean",group:"Misc",defaultValue:false},disableFirstRemoveIcon:{type:"boolean",group:"Misc",defaultValue:false},alwaysShowAddIcon:{type:"boolean",group:"Misc",defaultValue:true},usePrevConditionSetting:{type:"boolean",group:"Misc",defaultValue:true},autoReduceKeyFieldItems:{type:"boolean",group:"Misc",defaultValue:false},layoutMode:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Misc",defaultValue:false},displayFormat:{type:"string",group:"Misc",defaultValue:null},validationExecutor:{type:"object",group:"Misc",defaultValue:null}},aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content",visibility:"hidden"}},events:{dataChange:{}}},renderer:N});z.prototype.setConditions=function(e){if(!e){w.error("sap.ui.compP13nConditionPanelBase : aCondition is not defined")}if(this._bIgnoreSetConditions){return}this._oConditionsMap={};this._aConditionKeys=[];this._iConditions=0;for(var t=0;t<e.length;t++){this._addCondition2Map(e[t])}this._clearConditions();this._fillConditions()};z.prototype.removeAllConditions=function(){this._oConditionsMap={};this._aConditionKeys=[];this._iConditions=0;this._clearConditions();this._fillConditions()};z.prototype.addCondition=function(e){if(this._bIgnoreSetConditions){return}e.index=this._iConditions;this._addCondition2Map(e);this._addCondition(e)};z.prototype.insertCondition=function(e,t){if(this._bIgnoreSetConditions){return}if(t!==undefined){e.index=t}this._addCondition2Map(e);this._addCondition(e)};z.prototype.removeCondition=function(e){this._clearConditions();if(typeof e=="string"){this._removeConditionFromMap(e)}if(typeof e=="object"){this._removeConditionFromMap(e.key)}this._fillConditions()};z.prototype._addCondition2Map=function(e){if(!e.key){e.key="condition_"+this._iConditions;if(this.getExclude()){e.key="x"+e.key}}this._iConditions++;this._oConditionsMap[e.key]=e;this._aConditionKeys.push(e.key)};z.prototype._removeConditionFromMap=function(e){this._iConditions--;delete this._oConditionsMap[e];var t=this._aConditionKeys.indexOf(e);if(t>=0){this._aConditionKeys.splice(t,1)}};z.prototype.getConditions=function(){var e;var t=[];if(this._oConditionsMap){for(var i in this._oConditionsMap){e=this._oConditionsMap[i];var o=e.value;if(!o){o=this._getFormatedConditionText(e.operation,e.value1,e.value2,e.exclude,e.keyField,e.showIfGrouped)}if(!e._oGrid||e._oGrid.select.getSelected()){t.push({key:i,text:o,exclude:e.exclude,operation:e.operation,keyField:e.keyField,value1:e.value1,value2:this._hasSecondValue(e.operation)?e.value2:null,showIfGrouped:e.showIfGrouped})}}}return t};z.prototype.setOperations=function(e,t){t=t||"default";this._oTypeOperations[t]=e;this._updateAllOperations()};z.prototype.setValues=function(e,t){t=t||"default";this._oTypeValues[t]=e};z.prototype.addOperation=function(e,t){t=t||"default";this._oTypeOperations[t].push(e);this._updateAllOperations()};z.prototype.removeAllOperations=function(e){e=e||"default";this._oTypeOperations[e]=[];this._updateAllOperations()};z.prototype.getOperations=function(e){e=e||"default";return this._oTypeOperations[e]};z.prototype.setKeyFields=function(e){this._aKeyFields=e;this._aKeyFields.forEach(function(e){z._createKeyFieldTypeInstance(e)},this);this._updateKeyFieldItems(this._oConditionsGrid,true);this._updateAllConditionsEnableStates();this._createAndUpdateAllKeyFields();this._updateAllOperations()};z.prototype.addKeyField=function(e){this._aKeyFields.push(e);z._createKeyFieldTypeInstance(e);this._updateKeyFieldItems(this._oConditionsGrid,true,true);this._updateAllConditionsEnableStates();this._createAndUpdateAllKeyFields();this._updateAllOperations()};z._createKeyFieldTypeInstance=function(e){var t;if(!e.typeInstance){switch(e.type){case"boolean":e.typeInstance=new p;break;case"numc":if(!(e.formatSettings&&e.formatSettings.isDigitSequence)){w.error("sap.ui.compP13nConditionPanelBase","NUMC type support requires isDigitSequence==true!");e.formatSettings=Object.assign({},e.formatSettings,{isDigitSequence:true})}t=e.formatSettings;if(e.maxLength){t=Object.assign({},t,{maxLength:e.maxLength})}if(!t.maxLength){w.error("sap.ui.compP13nConditionPanelBase","NUMC type suppport requires maxLength!")}e.typeInstance=new h({},t);break;case"date":e.typeInstance=new g(Object.assign({},e.formatSettings,{strictParsing:true}),{});break;case"time":e.typeInstance=new _(Object.assign({},e.formatSettings,{strictParsing:true}),{});break;case"datetime":e.typeInstance=new f(Object.assign({},e.formatSettings,{strictParsing:true}),{displayFormat:"Date"});var i=e.typeInstance;if(!i.oFormat){i.formatValue(new Date,"string")}if(i.oFormat){i.oFormat.oFormatOptions.UTC=false}break;case"numeric":if(e.precision||e.scale){t={};if(e.precision){t["maxIntegerDigits"]=parseInt(e.precision)}if(e.scale){t["maxFractionDigits"]=parseInt(e.scale)}}e.typeInstance=new y(t);break;default:var o=e.formatSettings;if(e.maxLength){o=Object.assign({},o,{maxLength:e.maxLength})}e.typeInstance=new u({},o);break}}};z.prototype.removeAllKeyFields=function(){this._aKeyFields=[];this._updateKeyFieldItems(this._oConditionsGrid,true)};z.prototype.getKeyFields=function(){return this._aKeyFields};z.prototype.setAlwaysShowAddIcon=function(e){this.setProperty("alwaysShowAddIcon",e);if(this._oConditionsGrid){this._oConditionsGrid.toggleStyleClass("conditionRootGrid",this.getLayoutMode()!=="Desktop")}return this};z.prototype.setLayoutMode=function(e){this.setProperty("layoutMode",e);if(this._oConditionsGrid){this._oConditionsGrid.toggleStyleClass("conditionRootGrid",e!=="Desktop")}this._updateConditionFieldSpans(e);this._clearConditions();this._fillConditions();return this};z.prototype.setContainerQuery=function(e){this._unregisterResizeHandler();this.setProperty("containerQuery",e);this._registerResizeHandler();this._clearConditions();this._fillConditions();return this};z.prototype._updateConditionFieldSpans=function(e){if(this._aConditionsFields){var t=e==="Desktop";if(t){this._aConditionsFields[2].SpanFilter="L3 M3 S3";this._aConditionsFields[4].SpanFilter="L2 M2 S2";this._aConditionsFields[5].SpanFilter="L3 M3 S3";this._aConditionsFields[6].SpanFilter="L2 M2 S2";this._aConditionsFields[7].SpanFilter="L1 M1 S1"}var i=e==="Tablet";if(i){this._aConditionsFields[2].SpanFilter="L5 M5 S5";this._aConditionsFields[4].SpanFilter="L5 M5 S5";this._aConditionsFields[5].SpanFilter="L10 M10 S10";this._aConditionsFields[6].SpanFilter="L10 M10 S10";this._aConditionsFields[7].SpanFilter="L1 M1 S1"}}};z.prototype.init=function(){this._oRb=t.getResourceBundleFor("sap.m");this._sFromLabelText=this._oRb.getText("CONDITIONPANEL_LABELFROM");this._sToLabelText=this._oRb.getText("CONDITIONPANEL_LABELTO");this._sValueLabelText=this._oRb.getText("CONDITIONPANEL_LABELVALUE");this._sShowIfGroupedLabelText=this._oRb.getText("CONDITIONPANEL_LABELGROUPING");this._sValidationDialogFieldMessage=this._oRb.getText("CONDITIONPANEL_FIELDMESSAGE");this._oOperationsHelper=new E;this._oTypeOperations={default:[]};this._oTypeValues={default:[]};this._aKeyFields=[];this._oConditionsMap={};this._aConditionKeys=[];this._iConditions=0;this._sLayoutMode="Desktop";this._sConditionType="Filter";this._sAddRemoveIconTooltip="FILTER";this._iBreakPointTablet=n.media._predefinedRangeSets[n.media.RANGESETS.SAP_STANDARD].points[0];this._iBreakPointDesktop=n.media._predefinedRangeSets[n.media.RANGESETS.SAP_STANDARD].points[1];this._oConditionsGrid=new m({width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0}).toggleStyleClass("conditionRootGrid",this.getLayoutMode()!=="Desktop");this._oConditionsGrid.addStyleClass("sapUiRespGridOverflowHidden");this._iFirstConditionIndex=0;this._iConditionPageSize=10;this._oInvisibleTextField=new s({text:this._oRb.getText("CONDITIONPANEL_FIELD_LABEL")});this._oInvisibleTextOperatorInputValue=new s({text:this._oRb.getText("CONDITIONPANEL_FIELD_VALUE_ARIA_LABEL")});this._oInvisibleTextOperator=new s({text:this._oRb.getText("CONDITIONPANEL_OPERATOR_ARIA_LABEL")});this._oInvisibleTextOperatorAddButton=new s({text:this._oRb.getText("CONDITIONPANEL_ADD_SCREENREADER_DESCRIPTION")});this.addAggregation("content",this._oInvisibleTextField);this.addAggregation("content",this._oInvisibleTextOperatorInputValue);this.addAggregation("content",this._oInvisibleTextOperator);this.addAggregation("content",this._oInvisibleTextOperatorAddButton);this.addAggregation("content",this._oConditionsGrid);this._registerResizeHandler();this._aConditionsFields=this._createConditionsFields();this._oButtonGroupSpan={SpanFilter:"L2 M2 S2",SpanSort:n.system.phone?"L2 M2 S4":"L2 M2 S3",SpanGroup:"L2 M2 S3"};this._updateConditionFieldSpans(this.getLayoutMode());this._fillConditions()};z.prototype._createPaginatorToolbar=function(){this._bPaginatorButtonsVisible=false;var e=this;this._oPrevButton=new S({icon:a.getIconURI("navigation-left-arrow"),tooltip:this._oRb.getText("p13n.PREVIOUS"),visible:true,press:function(t){e._iFirstConditionIndex=Math.max(0,e._iFirstConditionIndex-e._iConditionPageSize);e._clearConditions();e._fillConditions()},layoutData:new b({priority:H.NeverOverflow})});this._oNextButton=new S({icon:a.getIconURI("navigation-right-arrow"),tooltip:this._oRb.getText("p13n.NEXT"),visible:true,press:function(t){e._iFirstConditionIndex+=e._iConditionPageSize;e._clearConditions();e._fillConditions()},layoutData:new b({priority:H.NeverOverflow})});this._oRemoveAllButton=new S({text:this._oRb.getText("CONDITIONPANEL_REMOVE_ALL"),visible:true,press:function(){e._aConditionKeys.forEach(function(e){this.fireDataChange({key:e,index:0,operation:"remove",newData:null})},e);this._iFirstConditionIndex=0;e.removeAllConditions()},layoutData:new b({priority:H.Low})});this._oAddButton=new S({icon:a.getIconURI("add"),visible:true,press:function(t){var i=e._createConditionRow(e._oConditionsGrid,undefined,null,0);e._changeField(i);setTimeout(function(){i.keyField.focus()});e._updatePaginatorToolbar()},layoutData:new b({priority:H.Low}),ariaDescribedBy:this._oInvisibleTextOperatorAddButton});this._oHeaderText=new F({wrapping:false,layoutData:new b({priority:H.NeverOverflow})});this._oPageText=new F({wrapping:false,textAlign:B.Center,layoutData:new b({priority:H.NeverOverflow})});this._oFilterField=new x({width:"12rem",layoutData:new b({priority:H.High})});this._oPaginatorToolbar=new T({height:"3rem",design:K.Transparent,content:[this._oHeaderText,new I,this._oFilterField,this._oPrevButton,this._oPageText,this._oNextButton,this._oRemoveAllButton,this._oAddButton]})};z.prototype._updatePaginatorToolbar=function(){if(this._sConditionType!=="Filter"||this.getMaxConditions()!=="-1"){return}var e=this._aConditionKeys.length;var t=1+Math.floor(Math.max(0,e-1)/this._iConditionPageSize);var i=1+Math.floor(this._iFirstConditionIndex/this._iConditionPageSize);var o=this.getParent();if(!this._oPaginatorToolbar){if(e>this._iConditionPageSize){this._createPaginatorToolbar();this.insertAggregation("content",this._oPaginatorToolbar,0);this._onGridResize()}else{if(o&&o.setHeaderText){if(this._sOrgHeaderText==undefined){this._sOrgHeaderText=o.getHeaderText()}o.setHeaderText(this._sOrgHeaderText+(e>0?" ("+e+")":""))}return}}this._oPrevButton.setEnabled(this._iFirstConditionIndex>0);this._oNextButton.setEnabled(this._iFirstConditionIndex+this._iConditionPageSize<e);if(o&&o.setHeaderToolbar){if(!o.getHeaderToolbar()){this.removeAggregation("content",this._oPaginatorToolbar);o.setHeaderToolbar(this._oPaginatorToolbar);o.attachExpand(e=>{this._setToolbarElementVisibility(e.getSource().getExpanded()&&this._bPaginatorButtonsVisible)})}}if(o&&o.setHeaderText){if(this._sOrgHeaderText==undefined){this._sOrgHeaderText=o.getHeaderText()}var a=this._sOrgHeaderText+(e>0?" ("+e+")":"");o.setHeaderText(a);this._oHeaderText.setText(a)}else{this._oHeaderText.setText(e+" Conditions")}this._oPageText.setText(i+"/"+t);this._bPaginatorButtonsVisible=this._bPaginatorButtonsVisible||t>1;this._setToolbarElementVisibility(this._bPaginatorButtonsVisible);if(i>t){this._iFirstConditionIndex-=Math.max(0,this._iConditionPageSize);this._clearConditions();this._fillConditions()}var n=0;this._oConditionsGrid.getContent().forEach(function(e){if(e.select.getSelected()){n++}},this);if(t==i&&e-this._iFirstConditionIndex>n){this._clearConditions();this._fillConditions()}};z.prototype._setToolbarElementVisibility=function(e){this._oPrevButton.setVisible(e);this._oNextButton.setVisible(e);this._oPageText.setVisible(e);this._oFilterField.setVisible(false);this._oAddButton.setVisible(e);this._oRemoveAllButton.setVisible(e)};z.prototype.exit=function(){this._clearConditions();this._unregisterResizeHandler();this._aConditionsFields=null;this._aKeys=null;this._aKeyFields=null;this._oTypeOperations=null;this._oRb=null;this._sFromLabelText=null;this._sToLabelText=null;this._sValueLabelText=null;this._sValidationDialogFieldMessage=null;this._oConditionsMap=null;this._aConditionKeys=[]};z.prototype._clearConditions=function(){var e=this._oConditionsGrid.getContent();e.forEach(function(e){for(var t in this._aConditionsFields){var i=this._aConditionsFields[t];if(e[i["ID"]]&&e.getContent().indexOf(e[i["ID"]])===-1){e[i["ID"]].destroy()}}},this);this._oConditionsGrid.destroyContent()};z.prototype._fillConditions=function(){var e,t;var i=0,o=this._getMaxConditionsAsNumber(),a=this._aConditionKeys.length;if(this._oConditionsMap){var n=this._sConditionType!=="Filter"||this.getMaxConditions()!=="-1"?9999:this._iConditionPageSize;a=Math.min(a,Math.min(o,this._iFirstConditionIndex+n));for(i=this._iFirstConditionIndex;i<a;i++){t=this._aConditionKeys[i];e=this._oConditionsMap[t];this._createConditionRow(this._oConditionsGrid,e,t)}}this._updatePaginatorToolbar();if((this.getAutoAddNewRow()||this._oConditionsGrid.getContent().length===0)&&this._oConditionsGrid.getContent().length<o){this._createConditionRow(this._oConditionsGrid)}};z.prototype._addCondition=function(e){var t=0;var i=this._getMaxConditionsAsNumber();if(this._oConditionsMap){for(var o in this._oConditionsMap){if(t<i&&e===this._oConditionsMap[o]){this._createConditionRow(this._oConditionsGrid,e,o,t)}t++}}this._updatePaginatorToolbar()};z.prototype._getMaxConditionsAsNumber=function(){return this.getMaxConditions()==="-1"?9999:parseInt(this.getMaxConditions())};z.prototype.onAfterRendering=function(){if(this.getLayoutMode()){this._sLayoutMode=this.getLayoutMode();return}};z.prototype._handleMediaChange=function(e){this._sLayoutMode=e.name;this._updateLayout(e)};z.prototype._unregisterResizeHandler=function(){if(this._sContainerResizeListener){r.deregister(this._sContainerResizeListener);this._sContainerResizeListener=null}n.media.detachHandler(this._handleMediaChange,this,n.media.RANGESETS.SAP_STANDARD)};z.prototype._registerResizeHandler=function(){if(this.getContainerQuery()){this._sContainerResizeListener=r.register(this._oConditionsGrid,this._onGridResize.bind(this));this._onGridResize()}else{n.media.attachHandler(this._handleMediaChange,this,n.media.RANGESETS.SAP_STANDARD)}};z.prototype._getKeyFromConditionGrid=function(e){var t=e.data("_key");if(!t){t=this._createConditionKey()}return t};z.prototype._createConditionKey=function(){var e=0;var t;do{t="condition_"+e;if(this.getExclude()){t="x"+t}e++}while(this._oConditionsMap[t]);return t};z.prototype._createConditionRow=function(e,t,i,o,a){var n,s=this;if(o===undefined){o=e.getContent().length}var r=new m({width:"100%",defaultSpan:"L12 M12 S12",hSpacing:1,vSpacing:0,containerQuery:this.getContainerQuery()}).data("_key",i);r.addStyleClass("sapUiRespGridOverflowHidden");for(var l in this._aConditionsFields){var d;var p=this._aConditionsFields[l];switch(p["Control"]){case"CheckBox":d=new V({enabled:false,layoutData:new C({span:p["Span"+this._sConditionType]})});this._setLayoutVisible(d,false);if(p["ID"]==="showIfGrouped"){d.setEnabled(true);d.setText(p["Label"]);d.attachSelect(function(){s._changeField(r)});d.setSelected(t?t.showIfGrouped:true)}else{if(t){d.setSelected(true);d.setEnabled(true)}}break;case"ComboBox":if(p["ID"]==="keyField"){d=new D({width:"100%",ariaLabelledBy:this._oInvisibleTextField});var u=d.setSelectedKey.bind(d);d.setSelectedKey=function(e){u(e);var t=s.getValidationExecutor();if(t){t()}};var h=d.setSelectedItem.bind(d);d.setSelectedItem=function(e){h(e);var t=s.getValidationExecutor();if(t){t()}};d.setLayoutData(new C({span:p["Span"+this._sConditionType]}));this._fillKeyFieldListItems(d,this._aKeyFields);if(d.attachSelectionChange){d.attachSelectionChange(function(t){var i=s.getValidationExecutor();if(i){i()}s._handleSelectionChangeOnKeyField(e,r)})}if(d.attachChange){d.attachChange(function(t){r.keyField.close();s._handleChangeOnKeyField(e,r)})}if(d.setSelectedItem){if(t){d.setSelectedKey(t.keyField);this._aKeyFields.forEach(function(e,i){var o=e.key;if(o===undefined){o=e}if(t.keyField===o){d.setSelectedItem(d.getItems()[i])}},this)}else{if(this.getUsePrevConditionSetting()&&!this.getAutoReduceKeyFieldItems()){if(o>0&&!i&&a){n=e.getContent()[o-1];if(n.keyField.getSelectedKey()){d.setSelectedKey(n.keyField.getSelectedKey())}else{if(!d.getSelectedItem()&&d.getItems().length>0){d.setSelectedItem(d.getItems()[0])}}}else{this._aKeyFields.some(function(e,t){if(e.isDefault){d.setSelectedItem(d.getItems()[t]);return true}if(!d.getSelectedItem()&&e.type!=="boolean"){d.setSelectedItem(d.getItems()[t])}},this);if(!d.getSelectedItem()&&d.getItems().length>0){d.setSelectedItem(d.getItems()[0])}}}else{this._aKeyFields.forEach(function(e,t){if(e.isDefault){d.setSelectedItem(d.getItems()[t])}},this)}}}}if(p["ID"]==="operation"){d=new L({width:"100%",ariaLabelledBy:this._oInvisibleTextOperator,layoutData:new C({span:p["Span"+this._sConditionType]})});d.attachChange(function(){s._handleChangeOnOperationField(e,r)});r[p["ID"]]=d;this._updateOperationItems(e,r);if(t){var g=this._getCurrentKeyFieldItem(r.keyField),_=this._getRelevantOperations(g),f=this.getCurrentOparation(t);_.some(function(e){if(f===e){d.setSelectedKey(e);return true}},this)}else{if(this.getUsePrevConditionSetting()){if(o>0&&i===null){var n=e.getContent()[o-1];d.setSelectedKey(n.operation.getSelectedKey())}}}}if(d.getSelectedItem&&d.getSelectedItem()&&d.getMetadata()._sUIDToken!=="box"){d.setTooltip(d.getSelectedItem().getTooltip()||d.getSelectedItem().getText())}break;case"TextField":var y=this._getCurrentKeyFieldItem(r.keyField);d=this._createValueField(y,p,r);d.oTargetGrid=e;if(t&&t[p["ID"]]!==undefined){var c=t[p["ID"]];if(d instanceof L){if(typeof c==="string"){c=r.oType.parseValue(c,"string")}if(typeof c==="boolean"){d.setSelectedIndex(c?2:1)}}else if(c!==null&&r.oType){if(typeof c==="string"&&r.oType.getName()==="sap.ui.comp.odata.type.StringDate"){d.setValue(c)}else{if(typeof c==="string"&&["String","sap.ui.model.odata.type.String","sap.ui.model.odata.type.Decimal"].indexOf(r.oType.getName())==-1){try{c=r.oType.parseValue(c,"string");d.setValue(r.oType.formatValue(c,"string"))}catch(e){w.error("sap.ui.compP13nConditionPanelBase","Value '"+c+"' does not have the expected type format for "+r.oType.getName()+".parseValue()")}}else{d.setValue(r.oType.formatValue(c,"string"))}}}else{d.setValue(c)}}break;case"Label":d=new M({text:p["Text"]+":",visible:this.getShowLabel(),layoutData:new C({span:p["Span"+this._sConditionType]})}).addStyleClass("conditionLabel");d.oTargetGrid=e;break}r[p["ID"]]=d;r.addContent(d)}this._addButtons(r,e);e.insertContent(r,o);this._updateOperationItems(e,r);this._changeOperationValueFields(e,r);this._updateAllConditionsEnableStates();this._updateConditionButtons(e);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false)}if(this._sLayoutMode){this._updateLayout({name:this._sLayoutMode})}if(t){var v=this._getFormatedConditionText(t.operation,t.value1,t.value2,t.exclude,t.keyField,t.showIfGrouped);t._oGrid=r;t.value=v;this._oConditionsMap[i]=t}var S=r.operation.getSelectedKey();if(S==="BT"&&r.value1.setMinDate&&r.value2.setMaxDate){var T=r.value1.getDateValue();var b=r.value2.getDateValue();this._updateMinMaxDate(r,T,b)}else{this._updateMinMaxDate(r,null,null)}return r};z.prototype._handleRemoveCondition=function(e,t){var i=e.getContent().indexOf(t);this._removeCondition(e,t);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false)}if(i>=0){i=Math.min(i,e.getContent().length-1);var t=e.getContent()[i];setTimeout(function(){t.remove.focus()})}this._updatePaginatorToolbar()};z.prototype._handleAddCondition=function(e,t,i){var o=e.getContent().indexOf(t);var a=this._createConditionRow(e,undefined,null,o+1,i);this._changeField(a);setTimeout(function(){if(a.keyField.getVisible()){a.keyField.focus();return}if(a.operation.getVisible()){a.operation.focus()}});this._updatePaginatorToolbar()};z.prototype._getCurrentKeyFieldItem=function(e){if(e.getSelectedKey&&e.getSelectedKey()){var t=e.getSelectedKey();var i=this._aKeyFields;for(var o in i){var a=i[o];if(a.key===t){return a}}}return null};z.prototype._createValueField=function(e,t,i){var o;var a;var n=this;var s={value:t["Value"],width:"100%",placeholder:t["Label"],change:function(e){n._validateAndFormatFieldValue(e);n._changeField(i,e)},layoutData:new C({span:t["Span"+this._sConditionType]})};if(e&&e.typeInstance){var r=e.typeInstance;a=this._findConfig(r,"ctrl");if(a==="DateTimePicker"&&r.getMetadata().getName()==="sap.ui.model.odata.type.DateTime"){if(!(r.oConstraints&&r.oConstraints.isDateOnly)){w.error("sap.ui.compP13nConditionPanelBase","sap.ui.model.odata.type.DateTime without displayFormat = Date is not supported!");r.oConstraints=Object.assign({},r.oConstraints,{isDateOnly:true})}a="DatePicker"}i.oType=r;if(a=="select"){var d=[];var p=e.values||this._oTypeValues[a]||["",r.formatValue(false,"string"),r.formatValue(true,"string")];p.forEach(function(e,t){d.push(new l({key:t.toString(),text:e.toString()}))});s={width:"100%",items:d,change:function(){n._changeField(i);n._makeFieldValid(o,true)},layoutData:new C({span:t["Span"+this._sConditionType]})};o=new L(s)}else if(a=="TimePicker"){if(r.oFormatOptions&&r.oFormatOptions.style){s.displayFormat=r.oFormatOptions.style}o=new k(s)}else if(a=="DateTimePicker"){if(r.oFormatOptions&&r.oFormatOptions.style){s.displayFormat=r.oFormatOptions.style}o=new A(s)}else if(a==="DatePicker"){if(r.oFormatOptions){s.displayFormat=r.oFormatOptions.style||r.oFormatOptions.pattern;if(r.isA("sap.ui.comp.odata.type.StringDate")){s.valueFormat="yyyyMMdd"}}o=new P(s)}else{o=new O(s);if(this._fSuggestCallback){e=this._getCurrentKeyFieldItem(i.keyField);if(e&&e.key){var u=this._fSuggestCallback(o,e.key);if(u){o._oSuggestProvider=u}}}}}else{i.oType=null;o=new O(s)}if(a!=="boolean"&&a!=="enum"&&o){o.onpaste=function(e){var t;if(window.clipboardData){t=window.clipboardData.getData("Text")}else{t=e.originalEvent.clipboardData.getData("text/plain")}var i=e.srcControl.getParent();var o=t.split(/\r\n|\r|\n/g);if(o&&o[o.length-1].trim()===""){o.pop()}var a=i.operation;var s=a.getSelectedKey();if(o&&o.length>1&&s!=="BT"){setTimeout(function(){var e=o?o.length:0;var t=n._getCurrentKeyFieldItem(i.keyField);var a=i.operation;for(var s=0;s<e;s++){if(n._aConditionKeys.length>=n._getMaxConditionsAsNumber()){break}var r=o[s].trim();if(r){var l;if(t.typeInstance){try{l=t.typeInstance.parseValue(r,"string");t.typeInstance.validateValue(l)}catch(e){w.error("sap.ui.compP13nConditionPanelBase.onPaste","not able to parse value "+r+" with type "+t.typeInstance.getName());r="";l=null}if(!l){continue}}var d={oOperation:a.getSelectedKey(),oKeyField:t.key,oPastedValue:l},p=n._getConditions(d);n._addCondition2Map(p);n.fireDataChange({key:p.key,index:p.index,operation:"add",newData:p})}}n._clearConditions();n._fillConditions()},0)}}}if(e&&e.maxLength&&o.setMaxLength){var h=-1;if(typeof e.maxLength==="string"){h=parseInt(e.maxLength)}if(typeof e.maxLength==="number"){h=e.maxLength}if(h>0&&(!o.getShowSuggestion||!o.getShowSuggestion())){o.setMaxLength(h)}}return o};z.prototype._getConditions=function(e){return{index:this._iConditions,key:this._createConditionKey(),exclude:this.getExclude(),operation:e.oOperation,keyField:e.oKeyField,value1:e.oPastedValue,value2:null}};z.prototype._fillOperationListItems=function(e,t,i){var o,a;if(i==="_STRING_"){i=""}if(i==="_TIME_"||i==="_DATETIME_"){i="_DATE_"}if(i==="_BOOLEAN_"||i==="_NUMC_"){i=""}e.destroyItems();t.forEach(function(t){a="CONDITIONPANEL_OPTION"+i+t;if(i&&this._oRb.hasText(a)){o=this._oRb.getText(a)}else{o=this._oRb.getText("CONDITIONPANEL_OPTION"+t)}e.addItem(new d({key:t,text:o,tooltip:o}))}.bind(this))};z.prototype._fillKeyFieldListItems=function(e,t){e.destroyItems();for(var i in t){var o=t[i];e.addItem(new d({key:o.key,text:o.text,tooltip:o.tooltip?o.tooltip:o.text}))}e.setEditable(e.getItems().length>1)};z.prototype._handleChangeOnOperationField=function(e,t){this._changeOperationValueFields(e,t);this._changeField(t)};z.prototype._handleSelectionChangeOnKeyField=function(e,t){if(this._sConditionType==="Filter"){this._updateOperationItems(e,t);this._createAndUpdateValueFields(e,t);this._changeOperationValueFields(e,t)}this._changeField(t)};z.prototype._handleChangeOnKeyField=function(e,t){if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(e,false,false,t.keyField)}};z.prototype._createAndUpdateAllKeyFields=function(){var e=this._oConditionsGrid.getContent();e.forEach(function(e){this._createAndUpdateValueFields(this._oConditionsGrid,e);this._changeOperationValueFields(this._oConditionsGrid,e)},this)};z.prototype._createAndUpdateValueFields=function(e,t){var i=this._getCurrentKeyFieldItem(t.keyField);var o=function(e,t,o){var a=t.getValue?t.getValue():"";var n=e.indexOfContent(t);e.removeContent(t);if(t._oSuggestProvider){t._oSuggestProvider.destroy();t._oSuggestProvider=null}t.destroy();var s=this._aConditionsFields[o];t=this._createValueField(i,s,e);e[s["ID"]]=t;e.insertContent(t,n===-1?e.indexOfContent(e.operation)+1:n);var r,l;if(e.oType&&a){try{r=e.oType.parseValue(a,"string");e.oType.validateValue(r);l=e.oType.formatValue(r,"string");if(l&&l.toUpperCase&&this.getDisplayFormat()==="UpperCase"){l=l.toUpperCase()}t.setValue(l)}catch(e){var d=e.message;this._makeFieldValid(t,false,d);t.setValue(a)}}};o.bind(this)(t,t.value1,5);o.bind(this)(t,t.value2,6)};z.prototype._updateAllOperations=function(){var e=this._oConditionsGrid.getContent();e.forEach(function(e){this._updateOperationItems(this._oConditionsGrid,e);this._changeOperationValueFields(this._oConditionsGrid,e)},this)};z.prototype._updateOperationItems=function(e,t){var i=this._getCurrentKeyFieldItem(t.keyField);var o=i&&i.type||"";var a=t.operation;var n=a.getSelectedItem();var s=this._getRelevantOperations(i);this._fillOperationListItems(a,s,o?"_"+o.toUpperCase()+"_":"");if(n&&a.getItemByKey(n.getKey())){a.setSelectedKey(n.getKey())}else{a.setSelectedItem(a.getItems()[0])}this._sConditionType="Filter";if(s[0]===U.Ascending||s[0]===U.Descending){this._sConditionType="Sort"}if(s[0]===U.GroupAscending||s[0]===U.GroupDescending){this._sConditionType="Group"}this._adjustValue1Span(t)};z.prototype._updateKeyFieldItems=function(e,t,i,o){var a=e.getContent().length;var n;var s={};if(!t){for(n=0;n<a;n++){var r=e.getContent()[n].keyField;var l=r.getSelectedKey();if(l!=null&&l!==""){s[l]=true}}}for(n=0;n<a;n++){var r=e.getContent()[n].keyField;var p=e.getContent()[n].select;var u=r.getSelectedKey();var h=0;var g=this._aKeyFields;if(r!==o){if(i){h=g.length-1}else{r.destroyItems()}for(h;h<g.length;h++){var _=g[h];if(_.key==null||_.key===""||!s[_.key]||_.key===u){r.addItem(new d({key:_.key,text:_.text,tooltip:_.tooltip?_.tooltip:_.text}))}}r.setEditable(r.getItems().length>1)}if(u){r.setSelectedKey(u)}else if(r.getItems().length>0){r.setSelectedItem(r.getItems()[0])}if(!p.getSelected()){this._aKeyFields.some(function(e,t){if(e.isDefault){r.setSelectedItem(r.getItems()[t]);return true}if(!r.getSelectedItem()){if(e.type!=="boolean"){r.setSelectedItem(r.getItems()[t])}}},this)}if(r.getSelectedItem()){r.setTooltip(r.getSelectedItem().getTooltip()||r.getSelectedItem().getText())}}};z.prototype._changeOperationValueFields=function(e,t){var i=t.operation;var o=i.getSelectedKey();var a=t.value1;var n=t.value2;var s=t.showIfGrouped;var r,l,d;if(!o){return}if(this._hasSecondValue(o)){if(a.setPlaceholder&&a.getPlaceholder()!==this._sFromLabelText){a.setPlaceholder(this._sFromLabelText)}if(!a.getVisible()){a.setVisible(true);t.insertContent(a,t.getContent().length-1)}if(n.setPlaceholder&&n.getPlaceholder()!==this._sToLabelText){n.setPlaceholder(this._sToLabelText)}if(!n.getVisible()){n.setVisible(true);t.insertContent(n,t.getContent().length-this._getSecondValueNegativeIndex())}r=t.getContent();l=r.indexOf(a);d=r.indexOf(n);if(l>d){t.mAggregations.content[l]=n;t.mAggregations.content[d]=a}}else{if(o===U.GroupAscending||o===U.GroupDescending){if(a.getVisible()){a.setVisible(false);t.removeContent(a)}if(n.getVisible()){n.setVisible(false);t.removeContent(n)}if(i.getVisible()){i.setVisible(false);t.removeContent(i)}s.setVisible(this._getMaxConditionsAsNumber()!=1);this._setLayoutVisible(s,this._getMaxConditionsAsNumber()!=1)}else{if(this._hasNoValues(o)){if(a.getVisible()){a.setVisible(false);t.removeContent(a)}if(n.getVisible()){n.setVisible(false);t.removeContent(n)}t.removeContent(s)}else{if(a.setPlaceholder&&a.getPlaceholder()!==this._sValueLabelText){a.setPlaceholder(this._sValueLabelText)}if(!a.getVisible()){a.setVisible(true);t.insertContent(a,t.getContent().length-1)}if(n.getVisible()){n.setVisible(false);t.removeContent(n)}}}}this._adjustValue1Span(t)};z.prototype._adjustValue1Span=function(e){if(this._sConditionType==="Filter"&&e.value1&&e.operation){var t=e.operation;var i=this._aConditionsFields[5]["Span"+this._sConditionType];if(t.getSelectedKey()!=="BT"){i="L5 M10 S10"}var o=e.value1.getLayoutData();if(o.getSpan()!==i){o.setSpan(i)}}};z.prototype._getIndexOfCondition=function(e){var t=-1;e.getParent().getContent().some(function(i){if(i.select.getSelected()){t++}return i===e},this);return t+this._iFirstConditionIndex};z.prototype._makeFieldValid=function(e,t,i){if(t){e.setValueState(R.None);e.setValueStateText("")}else{e.setValueState(R.Warning);e.setValueStateText(i?i:this._sValidationDialogFieldMessage)}};z.prototype._validateAndFormatFieldValue=function(e){var t=e.oSource;var i=t.getParent();var o;if(t.getDateValue&&e){o=e.getParameter("value");var a=e.getParameter("valid");this._makeFieldValid(t,a);return}else{o=t.getValue&&t.getValue()}if(!i){return}if(this.getDisplayFormat()==="UpperCase"&&o){o=o.toUpperCase();t.setValue(o)}if(i.oType&&o){try{var n=i.oType.parseValue(o,"string");i.oType.validateValue(n);this._makeFieldValid(t,true);o=i.oType.formatValue(n,"string");t.setValue(o)}catch(e){var s=e.message;this._makeFieldValid(t,false,s)}}else{this._makeFieldValid(t,true)}};z.prototype._updateMinMaxDate=function(e,t,i){if(e.value1.setMinDate&&e.value2.setMaxDate){if(e.value1&&e.value1.setMaxDate){e.value1.setMaxDate(i instanceof Date?i:null)}if(e.value2&&e.value2.setMinDate){e.value2.setMinDate(t instanceof Date?t:null)}}};z.prototype._changeField=function(e,t){var i=e.keyField.getSelectedKey();if(e.keyField.getSelectedItem()){e.keyField.setTooltip(e.keyField.getSelectedItem().getTooltip()||e.keyField.getSelectedItem().getText())}else{e.keyField.setTooltip(null)}var o=e.operation.getSelectedKey();if(e.operation.getSelectedItem()){e.operation.setTooltip(e.operation.getSelectedItem().getTooltip()||e.operation.getSelectedItem().getText())}else{e.operation.setTooltip(null)}var a=function(e,i){var o;var a;if(e.getDateValue&&!e.isA("sap.ui.compTimePicker")&&i.getName()!=="sap.ui.comp.odata.type.StringDate"){a=e.getDateValue();if(i&&a){if(t&&t.getParameter("valid")||e.isValidValue()){o=i.formatValue(a,"string")}else{o=""}}}else{o=this._getValueTextFromField(e);a=o;if(i&&i.getName()==="sap.ui.comp.odata.type.StringDate"){o=i.formatValue(a,"string")}else if(i&&o){try{a=i.parseValue(o,"string");i.validateValue(a)}catch(e){w.error("sap.ui.compP13nConditionPanelBase","not able to parse value "+o+" with type "+i.getName());o=""}}}return[a,o]}.bind(this);var n=a(e.value1,e.oType);var s=n[0],r=n[1];n=a(e.value2,e.oType);var l=n[0],d=n[1];if(this._hasSecondValue(o)){this._updateMinMaxDate(e,s,l)}else{this._updateMinMaxDate(e,null,null)}var p=this._getCurrentKeyFieldItem(e.keyField);if(p&&p.type==="numc"){if([U.Contains,U.EndsWith].indexOf(o)!=-1){s=e.oType.formatValue(s,"string")}}var u=e.showIfGrouped.getSelected();var h=this.getExclude();var g=e.select;var _="";var f;if(i===""||i==null){i=null;f=this._getKeyFromConditionGrid(e);this._removeConditionFromMap(f);this._enableCondition(e,false);var y=this._getIndexOfCondition(e);if(g.getSelected()){g.setSelected(false);g.setEnabled(false);this._bIgnoreSetConditions=true;this.fireDataChange({key:f,index:y,operation:"remove",newData:null});this._bIgnoreSetConditions=false}return}this._enableCondition(e,true);_=this._getFormatedConditionText(o,r,d,h,i,u);var c={value:_,exclude:h,operation:o,keyField:i,value1:s,value2:this._hasSecondValue(o)?l:null,showIfGrouped:u};f=this._getKeyFromConditionGrid(e);if(_!==""){g.setSelected(true);g.setEnabled(true);var o="update";if(!this._oConditionsMap[f]){o="add"}this._oConditionsMap[f]=c;if(o==="add"){this._aConditionKeys.splice(this._getIndexOfCondition(e),0,f)}e.data("_key",f);this.fireDataChange({key:f,index:this._getIndexOfCondition(e),operation:o,newData:c})}else if(this._oConditionsMap[f]!==undefined){this._removeConditionFromMap(f);e.data("_key",null);var y=this._getIndexOfCondition(e);if(g.getSelected()){g.setSelected(false);g.setEnabled(false);this._bIgnoreSetConditions=true;this.fireDataChange({key:f,index:y,operation:"remove",newData:null});this._bIgnoreSetConditions=false}}this._updatePaginatorToolbar()};z.prototype._getValueTextFromField=function(e){if(e instanceof L){return e.getSelectedItem()?e.getSelectedItem().getText():""}return e.getValue()};z.prototype._updateAllConditionsEnableStates=function(){var e=this._oConditionsGrid.getContent();e.forEach(function(e){var t=this._getCurrentKeyFieldItem(e.keyField);var i=t&&t.key!==undefined?t.key:t;var o=i!==""&&i!==null;this._enableCondition(e,o)},this)};z.prototype._enableCondition=function(e,t){e.operation.setEnabled(t);e.value1.setEnabled(t);e.value2.setEnabled(t);e.showIfGrouped.setEnabled(t)};z.prototype._removeCondition=function(e,t){var i=this._getKeyFromConditionGrid(t);var o=-1;if(t.select.getSelected()){o=this._getIndexOfCondition(t)}this._removeConditionFromMap(i);t.destroy();if(e.getContent().length<1){this._createConditionRow(e)}else{this._updateConditionButtons(e)}if(o>=0){this.fireDataChange({key:i,index:o,operation:"remove",newData:null})}};z.prototype._updateConditionButtons=function(e){var t=this._getMaxConditionsAsNumber();var i=e.getContent().length;for(var o=0;o<i;o++){var a=e.getContent()[o].add;if(this.getAlwaysShowAddIcon()&&i<t||o===i-1&&o<t-1){a.removeStyleClass("displayNone")}else{a.addStyleClass("displayNone")}var n=e.getContent()[o].remove;if(t===1||o===0&&i===1&&this.getDisableFirstRemoveIcon()){n.addStyleClass("displayNone")}else{n.removeStyleClass("displayNone")}}};z.prototype.validateConditions=function(){var e=this;var t=function(t){var i=true;for(var o=0;o<t.length;o++){var a=t[o];var n=e._checkCondition(a,o===t.length-1);i=i&&n}return i};return t(this._oConditionsGrid.getContent())};z.prototype.removeValidationErrors=function(){this._oConditionsGrid.getContent().forEach(function(e){var t=e.value1;var i=e.value2;t.setValueState(R.None);t.setValueStateText("");i.setValueState(R.None);i.setValueStateText("")},this)};z.prototype.removeInvalidConditions=function(){var e=[];this._oConditionsGrid.getContent().forEach(function(t){if(t.value1.getValueState()!==R.None||t.value2.getValueState()!==R.None){e.push(t)}},this);e.forEach(function(e){this._removeCondition(this._oConditionsGrid,e);if(this.getAutoReduceKeyFieldItems()){this._updateKeyFieldItems(this._oConditionsGrid,false)}},this)};z.prototype._checkCondition=function(e,t){var i=true;var o=e.value1;var a=e.value2;var n=o&&(o.getVisible()&&!this._getValueTextFromField(o));var s=o&&o.getVisible()&&o.getValueState?o.getValueState():R.None;var r=a&&(a.getVisible()&&!this._getValueTextFromField(a));var l=a&&a.getVisible()&&a.getValueState?a.getValueState():R.None;var d=e.operation.getSelectedKey();if(this._hasSecondValue(d)){if(!n?r:!r){if(n){o.setValueState(R.Warning);o.setValueStateText(this._sValidationDialogFieldMessage)}if(r){a.setValueState(R.Warning);a.setValueStateText(this._sValidationDialogFieldMessage)}i=false}else if(s!==R.None||l!==R.None){i=false}else{o.setValueState(R.None);o.setValueStateText("");a.setValueState(R.None);a.setValueStateText("")}}if(o.getVisible()&&o.getValueState&&o.getValueState()!==R.None||a.getVisible()&&a.getValueState&&a.getValueState()!==R.None){i=false}return i};z.prototype._getFormatedConditionText=function(e,t,i,o,a,n){var s=z.getFormatedConditionText(e,t,i,o);if(!s){switch(e){case U.Initial:s="=''";break;case U.NotEmpty:s="!''";break;case U.Ascending:s="ascending";break;case U.GroupAscending:s="ascending";s+=" showIfGrouped:"+n;break;case U.Descending:s="descending";break;case U.GroupDescending:s="descending";s+=" showIfGrouped:"+n;break;case U.Total:s="total";break;case U.Average:s="average";break;case U.Minimum:s="minimum";break;case U.Maximum:s="maximum";break}if(o&&s!==""){s="!("+s+")"}}if(this._aKeyFields&&this._aKeyFields.length>1){var r=null;for(var l=0;l<this._aKeyFields.length;l++){var d=this._aKeyFields[l];if(typeof d!=="string"){if(d.key===a&&d.text){r=d.text}}}if(r&&s!==""){s=r+": "+s}}return s};z._oConditionMap={EQ:"=$0",GT:">$0",GE:">=$0",LT:"<$0",LE:"<=$0",Contains:"*$0*",StartsWith:"$0*",EndsWith:"*$0",BT:"$0...$1",Empty:"<$r>"};(function(){var e=t.getResourceBundleFor("sap.m");z._oConditionMap[U.Empty]=z._oConditionMap[U.Empty].replace("$r",e.getText("CONDITIONPANEL_OPTIONEmpty"))})();z._templateReplace=function(e,t){return e.replace(/\$\d/g,function(e){return t[parseInt(e.substr(1))]})};z.getFormatedConditionText=function(e,t,i,o){var a="";switch(e){case U.Empty:a=z._templateReplace(z._oConditionMap[e],[]);break;case U.EQ:case U.GT:case U.GE:case U.LT:case U.LE:case U.Contains:case U.StartsWith:case U.EndsWith:if(t!==""&&t!==undefined&&t!==null){a=z._templateReplace(z._oConditionMap[e],[t])}break;case U.BT:if(t!==""&&t!==undefined&&t!==null){if(i!==""&&i!==undefined&&i!==null){a=z._templateReplace(z._oConditionMap[e],[t,i])}}break;default:break}if(o&&a!==""){a="!("+a+")"}return a};z.prototype._updateLayout=function(e){if(!this._oConditionsGrid){return}var t=this._oConditionsGrid.getContent();var i=this._aConditionsFields.length;var o=i;if(e.name==="Tablet"){o=5}if(e.name==="Phone"){o=3}if(this._sConditionType==="Filter"){for(var a=0;a<t.length;a++){var n=t[a];n.ButtonContainer.removeStyleClass("floatRight");n.removeContent(n.ButtonContainer);n.insertContent(n.ButtonContainer,o);if(!this.getAlwaysShowAddIcon()){if(o!==i){n.ButtonContainer.removeContent(n.add);n.addContent(n.add)}else{n.removeContent(n.add);n.ButtonContainer.addContent(n.add)}}}}};z.prototype._onGridResize=function(){var e;if(this._oPaginatorToolbar&&this._oConditionsGrid&&this._oConditionsGrid.getContent().length>0){var t=this._oConditionsGrid.getContent()[0];if(t.remove&&t.remove.$().position()){e=0;if(this._oPaginatorToolbar.getParent()&&this._oPaginatorToolbar.getParent().getExpandable&&this._oPaginatorToolbar.getParent().getExpandable()){e=48-4}var i=t.remove.$().position().left-e+t.remove.$().width();this._oPaginatorToolbar.setWidth(i+"px")}}var o=this._oConditionsGrid.getDomRef();if(!o){return}if(!jQuery(o).is(":visible")){return}e=o.clientWidth;var a={};if(e<=this._iBreakPointTablet){a.name="Phone"}else if(e>this._iBreakPointTablet&&e<=this._iBreakPointDesktop){a.name="Tablet"}else{a.name="Desktop"}if(a.name==="Phone"&&this._sLayoutMode!==a.name){this._updateLayout(a);this._sLayoutMode=a.name}if(a.name==="Tablet"&&this._sLayoutMode!==a.name){this._updateLayout(a);this._sLayoutMode=a.name}if(a.name==="Desktop"&&this._sLayoutMode!==a.name){this._updateLayout(a);this._sLayoutMode=a.name}};z.prototype._findConfig=function(e,t){if(typeof e==="object"){e=e.getMetadata().getName()}var i;while(e&&!(i=this._getConfig(e,t))){e=this._getParentType(e)}return i};z.prototype._getConfig=function(e,t){var i=this._mOpsForType[e];if(i){return i[t]}};z.prototype._getParentType=function(e){return this._mTypes[e]};z.prototype._getRelevantOperations=function(e){var t,i=e&&e.type&&this.getOperations(e.type);if(e&&e.operations){t=e.operations}else if(Array.isArray(i)&&i.length>0){t=i}else{t=this.getOperations("default")}return t};z.prototype._addButtons=function(e,t){var i=this;var o=new v({layoutData:new C({span:this.getLayoutMode()==="Desktop"?"L2 M2 S2":this._oButtonGroupSpan["Span"+this._sConditionType]})}).addStyleClass("floatRight");e.addContent(o);e["ButtonContainer"]=o;var n=new S({type:G.Transparent,icon:a.getIconURI("decline"),tooltip:this._oRb.getText("CONDITIONPANEL_REMOVE"+(this._sAddRemoveIconTooltipKey?"_"+this._sAddRemoveIconTooltipKey:"")+"_TOOLTIP"),press:function(){i._handleRemoveCondition(this.oTargetGrid,e)},layoutData:new C({span:this.getLayoutMode()==="Desktop"?"L1 M1 S1":"L1 M2 S2"})});n.oTargetGrid=t;o.addContent(n);e["remove"]=n;var s=new S({type:G.Transparent,icon:a.getIconURI("add"),tooltip:this._oRb.getText("CONDITIONPANEL_ADD"+(this._sAddRemoveIconTooltipKey?"_"+this._sAddRemoveIconTooltipKey:"")+"_TOOLTIP"),press:function(){i._handleAddCondition(this.oTargetGrid,e,true)},layoutData:new C({span:this.getLayoutMode()==="Desktop"?"L1 M1 S1":"L1 M10 S10"})});s.oTargetGrid=t;s.addStyleClass("conditionAddBtnFloatRight");o.addContent(s);e["add"]=s};z.prototype.getCurrentOparation=function(e){return e.operation};z.prototype.setSuggestCallback=function(e){this._fSuggestCallback=e};z.prototype._hasSecondValue=function(e){return e===U.BT};z.prototype._getSecondValueNegativeIndex=function(){return 1};z.prototype._createConditionsFields=function(){return[{ID:"select",Label:"",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"CheckBox",Value:""},{ID:"keyFieldLabel",Text:"Sort By",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"Label"},{ID:"keyField",Label:"",SpanFilter:"L3 M5 S10",SpanSort:"L5 M5 S12",SpanGroup:"L4 M4 S12",Control:"ComboBox"},{ID:"operationLabel",Text:"Sort Order",SpanFilter:"L1 M1 S1",SpanSort:"L1 M1 S1",SpanGroup:"L1 M1 S1",Control:"Label"},{ID:"operation",Label:"",SpanFilter:"L2 M5 S10",SpanSort:n.system.phone?"L5 M5 S8":"L5 M5 S9",SpanGroup:"L2 M5 S10",Control:"ComboBox"},{ID:"value1",Label:this._sFromLabelText,SpanFilter:"L3 M10 S10",SpanSort:"L3 M10 S10",SpanGroup:"L3 M10 S10",Control:"TextField",Value:""},{ID:"value2",Label:this._sToLabelText,SpanFilter:"L2 M10 S10",SpanSort:"L2 M10 S10",SpanGroup:"L2 M10 S10",Control:"TextField",Value:""},{ID:"showIfGrouped",Label:this._sShowIfGroupedLabelText,SpanFilter:"L1 M10 S10",SpanSort:"L1 M10 S10",SpanGroup:"L3 M4 S9",Control:"CheckBox",Value:"false"}]};z.prototype._hasNoValues=function(e){return e===U.Empty||e===U.Initial||e===U.Ascending||e===U.Descending||e===U.Total||e===U.Average||e===U.Minimum||e===U.Maximum};z.prototype._setLayoutVisible=function(e,t){var i;if(e.getLayoutData===undefined){return}i=e.getLayoutData&&e.getLayoutData();if(i&&(i.getMetadata&&i.getMetadata().getName()==="sap.ui.layout.GridData")){i.setVisibleXL(t);i.setVisibleL(t);i.setVisibleM(t);i.setVisibleS(t)}else{e.setLayoutData(new C({visibleXL:t,visibleL:t,visibleM:t,visibleS:t}))}e.setVisible(t)};z.prototype._mTypes={base:undefined,string:"base",numeric:"base",date:"base",time:"base",boolean:"base",int:"numeric",float:"numeric","sap.ui.model.type.Boolean":"boolean","sap.ui.model.type.Date":"date","sap.ui.model.type.FileSize":"string","sap.ui.model.type.Float":"float","sap.ui.model.type.Integer":"int","sap.ui.model.type.String":"string","sap.ui.model.type.Time":"time","sap.ui.comp.odata.type.StringDate":"date","sap.ui.model.odata.type.Boolean":"boolean","sap.ui.model.odata.type.Byte":"int","sap.ui.model.odata.type.Date":"date","sap.ui.model.odata.type.DateTime":"datetime","sap.ui.model.odata.type.DateTimeOffset":"datetime","sap.ui.model.odata.type.Decimal":"float","sap.ui.model.odata.type.Double":"float","sap.ui.model.odata.type.Single":"float","sap.ui.model.odata.type.Guid":"string","sap.ui.model.odata.type.Int16":"int","sap.ui.model.odata.type.Int32":"int","sap.ui.model.odata.type.Int64":"int","sap.ui.model.odata.type.Raw":"string","sap.ui.model.odata.type.SByte":"int","sap.ui.model.odata.type.String":"string","sap.ui.model.odata.type.Time":"time","sap.ui.model.odata.type.TimeOfDay":"time","Edm.Boolean":"sap.ui.model.odata.type.Boolean","Edm.Byte":"sap.ui.model.odata.type.Byte","Edm.Date":"sap.ui.model.odata.type.Date","Edm.DateTime":"sap.ui.model.odata.type.DateTime","Edm.DateTimeOffset":"sap.ui.model.odata.type.DateTimeOffset","Edm.Decimal":"sap.ui.model.odata.type.Decimal","Edm.Double":"sap.ui.model.odata.type.Double","Edm.Single":"sap.ui.model.odata.type.Single","Edm.Guid":"sap.ui.model.odata.type.Guid","Edm.Int16":"sap.ui.model.odata.type.Int16","Edm.Int32":"sap.ui.model.odata.type.Int32","Edm.Int64":"sap.ui.model.odata.type.Int64","Edm.SByte":"sap.ui.model.odata.type.SByte","Edm.String":"sap.ui.model.odata.type.String","Edm.Time":"sap.ui.model.odata.type.Time","Edm.TimeOfDay":"sap.ui.model.odata.type.TimeOfDay"};z.prototype._mOpsForType={base:{ctrl:"input"},string:{ctrl:"input"},date:{ctrl:"DatePicker"},datetime:{ctrl:"DateTimePicker"},numeric:{ctrl:"input"},time:{ctrl:"TimePicker"},boolean:{ctrl:"select"}};return z});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nConditionPanelBaseRenderer", ["sap/ui/core/Renderer"],function(n){"use strict";return n.extend("sap.ui.comp.p13n.P13nConditionPanelBaseRenderer",{apiVersion:2,render:function(n,e){n.openStart("section",e);n.class("sapMConditionPanel");n.openEnd();n.openStart("div");n.class("sapMConditionPanelContent");n.class("sapMConditionPanelBG");n.openEnd();e.getAggregation("content").forEach(function(e){n.renderControl(e)});n.close("div");n.close("section")}})});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nConditionPanelRenderer", ["sap/ui/core/Renderer"],function(n){"use strict";return n.extend("sap.ui.comp.p13n.P13nConditionPanelBaseRenderer",{apiVersion:2,render:function(n,e){n.openStart("span",e.getId()+"-firstfe").class("sapMDialogFirstFE").attr("role","none").attr("tabindex","-1").openEnd().close("span");n.openStart("section",e);n.class("sapMConditionPanel");n.openEnd();n.openStart("div");n.class("sapMConditionPanelContent");n.class("sapMConditionPanelBG");n.openEnd();e.getAggregation("content").forEach(function(e){n.renderControl(e)});n.close("div");n.close("section")}})});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nFilterItem", ["sap/ui/comp/library","sap/ui/core/Item"],function(e,t){"use strict";var r=t.extend("sap.ui.comp.p13n.P13nFilterItem",{metadata:{library:"sap.ui.comp",properties:{operation:{type:"string",group:"Misc",defaultValue:null},value1:{type:"string",group:"Misc",defaultValue:null},value2:{type:"string",group:"Misc",defaultValue:null},columnKey:{type:"string",group:"Misc",defaultValue:null},exclude:{type:"boolean",group:"Misc",defaultValue:false}}}});r.prototype.setOperation=function(e){return this.setProperty("operation",e,true)};r.prototype.setColumnKey=function(e){return this.setProperty("columnKey",e,true)};r.prototype.setValue1=function(e){return this.setProperty("value1",e,true)};r.prototype.setValue2=function(e){return this.setProperty("value2",e,true)};r.prototype.setExclude=function(e){return this.setProperty("exclude",e,true)};return r});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nFilterPanel", ["./P13nFilterPanelBase","./P13nConditionPanel","sap/ui/core/Lib","sap/ui/layout/form/SimpleForm","sap/m/library","./P13nFilterItem","./P13nOperationsHelper","./P13nFilterPanelBaseRenderer","sap/ui/layout/library"],function(e,t,i,n,o,a,s,r,l){"use strict";var d=o.P13nPanelType,p=o.P13nConditionOperation;var u=l.form.SimpleFormLayout;var h=e.extend("sap.ui.comp.p13n.P13nFilterPanel",{metadata:{library:"sap.ui.comp",properties:{maxIncludes:{type:"string",group:"Misc",defaultValue:"-1"},maxExcludes:{type:"string",group:"Misc",defaultValue:"-1"},maxConditions:{type:"string",group:"Misc",defaultValue:"-1"},defaultOperation:{type:"string",group:"Misc",defaultValue:null}}},renderer:r});h.prototype.setConditions=function(e){this._oConditionPanel.setConditions(e);return this};h.prototype.getConditions=function(){return this._oConditionPanel.getConditions()};h.prototype.setContainerQuery=function(e){this.setProperty("containerQuery",e);this._oConditionPanel.setContainerQuery(e);return this};h.prototype.setLayoutMode=function(e){this.setProperty("layoutMode",e);this._oConditionPanel.setLayoutMode(e);return this};h.prototype.validateConditions=function(){return this._oConditionPanel.validateConditions()};h.prototype.removeInvalidConditions=function(){this._oConditionPanel.removeInvalidConditions()};h.prototype.removeValidationErrors=function(){this._oConditionPanel.removeValidationErrors()};h.prototype.setIncludeOperations=function(e,t,i){t=t||"default";this.bEnhanceInclude=!i;this._aIncludeOperations[t]=e;if(this._oConditionPanel){this._oConditionPanel.setOperations(this._aIncludeOperations[t],t)}};h.prototype.getIncludeOperations=function(e){if(this._oConditionPanel){return this._oConditionPanel.getOperations(e,false)}};h.prototype.setExcludeOperations=function(e,t,i){t=t||"default";this.bEnhanceExclude=!i;this._aExcludeOperations[t]=e;if(this._oConditionPanel){this._oConditionPanel.setOperations(this._aExcludeOperations[t],t,true)}};h.prototype.getExcludeOperations=function(e){if(this._oConditionPanel){return this._oConditionPanel.getOperations(e,true)}};h.prototype.setKeyFields=function(e,t){this._aKeyFields=e;if(this._oConditionPanel){e.some(function(e){if(e.isDefault){this._oConditionPanel.setAutoAddNewRow(true)}}.bind(this));this._oConditionPanel.setKeyFields&&this._oConditionPanel.setKeyFields(e)}};h.prototype.setMaxConditions=function(e){this.setProperty("maxConditions",e);if(this._oConditionPanel){this._oConditionPanel.setMaxConditions(e)}return this};h.prototype.setMaxIncludes=function(e){this.setProperty("maxIncludes",e);this._updateIncludeOperations();return this};h.prototype.setMaxExcludes=function(e){this.setProperty("maxExcludes",e);this._updateExcludeOperations();return this};h.prototype._updatePanel=function(){};h.prototype.setDefaultOperation=function(e){this.setProperty("defaultOperation",e);if(this._oConditionPanel){this._oConditionPanel.setDefaultOperation(e)}return this};h.prototype.init=function(){this.setType(d.filter);this.setTitle(i.getResourceBundleFor("sap.m").getText("FILTERPANEL_TITLE"));this._aKeyFields=[];this._oRb=i.getResourceBundleFor("sap.m");this._aIncludeOperations={};this._aExcludeOperations={};this.bEnhanceExclude=true;this.bEnhanceInclude=true;this._oPanel=new n({layout:u.ResponsiveGridLayout});this._oConditionPanel=new t({maxConditions:this.getMaxConditions(),alwaysShowAddIcon:false,layoutMode:this.getLayoutMode(),dataChange:this._handleDataChange(),defaultOperation:this.getDefaultOperation()});this._oConditionPanel._sAddRemoveIconTooltipKey="FILTER";this._oPanel.addContent(this._oConditionPanel);this.addAggregation("content",this._oPanel);if(!this._oOperationsHelper){this._oOperationsHelper=new s}this._updateOperations()};h.prototype.onBeforeRendering=function(){var e=[],t,i,n=this.getEnableEmptyOperations();if(this._bUpdateRequired){this._bUpdateRequired=false;var o=this.getMessageStrip();if(o){o.addStyleClass("sapUiResponsiveMargin");this.insertAggregation("content",o,0)}t=[];i=(this.getBindingInfo("items")||{}).model;var a=function(e,t,i){var n=i.getBinding(e),o;if(n&&t){return t.getObject()[n.getPath()]}o=i.getMetadata();return o.hasProperty(e)?o.getProperty(e).get(i):o.getAggregation(e).get(i)};this.getItems().forEach(function(o){var s=o.getBindingContext(i),r,l,d;if(o.getBinding("key")){s.getObject()[o.getBinding("key").getPath()]=o.getKey()}t.push(r={key:o.getColumnKey(),text:a("text",s,o),tooltip:a("tooltip",s,o),maxLength:a("maxLength",s,o),type:a("type",s,o),typeInstance:a("typeInstance",s,o),formatSettings:a("formatSettings",s,o),precision:a("precision",s,o),scale:a("scale",s,o),isDefault:a("isDefault",s,o),values:a("values",s,o)});if(n){l=o.getNullable();d={};Object.keys(r).forEach(function(e){d[e]=r[e]});e.push(d);this._enhanceFieldOperationsWithEmpty(r,l);this._modifyFieldOperationsBasedOnMaxLength(d)}this._modifyFieldOperationsBasedOnMaxLength(r)},this);this.setKeyFields&&this.setKeyFields(t,e);var s=[];i=(this.getBindingInfo("filterItems")||{}).model;this.getFilterItems().forEach(function(e){var t=e.getBindingContext(i);if(e.getBinding("key")&&t){t.getObject()[e.getBinding("key").getPath()]=e.getKey()}s.push({key:e.getKey(),keyField:a("columnKey",t,e),operation:a("operation",t,e),value1:a("value1",t,e),value2:a("value2",t,e),exclude:a("exclude",t,e)})});this.setConditions(s)}};h.prototype._updateOperations=function(){this._updateIncludeOperations();this._updateExcludeOperations()};h.prototype._updateIncludeOperations=function(){if(this.getMaxIncludes()==="0"){this._oOperationsHelper.getIncludeTypes().forEach(function(e){this.setIncludeOperations([],e)}.bind(this))}else{this._oOperationsHelper.getIncludeTypes().forEach(function(e){this.setIncludeOperations(this._oOperationsHelper.getIncludeOperationsByType(e),e)}.bind(this))}};h.prototype._updateExcludeOperations=function(){if(this.getMaxExcludes()==="0"){this._oOperationsHelper.getExcludeTypes().forEach(function(e){this.setExcludeOperations([],e)}.bind(this))}else{this._oOperationsHelper.getExcludeTypes().forEach(function(e){this.setExcludeOperations(this._oOperationsHelper.getExcludeOperationsByType(e),e)}.bind(this))}};h.prototype._modifyFieldOperationsBasedOnMaxLength=function(e){var t;if(e.maxLength===1||e.maxLength==="1"){t=e.operations?e.operations:this._oConditionPanel.getOperations(e.type);e.operations=[];t.forEach(function(t){if([p.Contains,p.StartsWith,p.EndsWith].indexOf(t)===-1){e.operations.push(t)}},this)}};h.prototype._enhanceFieldOperationsWithEmpty=function(e,t){var i,n,o=e&&e.typeInstance&&e.typeInstance.oConstraints&&e.typeInstance.oConstraints.isDigitSequence,a=e&&e.typeInstance&&(e.typeInstance.sFiscalType==="IsFiscalPeriod"||e.typeInstance.sFiscalType==="IsFiscalYearPeriod");if(["string","stringdate","guid"].indexOf(e.type)>-1||["date","datetime"].indexOf(e.type)>-1&&t&&!(o&&a)&&!this.bIsSingleIntervalRange){i=this._oConditionPanel.getOperations(e.type,false).slice();n=this._oConditionPanel.getOperations(e.type,true).slice();if(i.length===0){i=this._oConditionPanel.getOperations("default",false)}if(n.length===0){n=this._oConditionPanel.getOperations("default",true)}if(i.indexOf(p.Empty)===-1&&this.getMaxIncludes()!=="0"&&this.bEnhanceInclude){i.push(p.Empty)}if(n.indexOf(p.NotEmpty)===-1&&this.getMaxExcludes()!=="0"&&this.bEnhanceExclude){n.push(p.NotEmpty)}if(!Array.isArray(e.operations)){e.operations=[]}e.operations=e.operations.concat(i).concat(n)}};h.prototype._handleDataChange=function(){var e=this;return function(t){var i=t.getParameter("newData"),n=t.getParameter("operation"),o=t.getParameter("key"),s=t.getParameter("index"),r;switch(n){case"update":r=e.getFilterItems()[s];if(r){r.setExclude(i.exclude);r.setColumnKey(i.keyField);r.setOperation(i.operation);r.setValue1(i.value1);r.setValue2(i.value2)}e.fireUpdateFilterItem({key:o,index:s,filterItemData:r});e.fireFilterItemChanged({reason:"updated",key:o,index:s,itemData:{columnKey:i.keyField,operation:i.operation,exclude:i.exclude,value1:i.value1,value2:i.value2}});break;case"add":if(s>=0){s++}r=new a({columnKey:i.keyField,exclude:i.exclude,operation:i.operation});r.setValue1(i.value1);r.setValue2(i.value2);e._bIgnoreBindCalls=true;e.fireAddFilterItem({key:o,index:s,filterItemData:r});e.fireFilterItemChanged({reason:"added",key:o,index:s,itemData:{columnKey:i.keyField,operation:i.operation,exclude:i.exclude,value1:i.value1,value2:i.value2}});e._bIgnoreBindCalls=false;break;case"remove":e._bIgnoreBindCalls=true;e.fireRemoveFilterItem({key:o,index:s});e.fireFilterItemChanged({reason:"removed",key:o,index:s});e._bIgnoreBindCalls=false;break;default:throw"Operation'"+n+"' is not supported yet"}e._notifyChange()}};h.prototype.getConditionPanel=function(){return this._oConditionPanel};h.prototype.setInnerTitle=function(e){this._oPanel&&this._oPanel.setHeaderText(e)};h.prototype.setSuggestCallback=function(e){if(this._oConditionPanel){this._oConditionPanel.setSuggestCallback(e)}};return h});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nFilterPanelBase", ["./P13nConditionPanel","./P13nPanel","sap/m/library","sap/m/Panel","./P13nFilterItem","./P13nOperationsHelper","./P13nFilterPanelBaseRenderer","sap/ui/core/Lib"],function(e,t,i,n,a,o,r,s){"use strict";var l=i.P13nPanelType;var d=i.P13nConditionOperation;var u=t.extend("sap.ui.comp.p13n.P13nFilterPanelBase",{metadata:{library:"sap.ui.comp",properties:{maxIncludes:{type:"string",group:"Misc",defaultValue:"-1"},maxExcludes:{type:"string",group:"Misc",defaultValue:"-1"},containerQuery:{type:"boolean",group:"Misc",defaultValue:false},layoutMode:{type:"string",group:"Misc",defaultValue:null},enableEmptyOperations:{type:"boolean",group:"Misc",defaultValue:false}},aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content",visibility:"hidden"},filterItems:{type:"sap.ui.comp.p13n.P13nFilterItem",multiple:true,singularName:"filterItem",bindable:"bindable"},messageStrip:{type:"sap.m.MessageStrip",multiple:false}},events:{addFilterItem:{},removeFilterItem:{},updateFilterItem:{},filterItemChanged:{parameters:{reason:{type:"string"},key:{type:"string"},index:{type:"int"},itemData:{type:"object"}}}}},renderer:r});u.prototype.setConditions=function(e){var t=[];var i=[];if(e.length){for(var n=0;n<e.length;n++){var a=e[n];if(!a.exclude){t.push(a)}else{i.push(a)}}}this._oIncludeFilterPanel.setConditions(t);this._oExcludeFilterPanel.setConditions(i);if(i.length>0){this._oExcludePanel.setExpanded(true)}return this};u.prototype.getConditions=function(){var e=this._oIncludeFilterPanel.getConditions();var t=this._oExcludeFilterPanel.getConditions();return e.concat(t)};u.prototype.setContainerQuery=function(e){this.setProperty("containerQuery",e);this._oIncludeFilterPanel.setContainerQuery(e);this._oExcludeFilterPanel.setContainerQuery(e);return this};u.prototype.setLayoutMode=function(e){this.setProperty("layoutMode",e);this._oIncludeFilterPanel.setLayoutMode(e);this._oExcludeFilterPanel.setLayoutMode(e);return this};u.prototype.validateConditions=function(){return this._oIncludeFilterPanel.validateConditions()&&this._oExcludeFilterPanel.validateConditions()};u.prototype.removeInvalidConditions=function(){this._oIncludeFilterPanel.removeInvalidConditions();this._oExcludeFilterPanel.removeInvalidConditions()};u.prototype.removeValidationErrors=function(){this._oIncludeFilterPanel.removeValidationErrors();this._oExcludeFilterPanel.removeValidationErrors()};u.prototype.onBeforeNavigationFrom=function(){return this.validateConditions()};u.prototype.onAfterNavigationFrom=function(){return this.removeInvalidConditions()};u.prototype.setIncludeOperations=function(e,t){t=t||"default";this._aIncludeOperations[t]=e;if(this._oIncludeFilterPanel){this._oIncludeFilterPanel.setOperations(this._aIncludeOperations[t],t)}};u.prototype.getIncludeOperations=function(e){if(this._oIncludeFilterPanel){return this._oIncludeFilterPanel.getOperations(e)}};u.prototype.setExcludeOperations=function(e,t){t=t||"default";this._aExcludeOperations[t]=e;if(this._oExcludeFilterPanel){this._oExcludeFilterPanel.setOperations(this._aExcludeOperations[t],t)}};u.prototype.getExcludeOperations=function(e){if(this._oExcludeFilterPanel){return this._oExcludeFilterPanel.getOperations(e)}};u.prototype.setKeyFields=function(e,t){this._aKeyFields=e;if(this._oIncludeFilterPanel){e.some(function(e){if(e.isDefault){this._oIncludeFilterPanel.setAutoAddNewRow(true)}}.bind(this));this._oIncludeFilterPanel.setKeyFields(e)}if(this._oExcludeFilterPanel){this._oExcludeFilterPanel.setKeyFields(Array.isArray(t)&&t.length>0?t:e)}};u.prototype.getKeyFields=function(){return this._aKeyFields};u.prototype.setMaxIncludes=function(e){this.setProperty("maxIncludes",e);if(this._oIncludeFilterPanel){this._oIncludeFilterPanel.setMaxConditions(e)}this._updatePanel();return this};u.prototype.setMaxExcludes=function(e){this.setProperty("maxExcludes",e);if(this._oExcludeFilterPanel){this._oExcludeFilterPanel.setMaxConditions(e)}this._updatePanel();return this};u.prototype._updatePanel=function(){var e=this.getMaxIncludes()==="-1"?1e3:parseInt(this.getMaxIncludes());var t=this.getMaxExcludes()==="-1"?1e3:parseInt(this.getMaxExcludes());if(e>0){if(t<=0){this._oIncludePanel.setHeaderText(null);this._oIncludePanel.setExpandable(false);this._oIncludePanel.addStyleClass("panelTopMargin");this._oIncludePanel.addStyleClass("panelNoHeader")}}if(t===0){this._oExcludePanel.setHeaderText(null);this._oExcludePanel.setExpandable(false);this._oExcludePanel.addStyleClass("panelNoHeader")}};u.prototype.init=function(){this.setType(l.filter);this.setTitle(s.getResourceBundleFor("sap.ui.comp").getText("FILTERPANEL_TITLE"));this._aKeyFields=[];this._oRb=s.getResourceBundleFor("sap.ui.comp");this._aIncludeOperations={};this._aExcludeOperations={};this._oIncludePanel=new n({expanded:true,expandable:true,headerText:this._oRb.getText("FILTERPANEL_INCLUDES"),width:"auto"}).addStyleClass("sapMFilterPadding");this._oIncludeFilterPanel=new e({maxConditions:this.getMaxIncludes(),alwaysShowAddIcon:false,layoutMode:this.getLayoutMode(),dataChange:this._handleDataChange()});this._oIncludeFilterPanel._sAddRemoveIconTooltipKey="FILTER";this._oIncludePanel.addContent(this._oIncludeFilterPanel);this.addAggregation("content",this._oIncludePanel);this._oExcludePanel=new n({expanded:false,expandable:true,headerText:this._oRb.getText("FILTERPANEL_EXCLUDES"),width:"auto"}).addStyleClass("sapMFilterPadding");this._oExcludeFilterPanel=new e({exclude:true,maxConditions:this.getMaxExcludes(),alwaysShowAddIcon:false,layoutMode:this.getLayoutMode(),dataChange:this._handleDataChange()});this._oExcludeFilterPanel._sAddRemoveIconTooltipKey="FILTER";if(!this._oOperationsHelper){this._oOperationsHelper=new o}this._updateOperations();var t;for(t in this._aExcludeOperations){this._oExcludeFilterPanel.setOperations(this._aExcludeOperations[t],t)}for(t in this._aIncludeOperations){this._oIncludeFilterPanel.setOperations(this._aIncludeOperations[t],t)}this._oExcludePanel.addContent(this._oExcludeFilterPanel);this.addAggregation("content",this._oExcludePanel);this._updatePanel()};u.prototype.exit=function(){var e=function(e){if(e&&e.destroy){e.destroy()}return null};this._oOperationsHelper=e(this._oOperationsHelper);this._aKeyFields=e(this._aKeyFields);this._aIncludeOperations=e(this._aIncludeOperations);this._aExcludeOperations=e(this._aExcludeOperations);this._oRb=e(this._oRb)};u.prototype.onBeforeRendering=function(){var e=[],t,i,n=this.getEnableEmptyOperations();if(this._bUpdateRequired){this._bUpdateRequired=false;var a=this.getMessageStrip();if(a){a.addStyleClass("sapUiResponsiveMargin");this.insertAggregation("content",a,0)}t=[];i=(this.getBindingInfo("items")||{}).model;this.getItems().forEach(function(a){var o=a.getBindingContext(i),r,s,l;if(a.getBinding("key")){o.getObject()[a.getBinding("key").getPath()]=a.getKey()}t.push(r={key:a.getColumnKey(),text:a.getText(),tooltip:a.getTooltip(),maxLength:a.getMaxLength(),type:a.getType(),typeInstance:a.getTypeInstance(),formatSettings:a.getFormatSettings(),precision:a.getPrecision(),scale:a.getScale(),isDefault:a.getIsDefault(),values:a.getValues()});if(n){s=a.getNullable();l={};Object.keys(r).forEach(function(e){l[e]=r[e]});e.push(l);this._enhanceFieldOperationsWithEmpty(l,s,true);this._enhanceFieldOperationsWithEmpty(r,s);this._modifyFieldOperationsBasedOnMaxLength(l)}this._modifyFieldOperationsBasedOnMaxLength(r)},this);this.setKeyFields&&this.setKeyFields(t,e);var o=[];i=(this.getBindingInfo("filterItems")||{}).model;this.getFilterItems().forEach(function(e){var t=e.getBindingContext(i);if(e.getBinding("key")&&t){t.getObject()[e.getBinding("key").getPath()]=e.getKey()}o.push({key:e.getKey(),keyField:e.getColumnKey(),operation:e.getOperation(),value1:e.getValue1(),value2:e.getValue2(),exclude:e.getExclude()})});this.setConditions(o)}};u.prototype._updateOperations=function(){this._oOperationsHelper.getIncludeTypes().forEach(function(e){this.setIncludeOperations(this._oOperationsHelper.getIncludeOperationsByType(e),e)}.bind(this));this._oOperationsHelper.getExcludeTypes().forEach(function(e){this.setExcludeOperations(this._oOperationsHelper.getExcludeOperationsByType(e),e)}.bind(this))};u.prototype._enableEnhancedExcludeOperations=function(){if(this._oOperationsHelper){this._oOperationsHelper.setUseExcludeOperationsExtended()}this._updateOperations()};u.prototype._modifyFieldOperationsBasedOnMaxLength=function(e){var t;if(e.maxLength===1||e.maxLength==="1"){t=e.operations?e.operations:this._oIncludeFilterPanel.getOperations(e.type);e.operations=[];t.forEach(function(t){if([d.Contains,d.StartsWith,d.EndsWith].indexOf(t)===-1){e.operations.push(t)}},this)}};u.prototype._enhanceFieldOperationsWithEmpty=function(e,t,i){var n,a;if(["string","stringdate"].indexOf(e.type)>-1||["date","datetime"].indexOf(e.type)>-1&&t){n=this[i?"_oExcludeFilterPanel":"_oIncludeFilterPanel"];a=n.getOperations(e.type);if(!a){a=n.getOperations()}if(!Array.isArray(e.operations)){e.operations=[]}a.forEach(function(t){e.operations.push(t)});if(e.operations.indexOf(d.Empty)===-1){e.operations.push(d.Empty)}}};u.prototype.addItem=function(e){t.prototype.addItem.apply(this,arguments);if(!this._bIgnoreBindCalls){this._bUpdateRequired=true}return this};u.prototype.removeItem=function(e){var i=t.prototype.removeItem.apply(this,arguments);this._bUpdateRequired=true;return i};u.prototype.destroyItems=function(){this.destroyAggregation("items");if(!this._bIgnoreBindCalls){this._bUpdateRequired=true}return this};u.prototype.addFilterItem=function(e){this.addAggregation("filterItems",e,true);if(!this._bIgnoreBindCalls){this._bUpdateRequired=true}return this};u.prototype.insertFilterItem=function(e,t){this.insertAggregation("filterItems",e,t,true);if(!this._bIgnoreBindCalls){this._bUpdateRequired=true}return this};u.prototype.updateFilterItems=function(e){this.updateAggregation("filterItems");if(e==="change"&&!this._bIgnoreBindCalls){this._bUpdateRequired=true;this.invalidate()}};u.prototype.setMessageStrip=function(e){this.setAggregation("messageStrip",e,true);if(!this._bIgnoreBindCalls){this._bUpdateRequired=true}return this};u.prototype.updateMessageStrip=function(e){this.updateAggregation("messageStrip");if(e==="change"&&!this._bIgnoreBindCalls){this._bUpdateRequired=true}};u.prototype.removeFilterItem=function(e){e=this.removeAggregation("filterItems",e,true);if(!this._bIgnoreBindCalls){this._bUpdateRequired=true}return e};u.prototype.removeAllFilterItems=function(){var e=this.removeAllAggregation("filterItems",true);if(!this._bIgnoreBindCalls){this._bUpdateRequired=true}return e};u.prototype.destroyFilterItems=function(){this.destroyAggregation("filterItems");if(!this._bIgnoreBindCalls){this._bUpdateRequired=true}return this};u.prototype._handleDataChange=function(){var e=this;return function(t){var i=t.getParameter("newData");var n=t.getParameter("operation");var o=t.getParameter("key");var r=t.getParameter("index");var s;var l=-1;var d=t.getSource()===e._oExcludeFilterPanel;e.getFilterItems().some(function(e,t){if(!e.getExclude()&&!d||e.getExclude()&&d){r--}l=t;return r<0},this);switch(n){case"update":s=e.getFilterItems()[l];if(s){s.setExclude(i.exclude);s.setColumnKey(i.keyField);s.setOperation(i.operation);s.setValue1(i.value1);s.setValue2(i.value2)}e.fireUpdateFilterItem({key:o,index:l,filterItemData:s});e.fireFilterItemChanged({reason:"updated",key:o,index:l,itemData:{columnKey:i.keyField,operation:i.operation,exclude:i.exclude,value1:i.value1,value2:i.value2}});break;case"add":if(r>=0){l++}s=new a({columnKey:i.keyField,exclude:i.exclude,operation:i.operation});s.setValue1(i.value1);s.setValue2(i.value2);e._bIgnoreBindCalls=true;e.fireAddFilterItem({key:o,index:l,filterItemData:s});e.fireFilterItemChanged({reason:"added",key:o,index:l,itemData:{columnKey:i.keyField,operation:i.operation,exclude:i.exclude,value1:i.value1,value2:i.value2}});e._bIgnoreBindCalls=false;break;case"remove":e._bIgnoreBindCalls=true;e.fireRemoveFilterItem({key:o,index:l});e.fireFilterItemChanged({reason:"removed",key:o,index:l});e._bIgnoreBindCalls=false;break;default:throw"Operation'"+n+"' is not supported yet"}e._notifyChange()}};u.prototype._notifyChange=function(){var e=this.getChangeNotifier();if(e){e(this)}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nFilterPanelBaseRenderer", ["sap/ui/core/Renderer"],function(e){"use strict";return e.extend("sap.ui.comp.p13n.P13nFilterPanelRenderer",{apiVersion:2,render:function(e,n){e.openStart("section",n);e.class("sapMFilterPanel");e.openEnd();e.openStart("div");e.class("sapMFilterPanelContent");e.class("sapMFilterPanelBG");e.openEnd();n.getAggregation("content").forEach(function(n){e.renderControl(n)});e.close("div");e.close("section")}})});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nItem", ["sap/m/library","sap/ui/core/Element"],function(e,l){"use strict";var t=l.extend("sap.ui.comp.p13n.P13nItem",{metadata:{library:"sap.ui.comp",properties:{columnKey:{type:"string",group:"Data",defaultValue:null},text:{type:"string",group:"Misc",defaultValue:""},visible:{type:"boolean",group:"Misc",defaultValue:null},type:{type:"string",group:"Misc",defaultValue:"text"},typeInstance:{type:"object",group:"Misc",defaultValue:null},precision:{type:"string",group:"Misc",defaultValue:null},formatSettings:{type:"object",group:"Misc",defaultValue:null},scale:{type:"string",group:"Misc",defaultValue:null},maxLength:{type:"string",group:"Misc",defaultValue:null},width:{type:"string",group:"Misc",defaultValue:null},isDefault:{type:"boolean",group:"Misc",defaultValue:false},values:{type:"string[]",group:"Misc",defaultValue:null},role:{type:"string",defaultValue:null},aggregationRole:{type:"string",defaultValue:null},href:{type:"string",defaultValue:null},target:{type:"string",defaultValue:null},press:{type:"object",defaultValue:null},description:{type:"string",defaultValue:null},nullable:{type:"boolean",group:"Misc",defaultValue:false}}}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nOperationsHelper", ["./P13nOperationsHelperBase","sap/m/library"],function(t,o){"use strict";var e=o.P13nConditionOperation;var n="Not";var N=function(){t.apply(this,arguments);this.init();this.oIncludeOperations.numcFiscal=[e.EQ,e.BT,e.LT,e.LE,e.GT,e.GE];this.oIncludeOperations.numc=[e.Contains,e.EQ,e.BT,e.EndsWith,e.LT,e.LE,e.GT,e.GE,e.Empty];this.oIncludeOperations.stringdate=[e.EQ,e.BT,e.LT,e.LE,e.GT,e.GE]};N.prototype=Object.create(t.prototype);N.prototype.oIncludeOperationsOptinal={optinal:[e.Empty]};N.prototype.oExcludeOperationsDefault={default:[e.NotEQ]};N.prototype.oExcludeOperationsExtended={default:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],string:[e.NotContains,e.NotEQ,e.NotBT,e.NotStartsWith,e.NotEndsWith,e.NotLT,e.NotLE,e.NotGT,e.NotGE],date:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],stringdate:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],time:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],datetime:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],numeric:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],numc:[e.NotContains,e.NotEQ,e.NotBT,e.NotEndsWith,e.NotLT,e.NotLE,e.NotGT,e.NotGE,e.NotEmpty],numcFiscal:[e.NotEQ,e.NotBT,e.NotLT,e.NotLE,e.NotGT,e.NotGE],boolean:[e.NotEQ]};N.prototype.oExcludeOperationsOptional={optinal:[e.NotEmpty]};N.prototype.isExcludeType=function(t){return i(t,this.oExcludeOperationsExtended)||i(t,this.oExcludeOperationsOptional)};N.prototype.getCorrespondingExcludeOperation=function(t){return n+t};N.prototype.getCorrespondingIncludeOperation=function(t){return t.slice(n.length)};function i(t,o){var e,n,N,i,r=false;for(n in o){N=o[n];for(e=0;e<N.length;e++){i=N[e];if(i===t){r=true;break}}if(r){break}}return r}return N},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nOperationsHelperBase", ["sap/m/library"],function(t){"use strict";var e=function(){this.init()};var n=t.P13nConditionOperation;e.prototype.oIncludeOperations={default:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],string:[n.Contains,n.EQ,n.BT,n.StartsWith,n.EndsWith,n.LT,n.LE,n.GT,n.GE],date:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],time:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],datetime:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],numeric:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],numc:[n.Contains,n.EQ,n.BT,n.EndsWith,n.LT,n.LE,n.GT,n.GE],boolean:[n.EQ]};e.prototype.oExcludeOperationsDefault={default:[n.EQ]};e.prototype.oExcludeOperationsExtended={default:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],string:[n.Contains,n.EQ,n.BT,n.StartsWith,n.EndsWith,n.LT,n.LE,n.GT,n.GE],date:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],time:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],datetime:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],numeric:[n.EQ,n.BT,n.LT,n.LE,n.GT,n.GE],numc:[n.Contains,n.EQ,n.BT,n.EndsWith,n.LT,n.LE,n.GT,n.GE],boolean:[n.EQ]};e.prototype.init=function(){this.oExcludeOperations=this.oExcludeOperationsDefault};e.prototype.setUseExcludeOperationsExtended=function(){this.oExcludeOperations=this.oExcludeOperationsExtended};e.prototype.getIncludeOperationsByType=function(t){if(!t){t="default"}return this.oIncludeOperations[t].map(function(t){return t})};e.prototype.getExcludeOperationsByType=function(t){if(!t){t="default"}return this.oExcludeOperations[t].map(function(t){return t})};e.prototype.getIncludeTypes=function(){return Object.keys(this.oIncludeOperations)};e.prototype.getExcludeTypes=function(){return Object.keys(this.oExcludeOperations)};return e});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/p13n/P13nPanel", ["sap/m/library","sap/ui/core/Control"],function(e,t){"use strict";var a=t.extend("sap.ui.comp.p13n.P13nPanel",{metadata:{abstract:true,library:"sap.ui.comp",interfaces:["sap.ui.comp.p13n.IContent"],properties:{title:{type:"string",group:"Appearance",defaultValue:null},titleLarge:{type:"string",group:"Appearance",defaultValue:null},type:{type:"string",group:"Misc",defaultValue:null},verticalScrolling:{type:"boolean",group:"Misc",defaultValue:true},validationExecutor:{type:"object",group:"Misc",defaultValue:null},validationListener:{type:"object",group:"Misc",defaultValue:null},changeNotifier:{type:"object",group:"Misc",defaultValue:null}},defaultAggregation:"items",aggregations:{items:{type:"sap.ui.comp.p13n.P13nItem",multiple:true,singularName:"item",bindable:"bindable"}},events:{beforeNavigationTo:{}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("span",t);e.class("sapMP13nPanel");e.openEnd();e.close("span")}}});a.prototype.getOkPayload=function(){return{}};a.prototype.getResetPayload=function(){return{}};a.prototype.beforeNavigationTo=function(){this.fireBeforeNavigationTo()};a.prototype.onBeforeNavigationFrom=function(){return true};a.prototype.onAfterNavigationFrom=function(){};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/BaseController", ["sap/ui/base/ManagedObject","sap/ui/comp/library","./Util","./ColumnHelper","sap/base/Log","sap/ui/core/Element","sap/ui/mdc/p13n/P13nBuilder","sap/ui/model/json/JSONModel"],function(t,e,n,o,a,i,r,s){"use strict";var l=t.extend("sap.ui.comp.personalization.BaseController",{metadata:{abstract:true,library:"sap.ui.comp",properties:{type:{type:"string",defaultValue:null},itemType:{type:"string",defaultValue:null},ignoreColumnKeys:{type:"object",defaultValue:[]},additionalIgnoreColumnKeys:{type:"object",defaultValue:[]},stableColumnKeys:{type:"string[]",defaultValue:[]},columnHelper:{type:"any",defaultValue:null},columnKeys:{type:"string[]",defaultValue:[]},redundantColumnKeys:{type:"string[]",defaultValue:[]},tableType:{type:"string",defaultValue:null}},aggregations:{messageStrip:{type:"sap.m.MessageStrip",multiple:false,singularName:"messageStrip"}},associations:{table:{type:"sap.ui.core.Control",multiple:false}},events:{beforePotentialTableChange:{},afterPotentialTableChange:{},afterPotentialModelChange:{parameters:{json:{type:"object"}}}}}});l.prototype.exit=function(){if(this.getModel()){this.getModel().destroy()}if(this._oAdaptationModel){this._oAdaptationModel.destroy();this._oAdaptationModel=null;this.oPanel=null}};l.prototype.setModelFunction=function(){var t=this;return function(){if(!this.getModel("$sapmP13nPanel")){this.setModel(t.getInternalModel(),"$sapmP13nPanel")}}};l.prototype.setTable=function(t){this.setAssociation("table",t);this.setTableType(n.getTableType(this.getTable()));return this};l.prototype.getTable=function(){var t=this.getAssociation("table");if(typeof t==="string"){t=i.getElementById(t)}return t};l.prototype.getColumnMap=function(){return this.getColumnHelper().getColumnMap()};l.prototype.createControlDataStructure=function(t){t=t||[];var e={};e[this.getType()]={};e[this.getType()][this.getItemType()]=t;return e};l.prototype.createColumnKeysStructure=function(t){t=t||[];var e={};e[this.getType()]={};e[this.getType()][this.getItemType()]=t.map(function(t){return{columnKey:t}});return e};l.prototype.checkConsistency=function(){var t=this.getColumnMap();this.getIgnoreColumnKeys().some(function(e){if(t[e]&&t[e].getVisible()){throw"The provided 'ignoreColumnKeys' for '"+this.getType()+"' are inconsistent. No columns specified as ignored is allowed to be visible."}},this);var e=this.getColumnKeys();Object.keys(t).forEach(function(t){if(e.indexOf(t)<0){throw"The provided 'columnKeys' and columns are inconsistent. For the column '"+t+"' no entry in 'columnKeys' exists."}});var n=this.getStableColumnKeys();n.forEach(function(e,n){if(t[e].getIndex()!=n){throw"The provided 'stableColumnKeys' are inconsistens. Please provide 'stableColumnKeys' by ascending indices of the columns, starting from index 0."}})};l.prototype.initializeInternalModel=function(t){["controlDataInitial","controlDataBase","controlData","alreadyKnownRuntimeData","alreadyKnownPersistentData"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,{})}t.setProperty("/"+e+"/"+this.getType(),this.createControlDataStructure()[this.getType()])},this);["ignoreData"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,{})}t.setProperty("/"+e+"/"+this.getType(),this.createColumnKeysStructure()[this.getType()])},this);["persistentDataChangeType","persistentDeltaDataChangeType"].forEach(function(n){if(!t.getProperty("/"+n)){t.setProperty("/"+n,{})}t.setProperty("/"+n+"/"+this.getType(),e.personalization.ChangeType.Unchanged);t.setProperty("/"+n+"/"+this.getType(),e.personalization.ChangeType.Unchanged)},this);["controlDataReduce","transientData","beforeOpenData","variantDataInitial"].forEach(function(e){if(!t.getProperty("/"+e)){t.setProperty("/"+e,undefined)}});this.setModel(t,"$sapuicomppersonalizationBaseController")};l.prototype._extendPropertyWithControlDataStructure=function(t){var e=this.getInternalModel();if(e.getProperty("/"+t)){return}e.setProperty("/"+t,{});e.setProperty("/"+t+"/"+this.getType(),this.createControlDataStructure()[this.getType()])};l.prototype.getInternalModel=function(){return this.getModel("$sapuicomppersonalizationBaseController")};l.prototype.calculateIgnoreData=function(){var t=this.getIgnoreColumnKeys().concat(this.getAdditionalIgnoreColumnKeys());t=t.filter(function(e,n){return t.indexOf(e)===n});var e=this.createColumnKeysStructure(t);this.setIgnoreData2Model(e)};l.prototype.calculateControlData=function(){var t=n.copy(this.getControlDataBase());this._deselectIgnoreDataFromJson(t);this.setControlData2Model(t)};l.prototype.calculateControlDataReduce=function(){var t=n.copy(this.getControlDataBase());this._removeIgnoreDataFromJson(t);this.setControlDataReduce2Model(t)};l.prototype.calculateTransientData=function(t){t=n.copy(t);this._removeIgnoreDataFromJson(t);this.setTransientData2Model(t)};l.prototype.calculatePersistentChangeTypesFromJson=function(t,n){var o=this.getPersistentDeltaDataChangeType();var a=this.getUnionData(this.getControlDataInitial(),t);o[this.getType()]=this.getChangeType(a,this.getAlreadyKnownPersistentData());this.setPersistentDeltaDataChangeType(o);o=this.getPersistentDataChangeType();if(n===e.personalization.ResetType.ResetFull){o[this.getType()]=this.getChangeType(t,this.getControlDataInitial())}else if(n===e.personalization.ResetType.ResetPartial){o[this.getType()]=this.getChangeType(t,this.getVariantDataInitial())}this.setPersistentDataChangeType(o)};l.prototype._removeIgnoreDataFromJson=function(t){if(!this.getIgnoreData()[this.getType()]){return}this.getIgnoreData()[this.getType()][this.getItemType()].forEach(function(e){var o=n.getIndexByKey("columnKey",e.columnKey,t[this.getType()][this.getItemType()]);if(o>-1){t[this.getType()][this.getItemType()].splice(o,1)}},this)};l.prototype._deselectIgnoreDataFromJson=function(t){if(!this.getIgnoreData()[this.getType()]){return}this.getIgnoreData()[this.getType()][this.getItemType()].forEach(function(e){var o=n.getIndexByKey("columnKey",e.columnKey,t[this.getType()][this.getItemType()]);if(o>-1){this.handleIgnore(t,o)}},this)};l.prototype.updateControlDataBaseFromJson=function(t){var e=this.getIgnoreData();var o=n.copy(this.getControlDataBase());var a=n.copy(this.getControlDataBase());var i=n.copy(t);o[this.getType()][this.getItemType()]=this.getControlDataBase()[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])>-1},this);i[this.getType()][this.getItemType()]=t[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])<0},this);a[this.getType()][this.getItemType()]=i[this.getType()][this.getItemType()];if(this.getType()==="columns"){if(a[this.getType()][this.getItemType()].length!==i[this.getType()][this.getItemType()].length){throw"the updated columns are inconsistent with 'controlDataBase'"}a[this.getType()][this.getItemType()].some(function(t){if(n.getIndexByKey("columnKey",t.columnKey,i[this.getType()][this.getItemType()])<0){throw"the columnKey '"+t.columnKey+"' is not contained in 'controlDataBase'"}},this)}var r=n.copy(this.getControlDataBase());r[this.getType()][this.getItemType()]=a[this.getType()][this.getItemType()].concat(o[this.getType()][this.getItemType()]);Object.keys(r[this.getType()]).forEach(function(e){if(!Array.isArray(r[this.getType()][e])){r[this.getType()][e]=t[this.getType()][e]}},this);this.setControlDataBase2Model(r);this.fireAfterPotentialModelChange({json:r})};l.prototype.extendControlDataInitial=function(t){this._extendData("controlDataInitial",t)};l.prototype.extendControlDataBase=function(t){this._extendData("controlDataBase",t)};l.prototype.extendVariantDataInitial=function(t){this._extendData("variantDataInitial",t)};l.prototype.extendAlreadyKnownRuntimeData=function(t){this._extendData("alreadyKnownRuntimeData",t)};l.prototype.extendAlreadyKnownPersistentData=function(t){this._extendData("alreadyKnownPersistentData",t)};l.prototype._extendData=function(t,e){if(!e||!e[this.getType()]||!this._getInternalModelData(t)){return}var o=n.copy(e);var i=this.getInternalModel();Object.keys(o[this.getType()]).forEach(function(e){if(Array.isArray(o[this.getType()][e])){o[this.getType()][e].forEach(function(o){var r=this._getInternalModelData(t)[this.getType()][e];if(n.getIndexByKey("columnKey",o.columnKey,r)>-1){a.error("columnKey '"+o.columnKey+"' does already exist in internal model");return}i.setProperty("/"+t+"/"+this.getType()+"/"+e+"/"+r.length+"/",o)},this);return}i.setProperty("/"+t+"/"+this.getType()+"/"+e+"/",o[this.getType()][e])},this)};l.prototype.setControlDataInitial2Model=function(t){this._setModelData("controlDataInitial",t)};l.prototype.setControlDataBase2Model=function(t){this._setModelData("controlDataBase",t)};l.prototype.setControlData2Model=function(t){this._setModelData("controlData",t)};l.prototype.setAlreadyKnownRuntimeData2Model=function(t){this._setModelData("alreadyKnownRuntimeData",t)};l.prototype.setAlreadyKnownPersistentData2Model=function(t){this._setModelData("alreadyKnownPersistentData",t)};l.prototype.setVariantDataInitial2Model=function(t){this._extendPropertyWithControlDataStructure("variantDataInitial");this._setModelData("variantDataInitial",t)};l.prototype.setIgnoreData2Model=function(t){this._setModelData("ignoreData",t)};l.prototype.setPersistentDataChangeType=function(t){this._setModelData("persistentDataChangeType",t)};l.prototype.setPersistentDeltaDataChangeType=function(t){this._setModelData("persistentDeltaDataChangeType",t)};l.prototype.setControlDataReduce2Model=function(t){this._extendPropertyWithControlDataStructure("controlDataReduce");this._setModelData("controlDataReduce",t)};l.prototype.setTransientData2Model=function(t){this._extendPropertyWithControlDataStructure("transientData");this._setModelData("transientData",t)};l.prototype.setBeforeOpenData2Model=function(t){this._extendPropertyWithControlDataStructure("beforeOpenData");this._setModelData("beforeOpenData",t)};l.prototype._setModelData=function(t,e){this.getInternalModel().setProperty("/"+t+"/"+this.getType(),e?n.copy(e)[this.getType()]:undefined)};l.prototype.getControlDataInitial=function(){return this._getInternalModelData("controlDataInitial")};l.prototype.getControlDataBase=function(){return this._getInternalModelData("controlDataBase")};l.prototype.getControlData=function(){return this._getInternalModelData("controlData")};l.prototype.getAlreadyKnownRuntimeData=function(){return this._getInternalModelData("alreadyKnownRuntimeData")};l.prototype.getAlreadyKnownPersistentData=function(){return this._getInternalModelData("alreadyKnownPersistentData")};l.prototype.getVariantDataInitial=function(){return this._getInternalModelData("variantDataInitial")};l.prototype.getIgnoreData=function(){return this._getInternalModelData("ignoreData")};l.prototype.getPersistentDataChangeType=function(){return this._getInternalModelData("persistentDataChangeType")};l.prototype.getPersistentDeltaDataChangeType=function(){return this._getInternalModelData("persistentDeltaDataChangeType")};l.prototype.getControlDataReduce=function(){return this._getInternalModelData("controlDataReduce")};l.prototype.getTransientData=function(){return this._getInternalModelData("transientData")};l.prototype.getBeforeOpenData=function(){return this._getInternalModelData("beforeOpenData")};l.prototype.isEqualAdditionalIgnoreColumnKeys=function(t){var e=this.getAdditionalIgnoreColumnKeys();if(e.length!==t.length){return false}return!e.some(function(e){return t.indexOf(e)<0})};l.prototype._getInternalModelData=function(t){return this.getInternalModel().getProperty("/"+t)};l.prototype.determineMissingColumnKeys=function(t){if(!t||!t[this.getType()]||!t[this.getType()][this.getItemType()]){return this.createColumnKeysStructure()}var e=this.getColumnMap();var o=this.getIgnoreData();var a=t[this.getType()][this.getItemType()].filter(function(t){return!e[t.columnKey]}).filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,o[this.getType()][this.getItemType()])<0},this).map(function(t){return t.columnKey});return this.createColumnKeysStructure(a)};l.prototype.extractIgnoreDataFromJson=function(t){if(!t||!t[this.getType()]||!t[this.getType()][this.getItemType()]){return null}var e=this.getIgnoreData();var o=t[this.getType()][this.getItemType()].filter(function(t){return n.getIndexByKey("columnKey",t.columnKey,e[this.getType()][this.getItemType()])>-1},this);return o.length?this.createControlDataStructure(o):null};l.prototype.getTable2Json=function(t){var e=this.createControlDataStructure();var n=this.getColumnMap();var o=this.getColumnKeys();t[this.getType()][this.getItemType()].forEach(function(t){var i=n[t.columnKey];if(!i){a.warning("Column with columnKey '"+t.columnKey+"' does not exist.");return}var r=this.getColumn2Json(i,t.columnKey,o.indexOf(t.columnKey));if(r){e[this.getType()][this.getItemType()].push(r)}},this);this.getAdditionalData2Json(e,this.getTable());return e};l.prototype.getTable2JsonTransient=function(t){var e=this.createControlDataStructure();var o=this.getColumnMap();var a,i;var r;t[this.getType()][this.getItemType()].forEach(function(t){var n=false;if(this.getType()==="columns"){this.getStableColumnKeys().forEach(function(e){if(e==t.columnKey){n=true}})}var s=o[t.columnKey];if(!s||n){return}if(s.isA("sap.ui.table.Column")){if(!s.getLabel()){throw"The column '"+t.columnKey+"' should have a 'label' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getLabel().getText();r=s.getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getTooltip_Text()}if(s.isA("sap.m.Column")){if(!s.getHeader()){throw"The column '"+t.columnKey+"' should have a 'header' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getHeader().getText();r=s.getHeader().getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getHeader().getTooltip_Text()}if(s.isA("sap.ui.comp.personalization.ColumnWrapper")){if(!s.getLabel()){throw"The column '"+t.columnKey+"' should have a 'label' aggregation otherwise the column can not be identified in the personalization dialog."}a=s.getLabel();r=s.getTooltip();i=r&&typeof r==="object"&&r.isA("sap.ui.core.TooltipBase")?r.getTooltip_Text():s.getTooltip_Text()}var l=this.getColumn2JsonTransient(s,t.columnKey,a,i);if(l){e[this.getType()][this.getItemType()].push(l)}},this);n.sortItemsByText(e[this.getType()][this.getItemType()],"text");return e};l.prototype.getColumn2Json=function(t,e,n){};l.prototype.getAdditionalData2Json=function(t,e){};l.prototype.getColumn2JsonTransient=function(t,e){};l.prototype.handleIgnore=function(t,e){};l.prototype.fixConflictWithIgnore=function(t,e){};l.prototype.syncJson2Table=function(t){};l.prototype.getPanel=function(){};l.prototype.getAdaptationUI=function(){return this.oPanel&&!this.oPanel.bIsDestroyed?this.oPanel:null};l.prototype.retrieveAdaptationUI=function(t){return this.getPanel(t)};l.prototype.getAdaptationData=function(){var t=this.getTransientData();var e=this.getInternalModel().getProperty("/controlDataReduce");var n=e[this.getType()][this.getItemType()].reduce(function(t,e,n){t[e.columnKey]=Object.assign({},e);t[e.columnKey].position=n;return t},{});var o=[];t[this.getType()][this.getItemType()].forEach(function(t,e){o.push(this._transformAdaptationData(n[t.columnKey],t))}.bind(this));this._sortAdaptationData(o);return o};l.prototype._transformAdaptationData=function(t,e){return{position:t?t.position:-1,name:e.columnKey,label:e.text,tooltip:e.tooltip}};l.prototype._sortAdaptationData=function(t){r.sortP13nData({visible:"visible",position:"position"},t)};l.prototype._getPresenceAttribute=function(){return"visible"};l.prototype._getP13nBuilder=function(){return r};l.prototype.getChangeType=function(t,e){};l.prototype.getChangeData=function(t,e){};l.prototype.getUnionData=function(t,e){};l.prototype.getResetWarningText=function(){return undefined};return l});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ChartWrapper", ["sap/ui/core/Element","sap/ui/comp/library","./ColumnWrapper","sap/ui/core/CustomData"],function(e,t,a,r){"use strict";var o=t.personalization.AggregationRole;var n=e.extend("sap.ui.comp.personalization.ChartWrapper",{constructor:function(t,a){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{externalFilters:{type:"any[]",defaultValue:[]}},aggregations:{columns:{type:"sap.ui.comp.personalization.ColumnWrapper",multiple:true,singularName:"column"}},associations:{chart:{type:"sap.chart.Chart",multiple:false}},events:{externalFiltersSet:{parameters:{filters:{type:"sap.ui.comp.p13n.P13nFilterItem[]"}}}}}});n.prototype.getChartObject=function(){var t=this.getAssociation("chart");if(typeof t==="string"){t=e.getElementById(t)}return t};n.prototype.getModel=function(){return this.getChartObject().getModel()};n.prototype.getDomRef=function(){var e=this.getChartObject();return e&&e.getDomRef()};n.createChartWrapper=function(e,t,l){var i;var s={};e.getDimensions().forEach(function(t){i=t.data("p13nData");s[i.columnKey]=new a({label:t.getLabel(),tooltip:t.getTooltip(),selected:e.getVisibleDimensions().indexOf(t.getName())>-1,aggregationRole:o.Dimension,role:t.getRole()?t.getRole():t.getMetadata().getProperty("role").getDefaultValue(),sorted:i.sorted,sortOrder:i.sortOrder,customData:new r({key:"p13nData",value:i}),hierarchyLevel:i.hierarchyLevel,chart:e})});e.getMeasures().forEach(function(t){i=t.data("p13nData");s[i.columnKey]=new a({label:t.getLabel(),tooltip:t.getTooltip(),selected:e.getVisibleMeasures().indexOf(t.getName())>-1,aggregationRole:o.Measure,role:t.getRole()?t.getRole():t.getMetadata().getProperty("role").getDefaultValue(),sorted:i.sorted,sortOrder:i.sortOrder,customData:new r({key:"p13nData",value:i}),chart:e})});if(t){t.forEach(function(t){s[t.columnKey]=new a({label:t.label,tooltip:t.tooltip,selected:false,aggregationRole:o.NotDimeasure,sorted:t.sorted,sortOrder:t.sortOrder,customData:new r({key:"p13nData",value:t}),chart:e});if(!s[t.columnKey].getParent()){e.addDependent(s[t.columnKey])}})}return new n({chart:e,columns:l.map(function(e){return s[e]})})};return n});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnHelper", ["sap/ui/base/DataType","sap/ui/base/ManagedObject","./Util","./ColumnWrapper","sap/base/util/isEmptyObject"],function(e,o,t,n,u){"use strict";var i=o.extend("sap.ui.comp.personalization.ColumnHelper",{constructor:function(e,t){o.apply(this,arguments)},metadata:{properties:{callbackOnSetVisible:{type:"object",defaultValue:null},callbackOnSetSummed:{type:"object",defaultValue:null},callbackOnSetGrouped:{type:"object",defaultValue:null}}}});i.prototype.init=function(){this._oColumnKey2ColumnMap={};this._oColumnKeyIsMonkeyPatched={}};i.prototype.exit=function(){this._oColumnKey2ColumnMap=null;this._oColumnKeyIsMonkeyPatched=null};i.prototype.addColumns=function(e){if(!e){return}e.forEach(function(e){this._addColumnToMap(t.getColumnKey(e),e)},this);this._checkConsistencyOfColumns(this._oColumnKey2ColumnMap)};i.prototype.addColumnMap=function(e){if(!e){return}for(var o in e){this._addColumnToMap(o,e[o])}this._checkConsistencyOfColumns(this._oColumnKey2ColumnMap)};i.prototype.getColumnMap=function(){return this._oColumnKey2ColumnMap};i.prototype._checkConsistencyOfColumns=function(e){if(u(e)){return}var o=Object.keys(e)[0];var n=!!t._getCustomProperty(e[o],"columnKey");for(var i in e){if(n!==!!t._getCustomProperty(e[i],"columnKey")){throw"The table instance contains some columns for which a columnKey is provided, some for which a columnKey is not provided."}}};i.prototype._addColumnToMap=function(e,o){if(this._oColumnKey2ColumnMap[e]){throw"Duplicate 'columnKey': The column '"+o.getId()+"' and column '"+this._oColumnKey2ColumnMap[e]+"' have same 'columnKey' "+e}if(!this._oColumnKey2ColumnMap[e]){this._oColumnKey2ColumnMap[e]=o;this._monkeyPatchColumn(o,e)}};i.prototype._monkeyPatchColumn=function(e,o){if(e instanceof n){return}if(this._oColumnKeyIsMonkeyPatched[o]){return}this._oColumnKeyIsMonkeyPatched[o]=true;var t=this.getCallbackOnSetVisible();var u=e.setVisible.bind(e);var i=function(e){if(t){t(e,o)}u(e)};e.setVisible=i;if(e.setSummed){var a=this.getCallbackOnSetSummed();var l=e.setSummed.bind(e);var s=function(o){if(a){a(o,e)}l(o)};e.setSummed=s}if(e.isA("sap.ui.table.AnalyticalColumn")){var c=this.getCallbackOnSetGrouped();if(typeof c==="function"){var m=e.setGrouped.bind(e);var r=function(o,t){if(!t&&c){c(o,e)}m(o)};e.setGrouped=r}}};return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnWrapper", ["sap/ui/core/Element","sap/ui/comp/personalization/Util"],function(e,t){"use strict";var a=e.extend("sap.ui.comp.personalization.ColumnWrapper",{constructor:function(t,a){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{label:{type:"string"},tooltip:{type:"string"},selected:{type:"boolean",defaultValue:false},aggregationRole:{type:"sap.ui.comp.personalization.AggregationRole"},role:{type:"string"},href:{type:"string",defaultValue:null},internalHref:{type:"string",defaultValue:null},target:{type:"string",defaultValue:null},press:{type:"object",defaultValue:null},sorted:{type:"boolean",defaultValue:false},sortOrder:{type:"string",defaultValue:"None"},hierarchyLevel:{type:"int",defaultValue:0},description:{type:"string",defaultValue:null}},associations:{chart:{type:"sap.chart.Chart",multiple:false}}}});a.prototype.getVisible=function(){var a=this.getAssociation("chart");if(typeof a==="string"){a=e.getElementById(a)}var l=a.getVisibleDimensions().concat(a.getVisibleMeasures());var i=t.getColumnKey(this);return l.indexOf(i)>-1};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/ColumnsController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/base/util/merge","sap/ui/core/Lib"],function(e,t,n,i,o,l){"use strict";var s=t.MultiSelectMode;var a=e.extend("sap.ui.comp.personalization.ColumnsController",{constructor:function(n,i){e.apply(this,arguments);this.setType(t.P13nPanelType.columns);this.setItemType(t.P13nPanelType.columns+"Items")},metadata:{properties:{triggerModelChangeOnColumnInvisible:{type:"boolean",group:"Misc",defaultValue:false}},events:{afterColumnsModelDataChange:{}}}});a.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()===n.personalization.TableType.ResponsiveTable){var i=t.findElements(false,function(e){return e.isA("sap.m.plugins.ColumnResizer")})[0];if(i){i.detachColumnResize(this._onColumnResize,this);i.attachColumnResize(this._onColumnResize,this)}}else if(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable){t.detachColumnMove(this._onColumnMove,this);t.detachColumnVisibility&&t.detachColumnVisibility(this._onColumnVisibility,this);t.detachColumnResize(this._onColumnResize,this);t.attachColumnMove(this._onColumnMove,this);t.attachColumnVisibility&&t.attachColumnVisibility(this._onColumnVisibility,this);t.attachColumnResize(this._onColumnResize,this)}this._monkeyPatchTable(t)};a.prototype.getColumn2Json=function(e,t,n){return{columnKey:t,index:n,visible:e.getVisible(),width:e.getWidth?e.getWidth():undefined,total:e.getSummed?e.getSummed():undefined}};a.prototype.getAdditionalData2Json=function(e,t){e.columns.fixedColumnCount=t?.getFixedColumnCount?.();if(!this._bInitialShowDetailsSet){e.columns.showDetails=false;this._bInitialShowDetailsSet=true}};a.prototype.getColumn2JsonTransient=function(e,t,n,i){return{columnKey:t,text:n,tooltip:i!==n?i:undefined}};a.prototype.handleIgnore=function(e,t){e.columns.columnsItems[t].visible=false};a.prototype.syncJson2Table=function(e){var t=this.getTable();var i=this.getColumnMap();this.fireBeforePotentialTableChange();if(this.getTable()&&(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable)){this._applyChangesToUiTableType(t,e,i)}else if(this.getTableType()===n.personalization.TableType.ResponsiveTable){this._applyChangesToMTableType(t,e,i)}this.fireAfterPotentialTableChange()};a.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();var n=function(e,n,o){var l=i.getIndexByKey("columnKey",e,t.columns.columnsItems);if(l<0){l=t.columns.columnsItems.length;t.columns.columnsItems.splice(l,0,{columnKey:e})}t.columns.columnsItems[l][n]=o};this.getControlDataInitial().columns.columnsItems.filter(function(e){return e.visible===true}).forEach(function(e){n(e.columnKey,"visible",false)});if(e.Visualizations&&e.Visualizations.length){var o=e.Visualizations.filter(function(e){return e.Type==="LineItem"});if(o.length){o[0].Content.forEach(function(e,t){n(e.Value,"visible",true);n(e.Value,"index",t)},this)}var l=e.Visualizations.filter(function(e){return e.Type==="ColumnWidth"});if(l.length){l[0].Content.forEach(function(e){n(e.Value,"width",e.Width)},this)}}if(e.Total&&e.Total.length){e.Total.forEach(function(e){n(e,"total",true)})}return t};a.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.columns||!t.columns.columnsItems||!t.columns.columnsItems.length){return}var n=t.columns.columnsItems.filter(function(e){return!!e.total});if(n.length){e.Total=n.map(function(e){return e.columnKey})}var i=t.columns.columnsItems.filter(function(e){return!!e.visible});if(i.length){if(!e.Visualizations){e.Visualizations=[]}i.sort(this._sortByIndex);e.Visualizations.push({Type:"LineItem",Content:i.map(function(e){return{Value:e.columnKey,Label:undefined}})})}var o=t.columns.columnsItems.filter(function(e){return!!e.width});if(o.length){if(!e.Visualizations){e.Visualizations=[]}e.Visualizations.push({Type:"ColumnWidth",Content:o.map(function(e){return{Value:e.columnKey,Width:e.width}})})}};a.prototype._onColumnMove=function(e){var t=e.getParameter("newPos"),n=i.getColumnKey(e.getParameter("column")),o=this.getControlData(),l=o.columns.columnsItems,s,a,u;this._sortAdaptationData(l);s=l.findIndex(function(e){return e.index===t});a=i.getIndexByKey("columnKey",n,l);if(a<0||s<0||a>l.length-1||s>l.length-1){return}if(s<a){u=1}else if(s>a){u=-1}this.fireBeforePotentialTableChange();var r=l.splice(a,1);l.splice(s,0,r[0]);for(var m=s;m!=a;m=m+u){this._swapIndexes(l[m],l[m+u])}this.updateControlDataBaseFromJson(o);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};a.prototype._onColumnVisibility=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.getParameter("column")),"visible",e.getParameter("newVisible"));this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};a.prototype._onColumnTotal=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.column),"total",e.isSummed);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};a.prototype._onColumnResize=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(i.getColumnKey(e.getParameter("column")),"width",e.getParameter("width"));this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};a.prototype._onColumnFixedCount=function(e){this.fireBeforePotentialTableChange();var t=this.getControlData();this.getInternalModel().setProperty("/controlData/columns/fixedColumnCount",e);this.updateControlDataBaseFromJson(t);this.fireAfterPotentialTableChange();this.fireAfterColumnsModelDataChange()};a.prototype._updateInternalModel=function(e,t,n){if(!e||!t){return}var o=this.getControlData();var l=i.getIndexByKey("columnKey",e,o.columns.columnsItems);if(l<0){throw"No entry found in 'controlDataBase' for columnKey '"+e+"'"}this.getInternalModel().setProperty("/controlData/columns/columnsItems/"+l+"/"+t,n);this.updateControlDataBaseFromJson(o)};a.prototype._swapIndexes=function(e,t){var n=e.index;e.index=t.index;t.index=n};a.prototype._quickSortPartition=function(e,t,n){var i,o=t,l=e[n];for(i=t;i<=n-1;i++){if(e[i].index<l.index){if(i!==o){this._swapIndexes(e[o],e[i])}o++}}this._swapIndexes(e[o],l);return o};a.prototype._quickSort=function(e,t,n){var i,o,l,s=[t,n];while(s[s.length-1]>=0){l=s.pop();o=s.pop();i=this._quickSortPartition(e,o,l);if(i-1>o){s.push(o);s.push(i-1)}if(i+1<l){s.push(i+1);s.push(l)}}};a.prototype._sortIndexesByOrder=function(e){var t=e.findIndex(function(e){return!Number.isInteger(e.index)}),n=t===-1?e.length-1:t-1;if(n>0){this._quickSort(e,0,n)}};a.prototype.retrieveAdaptationUI=function(e){return new Promise(function(e){sap.ui.require(["sap/m/p13n/SelectionPanel"],function(t){var n=this.getAdaptationData();var i=new t({showHeader:true,enableCount:true,fieldColumn:l.getResourceBundleFor("sap.ui.mdc").getText("fieldsui.COLUMNS"),multiSelectMode:s.Default});i.setP13nData(n);this.oPanel=i;var o;i.attachChange(function(e){o=e.getSource().getP13nData().map(function(e,t){var i={columnKey:e.name,visible:e.visible,width:e.width,total:e.total};i.index=n[t].position;return i});this._sortAdaptationData(o);this._sortIndexesByOrder(o);var t=this.getControlDataReduce();let i=false,l=0;const s=e.getParameter("item");t.columns.columnsItems.forEach(e=>{if(!i&&!e.visible){l++}if(e.columnKey===this._freezedColumnKey&&e.visible!==s.visible){i=true}});t.columns.columnsItems=o;if(i){t.columns.fixedColumnCount=t.columns.fixedColumnCount-l}this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:this._enhanceForStableKeys(this.getControlDataInitial(),t)})}.bind(this));e(i)}.bind(this))}.bind(this))};a.prototype._transformAdaptationData=function(t,n){var i=e.prototype._transformAdaptationData.apply(this,arguments);if(t){i.visible=t.visible;i.position=t.index;i.width=t.width;i.total=t.total;i.isRedundant=this.getRedundantColumnKeys().includes(t.columnKey)}return i};a.prototype._sortByIndex=function(e,t){if(e.index!==undefined&&t.index===undefined){return-1}if(t.index!==undefined&&e.index===undefined){return 1}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0};a.prototype._applyChangesToUiTableType=function(e,t,n){var i=null;var o={};var l=this;var s=function(e,t){e.forEach(function(e){o[e.columnKey]=e});e.sort(l._sortByIndex);var n=e.map(function(e){return e.columnKey});t.forEach(function(e,t){if(n.indexOf(e)<0){n.splice(t,0,e)}});return n};var a=function(e,t){var n=o[e];if(n&&n.visible!==undefined&&t.getVisible()!==n.visible){t.setVisible(n.visible,true)}};var u=function(t,n,i){var o=e.indexOfColumn(i);var l=t;if(l!==undefined&&o!==l){if(o>-1){e.removeColumn(i,true)}e.insertColumn(i,l,true)}};var r=function(e,t){var n=o[e];if(n&&n.width!==undefined&&t.getWidth()!==n.width){t.setWidth(n.width,true)}};var m=function(e,t){var n=o[e];if(n&&n.total!==undefined&&t.getSummed&&t.getSummed()!==n.total){t.setSummed(n.total,true)}};if(t.columns.columnsItems.length){var c=s(t.columns.columnsItems,this.getColumnKeys());c.forEach(function(e,t){i=n[e];if(i){a(e,i);u(t,e,i);r(e,i);m(e,i)}})}var f=t.columns.fixedColumnCount||0;if(e.getFixedColumnCount&&e.getFixedColumnCount()!==f){e.setFixedColumnCount(f,true)}};a.prototype._applyChangesToMTableType=function(e,t,n){var i=false;var o=function(e,t){var n=e.index;if(n!==undefined){t.setOrder(n,true);i=true}};var l=function(e,t){if(e.visible!==undefined&&t.getVisible()!==e.visible){t.setVisible(e.visible,true);i=true}};var s=function(e,t){if(e.width!==undefined&&t.getWidth()!==e.width){t.setWidth(e.width)}};if(typeof t.columns.showDetails==="boolean"){e.getParent()?._setShowDetails?.(t.columns.showDetails)}if(t.columns.columnsItems.length){t.columns.columnsItems.sort(function(e,t){if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0});t.columns.columnsItems.forEach(function(e){var t=n[e.columnKey];if(t){o(e,t);l(e,t);s(e,t)}},this)}if(i){e.invalidate()}};a.prototype.getChangeType=function(e,t){var i=this.getChangeData(e,t);var o=this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTriggerModelChangeOnColumnInvisible();if(i){var l=n.personalization.ChangeType.TableChanged;i.columns.columnsItems.some(function(e){if(e.visible||e.visible===false&&o){l=n.personalization.ChangeType.ModelChanged;return true}if(e.total===false||e.total===true){l=n.personalization.ChangeType.ModelChanged;return true}});return l}return n.personalization.ChangeType.Unchanged};a.prototype.getChangeData=function(e,t){if(!t||!t.columns||!t.columns.columnsItems){return null}var n={columns:i.copy(e.columns)},o=e.columns.showDetails===t.columns.showDetails,l=true;l=e.columns.fixedColumnCount===t.columns.fixedColumnCount;e.columns.columnsItems.some(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.columns.columnsItems);if(!i.semanticEqual(e,n)){l=false;return true}});l=l&&o;if(l){return null}var s=[];n.columns.columnsItems.forEach(function(e,n){var o=i.getArrayElementByKey("columnKey",e.columnKey,t.columns.columnsItems);if(i.semanticEqual(e,o)){s.push(e);return}for(var l in e){if(l==="columnKey"||!o){if(o&&o[l]===undefined){delete e[l]}else{continue}}if(e[l]===o[l]){delete e[l]}}if(Object.keys(e).length<2){s.push(e)}});s.forEach(function(e){var t=i.getIndexByKey("columnKey",e.columnKey,n.columns.columnsItems);n.columns.columnsItems.splice(t,1)});if(n.columns.fixedColumnCount===0){delete n.columns.fixedColumnCount}if(o){delete n.columns.showDetails}return n};a.prototype._sortArrayByPropertyName=function(e,t,n){var i=[];if(n===null||n===undefined){n=false}if(e&&e.length>0&&t!==undefined&&t!==null&&t!==""){if(n){i=o([],e)}else{i=e}i.sort(function(e,n){var i=e[t];var o=n[t];if(i<o||i!==undefined&&o===undefined){return-1}if(i>o||i===undefined&&o!==undefined){return 1}return 0})}return i};a.prototype.getUnionData=function(e,t){if(!t||!t.columns||!t.columns.columnsItems){return i.copy(e)}var n=i.copy(t);Object.keys(e.columns).forEach(function(t){if(Array.isArray(e.columns[t])){e.columns[t].forEach(function(e){var o=i.getArrayElementByKey("columnKey",e.columnKey,n.columns[t]);if(!o){n.columns[t].push(e);return}if(o.visible===undefined&&e.visible!==undefined){o.visible=e.visible}if(o.width===undefined&&e.width!==undefined){o.width=e.width}if(o.total===undefined&&e.total!==undefined){o.total=e.total}if(o.index===undefined&&e.index!==undefined){o.index=e.index}});return}if(n.columns[t]===undefined&&e.columns[t]!==undefined){n.columns[t]=e.columns[t]}},this);n.columns.columnsItems=n.columns.columnsItems.sort(function(e,t){return e.index-t.index}).reduce(function(e,t){var n=e[e.length-1];if(n&&n.index>=t.index){t.index=n.index+1}e.push(t);return e},[]);return n};a.prototype._enhanceForStableKeys=function(e,t){if(this.getStableColumnKeys().length>0&&this._checkFillRequired(e,t)){var n=this._getFilledArray(e,t);t.columns.columnsItems=n}return t};a.prototype._checkFillRequired=function(e,t){var n=t.columns.columnsItems.reduce(function(e,t){e[t.columnKey]=t;return e},{});var i=e.columns.columnsItems.some(function(e){return!n[e.columnKey]});return i};a.prototype._getFilledArray=function(e,t){var n=[];var i=e.columns.columnsItems.reduce(function(e,t){e[t.columnKey]=t;return e},{});for(var o=0;o<t.columns.columnsItems.length;o++){var l=t.columns.columnsItems[o];if(i[l.columnKey]){var s=l.index;i[l.columnKey]=l;i[l.columnKey].index=s}}Object.keys(i).forEach(function(e){n.push(i[e])});return n};a.prototype.fixConflictWithIgnore=function(e,t){if(!e||!e.columns||!e.columns.columnsItems||!t||!t.columns||!t.columns.columnsItems||!t.columns.columnsItems.length){return e}this._sortArrayByPropertyName(e.columns.columnsItems,"index");var n=false;t.columns.columnsItems.forEach(function(t){var o=i.getIndexByKey("columnKey",t.columnKey,e.columns.columnsItems);if(o<0||e.columns.columnsItems[o].index===undefined){return}if(o+1<=e.columns.columnsItems.length-1&&e.columns.columnsItems[o+1].index===e.columns.columnsItems[o].index||o-1>=0&&e.columns.columnsItems[o-1].index===e.columns.columnsItems[o].index){n=true}if(o+1<=e.columns.columnsItems.length-1&&e.columns.columnsItems[o+1].index===e.columns.columnsItems[o].index){var l=e.columns.columnsItems.splice(o,1);e.columns.columnsItems.splice(o+1,0,l[0])}});if(n){var o=-1;e.columns.columnsItems.forEach(function(e){if(e.index!==undefined){e.index=++o}})}};a.prototype.isColumnSelected=function(e,t){var n=i.getIndexByKey("columnKey",t,e.columnsItems);return n>-1?e.columnsItems[n].visible:false};a.prototype._monkeyPatchTable=function(e){if(this.getTableType()!==n.personalization.TableType.AnalyticalTable&&this.getTableType()!==n.personalization.TableType.Table&&this.getTableType()!==n.personalization.TableType.TreeTable){return}e.attachColumnFreeze(e=>{this._freezedColumn=e.getParameter("column");this._freezedColumnKey=e.getParameter("column")?.data("p13nData")?.columnKey});var t=this;var i=e.setFixedColumnCount.bind(e);var o=function(e,n){t._onColumnFixedCount(e);i(e,n);if(e===0){t._freezedColumn=null;t._freezedColumnKey=null}};if(e.setFixedColumnCount.toString()===o.toString()){return}e.setFixedColumnCount=o};a.prototype._updateInternalModelShowHide=function(e){var t=this.getControlData();this.getInternalModel().setProperty("/controlData/columns/showDetails/",e);this.updateControlDataBaseFromJson(t);this.fireAfterColumnsModelDataChange()};a.prototype.exit=function(){e.prototype.exit.apply(this,arguments);var t=this.getTable();if(this.getTable()&&(this.getTableType()===n.personalization.TableType.AnalyticalTable||this.getTableType()===n.personalization.TableType.Table||this.getTableType()===n.personalization.TableType.TreeTable)){t.detachColumnMove(this._onColumnMove,this);t.detachColumnVisibility&&t.detachColumnVisibility(this._onColumnVisibility,this);t.detachColumnResize(this._onColumnResize,this)}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Controller", ["sap/base/Log","sap/base/util/merge","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/thirdparty/jquery","sap/ui/base/ManagedObject","sap/m/library","sap/ui/comp/library","./ColumnsController","./FilterController","./GroupController","./SortController","./DimeasureController","./SelectionController","./Util","./ChartWrapper","./SelectionWrapper","./ColumnHelper","sap/m/MessageStrip","sap/m/P13nDialog","./Validator","sap/ui/model/json/JSONModel","sap/ui/Device","sap/ui/model/BindingMode","sap/ui/core/Lib"],function(t,e,n,i,jQuery,a,o,r,s,l,h,u,g,c,p,_,C,f,d,y,D,m,b,T,S){"use strict";var P=a.extend("sap.ui.comp.personalization.Controller",{constructor:function(t,e){a.apply(this,arguments)},metadata:{library:"sap.ui.comp",interfaces:["sap.m.p13n.modules.AdaptationProvider"],properties:{setting:{type:"object",defaultValue:{}},resetToInitialTableState:{type:"boolean",defaultValue:true},columnKeys:{type:"string[]",defaultValue:[]},redundantColumnKeys:{type:"string[]",defaultValue:[]}},associations:{table:{type:"object",multiple:false}},events:{beforePotentialTableChange:{},afterPotentialTableChange:{},afterP13nModelDataChange:{parameters:{persistentData:{type:"object"},persistentDataChangeType:{type:"sap.ui.comp.personalization.ChangeType"},runtimeDeltaData:{type:"object"},runtimeDeltaDataChangeType:{type:"sap.ui.comp.personalization.ChangeType"},_bTriggeredFromReset:{type:"boolean",defaultValue:false}}},requestColumns:{parameters:{columnKeys:{type:"string"}}},dialogAfterClose:{parameters:{cancel:{type:"boolean"}}},dialogAfterOpen:{},dialogConfirmedReset:{}}}});P.prototype.applySettings=function(t){a.prototype.applySettings.apply(this,arguments);this._initialize()};P.prototype._initialize=function(){this._bInitCalled=true;var t,e=this.getTable();if(!e){throw"The table instance should be passed into constructor."}t=e.getParent();if(t&&t.isA("sap.ui.comp.smarttable.SmartTable")){this._aAvailablePanels=t._aAvailablePanels.map(function(t){return t.toLowerCase()})}this._createSettingCurrent(this.getSetting());var n=e.getColumns();if(!this.getColumnKeys().length){this.setProperty("columnKeys",p.getColumnKeys(n),true)}var i=this._createInternalModel(this.getColumnKeys());this._callControllers(this._oSettingCurrent,"initializeInternalModel",i);this._oColumnHelper=new f({callbackOnSetVisible:this._onSetVisible.bind(this),callbackOnSetSummed:this._onSetSummed.bind(this),callbackOnSetGrouped:e.fireGroup?this._onSetGrouped.bind(this):null});this._oColumnHelper.addColumns(n);this._callControllers(this._oSettingCurrent,"setColumnHelper",this._oColumnHelper);this._callControllers(this._oSettingCurrent,"setTriggerModelChangeOnColumnInvisible");this._callControllers(this._oSettingCurrent,"setTable",e);this._callControllers(this._oSettingCurrent,"setColumnKeys",this.getColumnKeys());this._callControllers(this._oSettingCurrent,"setRedundantColumnKeys",this.getRedundantColumnKeys());this._callControllers(this._oSettingCurrent,"setIgnoreColumnKeys");this._callControllers(this._oSettingCurrent,"setStableColumnKeys");this._callControllers(this._oSettingCurrent,"checkConsistency");this._callControllers(this._oSettingCurrent,"calculateIgnoreData");var a=P._getOrderedColumnKeys(this._oColumnHelper.getColumnMap(),this.getColumnKeys());this._extendModelStructure(a);this._callControllers(this._oSettingCurrent,"calculateControlData");this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent()};P.prototype.init=function(){this._oDialog=null;this._bInitCalled=false;this._bSuspend=false;this._bUnconfirmedResetPressed=false;this._oColumnHelper=null;this._oSettingCurrent={}};P.prototype.setSetting=function(t){if(this._bInitCalled){throw"The setting instance should be passed only into constructor."}t=this.validateProperty("setting",t);this.setProperty("setting",t,true);return this};P.prototype.setResetToInitialTableState=function(t){if(this._bInitCalled){throw"The resetToInitialTableState property should be passed only into constructor."}t=this.validateProperty("resetToInitialTableState",t);this.setProperty("resetToInitialTableState",t,true);return this};P.prototype.setColumnKeys=function(e){if(this._bInitCalled){throw"The columnKeys array should be passed only into constructor."}e=this.validateProperty("columnKeys",e);var n=e.filter(function(n,i){var a=e.indexOf(n,i+1)>-1;if(a){t.warning("The provided columnKeys is inconsistent as columnKey "+n+" is not unique and therefore the duplicate entry is deleted from columnKeys.")}return!a});this.setProperty("columnKeys",n,true);return this};P.prototype.setTable=function(t){if(this._bInitCalled){throw"The table instance should be passed only into constructor."}this.setAssociation("table",t);return this};P.prototype._createSettingCurrent=function(t){var e=p.getTableType(this.getTable());var n,i;switch(e){case r.personalization.TableType.ChartWrapper:n=[o.P13nPanelType.dimeasure,o.P13nPanelType.sort,o.P13nPanelType.filter];break;case r.personalization.TableType.SelectionWrapper:n=[o.P13nPanelType.selection];break;default:n=[o.P13nPanelType.columns,o.P13nPanelType.sort,o.P13nPanelType.filter,o.P13nPanelType.group]}for(i in t){if(t[i].visible===false&&n.indexOf(i)>-1){n.splice(n.indexOf(i),1)}if(t[i].visible===true&&n.indexOf(i)<0){n.push(i)}}n.forEach(function(e){this._oSettingCurrent[e]={visible:true,controller:t[e]&&t[e].controller?t[e].controller:this._controllerFactory(e),payload:t[e]&&t[e].payload?t[e].payload:undefined,ignoreColumnKeys:t[e]&&t[e].ignoreColumnKeys?t[e].ignoreColumnKeys:[],triggerModelChangeOnColumnInvisible:t[e]&&t[e].triggerModelChangeOnColumnInvisible?t[e].triggerModelChangeOnColumnInvisible:undefined,createMessageStrip:t[e]&&t[e].createMessageStrip?t[e].createMessageStrip:undefined};if(e=="columns"){this._oSettingCurrent.columns.stableColumnKeys=t.stableColumnKeys}},this)};P.prototype._mixSetting=function(t,n){if(!n){return t}if(n.useAvailablePanels===false){const i={useAvailablePanels:false};for(const a in n){if(n[a]){i[a]=e(i[a],t[a])}}return i}return e({},t,n)};P.prototype.openLegacyDialog=function(t){this._suspendTable();this._prepareDialogUi();var e=this._mixSetting(this._oSettingCurrent,t);this._bCancelPressed=false;this._oDialog=new y(this.getId()+"-P13nDialog",{stretch:b.system.phone,showReset:t&&t.showReset!==undefined?t.showReset:true,showResetEnabled:{path:"$sapuicomppersonalizationBaseController>/isDirty"},initialVisiblePanelType:this._oInitialVisiblePanelType,validationExecutor:function(){var t=p.getTableType(this.getTable());var n=this._oColumnHelper.getColumnMap();var i=this._callControllers(e,"getUnionData",this._getControlDataInitial(),this._getControlDataReduce());return D.checkGroupAndColumns(t,e,n,i,[]).then(function(n){var i=this._callControllers(e,"getUnionData",this._getControlDataBase(),this._getControlDataReduce());var a=this._callControllers(e,"getUnionData",this._getControlDataInitial(),i);var o=this._callControllers(e,"getChangeData",a,this._getAlreadyKnownPersistentData());return D.checkSaveChanges(t,e,o,n)}.bind(this)).then(function(n){return D.checkChartConsistency(t,e,i,n)}).then(function(t){return t})}.bind(this)});this._oDialog.setModel(this._getInternalModel(),"$sapuicomppersonalizationBaseController");this._oDialog.toggleStyleClass("sapUiSizeCompact",!!jQuery(this.getTable().getDomRef()).closest(".sapUiSizeCompact").length);if(t&&t.contentWidth){this._oDialog.setContentWidth(t.contentWidth)}if(t&&t.contentHeight){this._oDialog.setContentHeight(t.contentHeight)}if(t&&t.styleClass){this._oDialog.addStyleClass(t.styleClass)}this._callControllers(this._oSettingCurrent,"setMessageStrip");var n=this._callControllers(e,"getPanel");var i=[];for(var a in n){if(n[a]){i.push(n[a])}}Promise.all(i).then(function(t){t.forEach(function(t){this._oDialog.addPanel(t)},this);this._oDialog.attachOk(this._handleDialogOk,this);this._oDialog.attachCancel(this._handleDialogCancel,this);this._oDialog.attachReset(this._handleDialogReset,this);this._oDialog.attachAfterClose(this._handleDialogAfterClose,this);this._oDialog.isPopupAdaptationAllowed=function(){return false};this._oDialog.setEscapeHandler(function(){this._handleDialogCancel().bind(this)}.bind(this));this._oDialog.open();this.fireDialogAfterOpen()}.bind(this))};P.prototype.getUISettings=function(){var t=this._oUISetting;var e=this._callControllers(t,"retrieveAdaptationUI");var n={resetEnabled:t.showReset,contentHeight:t.contentHeight,contentWidth:t.contentWidth};var a=[];var o=Object.keys(e);var r=i.getResourceBundleFor("sap.ui.mdc");var s={columns:r.getText("p13nDialog.TAB_Column"),dimeasure:r.getText("p13nDialog.TAB_Chart"),filter:r.getText("p13nDialog.TAB_Filter"),sort:r.getText("p13nDialog.TAB_Sort"),group:r.getText("p13nDialog.TAB_Group"),selection:r.getText("info.SELECTION_DIALOG_ALIGNEDTITLE")};var l=this._callControllers(t,"getResetWarningText");o.forEach(function(t){var i=s[t];var o=e[t];n[t]={resetEnabled:true,adaptationUI:o instanceof Promise?o:Promise.resolve(),reset:{warningText:l[t]},containerSettings:{title:i,tabText:i,contentHeight:n.contentHeight,contentWidth:n.contentWidth}};a.push(e[t])},this);Promise.all(a).then(function(t){this._callControllers(this._oSettingCurrent,"setModelFunction")}.bind(this));return n};P.prototype.initAdaptation=function(){return Promise.resolve()};P.prototype.reset=function(e,n){this._resetMessageStrip();return new Promise(function(n){this.resetPersonalization();this._syncDialogUi();this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",this._getControlDataBase());for(var i in this._oSettingCurrent){var a=this._oSettingCurrent[i].controller;if(a&&a.getAdaptationUI()&&a.getAdaptationUI().setP13nData){a.getAdaptationUI().setP13nData(a.getAdaptationData())}}return new Promise(function(n){if(e){S.load("sap.ui.fl",{async:true}).then(function(){sap.ui.require(["sap/ui/comp/navpopover/FlexConnector"],function(i){return i.discardChangesForControl(e._container).then(function(){n(true)},function(e){t.error("Changes could not be discarded in LRep: "+e);n(false)})})})}else{n(false)}}).then(function(){this._syncDialogUi();for(var t in this._oSettingCurrent){var e=this._oSettingCurrent[t].controller;if(e&&e.getAdaptationUI()&&e.getAdaptationUI().setP13nData){e.getAdaptationUI().setP13nData(e.getAdaptationData())}}n()}.bind(this))}.bind(this))};P.prototype.validateP13n=function(t,e,n){var i=p.getTableType(this.getTable());var a=this._oColumnHelper.getColumnMap();var o=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),this._getControlDataReduce());return D.checkGroupAndColumns(i,this._oSettingCurrent,a,o,[]).then(function(t){return D.checkChartConsistency(i,this._oSettingCurrent,o,t)}.bind(this)).then(function(t){return D.checkVisibleItemsThreshold(i,this._oSettingCurrent,o,t)}.bind(this)).then(function(t){return D.checkValidChartType(i,this._oSettingCurrent,o,t)}.bind(this)).then(function(t){if(t.length>0){t.forEach(function(t){for(var e in this._oSettingCurrent){var n=this._oSettingCurrent[e].controller;if(t.panelTypes.indexOf(e)>-1&&n){n.getAdaptationUI().setMessageStrip(new d({type:t.messageType,text:t.messageText}))}}}.bind(this))}else{this._resetMessageStrip()}}.bind(this))};P.prototype.preparePersonalization=function(){this._prepareDialogUi()};P.prototype.openDialog=function(t){var e;this._suspendTable();this._prepareDialogUi();this._oUISetting=this._mixSetting(this._oSettingCurrent,t);if(this._oUISetting&&this._oUISetting.showReset!==undefined){e={showReset:this._oUISetting.showReset}}this._callControllers(this._oSettingCurrent,"setMessageStrip");var n=Object.keys(this._getControllers());var i=Object.assign([],n);if(t&&t.useAvailablePanels===false){var a=Object.keys(t);n.forEach(function(t,e){if(a.indexOf(t)<0){i.splice(i.indexOf(t),1)}})}if(!e&&i&&i.length===1&&this._aAvailablePanels&&this._aAvailablePanels.indexOf(i[0])>-1){e={showReset:false}}return S.load("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(t,e){sap.ui.require(["sap/ui/comp/personalization/UIManager","sap/ui/comp/config/condition/DateRangeType"],function(e,n){t(e)},e)})}).then(function(n){if(!this._oUIManager){this._oUIManager=new n(this)}if(this._sActivePanel&&i.includes(this._sActivePanel)){e??={};e.activePanel??=this._sActivePanel}return this._oUIManager.show(this.getTable(),i,e).then(function(e){if(e.getCustomHeader()){var n=e.getCustomHeader().getContentRight()[0];if(n){n.bindProperty("enabled",{model:"$sapmP13nPanel",path:"/isDirty",formatter:function(t){return!!t}})}}e.getButtons()[1].attachPress(this._handleDialogCancel,this);e.attachAfterClose(this._handleDialogAfterClose,this);if(i.length>1&&this._sActivePanel){e.getContent()[0].switchView(this._sActivePanel)}if(t&&t.styleClass){e.addStyleClass(t.styleClass)}e.setModel(this._getInternalModel(),"$sapmP13nPanel");this._oDialog=e;this.fireDialogAfterOpen();return e}.bind(this))}.bind(this))};P.prototype.addColumns=function(t){var e=this.getTable();Object.keys(t).forEach(function(n){if(!t[n].getParent()){e.addDependent(t[n])}});this._oColumnHelper.addColumnMap(t)};P.prototype.getDataSuiteFormatSnapshot=function(){this._callControllers(this._oSettingCurrent,"calculateControlData");var t={};this._callControllers(this._oSettingCurrent,"getDataSuiteFormatSnapshot",t);return t};P.prototype.setDataSuiteFormatSnapshot=function(t,e,n){if(n){p.convertSelectOptions(t,this._oColumnHelper.getColumnMap());p.convertFilters(e,this._oColumnHelper.getColumnMap())}var i=this._callControllers(this._oSettingCurrent,"getDataSuiteFormat2Json",t);this._setRuntimeAndPersonalizationData(i,e)};P.prototype.setPersonalizationDataAsDataSuiteFormat=function(t,e){if(e){p.convertSelectOptions(t,this._oColumnHelper.getColumnMap())}var n=this._callControllers(this._oSettingCurrent,"getDataSuiteFormat2Json",t);this._setRuntimeAndPersonalizationData(n,n)};P.prototype.setPersonalizationData=function(t,e){this._extendModelStructure(this._requestMissingColumnsWithoutIgnore(t));if(e){p.convertFilters(t,this._oColumnHelper.getColumnMap())}this._setRuntimeAndPersonalizationData(t,t)};P.prototype._resetFilters=function(t){var e,n,i,a=this._oSettingCurrent&&this._oSettingCurrent.filter&&this._oSettingCurrent.filter.controller,o=this._getVariantData()&&this._getVariantData().filter&&this._getVariantData().filter.filterItems||[],r=this._getControlDataInitial()&&this._getControlDataInitial().filter&&this._getControlDataInitial().filter.filterItems;if(a){n=a.oFilterProvider;i=a.oFilterPanel}if(i&&this._oDialog&&this._oDialog.isOpen()){if(t){if(!this._getControlDataInitial()){if(n){n.clear()}e=e.map(function(t){t.active=false;return t});i.setP13nData(e)}else{this._resetToState(r,n,a,i)}}else{this._resetToState(o,n,a,i)}}};P.prototype._resetToState=function(t,e,n,i){var a,o,r,s,l,h,u,g,c=i.getP13nData();if(c&&t){for(a=0;a<c.length;a++){s=c[a];h=s.name;g=n._getFilterPropertyFromColumn(h);s.active=false;u=n._getControlByName(h);if(e){if(g&&g.includes("/")){l=e._oMetadataAnalyser.extractNavigationPropertyField(g,e.sEntitySet);l=e._createFieldMetadata(l)}else{l=e._getFieldMetadata(g)}if(l&&!l.control&&u){l.control=u}e._createInitialModelForField(e.getFilterData(),l)}if(u){if(u.setValue){u.setValue(null)}if(u.setTokens){u.setTokens([])}}for(o=0;o<t.length;o++){r=t[o];if(r.columnKey===h){s.active=true;break}}}i.setP13nData(c);if(e){n._updateFilterData(t)}else{n._updateBasicFilters(t)}}};P.prototype.resetPersonalization=function(t){t=this._determineResetType(t);if(t===r.personalization.ResetType.ResetFull){this._resetFull();this._resetFilters(true)}else{this._resetPartial();this._resetFilters(false)}this._setRuntimeAndPersonalizationData(this._getControlDataBase(),this._getVariantData(),true)};P.prototype.addToSettingIgnoreColumnKeys=function(t){if(this._isEqualAdditionalIgnoreColumnKeys(t)){return this}this._callControllers(this._oSettingCurrent,"setAdditionalIgnoreColumnKeys",t);this._callControllers(this._oSettingCurrent,"calculateIgnoreData");this._requestMissingColumnsWithoutIgnore(this._getControlDataBase());this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent();return this};P.prototype._handleDialogReset=function(){this._bUnconfirmedResetPressed=true;var t=this._determineResetType();if(t===r.personalization.ResetType.ResetFull){this._resetFull()}else{this._resetPartial()}this._syncDialogUi()};P.prototype._handleDialogOk=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.detachOk(this._handleDialogOk,this)}if(this._bUnconfirmedResetPressed){this.fireDialogConfirmedReset()}setTimeout(function(){this._postDialogUi(this._getControlDataReduce());this._syncTableUi();var t=function(t){var e=false;for(var n in this._oSettingCurrent){e=e||t.getParameter("runtimeDeltaDataChangeType")[n]==="ModelChanged";if(e){break}}var i=!e;this._resumeTable(i)};this.attachEventOnce("afterP13nModelDataChange",t,this);this._fireChangeEvent()}.bind(this),0);if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.close()}};P.prototype.handleP13n=function(){return new Promise(function(t){var e=this._oDialog.getContent()[0];if(e.isA("sap.m.p13n.Container")){this._sActivePanel=e.getCurrentViewKey()}var n=p.getTableType(this.getTable());var i=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataBase(),this._getControlDataReduce());var a=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),i);var o=this._callControllers(this._oSettingCurrent,"getChangeData",a,this._getAlreadyKnownPersistentData());this._handleDialogOk(true);return D.checkSaveChanges(n,this._oSettingCurrent,o,[]).then(function(){t()})}.bind(this))};P.prototype._handleDialogCancel=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.detachCancel(this._handleDialogCancel,this)}setTimeout(function(){this._postDialogUi(this._getBeforeOpenData());this._resumeTable(false);this._callControllers(this._oSettingCurrent,"calculateControlData")}.bind(this),0);this._bCancelPressed=true;if(this._oDialog.isA("sap.m.P13nDialog")){this._oDialog.close()}};P.prototype._handleDialogAfterClose=function(){if(this._oDialog.isA("sap.m.P13nDialog")){this._oInitialVisiblePanelType=this._oDialog.getVisiblePanel()?this._oDialog.getVisiblePanel().getType():this._getInitialVisiblePanelType()}this._bUnconfirmedResetPressed=false;this.fireDialogAfterClose({cancel:this._bCancelPressed});if(this._oDialog){this._oDialog.destroy();this._oDialog=null}};P.prototype._getInitialVisiblePanelType=function(){for(var t in this._oSettingCurrent){return t}};P.prototype._suspendTable=function(){if(p.getTableBaseType(this.getTable())===r.personalization.TableType.Table){this._bSuspend=true}};P.prototype._resumeTable=function(t){t=t===undefined?true:t;var e=this.getTable();if(this._bSuspend){if(e){if(t){e.invalidate()}}this._bSuspend=false}};P.prototype._requestMissingColumnsWithoutIgnore=function(t){var e=this._callControllers(this._oSettingCurrent,"determineMissingColumnKeys",t);var n=p.getUnionOfColumnKeys(e);if(!n.length){return[]}this.fireRequestColumns({columnKeys:n});return n};P.prototype._extendModelStructure=function(t){if(!t.length){return}var e=this._callControllers(this._oSettingCurrent,"createColumnKeysStructure",t);var n=this._callControllers(this._oSettingCurrent,"getTable2Json",e);this._callControllers(this._oSettingCurrent,"extendControlDataInitial",n);this._callControllers(this._oSettingCurrent,"extendVariantDataInitial",n);this._callControllers(this._oSettingCurrent,"extendControlDataBase",n);this._callControllers(this._oSettingCurrent,"extendAlreadyKnownRuntimeData",n);this._callControllers(this._oSettingCurrent,"extendAlreadyKnownPersistentData",n)};P.prototype._setRuntimeAndPersonalizationData=function(t,e,n){t=t===null?{}:t;if(!this._sanityCheck(t)){return}e=e===null?{}:e;if(!this._sanityCheck(e)){return}if(typeof t?.columns?.fixedColumnCount==="undefined"&&typeof e?.columns?.fixedColumnCount!=="undefined"){t.columns.fixedColumnCount=e.columns.fixedColumnCount}if(typeof t?.columns?.showDetails==="undefined"&&typeof e?.columns?.showDetails!=="undefined"){t.columns.showDetails=e.columns.showDetails}this._setVariantData(e);this._extendModelStructure(this._requestMissingColumnsWithoutIgnore(t));var i=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),e);this._callControllers(this._oSettingCurrent,"setVariantDataInitial2Model",i);var a=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),t);this._callControllers(this._oSettingCurrent,"fixConflictWithIgnore",a,this._getIgnoreData());this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",a);for(var o in this._oSettingCurrent){this._calculateChangeType(o,a)}this._suspendTable();this._syncTableUi();this._resumeTable(true);this._fireChangeEvent(null,n)};P.prototype._prepareDialogUi=function(){var t=this._callControllers(this._oSettingCurrent,"createColumnKeysStructure",this.getColumnKeys());this._extendModelStructure(this._requestMissingColumnsWithoutIgnore(t));this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",this._getControlDataBase());this._callControllers(this._oSettingCurrent,"calculateControlDataReduce");var e=this._callControllers(this._oSettingCurrent,"getTable2JsonTransient",t);this._callControllers(this._oSettingCurrent,"calculateTransientData",e);this._callControllers(this._oSettingCurrent,"calculatePropertyInfo",e)};P.prototype._postDialogUi=function(t){this._callControllers(this._oSettingCurrent,"updateControlDataBaseFromJson",t);this._callControllers(this._oSettingCurrent,"setBeforeOpenData2Model",undefined);this._callControllers(this._oSettingCurrent,"setControlDataReduce2Model",undefined);this._callControllers(this._oSettingCurrent,"setTransientData2Model",undefined)};P.prototype._syncDialogUi=function(){this._callControllers(this._oSettingCurrent,"calculateControlDataReduce")};P.prototype._syncTableUi=function(){this._callControllers(this._oSettingCurrent,"calculateControlData");this._callControllers(this._oSettingCurrent,"syncJson2Table",this._getControlData())};P.prototype._resetFull=function(){this._setVariantData(undefined);this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",this._getControlDataInitial())};P.prototype._resetPartial=function(){this._callControllers(this._oSettingCurrent,"setControlDataBase2Model",this._getVariantDataInitial())};P.prototype._calculateChangeType=function(t,e){var n={};n[t]=this._oSettingCurrent[t];this._callControllers(n,"calculatePersistentChangeTypesFromJson",e,this._determineResetType());var i=this._getPersistentDataChangeType();var a=false;for(t in this._oSettingCurrent){if(i[t]!==r.personalization.ChangeType.Unchanged){a=true}}this._setIsDirty(a)};P.prototype._fireChangeEvent=function(t,e){var n={};var i=this._callControllers(this._oSettingCurrent,"getUnionData",this._getControlDataInitial(),this._getControlData());n.runtimeDeltaDataChangeType=this._callControllers(this._oSettingCurrent,"getChangeType",i,this._getAlreadyKnownRuntimeData());n.persistentDeltaDataChangeType=this._getPersistentDeltaDataChangeType();n.persistentDataChangeType=this._getPersistentDataChangeType();if(!p.hasChangedType(n.runtimeDeltaDataChangeType)&&!p.hasChangedType(n.persistentDeltaDataChangeType)){return}var a=this._callControllers(this._oSettingCurrent,"getChangeData",i,this._getAlreadyKnownRuntimeData());n.runtimeDeltaData=p.removeEmptyProperty(p.copy(a));var o=this._callControllers(this._oSettingCurrent,"getChangeData",this._getControlDataBase(),this._getControlDataInitial());n.persistentData=p.removeEmptyProperty(o);this._callControllers(this._oSettingCurrent,"setAlreadyKnownRuntimeData2Model",this._getControlData());this._callControllers(this._oSettingCurrent,"setAlreadyKnownPersistentData2Model",this._getControlDataBase());delete n.persistentDeltaDataChangeType;if(!n){n={}}n._bTriggeredFromReset=!!e;this.fireAfterP13nModelDataChange(n)};P.prototype._onSetVisible=function(t,e){if(t){var n=p.getUnionOfAttribute(this._oSettingCurrent,"ignoreColumnKeys");if(n.indexOf(e)>-1){throw"The provided 'ignoreColumnKeys' are inconsistent. No column specified as ignored is allowed to be visible. "+this}}};P.prototype._onSetSummed=function(t,e){this._oSettingCurrent.columns.controller._onColumnTotal({column:e,isSummed:t})};P.prototype._onSetGrouped=function(t,e){this._oSettingCurrent.group.controller._setGroup(t,e)};P.prototype._getArgumentsByType=function(t,e){var n=[],i=null;if(t&&t.length&&e){t.forEach(function(t){if(t&&t[e]&&typeof t[e]!=="function"){i={};i[e]=t[e];n.push(i)}else{n.push(t)}})}return n};P.prototype._callControllers=function(t,e){var n,i,a;var o={},r=Array.prototype.slice.call(arguments,2);for(var s in t){n=i=a=null;n=t[s];i=n.controller;if(!i||!n.visible||!i[e]){continue}a=this._getArgumentsByType(r,s);if(e==="getPanel"||e==="retrieveAdaptationUI"){a.push(n.payload)}else if(e==="setIgnoreColumnKeys"){a.push(n.ignoreColumnKeys)}else if(e==="setTriggerModelChangeOnColumnInvisible"){a.push(n.triggerModelChangeOnColumnInvisible)}if(e==="setStableColumnKeys"&&s=="columns"){a.push(t.columns.stableColumnKeys)}if(e==="setMessageStrip"&&n.createMessageStrip){var l=n.createMessageStrip();a.push(l)}var h=i[e].apply(i,a);if(h!==null&&h!==undefined&&h[s]!==undefined){o[s]=h[s]}else{o[s]=h}}return o};P.prototype._sanityCheck=function(t){return true};P.prototype._createInternalModel=function(t){var e=new m;e.setDefaultBindingMode(T.TwoWay);e.setSizeLimit(1e4);this.setModel(e,"$sapuicomppersonalizationBaseController");return e};P.prototype._getInternalModel=function(){return this.getModel("$sapuicomppersonalizationBaseController")};P.prototype._getInternalModelData=function(t){return this._getInternalModel().getProperty("/"+t)};P.prototype._getControlDataInitial=function(){return this._getInternalModelData("controlDataInitial")};P.prototype._getControlDataBase=function(){return this._getInternalModelData("controlDataBase")};P.prototype._getIgnoreData=function(){return this._getInternalModelData("ignoreData")};P.prototype._getPersistentDataChangeType=function(){return this._getInternalModelData("persistentDataChangeType")};P.prototype._getPersistentDeltaDataChangeType=function(){return this._getInternalModelData("persistentDeltaDataChangeType")};P.prototype._getControlData=function(){return this._getInternalModelData("controlData")};P.prototype._getControlDataReduce=function(){return this._getInternalModelData("controlDataReduce")};P.prototype._getTransientData=function(){return this._getInternalModelData("transientData")};P.prototype._getAlreadyKnownRuntimeData=function(){return this._getInternalModelData("alreadyKnownRuntimeData")};P.prototype._getAlreadyKnownPersistentData=function(){return this._getInternalModelData("alreadyKnownPersistentData")};P.prototype._getVariantDataInitial=function(){return this._getInternalModelData("variantDataInitial")};P.prototype._getBeforeOpenData=function(){return this._getInternalModelData("beforeOpenData")};P.prototype._setVariantData=function(t){this._getInternalModel().setProperty("/variantData",t?p.copy(t):undefined)};P.prototype._setIsDirty=function(t){this._getInternalModel().setProperty("/isDirty",t)};P.prototype._getVariantData=function(){return this._getInternalModel().getProperty("/variantData")};P.prototype._getControllers=function(){var t={};Object.keys(this._oSettingCurrent).forEach(function(e){var n=this._oSettingCurrent[e];if(n.hasOwnProperty("controller")){t[e]=n}}.bind(this));return t};P.prototype._controllerFactory=function(t){var e=this;switch(t){case o.P13nPanelType.columns:return new s({afterColumnsModelDataChange:function(){var t=this.mEventRegistry.afterColumnsModelDataChange[0].fFunction;this.detachAfterColumnsModelDataChange(t);e._syncTableUi();this.attachAfterColumnsModelDataChange(t);e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case o.P13nPanelType.sort:return new u({afterSortModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case o.P13nPanelType.filter:return new l({afterFilterModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case o.P13nPanelType.group:return new h({afterGroupModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case o.P13nPanelType.dimeasure:return new g({afterDimeasureModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});case o.P13nPanelType.selection:return new c({afterSelectionModelDataChange:function(){e._fireChangeEvent()},beforePotentialTableChange:function(){e.fireBeforePotentialTableChange()},afterPotentialTableChange:function(){e.fireAfterPotentialTableChange()},afterPotentialModelChange:function(n){e._calculateChangeType(t,n.getParameter("json"))}});default:throw"Panel type '"+t+"' is not valid"}};P.prototype.getTable=function(){var t=this.getAssociation("table");if(typeof t==="string"){t=n.getElementById(t)}return t};P.prototype.getColumnMap=function(){return this._oColumnHelper?.getColumnMap()};P._getOrderedColumnKeys=function(t,e){var n=Object.keys(t);return e.reduce(function(t,e){if(n.indexOf(e)>-1){t.push(e)}return t},[])};P.prototype.exit=function(){var t;this._resumeTable(false);if(this._oDialog){this._oDialog.destroy();this._oDialog=null}if(this._oUIManager){this._oUIManager.destroy();this._oUIManager=null}this._oUISetting=null;this._callControllers(this._oSettingCurrent,"destroy");for(t in this._oSettingCurrent){this._oSettingCurrent[t]=null}this._oSettingCurrent=null;this._oColumnHelper=null};P.prototype._determineResetType=function(t){t=t||(this.getResetToInitialTableState()?r.personalization.ResetType.ResetFull:r.personalization.ResetType.ResetPartial);if(t===r.personalization.ResetType.ResetFull||this._getVariantData()===undefined){return r.personalization.ResetType.ResetFull}return r.personalization.ResetType.ResetPartial};P.prototype._isEqualAdditionalIgnoreColumnKeys=function(t){var e=this._callControllers(this._oSettingCurrent,"isEqualAdditionalIgnoreColumnKeys",t);var n=true;for(var i in e){n=n&&e[i]}return n};P.prototype._resetMessageStrip=function(t){for(var e in this._oSettingCurrent){var n=this._oSettingCurrent[e].controller;if(n&&n.getAdaptationUI()&&n.getAdaptationUI().isA("sap.m.p13n.BasePanel")){n.getAdaptationUI().setMessageStrip(undefined)}}};P.prototype._setShowDetails=function(t){this._callControllers(this._oSettingCurrent,"_updateInternalModelShowHide",t)};P.SyncReason={ResetFull:14,ResetPartial:15,NewModelDataMixedWithVariant:7};return P});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/DimeasureController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/comp/odata/ChartMetadata","sap/m/MessageStrip","sap/ui/core/Lib"],function(e,t,i,r,a,n,o){"use strict";var s=e.extend("sap.ui.comp.personalization.DimeasureController",{constructor:function(i,r){e.apply(this,arguments);this.setType(t.P13nPanelType.dimeasure);this.setItemType(t.P13nPanelType.dimeasure+"Items");this.CHARTLAYOUT_AXIS1="axis1";this.CHARTLAYOUT_AXIS2="axis2";this.CHARTLAYOUT_AXIS3="axis3";this.CHARTLAYOUT_CATEGORY="category";this.CHARTLAYOUT_CATEGORY2="category2";this.CHARTLAYOUT_SERIES="series"},metadata:{events:{afterDimeasureModelDataChange:{}}}});s.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()!==i.personalization.TableType.ChartWrapper){throw"The provided object is incorrect. 'oTable' has to be an instance of sap.ui.comp.personalization.ChartWrapper. "}var r=t.getChartObject();r.detachDrilledDown(this._onDrilledDown,this);r.attachDrilledDown(this._onDrilledDown,this);r.detachDrilledUp(this._onDrilledUp,this);r.attachDrilledUp(this._onDrilledUp,this);this._monkeyPatchTable(r)};s.prototype._monkeyPatchTable=function(e){var t=this;var i=e.setChartType.bind(e);var r=function(e){i(e);t._onSetChartType(e)};if(e.setChartType.toString()===r.toString()){return}e.setChartType=r};s.prototype._onSetChartType=function(e){var t=this.getControlData();if(!e||e===t.dimeasure.chartTypeKey){return}this.fireBeforePotentialTableChange();t.dimeasure.chartTypeKey=e;this.updateControlDataBaseFromJson(t);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};s.prototype._onDrilledDown=function(e){this.fireBeforePotentialTableChange();this._addVisibleDimensions(e.getParameter("dimensions")||[]);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};s.prototype._addVisibleDimensions=function(e){if(!e.length){return}var t=this.getControlData();if(t&&t.dimeasure&&t.dimeasure.dimeasureItems){t.dimeasure.dimeasureItems.sort(function(e,t){return e.index-t.index})}var a=t.dimeasure.dimeasureItems.filter(function(t){return t.visible&&t.aggregationRole===i.personalization.AggregationRole.Dimension&&e.indexOf(t.columnKey)<0}).reduce(function(e,t){return t.columnKey},"");e.forEach(function(e){var i=r.getIndexByKey("columnKey",a,t.dimeasure.dimeasureItems)+1;var n=r.getIndexByKey("columnKey",e,t.dimeasure.dimeasureItems);a=e;if(n<0||i<0||n>t.dimeasure.dimeasureItems.length-1||i>t.dimeasure.dimeasureItems.length-1){return}var o=t.dimeasure.dimeasureItems.splice(n,1);o[0].visible=true;t.dimeasure.dimeasureItems.splice(i,0,o[0]);var s=-1;t.dimeasure.dimeasureItems.forEach(function(e){if(e.index!==undefined){e.index=++s}});this.updateControlDataBaseFromJson(t)},this)};s.prototype._onDrilledUp=function(e){this.fireBeforePotentialTableChange();var t=this.getControlData();var i=e.getParameter("dimensions")||[];i.forEach(function(e){var i=r.getArrayElementByKey("columnKey",e,t.dimeasure.dimeasureItems);if(!i){throw"No entry found in 'controlDataBase' for columnKey '"+e+"'"}i.visible=false;this.updateControlDataBaseFromJson(t)},this);this.fireAfterPotentialTableChange();this.fireAfterDimeasureModelDataChange()};s.prototype.getColumn2Json=function(e,t,i){if(!r.isAggregatable(e)){return null}return{columnKey:t,index:i,visible:e.getVisible(),role:e.getRole(),aggregationRole:e.getAggregationRole()}};s.prototype.getAdditionalData2Json=function(e,t){var i=t.getChartObject();e.dimeasure.chartTypeKey=i.getChartType()};s.prototype.getColumn2JsonTransient=function(e,t,i,a){if(!r.isAggregatable(e)){return null}return{columnKey:t,text:i,tooltip:a!==i?a:undefined,aggregationRole:e.getAggregationRole()}};s.prototype.handleIgnore=function(e,t){e.dimeasure.dimeasureItems[t].visible=false};s.prototype.syncJson2Table=function(e){var t=this.getTable().getChartObject();var a=function(e,t,i,a){var n=r.copy(e);n.sort(s._sortByIndex);var o=[];n.forEach(function(e){if(e.visible===true){o.push(e.columnKey);var t=a(e.columnKey);if(t){t.setRole(e.role)}}});if(JSON.stringify(o)!==JSON.stringify(t)){i(o,true,true)}};this.fireBeforePotentialTableChange();var n=e.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Dimension});var o=e.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Measure});var u=t.getVisibleDimensions();a(n,u,t.setVisibleDimensions.bind(t),t.getDimensionByName.bind(t));var l=t.getVisibleMeasures();a(o,l,t.setVisibleMeasures.bind(t),t.getMeasureByName.bind(t));t.setChartType(e.dimeasure.chartTypeKey);this.fireAfterPotentialTableChange()};s.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();var n=function(e,i,a){var n=r.getIndexByKey("columnKey",e,t.dimeasure.dimeasureItems);if(n<0){n=t.dimeasure.dimeasureItems.length;t.dimeasure.dimeasureItems.splice(n,0,{columnKey:e})}t.dimeasure.dimeasureItems[n][i]=a};this.getControlDataInitial().dimeasure.dimeasureItems.filter(function(e){return e.visible===true}).forEach(function(e){n(e.columnKey,"visible",false)});if(e.Visualizations&&e.Visualizations.length){var o=e.Visualizations.filter(function(e){return e.Type==="Chart"});if(o.length){var s=0;if(o[0].Content.Dimensions.length){s=o[0].Content.Dimensions.length;o[0].Content.Dimensions.forEach(function(e,t){var s=r.getArrayElementByKey("Dimension",e,o[0].Content.DimensionAttributes);n(e,"visible",true);n(e,"index",t);if(s&&s.Role){n(e,"role",a.getDimensionRole(s.Role))}n(e,"aggregationRole",i.personalization.AggregationRole.Dimension)},this)}if(o[0].Content.Measures.length){o[0].Content.Measures.forEach(function(e,t){var u=r.getArrayElementByKey("Measure",e,o[0].Content.MeasureAttributes);n(e,"visible",true);n(e,"index",s+t);if(u&&u.Role){n(e,"role",a.getMeasureRole(u.Role))}n(e,"aggregationRole",i.personalization.AggregationRole.Measure)},this)}}t.dimeasure.chartTypeKey=a.getChartType(o[0].Content.ChartType)}return t};s.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.dimeasure||!t.dimeasure.dimeasureItems||!t.dimeasure.dimeasureItems.length){return}var r=t.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Dimension}).filter(function(e){return e.visible===true});var n=t.dimeasure.dimeasureItems.filter(function(e){return e.aggregationRole===i.personalization.AggregationRole.Measure}).filter(function(e){return e.visible===true});if(r.length||n.length){if(!e.Visualizations){e.Visualizations=[]}e.Visualizations.push({Type:"Chart",Content:{ChartType:a.getAnnotationChartType(t.dimeasure.chartTypeKey),Dimensions:r.sort(function(e,t){return e.index-t.index}).map(function(e){return e.columnKey}),DimensionAttributes:r.sort(function(e,t){return e.index-t.index}).map(function(e){return{Dimension:e.columnKey,Role:a.getAnnotationDimensionRole(e.role)}}),Measures:n.sort(function(e,t){return e.index-t.index}).map(function(e){return e.columnKey}),MeasureAttributes:n.sort(function(e,t){return e.index-t.index}).map(function(e){return{Measure:e.columnKey,Role:a.getAnnotationMeasureRole(e.role)}})}})}};s.prototype.getChartTypeLayoutConfig=function(){if(this._aChartTypeLayout){return this._aChartTypeLayout}var e=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];var t=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];var i=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_CATEGORY2];var r=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_AXIS3,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];this._aChartTypeLayout=[{key:"column",allowedLayoutOptions:e},{key:"bar",allowedLayoutOptions:e},{key:"line",allowedLayoutOptions:e},{key:"combination",allowedLayoutOptions:e},{key:"pie",allowedLayoutOptions:e},{key:"donut",allowedLayoutOptions:e},{key:"dual_column",allowedLayoutOptions:t},{key:"dual_bar",allowedLayoutOptions:t},{key:"dual_line",allowedLayoutOptions:t},{key:"stacked_bar",allowedLayoutOptions:e},{key:"scatter",allowedLayoutOptions:t},{key:"bubble",allowedLayoutOptions:r},{key:"heatmap",allowedLayoutOptions:i},{key:"bullet",allowedLayoutOptions:e},{key:"vertical_bullet",allowedLayoutOptions:e},{key:"dual_stacked_bar",allowedLayoutOptions:t},{key:"100_stacked_bar",allowedLayoutOptions:e},{key:"stacked_column",allowedLayoutOptions:e},{key:"dual_stacked_column",allowedLayoutOptions:t},{key:"100_stacked_column",allowedLayoutOptions:e},{key:"dual_combination",allowedLayoutOptions:t},{key:"dual_horizontal_combination",allowedLayoutOptions:t},{key:"dual_horizontal_combination",allowedLayoutOptions:t},{key:"dual_stacked_combination",allowedLayoutOptions:t},{key:"dual_horizontal_stacked_combination",allowedLayoutOptions:t},{key:"stacked_combination",allowedLayoutOptions:e},{key:"100_dual_stacked_bar",allowedLayoutOptions:e},{key:"100_dual_stacked_column",allowedLayoutOptions:e},{key:"horizontal_stacked_combination",allowedLayoutOptions:e},{key:"waterfall",allowedLayoutOptions:i},{key:"horizontal_waterfall",allowedLayoutOptions:i}];return this._aChartTypeLayout};s.prototype._getTimeseriesSpecificPanelLayout=function(e){if(e.includes("timeseries")){var t=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_SERIES];this._aChartTypeLayoutTimeseries=[{key:"timeseries_scatter",allowedLayoutOptions:t}];var i=this._aChartTypeLayoutTimeseries.find(function(t){return t.key===e});if(i){return i}else{var r=e.replace("timeseries_","");return this.getChartTypeLayoutConfig().find(function(e){return e.key===r})}}return undefined};s.prototype.isChartTypeValid=function(){if(!this.oPanel){return{valid:true,errorMessage:""}}const e=this.oPanel._validateChartType();const t=this.oPanel.getErrorConfig()?.chartType;const i=this.oPanel.getErrorMessage(t,e.error);return{valid:e.valid,errorMessage:i}};s.prototype.retrieveAdaptationUI=function(e){function t(e,t){if(!e.hasOwnProperty("index")||!t.hasOwnProperty("index")){return 0}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0}var i;var a=new Promise(function(e,t){i=e});sap.ui.require(["sap/ui/mdc/p13n/panels/ChartItemPanel"],function(e){var a,s=this.getControlDataReduce().dimeasure.chartTypeKey;var u=[{kind:"Dimension"},{kind:"Measure"}];const l=this.getTable().getChartObject(),d=l?.getParent(),y={chartType:s,invalidChartType:d?._bInvalidChartType,errorMessage:d?._sErrorMsg};if(s.includes("timeseries")){a=this._getTimeseriesSpecificPanelLayout(s)}if(!a){a=this.getChartTypeLayoutConfig().find(function(e){return e.key===s})}if(!a){var m=[this.CHARTLAYOUT_AXIS1,this.CHARTLAYOUT_AXIS2,this.CHARTLAYOUT_AXIS3,this.CHARTLAYOUT_CATEGORY,this.CHARTLAYOUT_CATEGORY2,this.CHARTLAYOUT_SERIES];a={key:s,allowedLayoutOptions:m}}a.templateConfig=u;var f=new e({panelConfig:a,errorConfig:y,changeItems:function(e){if(!e.getParameter("items")){return}var t=e.getParameter("items");var i=this.getControlDataReduce();i.dimeasure.dimeasureItems.forEach(function(e){var i=r.getArrayElementByKey("columnKey",e.columnKey,t);if(!i){return}e.index=i.index;e.visible=i.visible;e.role=i.role});this.setControlDataReduce2Model(i);this.fireAfterPotentialModelChange({json:i})}.bind(this)});var h=this.getAdaptationData().sort(t);f.setP13nData(h);this.oPanel=f;if(s==="heatmap"||s==="timeseries_heatmap"){var p=o.getResourceBundleFor("sap.ui.mdc");f.setMessageStrip(new n({text:p.getText("chart.PERSONALIZATION_DIALOG_MEASURE_WARNING"),type:"Warning"}))}i(f)}.bind(this));return a};s.prototype._transformAdaptationData=function(t,i){var r=e.prototype._transformAdaptationData.apply(this,arguments);r.visible=t.visible;r.role=t.role;r.kind=t.aggregationRole;r.index=t.index;return r};s.prototype._isDimMeasureItemEqual=function(e,t){if(!e&&!t){return true}if(e&&!t){if(e.index===-1&&e.visible===false){return true}return false}if(t&&!e){if(t.index===-1&&t.visible===false){return true}return false}for(var i in e){if(t[i]===undefined||e[i]!==t[i]){return false}}return true};s.prototype._isSemanticEqual=function(e,t){if(e.dimeasure.chartTypeKey!==t.dimeasure.chartTypeKey){return false}var i=function(e,t){if(e.visible===true&&(t.visible===false||t.visible===undefined)){return-1}else if((e.visible===false||e.visible===undefined)&&t.visible===true){return 1}else if(e.visible===true&&t.visible===true){if(e.index<t.index){return-1}else if(e.index>t.index){return 1}else{return 0}}else if((e.visible===false||e.visible===undefined)&&(t.visible===false||t.visible===undefined)){if(e.columnKey<t.columnKey){return-1}else if(e.columnKey>t.columnKey){return 1}else{return 0}}};var a=r.copy(e.dimeasure.dimeasureItems).sort(i);var n=r.copy(t.dimeasure.dimeasureItems).sort(i);var o=true;a.some(function(e,t){if(!this._isDimMeasureItemEqual(e,n[t])){o=false;return true}},this);return o};s.prototype.getChangeType=function(e,t){if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return i.personalization.ChangeType.Unchanged}return this._isSemanticEqual(e,t)?i.personalization.ChangeType.Unchanged:i.personalization.ChangeType.ModelChanged};s.prototype.getChangeData=function(e,t){if(!e||!e.dimeasure||!e.dimeasure.dimeasureItems){return this.createControlDataStructure()}if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return{chartTypeKey:e.dimeasure.chartTypeKey,dimeasure:r.copy(e.dimeasure)}}if(!this._isSemanticEqual(e,t)){return{chartTypeKey:e.dimeasure.chartTypeKey,dimeasure:r.copy(e.dimeasure)}}return null};s.prototype.getUnionData=function(e,t){if(!t||!t.dimeasure||!t.dimeasure.dimeasureItems){return r.copy(e)}var i=r.copy(t);Object.keys(e.dimeasure).forEach(function(t){if(Array.isArray(e.dimeasure[t])){e.dimeasure[t].forEach(function(e){var a=r.getArrayElementByKey("columnKey",e.columnKey,i.dimeasure[t]);if(!a){i.dimeasure[t].push(e);return}if(a.visible===undefined&&e.visible!==undefined){a.visible=e.visible}if(a.role===undefined&&e.role!==undefined){a.role=e.role}if(a.index===undefined&&e.index!==undefined){a.index=e.index}if(a.aggregationRole===undefined&&e.aggregationRole!==undefined){a.aggregationRole=e.aggregationRole}});return}if(i.dimeasure[t]===undefined&&e.dimeasure[t]!==undefined){i.dimeasure[t]=e.dimeasure[t]}},this);return i};s._sortByIndex=function(e,t){if(e.index!==undefined&&t.index===undefined){return-1}if(t.index!==undefined&&e.index===undefined){return 1}if(e.index<t.index){return-1}if(e.index>t.index){return 1}return 0};s.prototype.isChartConsistent=function(e){var t=this.getTable();if(!t){return Promise.resolve(true)}var i=t.getChartObject();if(!i){return Promise.resolve(true)}return o.load("sap.chart",{async:true}).then(function(){try{var t=sap.ui.require("sap/chart/library");var r=t.api.getChartTypeLayout(e.dimeasure.chartTypeKey,i.getDimensions(),i.getMeasures());return r.errors.length===0}catch(e){return false}})};s.prototype.exit=function(){e.prototype.exit.apply(this,arguments);var t=this.getTable();if(t){var i=t.getChartObject();if(i){i.detachDrilledDown(this._onDrilledDown,this);i.detachDrilledUp(this._onDrilledUp,this)}}};return s});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/FilterController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/comp/filterbar/VariantConverterTo","sap/ui/comp/filterbar/VariantConverterFrom","sap/base/util/merge","sap/ui/comp/smartfilterbar/FilterProvider","sap/ui/core/Lib","sap/m/p13n/FilterPanel","sap/ui/comp/util/FormatUtil","sap/ui/core/library","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfilterbar/SFBMultiInput","sap/ui/comp/providers/TokenParser","sap/ui/comp/p13n/P13nConditionPanel","sap/m/Token","sap/m/MultiInput","sap/ui/comp/valuehelpdialog/ValueHelpDialog","sap/ui/comp/smartfilterbar/AdditionalConfigurationHelper"],function(e,t,i,a,r,l,o,n,s,u,p,f,d,h,c,m,y,g,F,_){"use strict";var T=f.ValueState;var C=i.smartfilterbar.FilterType;var v=e.extend("sap.ui.comp.personalization.FilterController",{constructor:function(i,a){e.apply(this,arguments);this.setType(t.P13nPanelType.filter);this.setItemType(t.P13nPanelType.filter+"Items");this._aDropdownFields=[];this.aFilterItems=[];this._aSFBMultiInputs=[];this._aFilterPanelFields=[];this._aConditionTypeControls=[];this._aCustomFields=[];this._aCustomColumnKeysWithSlash=[];this.aSFBControlConfig=[];this._aRangeKeyFields=[];this._oResourceBundle=s.getResourceBundleFor("sap.ui.comp");this._bShowCurrentDateButton=false},metadata:{events:{afterFilterModelDataChange:{}}}});v.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments)};v.prototype.getColumn2Json=function(e,t,r){if(this.getTableType()!==i.personalization.TableType.AnalyticalTable&&this.getTableType()!==i.personalization.TableType.Table&&this.getTableType()!==i.personalization.TableType.TreeTable){return null}if(!a.isFilterable(e)){return null}if(!e.getFiltered||e.getFiltered&&!e.getFiltered()){return null}return{columnKey:t,exclude:false,operation:e.getFilterOperator(),value1:e.getFilterValue(),value2:""}};v.prototype.getColumn2JsonTransient=function(e,t,r,l){if(!a.isFilterable(e)){return null}var o;if(this.getTableType()===i.personalization.TableType.AnalyticalTable||this.getTableType()===i.personalization.TableType.Table||this.getTableType()===i.personalization.TableType.TreeTable){if(a.getColumnType(e)==="boolean"){o=a._getCustomProperty(e,"values")}return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:a._getCustomProperty(e,"maxLength"),precision:a._getCustomProperty(e,"precision"),scale:a._getCustomProperty(e,"scale"),type:a.getColumnType(e),typeInstance:a._getCustomProperty(e,"typeInstance"),values:o,nullable:a._getCustomProperty(e,"nullable")}}if(this.getTableType()===i.personalization.TableType.ResponsiveTable){if(a.getColumnType(e)==="boolean"){o=a._getCustomProperty(e,"values")}return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:a._getCustomProperty(e,"maxLength"),precision:a._getCustomProperty(e,"precision"),scale:a._getCustomProperty(e,"scale"),type:a.getColumnType(e),typeInstance:a._getCustomProperty(e,"typeInstance"),values:o,nullable:a._getCustomProperty(e,"nullable")}}if(this.getTableType()===i.personalization.TableType.ChartWrapper){return{columnKey:t,text:r,tooltip:l!==r?l:undefined,maxLength:a._getCustomProperty(e,"maxLength"),precision:a._getCustomProperty(e,"precision"),scale:a._getCustomProperty(e,"scale"),type:a.getColumnType(e),typeInstance:a._getCustomProperty(e,"typeInstance"),values:o,nullable:a._getCustomProperty(e,"nullable")}}};v.prototype.handleIgnore=function(e,t){e.sort.sortItems.splice(t,1)};v.prototype.syncJson2Table=function(e){var t=this.getColumnMap();var a=o({},t);this.fireBeforePotentialTableChange();if(this.getTableType()===i.personalization.TableType.AnalyticalTable||this.getTableType()===i.personalization.TableType.Table||this.getTableType()===i.personalization.TableType.TreeTable){e.filter.filterItems.forEach(function(e){var i=t[e.columnKey];if(i){if(!i.getFiltered()){i.setFiltered(true)}delete a[e.columnKey]}});for(var r in a){var l=a[r];if(l&&l.getFiltered()){l.setFiltered(false)}}}this.fireAfterPotentialTableChange()};v.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();if(!e.SelectOptions||!e.SelectOptions.length){return t}t.filter.filterItems=e.SelectOptions.map(function(e){var t=this.oFilterProvider?._getFieldMetadata(e.PropertyName);if(!t){t=this.getTable()?.getParent()?._oTableProvider.getTableViewMetadata()?.filter(function(t){return t.name===e.PropertyName})[0]}var i=l.convertOption(e.Ranges[0].Option,e.Ranges[0].Low,t);return{columnKey:e.PropertyName,exclude:e.Ranges[0].Sign==="E",operation:i.op,value1:i.v,value2:e.Ranges[0].High}}.bind(this));return t};v.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.filter||!t.filter.filterItems||!t.filter.filterItems.length){return}var i=this.getColumnMap(),l=a.getColumnKeysOfType("date",i),o=a.getColumnKeysOfType("datetime",i),n=a.getColumnKeysOfType("time",i);t.filter.filterItems.forEach(function(t){var a,s,u=true,p=t.columnKey,f=r.addRangeEntry(e,p);if(this._getSmartTable()){u=this._getSmartTable()._oTableProvider.getIsUTCDateHandlingEnabled()}if(this._getSmartChart()){u=this._getSmartChart()._oChartProvider.getIsUTCDateHandlingEnabled()}if(l.includes(p)){a="date"}else if(o.includes(p)){a="datetime"}else if(n.includes(p)){a="time"}if(l.concat(o,n).includes(p)){s=!!i[p]?.data("p13nData")?.typeInstance?.isA("sap.ui.comp.odata.type.FiscalDate");r.addP13nRanges(f,[t],a,u,s);return}r.addRanges(f,[t])},this)};v.prototype._getFilterPropertyFromColumn=function(e){var t,i,a,r=this._getColumnByKey(e);if(!r){a=this.getColumnMap();r=a&&a[e]}if(r){if(r.getFilterProperty){i=r.getFilterProperty()}t=r.data("p13nData");if(t&&!i){i=t["filterProperty"]}}return i};v.prototype._createFilterFieldControl=function(e){if(e.conditionType){e.control=e.conditionType.initializeFilterItem()}else if(!e.control&&e.fCreateControl){e.fCreateControl(e);delete e.fCreateControl}};v.prototype._getControlDataReduceFilterItems=function(){var e=this.getControlDataReduce();return e&&e.filter&&e.filter.filterItems};v.prototype._updateControlDataReduce=function(e){var t=this.getControlDataReduce();if(!e||!(t&&t.filter&&t.filter.filterItems)){return}e.reverse();t.filter.filterItems=e;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})};v.prototype._getColumnByKey=function(e){var t,i,a,r,l,o=this.getTable();if(o){t=o.getColumns();a=t.length;for(r=0;r<a;r++){i=t[r];l=i.data("p13nData");if(l&&l.columnKey===e){return i}}}return null};v.prototype._getIsCustomColumn=function(e){var t=this._getColumnByKey(e),i=t&&t.data("p13nData");return!i?false:!i.typeInstance};v.prototype._getFilterQueryPanelParameter=function(){return new URLSearchParams(window.location.search).get("sap-ui-xx-filterQueryPanel")==="true"};v.prototype.getPanel=function(e){if(!a.hasFilterableColumns(this.getColumnMap())){return null}if(e&&e.column){var t=a.getColumnKey(e.column);if(t){var i=this.getTransientData();i.filter.filterItems.forEach(function(e){e["isDefault"]=e.columnKey===t})}}var r=this.getTable(),l=this._getSmartFilterBar();if(l&&l._oFilterProvider){this._aDropdownFields=l._oFilterProvider._aFilterBarDropdownFieldMetadata;this._bShowCurrentDateButton=l._oFilterProvider._oShowCurrentDateButton}else if(r&&r.oParent&&r.oParent._oTableProvider&&r.oParent._oTableProvider._aTableViewMetadata){this._aDropdownFields=r.oParent._oTableProvider._aTableViewMetadata.filter(function(e){return e.hasFixedValues})}return new Promise(function(e){sap.ui.require(["sap/ui/comp/p13n/P13nFilterPanel","sap/ui/comp/p13n/P13nItem","sap/ui/comp/p13n/P13nAnyFilterItem","sap/ui/comp/providers/ValueListProvider"],function(t,i,a,r){var l,o=true,s,p=[],f,d;if(o){var h,c,m;if(!this.oSmartTable){this.oSmartTable=this._getSmartTable()}if(!this.oSmartChart){this.oSmartChart=this._getSmartChart()}if(!this.oSmartFilterBar){this.oSmartFilterBar=this._getSmartFilterBar();this.aSFBControlConfig=this.oSmartFilterBar?.getControlConfiguration();d=this.oSmartFilterBar?.getUseDateRangeType()&&this.oSmartTable?.isPropertyInitial("useDateRangeType")}if(this.oSmartTable){m=this.oSmartTable;p=this.oSmartTable.getFilterControlConfiguration();f=this.oSmartTable.getUseDateRangeType()}else if(this.oSmartChart){m=this.oSmartChart}if(m){h=m.getModel();c=m.getEntitySet();l=m.getId()}if(!c&&!m&&this.getTable()&&this.getTable().isA("sap.ui.table.AnalyticalTable")){h=this.getTable().getModel();c=this.getTable().getBinding("rows")&&this.getTable().getBinding("rows").getPath().slice(1).split("(")[0]}try{this.oFilterPanel=new u({enableReorder:false,change:this._mdcFilterPanelChangeHandler.bind(this),itemFactory:this._itemFactoryHandler.bind(this)});this._detachFieldsFromMDCFilterPanel();if(this.oSmartFilterBar){s=this.oSmartFilterBar.getAdditionalConfiguration()}if(this.oSmartTable&&p.length>0){s=new _(p)}if(s){s.getControlConfiguration().forEach(function(e){if(e.customControl!==null){e.customControl=null}if(e.conditionType?.defaultOperation){e.conditionType.defaultOperation=undefined}})}if(!this.oFilterProviderPromise){this.oFilterProviderPromise=n._createFilterProvider({entitySet:c,model:h,defaultDropDownDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultDropDownDisplayBehaviour"),defaultTokenDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultTokenDisplayBehaviour"),defaultSingleFieldDisplayBehaviour:this.oSmartTable&&this.oSmartTable.data("defaultSingleFieldDisplayBehaviour"),dateFormatSettings:this.oSmartTable&&this.oSmartTable._getDateFormatSettings(),useContainsAsDefaultFilter:this.oSmartTable&&this.oSmartTable.data("useContainsAsDefaultFilter"),defaultFilterBarExpanded:this.oSmartTable&&this.oSmartTable.data("defaultFilterBarExpanded"),defaultShowAllFilters:this.oSmartTable&&this.oSmartTable.data("defaultShowAllFilters"),annotationSuppressed:true,useDateRangeType:!!(f||d),showSelectAll:this.oSmartTable?.data("showSelectAll")||this.oSmartFilterBar?.data("showSelectAll"),context:"mdcFilterPanel",smartTable:this.oSmartTable,smartContainerId:l,additionalConfiguration:s,tableViewMetadata:this.oSmartTable&&this.oSmartTable._aTableViewMetadata,showCurrentDateButton:this._bShowCurrentDateButton})}this.oFilterProviderPromise.then(function(e){this._aActiveFilterPanelFieldNames=[];if(!e._aCustomFieldMetadata){e._aCustomFieldMetadata=[]}this.oFilterProvider=e;this.oFilterPanel.setModel(e.oModel,e.sFilterModelName);if(!this._aSplitIntervalFields){this._aSplitIntervalFields=this._getSplitIntervalFieldNames()}this.oFilterPanel.setP13nData(this._prepareP13nData());this._updateFilterData()}.bind(this))}catch(e){this.oFilterPanel=this._createBasicFilterPanel()}return e(this.oFilterPanel)}}.bind(this))}.bind(this))};v.prototype._removeFilter=function(e){var t=this._getControlDataReduceFilterItems().filter(function(t){return t.columnKey!==e});this._updateControlDataReduce(t);this._getControlByName(e).setTokens([])};v.prototype._createBasicFilterPanel=function(){var e=new u({enableReorder:false,change:this._mdcFilterPanelChangeHandler.bind(this),itemFactory:this._createBasicFilterField.bind(this)});this.oFilterPanel=e;e.setP13nData(this._prepareP13nData());this._detachFieldsFromMDCFilterPanel();this._updateBasicFilters();return e};v.prototype._updateBasicFilters=function(e){var t,i,a=e||this._getControlDataReduceFilterItems();this._aCustomFields.forEach(function(e){e.setTokens([])});if(Array.isArray(a)){a.reverse().forEach(function(e){t=this._getControlByName(e.columnKey);if(t){i=new y({text:this._getFormattedRangeTokenText(e.operation,e.value1,e.value2,e.exclude,e.columnKey)}).data("range",{exclude:e.exclude,operation:e.operation,keyField:e.columnKey,value1:e.value1,value2:e.value2});t.addToken(i)}}.bind(this))}};v.prototype._getFormattedRangeTokenText=function(e,t,i,a,r){var l=this._getKeyFieldByKey(r),o=t,n=i,s=true;if(l){if(!l.typeInstance&&m._createKeyFieldTypeInstance){m._createKeyFieldTypeInstance(l)}if(l.typeInstance){o=l.typeInstance.formatValue(t,"string",s);n=l.typeInstance.formatValue(i,"string",s)}}return p.getFormattedRangeText(e,o,n,a)};v.prototype._getKeyFieldByKey=function(e){var t;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(i){if(typeof i!=="string"){if(i.key===e){t=i;return true}}return false})}return t};v.prototype._createBasicFilterField=function(e){var t,i=this._getSmartTable(),a=i&&i.getId(),r,l=e.name,o=this._getControlByName(l);if(!o){r="FilterPanel-"+a+"-"+l;o=new g(r,{editable:true,enabled:true,showValueHelp:true,valueHelpOnly:true});o.attachTokenUpdate(function(e){var t,i,a=this._getControlDataReduceFilterItems(),r=e.getParameter("removedTokens"),l=r.length;if(e.getParameter("type")==="removed"){a=a.filter(function(e){for(t=0;t<l;t++){i=r[t].data("range");if(i&&i.keyField===e.columnKey&&i.value1===e.value1&&i.value2===e.value2){l-=1;return false}}return true});this._updateControlDataReduce(a)}}.bind(this));t=new c;t.addKeyField({key:l,label:e.label});t.associateInput(o);t.setDefaultOperation("EQ");o._sControlName=l;o.attachValueHelpRequest(this._vhRequest.bind(this,e,o));this._aCustomFields.push(o)}return o};v.prototype._getSplitIntervalFieldNames=function(){var e,t,i=[],a=this.oFilterProvider;if(a&&a.aAllFields){for(e=0;e<a.aAllFields.length;e++){t=a.aAllFields[e];if(t.filterRestriction===C.Interval&&t.type!=="Edm.DateTime"){i.push(t.name)}}}return i};v.prototype._vhRequest=function(e,t){var i,r=this._getColumnByKey(e.name),l=t&&t.getId()+"-valueHelpDialog",o=new F(l,{key:e.name,supportRangesOnly:true,supportRanges:true,title:e.label,cancel:function(){o.close()}});o.attachOk(this._onOk.bind(this,t,o));o.attachAfterClose(function(){this.destroy()});o.setProperty("_enhancedExcludeOperations",true);i={label:e.label,key:e.name,type:a._getCustomProperty(r,"type")||"string",maxLength:a._getCustomProperty(r,"maxLength"),scale:a._getCustomProperty(r,"scale"),precision:a._getCustomProperty(r,"precision"),nullable:a._getCustomProperty(r,"nullable")};m._createKeyFieldTypeInstance(i);this._aRangeKeyFields.push(i);o.setRangeKeyFields([i]);o.setTokens(t.getTokens());o.open()};v.prototype._onOk=function(e,t,i){var a=i.getParameter("tokens"),r=[];if(!a){t.close();return}e.setTokens(a);var l=this._getControlDataReduceFilterItems();a.forEach(function(e){r.push(e.data("range"))});l=l.filter(function(t){return t.columnKey!==e._sControlName});l.push(this._createConditionForRanges(r));l=l.flat();this._updateControlDataReduce(l);t.close()};v.prototype._getFieldMetadata=function(e,t){var i=null;if(Array.isArray(e)){e.some(function(e){if(e&&e.fields){e.fields.some(function(e){if(e&&e.name===t){i=e}return i!==null})}return i!==null})}return i};v.prototype._itemFactoryHandler=function(e){var t,i,r,l,o,n=e.name,s=this.oFilterProvider,u=this._getControlByName(n),p=this._getFilterPropertyFromColumn(n),f=this._getColumnByKey(n),d;if(u&&u.isA("sap.m.DatePicker")&&u.getValue()&&!this._checkIfFilterHasValue(n)){u.setValue("")}if(p&&p.includes("/")){d=s._oMetadataAnalyser.extractNavigationPropertyField(p,s.sEntitySet);d=s._createFieldMetadata(d)}else{d=s._getFieldMetadata(p)}if(d&&p&&n!==p){d=Object.assign({},d)}this._aActiveFilterPanelFieldNames.push(n);if(!u){if(!d){if(!this._aViewMetadata){this._aViewMetadata=s._oMetadataAnalyser._getAllFilterableFieldsByEntityForAllEndpoints(s.sEntitySet,true,false,null)}d=this._getFieldMetadata(this._aViewMetadata,n);if(d){d=s._createFieldMetadata(d)}}try{d=this._updateFieldMetadata(d,e,p)}catch(e){}if(this.aSFBControlConfig&&d){for(t=0;t<this.aSFBControlConfig.length;t++){i=this.aSFBControlConfig[t];if(i.getKey()===d.fieldName){r=i.getDisplayBehaviour();if(r&&!i.isPropertyInitial("displayBehaviour")){o=Object.assign({},d);o.displayBehaviour=r}l=i.getControlType();if(l&&!i.isPropertyInitial("controlType")){if(!o){o=Object.assign({},d)}o.controlType=l}break}}}if(o){if(o.conditionType){u=this._createSemanticControl(o)}else{o.fCreateControl(o);u=o.control}}else if(d){if(d.conditionType){u=this._createSemanticControl(d)}else{d.fCreateControl(d);u=d.control}}if(!u){u=new h({editable:true,enabled:true,showValueHelp:true,valueHelpOnly:true});d={fieldName:n,type:a._getCustomProperty(f,"edmType")||a._getCustomProperty(f,"type"),filterType:a._getCustomProperty(f,"type"),maxLength:a._getCustomProperty(f,"maxLength"),scale:a._getCustomProperty(f,"scale"),precision:a._getCustomProperty(f,"precision"),nullable:a._getCustomProperty(f,"nullable"),isDigitSequence:a._getCustomProperty(f,"isDigitSequence"),label:e.label};s._associateValueHelpDialog(u,d,true,true);s._aCustomFieldMetadata.push(d);u.bindProperty("value",{path:s.sFilterModelName+">/"+d.fieldName+"/value",type:s._getType(d)});s._handleMultiInput(u,d,s._getType(d))}u.setModel(this.getTable().getModel());u._sControlName=e.name;this._aFilterPanelFields.push(u);if(u.isA("sap.m.Select")||u.isA("sap.m.TimePicker")){u.setWidth("100%")}if(u.isA("sap.m.MultiInput")){u.attachTokenUpdate(this._fieldChangeHandler.bind(this))}else{u.attachChange(this._fieldChangeHandler.bind(this))}}if(u.getValueState&&u.getValueState()===T.Error){u.setValueState(T.None)}return u};v.prototype._createSemanticControl=function(e){const t=e.conditionType.initializeFilterItem("mdcFilterPanel");this._aConditionTypeControls.push(t);if(t&&t.getValue()){setTimeout(function(){t.setValue(null)},0,t)}return t};v.prototype._fieldChangeHandler=function(e){var t,i,a,r=[],l,o=this.oFilterProvider,n,s=e.getSource(),u=s._sControlName,p={exclude:false,columnKey:u,operation:"EQ",value1:null,value2:null};setTimeout(function(){Promise.all(o._getCurrentValidationPromises()).then(function(){n=o.getFilterData();for(t in n){if(n.hasOwnProperty(t)){i=n[t];if(i){a=o._getFieldMetadata(t);if(a&&a.fieldNameOData&&t!==a.fieldNameOData){t=a.fieldNameOData}p.columnKey=t;if(p.columnKey&&p.columnKey.includes("___")){p.columnKey=p.columnKey.replaceAll("___","/")}l=Object.assign({},p);if(Array.isArray(i.ranges)&&i.ranges.length>0){r.push(this._createConditionForRanges(i.ranges,i.conditionTypeInfo))}if(Array.isArray(i.items)&&i.items.length>0){r.push(this._createConditionForItems(i.items,p))}if(i.hasOwnProperty("low")&&i.low){r.push(this._createConditionForIntervals(i,t,p))}if(i.value){if(s&&s.getValueState()!==T.Error){l=Object.assign({},p);l.value1=i.value;r.push(l)}}if(typeof i!=="object"||i instanceof Date){l=Object.assign({},p);l.value1=i;r.push(l)}}}}r=r.flat();this._updateControlDataReduce(r);if(s._oFieldViewMetadata&&this.oFilterProvider._oMetadataAnalyser.getMultiUnitBehaviorEnabled()){if(s._oFieldViewMetadata.isMeasureField){this._setWarningState(s)}if(d.isUnitOfMeasure(s._oFieldViewMetadata)||d.isCurrencyCode(s._oFieldViewMetadata)){this._clearWarningState(s)}}}.bind(this))}.bind(this))};v.prototype._setWarningState=function(e){var t=e._oFieldViewMetadata,i=this.oFilterProvider&&this.oFilterProvider._getFieldMetadata(t.unit),a=i&&i.label,r=this._oResourceBundle.getText("UNIT_WARNING_TEXT",[a]),l=this._checkIfFilterHasValue(t.name),o=this._checkIfFilterHasValue(i.name);if(t.filterRestriction==="single"){return}if(!o&&l){setTimeout(function(){e.setValueState(T.Warning);e.setValueStateText(r)})}if(!l){e.setValueState(T.None)}};v.prototype._clearWarningState=function(e){var t=e._oFieldViewMetadata,i=t&&t.name,a=t&&t.label,r=this._oResourceBundle.getText("UNIT_WARNING_TEXT",[a]),l,o=this._checkIfFilterHasValue(t.name),n;if(t.filterRestriction==="single"){return}this.oFilterProvider.aAllFields.forEach(function(e){if(e.isCurrencyField&&e["Org.OData.Measures.V1.ISOCurrency"].Path===i||e.isMeasureField&&e["Org.OData.Measures.V1.Unit"]&&e["Org.OData.Measures.V1.Unit"].Path===i){l=this._getControlByName(e.name);if(l){n=this._checkIfFilterHasValue(e.name);if(o&&l.getValueState()===T.Warning){l.setValueState(T.None)}if(!o&&n&&l.getValueState()===T.None){l.setValueState(T.Warning);l.setValueStateText(r)}}}}.bind(this))};v.prototype._checkIfFilterHasValue=function(e,t){var i=t||this.oFilterProvider.getFilterData(),a=i[e]||i._CUSTOM&&i._CUSTOM[e];if(a===null||typeof a==="undefined"){return false}if(typeof a==="string"&&a){return true}if(typeof a==="number"){return true}if(typeof a==="object"&&Object.prototype.toString.call(a)==="[object Date]"){return true}if(typeof a==="object"&&(a.hasOwnProperty("low")||a.hasOwnProperty("high"))){return!!a.low||!!a.high}if(typeof a==="object"&&(a.hasOwnProperty("value")||a.hasOwnProperty("items")||a.hasOwnProperty("ranges"))){return!!a.value||a.items&&!!a.items.length||a.ranges&&!!a.ranges.length}return false};v.prototype._updateFieldMetadata=function(e,t,i){var a,r,l=t.name,o=this.oFilterProvider,n=false,s=this._getIsCustomColumn(l),u=this._getColumnByKey(l);if(e){if(t&&!s&&e.fieldName&&e.fieldName.includes("/")){n=true}if(s){a=u&&(u.getHeader&&u.getHeader()||u.getLabel&&u.getLabel());if(a&&a.getText()){e.label=a.getText()}}}if(i&&i.includes("/")){e=o._oMetadataAnalyser.extractNavigationPropertyField(i,o.sEntitySet);e=o._createFieldMetadata(e)}if(!e){l=this._getFilterPropertyFromColumn(l);r=o.aAllFields&&o.aAllFields.find(function(e){return e.name===l});r=o._createFieldMetadata(r);e=Object.assign({},r)}if(s||n){e=this._prepareFieldMetadataForCustomColumn(e,t)}return e};v.prototype._prepareFieldMetadataForCustomColumn=function(e,t){var i=t.name,r,l,o,n,s,u=t.name,p=this._getColumnByKey(u),f=this.oFilterProvider;if(u.includes("/")){this._aCustomColumnKeysWithSlash.push(u);u=u.replaceAll("/","___")}e.customColumnKey=i;e.fieldName=u;e.name=u;n=!!e.ui5Type&&e.ui5Type.oConstraints;e.label=p&&(p.getHeader?p.getHeader().getText():p.getLabel().getText());o=a._getCustomProperty(p,"maxLength");l=a._getCustomProperty(p,"scale");r=a._getCustomProperty(p,"precision");if(n&&(o||l||r)){s=e.ui5Type;e=Object.assign({},e,{ui5Type:Object.assign({},e.ui5Type,{oConstraints:Object.assign({},e.ui5Type.oConstraints)})});for(var d in s){if(!s.hasOwnProperty(d)){e.ui5Type[d]=s[d]}}}if(o){e.maxLength=o;if(n){e.ui5Type.oConstraints.maxLength=o}}if(l){e.scale=l;if(n){e.ui5Type.oConstraints.scale=l}}if(r){e.precision=r;if(n){e.ui5Type.oConstraints.precision=r}}f._aCustomFieldMetadata.push(e);this._updateFilterData();return e};v.prototype._prepareP13nData=function(){var e=[],t,i,a,r=this._getControlDataReduceFilterItems();this.getTransientData().filter.filterItems.forEach(function(a){t=r&&r.some(function(e){return e.columnKey===a.columnKey});if(a.isDefault){t=true;i=this.oFilterProvider?._oMetadataAnalyser?.getDescriptionFieldName(a.columnKey,this.oFilterProvider.sEntitySet)}e.push({name:a.columnKey,label:a.text,active:t})}.bind(this));if(i){a=e.find(e=>e.name===i);if(a){a.active=true}}return e};v.prototype._mdcFilterPanelChangeHandler=function(e){if(e.getParameter("reason")===this.oFilterPanel.CHANGE_REASON_REMOVE){this._handleFieldRemove(e)}};v.prototype._handleFieldRemove=function(e){try{var t=this.oFilterProvider,i=e.getParameter("item").name,a,r,l=this._getControlByName(i),o=t.getFilterData(),n=this._getControlDataReduceFilterItems();if(i&&i.includes("/")){r=t._oMetadataAnalyser.extractNavigationPropertyField(i,t.sEntitySet);r=t._createFieldMetadata(r)}else{r=t._getFieldMetadata(i)}if(n&&n.length>0){n=n.filter(function(e){return e.columnKey!==i})}this._updateControlDataReduce(n);if(!r){a=this._getFilterPropertyFromColumn(i);r=t.aAllFields.find(function(e){return e.name===a});r=t._createFieldMetadata(r);r.name=i;r.fieldName=i;r.control=l}if(r&&!r.control&&l){r.control=l}t._createInitialModelForField(o,r);if(l&&l.getValue&&l.getValue()){l.setValue(null)}}catch(t){this._removeFilter(e.getParameter("item").name)}};v.prototype._detachFieldsFromMDCFilterPanel=function(){var e,t=this.oFilterPanel.exit;this.oFilterPanel.exit=function(){t.apply(this,arguments);this._aFilterPanelFields.forEach(function(t){if(t){e=t.getParent();if(e){e.removeContent(t)}}});this._aCustomFields.forEach(function(t){if(t){e=t.getParent();if(e){e.removeContent(t)}}});if(this._aActiveFilterPanelFieldNames){this._aActiveFilterPanelFieldNames=null}}.bind(this)};v.prototype._createConditionForRanges=function(e,t){var i,a,r=[],l;for(i=0;i<e.length;i++){a=Object.assign({},e[i]);if(!a.columnKey){a.columnKey=a.keyField}try{l=this.oFilterProvider._getFieldMetadata(a.columnKey);if(l&&l.fieldNameOData){a.columnKey=l.fieldNameOData}if(a.columnKey&&a.columnKey.includes("___")){a.columnKey=a.columnKey.replaceAll("___","/")}}catch(e){}if(t){a.conditionTypeInfo=t}delete a.keyField;delete a.tokenText;r.push(a)}return r};v.prototype._createConditionForItems=function(e,t){var i,a,r=[],l;for(i=0;i<e.length;i++){a=e[i];l=Object.assign({},t);l.value1=a.key;l.token=a.text;r.push(l)}return r};v.prototype._createConditionForIntervals=function(e,t,i){var a,r=this.oFilterProvider,l=[],o;a=Object.assign({},i);a.operation="BT";if(e.low&&e.high){a.value1=e.low;a.value2=e.high}else if(e.low){if(r._aFilterBarDateTimeFieldNames.indexOf(t)>-1){o=r._getFieldMetadata(t);l=[e.low];if(typeof e.low==="string"){l=p.parseDateTimeOffsetInterval(e.low);l[0]=o.ui5Type.parseValue(l[0],"string")}if(l.length===2){l[1]=o.ui5Type.parseValue(l[1],"string")}if(l.length===1){a.operation="EQ"}}else{l=p.parseFilterNumericIntervalData(e.low)}if(l){a.value1=l[0];a.value2=l[1]}}return a};v.prototype._updateFilterData=function(e){var t,i,a,r,l,o,n,s=this.oFilterProvider,u=e?e:this._getControlDataReduceFilterItems();s.clear();if(this._aConditionTypeControls.length>0){this._aConditionTypeControls.forEach(e=>{if(e.getValue()){e.setValue(null)}})}o=Object.assign({},s.getFilterData());Object.values(o).forEach(e=>{if(e?.conditionTypeInfo){e.conditionTypeInfo.data.operation="DATE"}});n=Object.keys(o);if(u&&u.length>0){for(t=0;t<u.length;t++){l=Object.assign({},u[t]);r=l.keyField?l.keyField:l.columnKey;if(this._aCustomColumnKeysWithSlash.includes(r)){r=r.replaceAll("/","___")}if(r.indexOf("/")>-1&&n.indexOf(r.replaceAll("/","."))>-1){r=n[n.indexOf(r.replaceAll("/","."))]}a=o[r];if(!l.keyField){l.keyField=l.columnKey;delete l.columnKey}if(l.token){i={key:l.value1,text:l.token};if(!a.items){a.items=[]}a.items.push(i)}else if(l?.conditionTypeInfo){if(!l.conditionTypeInfo.data.operation){l.conditionTypeInfo.data.operation=l.conditionTypeInfo.data.operator}a.conditionTypeInfo=l.conditionTypeInfo;if(!a.ranges){a.ranges=[]}a.ranges.push(l)}else if(a?.conditionTypeInfo){a.conditionTypeInfo.data.value1=l.value1;a.conditionTypeInfo.data.value2=l.value2;const e=this.oFilterProvider._getFieldMetadata(a.conditionTypeInfo.data.key);if(e?.type==="Edm.DateTimeOffset"){if(l.value2){a.conditionTypeInfo.data.operation="DATETIMERANGE"}else{a.conditionTypeInfo.data.operation="DATETIME"}}else if(l.value2){a.conditionTypeInfo.data.operation="DATERANGE"}if(l.operation==="LE"||l.operation==="LT"){a.conditionTypeInfo.data.operation="TO"}if(l.operation==="GE"||l.operation==="GT"){a.conditionTypeInfo.data.operation="FROM"}if(e?.filterRestriction==="interval"){const e=this._getControlByName(l.keyField)?.toDates({operator:a.conditionTypeInfo.data.operation,values:[l.value1]});l.value1=a.conditionTypeInfo.data.value1=e[0]?.oDate;l.value2=a.conditionTypeInfo.data.value2=e[1]?.oDate;l.operation="BT"}if(!a.ranges){a.ranges=[]}a.ranges.push(l)}else if(a&&a.hasOwnProperty("low")){if(s._aFilterBarDateTimeFieldNames&&s._aFilterBarDateTimeFieldNames.indexOf(r)>-1){if(l.value1 instanceof Date){l.value1=l.value1.toISOString()}if(l.value2 instanceof Date){l.value2=l.value2.toISOString()}}if(this._aSplitIntervalFields&&this._aSplitIntervalFields.indexOf(l.keyField)>-1){i={low:l.value1+"-"+l.value2,high:null}}else{i={low:l.value1,high:l.value2}}o[r]=i}else if(a===null||typeof a!=="object"){o[r]=l.value1}else{if(this._getControlByName(l.keyField)?.isA("sap.m.MultiComboBox")){o[r].items?.push({key:l.value1})}else{if(!(a&&a.ranges)){a.ranges=[]}o[r].ranges.push(l)}}}s.setFilterData(o)}};v.prototype._getControlByName=function(e){var t,i,a,r=this._aFilterPanelFields.length?this._aFilterPanelFields:this._aCustomFields;for(t=0;t<r.length;t++){a=r[t];if(a._sControlName===e){i=a;break}}return i};v.prototype.getChangeType=function(e,t){if(!t||!t.filter||!t.filter.filterItems){return i.personalization.ChangeType.Unchanged}if(t&&t.filter&&t.filter.filterItems){t.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(e&&e.filter&&e.filter.filterItems){e.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}var a=JSON.stringify(e.filter.filterItems)!==JSON.stringify(t.filter.filterItems);return a?i.personalization.ChangeType.ModelChanged:i.personalization.ChangeType.Unchanged};v.prototype.getChangeData=function(e,t){if(!e||!e.filter||!e.filter.filterItems){return this.createControlDataStructure()}if(t&&t.filter&&t.filter.filterItems){t.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(e&&e.filter&&e.filter.filterItems){e.filter.filterItems.forEach(function(e){delete e.key;delete e.source})}if(!t||!t.filter||!t.filter.filterItems){return{filter:a.copy(e.filter)}}if(JSON.stringify(e.filter.filterItems)!==JSON.stringify(t.filter.filterItems)){return{filter:a.copy(e.filter)}}return null};v.prototype.getUnionData=function(e,t){if(!t||!t.filter||!t.filter.filterItems){return{filter:a.copy(e.filter)}}return{filter:a.copy(t.filter)}};v.prototype._getSmartFilterBar=function(){var e,t=this.getTable();if(t){e=t.oParent&&t.oParent._oSmartFilter}if(!e&&t&&this.getTableType()===i.personalization.TableType.ChartWrapper){e=t.getChartObject()&&t.getChartObject().oParent&&t.getChartObject().oParent._oSmartFilter}return e?e:null};v.prototype._getSmartTable=function(){var e=this.getTable()&&this.getTable().getParent();return e&&e.isA("sap.ui.comp.smarttable.SmartTable")?e:null};v.prototype._getSmartChart=function(){var e=this.getTable();if(e&&this.getTableType()===i.personalization.TableType.ChartWrapper){return e&&e.getChartObject()&&e.getChartObject().getParent()}return null};v.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this._aDropdownFields=null;this.aFilterItems=null;this._aSFBMultiInputs=null;this.oSmartChart=null;this.oSmartTable=null;this.oSmartFilterBar=null;this.aSFBControlConfig=null;this._aSplitIntervalFields=null;if(this.oFilterProviderPromise){this.oFilterProviderPromise=null}if(this.oFilterProvider&&this.oFilterProvider.destroy){this.oFilterProvider.destroy();this.oFilterProvider=null}if(this._aFilterPanelFields&&this._aFilterPanelFields.length>0){this._aFilterPanelFields.forEach(function(e){e.destroy()})}if(this._aCustomFields&&this._aCustomFields.length>0){this._aCustomFields.forEach(function(e){e.destroy()})}this._aFilterPanelFields=null;this._aConditionTypeControls=null;this._aCustomFields=null;this._aActiveFilterPanelFieldNames=null;this._aViewMetadata=null;this._aCustomColumnKeysWithSlash=null};return v});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/GroupController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/core/Element"],function(e,t,o,r,n){"use strict";var a=t.P13nConditionOperation;var p=e.extend("sap.ui.comp.personalization.GroupController",{constructor:function(o,r){e.apply(this,arguments);this.setType(t.P13nPanelType.group);this.setItemType(t.P13nPanelType.group+"Items")},metadata:{events:{afterGroupModelDataChange:{}}}});p.prototype.setTable=function(t){e.prototype.setTable.apply(this,arguments);if(this.getTableType()===o.personalization.TableType.ResponsiveTable){t.detachEvent("_group",this._onGroup,this);t.attachEvent("_group",this._onGroup,this)}else if(t&&t.detachGroup&&t.attachGroup){t.detachGroup(this._onGroup,this);t.attachGroup(this._onGroup,this)}};p.prototype.getColumn2Json=function(e,t,r){if(this.getTableType()!==o.personalization.TableType.AnalyticalTable){return null}if(!e.getGrouped()){return null}return{columnKey:t,isGrouped:e.getGrouped(),operation:e.getSortOrder&&e.getSortOrder()!=="Descending"?a.GroupAscending:a.GroupDescending,showIfGrouped:e.getShowIfGrouped?e.getShowIfGrouped():false}};p.prototype.getAdditionalData2Json=function(e,t){if(this.getTableType()!==o.personalization.TableType.AnalyticalTable){return}if(!e.group.groupItems.length){return}t.getGroupedColumns().forEach(function(t,o){if(typeof t==="string"){t=n.getElementById(t)}var a=r.getIndexByKey("columnKey",r.getColumnKey(t),e.group.groupItems);if(a>-1&&o===a){return}var p=e.group.groupItems.splice(a,1);e.group.groupItems.splice(o,0,p)})};p.prototype.getColumn2JsonTransient=function(e,t,o,n){if(!r.isGroupable(e)){return null}return{columnKey:t,text:o,tooltip:n!==o?n:undefined}};p.prototype.handleIgnore=function(e,t){e.sort.sortItems.splice(t,1)};p.prototype.syncJson2Table=function(e){var t=this.getColumnMap();var r=this.getTable();var n;this.fireBeforePotentialTableChange();if(this.getTableType()===o.personalization.TableType.TreeTable){return}else if(this.getTableType()===o.personalization.TableType.AnalyticalTable){var a=true;for(var p in t){n=t[p];if(!n){return}if(n.getGrouped()){n.setGrouped(false,a);n.setShowIfGrouped(false)}}e.group.groupItems.forEach(function(e){n=t[e.columnKey];if(!n){return}n.setGrouped(true,a);n.setShowIfGrouped(e.showIfGrouped)})}else if(this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.TreeTable){if(!r.getGroupBy){return}if(e.group.groupItems.length>0){e.group.groupItems.some(function(e){n=t[e.columnKey];if(n){r.setGroupBy&&r.setGroupBy(n);return true}})}else{r.setGroupBy&&r.setGroupBy(null)}}this.fireAfterPotentialTableChange()};p.prototype.getDataSuiteFormat2Json=function(e){var t=this.createControlDataStructure();if(!e.GroupBy||!e.GroupBy.length){return t}t.group.groupItems=e.GroupBy.map(function(e){return{columnKey:e,operation:a.GroupAscending,showIfGrouped:false}});return t};p.prototype.getDataSuiteFormatSnapshot=function(e){var t=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!t.group||!t.group.groupItems||!t.group.groupItems.length){return}e.GroupBy=t.group.groupItems.map(function(e){return e.columnKey})};p.prototype._onGroup=function(e){this.fireBeforePotentialTableChange();this._updateInternalModel(e.getParameter("groupedColumns"));this.fireAfterPotentialTableChange();this.fireAfterGroupModelDataChange()};p.prototype._setGroup=function(e,t){this.fireBeforePotentialTableChange();if(e){this._updateInternalModel([t])}else{this._updateInternalModel([])}this.fireAfterPotentialTableChange();this.fireAfterGroupModelDataChange()};p.prototype._updateInternalModel=function(e){this.getInternalModel().setProperty("/controlData/group/groupItems",[]);var t=this.getControlData();e.forEach(function(e){if(typeof e==="string"){e=n.getElementById(e)}var o=r.getColumnKey(e);var a=r.getIndexByKey("columnKey",o,t.group.groupItems);a=a>-1?a:t.group.groupItems.length;this.getInternalModel().setProperty("/controlData/group/groupItems/"+a+"/",{columnKey:o,showIfGrouped:e.getShowIfGrouped?e.getShowIfGrouped():false})},this);this.updateControlDataBaseFromJson(t)};p.prototype.retrieveAdaptationUI=function(e){if(!r.hasGroupableColumns(this.getColumnMap())){return null}return new Promise(function(e){sap.ui.require(["sap/m/p13n/GroupPanel"],function(t){var r=this.getAdaptationData();var n=this.getTableType()===o.personalization.TableType.AnalyticalTable;var a=new t({queryLimit:n?undefined:1,enableShowField:n});this.oPanel=a;a.setP13nData(r);a.attachChange(function(e){var t=t=e.getParameter("item");var o=a.getP13nData(true);var r=this.getControlDataReduce();r.group.groupItems=o.map(function(e){return{isGrouped:true,columnKey:e.name,operation:e.descending?"GroupDescending":"GroupAscending",showIfGrouped:t.name===e.name?t.showIfGrouped:e.showIfGrouped}});this.setControlDataReduce2Model(r);this.fireAfterPotentialModelChange({json:r})}.bind(this));e(a)}.bind(this))}.bind(this))};p.prototype._transformAdaptationData=function(t,o){var r=e.prototype._transformAdaptationData.apply(this,arguments);r.grouped=!!t;r.showIfGrouped=t?t.showIfGrouped:true;return r};p.prototype._sortAdaptationData=function(e){this._getP13nBuilder().sortP13nData({visible:"grouped",position:"position"},e)};p.prototype._getPresenceAttribute=function(){return"grouped"};p.prototype.getChangeType=function(e,t){if(!t||!t.group||!t.group.groupItems){return o.personalization.ChangeType.Unchanged}var r=JSON.stringify(e.group.groupItems)!==JSON.stringify(t.group.groupItems);return r?o.personalization.ChangeType.ModelChanged:o.personalization.ChangeType.Unchanged};p.prototype.getChangeData=function(e,t){if(!e||!e.group||!e.group.groupItems){return this.createControlDataStructure()}if(!t||!t.group||!t.group.groupItems){return{group:r.copy(e.group)}}if(JSON.stringify(e.group.groupItems)!==JSON.stringify(t.group.groupItems)){return{group:r.copy(e.group)}}return null};p.prototype.getUnionData=function(e,t){if(!t||!t.group||!t.group.groupItems){return{group:r.copy(e.group)}}return{group:r.copy(t.group)}};p.prototype.isGroupSelected=function(e,t){var o=-1;e.groupItems.some(function(e,r){if(e.columnKey===t){o=r;return true}});return o>-1};p.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this.getTable()&&this.getTable().detachGroup&&(this.getTableType()===o.personalization.TableType.AnalyticalTable||this.getTableType()===o.personalization.TableType.Table||this.getTableType()===o.personalization.TableType.TreeTable)){this.getTable().detachGroup(this._onGroup,this)}};return p});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/LinkPanelController", ["sap/ui/mdc/p13n/subcontroller/LinkPanelController","sap/ui/core/Lib","sap/m/MessageBox"],(e,t,n)=>{"use strict";const o=e.extend("sap.ui.comp.personalization.LinkPanelController",{});o.prototype.getSelectorForReset=function(){return this.getAdaptationControl()};o.prototype.getSelectorsForHasChanges=function(){return this.getAdaptationControl()};o.prototype._createAddRemoveChange=function(e,t,n){const o=n.name;return{selectorElement:e,changeSpecificData:{changeType:t,content:{visible:t==="addLink",key:o,selector:{id:o,idIsLocal:false}}}}};o.prototype._navigate=function(e){this.getAdaptationControl().getMetadata()._oParent._oClass.navigate(e)};o.prototype.getChangeOperations=function(){return{add:"addLink",remove:"removeLink"}};return o});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SelectionController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/ui/core/Lib"],function(e,t,n,i,o){"use strict";var r=e.extend("sap.ui.comp.personalization.SelectionController",{constructor:function(n,i){e.apply(this,arguments);this.setType(t.P13nPanelType.selection);this.setItemType(t.P13nPanelType.selection+"Items")},metadata:{events:{afterSelectionModelDataChange:{}}}});r.prototype.getColumn2Json=function(e,t,n){return{columnKey:t,text:e.getLabel(),visible:e.getSelected()}};r.prototype.getColumn2JsonTransient=function(e,t,n,i){return{columnKey:t,text:n,href:e.getHref(),internalHref:e.getInternalHref(),target:e.getTarget(),press:e.getPress(),description:e.getDescription()}};r.prototype.syncJson2Table=function(e){this.fireBeforePotentialTableChange();this.fireAfterPotentialTableChange()};r.prototype.retrieveAdaptationUI=function(e){return new Promise(function(e){sap.ui.require(["sap/ui/mdc/p13n/panels/LinkSelectionPanel"],function(t){var n=this.getAdaptationData();var i=new t({showHeader:true,enableCount:true,fieldColumn:o.getResourceBundleFor("sap.ui.mdc").getText("info.SELECTION_DIALOG_COLUMNHEADER_WITHOUT_COUNT"),linkPressed:this.getTable().getPress(),enableReorder:false});i.setP13nData(n);this.oPanel=i;var r;i.attachChange(function(e){var t=this.getControlDataReduce();r=e.getSource().getP13nData().map(function(e,t){return{columnKey:e.name,visible:e.visible}});t.selection.selectionItems=r;this.setControlDataReduce2Model(t);this.fireAfterPotentialModelChange({json:t})}.bind(this));e(i)}.bind(this))}.bind(this))};r.prototype._transformAdaptationData=function(t,n){var i=e.prototype._transformAdaptationData.apply(this,arguments);i.text=n.text;i.href=n.href;i.internalHref=n.internalHref?n.internalHref:undefined;i.visible=t.visible;i.description=n.description;i.label=n.name;return i};r.prototype.getChangeType=function(e,t){return this.getChangeData(e,t)?n.personalization.ChangeType.ModelChanged:n.personalization.ChangeType.Unchanged};r.prototype.getChangeData=function(e,t){if(!t||!t.selection||!t.selection.selectionItems){return null}var n={selection:i.copy(e.selection)};if(this._isSemanticEqual(e,t)){return null}var o=[];n.selection.selectionItems.forEach(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.selection.selectionItems);if(i.semanticEqual(e,n)){o.push(e);return}for(var r in e){if(r==="columnKey"||!n){continue}if(e[r]===n[r]){delete e[r]}}if(Object.keys(e).length<2){o.push(e)}});o.forEach(function(e){var t=i.getIndexByKey("columnKey",e.columnKey,n.selection.selectionItems);n.selection.selectionItems.splice(t,1)});return n};r.prototype.getUnionData=function(e,t){var n=i.copy(e);if(!t||!t.selection||!t.selection.selectionItems){return n.selection?{selection:i.copy(n.selection)}:null}if(!n||!n.selection||!n.selection.selectionItems){return{selection:i.copy(t.selection)}}var o=this.createControlDataStructure();n.selection.selectionItems.forEach(function(e){var n=i.getArrayElementByKey("columnKey",e.columnKey,t.selection.selectionItems);if(n){if(n.visible!==undefined){e.visible=n.visible}}o.selection.selectionItems.push(e)});return o};r.prototype._isSemanticEqual=function(e,t){var n=function(e,t){if(e.visible===true&&(t.visible===false||t.visible===undefined)){return-1}else if((e.visible===false||e.visible===undefined)&&t.visible===true){return 1}else if(e.visible===true&&t.visible===true){return 0}else if((e.visible===false||e.visible===undefined)&&(t.visible===false||t.visible===undefined)){if(e.columnKey<t.columnKey){return-1}else if(e.columnKey>t.columnKey){return 1}else{return 0}}};var o=i.copy(e.selection.selectionItems).sort(n);var r=i.copy(t.selection.selectionItems).sort(n);return!o.some(function(e,t){if(!i.semanticEqual(e,r[t])){return true}})};r.prototype.getResetWarningText=function(){return o.getResourceBundleFor("sap.ui.mdc").getText("info.SELECTION_DIALOG_RESET_WARNING")};return r});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SelectionWrapper", ["sap/ui/core/Element","./ColumnWrapper"],function(e,a){"use strict";var p=e.extend("sap.ui.comp.personalization.SelectionWrapper",{constructor:function(a,p){e.apply(this,arguments)},metadata:{library:"sap.ui.comp",properties:{press:{type:"function",defaultValue:null}},aggregations:{columns:{type:"sap.ui.comp.personalization.ColumnWrapper",multiple:true,singularName:"column"}}}});return p});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/SortController", ["./BaseController","sap/m/library","sap/ui/comp/library","./Util","sap/base/util/merge"],function(t,e,r,o,n){"use strict";var s=t.extend("sap.ui.comp.personalization.SortController",{constructor:function(r,o){t.apply(this,arguments);this.setType(e.P13nPanelType.sort);this.setItemType(e.P13nPanelType.sort+"Items")},metadata:{events:{afterSortModelDataChange:{}}}});s.prototype.setTable=function(e){t.prototype.setTable.apply(this,arguments);if(this.getTableType()===r.personalization.TableType.ResponsiveTable){e.detachEvent("_sort",this._onSort,this);e.attachEvent("_sort",this._onSort,this)}else if(e&&e.detachSort&&e.detachSort){e.detachSort(this._onSort,this);e.attachSort(this._onSort,this)}};s.prototype.getColumn2Json=function(t,e,r){if(!o.isSortable(t)){return null}if(!t.getSorted||t.getSorted&&!t.getSorted()){return null}if(!t.getSortOrder||t.getSortOrder()==="None"){return null}return{columnKey:e,operation:t.getSortOrder()}};s.prototype.getColumn2JsonTransient=function(t,e,r,n){if(!o.isSortable(t)){return null}return{columnKey:e,text:r,tooltip:n!==r?n:undefined}};s.prototype.handleIgnore=function(t,e){t.sort.sortItems.splice(e,1)};s.prototype.syncJson2Table=function(t){var e=this.getColumnMap();var o=n({},e);this.fireBeforePotentialTableChange();if(this.getTableType()===r.personalization.TableType.AnalyticalTable||this.getTableType()===r.personalization.TableType.Table||this.getTableType()===r.personalization.TableType.TreeTable){t.sort.sortItems.forEach(function(t){var r=e[t.columnKey];if(!r){return}if(t.operation===undefined){return}if(!r.getSorted()){r.setSorted(true)}if(r.getSortOrder()!==t.operation){r.setSortOrder(t.operation)}delete o[t.columnKey]});for(var s in o){var a=o[s];if(a&&a.getSorted()){a.setSorted(false)}if(a&&a.getSortOrder()!=="None"){a.setSortOrder("None")}}}this.fireAfterPotentialTableChange()};s.prototype.getDataSuiteFormat2Json=function(t){var e=this.createControlDataStructure();if(!t.SortOrder||!t.SortOrder.length){return e}e.sort.sortItems=t.SortOrder.map(function(t){return{columnKey:t.Property,operation:t.Descending?"Descending":"Ascending"}});return e};s.prototype.getDataSuiteFormatSnapshot=function(t){var e=this.getUnionData(this.getControlDataInitial(),this.getControlData());if(!e.sort||!e.sort.sortItems||!e.sort.sortItems.length){return}t.SortOrder=e.sort.sortItems.map(function(t){return{Property:t.columnKey,Descending:t.operation==="Descending"}})};s.prototype._onSort=function(t){t.preventDefault();this._updateInternalModel(o.getColumnKey(t.getParameter("column")),t.getParameter("sortOrder"),t.getParameter("columnAdded"));this.syncJson2Table(this.getControlData());this.fireAfterSortModelDataChange()};s.prototype._updateInternalModel=function(t,e,r){if(!t||e!=="Descending"&&e!=="Ascending"&&e!=="None"){return}if(!r){this.getInternalModel().setProperty("/controlData/sort/sortItems",[])}var n=this.getControlData();if(e!="None"){var s=o.getIndexByKey("columnKey",t,n.sort.sortItems);s=s>-1?s:n.sort.sortItems.length;this.getInternalModel().setProperty("/controlData/sort/sortItems/"+s+"/",{columnKey:t,operation:e})}this.updateControlDataBaseFromJson(n)};s.prototype._hasSortableColumns=function(){return o.hasSortableColumns(this.getColumnMap())};s.prototype.retrieveAdaptationUI=function(t){if(!o.hasSortableColumns(this.getColumnMap())){return null}return new Promise(function(t){sap.ui.require(["sap/m/p13n/SortPanel"],function(e){var r=this.getAdaptationData();var o=new e;o.setP13nData(r);this.oPanel=o;o.attachChange(function(t){var e=o.getP13nData(true);var r=this.getControlDataReduce();r.sort.sortItems=e.map(function(t){return{columnKey:t.name,operation:t.descending?"Descending":"Ascending"}});this.setControlDataReduce2Model(r);this.fireAfterPotentialModelChange({json:r})}.bind(this));t(o)}.bind(this))}.bind(this))};s.prototype._transformAdaptationData=function(e,r){var o=t.prototype._transformAdaptationData.apply(this,arguments);o.sorted=!!e;o.descending=e?e.operation==="Descending":false;return o};s.prototype._sortAdaptationData=function(t){this._getP13nBuilder().sortP13nData({visible:"sorted",position:"position"},t)};s.prototype._getPresenceAttribute=function(){return"sorted"};s.prototype.getChangeType=function(t,e){if(!e||!e.sort||!e.sort.sortItems){return r.personalization.ChangeType.Unchanged}var o=JSON.stringify(t.sort.sortItems)!==JSON.stringify(e.sort.sortItems);return o?r.personalization.ChangeType.ModelChanged:r.personalization.ChangeType.Unchanged};s.prototype.getChangeData=function(t,e){var r=t?.sort?.sortItems,n=e?.sort?.sortItems,s=r?.length>0&&n?.length>0;if(!t||!t.sort||!r){return{sort:{sortItems:[]}}}if(!e||!e.sort||!e.sort.sortItems){return{sort:o.copy(t.sort)}}if(JSON.stringify(r)!==JSON.stringify(e.sort.sortItems)){return{sort:o.copy(t.sort)}}if(s){if(JSON.stringify(r)===JSON.stringify(n)&&JSON.stringify(n)===JSON.stringify(this.getControlDataInitial().sort.sortItems)){return{sort:o.copy(t.sort)}}}return null};s.prototype.getUnionData=function(t,e){if(!e||!e.sort||!e.sort.sortItems){return{sort:o.copy(t.sort)}}return{sort:o.copy(e.sort)}};s.prototype.exit=function(){t.prototype.exit.apply(this,arguments);var e=this.getTable();if(e&&e.detachSort){e.detachSort(this._onSort,this)}};return s});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/UIManager", ["sap/m/p13n/modules/UIManager","sap/ui/base/Object"],function(a,n){"use strict";var t=a.extend("sap.ui.comp.personalization.UIManager",{constructor:function(a){this.oAdaptationProvider=a;n.call(this)}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Util", ["sap/base/i18n/Localization","sap/ui/comp/library","sap/m/library","sap/base/util/deepExtend","sap/ui/core/Locale","sap/ui/core/date/UI5Date"],function(e,t,r,n,a,i){"use strict";var o=t.personalization.ChangeType;var u=t.personalization.AggregationRole;var s=t.personalization.TableType;var l=t.personalization.ColumnType;var f={getColumnKeys:function(e){if(!e||!e.length){return[]}return e.map(function(e){return this.getColumnKey(e)},this)},sortItemsByText:function(t,r){var n;try{var n=new a(e.getLanguageTag()).toString();if(typeof window.Intl!=="undefined"){var i=window.Intl.Collator(n,{numeric:true});t.sort(function(e,t){return i.compare(e[r],t[r])})}else{t.sort(function(e,t){return e[r].localeCompare(t[r],n,{numeric:true})})}}catch(e){}},getUnionOfAttribute:function(e,t){var r=[];var n=function(e){if(r.indexOf(e)<0){r.push(e)}};for(var a in e){var i=e[a];if(!i[t]){continue}i[t].forEach(n)}return r},getUnionOfColumnKeys:function(e){var t=[];var r=function(e){t=t.concat(e.map(function(e){return e.columnKey}));t=t.filter(function(e,r){return t.indexOf(e)===r})};for(var n in e){for(var a in e[n]){if(!Array.isArray(e[n][a])){continue}r(e[n][a])}}return t},copy:function(e){if(e instanceof Array){return n([],e)}else{return n({},e)}},sort:function(e,t){var r=this.copy(t);r.sort(function(t,r){var n=t[e].toLocaleLowerCase();var a=r[e].toLocaleLowerCase();if(n<a){return-1}if(n>a){return 1}return 0});return r},removeEmptyProperty:function(e){for(var t in e){if(e[t]===null||e[t]===undefined){delete e[t]}}return e},semanticEqual:function(e,t){if(!e||!t){return false}for(var r in e){if(e[r]!==t[r]){return false}}return true},hasChangedType:function(e){for(var t in e){if(e[t]===o.ModelChanged||e[t]===o.TableChanged){return true}}return false},isNamespaceChanged:function(e,t){if(e[t]){return e[t]===o.ModelChanged||e[t]===o.TableChanged}return false},createArrayFromString:function(e){if(!e){return[]}var t=[];var r=e.split(",");r.forEach(function(e){if(e!==""){t.push(e.trim())}});return t},getIndexByKey:function(e,t,r){if(!r||!r.length){return-1}var n=-1;r.some(function(r,a){if(r[e]!==undefined&&r[e]===t){n=a;return true}});return n},getColumnKey:function(e){return this._getCustomProperty(e,"columnKey")||e.getId()},getColumnType:function(e){return this._getCustomProperty(e,"type")},hasSortableColumns:function(e){for(var t in e){if(f.isSortable(e[t])){return true}}return false},hasGroupableColumns:function(e){for(var t in e){if(f.isGroupable(e[t])){return true}}return false},hasFilterableColumns:function(e){for(var t in e){if(f.isFilterable(e[t])){return true}}return false},hasAggregatableColumns:function(e){for(var t in e){if(f.isAggregatable(e[t])){return true}}return false},isGroupable:function(e){if(e&&e.isA("sap.ui.table.AnalyticalColumn")){return e.isGroupableByMenu()||this._getCustomProperty(e,"isGroupable")}if(e&&e.isA("sap.m.Column")){return this.isSortable(e)}return false},isSortable:function(e){if(e.getSortProperty){return!!e.getSortProperty()}return!!this._getCustomProperty(e,"sortProperty")},isFilterable:function(e){if(e.getFilterProperty){return!!e.getFilterProperty()}return!!this._getCustomProperty(e,"filterProperty")},isAggregatable:function(e){if(e.getAggregationRole){return e.getAggregationRole()===u.Dimension||e.getAggregationRole()===u.Measure}return false},getArrayElementByKey:function(e,t,r){if(!r||!r.length){return null}var n=null;r.some(function(r){if(r[e]!==undefined&&r[e]===t){n=r;return true}});return n},isColumnIgnored:function(e,t){if(!t){return false}return t.indexOf(this.getColumnKey(e))>-1},createSort2Json:function(e,t,r,n){if(this.getTableBaseType(e)!==s.Table&&this.getTableType(e)!==s.ChartWrapper){return}this.addSortPersistentData(this._mapTable2P13nSortJson(e),{sort:{sortItems:t}},r,n)},addSortPersistentData:function(e,t,r,n){var a=[];e.sort.sortItems.forEach(function(e){if(!e.isSorted||r.indexOf(e.columnKey)>-1){return}t.sort.sortItems.push({columnKey:e.columnKey,operation:e.operation});a.push(e.columnKey)});if(n){n.forEach(function(e){if(a.indexOf(e.name)>-1||!e.sorted){return}t.sort.sortItems.push({columnKey:e.name,operation:e.sortOrder,initiallyNotVisibleColumn:true})})}},_mapTable2P13nSortJson:function(e){return{sort:{sortItems:e.getColumns().map(function(e){var t=e.getSortOrder()!=="None";if(!e.getSorted()){t=false}return{columnKey:f.getColumnKey(e),isSorted:t,operation:e.getSortOrder()}})}}},getTableType:function(e){switch(e&&e.getMetadata().getName()){case"sap.ui.comp.personalization.ChartWrapper":return s.ChartWrapper;case"sap.ui.comp.personalization.SelectionWrapper":return s.SelectionWrapper;case"sap.m.Table":return s.ResponsiveTable;case"sap.ui.table.AnalyticalTable":return s.AnalyticalTable;case"sap.ui.table.TreeTable":return s.TreeTable;case"sap.ui.table.Table":return s.Table}return null},getTableBaseType:function(e){switch(this.getTableType(e)){case s.ChartWrapper:return s.ChartWrapper;case s.SelectionWrapper:return s.SelectionWrapper;case s.ResponsiveTable:return s.ResponsiveTable;case s.AnalyticalTable:case s.Table:case s.TreeTable:return s.Table}return null},getColumnBaseType:function(e){switch(e&&e.getMetadata().getName()){case"sap.ui.comp.personalization.ColumnWrapper":return l.ColumnWrapper;case"sap.m.Column":return l.ResponsiveColumn;case"sap.ui.table.AnalyticalColumn":case"sap.ui.table.Column":return l.TableColumn}return null},_getCustomProperty:function(e,t){var r=this._getCustomData(e);if(!r||!t){return null}return r[t]},_getCustomData:function(e){if(!e){return null}var t=e.data("p13nData");if(typeof t==="string"){try{t=JSON.parse(t);e.data("p13nData",t)}catch(e){}}return t},getColumnKeysOfType:function(e,t){var r=[];for(var n in t){if(this.getColumnType(t[n])===e){r.push(n)}}return r},getColumnKeysOfFiscalTypeFields:function(e){return Object.values(e).reduce((e,t)=>{var r=this._getCustomData(t);if(r?.typeInstance?.sFiscalType){return e.concat(r.columnKey)}return e},[])},convertFilters:function(e,t){if(e&&e.filter&&e.filter.filterItems){var r=this.getColumnKeysOfType("date",t);var n=this.getColumnKeysOfType("time",t);var a=this.getColumnKeysOfType("datetime",t);e.filter.filterItems.forEach(function(e){var o=t&&t[e.columnKey];if(r.indexOf(e.columnKey)>-1||n.indexOf(e.columnKey)>-1||a.indexOf(e.columnKey)>-1){if(o&&o.data("p13nData")&&o.data("p13nData").edmType==="Edm.String"){return}if(e.value1&&typeof e.value1==="string"){e.value1=i.getInstance(e.value1)}if(e.value2&&typeof e.value2==="string"){e.value2=i.getInstance(e.value2)}}})}},convertSelectOptions:function(e,t){if(e&&e.SelectOptions){var r=this.getColumnKeysOfType("date",t);var n=this.getColumnKeysOfType("time",t);var a=this.getColumnKeysOfType("datetime",t);var o=this.getColumnKeysOfFiscalTypeFields(t);r=r.filter(function(e){return o.indexOf(e)===-1});e.SelectOptions.forEach(function(e){e.Ranges.forEach(function(t){if(r.indexOf(e.PropertyName)>-1||n.indexOf(e.PropertyName)>-1||a.indexOf(e.PropertyName)>-1){if(t.Low&&typeof t.Low==="string"){t.Low=i.getInstance(t.Low)}if(t.High&&typeof t.High==="string"){t.High=i.getInstance(t.High)}}})})}}};return f},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/personalization/Validator", ["sap/ui/comp/library","sap/m/library","sap/ui/core/Lib","sap/ui/core/message/MessageType"],function(e,r,s,o){"use strict";var n=r.P13nPanelType;var a=e.personalization.TableType;var t={checkGroupAndColumns:function(e,r,t,i,u){if(e!==a.AnalyticalTable||!r.group||!r.columns){return Promise.resolve(u)}for(var l in t){var c=r.columns.controller.isColumnSelected(i.columns,l);var p=r.group.controller.isGroupSelected(i.group,l);if(p&&!c){u.push({columnKey:l,panelTypes:[n.group,n.columns],messageType:o.Warning,messageText:s.getResourceBundleFor("sap.ui.comp").getText("PERSODIALOG_MSG_GROUPING_NOT_POSSIBLE_DESCRIPTION")})}}return Promise.resolve(u)},checkSaveChanges:function(e,r,t,i){if(e!==a.SelectionWrapper){return Promise.resolve(i)}return r.selection.payload.callbackSaveChanges(t).then(function(e){if(e){return i}i.push({panelTypes:[n.selection],messageType:o.Error,messageText:s.getResourceBundleFor("sap.ui.comp").getText("PERSODIALOG_MSG_CHANGES_SAVE_FAILED")});return i})},checkChartConsistency:function(e,r,t,i){if(e!==a.ChartWrapper){return Promise.resolve(i)}return r.dimeasure.controller.isChartConsistent(t).then(function(e){if(!e){i.push({panelTypes:[n.dimeasure],messageType:o.Error,messageText:s.getResourceBundleFor("sap.ui.comp").getText("PERSODIALOG_MSG_VALIDATION_CHARTTYPE")})}return i})},checkValidChartType:function(e,r,s,t){if(e!==a.ChartWrapper){return Promise.resolve(t)}const i=r.dimeasure.controller.isChartTypeValid();if(!i.valid){t.push({panelTypes:[n.dimeasure],messageType:o.Information,messageText:i.errorMessage})}return Promise.resolve(t)},checkVisibleItemsThreshold:function(e,r,a,t){if(!r.columns){return Promise.resolve(t)}var i=-1;if(r.columns.payload&&r.columns.payload.visibleItemsThreshold){i=r.columns.payload.visibleItemsThreshold}var u=a.columns.columnsItems.filter(function(e){return e.visible}).length;if(i>-1&&u>i){t.push({panelTypes:[n.columns],messageType:o.Warning,messageText:s.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_P13N_VISIBLE_ITEMS_THRESHOLD_MESSAGE")})}return Promise.resolve(t)}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/BaseValueListProvider", ["sap/ui/comp/library","sap/ui/core/library","sap/ui/base/EventProvider","sap/ui/comp/odata/ODataType","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/DateTimeUtil","sap/base/Log","sap/m/Token","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/table/Util","sap/base/util/isEmptyObject"],function(t,e,i,a,s,o,n,r,l,h,u,d,p){"use strict";var f=t.smartfilterbar.DisplayBehaviour;var m=t.ANALYTICAL_PARAMETER_PREFIX;const{ValueState:y}=e;var g=i.extend("sap.ui.comp.providers.BaseValueListProvider",{constructor:function(t){i.call(this);this.sFieldName=t.fieldName;this.oControl=t.control;this.oODataModel=t.model;this.oFilterModel=t.filterModel;this.oFilterProvider=t.filterProvider;this.sDisplayFormat=t.displayFormat;this._oDateFormatSettings=t.dateFormatSettings;this._oCalendarWeekSettings=t.calendarWeekSettings;this._oShowCurrentDateButton=t.showCurrentDateButton;this._aValidationPromises=[];this.sContext=t.context;this.fnAsyncWritePromise=t.fnAsyncWritePromise;this._selectedODataRowHandler=t.selectedODataRowHandler;if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}this._fieldViewMetadata=t.fieldViewMetadata;this.sValueListEntitySetName=null;this.bResolveInOutParams=t.resolveInOutParams===false?false:true;this.sDisplayBehaviour=t.displayBehaviour;this.sDDLBDisplayBehaviour=this.sDisplayBehaviour;if(!this.sDDLBDisplayBehaviour||this.sDDLBDisplayBehaviour===f.auto){this.sDDLBDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultDropDownDisplayBehaviour:f.descriptionOnly}this._sType=t.type;this._sMaxLength=t.maxLength;this.sPropertyTypePath="";if(this.bResolveInOutParams&&!this.oFilterModel&&!this.oFilterProvider){this._resolvePropertyPath()}if(t.loadAnnotation&&t.fullyQualifiedFieldName){this._oMetadataAnalyser=t.metadataAnalyser;this._sFullyQualifiedFieldName=t.fullyQualifiedFieldName;this._attachAnnotationLoadOnRender()}else{if(t.loadAnnotation){r.error("BaseValueListProvider","loadAnnotation is true, but no fullyQualifiedFieldName set for field '"+(this._sFullyQualifiedFieldName||this.sFieldName)+"'! Please check your annotations")}this._onAnnotationLoad({primaryValueListAnnotation:t.annotation,additionalAnnotations:t.additionalAnnotations})}}});g.prototype._attachAnnotationLoadOnRender=function(){this.oBeforeRenderingEventDelegate={onBeforeRendering:function(){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate,this);delete this.oBeforeRenderingEventDelegate;if(!this._bValueListRequested){if(this.bInitialised){if(this._onMetadataInitialised&&this.sAggregationName&&!this.bTypeAheadEnabled&&this.oControl.$()){this._onMetadataInitialised()}}else{this._loadAnnotation()}}}};this.oControl.addEventDelegate(this.oBeforeRenderingEventDelegate,this)};g.prototype.loadAnnotation=function(){if(this.oBeforeRenderingEventDelegate){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate,this);delete this.oBeforeRenderingEventDelegate}if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate,this);delete this.oAfterRenderingEventDelegate}return this._loadAnnotation()};g.prototype._loadAnnotation=function(){if(!this._bValueListRequested){this._bValueListRequested=true;if(!this._oMetadataAnalyser){this._oMetadataAnalyser=new s(this.oODataModel);this._bCleanupMetadataAnalyser=true}return this.getValueListAnnotation().then(this._onAnnotationLoad.bind(this),function(t){this._oError=t;this.bInitialised=true;r.debug(t);throw t}.bind(this))}return Promise.resolve()};g.prototype.getValueListAnnotation=function(){var t;if(s.hasValueListRelevantQualifiers(this._fieldViewMetadata)){t=this.oControl.getBindingContext()&&this.oControl.getBindingContext().getPath()}if(this.isFunctionImport()){const e=this.oControl.getParent().getControlFactory()._oMetaData,i=e.functionImportProperty,a=e.functionImport;return this._oMetadataAnalyser._getFunctionImportValueListAnnotationLazy(a,i,this._sFullyQualifiedFieldName,t)}return this._oMetadataAnalyser.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,t)};g.prototype.attachValueListChanged=function(t,e){this.attachEvent("valueListChanged",t,e)};g.prototype.detachValueListChanged=function(t,e){this.detachEvent("valueListChanged",t,e)};g.prototype._onAnnotationLoad=function(t){var e={};this.oPrimaryValueListAnnotation=t.primaryValueListAnnotation;this.additionalAnnotations=t.additionalAnnotations;this._resolveAnnotationData(this.oPrimaryValueListAnnotation);this.bInitialised=true;if(this._fBaseValueListProviderResolve){this._fBaseValueListProviderResolve()}if(this._onMetadataInitialised&&this.sAggregationName&&!this.bTypeAheadEnabled&&this.oControl.$()){this._onMetadataInitialised()}if(t.primaryValueListAnnotation&&t.primaryValueListAnnotation.annotation||t.primaryValueListAnnotationWithPVQualifier&&t.primaryValueListAnnotationWithPVQualifier.annotation){e.primaryValueListAnnotation=t.primaryValueListAnnotation||t.primaryValueListAnnotationWithPVQualifier}if(Array.isArray(t.additionalAnnotations)&&t.additionalAnnotations.length>0){e.additionalAnnotations=t.additionalAnnotations}if(Array.isArray(t.additionalAnnotationsWithPVQualifier)&&t.additionalAnnotationsWithPVQualifier.length>0){if(Array.isArray(e.additionalAnnotations)){e.additionalAnnotations=e.additionalAnnotations.concat(t.additionalAnnotationsWithPVQualifier)}else{e.additionalAnnotations=t.additionalAnnotationsWithPVQualifier}}return e};g.prototype._resolvePropertyPath=function(){var t=this.oControl.getBindingInfo("value"),e,i,a;if(t&&t.parts){e=t.parts[0]?t.parts[0].path:""}if(e){a=e.split("/");if(a.length>1){i=a[a.length-1];this.sPropertyTypePath=e.replace("/"+i,"")}}};g.prototype._resolveAnnotationData=function(t){var e=0,i=0,a,s,o,n=this.sValueListsDDLBDisplayBehaviour||this.sDDLBDisplayBehaviour;if(this.oODataModel&&t){this.bSupportBasicSearch=t.isSearchSupported;this.sValueListTitle=t.valueListTitle||t.qualifier;this.sKey=t.keyField;this._aKeys=t.keys;this.sValueListEntitySetName=t.valueListEntitySetName;this.mInParams=t.inParams;this.mOutParams=t.outParams;this.mConstParams=t.constParams;this.sValueListsDDLBDisplayBehaviour=this._getValueListsDDLBDisplayBehaviour(t);this.sTokenDisplayBehaviour=this.sDisplayBehaviour;if(!this.sTokenDisplayBehaviour||this.sTokenDisplayBehaviour===f.auto){this.sTokenDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultTokenDisplayBehaviour:f.descriptionAndId}this.sSingleFieldDisplayBehaviour=this.sDisplayBehaviour;if(!this.sSingleFieldDisplayBehaviour||this.sSingleFieldDisplayBehaviour===f.auto){this.sSingleFieldDisplayBehaviour=this.oFilterProvider?this.oFilterProvider.sDefaultSingleFieldDisplayBehaviour:f.descriptionAndId}if(!t.descriptionField){this.sTokenDisplayBehaviour=f.idOnly;this.sSingleFieldDisplayBehaviour=f.idOnly}if(n===f.descriptionOnly&&!t.descriptionField){this.sDescription=this.sKey}else{this.sDescription=t.descriptionField}if(this.sValueListEntitySetName&&this.sKey){this._aCols=[];this._aCombinedDescriptionColNames=[];this.aSelect=[];a=t.valueListFields;o=t.aHighImportanceFields;if(o&&o.length){this._aHighImportanceCols=[]}e=a.length;for(i=0;i<e;i++){s=a[i];if(s.visible){var l=this._getColumnConfigFromField(s);if(l&&o&&o.indexOf(s)!==-1){this._aHighImportanceCols.push(l)}if(l){this._aCols.push(l)}}this.aSelect.push(s.name)}if(t.descriptionField){this.aSelect.push(t.descriptionField)}if(t.deprecationCodeField){this.aSelect.push(t.deprecationCodeField)}}else{if(!this.sKey){r.error("BaseValueListProvider","key for ValueListEntitySetName '"+this.sValueListEntitySetName+"' missing! Please check your annotations")}}}};g.prototype._getValueListsDDLBDisplayBehaviour=function(t){var e,i;if(t&&Array.isArray(t.valueListFields)&&this._oMetadataAnalyser){i=t.valueListFields.find(function(e){return e.name===t.keyField});if(i&&i.fullName){e=this._oMetadataAnalyser.getTextArrangementValue(i.fullName)}}return e};g.prototype._getColumnConfigFromField=function(t){if(this._aCombinedDescriptionColNames&&this._aCombinedDescriptionColNames.includes(t.name)){return}var e=null,i=null,o,n,r=t.displayBehaviour||this._oMetadataAnalyser&&this._oMetadataAnalyser.getTextArrangementValue(t.fullName),l=this._oMetadataAnalyser&&this._oMetadataAnalyser.getDescriptionFieldName(t.name,this.sValueListEntitySetName),h=t.maxLength||0,u="",p=0,m=0,y=t.name,g=s.getIsTimezoneProperty(t),c,v=s.isDigitSequence(t);if(t.type==="Edm.Boolean"){e="boolean"}else if(t.type==="Edm.DateTime"&&t.displayFormat==="Date"){e="date";n=this._oDateFormatSettings;o={displayFormat:"Date"}}else if(t.type==="Edm.Decimal"){e="decimal";o={precision:t.precision,scale:t.scale}}else if(t.type==="Edm.String"){if(t.isCalendarDate){e="stringdate"}else{e="string"}}if(s.hasTextArrangementAnnotation(t)&&l&&r&&(r===f.idAndDescription||r===f.descriptionAndId)){var D=this.oPrimaryValueListAnnotation.valueListFields.find(function(t){return t.name===l});u=D?D.fieldLabel:"";p=D?D.maxLength:0;m=1;y=[t.name,l];this._aCombinedDescriptionColNames.push(l)}o=Object.assign({maxLength:""+(parseInt(h)+parseInt(p)+m),isDigitSequence:v},o);if(this.sContext==="SmartField"&&g){t.isTimezone=true;c=a.getType(t.type,{showDate:false,showTime:false},o,t)}i=a.getType(t.type,n,o,t.isCalendarDate);return{description:t.description,descriptionLabel:u,displayBehaviour:r,label:t.fieldLabel,tooltip:t.quickInfo||t.fieldLabel,type:e,oType:c||i,suggestionsWidth:d.calcColumnWidth(i,t.fieldLabel),width:d.calcColumnWidth(i,t.fieldLabel,{headerGap:true,truncateLabel:false}),template:y,sort:t.sortable?t.name:undefined,sorted:t.sortable&&t.name===this.sKey,sortOrder:"Ascending",isTimezone:t.isTimezone,fieldName:t.name,fieldTemplate:y}};g.prototype._getFilterData=function(){var t,e={};if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter){t=this.oFilterProvider._oSmartFilter.getFilterData();if(this.sFieldName&&this.sFieldName.indexOf(m)===0){Object.keys(t).forEach(function(i){var a=i.split(m);e[a[a.length-1]]=t[i]});return e}}return t};g.prototype._setFilterData=function(t){var e=t,i={};if(this.oFilterProvider){if(this.sFieldName&&this.sFieldName.indexOf(m)===0){Object.keys(t).forEach(function(e){i[m+e]=t[e]});e=i}this.oFilterProvider.setFilterData(e)}};g.prototype._adaptPropertyValue=function(t,e){var i=e;if((e instanceof Date||typeof e==="string"&&!isNaN(e))&&this.oPrimaryValueListAnnotation&&this.oPrimaryValueListAnnotation.fields){var a=null;this.oPrimaryValueListAnnotation.fields.some(function(e){if(e.name===t){a=e}return a!==null});if(a&&a.type==="Edm.DateTime"&&a.displayFormat==="Date"){i=n.utcToLocal(e)}if(a&&a.isDigitSequence){var s=new RegExp("^[0]*$");if(s.test(e)){i=null}}}return i};g.prototype._calculateFilterInputData=function(){var t,e,i=null,a,s;delete this.mFilterInputData;this.mFilterInputData={};this.aFilterField=[];if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter){i=this._getFilterData()}else if(this.oFilterModel){i=this.oFilterModel.getData()}if(this.mInParams&&i){for(t in this.mInParams){if(t){e=this.mInParams[t];e=e.replace("/",".");if(e!==this.sKey){if(this.sContext==="mdcFilterPanel"||this.sContext==="SmartFilterBar"&&this._isFieldHiddenInFilterBar(this.oFilterProvider._oSmartFilter,t)){continue}if(i[t]||i[m+t]){this.mFilterInputData[e]=i[t]||i[m+t];if(typeof this.mFilterInputData[e]==="object"){if(this.mFilterInputData[e].ranges&&this.mFilterInputData[e].ranges.length>0){for(var o=0;o<this.mFilterInputData[e].ranges.length;o++){this.mFilterInputData[e].ranges[o].keyField=e}}}this.aFilterField.push(e)}}}}}else if(this.oODataModel&&this.bResolveInOutParams){a=this.oControl.getBindingContext();if(this.mInParams&&a){for(t in this.mInParams){if(t){e=this.mInParams[t];e=e.replace("/",".");if(e!==this.sKey){var n=this.sPropertyTypePath?this.sPropertyTypePath+"/"+t:t;var r=a.getProperty(n);if(r||r===false){r=this._adaptPropertyValue(e,r);this.mFilterInputData[e]=r;this.aFilterField.push(e)}}}}}}if(this.mConstParams){for(s in this.mConstParams){this.mFilterInputData[s]=this.mConstParams[s];this.aFilterField.push(s)}}};g.prototype._isFieldHiddenInFilterBar=function(t,e){var i=t&&(t._getFilterItemByName(e)||t._getFilterItemByName(m+e));return!i||!i.getVisibleInFilterBar()};g.prototype._calculateAndSetFilterOutputData=function(t){var e,i,a,s=null,r,l,h,u,d,f,m;if(this.mOutParams&&t&&(this.oFilterProvider||this.oFilterModel)){s={};d=function(t){return t.key===h.key};f=function(t){if(h.value1 instanceof Date&&t.value1 instanceof Date){return t.operation==="EQ"&&h.value1.getTime()===t.value1.getTime()}return t.operation==="EQ"&&h.value1===t.value1};m=function(t){return t.operation==="EQ"&&h.key===t.value1};for(e in this.mOutParams){if(e){if(!this.oFilterProvider&&Object.keys(this.mOutParams).length>1){if(e!==this.sFieldName){continue}}var y=this.oFilterProvider&&this.oFilterProvider._getFieldMetadata(e);a=this.mOutParams[e];if(t.length>0){for(var u=0;u<this._aCols.length;u++){if(this._aCols[u].template===a){var g=this._aCols[u].description;i=t[0][g]}}}if(a!==this.sKey){l=null;u=t.length;while(u--){r=t[u];if(this.sContext==="mdcFilterPanel"||this.sContext==="SmartFilterBar"&&this._isFieldHiddenInFilterBar(this.oFilterProvider._oSmartFilter,e)){continue}if(r[a]){var c=r[a];var v=y&&(y.type==="Edm.DateTime"||!y.hasValueListAnnotation);if(v){if(y.type==="Edm.DateTime"&&this._oDateFormatSettings.UTC==true&&n._isValidDateObject(c)){c=n.utcToLocal(c)}h={exclude:false,operation:"EQ",keyField:e,value1:c,value2:null}}else{h={key:c,text:o.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,c,i)}}if(!s[e]){if(!l&&this.oFilterModel){l=this.oFilterModel.getData()}if(l&&l[e]&&l[e].items){s[e]=l[e];if(!s[e].ranges){s[e].ranges=[]}}else{s[e]={items:[],ranges:[]}}}var D=s[e];if(v){if(D.ranges.filter(f).length<=0){D.ranges.push(h)}}else if(D.items.filter(d).length<=0){if(!D.ranges||D.ranges.filter(m).length<=0){D.items.push(h)}}}}}}}if(s){if(this.oFilterProvider){this._clearErrorState(s);this._setFilterData(s);if(!p(s)){this.fireEvent("valueListChanged",{changes:Object.keys(s)})}}else if(this.oFilterModel){this.oFilterModel.setData(s,true)}}}else if(this.oODataModel&&this.bResolveInOutParams){this._calculateAndSetODataModelOutputData(t[0])}};g.prototype._clearErrorState=function(t){const e=Object.keys(t);e?.forEach(function(t){const e=this.oFilterProvider?._oSmartFilter?._getFilterItemByName(t),i=e?.getControl?.();if(i?.getValueState()===y.Error){i.setValueState(y.None)}},this)};g.prototype._calculateAndSetODataModelOutputData=function(t){var e,i,a,s,o,n={};if(t&&this.mOutParams){e=this.oControl.getBindingContext();for(i in this.mOutParams){if(i){a=this.mOutParams[i];if(a!==this.sKey){o=t[a];n[i]=o;s=this.sPropertyTypePath?this.sPropertyTypePath+"/"+i:i;this.oODataModel.setProperty(s,o,e,true)}}}if(n&&!jQuery.isEmptyObject(n)){this.fireEvent("valueListChanged",{changes:n})}}};g.prototype._handleRowsSelect=function(t){var e,i,a,s,n,r=[],h,u;if(!(this.oControl&&this.oControl.addToken)){return}h=this.oControl.getTokens();for(e=0;e<t.length;e++){a=t[e][this.sKey];s=t[e][this.sDescription];if(a||a===""){s=o.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,a,s);n=new l({key:a,text:s,tooltip:s});n.data("row",t[e]);r.push(n);for(i=0;i<h.length;i++){u=h[i];var d=u.getKey();if(d||d===""&&d===a){break}else if(u.data("range")&&!u.data("range").exclude&&u.data("range").operation==="EQ"&&u.data("range").value1==a){break}}if(i<h.length){h.splice(i,1)}}}if(r.length){this.oControl.setTokens(h.concat(r))}};g.prototype.readData=function(t){var e=[],i;this._oReadPromise=new Promise(function(t){this._fBaseValueListProviderResolve=t}.bind(this));if(this.bInitialised){this._fBaseValueListProviderResolve()}this._oReadPromise.then(function(){this._fBaseValueListProviderResolve=null;for(var a=0;a<t.length;a++){i=this.sDisplayFormat==="UpperCase"?t[a].toUpperCase():t[a];e.push(new h(this.sKey,u.EQ,i))}if(!this.sValueListEntitySetName){return}this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:e,success:function(e,i){if(e){if(e.results&&e.results.length!==t.length){r.error("Expecting "+t.length+" result rows, but received "+e.results.length+" rows...");return}var a=e.results;if(this.oControl&&this.oControl.isA("sap.m.MultiInput")&&this.oControl.getTokens().length!==t.length){a=this._getUpdatedDataModelRows(a)}this._handleRowsSelect(a)}}.bind(this),error:function(t){r.error("Error occured reading /"+this.sValueListEntitySetName)}.bind(this)})}.bind(this))};g.prototype._getUpdatedDataModelRows=function(t){var e=this.oControl.getTokens(),i=[];for(var a=0;a<e.length;a++){var s=e[a];var o=s.getKey();if(o){i.push(o)}else if(s.data("range")&&s.data("range").value1){i.push(s.data("range").value1)}}var n=[];for(var a=0;a<t.length;a++){var r=t[a][this.sKey];if(i.indexOf(r)!==-1){n.push(t[a])}}return n};g.prototype._addValidationPromise=function(t){var e,i,a,s=false;for(e=0;e<this._aValidationPromises.length;e++){a=this._aValidationPromises[e];if(a===null){this._aValidationPromises[e]=t;i=e;s=true;break}}if(!s){this._aValidationPromises.push(t);i=this._aValidationPromises.length-1}t.finally(function(){this._removeValidationPromise(i)}.bind(this))};g.prototype._removeValidationPromise=function(t){this._aValidationPromises[t]=null};g.prototype._getCurrentValidationPromises=function(){var t,e,i=[];for(t=0;t<this._aValidationPromises.length;t++){e=this._aValidationPromises[t];this._removeValidationPromise(t);i.push(e)}return i};g.prototype._isMultiFilterField=function(t){return t.isA("sap.m.MultiInput")};g.prototype._getDisplayBehaviour=function(){return this._isMultiFilterField(this.oControl)?this.sTokenDisplayBehaviour:this.sSingleFieldDisplayBehaviour};g.prototype.setValue=function(t){var e=this.oControl,i=e&&e.getBinding("value"),a=i&&i.getType();if(a&&a.isA("sap.ui.comp.smartfield.type.TextArrangement")){a.setSelectedValue(t)}e.setValue(t)};g.prototype.isFunctionImport=function(){return this.sContext==="SmartField"&&this.oControl?.getParent()?.getControlFactory()?._oMetaData?.functionImportProperty};g.prototype.destroy=function(){i.prototype.destroy.apply(this,arguments);if(this._bCleanupMetadataAnalyser&&this._oMetadataAnalyser){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this.oBeforeRenderingEventDelegate){this.oControl.removeEventDelegate(this.oBeforeRenderingEventDelegate);delete this.oBeforeRenderingEventDelegate}if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate);delete this.oAfterRenderingEventDelegate}this.oControl=null;this.sFieldName=null;this.mFilterInputData=null;this.aFilterField=null;this.sValueListEntitySetName=null;this.oODataModel=null;this.oFilterModel=null;this.oFilterProvider=null;this.oPrimaryValueListAnnotation=null;this.additionalAnnotations=null;this.sDisplayFormat=null;this.bSupportBasicSearch=null;this.bInitialised=null;this._oError=null;this.sValueListTitle=null;this.sKey=null;this._aKeys=null;this.mInParams=null;this.mOutParams=null;this.sDescription=null;this.aSelect=null;this._aCols=null;this._aHighImportanceCols=null;this.sDDLBDisplayBehaviour=null;this.sTokenDisplayBehaviour=null;this._oDateFormatSettings=null;this._oCalendarWeekSettings=null;this._oShowCurrentDateButton=null;this._fieldViewMetadata=null;this._oReadPromise=null;this._fBaseValueListProviderResolve=null;this.bIsDestroyed=true;this._aValidationPromises=null};return g});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ChartProvider", ["sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/ChartMetadata","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/odata/type/FiscalDate","sap/ui/comp/odata/type/CalendarDate","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/odata/ODataType","./ControlProvider","sap/ui/core/Lib","sap/ui/core/format/DateFormat","sap/ui/core/date/UI5Date"],function(t,e,a,i,n,r,s,o,l,h,d){"use strict";var u=function(a){this._oRb=l.getResourceBundleFor("sap.ui.comp");if(a){this._oParentODataModel=a.model;this.sEntitySet=a.entitySet;this._sIgnoredFields=a.ignoredFields;this._bSkipAnnotationParse=a.skipAnnotationParse==="true";this._sChartQualifier=a.chartQualifier;this._sPresentationVariantQualifier=a.presentationVariantQualifier;this._oDefaultDropDownDisplayBehaviour=a.defaultDropDownDisplayBehaviour;this._sNotAssignedText=a.notAssignedText;try{this._oDateFormatSettings=a.dateFormatSettings?JSON.parse(a.dateFormatSettings):undefined;if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}}catch(t){}if(a.chartLibrary){e.feedWithChartLibrary(a.chartLibrary,a.criticalityType)}}this._aODataFieldMetadata=[];this._oChartViewMetadata=null;this._oChartDataPointMetadata=null;this._aIgnoredFields=[];this._oMetadataAnalyser=new t(this._oParentODataModel);this._intialiseMetadata()};u.prototype._intialiseMetadata=function(){var t,a=[],i,n,r=0;this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);this._sFullyQualifiedEntityTypeName=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);if(!this._bSkipAnnotationParse){this._oPresentationVariant=this._oMetadataAnalyser.getPresentationVariantAnnotation(this._sFullyQualifiedEntityTypeName,this._sPresentationVariantQualifier);if(this._oPresentationVariant&&this._oPresentationVariant.chartAnnotation){this._oChartAnnotation=this._oPresentationVariant.chartAnnotation}else{this._oChartAnnotation=this._oMetadataAnalyser.getChartAnnotation(this._sFullyQualifiedEntityTypeName,this._sChartQualifier)}}if(!this._oDefaultDropDownDisplayBehaviour){this._oDefaultDropDownDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(this._sFullyQualifiedEntityTypeName)}this._generateIgnoredFieldsArray();this._oControlProvider=new o({metadataAnalyser:this._oMetadataAnalyser,model:this._oParentODataModel,fieldsMetadata:this._aODataFieldMetadata,dateFormatSettings:this._oDateFormatSettings,defaultDropDownDisplayBehaviour:this._oDefaultDropDownDisplayBehaviour,enableDescriptions:false,entitySet:this.sEntitySet});if(this._aODataFieldMetadata){this._prepareHierarchy();r=this._aODataFieldMetadata.length}for(n=0;n<r;n++){i=this._aODataFieldMetadata[n];if(this._aIgnoredFields.indexOf(i.name)>-1||!i.visible){continue}if(i.type.indexOf("Edm.")===0){t=this._getFieldViewMetadata(i);this._enrichWithChartViewMetadata(i,t);a.push(i)}}if(this._oChartAnnotation){this._oChartViewMetadata=Object.assign({},this._oChartAnnotation);this._oChartViewMetadata.chartType=e.getChartType(this._oChartViewMetadata.chartType);this._oChartViewMetadata.fields=a}};u.prototype._prepareHierarchy=function(){for(var t=0;t<this._aODataFieldMetadata.length;t++){if(this._aODataFieldMetadata[t].hierarchy){for(var e=0;e<this._aODataFieldMetadata.length;e++){this._aODataFieldMetadata[e].hierarchy=this._aODataFieldMetadata[e].hierarchy||{};this._aODataFieldMetadata[e].hierarchy.up=this._aODataFieldMetadata[e].hierarchy.up||{};if(this._aODataFieldMetadata[t].hierarchy.field===this._aODataFieldMetadata[e].name){this._aODataFieldMetadata[t].hierarchy.down=this._getFieldViewMetadata(this._aODataFieldMetadata[e]);this._aODataFieldMetadata[e].hierarchy.up[this._aODataFieldMetadata[t].hierarchy.type]=this._getFieldViewMetadata(this._aODataFieldMetadata[t])}}}}};u.prototype._setAnnotationMetadata=function(t){if(t&&t.fullName){var e=this._oMetadataAnalyser.getSemanticObjectsFromAnnotation(t.fullName);if(e){t.semanticObjects=e}}};u.prototype._getFieldViewMetadata=function(t){var e=this._oControlProvider.getFieldViewMetadata(t,false);this._setAnnotationMetadata(e);return e};u.prototype._generateIgnoredFieldsArray=function(){if(this._sIgnoredFields){this._aIgnoredFields=this._sIgnoredFields.split(",")}};u.prototype._enrichWithChartViewMetadata=function(e,a){function i(t,e,a){if(e.aggregationRole){return e.aggregationRole===t}if(a){var i=t=="dimension"?a.dimensionFields:a.measureFields;return i&&i.indexOf(e.name)!=-1}return false}e.isMeasure=i("measure",e,this._oChartAnnotation);e.isDimension=i("dimension",e,this._oChartAnnotation);e.isHierarchyDimension=e.hierarchy&&e.hierarchy.type===t.hierarchyType.nodeFor&&i("dimension",e.hierarchy.down,this._oChartAnnotation);e.quickInfo=a.quickInfo;e.modelType=a.modelType;e.hasValueListAnnotation=a.hasValueListAnnotation;e.fullName=a.fullName;e.timeUnitType=this._getTimeUnitType(e);e.customFormatter=this._getCustomFormatter(e);e.isTimeDimension=e.timeUnitType!==undefined;e.role=this._getRole(e);e.hierarchyLevel=this._getHierarchyLevel(e);e.dataPoint=this._getDataPoint(e);e.isNullable=t.isNullable(e);e.filterType=a.filterType;if(a.template){e.template=a.template}if(e.isDimension){e.displayBehaviour=a.displayBehaviour}else if(e.isHierarchyDimension){var n=e.hierarchy.up[t.hierarchyType.nodeExternalKeyFor]||a;e.displayBehaviour=n.displayBehaviour;e.description=n.description||n.name}e.isSemanticObject=a.semanticObjects?true:false;this._setInResult(e);this._setSortOrder(e)};u.prototype._getTimeUnitType=function(t){var e;switch(t.type){case"Edm.Date":e="Date";break;case"Edm.DateTime":case"Edm.DateTimeOffset":if(t.displayFormat==="Date"){e="Date"}break;case"Edm.String":if(a.isFiscalValue(t)){var i=a.getFiscalAnnotationType(t);if(i){var n={IsFiscalWeek:{timeUnitType:undefined},IsFiscalQuarter:{timeUnitType:undefined},IsFiscalPeriod:{timeUnitType:undefined},IsFiscalYearWeek:{timeUnitType:undefined},IsFiscalYearQuarter:{timeUnitType:undefined},IsFiscalYear:{timeUnitType:"fiscalyear"},IsFiscalYearPeriod:{timeUnitType:"fiscalyearperiod"}};e=n[i].timeUnitType;break}}var r=this._getCalendarAnnotationType(t);if(r){var s={IsCalendarYearWeek:{timeUnitType:"yearweek"},IsCalendarYearMonth:{timeUnitType:"yearmonth"},IsCalendarYearQuarter:{timeUnitType:"yearquarter"},IsCalendarWeek:{timeUnitType:undefined},IsCalendarMonth:{timeUnitType:undefined},IsCalendarQuarter:{timeUnitType:undefined},IsCalendarYear:{timeUnitType:undefined},IsCalendarDate:{timeUnitType:"yearmonthday"}};e=s[r].timeUnitType;break}break}return e};u.prototype._getCustomFormatter=function(t){var e,a;var i;switch(t.type){case"Edm.Boolean":e=function(e){return t.modelType.formatValue(e,"string")};return e;case"Edm.Date":a=h.getDateInstance(this._oDateFormatSettings);break;case"Edm.Time":a=h.getTimeInstance(this._oDateFormatSettings);break;case"Edm.DateTimeOffset":case"Edm.DateTime":if(t.type==="Edm.DateTimeOffset"&&t.timezone){a=h.getDateTimeWithTimezoneInstance(this._oDateFormatSettings);break}if(t.displayFormat==="Date"){a=h.getDateInstance(this._oDateFormatSettings)}else{var n=Object.assign({},this._oDateFormatSettings);delete n.UTC;a=h.getDateTimeInstance(n)}break;case"Edm.String":if(r.isDate(t)&&this._oDateFormatSettings){if(!e){var o=s.getType("Edm.String",this._oDateFormatSettings,i,{isCalendarDate:true});e=function(t){return o.formatValue(t,"string")}}}else{e=this._getDateFormatterForAnnotation(t,i)}break}if(a){e=function(t,e){if(this._checkForEmptyDates(t)){return this._sNotAssignedText}if(!t){return null}var i=d.getInstance(t);return a.format(i,e)}.bind(this)}return e};u.prototype._getDateFormatterForAnnotation=function(t,e){var o={};var l=null;if(a.isFiscalValue(t)){var d=new i(null,null,{fiscalType:a.getFiscalAnnotationType(t)});l=function(t){if(this._checkForEmptyDates(t)){return this._sNotAssignedText}return d.formatValue(t,"string")}.bind(this);return l}if(this._oDateFormatSettings){Object.assign(o,this._oDateFormatSettings)}if(r.isCalendarValue(t)){var u=this._getCalendarAnnotationType(t);if(u==="IsCalendarDate"){o.pattern="d MMMM y";var p=s.getType("Edm.String",o,e,{isCalendarDate:true});var y=h.getInstance({pattern:"yyyyMMdd"});l=function(t){if(this._checkForEmptyDates(t)){return this._sNotAssignedText}var e=y.parse(t);return p.formatValue(e,"string")}.bind(this)}else{var m=new n(null,null,{calendarType:u});l=function(t){if(this._checkForEmptyDates(t)){return this._sNotAssignedText}return m.formatValue(t,"string")}.bind(this)}return l}return null};u.prototype._checkForEmptyDates=function(t){return!!(t==""||t=="00000000")};u.prototype._getCalendarAnnotationType=function(t){return r.getCalendarAnnotationType(t)||(r.isDate(t)?"IsCalendarDate":undefined)};u.prototype._setInResult=function(t){if(this._oPresentationVariant){if(this._oPresentationVariant.requestAtLeastFields&&this._oPresentationVariant.requestAtLeastFields.indexOf(t.name)>-1){t.inResult=true}}};u.prototype._setSortOrder=function(t){t.sorted=false;t.sortOrder="None";var e;if(this._oPresentationVariant&&this._oPresentationVariant.sortOrderFields){e=this._oPresentationVariant.sortOrderFields.length;for(var a=0;a<e;a++){if(this._oPresentationVariant.sortOrderFields[a].name===t.name){t.sorted=true;t.sortOrder=this._oPresentationVariant.sortOrderFields[a].descending?"Descending":"Ascending";t.sortIndex=a;break}}}};u.prototype._unmarkTextDimensions=function(t,e){var a,i;for(a=0;a<t.length;a++){i=t[a];if(i.isDimension){if(e.indexOf(i.name)>-1){i.isDimension=false}}}};u.prototype._getRole=function(t){if(this._oChartAnnotation){if((t.isDimension||t.isHierarchyDimension)&&this._oChartAnnotation.dimensionAttributes[t.name]){return e.getDimensionRole(this._oChartAnnotation.dimensionAttributes[t.name].role)}else if(t.isMeasure&&this._oChartAnnotation.measureAttributes[t.name]){return e.getMeasureRole(this._oChartAnnotation.measureAttributes[t.name].role)}}};u.prototype._getHierarchyLevel=function(t){if(this._oChartAnnotation){if(t.isHierarchyDimension&&this._oChartAnnotation.dimensionAttributes[t.name]){var e=null;try{e=parseInt(this._oChartAnnotation.dimensionAttributes[t.name].hierarchyLevel)}catch(t){e=0}return e}return 0}};u.prototype._getTextPropertyForHierachyDimension=function(e){var a=e.hierarchy.up[t.hierarchyType.nodeExternalKeyFor]||e;return a.description||a.name};u.prototype._getDataPoint=function(t){if(this._oChartAnnotation&&t.isMeasure&&this._oChartAnnotation.measureAttributes[t.name]&&this._oChartAnnotation.measureAttributes[t.name].dataPoint){var e=this._oChartAnnotation.measureAttributes[t.name].dataPoint;var a=e.split("#");var i=a.length===2?a[1]:"";return this._getMeasureDataPoint(i,t.name)}return null};u.prototype.getChartViewMetadata=function(){return this._oChartViewMetadata};u.prototype.getViewField=function(t){var e=this._oChartViewMetadata.fields.filter(function(e){return e.name===t})[0];return e};u.prototype.getChartDataPointMetadata=function(){if(!this._oChartDataPointMetadata&&this._sFullyQualifiedEntityTypeName){this._oChartDataPointMetadata=this._oMetadataAnalyser.getDataPointAnnotation(this._sFullyQualifiedEntityTypeName)}return this._oChartDataPointMetadata};u.prototype._getMeasureDataPoint=function(t,e){var a=this.getChartDataPointMetadata();if(a){var i=null;if(t){if(a.additionalAnnotations){i=a.additionalAnnotations[t]}}else if(a.primaryAnnotation){i=a.primaryAnnotation}if(i!=null&&i.Value&&i.Value.Path==e){return i}}return null};u.prototype.getIsUTCDateHandlingEnabled=function(){return this._oDateFormatSettings?this._oDateFormatSettings.UTC:false};u.prototype.destroy=function(){if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this._oControlProvider&&this._oControlProvider.destroy){this._oControlProvider.destroy()}this._oControlProvider=null;this._aODataFieldMetadata=null;this._oChartViewMetadata=null;this._oChartDataPointMetadata=null;this._sIgnoredFields=null;this.bIsDestroyed=true};u.prototype.provideSemanticColoring=function(t){var a={};if(t.Criticality){if(t.Criticality.Path){a={Calculated:t.Criticality.Path}}else{a={Static:e.getCriticalityType(t.Criticality.EnumMember)}}}else{var i={};var n=this._buildThresholds(i,t.CriticalityCalculation);if(n){a={ConstantThresholds:i}}else{a={DynamicThresholds:i}}}return a};u.prototype.calculateDimensionColoring=function(t){var a=e.getValueCriticality(t);if(!a){return null}var i,n,r={Positive:{Values:[]},Critical:{Values:[]},Negative:{Values:[]},Neutral:{Values:[]}};for(var s=0;s<a.length;s++){n=a[s];i=e.calculateValue(n.Value);if(n.Criticality.EnumMember.endsWith("Positive")){r.Positive.Values.push(i)}else if(n.Criticality.EnumMember.endsWith("Critical")){r.Critical.Values.push(i)}else if(n.Criticality.EnumMember.endsWith("Negative")){r.Negative.Values.push(i)}else{r.Neutral.Values.push(i)}}return r};u.prototype._buildThresholds=function(t,a){var i=true;t.ImprovementDirection=e.getImprovementDirectionType(a.ImprovementDirection.EnumMember);var n=e.getCriticalityThresholds();var r=n.length;var s={oneSupplied:false};var o={oneSupplied:false};for(var l=0;l<r;l++){s[n[l]]=a[n[l]]?a[n[l]].Path:undefined;s.oneSupplied=s.oneSupplied||s[n[l]];if(!s.oneSupplied){o[n[l]]=e.calculateConstantValue(a[n[l]]);o.oneSupplied=o.oneSupplied||o[n[l]]}}if(s.oneSupplied){i=false;for(var l=0;l<r;l++){if(s[n[l]]){t[n[l]]=s[n[l]]}}}else{var h;t.AggregationLevels=[];if(o.oneSupplied){h={VisibleDimensions:null};for(var l=0;l<r;l++){if(o[n[l]]){h[n[l]]=o[n[l]]}}t.AggregationLevels.push(h)}if(a.ConstantThresholds&&a.ConstantThresholds.length>0){for(var l=0;l<a.ConstantThresholds.length;l++){var d=a.ConstantThresholds[l];var u=d.AggregationLevel?[]:null;if(d.AggregationLevel&&d.AggregationLevel.length>0){for(var p=0;p<d.AggregationLevel.length;p++){u.push(d.AggregationLevel[p].PropertyPath)}}h={VisibleDimensions:u};for(var p=0;p<r;p++){var y=e.calculateConstantValue(d[n[p]]);if(y){h[n[p]]=y}}t.AggregationLevels.push(h)}}}return i};u.prototype.getMaxItems=function(){var t=-1;if(this._oPresentationVariant&&this._oPresentationVariant.maxItems){t=this._oPresentationVariant.maxItems}return t};u.prototype.getIgnoredChartTypesForTimeSeries=function(){return e.getIgnoredChartTypesForTimeSeries()};return u},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ControlProvider", ["sap/m/CheckBox","sap/m/DatePicker","sap/m/TimePicker","sap/m/HBox","sap/m/Input","sap/m/Text","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/Image","sap/m/Link","sap/m/VBox","sap/m/FlexItemData","sap/m/library","sap/ui/comp/navpopover/SmartLink","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfield/ODataHelper","sap/ui/comp/smartfield/SmartField","sap/ui/comp/odata/ODataType","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/odata/CriticalityMetadata","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/MultiUnitUtil","sap/ui/core/Control","sap/ui/comp/navpopover/SemanticObjectController","./ValueHelpProvider","./ValueListProvider","sap/ui/comp/library","sap/base/Log","sap/ui/core/Lib","sap/ui/core/Element"],function(e,t,i,a,n,r,o,s,l,c,d,p,u,m,h,y,f,g,_,b,S,T,C,v,D,F,O,A,M,I,L){"use strict";var x;var P=function(e){if(e){this._oParentODataModel=e.model;this._oMetadataAnalyser=e.metadataAnalyser;this._aODataFieldMetadata=e.fieldsMetadata;this._oLineItemAnnotation=e.lineItemAnnotation;this._oSemanticKeyAnnotation=e.semanticKeyAnnotation;this._smartTableId=e.smartTableId;this._bProcessDataFieldDefault=e.processDataFieldDefault;this._isAnalyticalTable=e.isAnalyticalTable;this._isMobileTable=e.isMobileTable;this._oDateFormatSettings=e.dateFormatSettings;this._useUTCDateTime=e.useUTCDateTime;this._bEnableDescriptions=e.enableDescriptions;this._oCurrencyFormatSettings=e.currencyFormatSettings;this._oDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour||"descriptionAndId";this.useSmartField=e.useSmartField==="true";this.useSmartToggle=e.useSmartToggle==="true";this.defaultFilterBarExpanded=e.defaultFilterBarExpanded;this.defaultShowAllFilters=e.defaultShowAllFilters;this._sEntitySet=e.entitySet;this._oSemanticKeyAdditionalControl=e._semanticKeyAdditionalControl;this._oSemanticObjectController=e.semanticObjectController;this._bPreserveDecimals=e.preserveDecimals;this._oCustomizeConfigTextInEditModeSource=e.textInEditModeSource;this._oCustomizeConfigIgnoreInsertRestrictions=e.ignoreInsertRestrictions;this._oCustomizeConfigClientSideMandatoryCheck=e.clientSideMandatoryCheck}if(!this._oMetadataAnalyser&&this._oParentODataModel){this._oMetadataAnalyser=new h(this._oParentODataModel);this._intialiseMetadata()}this._mSmartField={};this._oHelper=new y(this._oMetadataAnalyser.oModel,null,null,true);this._aValueListProvider=[];this._aValueHelpProvider=[];this._aSmartLinks=[]};P.prototype._intialiseMetadata=function(){if(!this._aODataFieldMetadata){this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntity)}};P.prototype.getFieldViewMetadata=function(e,t){var i=this._createFieldMetadata(e);this._createFieldTemplate(i,t);return i};P.prototype._getTextInEditModeSource=function(e){if(!this._oCustomizeConfigTextInEditModeSource){return A.smartfield.TextInEditModeSource.None}return this._oCustomizeConfigTextInEditModeSource[e.name]||this._oCustomizeConfigTextInEditModeSource["*"]||A.smartfield.TextInEditModeSource.None};P.prototype._getIgnoreInsertRestrictions=function(e){if(!this._oCustomizeConfigIgnoreInsertRestrictions){return false}if(this._oCustomizeConfigIgnoreInsertRestrictions.hasOwnProperty(e.name)){return this._oCustomizeConfigIgnoreInsertRestrictions[e.name]}return this._oCustomizeConfigIgnoreInsertRestrictions["*"]||false};P.prototype._getClientSideMandatoryCheck=function(e){if(!this._oCustomizeConfigClientSideMandatoryCheck){return true}if(this._oCustomizeConfigClientSideMandatoryCheck.hasOwnProperty(e.name)){return this._oCustomizeConfigClientSideMandatoryCheck[e.name]}return this._oCustomizeConfigClientSideMandatoryCheck["*"]||false};P.prototype._createFieldTemplate=function(e,t){if(this.useSmartField){e.template=new f({textInEditModeSource:this._getTextInEditModeSource(e),value:{path:e.name},entitySet:this._sEntitySet,contextEditable:{path:"sm4rtM0d3l>/editable",mode:"OneWay"},controlContext:this._isMobileTable?"responsiveTable":"table",wrapping:this._isMobileTable,clientSideMandatoryCheck:this._getClientSideMandatoryCheck(e)});if(g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){e.template.setTextAlign("Right");e.template.setWidth("100%")}this._completeSmartField(e);e.template._setPendingEditState(t)}if(this.useSmartToggle){e.template=new x({editable:{path:"sm4rtM0d3l>/editable",mode:"OneWay"},edit:this.useSmartField?e.template:this._createEditableTemplate(e),display:this._createDisplayOnlyTemplate(e)})}else if(!this.useSmartField){e.template=t?this._createEditableTemplate(e):this._createDisplayOnlyTemplate(e)}};P.prototype._addCustomDataToConfigData=function(e,t,i,a){if(e==="true"||e==="false"){i[a]=e}else if(typeof e==="object"&&e!==null&&e[t.name]){i[a]=e[t.name]}};P.prototype._completeSmartField=function(e){var t,i,a={annotations:{},path:e.name,ignoreInsertRestrictions:this._getIgnoreInsertRestrictions(e)};if(!this._mSmartField.entitySetObject){this._mSmartField.entitySetObject=this._oHelper.oMeta.getODataEntitySet(this._sEntitySet);this._mSmartField.entityType=this._oHelper.oMeta.getODataEntityType(this._mSmartField.entitySetObject.entityType)}a.modelObject=this._oParentODataModel;a.entitySetObject=this._mSmartField.entitySetObject;a.entitySet=this._mSmartField.entitySetObject;a.entityType=this._mSmartField.entityType;this._oHelper.getProperty(a);e.fieldControlProperty=this._oHelper.oAnnotation.getFieldControlPath(a.property.property);if(e.fieldControlProperty&&e.parentPropertyName){e.fieldControlProperty=e.parentPropertyName+"/"+e.fieldControlProperty}a.annotations.uom=this._oHelper.getUnitOfMeasure2(a);a.annotations.text=this._oHelper.getTextProperty2(a);a.annotations.lineitem=this._oLineItemAnnotation;a.annotations.semantic=h.getSemanticObjectsFromProperty(a.property.property);this._oHelper.getUOMTextAnnotation(a);if(a.property.property["sap:value-list"]||a.property.property["com.sap.vocabularies.Common.v1.ValueList"]){a.annotations.valuelist=this._oHelper.getValueListAnnotationPath(a);if(a.property.property["sap:value-list"]){a.annotations.valuelistType=a.property.property["sap:value-list"]}else{a.annotations.valuelistType=this._oMetadataAnalyser.getValueListSemantics(a.property.property["com.sap.vocabularies.Common.v1.ValueList"])}}if(a.property.property["com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]){a.annotations.valuelistType=h.getValueListMode(a.property.property)}this._oHelper.getUOMValueListAnnotationPath(a);delete a.entitySet;if(this.defaultFilterBarExpanded){this._addCustomDataToConfigData(this.defaultFilterBarExpanded,e,a,"defaultFilterBarExpanded")}if(this.defaultShowAllFilters){this._addCustomDataToConfigData(this.defaultShowAllFilters,e,a,"defaultShowAllFilters")}if(a.annotations.valuelist!==undefined){if(e.template.getTextInEditModeSource()!=="None"){i=function(){if(t===undefined){t=this._oHelper.getAnalyzer().getValueListAnnotationLazy(a.annotations.valuelist)}return t}.bind(this)}}else{e.template.setTextInEditModeSource("None")}e.template.data("configdata",{configdata:a,configdataVL:i});e.template.data("dateFormatSettings",this._oDateFormatSettings);e.template.data("currencyFormatSettings",this._oCurrencyFormatSettings);e.template.data("defaultDropDownDisplayBehaviour",this._oDefaultDropDownDisplayBehaviour);e.template.data("defaultInputFieldDisplayBehaviour",e.displayBehaviour);if(a.annotations.uom||g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){var n=e.template.getTextAlign();if(n==="Initial"){n="Right"}if(g.isNumeric(e.type)&&!e.unit&&e.description&&e.displayBehaviour!=="idOnly"){n=undefined}e.align=n}P._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals)};P.prototype._createEditableTemplate=function(a,r){var o=null,s=P._createModelTypeInstance(a,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals);var l=a.type==="Edm.DateTime"&&a.displayFormat==="Date";if(l||a.isCalendarDate){o=new t({value:{path:a.name,type:s}})}else if(a.type==="Edm.Boolean"){o=new e({selected:{path:a.name}})}if(a.semanticObjects&&!r){o=this._createSmartLinkFieldTemplate(a,s,function(){return this._createEditableTemplate(a,true)}.bind(this))}if(!o){if(a.type==="Edm.Time"){o=new i({value:{path:a.name,type:s}})}else if(a.type==="Edm.String"&&a.isTimezone){o=new n({value:this._getDefaultBindingInfo(a,s)})}else{o=new n({value:{path:a.name,type:s}});if(a.unit){o.bindProperty("description",{path:a.unit});o.setTextAlign("Right");o.setTextDirection("LTR");o.setFieldWidth("80%")}else if(this._bEnableDescriptions&&a.description){o.bindProperty("description",{path:a.description})}else if(g.isNumeric(a.type)||g.isDateOrTime(a.type)||b.isCalendarValue(a)||_.isFiscalValue(a)){a.align="Right";o.setTextAlign("Right");o.setTextDirection("LTR");if(a.timezone){o.bindProperty("description",{path:a.timezone})}}if(a.hasValueListAnnotation){this._associateValueHelpAndSuggest(o,a)}}}return o};P.prototype._associateValueHelpAndSuggest=function(e,t){e.setShowValueHelp(true);this._aValueHelpProvider.push(new F({fieldName:t.fieldName,control:e,model:this._oParentODataModel,dateFormatSettings:this._oDateFormatSettings,displayFormat:t.displayFormat,displayBehaviour:t.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,title:t.label,preventInitialDataFetchInValueHelpDialog:true,takeOverInputValue:false,type:t.type,maxLength:t.maxLength}));e.setShowSuggestion(true);e.setFilterSuggests(false);this._aValueListProvider.push(new O({fieldName:t.fieldName,control:e,model:this._oParentODataModel,displayFormat:t.displayFormat,dateFormatSettings:this._oDateFormatSettings,displayBehaviour:t.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,aggregation:"suggestionRows",typeAheadEnabled:true}))};P.prototype._createDisplayOnlyTemplate=function(e,t){var i=null,a=null,n,o,s;a=P._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals);if(g.isNumeric(e.type)||g.isDateOrTime(e.type)||b.isCalendarValue(e)||_.isFiscalValue(e)){n="Right";if(g.isNumeric(e.type)&&!e.unit&&e.description&&e.displayBehaviour!=="idOnly"){n=undefined}}if(e.urlInfo){i=this._createLink(e,a,e.urlInfo)}else if(e.criticalityInfo){i=this._createObjectStatusTemplate(e,a,e.criticalityInfo)}if(this._isMobileTable&&!i){if(e.isImageURL){i=new l({src:{path:e.name},width:"3em",height:"3em"})}else{s=P._getSemanticKeyIndex(e,this._oSemanticKeyAnnotation);if(s>-1){i=this._createObjectIdentifierTemplate(e,a,s===0)}}}if(!i){if(e.semanticObjects&&!t){i=this._createSmartLinkFieldTemplate(e,a,function(){return this._createDisplayOnlyTemplate(e,true)}.bind(this))}else if(e.unit){i=this._createMeasureFieldTemplate(e,a)}else if(e.isEmailAddress||e.isPhoneNumber){i=this._createEmailOrPhoneLink(e,a)}else{o=this._getDefaultBindingInfo(e,a,true);i=new r({wrapping:this._isMobileTable,textAlign:n,text:o})}}e.align=n;return i};P._getSemanticKeyIndex=function(e,t){var i=-1,a;if(t&&t.semanticKeyFields){i=t.semanticKeyFields.indexOf(e.name);if(i<0){a=h.resolveEditableFieldFor(e);i=a?t.semanticKeyFields.indexOf(a):-1}}return i};P._createModelTypeInstance=function(e,t,i,a){var n,r,o={};var s=e.type==="Edm.DateTime"&&e.displayFormat==="Date";if(s||e.isCalendarDate){n=t;r={displayFormat:"Date"}}else if(e.type==="Edm.DateTime"&&i){n={UTC:true}}else if(e.type==="Edm.Decimal"){r={precision:e.precision,scale:e.scale};n={preserveDecimals:a}}else if(e.type==="Edm.String"){r={isDigitSequence:e.isDigitSequence}}if(e.isCalendarDate){o.isCalendarDate=true}if(e.isCalendarType&&!e.isCalendarDate){o.isCalendarType=true;o.calendarType=b.getCalendarAnnotationType(e)}if(e.isFiscalDate){o.isFiscalDate=true;o.fiscalType=_.getFiscalAnnotationType(e)}if(e.isTimezone){o.isTimezone=true;n={showDate:false,showTime:false}}r=Object.assign({},r,{maxLength:e.maxLength});if(e.type=="Edm.DateTime"&&(e.isFiscalDate||e.isCalendarType)){M.error("Unexpected configuration for Edm.DateTime")}if(e.type=="Edm.DateTime"&&!e.isFiscalDate&&!e.isCalendarType){e.modelType=g.getType(e.type,n,r,o);e.modelType.formatValue(new Date,"string");return g.getType(e.type,n,r,o)}e.modelType=g.getType(e.type,n,r,o);return e.modelType};P.prototype.createModelTypeInstance=function(e){return P._createModelTypeInstance(e,this._oDateFormatSettings,this._useUTCDateTime,this._bPreserveDecimals)};P.prototype._createEmailOrPhoneLink=function(e,t){var i=new c({text:this._getDefaultBindingInfo(e,t,true),wrapping:this._isMobileTable,reactiveAreaMode:u.ReactiveAreaMode.Overlay,press:function(t){var i=t.getSource().getText();if(e.isEmailAddress){u.URLHelper.triggerEmail(i)}else if(e.isPhoneNumber){u.URLHelper.triggerTel(i)}}});return i};P.prototype._getDefaultBindingInfo=function(e,t,i){var a={path:e.name,type:t,formatter:T.getWhitespaceReplacer(i)};if(e.type==="Edm.DateTimeOffset"&&e.timezone){a={parts:[{path:e.name,type:t},{path:e.timezone}],formatter:T.getDateTimeWithTimezoneFormatter(),useRawValues:true}}else if(e.type==="Edm.String"&&e.isTimezone){a={parts:[{value:null},{path:e.name}],type:t}}else if(this._bEnableDescriptions&&e.description){a={parts:[{path:e.name,type:t},{path:e.description}],formatter:T.getFormatterFunctionFromDisplayBehaviour(e.displayBehaviour,i)};if(t&&t.getName()==="sap.ui.comp.odata.type.NumericText"&&this._bEnableDescriptions&&e.description){var n=a.formatter;a.formatter=function(e,t,i){if(e===null&&t){e=""}return n(e,t,i)}}}return a};P.prototype._createLink=function(e,t,i){var a=null;e.linkProperties=i.parameters||i.urlPath;if(i.urlPath){a={path:i.urlPath}}else if(i.urlTarget){a=i.urlTarget}return new c({text:this._getDefaultBindingInfo(e,t,true),wrapping:this._isMobileTable,reactiveAreaMode:u.ReactiveAreaMode.Overlay,href:a})};P.prototype._fnNavigationTargetsObtainedListener=function(e){if(e.getSource){const t=e.getSource().getFieldInfo()._getSourceControl();const i=e.getParameters().mainNavigation;e.getParameters().show(t.getTitle(),i,undefined,undefined);return}const t=L.getElementById(e.originalId);const i=e.mainNavigation;if(i){i.setDescription(t.getText())}return Promise.resolve({...e,mainNavigation:i,mainNavigationId:t.getTitle()})};P.prototype._createObjectIdentifierTemplate=function(e,t,i){let a,n,r,s,l;const c=this;const p=function(e){return e.startsWith("{")&&e.endsWith("}")};const h=function(e){return e.replace("{","").replace("}","")};const y=function(t,i){const a=e.semanticObjects.additionalSemanticObjects;if(c._oSemanticObjectController&&c._oSemanticObjectController.getForceLinkRendering()&&c._oSemanticObjectController.getForceLinkRendering()[e.name]){return true}i=i?i:e.semanticObjects.defaultSemanticObject;return D.hasDistinctSemanticObject(a.concat(i),t)};const f=function(e){return!(e.getReplaceSmartLinkNavigationTargetsObtained()||e.getNavigationTargetsObtainedCallback()||e.hasListeners("navigationTargetsObtained"))};const g=function(){const t=new m({semanticObject:e.semanticObjects?e.semanticObjects.defaultSemanticObject:"",additionalSemanticObjects:e.semanticObjects?e.semanticObjects.additionalSemanticObjects:[],semanticObjectLabel:e.label,fieldName:e.name,text:_.getTitle(),reactiveAreaMode:u.ReactiveAreaMode.Overlay,semanticObjectController:c._oSemanticObjectController});if(!c._oSemanticObjectController||f(c._oSemanticObjectController)){t.attachNavigationTargetsObtained(c._fnNavigationTargetsObtainedListener)}if(!c._oSemanticObjectController||f(c._oSemanticObjectController)){t.setNavigationTargetsObtainedCallback(c._fnNavigationTargetsObtainedListener)}c._aSmartLinks.push(t);return t};if(e.semanticObjects){D.getDistinctSemanticObjects().then(function(t){if(p(e.semanticObjects.defaultSemanticObject)||y(t)){l=g()}})}if(e.description){switch(e.displayBehaviour){case"descriptionAndId":e.vertical=true;a=e.description;n=e.name;r=t;break;case"idAndDescription":e.vertical=true;a=e.name;n=e.description;s=t;break;case"idOnly":a=e.name;r=t;break;default:a=e.description;break}}else{a=e.name;s=t}const _=new o({title:a?{path:a,type:s,formatter:T.getWhitespaceReplacer(true)}:undefined,text:n?{path:n,type:r,formatter:T.getWhitespaceReplacer(true)}:undefined,titleActive:e.semanticObjects?{parts:p(e.semanticObjects.defaultSemanticObject)?[{path:"$sapuicompcontrolprovider_distinctSO>/distinctSemanticObjects"},{path:h(e.semanticObjects.defaultSemanticObject)}]:[{path:"$sapuicompcontrolprovider_distinctSO>/distinctSemanticObjects"}],formatter:function(e,t){return y(e,t)}}:false,reactiveAreaMode:u.ReactiveAreaMode.Overlay,titlePress:function(t){if(!e.semanticObjects){return}if(!l||l.bIsDestroyed){l=g()}const i=l?.getFieldInfo();if(!i){return}t.getSource().addDependent(l);i.setSourceControl(t.getSource());i.open(t.getSource(),t)}});_.attachEvent("ObjectIdentifier.designtime",function(e){if(l){const t=l.getFieldInfo();const i=e.getSource();i.addDependent(l);t.setSourceControl(i);e.getParameters().registerSmartLink(l)}});_.setModel(D.getJSONModel(),"$sapuicompcontrolprovider_distinctSO");if(this._oSemanticKeyAdditionalControl&&i){this._bSemanticKeyAdditionalControlUsed=true;return new d({renderType:"Bare",items:[_,this._oSemanticKeyAdditionalControl]}).addStyleClass("sapUiTinyMarginTopBottom")}return _};P.prototype._createObjectStatusTemplate=function(e,t,i){var a,n,r,o;r=S.getShowCriticalityIcon(i.criticalityRepresentationType);if(i.path){e.criticality=i.path;a={path:i.path,formatter:S.getCriticalityState};if(i.criticalityRepresentationPath){e.criticalityRepresentation=i.criticalityRepresentationPath;n={parts:[{path:i.path},{path:i.criticalityRepresentationPath}],formatter:function(e,t){return S.getShowCriticalityIcon(t)?S.getCriticalityIcon(e):undefined}}}else if(r){n={path:i.path,formatter:S.getCriticalityIcon}}}else{a=S.getCriticalityState(i.criticalityType);if(i.criticalityRepresentationPath){e.criticalityRepresentation=i.criticalityRepresentationPath;n={path:i.criticalityRepresentationPath,formatter:function(e){return S.getShowCriticalityIcon(e)?S.getCriticalityIcon(i.criticalityType):undefined}}}else if(r){n=S.getCriticalityIcon(i.criticalityType)}}if(e.unit){o={parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?T.getInlineAmountFormatter(this._bPreserveDecimals):T.getInlineMeasureUnitFormatter(this._bPreserveDecimals),useRawValues:true}}else{o=this._getDefaultBindingInfo(e,t,true)}return new s({text:o,state:a,icon:n})};P.prototype._createSmartLinkFieldTemplate=function(e,t,i){var a=e.unit?{parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?T.getAmountCurrencyFormatter(this._bPreserveDecimals):T.getMeasureUnitFormatter(this._bPreserveDecimals,e.scale),useRawValues:true}:this._getDefaultBindingInfo(e,t,true);var n=new m({semanticObject:e.semanticObjects.defaultSemanticObject,additionalSemanticObjects:e.semanticObjects.additionalSemanticObjects,fieldName:e.name,text:a,reactiveAreaMode:u.ReactiveAreaMode.Overlay,uom:e.unit?{path:e.unit}:undefined,wrapping:this._isMobileTable,beforeNavigationCallback:this._oSemanticObjectController?this._oSemanticObjectController.getBeforeNavigationCallback():undefined});if(n){n.attachNavigationTargetsObtained(t=>{const i=t.getSource();const a=i.getBinding("text");if(!a||!Array.isArray(a.getValue())||e.unit){t.getParameters().show();return}const n=a.getValue();const r=T.getTextsFromDisplayBehaviour(e.displayBehaviour,n[0],n[1]);const o=t.getParameters().mainNavigation;t.getParameters().show(r.firstText,o,undefined,undefined)})}if(!n.hasListeners("navigationTargetsObtained")){n.setNavigationTargetsObtainedCallback(t=>{const i=L.getElementById(t.originalId);const a=i?.getBinding("text");if(!a||!Array.isArray(a.getValue())||e.unit){return Promise.resolve(t)}const n=a.getValue();const r=T.getTextsFromDisplayBehaviour(e.displayBehaviour,n[0],n[1]);const o=t.mainNavigation;if(o){o.setDescription(r.secondText)}return Promise.resolve({...t,mainNavigation:o})})}n.setSemanticObjectController(this._oSemanticObjectController);n.setCreateControlCallback(i);return n};P.prototype._createMeasureFieldTemplate=function(e,t){var i,n,o,s,l,m=false;m=!!(e.isCurrencyField&&this._oCurrencyFormatSettings&&this._oCurrencyFormatSettings.showCurrencySymbol);s=new r({layoutData:this._isMobileTable?undefined:new p({growFactor:1,baseSize:"0%"}),textDirection:"LTR",wrapping:false,textAlign:"End",text:{parts:[{path:e.name,type:t},{path:e.unit},{mode:"OneTime",path:e.isCurrencyField?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:e.isCurrencyField?T.getAmountCurrencyFormatter(this._bPreserveDecimals):T.getMeasureUnitFormatter(this._bPreserveDecimals,e.scale),useRawValues:true}}).addStyleClass("sapUiCompCurrency").addStyleClass("sapUiCompCurrencyTabNums");l=new r({layoutData:new p({shrinkFactor:0}),textDirection:"LTR",wrapping:false,textAlign:"End",width:"3.3em",text:{path:e.unit,formatter:m?T.getCurrencySymbolFormatter():undefined}}).addStyleClass("sapUiCompUoMPart").addStyleClass("sapUiCompCurrencyMonoFont");i=new a({renderType:"Bare",justifyContent:"End",wrap:this._isMobileTable?"Wrap":undefined,items:[s,l]});i.addStyleClass("sapUiCompDirectionLTR");if(this._isAnalyticalTable){o=i;o.bindProperty("visible",{path:e.unit,formatter:C.isNotMultiUnit});n=new c({text:I.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_MULTI_LINK_TEXT")||"Show Details",reactiveAreaMode:u.ReactiveAreaMode.Overlay,visible:{path:e.unit,formatter:C.isMultiUnit},press:[{value:e.name,unit:e.unit,additionalParent:this.useSmartToggle,smartTableId:this._smartTableId,template:o},C.openMultiUnitPopover]});i=new d({renderType:"Bare",items:[n,o]})}return i};P.prototype._createFieldMetadata=function(e){var t=Object.assign({},e);t.label=e.fieldLabel||e.name;t.quickInfo=e.quickInfo;t.displayBehaviour=t.displayBehaviour||this._oDefaultDropDownDisplayBehaviour;t.filterType=this._getFilterType(e);this._updateValueListMetadata(t);this._setAnnotationMetadata(t);if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields&&this._oLineItemAnnotation.fields.indexOf(e.name)>-1){t.urlInfo=this._oLineItemAnnotation.urlInfo&&this._oLineItemAnnotation.urlInfo[e.name];t.criticalityInfo=this._oLineItemAnnotation.criticality&&this._oLineItemAnnotation.criticality[e.name]}else if(this._bProcessDataFieldDefault){this._oMetadataAnalyser.updateDataFieldDefault(t)}return t};P.prototype._updateValueListMetadata=function(e){e.hasValueListAnnotation=e["sap:value-list"]!==undefined;if(e.hasValueListAnnotation){e.hasFixedValues=h.isValueListWithFixedValues(e)||e["sap:value-list"]==="fixed-values"}else if(e["com.sap.vocabularies.Common.v1.ValueList"]){e.hasValueListAnnotation=true;e.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(e["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";if(!e.hasFixedValues){e.hasFixedValues=h.isValueListWithFixedValues(e)}}};P.prototype._setAnnotationMetadata=function(e){if(e&&e.fullName){e.semanticObjects=this._oMetadataAnalyser.getSemanticObjectsFromAnnotation(e.fullName)}};P.prototype._getFilterType=function(e){return T._getFilterType(e)};P.prototype.destroy=function(){var e=function(e){var t;if(e){t=e.length;while(t--){e[t].destroy()}}};if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(!this._bSemanticKeyAdditionalControlUsed&&this._oSemanticKeyAdditionalControl&&this._oSemanticKeyAdditionalControl.destroy){this._oSemanticKeyAdditionalControl.destroy()}e(this._aValueHelpProvider);this._aValueHelpProvider=null;e(this._aValueListProvider);this._aValueListProvider=null;e(this._aSmartLinks);this._aSmartLinks=null;if(this._oHelper){this._oHelper.destroy()}this._oHelper=null;this._mSmartField=null;this._aODataFieldMetadata=null;this._oDateFormatSettings=null;this._oCurrencyFormatSettings=null;this._oDefaultDropDownDisplayBehaviour=null;this._oLineItemAnnotation=null;this._oSemanticKeyAnnotation=null;this._oParentODataModel=null;this.bIsDestroyed=true};x=v.extend("sap.ui.comp.SmartToggle",{metadata:{library:"sap.ui.comp",properties:{editable:{type:"boolean",defaultValue:false}},aggregations:{edit:{type:"sap.ui.core.Control",multiple:false},display:{type:"sap.ui.core.Control",multiple:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("span",t).class("sapUiCompSmartToggle").openEnd();e.renderControl(t.getEditable()?t.getEdit():t.getDisplay());e.close("span")}}});x.prototype.getFocusDomRef=function(){var e=this.getEditable()?this.getEdit():this.getDisplay();if(e){return e.getFocusDomRef()}return v.prototype.getFocusDomRef.call(this)};x.prototype.getAccessibilityInfo=function(){var e=this.getEditable()?this.getEdit():this.getDisplay();if(e&&e.getVisible()&&e.getAccessibilityInfo){return e.getAccessibilityInfo()}return null};x.prototype.addAssociation=function(e,t,i){if(e==="ariaLabelledBy"){var a=this.getEdit(),n=this.getDisplay();a&&a.addAssociation(e,t,i);n&&n.addAssociation(e,t,i)}return v.prototype.addAssociation.apply(this,arguments)};x.prototype.removeAssociation=function(e,t,i){if(e==="ariaLabelledBy"){var a=this.getEdit(),n=this.getDisplay();a&&a.removeAssociation(e,t,i);n&&n.removeAssociation(e,t,i)}return v.prototype.removeAssociation.apply(this,arguments)};x.prototype.removeAllAssociation=function(e,t){if(e==="ariaLabelledBy"){var i=this.getEdit(),a=this.getDisplay();i&&i.removeAllAssociation(e,t);a&&a.removeAllAssociation(e,t)}return v.prototype.removeAllAssociation.apply(this,arguments)};return P},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/TableProvider", ["sap/ui/comp/odata/MetadataAnalyser","./ControlProvider","sap/ui/comp/util/FormatUtil","sap/ui/Device","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/odata/CalendarMetadata"],function(t,e,i,a,n,o){"use strict";var s=function(e){if(e){this._oParentODataModel=e.model;this.sEntitySet=e.entitySet;this._sIgnoredFields=e.ignoredFields;this._sInitiallyVisibleFields=e.initiallyVisibleFields;this.isEditableTable=e.isEditableTable;this._smartTableId=e.smartTableId;this._isAnalyticalTable=e.isAnalyticalTable;this._isMobileTable=e.isMobileTable;this.useSmartField=e.useSmartField;this.useSmartToggle=e.useSmartToggle;this.defaultFilterBarExpanded=e.defaultFilterBarExpanded;this.defaultShowAllFilters=e.defaultShowAllFilters;this.useUTCDateTime=e.useUTCDateTime==="true";this._bSkipAnnotationParse=e.skipAnnotationParse==="true";this._sLineItemQualifier=e.lineItemQualifier;this._sPresentationVariantQualifier=e.presentationVariantQualifier;this.enableInResultForLineItem=e.enableInResultForLineItem==="true";this._oSemanticKeyAdditionalControl=e._semanticKeyAdditionalControl;this._bShowDetailsButton=e.showDetailsButton;this._bEnableAutoColumnWidth=e.enableAutoColumnWidth;this._bPreserveDecimals=e.preserveDecimals;this._oCustomizeConfigTextInEditModeSource=e.textInEditModeSource;this._oCustomizeConfigIgnoreInsertRestrictions=e.ignoreInsertRestrictions;this._oCustomizeConfigClientSideMandatoryCheck=e.clientSideMandatoryCheck;try{var i=function(t){switch(typeof t){case"string":return JSON.parse(t);case"object":if(t==null){return undefined}return t;default:return undefined}};this._oDateFormatSettings=i(e.dateFormatSettings);this._oCurrencyFormatSettings=i(e.currencyFormatSettings);this._oDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour}catch(t){}}if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}this._aODataFieldMetadata=[];this._aTableViewMetadata=[];this._aIgnoredFields=[];this._aInitiallyVisibleFields=[];this._oMetadataAnalyser=new t(this._oParentODataModel);this._oSemanticObjectController=e.semanticObjectController;this._intialiseMetadata()};s.prototype._intialiseMetadata=function(){var t=[],i=-1,a,n,o,s,r,l,d;this._aODataFieldMetadata=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);d=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);if(!this._bSkipAnnotationParse){this._oPresentationVariant=this._oMetadataAnalyser.getPresentationVariantAnnotation(d,this._sPresentationVariantQualifier);if(this._oPresentationVariant){this._oLineItemAnnotation=this._oPresentationVariant.lineItemAnnotation}if(!this._oLineItemAnnotation){this._oLineItemAnnotation=this._oMetadataAnalyser.getLineItemAnnotation(d,this._sLineItemQualifier)}}if(this._isMobileTable){this._oSemanticKeyAnnotation=this._oMetadataAnalyser.getSemanticKeyAnnotation(d)}if(!this._isAnalyticalTable){this._addLineItemNavigationFields(d)}l=this._oMetadataAnalyser.getEntityContainerAttribute("supported-formats");if(l){this._bSupportsExcelExport=l.indexOf("xlsx")>-1;this._oPdfAnnotation=l.indexOf("pdf")>-1&&this._oMetadataAnalyser.getPDFSupportedAnnotation();this._bSupportsPDFExport=this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oPdfAnnotation}if(!this._oDefaultDropDownDisplayBehaviour){this._oDefaultDropDownDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(d)}this._generateArrays();this._oControlProvider=new e({metadataAnalyser:this._oMetadataAnalyser,model:this._oParentODataModel,fieldsMetadata:this._aODataFieldMetadata,lineItemAnnotation:this._oLineItemAnnotation,semanticKeyAnnotation:this._oSemanticKeyAnnotation,_semanticKeyAdditionalControl:this._oSemanticKeyAdditionalControl,processDataFieldDefault:true,isMobileTable:this._isMobileTable,isAnalyticalTable:this._isAnalyticalTable,smartTableId:this._smartTableId,dateFormatSettings:this._oDateFormatSettings,currencyFormatSettings:this._oCurrencyFormatSettings,defaultDropDownDisplayBehaviour:this._oDefaultDropDownDisplayBehaviour,useSmartField:this.useSmartField,useSmartToggle:this.useSmartToggle,defaultFilterBarExpanded:this.defaultFilterBarExpanded,defaultShowAllFilters:this.defaultShowAllFilters,useUTCDateTime:this.useUTCDateTime,enableDescriptions:true,entitySet:this.sEntitySet,semanticObjectController:this._oSemanticObjectController,preserveDecimals:this._bPreserveDecimals,textInEditModeSource:this._oCustomizeConfigTextInEditModeSource,ignoreInsertRestrictions:this._oCustomizeConfigIgnoreInsertRestrictions,clientSideMandatoryCheck:this._oCustomizeConfigClientSideMandatoryCheck});this._oFieldSemanticObjectMap={};if(this._aODataFieldMetadata){n=this._aODataFieldMetadata.length}for(a=0;a<n;a++){o=this._aODataFieldMetadata[a];if(this._aIgnoredFields.indexOf(o.name)>-1||!this._isVisible(o)){o.visible=false;continue}if(o.type.indexOf("Edm.")===0){s=this._oControlProvider.getFieldViewMetadata(o,this.isEditableTable);this._enrichWithTableViewMetadata(s,i++);t.push(s);if(s.semanticObject){this._oFieldSemanticObjectMap[s.name]=s.semanticObject}}}r=function(t,e){return t.index-e.index};this._aTableViewMetadata=t.sort(r);if(this._isAnalyticalTable&&this._mDimensionFromText){this._aTableViewMetadata.forEach(function(t){var e=this._mDimensionFromText[t.name];if(e&&t.aggregationRole!=="dimension"){if(!t.additionalProperty){t.additionalProperty=e}else{t.additionalProperty+=","+e}}}.bind(this))}};s.prototype._addLineItemNavigationFields=function(t){var e,i,a,n;if(this._aODataFieldMetadata&&this._oLineItemAnnotation){e=this._oLineItemAnnotation.fields;if(e){i=e.length}while(i--){a=e[i];if(a&&a.indexOf("/")>=0){n=this._oMetadataAnalyser.extractNavigationPropertyField(a,this.sEntitySet);if(n){n.name=n.parentPropertyName+"/"+n.name;if(n.description){n.description=n.parentPropertyName+"/"+n.description}if(n.unit){n.unit=n.parentPropertyName+"/"+n.unit}this._aODataFieldMetadata.push(n)}}}}};s.prototype.getFieldSemanticObjectMap=function(){return this._oFieldSemanticObjectMap};s.prototype.getTableViewMetadata=function(){return this._aTableViewMetadata};s.prototype.getSupportsExcelExport=function(){return this._bSupportsExcelExport};s.prototype.getExportCapabilities=function(t){var e={};if(t.indexOf("UI5Client")>-1){e["XLSX"]={}}if(this._bSupportsPDFExport&&t=="UI5ClientPDF"){e["PDF"]={};Object.assign(e["PDF"],this._oPdfAnnotation)}return e};s.prototype.getMultiUnitBehaviorEnabled=function(){return this._oMetadataAnalyser.getMultiUnitBehaviorEnabled()};s.prototype.getIsUTCDateHandlingEnabled=function(){return this._oDateFormatSettings?this._oDateFormatSettings.UTC:false};s.prototype.getRequestAtLeastFields=function(){return this._oPresentationVariant&&this._oPresentationVariant.requestAtLeastFields?this._oPresentationVariant.requestAtLeastFields:[]};s.prototype.isLineItemDefaultImportance=function(e){if(e.importance!="High"){return false}var i=this._oLineItemAnnotation&&this._oLineItemAnnotation.annotation||[];return i.some(function(i){return i.Value&&i.Value.Path==e.name&&!t.hasImportance(i)})};s.prototype.getFieldMetadata=function(t,e){var i=this._aTableViewMetadata.concat(this._aODataFieldMetadata).find(function(e){return e.name==t});if(!i&&t&&t.includes("/")){try{i=this._oMetadataAnalyser.extractNavigationPropertyField(t,this.sEntitySet)}catch(t){}}if(i){if(!i.modelType){this._oControlProvider.createModelTypeInstance(i)}if(e&&!i.hasOwnProperty("additionalProperty")){i.additionalProperty=this._getAdditionalProperty(i).join(",")}}return i};s.prototype._generateArrays=function(){if(this._sIgnoredFields){this._aIgnoredFields=this._sIgnoredFields.split(",")}if(this._sInitiallyVisibleFields){this._aInitiallyVisibleFields=this._sInitiallyVisibleFields.split(",")}};s.prototype._getAdditionalProperty=function(t){var e=[];if(t.isMeasureField&&t.unit){e.push(t.unit)}else if(t.description){e.push(t.description)}if(t.criticality){e.push(t.criticality)}if(t.criticalityRepresentation){e.push(t.criticalityRepresentation)}if(t.linkProperties&&t.linkProperties.length){e=e.concat(t.linkProperties)}if(t.fieldControlProperty){e.push(t.fieldControlProperty)}if(t.timezone){e.push(t.timezone)}return e};s.prototype._enrichWithTableViewMetadata=function(t,e){var a=[],s,r,l,d;var h=function(t){var e,i;if(t&&t.indexOf("/")>-1){i=t.split("/");i.pop();e=i.join("/")}return e};this._updateLabel(t);t.importance=this._getFieldImportance(t)||t.importance;t.isInitiallyVisible=this._isInitiallyVisible(t);t.index=this._getIndex(t,e);if(!t.width){d=this._getLineItemFieldWidth(t);if(d){t.width=d}else if(!this._isMobileTable&&!this._bEnableAutoColumnWidth){t.width=i.getWidth(t)}}s=this._getAdditionalProperty(t);l=s.length;if(l){t.additionalProperty=s.join(",")}while(l--){r=h(s[l]);if(r){a.push(r)}}if(t.parentPropertyName){a.push(t.parentPropertyName)}t.navigationProperty=a.join(",");this._setSortOrder(t);if(t.isFiscalDate){n.updateViewMetadata(t)}if(t.isCalendarType){o.updateViewMetadata(t)}t.semanticObjectPath=t["com.sap.vocabularies.Common.v1.SemanticObject"]&&t["com.sap.vocabularies.Common.v1.SemanticObject"]["Path"]||undefined;if(this._isAnalyticalTable){t.summed=t.aggregationRole==="measure";this._setInResult(t);this._setGroupBy(t);this._mapDimensionFromTextProperty(t)}};s.prototype._isInitiallyVisible=function(t){var e=false;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields){e=this._oLineItemAnnotation.fields.indexOf(t.name)>-1;if(e&&!a.system.desktop&&!this._bShowDetailsButton){var i=t.importance;if(i){if(a.system.tablet){e=i==="High"||i==="Medium"}else if(a.system.phone){e=i==="High"}}}}if(!e&&this._aInitiallyVisibleFields){e=this._aInitiallyVisibleFields.indexOf(t.name)>-1}return e};s.prototype._setInResult=function(t){if(this._oPresentationVariant){if(this._oPresentationVariant.requestAtLeastFields&&this._oPresentationVariant.requestAtLeastFields.indexOf(t.name)>-1){t.inResult=true}}else if(this.enableInResultForLineItem){if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields&&this._oLineItemAnnotation.fields.indexOf(t.name)>-1){t.inResult=true}}};s.prototype._setSortOrder=function(t){var e;if(this._oPresentationVariant&&this._oPresentationVariant.sortOrderFields){e=this._oPresentationVariant.sortOrderFields.length;for(var i=0;i<e;i++){if(this._oPresentationVariant.sortOrderFields[i].name===t.name){t.sorted=true;t.sortOrder=this._oPresentationVariant.sortOrderFields[i].descending?"Descending":"Ascending";break}}}};s.prototype._setGroupBy=function(t){if(this._oPresentationVariant&&this._oPresentationVariant.groupByFields&&this._oPresentationVariant.groupByFields.indexOf(t.name)>=0){t.grouped=true}};s.prototype._isVisible=function(t){return t.visible&&!this?._oLineItemAnnotation?.hidden?.[t.name]};s.prototype._getFieldImportance=function(t){var e=null;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.importance){e=this._oLineItemAnnotation.importance[t.name]}return e};s.prototype._getLineItemFieldWidth=function(t){var e=null;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.width){e=this._oLineItemAnnotation.width[t.name]}return e};s.prototype._mapDimensionFromTextProperty=function(t){if(!t.description||t.aggregationRole!=="dimension"){return}if(!this._mDimensionFromText){this._mDimensionFromText={}}this._mDimensionFromText[t.description]=t.name};s.prototype._getIndex=function(t,e){var i=-1,a=0,n=0;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.fields){a=this._oLineItemAnnotation.fields.length;i=this._oLineItemAnnotation.fields.indexOf(t.name)}if(i<0&&this._aInitiallyVisibleFields){n=this._aInitiallyVisibleFields.length;i=this._aInitiallyVisibleFields.indexOf(t.name);if(i>-1){i+=a}}if(i>-1){return i}return e+a+n};s.prototype._updateLabel=function(t){var e;if(this._oLineItemAnnotation&&this._oLineItemAnnotation.labels){e=this._oLineItemAnnotation.labels[t.name]}if(e){t.label=e}};s.prototype.getFieldLabel=function(t,e){if(!e){return null}var i;if(e.indexOf("/")>-1){i=this._oMetadataAnalyser.extractNavigationPropertyField(e,t)}else{i=this._oMetadataAnalyser.getFieldsByEntitySetName(t).find(function(t){return t.name==e})}if(!i){return null}return i["com.sap.vocabularies.Common.v1.Label"]&&i["com.sap.vocabularies.Common.v1.Label"]["String"]||i["fieldLabel"]||null};s.prototype.destroy=function(){if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;if(this._oControlProvider&&this._oControlProvider.destroy){this._oControlProvider.destroy()}this._mDimensionFromText=null;this._oControlProvider=null;this._aODataFieldMetadata=null;this._aTableViewMetadata=null;this._aIgnoredFields=null;this._aInitiallyVisibleFields=null;this._sIgnoredFields=null;this._sInitiallyVisibleFields=null;this.bIsDestroyed=true};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/TokenParser", ["sap/ui/comp/library","sap/ui/base/ManagedObject","sap/m/Token","sap/m/library","sap/ui/comp/util/FormatUtil","sap/ui/core/Core","sap/ui/core/Lib"],function(e,t,a,r,o,n,i){"use strict";var p=e.valuehelpdialog.ValueHelpRangeOperation;var s=r.P13nConditionOperation;var l={default:[s.EQ,s.BT,s.LT,s.LE,s.GT,s.GE,s.NotEQ,s.NotBT,s.NotLT,s.NotLE,s.NotGT,s.NotGE],string:[s.Empty,s.NotEmpty,s.Contains,s.EQ,s.BT,s.StartsWith,s.EndsWith,s.LT,s.LE,s.GT,s.GE,s.NotEQ,s.NotContains,s.NotStartsWith,s.NotEndsWith,s.NotBT,s.NotLT,s.NotLE,s.NotGT,s.NotGE],date:[s.Empty,s.NotEmpty,s.EQ,s.BT,s.LT,s.LE,s.GT,s.GE,s.NotEQ,s.NotBT,s.NotLT,s.NotLE,s.NotGT,s.NotGE],time:[s.EQ,s.BT,s.LT,s.LE,s.GT,s.GE,s.NotEQ,s.NotBT,s.NotLT,s.NotLE,s.NotGT,s.NotGE],numeric:[s.EQ,s.BT,s.LT,s.LE,s.GT,s.GE,s.NotEQ,s.NotBT,s.NotLT,s.NotLE,s.NotGT,s.NotGE],numc:[s.Contains,s.EQ,s.BT,s.EndsWith,s.LT,s.LE,s.GT,s.GE,s.Empty,s.NotContains,s.NotEQ,s.NotBT,s.NotEndsWith,s.NotLT,s.NotLE,s.NotGT,s.NotGE],boolean:[s.EQ]};var u=[s.Empty,s.BT,s.EQ,s.Contains,s.StartsWith,s.EndsWith,s.LT,s.LE,s.GT,s.GE,s.NotEmpty,s.NotBT,s.NotEQ,s.NotContains,s.NotStartsWith,s.NotEndsWith,s.NotLT,s.NotLE,s.NotGT,s.NotGE];var f=function(e){var t=e&&e.rangeOperationsKeys||u;this._aKeyFields=[];this._sDefaultOperation=typeof e==="string"&&e||e&&e.defaultOperation&&e.defaultOperation||undefined;this._mTypeOperations=e&&e.typeOperations||l;this._initRangeOperations(t)};function g(e){var t=this.re.exec(e),a=t[1],r=t[2];if(t){if(a&&a.trim){a=a.trim()}if(r&&r.trim){r=r.trim()}return[a,r]}return[]}f.rangeOperations={};f.rangeOperations[s.Empty]={regex:new RegExp("^"+o.getFormattedRangeText(p.Empty,null,null,false)+"$","i"),operator:s.Empty,example:o.getFormattedRangeText(p.Empty,null,null,false),template:o.getFormattedRangeText(p.Empty,null,null,false),exclude:false,parse:function(e){return[]}};f.rangeOperations[s.BT]={regex:/^([^!].*)\.\.\.(.+)$/,operator:s.BT,example:"foo...bar",template:"$0...$1",exclude:false,parse:g};f.rangeOperations[s.EQ]={regex:/^\=(.+)$/,operator:s.EQ,example:"=foo",template:"=$0",exclude:false};f.rangeOperations[s.Contains]={regex:/^\*(.+)\*$/,operator:s.Contains,example:"*foo*",template:"*$0*",exclude:false};f.rangeOperations[s.StartsWith]={regex:/^([^\*!].*)\*$/,operator:s.StartsWith,example:"foo*",template:"$0*",exclude:false};f.rangeOperations[s.EndsWith]={regex:/^\*(.*[^\*])$/,operator:s.EndsWith,example:"*foo",template:"*$0",exclude:false};f.rangeOperations[s.LT]={regex:/^\<([^\=].*)$/,operator:s.LT,example:"< foo",template:"<$0",exclude:false};f.rangeOperations[s.LE]={regex:/^\<\=(.+)$/,operator:s.LE,example:"<=foo",template:"<=$0",exclude:false};f.rangeOperations[s.GT]={regex:/^\>([^\=].*)$/,operator:s.GT,example:"> foo",template:">$0",exclude:false};f.rangeOperations[s.GE]={regex:/^>=(.+)$/,operator:s.GE,example:">=foo",template:">=$0",exclude:false};f.rangeOperations[s.NotEmpty]={regex:new RegExp("^"+o.getFormattedRangeText(p.Empty,null,null,true).replace("(","\\(").replace(")","\\)")+"$","i"),operator:s.NotEmpty,example:o.getFormattedRangeText(p.Empty,null,null,true),template:o.getFormattedRangeText(p.Empty,null,null,true),exclude:true,parse:function(e){return[]}};f.rangeOperations[s.NotBT]={regex:/^![(]?(.+)\.\.\.([^)]+)[)]?$/,operator:s.NotBT,example:"!foo...bar",template:"!($0...$1)",exclude:true,parse:g};f.rangeOperations[s.NotEQ]={regex:/^![(]?=(.+?)[)]?$/,operator:s.NotEQ,example:"!=foo",template:"!(=$0)",exclude:true};f.rangeOperations[s.NotContains]={regex:/^![(]?\*(.+)\*[)]?$/,operator:s.NotContains,example:"!*foo*",template:"!(*$0*)",exclude:true};f.rangeOperations[s.NotStartsWith]={regex:/^![(]?([^\\*].*)\*[)]?$/,operator:s.NotStartsWith,example:"!foo*",template:"!($0*)",exclude:true};f.rangeOperations[s.NotEndsWith]={regex:/^![(]?\*([^\*)]*)[)]?$/,operator:s.NotEndsWith,example:"!*foo",template:"!(*$0)",exclude:true};f.rangeOperations[s.NotLT]={regex:/^![(]?<([^=].*?)[)]?$/,operator:s.NotLT,example:"!<foo",template:"!(<$0)",exclude:true};f.rangeOperations[s.NotLE]={regex:/^![(]?<=(.+?)[)]?$/,operator:s.NotLE,example:"!<=foo",template:"!(<=$0)",exclude:true};f.rangeOperations[s.NotGT]={regex:/^![(]?>([^=].*?)[)]?$/,operator:s.NotGT,example:"!>foo",template:"!(>$0)",exclude:true};f.rangeOperations[s.NotGE]={regex:/^![(]?>=(.+?)[)]?$/,operator:s.NotGE,example:"!>=foo",template:"!(>=$0)",exclude:true};f.excludeOperationsMapping={};f.excludeOperationsMapping[s.NotEmpty]=s.Empty;f.excludeOperationsMapping[s.NotLT]=s.LT;f.excludeOperationsMapping[s.NotLE]=s.LE;f.excludeOperationsMapping[s.NotGT]=s.GT;f.excludeOperationsMapping[s.NotGE]=s.GE;f.excludeOperationsMapping[s.NotContains]=s.Contains;f.excludeOperationsMapping[s.NotStartsWith]=s.StartsWith;f.excludeOperationsMapping[s.NotEndsWith]=s.EndsWith;f.excludeOperationsMapping[s.NotBT]=s.BT;f.excludeOperationsMapping[s.NotEQ]=s.EQ;f.prototype._initRangeOperations=function(e){e.forEach(function(e){this.createOperation(f.rangeOperations[e])},this)};f.prototype.destroy=function(){if(this._oInput&&!this._oInput.bIsDestroyed){this._oInput.removeValidator(this._validator);if(this._aOrgValidators&&this._aOrgValidators.length>0){this._oInput.addValidator(this._aOrgValidators)}this._oInput=null}this._aOrgValidators=null;this._aKeyFields=null;this._mTypeOperations=null};f.prototype.setDefaultOperation=function(e){this._sDefaultOperation=e};f.prototype.getDefaultOperation=function(){return this._sDefaultOperation};f.prototype.getOperations=function(){return this._mOperations};f.prototype.getOperation=function(e){return this._mOperations&&this._mOperations[e]};f.prototype._getKeyFieldByLabel=function(e){var t;this._aKeyFields.some(function(a){if(a.label.toUpperCase()===e.toUpperCase()){t=a}},this);return t};f.prototype.addKeyField=function(e){this._aKeyFields.push(e)};f.prototype.getKeyFields=function(){return this._aKeyFields};f.prototype.addTypeOperations=function(e,t){this._mTypeOperations[e]=t};f.prototype.removeTypeOperations=function(e){delete this._mTypeOperations[e]};f.prototype.getTypeOperations=function(e){return this._mTypeOperations[e]||this._mTypeOperations["default"]};f.prototype.createOperation=function(e){var t=e.operator,a=e.example,r=e.regex,o=e.template,n=e.parse,i=e.exclude;if(!this._mOperations){this._mOperations={}}this._mOperations[t]={key:t,example:a,re:r,template:o,exclude:i,parser:this,match:function(e,t){var a=this.re.exec(e);if(a){var r=this.parse(e);if(t){r.forEach(function(e){if(t.hasOwnProperty("maxLength")&&t.maxLength>=0&&e.length>t.maxLength){a=null}if(t.oType){try{e=t.oType.parseValue(e,"string");t.oType.validateValue(e)}catch(e){a=null}}},this)}}return a},parse:n||function(e){var t=this.re.exec(e);if(t){var a=t[1]||t[2];if(a&&a.trim){a=a.trim()}return[a]}return[]},getFilledTemplate:function(e,t){var a=this.parse(e);var r=[];var o="";for(var n=0;n<a.length;n++){r[n]=this.formatValue(a[n],false,t)}o=f._templateReplace(this.template,r);return o},getConditionData:function(e,t){var a={};a.exclude=this.exclude;if(this.exclude){a.operation=f.excludeOperationsMapping[this.key];if(!a.operation){a.operation=this.key}}else{a.operation=this.key}var r=this.parse(e);for(var o=0;o<r.length;o++){a["value"+(o+1)]=this.formatValue(r[o],true,t)}return a},formatValue:function(e,t,a){if(!a){return e}if(a.hasOwnProperty("maxLength")){if(a.maxLength>=0){e=e.substring(0,a.maxLength)}}if(a.displayFormat){if(a.displayFormat==="UpperCase"){e=e.toUpperCase()}}if(a.oType){try{e=a.oType.parseValue(e,"string");a.oType.validateValue(e)}catch(e){return"ERROR"}if(!t){e=a.oType.formatValue(e,"string")}}return e}};return this._mOperations[t]};f.prototype.removeOperation=function(e){delete this._mOperations[e]};f.prototype.removeAllOperations=function(){var e=Object.keys(this._mOperations);e.forEach(function(e){delete this._mOperations[e]},this)};f.prototype.getTranslatedText=function(e,t,a){var r=t.key;e=e!=="default"?"_"+e.toUpperCase()+"_":"";if(e==="_STRING_"||e==="_BOOLEAN_"||e==="_NUMC_"){e=""}if(e==="_TIME_"){e="_DATE_"}if(!a){a="sap.m"}r="CONDITIONPANEL_OPTION"+e+r;var o=i.getResourceBundleFor(a).getText(r)||r;if(o.startsWith("CONDITIONPANEL_OPTION")){r="CONDITIONPANEL_OPTION"+t.key;o=i.getResourceBundleFor(a).getText(r)}return o};f.prototype.associateInput=function(e){this._oInput=e;this._aOrgValidators=this._oInput&&this._oInput.isA("sap.m.MultiInput")?this._oInput.getValidators().slice():[];this._oInput.removeAllValidators();this._oInput.addValidator(this._validator.bind(this))};f.prototype._validator=function(e){if(this._aOrgValidators){var t;this._aOrgValidators.some(function(a){t=a(e);return t},this);if(t){return t}}if(e.text){return this._onValidate(e.text)}return null};f._templateReplace=function(e,t){return e.replace(/\$\d/g,function(e){return t[parseInt(e.substr(1))]})};f.prototype._onValidate=function(e){var r=this._aKeyFields.length>0?this._aKeyFields[0]:null;if(this._oInput._getIsSuggestionPopupOpen&&this._oInput._getIsSuggestionPopupOpen()&&this._oInput._oSuggestionsTable&&this._oInput._oSuggestionsTable.getSelectedItem()){return null}if(r){var o=/^\w+\:\s/.exec(e);if(o){var n=o[0];var i=this._getKeyFieldByLabel(n.slice(0,n.indexOf(":")));if(i){r=i;e=e.slice(o[0].length).trim()}}}var p=r&&r.type||"default";var l=this.getTypeOperations(p);var u=function(e,o){if(e.match(o,r)){var n=e.getConditionData(o,r);n.keyField=r?r.key:null;if(r.hasOwnProperty("maxLength")&&r.maxLength===1){if([s.Contains,s.EndsWith,s.StartsWith].indexOf(e.key)!==-1){return}}if(p==="numc"){if([s.Contains,s.EndsWith].indexOf(e.key)!==-1){n.value1=r.oType.formatValue(n.value1,"string")}}var i=(r&&r.label&&this._aKeyFields.length>1?r.label+": ":"")+e.getFilledTemplate(o,r);i=t.escapeSettingsValue(i);return new a({text:i,tooltip:i}).data("range",n)}return null}.bind(this);var g;if(l.some(function(t){g=u(this._mOperations[t],e);return g},this)){return g}if(this._sDefaultOperation&&this._mOperations[this._sDefaultOperation]){e=f._templateReplace(this._mOperations[this._sDefaultOperation].template,[e]);return u(this._mOperations[this._sDefaultOperation],e)}return null};f._createRangeByText=function(e){var t=f._matchOperationFromText(e);if(!t){return{exclude:false,operation:s.EQ,tokenText:null,value1:e,value2:null}}var a=t;var r=false;if(f.excludeOperationsMapping[t]){a=f.excludeOperationsMapping[t];r=true}var o=a===s.BT?true:false;return f._getRangeByTextAndOperation(e,a,r,o)};f._matchOperationFromText=function(e){var t=[];for(var a in f.rangeOperations){if(f.rangeOperations[a].regex.test(e)){t.push(a)}}if(t.length===0){return null}if(t.length>1){if(e===o.getFormattedRangeText(p.Empty,null,null,false)&&t.indexOf(f.rangeOperations[s.Empty].operator)>-1){t=[f.rangeOperations[s.Empty].operator]}if(e===o.getFormattedRangeText(p.Empty,null,null,true)&&t.indexOf(f.rangeOperations[s.NotEmpty].operator)>-1){t=[f.rangeOperations[s.NotEmpty].operator]}if(t.indexOf(f.rangeOperations[s.NotContains].operator)>-1&&t.indexOf(f.rangeOperations[s.NotStartsWith].operator)>-1){return f.rangeOperations[s.NotContains].operator}}return t[0]};f._getRangeByTextAndOperation=function(e,t,a,r){var o=[];if(a&&e.startsWith("!(")&&e.endsWith(")")){e=e.slice(2,-1)}var n=f.rangeOperations[t].template;if(r){o=e.split("...");return{exclude:a,operation:t,value1:o[0],value2:o[1]}}else{var i=n.indexOf("$0");var p=i+2;if(p===n.length){e=e.slice(i)}else{p=n.length-p;e=e.slice(i,-p)}return{exclude:a,operation:t,value1:e,value2:null}}};return f},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ValueHelpProvider", ["sap/ui/core/Lib","sap/ui/core/date/UI5Date","sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/m/library","sap/m/List","sap/m/ResponsivePopover","sap/m/StandardListItem","sap/m/Token","sap/m/Table","sap/m/ColumnListItem","sap/m/Label","./BaseValueListProvider","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/DateTimeUtil","sap/ui/model/json/JSONModel","sap/ui/core/format/DateFormat","sap/ui/Device","sap/ui/model/Sorter","sap/base/util/merge","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/VariantItem","sap/base/strings/capitalize"],function(e,t,jQuery,i,a,s,l,o,r,n,h,u,p,d,g,c,f,m,y,S,_,D,V,F){"use strict";var v=i.valuehelpdialog.ValueHelpRangeOperation;var C=i.ValueHelpDeprecationCode;var b;var H=p.extend("sap.ui.comp.providers.ValueHelpProvider",{constructor:function(e){if(e){this.preventInitialDataFetchInValueHelpDialog=!!e.preventInitialDataFetchInValueHelpDialog;this.sTitle=e.title;this.bSupportMultiselect=!!e.supportMultiSelect;this.bSupportRanges=!!e.supportRanges;this.bIsSingleIntervalRange=!!e.isSingleIntervalRange;this.bIsSearchExpressionFilterRestriction=!!e.isSearchExpressionFilterRestriction;this.bIsUnrestrictedFilter=!!e.isUnrestrictedFilter;this.bTakeOverInputValue=e.takeOverInputValue===false?false:true;this._sScale=e.scale;this._sPrecision=e.precision;this._defaultOperation=e.defaultOperation?e.defaultOperation:null;this.filterBarClass=e.filterBarClass;this._onBeforeOpenValueHelpDialog=e._onBeforeOpenValueHelpDialog||function(){};this.enabledMultiSelectionPlugin=!!e.enabledMultiSelectionPlugin;this.defaultFilterBarExpanded=e.defaultFilterBarExpanded;this.defaultShowAllFilters=e.defaultShowAllFilters;this.calendarWeekSettings=e.calendarWeekSettings;this.showCurrentDateButton=e.showCurrentDateButton;if(this.bIsSingleIntervalRange){this.bSupportRanges=true}}p.apply(this,arguments);this._onInitialise()}});H.prototype._onInitialise=function(){if(this.oControl.attachValueHelpRequest){this._fVHRequested=function(e){if(!this.bInitialised){return}var t=e.getParameter("_userInputValue");this.oControl=e.getSource();this.bForceTriggerDataRetreival=e.getParameter("fromSuggestions");if(this.bSupportBasicSearch&&(this.bTakeOverInputValue||this.bForceTriggerDataRetreival)&&(t||t==="")){this.sBasicSearchText=t}this._createValueHelpDialog()}.bind(this);this.oControl.attachValueHelpRequest(this._fVHRequested)}};H.prototype._getEntitiesLazy=function(){return e.load("sap.ui.mdc",{async:true}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/mdc/valuehelp/CollectiveSearchSelect","sap/ui/comp/valuehelpdialog/ValueHelpDialog"],function(t,i){e([i,t])})})})};H.prototype._createValueHelpDialog=function(){if(!this.bCreated){this.bCreated=true;if(!this._oValueHelpDialogClass||!this._oCollectiveSearchSelectClass){this._getEntitiesLazy().then(this._onValueHelpDialogRequired.bind(this))}else{this._onValueHelpDialogRequired([this._oValueHelpDialogClass,this._oCollectiveSearchSelectClass])}}};H.prototype._getTitle=function(){if(this.sTitle){return this.sTitle}else if(this.oFilterProvider){return this.oFilterProvider._determineFieldLabel(this._fieldViewMetadata)}return""};H.prototype.getValueListAnnotation=function(){var e;if(this._isContextDependent()){e=this.oControl.getBindingContext()&&this.oControl.getBindingContext().getPath()}if(this.isFunctionImport()){const t=this.oControl.getParent().getControlFactory()._oMetaData,i=t.functionImportProperty,a=t.functionImport;return this._oMetadataAnalyser._getFunctionImportValueListAnnotationLazy(a,i,this._sFullyQualifiedFieldName,e)}return this._oMetadataAnalyser.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,e)};H.prototype._onValueHelpDialogRequired=function(e){if(this.bInitialised&&this.bIsContextDependent){this._bValueListRequested=false;return this._loadAnnotation().then(function(){return this._onInitValueHelpDialog(e)}.bind(this))}else{return this._onInitValueHelpDialog(e)}};H.prototype._setDefaultSFBSmartTableConfig=function(e){this.oValueHelpDialog.data("defaultSFBSmartTableConfig",{smartFilterBar:function(){return this.oSmartFilterBar}.bind(this),valueListAnnotation:e,entitySet:this.sValueListEntitySetName,cols:this._aCols,key:this.sKey,description:this.sDescription,displayBehaviour:this._getDisplayBehaviour(),autoSearch:!this.preventInitialDataFetchInValueHelpDialog||this.bForceTriggerDataRetreival})};H.prototype._onInitValueHelpDialog=function(t){this._oValueHelpDialogClass=t[0];this._oCollectiveSearchSelectClass=t[1];var i=this.oControl&&this.oControl.getId()+"-valueHelpDialog";this.oValueHelpDialog=new this._oValueHelpDialogClass(i,{stretch:y.system.phone,basicSearchText:this.sBasicSearchText,supportRangesOnly:this.bIsSingleIntervalRange||!this.oPrimaryValueListAnnotation,supportMultiselect:this.bSupportMultiselect,title:this._getTitle(),supportRanges:this.bSupportRanges,displayFormat:this.sDisplayFormat,enabledMultiSelectionPlugin:!!this.enabledMultiSelectionPlugin,ok:this._onOK.bind(this),cancel:this._onCancel.bind(this),beforeOpen:function(){this._onBeforeOpenValueHelpDialog({fieldName:this.sFieldName,_switchView:this._switchView.bind(this)})}.bind(this),afterClose:function(){if(this.oPrimaryValueListAnnotation){this._resolveAnnotationData(this.oPrimaryValueListAnnotation)}this.oValueHelpDialog.destroy();this.bCreated=false;if(this.oControl&&this.oControl.focus&&!y.system.phone){this.oControl.focus()}}.bind(this)});if(this.sValueListEntitySetName&&this._aCols){this._setDefaultSFBSmartTableConfig(this.oPrimaryValueListAnnotation)}if(this.oValueHelpDialog&&this._defaultOperation&&v[this._defaultOperation]){this.oValueHelpDialog.setConditionPanelDefaultOperation(this._defaultOperation)}if(this.oValueHelpDialog&&this.calendarWeekSettings){this.oValueHelpDialog.setProperty("_conditionPanelCalendarWeekSettings",this.calendarWeekSettings)}if(this.oValueHelpDialog&&this.showCurrentDateButton){this.oValueHelpDialog.setProperty("_conditionPanelShowCurrentDateButton",this.showCurrentDateButton)}if(this.oValueHelpDialog._oColSearchBox){this.oValueHelpDialog._oColSearchBox.destroy();this.oValueHelpDialog._oColSearchBox=null}this.oValueHelpDialog._oColSearchBox=new this._oCollectiveSearchSelectClass({visible:false,title:e.getResourceBundleFor("sap.ui.comp").getText("COLLECTIVE_SEARCH_SELECTION_TITLE")}).addStyleClass("sapUiTinyMarginEnd");this.oValueHelpDialog.setProperty("_enhancedExcludeOperations",true);this.oControl.addDependent(this.oValueHelpDialog);this.oValueHelpDialog.suggest(function(e,t){if(this.oPrimaryValueListAnnotation){var i=function(i){e.setShowSuggestion(true);e.setFilterSuggests(false);e._oSuggestProvider=new i({fieldName:t,control:e,model:this.oODataModel,displayFormat:this.sDisplayFormat,resolveInOutParams:false,displayBehaviour:this.sTokenDisplayBehaviour,annotation:this.oPrimaryValueListAnnotation,fieldViewMetadata:this._fieldViewMetadata,maxLength:this._sMaxLength,filterModel:this.oFilterModel,aggregation:"suggestionRows",typeAheadEnabled:true,enableShowTableSuggestionValueHelp:false})}.bind(this);b=sap.ui.require("sap/ui/comp/providers/ValueListProvider");if(!b){sap.ui.require(["sap/ui/comp/providers/ValueListProvider"],i)}else{i(b);return e._oSuggestProvider}return null}}.bind(this));if(this.bIsSingleIntervalRange){this.oValueHelpDialog.setIncludeRangeOperations([v.BT,v.EQ],this._sType);(function(){this.oValueHelpDialog.setMaxIncludeRanges&&this.oValueHelpDialog.setMaxIncludeRanges(1);this.oValueHelpDialog.setMaxExcludeRanges&&this.oValueHelpDialog.setMaxExcludeRanges(0)}).bind(this)();this.oValueHelpDialog._iMaxIncludeRanges=1;this.oValueHelpDialog._iMaxExcludeRanges=0;this.oValueHelpDialog.setMaxConditions(1);this.oValueHelpDialog.bIsSingleIntervalRange=this.bIsSingleIntervalRange;this._updateInitialInterval()}else if((this._sType==="date"||this._sType==="time"||this._sType==="datetime"||this._sType==="stringdate")&&!this.bIsUnrestrictedFilter){this.oValueHelpDialog.setIncludeRangeOperations([v.EQ],this._sType);(function(){this.oValueHelpDialog.setMaxExcludeRanges(0)}).bind(this)();this.oValueHelpDialog._iMaxExcludeRanges=0}else if(this.bIsSearchExpressionFilterRestriction){this.oValueHelpDialog.setIncludeRangeOperations(d._getSearchExpressionRangeOperationsKeys(),d._getSearchExpressionType());this.oValueHelpDialog.setExcludeRangeOperations(d._getSearchExpressionRangeOperationsKeys(),d._getSearchExpressionType())}if(this.oControl.$()&&this.oControl.$().closest(".sapUiSizeCompact").length>0){this.oValueHelpDialog.addStyleClass("sapUiSizeCompact")}else if(this.oControl.$()&&this.oControl.$().closest(".sapUiSizeCozy").length>0){this.oValueHelpDialog.addStyleClass("sapUiSizeCozy")}else if(jQuery("body").hasClass("sapUiSizeCompact")){this.oValueHelpDialog.addStyleClass("sapUiSizeCompact")}else{this.oValueHelpDialog.addStyleClass("sapUiSizeCozy")}if(this.bSupportRanges){this.oValueHelpDialog.setRangeKeyFields([{label:this._getTitle(),key:this.sFieldName,typeInstance:this._fieldViewMetadata?this._fieldViewMetadata.ui5Type:null,type:this._sType,formatSettings:this._sType==="numc"?{isDigitSequence:true,maxLength:this._sMaxLength}:Object.assign({},this._oDateFormatSettings,{UTC:false}),scale:this._sScale,precision:this._sPrecision,maxLength:this._sMaxLength,nullable:this._fieldViewMetadata?this._fieldViewMetadata.nullable:false}])}if(!(this.bIsSingleIntervalRange||!this.oPrimaryValueListAnnotation)){this.oValueHelpDialog.setModel(this.oODataModel);this._createAdditionalValueHelpControls();this._createCollectiveSearchControls()}if(this.oControl.getTokens){var a=this.oControl.getTokens();if(a){a=this._adaptTokensFromFilterBar(a);this.oValueHelpDialog.setTokens(a)}}return Promise.resolve().then(this.oValueHelpDialog.open.bind(this.oValueHelpDialog))};H.prototype._isContextDependent=function(){var e,t;if(this.bIsContextDependent===undefined){t=this._oMetadataAnalyser.getPropertyContextByPath(this._sFullyQualifiedFieldName);if(t){e=t.getObject();if(d.hasValueListRelevantQualifiers(e)){this.bIsContextDependent=true}}}return this.bIsContextDependent};H.prototype._adaptTokensFromFilterBar=function(e){var t,i,a,s=e;if(this.oFilterProvider&&e&&this._sType==="time"){s=[];for(var l=0;l<e.length;l++){t=_({},e[l]);i=t.data("range");if(i){i=_({},i);if(i.value1 instanceof Date){a=c.localToUtc(i.value1);i.value1={__edmType:"Edm.Time",ms:a.getTime()}}if(i.value2 instanceof Date){a=c.localToUtc(i.value2);i.value2={__edmType:"Edm.Time",ms:a.getTime()}}t.data("range",i);s.push(t)}}}return s};H.prototype._updateInitialInterval=function(){var e=this.oControl.getValue(),i,a,s,l,o;if(e){i=new r;a={exclude:false,keyField:this.sFieldName};if(this._sType==="numeric"){s=g.parseFilterNumericIntervalData(e);if(s.length==0){s.push(e)}}else if(this._sType==="datetime"){s=g.parseDateTimeOffsetInterval(e);l=m.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));o=l.parse(s[0]);s[0]=o?o:t.getInstance(s[0]);if(s.length===2){o=l.parse(s[1]);s[1]=o?o:t.getInstance(s[1])}}else{s=e.split("-")}if(s&&s.length===2){a.operation="BT";a.value1=s[0];a.value2=s[1]}else{a.operation="EQ";a.value1=s[0]}i.data("range",a)}if(i){this.oValueHelpDialog.setTokens([i])}};H.prototype._createCollectiveSearchControls=function(){var e,t=0,i=0,a,s;if(this.additionalAnnotations&&this.additionalAnnotations.length){a=function(e){var t,i,a,s=e.getParameter("key"),l=e.getSource(),o=l&&l.getItems();for(var r=0;r<o.length;r++){a=o[r];if(a.getKey()===s){t=a;break}}if(t){i=t.data("_annotation");if(i){this._triggerAnnotationChange(i)}}}.bind(this);e=new F({key:this.oPrimaryValueListAnnotation.keyField,text:this.oPrimaryValueListAnnotation.valueListTitle});e.data("_annotation",this.oPrimaryValueListAnnotation);this.oValueHelpDialog._oColSearchBox.addItem(e);this.oValueHelpDialog._oColSearchBox.setSelectedItemKey(this.oPrimaryValueListAnnotation.keyField);i=this.additionalAnnotations.length;for(t=0;t<i;t++){s=this.additionalAnnotations[t];e=new F({key:s.qualifier,text:s.valueListTitle});e.data("_annotation",s);this.oValueHelpDialog._oColSearchBox.addItem(e)}this.oValueHelpDialog._oColSearchBox.attachSelect(a);this.oValueHelpDialog._oColSearchBox.setVisible(true)}};H.prototype._triggerAnnotationChange=function(e){this.oValueHelpDialog.resetTableState();this._resolveAnnotationData(e);this._createAdditionalValueHelpControls();this._setDefaultSFBSmartTableConfig(e);this.oValueHelpDialog._recreateTable()};H.prototype._createAdditionalValueHelpControls=function(){var e=null,t=this.filterBarClass;this.oValueHelpDialog.setKey(this.sKey);this.oValueHelpDialog.setKeys(this._aKeys);this.oValueHelpDialog.setDescriptionKey(this.sDescription);this.oValueHelpDialog.setTokenDisplayBehaviour(this.sTokenDisplayBehaviour);var i=new f;i.setData({cols:this._aCols});this.oValueHelpDialog.setModel(i,"columns");if(this.bSupportBasicSearch){e=this.sKey}if(this.oSmartFilterBar){this.oSmartFilterBar._setCollectiveSearch(null);this.oSmartFilterBar.destroy()}if(!t){t=sap.ui.require("sap/ui/comp/smartfilterbar/SmartFilterBar")}this.oSmartFilterBar=new t(this.oValueHelpDialog.getId()+"-smartFilterBar",{entitySet:this.sValueListEntitySetName,basicSearchFieldName:e,enableBasicSearch:this.bSupportBasicSearch,isRunningInValueHelpDialog:true,advancedMode:true,showGoOnFB:!y.system.phone,search:this._onFilterBarSearchPressed.bind(this),reset:this._onFilterBarResetPressed.bind(this),filterChange:this._onFilterBarFilterChange.bind(this),initialise:this._onFilterBarInitialise.bind(this),filterBarExpanded:!!this.defaultFilterBarExpanded,showAllFilters:!!this.defaultShowAllFilters,considerAnalyticalParameters:true});if(this._oDateFormatSettings){this.oSmartFilterBar.data("dateFormatSettings",this._oDateFormatSettings)}if(this.oPrimaryValueListAnnotation&&this.oPrimaryValueListAnnotation.constParams){this.oSmartFilterBar.data("hiddenFields",Object.keys(this.oPrimaryValueListAnnotation.constParams));this.oSmartFilterBar.data("significantFields",this.oPrimaryValueListAnnotation.aInitialValueIsSignificantFields)}this.oValueHelpDialog.setFilterBar(this.oSmartFilterBar)};H.prototype._onFilterBarFilterChange=function(){if(!this._bIgnoreFilterChange){this.oValueHelpDialog.getTableAsync().then(function(e){if(e.data("isInternal")){return}e.setShowOverlay(true);this.oValueHelpDialog.TableStateSearchData()}.bind(this))}};H.prototype._expandFilterBar=function(){var e=this.oFilterProvider&&this.oFilterProvider._oAdditionalConfiguration,t=e?e.getControlConfigurationByKey(this._fieldViewMetadata.fieldName):null;if(this.defaultFilterBarExpanded!==false){if(this.oSmartFilterBar._hasMandatoryFields()){this.oSmartFilterBar.setFilterBarExpanded(true);if(this.defaultShowAllFilters!==false){this.oSmartFilterBar.setShowAllFilters(true)}}else if(!this.bSupportBasicSearch||this.oFilterProvider&&this.oFilterProvider._getPreventInitialDataFetchInValueHelpDialog(this._fieldViewMetadata,t)){this.oSmartFilterBar.setFilterBarExpanded(true)}}};H.prototype._onFilterBarSearchPressed=function(){this._rebindTable()};H.prototype._rebindTable=function(){var e,t,i,a,s;e=this.oSmartFilterBar.getFilters();a=this.oPrimaryValueListAnnotation.deprecationCodeField;if(a){if(e.length===0||e.length>0&&!this._checkForExistingRevokedFilters(e[0],a)){e.push(new D(a,V.NE,C.RevokedCode))}}t=this.oSmartFilterBar.getParameters()||{};if(this.aSelect&&this.aSelect.length){t["select"]=this.aSelect.toString()}s=this.oSmartFilterBar.getAnalyticBindingPath();i={path:s||"/"+this.sValueListEntitySetName,filters:e,parameters:t,events:{dataReceived:function(e){this.oValueHelpDialog.TableStateDataFilled();var t=e.getSource();this.oValueHelpDialog.getTableAsync().then(function(e){if(t&&this.oValueHelpDialog&&this.oValueHelpDialog.isOpen()){var i=t.getLength();if(i){this.oValueHelpDialog.update()}else{this.oValueHelpDialog._updateTitles()}}}.bind(this))}.bind(this)}};this.oValueHelpDialog.getTableAsync().then(function(e){if(e.data("isInternal")){return}e.setShowOverlay(false);this.oValueHelpDialog.TableStateDataSearching();e.setEnableBusyIndicator(true);if(e instanceof n){var t;if(this.sKey&&this._oMetadataAnalyser){t=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sValueListEntitySetName);for(var a=0;a<t.length;a++){if(t[a].name===this.sKey&&t[a].sortable!==false){i.sorter=new S(this.sKey);break}}}i.factory=function(t,i){var a=e.getModel("columns").getData().cols;return new h({cells:a.map(function(e){var t=e.template,i="{"+t+"}";if(Array.isArray(t)){i={parts:[{path:t[0]},{path:t[1]}],formatter:function(t,i){var a=g.getFormattedExpressionFromDisplayBehaviour(e.displayBehaviour,t,i);return a}}}return new u({text:i})})})};e.bindItems(i)}else{var s=e.getColumns();for(var a=0;a<s.length;a++){var l=s[a];l._appDefaults=null;if(i&&i.parameters&&i.parameters.custom){var o=i.parameters.custom.search?false:l.getBindingContext("columns").getProperty("sorted");l.setSorted(o);l.setSortOrder(o?"Ascending":"None")}}s=e.getSortedColumns();if(!s||s.length==0){s=e.getColumns()}for(var a=0;a<s.length;a++){var l=s[a];var r=l.getSortOrder()!=="None";if(!l.getSorted()){r=false}if(r){if(!i.sorter){i.sorter=[]}i.sorter.push(new S(l.getSortProperty(),l.getSortOrder()==="Descending"))}}e.bindRows(i)}}.bind(this))};H.prototype._checkForExistingRevokedFilters=function(e,t){var i=false;if(e.sPath===t&&e.sOperator===v.EQ&&e.oValue1===C.RevokedCode){i=true}else if(Array.isArray(e.aFilters)){for(var a=0;a<e.aFilters.length;a++){i=this._checkForExistingRevokedFilters(e.aFilters[a],t);if(i){break}}}return i};H.prototype._onFilterBarResetPressed=function(){this._calculateFilterInputData();if(this.oSmartFilterBar){this.oSmartFilterBar.setFilterData(this.mFilterInputData)}};H.prototype._onFilterBarInitialise=function(){var e=null;this._bIgnoreFilterChange=true;this._onFilterBarResetPressed();delete this._bIgnoreFilterChange;if(this.oSmartFilterBar&&this.oSmartFilterBar.getBasicSearchControl){e=this.oSmartFilterBar.getBasicSearchControl();if(e){e.setValue(this.sBasicSearchText);if(y.system.phone&&e.isA("sap.m.SearchField")){e.setShowSearchButton(true)}}}if(!this.preventInitialDataFetchInValueHelpDialog||this.bForceTriggerDataRetreival){this._rebindTable();this.bForceTriggerDataRetreival=false}if(y.system.desktop){this._expandFilterBar()}};H.prototype._onOK=function(e){var i=e.getParameter("_tokensHaveChanged"),a=e.getParameter("tokens"),s,l,o=0,r=[],n=null,h,u={},p;this._onCancel();if(!i){return}if(this.oControl.isA("sap.m.MultiInput")){var d=[];this.oControl.setValue("");this.oControl.destroyTokens();this.oControl.setTokens(a);o=a.length;if(o>0){u.type="added";u.addedTokens=a}this.oControl.fireTokenUpdate(u);while(o--){var c,f=a[o],n=f.data("row");if(n){c=n[this.sDescription];r.push(n)}if(this.sContext==="SmartFilterBar"){const e={key:f.getKey(),compositeKey:f.data("compositeKey"),text:c};d.push(e)}}if(this.sContext==="SmartFilterBar"){this.oFilterProvider._setInputsWithCompositeKeysFieldData(this.sFieldName,d)}}else{if(a[0]){if(this.bIsSingleIntervalRange){s=a[0].data("range");if(s){if(this._sType==="datetime"){h=m.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));if(typeof s.value1==="string"){s.value1=t.getInstance(s.value1)}if(s.operation==="BT"){if(typeof s.value2==="string"){s.value2=t.getInstance(s.value2)}l=h.format(s.value1)+"-"+h.format(s.value2)}else{l=h.format(s.value1)}}else{if(s.operation==="BT"){l=s.value1+"-"+s.value2}else{l=s.value1}}}}else{l=a[0].getKey()}n=a[0].data("row");if(n){p=this._getAbsolutePathToVLProperty(a[0]);r.push(n)}a[0].destroy()}if(this.sContext==="SmartField"&&this._selectedODataRowHandler){this.oControl?.getParent()?.getControlFactory()?.getValueListProvider()?._oHistoryValuesProvider?.setFieldData(r);this._selectedODataRowHandler(l,r[0],p)}this.setValue(l);if(this.sContext==="SmartFilterBar"&&!this.bIsSingleIntervalRange){var c=r[0]&&r[0][this.sDescription];this.oControl.setValue(g.getFormattedExpressionFromDisplayBehaviour(this.sSingleFieldDisplayBehaviour,l,c));this.oControl.setValueState("None");this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,l);this.oFilterProvider._setSingleInputsTextArrangementFieldData(this.sFieldName,l,c)}this.oControl.fireChange({value:l,validated:true})}if(this.fnAsyncWritePromise){this.fnAsyncWritePromise().then(this._calculateAndSetFilterOutputData.bind(this,r))}else{this._calculateAndSetFilterOutputData(r)}};H.prototype._getAbsolutePathToVLProperty=function(e){const t=e.data("longKey");const i=t.replace(/'([^']*)'/g,(e,t)=>{const i=encodeURIComponent(t);return`'${i}'`});return"/"+i};H.prototype._onCancel=function(){this.oValueHelpDialog.close();this.oValueHelpDialog.setModel(null)};H.prototype._switchView=function(e){if(!(this.oValueHelpDialog&&this.oValueHelpDialog._oColSearchBox)){return}var t=this.oValueHelpDialog._oColSearchBox,i=t.getItems(),a=i.find(function(t){return t.getKey()===e});if(a){this._triggerAnnotationChange(a.data("_annotation"));this.oValueHelpDialog._oColSearchBox.setSelectedItemKey(a.getKey())}};H.prototype.destroy=function(){if(this.oControl&&this.oControl.detachValueHelpRequest){this.oControl.detachValueHelpRequest(this._fVHRequested);this._fVHRequested=null}p.prototype.destroy.apply(this,arguments);if(this.oValueHelpDialog){this.oValueHelpDialog.destroy();this.oValueHelpDialog=null}if(this.oSmartFilterBar){this.oSmartFilterBar.destroy();this.oSmartFilterBar=null}this.sTitle=null};return H});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/providers/ValueListProvider", ["sap/ui/core/Lib","sap/ui/core/library","sap/ui/comp/library","sap/m/library","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/util/DateTimeUtil","sap/ui/core/SeparatorItem","sap/m/GroupHeaderListItem","sap/m/Column","sap/m/ColumnListItem","sap/m/Text","sap/m/Token","./BaseValueListProvider","sap/ui/core/ListItem","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/model/json/JSONModel","sap/ui/model/FilterOperator","sap/ui/comp/util/FormatUtil","sap/ui/comp/historyvalues/HistoryValuesProvider","sap/ui/comp/historyvalues/HistoryOptOutProvider","sap/ui/comp/historyvalues/Constants","sap/m/ComboBox","sap/m/MultiComboBox","sap/m/Select","sap/base/util/deepEqual","sap/ui/Device","sap/base/Log","sap/base/util/values","sap/m/Label","sap/base/strings/whitespaceReplacer","sap/ui/comp/smartfilterbar/FilterProviderUtils","sap/base/util/Deferred"],function(t,e,i,o,s,r,n,a,l,h,u,d,p,g,c,m,f,_,y,S,C,v,F,P,D,b,V,I,A,w,T,B,L){"use strict";var R=i.smartfilterbar.DisplayBehaviour;var H=o.PopinDisplay;var M=o.WrappingType;var E=e.ValueState;var x=t.getResourceBundleFor("sap.ui.comp").getText("SEARCH_FIELD_VALIDATION_WARNING_MESSAGE");var N={Recommendations:10,RecentlyUsed:20,Others:30};var O="list";var k=p.extend("sap.ui.comp.providers.ValueListProvider",{constructor:function(e){if(e){this.sAggregationName=e.aggregation;this.bTypeAheadEnabled=!!e.typeAheadEnabled;this.bEnableShowTableSuggestionValueHelp=e.enableShowTableSuggestionValueHelp===undefined?true:e.enableShowTableSuggestionValueHelp;this.dropdownItemKeyType=e.dropdownItemKeyType;this.sDeferredGroupId=e.deferredGroupId;this._fieldHistoryEnabled=e.fieldHistoryEnabled;this._fieldHistoryEnabledInitial=e.fieldHistoryEnabledInitial;this._bSuggestionsEnabled=this._getSuggestionsEnabled();this.bShowAllSuggestionsButton=e.bShowAllSuggestionsButton}this._aRecommendations=[];this._oRecommendationListPromise=Promise.resolve();this._oResourceBundle=t.getResourceBundleFor("sap.ui.comp");this._groupHeaderFactory=this._groupHeaderFactory.bind(this);this._pendingValidationCount=0;this._bConsiderPresentationVariant=typeof e.considerPresentationVariant==="undefined"?true:e.considerPresentationVariant;p.apply(this,arguments);this._onInitialise()}});k.prototype._onInitialise=function(){if(!this.bTypeAheadEnabled){this.oAfterRenderingEventDelegate={onAfterRendering:this._onMetadataInitialised};this.oControl.addEventDelegate(this.oAfterRenderingEventDelegate,this)}else if(this.oControl.attachSuggest){this._fSuggest=function(t){this.oControl=t.getSource();if(!this.bInitialised){return}if(!this.isDisableSearchMatchesPatternWarning()&&this.oControl.getValueState&&this.oControl.getValueState()===E.Warning&&this.oControl.getValueStateText&&this.oControl.getValueStateText()===x){return}if(!this._oTemplate||!this.oControl.data("_hassuggestionTemplate")){this._createSuggestionTemplate()}var e=t.getParameter("suggestValue");this._fetchData(e)}.bind(this);this.oControl.attachSuggest(this._fSuggest);if(!this.oFilterModel){var t=this;var e=this.oControl.setParent;this.oControl.setParent=function(i,o,s){var r=this.getParent();var n=e.apply(this,arguments);i=this.getParent();var a=!(i&&r===null);if(i!==r&&a){t.unbindAggregation()}return n}}this._handleSelect()}this.oControl.setModel(new f,O);this._setupHistoryValues();this._setupRecommendations()};k.prototype._onMetadataInitialised=function(){if(this.bInitialised){if(this.oAfterRenderingEventDelegate){this.oControl.removeEventDelegate(this.oAfterRenderingEventDelegate)}if(this.oPrimaryValueListAnnotation){this._oPresentationVariant=this._handlePresentationVariantSortOrderAnnotation();if(this.sAggregationName&&this.sAggregationName=="suggestionRows"){this._createSuggestionTemplate()}else{this._createDropDownTemplate()}this._fetchData();if(this._isControlDropdown()){if(this.mOutParams&&Object.keys(this.mOutParams).length>1){this._handleOutParameters()}if(this.mInParams&&Object.keys(this.mInParams).length>1){this._handleInParameters()}}}else{I.error("ValueListProvider","Missing primary ValueListAnnotation for "+(this._sFullyQualifiedFieldName||this.sFieldName))}if(this.oAfterRenderingEventDelegate){delete this.oAfterRenderingEventDelegate}}};k.prototype._onAnnotationLoad=function(t){var e=p.prototype._onAnnotationLoad.call(this,t);if(!this._isControlSupportedForHistory(this.oControl)){return e}if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){this._oHistoryValuesProvider?.getHistoryEnabled().then(t=>{if(t){this._setupSuggestionInteractions()}})}if(this.sContext==="SmartFilterBar"&&this._hasNotValidatedSingleField(this.sFieldName)){this._validateInput(this.oFilterProvider._oNotValidatedSingleFields[this.sFieldName],undefined,true);this.oFilterProvider._oNotValidatedSingleFields[this.sFieldName]=""}return e};k.prototype._isSortable=function(t){if(this.oPrimaryValueListAnnotation){for(var e=0;e<this.oPrimaryValueListAnnotation.valueListFields.length;e++){if(this.oPrimaryValueListAnnotation.valueListFields[e].name===t){return this.oPrimaryValueListAnnotation.valueListFields[e].sortable!==false}}return false}return false};k.prototype._createDropDownTemplate=function(){if(this.dropdownItemKeyType&&this.dropdownItemKeyType.oFormatOptions){this.dropdownItemKeyType.oFormatOptions.bFixedKey=true}var t=[{path:this._resolveSuggestionBindingPath(this.sKey),type:this.dropdownItemKeyType}],e=this.sValueListsDDLBDisplayBehaviour||this.sDDLBDisplayBehaviour,i=this.oControl.getBinding("realValue")&&this.oControl.getBinding("realValue").getType();if(this.oControl.isA("sap.ui.comp.IDropDownTextArrangement")&&this.sValueListsDDLBDisplayBehaviour&&this.sValueListsDDLBDisplayBehaviour!==this.sDDLBDisplayBehaviour){this.oControl.setTextArrangement(this.sDDLBDisplayBehaviour)}if(this.sDescription){t.push({path:this._resolveSuggestionBindingPath(this.sDescription)})}if(this.sContext==="SmartField"&&s.getIsTimezoneProperty(this._fieldViewMetadata)){this._oTemplate=new g({key:{path:this._resolveSuggestionBindingPath(this.sKey),parts:[{value:null},{path:this._resolveSuggestionBindingPath(this.sKey)}],type:this.dropdownItemKeyType||i},text:{parts:[{value:null},{path:this._resolveSuggestionBindingPath(this.sKey)}],type:this.dropdownItemKeyType||i}})}else{this._oTemplate=new g({key:{path:this._resolveSuggestionBindingPath(this.sKey),type:this.dropdownItemKeyType},text:{parts:t,formatter:function(t,i){var o=y.getFormatterFunctionFromDisplayBehaviour(e),s=o(t,i);return T(s)}}})}if(this._oRecommendationListAnnotation){this._oTemplate.bindProperty("additionalText",{path:this._resolveSuggestionBindingPath(this._oRecommendationListAnnotation.rankProperty)})}this._oSorter=null;var o=this._isSortable(this.sKey),r=this._isSortable(this.sDescription);if(this._oPresentationVariant){if(this._oPresentationVariant._bIsPresentationVariantSortPathInVHDEntityType&&this._oPresentationVariant._bIsPresentationVariantSortOrderPropertySortable){this._oSorter=new m(this._oPresentationVariant.sPresentationVariantSortPath,this._oPresentationVariant.sortOrderFields[0].descending)}else{I.error("ValueListProvider","Is Presentation Variant SortOrder property path part of EntityType = "+this._oPresentationVariant._bIsPresentationVariantSortPathInVHDEntityType+". Is property sortable ="+this._oPresentationVariant._bIsPresentationVariantSortOrderPropertySortable)}}else{if(this.sDDLBDisplayBehaviour===R.idOnly||this.sDDLBDisplayBehaviour===R.idAndDescription||this.sDDLBDisplayBehaviour===R.descriptionAndId){if(o){this._oSorter=new m(this.sKey)}}else{if(r){this._oSorter=new m(this.sDescription)}else if(this.sDescription!==this.sKey&&o){this._oSorter=new m(this.sKey)}}}};k.prototype._createSuggestionTemplate=function(){var t=0,e=0,i=0,o=this._aHighImportanceCols||this._aRecommendationCols||this._aCols,s;this._oTemplate=new h;if(o){this.oControl.removeAllSuggestionColumns();e=o.length;for(t=0;t<e;t++){var r=false,n="1px",a=o[t].suggestionsWidth;if(V.system.phone){a=undefined;if(t>=2){r=true;n=(t+1)*10+"rem"}}this.oControl.addSuggestionColumn(new l({header:new w({wrapping:true,wrappingType:M.Hyphenated,text:o[t].label}),demandPopin:r,popinDisplay:H.Inline,minScreenWidth:n,width:a}));if(o[t].isTimezone){s={path:this._resolveSuggestionBindingPath(o[t].template),parts:[{value:null},{path:this._resolveSuggestionBindingPath(o[t].template)}],type:o[t].oType}}else{s={path:this._resolveSuggestionBindingPath(o[t].template),type:o[t].oType,formatter:function(t){return T(t)}}}if(Array.isArray(o[t].template)){s={parts:[{path:this._resolveSuggestionBindingPath(o[t].template[0])},{path:this._resolveSuggestionBindingPath(o[t].template[1])}],formatter:function(t,e,i){var o=y.getFormatterFunctionFromDisplayBehaviour(t),s=o(e,i);return T(s)}.bind(this,o[t].displayBehaviour)}}this._oTemplate.addCell(new w({wrapping:true,text:s}));if(a){i+=parseFloat(a.substring(0,a.length-2))}}if(i>0){this.oControl.setProperty("maxSuggestionWidth",i+e+"em",true)}if(e===1){this.oControl._setSeparateSuggestions(false)}}this.oControl.data("_hassuggestionTemplate",true);if(this.oControl&&this.oControl._oSuggestionTable){this.oControl._oSuggestionTable.addStyleClass("sapUiCompValueListProviderTable")}};k.prototype._handleRowSelect=function(t,e,i){var o,s,r,n=i&&typeof i.getPath==="function"&&i.getPath()||"";if(t){o=t[this.sKey];s=t[this.sDescription]}if(o||o===""){if(this.oControl.addToken){s=T(y.getFormattedExpressionFromDisplayBehaviour(this.sTokenDisplayBehaviour,o,s));r=new d;r.setKey(o);r.setText(s);r.setTooltip(s);r.data("row",t);if(this.oControl.getMetadata()&&this.oControl.getMetadata()?.getName()==="sap.ui.comp.smartfilterbar.SFBMultiInput"){r.getTextForCopy=this.oControl._getTextForCopy.bind(this.oControl,r)}if(e){e(r)}if(this.oControl.getValue()===""){this.oControl.setValue("")}delete this.oControl.__sValidationText}else{if(this.sContext==="SmartField"&&this._selectedODataRowHandler){this._selectedODataRowHandler(o,t,n)}this.setValue(o);if(this.sContext==="SmartFilterBar"||this.sContext==="mdcFilterPanel"){this.oControl.setValue(y.getFormattedExpressionFromDisplayBehaviour(this.sSingleFieldDisplayBehaviour,o,s));this.oControl.setValueState("None");this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,o);this.oFilterProvider._setSingleInputsTextArrangementFieldData(this.sFieldName,o,s);if(!this.oFilterProvider._oSingleFieldSetFromFilterData[this.sFieldName]){this.oControl.fireChange({value:o,validated:true})}delete this.oFilterProvider._oSingleFieldSetFromFilterData[this.sFieldName]}if(this.sContext!=="SmartFilterBar"){this.oControl.fireChange({value:o,validated:true})}}}if(this.fnAsyncWritePromise){this.fnAsyncWritePromise().then(this._calculateAndSetFilterOutputData.bind(this,[t]))}else{this._calculateAndSetFilterOutputData([t])}};k.prototype._multiInputValidator=function(t){if(!this.bInitialised){return}if(this._aValidators){var e;this._aValidators.some(function(i){e=i(t);return e},this);if(e){return e}}var i=t.suggestionObject,o,s=t.text;if(i){var r=this._getSuggestionsModelName(),n=i.getBindingContext(r);o=n.getObject();this._handleRowSelect(o,t.asyncCallback,n)}else if(s){this._validateInput(s,t.asyncCallback)}};k.prototype._resetErrorState=function(){if(this.oControl.data("__validationError")){this.oControl.data("__validationError",null);this.oControl.setValueStateText("");this.oControl.setValueState("None")}};k.prototype._setErrorState=function(){this.oControl.setValueStateText(this._oResourceBundle.getText("VALUELIST_NOT_UNIQUE_ERROR"));this.oControl.setValueState(E.Error);this.oControl.data("__validationError",true)};k.prototype._onFilterError=function(t,e){this._resetErrorState();delete this.oControl.__bValidatingToken;if(!e){this._afterTokenValidate()}t()};k.prototype._onFilterSuccess=function(t,e,i,o,s,r,n){var a,l=t;if(!this.oControl||!this._pendingValidationCount&&!this.oControl.hasOwnProperty("__bValidatingToken")){return}delete this.oControl.__bValidatingToken;this._pendingValidationCount--;if(t){if(t.results?.length===1){this.oControl._iDescriptionCount=1;l=t.results[0];this._resetErrorState()}else if(s&&this.sContext==="SmartFilterBar"){this._pendingValidationCount++;a=new Promise(function(t,i){this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:r,urlParameters:n,success:function(i){this._onFilterSuccess(i,e,t,o)}.bind(this),error:function(){this._onFilterError(t,o)}.bind(this)})}.bind(this));this._removeValidationPromise(this._aValidationPromises.length-1);this._addValidationPromise(a)}else if(!s&&t.results?.length>1){this.oControl._iDescriptionCount=t.results.length;if(this.sContext==="SmartFilterBar"&&this._fieldViewMetadata.filterRestriction==="single"){if(t.results.length>1){this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,t.results[0][this.sKey])}if(!l.results){this._oHistoryValuesProvider&&this._oHistoryValuesProvider.setFieldData([l])}}this._resetErrorState()}else{this._setErrorState()}if(l&&l[this.sKey]){this.oControl._pendingAutoTokenGeneration=true;this._handleRowSelect(l,e);this.oControl._pendingAutoTokenGeneration=false}}if(!o){this._afterTokenValidate()}i()};k.prototype._validateInput=function(t,e,i){var o,s=[],r=this.oControl,n,a,l=false;if(this.sDisplayFormat==="UpperCase"){t=t.toUpperCase()}if(r.__sValidationText!==t){r.__sValidationText=t;if(t===this._truncateSearchText(t)){r.__bValidatingToken=true;this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){var h={dateSettings:this._oDateFormatSettings};if(this.oFilterProvider){h.useContainsAsDefault=this.oFilterProvider._bUseContainsAsDefault;h.stringFields=this.oFilterProvider._aFilterBarStringFieldNames;h.timeFields=this.oFilterProvider._aFilterBarTimeFieldNames;h.dateTimeOffsetValueFields=this.oFilterProvider._aFilterBarDateTimeFieldNames;h.dateTimeOffsetWithTimeZone=this.oFilterProvider._aFilterBarDateTimeOffsetWithTimezoneFieldNames;h.viewMetadataData=this.oFilterProvider._aFilterBarViewMetadata}s=B.generateFilters(this.aFilterField,this.mFilterInputData,h)}if(this._getDisplayBehaviour()==="descriptionOnly"&&this.sDescription&&this.sContext==="SmartFilterBar"){a=this.sDescription;l=true}else{a=this.sKey}s.push(new c(a,_.EQ,t));if(this.bSupportBasicSearch){n={"search-focus":a}}if(!e){this._abortPendingValidations()}this._pendingValidationCount++;o=new Promise(function(o,r){this._oValidationRead=this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:s,urlParameters:n,success:function(r){if(l&&r.results?.length!==1){s.splice(s.length-1,1,new c(this.sKey,_.EQ,t))}this._onFilterSuccess(r,e,o,i,l,s,n)}.bind(this),error:function(){this._onFilterError(o,i)}.bind(this)})}.bind(this));this._addValidationPromise(o)}else if(this.sContext==="SmartFilterBar"&&this._fieldViewMetadata.filterRestriction==="single"){this._setErrorState()}}else{if(r.data("__validationError")){this._setErrorState()}}};k.prototype._fetchSingleFieldDescription=function(t){var e=[],i;if(this.sDisplayFormat==="UpperCase"){t=t.toUpperCase()}if(t===this._truncateSearchText(t)){this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){e=B.generateFilters(this.aFilterField,this.mFilterInputData)}e.push(new c(this.sKey,_.EQ,t));if(this.bSupportBasicSearch){i={"search-focus":this.sKey}}this._abortPendingValidations();this._oSingleFieldDescriptionRead=this.oODataModel.read("/"+this.sValueListEntitySetName,{filters:e,urlParameters:i,success:function(t){if(!this.oControl){return}if(t?.results&&t?.results?.length===1){this.oControl._iDescriptionCount=1;if(this.oControl.data("__validationError")){this.oControl.data("__validationError",null);this.oControl.setValueState("None")}var e=t.results[0],i=e[this.sKey],o=e[this.sDescription];Promise.all(this._aValidationPromises).then(()=>{this.oControl.setValue(y.getFormattedExpressionFromDisplayBehaviour(this.sSingleFieldDisplayBehaviour,i,o));this.oFilterProvider.oModel.setProperty("/"+this.sFieldName,i)})}else{this.oControl._iDescriptionCount=t?.results?.length||0;this.oControl.setValueState("Error");this.oControl.data("__validationError",true)}}.bind(this)})}};k.prototype._validateStringSingleWithValueList=function(t){var e,i;if(t.getParameter("validated")){return}e=t.getParameter("value");if(e===""||e===undefined){return}if(this.sSingleFieldDisplayBehaviour==="idAndDescription"){i=/^([\S\s]+?)\s\([\S\s]+\)$/.exec(e)}else if(this.sSingleFieldDisplayBehaviour==="descriptionAndId"){i=/^[\S\s]+\s\(([\S\s]+?)\)$/.exec(e)}if(Array.isArray(i)&&i[1]){e=i[1]}this._validateInput(e)};k.prototype._abortPendingValidations=function(){if(this._oSingleFieldDescriptionRead?.abort){this._oSingleFieldDescriptionRead.abort()}if(this._oValidationRead?.abort&&this._pendingValidationCount>0){this._oValidationRead.abort();this._pendingValidationCount--}};k.prototype._afterTokenValidate=function(){if(this.oFilterProvider&&this.oFilterProvider._oSmartFilter&&this.oFilterProvider._oSmartFilter.bIsSearchPending&&this.oFilterProvider._oSmartFilter.search){if(this.oFilterProvider._oSmartFilter.getLiveMode&&this.oFilterProvider._oSmartFilter.getLiveMode()){return}this.oFilterProvider._oSmartFilter.search()}};k.prototype._onSuggestionItemSelected=function(t){var e,i=t.getParameter("selectedRow");if(i){var o=this._getSuggestionsModelName();e=i.getBindingContext(o);this._handleRowSelect(e.getObject(),null,e)}};k.prototype._setFilterOutputDataFromSelectedRow=function(t){var e,i,o;if(t){e=this._getSuggestionsModelName();i=t.getBindingContext(e);o=i.getObject();this._calculateAndSetFilterOutputData([o])}};k.prototype._onMultiComboBoxItemSelected=function(t){if(!t.getParameter("selected")){return}var e=t.getParameter("changedItem");this._setFilterOutputDataFromSelectedRow(e)};k.prototype._onComboBoxItemSelected=function(t){var e=t.getParameter("value"),i=t.getParameter("newValue"),o=t.getParameter("filterChangeReason");if(o&&!e&&!i){return}var s=this.oControl.getSelectedItem();this._setFilterOutputDataFromSelectedRow(s)};k.prototype._handleSelect=function(){if(this.oControl.addValidator){this._aValidators=this.oControl&&this.oControl.isA("sap.m.MultiInput")?this.oControl.getValidators().slice():[];this.oControl.removeAllValidators();this._fValidator=this._multiInputValidator.bind(this);this.oControl.addValidator(this._fValidator)}else if(this.oControl.attachSuggestionItemSelected){this.oControl.attachSuggestionItemSelected(this._onSuggestionItemSelected,this)}if(this.oControl.setRowResultFunction){this.oControl.setRowResultFunction(function(t){var e,i="",o=this._getSuggestionsModelName();if(t){e=t.getBindingContext(o)}if(e&&this.sKey){i=e.getProperty(this.sKey)}if(i&&this.sContext=="SmartField"&&s.getIsTimezoneProperty(this._fieldViewMetadata)){i=this.oControl.getBinding("value").getType().formatValue([null,i],"string")}return i}.bind(this))}};k.prototype._filterDropdownRowsByInParameters=function(){this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField&&this.aFilterField.length>0){this._fetchData();this._mLastFilterInputData=this.mFilterInputData;if(!this.oControl.isA("sap.m.Select")){this._cleanupControlSelection()}}};k.prototype.isInSmartFilterBar=function(){return!!this.oFilterModel};k.prototype.isDisableSearchMatchesPatternWarning=function(){if(this._disableSearchMatchesPatternWarning===undefined&&this.isInSmartFilterBar()&&this.oFilterProvider&&this.oFilterProvider._oSmartFilter){this._disableSearchMatchesPatternWarning=this.oFilterProvider._oSmartFilter.getDisableSearchMatchesPatternWarning()}return this._disableSearchMatchesPatternWarning};k.prototype._isControlDropdown=function(t){if(!t){t=this.oControl}return!!(t.isA("sap.m.MultiComboBox")||t.isA("sap.m.ComboBox"))||t.isA("sap.m.Select")};k.prototype._cleanupControlSelection=function(){if(this.oControl.isA("sap.m.MultiComboBox")){this.oControl.setSelectedKeys(null);if(this.isInSmartFilterBar()){this.oFilterModel.setProperty("/"+this.sFieldName+"/items",[])}}else{this.oControl.setSelectedKey(null);this.oControl.clearSelection()}};k.prototype._openDropdown=function(){if(this.oControl.isA("sap.m.MultiComboBox")){P.prototype.open.apply(this.oControl,arguments)}else if(this.oControl.isA("sap.m.ComboBox")){F.prototype.open.apply(this.oControl,arguments)}else if(this.oControl.isA("sap.m.Select")){D.prototype.open.apply(this.oControl,arguments)}};k.prototype._handleOutParameters=function(){if(this.oControl.isA("sap.m.MultiComboBox")){this.oControl.attachSelectionChange(this._onMultiComboBoxItemSelected,this)}else if(this.oControl.isA("sap.m.ComboBox")||this.oControl.isA("sap.m.Select")){this.oControl.attachChange(this._onComboBoxItemSelected,this)}};k.prototype._handleInParameters=function(){this.oControl.setBusyIndicatorDelay(0);this._calculateFilterInputData();this._mLastFilterInputData=this.mFilterInputData;this.oControl.open=function(){this._calculateFilterInputData();if(b(this._mLastFilterInputData,this.mFilterInputData)){this._openDropdown();return}this._filterDropdownRowsByInParameters();this._openDropdown()}.bind(this);this.oControl.addEventDelegate({onmousedown:function(t){if(this.oControl.getArrowIcon&&t.target===this.oControl.getArrowIcon().getFocusDomRef()){this._bSkipFocusIn=true}}.bind(this),onmouseup:function(t){if(this._bSkipFocusIn&&(this.oControl.getArrowIcon&&t.target===this.oControl.getArrowIcon().getFocusDomRef())){this.oControl.open()}this._bSkipFocusIn=false}.bind(this),onfocusin:function(t){if(this._bSkipFocusIn){return t}setTimeout(function(){this._calculateFilterInputData();if(b(this._mLastFilterInputData,this.mFilterInputData)){return}this._filterDropdownRowsByInParameters()}.bind(this));return t}.bind(this)})};k.prototype._updateBindings=function(){this._calculateFilterInputData();if(!this._mLastFilterInputData||b(this._mLastFilterInputData,this.mFilterInputData)){return}this._filterDropdownRowsByInParameters()};k.prototype._primaryValueListAnnotationChanged=function(t){var e=this.oControl,i=this._oMetadataAnalyser,o,s,r=[],n=e.getBindingContext()&&e.getBindingContext().getPath();if(n){o=e.getModel()&&e.getModel().getContext(n);s=i.getPropertyContextByPath(this._sFullyQualifiedFieldName);r=i._getODataValueListRelevantQualifiers(s,o)}if(r.length>0&&(!r.includes(this.oPrimaryValueListAnnotation.qualifier)||r.includes("")&&this.oPrimaryValueListAnnotation.qualifier!=="")){i.getValueListAnnotationLazy(this._sFullyQualifiedFieldName,n).then(function(i){if(e.oParent&&e.oParent._oFactory){e.oParent._oFactory._initValueList(i)}this._onAnnotationLoad(i);this._rebindInnerControlSuggestions();this._fetchData(t)}.bind(this));return true}return false};k.prototype._prepareValueListSearchParameters=function(t){var e={},i=[],o,r=this._getBindingLength(),n="";if(s.hasValueListRelevantQualifiers(this._fieldViewMetadata)&&this._primaryValueListAnnotationChanged(t)){return}if(this.sDDLBDisplayBehaviour==="descriptionOnly"&&this.sDescription){o=this.sDescription}else{o=this.sKey}t=t||"";if(this.bTypeAheadEnabled){if(t&&this.sDisplayFormat==="UpperCase"){t=t.toUpperCase()}if(this.bSupportBasicSearch){if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){e={"search-focus":o,search:t}}else{e.custom={"search-focus":o,search:t}}}this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){i=B.generateFilters(this.aFilterField,this.mFilterInputData,{dateSettings:this._oDateFormatSettings})}if(!this.bSupportBasicSearch){if(this._fieldViewMetadata&&this._fieldViewMetadata.filterType==="numc"){i.push(new c(o,_.Contains,t))}else{n=this._truncateSearchText(t);if(n===t){i.push(new c(o,_.StartsWith,n))}}}r=10}e["$top"]=r;e["$skip"]=0;if(!this.sValueListEntitySetName){I.error("ValueListProvider","Empty sValueListEntitySetName for "+this.sAggregationName+" binding! (missing primaryValueListAnnotation)")}if(this.sDeferredGroupId){e["batchGroupId"]=this.sDeferredGroupId}if(this.aSelect&&this.aSelect.length){e["$select"]=this.aSelect.toString()}return{mParams:e,aFilters:i,sSearchTextTruncated:n,length:r}};k.prototype._fetchData=function(t){var{mParams:e,aFilters:i,sSearchTextTruncated:o,length:s}=this._prepareValueListSearchParameters(t),r,n,a;if(this.bTypeAheadEnabled&&!this.bSupportBasicSearch&&!(this._fieldViewMetadata&&this._fieldViewMetadata.filterType==="numc")&&!(o===t)){this.oControl.closeSuggestions();return}if(!(this._shouldHaveRecommendations()||this._shouldHaveHistory())||!this._isControlSupportedForHistory(this.oControl)){if(this.bTypeAheadEnabled&&this.bEnableShowTableSuggestionValueHelp&&this._isSuggestionEnabled()){n={dataReceived:function(t){var e=t.getSource(),i;if(e){i=e.getLength();if(i&&i<=s){this.oControl.setShowTableSuggestionValueHelp(false)}else if(!this.bShowAllSuggestionsButton){this.oControl.setShowTableSuggestionValueHelp(false)}else{this.oControl.setShowTableSuggestionValueHelp(true)}}}.bind(this)}}else if(!this._isSuggestionEnabled()&&this.oControl.setShowTableSuggestionValueHelp&&this.oControl.setShowSuggestion){this.oControl.setShowTableSuggestionValueHelp(false);this.oControl.setShowSuggestion(false)}else if(this.bTypeAheadEnabled){this.oControl.setShowTableSuggestionValueHelp(false)}if(this.aSelect&&this.aSelect.length){e["select"]=this.aSelect.toString();delete e["$select"]}if(this._isControlDropdown(this.oControl)&&(this.mInParams&&Object.keys(this.mInParams).length>=1||this.mConstParams&&Object.keys(this.mConstParams).length>=1)){if(!n){a=new L;this.oControl.data("__dataReceivedPromise",a.promise);this.oControl.setBusy(true);n={dataReceived:function(t){a.resolve();this.oControl.setBusy(false);this._resetValueState(t);this._applyValueIfNeeded()}.bind(this)}}this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){i=B.generateFilters(this.aFilterField,this.mFilterInputData,{dateSettings:this._oDateFormatSettings,viewMetadataData:this._createViewMetadataData()})}}this.oControl.bindAggregation(this.sAggregationName,{path:"/"+this.sValueListEntitySetName,length:s,parameters:e,filters:i,sorter:this._oSorter,events:n,template:this._oTemplate,templateShareable:true});return}this._bindInnerControlSuggestions();var l=this;r=new Promise(function(t,o){if(!l.sValueListEntitySetName||!l._isSuggestionEnabled()&&!l._isControlDropdown()){t({results:[]});return}if(!l._isSuggestionEnabled()){t({results:[]});return}l.oODataModel.read("/"+l.sValueListEntitySetName,{urlParameters:e,filters:i,sorters:l._oSorter&&[l._oSorter],success:function(e){t(e)},error:function(t){o(t)}})});var h=Promise.resolve([]);if(this._shouldHaveHistory()){h=l._oHistoryValuesProvider.getFieldData()}Promise.all([r,this._oRecommendationListPromise,h]).then(function(t){var e=[],i=[],o=[],r=[],n=l._getSuggestionsModelName(),a=l.oControl;if(!a){return}var h=a.getModel(n);if(Array.isArray(t[0]&&t[0].results)){i=l._addSuggestionsToGroup(t[0].results,N.Others)}if(Array.isArray(t[1]&&t[1].results)){o=l._addSuggestionsToGroup(t[1].results,N.Recommendations)}if(l._shouldHaveHistory()&&Array.isArray(t[2])){r=l._addSuggestionsToGroup(t[2],N.RecentlyUsed);r=l._parseHistoryJsonDates(r)}e=e.concat(o).concat(r).concat(i);e=l._getDistinctSuggestions(e);e=e.filter(l._filterSuggestionsWithInParams.bind(l,l.mFilterInputData));l._showSuggestionsMoreButton(i.length>=s);if(l.oControl.isA("sap.m.MultiInput")){l.oControl._oSuggPopover._oProposedItem=null}h.setData(e)})};k.prototype._getSuggestionsData=function(){return new Promise((t,e)=>{var{mParams:i,aFilters:o}=this._prepareValueListSearchParameters();if(this._isControlDropdown(this.oControl)&&(this.mInParams&&Object.keys(this.mInParams).length>=1||this.mConstParams&&Object.keys(this.mConstParams).length>=1)){this._calculateFilterInputData();if(this.mFilterInputData&&this.aFilterField){o=B.generateFilters(this.aFilterField,this.mFilterInputData,{dateSettings:this._oDateFormatSettings,viewMetadataData:this._createViewMetadataData()})}}this.oODataModel.read("/"+this.sValueListEntitySetName,{urlParameters:i,filters:o,sorters:this._oSorter&&[this._oSorter],success:e=>{t(e.results.map(t=>({key:t[this.sKey],description:t[this.sDescription]})))},error:function(t){e(t)}})})};k.prototype._createViewMetadataData=function(){var t=this.mConstParams&&Object.keys(this.mConstParams),e=this.oPrimaryValueListAnnotation.aInitialValueIsSignificantFields,i=[];if(Array.isArray(this.aFilterField)&&this.aFilterField.length>0){i=this.aFilterField.map(function(i){var o={};o.name=i;o.fieldName=i;o.isConstant=Array.isArray(t)&&t.indexOf(i)!==-1;o.isInitialValueSignificant=Array.isArray(e)&&e.indexOf(i)!==-1;return o})}return[{fields:i}]};k.prototype._resetValueState=function(t){var e=t.getParameter("data"),i=e&&e.results,o;if(this.oControl.isA("sap.m.ComboBox")&&i){for(o=0;o<i.length;o++){if(i[o][this.sKey]==this.oControl.getSelectedKey()&&this.oControl.getValueState()===E.Error){this.oControl.setValueState(E.None)}}}};k.prototype._applyValueIfNeeded=function(){var t=this.oControl,e,i,o;if(!t.isA("sap.m.ComboBox")){return}e=t.getKeys();i=t.getSelectedKey();o=t.getValue();if(o&&!i&&e.indexOf(o)!==-1){t.setSelectedKey(o)}};k.prototype._isSuggestionEnabled=function(){return this._bSuggestionsEnabled};k.prototype._sortRecommendations=function(t,e){var i=this._oRecommendationListAnnotation.rankProperty,o=parseFloat(t[i]),s=parseFloat(e[i]);return s-o};k.prototype._showSuggestionsMoreButton=function(t){if(!this.bTypeAheadEnabled){return}if(this.bEnableShowTableSuggestionValueHelp){this.oControl.setShowTableSuggestionValueHelp(t)}else{this.oControl.setShowTableSuggestionValueHelp(false)}};k.prototype._addSuggestionsToGroup=function(t,e){if(!t){return[]}return t.map(function(t){var i={};i[v.getSuggestionsGroupPropertyName()]=e;return Object.assign({},t,i)})};k.prototype._groupHeaderFactory=function(t){var e=this._getGroupHeaderTitle(t.key);if(this._isControlDropdown()){return new n({key:v.getHistoryPrefix()+t.key+".key",text:e})}return new a({title:e})};k.prototype._getGroupHeaderTitle=function(t){switch(t){case N.Recommendations:return this._oResourceBundle.getText("VALUELIST_RECOMMENDATIONS_TITLE");case N.RecentlyUsed:return this._oResourceBundle.getText("VALUELIST_RECENTLY_USED_TITLE");default:return this._oResourceBundle.getText("VALUELIST_OTHERS_TITLE")}};k.prototype._getGroupHeaderSorter=function(){if(this._groupHeaderSorter){return this._groupHeaderSorter}this._groupHeaderSorter=new m({path:v.getSuggestionsGroupPropertyName(),descending:false,group:function(t){return t.getProperty(v.getSuggestionsGroupPropertyName())}});return this._groupHeaderSorter};k.prototype._getDistinctSuggestions=function(t){var e={},i=[],o=this._aHighImportanceCols||this._aCols,s=o&&o.reduce(function(t,e){return t.concat(e.template)},[]);if(!s&&t.length>0){s=Object.keys(t[0])}t.forEach(function(t){var o=s.reduce(function(e,i){e.push([i,t[i]]);return e},[]);var r=o.toString();if(!e[r]){i.push(t);e[r]={index:i.length-1}}else if(e[r]&&Number.isInteger(e[r].index)){var n=e[r].index,a=i[n][v.getSuggestionsGroupPropertyName()];if(a!==N.Others){i[e[r].index][v.getForcedVisiblePropertyName()]=true}}},this);return i};k.prototype._resolveRecommendationListAnnotationData=function(t){var e=t.fieldsToDisplay,i,o,s;this._aRecommendationCols=[];this.aRecommendationSelect=[];for(var r=0;r<e.length;r++){i=e[r];o=this._getColumnConfigFromField(i);if(i.visible){this._aRecommendationCols.push(o);this.aRecommendationSelect.push(i.name)}}if(this._aHighImportanceCols&&this._oRecommendationListAnnotation){s=this._oRecommendationListAnnotation.rankField[0];s=this._getColumnConfigFromField(s);this._aHighImportanceCols.push(s)}};k.prototype._setupRecommendations=function(){if(!this._shouldHaveRecommendations()||!this._isControlSupportedForHistory(this.oControl)){return}this._resolveRecommendationListAnnotationData(this._getRecommendationListAnnotation());this._fetchRecommendations()};k.prototype._shouldHaveRecommendations=function(){return s.isRecommendationList(this._fieldViewMetadata)};k.prototype._getRecommendationListAnnotation=function(){if(!this._oRecommendationListAnnotation){var t=this._oMetadataAnalyser._getRecommendationListAnnotation(this._sFullyQualifiedFieldName);this._oRecommendationListAnnotation=this._oMetadataAnalyser._enrichRecommendationListAnnotation(t)}return this._oRecommendationListAnnotation};k.prototype._fetchRecommendations=function(){var t=this;this._oRecommendationListPromise=new Promise(function(e,i){t.oODataModel.read("/"+t._oRecommendationListAnnotation.path,{urlParameters:{$skip:0,$top:5,$select:t.aRecommendationSelect.toString()},sorter:t._oSorter,success:function(i){var o=t._addSuggestionsToGroup(i.results,N.Recommendations),s=t._getSuggestionsModelName(),r=t.oControl.getModel(s),n=r.getData(),a=o.sort(t._sortRecommendations.bind(t));t._aRecommendations=a;if(Array.isArray(n)){a=[].concat(n).concat(a)}r.setData(a);t._showSuggestionsMoreButton(false);e(i)},error:function(t){i(t)}})})};k.prototype._createHistoryValuesProvider=function(){return new S(this.oControl,this._sFullyQualifiedFieldName)};k.prototype._createHistoryOptOutProvider=function(){return C.createOptOutSettingPage()};k.prototype._setupHistoryValues=function(){if(!this._shouldHaveHistory()||!this._isControlSupportedForHistory(this.oControl)){return}this._oHistoryValuesProvider=this._createHistoryValuesProvider();this._createHistoryOptOutProvider();this._oHistoryValuesProvider.getHistoryEnabled().then(function(t){if(!t||!this._oHistoryValuesProvider){return}this._oHistoryValuesProvider.attachChangeListener();this._oHistoryValuesProvider.attachEvent("fieldUpdated",this._onHistoryFieldUpdated,this);this._oHistoryValuesProvider.getFieldData().then(this._onHistoryDataInitialized.bind(this))}.bind(this))};k.prototype._onHistoryDataInitialized=function(t){this._updateModelHistoryData(t);return t};k.prototype._onHistoryFieldUpdated=function(t){var e=t.getParameter("fieldData")||[];if(this.oControl.isA("sap.m.Input")){this._updateModelHistoryData(e);setTimeout(function(){this.oControl&&this.oControl._oSuggPopover._oPopover.close()}.bind(this),50);return}this._updateModelHistoryData(e);if(this.oControl.isA("sap.m.ComboBox")){setTimeout(function(){this.oControl&&this.oControl._oSuggestionPopover._oPopover.close()}.bind(this))}};k.prototype._updateModelHistoryData=function(t){if(!this.oControl){return}t=this._parseHistoryJsonDates(t);var e=[],i=this._addSuggestionsToGroup(t,N.RecentlyUsed),o=this._getSuggestionsModelName(),s=this.oControl.getModel(o),r=s.getData();if(!Array.isArray(r)){r=[]}e=this._getDistinctSuggestions(e.concat(i).concat(r));s.setData(e);this._showSuggestionsMoreButton(false)};k.prototype._getShellConfig=function(){var t=window["sap-ushell-config"];if(t){return t.apps}return null};k.prototype._getSuggestionsEnabled=function(){var t=this._getShellConfig(),e;if(t){e=t.inputFieldSuggestions}if(e){return e.enabled}return true};k.prototype._getUShellContainer=function(){return sap.ui.require("sap/ushell/Container")};k.prototype._shouldHaveHistory=function(){if(!this._fieldHistoryEnabled||!this._fieldViewMetadata||!this._sFullyQualifiedFieldName||!this.oControl||this._isControlDropdown()&&(this._fieldHistoryEnabledInitial||this._fieldHistoryEnabledInitial===undefined)&&this._fieldHistoryEnabled){return false}var t=this._getShellConfig(),e,i;if(t){e=t.inputFieldHistory}if(e){i=e.enabled}var o=this._getUShellContainer();return o&&i&&!s.isPotentiallySensitive(this._fieldViewMetadata)};k.prototype._bindInnerControlSuggestions=function(){if(this.sAggregationName&&this.oControl.isBound(this.sAggregationName)){return}this._rebindInnerControlSuggestions()};k.prototype._rebindInnerControlSuggestions=function(){if(this.sAggregationName&&this.sAggregationName==="suggestionRows"){this._createSuggestionTemplate()}else{this._createDropDownTemplate()}var t={path:this._getSuggestionsModelName()+">/",template:this._oTemplate,templateShareable:true,length:this._getBindingLength()};t.groupHeaderFactory=this._groupHeaderFactory;t.sorter=this._getGroupHeaderSorter();if(this.sAggregationName){this.oControl.bindAggregation(this.sAggregationName,t)}};k.prototype._setupSuggestionInteractions=function(){if(this.sAggregationName==="suggestionRows"){this._setupInputSuggestionInteractions();return}this._setupComboBoxSuggestionInteractions()};k.prototype._setupInputSuggestionInteractions=function(){var t=this.oControl;t.setFilterSuggests(true);t.setFilterFunction(function(t,e){var i=this._getSuggestionsModelName(),o=e.getBindingContext(i).getObject(),s=o[this.sKey],r=o[this.sDescription],n=y.getFormatterFunctionFromDisplayBehaviour(this.sDDLBDisplayBehaviour),a=n(s,r);if(o[v.getForcedVisiblePropertyName()]||o[v.getSuggestionsGroupPropertyName()]===N.Others){return true}t=t.replace(/\*$/,"");t=t.replace(/^\*/,"");var l=Object.keys(o).some(function(e){var i=o[e]+"";return i.toLowerCase().indexOf(t.toLowerCase())!==-1});var h=a&&a.toLowerCase().indexOf(t.toLowerCase())!==-1;return l||h}.bind(this));t.attachLiveChange(function(t){var e=t.getParameter("value"),i=[N.RecentlyUsed,N.Recommendations];if(e===""){this.oControl._oSuggPopover._oPopover.close();this._showInitialSuggestions(i)}},this);t.addEventDelegate({onmousedown:function(e){if(this.oControl.getAggregation("_suggestionPopup")&&this.oControl.getAggregation("_suggestionPopup").isOpen()||e.target.tagName!=="INPUT"){return}this._bindInnerControlSuggestions();if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.getFieldData().then(function(e){this._updateModelHistoryData(e);this._showInitialSuggestions("suggestionRows",t.getValue())}.bind(this))}},onkeyup:function(e){this._bindInnerControlSuggestions();if(e.keyCode!==9){return}if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.getFieldData().then(function(e){this._updateModelHistoryData(e);this._showInitialSuggestions("suggestionRows",t.getValue())}.bind(this))}}},this);if(t.isA("sap.m.MultiInput")||!this._shouldHaveRecommendations()){return}t.attachSuggestionItemSelected(function(t){var e=this._getSuggestionsModelName(),i=t.getParameter("selectedRow"),o;if(i){var s=i.getBindingContext(e).getObject();o=s&&s[this.sKey]}if(this._isNotRecommendationItemSelected("suggestionRows",o)){this._setControlValueState(E.Warning)}else{this._setControlValueState(E.None)}},this)};k.prototype._setupComboBoxSuggestionInteractions=function(){var t=this.oControl;t.setShowSecondaryValues(true);t.addEventDelegate({onmousedown:function(e){if(this.oControl.getPicker()&&this.oControl.getPicker().isOpen()||e.target.tagName!=="INPUT"){return}this._bindInnerControlSuggestions();setTimeout(function(){this._showInitialSuggestions("items",t.getValue())}.bind(this))},onkeyup:function(e){this._bindInnerControlSuggestions();if(e.keyCode!==9){return}setTimeout(function(){this._showInitialSuggestions("items",t.getValue())}.bind(this))}},this);if(t.isA("sap.m.MultiComboBox")||!this._shouldHaveRecommendations()){return}t.attachChange(function(t){if(this._isNotRecommendationItemSelected("items",t.getParameter("value"))){this._setControlValueState(E.Warning)}else{this._setControlValueState(E.None)}},this)};k.prototype._isNotRecommendationItemSelected=function(t,e){return this._findSuggestionItemGroup(t,e)!==N.Recommendations};k.prototype._findSuggestionItemGroup=function(t,e){var i=this.oControl.getBinding(t),o=i?i.getCurrentContexts():[],s;for(var r=0;r<o.length;r++){var n=o[r].getObject(),a=n[this.sKey],l=n[this.sDescription];if(a===e||l===e){s=n;break}}return s?s[v.getSuggestionsGroupPropertyName()]:null};k.prototype._setControlValueState=function(t){this.oControl.setValueState(t?t:E.None);this.oControl.setValueStateText(" ")};k.prototype._showInitialSuggestions=function(t,e){var i=this,o=[N.RecentlyUsed,N.Recommendations],s=[N.RecentlyUsed],r=[];if(this._isNotRecommendationItemSelected(t,e)){r=o}else if(this._shouldHaveHistory()){r=s}this._calculateFilterInputData();this.oControl.showItems(function(t,e){var o=i._getSuggestionsModelName(),s=e.getBindingContext(o),n=s?s.getObject():{},a=n[v.getSuggestionsGroupPropertyName()];return i._filterSuggestionsWithInParams(i.mFilterInputData,n)&&r.indexOf(a)!==-1})};k.prototype._filterSuggestionsWithInParams=function(t,e){if(!t||t.length===0){return true}return Object.keys(t).every(function(i){var o=e[i];var s=t[i];if(!o){return true}if(typeof s==="string"){return s===o}if(typeof s==="object"&&s.items&&s.items.length>0){return s.items.some(function(t){return t.key===o})}return true})};k.prototype._getSuggestionsModelName=function(){var t;if(!this._isControlSupportedForHistory(this.oControl)){return t}if(this._shouldHaveRecommendations()||this._shouldHaveHistory()){t=O}return t};k.prototype._resolveSuggestionBindingPath=function(t){var e=this._getSuggestionsModelName();if(e){t=e+">"+t}return t};k.prototype._isControlSupportedForHistory=function(t){if(!t){return false}if(t.isA("sap.ui.comp.smartfield.DisplayComboBox")){return false}if(t.isA("sap.m.ComboBox")||t.isA("sap.m.MultiComboBox")||t.isA("sap.m.Input")||t.isA("sap.m.MultiInput")){return true}return false};k.prototype._getBindingLength=function(){var t=300;if(this.oODataModel&&this.oODataModel.iSizeLimit&&this.oODataModel.iSizeLimit>t){t=this.oODataModel.iSizeLimit}return t};k.prototype._parseHistoryJsonDates=function(t){return t.map(function(t){return Object.keys(t).reduce(function(e,i){if(r._hasJsonDateString(t[i])){e[i]=r._parseJsonDateString(t[i])}else{e[i]=t[i]}return e},{})})};k.prototype._truncateSearchText=function(t){var e=-1;if(this._sMaxLength){e=parseInt(this._sMaxLength)}else if(this._fieldViewMetadata&&this._fieldViewMetadata.maxLength){e=parseInt(this._fieldViewMetadata.maxLength)}if(e>-1&&t.length>e){t=t.substr(0,e)}return t};k.prototype._handlePresentationVariantSortOrderAnnotation=function(){var t,e,i=this.oPrimaryValueListAnnotation.valueListEntityName;if(!this._bConsiderPresentationVariant){return false}if(!this._oMetadataAnalyser){this._oMetadataAnalyser=new s(this.oODataModel);this._bCleanupMetadataAnalyser=true}t=this._oMetadataAnalyser._getPresentationVariantQualifierForVHD(i);e=this._oMetadataAnalyser.getPresentationVariantAnnotation(i,t);if(e&&e.sortOrderFields.length!==0){e.sPresentationVariantSortPath=e.sortOrderFields[0].name;this._oMetadataAnalyser._getEntityDefinition(i).property.forEach(function(t){if(t.name===e.sPresentationVariantSortPath){e._bIsPresentationVariantSortPathInVHDEntityType=true}});this.oPrimaryValueListAnnotation.fields.forEach(function(t){if(t.name===e.sPresentationVariantSortPath&&t.sortable===true){e._bIsPresentationVariantSortOrderPropertySortable=true}})}return e};k.prototype._hasNotValidatedSingleField=function(t){return this.oFilterProvider&&this.oFilterProvider._oNotValidatedSingleFields&&this.oFilterProvider._oNotValidatedSingleFields[t]};k.prototype.unbindAggregation=function(){if(this.oControl){this.oControl.unbindAggregation(this.sAggregationName)}return this};k.prototype.destroy=function(){if(this.oControl){if(this.oControl.detachSuggest&&this._fSuggest){this.oControl.detachSuggest(this._fSuggest);this._fSuggest=null}if(this.oControl.removeValidator&&this._fValidator){this.oControl.removeValidator(this._fValidator);this._fValidator=null}else if(this.oControl.detachSuggestionItemSelected){this.oControl.detachSuggestionItemSelected(this._onSuggestionItemSelected,this)}if(this.oControl.detachChange){this.oControl.detachChange(this._validateStringSingleWithValueList,this)}this.oControl.unbindAggregation(this.sAggregationName);this.oControl.data("_hassuggestionTemplate",false);delete this.oControl.__sValidationText;delete this.oControl.__bValidatingToken;delete this.oControl._iDescriptionCount}if(this._oHistoryValuesProvider){this._oHistoryValuesProvider.destroy();this._oHistoryValuesProvider=null}p.prototype.destroy.apply(this,arguments);if(this.oJsonModel){this.oJsonModel.destroy();this.oJsonModel=null}if(this._oTemplate){this._oTemplate.destroy()}this._oTemplate=null;this.sAggregationName=null;this.bTypeAheadEnabled=null;this._oSorter=null;this._oResourceBundle=null};return k});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/rules/RulesLog", ["sap/ui/base/Object"],function(e){"use strict";var t=e.extend("sap.ui.comp.rules.RulesLog");t.prototype.setInvokedMethod=function(e,t){if(this.mProperties===undefined||this.mProperties===null){this.mProperties={}}if(this.mProperties[e]===undefined){this.mProperties[e]=t}};t.prototype.getInvokedMethod=function(e){var t=null;if(this.mProperties!==undefined&&this.mProperties[e]!==undefined){t=this.mProperties[e]}return t};t.prototype.getInvokedMethods=function(){var e=null;if(this.mProperties!==undefined){e=this.mProperties}return e};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/AnnotationHelper", [],function(){"use strict";var t=function(){};t.prototype.getText=function(t){return this._getObject("com.sap.vocabularies.Common.v1.Text/Path",t)};t.prototype.getTextArrangement=function(t,e,r){var o=null,a=null;a=this._getObject("com.sap.vocabularies.Common.v1.Text",t);if(a){o=a["com.sap.vocabularies.UI.v1.TextArrangement"]}if(!o){o=this._getObject("com.sap.vocabularies.UI.v1.TextArrangement",t)}if(!o){o=this._getObject("com.sap.vocabularies.UI.v1.TextArrangement",e)}if(r&&!o&&a&&a.Path){for(var n=0;n<e.property.length;n++){if(e.property[n].name===a.Path){a=e.property[n];var i=this._getObject("com.sap.vocabularies.Common.v1.Text",a);if(i&&!i.navigationPath){o=i["com.sap.vocabularies.UI.v1.TextArrangement"]}break}}}if(o&&o.EnumMember){if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextFirst"){return"descriptionAndId"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextLast"){return"idAndDescription"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextSeparate"){return"idOnly"}if(o.EnumMember==="com.sap.vocabularies.UI.v1.TextArrangementType/TextOnly"){return"descriptionOnly"}}return null};t.prototype.getUnit=function(t){return this._getObject("Org.OData.Measures.V1.ISOCurrency/Path",t)||this._getObject("Org.OData.Measures.V1.Unit/Path",t)};t.prototype.getLabel=function(t){var e=this._getObject("com.sap.vocabularies.UI.v1.DataFieldWithUrl/Label/String",t);return e||this._getObject("com.sap.vocabularies.Common.v1.Label/String",t)};t.prototype.getValueListLabel=function(t){return this._getObject("com.sap.vocabularies.Common.v1.ValueList/Label/String",t)};t.prototype.getPlaceholder=function(t){return this._getObject("com.sap.vocabularies.UI.v1.Placeholder/String",t)};t.prototype.isCurrency=function(t,e){return!!(e&&e["sap:semantics"]==="currency-code")||!!(t&&this._getObject("Org.OData.Measures.V1.ISOCurrency/Path",t))};t.prototype.getQuickInfo=function(t){return this._getObject("com.sap.vocabularies.Common.v1.QuickInfo/String",t)};t.prototype.isMasked=function(t){return!!this._getObject("com.sap.vocabularies.Common.v1.Masked",t)};t.prototype.isMultiLineText=function(t){return!!this._getObject("com.sap.vocabularies.UI.v1.MultiLineText",t)};t.prototype.isStaticMandatory=function(t){var e=this._getObject("com.sap.vocabularies.Common.v1.FieldControl",t);if(e&&e.EnumMember){return e.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Mandatory"}return false};t.prototype.isStaticOptional=function(t){var e=this._getObject("com.sap.vocabularies.Common.v1.FieldControl",t);if(e&&e.EnumMember){return e.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Optional"}return false};t.prototype.isNullable=function(t){var e=this._getObject("nullable",t);if(e){return e==="true"}return true};t.prototype.isUpperCase=function(t){return this._getObject("com.sap.vocabularies.Common.v1.IsUpperCase/Bool",t)==="true"};t.prototype.canCreateEntitySet=function(t){return!(this._getObject("Org.OData.Capabilities.V1.InsertRestrictions/Insertable/Bool",t)==="false")};t.prototype.canCreateProperty=function(t){var e=this._getObject("Org.OData.Core.V1.Immutable/Bool",t);var r=this._getObject("Org.OData.Core.V1.Computed/Bool",t);if(r){return r=="false"}if(e){return e=="true"}return true};t.prototype.canUpdateEntitySet=function(t){return!(this._getObject("Org.OData.Capabilities.V1.UpdateRestrictions/Updatable/Bool",t)==="false")};t.prototype.getUpdateEntitySetPath=function(t){return this._getObject("Org.OData.Capabilities.V1.UpdateRestrictions/Updatable/Path",t)};t.prototype.canUpdateProperty=function(t){var e=this._getObject("Org.OData.Core.V1.Computed/Bool",t)==="true"||this._getObject("Org.OData.Core.V1.Immutable/Bool",t)==="true"||this._getObject("com.sap.vocabularies.Common.v1.FieldControl/EnumMember",t)==="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly";return!e};t.prototype.getFieldControlPath=function(t){return this._getObject("com.sap.vocabularies.Common.v1.FieldControl/Path",t)};t.prototype.getUIHiddenPath=function(t){return this._getObject("com.sap.vocabularies.UI.v1.Hidden/Path",t)};t.prototype.getVisible=function(t){var e=this._getObject("com.sap.vocabularies.Common.v1.FieldControl/EnumMember",t);if(e==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"){return"false"}var r=this._getObject("com.sap.vocabularies.UI.v1.Hidden",t);if(r&&typeof r.Bool==="undefined"&&typeof r.Path==="undefined"){return"false"}if(r&&r.Bool&&!(r.Bool=="false")){return"false"}return"true"};t.prototype.getImportanceAnnotation=function(t){var e,r=this._getObject("com.sap.vocabularies.UI.v1.Importance",t);if(r){e=r.EnumMember}switch(e){case"com.sap.vocabularies.UI.v1.ImportanceType/High":return"High";case"com.sap.vocabularies.UI.v1.ImportanceType/Medium":return"Medium";default:return"Low"}};t.prototype._getObject=function(t,e){var r=e,o=t.split("/"),a=0;while(r&&o[a]){r=r[o[a]];a++}return r};t.prototype.destroy=function(){};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/BindingUtil", ["sap/ui/model/odata/AnnotationHelper","sap/ui/base/BindingParser"],function(t,r){"use strict";var e=function(){};e.prototype.correctPath=function(t){var r,e=/\((.+)\)*/,a=e.exec(t);if(a){r=t.replace(a[0],"")}else{r=t||""}return r.replace("/","")};e.prototype.getNavigationProperties=function(t){var r,e,a={};e=t.getBindingContext();if(e&&e.sPath){a.paths=e.sPath.split("/")}r=t.getObjectBinding();if(r&&r.sPath){a.objectBinding=r.sPath;if(a.paths){a.paths.push(r.sPath)}else{a.paths=[r.sPath]}}if(!a.paths){a.paths=[]}return a};e.prototype.getBindingParts=function(t,r,e){var a=0,o,p,n;if(t&&t.parts){a=t.parts.length}for(o=0;o<a;o++){n="";p=t.parts[o];if(p.model){n=n+p.model+">"}n=n+p.path;r.push(n);e.length++}};e.prototype.toBinding=function(t){var r={},e,a,o,p,n={model:true,formatter:true,mode:true,path:true};if(t){if(t.parts&&t.parts.length){p=t.parts.length;r.parts=[]}for(o=0;o<p;o++){a=t.parts[o];r.parts.push(a)}for(e in n){if(t[e]){r[e]=t[e]}}return r}return null};e.prototype.toBindingPath=function(t){var r,e="",a,o,p;r=this.toBinding(t);if(r){if(r.model){e=r.model+">"}if(r.path){e=e+r.path}else if(r.parts&&r.parts.length>0){p=r.parts.length;for(o=0;o<p;o++){a=r.parts[o];if(a.model){e=e+a.model+">"}e=e+a.path}}}return e};e.prototype.fromFormatter=function(t,r,e){var a,o,p,n={model:t,formatter:r.formatter};p=r.path();o=p.length;if(o>0){n.parts=p;if(e){for(a=0;a<o;a++){e.push(p[a])}}}else{n.path=""}return n};e.prototype.executeODataBindingExpression=function(e,a){var o,p,n,i,s,f="";if(e&&a){s=t.format(a,e);f=s;i=r.complexParser(s,a);n=[];if(i){if(i.formatter){for(o=0;o<i.parts.length;o++){p=a.getProperty(i.parts[o].path,"value");n.push(p)}f=i.formatter.apply(null,n)}else{f=a.getProperty(i.path,"value")}}}return f};e.prototype.destroy=function(){};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ComboBox", ["sap/ui/comp/odata/ComboBox","sap/ui/comp/util/FormatUtil","./ComboBoxRenderer"],function(e,t,r){"use strict";var i="00000000-0000-0000-0000-000000000000";function s(e){return e===i}const a=new RegExp("^[0]*$");var n=e.extend("sap.ui.comp.smartfield.ComboBox",{metadata:{library:"sap.ui.comp",properties:{selectedKey:{type:"string",group:"Data",defaultValue:null},enteredValue:{type:"string",group:"Data",defaultValue:null},realValue:{type:"string",group:"Data",defaultValue:null},valueTextArrangement:{type:"string",group:"Misc",defaultValue:""}}},renderer:r});n.prototype.init=function(){e.prototype.init.apply(this,arguments);this.attachChange(function(){var e=this._getValue();if(this.getItemByKey(e)){this.setSelectedKey(e)}this.setProperty("realValue",e)}.bind(this))};n.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);this._processValueTextArrangement();this._synchronize()};n.prototype._processValueTextArrangement=function(){var e,r,i,s,a,n,l,o,u=this.getValueTextArrangement();i=this.getSelectedKey();s=this.getItemByKey(""+i);e=s&&s.getBinding("text");if(u&&s&&i!==""&&e&&Array.isArray(e.aBindings)){l=e.aBindings[0];n=e.aBindings[1];r=l&&l.getValue();a=n&&n.getValue();if(i!==r){return}o=t.getFormattedExpressionFromDisplayBehaviour(u,r,a);this.setValue(o)}};n.prototype.updateDomValue=function(t){const r=this.getItemByKey(t);if(!r&&t&&a.test(t)){t=""}e.prototype.updateDomValue.apply(this,[t])};n.prototype._synchronize=function(){var e=this.getSelectedKey(),t=this.getKeys(),r=this.getItemByKey(""+e);if(r&&(e!==""||t.indexOf(e)!==-1)&&e===this.getValue()&&e!==r.getText()){this.setAssociation("selectedItem",r,true);this._setPropertyProtected("selectedItemId",r.getId(),true);this.setProperty("enteredValue",e);this.setProperty("realValue",e);this.setValue(r.getText());this._sValue=this.getValue()}};n.prototype.validateProperty=function(t,r){if(r===null&&(t==="enteredValue"||t==="selectedItemId"||t==="selectedKey"||t==="realValue"||t==="value")){return r}return e.prototype.validateProperty.apply(this,arguments)};n.prototype.setRealValue=function(e){if(e===null||s(e)){this.setValue("")}else{this.setValue(e)}this.setSelectedKey(e);return this.setProperty("realValue",e)};n.prototype.setEnteredValue=function(e){var t,r=this.getSelectedItem();if(typeof e!=="undefined"){this.setSelectedKey(e)}if(e&&!r&&!s(e)){this.setValue(e)}t=this._getValue();this.setProperty("enteredValue",t);return this};n.prototype._getValue=function(){var e,t=this.getSelectedKey(),r=this.getSelectedItem();if(r&&t!==null){e=t}else if(t===null&&this.getValue()===""){e=t}else{e=this.getValue()}return e};n.prototype.shouldResetSelection=function(e){var t=this.getKeys(),r=t.length===0||t.indexOf(e)!==-1;return e===this.getMetadata().getProperty("selectedKey").defaultValue||!r};return n});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ComboBoxRenderer", ["sap/m/ComboBoxRenderer","sap/ui/core/Renderer"],function(e,t){"use strict";const n=t.extend(e);n.apiVersion=2;const r=new RegExp("^0*$");n.writeInnerValue=function(e,t){let n=t.getValue();if(r.test(n)){n=""}e.attr("value",n)};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/Configuration", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var i=a.extend("sap.ui.comp.smartfield.Configuration",{metadata:{library:"sap.ui.comp",properties:{controlType:{type:"sap.ui.comp.smartfield.ControlType",group:"Misc",defaultValue:null},displayBehaviour:{type:"sap.ui.comp.smartfield.DisplayBehaviour",group:"Misc",defaultValue:null},criticalityQualifier:{type:"string",group:"Misc",defaultValue:null},preventInitialDataFetchInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false}}}});return i});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ControlFactoryBase", ["sap/ui/base/Object","sap/ui/core/Lib","sap/ui/core/library","sap/ui/comp/library","sap/ui/model/BindingMode","sap/ui/comp/util/FormatUtil","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/providers/ValueListProvider","sap/ui/comp/smartfield/BindingUtil","sap/ui/comp/odata/MetadataAnalyser","sap/m/HBox","sap/base/Log","sap/base/strings/capitalize","sap/ui/comp/smartfilterbar/SmartFilterBar","sap/ui/comp/smartfield/ValueListDelegate"],function(t,e,a,i,o,n,r,s,l,u,d,p,h,g,f){"use strict";var c=i.smartfield.ControlContextType;var y=a.ValueState;var m=t.extend("sap.ui.comp.smartfield.ControlFactoryBase",{constructor:function(a,i){t.apply(this,arguments);this.sName="ControlFactoryBase";this._oModel=a;this._oParent=i;this._oBinding=new l;this._aProviders=[];this._oRb=e.getResourceBundleFor("sap.ui.comp")}});m.prototype.bind=function(){return Promise.resolve()};m.prototype.createControl=function(t){var e,a;e=this._getCreator(t);if(e){a=this[e](t);this._addAriaLabelledBy(a);this._addAriaDescribedBy(a);if(a&&a.onCreate){this[a.onCreate](a.control,a.params)}}return a};m.prototype.updateControl=function(t){var e,a=t.mode,i=this._oParent,o=i.data("configdata");if(o&&o.configdata){e=i.getFirstInnerControl();if(o.configdata.onText&&a==="display"){o.configdata.onText(e)}else if(o.configdata.onInput&&a==="edit"){o.configdata.onInput(e)}}};m.prototype._addAriaLabelledBy=function(t){var e=this._getTargetControlForAccAttributes(t),a=this._oParent.getAriaLabelledBy();if(e&&e.addAriaLabelledBy&&a.length>0){e.removeAllAriaLabelledBy();a.forEach(function(t){e.addAriaLabelledBy(t)})}};m.prototype._addAriaDescribedBy=function(t){var e=this._getTargetControlForAccAttributes(t),a=this._oParent.getAriaDescribedBy();if(e&&e.addAriaDescribedBy&&a.length>0){e.removeAllAriaDescribedBy();a.forEach(function(t){e.addAriaDescribedBy(t)})}};m.prototype._getTargetControlForAccAttributes=function(t){var e,a=this._oParent.getControlContext();if(a===c.None||a===c.Form||a===c.SmartFormGrid){if(t){e=t.control;if(e instanceof d){if(e.getItems().length>0){e=e.getItems()[0]}}}}return e};m.prototype.addValidations=function(t,e){var a,i,o=this;a=function(t,a){var i,n,r=a.getParameter("targetControl")||a.getSource();if(r){if(r.setValueState){r.setValueState(t)}n=a.getParameter("exception");if(n){i=n.message}if(!i){i=a.getParameter("message")}if(r.setValueStateText){r.setValueStateText(i)}}if(e){o._oParent[e](t===y.Error)}};i=function(t){a(y.Error,t)};t.attachFormatError(i);t.attachParseError(i);t.attachValidationError(i);t.attachValidationSuccess(function(t){o._oParent.onValidation(t);a(y.None,t)})};m.prototype._isInnerUoM=function(){var t=this.getCustomDataConfiguration();return t&&t.isUOM&&t.isInnerControl};m.prototype._getDisplayBehaviourConfiguration=function(t){var e=null,a,o=this._isInnerUoM(),n=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";var r=this._oParent.getConfiguration();if(r&&!this._getCriticalityQualifierConfiguration()){e=r.getDisplayBehaviour()}if(!e&&this._oMetaData&&this._oMetaData.entityType){e=this._oHelper.oAnnotation.getTextArrangement(this._oMetaData.property.property,this._oMetaData.entityType,n)}if(!e){if(!t&&this._oSelector){a=this._oSelector.checkComboBox({mode:"edit"});t=a&&a.combobox?"defaultDropDownDisplayBehaviour":"defaultInputFieldDisplayBehaviour"}e=this._oParent.data(t)}if(!e&&!o){e=i.DEFAULT_DISPLAY_BEHAVIOUR}return e};m.prototype._getCriticalityQualifierConfiguration=function(){var t=null,e=this._oParent.getConfiguration();if(e){t=e.getCriticalityQualifier&&e.getCriticalityQualifier()}return t};m.prototype._getPreventInitialDataFetchInVHDialog=function(t){var e=this._oParent.getConfiguration();if(e&&!e.isPropertyInitial("preventInitialDataFetchInValueHelpDialog")){return e.getPreventInitialDataFetchInValueHelpDialog()}if(u.isValueList(t)&&t["com.sap.vocabularies.Common.v1.ValueList"]&&t["com.sap.vocabularies.Common.v1.ValueList"].FetchValues){return t["com.sap.vocabularies.Common.v1.ValueList"].FetchValues.Int!=="1"}return false};m.prototype._formatDisplayBehaviour=function(t,e,a){var i=this._getDisplayBehaviourConfiguration(t);if(t==="defaultCheckBoxDisplayBehaviour"){return this._getFormattedExpressionFromDisplayBehaviour(i,e)}if(t==="defaultComboBoxReadOnlyDisplayBehaviour"&&!i){i="descriptionAndId"}return n.getFormattedExpressionFromDisplayBehaviour(i||"idOnly",e,a)};m.prototype._getFormattedExpressionFromDisplayBehaviour=function(t,e){var a="";switch(t){case"OnOff":a=e?"SMARTFIELD_CB_ON":"SMARTFIELD_CB_OFF";break;case"TrueFalse":a=e?"SMARTFIELD_CB_TRUE":"SMARTFIELD_CB_FALSE";break;default:a=e?"SMARTFIELD_CB_YES":"SMARTFIELD_CB_NO";break}return this._oRb.getText(a)};m.prototype.getDropdownItemKeyType=function(){};m.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(){};m.prototype.createValueHelp=function(t){var e,a=this.getCustomDataConfiguration(),i=this._isInnerUoM()?a&&a.smartFieldRootControl:this._oParent,o=t.edmProperty,n=t.valueHelp;if(n.annotation&&(o["sap:value-list"]||o["com.sap.vocabularies.Common.v1.ValueList"])){var l=n.displayBehaviour||this._getDisplayBehaviourConfiguration(),u=this._oParent.data("dateFormatSettings"),d=this._getPreventInitialDataFetchInVHDialog(o);if(typeof u==="string"){try{u=JSON.parse(u)}catch(t){}}var p,h,c,y,m,_,v;if(typeof n.annotation==="string"){h=n.annotation}else if(n&&typeof n.annotation==="object"){if(a){c=a.annotations;if(c&&c.valuelist&&typeof c.valuelist==="string"){h=c.valuelist}}y=c&&(c.valueListData&&c.valueListData.annotation||c.valuelist);p=n.analyser.getValueListAnnotationForFunctionImport({"":y||n.annotation},o.name).primaryValueListAnnotation}var P=t.control,A=t.model,b=t.onValueListChange;if(!n.noDialog){if(P.setFilterSuggests){P.setFilterSuggests(false)}if(i){if(i.isContextTable&&i.isContextTable()){v=i.data("configdata")&&i.data("configdata").configdata;if(v){m=v.defaultFilterBarExpanded;_=v.defaultShowAllFilters}}else{m=i.data("defaultFilterBarExpanded");_=i.data("defaultShowAllFilters")}}var B=new r({context:"SmartField",fnAsyncWritePromise:this._oParent._isAsync&&this._oParent._isAsync()?this._oParent.checkValuesValidity.bind(this._oParent):null,selectedODataRowHandler:this._selectedODataRowHandler.bind(this),fieldName:o.name,control:P,model:A,dateFormatSettings:u,displayBehaviour:l,loadAnnotation:true,fullyQualifiedFieldName:h,metadataAnalyser:n.analyser,annotation:p,title:n.dialogtitle,preventInitialDataFetchInValueHelpDialog:d,supportMultiSelect:!!n.supportMultiSelect,supportRanges:!!n.supportRanges,takeOverInputValue:true,type:n.type,maxLength:o.maxLength,filterBarClass:g,enabledMultiSelectionPlugin:n?.enabledMultiSelectionPlugin!==undefined?n.enabledMultiSelectionPlugin:true,defaultFilterBarExpanded:m,defaultShowAllFilters:_});if(b){B.attachValueListChanged(b)}this._aProviders.push(B);if(P.setShowValueHelp){P.setShowValueHelp(true)}}var D=true,C=true,S=true;if(this._oParent._getHistoryEnabled){D=this._oParent._getHistoryEnabled();C=this._oParent.isPropertyInitial("historyEnabled")}if(this._oParent.getShowValueHelp&&!this._oParent.getShowValueHelp()){S=false}if(!n.noTypeAhead||!P.isA("sap.m.Input")){e={control:P,model:A,dateFormatSettings:u,displayBehaviour:l,fieldViewMetadata:o,loadAnnotation:true,fullyQualifiedFieldName:h,metadataAnalyser:n.analyser,annotation:p,aggregation:n.aggregation,typeAheadEnabled:!n.noTypeAhead,dropdownItemKeyType:this.getDropdownItemKeyType(P),maxLength:o.maxLength,fieldHistoryEnabled:D,fieldHistoryEnabledInitial:C,bShowAllSuggestionsButton:S};var F=new s(this.getValueListProviderConfiguration(e));if(!n.noTypeAhead){if(P.setShowSuggestion){P.setShowSuggestion(true)}}if(b){F.attachValueListChanged(b)}this.oValueListDelegate=new f(F);this._aProviders.push(F)}}};m.prototype.getValueListProviderConfiguration=function(t){return{context:"SmartField",fnAsyncWritePromise:this._oParent._isAsync&&this._oParent._isAsync()?this._oParent.checkValuesValidity.bind(this._oParent):null,selectedODataRowHandler:this._selectedODataRowHandler.bind(this),control:t.control,model:t.model,dateFormatSettings:t.dateFormatSettings,displayBehaviour:t.displayBehaviour,fieldViewMetadata:t.fieldViewMetadata,loadAnnotation:true,fullyQualifiedFieldName:t.fullyQualifiedFieldName,metadataAnalyser:t.metadataAnalyser,annotation:t.annotation,aggregation:t.aggregation,typeAheadEnabled:t.typeAheadEnabled,dropdownItemKeyType:t.dropdownItemKeyType,maxLength:t.maxLength,fieldHistoryEnabled:t.fieldHistoryEnabled,fieldHistoryEnabledInitial:t.fieldHistoryEnabledInitial,bShowAllSuggestionsButton:t.bShowAllSuggestionsButton}};m.prototype._selectedODataRowHandler=function(t,e,a){if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.setDataForNextDescriptionRequest(t,e);this.oTextArrangementDelegate.setAbsolutePathToVLProperty(a)}};m.prototype.getAttribute=function(t){var e=this._oParent.getBindingInfo(t);if(e){return this._oBinding.toBindingPath(e)}return this._oParent["get"+t.substring(0,1).toUpperCase()+t.substring(1)]()};m.prototype.getCustomDataConfiguration=function(){var t=this._oParent&&this._oParent.data&&this._oParent.data("configdata");return t&&t.configdata?t.configdata:null};m.prototype.createAttributes=function(t,e,a,i){var o=this,n,r={};for(var s in a){if(a.hasOwnProperty(s)){var l=this._oParent.getBindingInfo(s);if(l){r[s]=this._oBinding.toBinding(l)}else if(s==="valueState"&&this._oParent.isPropertyInitial("valueState")){l=this.getValueStateBindingInfoForRecommendationStateAnnotation();if(l){r[s]=l}else{r[s]=this._oParent["get"+h(s)]()}}else{r[s]=this._oParent["get"+h(s)]()}if(s==="placeholder"&&e&&e.property&&!r.placeholder){r.placeholder=this._oHelper.oAnnotation.getPlaceholder(e.property)}}}if(t){if(e&&e.property&&e.property.type==="Edm.String"&&(this._oHelper.oAnnotation.isStaticOptional(e.property)||this._oParent&&this._oParent._fieldControlValue===3||this._oParent&&!this._oParent.getClientSideMandatoryCheck())){n={parseKeepsEmptyString:true}}if(e&&e.property&&u.getIsTimezoneProperty(e.property)){r[t]={model:this._oMetaData.model,path:this._oMetaData.path,parts:[{value:null},{path:this._oMetaData.path}],type:e?this._oTypes.getType(e,{showDate:false,showTime:false}):null,mode:this._oParent.getBindingMode("value")}}else{r[t]={model:this._oMetaData.model,path:this._oMetaData.path,type:e?this._oTypes.getType(e,n):null,mode:this._oParent.getBindingMode("value")}}}if(i){r[i.event]=function(t){try{var e=t.getParameters();var a={value:e[i.parameter],newValue:e[i.parameter]};o._oParent.fireChange(a)}catch(t){p.warning(t)}}}return r};m.prototype.mapBindings=function(t,e,a){var i,o;for(i in e){o=this._oParent.getBindingInfo(i);if(o){t[e[i]]=this._oBinding.toBinding(o)}else{t[e[i]]=a&&a[e[i]]||this._oParent["get"+i.substring(0,1).toUpperCase()+i.substring(1)]()}}};m.prototype.getFormatSettings=function(t){var e=null,a,i,o;if(t){e=this._oParent.data(t);if(!e){a=this._oParent.getCustomData();if(a){o=a.length;while(o--){i=a[o];if(i.getKey()===t){e=i.getValue();break}}}}if(e&&typeof e==="string"){try{e=JSON.parse(e)}catch(t){return null}}}return e};m.prototype.getValueListProvider=function(){return this._aProviders.find(function(t){return t.isA("sap.ui.comp.providers.ValueListProvider")})};m.prototype.getValueHelpProvider=function(){return this._aProviders.find(function(t){return t.isA("sap.ui.comp.providers.ValueHelpProvider")})};m.prototype.destroyValueHelp=function(){this._aProviders.forEach(function(t){t.destroy()});this._aProviders=[]};m.prototype.destroy=function(){this.destroyValueHelp();if(this._oBinding){this._oBinding.destroy()}this._oBinding=null;this._oParent=null;this._oModel=null;this._oRb=null};return m},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ControlProposal", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var t=e.smartfield.ControlProposalType;var o=a.extend("sap.ui.comp.smartfield.ControlProposal",{metadata:{library:"sap.ui.comp",properties:{controlType:{type:"sap.ui.comp.smartfield.ControlProposalType",group:"Misc",defaultValue:t.None}},aggregations:{objectStatus:{type:"sap.ui.comp.smartfield.ObjectStatus",multiple:false}}}});return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/FieldControl", ["sap/ui/comp/smartfield/BindingUtil","sap/ui/core/Lib","sap/ui/model/ParseException","sap/base/strings/capitalize","sap/base/util/isPlainObject","sap/ui/comp/library"],function(t,e,i,r,o,n){"use strict";var a=n.numericEdmTypes;var s=function(e,i){this._bIsDestroyed=false;this._oBinding=new t;this._oStoredProperties={};this._bVisibleSet=false;this._bEditableSet=false;this._bMandatorySet=false;this._bUomEditableSet=false;this._oStoredBindings={};this._oParent=e;this._oHelper=i;this._oAnnotation=i.oAnnotation};s.prototype.getPropertyNames=function(t){if(t){return["editable","visible"]}return["editable","visible","mandatory"]};s.prototype.getControlFormatters=function(t,e){var i,o,n,a={};if(t&&e){o=e.length;while(o--){n=e[o];i="_get"+r(n);if(this[i]){a[n]=this[i](t,this._oParent.getBindingInfo(n))}}}return a};s.prototype._getEditable=function(t,e,i){if(i===undefined){i="editable"}var n,a=this._oParent["get"+r(i)](),s=-1,p=-1,l=-1,d=-1,u=this;var f={length:0};if(i==="uomEditable"){this._bUomEditableSet=true}else{this._bEditableSet=true}if(!e){n=this._oParent["get"+r(i)]();this._oStoredProperties[i]=n;this._oStoredBindings.editable=null}else if(this._oStoredBindings.editable===undefined){this._oStoredBindings.editable=e}return{path:function(){var i=[],r,o=0;if(!t.property||!t.property.property){return[""]}r=u._oAnnotation.getFieldControlPath(t.property.property);if(r){i.push(u._toPath(t,r));s=o;o++}if(t.entitySet["sap:updatable-path"]){if(t.toRoleAssociationEndMultiplicity==="1"){i.push(u._toPath(t,t.entitySet["sap:updatable-path"]))}else{i.push(t.entitySet["sap:updatable-path"])}p=o;o++}if(e){l=o;u._oBinding.getBindingParts(e,i,f);o=o+f.length}if(t&&t.navigationPath&&!u._oParent._getEditableForNotExpandedNavigation()){i.push(t.navigationPath);d=o;o++}if(o>0){return i}return[""]},formatter:function h(_,y,g,b){if(u._bIsDestroyed){return false}if(!u._oAnnotation){return false}var c=this||u._oParent;var m;if(c&&typeof c.getBindingContext==="function"){m=c.getBindingContext()}var P=m&&m.getObject(),S=P&&P.__metadata,v=!!(S&&S.created),E=t.property&&t.property.property,B=s>-1?arguments[s]:null;if(v&&S.created.functionImport){if(B===1){return false}if(E["com.sap.vocabularies.Common.v1.FieldControl"]?.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/ReadOnly"||E["com.sap.vocabularies.UI.v1.ReadOnly"]){return false}return true}if(P&&E){if(v){if(c.data("ignoreInsertRestrictions")==="true"){return true}if(!u._getCreatableStatic(t)){return false}}else if(!u._getUpdatableStatic(t)){return false}}var C=[];if(s>-1){C.push(arguments[s]!==1)}if(p>-1&&(!P||!S||!v)&&arguments[p]!==undefined&&arguments[p]!==null){C.push(!!arguments[p])}if(l>-1){if(e.formatter){C.push(u._execFormatter(e.formatter,arguments,l,f.length))}else{C.push(!!arguments[l])}}if(d>-1){C.push(!!arguments[d])}if(C.length===0){var A=c&&c.getBinding(i),I=c&&c.getBindingPath(i),M=I==="",O=!!A&&A.isInitial(),T=_==null;if(T&&M&&(m&&!m.isTransient()||m===undefined)){n=u._oParent["get"+r(i)]()}else if(M&&o(_)&&P&&E&&u._getCreatableStatic(t)&&u._getUpdatableStatic(t)){n=u._oParent["get"+r(i)]()}else if(!O&&T){n=true}else if(!O&&a&&m&&m.isTransient()&&P&&E&&u._getCreatableStatic(t)){n=true}else if(!O&&!T&&M&&!o(_)){n=_}C.push(n)}return u._compare(C,false,true)}}};s.prototype._execFormatter=function(t,e,i,r){var o=[],n;if(i>-1&&r>-1){for(n=0;n<r;n++){o.push(e[i+n])}}return t.apply(this._oParent,o)};s.prototype._getCreatableStatic=function(t){var e=this._oAnnotation.canCreateEntitySet(t.entitySet),i=this._oAnnotation.canCreateProperty(t.property.property),r=t.ignoreInsertRestrictions;return(e||r)&&i};s.prototype._getUpdatableStatic=function(t){return this._oAnnotation.canUpdateEntitySet(t.entitySet)&&this._oAnnotation.canUpdateProperty(t.property.property)};s.prototype._compare=function(t,e,i){var r,o=t.length;for(r=0;r<o;r++){if(t[r]===e){return e}}return i};s.prototype._getUIVisible=function(t){const e=this._oHelper.getEdmProperty(t),i=!!t.functionImportProperty,r=this._oAnnotation.getVisible(e)==="true";if(!i){return r}return this._oAnnotation.getVisible(t.functionImportProperty)==="true"};s.prototype._getVisible=function(t,e,i){if(i===undefined){i="visible"}var n,a=-1,s=-1,p=this;var l={length:0};this._bVisibleSet=true;if(!e){n=this._oParent["get"+r(i)]();this._oStoredProperties[i]=n;this._oStoredBindings.visible=null}else if(this._oStoredBindings.visible===undefined){this._oStoredBindings.visible=e}return{path:function(){var i=[],r,o=0;if(!t.property||!t.property.property){return[""]}r=p._oAnnotation.getUIHiddenPath(t.property.property);if(!r){r=p._oAnnotation.getFieldControlPath(t.property.property)}if(r){i.push(p._toPath(t,r));s=o;o++}if(e){a=o;p._oBinding.getBindingParts(e,i,l);o=o+l.length}if(o>0){return i}return[""]},formatter:function d(u,f){if(p._bIsDestroyed){return false}if(!p._oAnnotation){return false}var h=this||p._oParent,_=t.property&&t.property.property;if(_&&!p._getUIVisible(t)||p._oAnnotation.getUIHiddenPath(_)&&u===true){return false}var y=[];if(s>-1){y.push(arguments[s]!==0);h._fieldControlValue=u}if(a>-1){if(e.formatter){y.push(p._execFormatter(e.formatter,arguments,a,l.length))}else{y.push(!!arguments[a])}}if(y.length==0){var g=h&&h.getBinding(i),b=h&&h.getBindingPath(i),c=b==="",m=!!g&&g.isInitial(),P=u==null,S;if(m&&P&&c){S=n}else if(!m&&P){S=true}else if(!m&&!P&&c&&!o(u)){S=u}else{S=p._oParent["get"+r(i)]()}y.push(S)}return p._compare(y,false,true)}}};s.prototype._getMandatory=function(t,e){var i=-1,r=-1,o=this;var n={length:0};this._bMandatorySet=true;if(!e){this._oStoredProperties.mandatory=this._oParent.getMandatory();this._oStoredBindings.mandatory=null}else if(this._oStoredBindings.mandatory===undefined){this._oStoredBindings.mandatory=e}return{path:function(){var a=[],s,p=0;if(!t.property||!t.property.property){return[""]}s=o._oAnnotation.getFieldControlPath(t.property.property);if(s){a.push(o._toPath(t,s));r=p;p++}if(e){i=p;o._oBinding.getBindingParts(e,a,n);p=p+n.length}if(p>0){return a}return[""]},formatter:function a(s,p){var l=t.property&&t.property.property,d=[],u,f,h;if(l&&l.nullable!==undefined){h=l&&l.nullable==="false"?true:false}if(o._bIsDestroyed){return true}u=r>-1;if(u){if(arguments[r]===7){h=true}else if(arguments[r]===3){h=false}}if(l&&o._oAnnotation){if(o._oAnnotation.isStaticMandatory(l)){h=true}else if(o._oAnnotation.isStaticOptional(l)){h=false}}if(h!==undefined){d.push(h)}f=i>-1;if(f){if(e.formatter){d.push(o._execFormatter(e.formatter,arguments,i,n.length))}else{d.push(!!arguments[i])}}if(d.length===0||l&&l.nullable==="true"&&!u&&!f){d.push(o._oParent.getMandatory())}return o._compare(d,true,false)}}};s.prototype._toPath=function(t,e){if(t.property.complex){return t.path.replace(t.property.property.name,e)}if(t.navigationPath){return t.navigationPath+"/"+e}return e};s.prototype.getMandatoryCheck=function(t,r){if(t){switch(t.property.type){case"Edm.DateTimeOffset":case"Edm.DateTime":case"Edm.Time":case"Edm.String":case"Edm.Decimal":case"Edm.Double":case"Edm.Float":case"Edm.Single":case"Edm.Int16":case"Edm.Int32":case"Edm.Int64":case"Edm.Byte":case"Edm.SByte":case"Edm.Guid":return function(o,n){var s,p=e.getResourceBundleFor("sap.ui.comp"),l=r?o==null:o===""||o==null,d=a.indexOf(t.property.type)!==-1;if(l){if(this._oParent&&this._oParent.getComputedTextLabel&&this._oParent.getComputedTextLabel()){s=p.getText("MANDATORY_FIELD_WITH_LABEL_ERROR",[this._oParent.getComputedTextLabel()])}else{s=p.getText("MANDATORY_FIELD_ERROR")}if(this._oAnnotation&&(d&&!this._oAnnotation.isStaticMandatory(t.property))&&(!this._oAnnotation.isNullable(t.property)&&!this._oAnnotation.isStaticOptional(t.property)&&(this._oParent&&this._oParent._fieldControlValue!==3))&&(this._oParent.getClientSideMandatoryCheck()||t.property.type!=="Edm.String")){throw new i(s)}if(this._oParent.getClientSideMandatoryCheck()&&this._oParent.getMandatory()){throw new i(s)}}}.bind(this)}}};s.prototype.getUOMEditState=function(t){var e,i,r,o=0,n;n=this._oParent.getBindingInfo("editable");e=this._getEditable(t,n);r={model:t.model,path:this._oHelper.getUOMPath(t),entitySet:t.entitySet,entityType:t.entityType,property:{property:t.annotations.uom.property,complex:t.property.complex,typePath:this._oHelper.getUOMTypePath(t)}};i=this._getEditable(r,this._oParent.getBindingInfo("uomEditable"),"uomEditable");return{path:function(){var t=e.path(),r=i.path();if(t[0]===""&&r===""){return[""]}o=t.length;return t.concat(r)},formatter:function t(r,n,a,s){var p=[],l,d,u,f=arguments.length;for(l=0;l<o;l++){p.push(arguments[l])}d=e.formatter.apply(null,p);p=[];for(l=0;l<f;l++){p.push(arguments[l])}for(l=0;l<o;l++){p.shift()}u=i.formatter.apply(null,p);if(!u&&!d){return 0}return 1}}};s.prototype.hasUomEditState=function(t){var e;if(t&&t.annotations&&t.annotations.uom){e=this._oParent.getControlProposal&&this._oParent.getControlProposal();if(e){if(e.getControlType()==="ObjectNumber"){return true}if(e.getObjectStatus()){return true}}return this._oParent.getProposedControl&&this._oParent.getProposedControl()==="ObjectNumber"}return false};s.prototype.bindProperties=function(t){var e={propertiesNames:this.getPropertyNames()};t=Object.assign(e,t);var i=t.propertiesNames,r=t.metadata;if(i.length){var o=this.getControlFormatters(r,i);for(var n in o){var a=this._oBinding.fromFormatter(r.model,o[n]);this._oParent.bindProperty(n,a)}}};s.prototype.destroy=function(){if(this._oBinding){this._oBinding.destroy();this._oBinding=null}this._oAnnotation=null;var t=this._oParent;if(t&&!t._bInDestroy){var e=true;for(var i in this._oStoredProperties){t.unbindProperty(i,e);var o="set"+r(i),n=t[o];if(typeof n==="function"){n.call(t,this._oStoredProperties[i])}}if(this._oStoredProperties){if(!this._oStoredProperties.editable&&this._bEditableSet){t.unbindProperty("editable")}if(!this._oStoredProperties.visible&&this._bVisibleSet){t.unbindProperty("visible")}if(!this._oStoredProperties.mandatory&&this._bMandatorySet){t.unbindProperty("mandatory")}if(!this._oStoredProperties.uomEditable&&this._bUomEditableSet){t.unbindProperty("uomEditable")}}if(this._oStoredBindings){if(this._oStoredBindings.editable){t.bindProperty("editable",this._oStoredBindings.editable)}if(this._oStoredBindings.visible){t.bindProperty("visible",this._oStoredBindings.visible)}if(this._oStoredBindings.mandatory){t.bindProperty("mandatory",this._oStoredBindings.mandatory)}if(this._oStoredBindings.uomEditable){t.bindProperty("uomEditable",this._oStoredBindings.uomEditable)}}}this._oStoredProperties=null;this._oStoredBindings=null;this._oParent=null;this._oHelper=null;this._bIsDestroyed=true;this._bEditableSet=false;this._bMandatorySet=false;this._bVisibleSet=false;this._bUomEditableSet=false};return s},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/JSONControlFactory", ["sap/m/CheckBox","sap/m/ComboBox","sap/m/DatePicker","sap/m/Input","sap/m/Text","sap/ui/comp/smartfield/ControlFactoryBase","sap/ui/comp/smartfield/JSONTypes"],function(e,t,r,a,o,n,i){"use strict";var s=n.extend("sap.ui.comp.smartfield.JSONControlFactory",{constructor:function(e,t,r){n.apply(this,[e,t]);this.sName="JSONControlFactory";this._oMetaData=r;this._oTypes=new i}});s.prototype._getCreator=function(){var e={Boolean:"_createBoolean",Date:"_createDate",DateTime:"_createString",Float:"_createString",Integer:"_createString",String:"_createString"};if(!this._oParent.getEditable()||!this._oParent.getEnabled()){if(this._oParent.getJsontype()==="Boolean"){return"_createBoolean"}return"_createDisplay"}return e[this._oParent.getJsontype()]||"_createString"};s.prototype._createString=function(){var e,t,r={width:true,textAlign:true,placeholder:true,name:true,maxLength:true};e=!this._oParent.getShowValueHelp();t=!this._oParent.getShowSuggestion();if(e){if(this._oParent.data("controlType")==="dropDownList"){return this._createComboBox({annotation:null,noDialog:e,noTypeAhead:true})}}return{control:new a(this.createAttributes("value",this._oParent.getJsontype(),r,{event:"change",parameter:"value"})),onCreate:"_onCreate",noDialog:e,noTypeAhead:t,params:{getValue:"getValue"}}};s.prototype._createComboBox=function(e){var r={width:true,textAlign:true,placeholder:true,name:true};return{control:new t(this.createAttributes("value",this._oParent.getJsontype(),r,{event:"selectionChange",parameter:"selectedItem"})),onCreate:"_onCreate",params:{valuehelp:e,getValue:"getValue"}}};s.prototype._createBoolean=function(){var t=this.createAttributes("selected",this._oParent.getJsontype(),{},{event:"select",parameter:"selected"});t.enabled=this._oParent.getEditable()&&this._oParent.getEnabled();return{control:new e(t),onCreate:"_onCreate",params:{getValue:"getSelected"}}};s.prototype._createDate=function(){var e={width:true,textAlign:true,placeholder:true,name:true};return{control:new r(this.createAttributes("value",this._oParent.getJsontype(),e,{event:"change",parameter:"value"})),onCreate:"_onCreate",params:{getValue:"getValue"}}};s.prototype._createDisplay=function(){var e={width:true,textAlign:true};return{control:new o(this.createAttributes("text",this._oParent.getJsontype(),e))}};s.prototype._onCreate=function(e,t){var r;this.addValidations(e,"setSimpleClientError");if(t.getValue){r=t.getValue;t.getValue=function(){return e[r]()}}};s.prototype.destroy=function(){this._oTypes.destroy();this._oTypes=null;this._oMetaData=null;n.prototype.destroy.apply(this,[])};return s},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/JSONTypes", ["sap/ui/model/type/Boolean","sap/ui/model/type/Date","sap/ui/model/type/Float","sap/ui/model/type/Integer","sap/ui/model/type/String"],function(e,t,n,r,u){"use strict";var o=function(){};o.prototype.getType=function(o){if(o){switch(o){case"Boolean":return new e;case"Date":return new t;case"Float":return new n;case"Integer":return new r;default:return new u}}return null};o.prototype.destroy=function(){};return o},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/LifecycleUtil",["sap/base/util/Deferred"],function(e){"use strict";var t={};t._getNextModeRenderedPromise=function(){var t=new e,i;this._oNextRendering=t;i={onAfterRendering:function(e){var n=this._oControl[this.getMode()];if(n&&n.getFocusDomRef()){this.removeEventDelegate(i);clearInterval(this._iNMRPromiseTimeout);t.resolve(this)}}.bind(this)};this.addEventDelegate(i);this._iNMRPromiseTimeout=setInterval(t.reject.bind(this,"rejected by timeout"),1e3);return t.promise};t._createICRenderedDeferred=function(){var t;t=new e;this._oRenderedWithContext=t;new Promise(function(e){var t={onAfterRendering:function(i){var n=this._oControl[this.getMode()],r=this.getAggregation("_content");if(!n){return}if(n.getDomRef()&&n.getFocusDomRef()&&n.getBindingContext()&&n===r){this.removeEventDelegate(t);e()}}.bind(this)};this.addEventDelegate(t)}.bind(this)).then(function(){t.resolve()})};t._getICRenderedPromise=function(){var e=this._oRenderedWithContext;return e?e.promise:undefined};t._rejectAll=function(e){if(this._oNextRendering){this._oNextRendering.reject(e)}if(this._oRenderedWithContext){this._oRenderedWithContext.reject(e)}};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataControlFactory", ["sap/base/i18n/Localization","sap/ui/core/Element","sap/ui/core/library","sap/m/library","sap/ui/comp/library","sap/ui/model/BindingMode","sap/m/TextArea","sap/m/Link","sap/m/CheckBox","sap/m/ComboBox","sap/ui/comp/smartfield/ComboBox","sap/m/DatePicker","sap/m/DateTimePicker","sap/m/HBox","sap/m/Input","sap/m/Select","sap/m/Text","sap/m/ExpandableText","sap/ui/core/Renderer","sap/ui/comp/navpopover/SmartLink","./ControlFactoryBase","./FieldControl","./ODataControlSelector","./ODataHelper","sap/ui/comp/odata/ODataModelUtilSync","./ODataTypes","./TextArrangementDelegate","sap/m/ObjectNumber","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/TimePicker","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartfield/Configuration","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/core/InvisibleText","sap/base/Log","sap/base/assert","sap/base/security/URLListValidator","sap/base/util/merge","sap/base/strings/capitalize","sap/base/util/deepClone","sap/base/strings/whitespaceReplacer","sap/m/FlexItemData","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/odata/CriticalityMetadata"],function(t,e,a,i,o,r,n,s,l,p,u,h,d,c,g,y,m,f,_,M,D,v,C,P,T,b,x,S,I,V,F,A,E,O,B,L,N,w,U,H,k,R,j,W,z,q,G){"use strict";var K=a.ValueState;var $=a.TextAlign;var Q=i.InputType;var J=i.EmptyIndicatorMode;var X=i.FlexJustifyContent;var Y=o.smartfield.CriticalityRepresentationType;var Z=o.smartfield.ControlContextType;var tt=a.TextDirection;var et=i.FlexAlignContent;var at=o.smartfield.TextInEditModeSource;var it=o.smartfield.ValueHelpTitleSource;var ot;var rt=D.extend("sap.ui.comp.smartfield.ODataControlFactory",{constructor:function(t,e,a){var i;D.call(this,t,e);this.sName="ODataControlFactory";this._oMetaData={annotations:{}};this._oMeta=a;if(t){i=t}else if(a&&a.modelObject){i=a.modelObject}this._oHelper=new P(i,this._oBinding,null,true);this._oFieldControl=new v(e,this._oHelper);this._oTypes=new b(e);this._oSelector=new C(this._oMetaData,e,this._oTypes);this.oTextArrangementDelegate=new x(this);this.oValueListDelegate=null;this._bInitialized=false;this._bInitializeFromConfig=false;this.bPending=false;this.oMeasureField=null;ot=sap.ui.require("sap/ui/comp/smartfield/SmartField");if(!ot){throw new Error("SmartField module not loaded for "+this)}}});rt.prototype._checkBoxFlag=function(t){if(!t.type){return}if(t.type==="Edm.Boolean"){this._oParent._bEdmBoolDetected=true}};rt.prototype._findProperty=function(t,e){return t.parameter.find(function(t){return t.name===e})};rt.prototype._init=function(t){var e=t.entitySetObject||this._oHelper.oMeta.getODataEntitySet(t.entitySet),a=this._oMetaData.path===t.path&&this._oMetaData.entitySet&&e&&this._oMetaData.entitySet.name===e.name&&this._oMetaData.model===t.model,i,o,r;if(!e){i=this._oHelper.oMeta.getODataFunctionImport(t.entitySet);if(i){e=this._oHelper.oMeta.getODataEntitySet(i.entitySet)||{};this._oMetaData.functionImport=i;this._oParent._isFunctionImport=true;this._oMetaData.functionImportProperty=this._findProperty(i,t.path)}}if(a){return}this._oMetaData.model=t.model;this._oMetaData.path=t.path;this._oMetaData.entitySet=e;if(this._oHelper.oMeta){U(this._oMetaData.entitySet,'The entity set named "'+t.entitySet+'" was not found in the "'+this._oHelper.oMeta.getODataEntityContainer().name+'" entity container of the service metadata document. - '+this.getMetadata().getName())}this._oMetaData.entityType=t.entityType||this._oHelper.oMeta.getODataEntityType(this._oMetaData.entitySet.entityType)||this._oMetaData?.functionImportProperty?.type;this._oMetaData.navigationPath=t.navigationPath||null;if(typeof t.ignoreInsertRestrictions==="boolean"){this._oMetaData.ignoreInsertRestrictions=t.ignoreInsertRestrictions}if(this._oModel){this._oHelper.checkNavigationProperty(this._oMetaData,this._oParent);this._oHelper.getProperty(this._oMetaData);r=Object.assign({},this.getEdmProperty());if(this._oMetaData?.functionImportProperty){if(!r){r=this._oMetaData.functionImportProperty}else{Object.assign(r,this._oMetaData.functionImportProperty)}if(r){this._oMetaData.property.property=r}}U(!!r,'The EDM property "'+t.path+'" was not found in the "'+this._oMetaData.entityType.namespace+"."+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(r){this._checkBoxFlag(r);if(!this._oParent._shouldSuppressTextAnnotation()){this._oMetaData.annotations.text=this._oHelper.getTextProperty2(this._oMetaData)}o=this._oHelper.getAnalyzer();this._oMetaData.annotations.uom=this._oHelper.getUnitOfMeasure2(this._oMetaData);this._oHelper.getValueListData(this._oMetaData);this._oMetaData.annotations.lineitem=o.getLineItemAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData.annotations.datapoint=o.getDataPointAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData.annotations.fieldgroup=o.getFieldGroupAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData.annotations.connectedfields=o.getConnectedFieldsAnnotation(this._oMetaData.entitySet.entityType);this._oHelper.getUOMValueListAnnotationPath(this._oMetaData);this._oMetaData.annotations.semantic=B.getSemanticObjectsFromProperty(r);this._oMetaData.annotations.semanticKeys=o.getSemanticKeyAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData._isNumber=B.isNumber(r);this._oHelper.applyCriticality(this._oMetaData,this._getCriticalityQualifierConfiguration());if(this._oMetaData.annotations.uom){this._oMetaData.annotations.uom.annotations={};this._oHelper.getValueListData(this._oMetaData.annotations.uom)}this._oHelper.getUOMTextAnnotation(this._oMetaData);if(this._oParent&&this._oParent.getExpandNavigationProperties&&this._oParent.getExpandNavigationProperties()){var n=this._oParent.getBindingContext(),s=n&&n.getObject(),l=s&&s.__metadata.created;if(!l){var p=this._oHelper.getAutoExpandProperties(r);if(p.length>0){this._oParent.bindElement({path:"",parameters:{expand:p,select:p}})}}}}}else{this._oMetaData.modelObject=t.modelObject;this._oMetaData.property=t.property;this._oMetaData.annotations.text=t.annotations.text;this._oMetaData.annotations.uom=t.annotations.uom;if(this._oMetaData.annotations.uom&&!this._oMetaData.annotations.uom.annotations){this._oMetaData.annotations.uom.annotations={}}if(t.annotations.valueListData){this._oMetaData.annotations.valuelist=t.annotations.valueListData}else{this._oMetaData.annotations.valuelist=t.annotations.valuelist}this._oMetaData.annotations.lineitem=t.annotations.lineitem;this._oMetaData.annotations.datapoint=t.annotations.datapoint;this._oMetaData.annotations.fieldgroup=t.annotations.fieldgroup;this._oMetaData.annotations.connectedfields=t.annotations.connectedfields;this._oHelper.applyCriticality(this._oMetaData,this._getCriticalityQualifierConfiguration());this._oMetaData.annotations.valuelistType=t.annotations.valuelistType;this._oMetaData.annotations.semantic=t.annotations.semantic;this._oMetaData.annotations.valuelistuom=t.annotations.valuelistuom}};rt.prototype._initValueList=function(t){var e=this._oMetaData.property,a=t.primaryValueListAnnotation;this._oMetaData.annotations.valueListData=a;e.valueListAnnotation=a;e.valueListKeyProperty=this._oHelper.getODataValueListKeyProperty(a);e.valueListEntitySet=this._oHelper.oMeta.getODataEntitySet(a.valueListEntitySetName);e.valueListEntityType=this._oHelper.oMeta.getODataEntityType(this._oHelper.oMeta.getODataEntitySet(a.valueListEntitySetName).entityType)};rt.prototype._getTextArrangementType=function(){var t=null,e=x.getPaths("ValueList",this._oMetaData);if(e.keyField&&e.descriptionField){t=this._oTypes.getType(this._oMetaData.property,null,null,{composite:true,keyField:e.keyField,descriptionField:e.descriptionField,valueListNoValidation:this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation"});if(Array.isArray(t)){t=t[0]}if(!(t.isA("sap.ui.comp.smartfield.type.TextArrangementString")||t.isA("sap.ui.comp.smartfield.type.TextArrangementGuid"))){t=null}}return t};rt.prototype._displayFormatter=function(t,e){if(t===null){return""}if(this.oType&&!this._bTextInDisplayModeValueList){t=this.oType.formatValue(t,"string")}if(this.oType&&this.oType.isA("sap.ui.comp.odata.type.NumericText")&&t===null&&e){t=""}return this._formatDisplayBehaviour(null,t,e)};rt.prototype._createEdmDisplay=function(a){var i,o,r,n=this._getLocalTextAnnotation(),s=n&&n.path||null,l,p,u,h="getText",d=this,c={width:true,textAlign:true},g=this.getEdmProperty(),y=this._oParent.data("configdata"),_=this._oSelector.checkDatePicker()||(g?g.type.startsWith("Edm.Date"):false),D=g?g.type==="Edm.Time":false,v=g&&B.getIsTimezoneProperty(g),C=this._isObjectStatusScenario();if(this._checkLink()&&!this._oSelector.useObjectIdentifier()){return this._createLink(_)}l=this.createAttributes(null,this._oMetaData.property,c);l.emptyIndicatorMode=J.Auto;this.oType=null;var P=g&&B.getTimezonePropertyPath(g)||false;if(g&&g.type==="Edm.DateTimeOffset"&&P){this.oType=this._getDateFormatType();var T=function(){if(!arguments[0]&&!(this.oType.oFormatOptions&&this.oType.oFormatOptions.showDate===false&&this.oType.oFormatOptions.showTime===false)){return""}return this.oType.formatValue(arguments,"string")};l.text={model:this._oMetaData.model,type:this.oType,parts:[{path:this._oMetaData.path,type:this.oType},{path:P,parameters:{useUndefinedForUnresolved:true}}],useRawValues:true,formatter:T.bind(this)}}else if(_||D){this.oType=this._getDateFormatType();l.text={model:this._oMetaData.model,path:this._oMetaData.path,type:this.oType}}else if(v){this.oType=this._oTypes.getType(this._oMetaData.property,{showDate:false,showTime:false});l.text={model:this._oMetaData.model,parts:[{value:null},{path:this._oMetaData.path}],type:this.oType}}else{l.text={model:this._oMetaData.model,type:this.oType};if(this._bTextInDisplayModeValueList&&this._oMetaData.property&&this._oMetaData.property.valueListAnnotation){u={};if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){u.sDisplayFormat="UpperCase"}u.valueListNoValidation=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";p=this.oTextArrangementDelegate.getBindingInfo(u);this.oType=p.type;l.text.parts=p.parts}if(!this.oType){var x=this._oParent.data("defaultTextInEditModeSource")&&this._oParent.isPropertyInitial("textInEditModeSource");this.oTextArrangementDelegate.checkRequiredMetadata(this._oParent._getComputedTextInEditModeSource(),x);this.oType=this._oTypes.getType(this._oMetaData.property);l.text.path=this._oHelper.getEdmDisplayPath(this._oMetaData)}l.text.type=this.oType}if(g){o=this._oHelper.oAnnotation.isMasked(g);if(o){l.text.formatter=b.maskValue}if(s){r=this._oSelector.useObjectIdentifier(_,o);if(r){delete l.width;delete l.textAlign;l.text={path:this._oMetaData.path};l.title={path:this._oHelper.getEdmDisplayPath(this._oMetaData)};if(this._oParent.hasListeners("press")){l.titleActive=true;l.titlePress=function(t){d._oParent.firePress(t)}}else if(this._oMetaData.annotations.semantic&&this._oMetaData.annotations.semantic.defaultSemanticObject){var S;var F;var E=this._oMetaData.annotations.semantic.additionalSemanticObjects.concat(this._oMetaData.annotations.semantic.defaultSemanticObject);A.getDistinctSemanticObjects().then(function(t){S=A.hasDistinctSemanticObject(E,t);if(S){var a=d._oParent.getBindingInfo("value");var i=a.parts[0].path;F=new M({semanticObject:d._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:d._oMetaData.annotations.semantic.additionalSemanticObjects,fieldName:i});if(!F.hasListeners("navigationTargetsObtained")){F.attachNavigationTargetsObtained(function(t){const a=e.getElementById(t.getSource().getControl());const i=t.getParameters().mainNavigation;if(i){i.setDescription(a.getText())}t.getParameters().show(a.getTitle(),i,undefined,undefined)})}if(!F.hasListeners("navigationTargetsObtained")){F.setNavigationTargetsObtainedCallback(t=>{const a=e.getElementById(t.originalId);const i=t.mainNavigation;if(i){i.setDescription(a.getText())}return Promise.resolve({mainNavigationId:a.getTitle(),mainNavigation:i})})}}});l.titleActive={path:"$sapuicompsmartfield_distinctSO>/distinctSemanticObjects",formatter:function(t){return A.hasDistinctSemanticObject(E,t)}};l.titlePress=function(t){if(S&&F){const e=F.getFieldInfo();if(!e){return}e.open(t.getSource(),t);e.setSourceControl(t.getSource());t.getSource().addDependent(F)}}}}else if(!(y&&y.isInnerControl===true)){l.text={};l.text.parts=[];l.text.parts.push(this._oMetaData.path);l.text.parts.push(this._oHelper.getEdmDisplayPath(this._oMetaData));l.text.formatter=this._displayFormatter.bind(this)}}else if(this._oSelector.checkCheckBox()){l.text.formatter=function(t){return d._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",t)}}}if(r){i=new I(this._oParent.getId()+"-objIdentifier",l);if(this._oMetaData.annotations.semantic){i.setModel(A.getJSONModel(),"$sapuicompsmartfield_distinctSO")}}else{if(l.text.type&&l.text.type.isA("sap.ui.comp.smartfield.type.DateTime")&&l.text.type.oConstraints&&l.text.type.oConstraints.isDateOnly){l.wrapping=false}if(this._oParent.isContextTable()&&t.getRTL()){l.textDirection="LTR"}if(typeof l.text.formatter==="undefined"&&!P&&!v){l.text.formatter=function(t){return W(t)}}l.renderWhitespace=true;if(this._oHelper.oAnnotation.isMultiLineText(g)){delete l.width;i=new f(this._oParent.getId()+"-expandableText",l)}else if(C&&!this._isInnerUoM()){delete l.width;delete l.textAlign;delete l.renderWhitespace;l.emptyIndicatorMode=J.Auto;this._addMetadataObjectStatusAttributes(l,g.criticalityInfo);i=new V(this._oParent.getId()+"-objStatus",l)}else{i=new m(this._oParent.getId()+"-text",l)}}if(r&&y&&y.configdata&&y.configdata.onText){delete y.configdata.onText}var O={control:i,onCreate:"_onCreate",params:{getValue:h,noValidations:true,type:null}};if(this.oType){O.type={type:this.oType,property:this._oMetaData.property}}return O};rt.prototype._getDateFormatType=function(){var t=this.getFormatSettings("dateFormatSettings"),e=this.getEdmProperty(),a;try{a=j(t)}catch(e){a=t}if(a&&e&&e.type==="Edm.DateTimeOffset"){a.UTC=false}return this._oTypes.getType(this._oMetaData.property,a)};rt.prototype._createEdmTime=function(){var t=this.getFormatSettings("dateFormatSettings"),e={width:true,placeholder:true,valueState:true,valueStateText:true};var a=rt.getBoundPropertiesMapInfoForControl(F.getMetadata().getName(),{propertyName:"value"})[0];var i={valueFormat:"HH:mm:ss"};i=Object.assign(i,this.createAttributes(a,this._oMetaData.property,e,{event:"change",parameter:"value"}));if(i.width===""){i.width="100%"}if(t){i[a].type=this._oTypes.getType(this._oMetaData.property,t)}var o=new F(this._oParent.getId()+"-timePicker",i);this._enhanceInputControls(o);return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:i.value.type,property:this._oMetaData.property}}}};rt.prototype._createProposedObjectStatus=function(){var t=this.createAttributes(null,this._oMetaData.property,null),e=this._getLocalTextAnnotation();var a=rt.getBoundPropertiesMapInfoForControl(V.getMetadata().getName(),{propertyName:"value"})[0];if(e){t[a]={parts:[this._oHelper.getEdmDisplayPath(this._oMetaData)]}}else{t[a]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)}}t.emptyIndicatorMode=J.Auto;this._addProposedObjectStatusAttributes(t);var i=new V(this._oParent.getId()+"-objStatus",t);return{control:i,onCreate:"_onCreate",params:{getValue:"getText",noValidation:true}}};rt.prototype._addProposedObjectStatusAttributes=function(t){var e,a=this._oParent.getControlProposal(),i=a&&a.getObjectStatus();if(i){e=i.getBindingInfo("criticality")}var o=function(t){var e={0:K.None,1:K.Error,2:K.Warning,3:K.Success};var a={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":K.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":K.Warning,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":K.Error,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":K.Success};return a[t]||e[t]||K.None};var r=function(){var t={};t[K.Error]="sap-icon://error";t[K.Warning]="sap-icon://alert";t[K.Success]="sap-icon://sys-enter-2";t[K.None]=null;var a;if(e){if(e.formatter){a=e.formatter.apply(null,arguments)}else{a=arguments[0]}}else{a=i.getCriticality()}if(a===undefined||a===null){return null}return t[o(a)]};var n=function(){if(!i){return false}return i.getCriticalityRepresentationType()!==Y.WithoutIcon};if(e){t.state={formatter:function(){var t;if(e.formatter){t=e.formatter.apply(null,arguments)}else{t=arguments[0]}return o(t)},parts:e.parts};if(n()){t.icon={formatter:r,parts:e.parts}}}else{if(i){t.state=o(i.getCriticality())}if(n()){t.icon=r()}}};rt.prototype._addMetadataObjectStatusAttributes=function(t,e){var a;if(!e){return}a=G.getShowCriticalityIcon(e.criticalityRepresentationType);if(e.path){t.state={path:e.path,formatter:G.getCriticalityState};if(e.criticalityRepresentationPath){t.icon={parts:[{path:e.path},{path:e.criticalityRepresentationPath}],formatter:function(t,e){return G.getShowCriticalityIcon(e)?G.getCriticalityIcon(t):undefined}}}else if(a){t.icon={path:e.path,formatter:G.getCriticalityIcon}}}else{t.state=G.getCriticalityState(e.criticalityType);if(e.criticalityRepresentationPath){t.icon={path:e.criticalityRepresentationPath,formatter:function(t){return G.getShowCriticalityIcon(t)?G.getCriticalityIcon(e.criticalityType):undefined}}}else if(a){t.icon=G.getCriticalityIcon(e.criticalityType)}}};rt.prototype._isObjectStatusScenario=function(){const t=this.getEdmProperty();const e=t&&t.criticalityInfo;if(e&&e.criticalityFrom!=="ConnectedFields"){return true}if(e&&e.criticalityFrom==="ConnectedFields"&&this._oParent.getParent().isA("sap.ui.comp.smartform.SemanticGroupElement")){return true}return false};rt.prototype._createInput=function(t){var e=new g(this._oParent.getId()+"-input",t);this._enhanceInputControls(e);return e};rt.prototype._enhanceInputControls=function(t){if(t.isA("sap.m.InputBase")&&typeof t._setPreferUserInteraction==="function"){t._setPreferUserInteraction(true)}};rt.prototype._createEdmString=function(t){var e={},a=t.mode,i={},o=this.isEmptyStringSignificant(),r;if(this._oSelector.checkCheckBox()){return this._createCheckBox()}var n=this._oSelector.checkSelection();if(n.selection){return this._createSelect({valueHelp:rt.getValueHelpDropdownSettings(n)})}n=this._oSelector.checkComboBox(t);if(n.combobox){return this._createComboBox({valueHelp:rt.getValueHelpDropdownSettings(n),edit:true})}var s={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var l=this.getEdmProperty();if(this._oHelper.oAnnotation.isMultiLineText(l)){delete s["width"];return this._createMultiLineText({attributesNamesMap:s})}var p=this._oParent.isTextInEditModeSourceNotNone(),u=/Edm.String|Edm.Guid/.test(l.type);if(p||this._bTextInDisplayModeValueList){U(u,"The ValueList and NavigationProperty"+"members of the sap.ui.comp.smartfield.TextInEditModeSource enumeration are only supported for OData "+"EDM Properties typed as Edm.String or Edm.Guid. - "+this.getMetadata().getName())}var h=rt.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];var d=this._oParent._getComputedTextInEditModeSource(),c,y;if(this._oParent.data("defaultTextInEditModeSource")&&this._oParent.isPropertyInitial("textInEditModeSource")&&a==="edit"){c=true}if(u){this.oTextArrangementDelegate.bValidMetadata=this.oTextArrangementDelegate.checkRequiredMetadata(d,c);y=this._oHelper.checkValueListRequiredMetadataForValidation(this._oMetaData.property)}if(this.oTextArrangementDelegate.bValidMetadata){i=this.createAttributes("",this._oMetaData.property,s);e.valueListNoValidation=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";i[h]=this.oTextArrangementDelegate.getBindingInfo(e)}else if(d===at.ValueList&&y&&a==="edit"){i=this.createAttributes(h,this._oMetaData.property,s);i[h]=this.oTextArrangementDelegate.getBindingInfo(e)}else if(o){i=this.createAttributes(h,Object.assign({isStringNullable:true},this._oMetaData.property),s)}else{i=this.createAttributes(h,this._oMetaData.property,s)}if(L.isFiscalValue(l)){i.placeholder=i.value?.type?.formatter?.getPattern();r=this._createInput(i);this._handleEventingForEdmString({control:r,edmProperty:this._oMetaData.property.property});return{control:r,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:i.value.type,property:this._oMetaData.property}}}}if(q.isCalendarValue(l)){i.placeholder=i.value?.type?.formatter?.getPattern();const t=this._createInput(i);this._handleEventingForEdmString({control:t,edmProperty:this._oMetaData.property.property});return{control:t,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:i.value.type,property:this._oMetaData.property}}}}var m=i.value.type&&i.value.type.oConstraints;if(m&&m.maxLength&&!B.isValueList(l)){i.maxLength=m.maxLength}var f=this._createInput(i);if(this._oHelper.oAnnotation.isMasked(l)){f.setType(Q.Password)}var _=this.getCustomDataConfiguration();if(this.oTextArrangementDelegate.bValidMetadata){this._handleEventingForTextArrangement({control:f});const t=this?._oMetaData?.property?.valueListKeyProperty,e=t?t["com.sap.vocabularies.Common.v1.DocumentationRef"]:undefined;if(e){this.getODataHelper()._setControlDocumentationRef(f,e)}}else{this._handleEventingForEdmString({control:f,edmProperty:this._oMetaData.property.property,currency:_&&_.currency})}return{control:f,onCreate:"_onCreate",params:{valuehelp:{annotation:n.annotation,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"},getValue:"getValue",type:{type:i.value.type,property:this._oMetaData.property,emptyStringSignificant:o}}}};rt.prototype.isEmptyStringSignificant=function(){var t=this.getEdmProperty(),e=t&&(t["sap:semantics"]==="currency-code"||t["sap:semantics"]==="unit-of-measure"),a=this._getDisplayBehaviourConfiguration(),i=a==="descriptionAndId"||a==="idAndDescription"||false,o=this._oMetaData.annotations&&this._oMetaData.annotations.valueListData,r=o&&o.descriptionField!==undefined;return i&&!e&&r||false};rt.prototype.getLocalTextPropertyName=function(){var t,e=this._oHelper.getAnalyzer(),a=this.getEdmProperty();if(e&&a){t=e.getDescriptionFieldName(a)}return t};rt.getValueHelpDropdownSettings=function(t){return{annotation:t.annotation,noDialog:true,noTypeAhead:true}};rt.prototype._getMaxLength=function(){return this._oTypes.getMaxLength(this._oMetaData.property,this._oParent.getBindingInfo("value"))};rt.prototype._addAriaLabelledBy=function(t){var e,a,i,o=this._oParent.getControlContext();if(o===Z.None||o===Z.Form||o===Z.SmartFormGrid){D.prototype._addAriaLabelledBy.apply(this,arguments);i=this._oParent.data("configdata");if(i&&i.configdata.isInnerControl){if(t){a=t.control;if(a instanceof c){if(a.getItems().length>0){a=a.getItems()[0]}}}if(a&&a.getAriaLabelledBy&&a.getAriaLabelledBy().length===0){var r=this.getEdmProperty();if(this._oHelper.oAnnotation.getLabel(r)){e=new N({text:this._oHelper.oAnnotation.getLabel(r)});a.addAriaLabelledBy(e);this._oParent.addAggregation("_ariaLabelInvisibleText",e)}}}}};rt.prototype._addAriaDescribedBy=function(){var t=this._oParent.getControlContext();if(t===Z.None||t===Z.Form||t===Z.SmartFormGrid){D.prototype._addAriaDescribedBy.apply(this,arguments)}};rt.prototype._handleEventingForEdmString=function(t){var e=t.control;if(!e){return}e.attachChange(function a(i){var o=this._getChangeEventParams(i),r=i&&i.getParameters(),n=i&&i.getSource(),s,l,p,u,h=null;if(r){s=r.value;o.value=s;o.newValue=s;l=e._oSuggestionPopup&&e._oSuggestionPopup.isOpen();if(l){p=e._oSuggestionPopup.getContent&&e._oSuggestionPopup.getContent();u=p&&p.length>0&&p[0]&&p[0].isA("sap.m.Table")&&p[0];h=u&&u.getSelectedItem&&u.getSelectedItem();if(!r.validated&&h){return}}if(t.currency){var d=this.getCurrencyValidationSettings();d.oSource=n;if(this._oHelper.oAnnotation.isUpperCase(t.edmProperty)&&s){s=s.toUpperCase();e.setValue(s)}}try{this._oParent.fireChange(o)}catch(t){w.error(t)}}}.bind(this))};rt.prototype._handleEventingForTextArrangement=function(t){var e=t.control;if(!e){return}e.attachChange(function(t){var a=this._getChangeEventParams(t),i=e._oSuggPopover,o=e.getShowSuggestion(),r=o&&i.isOpen(),n=false;if(r){var s=i.getItemsContainer&&i.getItemsContainer();n=s&&s.getSelectedItem()!==null}if(r&&(!a.validated&&n)){return}if(!n&&!a.validated){const t=this._oParent.getFirstInnerControl?.().getBinding?.("value"),e=t&&t.getCurrentValues?.()[0],i=t&&t?.oType?.oFormatOptions?.textArrangement;if(e&&i&&(i==="idAndDescription"||i==="descriptionAndId")&&this._oParent.getValueState()!=="Error"){a.newValue=e;a.value=e}}try{var l=this._oParent.data("configdata");if(l&&l.configdata&&this._oParent.isTextInEditModeSourceNotNone()){this._oParent.checkValuesValidity().catch(function(){}).finally(function(){this._oParent.fireChange(a)}.bind(this))}else{this._oParent.fireChange(a)}}catch(t){w.error(t)}}.bind(this))};rt.prototype.getUOMChangeHandler=function(t){return function(e){try{var a=t.smartFieldRootControl,i=e.getParameters(),o=i.value,r=e.getSource(),n=t.currency,s=n?this.getCurrencyValidationSettings(t):this.getUnitValidationSettings(t);s.oSource=r;n?this.updateModelPropertiesForCurrency("value",s):this.updateModelPropertiesForUnit("value",s);a.fireChange({value:o,newValue:o,unitChanged:!!t.unit,validated:!!i.validated})}catch(e){if(e.validationUnitError){a.fireChange({value:o,newValue:o,unitChanged:!!t.unit,validated:!!i.validated})}w.error(e)}}.bind(this)};rt.prototype.getCurrencyValidationSettings=function(t){var e;if(t){e=t.smartFieldRootControl}else{var a=this.getCustomDataConfiguration();e=a&&a.smartFieldRootControl}var i=e.getInnerControls();return{amountField:i[0],currencyField:i[1],errorState:e._oError,checkValidity:e.checkValuesValidity.bind(e),rootControl:e,bindingContext:e.getBindingContext()}};rt.prototype.getUnitValidationSettings=function(t){var e;if(t){e=t.smartFieldRootControl}else{var a=this.getCustomDataConfiguration();e=a&&a.smartFieldRootControl}var i=e.getInnerControls();return{measureField:i[0],unitField:i[1],errorState:e._oError,checkValidity:e.checkUnitValidity.bind(e),rootControl:e}};rt.prototype._setCurrencyValues=function(t,e,a){var i=t.getBindings(),o=i[0].getContext(),r=i[1].getContext();t.setContext(a);t.setValue(e);i[0].setContext(o);i[1].setContext(r)};rt.prototype.updateModelPropertiesForCurrency=function(t,e){var a=e.amountField,i=e.currencyField,o=e.oSource,n=a.getValue(),s,l,p="";if(i){var u=i.getMetadata().getName();s=rt.getBoundPropertiesMapInfoForControl(u,{propertyName:t})[0];l=i.getParent();if(this._getDisplayBehaviourConfiguration()&&l&&(l.getEditable&&(!l.getEditable()||l._oFactory._getTextArrangementType()))){p=l.getBinding("value").getValue()}else{var h="get"+R(s);p=i[h]()}}var d=[n,p];var c={rawValues:d,handleSuccess:false};var g=e.checkValidity(c);function y(l){var p=a.getModel(),u=a.getBinding(t),h,c;if(i){h=i.getBinding(s);c=h.getType()}var g=u.getType(),y=u.getExternalValue(),m=h&&h.getExternalValue(),f=g.parseValue(n,"string",d),_=f[1],M=g.formatValue(f,"string"),D=c&&c.formatValue(_,"string");if(p.getDefaultBindingMode()===r.TwoWay){if(!l){this._setCurrencyValues(u,f,e.bindingContext)}}if(!l){a.setValue(M)}var v=false,C=true;if(u.hasValidation()&&!l){var P={element:a,property:t,type:g,newValue:M,oldValue:y,mParameters:{originSource:o}};a.fireValidationSuccess(P,v,C)}if(h&&h.hasValidation()){var T={element:i,property:s,type:c,newValue:D,oldValue:m,mParameters:{originSource:o}};i.fireValidationSuccess(T,v,C)}}function m(t){}function f(){var o=e.errorState;if(o.bComplex&&o.bFirst&&o.bSecond){var r=a.getBinding(t).getExternalValue();d=[r,p];var n={rawValues:d,innerControls:[i],handleSuccess:false};var s=e.checkValidity(n);s.then(function(){return y.call(this,true)}.bind(this)).catch(m)}}g.then(function(){return y.call(this)}.bind(this)).catch(m).finally(f)};rt.prototype.updateModelPropertiesForUnit=function(t,e){var a=e.measureField,i=e.unitField,o=a.getValue(),n,s="",l=e.oSource,p=a.getMetadata().getName(),u,h,d={},c,g;if(i){var y=i.getMetadata().getName();n=rt.getBoundPropertiesMapInfoForControl(y,{propertyName:t})[0];var m="get"+R(n),f=i.getParent();if(i.isA("sap.m.ComboBox")){s=i.getSelectedKey()}else if(this._getDisplayBehaviourConfiguration()&&f&&(!f.getEditable()||f._oFactory._getTextArrangementType())){s=f.getBinding("value").getValue()}else{s=i[m]()}}else if(this._checkSuppressUnit()){var _=this.getMetaData().annotations.uom.path,M=a.getBindingContext();s=this._oModel.getData(_,M)}var D=[o,s];var v={rawValues:D,handleSuccess:false};var C=e.checkValidity(v);if(C){var P=a.getModel(),T=a.getBinding(t),b,x;if(i){b=i.getBinding(n);x=b.getType()}var S=T.getType(),I=S.parseValue(o,"string",D),V=I[1],F,A;if(V===undefined&&i&&!i.getEditable){F=S.formatValue([I[0],null],"string");A=V}else{F=S.formatValue(I,"string");if(!T.isA("sap.ui.comp.smartfield.type.Unit")){V=s}A=x&&x.formatValue(V,"string")}if(P.getDefaultBindingMode()===r.TwoWay){T.setValue(I);u=false;h=true;d=rt.getBoundPropertiesMapInfoForControl(p,{propertyName:"value"});c=d&&d[0];g={element:a,property:c,type:T.getType(),newValue:o,oldValue:T.getValue(),mParameters:{originSource:l}};a.fireValidationSuccess(g,u,h)}a.setValue(F);if(i&&i.getEditable&&i.getEditable()&&i.getParent().getVisible()&&!i.isA("sap.m.ComboBox")){i.setValue(A)}}};rt.prototype._createComboBox=function(t){var e=null,a=this._isMComboBoxRequired(),i=a?p:u,o=this._oParent._getComputedTextInEditModeSource(),r=o==="ValueList"?"realValue":"value",n=a?"value":r,s={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true},l,h={},d={width:"100%"},c=false;l=rt.getBoundPropertiesMapInfoForControl(i.getMetadata().getName(),{propertyName:n})[0];h["change"]=this._oHelper.getDropdownChangeHandler(this._oParent,!a);if(t.edit){if(a){h=Object.assign(h,this.createAttributes(l,this._oMetaData.property,s),d);e=new p(this._oParent.getId()+"-comboBoxEdit",h)}else{if(B.getIsTimezoneProperty(this._oMetaData.property)){h=Object.assign(h,this.createAttributes(l,this._oMetaData.property,s),d)}else{c=true;h=Object.assign(h,this.createAttributes(l,Object.assign({isStringNullable:true},this._oMetaData.property),s),d)}e=new u(this._oParent.getId()+"-comboBoxEdit",h)}this._enhanceInputControls(e);e.attachChange(function(){this._oParent.oValidation.handleComboValidation(e)}.bind(this))}else{h=Object.assign(h,this.createAttributes(l,this._oMetaData.property,s),d);e=this._createDisplayedComboBox(h)}this._oParent.oValidation.addValidationToType(h[l].type);e.setFilterFunction(function(t,e){RegExp.escape=function(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")};var a=RegExp.escape(t);var i=new RegExp(a,"i");return e.getText().match(new RegExp(i,"i"))||e.getKey().match(new RegExp(i,"i"))});e.useHighlightItemsWithContains=function(){return true};return{control:e,onCreate:"_onCreate",params:{valuehelp:{annotation:t.valueHelp.annotation,aggregation:"items",noDialog:t.valueHelp.noDialog,noTypeAhead:t.valueHelp.noTypeAhead},getValue:"get"+l[0].toUpperCase()+l.slice(1),type:{type:h[l].type,property:this._oMetaData.property,emptyStringSignificant:c}}}};rt.prototype._createDisplayedComboBox=function(t){var e=p.extend("sap.ui.comp.smartfield.DisplayComboBox",{metadata:{library:"sap.ui.comp",properties:{wrapping:{type:"boolean",group:"Appearance",defaultValue:true}}},renderer:{apiVersion:2,render:function(t,e){var a=e.getWidth(),i=e.getValue(),o=e.getTextDirection(),r=e.getTextAlign(),n=e.getTooltip_AsString(),s=e.getWrapping();t.openStart("span",e);t.class("sapMText");t.class("sapUiSelectable");if(s){if(i&&i.length>0&&!/\s/.test(i)){t.class("sapMTextBreakWord")}}else{t.class("sapMTextNoWrap")}if(a&&i!==""){t.style("width",a)}else{t.class("sapMTextMaxWidth")}if(o!==tt.Inherit){t.attr("dir",o.toLowerCase())}if(n){t.attr("title",n)}if(r){r=_.getTextAlign(r,o);if(r){t.style("text-align",r)}}var l=s?"sapMTextRenderWhitespaceWrap":"sapMTextRenderWhitespace";t.class(l);t.openEnd();i.replace(/\r\n|\n\r|\r/g,"\n");t.text(i);t.close("span")}},updateDomValue:function(t){if(!this.isActive()){return this}t=this._getInputValue(t);if(this.$().text()!==t){this.$().text(t);this._bCheckDomValue=true}return this},getValue:function(){return this.getProperty("value")},getFocusDomRef:function(){return this.getDomRef()},getEditable:function(){return false}});return new e(this._oParent.getId()+"-comboBoxDisp",t)};rt.prototype._createSelect=function(t){var e={width:true,name:true,valueState:true},a;var i=rt.getBoundPropertiesMapInfoForControl(y.getMetadata().getName(),{propertyName:"value"})[0];var o={change:this._oHelper.getDropdownChangeHandler(this._oParent),forceSelection:false};o=Object.assign(o,this.createAttributes(i,this._oMetaData.property,e));if(o.width===""){o.width="100%"}a=new y(this._oParent.getId()+"-select",o);this._enhanceInputControls(a);return{control:a,onCreate:"_onCreate",params:{valuehelp:{annotation:t.valueHelp.annotation,aggregation:"items",noDialog:t.valueHelp.noDialog,noTypeAhead:t.valueHelp.noTypeAhead},getValue:"getSelectedKey",type:{type:o.selectedKey.type,property:this._oMetaData.property}}}};rt.prototype._createCheckBox=function(){var t=rt.getBoundPropertiesMapInfoForControl(l.getMetadata().getName(),{propertyName:"value"})[0];var e=this.createAttributes(t,null,{},{event:"select",parameter:"selected"});e.editable=this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable();e.selected.type=this._oTypes.getAbapBoolean();return{control:new l(this._oParent.getId()+"-cBox",e),onCreate:"_onCreate",params:{getValue:"getSelected"}}};rt.prototype._createEdmDateTime=function(){var t=this.getFormatSettings("dateFormatSettings"),e,a,i;var o={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var r=this.createAttributes(null,this._oMetaData.property,o,{event:"change",parameter:"value"});if(this._oSelector.checkDatePicker()){e=rt.getBoundPropertiesMapInfoForControl(h.getMetadata().getName(),{propertyName:"value"})[0];r[e]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,t,{displayFormat:"Date"}),model:this._oMetaData.model,mode:this._oParent.getBindingMode("value")};if(t&&t.style){r.displayFormat=t.style}i=new h(this._oParent.getId()+"-datePicker",r);this._enhanceInputControls(i);return{control:i,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:r.value.type,property:this._oMetaData.property}}}}e=rt.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];r[e]={path:this._oMetaData.path,model:this._oMetaData.model,type:this._oTypes.getType(this._oMetaData.property,t),mode:this._oParent.getBindingMode("value")};a=new d(this._oParent.getId()+"-input",r);this._enhanceInputControls(a);return{control:a,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:r.value.type,property:this._oMetaData.property}}}};rt.prototype._createEdmDateTimeOffset=function(){var t,e=this.getFormatSettings("dateFormatSettings"),a=this.getEdmProperty(),i;try{t=j(e)}catch(a){t=e}if(t){t.UTC=false}var o=rt.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var r={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var n=this.createAttributes(null,this._oMetaData.property,r,{event:"change",parameter:"value"});var s=a&&B.getTimezonePropertyPath(a)||false;if(s){if(e&&e.showTimezone===false){n.showTimezone=false}else{n.showTimezone=true}if(t&&t.style){n.displayFormat=t.style}if(t&&t.pattern){n.displayFormat=t.pattern}this.oType=this._oTypes.getType(this._oMetaData.property,t);n[o]={model:this._oMetaData.model,type:this.oType,parts:[{path:this._oMetaData.path,parameters:{useUndefinedForUnresolved:true},type:this.oType},{path:s,parameters:{useUndefinedForUnresolved:true}}],useRawValues:true,mode:this._oParent.getBindingMode("value")}}else{n[o]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,t),mode:this._oParent.getBindingMode("value")}}i=new d(this._oParent.getId()+"-input",n);this._enhanceInputControls(i);return{control:i,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:n.value.type,property:this._oMetaData.property}}}};rt.prototype._createEdmNumeric=function(e){var a=this._oSelector.checkComboBox(e),i=e?e.mode:undefined,o;if(a.combobox){return this._createComboBox({valueHelp:{annotation:a.annotation,noDialog:true,noTypeAhead:true},edit:true})}var r={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var n=rt.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];var s=this.createAttributes(n,this._oMetaData.property,r,{event:"change",parameter:"value"});if(this._oParent.isContextTable()&&t.getRTL()){s.textDirection="LTR"}o=this._createInput(s);if(i==="edit"&&this._oParent.isFormContextType()){o.setTextAlign($.End)}return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:s.value.type,property:this._oMetaData.property}}}};rt.prototype._handleUoMAriaDescribedBy=function(t,e,a){var i=e?.getId(),o=t.getAriaDescribedBy();if(a==="add"){if(!o.includes(i)){t.addAriaDescribedBy(i)}}else if(a==="remove"){if(o.includes(i+"-text")){t.removeAriaDescribedBy(i+"-text")}}};rt.prototype._createEdmUOM=function(e){var a=e.mode,i=this._oParent.getEntitySet(),o=rt.getBoundPropertiesMapInfoForControl(ot.getMetadata().getName(),{propertyName:"value"})[0],r=this._getPropertyBindingMode(o),n=this.getEdmProperty(),s=this._oMetaData.annotations.uom.property.property,l=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(n,s);var p={currency:l,edmProperty:s,bindingMode:r};var u=this._createEdmUOMAttributes(p),h=t.getRTL(),d=h&&this._oParent.isContextTable(),g=this._oParent.getId(),y;if(d){u.textDirection="LTR"}var m=this._createInput(u);this.oMeasureField=m;if(a==="edit"&&this._oParent.isFormContextType()){m.setTextAlign($.End)}if(this._oParent.data("suppressUnit")==="true"){var f={getValue:"getValue"};if(!l){f.type={type:u.value.type,property:this._oMetaData.property}}return{control:m,onCreate:"_onCreate",params:f}}if(!l){y={type:u.value.type,property:this._oMetaData.property}}var _={textAlign:this._getEdmUOMTextAlignment()};if(r==="TwoWay"){_.change=this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:l,unit:true})}var M=this._oHelper.getUOMPath(this._oMetaData);_[o]={model:this._oMetaData.model,path:M,mode:r};this.mapBindings(_,rt._getEmbeddedSmartFieldMapSettings(),e);if(this._oParent.getConfiguration()){_.configuration=new O({preventInitialDataFetchInValueHelpDialog:this._getPreventInitialDataFetchInVHDialog()})}if(i){_.entitySet=i}var D=new ot(g+"-sfEdit",_),v=this;D.data("configdata",{configdata:{currency:l,smartFieldRootControl:this._oParent,measureField:this.oMeasureField,isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:M,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,valuelistType:this._oMetaData.annotations.uom.annotations.valuelistType,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(t){v._updateStaticAmountInputFlexItemData(m);v._updateStaticUOMTextFlexItemData(D);v._updateInnerControl(t,{RTLInTable:d});v._handleUoMAriaDescribedBy(m,t,"add")},onInput:function(t){var e=D&&!D.getVisible();v._updateDynamicAmountInputFlexItemData(m,{isfullWidth:e});v._updateStaticUOMInputFlexItemData(D);v._updateInnerControl(t,{RTLInTable:d});v._handleUoMAriaDescribedBy(m,D,"remove")}}});D.attachVisibleChanged(function(t){var e=this.data("configdata")?.configdata?.measureField;if(!t.getParameter("visible")){v._handleUoMAriaDescribedBy(e,this,"remove")}});D.data("errorCheck","setComplexClientErrorSecondOperandNested");if(D.getVisible()){m.addStyleClass("smartFieldPaddingRight")}m.addStyleClass("sapUiCompSmartFieldValue");var C=new c({justifyContent:X.End,items:[m,D],fitContainer:true,width:this._oParent.getWidth()});C.addStyleClass("sapUiCompUOM");C.enhanceAccessibilityState=function(t,e){this._oParent.enhanceAccessibilityState(t,e)}.bind(this);if(this._oParent.isContextTable()){if(d){C.addStyleClass("sapUiCompDirectionLTR")}C.addStyleClass("sapUiCompUOMInTable");if(a!=="edit"){C.addStyleClass("sapUiCompUOMInTableDisplay")}}return{control:C,onCreate:"_onCreateUOM",params:{getValue:true,valuehelp:true,type:y}}};rt.prototype._createEdmUOMAttributes=function(t){t=t||{};var e=this.createUOMDefaultAttributes(t);var a=rt.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];var i=t.bindingMode||"TwoWay";var o=t.currency||this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property);e[a]={mode:r.OneWay,model:this._oMetaData.model,parts:[{mode:i,path:this._oMetaData.path},{mode:i,path:this._oHelper.getUOMPath(this._oMetaData)},{mode:"OneTime",path:o?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],type:o?this._oTypes.getCurrencyType(this._oMetaData.property):this._oTypes.getUoMType(this._oMetaData.property)};return e};rt.prototype.createUOMDefaultAttributes=function(t){return{textAlign:this._getEdmUOMTextAlignment(),placeholder:this.getAttribute("placeholder"),name:this.getAttribute("name"),valueState:this.getValueStateBindingInfoForRecommendationStateAnnotation(),change:this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:t.currency})}};rt.prototype._getEdmUOMTextAlignment=function(){var t=this.getAttribute("textAlign");if(!t){t=$.Initial}if(t===$.Initial){if(this._oParent.isContextTable()){return $.End}return $.Begin}return t};rt.prototype._createEdmUOMDisplay=function(e){var a=this,i=this._oParent.getEntitySet(),o=this._oHelper.getUOMPath(this._oMetaData),r=this._getEdmUOMTextAlignment(),n=null,s=this.getEdmProperty(),l=t.getRTL(),p=l&&this._oParent.isContextTable(),u=this._oHelper.oAnnotation.isCurrency(s),h=rt.getBoundPropertiesMapInfoForControl(ot.getMetadata().getName(),{propertyName:"value"})[0],d=this._getPropertyBindingMode(h)||"TwoWay";var g=rt.getBoundPropertiesMapInfoForControl(m.getMetadata().getName(),{propertyName:"value"})[0];var y={textAlign:r};y[g]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:o},{mode:"OneTime",path:u?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],model:this._oMetaData.model,formatter:this._oTypes.getDisplayFormatter(s,{currency:u,mask:this._oHelper.oAnnotation.isMasked(s),type:this._oTypes.getType(this._oMetaData.property)}),useRawValues:true};if(p){y.textDirection="LTR"}var f=new m(this._oParent.getId()+"-text",y);o=this._oHelper.getUOMPath(this._oMetaData);y={textAlign:this._getEdmUOMTextAlignment()};if(d==="TwoWay"){y.change=this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:u,unit:true})}g=rt.getBoundPropertiesMapInfoForControl(ot.getMetadata().getName(),{propertyName:"value"})[0];y[g]={model:this._oMetaData.model,path:o,mode:this._getPropertyBindingMode(g)};this.mapBindings(y,rt._getEmbeddedSmartFieldMapSettings(),e);f.addStyleClass("sapUiCompSmartFieldValue");f.addStyleClass("smartFieldUoMAmountDisplayText");f.addStyleClass("smartFieldPaddingRight");if(this._checkSuppressUnit()){return{control:f}}if(i){y.entitySet=i}n=new ot(this._oParent.getId()+"-sfDisp",y);n.data("configdata",{configdata:{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:o,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(t){if(t&&t.setWrapping){t.setWrapping(false)}a._updateInnerControl(t,{RTLInTable:p})},onInput:function(t){a._updateInnerControl(t,{RTLInTable:p})},getContextEditable:function(){return a._oParent.getContextEditable()}}});n.data("errorCheck","setComplexClientErrorSecondOperandNested");var _=new c({alignItems:et.Center,items:[f,n],fitContainer:true,width:this._oParent.getWidth()});_.enhanceAccessibilityState=function(t,e){this._oParent.enhanceAccessibilityState(t,e)}.bind(this);if(this._oParent.isContextTable()){_.setJustifyContent("End");this._oParent.addStyleClass("sapUiCompUOMInTable");if(p){_.addStyleClass("sapUiCompDirectionLTR")}_.addStyleClass("sapUiCompUOMInTable")}return{control:_}};rt.prototype._createEdmUOMObjectStatus=function(){var t,e=this.getEdmProperty(),a=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(e),i=this._oTypes.getDisplayFormatter(e,{currency:a}),o=this._oHelper.getUOMPath(this._oMetaData),r={};var n=rt.getBoundPropertiesMapInfoForControl(V.getMetadata().getName(),{propertyName:"value"})[0];r[n]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:o},{mode:"OneTime",path:a?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:function(){var t=i.apply(this,arguments);return t+arguments[1]},useRawValues:true};r.emptyIndicatorMode=J.Auto;this._addProposedObjectStatusAttributes(r);t=new V(this._oParent.getId()+"-objStatus",r);t.addStyleClass("sapUiCompUOM");return{control:t}};rt.prototype._createEdmUOMObjectNumber=function(){var t,e,a=this._getEdmUOMTextAlignment();var i=rt.getBoundPropertiesMapInfoForControl(S.getMetadata().getName(),{propertyName:"value"});if(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property)){t={model:this._oMetaData.model,textAlign:a};t[i[0]]={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)},{mode:"OneTime",path:"/##@@requestCurrencyCodes",targetType:"any"}],type:this._oTypes.getCurrencyType(this._oMetaData.property)};t[i[1]]={path:this._oHelper.getUOMPath(this._oMetaData)}}else{t={model:this._oMetaData.model,textAlign:a};t[i[0]]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};t[i[1]]={path:this._oHelper.getUOMPath(this._oMetaData)}}e=new S(this._oParent.getId()+"-objNumber",t);e.addStyleClass("sapUiCompUOM");return{control:e}};rt.prototype._createEdmSemantic=function(){var t=this,e=this._oParent.getBindingPath("value"),a=this.getEdmProperty(),i=this._getLocalTextAnnotation(),o=i&&i.path||null;var r={semanticObject:this._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:this._oMetaData.annotations.semantic.additionalSemanticObjects,fieldName:e,width:this.getAttribute("width"),emptyIndicatorMode:J.Auto,createControlCallback:function(){var t=this.createControl(true);if(t){return t.control}return null}.bind(this)};this.oType=this._oTypes.getType(this._oMetaData.property);if(o){r.text={parts:[this._oMetaData.path,this._oHelper.getEdmDisplayPath(this._oMetaData)],model:this._oMetaData.model,formatter:function(e,a){if(t.oType){e=t.oType.formatValue(e,"string")}if(t.oType&&t.oType.isA("sap.ui.comp.odata.type.NumericText")&&e===null&&a){e=""}if(e&&a){return t._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",e,a)}return e?e:""}};r.navigationTargetsObtained=function(e){var a=this.getBinding("text");if(!Array.isArray(a.getValue())){e.getParameters().show();return}var i=a.getValue();var o=t._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour")||"idOnly";var r=E.getTextsFromDisplayBehaviour(o,i[0],i[1]);var n=e.getParameters().mainNavigation;if(n){n.setDescription(r.secondText)}e.getParameters().show(r.firstText,n,undefined,undefined)}}else{var n=this._oHelper.getUOMPath(this._oMetaData);if(n){r.text={parts:[{path:e},{path:n}],model:this._oMetaData.model,formatter:this._oHelper.oAnnotation.isCurrency(a,this._oMetaData.annotations.uom.property.property)?E.getAmountCurrencyFormatter():E.getMeasureUnitFormatter(),useRawValues:true};r.uom={path:n}}else{r.text={path:e,model:this._oMetaData.model,type:this.oType}}}return{control:new M(this._oParent.getId()+"-sl",r),onCreate:"_onCreate",params:{getValue:"getInnerControlValue"}}};rt.prototype._createMultiLineText=function(t){var e=rt.getBoundPropertiesMapInfoForControl(n.getMetadata().getName(),{propertyName:"value"})[0];var a=this.createAttributes(e,this._oMetaData.property,t.attributesNamesMap);var i=this.getFormatSettings("multiLineSettings");a=k(a,i);if(this._oParent.isContextTable()){a.width="100%"}var o=new n(this._oParent.getId()+"-textArea",a);this._enhanceInputControls(o);this._handleEventingForEdmString({control:o,edmProperty:this._oMetaData.property.property});return{control:o,onCreate:"_onCreate",params:{type:{type:a.value.type,property:this._oMetaData.property},getValue:"getValue"}}};rt.prototype._createLink=function(t){var e=this,a=this._oParent,i=a.getBindingInfo("url");var o={text:"",href:""};var r=rt.getBoundPropertiesMapInfoForControl(s.getMetadata().getName(),{propertyName:"url"})[0];if(i){o[r]=this._oBinding.toBinding(i)}else{o[r]=a.getUrl()}if(a.hasListeners("linkPress")){o.press=function(t){t.preventDefault();a.fireLinkPress(t)}}if(a.hasListeners("press")){o.press=function(t){t.preventDefault();a.firePress(t)}}var n=a.getBindingInfo("value");var l=rt.getBoundPropertiesMapInfoForControl(s.getMetadata().getName(),{propertyName:"value"});if(n){var p=this._oMetaData,u=p.path,h=p.property.property;if(p.annotations.text&&h.type==="Edm.String"){o[l[0]]={parts:[p.path,this._oHelper.getEdmDisplayPath(p)],formatter:this._formatText.bind(e)}}else if(rt.isSpecialLink(h)){var d=rt[rt._getLinkFormatterFunctionName(h)];o[l[0]]={path:u};o[l[1]]={path:u,formatter:null};if(typeof d==="function"){o[l[1]].formatter=d}}else if(t){o[l[0]]={path:u,type:this._getDateFormatType()}}else{o[l[0]]=this._oBinding.toBinding(n)}}else{o[l[0]]=a.getValue()}return{control:new s(a.getId()+"-link",o),onCreate:"_onCreate",params:{noValidation:true}}};rt.prototype._createEdmBoolean=function(t){var e=this._oSelector.checkComboBox(t),a=t.mode==="edit",i=this,o=null,r;if(e.combobox){if(a||this._oParent.getFetchValueListReadOnly()){return this._createComboBox({valueHelp:{annotation:e.annotation,noDialog:true,noTypeAhead:true},edit:a})}}var n,s;if(a){s=rt.getBoundPropertiesMapInfoForControl(l.getMetadata().getName(),{propertyName:"value"})[0];n=this.createAttributes(s,this._oMetaData.property,{},{event:"select",parameter:"selected"});r=new l(this._oParent.getId()+"-cBoxBool",n);o={getValue:"getSelected"}}else{s=rt.getBoundPropertiesMapInfoForControl(m.getMetadata().getName(),{propertyName:"value"})[0];n=this.createAttributes(s,this._oMetaData.property,{width:true,textAlign:true});n[s]={model:this._oMetaData.model,path:this._oMetaData.path,formatter:function(t){return i._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",t)}};n.renderWhitespace=true;r=new m(this._oParent.getId()+"-text",n)}return{control:r,onCreate:"_onCreate",params:o}};rt.prototype._createValueHelp=function(){var t=this._oParent.getContent();if(!t){return}var e={annotation:this._oMetaData.annotations.valuelist,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"};this._getValueHelpDialogTitle(e);e.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:t,edmProperty:this.getEdmProperty(),valueHelp:e,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(t){this._oParent.fireValueListChanged({changes:t.mParameters.changes})}.bind(this)})};rt.prototype.getValueListProviderConfiguration=function(t){var e=D.prototype.getValueListProviderConfiguration.apply(this,arguments);if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){e.displayFormat="UpperCase"}return e};rt.prototype._checkSuppressUnit=function(){if(this._oParent.data("suppressUnit")==="true"){return true}var t=this._oParent.getBindingInfo("uomVisible");return!t&&!this._oParent.getUomVisible()};rt.prototype.getEdmProperty=function(){var t=this._oHelper;if(t){return t.getEdmProperty(this._oMetaData)}return null};rt.prototype.getEntityType=function(){if(this._oMetaData){return this._oMetaData.entityType}return null};rt.prototype._checkLink=function(){var t=this._oParent.getBindingInfo("url"),e=this.getEdmProperty();if(t||this._oParent.getUrl()||rt.isSpecialLink(e)){return true}return this._oParent.hasListeners("press")||this._oParent.hasListeners("linkPress")};rt._getEmbeddedSmartFieldMapSettings=function(){return{uomEditable:"editable",uomEnabled:"enabled",uomVisible:"visible",mandatory:"mandatory",contextEditable:"contextEditable"}};rt.getBoundPropertiesMapInfoForControl=function(t,e){e=e||{};var a=null;switch(t){case"sap.m.Input":case"sap.m.TimePicker":case"sap.m.DatePicker":case"sap.m.DateTimePicker":case"sap.m.TextArea":a={value:["value"]};break;case"sap.m.Text":case"sap.m.ObjectIdentifier":case"sap.ui.comp.navpopover.SmartLink":a={value:["text"]};break;case"sap.m.Link":a={url:["href"],value:["text","href"]};break;case"sap.m.ObjectStatus":a={value:["text","state","icon"]};break;case"sap.m.ObjectNumber":a={value:["number","unit"]};break;case"sap.m.Select":case"sap.m.ComboBox":case"sap.ui.comp.smartfield.DisplayComboBox":a={value:["selectedKey"]};break;case"sap.ui.comp.smartfield.ComboBox":a={value:["enteredValue"],realValue:["realValue"]};break;case"sap.m.CheckBox":a={value:["selected"]};break;case"sap.ui.comp.smartfield.SmartField":var i=Object.keys(ot.getMetadata().getProperties());a={};i.forEach(function(t,e,i){a[t]=[i[e]]});break}if(a&&e.propertyName){return a[e.propertyName]||null}return a};rt.isSpecialLink=function(t){return B.isEmailAddress(t)||B.isPhoneNumber(t)||B.isURL(t)};rt._getLinkFormatterFunctionName=function(t){return"_format"+B.getLinkDisplayFormat(t)};rt._formatEmailAddress=function(t){return"mailto:"+t};rt._formatPhoneNumber=function(t){return"tel:"+t};rt._formatURL=function(t){return H.validate(t)?t:""};rt.prototype._formatText=function(t,e){if(t&&e){var a=this._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",t,e);return W(a)}return t||""};rt.prototype._getCreator=function(t){return this._oSelector.getCreator(t)};rt.prototype._onCreate=function(t,e){var a,i,o,r=true,n=this;if(e){if(e.noValidation){r=false}if(e.valuehelp){this._getValueHelpDialogTitle(e.valuehelp);e.valuehelp.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:t,edmProperty:this.getEdmProperty(),valueHelp:e.valuehelp,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(t){n._oParent.fireValueListChanged({changes:t.mParameters.changes})}})}if(e.getValue){i=e.getValue;e.getValue=function(){return t[i]()}}if(e.type){a=e.type.emptyStringSignificant||false;o=this._oFieldControl.getMandatoryCheck(e.type.property,a);if(o){e.type.type.oFieldControl=o}}}if(r){this.addValidations(t,this._oParent.data("errorCheck")||"setSimpleClientError")}if(!this._checkUOM()){t.addStyleClass("sapUiCompSmartFieldValue")}};rt.prototype._checkUOM=function(){var t=this._oParent.data("configdata");if(t&&t.configdata){if(t.configdata.onInput||t.configdata.onText){return true}}return false};rt.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(t,e,a){t=t||this.getEdmProperty();var i=t&&t["com.sap.vocabularies.UI.v1.RecommendationState"];if(!i){return null}U(!(i.Path===undefined),'Missing "Path" attribute of the "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+t.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());U(!(i.Path===""),'Missing path name of "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+t.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());e=e||this._oHelper.findProperty(this._oMetaData.entityType.property,i.Path);U(!!e,'The EDM property was not found in the "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(e&&e.type==="Edm.Byte"){return{model:a||this._oMetaData.model,path:i.Path,formatter:rt.formatRecommendationState}}U(e&&e.type==="Edm.Byte",'The EDM property "'+e.name+'" of "'+this._oMetaData.entityType.name+'" entity type must be typed as Edm.Byte. - '+this.getMetadata().getName());return null};rt.formatRecommendationState=function(t){t=String(t);switch(t){case"0":return K.None;case"1":return K.Information;case"2":return K.Warning;default:return K.None}};rt.prototype._updateDynamicAmountInputFlexItemData=function(t,e){var a=t.getLayoutData()||new z,i="sapUiCompSmartFieldFlexItemAmountEdit",o="";if(a){if(e.isfullWidth){i="sapUiCompSmartFieldFlexItemAmountNoUnitEdit";o="100%"}a.setGrowFactor(1);a.setMaxWidth(o);a.setStyleClass(i);a.setMinWidth("0")}t.setLayoutData(a)};rt.prototype._updateStaticAmountInputFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setGrowFactor(1);e.setMaxWidth("");e.setStyleClass("")}t.setLayoutData(e)};rt.prototype._updateStaticUOMInputFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setShrinkFactor(1);e.setGrowFactor(0);e.setStyleClass("sapUiCompSmartFieldFlexItemUnitEdit");e.setMinWidth("")}t.setLayoutData(e)};rt.prototype._updateStaticUOMTextFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setShrinkFactor(0);e.setGrowFactor(0);e.setStyleClass("sapUiCompSmartFieldUOMDisplayText");e.setMinWidth("auto")}t.setLayoutData(e)};rt.prototype._updateInnerControl=function(t,e){var a=e.RTLInTable,i,o;if(t){i=typeof t.getParent==="function"?t.getParent():{};o=i&&i.getInnerControls?i.getInnerControls():[];if(a&&typeof t.setTextDirection==="function"){t.setTextDirection("LTR")}t.addStyleClass("sapUiCompSmartFieldUnit");if(o.length>0&&o[0].getEditable&&o[0].getEditable()===true){t.addStyleClass("sapUiCompSmartFieldFlexItemUnitEdit")}}};rt.prototype._getValueHelpDialogTitle=function(t){var e=this.getEdmProperty();t.dialogtitle=this._oParent?.getValueHelpTitleSource()===it.ValueList?this._oHelper.oAnnotation.getValueListLabel(e):this._oParent.getComputedTextLabel();if(!t.dialogtitle){t.dialogtitle=this._oHelper.oAnnotation.getLabel(e)||e.name}};rt.prototype._onCreateUOM=function(t,e){var a=t.getItems(),i;this.addValidations(a[0],"setComplexClientErrorFirstOperand");if(e&&e.getValue){e.getValue=function(){return a[0].getValue()}}e.uom=function(){return a[1].getValue()};e.uomset=function(t){a[1].setValue(t)};if(e.type){i=this._oFieldControl.getMandatoryCheck(e.type.property);if(i){e.type.type.oFieldControl=i}}};rt.prototype.triggerCreationOfControls=function(){try{this._setUOMEditState();this._oFieldControl.bindProperties({metadata:this._oMetaData});this._addLabelAndQuickInfo();if(this._oParent.isContextTable()&&this._oMetaData._isNumber==undefined){this._oMetaData._isNumber=B.isNumber(this._oMetaData.property.property)}}catch(t){w.error(t,null,this.getMetadata().getName())}};rt.prototype._checkTextInDisplayModeValueList=function(t){var e=this._oHelper.getValueListAnnotationPath(this._oMetaData),a=this.getEdmProperty(),i,o;if(!a){return false}o=L.isFiscalValue(a);i=q.isCalendarValue(a);return!!(!o&&!i&&this._oMetaData.annotations&&this._oMetaData.annotations.valuelist!==undefined&&this._getDisplayBehaviourConfiguration()&&(this._oMetaData.property&&(this._oMetaData.property.property.type==="Edm.String"||this._oMetaData.property.property.type==="Edm.Guid"))&&t.mode==="display"&&this._oParent.getFetchValueListReadOnly()&&e&&!(this._oParent.getExpandNavigationProperties&&this._oParent.getExpandNavigationProperties()&&this._oParent.isPropertyInitial("expandNavigationProperties"))&&!this._oHelper.startWithNavigationProperty(e,this._oMetaData)&&!this.isValueInitialWithTextArrangement(a)&&this._getDisplayBehaviourConfiguration()!=="idOnly")};rt.prototype.isValueInitialWithTextArrangement=function(t){var e=this._getLocalTextAnnotation();return this._oParent._isValueInitial()&&e};rt.prototype._hasBoundFieldControl=function(){var t=this._oFieldControl.getPropertyNames();for(var e=0;e<t.length;e++){if(this._oParent.getBinding(t[e])){return true}}return false};rt.prototype.bind=function(t){var e=t.mode,t=t||{};this._bTextInDisplayModeValueList=this._checkTextInDisplayModeValueList(t);if(!(!this._bInitialized&&!this.bPending)&&(!t.rebind&&!this._bTextInDisplayModeValueList)){return Promise.resolve({skipInit:this._bInitializeFromConfig})}this._bInitialized=true;var a=this._oParent.data("configdata");if(a&&a.configdata){try{this._init(this._oMeta);if(this._oMetaData&&this._oMetaData.annotations&&typeof a.configdataVL==="function"){this._bInitializeFromConfig=true;return a.configdataVL().then(function(t){this._initValueList(t);return Promise.resolve({fetchIDAndDescription:true})}.bind(this)).catch(function(t){return Promise.resolve()})}}catch(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}return Promise.resolve()}if(!this._oModel){return Promise.reject()}var i=!!(this._oParent&&this._oParent.isTextInEditModeSourceNotNone());if(!i&&this._oModel.bMetaModelLoaded&&(e!=="display"||!this._oParent.getFetchValueListReadOnly())){try{this._init(this._oMeta)}catch(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}return Promise.resolve()}this.bPending=true;return this._metadataInitialise().then(function a(){if(!this._oParent){this.bPending=false;return Promise.reject()}this._init(this._oMeta);this._bTextInDisplayModeValueList=this._checkTextInDisplayModeValueList(t);if(e!=="display"&&i||this._bTextInDisplayModeValueList){var o=this._oMetaData.annotations.valuelist;if(typeof o==="string"){var r=this._oParent&&this._oParent.getBindingContext()&&this._oParent.getBindingContext().getPath();if(this._oMetaData.functionImportProperty){return this._oHelper.getAnalyzer()._getFunctionImportValueListAnnotationLazy(this._oMetaData.functionImport,this._oMetaData.functionImportProperty,o,r)}else{return this._oHelper.loadValueListAnnotation(o,r)}}else{this.bPending=false;return Promise.reject()}}this.bPending=false}.bind(this)).then(function t(e){var a={fetchIDAndDescription:false};if(!i&&!this._bTextInDisplayModeValueList||!this._oParent){return}this.bPending=false;if(e){this._initValueList(e)}if(e&&this.oTextArrangementDelegate){a.fetchIDAndDescription=true}return a}.bind(this)).catch(function(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded");this._oParent._rejectLifecyclePromises("Metadata loading problem.")}}.bind(this))};rt.prototype._metadataInitialise=function(){return Promise.resolve().then(function(){if(this._oParent._bMetaModelLoadAttached){return this._oModel.getMetaModel().loaded()}else{return T.handleModelInit(this._oParent,function(){},true)}}.bind(this)).catch(function(t){w.error("The meta model could not be loaded.",t,this.getMetadata().getName())}.bind(this))};rt.prototype._addLabelAndQuickInfo=function(){var t=this.getDataProperty();t=t.property;var e=this._oHelper.oAnnotation.getLabel(t);var a=this._oHelper.oAnnotation.getQuickInfo(t);if(e){this._oParent._sAnnotationLabel=e}if(a&&this._oParent.isPropertyInitial("tooltipLabel")){this._oParent.setTooltipLabel(a)}};rt.prototype.rebindOnCreated=function(){var t,e=this._oFieldControl.getControlFormatters(this._oMetaData,["editable"]);for(var a in e){t=this._oBinding.fromFormatter(this._oMetaData.model,e[a]);this._oParent.bindProperty(a,t)}};rt.prototype._setUOMEditState=function(){if(this._oFieldControl.hasUomEditState(this._oMetaData)){var t=this._oFieldControl.getUOMEditState(this._oMetaData);if(t){var e=this._oBinding.fromFormatter(this._oMetaData.model,t);this._oParent.bindProperty("uomEditState",e)}}};rt.prototype.getDataProperty=function(){return this._oMetaData.property};rt.prototype.getDropdownItemKeyType=function(t){var e=t.getMetadata().getName(),a=this._isMComboBoxRequired(),i=this._oParent._getComputedTextInEditModeSource(),o=i==="ValueList"?"realValue":"value",r=a?"value":o;if(e==="sap.ui.comp.smartfield.DisplayComboBox"||e==="sap.m.ComboBox"||e==="sap.ui.comp.smartfield.ComboBox"||e==="sap.m.Select"){var n=rt.getBoundPropertiesMapInfoForControl(e,{propertyName:r})[0];const{type:a}=t.getBindingInfo(n);if(a){if(a.oFormatOptions){a.oFormatOptions.bFixedKey=true}return this._oTypes.cloneType(a)}return null}return null};rt.prototype.getMetaData=function(){return this._oMetaData};rt.prototype.getODataHelper=function(){return this._oHelper};rt.prototype._getChangeEventParams=function(t){var e,a={},i=t&&t.getParameters();if(i){e=i.value;a.value=e;a.newValue=e;if(i.validated){a.validated=i.validated}}else{a=t}return a};rt.prototype._getPropertyBindingMode=function(t){var e=typeof this._oParent.getBinding==="function"&&this._oParent.getBinding(t);return e&&typeof e.getBindingMode==="function"&&e.getBindingMode()||"TwoWay"};rt.prototype._getLocalTextAnnotation=function(){var t=this.getMetaData(),e=t&&t.annotations&&t.annotations.text||null;return e};rt.prototype.fetchIDAndDescriptionCollectionIfRequired=function(t){var e=t.mode==="edit"&&this._isFixedList();if(this.oValueListDelegate&&e){this.oValueListDelegate.fetchIDAndDescriptionCollectionIfRequired()}else if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.fetchIDAndDescriptionCollectionIfRequired(t)}};rt.prototype._isFixedList=function(){var t=this.getMetaData();return t&&t.annotations&&t.annotations.valuelistType==="fixed-values"};rt.prototype._isMComboBoxRequired=function(){return this._oSelector&&this._oSelector._oParent&&this._oSelector._oParent.oParent&&this._oSelector._oParent.oParent.isA("sap.ui.comp.smartmultiedit.Field")||this._oParent&&this._oParent.getFixedValueListValidationEnabled&&this._oParent.getFixedValueListValidationEnabled()};rt.prototype.destroy=function(){if(this._oFieldControl){this._oFieldControl.destroy()}if(this._oSelector){this._oSelector.destroy()}if(this._oTypes){this._oTypes.destroy()}if(this._oHelper){this._oHelper.destroy()}if(this.oType){this.oType.destroy();this.oType=null}if(this.oValueListDelegate){this.oValueListDelegate.destroy()}if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.destroy()}this._oHelper=null;this._oFieldControl=null;this._oTypes=null;this._oSelector=null;this._oMetaData=null;this.oMeasureField=null;this.oTextArrangementDelegate=null;D.prototype.destroy.apply(this,arguments)};return rt},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataControlSelector", [],function(){"use strict";var t=function(t,e,a){this._oMetaData=t;this._oParent=e;this._oTypes=a};t.prototype.checkComboBox=function(t){var e={},a;if(typeof t!=="undefined"){a=t.mode}if(a==="display"){e.combobox=false;return e}return this._checkComboBox()};t.prototype._checkComboBox=function(){var t={};if(this._oMetaData.annotations.valuelist){t.valuelistType=this._oMetaData.annotations.valuelistType;t.annotation=this._oMetaData.annotations.valuelist}if(!t.annotation){return t}if(t.valuelistType==="fixed-values"){t.combobox=true}if(!t.combobox){t.annotation=this._oMetaData.annotations.valuelist;t.combobox=this._checkConfig("dropDownList")}return t};t.prototype.checkSelection=function(){var t={};if(this._oMetaData.annotations.valuelist){t.annotation=this._oMetaData.annotations.valuelist;t.selection=this._checkConfig("selection")}return t};t.prototype.checkCheckBox=function(){var t,e;if(this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.String"){t=this._oParent.getBindingInfo("value");e=this._oTypes.getMaxLength(this._oMetaData.property,t);if(e===1){if(this._checkConfig("checkBox")){return true}}}return false};t.prototype.checkDatePicker=function(){if(this._oMetaData.property&&this._oMetaData.property.property&&(this._oMetaData.property.property["sap:display-format"]==="Date"||this._oTypes.isCalendarDate(this._oMetaData.property))){return true}return this._checkConfig("datePicker")};t.prototype._checkConfig=function(t){var e=this._oParent.getConfiguration();if(e){return e.getControlType()===t}return false};t.prototype.getCreator=function(t){var e,a;if(typeof t!=="undefined"){if(typeof t==="boolean"){e=t}else{e=t.blockSmartLinkCreation;a=t.mode}}var o={"Edm.Decimal":"_createEdmNumeric","Edm.Double":"_createEdmNumeric","Edm.Float":"_createEdmNumeric","Edm.Single":"_createEdmNumeric","Edm.Int16":"_createEdmNumeric","Edm.Int32":"_createEdmNumeric","Edm.Int64":"_createEdmNumeric","Edm.Byte":"_createEdmNumeric","Edm.DateTimeOffset":"_createEdmDateTimeOffset","Edm.DateTime":"_createEdmDateTime","Edm.Boolean":"_createEdmBoolean","Edm.String":"_createEdmString","Edm.Time":"_createEdmTime"};if(this._isUOMDisplayObjectStatus()){return"_createEdmUOMObjectStatus"}if(this._isUOMDisplay()){return"_createEdmUOMObjectNumber"}if(a==="display"){if(this._oMetaData.annotations){if(this.useObjectIdentifier(this.checkDatePicker())&&this._oMetaData.annotations.text&&this._oMetaData.annotations.semanticKeys&&this._oMetaData.annotations.semanticKeys.semanticKeyFields&&this._oMetaData.annotations.semanticKeys.semanticKeyFields.indexOf(this._oMetaData.path)>-1){return"_createEdmDisplay"}if(this._oMetaData.annotations.semantic&&!e){return"_createEdmSemantic"}if(this._oMetaData.annotations.uom){return"_createEdmUOMDisplay"}if(this._isObjectStatusProposed()){return"_createProposedObjectStatus"}return this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.Boolean"?"_createEdmBoolean":"_createEdmDisplay"}}if(this._oMetaData.annotations&&this._oMetaData.annotations.uom){return"_createEdmUOM"}if(this._oMetaData.property&&this._oMetaData.property.property){if(this._oTypes.isCalendarDate(this._oMetaData.property)){return"_createEdmDateTime"}return o[this._oMetaData.property.property.type]||"_createEdmString"}return null};t.prototype._isUOMDisplay=function(){if(this._oMetaData.annotations.uom){if(this._isObjectNumberProposed()){if(!this._oParent.getContextEditable()||!this._oParent.getEditable()&&!this._oParent.getUomEditable()||!this._oParent.getEnabled()&&!this._oParent.getUomEnabled()){return true}if(this._oParent.getProperty("uomEditState")===0){return true}}}return false};t.prototype._isUOMDisplayObjectStatus=function(){if(this._oMetaData.annotations.uom){if(this._isObjectStatusProposed()){if(!this._oParent.getContextEditable()||!this._oParent.getEditable()&&!this._oParent.getUomEditable()||!this._oParent.getEnabled()&&!this._oParent.getUomEnabled()){return true}if(this._oParent.getProperty("uomEditState")===0){return true}}}return false};t.prototype._isObjectStatusProposed=function(){var t=this._oParent.getControlProposal&&this._oParent.getControlProposal(),e;if(t){e=t.getObjectStatus();if(e){return true}}return false};t.prototype._isObjectNumberProposed=function(){var t;if(this._oParent.data("suppressUnit")!=="true"){t=this._oParent.getControlProposal&&this._oParent.getControlProposal();if(t&&t.getControlType()==="ObjectNumber"){return true}if(this._oParent.getProposedControl&&this._oParent.getProposedControl()==="ObjectNumber"){return true}}return false};t.prototype.useObjectIdentifier=function(t,e){var a;if(this._oMetaData&&this._oMetaData.property&&this._oMetaData.property.property&&this._oMetaData.property.property.type==="Edm.String"){if(!t&&!e){a=this._oParent.getControlProposal?this._oParent.getControlProposal():null;if(a&&a.getControlType()==="ObjectIdentifier"){return true}if(this._oParent.getProposedControl&&this._oParent.getProposedControl()==="ObjectIdentifier"){return true}}}return false};t.prototype.destroy=function(){this._oParent=null;this._oMetaData=null;this._oTypes=null};return t},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataHelper", ["sap/ui/comp/library","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/AnalyticalAnalyser","sap/ui/comp/smartfield/AnnotationHelper","sap/base/Log","sap/ui/model/odata/_ODataMetaModelUtils","sap/ui/model/odata/ODataUtils","sap/base/assert"],function(t,e,i,n,a,r,o,p){"use strict";var s=t.TextArrangementType;var l=function(t,e,i,a){if(t){this.oMeta=t.getMetaModel()}if(i){this.oMeta=i}this._oModel=t;this._oUtil=e;this.oAnnotation=new n;this.bIsAnalytical=a};l.prototype.getAnalyzer=function(t){if(!this._oAnalyzer){if(this.bIsAnalytical){this._oAnalyzer=new i(this._oModel||t)}else{this._oAnalyzer=new e(this._oModel||t)}}return this._oAnalyzer};l.prototype.checkNavigationProperty=function(t,e){var i,n,a,r;if(e&&t){i=this._oUtil.getNavigationProperties(e);a=i.paths.length;while(a--){n=i.paths.shift();n=this._oUtil.correctPath(n);if(n===""||n===t.entitySet.name){continue}r=this.getNavigationProperty(t.entityType,n);if(r.entitySet){t.entitySet=r.entitySet;t.entityType=r.entityType}}}};l.prototype.getNavigationProperty=function(t,e){var i=this._getNamedProperty(e,"navigationProperty",t),n,a,r={};if(i){n=this.oMeta.getODataAssociationSetEnd(t,i.name);if(n===null){return}a=this.getAssociation(t,i.name);if(a){r.toRoleAssociationEndMultiplicity=this.getToRoleAssociationEndMultiplicity(a.end,i.toRole)}r.entitySet=this.oMeta.getODataEntitySet(n.entitySet);if(r.entitySet){r.entityType=this.oMeta.getODataEntityType(r.entitySet.entityType)}}return r};l.prototype.startWithNavigationProperty=function(t,e){var i=t.split("/"),n;if(i&&i.length>1){n=this._getNamedProperty(i.shift(),"navigationProperty",e.entityType)}if(n){return n.name}return null};l.prototype.getProperty=function(t){var e=[],i,n,a,r,o,p={entityType:t.entityType,entitySet:t.entitySet};if(t){n=t.path.split("/");i=n.length;if(p&&i>1){while(p&&p.entityType){r=n[0];p=this.getNavigationProperty(p.entityType,r);if(p&&p.entityType){t.entityType=p.entityType;t.entitySet=p.entitySet;t.toRoleAssociationEndMultiplicity=p.toRoleAssociationEndMultiplicity;e.push(n.shift());i--}}}t.navigationPath=e.join("/");if(i>1){a=this.oMeta.getODataProperty(t.entityType,n[0]);if(a){t.property=this._getComplex(a,n,i)}return}if(t.navigationPath){o=t.path.replace(t.navigationPath+"/","")}else{o=t.path}a=this.oMeta.getODataProperty(t.entityType,o);t.property={property:a,typePath:t.path,valueListAnnotation:null,valueListKeyProperty:null,valueListEntitySet:null,valueListEntityType:null}}};l.prototype._getComplex=function(t,e,i){var n=t,a,r=[];while(i--){if(n){if(i===0){a=n.name;n=this._getNamedProperty(e[0],"property",n);return{typePath:a+"/"+e[0],property:n,complex:true,parents:r}}n=this.oMeta.getODataComplexType(n.type);if(n){r.push(n)}}e.shift()}};l.prototype._getNamedProperty=function(t,e,i){var n;if(i[e]){for(var a=0;a<i[e].length;a++){if(i[e][a].name===t){n=i[e][a];break}}}return n};l.prototype.getTextProperty2=function(t){var e,i;e=this.oAnnotation.getText(t.property.property);if(e){i=this._preprocAnnotation(e,t);this.getProperty(i);this._postprocAnnotation(i,t)}return i};l.prototype.getUnitOfMeasure2=function(t){var e,i;e=this.oAnnotation.getUnit(t.property.property);if(e){i=this._preprocAnnotation(e,t);this.getProperty(i);this._postprocAnnotation(i,t)}return i};l.prototype._preprocAnnotation=function(t,e){var i,n;n=this.traverseNavigationProperties(t,e.entityType);if(!n.navigationPath){n.entitySet=e.entitySet}if(e.navigationPath){n.path=e.path.replace(e.navigationPath+"/","")}else{n.path=e.path}if(n.navigationPath){i=t.replace(n.navigationPath+"/","")}else{i=t}n.path=n.path.replace(e.property.property.name,i);if(n.navigationPath){n.navigationPathHelp=n.navigationPath}return n};l.prototype._postprocAnnotation=function(t,e){var i;if(t.navigationPathHelp){t.navigationPath=t.navigationPathHelp}if(t.navigationPath){i=t.navigationPath}else{i=""}if(e.navigationPath){if(i){i=e.navigationPath+"/"+i}else{i=e.navigationPath}}t.navigationPath=i;if(t.navigationPath){t.path=t.navigationPath+"/"+t.path}};l.prototype.traverseNavigationProperties=function(t,e){var i={},n={},a,r,o;a=t.split("/");o=a.length;i.entityType=e;n.entityType=e;while(o--){r=a.shift();if(r===""){continue}n=this.getNavigationProperty(i.entityType,r);if(!n.entitySet){break}i.entityType=n.entityType;i.entitySet=n.entitySet;if(i.navigationPath){i.navigationPath=i.navigationPath+"/"+r}else{i.navigationPath=r}}return i};l.prototype.getValueListAnnotationPath=function(t){var e,i,n=this.getEdmProperty(t),a=n?n.name:"";if(t&&t.property&&t.property.complex){i=t.property.parents.length-1;e=t.property.parents[i].namespace;e=e+"."+t.property.typePath}else if(t&&t.entitySet&&n){e=t.entitySet.entityType+"/"+a}return e};l.prototype.getUOMValueListAnnotationPath=function(t){var e;if(t.annotations.uom){e=this.getValueListAnnotationPath(t.annotations.uom)}if(e){t.annotations.valuelistuom=e}};l.prototype.getUOMTextAnnotation=function(t){if(t&&t.annotations&&t.annotations.uom){t.annotations.textuom=this.getTextProperty2(t.annotations.uom)}};l.prototype.geValueListEntitySet=function(t){if(t&&t.annotations&&t.annotations.valuelist){if(t.annotations.valuelist.primaryValueListAnnotation&&t.annotations.valuelist.primaryValueListAnnotation.valueListEntitySetName){t.annotations.valuelistentityset=this.oMeta.getODataEntitySet(t.annotations.valuelist.primaryValueListAnnotation.valueListEntitySetName)}}};l.prototype.getEdmProperty=function(t){var e=t.property;return e&&e.property||null};l.prototype.getValueListData=function(t){var i=this.getEdmProperty(t),n=t.annotations;if(e.isValueList(i)){n.valuelist=this.getValueListAnnotationPath(t);var a=e.getValueListMode(i);if(a){n.valuelistType=a}else{n.valuelistType=this.getAnalyzer().getValueListSemantics(i["com.sap.vocabularies.Common.v1.ValueList"])}}};l.prototype.findProperty=function(t,e){return r.findObject(t,e)};l.prototype.getAssociation=function(t,e){var i;if(t){i=this.findProperty(t.navigationProperty,e)}if(i&&this.oMeta.oModel){return r.getObject(this.oMeta.oModel,"association",i.relationship)}return null};l.prototype.getToRoleAssociationEnd=function(t,e){if(Array.isArray(t)){for(var i=0;i<t.length;i++){var n=t[i];if(n.role===e){return n}}}return null};l.prototype.getToRoleAssociationEndMultiplicity=function(t,e){var i=this.getToRoleAssociationEnd(t,e);return i?i.multiplicity:""};l.prototype.checkNavigationPropertyRequiredMetadata=function(t){var e=t.propertyName,i=t.textAnnotation,n=i?i.Path:"",r=t.entityType,o=r.namespace+"."+r.name,l="sap.ui.comp.smartfield.ODataHelper",y="com.sap.vocabularies.Common.v1.Text";if(!i){a.info('Missing "'+y+'" annotation for "'+e+'" EDM property of "'+o+'" entity type.',l);return false}if(n===undefined){p(false,'Missing "Path" attribute of "'+y+'" annotation for "'+e+'" EDM property of "'+o+'" entity type. - '+l);return false}if(n===""){p(false,'Missing URL path name of "'+y+'" annotation for "'+e+'" EDM property of "'+o+'" entity type. - '+l);return false}var f="com.sap.vocabularies.UI.v1.TextArrangement",u=i[f];if(!u){a.info('Missing "'+f+'" annotation for "'+e+'" EDM property of "'+o+'" entity type.',l);return false}var c=u.EnumMember;if(c===undefined){p(false,'Missing "EnumMember" attribute of "'+f+'" annotation for "'+e+'" EDM property of "'+o+'" entity type. - '+l);return false}if(!(c.split("/")[1]in s)){p(false,'Invalid "'+c+'" Text annotation enumeration member for "'+e+'" EDM property of "'+o+'" entity type. - '+l);return false}if(u.EnumMember===s.TextSeparate){return false}if(n.indexOf("/")===-1){p(false,'Invalid navigation property URL path name specified in the "'+y+'" annotation of the "'+e+'" EDM property of the "'+o+'" entity type. - '+l);return false}var h=n.split("/")[0],g=this.findProperty(r.navigationProperty,h);if(!g){p(false,'The navigation property URL path name "'+h+'" (specified in the Text annotation of the "'+e+'" EDM property) was not found in the "'+o+'" entity type of the service metadata document. - '+l);return false}var d=this.getAssociation(r,h);if(!d){p(false,'Missing "'+g.relationship+'" association for "'+g.name+'" EDM navigation property of the "'+o+'" entity type. - '+l);return false}var v=d.referentialConstraint;if(!v){p(false,'Missing referential constraint for "'+g.relationship+'" association in the service metadata document. - '+l);return false}if(!Array.isArray(d.end)||!(d.end.length>0)){p(false,'Missing association end for "'+g.relationship+'" association in the service metadata document. - '+l);return false}var m=this.getToRoleAssociationEndMultiplicity(d.end,g.toRole);if(m!=="1"){p(false,'Expected multiplicity of 1 for "'+g.toRole+'" association end of the "'+g.relationship+'" association in the service metadata document. - '+l);return false}if(v.principal.propertyRef.length!==1||v.dependent.propertyRef.length!==1){p(false,'Expected the single "'+e+'" foreign key EDM property as '+'referential constraint in the "'+g.relationship+'" association. - '+l);return false}var P=t.entityTypeOfNavigationProperty||this.getNavigationProperty(r,h).entityType;if(P.key.propertyRef.length!==1){p(false,'Expected a single key property in the lookup "'+P.namespace+"."+P.name+'" entity type. - '+l);return false}var A=v.principal.propertyRef[0].name;if(A!==P.key.propertyRef[0].name){p(false,'Expected a property named "'+A+'" to be the single key property in the lookup "'+P.namespace+"."+P.name+'" entity type. - '+l);return false}return true};l.prototype.checkNavigationPropertyRequiredMetadataNoAsserts=function(t){var e=t.textAnnotation,i=e?e.Path:"",n=t.entityType;if(!e){return false}if(i===undefined){return false}if(i===""){return false}var a="com.sap.vocabularies.UI.v1.TextArrangement",r=e[a];if(!r){return false}var o=r.EnumMember;if(o===undefined){return false}if(!(o.split("/")[1]in s)){return false}if(r.EnumMember===s.TextSeparate){return false}if(i.indexOf("/")===-1){return false}var p=i.split("/")[0],l=this.findProperty(n.navigationProperty,p);if(!l){return false}var y=this.getAssociation(n,p);if(!y){return false}var f=y.referentialConstraint;if(!f){return false}if(!Array.isArray(y.end)||!(y.end.length>0)){return false}var u=this.getToRoleAssociationEndMultiplicity(y.end,l.toRole);if(u!=="1"){return false}if(f.principal.propertyRef.length!==1||f.dependent.propertyRef.length!==1){return false}var c=t.entityTypeOfNavigationProperty||this.getNavigationProperty(n,p).entityType;if(c.key.propertyRef.length!==1){return false}var h=f.principal.propertyRef[0].name;if(h!==c.key.propertyRef[0].name){return false}return true};l.prototype.checkValueListRequiredMetadataForTextArrangmentNoAsserts=function(t){var e=t.valueListAnnotation;if(!e){return false}if(!Array.isArray(e.fields)){return false}var i=e.descriptionField,n=this.findProperty(e.fields,i);if(!n){return false}if(n["sap:filterable"]==="false"){return false}return true};l.prototype.checkValueListRequiredMetadataForTextArrangment=function(t){var e=t.valueListAnnotation,i="sap.ui.comp.smartfield.ODataHelper";if(!e){var n=t.entityType,a=n.namespace+"."+n.name;p(false,'Missing "ValueList" annotation for "'+t.propertyName+'" EDM property of "'+a+'" entity type. - '+i);return false}if(!Array.isArray(e.fields)){p(false,'Missing fields for "'+e.valueListEntityName+'" entity. - '+i);return false}var r=e.descriptionField,o=this.findProperty(e.fields,r);if(r!==undefined){if(!o){p(false,'The "'+r+'" description field was not found '+"in the service metadata document. - "+i);return false}if(o["sap:filterable"]==="false"){p(false,'Expected the "'+o.fullName+'" field to be filterable. - '+i);return false}}return true};l.prototype.checkValueListRequiredMetadataForValidation=function(t){var e=t.valueListAnnotation;if(!e){return false}if(!Array.isArray(e.fields)){return false}return true};l.prototype.getEdmDisplayPath=function(t){var e=t.annotations.text;if(e){return e.path}return t.path};l.prototype.getTextAnnotationPropertyPath=function(t){return t?t.path:""};l.prototype.getAbsolutePropertyPathToValueListEntity=function(t){var e=t.property,i=e&&e["com.sap.vocabularies.Common.v1.Text"],n=t.bindingContextPath;if(typeof n==="string"&&n!==""&&i){return n+"/"+i.Path}var a=t.entitySet,r=t.entityID,p;if(r==null||r===""){return""}if(i&&a){if(t.property.type=="Edm.Guid"){p=t.entityID.toLowerCase()}else{p=t.entityID}p=o.formatValue(p,t.property.type,true);return"/"+a.name+"("+encodeURIComponent(p)+")"+"/"+i.Path}return""};l.prototype.getODataValueListKeyProperty=function(t){for(var e=0;e<t.fields.length;e++){var i=t.fields[e];if(i.name===t.keyField){return i}}};l.prototype.getUOMPath=function(t){if(t&&t.annotations&&t.annotations.uom){return t.annotations.uom.path}return null};l.prototype.getUOMTypePath=function(t){if(t.property.complex){return t.property.typePath.replace(t.property.property.name,t.annotations.uom.property.name)}return t.annotations.uom.property.name};l.prototype.getDropdownChangeHandler=function(t,e){return function(i){var n="",r=false;try{if(e){if(t.getFirstInnerControl&&t.getFirstInnerControl().setEnteredValue){t.getFirstInnerControl().setEnteredValue()}n=i.getSource().getSelectedKey();r=n!==null;if(!r){n=i.getSource().getValue()}}else{var o=i.getParameter("selectedItem");if(!o&&i.getSource().getSelectedItem){o=i.getSource().getSelectedItem()}if(o){n=o.getKey();r=n!==null}}t.fireChange({value:n,newValue:n,selectionChange:r})}catch(t){a.warning(t)}}};l.prototype.applyCriticality=function(t,e){var i=this.getEdmProperty(t),n=t.annotations?.lineitem,a=t.annotations?.datapoint,r=t.annotations?.fieldgroup,o=t.annotations?.connectedfields,p,s,l;if(!i){return}p=i["com.sap.vocabularies.UI.v1.DataFieldDefault"];if(p&&p.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&p["Criticality"]){i.criticalityInfo=this.getAnalyzer()._extractCriticalityInfo(p["Criticality"],p);i.criticalityInfo.criticalityFrom="DataFieldDefault";return}if(n&&n.criticality&&n.criticality[i.name]){i.criticalityInfo=n.criticality[i.name];i.criticalityInfo.criticalityFrom="LineItem";return}if(a){if(a.primaryAnnotation&&!e){s=a.primaryAnnotation}else if(a.additionalAnnotations){s=a.additionalAnnotations[e]}if(s&&s?.Value?.Path===i.name&&s.Criticality){i.criticalityInfo=this.getAnalyzer()._extractCriticalityInfo(s.Criticality,s);i.criticalityInfo.criticalityFrom="DataPoint";return}}l={FieldGroup:r,ConnectedFields:o};for(const t in l){const n=l[t];if(n){for(let a=0;a<n.length;a++){const r=n[a];if(!r.groupName&&!e||r.groupName===e){if(r.criticality&&r.criticality[i.name]){i.criticalityInfo=r.criticality[i.name];i.criticalityInfo.criticalityFrom=t;return}}}}}};l.prototype.destroy=function(){if(this._oAnalyzer){this._oAnalyzer.destroy()}if(this.oAnnotation){this.oAnnotation.destroy()}this._oUtil=null;this.oMeta=null;this.oAnalyzer=null;this.oAnnotation=null};l.prototype.getAutoExpandProperties=function(t){var e=[],i=[];for(var n in t){switch(n){case"com.sap.vocabularies.Common.v1.Text":case"Org.OData.Measures.V1.Unit":case"Org.OData.Measures.V1.ISOCurrency":case"com.sap.vocabularies.Common.v1.FieldControl":if(t[n].Path){i=t[n].Path.split("/")}break}if(i.length>1&&e.indexOf(i[0])<0){e.push(i[0])}}return e.join(",")};l.prototype.loadValueListAnnotation=function(t,e){var i=this.getAnalyzer().getValueListAnnotationLazy(t,e);i.catch(function(){a.error("The value list annotation could not be loaded.",undefined,"sap.ui.comp.smartfield.ODataHelper.loadValueListAnnotation")});return i};l.prototype._setControlDocumentationRef=function(t,e){if(e?.String&&t){sap.ui.require(["sap/ui/core/fieldhelp/FieldHelpUtil"],function(i){i.setDocumentationRef(t,e.String)})}};return l},true);
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ODataTypes", ["sap/ui/model/SimpleType","sap/ui/core/format/NumberFormat","sap/ui/model/odata/type/Boolean","sap/ui/comp/smartfield/type/Double","sap/ui/comp/smartfield/type/DateTime","sap/ui/comp/odata/type/StringDate","sap/ui/comp/odata/type/FiscalDate","sap/ui/comp/odata/type/NumericText","sap/ui/comp/smartfield/type/DateTimeOffset","sap/ui/model/odata/type/DateTimeWithTimezone","sap/ui/comp/smartfield/type/Decimal","sap/ui/comp/smartfield/type/Int16","sap/ui/comp/smartfield/type/Int32","sap/ui/comp/smartfield/type/Int64","sap/ui/comp/smartfield/type/Byte","sap/ui/comp/smartfield/type/SByte","sap/ui/comp/smartfield/type/String","sap/ui/comp/smartfield/type/StringNullable","sap/ui/comp/smartfield/type/TextArrangementString","sap/ui/comp/smartfield/type/TextArrangementGuid","sap/ui/comp/smartfield/type/AbapBool","sap/ui/comp/smartfield/type/Currency","sap/ui/comp/smartfield/type/Time","sap/ui/comp/smartfield/type/Guid","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/smartfield/type/Unit","sap/ui/comp/smartfield/type/IanaTextArrangement","sap/ui/comp/odata/type/CalendarDate","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/library","sap/base/util/merge"],function(e,t,n,r,i,a,o,s,p,u,l,m,c,f,y,g,d,h,C,v,T,x,D,_,F,w,O,S,b,A,L,E){"use strict";var I=L.numericEdmTypes;var P=function(e){this._oParent=e};P.prototype.getType=function(t,T,x,O){O=O||{};var L=this._oParent.getBindingInfo("value"),E=L&&L.binding&&L.binding.getType(),P=O.composite&&E instanceof e;if(E&&!P){return N(E)}if(t&&t.property&&t.property.type){if(!E){x=this.getConstraints(t.property,x);T=this.getFormatOptions(t.property,T)}if(I.indexOf(t.property.type)!==-1&&x.nullable===false){T.parseEmptyValueToZero=true}switch(t.property.type){case"Edm.Boolean":return new n(T,x);case"Edm.Double":return new r(T,x);case"Edm.Decimal":case"Edm.Single":return new l(T,this._getDecimalConstraints(t,x));case"Edm.Int16":return new m(T,x);case"Edm.Int32":return new c(T,x);case"Edm.Int64":return new f(T,x);case"Edm.Byte":return new y(T,x);case"Edm.SByte":return new g(T,x);case"Edm.DateTimeOffset":if(this.isWithTimeZone(t)){return new u(T)}return new p(T,x);case"Edm.DateTime":return new i(T,this._getDateTimeConstraints(t,x));case"Edm.String":if(!E){x=this._getStringConstraints(t,x)}if(E&&!x){x=E.oConstraints}var B=A.getCalendarAnnotationType(t.property);if(B&&!O.composite){return new b(T,x,{calendarType:B})}if(this.isCalendarDate(t)&&!O.composite){return new a(T)}var M=w.getFiscalAnnotationType(t.property);if(M&&!O.composite){return new o(T,x,{fiscalType:M})}if(x&&x.isDigitSequence&&!O.composite){return new s(T,x)}if(O.composite&&this.isTimeZone(t)){T=Object.assign({},T,this._getTextArrangementFormatOptions());return new S(T,x,this._getTextArrangementOptions(O))}if(O.composite){T=Object.assign({},T,this._getTextArrangementFormatOptions());x=this._getTextArrangementConstraints(t,x,T);if(x.isDigitSequence){return[new C(T,x,this._getTextArrangementOptions(O),this._oParent),new s(T,x)]}else{return new C(T,x,this._getTextArrangementOptions(O),this._oParent)}}if(this.isTimeZone(t)){return new u(T)}if(t.isStringNullable){return new h(T,x)}return new d(T,x,this._oParent);case"Edm.Time":return new D(T,x);case"Edm.Guid":var V={},k=this._getTextArrangementFormatOptions();if(F.hasTextArrangementAnnotation(t.property)&&k&&k.textArrangement==="descriptionOnly"){V={validateException:{resourceBundle:"sap.ui.comp",text:"ENTER_AN_EXISTING_DESCRIPTION"}}}if(O.composite){T=Object.assign({},T,this._getTextArrangementFormatOptions());return new v(T,x,this._getTextArrangementOptions(O))}return new _(T,x,V);default:return null}}return null};function N(e){var t=e.parseValue,n=e.destroy;e.parseValue=function(e,n){var r=t.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,n)}return r};e.destroy=function(){n.apply(this,arguments);this.oFieldControl=null};return e}P.prototype.getConstraints=function(e,t){return Object.assign({},t,{nullable:F.isNullable(e),skipDecimalsValidation:F.isSkippingMeasuredQuantityCheck(e)})};P.prototype.getFormatOptions=function(e,t){var n={};if(F.isUpperCase(e)){n.displayFormat="UpperCase"}return Object.assign({},t,n)};P.prototype.cloneType=function(e){const t=e.getMetadata().getClass();return new t(e.oFormatOptions?E({},e.oFormatOptions):undefined,e.oConstraints?E({},e.oConstraints):undefined)};P.prototype._getDateTimeConstraints=function(e,t){var n={},r;if(e.property["sap:display-format"]==="Date"||this.isCalendarDate(e)){n={displayFormat:"Date"}}for(r in t){n[r]=t[r]}return n};P.prototype.getMaxLength=function(e,t){var n=[],r,i=0;if(t&&t.constraints){if(t.constraints.maxLength&&t.constraints.maxLength>-1){n.push(t.constraints.maxLength)}}if(t&&t.type&&t.type.oConstraints){if(t.type.oConstraints.maxLength&&t.type.oConstraints.maxLength>-1){n.push(t.type.oConstraints.maxLength)}}if(e&&e.property&&e.property.maxLength){var a=parseInt(e.property.maxLength);if(a>-1){n.push(a)}}var o=this._oParent.getMaxLength();if(o>0){n.push(o)}var s=n.length;while(s--){r=n[s];if(r>0){if(i>0){if(r<i){i=r}}else{i=r}}}return i};P.prototype._getDecimalConstraints=function(e,t){var n=e.property;t=t||{};if(n.precision){t.precision=parseInt(n.precision)}if(n.scale){t.scale=parseInt(n.scale)}if(n["sap:variable-scale"]){t.variableScale=n["sap:variable-scale"]==="true"}return t};P.prototype._getTextArrangementFormatOptions=function(){return{textArrangement:this._oParent.getControlFactory()._getDisplayBehaviourConfiguration()}};P.prototype._getTextArrangementConstraints=function(e,t,n){var r=Object.assign({},t),i,a=e.valueListAnnotation;if(a&&n&&n.textArrangement==="descriptionOnly"){i=a.fields.find(function(e){return e.name===a.descriptionField});if(i!==undefined&&parseInt(i.maxLength)>parseInt(t.maxLength)){r.keyMaxLength=r.maxLength;r.maxLength=t.maxLength;r.descriptionMaxLength=i.maxLength}}return r};P.prototype._getStringConstraints=function(e,t){t=t||{};var n=this._oParent.getBindingInfo("value"),r=this.getMaxLength(e,n),i;if(n&&n.type&&n.type.oConstraints){if(n.type.oConstraints.equals){i=n.type.oConstraints.equals}}if(r>0||i){if(r>0){t.maxLength=r}if(i){t.equals=i}}if(F.isDigitSequence(e.property)){t.isDigitSequence=true}return t};P.prototype._getTextArrangementOptions=function(e){var t=this._oParent.getControlFactory().oTextArrangementDelegate;return{keyField:e.keyField,descriptionField:e.descriptionField,valueListNoValidation:e.valueListNoValidation,valueList:e.valueList,onBeforeValidateValue:t.onBeforeValidateValue.bind(t),delegate:e.delegate,clientSideMandatoryCheck:this._oParent.getClientSideMandatoryCheck()}};P.prototype.isCalendarDate=function(e){var t=e.property["com.sap.vocabularies.Common.v1.IsCalendarDate"];if(t&&t.Bool){return t.Bool?t.Bool!=="false":true}return false};P.prototype.isTimeZone=function(e){return e.property["com.sap.vocabularies.Common.v1.IsTimezone"]&&e.property["com.sap.vocabularies.Common.v1.IsTimezone"].Bool!=="false"};P.prototype.isWithTimeZone=function(e){return e.property["com.sap.vocabularies.Common.v1.Timezone"]?true:false};P.prototype.getDisplayFormatter=function(e,t){t=t||{};if(t.currency){return this.getCurrencyDisplayFormatter(t)}else if(t.type&&t.type.oConstraints&&t.type.oConstraints.scale&&e.scale){e.scale=t.type.oConstraints.scale}return this.getUOMDisplayFormatter(e,t)};P.prototype.getCurrencyDisplayFormatter=function(e){var t={showMeasure:false,emptyString:NaN},n;this._enhanceFormatOptions(t);n=new x(t);return function(t,r,i){var a,o,s,p,u,l=this&&this.oParent&&this.oParent.oParent,m=l&&l.isA("sap.ui.comp.smartfield.SmartField")&&l.isFormContextType();if(!t||!r||r==="*"){return""}if(!e.currency){a=t+="";return a}if(isNaN(parseFloat(t))){return t.toString()+""}a=n.formatValue([t,r,i],"string");p=i&&i[r]&&i[r].digits;s=n&&n.oOutputFormat&&n.oOutputFormat.oLocaleData.getCurrencyDigits(r);o=p||s;if(o===0&&!m){a+=""}u=3-o;if(u&&!m&&a){a=a.padEnd(a.length+u,"")}else{a+=""}if(e.mask){return P.maskValue(a)}return a}};P.prototype.getUOMDisplayFormatter=function(e,t){var n={showMeasure:false,emptyString:NaN},r;this._enhanceFormatOptions(n);r=new O(n,{scale:e&&e.scale?e.scale:0});return function(e,n,i){var a,o,s=this&&this.oParent&&this.oParent.oParent,p=s&&s.isA("sap.ui.comp.smartfield.SmartField")&&s.isFormContextType();if(!e&&e!==0||!n&&n!==""||n==="*"){return""}if(isNaN(parseFloat(e))){return e.toString()+""}a=r.formatValue([e,n,i],"string");o=i&&i[n]&&i[n].UnitSpecificScale;if((o===0||o===null)&&!p){a+=""}if(!p&&s&&s.getControlContext&&s.getControlContext()===""&&a&&o){a=a.padEnd(a.length+1,"")}if(p){a+=""}if(t&&t.mask){return P.maskValue(a)}return a}};P.maskValue=function(e){if(e){return e.replace(new RegExp(".","igm"),"*")}return e};P.prototype.getCurrencyType=function(e){if(e){var t=this._getDecimalConstraints(e),n=this.getConstraints(e.property,t),r=B(n),i=M(t);this._enhanceFormatOptions(r);return new x(r,this.getConstraints(e.property,i))}return null};P.prototype.getUoMType=function(e){var t=["edm.int16","edm.int32","edm.byte","edm.double"];if(e){var n=this._getDecimalConstraints(e),r=this.getConstraints(e.property,n),i=B(r);if(t.includes(e.property.type.toLowerCase())){i.parseAsString=false;r.type=e.property.type}this._enhanceFormatOptions(i);return new O(i,r)}return null};function B(e){var t=e.nullable?null:0;return{showMeasure:false,parseAsString:true,emptyString:t,precision:e.precision}}function M(e){return{precision:e.precision,scale:e.scale,variableScale:e.variableScale}}P.prototype.getAbapBoolean=function(){return new T};P.prototype.destroy=function(){this._oParent=null};P.prototype._enhanceFormatOptions=function(e){var t=this._getCustomDataConfiguration();if(typeof t.preserveDecimals==="boolean"){e.preserveDecimals=t.preserveDecimals}};P.prototype._getCustomDataConfiguration=function(){var e={},t;if(this._oParent){t=this._oParent.data("preserveDecimals");if(t){e.preserveDecimals=t==="true"}}return e};return P},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ObjectStatus", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var i=t.extend("sap.ui.comp.smartfield.ObjectStatus",{metadata:{library:"sap.ui.comp",properties:{criticality:{type:"any",group:"Misc",defaultValue:null},criticalityRepresentationType:{type:"sap.ui.comp.smartfield.CriticalityRepresentationType",group:"Misc",defaultValue:e.smartfield.CriticalityRepresentationType.WithIcon}}}});return i});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SideEffectUtil", ["sap/ui/comp/odata/SideEffects"],function(t){"use strict";var e=function(e){this._oParent=e;this._oSideEffects=new t};e.prototype.getFieldGroupIDs=function(t,e){var i,n,r,o;if(t.property&&t.property.complex){n=t.property.parents[0];r=this._toTypePath(t.path,n)}i={entitySet:t.entitySet,entityType:t.entityType,complexType:n};o=this._oSideEffects.getSideEffects(t.path,r,i);return this._calcFieldGroups(o,t,e)};e.prototype._calcFieldGroups=function(t,e,i){var n,r,o,f,s=[],p;r=this._getSideEffects(t,e,i);f=r.length;p=this._oParent.getBindingContext();n=p.getPath();for(o=0;o<f;o++){this._calcFieldGroups2(r[o],s,i,n,p)}return s.length>0?s:null};e.prototype._calcFieldGroups2=function(t,e,i,n,r){var o,f,s,p=this;t.sideEffects.forEach(function(c){s={name:c.name,originType:c.originType,originName:t.origin.name,originNamespace:t.origin.namespace,context:n};f=JSON.stringify(s);f=f.substring(1,f.length-2);o=i.data(f);if(!o){o=p.createUUID();s.contextObject=r;i.data(o,s);i.data(f,o)}e.push(o)})};e.prototype._getSideEffects=function(t,e){var i=[];var n={};n.sideEffects=this._getSideEffectsFromEntity("entitySet",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.entitySet;i.push(n)}n={};n.sideEffects=this._getSideEffectsFromEntity("entityType",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.entityType;i.push(n)}n={};n.sideEffects=this._getSideEffectsFromEntity("complexType",t);if(n.sideEffects&&n.sideEffects.length){n.origin=e.property.parents[0];i.push(n)}return i};e.prototype._getSideEffectsFromEntity=function(t,e){var i,n=[];if(e[t]){for(i in e[t]){n.push({name:i,originType:t,sideEffect:e[t][i]})}}return n};e.prototype._toTypePath=function(t,e){var i=t.split("/");return t.replace(i[0],e.name)};e.prototype.createUUID=function(){var t=(new Date).getTime();var e="xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx".replace(/[x]/g,function(e){var i=(t+Math.random()*16)%16|0;t=Math.floor(t/16);return(e==="x"?i:i&7|8).toString(16)});return e};e.prototype.destroy=function(){if(this._oSideEffects){this._oSideEffects.destroy()}this._oSideEffects=null};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SmartField", ["sap/ui/core/Lib","sap/ui/core/library","sap/ui/comp/library","sap/m/library","./JSONControlFactory","./ODataControlFactory","./BindingUtil","./SideEffectUtil","./ODataHelper","./ValidationUtil","./LifecycleUtil","sap/ui/core/Control","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode","sap/base/strings/capitalize","sap/base/Log","sap/base/util/Deferred","sap/m/DisplayListItem","sap/m/InputListItem","sap/ui/core/message/MessageMixin","./TextArrangementRead","sap/ui/Device","sap/ui/base/ManagedObjectObserver","sap/ui/core/EventBus"],function(t,e,i,r,o,n,a,s,l,u,d,p,h,f,c,g,y,_,m,C,b,v,V,I,S,E,P){"use strict";var F=e.ValueState;var M=i.smartfield.TextInEditModeSource;var x=i.smartfield.Importance;var T=e.TextAlign;var A=r.FlexJustifyContent;var D=e.TextDirection;var B=i.smartfield.ControlContextType;var L=i.smartfield.ControlProposalType;var O=r.EmptyIndicatorMode;var w=i.smartfield.ValueHelpTitleSource;var N=p.extend("sap.ui.comp.smartfield.SmartField",{metadata:{interfaces:["sap.ui.core.IFormContent","sap.ui.core.ISemanticFormContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartfield/SmartField.designtime",properties:{value:{type:"any",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},entitySet:{type:"string",group:"Misc",defaultValue:""},editable:{type:"boolean",group:"Misc",defaultValue:true},contextEditable:{type:"boolean",group:"Misc",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Misc",defaultValue:""},textAlign:{type:"sap.ui.core.TextAlign",group:"Misc",defaultValue:T.Initial},textDirection:{type:"sap.ui.core.TextDirection",group:"Appearance",defaultValue:D.Inherit},placeholder:{type:"string",group:"Misc",defaultValue:""},name:{type:"string",group:"Misc",defaultValue:""},valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:F.None},valueStateText:{type:"string",group:"Appearance",defaultValue:""},showValueStateMessage:{type:"boolean",group:"Appearance",defaultValue:true},jsontype:{type:"sap.ui.comp.smartfield.JSONType",group:"Misc",defaultValue:null},mandatory:{type:"boolean",group:"Misc",defaultValue:false},maxLength:{type:"int",group:"Misc",defaultValue:0},showSuggestion:{type:"boolean",group:"Misc",defaultValue:true},showValueHelp:{type:"boolean",group:"Misc",defaultValue:true},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},textLabel:{type:"string",group:"Misc",defaultValue:""},tooltipLabel:{type:"string",group:"Misc",defaultValue:""},uomVisible:{type:"boolean",group:"Misc",defaultValue:true},uomEditable:{type:"boolean",group:"Misc",defaultValue:true},uomEnabled:{type:"boolean",group:"Misc",defaultValue:true},url:{type:"string",group:"Misc",defaultValue:""},uomEditState:{type:"int",group:"Misc",defaultValue:-1},controlContext:{type:"sap.ui.comp.smartfield.ControlContextType",group:"Misc",defaultValue:B.None},proposedControl:{type:"sap.ui.comp.smartfield.ControlProposalType",group:"Misc",defaultValue:L.None},wrapping:{type:"boolean",group:"Misc",defaultValue:true},clientSideMandatoryCheck:{type:"boolean",group:"Misc",defaultValue:true},fetchValueListReadOnly:{type:"boolean",group:"Misc",defaultValue:true},expandNavigationProperties:{type:"boolean",group:"Behavior",defaultValue:false},textInEditModeSource:{type:"sap.ui.comp.smartfield.TextInEditModeSource",group:"Behavior",defaultValue:M.None},historyEnabled:{type:"boolean",group:"Misc",defaultValue:true},importance:{type:"sap.ui.comp.smartfield.Importance",group:"Misc",defaultValue:x.Low},fixedValueListValidationEnabled:{type:"boolean",group:"Misc",defaultValue:false},_internalFieldGroupIds:{type:"string[]",defaultValue:[],visibility:"hidden"},suppressEmptyStringRequest:{type:"boolean",group:"Misc",defaultValue:true},valueHelpTitleSource:{type:"sap.ui.comp.smartfield.ValueHelpTitleSource",group:"Behavior",defaultValue:w.Property}},aggregations:{_content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},configuration:{type:"sap.ui.comp.smartfield.Configuration",multiple:false},controlProposal:{type:"sap.ui.comp.smartfield.ControlProposal",multiple:false},_ariaLabelInvisibleText:{type:"sap.ui.core.InvisibleText",multiple:true,visibility:"hidden"},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"},ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"}},events:{entitySetFound:{parameters:{entitySet:{type:"string"}}},change:{parameters:{value:{type:"string"},newValue:{type:"string"}}},changeModelValue:{enableEventBubbling:true,parameters:{valueChanged:{type:"boolean"},valueLastValueState:{type:"boolean"},unitChanged:{type:"boolean"},unitLastValueState:{type:"sap.ui.core.ValueState"}}},initialise:{},visibleChanged:{parameters:{visible:{type:"boolean"}}},editableChanged:{parameters:{editable:{type:"boolean"}}},contextEditableChanged:{parameters:{editable:{type:"boolean"}}},modeToggled:{},innerControlsCreated:{},valueListChanged:{parameters:{changes:{type:"sap.ui.core.Control[]"}}},linkPress:{},press:{}}},renderer:{apiVersion:2,render:function(e,i){var r=i.getContent(),o=i.getFirstInnerControl();e.openStart("div",i);e.class("sapUiCompSmartField");e.openEnd();if(r&&i.getMode()==="display"&&i.isFormContextType()&&i._innerControlHasNoValue()&&o!==null&&!o.getMetadata().hasProperty("emptyIndicatorMode")){e.openStart("span");e.class("sapUiPseudoInvisibleText");e.openEnd();e.text(t.getResourceBundleFor("sap.ui.comp").getText("NO_VALUE"));e.close("span");e.openStart("span");e.attr("aria-hidden","true");e.class("sapMText");e.class("sapUiSelectable");e.class("sapMTextMaxWidth");e.class("sapUiCompSmartFieldValue");e.class("sapUiCompEmptyValue");e.openEnd();e.close("span")}e.renderControl(r);if(i.getAggregation("_ariaLabelInvisibleText")){i.getAggregation("_ariaLabelInvisibleText").forEach(function(t){e.renderControl(t)})}e.close("div")}}});V.call(N.prototype);var R=N.prototype.refreshDataState;N.prototype.init=function(){this._isInnerControlCreationDelayed=true;this._sAnnotationLabel="";this._bInDestroy=false;this._oSideEffects=new s(this);this._oFactory=null;this._oAdditionalInfo={};this._oControl={display:null,edit:null,current:null};this._oValue={display:null,edit:null,uom:null,uomset:null};this._oError={bComplex:false,bFirst:false,bSecond:false};this._oState=this._initState();this._oUtil=new a;this._bSuppressToggleControl=false;this.oValidation=new u(this);this._oLastValidated=null;this._bValueNotInitial=false;this.attachModelContextChange(function(){if(this._hasDefaultModel()){d._createICRenderedDeferred.call(this);this.invalidate();this._getComputedMetadata().then(function(t){if(t?.annotations?.valuelistType==="fixed-values"){let t=this.getMode()==="display"?true:false;const e=this.getBindingContext().getPath();const i=this._oControl?.edit;const r=i?.getBindingContext()?.getPath();if(i&&(!i.getBindingContext()&&this.getBindingContext()||e!==r)){i.setBindingContext(this.getBindingContext());t=true}if(t){this.getControlFactory()?.getValueListProvider()?._updateBindings()}}}.bind(this))}}.bind(this));this._initialStateApplied=new C;this._initialStateApplied.promise.then(function(){var t=this.getBinding("value");if(t){var e=function(){var i=this.getBinding("value").getDataState();if(i.getOriginalValue()!==i.getValue()){this._bValueNotInitial=true;t.detachChange(e)}}.bind(this);t.attachChange(e)}}.bind(this));this._oObserverConfiguration={properties:["visible"]};this._oObserver=new E(function(t){if(!t){return}if(t.type==="property"&&t.name==="visible"&&t.current===false){this._oState._setProperty("VISIBLE",t.current);this.fireVisibleChanged({visible:t.current})}}.bind(this));this._oObserver.observe(this,this._oObserverConfiguration);P.getInstance().publish("sap.ui.comp.smartfield.SmartField","INSTANCE_CREATED",{id:this.getId()})};N.prototype._getNextModeRenderedPromise=d._getNextModeRenderedPromise;N.prototype._getICRenderedPromise=d._getICRenderedPromise;N.prototype._rejectLifecyclePromises=d._rejectAll;N.prototype._shouldSuppressTextAnnotation=function(){return this.data("suppressCommonText")==="true"};N.prototype._setVisibilityBasedOnImportance=function(t){var e,i,r,o,n,a=this._oFactory,s=this.oParent&&this.oParent.isA("sap.ui.comp.smartform.GroupElement")&&this.oParent.getDomRef();if(!a||!s){return}e=a.getMetaData&&a.getMetaData();i=e&&e.property&&e.property.property;o=a._oHelper&&a._oHelper.oAnnotation;if(o){if(!o.isNullable(i)||o.isStaticMandatory(i)||o.getVisible(i)==="false"){return}}if(this.getMandatory()||!this.getVisible()||this._fieldControlValue===0||this._fieldControlValue===7){return}r=!this.isPropertyInitial("importance")&&this.getImportance()||o&&o.getImportanceAnnotation(i);switch(t){case x.High:n=r===x.High?"":"none";break;case x.Medium:n=r===x.Low?"none":"";break;default:n=""}s.style.display=n};N.prototype.getComputedTextLabel=function(){return this.getProperty("textLabel")||this._sAnnotationLabel};N.prototype.isPropertyBeingUpdatedByModel=function(t){var e=this.getBindingInfo(t);return!!(e&&e.skipModelUpdate)};N.prototype._boundEntityExists=function(t){t=t||this.getBindingContext();return!!(t&&t.getObject())};N.prototype.setShowValueHelp=function(t){var e=this.getShowValueHelp();this.setProperty("showValueHelp",t,true);var i=this.getContent();if(i&&typeof i.setShowValueHelp==="function"){t=this.getShowValueHelp();var r=t!==e,o=this._oFactory;if(r&&o){o.destroyValueHelp();if(t){o._createValueHelp()}}i.setShowValueHelp(t)}return this};N.prototype.setShowSuggestion=function(t){var e=this.getShowSuggestion();this.setProperty("showSuggestion",t,true);var i=this.getContent();if(i&&typeof i.setShowSuggestion==="function"){t=this.getShowSuggestion();var r=t!==e,o=this._oFactory;if(r&&o){if(t){o._createValueHelp()}else{o.destroyValueHelp()}}i.setShowSuggestion(t)}return this};N.prototype.setConfiguration=function(t){var e=this.getConfiguration(),i=this.setAggregation("configuration",t,true);t=this.getConfiguration();var r=!!(t&&e===null||e&&t===null),o=!!this.getContent();if(o&&(r||t&&e&&(t.getControlType()!==e.getControlType()||t.getDisplayBehaviour()!==e.getDisplayBehaviour()))){this._destroyControls();this._toggleInnerControlIfRequired({mode:this.getMode()});if(t&&t.getDisplayBehaviour()){this._onInnerControlToggled({mode:this.getMode(),fetchIDAndDescription:true,forceTextArrangementFetch:true})}}return i};N.prototype.setTooltip=function(t){this._refreshTooltipBaseDelegate(t);this.setAggregation("tooltip",t,true);var e=this.getFirstInnerControl();if(e){e.setTooltip(t)}return this};N.prototype._setOnInnerControl=function(){var t,e,i=this.getContent(),r=this.getFirstInnerControl(),o=this.getTextAlign();if(i){if(typeof i.setWidth==="function"){var n=this.getWidth();if(n){i.setWidth(n)}}this._setPropertyOnControls("wrapping",this.getWrapping());if(typeof i.setName==="function"){i.setName(this.getName())}if(typeof i.setPlaceholder==="function"&&this.getPlaceholder()!==""){i.setPlaceholder(this.getPlaceholder())}if(typeof i.setTextAlign==="function"&&(!i.getTextAlign()||o!==T.Initial)){i.setTextAlign(o)}if(typeof i.setJustifyContent==="function"){e=i.getJustifyContent();if(!e||e===""){if(o===T.Initial||o===T.Begin){t=A.Start}else if(o==="Right"){t=A.End}else{t=o}i.setJustifyContent(t)}}this._setPropertyOnControls("required",this.getMandatory());this._setPropertyOnControls("textDirection",this.getTextDirection());if(r&&r.getMetadata().getProperty("textAlign")&&(!r.getTextAlign()||o!==T.Initial)){this._setPropertyOnControls("textAlign",o)}}return this};N.prototype.getUomProperty=function(t){var e=this._getEmbeddedSmartField(),i=e&&e.getControlFactory(),r=i&&i._oFieldControl,o=_(t),n="getUom"+o,a=this[n]();if(e.isBound(t)&&r){var s=i.getMetaData();if(s){var l=r._oStoredBindings[t],u=r["_get"+o](s,l,t);u.path();var d=u.formatter.call(e,a);return d}}return a};N.prototype._setPropertyOnControls=function(t,e,i){i=i||this.getInnerControls();i.forEach(function(i){var r="set"+_(t);if(typeof i[r]==="function"){i[r](this._convertValueForControl(t,e,i))}},this)};N.prototype._convertValueForControl=function(t,i,r){var o;if(r){o=r.getMetadata().getProperty(t)}if(o){switch(t){case"wrapping":switch(o.type){case"boolean":return i;case"sap.ui.core.Wrapping":var n=e.Wrapping;if(i){return n.Soft}return n.None}}}return i};N.prototype.setEntitySet=function(t){this.setProperty("entitySet",t,true);this.fireEntitySetFound({entitySet:t});return this};N.prototype._setPendingEditState=function(t){this.data("pendingEditableState",!t)};N.prototype.setContent=function(t){return this.setAggregation("_content",t)};N.prototype.getContent=function(){return this.getAggregation("_content")};N.prototype.getControlFactory=function(){return this._oFactory};N.prototype.getValue=function(){var t=this.getInnerValueFunction();if(t){return t()}return this.getProperty("value")};N.prototype.getInnerValueFunction=function(){if(this._oValue&&typeof this._oValue[this.getMode()]==="function"){return this._oValue[this.getMode()]}return null};N.prototype.getValueState=function(){var t=this.getInnerControls(),e=this._getMaxSeverity(t);if(e>-1){return t[e].getValueState()}return F.None};N.prototype.setValueState=function(t){this.setProperty("valueState",t,true);var e=this.getInnerControls(),i,r="setSimpleClientError";if(e&&e.length){i=e[0];if(e.length>1){r="setComplexClientErrorFirstOperand"}}if(i&&typeof i.setValueState==="function"){i.setValueState(t);this[r](t===F.Error)}return this};N.prototype.getValueStateText=function(){var t=this.getInnerControls(),e=this._getMaxSeverity(t);if(e>-1){return t[e].getValueStateText()}return this.getProperty("valueStateText")};N.prototype.setValueStateText=function(t){this.setProperty("valueStateText",t,true);var e=this.getInnerControls(),i;if(e&&e.length){i=e[0]}if(i&&typeof i.setValueStateText==="function"){i.setValueStateText(t)}return this};N.prototype._getMaxSeverity=function(t){var e,i,r,o,n=0,a=-1,s={Error:3,Warning:2,Success:1,None:0};o=t.length;for(r=0;r<o;r++){i=t[r];if(i.getValueState){e=i.getValueState();if(e&&s[e]>n){n=s[e];a=r}}}return a};N.prototype.getFocusDomRef=function(){var t=this.getInnerControls(),e,i=t.length;if(i>0){e=t[0]}if(e&&e.getFocusDomRef){return e.getFocusDomRef()}return p.prototype.getFocusDomRef.apply(this,arguments)};N.prototype.getIdForLabel=function(){var t=this.getInnerControls(),e,i=t.length;if(i>0){e=t[0]}if(e&&typeof e.getIdForLabel==="function"){return e.getIdForLabel()}return this.getId()};N.prototype.unbindProperty=function(t,e){p.prototype.unbindProperty.apply(this,arguments);var i=this.getAllInnerControls();i.forEach(function(i){var r=i.getMetadata().getName();var o=n.getBoundPropertiesMapInfoForControl(r,{propertyName:t});if(Array.isArray(o)){o.forEach(function(t){i.unbindProperty(t,e)})}});return this};N.prototype.getMode=function(){var t=this.getEditable(),e=this.getEnabled(),i=this.getContextEditable();if(this.data("configdata")&&this.data("configdata").configdata&&this.data("configdata").configdata.isUOM&&this.data("configdata").configdata.isInnerControl&&this.data("configdata").configdata.getContextEditable){i=this.data("configdata").configdata.getContextEditable()}return t&&e&&i?"edit":"display"};N.prototype.isInEditMode=function(){return this.getMode()==="edit"};N.prototype._toggleInnerControlIfRequired=function(t){var e=t.mode;if(this._bSuppressToggleControl||(!this._oFactory||this._oFactory.bPending)){return}if(e==="edit"){this._createControlIfRequired(t)}else{var i,r=this.getProperty("value"),o=this._oFactory.getLocalTextPropertyName(),n=this.getBindingContext(),a=true;var s=this.data("configdata");if(n&&o){i=n.getProperty(o)}if(s&&s.configdata&&!s.configdata.isUOM){if(r===null||r===""&&!i){a=false}}if(a){this._createControlIfRequired(t)}else{this.setContent(null);this._oControl.current="display";this._rejectLifecyclePromises("SmartTable context optimisation")}}};N.prototype._propagateToInnerControls=function(){this._propagateFieldGroupIDs(this.getProperty("_internalFieldGroupIds"));this._setOnInnerControl();this._propagateToUoM()};N.prototype._propagateToUoM=function(){var t=this._getEmbeddedSmartField(),e=this.getUomVisible(),i;if(t){if(!this.isPropertyInitial("uomEditable")){t.setEditable(this.getUomEditable())}if(!this.isPropertyInitial("uomEnabled")){t.setEnabled(this.getUomEnabled())}if(!this.isPropertyInitial("uomVisible")){t.setVisible(e);i=t.getFirstInnerControl();if(i){i.toggleStyleClass("smartFieldPaddingRight",e)}}}};N.prototype._propagateFieldGroupIDs=function(t){var e;if(Array.isArray(t)&&t.length){e=this.getFirstInnerControl();if(e){e.setFieldGroupIds(t)}}};N.prototype._onInnerControlToggled=function(t){var e,i=this.getContent(),r,o=false,n=false,a={mode:t.mode,forceTextArrangementFetch:t.forceTextArrangementFetch};if(t&&t.fetchIDAndDescription&&this.getModel()&&this.getBindingContext()&&this.getBinding("value")){this._oFactory.fetchIDAndDescriptionCollectionIfRequired(a)}this._initialStateApplied.resolve();this._propagateToInnerControls();this._processEvents({editableChanged:t.editableChanged,editable:t.editable,contextEditableChanged:t.contextEditableChanged,contextEditable:t.contextEditable,visibleChanged:t.visibleChanged,visible:t.visible});if(t.mode==="display"&&this.isFormContextType()){this._setEmptyIndicator(this.getFirstInnerControl())}if(t.mode==="edit"&&i){i=this.getContent();r=this._oControl.edit;o=r&&i&&r.getId()===i.getId();if(o){this._checkFieldGroups({mode:t.mode})}}e=this._getEmbeddedSmartField();if(e&&e.data("configdata")&&e.data("configdata").configdata.isUOM){e.setClientSideMandatoryCheck(t.clientSideMandatoryCheck);var s=this._oFactory.getMetaData&&this._oFactory.getMetaData();if(e.getBindingInfo("editable")||s&&s.annotations&&s.annotations.uom.property&&s.annotations.uom.property.property&&s.annotations.uom.property.property["sap:updatable"]){n=true}if(t.isFormContextType&&t.contextEditable&&t.contextEditable!==t.editable&&!n&&e.getEditable()!==t.editable){e.setEditable(t.editable)}}};N.prototype._processEvents=function(t){if(t.editableChanged){this.fireEditableChanged({editable:t.editable})}if(t.contextEditableChanged){this.fireContextEditableChanged({editable:t.contextEditable})}if(t.visibleChanged){this.fireVisibleChanged({visible:t.visible})}};N.prototype._forceInitialise=function(){if(this._isBoundToDefaultModel()){return this._processStateHandler()}else if(!this.bIsListeningForDefaultModel){this.bIsListeningForDefaultModel=true;return new Promise(function(t,e){this.attachEvent("modelContextChange",{resolve:t,reject:e},this._forceInitialiseHandler,this)}.bind(this))}};N.prototype._forceInitialiseHandler=function(t,e){if(this._isBoundToDefaultModel()){this.detachEvent("modelContextChange",this._forceInitialiseHandler,this);this._processStateHandler().then(function(){e.resolve()}).catch(function(t){e.reject(t)})}};N.prototype._processStateHandler=function(){var t=this.getMode();return this._processState().then(function(){var e=this._getEmbeddedSmartFieldByMode(t);return e&&e._processState()}.bind(this))};N.prototype._updateInnerControlsIfRequired=function(){var t,e,i={mode:this.getMode(),contextEditable:this.getContextEditable(),editable:this.getEditable(),enabled:this.getEnabled(),visible:this.getVisible()};this._updateInnerControlsIfRequiredHandler(i);t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){e={mode:t.getMode(),contextEditable:t.getContextEditable(),editable:t.getEditable(),enabled:t.getEnabled(),visible:t.getVisible()};t._updateInnerControlsIfRequiredHandler(e)}};N.prototype._updateInnerControlsIfRequiredHandler=function(t){this._init();if(this._oFactory!==null){this._oFactory._init(this._oFactory._oMeta)}this._toggleInnerControlIfRequired(t)};N.prototype._getInnerControlPropertyBinding=function(t){var e,i,r,o,a,s=this._oControl[t],l=s&&this._getInnerControls(s);if(Array.isArray(l)&&l.length>0){e=l[0];i=e.getMetadata().getName();r=n.getBoundPropertiesMapInfoForControl(i,{propertyName:"value"})}if(Array.isArray(r)&&r.length>0){o=r[0];a=e.getBinding(o)}return a};N.prototype.isTextInEditModeSourceNotNone=function(t){return this._getComputedTextInEditModeSource(false,t)!==M.None};N.prototype._getComputedTextInEditModeSource=function(t,e){var i=e||this.getMode(),r=this.getTextInEditModeSource(),o=this.data("defaultTextInEditModeSource");if(o&&this.isPropertyInitial("textInEditModeSource")&&i==="edit"){r=o}if(!t&&r===M.ValueListWarning){r=M.ValueListNoValidation}return r};N.prototype._isValueListWarning=function(){return this._getComputedTextInEditModeSource(true)===M.ValueListWarning};N.prototype._isValueListValidationMode=function(){var t=this._getComputedTextInEditModeSource(true);if(t===M.ValueList||t===M.ValueListWarning){return true}return false};N.prototype._createControlIfRequired=function(t){if(!this._oFactory){return}var e=t.mode,i=this._oControl[e];if(e!==this._oControl.current||!i){if(!i){var r=this._oFactory.createControl(t);if(r){this._oControl[e]=r.control;this._placeCallBacks(r,e)}}this._oControl.current=e;this.setContent(this._oControl[e]);this._oFactory.updateControl(t);this._setOnInnerControl();this._fireInnerControlsCreated();this.fireModeToggled({mode:t.mode})}else if(!this.getContent()){this._oControl.current=e;this.setContent(this._oControl[e])}};N.prototype._fireInnerControlsCreated=function(){var t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){t.attachInnerControlsCreated(function(){this.fireInnerControlsCreated(this.getInnerControls())}.bind(this))}else{this.fireInnerControlsCreated(this.getInnerControls())}};N.prototype._placeCallBacks=function(t,e){if(t.params&&t.params.getValue){this._oValue[e]=t.params.getValue}if(t.params&&t.params.uom){this._oValue.uom=t.params.uom}if(t.params&&t.params.uomset){this._oValue.uomset=t.params.uomset}};N.prototype._init=function(t){var e,i,r;if(!this._oFactory){i=this.data("configdata");if(!i){e=this.getModel(t)}r=this.getBindingPath("value");if(t===undefined&&r&&(i||e)){this._oFactory=this._createFactory(t,e,r,i)}}};N.prototype.clone=function(){var t=p.prototype.clone.apply(this,arguments);t.attachModelContextChange(function(){this.invalidate()}.bind(t));d._createICRenderedDeferred.call(t);return t};N.prototype._destroyFactory=function(){this._bSuppressToggleControl=true;this._bSideEffects=false;this._bIsInitialized=false;if(this._oFactory){this._oFactory.destroy()}this._oFactory=null;this._bSuppressToggleControl=false;this._destroyControls()};N.prototype._destroyControls=function(){if(this._oControl){if(this._oControl.display){this._oControl.display.destroy()}if(this._oControl.edit){this._oControl.edit.destroy()}this._oControl.display=null;this._oControl.edit=null;this._oControl.current=null}this._oValue={display:null,edit:null,uom:null,uomset:null};this.destroyAggregation("_content")};N.prototype._createFactory=function(t,e,i,r){if(e&&e instanceof g){return new o(e,this,{model:t,path:i})}var a;if(!r){a=this._getEntitySet(t)}if(a||r){var s;if(r){s=r.configdata;this._enhanceConfigData(s)}else{s={entitySet:a,model:t,path:i}}return new n(e,this,s)}return null};N.prototype._enhanceConfigData=function(t){var e=this.data("ignoreInsertRestrictions");if(typeof e==="boolean"){t.ignoreInsertRestrictions=e}};N.prototype._getEntitySet=function(t,e){var i=this.getEntitySet(),r=i!=="";if(r&&!t){return i}var o=this.getBindingContext(t);if(o){var n=o.getPath();if(n===""||n===undefined||n==="/undefined"){return""}i=this._oUtil.correctPath(n);if(!e){this.fireEntitySetFound({entitySet:i})}return i}return""};N.prototype._getODataEntityType=function(t){var e,i,r,o,n=this.getModel(),a=n&&n.getMetaModel();e=this._getEntitySet(t);if(e===""){return}o=a.getODataEntitySet(e);if(o!==null&&o.entityType){i=o.entityType}if(i===undefined){r=a.getODataFunctionImport(e);if(r!==null&&r.returnType){i=r.returnType}}return i};N.prototype.getDataType=function(){var t;if(this._oFactory){if(this._oFactory.getDataProperty){t=this._oFactory.getDataProperty();if(t){return t.property.type}}return this.getJsonType()}return null};N.prototype.getDataProperty=function(){var t,e,i,r,o,n=this.getModel(),a=n&&n.getMetaModel();if(this._oFactory){if(this._oFactory.getDataProperty){return this._oFactory.getDataProperty()}}else{o=this.data("configdata")&&this.data("configdata").configdata;if(o&&o.property){return o.property}if(!a||!a.oModel){return null}e=this._getODataEntityType();if(e===undefined){return null}t=this.getBindingPath("value");if(t===undefined){return null}i=a.getODataEntityType(e);r=a.getODataProperty(i,t);if(r===null){return null}return{property:r}}};N.prototype.getUnitOfMeasure=function(){if(this._oValue.uom){return this._oValue.uom()}return null};N.prototype.setUnitOfMeasure=function(t){if(t&&this._oValue.uomset){this._oValue.uomset(t)}};N.prototype.setSimpleClientError=function(t){this._oError.bFirst=t};N.prototype.setComplexClientErrorFirstOperand=function(t){this._oError.bComplex=true;this._oError.bFirst=t};N.prototype.setComplexClientErrorSecondOperand=function(t){this._oError.bComplex=true;this._oError.bSecond=t};N.prototype.setComplexClientErrorSecondOperandNested=function(t){var e=this.getParent().getParent();e.setComplexClientErrorSecondOperand(t)};N.prototype._hasClientError=function(){if(this._oError.bComplex){return this._oError.bFirst||this._oError.bSecond}return this._oError.bFirst};N.prototype.checkClientError=function(t){t=Object.assign({handleSuccess:false},t);var e="The sap.ui.comp.smartfield.SmartField#checkClientError method is deprecated. "+"Please use the sap.ui.comp.smartfield.SmartField#checkValuesValidity method instead.";m.warning(e,this.getMetadata().getName());if(this.getMode()==="display"){return false}if(this._hasClientError()&&!t.handleSuccess){return true}this.getInnerControls().forEach(function(e){this._checkErrors(e,{checkClientErrorsOnly:true,handleSuccess:t.handleSuccess})}.bind(this));return this._hasClientError()};N.prototype.checkValuesValidity=function(t){var e,i=this.getControlFactory(),r;if(i&&i.getEdmProperty){r=i.getEdmProperty();if(!r){return Promise.resolve()}e=r.name}if(this.getMode()==="display"){return Promise.resolve({property:e,instance:this})}t=t||{};var o={handleSuccess:true,innerControls:this.getInnerControls(),rawValues:[]};var n=this._getEmbeddedSmartField();t=Object.assign(o,t);if(t.rawValues.length===0&&n&&n.data("configdata")&&n.data("configdata").configdata.isUOM){this._updateCurrencyRawValues(t)}return new Promise(function(i,r){var o={rawValues:t.rawValues,handleSuccess:t.handleSuccess,bCheckValuesValidity:true};var n=t.innerControls.map(function(t){return this._checkErrors(t,o)},this);Promise.all(n).then(function(){i({property:e,instance:this})}.bind(this)).catch(function(t){r({property:e,instance:this})}.bind(this))}.bind(this))};N.prototype.checkUnitValidity=function(t){var e=false;if(this.getMode()==="display"){return true}t=t||{};var i={handleSuccess:true,innerControls:this.getInnerControls(),rawValues:[]};var r=this._getEmbeddedSmartField();t=Object.assign(i,t);if(t.rawValues.length===0&&r&&r.data("configdata")&&r.data("configdata").configdata.isUOM){this._updateCurrencyRawValues(t)}if(i.innerControls.length!==2&&(i.innerControls.length!==1&&!this._oFactory._checkSuppressUnit())){throw new f}r=r?r:i.innerControls[1];var o=i.innerControls[0],a=r?r:this._getUomControl(),s,l,u,d;t=Object.assign({checkClientErrorsOnly:false,handleSuccess:true},t);if(o){var p=n.getBoundPropertiesMapInfoForControl(o.getMetadata().getName(),{propertyName:"value"});u=p&&p[0]}if(a){var g=n.getBoundPropertiesMapInfoForControl(a.getMetadata().getName(),{propertyName:"value"});d=g&&g[0]}if(u){s=o.getBinding(u)}if(d){l=a.getBinding(d)}if(!s||!l&&!this._oFactory._checkSuppressUnit()){return true}try{var y="get"+_(u),m=s.getType(),C=s.sInternalType,b=o[y]();if(C&&m){var v=t.rawValues||s.getValue(),V=m.parseValue(b,s.sInternalType,v);if(V){m.validateValue(V)}if(s.hasValidation()){var I=false,S=true,E={element:o,property:u,type:s.getType(),newValue:b,oldValue:s.getValue(),mParameters:{suppressChangeModelValue:true}};o.fireValidationSuccess(E,I,S);e=true}}}catch(t){var P={element:o,property:u,type:s.getType(),newValue:b,oldValue:s.getValue(),exception:t,message:t.message};if(t instanceof c){P.targetControl=r&&r.getFirstInnerControl()}if(t instanceof h){o.fireParseError(P)}else if(t instanceof f){o.fireValidationError(P)}else{if(t.toString()==="TypeError: Cannot read property 'decimals' of undefined"){t.validationUnitError=true}throw t}}try{if(!d||!a.getVisible()){return e}var F="get"+_(d),M=l.getType(),x=l.sInternalType,b=o[y](),T=a[F]();if(x&&M){var v=t.rawValues||s.getValue(),A=M.parseValue(T,l.sInternalType,v);if(A){M.validateValue(A)}if(l.hasValidation()){var I=false,S=true,D={element:a,property:d,type:l.getType(),newValue:T,oldValue:l.getValue(),mParameters:{suppressChangeModelValue:true}};a.fireValidationSuccess(D,I,S);e&=true}}}catch(t){var B={element:a,property:d,type:l.getType(),newValue:T,oldValue:l.getValue(),exception:t,message:t.message};if(t instanceof h){a.fireParseError(B)}else if(t instanceof f){a.fireValidationError(B)}else{t.validationUnitError=true;throw t}e=false}return e};N.prototype._updateCurrencyRawValues=function(t){t.rawValues=t.innerControls.map(function(t){var e=t.getMetadata(),i=n.getBoundPropertiesMapInfoForControl(e.getName(),{propertyName:"value"});return e.getProperty(i).get(t)})};N.prototype._checkErrors=function(t,e){e=Object.assign({checkClientErrorsOnly:false,handleSuccess:true},e);var i,r,o=this;if(t){var a=n.getBoundPropertiesMapInfoForControl(t.getMetadata().getName(),{propertyName:"value"});r=a&&a[0]}if(r){i=t.getBinding(r)}if(!i){return Promise.resolve()}var s;function l(e){var n,a={element:t,property:r,type:i.getType(),newValue:s,oldValue:i.getValue(),exception:e,message:e.message};if(e instanceof c){n=o._getEmbeddedSmartField();a.targetControl=n&&n.getFirstInnerControl()}if(e instanceof h){t.fireParseError(a)}else if(e instanceof f){t.fireValidationError(a)}else{throw e}}function u(){if(e.handleSuccess&&i.hasValidation()){var o={element:t,property:r,type:i.getType(),newValue:s,oldValue:i.getValue(),mParameters:{suppressChangeModelValue:true}};var n=false,a=true;t.fireValidationSuccess(o,n,a)}}try{var d="get"+_(r),p=i.getType(),g=i.sInternalType;s=t[d]();if(g&&p){if(e.checkClientErrorsOnly&&p.async){var y="The deprecated sap.ui.comp.smartfield.SmartField#checkClientError method can not be "+"used with async types. Please use sap.ui.comp.smartfield.SmartField#checkValuesValidity "+"method instead.";m.error(y,this.getMetadata().getName());this.setSimpleClientError(true);return Promise.reject()}if(p.async){var C=i.getDataState();var b=p.formatValue(C.getValue(),g);const t=this.getMandatory()&&this.getClientSideMandatoryCheck()&&!s;if(!C.isControlDirty()&&b===s&&!t){u();return Promise.resolve()}}var v=e.rawValues||i.getValue(),V=p.parseValue(s,i.sInternalType,v),I;if(V&&V instanceof Promise){I=V.then(function(t){return p.validateValue(t)}).then(u);I.catch(l);return I}I=p.validateValue(V,e.bCheckValuesValidity);if(I instanceof Promise){I.catch(l);return I.then(u)}}}catch(t){l(t);return Promise.reject()}u();return Promise.resolve()};N.prototype.isContextTable=function(){return this.getControlContext()==="responsiveTable"||this.getControlContext()==="table"};N.prototype.isFormContextType=function(){var t=this.getControlContext(),e=i.smartfield.ControlContextType;return t===e.Form||t===e.SmartFormGrid};N.prototype.isTableContextType=function(){var t=this.getControlContext(),e=i.smartfield.ControlContextType;return t===e.Table||t===e.ResponsiveTable};N.prototype.getInnerControls=function(){var t=this.getContent();return this._getInnerControls(t)};N.prototype._getInnerControls=function(t){var e,i={"sap.m.HBox":function(t){var e,i,r=0;i=t.getItems();if(i){r=i.length}if(r===0){return[]}if(r===1){return[i[0]]}e=i[1].getContent();if(e){return[i[0],e]}return[i[0]]},"sap.ui.comp.navpopover.SmartLink":function(t){var e=t.getAggregation("innerControl");if(e){return[e]}return[t]}};if(t){e=i[t.getMetadata()._sClassName]}if(e){return e(t)}if(t){return[t]}return[]};N.prototype.getAllInnerControls=function(){var t=[],e=this._oControl;if(e){for(var i in e){if(e.hasOwnProperty(i)){var r=e[i];if(r&&r instanceof Object){t.push(r)}}}}return t};N.prototype._getEmbeddedSmartField=function(){var t=this.getContent();return this._getEmbeddedSmartFieldInstace(t)};N.prototype._getEmbeddedSmartFieldByMode=function(t){var e=t==="edit"?this._oControl.edit:this._oControl.display;return this._getEmbeddedSmartFieldInstace(e)};N.prototype._getEmbeddedSmartFieldInstace=function(t){if(t){if(t.isA("sap.m.HBox")){var e=t.getItems();if(e){for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartfield.SmartField")){return e[i]}}}}}return null};N.prototype.onAfterRendering=function t(){p.prototype.onAfterRendering.bind(this,arguments);this._applyPlaceHolder();this._applyAttributes()};N.prototype.onBeforeRendering=function t(){var e;if(!this._hasDefaultModel()||this._bInDestroy){return Promise.resolve()}e=this._processState().then(this.accessibilityAttributesHandler.bind(this)).then(p.prototype.onBeforeRendering.bind(this,arguments)).catch(function(t){if(t){m.error(t)}});return e};N.prototype._calculateCurrentState=function(){var t,e,i,r=this.getClientSideMandatoryCheck(),o=this._getControlDescriptionPath(this._oControl.edit),n=this._getControlDescriptionPath(this._oControl.display),a=this.getEditable(),s=this.getContextEditable(),l=this.isFormContextType(),u=this.getMode(),d=this.getEnabled(),p=this.getVisible(),h=this.getBinding("value"),f=h&&this._oState.isValuePropertyChanged(h.getValue()),c=this._oState.isValueBindingPathChanged(this.getBindingPath("value")),g=this._oState.isModelChanged(this.getModel()),y=this._oState.isBindingContextChanged(this.getBindingContext()),_=this._oState.isEntitySetChanged(this._getEntitySet(undefined,true)),m=this._oState.isModeChanged(u),C=this._oState.isEditableChanged(a),b=this._oState.isVisibleChanged(p),v=this._oState.isContextEditableChanged(s),V=this._oState.isTextInEditModeSourceChanged(this.getTextInEditModeSource()),I=this._isDescriptionBindingPathDefault(),S=this._getComputedTextInEditModeSource()===M.ValueListNoValidation&&f,E=m&&o!==n,P=c||g||_||V,F=P;if(P){this._oState._resetProperty("EDIT");this._oState._resetProperty("DISPLAY")}t=this._oState.isModeInitialized(u);e=y||!t;i=S||!t||I||f||E;return{mode:u,rebind:i,enabled:d,visible:p,visibleChanged:b,editable:a,editableChanged:C,contextEditable:s,contextEditableChanged:v,forceTextArrangementFetch:e,clientSideMandatoryCheck:r,isFormContextType:l,isFactoryJustCreated:F,destroyFactory:P,bindingContextChanged:y}};N.prototype._processState=function(){var t,e,i,r,o=this._calculateCurrentState();e={mode:o.mode,rebind:o.rebind};i={mode:o.mode,contextEditable:o.contextEditable,editable:o.editable,enabled:o.enabled,visible:o.visible};r={editable:o.editable,editableChanged:o.editableChanged,isFormContextType:o.isFormContextType,contextEditable:o.contextEditable,contextEditableChanged:o.contextEditableChanged,forceTextArrangementFetch:o.forceTextArrangementFetch,clientSideMandatoryCheck:o.clientSideMandatoryCheck,mode:o.mode,visible:o.visible,visibleChanged:o.visibleChanged};if(this.isContextTable()&&(o.editableChanged||o.contextEditableChanged)&&(o.editable&&o.contextEditable)){var n=this._oControl&&this._oControl.edit;if(n){(n.isA("sap.m.HBox")?n.getItems():[n]).forEach(function(t){if(t.getValueState&&(t.getValueState()===F.Error||t.getValueState()===F.Warning)){t.setValueState(F.None)}})}}if(this._oFactory!==null&&o.destroyFactory){this._calculatePlaceHolder();this._destroyFactory()}if(o.bindingContextChanged){this._bSideEffects=false}this._init();if(this._oFactory===null){return Promise.resolve()}else{this._deletePlaceHolder()}t=this._oFactory.bind(e).then(function t(e){const n=e&&e.skipInit;if(n||this._oFactory===null){const t=this.data("configdata")?.configdataVL;if(this._oFactory&&this.isContextTable()&&!t){this._toggleInnerControlIfRequired(i)}return Promise.reject()}r.fetchIDAndDescription=e&&e.fetchIDAndDescription||false;if(o.isFactoryJustCreated&&this._oFactory.isA("sap.ui.comp.smartfield.ODataControlFactory")){this._oFactory.triggerCreationOfControls()}this._toggleInnerControlIfRequired(i);if(this._fieldControlValue===0){r.fetchIDAndDescription=false}this._onInnerControlToggled(r);if(this._oFactory.isA("sap.ui.comp.smartfield.ODataControlFactory")&&this._oFactory.getDataProperty()&&this._oFactory.getDataProperty().property!==undefined){this._fireInitialise()}}.bind(this));t.catch(function(t){if(t){m.error(t)}});return t};N.prototype._fireInitialise=function(){var t=this._getEmbeddedSmartField();if(t&&t.isA("sap.ui.comp.smartfield.SmartField")){if(!t.hasListeners("initialise")){t.attachInitialise(function(){!this._bIsInitialized&&this.fireInitialise();this._bIsInitialized=true}.bind(this))}}else if(!this._bIsInitialized){this._bIsInitialized=true;this.fireInitialise()}};N.prototype._calculatePlaceHolder=function(){var t=this.getFirstInnerControl(),e=t&&t.getDomRef()||null;this._iInnerControlHeight=e&&e.offsetHeight||null};N.prototype._deletePlaceHolder=function(){this._iInnerControlHeight=null};N.prototype._applyPlaceHolder=function(){var t=this.getDomRef();if(t){if(this._iInnerControlHeight){t.style.minHeight=this._iInnerControlHeight+"px"}else{t.style.minHeight=""}}};N.prototype._applyAttributes=function(){var t=this.getFirstInnerControl()?this.getFirstInnerControl().getDomRef("inner"):null;if(t&&this.isInEditMode()&&(this._isPhone()||this._isTablet())&&this._oFactory&&this._oFactory._oMetaData){if(this._oFactory._oMetaData._isNumber){t.setAttribute("inputmode","decimal");t.setAttribute("pattern","[0-9]+([.,][0-9]+)?")}}};N.prototype._isPhone=function(){return S.system.phone?true:false};N.prototype._isTablet=function(){return S.system.tablet&&!S.system.desktop?true:false};N.prototype.accessibilityAttributesHandler=function(){var t=this._getEmbeddedSmartField();if(this.isContextTable()){this._handleAriaLabelledByInSmartTable(t)}};N.prototype.getFirstInnerControl=function(){var t=this.getInnerControls();if(t.length){return t[0]||null}return null};N.prototype._checkFieldGroups=function(t){var e,i,r=t.mode;if(this.getBindingContext()&&this._oFactory&&this._oFactory.getMetaData&&r==="edit"&&!this._bSideEffects){i=this._calculateFieldGroupMetaData();e=this._getView();if(e&&i){this._setFieldGroup(i,e)}}};N.prototype._calculateFieldGroupMetaData=function(){var t=this._oFactory.getMetaData();if(t&&(!t.property||t.property&&!t.property.property)){return}return t};N.prototype._setFieldGroup=function(t,e){var i,r=this._oSideEffects.getFieldGroupIDs(t,e);if(r){i=this.getFirstInnerControl();if(i){this._bSideEffects=true;i.setFieldGroupIds(r)}}};N.prototype._getView=function(){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){return t}t=t.getParent()}return null};N.prototype._getUomControl=function(){var t=this.getAllInnerControls();if(this.getUomEnabled()&&t&&t.length===1){var e=t[0].getItems?t[0].getItems():[];for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartfield.SmartField")){return e[i]}}}return null};N.prototype.refreshDataState=function(t,e){var i,r,o,n;if(t==="value"){o=e&&e.getChanges();n=o&&o.value;if(n&&n.value!==n.oldValue){this._oLastValidated=null}R.apply(this,arguments);if(e.isLaundering()){if(this.getEditable()){i=this.getBindingContext();if(i&&i.getObject){r=i.getObject();if(r&&r.__metadata&&r.__metadata.created){this._checkCreated=true;return}}}}if(this._checkCreated&&!e.isLaundering()&&!e.isDirty()){if(this._oFactory){this._oFactory.rebindOnCreated()}this._checkCreated=false}}};N.prototype.onValidation=function(t){var e,i=t.getParameters(),r=i.newValue!==i.oldValue,o=this.data("configdata")&&this.data("configdata").configdata,n=o&&o.smartFieldRootControl?o.smartFieldRootControl:this,a=n._getEmbeddedSmartField(),s=a&&a.getFirstInnerControl(),l=s&&s.getId(),u=n.getModel(),d=t.getSource().getId(),p=i.mParameters,h=p&&p.originSource&&p.originSource.getId(),f=this._oLastValidated!==null&&this._oLastValidated.sourceId===d&&this._oLastValidated.sNewValue===i.newValue,c=p&&p.suppressChangeModelValue||f||false,g=l&&l!==d,_=l&&l===d,m=l&&h&&l!==h,C=l&&h&&l===h;if(h&&h!==d||c||u.getDefaultBindingMode()!==y.TwoWay){return}this._oLastValidated={sourceId:d,sNewValue:i.newValue};if(m||g){e={valueChanged:r,valueLastValueState:n.getValueState(),unitChanged:false,unitLastValueState:a.getValueState()}}else if(C||_){e={valueChanged:false,valueLastValueState:n.getValueState(),unitChanged:r,unitLastValueState:a.getValueState()}}else{e={valueChanged:r,valueLastValueState:n.getValueState()}}n.fireChangeModelValue(e)};N.prototype.exit=function(){this._bInDestroy=true;var t=null;this._oAdditionalInfo=null;if(this._oSideEffects){this._oSideEffects.destroy()}if(this._oUtil){this._oUtil.destroy()}if(this._oFactory){this._oFactory.destroy()}var e=this._oControl;if(e){if(e.current==="edit"){t=e["display"]}else{t=e["edit"]}if(e[e.current]&&!e[e.current].getParent()){e[e.current].destroy()}}if(t&&typeof t.destroy==="function"){t.destroy()}this._oObserver.unobserve(this,this._oObserverConfiguration);this._oUtil=null;this._oError=null;this._oValue=null;this._oFactory=null;this._oControl=null;this._oSideEffects=null;this._oState=null;this._sAnnotationLabel="";this._oLastValidated=null;this._oObserver=null};N.getSupportedAnnotationPaths=function(t,e,i,r){var o,n,a=[],s;if(t&&e&&i){s={entitySet:e,entityType:t.getODataEntityType(e.entityType),path:i};o={helper:new l(null,null,t)};if(r){o.navigationPathOnly=r}o.helper.getProperty(s);N._getFromEntitySet(a,s,o);N._getFromProperty(a,s,o);n=o.helper.getUnitOfMeasure2(s);if(n){N._getFromProperty(a,n,o)}o.helper.destroy()}return a};N._getFromEntitySet=function(t,e,i){var r;if(e.entitySet){r=i.helper.oAnnotation.getUpdateEntitySetPath(e.entitySet);N._push(r,t,e,i)}};N._push=function(t,e,i,r){var o,n,a,s,l={};if(t){if(r.navigationPathOnly){o=t.split("/");a=o.length;l.entityType=i.entityType;while(a--){n=o.shift();if(n===""){continue}l=r.helper.getNavigationProperty(l.entityType,n);if(!l.entitySet){break}if(s){s=s+"/"+n}else{s=n}}}else{s=t}}if(s){if(i.navigationPath){e.push(i.navigationPath+"/"+s)}else{e.push(s)}}};N._getFromProperty=function(t,e,i){var r;if(e.property.property){r=i.helper.oAnnotation.getText(e.property.property);N._push(r,t,e,i);r=i.helper.oAnnotation.getUnit(e.property.property);N._push(r,t,e,i);r=i.helper.oAnnotation.getFieldControlPath(e.property.property);N._push(r,t,e,i)}};N.prototype.addAssociation=function(t,e,i){if(t==="ariaLabelledBy"&&e){this.getInnerControls().forEach(function(t){if(t.addAriaLabelledBy){t.addAriaLabelledBy(e)}})}else if(t==="ariaDescribedBy"&&e){this.getInnerControls().forEach(function(t){if(t.addAriaDescribedBy){t.addAriaDescribedBy(e)}})}return p.prototype.addAssociation.apply(this,arguments)};N.prototype.removeAssociation=function(t,e,i){var r=p.prototype.removeAssociation.apply(this,arguments);if(t==="ariaLabelledBy"&&r){this.getInnerControls().forEach(function(t){if(t.removeAriaLabelledBy){t.removeAriaLabelledBy(r)}})}else if(t==="ariaDescribedBy"&&r){this.getInnerControls().forEach(function(t){if(t.removeAriaDescribedBy){t.removeAriaDescribedBy(r)}})}return r};N.prototype.getAccessibilityInfo=function(){const t=this.getContent();const e=this.isContextTable()?{description:""}:null;return t?.getAccessibilityInfo?.()||e};N.prototype.enhanceAccessibilityState=function(t,e){var i=this.getParent();if(i&&i.enhanceAccessibilityState){i.enhanceAccessibilityState(t,e)}};N.prototype._handleAriaLabelledByInSmartTable=function(t){var e,i=this;if(this.getAriaLabelledBy().length>0){this.getInnerControls().forEach(function(t){if(t.addAriaLabelledBy&&t.getAriaLabelledBy){e=t.getAriaLabelledBy().indexOf(i.getAriaLabelledBy()[0])>-1;if(!e){t.addAriaLabelledBy(i.getAriaLabelledBy()[0])}}})}};N.prototype._isValueInitial=function(){var t,e=this.getBinding("value"),i=e&&e.getDataState();if(!i||this._bValueNotInitial){t=false}else if(this._isValueInValidation()){t=this._getValueInValidation()===i.getOriginalValue()}else{t=i.getValue()===i.getOriginalValue()}return t};N.prototype._setValueInValidation=function(t){this._vValueInValidation=t};N.prototype._getValueInValidation=function(){return this._vValueInValidation};N.prototype._isValueInValidation=function(){return this._vValueInValidation!==undefined};N.prototype.getRequired=function(){if(this.getContextEditable()&&this.getEditable()){return this.getMandatory()}else{return false}};N.prototype.getBindingMode=function(t){var e=this.getBindingInfo(t);return e?e.parts[0].mode:undefined};N.prototype._innerControlHasNoValue=function(){var t,e,i,r,o,a,s,l,u=this.getInnerControls(),d=false;for(t=0;t<u.length;t++){o=u[t];a=o.getMetadata().getName();if(a==="sap.m.ObjectStatus"&&!(o.getText().trim()||o.getIcon().trim()||o.getTitle().trim())){d=true;break}else{l=n.getBoundPropertiesMapInfoForControl(a,{propertyName:"value"});if(!Array.isArray(l)){return false}i=0;for(e=0;e<l.length;e++){r=undefined;s=l[e];r=o.getProperty(s);if(r===""||r===null){i+=1}}if(i===l.length){d=true;break}}}return d};N.prototype._getHistoryEnabled=function(){return this.getHistoryEnabled()};N.prototype.getFormValueProperty=function(){return"value"};N.prototype.getFormFormattedValue=function(){var t,e=this._forceInitialise();if(e instanceof Promise){return e.then(function(){return this.getInnerControls().map(function(e){if(e.isA("sap.m.Text")){t=e.getText();if(!t&&e.getEmptyIndicatorMode()===O.On){t="-"}return t}}).join("")}.bind(this))}};N.prototype._hasSemanticObject=function(){var t,e=null,i=this.getControlFactory();if(i){t=i._oSelector}if(t){e=t.getCreator({mode:"display"})}return e==="_createEdmSemantic"};N.prototype._hasCriticality=function(){var t=this.getControlFactory();return!!t?.getEdmProperty()?.criticalityInfo};N.prototype.getDataSourceLabel=function(){return this._sAnnotationLabel};N.prototype._isAsync=function(){var t=this._getComputedTextInEditModeSource(),e=i.smartfield.TextInEditModeSource,r;if(t===e.ValueList){return true}else if(t===e.NavigationProperty){return true}else if(t===e.ValueListNoValidation){r=this.getControlFactory()._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour");return r==="descriptionOnly"}return false};N.prototype._getTextArrangementRead=function(){if(!this._oTextArrangementRead){this._oTextArrangementRead=new I}return this._oTextArrangementRead};N.prototype._hasDefaultModel=function(){var t=this.getModel();return t!==undefined};N.prototype._isBoundToDefaultModel=function(){var t=this._hasDefaultModel(),e=this._getEntitySet(undefined,true);return t&&e};N.prototype._isDescriptionBindingPathDefault=function(){var t=this.getFirstInnerControl(),e=t&&t.getBinding("value"),i=e&&e.isA("sap.ui.model.CompositeBinding")&&e.getBindings()[1]&&e.getBindings()[1].getPath()==="__$$SmartFieldNotExistingBindingPath"||false;return i};N.prototype._getControlDescriptionPath=function(t){var e=t&&t.getBindingInfo("value"),i=e&&Array.isArray(e.parts)&&e.parts[1]&&e.parts[1].path;return i};N.prototype._initState=function(){var t=Object.create({_setProperty:function(t,e){if(this.mProperties===undefined||this.mProperties===null){this.mProperties={}}if(this.mProperties[t]===undefined){this.mProperties[t]={}}this.mProperties[t].previous=this.mProperties[t].current;this.mProperties[t].current=e},_getProperty:function(t){return this.mProperties&&this.mProperties[t]&&this.mProperties[t].current},_resetProperty:function(t){if(this.mProperties[t]!==undefined){this.mProperties[t]={}}},_resetProperties:function(){if(this.mProperties){this.mProperties={}}},isModeInitialized:function(t){var e=t==="edit"?"EDIT":"DISPLAY",i=this._getProperty(e);if(!i){this._setProperty(e,true)}return i},isModeChanged:function(t){var e="MODE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isValuePropertyChanged:function(t){var e="VALUE_PROPERTY_VALUE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isModelChanged:function(t){var e="MODEL_ID",i=t&&t.getId(),r=this._getProperty(e)!==i;if(r){this._setProperty(e,i)}return r},isValueBindingPathChanged:function(t){var e="VALUE_PROPERTY_BINDING_PATH",i=typeof t!=="undefined"&&this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isEntitySetChanged:function(t){var e="ENTITY_SET",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isBindingContextChanged:function(t){var e="BINDING_CONTEXT_PATH",i=t&&t.getPath(),r=typeof i!=="undefined"&&this._getProperty(e)!==i;if(r){this._setProperty(e,i)}return r},isEditableChanged:function(t){var e="EDITABLE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isContextEditableChanged:function(t){var e="CONTEXT_EDITABLE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isVisibleChanged:function(t){var e="VISIBLE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i},isTextInEditModeSourceChanged:function(t){var e="TEXT_IN_EDIT_SOURCE_MODE",i=this._getProperty(e)!==t;if(i){this._setProperty(e,t)}return i}});t._setProperty("TEXT_IN_EDIT_SOURCE_MODE",M.None);return t};N.prototype.readODataLabel=function(){return new Promise(function(t,e){var i=this.getModel(),r=this.data("configdata"),o,n=i&&i.getMetaModel(),a,s;if(this._sAnnotationLabel){t(this._sAnnotationLabel);return}if(!i&&!r){e();return}a=new l(i,this._oUtil,n);if(r&&r.configdata){this._sAnnotationLabel=a.oAnnotation.getLabel(a.getEdmProperty(r.configdata));t(this._sAnnotationLabel);return}o=this.getBindingPath("value");s=this._getEntitySet();if(o&&s){n.loaded().then(function(){var e=a.oMeta.getODataEntitySet(s),i={entitySet:e,entityType:a.oMeta.getODataEntityType(e.entityType),path:o};a.getProperty(i);this._sAnnotationLabel=a.oAnnotation.getLabel(a.getEdmProperty(i));t(this._sAnnotationLabel)}.bind(this))}else{e()}}.bind(this))};N.prototype._setEmptyIndicator=function(t){if(t&&t.getEmptyIndicatorMode&&t.getEmptyIndicatorMode()!==O.On){t.setEmptyIndicatorMode(O.On)}};N.prototype._getEditableForNotExpandedNavigation=function(){return false};N.prototype._getComputedMetadata=function(){return this._initialStateApplied.promise.then(function(){return this._oFactory?.isA("sap.ui.comp.smartfield.ODataControlFactory")&&this._oFactory.getMetaData()}.bind(this))};N.prototype._calculateFieldGroupIDs=function(t){return this._oSideEffects.getFieldGroupIDs(t,this._getView())};N.prototype._setInternalFieldGroupIds=function(t){this.setProperty("_internalFieldGroupIds",t)};N.prototype._getAdditionalInfo=function(){return this._oAdditionalInfo};N.prototype._addAdditionalInfo=function(t,e){this._oAdditionalInfo[t]=e};N.prototype._isFixedValueList=function(){var t=this._oFactory.getMetaData();if(t&&t.annotations&&t.annotations.valuelistType==="fixed-values"){return true}return false};return N},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/SmartLabel", ["sap/ui/core/Control","sap/m/Label","sap/ui/comp/library","./BindingUtil","./AnnotationHelper","./SmartField","sap/base/strings/capitalize","sap/ui/core/Element","sap/ui/core/EventBus"],function(t,e,i,a,n,s,r,l,o){"use strict";var h=e.extend("sap.ui.comp.smartfield.SmartLabel",{metadata:{designtime:"sap/ui/comp/designtime/smartfield/SmartLabel.designtime",interfaces:["sap.ui.core.Label","sap.ui.core.IShrinkable","sap.m.IOverflowToolbarContent","sap.m.IHyphenation"],library:"sap.ui.comp"},renderer:{apiVersion:2}});h.prototype.init=function(){this._sSmartFieldId=null;this._bMetaDataApplied=false;this._fInnerControlsCreatedHandlers=null};h.prototype._bindProperties=function(){var t=this._getField();if(t){var e=new a;var i=null;if(!this.isBound("visible")){this.setVisible(t.getVisible())}if(!this._bTextSetExplicitly){i=t.getBindingInfo("textLabel");if(i){this.bindProperty("text",e.toBinding(i))}else if(!this.getBindingInfo("text")){this._setText(t.getComputedTextLabel())}}i=t.getBindingInfo("tooltipLabel");if(i){this.bindProperty("tooltip",e.toBinding(i))}else{this.setTooltip(t.getTooltipLabel())}}};h.prototype.onFieldVisibilityChange=function(t){if(!this.isBound("visible")){this.setVisible(t.getSource().getVisible())}};h.prototype.getLabelInfo=function(){var t,e;var i=this._getField();if(i){this._bindProperties();t=i.getDataProperty();if(t){e=this._getLabelInfo(t);if(e){if(e.text&&!this._bTextSetExplicitly){this._setProperty(this,"text",e.text)}if(e.quickinfo){this._setProperty(this,"tooltip",e.quickinfo)}}}}};h.prototype._setProperty=function(t,e,i){if(t&&e){if(i.match(/{@i18n>.+}/gi)){t.bindProperty(e,i.slice(1,-1))}else{var a=r(e);if(!t.getBindingInfo(e)&&!t["get"+a]()){t["set"+a](i)}}}};h.prototype.setLabelFor=function(t){var i=this._getField();var a="";if(t){if(typeof t==="string"){a=t}else if(t.getId){a=t.getId()}}if((this._fChange||this._fInitialized)&&a.length>0&&a===this._sSmartFieldId){return this}if(i){if(this._fChange){i.detachEvent("_change",this._fChange);this._fChange=null}if(this._fInitialized){i.detachInitialise(this._fInitialized);this._fInitialized=null}this.detachFieldVisibilityChange(i);this._bMetaDataApplied=false}if(a.length>0){this._sSmartFieldId=a;this._setLabelFor()}else{this._sSmartFieldId=null}e.prototype.setLabelFor.apply(this,arguments);var n=l.getElementById(this.getLabelFor());this.detachFieldVisibilityChange(n);this.attachFieldVisibilityChange(n);return this};h.prototype._lazyLinkRestore=function(){var t=o.getInstance(),e=function(i,a,n){if(n.id&&n.id===this._sSmartFieldId){t.unsubscribe("sap.ui.comp.smartfield.SmartField","INSTANCE_CREATED",e);setTimeout(function(){this.getLabelInfo()}.bind(this))}}.bind(this);t.subscribe("sap.ui.comp.smartfield.SmartField","INSTANCE_CREATED",e)};h.prototype._getField=function(){if(this._sSmartFieldId){return l.getElementById(this._sSmartFieldId)}return null};h.prototype._setLabelFor=function(){var t,e=this._getField();if(e&&!this._bMetaDataApplied){this._bMetaDataApplied=true;if(e.getDataProperty){t=e.getDataProperty();if(t){this.getLabelInfo()}else{if(!this._fInitialized){this._fInitialized=this.getLabelInfo.bind(this);e.attachInitialise(this._fInitialized)}if(!this._fChange){this._fChange=function(t){if(t.getParameter("name")==="textLabel"){this.getLabelInfo()}else if(t.getParameter("name")==="mandatory"){this.invalidate()}}.bind(this);e.attachEvent("_change",this._fChange)}}this._lateUpdateLabelFor(e)}}};h.prototype.updateLabelFor=function(t){var i=t.slice(0);if(i&&i.length>0){this.invalidate();e.prototype.setLabelFor.call(this,i.shift());this.updateAriaLabeledBy(i)}};h.prototype.updateAriaLabeledBy=function(t){if(t){for(var e=0;e<t.length;e++){var i=t[e];if(typeof i.addAriaLabelledBy==="function"){i.removeAriaLabelledBy(this);i.addAriaLabelledBy(this)}}}};h.prototype.setText=function(t){this.setProperty("text",t);this._bTextSetExplicitly=true;return this};h.prototype._setText=function(t){this.setProperty("text",t)};h.prototype._getLabelInfo=function(t){var e=new n;if(t&&t.property){return{text:e.getLabel(t.property),quickinfo:e.getQuickInfo(t.property)}}};h.prototype._delayUpdateLabelFor=function(t){var e=this;if(t.attachInnerControlsCreated&&!this._fInnerControlsCreatedHandlers){this._fInnerControlsCreatedHandlers=function(t){e.updateLabelFor(t.getParameters())};t.attachInnerControlsCreated(this._fInnerControlsCreatedHandlers)}};h.prototype._lateUpdateLabelFor=function(t){var e;if(t&&t instanceof s){e=t.getInnerControls();if(e&&e.length>0){this.updateLabelFor(e)}else{this._delayUpdateLabelFor(t)}var i=l.getElementById(this.getLabelFor());this.detachFieldVisibilityChange(i);this.attachFieldVisibilityChange(i)}};h.prototype.onBeforeRendering=function(){if(this._sSmartFieldId){var t=this._getField();if(!this._bMetaDataApplied){this._setLabelFor();if(!t){this._lazyLinkRestore()}else if(t&&t.getId()===this.getLabelFor()){this._lateUpdateLabelFor(t)}}}};h.prototype.attachFieldVisibilityChange=function(t){if(t&&typeof t.attachVisibleChanged==="function"){t.attachVisibleChanged(this.onFieldVisibilityChange,this)}};h.prototype.detachFieldVisibilityChange=function(t){if(t&&typeof t.detachVisibleChanged==="function"){t.detachVisibleChanged(this.onFieldVisibilityChange,this)}};h.prototype.destroy=function(t){var i=this._getField();delete this._bTextSetExplicitly;if(i){if(this._fInnerControlsCreatedHandlers&&i.detachInnerControlsCreated){i.detachInnerControlsCreated(this._fInnerControlsCreatedHandlers);this._fInnerControlsCreatedHandlers=null}if(this._fInitialized&&i.detachInitialise){i.detachInitialise(this._fInitialized);this._fInitialized=null}if(this._fChange){i.detachEvent("_change",this._fChange);this._fChange=null}}this._sSmartFieldId=null;return e.prototype.destroy.apply(this,arguments)};h.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this.detachFieldVisibilityChange(l.getElementById(this.getLabelFor()))};return h});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/TextArrangementDelegate", ["sap/ui/comp/library","sap/ui/core/library","sap/ui/core/Core","sap/ui/base/Object","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/base/assert","sap/base/util/deepEqual"],function(t,e,i,r,a,o,n,s){"use strict";var l=t.smartfield.TextInEditModeSource;var d=r.extend("sap.ui.comp.smartfield.TextArrangementDelegate",{constructor:function(t){r.apply(this,arguments);this.oFactory=t;this.oSmartField=t._oParent;this.bValidMetadata=false;this.sBindingContextPath="";this.sAbsolutePathToVLProperty="";this._mOneTimeDescriptionCache=new Map;this._sTextArrangementLastReadValue=null;this._mTextArrangementLastReadAdditionalFilters=null}});d.getPaths=function(t,e){var i=e.property&&e.property.valueListAnnotation;switch(t){case l.NavigationProperty:var r=e.annotations.text;if(!r){return{}}return{keyField:r.entityType.key.propertyRef[0].name,descriptionField:r.property.typePath,entitySetName:r.entitySet.name};case l.ValueList:if(!i){return{}}return{keyField:i.keyField,descriptionField:i.descriptionField,entitySetName:e.property.valueListEntitySet&&e.property.valueListEntitySet.name};case l.ValueListNoValidation:if(!i){return{}}return{valueListNoValidation:true,keyField:i.keyField,descriptionField:i.descriptionField,entitySetName:e.property.valueListEntitySet.name}}};d.prototype.getBindingInfo=function(t){var e,i,r=t&&t.type,a=t&&t.keyType,o=t.valueListNoValidation,n={},s=this.oSmartField,u=this.oFactory,p=u._oMetaData;if(!r||!r.isA("sap.ui.comp.smartfield.type.TextArrangement")&&!r.isA("sap.ui.comp.smartfield.type.TextArrangementString")){var c=s.getBindingInfo("value");r=c&&c.type||{};var y=d.getPaths(u._bTextInDisplayModeValueList?l.ValueList:s._getComputedTextInEditModeSource(),p);if(u.isEmptyStringSignificant()){n.isStringNullable=true}i=u._oTypes.getType(p.property,Object.assign(n,r.oFormatOptions),r.oConstraints,{composite:true,keyField:y.keyField,descriptionField:y.descriptionField,valueListNoValidation:o,valueList:s._getComputedTextInEditModeSource()===l.ValueList,delegate:this});if(Array.isArray(i)){r=i[0];a=i[1]}else{r=i}}var h=this.oSmartField.getBinding("value").getValue(),f=s._getComputedTextInEditModeSource(),g=d.getPaths(this.oFactory._bTextInDisplayModeValueList?l.ValueList:f,p);var F=this.getTextAnnotationPropertyPath({entitySet:{name:g.entitySetName},entityID:h});if(F===""||F.indexOf("undefined")!==-1){F="__$$SmartFieldNotExistingBindingPath"}e={model:p.model,type:r,parts:[{path:p.path},{path:F}]};if(a){e.parts[0].type=a}return e};d.prototype.getTextAnnotationPropertyPath=function(t){t=t||{};var e=t.textInEditModeSource||this.oSmartField._getComputedTextInEditModeSource(),i=this.oFactory,r=i._oMetaData,a=r.annotations&&r.annotations.text,o=t.textAnnotation||a;if(i._bTextInDisplayModeValueList){e=l.ValueList}switch(e){case l.NavigationProperty:return i._oHelper.getTextAnnotationPropertyPath(o);case l.ValueList:case l.ValueListNoValidation:var n=t.edmValueListKeyProperty||r.property.valueListKeyProperty,s=t.bindingContextPath||this.sBindingContextPath;if(o&&s!=="/undefined"&&this.oSmartField._isValueInitial()){var d=i._oHelper.getTextAnnotationPropertyPath(o);if(d&&d!==this.oFactory.getMetaData().path){return d}}return i._oHelper.getAbsolutePropertyPathToValueListEntity({property:n,bindingContextPath:s,entitySet:t.entitySet,entityID:t.entityID});case l.None:return"";default:return""}};d.prototype.checkRequiredMetadata=function(t,e){var i=this.oFactory,r=i._oMetaData,a=r.property,o=a.property,n=a.valueListKeyProperty,s=this.oSmartField.getTextInEditModeSource(),d=s===l.ValueList||s===l.ValueListWarning,u=o&&o["com.sap.vocabularies.Common.v1.Text"]||n&&n["com.sap.vocabularies.Common.v1.Text"];if(!u&&!d){return false}switch(t){case l.None:return false;case l.NavigationProperty:var p=r.annotations.text,c;if(p){c=p.entityType}var y={propertyName:r.property&&r.property.property&&r.property.property.name,entityType:r.entityType,entityTypeOfNavigationProperty:c,textAnnotation:r.property&&r.property.property&&r.property.property["com.sap.vocabularies.Common.v1.Text"]};if(e){return i._oHelper.checkNavigationPropertyRequiredMetadataNoAsserts(y)}else{return i._oHelper.checkNavigationPropertyRequiredMetadata(y)}case l.ValueList:case l.ValueListNoValidation:var h={propertyName:r.property&&r.property.property&&r.property.property.name,entityType:r.entityType,valueListAnnotation:r.property&&r.property.valueListAnnotation};if(e){return i._oHelper.checkValueListRequiredMetadataForTextArrangmentNoAsserts(h)}else{return i._oHelper.checkValueListRequiredMetadataForTextArrangment(h)}default:return false}};d.prototype.onBeforeValidateValue=function(t,e){var i=this.oSmartField;if(!i.getBindingContext()){return}var r=this.onFetchIDAndDescriptionCollectionSuccess.bind(this,{value:t,mode:i.getMode(),noRebind:e.noRebind,success:e.success,filterFields:e.filterFields,userInteractionValue:true});var a=this.onFetchIDAndDescriptionCollectionError.bind(this,{error:e.error});var o={value:t,success:r,error:a,filterFields:e.filterFields,updateBusyIndicator:true,bCheckValuesValidity:e.bCheckValuesValidity};return this.fetchIDAndDescriptionCollection(o)};d.prototype.fetchIDAndDescriptionCollectionIfRequired=function(t){var e,i,r,a=this.oSmartField,o=t.mode,n=t.forceTextArrangementFetch,d=a._getInnerControlPropertyBinding(o),u=a.getBinding("value"),p=d&&d.getType(),c=p&&p.isA("sap.ui.comp.smartfield.type.TextArrangement")||false,y=a._getComputedTextInEditModeSource(),h=this.oFactory,f=y===l.ValueList,g=a._isValueInitial();if(h){e=h.getMetaData();i=h._getLocalTextAnnotation()}if(i&&(e&&i.path===e.path||this.sBindingContextPath==="/undefined"||!g)){i=null}if(i&&g&&!a._isValueInValidation()){return}if(f||!i&&y===l.ValueListNoValidation&&this.oFactory._getDisplayBehaviourConfiguration()!=="idOnly"||this.oFactory._bTextInDisplayModeValueList){var F,m,v,P,V=false,D=a.getModel(),A=this.getAdditionalFiltersData(a,a.getControlFactory().getMetaData(),{}),L=this._mTextArrangementLastReadAdditionalFilters&&!s(this._mTextArrangementLastReadAdditionalFilters,A);if(D&&d){if(c){F=d.getBindings();m=D.getProperty(F[0].getResolvedPath());if(p.oFormatOptions.textArrangement==="descriptionOnly"){v=D.getProperty(F[1].getResolvedPath());if(v&&[v,m].includes(this._sTextArrangementLastReadValue)){V=true}}else{V=this._sTextArrangementLastReadValue===m}}else{m=D.getProperty(u.getResolvedPath());V=this._sTextArrangementLastReadValue===m}P=m===undefined||m===null}if(!P&&(L||!V||!c||n)){r=["keyField"];var T={value:m,mode:o,initialRendering:true,filterFields:r};return this.fetchIDAndDescriptionCollection({value:m,filterFields:r,updateBusyIndicator:false,success:this.onFetchIDAndDescriptionCollectionSuccess.bind(this,T)})}}};d.prototype.fetchIDAndDescriptionCollection=function(t){var e=t.value,i=this.oSmartField;if(t.bCheckValuesValidity){t.filterFields=["keyField"]}var r=i._oControl&&i._oControl.edit;if(r&&t.updateBusyIndicator){r.setBusyIndicatorDelay(300);r.setBusy(true)}i._setValueInValidation(e);return this.readODataModel(t).then(function(){i._bValueNotInitial=true}).finally(function(){if(r&&t.updateBusyIndicator){r.setBusyIndicatorDelay(0);r.setBusy(false)}i._setValueInValidation(undefined)})};d.prototype.readODataModel=function(t){var e=this.oSmartField,i,r,a,o,n,s=e._getComputedTextInEditModeSource(),u=e.getControlFactory().getMetaData(),p=d.getPaths(this.oFactory._bTextInDisplayModeValueList?l.ValueList:s,u),c="/"+p.entitySetName,y=u&&u.annotations&&u.annotations.valueListData||null,h=p.keyField,f=p.descriptionField,g=this.oFactory&&this.oFactory.getValueListProvider(),F=y&&y.valueListEntitySetName===p.entitySetName,m=F&&y&&y.outParams?Object.values(y.outParams):[],v=F&&y&&y.fields?y.fields:[],P={success:t.success,error:t.error},V=e.getSuppressEmptyStringRequest(),D=this.oFactory.isEmptyStringSignificant(),A=this.oFactory._isFixedList();if(!f&&(this.oSmartField.getMode()==="display"||!e._isValueListValidationMode())){return Promise.resolve()}this._sTextArrangementLastReadValue=t.value;try{i=this.getAbsolutePathToVLProperty();if(i){r=this.getSelectedEntity(i);if(r){this.clearAbsolutePathToVLProperty();t.success(r);return Promise.resolve()}}}catch(t){return Promise.reject(t)}n=this.getDataForNextDescriptionRequest(t.value);if(n&&n.hasOwnProperty(f)&&g&&g._shouldHaveHistory&&!g._shouldHaveHistory()){t.success(n);return Promise.resolve()}o=this.getAdditionalFiltersData(e,u,n);var L={keyFieldPath:h,aFilterFields:["keyField"]};if(f){L.descriptionFieldPath=f;L.aFilterFields=t.filterFields}for(a in o){t.filterFields.push(a)}L.additionalFilters=o;var T=this.getFilters(t.value,L);if(T.length===0){return Promise.resolve()}var x=this.getUrlParameters({keyField:h,descriptionField:f,outParams:m,allFields:v});P.filters=T;P.urlParameters=x;this._mTextArrangementLastReadAdditionalFilters=o;if(D&&!A&&V===true&&t.value===""){t.success=null;this.onFetchIDAndDescriptionCollectionSuccess(t,{results:[]});return Promise.resolve()}return e._getTextArrangementRead().read(e.getModel(),c,P).then(t.success).catch(t.error)};d.prototype.getSelectedEntity=function(t){return t!==""&&this.oSmartField.getBindingContext().getProperty(t)};d.prototype.clearAbsolutePathToVLProperty=function(){this.sAbsolutePathToVLProperty=""};d.prototype.setAbsolutePathToVLProperty=function(t){this.sAbsolutePathToVLProperty=t};d.prototype.getAbsolutePathToVLProperty=function(){return this.sAbsolutePathToVLProperty};d.prototype.getAdditionalFiltersData=function(t,e,i){var r,a,o,n,s,l={};if(typeof i==="undefined"){i={}}if(e&&e.annotations&&e.annotations.valueListData){a=e.annotations.valueListData.inParams;r=e.annotations.valueListData.constParams}if(r){for(o in r){l[o]=r[o]}}if(a){for(n in a){s=a[n];if(s!==e.annotations.valueListData.keyField){l[s]=i[s]!==undefined?i[s]:t.getBindingContext().getProperty(n)}}}return l};d.prototype._setBindingPath=function(t,e,i,r,a){var o=t.getModel(),s;n(Array.isArray(e)," - "+this.getMetadata().getName());if(o){this.invalidateDescription(i,r,false);if(Array.isArray(e)&&e.length===1){s=o.getKey(e[0])}if(a&&e.length!==1){this.sBindingContextPath="/"+s;this.bindPropertyForValueList(i,r,true)}else if(typeof s==="string"){this.sBindingContextPath="/"+s;this.bindPropertyForValueList(i,r,false,a)}else if(e.length!==1&&i==="text"){this.sBindingContextPath=undefined;this.bindPropertyForValueList(i,r,false)}else if(e.length!==1){this.invalidateDescription(i,r,true)}}};d.prototype.invalidateDescription=function(t,e,i){var r,a=e&&e.getBinding(t),o,n=a&&a.getType();if(!n){o=e&&e.getBindingInfo(t);n=o&&o.type}if(n&&n.isA("sap.ui.comp.smartfield.type.TextArrangement")){r=n.getDescriptionIsInvalid();if(r!==i){n.setDescriptionIsInvalid(i);if(a){a.refresh(true)}}}};d.prototype.onFetchIDAndDescriptionCollectionSuccess=function(t,e,i){var r,a=true,o,n,s,d,u,p,c,y=this.oSmartField;if(!y){return}n=t.mode||y.getMode();r=e&&Array.isArray(e.results)&&e.results.length===1?e.results[0]:null;o=y.getControlFactory()&&y.getControlFactory().getValueListProvider()||null;s=y._oControl.edit;d=y._oControl.display;u=e&&e.results===undefined?[e]:e.results;c=y._getComputedTextInEditModeSource();if(r&&o&&t.userInteractionValue){o._calculateAndSetODataModelOutputData(r);if(n==="edit"&&!t.initialRendering&&c!==l.NavigationProperty){o._oHistoryValuesProvider&&o._oHistoryValuesProvider.setFieldData([r])}}if(!t.initialRendering){y.oValidation.handleValueListWarning(u)}if(typeof t.success==="function"){a=t.success(u)}if(!a&&c!==l.ValueListNoValidation){return}if(t.noRebind){return}if(d){this._setBindingPath(y,u,"text",d)}if(s&&y.isTextInEditModeSourceNotNone("edit")){p=c===l.ValueListNoValidation;this._setBindingPath(y,u,"value",s,p)}};d.prototype.onFetchIDAndDescriptionCollectionError=function(t,e){if(typeof t.error==="function"){t.error(e)}};d.prototype.bindPropertyForValueList=function(t,e,i,r){var a=this.oSmartField,o={},n,s,d,u,p=a._getComputedTextInEditModeSource();if(p===l.ValueList||p===l.ValueListNoValidation||this.oFactory._bTextInDisplayModeValueList){s=e&&e.getBindingInfo(t);if(this.oFactory&&s){d=s.type;if(s.parts&&s.parts[0]){u=s.parts[0].type}if((!d||!d.isA("sap.ui.comp.smartfield.type.TextArrangement"))&&this.oFactory._getTextArrangementType){n=this.oFactory._getTextArrangementType();if(n){d=n}}if(d){o={type:d}}if(u){o.keyType=u}o.skipValidation=i;o.bValueListNoValidation=r;e.bindProperty(t,this.getBindingInfo(o))}}};d.prototype.getUrlParameters=function(t){var e=[t.keyField];if(t.descriptionField){e.push(t.descriptionField)}t.outParams.forEach(function(t){if(e.indexOf(t)===-1){e.push(t)}});if(this.oSmartField._getComputedTextInEditModeSource()!==l.NavigationProperty){e=t.allFields.map(function(t){return t.name})}return{$select:e.join(","),$top:2}};d.prototype.getFilters=function(t,e){this.destroyFilters();var i=e.aFilterFields,r;if(Array.isArray(i)&&i.length===1&&Object.keys(e.additionalFilters).length===0){switch(i[0]){case"keyField":this.oIDFilter=u(t,e);return[this.oIDFilter];case"descriptionField":this.oDescriptionFilter=p(t,e);return[this.oDescriptionFilter]}}this.oIDFilter=u(t,e);r=this._getAdditionalFilters(e);this.oFilters=new a({and:true,filters:[new a({and:false,filters:[this.oIDFilter]})]});if(r.aFilters.length>0){this.oFilters.aFilters.push(r)}return[this.oFilters]};d.prototype.setDataForNextDescriptionRequest=function(t,e){this._mOneTimeDescriptionCache.set(t,e)};d.prototype.getDataForNextDescriptionRequest=function(t){var e=this._mOneTimeDescriptionCache.get(t);this._mOneTimeDescriptionCache.delete(t);return e};function u(t,e){return new a({value1:t,path:e.keyFieldPath,operator:o.EQ})}function p(t,e){return new a({value1:t,path:e.descriptionFieldPath,operator:o.EQ})}d.prototype._getAdditionalFilters=function(t){var e=[],i=this.oSmartField.getControlFactory().getMetaData(),r=i.annotations&&i.annotations.valueListData,o=r&&r.fields;Object.keys(t.additionalFilters).forEach(function(i){var a=t.additionalFilters[i],n=o.find(function(t){return t.name===i}),s=r.aInitialValueIsSignificantFields.indexOf(i)!==-1,l=this._generateFiltersForField(a,i,n,s);if(l){e.push(l)}}.bind(this));return new a({and:true,filters:e})};d.prototype._generateFiltersForField=function(t,e,i,r){if(t===null||t===undefined||t===""){if(r){return this._generateFiltersForEmptyField(e,i&&i.nullable==="false")}}else{return new a({value1:t,path:e,operator:o.EQ})}};d.prototype._generateFiltersForEmptyField=function(t,e){if(e){return new a({value1:"",path:t,operator:o.EQ})}return new a([new a({value1:"",path:t,operator:o.EQ}),new a({value1:null,path:t,operator:o.EQ})],false)};d.prototype.destroyFilters=function(){if(this.oIDFilter){this.oIDFilter.destroy();this.oIDFilter=null}if(this.oDescriptionFilter){this.oDescriptionFilter.destroy();this.oDescriptionFilter=null}if(this.oFilters){this.oFilters.destroy();this.oFilters=null}};d.prototype.destroy=function(){this.oSmartField=null;this.bValidMetadata=false;this.sBindingContextPath="";this.sAbsolutePathToVLProperty="";this._mOneTimeDescriptionCache=null;this._mTextArrangementLastReadAdditionalFilters=null;this.destroyFilters()};return d});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/TextArrangementRead", ["sap/ui/thirdparty/URI"],function(e){"use strict";var t;var r=function(){if(!t){t=this;this.mRequests=new Map;this._iMaxRequests=1e3;if(window.location.search.indexOf("data-sap-ui-xx-disableTextArrangementReadCache=true")!==-1){this.read=function(e,t,r){return this._createReadPromise({model:e,path:t,settings:r})}.bind(this)}}return t};r.prototype.read=function(e,t,r){var s,i={model:e,path:t,settings:r};try{s=this._calculateCacheKey(i)}catch(e){return this._createReadPromise(i)}return this._getPromise(s,i)};r.prototype._getPromise=function(e,t){var r,s;if(this.mRequests.has(e)){r=this.mRequests.get(e);s=this._validateCache(e,r,t);if(s===true){return r.promise}if(s instanceof Promise){return s}}return this._createReadPromise(t,e)};r.prototype._setPromise=function(e,t,r){var s;this.mRequests.set(e,{modelId:r.model.getId(),promise:t});if(this.mRequests.size>this._iMaxRequests){s=this.mRequests.getKeys().next().value;if(s){this.mRequests.delete(s)}}};r.prototype._validateCache=function(e,t,r){if(r&&r.model){if(t.modelId===r.model.getId()){return true}return new Promise(function(s){t.promise.then(function(i){if(i&&Array.isArray(i.results)&&this._probeLocalModelForLoadedData(r,i)){s(t.promise)}else{s(this._createReadPromise(r,e))}}.bind(this))}.bind(this))}return true};r.prototype._probeLocalModelForLoadedData=function(e,t){var r=e.model.getKey(t.results[0]);if(r){return!!e.model.getProperty("/"+r)}return false};r.prototype.exit=function(){this.mRequests.clear()};r.prototype.clearCache=function(){this.mRequests.clear()};r.prototype._createReadPromise=function(e,t){var r=new Promise(function(t,r){e.settings.success=t;e.settings.error=r;e.model.read(e.path,e.settings)}).then(function(e){var r=e&&Array.isArray(e.results)&&e.results.length===1;if(t&&!r){this.mRequests.delete(t)}return e}.bind(this));if(t){this._setPromise(t,r,e)}return r};r.prototype._calculateCacheKey=function(t){var r,s=t.model.sServiceUrl,i=t.model.aUrlParams;if(!s){throw"Can't access service URL. Opt out of value list caching."}s=new e(s).absoluteTo(document.baseURI).pathname().toString();r={path:t.path,service:s,filters:this._flattenFilters(t.settings.filters)};if(Array.isArray(i)&&i.length){r["urlParams"]=i}return JSON.stringify(r)};r.prototype._flattenFilters=function(e){var t=[],r=function(e){if(e.sPath){t.push({p:e.sPath,v:e.oValue1})}if(Array.isArray(e.aFilters)){e.aFilters.forEach(r)}};r(e[0]);return t};return r},false);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/UoMValidateException", ["sap/ui/model/ValidateException"],function(t){"use strict";var e=function(e,i){t.apply(this,arguments)};e.prototype=Object.create(t.prototype);return e});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ValidationUtil",["sap/ui/comp/library","sap/ui/core/Lib","sap/ui/core/Messaging","sap/ui/core/message/Message","sap/ui/core/message/MessageType","sap/ui/core/message/ControlMessageProcessor","sap/ui/model/ValidateException"],function(e,t,s,i,o,r,a){"use strict";var n=e.smartfield.TextInEditModeSource;var u=function(e){this.oSmartField=e;this.oRB=t.getResourceBundleFor("sap.ui.comp")};u.prototype._getPropertyName=function(e){if(e.isA("sap.ui.comp.smartfield.ComboBox")){return"enteredValue"}else if(e.isA("sap.m.ComboBox")){return"selectedKey"}else{return"value"}};u.prototype._createMessage=function(e,t,o){var r=this._getPropertyName(t),a;this._removeMessage();a=new i({message:this.oRB.getText(e),type:o,target:t.getId()+"/"+r,processor:this._getMessageProcessor()});this._oCurrentMessage=a;s.addMessages(a)};u.prototype._removeMessage=function(){if(this._oCurrentMessage){s.removeMessages(this._oCurrentMessage);this._oCurrentMessage.destroy();this._oCurrentMessage=null}};u.prototype.handleValueListWarning=function(e){var t=this.oSmartField._oControl.edit;if(t&&this.oSmartField._isValueListWarning()){if(e.length===0){this._createMessage("SMARTFIELD_NOT_FOUND",t,o.Warning)}else if(e.length>1){this._createMessage("SMARTFIELD_DUPLICATE_VALUES",t,o.Warning)}else{this._removeMessage()}}};u.prototype._getMessageProcessor=function(){var e;if(this._oMessageProcessor){return this._oMessageProcessor}e=new r;s.registerMessageProcessor(e);this._oMessageProcessor=e;return this._oMessageProcessor};u.prototype.handleComboValidation=function(e){if(!this._isComboBoxValidationWarning()){return}if(e.getEnteredValue()&&!e.getSelectedKey()&&e.getValue()!==""){this._createMessage("SMARTFIELD_NOT_FOUND",e,o.Warning)}else{this._removeMessage()}};u.prototype._isComboBoxValueInvalid=function(e,t,s){if(s===null||s===""&&t.isA("sap.ui.comp.odata.type.NumericText")){return false}return!e.getSelectedItem()&&e.getValue()};u.prototype.addValidationToType=function(e){var t;if(!e){return}t=e.validateValue;if(this._isComboBoxValidationStrict()){e.validateValue=function(s){var i=this.oSmartField._oControl.edit;if(this._isComboBoxValueInvalid(i,e,s)){if(i.getTextArrangement()==="descriptionOnly"){throw new a(this.oRB.getText("SMARTFIELD_NOT_UNIQUE"))}else{throw new a(this.oRB.getText("SMARTFIELD_NOT_FOUND"))}}return t.apply(this,arguments)}.bind(this)}else{e.validateValue=function(){try{t.apply(e,arguments)}catch(e){throw new a(this.oRB.getText("SMARTFIELD_NOT_FOUND"))}}.bind(this)}};u.prototype._isLegacyMode=function(){var e=this.oSmartField;return e._isFixedValueList()&&e.getFixedValueListValidationEnabled()};u.prototype._isComboBoxValidationStrict=function(){if(this._isLegacyMode()){return false}return this.oSmartField._getComputedTextInEditModeSource()===n.ValueList};u.prototype._isComboBoxValidationWarning=function(){if(this._isLegacyMode()){return false}return this.oSmartField._isValueListWarning()};return u},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/ValueListDelegate", ["sap/ui/base/Object","sap/base/util/deepEqual"],function(t,i){"use strict";var e=t.extend("sap.ui.comp.smartfield.ValueListDelegate",{constructor:function(i){t.apply(this,arguments);this.oValueListProvider=i}});e.prototype.fetchIDAndDescriptionCollectionIfRequired=function(){if(!this.oValueListProvider.bInitialised){return}this.oValueListProvider._calculateFilterInputData();if(!i(this.oValueListProvider._mLastFilterInputData,this.oValueListProvider.mFilterInputData)){this.oValueListProvider._fetchData();this.oValueListProvider._mLastFilterInputData=this.oValueListProvider.mFilterInputData}};e.prototype.destroy=function(){this.oValueListProvider=null};return e});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/flexibility/SmartFieldWriteDelegate", function(){"use strict";const e=true;function r(r){return r.modifier.createControl("sap.ui.comp.smartfield.SmartLabel",r.appComponent,r.view,r.labelFor+"-label",{labelFor:r.labelFor},e)}function t(r){return r.modifier.createControl("sap.ui.comp.smartfield.SmartField",r.appComponent,r.view,r.fieldSelector,{value:"{"+r.bindingPath+"}"},e)}var n={};n.createLabel=function(e){return r(e)};n.createControlForProperty=async function(e){const r=await t(e);return{control:r,valueHelp:undefined}};return n});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/AbapBool", ["sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/SimpleType"],function(o,e,t){"use strict";var n=t.extend("sap.ui.comp.smartfield.type.AbapBool",{constructor:function(){t.apply(this,arguments);this.sName="sap.ui.comp.smartfield.type.AbapBool"}});n.prototype.formatValue=function(e,t){if(e===undefined||e===null){return null}switch(t){case"boolean":case"any":return e==="X";default:throw new o("Don't know how to format Boolean to "+t)}};n.prototype.parseValue=function(o,t){switch(t){case"boolean":return o===true?"X":"";default:throw new e("Don't know how to parse Boolean from "+t)}};n.prototype.validateValue=function(o){if(o!==null&&o!==undefined){if(o!=="X"&&o!==""){throw new e("Invalid Boolean "+o)}}};return n});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Byte", ["sap/ui/model/odata/type/Byte"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Byte",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Byte"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Currency", ["sap/ui/core/Lib","sap/ui/model/type/Currency","sap/ui/model/odata/type/Currency","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException"],function(t,e,r,i,n){"use strict";var s=/^([-]?)(\d+)(?:\.(\d+))?$/;var o=r.extend("sap.ui.comp.smartfield.type.Currency",{constructor:function(t,e){r.apply(this,[t]);this.oConstraints=e;this.bParseWithValues=true;this.sName="Currency"}});o.prototype.parseValue=function(t,e,i){if(i[1]&&this.shouldConvertUnitToUpperCase(i[1])){arguments[2][1]=arguments[2][1].toUpperCase()}var n=r.prototype.parseValue.apply(this,arguments),s,o,u=Array.isArray(n)&&n[0]&&a(n[0]);if(Array.isArray(u)){s=u[1]+u[2];o=u[3];if(Number.parseInt(o)===0){n[0]=s}}if(n[1]===undefined){n[1]=i[1]}return n};o.prototype.validateValue=function(t){var e,r=t[0],s=t[1],o=r===null,h=0,m=this.oFormatOptions&&this.oFormatOptions.customCurrencies;if(s&&this.shouldConvertUnitToUpperCase(s)){s=s.toUpperCase()}if(this.oConstraints&&this.oConstraints.nullable&&(o||r===this.oFormatOptions.emptyString)){return}if(m&&s&&Object.keys(m).indexOf(s)===-1){throw new n(p("CURRENCY_VALIDATION_FAILS",[s]))}if(typeof r!=="string"||e===null){throw new i(u("EnterNumber"))}e=a(r);if(typeof r!=="string"||e===null){throw new i(u("EnterNumber"))}var c=parseInt(e[2]),l=c===0?0:e[2].length,f=(e[3]||"").length,C=this.oConstraints&&this.oConstraints.precision,y=typeof C==="number"?C:Infinity,d=s,U=this.oOutputFormat.oLocaleData.getCurrencyDigits(d),g=this.mCustomUnits&&this.mCustomUnits[d]&&this.mCustomUnits[d].decimals;if(g||g===0){U=g}if(this.oConstraints&&this.oConstraints.variableScale){h=Math.min(y,U)}else{h=Math.min(this.oConstraints&&this.oConstraints.scale||0,U)}if(h>y){h=y}if(f>h){if(h===0){throw new i(u("EnterInt"))}if(l+h>y){throw new i(u("EnterNumberIntegerFraction",[y-h,h]))}throw new i(u("EnterNumberFraction",[h]))}if(l>y-h){throw new i(u("EnterNumberInteger",[y-h]))}};function a(t){return s.exec(t)}function u(e,r){return t.getResourceBundleFor("sap.ui.core").getText(e,r)}function p(e,r){return t.getResourceBundleFor("sap.ui.comp").getText(e,r)}o.prototype.shouldConvertUnitToUpperCase=function(t){return this.mCustomUnits&&!this.mCustomUnits[t]&&this.mCustomUnits[t.toUpperCase()]};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Currency"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/DateTime", ["sap/ui/model/odata/type/DateTime"],function(t){"use strict";var e=t.extend("sap.ui.comp.smartfield.type.DateTime",{constructor:function(e,o){t.apply(this,arguments);this.oFieldControl=null}});e.prototype.parseValue=function(e,o){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,o)}return i};e.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};e.prototype.getName=function(){return"sap.ui.comp.smartfield.type.DateTime"};return e});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/DateTimeOffset", ["sap/ui/model/odata/type/DateTimeOffset"],function(t){"use strict";var e=t.extend("sap.ui.comp.smartfield.type.DateTimeOffset",{constructor:function(e,o){t.apply(this,arguments);this.oFieldControl=null}});e.prototype.parseValue=function(e,o){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,o)}return i};e.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};e.prototype.getName=function(){return"sap.ui.comp.smartfield.type.DateTimeOffset"};return e});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Decimal", ["sap/ui/model/odata/type/Decimal"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Decimal",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Decimal"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Double", ["sap/ui/model/odata/type/Double"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Double",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){o=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return o};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Double"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Guid", ["sap/ui/model/odata/type/Guid","sap/ui/model/ValidateException","sap/ui/core/Lib"],function(t,e,i){"use strict";var o=/^[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}$/i;function n(t){if(!t.resourceBundle){t.resourceBundle="sap.ui.core"}return i.getResourceBundleFor(t.resourceBundle).getText(t.text)}function s(t){throw new e(n(t))}var r=t.extend("sap.ui.comp.smartfield.type.Guid",{constructor:function(e,i,o){t.apply(this,arguments);this.oSettings=o;this.oFieldControl=null;this.oValidateExceptionSettings=this.oSettings&&this.oSettings.validateException||{resourceBundle:"",text:"EnterGuid"}}});r.prototype.parseValue=function(e,i){e=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(e,i)}return e};r.prototype.validateValue=function(t){if(t===null){if(this.oConstraints&&this.oConstraints.nullable===false){s.call(this,this.oValidateExceptionSettings)}return}if(typeof t!=="string"){throw new e("Illegal "+this.getName()+" value: "+t)}if(!o.test(t)){s.call(this,this.oValidateExceptionSettings)}};r.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};r.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Guid"};return r});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/IanaTextArrangement", ["sap/ui/comp/smartfield/type/TextArrangementString","sap/ui/model/odata/type/DateTimeWithTimezone"],function(e,t){"use strict";var a=e.extend("sap.ui.comp.smartfield.type.IanaTextArrangement",{constructor:function(a){a=Object.assign({showDate:false,showTime:false},a);this.DateTimeWithTimezoneType=new t(a);return e.prototype.constructor.apply(this,arguments)}});a.prototype.formatValue=function(t,a){t[0]=this.DateTimeWithTimezoneType.formatValue([null,t[0]],a);return e.prototype.formatValue.call(this,t,a)};a.prototype.getName=function(){return"sap.ui.comp.smartfield.type.IanaTextArrangement"};return a});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int16", ["sap/ui/model/odata/type/Int16"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int16",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int16"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int32", ["sap/ui/model/odata/type/Int32"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int32",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int32"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Int64", ["sap/ui/model/odata/type/Int64"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Int64",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Int64"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/SByte", ["sap/ui/model/odata/type/SByte"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.SByte",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var p=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return p};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.SByte"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/String", ["sap/ui/model/odata/type/String"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.String",{constructor:function(o,e){t.apply(this,arguments);this.oFormatOptions=o;this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(this.oFormatOptions&&this.oFormatOptions.displayFormat==="UpperCase"&&i&&i.toUpperCase){i=i.toUpperCase()}if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.String"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/StringNullable", ["sap/ui/comp/smartfield/type/String"],function(t){"use strict";var e=t.extend("sap.ui.comp.smartfield.type.StringNullable",{constructor:function(e,r){e=Object.assign({parseKeepsEmptyString:true},e);t.call(this,e,r)}});e.prototype.formatValue=function(e,r){if(e===null&&this.getPrimitiveType(r)==="string"){return null}return t.prototype.formatValue.call(this,e,r)};e.prototype.getName=function(){return"sap.ui.comp.smartfield.type.StringNullable"};return e});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangement", ["sap/ui/core/Lib","sap/ui/model/CompositeType","sap/ui/comp/util/FormatUtil","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/base/util/isPlainObject","sap/base/util/Deferred","sap/base/assert"],function(e,t,i,r,n,s,o,a){"use strict";var l=t.extend("sap.ui.comp.smartfield.type.TextArrangement",{constructor:function(e,i,r,n){this.getPrimaryType().call(this,e,i);t.call(this,e,i);this.init(e,i,r);a(r.keyField!==undefined,"Missing value for the keyField. - "+this.getName());if(n?.isA?.("sap.ui.comp.smartfield.SmartField")){this.oSmartField=n}},metadata:{abstract:true}});l.prototype.init=function(e,t,i){this.sName="TextArrangement";this.bParseWithValues=true;this.async=true;var r={textArrangement:"idOnly"};var n={onBeforeValidateValue:function(){}};this.oSettings=Object.assign(n,i);this.oFormatOptions=Object.assign(r,e);this.fnParser=this.getValidator({textArrangement:this.oFormatOptions.textArrangement,prefix:"parse"});this.fnValidator=this.getValidator({textArrangement:this.oFormatOptions.textArrangement,prefix:"validate"});this.bValueListNoValidation=i.valueListNoValidation;this.bClientSideMandatoryCheck=this.oSettings.clientSideMandatoryCheck!==undefined?this.oSettings.clientSideMandatoryCheck:true;this.bIsInvalid=false;this._sSelectedValue=null};l.prototype.getSettings=function(){return this.oSettings};l.prototype.parseValue=function(e,t,i){var r,n=e===""&&!this._isValueSelected(e),s=this.oFormatOptions.textArrangement;if(n&&(this.bClientSideMandatoryCheck||!this.bClientSideMandatoryCheck&&this.oConstraints.nullable)){e=null}if(typeof e==="string"){e=e.replace(/\u0020+$/,"")}if(s==="idOnly"){r=this.parseIDOnly(e,t)}else{r=this.fnParser(e,t,i,this.oFormatOptions,this.oSettings)}if(r[0]&&r[0].toUpperCase&&this.oFormatOptions.displayFormat==="UpperCase"){r[0]=r[0].toUpperCase()}return r};l.prototype.parseIDOnly=function(e,t){e=this.getPrimaryType().prototype.parseValue.call(this,e,t);return[e,undefined]};l.prototype.setSelectedValue=function(e){this._sSelectedValue=e};l.prototype._isValueSelected=function(e){return this._sSelectedValue===e};l.prototype.parseIDAndDescription=function(e,t,i,r){var n;if(!this._isValueSelected(e)){if(r&&r.textArrangement==="idAndDescription"){n=/^([\S\s]+?)\s\([\S\s]+\)$/.exec(e)}else{n=/^[\S\s]+\s\(([\S\s]+?)\)$/.exec(e)}}this.setSelectedValue(null);if(Array.isArray(n)&&n[1]){e=n[1]}return this.parseIDOnly(e,t)};l.prototype._parseKey=function(e,t){const i=this.getPrimaryType(),r=new i(this.oFormatOptions,this.oConstraints);return r.parseValue.call(this,e,t)};l.prototype.parseDescriptionOnly=function(e,t,i,r,s){var a,l,d,p=this.oConstraints&&this.oConstraints.maxLength?this.oConstraints.maxLength:0;if(e&&this._isValueSelected(e)){return Promise.resolve([e])}function h(i,r){var o,a=s.keyField,l=s.descriptionField,d=i.reject;var p=u(e,{key:l,value:a,data:r});var h=p.length;if(h===1){if(this._bRevokedValue){this._bRevokedValue=false;return false}o=this.getPrimaryType().prototype.parseValue.call(this,p[0],t);i.resolve([o,undefined]);return true}if(h===0){p=u(e,{key:a,value:l,data:r});h=p.length}if(!this.bValueListNoValidation){this.oSmartField?._addAdditionalInfo("descriptionCount",h);if(h===0){i.reject(new n(this.getResourceBundleText("SMARTFIELD_NOT_UNIQUE")));return false}if(h>1){i.reject(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return false}}if(!this._validateDeprecationCode(s,e,p,d,r)){return false}o=this.getPrimaryType().prototype.parseValue.call(this,e,t);i.resolve([o,undefined]);return true}function c(e,t){e.reject(new n(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}a=new o;if(e===null){a.resolve([e,undefined]);return a.promise}if(e&&e.toUpperCase&&this.oFormatOptions.displayFormat==="UpperCase"){e=e.toUpperCase()}if(this.oConstraints.descriptionMaxLength){p=parseInt(this.oConstraints.descriptionMaxLength)}if(e&&p&&e.length>p){a.reject(new n(this.getCoreResourceBundleText("EnterTextMaxLength",[p])));return a.promise}d={filterFields:this.getFilterFields(),noRebind:true,success:function(e){if(e.length!==1){a.resolve([null]);return false}return h.call(this,a,e)}.bind(this),error:c.bind(this,a)};l=this.onBeforeValidateValue(e,d);if(l){a.promise.then(l)}return a.promise.then(function(i){if(l&&i&&i[0]){e=i[0]}if(this.oConstraints.keyMaxLength){this.oConstraints.maxLength=parseInt(this.oConstraints.keyMaxLength);p=this.oConstraints.maxLength}e=this._parseKey(e,t);if(e&&p&&e.length>p){return new Promise((e,t)=>{t(new n(this.getResourceBundleText("ENTER_A_VALID_VALUE")))})}return a.promise.then(function(t){var i,r;if(t[0]!==null){return t}else{i=new o;r={filterFields:["keyField"],success:h.bind(this,i),error:c.bind(this,i)};this.onBeforeValidateValue(e,r);return i.promise}}.bind(this))}.bind(this))};l.prototype.validateValue=function(e,t){this.validateIDOnly(e);var i=e[0];if(i===null){return}if(this.oFormatOptions.textArrangement==="descriptionOnly"){this.validateDescriptionOnly(e,this.oSettings);return}if(this.oFormatOptions.textArrangement==="idOnly"&&this.bValueListNoValidation){return}var r=new Promise(function(r,s){function o(t){var n=Object.assign({},this.oSettings,{data:t,reject:s});if(i===""&&Array.isArray(t)&&t.length===0&&this.oConstraints.nullable===false&&!this.bClientSideMandatoryCheck){r(e);return true}var o=this.fnValidator(e,n);if(o){r(e)}return o}function a(e){s(new n(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}var l={filterFields:this.getFilterFields(),success:o.bind(this),error:a.bind(this),bCheckValuesValidity:t};this.onBeforeValidateValue(i,l)}.bind(this));if(this.bValueListNoValidation){return}else{return r}};l.prototype.validateIDOnly=function(e,t){var i=e[0],r,s;this.getPrimaryType().prototype.validateValue.call(this,i);if(this.getSettings().valueList&&t){r=t.data;s=t.reject;this.oSmartField?._addAdditionalInfo("descriptionCount",r.length);if(r.length===0){s(new n(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return false}if(r.length>1){s(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return false}if(!this._validateDeprecationCode(t,e,[],s,t.data)){return false}}return true};l.prototype.validateIDAndDescription=function(e,t){var i={key:t.keyField,value:t.descriptionField,data:t.data};if(this.oFormatOptions&&this.oFormatOptions.displayFormat){i.displayFormat=this.oFormatOptions.displayFormat}var r=u(e[0],i,this.oConstraints);this.oSmartField?._addAdditionalInfo("descriptionCount",r.length);var s=t.reject;if(!this.bValueListNoValidation){if(r.length===0){s(new n(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return false}if(r.length>1){s(new n(this.getResourceBundleText("SMARTFIELD_DUPLICATE_VALUES")));return false}}if(!this._validateDeprecationCode(t,e,r,s,t.data)){return false}return true};l.prototype._validateDeprecationCode=function(e,t,i,r,s){const o=this._getDeprecationCodeField(),a=e.reject||r;if(!o||!this.oSmartField){return true}const l=s[0]?.[o];if(l==="W"){setTimeout(()=>{this.oSmartField.setValueState("Warning");this.oSmartField.setValueStateText(this.getResourceBundleText("DEPRECATED_VALUE"))})}if(l==="E"){if(!this.bValueListNoValidation){this._decorateRevokedValue(t[0],i[0]);a(new n(this.getResourceBundleText("REVOKED_VALUE")));return false}else if(this.bValueListNoValidation){setTimeout(()=>{this.oSmartField.setValueState("Error");this.oSmartField.setValueStateText(this.getResourceBundleText("REVOKED_VALUE"))})}}return true};l.prototype._getDeprecationCodeField=function(){if(!this._sDeprecationCodeField){this._sDeprecationCodeField=this.oSmartField?._oFactory?.getValueHelpProvider()?.oPrimaryValueListAnnotation?.deprecationCodeField}return this._sDeprecationCodeField};l.prototype._decorateRevokedValue=function(e,t){const i=this.oSmartField?._getInnerControlPropertyBinding("edit")?.sInternalType,r=this.formatValue([e,t],i);this.oSmartField?.getFirstInnerControl()?.setValue(r);this._bRevokedValue=true};l.prototype.validateDescriptionOnly=function(e,t){};l.prototype.formatValue=function(e,t){var r;if(!Array.isArray(e)){return e}if(this.bValueListNoValidation&&e[1]===undefined){e.splice(1,1)}r=this.getPrimaryType().prototype.formatValue.call(this,e[0],t);if(r===null&&!(this._isKeyPropertyMissingInModel(e)&&this.oFormatOptions.textArrangement==="descriptionOnly")){return r}if(this.oConstraints.isDigitSequence&&r===""){if(e[0]!==""){r=e[0]}else{return[]}}if(r&&this.oFormatOptions.displayFormat==="UpperCase"){r=r.toUpperCase()}var n=e[1];if(n===""&&this.oFormatOptions.textArrangement!=="idOnly"&&this.oSettings.delegate){this.oSettings.delegate._sTextArrangementLastReadValue=null}if(!n&&this.oFormatOptions.textArrangement==="descriptionOnly"){return r}if(s(n)||this.bIsInvalid){n=""}return i.getFormattedExpressionFromDisplayBehaviour(this.oFormatOptions.textArrangement,r,n)};l.prototype._isKeyPropertyMissingInModel=function(e){return e[0]===undefined&&e[1]!==undefined?true:false};l.prototype.setDescriptionIsInvalid=function(e){this.bIsInvalid=e};l.prototype.getDescriptionIsInvalid=function(){return this.bIsInvalid};l.prototype.destroy=function(){this.oFormatOptions=null;this.oSettings=null;this.fnParser=null;this.fnValidator=null};l.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangement"};l.prototype.onBeforeValidateValue=function(e,t){return this.oSettings.onBeforeValidateValue(e,t)};l.prototype.getResourceBundleText=function(t,i){return e.getResourceBundleFor("sap.ui.comp").getText(t,i)};l.prototype.getCoreResourceBundleText=function(t,i){return e.getResourceBundleFor("sap.ui.core").getText(t,i)};l.prototype.getPrimaryType=function(){};l.prototype.getValidator=function(e){switch(e.textArrangement){case"idAndDescription":case"descriptionAndId":return this[e.prefix+"IDAndDescription"];case"descriptionOnly":return this[e.prefix+"DescriptionOnly"];default:return this[e.prefix+"IDOnly"]}};l.prototype.getFilterFields=function(e){if(this.oFormatOptions&&this.oFormatOptions.textArrangement==="descriptionOnly"){return["descriptionField"]}return["keyField"]};function u(e,t,i){var r=[];if(t.displayFormat==="UpperCase"){e=e.toLowerCase()}t.data.forEach(function(n){let s=n[t.key];if(s&&t.displayFormat==="UpperCase"){s=s.toLowerCase()}const o=i?.isDigitSequence&&i?.maxLength&&e.lastIndexOf(s)!==-1;if(o||s===e){r.push(n[t.value])}});return r}return l});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangementGuid", ["sap/ui/comp/smartfield/type/TextArrangement","sap/ui/comp/smartfield/type/Guid","sap/ui/model/ValidateException","sap/base/assert"],function(t,e,i,r){"use strict";var n=t.extend("sap.ui.comp.smartfield.type.TextArrangementGuid");n.prototype.init=function(){t.prototype.init.apply(this,arguments);if(this.oFormatOptions&&this.oFormatOptions.textArrangement==="descriptionOnly"){this.oValidateExceptionSettings={resourceBundle:"sap.ui.comp",text:"ENTER_AN_EXISTING_DESCRIPTION"}}else{this.oValidateExceptionSettings={resourceBundle:"",text:"EnterGuid"}}};n.prototype.parseDescriptionOnly=function(n,s,p,a,u){var l=e.prototype.parseValue.call(this,n,s);if(o(l)){return new Promise(function(t,e){function n(n){if(n.length===1){this.sDescription=n[0][u.descriptionField];t([l,undefined]);return true}if(n.length===0){e(new i(this.getResourceBundleText("SMARTFIELD_NOT_FOUND")));return false}r(false,"Duplicate GUID. - "+this.getName())}function o(t){e(new i(this.getResourceBundleText("SMARTFIELD_INVALID_ENTRY")))}var s={filterFields:this.getFilterFields(l),success:n.bind(this),error:o.bind(this)};this.onBeforeValidateValue(l,s)}.bind(this))}else{if(typeof n==="string"){n=n.trim()}return t.prototype.parseDescriptionOnly.call(this,n,s,p,a,u)}};n.prototype.getFilterFields=function(t){if(this.oFormatOptions.textArrangement==="descriptionOnly"){if(o(t)){return["keyField"]}return["descriptionField"]}return["keyField","descriptionField"]};n.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangementGuid"};n.prototype.getPrimaryType=function(){return e};n.prototype.formatValue=function(e){var i=t.prototype.formatValue.apply(this,arguments);if(this.oFormatOptions.textArrangement==="descriptionOnly"&&i==="00000000-0000-0000-0000-000000000000"){i=""}return i};function o(t){var e=/^[A-F0-9]{8}-([A-F0-9]{4}-){3}[A-F0-9]{12}$/i;return e.test(t)}return n});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/TextArrangementString", ["sap/ui/comp/smartfield/type/TextArrangement","sap/ui/comp/smartfield/type/StringNullable","sap/ui/model/ValidateException"],function(t,e,r){"use strict";var i=t.extend("sap.ui.comp.smartfield.type.TextArrangementString");i.prototype.getName=function(){return"sap.ui.comp.smartfield.type.TextArrangementString"};i.prototype.validateValue=function(e){var i=this.oConstraints||{},n=i.maxLength,a=e[0],o=!a&&this.oSmartField&&this.oSmartField.getMandatory();if(this.oFormatOptions?.textArrangement==="descriptionOnly"&&(o||a?.length>n)){throw new r(this.getResourceBundleText("ENTER_A_VALID_VALUE"))}return t.prototype.validateValue.apply(this,arguments)};i.prototype.getPrimaryType=function(){return e};return i});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Time", ["sap/ui/model/odata/type/Time"],function(t){"use strict";var o=t.extend("sap.ui.comp.smartfield.type.Time",{constructor:function(o,e){t.apply(this,arguments);this.oFieldControl=null}});o.prototype.parseValue=function(o,e){var i=t.prototype.parseValue.apply(this,arguments);if(typeof this.oFieldControl==="function"){this.oFieldControl(o,e)}return i};o.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this.oFieldControl=null};o.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Time"};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfield/type/Unit", ["sap/ui/core/Lib","sap/ui/model/odata/type/Unit","sap/ui/comp/smartfield/type/Decimal","sap/ui/comp/smartfield/type/Int16","sap/ui/comp/smartfield/type/Int32","sap/ui/comp/smartfield/type/Int64","sap/ui/comp/smartfield/type/Byte","sap/ui/comp/smartfield/type/SByte","sap/ui/comp/smartfield/type/Double","sap/ui/model/ValidateException","sap/ui/comp/smartfield/UoMValidateException"],function(t,i,e,s,n,a,o,r,p,u,m){"use strict";var l=/^([-]?)(\d+)(?:\.(\d+))?$/;var c=i.extend("sap.ui.comp.smartfield.type.Unit",{constructor:function(t,e){t.decimals=e.scale;i.apply(this,[t,{skipDecimalsValidation:e.skipDecimalsValidation}]);this.oConstraints=e;this.sName="Unit"}});c.prototype.parseValue=function(t,e,s){var n=i.prototype.parseValue.apply(this,arguments),a,o,r=Array.isArray(n)&&n[0]&&h(n[0]);if(Array.isArray(r)){a=r[1]+r[2];o=r[3];if(Number.parseInt(o)===0){n[0]=a}}if(n[1]===undefined&&s){n[1]=s[1]}if(n[1]&&this.shouldConvertUnitToUpperCase(n[1])){n[1]=n[1].toUpperCase()}return n};c.prototype.validateValue=function(t){var e,s=t[0],n=t[1],a=s===null,o=this.oFormatOptions&&this.oFormatOptions.customUnits;if(o&&n&&Object.keys(o).indexOf(n)===-1){throw new m(f("UNIT_VALIDATION_FAILS",[n]))}i.prototype.validateValue.apply(this,arguments);if(this.oConstraints.nullable&&(a||s===this.oFormatOptions.emptyString)){return}e=h(s);if(e===null){throw new u(d("EnterNumber"))}if(this.oConstraints&&!this.oConstraints.scale&&this.oConstraints.skipDecimalsValidation){return}y.call(this,this.oConstraints.type,s);var r=parseInt(e[2]),p,l=this.oConstraints&&this.oConstraints.scale,c=l,C=r===0?0:e[2].length,w=(e[3]||"").length,b=this.oConstraints&&this.oConstraints.precision,U=typeof b==="number"?b:Infinity,I=this.mCustomUnits&&this.mCustomUnits[n]&&this.mCustomUnits[n].decimals;if((I||I===0)&&!this.oConstraints.skipDecimalsValidation){c=I}if(this.oConstraints&&this.oConstraints.variableScale){p=Math.min(U,c);l=p}else{p=Math.min(l||0,c)}if(p>U){p=U}if(w>p){if(p===0){throw new u(d("EnterInt"))}if(C+p>U){throw new u(d("EnterNumberIntegerFraction",[U-p,p]))}throw new u(d("EnterNumberFraction",[p]))}if(C>U-l){throw new u(d("EnterNumberInteger",[U-l]))}};function h(t){return l.exec(t)}function d(i,e){return t.getResourceBundleFor("sap.ui.core").getText(i,e)}function f(i,e){return t.getResourceBundleFor("sap.ui.comp").getText(i,e)}function y(t,i){if(t){var u;switch(t){case"Edm.Double":u=new p({},this.oConstraints);break;case"Edm.Decimal":u=new e({},this.oConstraints);break;case"Edm.Int16":u=new s({},this.oConstraints);break;case"Edm.Int32":u=new n({},this.oConstraints);break;case"Edm.Int64":u=new a({},this.oConstraints);break;case"Edm.Byte":u=new o({},this.oConstraints);break;case"Edm.SByte":u=new r({},this.oConstraints);break}u.validateValue(i)}}c.prototype.shouldConvertUnitToUpperCase=function(t){return this.mCustomUnits&&!this.mCustomUnits[t]&&this.mCustomUnits[t.toUpperCase()]};c.prototype.getName=function(){return"sap.ui.comp.smartfield.type.Unit"};return c});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/AdditionalConfigurationHelper", ["sap/ui/comp/library"],function(e){"use strict";var t=function(e,t){this.controlConfiguration=[];this.groupConfiguration=[];this._initialize(e,t)};t.prototype._initialize=function(t,i){var n,o,a,r,l,g,u,p,s,d;if(!t){t=[]}if(!i){i=[]}o=t.length;for(n=0;n<o;n++){r=t[n];l={};l.key=r.getKey&&r.getKey();l.groupId=r.getGroupId&&r.getGroupId();l.index=r.getIndex&&r.getIndex();l.label=r.getLabel&&r.getLabel();l.isVisible=r.getVisible&&r.getVisible();l.mandatory=r.getMandatory&&r.getMandatory();l.width=r.getWidth&&r.getWidth();l.hasValueHelpDialog=r.getHasValueHelpDialog&&r.getHasValueHelpDialog();l.hasValidation=r.getHasValidation&&r.getHasValidation();l.hasTypeAhead=r.getHasTypeAhead&&r.getHasTypeAhead();l.controlType=r.getControlType&&r.getControlType();l.filterType=r.getFilterType&&r.getFilterType();l.customControl=r.getCustomControl&&r.getCustomControl();l.visibleInAdvancedArea=r.getVisibleInAdvancedArea&&r.getVisibleInAdvancedArea();l.preventInitialDataFetchInValueHelpDialog=r.getPreventInitialDataFetchInValueHelpDialog&&r.getPreventInitialDataFetchInValueHelpDialog();l.isSetPreventInitialDataFetchInValueHelpDialog=r.isPropertyInitial&&r.isPropertyInitial("preventInitialDataFetchInValueHelpDialog");l.displayBehaviour=r.getDisplayBehaviour&&r.getDisplayBehaviour();l.defaultFilterValues=[];l.conditionType=r.getConditionType&&r.getConditionType();l.historyEnabled=r.getHistoryEnabled&&r.getHistoryEnabled();l.historyEnabledInitial=r.isPropertyInitial&&r.isPropertyInitial("historyEnabled");l.conditionPanelDefaultOperation=r.isPropertyInitial&&r.getConditionPanelDefaultOperation&&!r.isPropertyInitial("conditionPanelDefaultOperation")&&e.valuehelpdialog.ValueHelpRangeOperation[r.getConditionPanelDefaultOperation()]?r.getConditionPanelDefaultOperation():null;l.timezone=r.getTimezone&&r.getTimezone();g=r.getDefaultFilterValues&&r.getDefaultFilterValues();if(g&&g.length){s=g.length;for(p=0;p<s;p++){u=g[p];d={};d.sign=u.getSign();d.operator=u.getOperator();d.low=u.getLow();d.high=u.getHigh();l.defaultFilterValues.push(d)}}this.controlConfiguration.push(l)}o=i.length;for(n=0;n<o;n++){a=i[n];l={key:a.getKey(),index:a.getIndex(),label:a.getLabel()};this.groupConfiguration.push(l)}};t.prototype.getControlConfigurationByKey=function(e){var t,i;i=this.controlConfiguration.length;for(t=0;t<i;t++){if(this.controlConfiguration[t].key===e){return this.controlConfiguration[t]}}return undefined};t.prototype.getControlConfiguration=function(){return this.controlConfiguration};t.prototype.getGroupConfiguration=function(){return this.groupConfiguration};t.prototype.getGroupConfigurationByKey=function(e){var t,i;i=this.groupConfiguration.length;for(t=0;t<i;t++){if(this.groupConfiguration[t].key===e){return this.groupConfiguration[t]}}return undefined};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/ControlConfiguration", ["sap/ui/comp/library","sap/ui/comp/config/ControlConfigurationBase"],function(e,t){"use strict";var a=t.extend("sap.ui.comp.smartfilterbar.ControlConfiguration",{metadata:{library:"sap.ui.comp",properties:{groupId:{type:"string",group:"Misc",defaultValue:null},label:{type:"string",group:"Misc",defaultValue:null},visible:{type:"boolean",group:"Misc",defaultValue:true},hasValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:true},hasValidation:{type:"boolean",group:"Misc",defaultValue:true},controlType:{type:"sap.ui.comp.smartfilterbar.ControlType",group:"Misc",defaultValue:"auto"},filterType:{type:"sap.ui.comp.smartfilterbar.FilterType",group:"Misc",defaultValue:"auto"},index:{type:"int",group:"Misc",defaultValue:-1},hasTypeAhead:{type:"boolean",group:"Misc",defaultValue:true},mandatory:{type:"sap.ui.comp.smartfilterbar.MandatoryType",group:"Misc",defaultValue:"auto"},width:{type:"string",group:"Misc",defaultValue:null},visibleInAdvancedArea:{type:"boolean",group:"Misc",defaultValue:false},preventInitialDataFetchInValueHelpDialog:{type:"boolean",group:"Misc",defaultValue:false},displayBehaviour:{type:"sap.ui.comp.smartfilterbar.DisplayBehaviour",group:"Misc",defaultValue:"auto"},historyEnabled:{type:"boolean",group:"Misc",defaultValue:true},conditionPanelDefaultOperation:{type:"sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation",group:"Misc",defaultValue:null},timezone:{type:"string",group:"Misc",defaultValue:null}},aggregations:{defaultFilterValues:{type:"sap.ui.comp.smartfilterbar.SelectOption",multiple:true,singularName:"defaultFilterValue"},customControl:{type:"sap.ui.core.Control",multiple:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});a.prototype.setVisible=function(e){this.setProperty("visible",e);this.fireChange({propertyName:"visible"});return this};a.prototype.setLabel=function(e){this.setProperty("label",e);this.fireChange({propertyName:"label"});return this};a.prototype.setVisibleInAdvancedArea=function(e){this.setProperty("visibleInAdvancedArea",e);this.fireChange({propertyName:"visibleInAdvancedArea"});return this};a.FILTERTYPE=e.smartfilterbar.FilterType;a.CONTROLTYPE=e.smartfilterbar.ControlType;a.MANDATORY=e.smartfilterbar.MandatoryType;a.DISPLAYBEHAVIOUR=e.smartfilterbar.DisplayBehaviour;return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/FilterProvider", ["sap/ui/core/Lib","sap/ui/core/date/UI5Date","sap/ui/comp/util/DateTimeUtil","sap/m/DateTimePicker","sap/m/Select","sap/ui/core/Item","sap/ui/comp/odata/ComboBox","sap/m/DatePicker","sap/m/DateRangeSelection","sap/m/TimePicker","sap/m/Input","sap/ui/comp/smartfilterbar/SFBMultiComboBox","sap/ui/comp/smartfilterbar/SFBMultiInput","sap/ui/comp/smartfilterbar/SortingUtil","sap/ui/comp/smartfilterbar/SFBSearchField","sap/m/Token","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/providers/ValueListProvider","sap/ui/model/json/JSONModel","sap/ui/comp/odata/ODataType","sap/ui/comp/util/FormatUtil","sap/ui/base/EventProvider","sap/ui/comp/util/IdentifierUtil","sap/ui/comp/providers/TokenParser","sap/ui/core/format/DateFormat","sap/ui/comp/library","sap/ui/core/library","sap/ui/model/analytics/odata4analytics","sap/ui/model/FilterOperator","sap/base/Log","sap/base/security/encodeURL","sap/base/util/merge","sap/ui/comp/smartfilterbar/FilterProviderUtils","sap/ui/comp/filterbar/VariantConverterFrom","sap/ui/comp/odata/CalendarMetadata"],function(e,t,i,a,n,r,o,s,l,d,u,f,h,p,c,m,_,g,y,F,D,T,v,C,S,V,A,M,P,I,E,N,B,b,x,w,R){"use strict";var O=M.smartfilterbar.ControlType;var L=M.smartfilterbar.DisplayBehaviour;var k=M.smartfilterbar.FilterType;var H=P.ValueState;var U=M.smartfilterbar.MandatoryType;var W=function(e){this._bInitialized=false;this._bPending=true;this._bConsiderAnalyticalParameters=false;this._bAttachInitializedDone=false;this.aFilterAnnotations=[];var t;if(e){this._sSmartContainerId=e.smartContainerId;this._sContext=e.context;this._oParentODataModel=e.model;this._sServiceURL=e.serviceUrl;this._sBasicSearchFieldName=e.basicSearchFieldName;this._isBasicSearchEnabled=e.enableBasicSearch;this._bUseContainsAsDefault=e.useContainsAsDefaultFilter==="true";this.sEntityType=e.entityType;this.sEntitySet=e.entitySet;this._isRunningInValueHelpDialog=e.isRunningInValueHelpDialog;this._oAdditionalConfiguration=e.additionalConfiguration;this.sDefaultDropDownDisplayBehaviour=e.defaultDropDownDisplayBehaviour;this.sDefaultTokenDisplayBehaviour=e.defaultTokenDisplayBehaviour;this.mDefaultFilterBarExpanded=e.defaultFilterBarExpanded;this.mDefaultShowAllFilters=e.defaultShowAllFilters;this.bShowSelectAll=e.showSelectAll==="true";this.sDefaultSingleFieldDisplayBehaviour=e.defaultSingleFieldDisplayBehaviour;if(typeof e.dateFormatSettings==="string"){try{this._oDateFormatSettings=e.dateFormatSettings?JSON.parse(e.dateFormatSettings):undefined}catch(e){}}else{this._oDateFormatSettings=e.dateFormatSettings}if(!this._oDateFormatSettings){this._oDateFormatSettings={}}if(!this._oDateFormatSettings.hasOwnProperty("UTC")){this._oDateFormatSettings["UTC"]=true}if(typeof e.calendarWeekSettings==="string"){this._oCalendarWeekSettings=e.calendarWeekSettings?e.calendarWeekSettings:undefined}if(!this._oCalendarWeekSettings){this._oCalendarWeekSettings=undefined}t=e.showCurrentDateButton;if(typeof t==="string"){this._oShowCurrentDateButton=t&&t==="true"?t&&true:undefined}if(typeof t==="boolean"){this._oShowCurrentDateButton=t}if(!this._oShowCurrentDateButton){this._oShowCurrentDateButton=undefined}this._oSmartTable=e.smartTable;this._oSmartFilter=e.smartFilter;this.filterBarClass=e.filterBarClass;this._bConsiderAnalyticalParameters=e.considerAnalyticalParameters;this._bUseDateRangeType=e.useDateRangeType;this._bConsiderSelectionVariants=e.considerSelectionVariants;this._aConsiderNavigations=e.considerNavigations;this._bSuppressValueListsAssociation=e.suppressValueListsAssociation;this._aConstParams=this._getConstParams();this._aSignificantParams=this._getSignificantParams()}this.sFilterModelName=x.FILTER_MODEL_NAME;this._sBasicFilterAreaID=x.BASIC_FILTER_AREA_ID;this._aAnalyticalParameters=[];this._aFilterBarViewMetadata=[];this._oFilterBarViewMetadataExtend={};this._aFilterBarFieldNames=[];this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarSingleValueWithValueListFieldMetadata=[];this._aFilterBarDropdownFieldMetadata=[];this._aFilterBarStringDateFieldNames=[];this._aFilterBarDateFieldNames=[];this._aFilterBarTimeFieldNames=[];this._aFilterBarTimeIntervalFieldNames=[];this._aFilterBarDateTimeMultiValueFieldNames=[];this._aFilterBarStringFieldNames=[];this._aFilterBarDateTimeFieldNames=[];this._aFilterBarDateTimeOffsetWithTimezoneFieldNames=[];this._aFilterBarNumericFieldMetadata=[];this._sSingleInputsTextArrangementData={};this._sInputsWithCompositeKeysData={};this._oNotValidatedSingleFields={};this._oSingleFieldSetFromFilterData={};this._aFieldGroupAnnotation=[];this._oMetadataAnalyser=new _(this._oParentODataModel||this._sServiceURL);this.oModel=new D;this._aValueListProvider=[];this._aValueHelpDialogProvider=[];this._mTokenHandler={};this._mConditionTypeFields={};this._aSelectionVariants=[];this._oParameterization=null;this._oNonAnaParameterization=null;this._aPromises=[]};W._reduceRangesForParameters=function(e){if(e.ranges&&e.ranges.length>1){var t=e.ranges.find(function(e){return e.semantic!==undefined});if(t){e.ranges=[t]}if(e.ranges.length>1){e.ranges=[e.ranges[0]]}}};W.prototype._getConstParams=function(){return this._oSmartFilter&&this._oSmartFilter.data&&this._oSmartFilter.data("hiddenFields")||null};W.prototype._getSignificantParams=function(){return this._oSmartFilter&&this._oSmartFilter.data&&this._oSmartFilter.data("significantFields")||null};W._createFilterProvider=function(e){var t=new W(e);return t._intialiseMetadata()};W.prototype._addLineItemNavigationFields=function(e,t){var i=this._oSmartTable._oTableProvider,a,n,r,o;if(i._aODataFieldMetadata&&i._oLineItemAnnotation){a=i._oLineItemAnnotation.fields;if(a){n=a.length}while(n--){r=a[n];if(r&&r.indexOf("/")>=0){o=i._oMetadataAnalyser.extractNavigationPropertyField(r,i.sEntitySet);if(o){if(o.description){o.description=o.parentPropertyName+"/"+o.description}if(o.unit){o.unit=o.parentPropertyName+"/"+o.unit}this._aFilterBarViewMetadata[0].fields.push(o);t[0].fields.push(o)}}}}};W.prototype._intialiseMetadata=function(){var e,t,i,a,n,r,o,s,l,d,u,f,h;this._aPromises=[];this._aFilterBarViewMetadata.push({groupName:this._sBasicFilterAreaID,index:0,fields:[]});if(!this.sEntitySet&&this.sEntityType){(function(){this.sEntitySet=this._oMetadataAnalyser.getEntitySetNameFromEntityTypeName(this.sEntityType)}).bind(this)()}this.sEntityType=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);r=this._oMetadataAnalyser.getAllFilterableFieldsByEntitySetName(this.sEntitySet,this._bConsiderAnalyticalParameters,this._aConsiderNavigations);this.aAllFields=this._oMetadataAnalyser.getFieldsByEntitySetName(this.sEntitySet);if(this._sContext==="mdcFilterPanel"&&this._oSmartTable&&!this._oSmartTable._isAnalyticalTable){var p=this._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.sEntitySet);this._addLineItemNavigationFields(p,r)}if(r){this._updateDisplayBehaviour();this._aFieldGroupAnnotation=this._oMetadataAnalyser.getFieldGroupsByFilterFacetsAnnotation(this.sEntityType);a=this._oMetadataAnalyser.getSelectionFieldsAnnotation(this.sEntityType);if(a&&a.selectionFields){this._aSelectionFields=a.selectionFields}if(this._aFieldGroupAnnotation){e=this._aFieldGroupAnnotation.length;for(o=0;o<e;o++){n=this._aFieldGroupAnnotation[o];u=this._createGroupMetadata(n);u.index=this._aFilterBarViewMetadata.length;this._aFilterBarViewMetadata.push(u)}}e=r.length;for(o=0;o<e;o++){n=r[o];t=n.fields.length;u=this._createGroupMetadata(n);this._aFilterBarViewMetadata.push(u);for(s=0;s<t;s++){l=n.fields[s];if(l.type.indexOf("Edm.")===0){d=this._createFieldMetadata(l);u.fields.push(d);this._aFilterBarFieldNames.push(d.fieldName)}}i=n.hiddenFields&&n.hiddenFields.length;if(this._isRunningInValueHelpDialog&&i){for(s=0;s<i;s++){l=n.hiddenFields[s];if(l.type.indexOf("Edm.")===0){d=this._createFieldMetadata(l);u.hiddenFields.push(d)}}}}}h=this._getAdditionalConfigurationForCustomGroups(r);e=h.length;for(s=0;s<e;s++){u=this._createGroupMetadataForCustomGroup(h[s]);if(u){this._aFilterBarViewMetadata.push(u)}}f=this._getAdditionalConfigurationForCustomFilterFields();t=f.length;for(s=0;s<t;s++){d=this._createFieldMetadataForCustomFilterFields(f[s]);if(d){this._aFilterBarViewMetadata[0].fields.push(d)}}if(this._hasBasicSearch()){d=this._createBasicSearchFieldMetadata();this._aFilterBarViewMetadata[0].fields.push(d)}if(this._bConsiderAnalyticalParameters||!this._isRunningInValueHelpDialog){this._createParameters()}return new Promise(function(e){Promise.all(this._aPromises).then(function(){if(this._bConsiderSelectionVariants){this._createSelectionVariants()}this._applyGroupId();this._applyIndexes();this._createInitialModel(true);this._initializeConditionTypeFields();this.setPending(this.isPending());this._bInitialized=true;e(this)}.bind(this))}.bind(this))};W.prototype._createSelectionVariants=function(){this._aSelectionVariants=this._oMetadataAnalyser.getSelectionVariantAnnotationList(this.sEntityType)};W.prototype._createParameters=function(){if(this._oMetadataAnalyser.isSemanticAggregation(this.sEntityType)){if(this._bConsiderAnalyticalParameters){var e=sap.ui.require("sap/ui/model/analytics/odata4analytics");if(e){this._createAnalyticalParameters(e)}else{var t=new Promise(function(e){sap.ui.require(["sap/ui/model/analytics/odata4analytics"],function(t){this._createAnalyticalParameters(t);e()}.bind(this))}.bind(this));this._aPromises.push(t)}}}else{this._createNonAnalyticalParameters()}};W.prototype._createAnalyticalParameters=function(e){this._oParameterization=this._getAnalyticParameterization(e);this._createAnalyticParameters(this._oParameterization)};W.prototype._getAnalyticParameterization=function(e){var t,i;try{t=new e.Model(new e.Model.ReferenceByModel(this._oParentODataModel))}catch(e){throw"Failed to instantiate analytical extensions for given OData model: "+e.message}i=t&&t.findQueryResultByName(this.sEntitySet);return i&&i.getParameterization()};W.prototype._createNonAnalyticalParameters=function(){if(this.sEntitySet){this._oNonAnaParameterization=this._oMetadataAnalyser.getParametersByEntitySetName(this.sEntitySet);if(this._oNonAnaParameterization){this._createParametersByEntitySetName(this._oNonAnaParameterization.entitySetName,this._oNonAnaParameterization.parameters)}}};W.prototype.attachPendingChange=function(e){this._attachEvent("PendingChange",e)};W.prototype.detachPendingChange=function(e){this._detachEvent("PendingChange",e)};W.prototype.setPending=function(e){var t=this._bPending!==e;this._bPending=e;if(t){var i={};i.pending=e;this._fireEvent("PendingChange",i)}};W.prototype.isPending=function(){if(!this._bInitialized){return true}for(var e in this._mConditionTypeFields){if(this._mConditionTypeFields[e].conditionType.isPending()){return true}}return false};W.prototype._updateDisplayBehaviour=function(){this._sTextArrangementDisplayBehaviour=this._oMetadataAnalyser.getTextArrangementValue(this.sEntityType);if(!this.sDefaultDropDownDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultDropDownDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultDropDownDisplayBehaviour=L.descriptionAndId}}if(!this.sDefaultTokenDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultTokenDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultTokenDisplayBehaviour=L.descriptionAndId}}if(!this.sDefaultSingleFieldDisplayBehaviour){if(this._sTextArrangementDisplayBehaviour){this.sDefaultSingleFieldDisplayBehaviour=this._sTextArrangementDisplayBehaviour}else{this.sDefaultSingleFieldDisplayBehaviour=L.descriptionAndId}}};W.prototype._hasBasicSearch=function(){return this._isBasicSearchEnabled};W.prototype._getAdditionalConfigurationForCustomFilterFields=function(){var e,t,i,a;if(!this._oAdditionalConfiguration){return[]}e=this._oAdditionalConfiguration.getControlConfiguration();if(!this._aFilterBarFieldNames||!this._aFilterBarFieldNames.length){return e}a=[];t=e.length;for(i=0;i<t;i++){if(this._aFilterBarFieldNames.indexOf(e[i].key)<0){a.push(e[i])}}return a};W.prototype._getAdditionalConfigurationForCustomGroups=function(e){var t,i,a,n,r,o,s,l;if(!this._oAdditionalConfiguration){return[]}t=this._oAdditionalConfiguration.getGroupConfiguration();if(!e||!e.length){return t}r=[];a=e.length;i=t.length;for(n=0;n<i;n++){s=false;for(o=0;o<a;o++){l=e[o].groupName||e[o].groupEntitySetName;if(l===t[n].key){s=true;break}}if(!s){r.push(t[n])}}return r};W.prototype._createInitialModelForField=function(e,i,a){var n=false,r,o,s=false,l=false,d=null,u=null,f,h=null,p=[],c=[];if(!i||i.isCustomFilterField){return}if(i.filterRestriction!==k.multiple){l=true}if((i.filterType==="date"||i.filterType==="time"||i.filterType==="datetime")&&!i.isFiscalDate&&!i.isCalendarType){n=true}if(a){r=i.defaultFilterValues;s=r&&r.length;if(!s){if(i.defaultPropertyValue&&i.isParameter){o=i.defaultPropertyValue;if(i.filterType==="numeric"){o=this._getType(i).parseValue(o,"string")}r=[{low:o}];s=true}else if(i.defaultFilterValue){o=i.defaultFilterValue;r=[{low:o,high:o,operator:"EQ",sign:"I"}];s=true}}}var m=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(i.fieldName):null;if(i.hasFixedValues||m&&m.controlType===O.dropDownList){this._aFilterBarDropdownFieldMetadata.push(i)}if(i.filterRestriction===k.single&&!this._isSingleDynamicDateEnabled(i)){if(s){o=r[0];d=n?this._createDateTimeValue(i,o.low):o.low}if(i.type==="Edm.String"&&i.hasValueListAnnotation&&!i.hasFixedValues&&i.controlType!=="dropDownList"){this._aFilterBarSingleValueWithValueListFieldMetadata.push(i);if(!s&&i.control){i.control.setValue("")}}e[i.fieldName]=d}else if(i.filterRestriction===k.interval&&i.type!=="Edm.Time"){if(s){o=r[0];d=n?this._createDateTimeValue(i,o.low):o.low;u=n?this._createDateTimeValue(i,o.high):o.high}e[i.fieldName]={low:d,high:u}}else{if(s){f=r.length;while(f--){o=r[f];if(l){h={exclude:o.sign==="E",operation:o.operator==="CP"?"Contains":o.operator,keyField:i.fieldName,value1:n?this._createDateTimeValue(i,o.low):o.low,value2:n?null:o.high};if(i.filterType==="time"&&o.high){h.value2=t.getInstance(o.high)}}else{h={key:n?this._createDateTimeValue(i,o.low):o.low,text:n?"":o.low}}p.push(h)}}this._aFilterBarMultiValueFieldMetadata.push(i);e[i.fieldName]={value:null};if(l){c=p.slice(0);p=[];e[i.fieldName].ranges=c}e[i.fieldName].items=p;this._updateMultiValueControl(i.control,p,c)}};W.prototype._createDateTimeValue=function(e,i){switch(e.type){case"Edm.Time":if(i.indexOf("PT")===0){return this._getTime(i)}else{N.error("Default value for "+e.fieldName+" could not be parsed.")}break;case"Edm.DateTime":if(typeof i=="string"&&e.displayFormat&&e.displayFormat.toLowerCase()=="date"){var a=i.split("T");i=a[0]+"T00:00:00";return t.getInstance(i)}else{N.error("Default value for "+e.fieldName+" could not be parsed.")}break;case"Edm.DateTimeOffset":return t.getInstance(i);default:N.error("Default value for "+e.fieldName+" could not be parsed.")}};W.prototype._createInitialModel=function(e){var t,i,a,n,r,o,s,l;t={};this._bCreatingInitialModel=true;this._aFilterBarMultiValueFieldMetadata=[];this._aFilterBarSingleValueWithValueListFieldMetadata=[];this._aFilterBarDropdownFieldMetadata=[];if(this._aFilterBarViewMetadata){i=this._aFilterBarViewMetadata.length;for(s=0;s<i;s++){r=this._aFilterBarViewMetadata[s];a=r.fields.length;for(o=0;o<a;o++){this._createInitialModelForField(t,r.fields[o],e)}n=r.hiddenFields&&r.hiddenFields.length;if(this._isRunningInValueHelpDialog&&n){for(o=0;o<n;o++){this._createInitialModelForField(t,r.hiddenFields[o],e)}}}}if(this._aCustomFieldMetadata){for(l=0;l<this._aCustomFieldMetadata.length;l++){this._createInitialModelForField(t,this._aCustomFieldMetadata[l],false)}}if(this._aAnalyticalParameters){a=this._aAnalyticalParameters.length;for(o=0;o<a;o++){this._createInitialModelForField(t,this._aAnalyticalParameters[o],e)}}this.oModel&&this.oModel.setData(t);if(!e){this._clearConditionTypeFields()}this._updateConditionTypeFields();this._bCreatingInitialModel=false};W.prototype._setTokenTooltip=function(e,t){if(!e||!t){return}if(typeof t!=="string"){try{t=t.toString()}catch(e){}}e.setTooltip(t)};W.prototype._updateMultiValueControl=function(e,t,a,n,r){var o=0,s=null,l=null,d=null,u=null,p=null,c,_,g,y;if(e&&t){o=t.length;if(e instanceof h){s=[];while(o--){const i=new m,a=Object.keys(this._getInputsWithCompositeKeysData()),r=t[o],l=r.text||r.key,d=n?.name;if(a?.includes(d)){const e=this._getInputsWithCompositeKeysData(d);e.forEach(e=>{if(e.key===r.key&&r.text?.includes(e.text)){i.data("compositeKey",e.compositeKey)}})}i.setKey(t[o].key);i.setText(l);this._setTokenTooltip(i,l);if(e.getMetadata()&&e.getMetadata()?.getName()==="sap.ui.comp.smartfilterbar.SFBMultiInput"){i.getTextForCopy=e._getTextForCopy.bind(e,i)}s.push(i)}if(a){o=a.length;while(o--){d=a[o];if((d.value1===""||d.value1===null)&&d.operation===E.EQ){y=w.convertOption(d.operation,d.value1);d.operation=y.op;d.tokenText=v.getFormattedRangeText(d.operation,null,null,d.exclude);d.value1=y.v}if(d.tokenText){u=d.tokenText}else{c=d.value1;_=d.value2;if(n){var F=true;var D=["date","datetime","time"];if(D.indexOf(n.filterType)>-1){g=this._getType(n);if(g){if(c){if(n.filterType==="time"){c=i.dateToEdmTime(i.localToUtc(c))}c=g.formatValue(c,"string",F)}if(_){if(n.filterType==="time"){_=i.dateToEdmTime(i.localToUtc(_))}_=g.formatValue(_,"string",F)}}}else if(n.filterType==="numeric"){g=this._getType(n);if(g){if(c!==""&&c!==undefined){if(typeof c==="string"&&!isNaN(c)){c=parseFloat(c);d.value1=c}c=g.formatValue(c,"string")}if(_!==""&&_!==undefined){if(typeof _==="string"&&!isNaN(_)){_=parseFloat(_);d.value2=_}_=g.formatValue(_,"string")}}}else if(n.filterType==="boolean"){g=this._getType(n);if(g){if(c!==""&&c!==undefined&&c==="false"){c=g.formatValue(false,"string")}else{c=g.formatValue(c,"string")}if(_!==""&&_!==undefined&&_==="false"){_=g.formatValue(false,"string")}else{_=g.formatValue(c,"string")}}}else{var T=n.isCalendarDate||n.isFiscalDate||n.isCalendarType||(c instanceof Date||_ instanceof Date);if(T){g=this._getType(n);if(c){c=g.formatValue(c,"string")}if(_){_=g.formatValue(_,"string")}}}}u=v.getFormattedRangeText(d.operation,c,_,d.exclude)}l=new m;l.setText(u);this._setTokenTooltip(l,u);l.data("range",d);s.push(l)}}e.setTokens(s);e.fireTokenUpdate()}else if(e instanceof f){p=[];if(t.length>0){while(o--){p.push(t[o].key)}}else if(r){p.push(r)}e.setSelectedKeys(p)}}};W.prototype._updateSingleValueControl=function(e){var t=e.control,i=e.fieldName,a=e.displayBehaviour||this.sDefaultSingleFieldDisplayBehaviour,n=this.oModel.getData(),r=n[i],o=r,s=this._getSingleInputsTextArrangementData(i);if(s&&s.key===r&&s.key!==s.text){o=v.getFormattedExpressionFromDisplayBehaviour(a,s.key,s.text);delete this._oNotValidatedSingleFields[i]}var l=this._aValueListProvider.find(function(e){return e.sFieldName===i});t.setValue(o);if(r&&r===o){this._oSingleFieldSetFromFilterData[i]=true;if(l&&l.bInitialised){l._fetchSingleFieldDescription(r);delete this._oNotValidatedSingleFields[i]}else{this._oNotValidatedSingleFields[i]=r}}if(s&&l&&r!==o){l&&l._abortPendingValidations()}};W.prototype._applyIndexes=function(){if(!this._aFilterBarViewMetadata){return}this._aFilterBarViewMetadata=p.groupSorting(this._aFilterBarViewMetadata)};W.prototype._applyGroupId=function(){var e=Array.isArray(this._aFilterBarViewMetadata)?this._aFilterBarViewMetadata.length:0,t,i,a,n,r,o;for(n=0;n<e;n++){if(!this._aFilterBarViewMetadata[n].fields){continue}t=this._aFilterBarViewMetadata[n].fields.length;for(r=0;r<t;r++){a=this._aFilterBarViewMetadata[n].fields[r];if(a&&a.groupId&&a.groupId!==this._aFilterBarViewMetadata[n].groupName){i=undefined;for(o=0;o<e;o++){if(this._aFilterBarViewMetadata[o].groupName===a.groupId){i=this._aFilterBarViewMetadata[o];break}}if(i){this._aFilterBarViewMetadata[n].fields.splice(r,1);r--;t--;i.fields=i.fields||[];i.fields.push(a)}}}}};W.prototype._createFilterControlId=function(e){var t=this._oSmartFilter?this._oSmartFilter.getId():"FilterPanel";var i=S.replace(e.groupId||"");var a=S.replace(e.fieldName);var n=e.customColumnKey&&S.replace(e.customColumnKey);if(n){a+=n}if(this._sSmartContainerId){a=this._sSmartContainerId+"-"+a}return t+"-filterItemControl"+i+"-"+a};W.prototype._createGroupMetadata=function(e){var t,i=null,a;a=e.groupName||e.groupEntitySetName;if(this._oAdditionalConfiguration){i=this._oAdditionalConfiguration.getGroupConfigurationByKey(a)}t={};t.groupName=a;t.groupLabel=this._getGroupLabel(e,i);t.fields=[];t.hiddenFields=[];t.index=this._getGroupIndex(i);return t};W.prototype._createGroupMetadataForCustomGroup=function(e){var t;t={};t.groupName=e.key;t.groupLabel=e.label;t.fields=[];t.index=this._getGroupIndex(e);return t};W.prototype._getTime=function(e){var t=A.getTimeInstance({pattern:"'PT'hh'H'mm'M'ss'S'"});return t.parse(e)};W.prototype._checkMetadataDefaultValue=function(e){var t=e.defaultFilterValue||e.defaultPropertyValue;if(t){try{if(e.type==="Edm.Time"&&t.indexOf("PT")===0){this._getTime(t)}else{this._getType(e)}}catch(t){e.defaultPropertyValue=null;e.defaultFilterValue=null;N.error("default value for "+e.fieldName+" could not be parsed.")}}};W.prototype._getType=function(e){var t,i={},a={},n={};if(e.ui5Type){return e.ui5Type}if(e.precision||e.scale){a.precision=e.precision;a.scale=e.scale}if(e.maxLength){a.maxLength=e.maxLength}if(e.displayFormat){a.displayFormat=e.displayFormat}if(e.isDigitSequence&&!e.isFiscalDate&&!e.fiscalType){a.isDigitSequence=e.isDigitSequence}if(e.isCalendarDate){n.isCalendarDate=true}if(e.isCalendarType&&!e.isCalendarDate){n.isCalendarType=true;n.calendarType=e.calendarType}if(e.isFiscalDate&&e.fiscalType){n.isFiscalDate=true;n.fiscalType=e.fiscalType}if(e.filterType==="date"||e.filterType==="time"||e.filterType==="datetime"||e.isCalendarDate){i=Object.assign({},this._oDateFormatSettings,{UTC:false})}t=T.getType(e.type,i,a,n);return t};W.prototype._setControlDisplayFormat=function(e,t){var i;if(!t){return}i=t.style||t.pattern;if(!i){return}e.setDisplayFormat(i)};W.prototype._setControlCalendarWeekSetting=function(e,t){if(!t){return}if(typeof e.setCalendarWeekNumbering==="function"){e.setCalendarWeekNumbering(t)}};W.prototype._setShowCurrentDateButton=function(e,t){if(!t){return}if(typeof e.setShowCurrentDateButton==="function"){e.setShowCurrentDateButton(t)}};W.prototype._createControl=function(t){var i,p,c=false,m,_,g=t.type!=="Edm.String"||t.isFiscalDate||t.isCalendarType||t.isDigitSequence;if(t.customControl){if(t["com.sap.vocabularies.Common.v1.DocumentationRef"]&&!t.customControl.data("sap-ui-DocumentationRef")){this._setControlDocumentationRef(t.customControl,t["com.sap.vocabularies.Common.v1.DocumentationRef"])}return t.customControl}p=this._getType(t);i=new t.fControlConstructor(this._createFilterControlId(t));i._oFieldViewMetadata=t;if(i._oFieldViewMetadata["com.sap.vocabularies.Common.v1.DocumentationRef"]){this._setControlDocumentationRef(i,i._oFieldViewMetadata["com.sap.vocabularies.Common.v1.DocumentationRef"])}if(t.fControlConstructor===l){this._setControlDisplayFormat(i,this._oDateFormatSettings);this._setControlCalendarWeekSetting(i,this._oCalendarWeekSettings);this._setShowCurrentDateButton(i,this._oShowCurrentDateButton);if(t.isCalendarDate){i.bindProperty("dateValue",{path:this.sFilterModelName+">/"+t.fieldName+"/low",type:p});i.bindProperty("secondDateValue",{path:this.sFilterModelName+">/"+t.fieldName+"/high",type:p})}else{i.bindProperty("dateValue",this.sFilterModelName+">/"+t.fieldName+"/low");i.bindProperty("secondDateValue",this.sFilterModelName+">/"+t.fieldName+"/high")}}else if(t.fControlConstructor===o||t.fControlConstructor===n){if(i.setForceSelection){i.setForceSelection(true)}if(t.fControlConstructor===n){if(!this.oResourceBundle){this.oResourceBundle=e.getResourceBundleFor("sap.ui.comp")}i.addItem(new r({key:"",text:this.oResourceBundle.getText("NO_BOOLEAN_VALUE_SELECTED")}));i.addItem(new r({key:false,text:p.formatValue(false,"string")}));i.addItem(new r({key:true,text:p.formatValue(true,"string")}))}else{this._associateValueList(i,"items",t,false,this._getSuppressValueListsAssociation());i.attachSelectionChange(function(){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}i.fireChange({filterChangeReason:t.fieldName,value:""})}.bind(this));if(i.isA("sap.ui.comp.odata.ComboBox")){i.useHighlightItemsWithContains=function(){return true};i.attachSelectedKeyChange(function(){if(i.data("__validationError")){i.data("__validationError",null);i.setValueState(H.None)}})}}i.bindProperty("selectedKey",this.sFilterModelName+">/"+t.fieldName)}else if(t.fControlConstructor===f){this._associateValueList(i,"items",t,false,this._getSuppressValueListsAssociation());i.attachSelectionChange(function(e){if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}var i=e.getSource(),a=null,n=[],r;a=i.getSelectedItems();if(a){r=a.length;while(r--){n.push({key:a[r].getKey(),text:a[r].getText()})}}if(this.oModel){this.oModel.setProperty("/"+t.fieldName+"/items",n)}if(!e.getParameter("stopChangePropagation")){i.fireChange({filterChangeReason:t.fieldName,value:""})}}.bind(this));i.bindProperty("value",this.sFilterModelName+">/"+t.fieldName+"/value")}else if(t.fControlConstructor===h){if(t.controlType===O.date||t.type==="Edm.Time"||t.type==="Edm.DateTimeOffset"){i.setValueHelpOnly&&i.setValueHelpOnly(true);if(t.filterRestriction===k.interval){this._associateValueHelpDialog(i,t,false,false)}else{this._associateValueHelpDialog(i,t,true,true)}this._setControlCalendarWeekSetting(i,this._oCalendarWeekSettings);this._setShowCurrentDateButton(i,this._oShowCurrentDateButton)}else{if(t.hasValueHelpDialog){this._associateValueHelpDialog(i,t,t.filterRestriction!==k.multiple,true)}else{i.setShowValueHelp(false)}i.bindProperty("value",{path:this.sFilterModelName+">/"+t.fieldName+"/value",type:p})}this._handleMultiInput(i,t,p)}else if(t.fControlConstructor===u){if(t.filterRestriction===k.interval){c=true;i.bindProperty("value",this.sFilterModelName+">/"+t.fieldName+"/low");if(!this.oResourceBundle){this.oResourceBundle=e.getResourceBundleFor("sap.ui.comp")}if(!this.sIntervalPlaceholder){this.sIntervalPlaceholder=this.oResourceBundle.getText("INTERVAL_PLACEHOLDER_TEXT")}i.setPlaceholder(this.sIntervalPlaceholder)}else if(t.hasValueListAnnotation){i.attachChange(function(e){var a=e.getParameter("value");i.__sValidationText="";if(!a){this.oModel.setProperty("/"+t.fieldName,"")}}.bind(this))}else{i.bindProperty("value",{path:this.sFilterModelName+">/"+t.fieldName,type:p})}if(t.hasValueHelpDialog){i.setShowValueHelp(true);if(c&&g){i.setValueHelpOnly&&i.setValueHelpOnly(true)}this._associateValueHelpDialog(i,t,false,false)}}else if(t.isCalendarDate){this._setControlDisplayFormat(i,this._oDateFormatSettings);this._setControlCalendarWeekSetting(i,this._oCalendarWeekSettings);this._setShowCurrentDateButton(i,this._oShowCurrentDateButton);i.bindProperty("dateValue",{path:this.sFilterModelName+">/"+t.fieldName,type:p})}else if(t.fControlConstructor===s){i.bindProperty("dateValue",this.sFilterModelName+">/"+t.fieldName);this._setControlDisplayFormat(i,this._oDateFormatSettings);this._setControlCalendarWeekSetting(i,this._oCalendarWeekSettings);this._setShowCurrentDateButton(i,this._oShowCurrentDateButton)}else if(t.fControlConstructor===d||t.fControlConstructor===a){i.bindProperty("dateValue",this.sFilterModelName+">/"+t.fieldName);if(this._oDateFormatSettings&&this._oDateFormatSettings.style){i.setDisplayFormat(this._oDateFormatSettings.style)}this._setControlCalendarWeekSetting(i,this._oCalendarWeekSettings);this._setShowCurrentDateButton(i,this._oShowCurrentDateButton)}if(i instanceof s){i.attachChange(function(t){var a=t.getParameter("valid");i.data("__mandatoryEmpty",null);if(a){i.setValueState(H.None);i.setValueStateText()}else{var n=i._parseValue(t.getParameter("newValue")),r=this._getSelectedDateRange(n);i.setValueState(H.Error);if(r[0]&&r[1]){var o=e.getResourceBundleFor("sap.ui.comp"),s=this._getDateFieldOutOfRangeErrorText(i,r,p,o);i.setValueStateText(s)}else if(p){try{p.parseValue("foo","string")}catch(e){i.setValueStateText(e.message)}}}}.bind(this))}if(t.hasTypeAhead){if(t.hasValueListAnnotation){i.setShowSuggestion(true)}i.setFilterSuggests(false);this._associateValueList(i,"suggestionRows",t,true,this._getSuppressValueListsAssociation())}if(t.displayFormat==="UpperCase"&&t.controlType!==O.dropDownList&&i.attachChange&&i.getValue&&i.setValue){i.attachChange(function(e){var a=i.getValue();if(a&&!t.hasValueListAnnotation){i.setValue(a.toUpperCase())}});if(this._mTokenHandler[i.getId()]&&this._mTokenHandler[i.getId()].parser){var y=this._mTokenHandler[i.getId()].parser;y.getKeyFields()[0].displayFormat=t.displayFormat}}if(i instanceof u){if(t.maxLength){m=parseInt(t.maxLength);if(!isNaN(m)){if(this._mTokenHandler[i.getId()]&&this._mTokenHandler[i.getId()].parser){var y=this._mTokenHandler[i.getId()].parser;y.getKeyFields()[0].maxLength=m}else{if(!t.hasValueListAnnotation&&!c){i.setMaxLength(m)}}}}if(t.isCalendarType&&t.calendarType){i.setPlaceholder(p.formatter.getPattern())}if(t.isFiscalDate){i.setPlaceholder(p.formatter.getPattern())}var F=t.filterRestriction==="auto"||t.filterRestriction==="multi-value"||t.filterRestriction==="multiple";if(t.type==="Edm.String"&&F&&(this._oSmartFilter&&!this._oSmartFilter.getDisableSearchMatchesPatternWarning())){i.attachLiveChange(this._oSmartFilter._onLiveChangeValidateSymbols.bind(this._oSmartFilter))}}_=function(e){var t=e.getParameter("exception");var a=e.getParameter("element");if(i&&a&&i.getId()===a.getId()){if(t){if(i.setValueStateText){i.setValueStateText(t.message)}}if(i.setValueState){i.setValueState(H.Error)}i.data("__mandatoryEmpty",null)}};i.attachParseError(_);i.attachFormatError(_);i.attachValidationError(_);i.attachValidationSuccess(function(e){var t=e.getParameter("element");if(i&&t&&i.getId()===t.getId()){if(i.setValueState){i.setValueState(H.None)}if(i.setValueStateText){i.setValueStateText()}i.data("__mandatoryEmpty",null);delete i.__sValidationText}});if(t.fControlConstructor===o||t.fControlConstructor===f){i.setFilterFunction(function(e,t){RegExp.escape=function(e){return e.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")};var i=RegExp.escape(e);var a=new RegExp(i,"i");return t.getText().match(new RegExp(a,"i"))||t.getKey().match(new RegExp(a,"i"))})}return i};W.prototype._getControlConstructor=function(e,t){var i=u,r,p,c;c=t?t+e.fieldName:e.fieldName;if(e.isCustomFilterField){i=undefined}else{r=e.filterRestriction===k.single;p=e.filterRestriction===k.interval;if(e.controlType===O.date){if(r&&!this._isSingleDynamicDateEnabled(e)){i=s}else{i=p?l:h}if(e.isCalendarDate){this._aFilterBarStringDateFieldNames.push(c)}else{this._aFilterBarDateFieldNames.push(c)}if(e.filterRestriction===k.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(c)}}else if(e.controlType===O.dropDownList){if(r){i=this._isBooleanWithFixedValuedButWithoutValueListAnnotation(e)?n:o}else{i=f}if(!r){e.filterRestriction=k.multiple}}else if(e.type==="Edm.Time"){if(r){i=d}else{i=h}this._aFilterBarTimeFieldNames.push(c);if(p){this._aFilterBarTimeIntervalFieldNames.push(c)}else if(e.filterRestriction===k.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(c)}}else if(!p&&e.controlType===O.dateTimePicker){if(r){i=a}else{i=h}this._aFilterBarDateTimeFieldNames.push(c);if(e.filterRestriction===k.multiple){this._aFilterBarDateTimeMultiValueFieldNames.push(c)}}else if(p&&e.type==="Edm.DateTimeOffset"){var m=this._getFilterTimeZone(c);if(m){var g={key:c,value:m};this._aFilterBarDateTimeOffsetWithTimezoneFieldNames.push(g)}this._aFilterBarDateTimeFieldNames.push(c)}else if(r&&_.isNumber(e)){this._aFilterBarNumericFieldMetadata.push(c)}else if(!r&&!p){i=h}}return i};W.prototype._handleTokenUpdate=function(e,t){this._tokenUpdate({control:t.control,fieldViewMetadata:t.fieldViewMetadata,removedTokens:e&&e.getParameter("removedTokens")})};W.prototype._tokenUpdate=function(e){var t=e.removedTokens,a=e.control,n=e.fieldViewMetadata,r,o=[],s,l,d,u=[],f="/"+n.fieldName;if(this._bUpdatingFilterData||this._bCreatingInitialModel){return}r=a.getTokens();if(t){r=r.filter(function(e){return t.indexOf(e)===-1})}if(Array.isArray(r)&&r.length>0){s=r.length;while(s--){l=r[s];d=l.data("range");if(d){d.tokenText=l.getText();if(n.customColumnKey){d.customColumnKey=n.customColumnKey}if(d&&l.getKey().indexOf("range_")===0){if(n.type==="Edm.Time"){if(d.value1&&(d.value1.ms||d.value1.ms===0)){d.value1=i.utcToLocal(i.edmTimeToDate(d.value1))}if(d.value2&&(d.value2.ms||d.value2.ms===0)){d.value2=i.utcToLocal(i.edmTimeToDate(d.value2))}}}u.push(d)}else{o.push({key:l.getKey(),text:l.getText()})}}}if(this.oModel){this.oModel.setProperty(f+"/items",o);this.oModel.setProperty(f+"/ranges",u)}if(a.__bValidatingToken){delete a.__bValidatingToken}if(!a._pendingAutoTokenGeneration){a.fireChange({filterChangeReason:n.fieldName,value:""})}};W.prototype._handleMultiInput=function(t,i,a){t._setFilterProvider(this);t._setFieldViewMetadata(i);t.attachTokenUpdate({control:t,fieldViewMetadata:i},this._handleTokenUpdate,this);var n,r=i.type==="Edm.DateTime"&&i.displayFormat==="Date";if(i.hasValueListAnnotation||i.type==="Edm.String"||r){t.attachEvent("_validateOnPaste",function(o){var s=o.getParameter("textRows"),l=o.getParameter("texts"),d,u,f,h,p,c,m,_;f=s?s.length:0;u=l?l.length:0;if(f<=1&&u>1){o.preventDefault();return}if(f>1){o.preventDefault();d=this.oModel.getProperty("/"+i.fieldName);_=d.ranges||[];t.setValue("");while(f--){h=s[f][0];if(h){if(h.length>i.maxLength){if(!c){c=e.getResourceBundleFor("sap.ui.comp")}t.setValueState(H.Error);t.data("__validationError",true);if(p){t.setValueStateText(c.getText("FIELD_PASTE_MULTIPLE_ERRORS"));return}else{t.setValueStateText(c.getText("FIELD_PASTE_SINGLE_ERROR",[h,f+1,i.maxLength]));p=true}_=[]}m=null;if(i.isUpperCase){h=h.toUpperCase()}if(r){n=this._getDateValue(h,a);if(isNaN(n.getDate())){continue}else{m=h;h=n}}var g=V._createRangeByText(h);_.push(Object.assign({keyField:i.fieldName,tokenText:m,value1:h,value2:null},g))}}if(p){return}this.oModel.setProperty("/"+i.fieldName+"/ranges",_);this._updateMultiValueControl(t,d.items,_,i)}}.bind(this))}};W.prototype._associateValueHelpDialog=function(e,t,i,a){var n=t.visibleInAdvancedArea||t.groupId===x.BASIC_FILTER_AREA_ID;if(this._getSuppressValueListsAssociation()&&n){this._attachEventOnce(x.ASSOCIATE_VALUE_LISTS,function(){this._associateValueHelpDialogHandler(e,t,i,a)}.bind(this))}else{this._associateValueHelpDialogHandler(e,t,i,a)}};W.prototype._addToParams=function(e,t,i){if(t==="true"||t==="false"){e[i]=t==="true"}else if(typeof t==="object"&&t!==null&&Object.keys(t).length>0){e[i]=t[e.fieldName]==="true"}else if(t!==undefined&&t!==null){N.error("customData for "+i+" is not of type boolean or object")}};W.prototype._associateValueHelpDialogHandler=function(e,t,i,a){var n,r,o={fieldName:t.fieldName,control:e,model:this._oParentODataModel,filterModel:this.oModel,filterProvider:this,dateFormatSettings:this._oDateFormatSettings,calendarWeekSettings:this._oCalendarWeekSettings,showCurrentDateButton:this._oShowCurrentDateButton,fieldViewMetadata:t,displayFormat:t.displayFormat,displayBehaviour:t.displayBehaviour,loadAnnotation:t.hasValueListAnnotation,fullyQualifiedFieldName:t.fullName,metadataAnalyser:this._oMetadataAnalyser,preventInitialDataFetchInValueHelpDialog:t.preventInitialDataFetchInValueHelpDialog,supportMultiSelect:a,supportRanges:i,isSingleIntervalRange:t.filterRestriction===k.interval,isSearchExpressionFilterRestriction:t.filterRestriction===k.searchExpression,isUnrestrictedFilter:t.filterRestriction!==k.multiple,type:t.filterType,maxLength:t.maxLength,scale:t.scale,precision:t.precision,context:this._oSmartFilter?"SmartFilterBar":"mdcFilterPanel",filterBarClass:this.filterBarClass,defaultOperation:t.conditionPanelDefaultOperation,enabledMultiSelectionPlugin:!this.bShowSelectAll,_onBeforeOpenValueHelpDialog:function(e){if(this._oSmartFilter){this._oSmartFilter.fireEvent("_beforeOpenVHD",e)}}.bind(this)};if(o.isSearchExpressionFilterRestriction){r={defaultOperation:_._getSearchExpressionTypeOperations().string[0],typeOperations:_._getSearchExpressionTypeOperations(),rangeOperationsKeys:_._getSearchExpressionRangeOperationsKeys()}}if(t.isCalendarDate){o.oType=this._getType(t)}if(this.mDefaultFilterBarExpanded){this._addToParams(o,this.mDefaultFilterBarExpanded,"defaultFilterBarExpanded")}if(this.mDefaultShowAllFilters){this._addToParams(o,this.mDefaultShowAllFilters,"defaultShowAllFilters")}var s=new y(o);s.attachValueListChanged(function(e){if(this._oSmartFilter){this._oSmartFilter.fireFilterChange(e);this._oSmartFilter.validateMandatoryFields()}}.bind(this));if(t.visibleInAdvancedArea||t.groupId===x.BASIC_FILTER_AREA_ID){this.aFilterAnnotations.push(s.loadAnnotation().then(function(e){this._enrichFieldViewMetadata(t,e)}.bind(this)))}this._aValueHelpDialogProvider.push(s);if(i&&e.addValidator){n=new V(r);n.addKeyField({key:t.fieldName,label:t.label,type:t.filterType,oType:t.ui5Type});if(t.filterType==="numeric"){n.setDefaultOperation("EQ")}n.associateInput(e);this._mTokenHandler[e.getId()]={parser:n}}};W.prototype._determineFieldLabel=function(e){var t,i=e.label;if(this._oSmartFilter&&this._oSmartFilter.determineFilterItemByName){t=this._oSmartFilter.determineFilterItemByName(e.name,e.groupName);if(t){i=t.getLabel()}}return i};W.prototype._associateValueList=function(e,t,i,a,n){var r=i.visibleInAdvancedArea||i.groupId===x.BASIC_FILTER_AREA_ID,o={control:e,aggregation:t,fieldViewMetadata:i,hasTypeAhead:a,annotaionIsToBeLoaded:r};if(n&&r){this._attachEventOnce(x.ASSOCIATE_VALUE_LISTS,function(){this._associateValueListHandler(o)}.bind(this))}else{this._associateValueListHandler(o)}};W.prototype._associateValueListHandler=function(e){var t,i,a=e.control,n=e.aggregation,r=e.fieldViewMetadata,o=e.hasTypeAhead,s=e.annotaionIsToBeLoaded;if(this._oSmartFilter&&!this._bAttachInitializedDone&&new URLSearchParams(window.location.search).get("sap-ui-comp-filterbar-data-defer")){var l=this._oParentODataModel;this._sDeferredGroupId="sapUiCompFilterBarData";var d=l.getDeferredGroups?this._oParentODataModel.getDeferredGroups():null;if(d!==null){d.push(this._sDeferredGroupId);l.setDeferredGroups(d);var u=function(){l.submitChanges({groupId:this._sDeferredGroupId});var e=l.getDeferredGroups().filter(function(e){return e!==this._sDeferredGroupId}.bind(this));l.setDeferredGroups(e);delete this._sDeferredGroupId;this._oSmartFilter.detachInitialized(u)}.bind(this);this._oSmartFilter.attachInitialized(u);this._bAttachInitializedDone=true}}if(r.hasValueListAnnotation){t=new F({fieldName:r.fieldName,control:a,model:this._oParentODataModel,filterModel:this.oModel,filterProvider:this,displayFormat:r.displayFormat,dateFormatSettings:this._oDateFormatSettings,fieldViewMetadata:r,displayBehaviour:r.displayBehaviour,loadAnnotation:true,fullyQualifiedFieldName:r.fullName,metadataAnalyser:this._oMetadataAnalyser,type:r.filterType,aggregation:n,typeAheadEnabled:o,bShowAllSuggestionsButton:r.hasValueHelpDialog,enableShowTableSuggestionValueHelp:r.hasValueHelpDialog,deferredGroupId:this._sDeferredGroupId,context:this._sContext?this._sContext:"SmartFilterBar",fieldHistoryEnabled:r.historyEnabled!==undefined?r.historyEnabled:true,fieldHistoryEnabledInitial:r.historyEnabledInitial!==undefined?r.historyEnabledInitial:true,considerPresentationVariant:this._oSmartFilter?.getConsiderPresentationVariant()});t.attachValueListChanged(function(e){if(this._oSmartFilter){this._oSmartFilter.fireFilterChange(e);this._oSmartFilter.validateMandatoryFields()}}.bind(this));if(s){i=t.loadAnnotation().then(function(e){this._enrichFieldViewMetadata(r,e)}.bind(this));a.data("__loadVLPromise",i);this.aFilterAnnotations.push(i)}this._aValueListProvider.push(t)}else if(this._mTokenHandler[a.getId()]&&this._mTokenHandler[a.getId()].parser&&r.filterRestriction!=="searchExpression"){this._mTokenHandler[a.getId()].parser.setDefaultOperation("EQ")}};W.prototype._createAnalyticParameters=function(e){var t,i;if(e){i=e.getAllParameterNames();t=e.getEntitySet();if(t){this._createParametersByEntitySetName(t.getQName(),i)}}};W.prototype._createParametersByEntitySetName=function(e,t){var i,a=this._oMetadataAnalyser.getFieldsByEntitySetName(e);for(var n=0;n<a.length;n++){if(t.indexOf(a[n].name)>=0){i=this._createAnalyticParameterMetadata(a[n]);if(i&&i.visible){if(this._oNonAnaParameterization&&i.isCustomFilterField){continue}this._aAnalyticalParameters.push(i)}}}};W.prototype._createAnalyticParameterMetadata=function(e){var t,i=M.ANALYTICAL_PARAMETER_PREFIX,a=function(e){return e.type==="Edm.String"&&e["sap:parameter"]==="optional"};e.filterRestriction="single-value";t=this._createFieldMetadata(e,i);if(t){t.fieldName=i+e.name;t.isMandatory=a(t)?false:true;t.isParameter=true;t.visibleInAdvancedArea=true}else{N.error("_createAnalyticParameterMetadata issue with property: "+e.name)}return t};W.prototype.getAnalyticParameters=function(){return this._aAnalyticalParameters};W.prototype.getSelectionVariants=function(){return this._aSelectionVariants};W.prototype.getAnalyticBindingPath=function(){var e,t=[],i=this.getAnalyticParameters();i.forEach(function(e){t.push(e.fieldName)});e=this.getFilledFilterData(t);if(this._oParameterization){return this._createAnalyticBindingPath(i,e)}else{return this._createNonAnalyticBindingPath(i,e)}};W.prototype._createAnalyticBindingPath=function(e,t){var a,n="",r;r=this._getParameterizationRequest(this._oParameterization);if(r){e.forEach(function(e){a=t[e.fieldName];if(!a&&a!==0){a=""}else if(e.type==="Edm.Time"&&a instanceof Date){if(this._oDateFormatSettings&&!this._oDateFormatSettings.UTC){a=i.utcToLocal(a)}a=i.localToUtc(a);a={__edmType:"Edm.Time",ms:a.valueOf()}}else if(e.type==="Edm.DateTime"&&t[e.fieldName]&&t[e.fieldName].conditionTypeInfo&&t[e.fieldName].ranges&&t[e.fieldName].ranges[0]){a=t[e.fieldName].ranges[0].value1;if(this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=i.localToUtc(a)}}else if(e.type!=="Edm.DateTimeOffset"&&this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=i.localToUtc(a)}r.setParameterValue(e.name,a)}.bind(this));n=r.getURIToParameterizationEntry()+"/"+this._oParameterization.getNavigationPropertyToQueryResult()}return n};W.prototype._createNonAnalyticBindingPath=function(e,t){var a,n="",r="";if(this._oNonAnaParameterization){n="/"+this._oNonAnaParameterization.entitySetName+"(";e.forEach(function(e){a=t[e.fieldName];if(!a){a=""}else if(e.type==="Edm.Time"&&a instanceof Date){a=i.localToUtc(a);a={__edmType:"Edm.Time",ms:a.valueOf()}}else if(e.type==="Edm.DateTime"&&t[e.fieldName]&&t[e.fieldName].conditionTypeInfo&&t[e.fieldName].ranges&&t[e.fieldName].ranges[0]){a=t[e.fieldName].ranges[0].value1;if(this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=i.localToUtc(a)}}else if(e.type!=="Edm.DateTimeOffset"&&this._oDateFormatSettings&&this._oDateFormatSettings.UTC&&a instanceof Date){a=i.localToUtc(a)}n+=r+e.name+"="+B(this._oParentODataModel.formatValue(a,e.type));r=","}.bind(this));n+=")/"+this._oNonAnaParameterization.navPropertyName}return n};W.prototype._getParameterizationRequest=function(){return this._oParameterization?new I.ParameterizationRequest(this._oParameterization):null};W.prototype._constructContextUrl=function(e,t){var i=e._getServerUrl();if(i&&i.lastIndexOf("/")===i.length-1){i=i.substr(0,i.length-1)}return i+e.sServiceUrl+"/$metadata#"+t};W.prototype.getFilterContextUrl=function(){var e,t=null;if(this._oParentODataModel&&this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oParentODataModel.getMetaModel()){e=this._oParentODataModel.getMetaModel().getODataEntitySet(this.sEntitySet);if(e){t=this._constructContextUrl(this._oParentODataModel,e.name)}}return t};W.prototype.getParameterContextUrl=function(){var e,t=null;if(this._oParentODataModel&&this._oParentODataModel.isA("sap.ui.model.odata.v2.ODataModel")&&this._oParentODataModel.getMetaModel()){if(this._oParameterization&&this._oParameterization.getEntitySet()){e=this._oParameterization.getEntitySet().getQName()}else if(this._oNonAnaParameterization){e=this._oNonAnaParameterization.entitySetName}if(e){t=this._constructContextUrl(this._oParentODataModel,e)}}return t};W.prototype._createFieldMetadata=function(e,i){var a,n,r,o,s;e.fieldName=this._getFieldName(e);e.fieldNameOData=e.fieldName.replace(x.FIELD_NAME_REGEX,"/");n=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(e.fieldName):null;a=Object.assign({},e);a.filterRestriction=this._getFilterRestriction(e.filterRestriction,n);this._updateValueListMetadata(a,e);a.hasValueHelpDialog=this._hasValueHelpDialog(a,n);a.isConstant=Array.isArray(this._aConstParams)&&this._aConstParams.indexOf(e.fieldName)!==-1;a.isInitialValueSignificant=Array.isArray(this._aSignificantParams)&&this._aSignificantParams.indexOf(e.fieldName)!==-1;if(n){a.preventInitialDataFetchInValueHelpDialog=this._getPreventInitialDataFetchInValueHelpDialog(a,n);a.conditionPanelDefaultOperation=n.conditionPanelDefaultOperation;if(n.displayBehaviour&&n.displayBehaviour!=="auto"){a.displayBehaviour=n.displayBehaviour}a.isCustomFilterField=!!n.customControl;a.visibleInAdvancedArea=!!n.visibleInAdvancedArea;a.defaultFilterValues=n.defaultFilterValues;a.customControl=n.customControl;r=n.conditionType;a.width=this._getWidth(n);a.isVisible=this._isVisible(n);a.historyEnabled=n.historyEnabled;a.historyEnabledInitial=n.historyEnabledInitial;a.hasValidation=n.hasValidation}else{a.preventInitialDataFetchInValueHelpDialog=this._getPreventInitialDataFetchInValueHelpDialog(a);a.isVisible=true;a.isCustomFilterField=false;a.visibleInAdvancedArea=false;a.hasValidation=true}a.controlType=this._getControlType(a,n);a.label=this._getLabel(e,n);a.isMandatory=this._isMandatory(e,n);a.groupId=this._getGroupID(e,n);a.index=this._getIndex(e,n);a.fControlConstructor=this._getControlConstructor(a,i);a.isFiscalDate=g.isFiscalValue(a);a.isCalendarType=R.isCalendarValue(a);a.fiscalType=g.getFiscalAnnotationType(a);a.calendarType=R.getCalendarAnnotationType(a);if(a.isFiscalDate){g.updateViewMetadata(a)}if(a.isCalendarType&&a.calendarType){R.updateViewMetadata(a)}a.filterType=this._getFilterType(a);a.hasTypeAhead=this._hasTypeAhead(a,e,n);a.ui5Type=this._getType(a);if(a.ui5Type&&a.ui5Type.isA("sap.ui.model.odata.type.DateTime")){a.ui5Type.formatValue(t.getInstance(),"string");a.ui5Type.oFormat.oFormatOptions.UTC=false}a.fCreateControl=function(e){var t;e.control=this._createControl(e);t=this.oModel.getData()[e.fieldName];if(t){this._updateMultiValueControl(e.control,t.items,t.ranges,e);var i=this._aFilterBarSingleValueWithValueListFieldMetadata.some(function(t){return t.name===e.fieldName||M.ANALYTICAL_PARAMETER_PREFIX+t.name===a.fieldName});if(i){this._updateSingleValueControl(e)}}}.bind(this);this._applyWidth(a);if(a.type==="Edm.String"){this._aFilterBarStringFieldNames.push(a.fieldName)}a.conditionType=null;var d=a.filterRestriction===k.single&&(a.type==="Edm.DateTime"&&a.displayFormat==="Date"||a.type==="Edm.String"&&a.isCalendarDate);var u=a.type==="Edm.DateTimeOffset"&&a.filterRestriction==="interval";if(!r&&this._bUseDateRangeType&&(a.fControlConstructor===l||d||u)){r="sap.ui.comp.config.condition.DateRangeType"}if(r){o="";if(typeof r==="object"){if(this._bUseDateRangeType&&!r.module&&a.fControlConstructor===l||d||u){r.module="sap.ui.comp.config.condition.DateRangeType"}o=r.module}else{o=r;r=null}try{o=o.replace(/\./g,"/");var f=sap.ui.require(o);if(f){this._enhanceConditionTypeInfo(f,o,r,a,i)}else{s=new Promise(function(e){sap.ui.require([o],function(t){this._enhanceConditionTypeInfo(t,o,r,a,i);e()}.bind(this))}.bind(this));this._aPromises.push(s)}}catch(e){N.error("Module "+o+" could not be loaded")}}else{this._checkMetadataDefaultValue(a)}return a};W.prototype._requireConditionType=function(e,t,i){var e=e.replace(/\./g,"/");var a=sap.ui.require(e);if(a){this._enhanceConditionTypeInfo(a,e,t,i)}else{sap.ui.require([e],function(a){this._enhanceConditionTypeInfo(a,e,t,i)}.bind(this))}};W.prototype._enhanceConditionTypeInfo=function(e,t,i,a,n){var r=e;var o=n===M.ANALYTICAL_PARAMETER_PREFIX&&a.fieldName.indexOf(M.ANALYTICAL_PARAMETER_PREFIX)===-1?n+a.fieldName:a.fieldName;if(this._sContext==="mdcFilterPanel"&&t!=="sap/ui/comp/config/condition/DateRangeType"){return}a.conditionType=new r(o,this,a);this._mConditionTypeFields[o]=a;a.calendarWeekNumbering=this._oCalendarWeekSettings;a.showCurrentDateButton=this._oShowCurrentDateButton;if(i&&!this._bUseDateRangeType){if(a.defaultValue&&n===M.ANALYTICAL_PARAMETER_PREFIX){i=Object.assign({},i,{defaultDate:a.defaultValue})}a.conditionType.applySettings(i)}if(this._bUseDateRangeType&&i&&n!==M.ANALYTICAL_PARAMETER_PREFIX){a.conditionType.applySettings(i)}if(this._bUseDateRangeType&&n===M.ANALYTICAL_PARAMETER_PREFIX&&(a.defaultValue||i&&i.defaultOperation)){var s={defaultDate:a.defaultValue};i=Object.assign({},s,i);a.conditionType.applySettings(i)}this._checkMetadataDefaultValue(a)};W.prototype._getFilterType=function(e){return v._getFilterType(e)};W.prototype._updateValueListMetadata=function(e,t){e.hasValueListAnnotation=t["sap:value-list"]!==undefined;if(e.hasValueListAnnotation){e.hasFixedValues=t["sap:value-list"]==="fixed-values"}else if(t["com.sap.vocabularies.Common.v1.ValueList"]){e.hasValueListAnnotation=true;e.hasFixedValues=this._oMetadataAnalyser.getValueListSemantics(t["com.sap.vocabularies.Common.v1.ValueList"])==="fixed-values";if(!e.hasFixedValues){e.hasFixedValues=_.isValueListWithFixedValues(t)}}};W.prototype._createBasicSearchFieldMetadata=function(){var t;var i=e.getResourceBundleFor("sap.ui.comp");t={};t.filterRestriction=k.single;t.name=x.BASIC_SEARCH_FIELD_ID;t.fieldName=x.BASIC_SEARCH_FIELD_ID;t.label=undefined;t.isMandatory=false;t.isVisible=true;t.groupId=x.BASIC_FILTER_AREA_ID;t.index=-1;t.control=new c(this._oSmartFilter.getId()+"-btnBasicSearch",{showSearchButton:true});if(!this._isRunningInValueHelpDialog){t.control.setPlaceholder(i.getText("FILTER_BAR_BSEARCH_PLACE_HOLDER"))}t.control.bindProperty("value",this.sFilterModelName+">/"+t.fieldName);this._oBasicSearchControl=t.control;return t};W.prototype._applyWidth=function(e){if(e&&e.width&&e.control&&typeof e.control.setWidth==="function"){e.control.setWidth(e.width)}};W.prototype._createFieldMetadataForCustomFilterFields=function(e){var t;if(!e||!e.customControl){return undefined}t={};t.name=e.key;t.fieldName=e.key;t.label=e.label;t.visibleInAdvancedArea=!!(e&&e.visibleInAdvancedArea);t.isVisible=this._isVisible(e);t.groupId=e.groupId;t.isMandatory=this._isMandatory(undefined,e);t.index=e.index;t.width=this._getWidth(e);t.control=e.customControl;t.isCustomFilterField=true;this._applyWidth(t);return t};W.prototype._getFieldName=function(e){if(!e.parentPropertyName){return e.name}else{return e.parentPropertyName+"."+e.name}};W.prototype._getPreventInitialDataFetchInValueHelpDialog=function(e,t){if(t&&!t.isSetPreventInitialDataFetchInValueHelpDialog){return t.preventInitialDataFetchInValueHelpDialog}if(_.isValueList(e)&&e["com.sap.vocabularies.Common.v1.ValueList"]&&e["com.sap.vocabularies.Common.v1.ValueList"].FetchValues){return e["com.sap.vocabularies.Common.v1.ValueList"].FetchValues.Int!=="1"}return false};W.prototype._hasValueHelpDialog=function(e,t){var i=true;if(t){if(t.controlType===O.dropDownList){i=false}else if(t.hasValueHelpDialog!==true){i=false}}if(e&&!e.hasValueListAnnotation){if(e.filterRestriction===k.single||e.filterRestriction===k.multiple){i=false}}return i};W.prototype._isVisible=function(e){if(e&&e.isVisible===false){return false}return true};W.prototype._getWidth=function(e){if(e&&e.width){return e.width}return undefined};W.prototype._isMandatory=function(e,t){if(t&&t.mandatory!==U.auto){return t.mandatory===U.mandatory}if(e){return e.requiredFilterField}return false};W.prototype._getFilterRestriction=function(e,t){if(t&&t.filterType&&t.filterType!==k.auto){return t.filterType}switch(e){case"single-value":return k.single;case"multi-value":return k.multiple;case"interval":return k.interval;case"search-expression":return k.searchExpression;default:return k.auto}};W.prototype._getControlType=function(e,t){var i;if(t&&t.controlType&&t.controlType!==O.auto){i=t.controlType}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.isCalendarDate){i=O.date}else if(e.type==="Edm.DateTimeOffset"){i=O.dateTimePicker}else if(e.hasValueListAnnotation&&e.hasFixedValues){i=O.dropDownList}else if(this._isBooleanWithFixedValuedButWithoutValueListAnnotation(e)){i=O.dropDownList}else{i=O.input}return i};W.prototype._isBooleanWithFixedValuedButWithoutValueListAnnotation=function(e){if(e.type==="Edm.Boolean"&&!e.hasFixedValues&&!e.hasValueListAnnotation&&e.filterRestriction==="single"){return true}return false};W.prototype._getGroupID=function(e,t){if(t&&t.groupId){return t.groupId}else if(e&&(e.requiredFilterField||this._aSelectionFields&&this._aSelectionFields.indexOf(e.fieldNameOData)>-1)){return this._sBasicFilterAreaID}return this._getGroupIDFromFieldGroup(e)};W.prototype._getGroupIDFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields&&i.fields.indexOf(e.fieldNameOData)>-1){a=i.groupName;break}}}return a};W.prototype._getLabel=function(e,t){if(t&&t.label){return t.label}return this._getLabelFromFieldGroup(e)||e.fieldLabel||e.fieldName};W.prototype._getLabelFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields&&i.fields.indexOf(e.fieldNameOData)>-1){a=i.labels[e.fieldNameOData];break}}}return a};W.prototype._getIndex=function(e,t){if(t&&t.index>=0){return t.index}else if(this._aSelectionFields&&this._aSelectionFields.indexOf(e.fieldNameOData)>-1){return this._aSelectionFields.indexOf(e.fieldNameOData)}return this._getIndexFromFieldGroup(e)};W.prototype._getIndexFromFieldGroup=function(e){var t=0,i=null,a;if(e&&this._aFieldGroupAnnotation&&this._aFieldGroupAnnotation.length){t=this._aFieldGroupAnnotation.length;while(t--){i=this._aFieldGroupAnnotation[t];if(i&&i.fields){a=i.fields.indexOf(e.fieldNameOData);if(a>-1){break}a=undefined}}}return a};W.prototype._getGroupIndex=function(e){if(e&&(e.index||e.index===0)){return e.index}};W.prototype._getGroupLabel=function(e,t){if(t&&t.label){return t.label}return e.groupLabel||e.groupName||e.groupEntitySetName};W.prototype._hasTypeAhead=function(e,t,i){var a;a=true;if(i){a=i.hasTypeAhead}else if(t.type!=="Edm.String"){return false}if(!(e.fControlConstructor===u||e.fControlConstructor===h)){return false}return a};W.prototype.getModel=function(){return this.oModel};W.prototype.getFilterBarViewMetadata=function(){return this._aFilterBarViewMetadata};W.prototype._getFilterBarViewMetadataExtend=function(){return this._oFilterBarViewMetadataExtend};W.prototype.getAssociatedValueHelpProviders=function(){return this._aValueHelpDialogProvider};W.prototype.getAssociatedValueListProviders=function(){return this._aValueListProvider};W.prototype.getParameters=function(){var e,t=null;if(this.oModel){t=this.oModel.getProperty("/"+x.BASIC_SEARCH_FIELD_ID)}if(this._sBasicSearchFieldName||t){e={custom:{}};if(this._sBasicSearchFieldName){e.custom["search-focus"]=this._sBasicSearchFieldName}e.custom["search"]=t||""}return e};W.prototype.getFilters=function(e){var t=null;if(this.oModel){t=this.oModel.getData()}return x.generateFilters(e,t,{dateSettings:this._oDateFormatSettings,useContainsAsDefault:this._bUseContainsAsDefault,stringFields:this._aFilterBarStringFieldNames,timeFields:this._aFilterBarTimeFieldNames,dateTimeOffsetValueFields:this._aFilterBarDateTimeFieldNames,dateTimeOffsetWithTimeZone:this._aFilterBarDateTimeOffsetWithTimezoneFieldNames,viewMetadataData:this._aFilterBarViewMetadata},this._sContext)};W.prototype.getFilterData=function(){return this.oModel?this.oModel.getData():null};W.prototype.getFilterDataAsString=function(){return this.oModel?this.oModel.getJSON():null};W.prototype.getFilledFilterData=function(e){var t,i={},a,n,r;t=this.oModel?this.oModel.getData():null;if(t&&e){a=e.length;while(a--){n=e[a];if(n&&n!==x.BASIC_SEARCH_FIELD_ID){r=t[n];if(r&&r.hasOwnProperty("low")){if(r.low){i[n]=r}}else if(r&&r.hasOwnProperty("items")){if(r.value&&typeof r.value==="string"){r.value=r.value.trim()}if(r.items.length||r.ranges&&r.ranges.length||r.value||typeof r.value==="boolean"){i[n]=r}}else if(r||r===0){if(typeof r==="string"){r=r.trim()}if(r||r===0){i[n]=r}}}if(a===0){n=x.CUSTOM_FIELDS_MODEL_PROPERTY;r=t[n];if(r){i[n]=r}}}}return b({},i)};W.prototype.getFilledFilterDataAsString=function(e){return JSON.stringify(this.getFilledFilterData(e))};W.prototype.setFilterData=function(e,t){var i=null,a=null,n=null;if(this.oModel&&e){this._bUpdatingFilterData=true;try{if(t){this._createInitialModel(false)}i=this._parseFilterData(e,t);if(i){this.oModel.setData(i,true);a=[];var r=arguments[2];if(r){a.push(r)}for(n in i){a.push(n)}this._handleFilterDataUpdate(a,arguments[3])}}finally{this._bUpdatingFilterData=false}}};W.prototype.setFilterDataAsString=function(e,t){if(e){this.setFilterData(JSON.parse(e),t)}};W.prototype._parseFilterData=function(e,t){return W.parseFilterData(this.oModel.getData(),e,{stringDateFields:this._aFilterBarStringDateFieldNames,dateFields:this._aFilterBarDateFieldNames,timeFields:this._aFilterBarTimeFieldNames,timeIntervalFields:this._aFilterBarTimeIntervalFieldNames,dateTimeMultiValueFields:this._aFilterBarDateTimeMultiValueFieldNames,conditionTypeFields:this._mConditionTypeFields,dateTimeOffsetValueFields:this._aFilterBarDateTimeFieldNames,dateTimeOffsetWithTimeZone:this._aFilterBarDateTimeOffsetWithTimezoneFieldNames,viewMetadataData:this._aFilterBarViewMetadata,filterProvider:this},t)};W.prototype._handleFilterDataUpdate=function(e,t){var i=0,a,n,t=t===undefined?false:t,r=this.oModel.getData();var o=function(e,t){var i=t;e.forEach(function(e){t.forEach(function(a){if(a.operation===E.EQ&&a.value1===e.key){i.splice(t.indexOf(a),1)}})});return i};if(this._aFilterBarMultiValueFieldMetadata){i=this._aFilterBarMultiValueFieldMetadata.length;while(i--){if(r){a=this._aFilterBarMultiValueFieldMetadata[i];if(e.indexOf(a.fieldName)>-1){n=r[a.fieldName];if(n){if(n.items&&n.items.length>0&&n.ranges&&n.ranges.length>0){n.ranges=o(n.items,n.ranges)}this._updateMultiValueControl(a.control,n.items,n.ranges,a,n.value)}}}}this._updateConditionTypeFields()}if(this._aFilterBarSingleValueWithValueListFieldMetadata&&r&&!t){this._aFilterBarSingleValueWithValueListFieldMetadata.forEach(function(t){var i=t.control,a=t.fieldName;if(!i||_.isHiddenFilter(t)&&this._sContext!=="mdcFilterPanel"){return}if(e.includes(a)){this._updateSingleValueControl(t)}else if(!r[a]){i.setValue("");i.__sValidationText=""}}.bind(this))}};W.prototype.clear=function(){this._createInitialModel(false)};W.prototype.reset=function(){this._createInitialModel(true)};W.prototype._initializeConditionTypeFields=function(){var e=function(e){this.setPending(this.isPending())}.bind(this);for(var t in this._mConditionTypeFields){this._mConditionTypeFields[t].conditionType.initialize(this.oModel.getData()[t],this._sContext);if(this._mConditionTypeFields[t].conditionType.getAsync()){this._mConditionTypeFields[t].conditionType.attachPendingChange(e)}}};W.prototype._updateConditionTypeFields=function(){var e=this._oldData;var t=this.oModel.getData();this._oldData=b({},t);if(e!==undefined){var i=[],a;for(a in t){var n=JSON.stringify(t[a]);var r=JSON.stringify(e[a]);if(n!==r){i.push(a)}}if(i.length>0){for(a in this._mConditionTypeFields){this._mConditionTypeFields[a].conditionType.providerDataUpdated(i,t)}}}};W.prototype._clearConditionTypeFields=function(){var e=this.oModel.getData();for(var t in this._mConditionTypeFields){if(!e[t]){this._mConditionTypeFields[t].conditionType.initialize({})}else{this._mConditionTypeFields[t].conditionType.initialize(e[t],this._sContext)}}};W.prototype._validateConditionTypeFields=function(e){var t=false;for(var i in this._mConditionTypeFields){var a=this._mConditionTypeFields[i].conditionType.validate(e);if(!a&&!t){t=true}}return t};W.prototype._getFieldMetadata=function(e){return x._getFieldMetadata(this.getFilterBarViewMetadata(),e)};W.prototype._getSelectedDateRange=function(e){if(!Array.isArray(e)){e=[e,e]}return e};W.prototype._getDateFieldOutOfRangeErrorText=function(e,t,i,a){var n=e.getMinDate()||e._oMinDate,r=e.getMaxDate()||e._oMaxDate;if(t[0].getTime()<n.getTime()){return a.getText("FILTER_BAR_DATE_FIELD_MIN_DATE_ERROR",[i.formatValue(n,"string")])}if(t[1].getTime()>r.getTime()){return a.getText("FILTER_BAR_DATE_FIELD_MAX_DATE_ERROR",[i.formatValue(r,"string")])}};W.generateFilters=function(e,t,i){return x.generateFilters(e,t,i)};W.parseFilterData=function(e,a,n,r){var o={},s=null,l=null,d=null,u,f,h,p,c,m,_,g,y,F,D,T,v,C,S;if(n){m=n.stringDateFields;_=n.dateFields;g=n.timeFields;y=n.timeIntervalFields;F=n.dateTimeMultiValueFields;s=n.conditionTypeFields||{};D=n.dateTimeOffsetValueFields;T=n.viewMetadataData||[];C=n.filterProvider||null}if(!m){m=[]}if(!_){_=[]}if(!g){g=[]}if(!y){y=[]}if(!F){F=[]}if(!D){D=[]}if(e&&a){f=Object.assign({},a,true);for(l in f){v=x._getFieldMetadata(T,l);if(e.hasOwnProperty(l)&&l!==x.CUSTOM_FIELDS_MODEL_PROPERTY){d=e[l];u=f[l];if(l in s){if(s[l]&&typeof u==="string"){var V=t.getInstance(u);if(V instanceof Date&&!isNaN(V)){s[l].conditionType.initialize({value1:V},this._sContext)}else if(s[l].type==="Edm.String"&&s[l].ui5Type&&typeof s[l].ui5Type.formatValue==="function"){var V=s[l].ui5Type.formatValue(u);s[l].conditionType.initialize({value1:V})}}else if(u&&(u.low||u.low===0)&&(u.high||u.high===0)){var A=t.getInstance(u.low),M=t.getInstance(u.high);if(A instanceof Date&&!isNaN(A)&&M instanceof Date&&!isNaN(M)){s[l].conditionType.initialize({value1:A,value2:M})}else if(s[l].type==="Edm.String"&&s[l].ui5Type&&typeof s[l].ui5Type.formatValue==="function"){var A=s[l].ui5Type.formatValue(u.low),M=s[l].ui5Type.formatValue(u.high);s[l].conditionType.initialize({value1:A,value2:M})}}else if(u&&"conditionTypeInfo"in u){if(s[l].isParameter){this._reduceRangesForParameters(u)}else if(u.ranges&&u.ranges.length>0){c=u.ranges[u.ranges.length-1];if(c){if(u.conditionTypeInfo.data.operation==="DATE"){u.conditionTypeInfo.data.value1=c.value1}else if(u.conditionTypeInfo.data.operation==="DATERANGE"){u.conditionTypeInfo.data.value1=c.value1;u.conditionTypeInfo.data.value2=c.value2}}}s[l].conditionType.initialize(u)}else if(u&&!("conditionTypeInfo"in u)&&u.ranges){if(s[l].isParameter){this._reduceRangesForParameters(u)}s[l].conditionType.initialize(u)}}else if(d&&d.hasOwnProperty("low")){o[l]=u;if(u){if((u.low||u.low===0)&&(u.high||u.high===0)){if(_.indexOf(l)>-1||g.indexOf(l)>-1){if(!(u.low instanceof Date)){o[l].low=t.getInstance(u.low)}if(!(u.high instanceof Date)){o[l].high=t.getInstance(u.high)}}else if(C&&v&&D.indexOf(l)>-1&&u.low&&u.high){o[l].low=v.ui5Type.formatValue(t.getInstance(u.low),"string")+"-"+v.ui5Type.formatValue(t.getInstance(u.high),"string");o[l].high=null}else if(m.indexOf(l)===-1){o[l].low=u.low+"-"+u.high;o[l].high=null}}else if((u.low||u.low===0||u.value)&&!u.high){if(!u.low&&u.value){u.low=u.value}if((_.indexOf(l)>-1||g.indexOf(l)>-1||D.indexOf(l)>-1)&&!(u.low instanceof Date)){if(C&&v&&D.indexOf(l)>-1&&v.filterRestriction==="interval"&&(u.low.indexOf("-")<0||u.low.indexOf("Z")>0)){o[l].low=v.ui5Type.formatValue(t.getInstance(u.low),"string")}else{S=Date.parse(u.low);if(!Number.isNaN(S)){o[l].low=t.getInstance(S)}o[l].low=u.low}}o[l].high=null}}}else if(d&&d.hasOwnProperty("items")){if(u&&(u.items||u.ranges)){if(u.ranges&&u.ranges.length){if(y.indexOf(l)>-1){p=u.ranges.length;for(h=0;h<p;h++){c=u.ranges[h];if(!c.exclude&&(c.operation==="EQ"||c.operation==="BT")){break}c=null}if(c){if(c.value1&&typeof c.value1==="string"){c.value1=t.getInstance(c.value1)}if(c.value2&&typeof c.value2==="string"){c.value2=t.getInstance(c.value2)}o[l]={ranges:[c],items:[],value:""}}continue}else if(_.indexOf(l)>-1||g.indexOf(l)>-1||D.indexOf(l)>-1){p=u.ranges.length;for(h=0;h<p;h++){c=u.ranges[h];if(c.value1&&typeof c.value1==="string"){c.value1=t.getInstance(c.value1)}if(c.value2&&typeof c.value2==="string"){c.value2=t.getInstance(c.value2)}}}else if(v&&v.isCalendarDate){p=u.ranges.length;for(h=0;h<p;h++){c=u.ranges[h];if(c.value1&&typeof c.value1==="string"&&!c.value1.match(/([1-9][0-9]{3,}|0[0-9]{3})(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])/)){c.value1=v.ui5Type.parseValue(t.getInstance(c.value1),"date")}if(c.value2&&typeof c.value2==="string"&&!c.value2.match(/([1-9][0-9]{3,}|0[0-9]{3})(0[1-9]|1[0-2])(0[1-9]|[12][0-9]|3[01])/)){c.value2=v.ui5Type.parseValue(t.getInstance(c.value2),"date")}}}else if(v&&v.filterType==="boolean"){p=u.ranges.length;for(h=0;h<p;h++){c=u.ranges[h];if(c.hasOwnProperty("value1")){if(typeof c.value1==="string"){c.value1=c.value1==="true"}}if(c.hasOwnProperty("value2")){if(typeof c.value2==="string"){c.value2=c.value2==="true"}}}}}o[l]=u;if(!r&&o[l].ranges){for(h=0;h<o[l].ranges.length;h++){o[l].ranges[h].tokenText=null}}}else if(typeof u==="string"||typeof u==="boolean"||typeof u==="number"||u instanceof Date){if(u&&(_.indexOf(l)>-1||g.indexOf(l)>-1)){if(typeof u==="string"){u=t.getInstance(u)}o[l]={ranges:[{exclude:false,operation:"EQ",keyField:l,value1:u,value2:null}],items:[],value:""}}else{o[l]={value:u,items:[]}}}}else{o[l]=null;if(typeof u==="string"||typeof u==="boolean"||typeof u==="number"||u instanceof Date){if(typeof u==="string"&&(_.indexOf(l)>-1||g.indexOf(l)>-1||D.indexOf(l)>-1)){o[l]=t.getInstance(u)}else{o[l]=u}}else if(u&&(u.value||u.value===0||u.value===false)){o[l]=u.value}else if(u&&u.items&&u.items.length){o[l]=u.items[0].key}else if(u&&u.ranges&&u.ranges.length){p=u.ranges.length;for(h=0;h<p;h++){c=u.ranges[h];if(!c.exclude&&c.operation==="EQ"){break}c=null}if(c&&c.value1){if(typeof c.value1==="string"&&(_.indexOf(l)>-1||g.indexOf(l)>-1||D.indexOf(l)>-1)){o[l]=t.getInstance(c.value1)}else{o[l]=c.value1}}if(c===null&&u.conditionTypeInfo&&u.conditionTypeInfo.data&&u.conditionTypeInfo.data.operation==="DATE"&&u.conditionTypeInfo.data.value1&&i._isValidDateObject(u.conditionTypeInfo.data.value1)){o[l]=u.conditionTypeInfo.data.value1}}}}else if(r||l===x.CUSTOM_FIELDS_MODEL_PROPERTY){o[l]=f[l]}}}return o};W.prototype._attachEvent=function(e,t){if(!this._oEventProvider){this._oEventProvider=new C}this._oEventProvider.attachEvent(e,t)};W.prototype._attachEventOnce=function(e,t){if(!this._oEventProvider){this._oEventProvider=new C}this._oEventProvider.attachEventOnce(e,t)};W.prototype._detachEvent=function(e,t){if(!this._oEventProvider){return}this._oEventProvider.detachEvent(e,t)};W.prototype._fireEvent=function(e,t){if(!this._oEventProvider){return}this._oEventProvider.fireEvent(e,t||{})};W.prototype._getSuppressValueListsAssociation=function(){return this._bSuppressValueListsAssociation};W.prototype._getCurrentValidationPromises=function(){return this._aValueListProvider.concat(this._aValueHelpDialogProvider).reduce(function(e,t){return e.concat(t._getCurrentValidationPromises())},[])};W.prototype._enrichFieldViewMetadata=function(e,t){var i,a,n,r,o,s,l={},d="com.sap.vocabularies.Common.v1.ValueList";if(t===undefined||e===undefined){return}a=e["groupName"];n=e["fullName"];r=t.primaryValueListAnnotation!==undefined;o=Array.isArray(t.additionalAnnotations)&&t.additionalAnnotations.length>0;if(r){l[d]=t.primaryValueListAnnotation.annotation}if(o){for(i=0;i<t.additionalAnnotations.length;i++){s=t.additionalAnnotations[i];l[d+"#"+s.qualifier]=s.annotation}}if(r||o){if(this._oFilterBarViewMetadataExtend[a]===undefined){this._oFilterBarViewMetadataExtend[a]={}}if(this._oFilterBarViewMetadataExtend[a][n]===undefined){this._oFilterBarViewMetadataExtend[a][n]={}}this._oFilterBarViewMetadataExtend[a][n]=l}};W.prototype._isSingleDynamicDateEnabled=function(e){var t=this._bUseDateRangeType&&(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.type==="Edm.String"&&e.isCalendarDate);if(t){return true}var i=this._oAdditionalConfiguration?this._oAdditionalConfiguration.getControlConfigurationByKey(e.fieldName)||this._oAdditionalConfiguration.getControlConfigurationByKey(e.name):null;var a=i&&this._sContext!=="mdcFilterPanel"&&(i.conditionType==="sap.ui.comp.config.condition.DateRangeType"||i.conditionType&&i.conditionType&&typeof i.conditionType==="object"&&i.conditionType.module==="sap.ui.comp.config.condition.DateRangeType")&&(e.type==="Edm.DateTime"||e.type==="Edm.String"&&e.isCalendarDate);return a};W.prototype._setSingleInputsTextArrangementData=function(e){this._sSingleInputsTextArrangementData=Object.assign({},e);return this};W.prototype._setSingleInputsTextArrangementFieldData=function(e,t,i){this._sSingleInputsTextArrangementData[e]={key:t,text:i};return this};W.prototype._setInputsWithCompositeKeysData=function(e){this._sInputsWithCompositeKeysData=Object.assign({},e);return this};W.prototype._setInputsWithCompositeKeysFieldData=function(e,t){this._sInputsWithCompositeKeysData[e]=t;return this};W.prototype._getInputsWithCompositeKeysData=function(e){if(e){return this._sInputsWithCompositeKeysData[e]}return this._sInputsWithCompositeKeysData};W.prototype._getSingleInputsTextArrangementData=function(e){if(e){return this._sSingleInputsTextArrangementData[e]}return this._sSingleInputsTextArrangementData};W.prototype._getFilterTimeZone=function(e){var t=this._oAdditionalConfiguration,i=t?t.getControlConfigurationByKey(e):null,a=null;if(i){a=i.timezone}return a};W.prototype._setControlDocumentationRef=function(e,t){if(t?.String&&e){sap.ui.require(["sap/ui/core/fieldhelp/FieldHelpUtil"],function(i){i.setDocumentationRef(e,t.String)})}};W.prototype.destroy=function(){var e=function(e){var t;if(e){t=e.length;while(t--){e[t].destroy()}}};this._oParentODataModel=null;this._aAnalyticalParameters=null;this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._oParameterization=null;this._oNonAnaParameterization=null;this._aFilterBarFieldNames=null;this._aFilterBarStringDateFieldNames=null;this._aFilterBarDateFieldNames=null;this._aFilterBarTimeFieldNames=null;this._aFilterBarTimeIntervalFieldNames=null;this._aFilterBarDateTimeMultiValueFieldNames=null;this._aFilterBarStringFieldNames=null;this._aFilterBarMultiValueFieldMetadata=null;this._aFilterBarDropdownFieldMetadata=null;this._aFilterBarNumericFieldMetadata=null;this._sSingleInputsTextArrangementData=null;this._sInputsWithCompositeKeysData=null;this._oNotValidatedSingleFields={};this._oSingleFieldSetFromFilterData={};this._aFilterBarDateTimeFieldNames=null;this._aFilterBarDateTimeOffsetWithTimezoneFieldNames=null;this._aFieldGroupAnnotation=null;this._aSelectionFields=null;this._aSelectionVariants=null;if(this._oBasicSearchControl&&this._oBasicSearchControl.destroy){this._oBasicSearchControl.destroy()}this._oBasicSearchControl=null;if(this._oMetadataAnalyser&&this._oMetadataAnalyser.destroy){this._oMetadataAnalyser.destroy()}this._oMetadataAnalyser=null;e(this._aValueHelpDialogProvider);this._aValueHelpDialogProvider=null;e(this._aValueListProvider);this._aValueListProvider=null;if(this._mTokenHandler){for(var t in this._mTokenHandler){var i=this._mTokenHandler[t];if(i.parser){i.parser.destroy();i.parser=null}}delete this._mTokenHandler}this.oResourceBundle=null;this.sIntervalPlaceholder=null;this.sDefaultDropDownDisplayBehaviour=null;this.sDefaultTokenDisplayBehaviour=null;this.sDefaultSingleFieldDisplayBehaviour=null;this._oSmartFilter=null;if(this._oEventProvider){if(this._oEventProvider.destroy){this._oEventProvider.destroy()}this._oEventProvider=null}for(var a in this._mConditionTypeFields){this._mConditionTypeFields[a].conditionType.destroy()}this._mConditionTypeFields=null;if(this.oModel){this.oModel.destroy();this.oModel=null}this._aPromises=[];this.bIsDestroyed=true};return W},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/FilterProviderUtils", ["sap/base/i18n/Localization","sap/ui/base/Object","sap/ui/core/date/UI5Date","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/FilterUtil","sap/ui/comp/library"],function(e,i,t,n,a,l,o,s,r){"use strict";var f=r.smartfilterbar.FilterType,u=r.valuehelpdialog.ValueHelpRangeOperation;var c=i.extend("sap.ui.comp.smartfilterbar.FilterProviderUtils");c.FIELD_NAME_REGEX=/\./g;c.BASIC_SEARCH_FIELD_ID="_BASIC_SEARCH_FIELD";c.BASIC_FILTER_AREA_ID="_BASIC";c.FILTER_MODEL_NAME="fi1t3rM0d31";c.CUSTOM_FIELDS_MODEL_PROPERTY="_CUSTOM";c.ASSOCIATE_VALUE_LISTS="AssociateValueLists";c.INTL_TIMEZONE=Intl.DateTimeFormat().resolvedOptions().timeZone;c.UI_TIMEZONE=e.getTimezone();c._getStringEmptyFilter=function(e,i,t){var l=t?a.NE:a.EQ,o=i&&i.type==="Edm.Guid"?"00000000-0000-0000-0000-000000000000":"";if(i&&i.nullable==="false"){return new n(e,l,o)}else if(i&&i.isDigitSequence){return new n(e,l,i.ui5Type.formatValue("","string",true))}return new n({and:!!t,filters:[new n(e,l,o),new n(e,l,null)]})};c._getFieldMetadata=function(e,i){var t=null;e.some(function(e){if(e&&e.fields){e.fields.some(function(e){if(e&&e.fieldName===i){t=e}return t!==null})}return t!==null});return t};c._getAnalyticalFieldMetadata=function(e,i){var t=null;e.some(function(e){if(e&&e.fieldName===i){t=e}return t!==null});return t};c._getTimezone=function(e,i){var t=e&&e.find(function(e){return e.key===i});if(t){return t.value}return null};c.adaptTime=function(e,i){var t;if(!(e instanceof Date)||!i){return e}if(i.filterRestriction===f.single&&i.control&&i.control.isA("sap.m.DynamicDateRange")){return l.normalizeDate(e,true)}if(i.displayFormat==="Date"){return l.normalizeDate(e,true)}t=parseInt(i.precision);return l.adaptPrecision(e,t)};c.generateFilters=function(e,i,r,f){var p=[],d=null,T=null,m=null,E=null,g=c.FIELD_NAME_REGEX,I=null,w,h,D=null,_=0,v=0,O,F,C,M,U,y,L,S,N,A,x,V=[],B,R,z,Q,b;if(r){O=r.dateSettings;F=r.useContainsAsDefault;C=r.stringFields;M=r.timeFields;L=r.dateTimeOffsetValueFields;V=r.viewMetadataData||[];S=r.dateTimeOffsetWithTimeZone}if(e){if(i){v=e.length;while(v--){y=false;N=false;E=e[v];A=this._getTimezone(S,E);x=c._getFieldMetadata(V,E);if(x&&x.isCustomFilterField){continue}if(x){Q=x.isConstant;b=x.isInitialValueSignificant}if(E&&E!==c.BASIC_SEARCH_FIELD_ID){D=null;U=false;if(F&&C){if(C.indexOf(E)>-1){U=true}}else if(M&&M.indexOf(E)>-1){y=true}else if(L&&L.indexOf(E)>-1){N=true}I=i[E];E=E.replace(g,"/");if(I&&I.hasOwnProperty("low")){if(I.low&&I.high){w=I.low;h=I.high;if(!N&&O&&O.UTC&&w instanceof Date&&h instanceof Date){w=l.localToUtc(w);h=l.localToUtc(h)}w=c.adaptTime(w,x);h=c.adaptTime(h,x);p.push(new n(E,a.BT,w,h))}else if(I.low){if(I.low instanceof Date){w=I.low;if(!N&&O&&O.UTC){w=l.localToUtc(w)}w=c.adaptTime(w,x);p.push(new n(E,a.EQ,w))}else if(typeof I.low==="string"){if(N&&x){D=o.parseDateTimeOffsetInterval(I.low);D[0]=x.ui5Type.parseValue(D[0],"string");if(D.length===1){D[1]=I.low}if(D.length===2){D[1]=x.ui5Type.parseValue(D[1],"string");D[1].setMilliseconds(999)}}else{D=o.parseFilterNumericIntervalData(I.low)}if(D&&D.length===2){D[0]=c.adaptTime(D[0],x);D[1]=c.adaptTime(D[1],x);var P=new n(E,a.BT,D[0],D[1]);if(N){P=o.adaptMilliseconds(P,x.precision,a.BT)}p.push(P)}else if(D&&D.length===1){I[0]=c.adaptTime(I[0],x);p.push(new n(E,a.EQ,D[0]))}else{p.push(new n(E,U?a.Contains:a.EQ,I.low))}}}}else if(I&&I.hasOwnProperty("items")){d=[];m=[];T=null;if(I&&I.hasOwnProperty("ranges")){D=I.ranges;_=D.length;while(_--){B=D[_];w=B.value1;h=B.value2;if(y){if(w instanceof Date){w=o.getEdmTimeFromDate(w)}if(h instanceof Date){h=o.getEdmTimeFromDate(h)}}else if(x&&x.isCalendarDate){if(w instanceof Date){w=x.ui5Type.parseValue(w)}if(h instanceof Date){h=x.ui5Type.parseValue(h)}}else if(!N&&O&&O.UTC){if(w instanceof Date){w=l.localToUtc(w)}if(h instanceof Date){h=l.localToUtc(h);h.setMilliseconds(999)}}else if(N&&A){if(w){w=l.toTimezone(w,A);if(c.UI_TIMEZONE!==c.INTL_TIMEZONE){w=t.getInstance(w)}w=l.localToUtc(w);if(!B.exclude&&(B.operation===a.LT||B.operation===a.LE)||B.exclude&&(B.operation===a.GT||B.operation===a.GE)){w.setMilliseconds(999)}}if(h){h=l.toTimezone(h,A);if(c.UI_TIMEZONE!==c.INTL_TIMEZONE){h=t.getInstance(h)}h=l.localToUtc(h);h.setMilliseconds(999)}}else if(N&&!A){if(w){if(O&&O.UTC){w=l.uiTimezoneToUtc(w);w=l.localToUtc(w)}else{w=l.toTimezone(w,c.INTL_TIMEZONE)}if(!B.exclude&&(B.operation===a.LT||B.operation===a.LE)||B.exclude&&(B.operation===a.GT||B.operation===a.GE)){w.setMilliseconds(999)}}if(h){if(O&&O.UTC){h=l.uiTimezoneToUtc(h);h=l.localToUtc(h)}else{h=l.toTimezone(h,c.INTL_TIMEZONE)}h.setMilliseconds(999)}}w=c.adaptTime(w,x);h=c.adaptTime(h,x);R=B.exclude?m:d;if(B.operation===u.Empty||I?.conditionTypeInfo?.data?.operation==="NODATE"){if(x&&["Edm.DateTime","Edm.DateTimeOffset"].indexOf(x.type)>-1){R.push(new n(E,B.exclude?a.NE:a.EQ,null))}else{R.push(c._getStringEmptyFilter(E,x,B.exclude))}}else if(N){z=B.operation;if(x.filterRestriction==="auto"&&B.operation===a.EQ){h=new Date(w);h.setMilliseconds(999);h=c.adaptTime(h,x);z=a.BT}z=B.exclude?s.getTransformedExcludeOperation(z):z;var P=new n(E,z,w,h);if(x){P=o.adaptMilliseconds(P,x.precision,z)}d.push(P)}else{if(B.operation!==a.BT&&B.operation!==a.NB){h=undefined}z=B.exclude?s.getTransformedExcludeOperation(B.operation):B.operation;R.push(new n(E,z,w,h))}}if(m.length){T=new n(m,true)}}D=I.items;_=D.length;const e=[];while(_--){const i=D[_].key;if(!e.includes(i)){d.push(new n(E,a.EQ,i));e.push(i)}}if(I.value||I.value===0||I.value===false){if(typeof I.value==="string"){I.value=I.value.trim()}d.push(new n(E,U?a.Contains:a.EQ,I.value))}else if(I.value===""&&Q&&b){d.push(new n(E,U?a.Contains:a.EQ,I.value))}if(d.length){if(T){p.push(new n([new n(d,false),T],true))}else{p.push(new n(d,false))}}else if(T){p.push(T)}}else if(x&&x.control&&x.control.isA("sap.m.ComboBox")&&this.isValueSignificant(x)){if(I===null&&x.control.getSelectedKey()===""){I=""}if(x.control.getSelectedItem()){I=c.adaptTime(I,x);p.push(new n(E,U?a.Contains:a.EQ,I))}}else if(I||I===0||I===false){if(typeof I==="string"){I=I.trim()}if(I&&I instanceof Date){if(y){I=o.getEdmTimeFromDate(I)}else if(!N&&O&&O.UTC){I=l.localToUtc(I)}}if(x?.type==="Edm.Boolean"){if(I==="false"){I=false}else if(I==="true"){I=true}}if(I||I===0||I===false){I=c.adaptTime(I,x);p.push(new n(E,U?a.Contains:a.EQ,I))}}else if(I===""&&Q&&b){p.push(new n(E,U?a.Contains:a.EQ,I))}}}}}if(f==="mdcFilterPanel"){return p}return p.length>1?[new n(p,true)]:p};c.isValueSignificant=function(e){var i=e["com.sap.vocabularies.Common.v1.ValueList"]&&e["com.sap.vocabularies.Common.v1.ValueList"].Parameters,t;if(i){t=i.find(function(e){return e.hasOwnProperty("InitialValueIsSignificant")})}if(t&&t["InitialValueIsSignificant"]){return t["InitialValueIsSignificant"].Bool.toLocaleLowerCase()==="true"}return false};return c});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/GroupConfiguration", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,t){"use strict";var r=t.extend("sap.ui.comp.smartfilterbar.GroupConfiguration",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},index:{type:"any",group:"Misc",defaultValue:undefined},label:{type:"any",group:"Misc",defaultValue:undefined}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});r.prototype.setLabel=function(e){this.setProperty("label",e);this.fireChange({propertyName:"label"});return this};return r});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SFBMultiComboBox", ["sap/m/MultiComboBox","sap/m/MultiComboBoxRenderer","sap/ui/comp/util/ComboBoxUtils","sap/m/inputUtils/ListHelpers","sap/ui/base/ManagedObjectObserver"],function(e,t,i,r,o){"use strict";var n=r.CSS_CLASS+"Token";var s=e.extend("sap.ui.comp.smartfilterbar.SFBMultiComboBox",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IDropDownTextArrangement"],properties:{textArrangement:{type:"string",group:"Misc",defaultValue:""}}},renderer:t});s.prototype.init=function(){var t=false;e.prototype.init.apply(this,arguments);this._oObserver=new o(function(e){if(!e){return}if(e.type==="aggregation"&&e.name==="items"&&this.data("__dataReceivedPromise")&&!t){t=true;this.data("__dataReceivedPromise").then(function(){this.fireSelectionChange({stopChangePropagation:true})}.bind(this))}}.bind(this));this._oObserver.observe(this,{aggregations:["items"]})};s.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);this._processTextArrangement()};s.prototype._processTextArrangement=function(){var e,t,r,o,s,a=this.getSelectedKeys(),p=this.getTextArrangement();if(!p||a.length===0){return}for(e=0;e<a.length;e++){r=a[e];o=this.getItemByKey(""+r);s=i.formatDisplayBehaviour(o,p);if(s){t=o.data(n);if(t&&t.isA("sap.m.Token")){t.setText(s)}}}};s.prototype.useHighlightItemsWithContains=function(){return true};s.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this._oObserver=null};return s});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SFBMultiInput", ["sap/m/MultiInput","sap/m/MultiInputRenderer","sap/base/strings/whitespaceReplacer","sap/ui/comp/smartfilterbar/SFBTokenizer","sap/m/library"],function(e,t,i,r,n){"use strict";var o=n.TokenizerRenderMode;var s=e.extend("sap.ui.comp.smartfilterbar.SFBMultiInput",{metadata:{library:"sap.ui.comp",aggregations:{tokenizer:{type:"sap.ui.comp.smartfilterbar.SFBTokenizer",multiple:false,visibility:"hidden"}}},renderer:t});s.prototype._initTokenizer=function(){return new r({renderMode:o.Narrow,tokenDelete:e.prototype._tokenDelete.bind(this)})};s.prototype.setTokens=function(t){t.map(function(e){e.getTextForCopy=this._getTextForCopy.bind(this,e);return e.setText(i(e.getText()))}.bind(this));e.prototype.setTokens.apply(this,arguments);this._pendingAutoTokenGeneration=true;this._getFilterProvider()._tokenUpdate({control:this,fieldViewMetadata:this._getFieldViewMetadata()});this._pendingAutoTokenGeneration=false;this._isOninputTriggered=false};s.prototype._setFilterProvider=function(e){this.oFilterProvider=e};s.prototype._getFilterProvider=function(){return this.oFilterProvider};s.prototype._setFieldViewMetadata=function(e){this.oFieldViewMetadata=e};s.prototype._getFieldViewMetadata=function(){return this.oFieldViewMetadata};s.prototype.oninput=function(){e.prototype.oninput.apply(this,arguments);this._isOninputTriggered=true};s.prototype.addToken=function(){e.prototype.addToken.apply(this,arguments);this._isOninputTriggered=false;return this};s.prototype.insertToken=function(){e.prototype.insertToken.apply(this,arguments);this._isOninputTriggered=false;return this};s.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);if(!this._isOninputTriggered&&this.getValue()){this._pendingAutoTokenGeneration=true;this._validateCurrentText(true);this._pendingAutoTokenGeneration=false}};s.prototype._getTextForCopy=function(e){var t=function(e,t){var i=t[0];for(var r=1;r<t.length;r++){e=e.split(t[r]).join(i)}e=e.split(i);return e},i="\t",r=e.getText(),n,o,s="",a=[],p="",d,l;for(d in this._getFilterProvider()._aValueListProvider){if(this._getFilterProvider()._aValueListProvider[d].sFieldName===this.oFieldViewMetadata.name){n=this._getFilterProvider()._aValueListProvider[d];s=n.sTokenDisplayBehaviour}}o=s?s:"";l=this._getCondition(r);p=r;if(o&&!l){a=t(r,["(",")"]);if(o==="descriptionAndId"){p=[a[1],a[0]].join(i)}else if(o==="idAndDescription"){p=[a[0],a[1]].join(i)}else if(o==="descriptionOnly"){p=[e.getKey(),e.getText()].join(i)}else{p=r}}return p};s.prototype._getCondition=function(e){return this._getFilterProvider()._mTokenHandler&&this._getFilterProvider()._mTokenHandler[this.getId()]?.parser?._onValidate(e)?.data()};return s});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SFBSearchField", ["sap/m/SearchField","sap/ui/comp/smartfilterbar/SFBSearchFieldRenderer","sap/m/delegate/ValueStateMessage","sap/ui/core/Lib","sap/ui/core/library","sap/ui/core/InvisibleMessage"],function(e,t,a,s,i,r){"use strict";var o=i.ValueState;var u=1e3;var l="sapMSFContentWrapperError";var n=e.extend("sap.ui.comp.smartfilterbar.SFBSearchField",{metadata:{library:"sap.ui.comp",properties:{valueState:{type:"sap.ui.core.ValueState",group:"Appearance",defaultValue:o.None},valueStateText:{type:"string",group:"Misc",defaultValue:null}}},renderer:t});n.prototype.init=function(){e.prototype.init.apply(this,arguments);this._oCoreRB=s.getResourceBundleFor("sap.ui.core");this._oValueState=new a(this);this._oInvisibleMessage=r.getInstance();this.addEventDelegate({onfocusin:function(){this.addStyleClass("sapMFocus");this._oValueState.open()}.bind(this),onfocusout:function(){this.validateValue();this._oValueState.close()}.bind(this)})};n.prototype._validateBasicSearchLength=function(){return this.getValue()?.length>1e3?false:true};n.prototype.validateValue=function(){var e=this._validateBasicSearchLength(),t=this.getValueState();if(e&&t===o.Error){this.setValueState(o.None);this.removeStyleClass(l)}else if(!e&&t===o.None){this.addStyleClass(l);this.setValueState(o.Error)}this.setValueStateText(this._oCoreRB.getText("EnterTextMaxLength",[u]));return e};n.prototype.getValueStateMessageId=function(){return this.getId()+"-message"};n.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this._oValueState.destroy();this._oValueState=null;this._oCoreRB=null};n.prototype.getDomRefForValueStateMessage=function(){return this.getDomRef()};return n});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SFBSearchFieldRenderer", ["sap/ui/core/Renderer","sap/m/SearchFieldRenderer","sap/ui/core/library","sap/ui/core/Lib","sap/ui/core/ControlBehavior","sap/ui/core/ValueStateSupport"],function(e,t,a,r,n,s){"use strict";const i=a.ValueState;const o=r.getResourceBundleFor("sap.m");const c=e.extend(t);c.apiVersion=2;c.renderValueStateAccDom=function(e,t){const a=t.getValueState(),r=n.isAccessibilityEnabled();if(a===i.None||!t.getEnabled()||!r){return}const c=o.getText("INPUTBASE_VALUE_STATE_"+a.toUpperCase());e.openStart("div",t.getValueStateMessageId()+"-sr").class("sapUiPseudoInvisibleText");e.openEnd().text(c).text(" ");e.text(t.getValueStateText()||s.getAdditionalText(t));e.close("div")};c.render=function(e,a){t.render.apply(this,arguments);this.renderValueStateAccDom(e,a)};return c},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SFBTokenizer", ["sap/m/Tokenizer","sap/m/TokenizerRenderer"],function(t,e){"use strict";var a=t.extend("sap.ui.comp.smartfilterbar.SFBTokenizer",{metadata:{library:"sap.ui.comp"},renderer:e});a.prototype._copy=function(){this._fillClipboard("copy")};a.prototype._cutToClipboard=function(t){const e=this._sTokensTextsHTML||"";const a=this._sTokensTexts||"";const i=this._bSpecial||false;if(t.clipboardData){t.clipboardData.setData("text/plain",a);if(i){t.clipboardData.setData("text/html",e)}}else{t.originalEvent.clipboardData.setData("text/plain",a);if(i){t.originalEvent.clipboardData.setData("text/html",e)}}t.preventDefault()};a.prototype._fillClipboard=function(t){var e=this.getSelectedTokens();var a=false;var i=e.map(function(t){if(!a&&t.getTextForCopy){a=true}return t.getTextForCopy?t.getTextForCopy():t.getText()}).join("\r\n");var o="<table><tr>"+e.map(function(t){return"<td>"+t.getText()+"</td>"}).join("</tr><tr>")+"</tr></table>";this._sTokensTextsHTML=o;this._sTokensTexts=i;this._bSpecial=a;var r=this._cutToClipboard.bind(this);document.addEventListener(t,r);document.execCommand(t);document.removeEventListener(t,r)};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SelectOption", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/model/FilterOperator"],function(e,r,t){"use strict";var i=r.extend("sap.ui.comp.smartfilterbar.SelectOption",{metadata:{library:"sap.ui.comp",properties:{sign:{type:"sap.ui.comp.smartfilterbar.SelectOptionSign",group:"Misc",defaultValue:"I"},operator:{type:"string",group:"Misc",defaultValue:"EQ"},low:{type:"string",group:"Misc",defaultValue:null},high:{type:"string",group:"Misc",defaultValue:null}}},setOperator(e){if(e!=null&&!(e in t)){throw new Error(`"${e}" is not a valid sap.ui.model.FilterOperator`)}return this.setProperty("operator",e)}});i.SIGN=e.smartfilterbar.SelectOptionSign;i.OPERATOR=t;return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SmartFilterBar", ["sap/m/MessageBox","sap/ui/comp/util/DateTimeUtil","sap/ui/base/ManagedObjectObserver","sap/ui/comp/filterbar/FilterBar","sap/ui/comp/smartfilterbar/SmartFilterBarFilterGroupItem","sap/ui/comp/filterbar/FilterItem","sap/ui/comp/library","./AdditionalConfigurationHelper","./ControlConfiguration","./FilterProvider","sap/ui/comp/smartfilterbar/FilterProviderUtils","./GroupConfiguration","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/comp/odata/ODataModelUtil","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/library","sap/ui/core/Messaging","sap/ui/core/date/UI5Date","sap/ui/comp/variants/VariantItem","sap/ui/model/odata/AnnotationHelper","sap/ui/model/Context","sap/ui/comp/filterbar/VariantConverterFrom","sap/base/Log","sap/base/util/merge","sap/ui/Device","sap/ui/performance/trace/FESRHelper","sap/ui/comp/rules/RulesLog","sap/ui/comp/odata/MetadataAnalyser"],function(e,t,i,r,a,n,o,s,l,d,u,h,f,c,p,g,_,m,F,y,S,v,V,b,C,P,A,I,M,T,B){"use strict";var E=F.ValueState;var D=o.smartfilterbar.FilterType;var N=o.ANALYTICAL_PARAMETER_PREFIX;var L=r.extend("sap.ui.comp.smartfilterbar.SmartFilterBar",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartfilterbar/SmartFilterBar.designtime",properties:{entityType:{type:"string",group:"Misc",defaultValue:null,deprecated:true},entitySet:{type:"string",group:"Misc",defaultValue:null},resourceUri:{type:"string",group:"Misc",defaultValue:null},basicSearchFieldName:{type:"string",group:"Misc",defaultValue:null},enableBasicSearch:{type:"boolean",group:"Misc",defaultValue:false},liveMode:{type:"boolean",group:"Misc",defaultValue:false},showMessages:{type:"boolean",group:"Misc",defaultValue:false},considerAnalyticalParameters:{type:"boolean",group:"Misc",defaultValue:false},useDateRangeType:{type:"boolean",group:"Misc",defaultValue:null},suppressSelection:{type:"boolean",group:"Misc",defaultValue:false},considerSelectionVariants:{type:"boolean",group:"Misc",defaultValue:false},defaultSelectionVariantName:{type:"string",group:"Misc",defaultValue:null},useProvidedNavigationProperties:{type:"boolean",group:"Misc",defaultValue:false},navigationProperties:{type:"string",group:"Misc",defaultValue:""},considerPresentationVariant:{type:"boolean",group:"Misc",defaultValue:true}},associations:{smartVariant:{type:"sap.ui.comp.smartvariants.SmartVariantManagement",multiple:false}},aggregations:{controlConfiguration:{type:"sap.ui.comp.smartfilterbar.ControlConfiguration",multiple:true,singularName:"controlConfiguration"},groupConfiguration:{type:"sap.ui.comp.smartfilterbar.GroupConfiguration",multiple:true,singularName:"groupConfiguration"}},events:{pendingChange:{parameters:{pendingValue:{type:"boolean"}}}}},renderer:{apiVersion:2}});L.LIVE_MODE_INTERVAL=300;L.SELECTION_VARIANT_KEY_PREFIX="#";L.prototype.init=function(){if(!d){d=sap.ui.require("sap/ui/comp/smartfilterbar/FilterProvider")}this._oResourceBundle=m.getResourceBundleFor("sap.ui.comp");this._bCreateFilterProviderCalled=false;this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._bSetFilterDataSuspended=false;this.bNotFirstTimeOpen=false;this._oStoredFilterData={};this._oObservers=[];this._bSetFilterDataFromVariant=false;r.prototype.init.apply(this);y.registerObject(this,true);this.getMetadata().addPublicMethods(["suspendSelection","resumeSelection"]);this._oRulesLog=new T};L.prototype._applyFESRSemantic=function(e,t,i){if(!e||!t){return}if(!i){i="press"}t=t.slice(0,20);M.setSemanticStepname(e,i,t)};L.prototype.onBeforeRendering=function(){r.prototype.onBeforeRendering.apply(this,arguments);this._applyFESRSemantic(this._getSearchButton(),"sc:sfbGo");this._applyFESRSemantic(this._getHideShowButton(),"sc:sfbShowHideToggle");this._applyFESRSemantic(this._getClearButton(),"sc:sfbClear");this._applyFESRSemantic(this._getRestoreButton(),"sc:sfbRestore");this._applyFESRSemantic(this._getFiltersButton(),"sc:sfbAdaptFilters")};L.prototype._initializeMetadata=function(){if(!this.bIsInitialised){g.handleModelInit(this,this._onMetadataInitialised,!this.getIsRunningInValueHelpDialog())}};L.prototype._onMetadataInitialised=function(){var e,t,i,r;this._bMetaModelLoadAttached=false;if(!this.bIsInitialised&&!this._bCreateFilterProviderCalled){t=this.getModel();e=this.getResourceUri();i=this.getEntityType();r=this.getEntitySet();if((t||e)&&(i||r)){this._bCreateFilterProviderCalled=true;this._createFilterProvider(t,e,i,r).then(function(e){if(!e){return}if(this.bIsDestroyed){e.destroy();return}this._oFilterProvider=e;this._aFilterBarViewMetadata=e.getFilterBarViewMetadata();this._aAnalyticalFilterBarViewMetadata=e.getAnalyticParameters();this._oFilterBarViewMetadataExtend=e._getFilterBarViewMetadataExtend();if(this._aFilterBarViewMetadata){this._attachAdditionalConfigurationChanged();this.bIsInitialised=true;this.setModel(e.oModel,e.sFilterModelName);this.registerGetFiltersWithValues(this.getFiltersWithValues.bind(this));this.registerFetchData(function(e){return this.getFilterDataAsStringForVariant(true,e)}.bind(this));this.registerApplyData(function(e,t){this.setFilterDataAsStringFromVariant(e,true,t)}.bind(this));this._initializeVariantManagement()}e.attachPendingChange(function(e){this.firePendingChange({pendingValue:e.getParameter("pending")})}.bind(this))}.bind(this))}}};L.prototype._setInitialFocus=function(){var e=this.getAssociation("smartVariant");e=e||this.getConsiderSelectionVariants();var t=this.getBasicSearchControl(),i=this.getAllFilterItems(true),r;if(!e){if(this.getEnableBasicSearch()){this._onAfterRenderingBasicSearchDelegate={onAfterRendering:function(){setTimeout(function(){t.focus();t.removeDelegate(this._onAfterRenderingBasicSearchDelegate)}.bind(this))}.bind(this)};t.addDelegate(this._onAfterRenderingBasicSearchDelegate,this)}else if(i.length>0){r=i[0]._getControl();this._onAfterRenderingFirstFilterVisibleFieldDelegate={onAfterRendering:function(){setTimeout(function(){r.focus();r.removeDelegate(this._onAfterRenderingFirstFilterVisibleFieldDelegate)}.bind(this))}.bind(this)};r.addDelegate(this._onAfterRenderingFirstFilterVisibleFieldDelegate,this)}}};L.prototype.getModelData=function(){return this._oFilterProvider?this._oFilterProvider.getModel().getData():null};L.prototype.getFilterContextUrl=function(){return this._oFilterProvider?this._oFilterProvider.getFilterContextUrl():null};L.prototype.getParameterContextUrl=function(){return this._oFilterProvider?this._oFilterProvider.getParameterContextUrl():null};L.prototype.getFilterBarViewMetadata=function(e){var t;if(this._aFilterBarViewMetadata===null){return[]}t=Object.assign({},this._aFilterBarViewMetadata);t=this._aFilterBarViewMetadata.map(function(t){var i=Object.assign({},t);if(e&&this._oFilterBarViewMetadataExtend!==null){i.fields=i.fields.map(function(e){var t,i=e.groupName,r=e.fullName,a=this._oFilterBarViewMetadataExtend[i]&&this._oFilterBarViewMetadataExtend[i][r];if(a!==undefined){t=Object.assign({},e,a)}else{t=Object.assign({},e)}return t}.bind(this))}return i}.bind(this));return t};L.prototype.getAnalyticalParameters=function(){return this._oFilterProvider?this._oFilterProvider.getAnalyticParameters():[]};L.prototype.getSelectionVariants=function(){var e=null;if(this._oFilterProvider){e=this._oFilterProvider.getSelectionVariants();if(Object.keys(e).length<1){e=null}}return e};L.prototype._createFilterProvider=function(e,t,i,r){return d._createFilterProvider({basicSearchFieldName:this.getBasicSearchFieldName(),enableBasicSearch:this.getEnableBasicSearch(),entityType:i,entitySet:r,serviceUrl:t,isRunningInValueHelpDialog:this.getIsRunningInValueHelpDialog(),model:e,additionalConfiguration:this.getAdditionalConfiguration(),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),defaultTokenDisplayBehaviour:this.data("defaultTokenDisplayBehaviour"),defaultSingleFieldDisplayBehaviour:this.data("defaultSingleFieldDisplayBehaviour"),defaultFilterBarExpanded:this.data("defaultFilterBarExpanded"),defaultShowAllFilters:this.data("defaultShowAllFilters"),dateFormatSettings:this.data("dateFormatSettings"),calendarWeekSettings:this.data("calendarWeekSettings"),showCurrentDateButton:this.data("showCurrentDateButton"),useContainsAsDefaultFilter:this.data("useContainsAsDefaultFilter"),showSelectAll:this.data("showSelectAll"),smartFilter:this,filterBarClass:L,considerAnalyticalParameters:this.getConsiderAnalyticalParameters(),useDateRangeType:this.getUseDateRangeType(),considerSelectionVariants:this.getConsiderSelectionVariants(),considerNavigations:this.getUseProvidedNavigationProperties()?this._createArrayFromString(this.getNavigationProperties()):null,suppressValueListsAssociation:this.getSuppressValueListsAssociation()})};L.prototype._createArrayFromString=function(e){var t=[];if(e){e.split(",").forEach(function(e){t.push(e.trim())});return t}else{return[]}};L.prototype._attachAdditionalConfigurationChanged=function(){var e,t,i,r;t=this.getGroupConfiguration();r=t.length;for(i=0;i<r;i++){t[i].attachChange(this._handleGroupConfigurationChanged.bind(this))}e=this.getControlConfiguration();r=e.length;for(i=0;i<r;i++){e[i].attachChange(this._handleControlConfigurationChanged.bind(this))}};L.prototype._handleControlConfigurationChanged=function(e){var t,i,r,a,n;t=e.getParameter("propertyName");i=e.oSource;if(!i){return}a=i.getKey();r=this._getFilterItemByName(a);if(!r){this._handleControlConfigurationChangedForDelayedFilterItems(a,i,t);return}if(t==="visible"){n=i.getVisible();r.setVisible(n)}else if(t==="label"){n=i.getLabel();r.setLabel(n)}else if(t==="visibleInAdvancedArea"){n=i.getVisibleInAdvancedArea();if(r.setVisibleInFilterBar){r.setVisibleInFilterBar(n)}}};L.prototype._handleControlConfigurationChangedForDelayedFilterItems=function(e,t,i){var r,a;if(this._aFilterBarViewMetadata){this._aFilterBarViewMetadata.some(function(t){t.fields.some(function(t){if(t.fieldName===e){a=t}return!!a});return!!a})}if(a){if(i==="visible"){r=t.getVisible();a.isVisible=r}else if(i==="label"){r=t.getLabel();a.label=r}else if(i==="visibleInAdvancedArea"){r=t.getVisibleInAdvancedArea();a.visibleInAdvancedArea=r}}};L.prototype._handleGroupConfigurationChanged=function(e){var t,i;t=e.getParameter("propertyName");i=e.oSource;if(t==="label"){this._handleGroupConfigurationLabelChanged(i)}};L.prototype._handleGroupConfigurationLabelChanged=function(e){var t,i,r;if(!e){return}r=e.getLabel();i=e.getKey();t=this._getFilterGroupItemByGroupName(i);if(t){t.setGroupTitle(r)}else{this._handleGroupConfigurationLabelChangedForDelayedFilterItems(i,r)}};L.prototype._handleGroupConfigurationLabelChangedForDelayedFilterItems=function(e,t){var i=null;if(this._aFilterBarViewMetadata){this._aFilterBarViewMetadata.some(function(t){if(t.groupName===e){i=t}return!!i})}if(i){i.groupLabel=t}};L.prototype._getFilterItemByName=function(e){return this.determineFilterItemByName(e)};L.prototype._getFilterGroupItemByGroupName=function(e){return this.determineFilterItemByName(e)};L.prototype.determineControlByFilterItem=function(e,t){P.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#determinControlByFilterItem. Consider changing it with proper one.");return this._determineControlByFilterItem.apply(this,arguments)};L.prototype._determineControlByFilterItem=function(e,t){return r.prototype.determineControlByFilterItem.apply(this,arguments)};L.prototype.determineControlByName=function(e,t){P.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#determineControlByName. Consider changing it with proper one.");return this._determineControlByName.apply(this,arguments)};L.prototype._determineControlByName=function(e,t){return r.prototype.determineControlByName.apply(this,arguments)};L.prototype.getAdditionalConfiguration=function(){return new s(this.getControlConfiguration(),this.getGroupConfiguration())};L.prototype.setEntityType=function(e){this.setProperty("entityType",e);this._initializeMetadata();return this};L.prototype.setEntitySet=function(e){this.setProperty("entitySet",e);this._initializeMetadata();return this};L.prototype.setResourceUri=function(e){this.setProperty("resourceUri",e);this._initializeMetadata();return this};L.prototype.propagateProperties=function(){r.prototype.propagateProperties.apply(this,arguments);this._initializeMetadata()};L.prototype._getFilterInformation=function(){var e=this.data("hiddenFields"),t,i,a,n=0,o=0,s,l=[],d;if(this._aFilterBarViewMetadata){n=this._aFilterBarViewMetadata.length;for(i=0;i<n;i++){t=this._aFilterBarViewMetadata[i];s=t.fields;o=s.length;for(a=0;a<o;a++){d=s[a];if(Array.isArray(e)&&e.indexOf(d.name)!==-1){continue}else if(d.name===u.BASIC_SEARCH_FIELD_ID){this.setBasicSearch(d.control);this._attachToBasicSearch(d.control);continue}else if(t.groupName===u.BASIC_FILTER_AREA_ID){this._createFieldInAdvancedArea({groupName:r.INTERNAL_GROUP,groupLabel:""},d)}else{this._createFieldInAdvancedArea(t,d)}l.push(d)}}var h=this.getAnalyticalParameters();n=h.length;for(i=0;i<n;i++){d=h[i];this._createAnalyticParameter(d);l.push(d)}}return l};L.prototype._validateState=function(){var e,t,i,r=false;e=this.getAllFilterItems(true);if(Array.isArray(e)){t=e.length;while(t--){i=this._determineControlByFilterItem(e[t],true);if(i){if(i.__bValidatingToken){this.bIsSearchPending=true;r=true;break}else if(i.getValueState&&i.getValueState()===E.Error&&!i.data("__mandatoryEmpty")){r=true;break}}}}if(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields){var a=Object.keys(this._oFilterProvider._mConditionTypeFields);for(var n=0;n<a.length;n++){var o=a[n];var s=this._oFilterProvider._mConditionTypeFields[o].conditionType;i=s&&s._oInput;if(i&&i.getValueState&&i.getValueState()===E.Error&&!i.data("__mandatoryEmpty")){r=true;break}}}if(this._oFilterProvider){return!r&&!this._oFilterProvider._validateConditionTypeFields(this._bForceError)}else{return!r}};L.prototype._isDateRangeTypeFilter=function(e){return!!(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields[e])};L.prototype._specialControls=function(e,t){return!!(e.setValue&&(this._isDateRangeTypeFilter(t)||e.isA("sap.m.DatePicker")))};L.prototype._clearErroneusControlValues=function(){var e,t,i,r,a,n=null,o=false;e=this.getAllFilterItems(false);if(e){t=e.length;while(t--){i=this._determineControlByFilterItem(e[t],true);if(i){if(i.getValueState&&i.getValueState()===E.Error){r=i.getBinding("value");a=this._oFilterProvider.oModel;if(a){n=a.getProperty("/"+e[t].getName())}o=n!==null&&n!==undefined&&(n===i.getValue()||typeof n.hasOwnProperty==="function"&&n.hasOwnProperty("value")&&n.value===i.getValue());if(r&&!o&&!this._specialControls(i,e[t].getName())){r.checkUpdate(true)}else if(i.data("__validationError")){if(i.isA("sap.m.MultiInput")){i.setValueState(E.None);i.setValue("")}else if(i.isA("sap.m.Input")){i.setValueState(E.None);i.setValue(n);if(n!==null){i.fireChange({value:n,newValue:n})}}}else if(i.setValue){i.resetProperty("value");i.setValueState(E.None)}}}}}};L.prototype._attachToBasicSearch=function(e){if(e){e.attachSearch(function(e){if(e&&e.getParameter("clearButtonPressed")){return}if(!this.isDialogOpen()){this._searchFromFilterBar()}}.bind(this));e.attachChange(this._onChange.bind(this))}};L.prototype._onLiveChange=function(e){var t=e.getSource();if(t.data("__validationError")&&!t.getValue()){t.data("__validationError",null);t.setValueState(E.None);delete t.__sValidationText}};L.prototype._onChange=function(e){var t=e.getSource(),i=t._oFieldViewMetadata,r=this._oFilterProvider._oMetadataAnalyser,a=this._oFilterProvider._bUpdatingFilterData||this._oFilterProvider._bCreatingInitialModel;if(i&&i.hasValueListAnnotation&&!t.addValidator&&t.attachSuggestionItemSelected){var n=this._oFilterProvider._aValueListProvider.find(e=>e._fieldViewMetadata.fieldNameOData===i.name);n?._validateStringSingleWithValueList(e)}if(t.data("__mandatoryEmpty")){t.data("__mandatoryEmpty",null);t.setValueState(E.None)}if(t.data("__validationError")&&!t.getValue()){t.data("__validationError",null);t.setValueState(E.None)}if(t.isA("sap.m.ComboBox")&&t.getValue()){this._filterSetInErrorState(t);if(!t.getSelectedItem()){t.data("__validationError",true);t.setValueStateText(this._oResourceBundle.getText("FILTER_BAR_FIELD_ERROR"));t.setValueState(E.Error);if(!a){this.fireFilterChange(e)}return}if(t.data("__validationError")){t.data("__validationError",null);t.setValueState(E.None)}}if(i&&r&&r.getMultiUnitBehaviorEnabled()){if(i.isMeasureField){this._setWarningState(t)}if(B.isUnitOfMeasure(i)||B.isCurrencyCode(i)){this._clearWarningState(t)}}if(a){return}if(!t||t&&!t.__bValidatingToken){this.fireFilterChange(e);this._oFilterProvider._updateConditionTypeFields(e.getParameter("filterChangeReason"))}else{this._filterSetInErrorState(t)}if(this.isLiveMode()){if(e.getSource().isA("sap.m.MultiComboBox")||e.getSource().isA("sap.m.ComboBox")){this.triggerSearch()}else{this._searchFromFilterBar()}}};L.prototype._setWarningState=function(e){var t=e._oFieldViewMetadata,i=this._oFilterProvider&&this._oFilterProvider._getFieldMetadata(t.unit),r=i&&i.label,a=this._oResourceBundle.getText("UNIT_WARNING_TEXT",[r]),n=this._checkIfFilterHasValue(t.name),o=i&&this._checkIfFilterHasValue(i.name);if(!i||i.filterRestriction==="single"||B.isHidden(i)||B.isHiddenFilter(i)){return}if(!o&&n){setTimeout(function(){e.setValueState(E.Warning);e.setValueStateText(a)})}if(!n){e.setValueState(E.None)}};L.prototype._clearWarningState=function(e){var t=e._oFieldViewMetadata,i=t&&t.name,r=t&&t.label,a=this._oResourceBundle.getText("UNIT_WARNING_TEXT",[r]),n,o=this._checkIfFilterHasValue(t.name),s;if(t.filterRestriction==="single"){return}this._oFilterProvider.aAllFields.forEach(function(e){if(e.isCurrencyField&&e["Org.OData.Measures.V1.ISOCurrency"].Path===i||e.isMeasureField&&e["Org.OData.Measures.V1.Unit"]&&e["Org.OData.Measures.V1.Unit"].Path===i){n=this.getControlByKey(e.name);if(n){s=this._checkIfFilterHasValue(e.name);if(o&&n.getValueState()===E.Warning){n.setValueState(E.None)}if(!o&&s&&n.getValueState()===E.None){n.setValueState(E.Warning);n.setValueStateText(a)}}}}.bind(this))};L.prototype._handleChange=function(e){if(e){if(e.attachChange){e.attachChange(this._onChange.bind(this))}if(e.attachLiveChange){e.attachLiveChange(this._onLiveChange.bind(this))}}};L.prototype._handleSelectionChange=function(e){if(e){if(e.attachSelectionChange){e.attachSelectionChange(this._onChange.bind(this))}}};L.prototype._handleEnter=function(e){if(this.isLiveMode()){return}e.attachBrowserEvent("keydown",function(t){if(t.which===13){e.__bSuggestInProgress=e._oSuggestionPopup&&e._oSuggestionPopup.isOpen()}});e.attachBrowserEvent("keyup",function(t){if(e.isA("sap.m.DynamicDateRange")&&e._oPopup?.isOpen()){return}if(t.which===13&&!e.__bSuggestInProgress&&(e.isA("sap.m.InputBase")||e.isA("sap.m.Select")||e.isA("sap.m.DynamicDateRange"))){this._searchFromFilterBar()}}.bind(this))};L.prototype._createFilterFieldControl=function(e){if(e.conditionType){e.control=e.conditionType.initializeFilterItem()}else if(!e.control&&e.fCreateControl){e.fCreateControl(e);delete e.fCreateControl}this._handleEnter(e.control);this._handleChange(e.control);if(e.isCustomFilterField&&e.control.isA("sap.m.MultiComboBox")){this._handleSelectionChange(e.control)}};L.prototype._createAnalyticParameter=function(e){e.factory=function(){this._createFilterFieldControl(e);if(!e.control){return}var t=new a({controlTooltip:e.quickInfo,name:e.fieldName,mandatory:e.isMandatory,visible:e.isVisible,control:e.control,hiddenFilter:false});this._setLabel(t,e.label);this._addParameter(t)}.bind(this);e.groupName=r.INTERNAL_GROUP;return e};L.prototype._createFieldInAdvancedArea=function(e,t){t.factory=function(){this._createFilterFieldControl(t);var i=new a({controlTooltip:t.quickInfo,name:t.fieldName,groupName:e.groupName,groupTitle:e.groupLabel,entitySetName:t.groupEntitySet,entityTypeName:t.groupEntityType,mandatory:t.isMandatory,visible:t.isVisible,visibleInAdvancedArea:t.visibleInAdvancedArea||e.groupName===r.INTERNAL_GROUP,visibleInFilterBar:t.visibleInAdvancedArea||e.groupName===r.INTERNAL_GROUP,control:t.control,hiddenFilter:t.hiddenFilter});if(t.isCustomFilterField){i.data("isCustomField",true);this._attachCustomControlCustomDataChange(i._getControl().getCustomData())}if(t.control&&t.control.getTooltip&&t.control.getTooltip()){i.setControlTooltip(t.control.getTooltip())}if(t.quickInfo){this._setLabelTooltip(i,t.quickInfo)}this._setLabel(i,t.label);this.addFilterGroupItem(i)}.bind(this);t.groupName=e.groupName;t.groupTitle=e.groupLabel;return t};L.prototype._setLabel=function(e,t){if(t.match(/{@i18n>.+}/gi)){e.bindProperty("label",t.substring(1,t.length-1))}else{e.setLabel(t)}};L.prototype._setLabelTooltip=function(e,t){var i=/{(@?i18n>.+)}/i.exec(t);if(i&&i[1]){e.bindProperty("labelTooltip",i[1])}else{e.setLabelTooltip(t)}};L.prototype._logAccessWhenNotInitialized=function(e){if(!this.bIsInitialised){P.error("SmartFilterBar."+e+": called before the SmartFilterBar is initialized")}};L.prototype.ensureLoadedValueHelp=function(e){this._logAccessWhenNotInitialized("ensureLoadedValueHelp");if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueHelpProviders().some(function(t){if(t.sFieldName===e){this._ensureLoadedValueHelpList(t);return true}}.bind(this))}};L.prototype.ensureLoadedValueList=function(e){if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueListProviders().some(function(t){if(t.sFieldName===e){this._ensureLoadedValueHelpList(t);return true}}.bind(this))}};L.prototype._ensureLoadedValueHelpList=function(e){if(!e._bValueListRequested){e.loadAnnotation().catch(function(e){})}};L.prototype._getValueListHelpProvider=function(e){var t=null;if(this._oFilterProvider){this._oFilterProvider.getAssociatedValueListProviders().some(function(i){if(i.sFieldName===e){t=i}return t!=null});if(!t){this._oFilterProvider.getAssociatedValueHelpProviders().some(function(i){if(i.sFieldName===e){t=i}return t!=null})}}return t};L.prototype.getDescriptionForKeys=function(e){var t=[];if(e){e.forEach(function(e){var i=this._getValueListHelpProvider(e.filterName);if(i){if(!i._bValueListRequested){i.loadAnnotation()}e.provider=i;t.push(e)}}.bind(this));if(t&&t.length>0){t.forEach(function(e){if(e.provider){e.provider.readData(e.keys)}})}}};L.prototype.ensureLoadedValueHelpList=function(e){this.ensureLoadedValueHelp(e);this.ensureLoadedValueList(e)};L.prototype.getFilters=function(e){this._logAccessWhenNotInitialized("getFilters");if(!e||!e.length){if(this.getIsRunningInValueHelpDialog()){e=this._getAllFieldNames()}else{e=this._getVisibleFieldNames(true)}}return this._oFilterProvider?this._oFilterProvider.getFilters(e):[]};L.prototype.getParameters=function(){this._logAccessWhenNotInitialized("getParameters");return this._oFilterProvider?this._oFilterProvider.getParameters():{}};L.prototype.getAnalyticBindingPath=function(){var e="";this._logAccessWhenNotInitialized("getAnalyticBindingPath");if(this._oFilterProvider){e=this._oFilterProvider.getAnalyticBindingPath()}return e};L.prototype.getParameterBindingPath=function(){return this.getAnalyticBindingPath()};L.prototype.getControlByKey=function(e){P.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBar#getControlByKey. Consider changing it with proper one.");this._logAccessWhenNotInitialized("getControlByKey");if(this._oRulesLog){this._oRulesLog.setInvokedMethod("getControlByKey",true)}return this._determineControlByName(e)};L.prototype._getAllFieldNames=function(){var e,t=[],i,r,a;if(this._oFilterProvider&&this._oFilterProvider._oMetadataAnalyser){e=this._oFilterProvider._oMetadataAnalyser.getFieldsByEntitySetName(this.getEntitySet())}if(e){r=e.length;for(i=0;i<r;i++){a=e[i];if(a){t.push(a.name)}}}return t};L.prototype._getAllFilterAndParameterNames=function(e){var t=[],i=this.getAllFilterItems(false),r=i.length,a;while(r--){a=i[r];if(a){if(e&&a._isParameter()){continue}t.push(a.getName())}}return t};L.prototype._getVisibleFieldNames=function(e,t){var i=[],r=this.getAllFilterItems(true),a=r.length,n,o,s,l=false;if(t===undefined){t=true}while(a--){n=r[a];if(!n){continue}o=n._getControl&&n._getControl();s=n._isParameter()&&e;if(!t&&o&&o.getValueState&&o.getValueState()===E.Error){l=true}if(s||l){l=false;continue}i.push(n.getName())}return i};L.prototype._checkHasValueData=function(e){if(!e||e==="false"){return false}if(typeof e==="boolean"){return e}else if(typeof e==="string"&&e.toLowerCase()==="true"){return true}return false};L.prototype._checkForValues=function(e,t,i){var r,a=null,n;if(e&&t&&i){r=t.getName();if(!t.data("isCustomField")){a=e[r];if(!a&&i.getSelectedItem&&i.getSelectedItem()){n=u._getFieldMetadata(this._aFilterBarViewMetadata,r);if(n&&n.type==="Edm.Boolean"){if(i.getSelectedItem().getKey()===""){return false}}return true}if(!a&&i.getSelectedKey&&i.getSelectedKey()){return true}if(r.indexOf(N)===0&&Array.isArray(this._aAnalyticalFilterBarViewMetadata)){n=u._getAnalyticalFieldMetadata(this._aAnalyticalFilterBarViewMetadata,r)}else if(Array.isArray(this._aFilterBarViewMetadata)){n=u._getFieldMetadata(this._aFilterBarViewMetadata,r)}if(a===undefined){return false}}else{var o=i.data("hasValue");if(o!==undefined&&o!=null){return this._checkHasValueData(o)}else{if(i.getValue){if(i.getValue()){return true}}if(i.getSelectedItem&&i.getSelectedItem()){return true}if(i.getSelectedKey&&i.getSelectedKey()){return true}if(i.getSelectedKeys&&i.getSelectedKeys().length>0){return true}if(i.getTokens&&i.getTokens().length>0){return true}}}}return!!a||a===0};L.prototype.getFiltersWithValues=function(){this._logAccessWhenNotInitialized("getFiltersWithValues");return this._getFiltersWithAssignedValues(true)};L.prototype.getAllFiltersWithValues=function(){return this._getFiltersWithAssignedValues(false)};L.prototype._getFiltersWithAssignedValues=function(e){var t,i=[];var r=this.getAllFilterItems(e),a,n,o=0,s;if(e){a=this.getFilterData()}else if(this._oFilterProvider){a=this._bSetFilterDataSuspended?this._oStoredFilterData:this._oFilterProvider.getFilledFilterData(this._getAllFilterAndParameterNames())}if(r&&a){o=r.length;while(o--){n=r[o];s=this._determineControlByFilterItem(n,true);t=this._checkForValues(a,n,s);if(t&&s.isA("sap.m.ComboBox")){t=this._validateComboBox(n,s)}if(t){i.push(n)}}}return i.reverse()};L.prototype._checkIfFilterHasValue=function(e,t){var i=t||this._oFilterProvider.getFilterData();var r=i[e];if(r===null||typeof r==="undefined"){r=i._CUSTOM&&i._CUSTOM[e]}if(r===null||typeof r==="undefined"){return false}if(typeof r==="string"&&r){return true}if(typeof r==="number"){return true}if(typeof r==="object"&&Object.prototype.toString.call(r)==="[object Date]"){return true}if(typeof r==="object"&&(r.hasOwnProperty("low")||r.hasOwnProperty("high"))){return!!r.low||!!r.high}if(typeof r==="object"&&(r.hasOwnProperty("value")||r.hasOwnProperty("items")||r.hasOwnProperty("ranges"))){return!!r.value||r.items&&!!r.items.length||r.ranges&&!!r.ranges.length}return false};L.prototype._checkIfCustomControlFilterHasValue=function(e){if(!e.control){return false}return e.control.data("hasValue")};L.prototype._removeEmptyFilters=function(e){if(this._bSetFilterDataSuspended){return e}var t=JSON.parse(e);var i={};Object.keys(t).forEach(function(e){const r=this._oFilterProvider._mConditionTypeFields&&this._oFilterProvider._mConditionTypeFields[e]?.conditionType?.getDefaultOperation()?true:false;if(e==="_CUSTOM"||(this._checkIfFilterHasValue(e)||r)){i[e]=t[e]}}.bind(this));return JSON.stringify(i)};L.prototype._removeValuesForNonPartOfCurrentVariants=function(e){var t=[];if(this._oFilterProvider&&e&&e.length>0){var i=this._oFilterProvider.getFilterData();e.forEach(function(e){var r=e.getName();if(!e.data("isCustomField")){var a=this._oFilterProvider._getFieldMetadata(r);if(a.conditionType){t.push(a)}this._oFilterProvider._createInitialModelForField(i,a,false)}else if(i._CUSTOM&&i._CUSTOM[r]){delete i._CUSTOM[r]}},this);this.setFilterData(i);t.forEach(function(e){var t=e.fieldName;this._oFilterProvider._mConditionTypeFields[t].conditionType.initialize(i[t])},this)}};L.prototype.getFilterDataAsStringForVariant=function(e,t){var i={},r=this._oFilterProvider._aFilterBarDateTimeFieldNames;i=A(i,this.getFilterData(e));r.forEach(function(e){var t,r,a=u._getFieldMetadata(this._aFilterBarViewMetadata,e);if(a&&a.type==="Edm.DateTimeOffset"){r=i[e];if(r&&r.low){if(a.filterRestriction===D.interval){t=f.parseDateTimeOffsetInterval(r.low);if(t&&t.length===2){r.low=a.ui5Type.parseValue(t[0],"string");r.high=a.ui5Type.parseValue(t[1],"string")}}}}}.bind(this));this._oFilterProvider._aFilterBarDateFieldNames.concat(this._oFilterProvider._aFilterBarTimeFieldNames).forEach(function(e){var t,r=u._getFieldMetadata(this._aFilterBarViewMetadata,e);if(!r){r=this.getParameterMetadata(e)}if(r&&(r.filterType==="date"||r.filterType==="time")){t=i[e];var a=this._oFilterProvider._isSingleDynamicDateEnabled(r);if(t){var n=t.conditionTypeInfo;if(r.filterRestriction===D.multiple||r.filterRestriction===D.auto){this._processDateRanges(t.ranges)}else if(r.filterRestriction===D.single&&a){this._processDateRanges(t.ranges)}else if(r.filterRestriction===D.single){i[e]=this._dateConvert(t)}else if(r.filterRestriction===D.interval){if(t.ranges){this._processDateRanges(t.ranges)}else{if(t.low){t.low=this._dateConvert(t.low)}if(t.high){t.high=this._dateConvert(t.high)}}}if(n&&n.data){if(n.data.value1&&n.data.value1 instanceof Date){n.data.value1=this._dateConvert(n.data.value1)}if(n.data.value2&&n.data.value2 instanceof Date){n.data.value2=this._dateConvert(n.data.value2)}}}}}.bind(this));return JSON.stringify(i)};L.prototype._dateConvert=function(e){if(this.isInUTCMode()){if(typeof e==="string"){e=S.getInstance(e)}e=t.localToUtc(e).toJSON()}if(e.indexOf&&e.indexOf("Z")===e.length-1){e=e.substr(0,e.length-1)}return e};L.prototype._processDateRanges=function(e){if(!Array.isArray(e)){return}e.forEach(function(e){e.tokenText=null;if(e.value1){e.value1=this._dateConvert(e.value1)}if(e.value2){e.value2=this._dateConvert(e.value2)}}.bind(this))};L.prototype.getFilterData=function(e,t){if(this._bSetFilterDataSuspended){return Object.assign({},this._oStoredFilterData)}var i=this._oFilterProvider;this._logAccessWhenNotInitialized("getFilterData");if(!i){return null}if(t===undefined){t=false}return e?i.getFilterData():i.getFilledFilterData(this._getVisibleFieldNames(false,t))};L.prototype.getFilterDataAsString=function(e){var t=this._oFilterProvider;this._logAccessWhenNotInitialized("getFilterDataAsString");if(!t){return null}return e?t.getFilterDataAsString():t.getFilledFilterDataAsString(this._getVisibleFieldNames(false,false))};L.prototype.getParameterMetadata=function(e){var t=null,i=this.getAnalyticalParameters();if(e.indexOf(o.ANALYTICAL_PARAMETER_PREFIX)===0){e=e.substring(o.ANALYTICAL_PARAMETER_PREFIX.length)}if(Array.isArray(i)){i.some(function(i){if(i.name===e){t=i}return t!==null})}return t};L.prototype.setFilterDataAsStringFromVariant=function(e,t,i){var r,a=this._oFilterProvider._aFilterBarDateTimeFieldNames;if(e){r=JSON.parse(e);a.forEach(function(e){var t,i=u._getFieldMetadata(this._aFilterBarViewMetadata,e);if(i&&i.type==="Edm.DateTimeOffset"){t=r[e];if(t&&(i.filterRestriction===D.multiple||i.filterRestriction===D.auto)){if(t.ranges){for(var a=0;a<t.ranges.length;a++){delete t.ranges[a].tokenText}}}}}.bind(this));this._oFilterProvider._aFilterBarDateFieldNames.concat(this._oFilterProvider._aFilterBarTimeFieldNames).forEach(function(e){var t,i=u._getFieldMetadata(this._aFilterBarViewMetadata,e);if(!i){i=this.getParameterMetadata(e)}if(i&&(i.filterType==="date"||i.filterType==="time")){t=r[e];if(t){if(t.ranges){for(var a=0;a<t.ranges.length;a++){delete t.ranges[a].tokenText}}}}}.bind(this));this._bSetFilterDataFromVariant=true;this.setFilterData(r,t)}};L.prototype.setFilterData=function(e,t){if(this._bSetFilterDataSuspended){if(t){this._oStoredFilterData=e}else{this._oStoredFilterData=Object.assign({},this._oStoredFilterData,e)}return}this._setFilterData(e,t)};L.prototype.suspendSetFilterData=function(){this._bSetFilterDataSuspended=true};L.prototype.resumeSetFilterData=function(){if(this._bSetFilterDataSuspended){this._bSetFilterDataSuspended=false;this.setFilterData(this._oStoredFilterData,true);this._oStoredFilterData={}}};L.prototype._setFilterData=function(e,t){var i;this._logAccessWhenNotInitialized("setFilterData");if(e){Object.keys(e).forEach(function(t){i=this._getFilterMetadata(t);if(i&&this._checkIfFilterHasValue(t,e)){this._instanciateFilterItem(i)}}.bind(this))}if(this._oFilterProvider){this._oFilterProvider.setFilterData(e,t)}if(e&&Object.keys(e).length===1&&e._CUSTOM&&!this._bSetFilterDataFromVariant){return}this._bSetFilterDataFromVariant=false;this.fireFilterChange({afterFilterDataUpdate:true})};L.prototype.setFilterDataAsString=function(e,t){if(e){this.setFilterData(JSON.parse(e),t)}};L.prototype._getFixedFilterItemSuggestions=function(e){const t=this._oFilterProvider;const i=t._aValueListProvider.find(t=>t.sFieldName===e||t.sFieldName===`$Parameter.${e}`);if(!i){return Promise.resolve([])}if(!i._isControlDropdown()){throw new Error("Fetching values for standard value-list is not allowed")}return i._getSuggestionsData()};L.prototype._isFilterBarContext=function(){return false};L.prototype.fireClear=function(){this._clearFilterFields();this.fireEvent("clear",arguments)};L.prototype._clearFilterFields=function(){if(this._oFilterProvider){this._oFilterProvider.clear();this._clearErroneusControlValues()}this.fireFilterChange({afterFilterDataUpdate:true})};L.prototype.fireReset=function(){this._resetFilterFields();this.fireEvent("reset",arguments)};L.prototype._resetFilterFields=function(){if(this._oFilterProvider){this._oFilterProvider.reset();this._clearErroneusControlValues()}this.fireFilterChange({afterFilterDataUpdate:true})};L.prototype._suspendedTriggerSearch=function(e){if(this.getSuppressSelection()){return}this._oSuspendedTriggerSearch={delay:e};return true};L.prototype._regularTriggerSearch=function(e){if(this.getSuppressSelection()){return}this._clearDelayedSearch();this._iDelayedSearchId=setTimeout(function(){var e=this._getVisibleControlsLoadingPromises();if(!this._bSearchTriggeredOnce&&e.length){Promise.all(e).then(this._search.bind(this)).catch(this._search.bind(this))}else{this._search()}}.bind(this),e||0)};L.prototype.suspendSelection=function(){this.triggerSearch=this._suspendedTriggerSearch};L.prototype.resumeSelection=function(){this.triggerSearch=this._regularTriggerSearch;if(this._oSuspendedTriggerSearch){this.triggerSearch(this._oSuspendedTriggerSearch.delay);this._oSuspendedTriggerSearch=undefined}};L.prototype.triggerSearch=L.prototype._regularTriggerSearch;L.prototype._getVisibleControlsLoadingPromises=function(){var e=[];this.determineAsyncFilters({bAll:true}).forEach(function(t){var r=t._getControl();if(r.isA("sap.m.ComboBox")&&!r.getItems().length){e.push(new Promise(function(e){var t=r.data("__loadVLPromise"),a=r.data("__dataReceivedPromise"),n=r.getBinding("items"),o;if(t instanceof Promise){t.catch(e)}if(a instanceof Promise){a.finally(e)}if(n){n.attachEventOnce("dataReceived",e);return}o=new i(function(t){if(t&&t.mutation==="ready"){r.getBinding("items").attachEventOnce("dataReceived",e);o.unobserve(r,{bindings:["items"]})}});o.observe(r,{bindings:["items"]});this._oObservers.push(o)}.bind(this)))}}.bind(this));return e};L.prototype.search=function(e){if(this.getSuppressSelection()){return undefined}this._logAccessWhenNotInitialized("search");if(e&&!this.isLiveMode()){return this._search()}this.triggerSearch(0);return true};L.prototype._search=function(){var t=true,i=false,r,a,n;this._bSearchTriggeredOnce=true;a=this.verifySearchAllowed();if(a.hasOwnProperty("pending")){if(this._iDelayedSearchId&&!this.getSuppressSelection()){this.triggerSearch()}return undefined}else if(a.hasOwnProperty("error")){t=false;i=true}else if(a.hasOwnProperty("mandatory")){t=false}if(this.isPending()&&!this._bIsPendingChangeAttached){n=function(e){if(e.getParameter("pendingValue")===false){this.detachPendingChange(n);this._bIsPendingChangeAttached=false;this.triggerSearch()}}.bind(this);this._bIsPendingChangeAttached=true;this.attachPendingChange(n);return undefined}this._clearDelayedSearch();if(t){if(this._isTablet()&&this.getUseToolbar()&&!this.getAdvancedMode()){this.setFilterBarExpanded(false)}if(this._oFilterProvider?._mConditionTypeFields){for(var o in this._oFilterProvider._mConditionTypeFields){this._oFilterProvider._mConditionTypeFields[o]?.conditionType?.updateFilters()}}this.fireSearch([{selectionSet:this._retrieveCurrentSelectionSet(false,true),firedFromFilterBar:this._bSearchFiredFromFilterBar}]);this._bSearchFiredFromFilterBar=false}else{if(!i){if(!this._sMandatoryErrorMessage){this._sMandatoryErrorMessage=this._oResourceBundle.getText("EMPTY_MANDATORY_MESSAGE")}r=this._sMandatoryErrorMessage}else{if(!this._sValidationErrorMessage){this._sValidationErrorMessage=this._oResourceBundle.getText("VALIDATION_ERROR_MESSAGE")}r=this._sValidationErrorMessage}if(this.getShowMessages()&&!this.getLiveMode()){try{e.error(r,{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:this._setFocusOnFirstErroneousField.bind(this)})}catch(e){return undefined}}else{this._setFocusOnFirstErroneousField();P.warning("search was not triggered. "+r);if(I.system.desktop){this.setFilterBarExpanded(true)}}}return t};L.prototype.validateMandatoryFields=function(){this._logAccessWhenNotInitialized("validateMandatoryFields");return this._validateMandatoryFields()};L.prototype.validateNonMandatoryFields=function(){this._logAccessWhenNotInitialized("validateNonMandatoryFields");return this._validateNonMandatoryFields()};L.prototype.validateBasicSearch=function(){this._logAccessWhenNotInitialized("validateBasicSearch");if(!this.getBasicSearch()){return true}return this._validateBasicSearch()};L.prototype.verifySearchAllowed=function(){var e,t,i;this._logAccessWhenNotInitialized("verifySearchAllowed");this.bIsSearchPending=false;this._bForceError=false;if(this._validateState()){e=this.validateMandatoryFields();t=this.validateNonMandatoryFields();i=this.validateBasicSearch();this._bForceError=undefined;if(this._oFilterProvider){this._oFilterProvider._validateConditionTypeFields(true)}if(e&&t&&i){return{}}if(!e){return{mandatory:true}}if(!t||!i){return{error:true}}}if(this.bIsSearchPending){return{pending:true}}return{error:true}};L.prototype.checkSearchAllowed=function(){this._logAccessWhenNotInitialized("checkSearchAllowed");var e=false,t=null;this.bIsSearchPending=false;this._bForceError=false;if(this._validateState()){t=this._checkMandatoryFields();if(!t.emptyMandatory&&!t.valueStateInError){e=true}}if(this.bIsSearchPending){e=false}this._bForceError=undefined;return e};L.prototype.enhanceAccessibilityState=function(e,t){if(e.isA("sap.ui.comp.smartfilterbar.SFBSearchField")){const i=e.getValueStateMessageId()+"-sr";if(e.getValueState()===E.Error){t.invalid=true;t.errormessage=i}}};L.prototype._setFocusOnFirstErroneousField=function(){var e,t,i,r,a=this.getBasicSearchControl(),n=this.getIsRunningInValueHelpDialog();if((!n||n&&this.bNotFirstTimeOpen)&&a?.getValueState()===E.Error){setTimeout(a["focus"].bind(a),0);return}this.bNotFirstTimeOpen=true;e=this.getAllFilterItems(true);if(Array.isArray(e)){t=e.length;for(r=0;r<t;r++){i=this._determineControlByFilterItem(e[r],true);if(i&&i.getValueState&&i.getValueState()===E.Error){setTimeout(i["focus"].bind(i),0);break}}}};L.prototype.setLiveMode=function(e){if(!this._isPhone()){if(e){this.hideGoButton()}else{this.restoreGoButton()}}if(this._oSmartVariantManagement){if(e){if(this._bShowShareState===undefined){this._bShowShareState=this._oSmartVariantManagement.getShowExecuteOnSelection()}this._oSmartVariantManagement.setShowExecuteOnSelection(false)}else if(this._bShowShareState!==undefined){this._oSmartVariantManagement.setShowExecuteOnSelection(this._bShowShareState)}}return this.setProperty("liveMode",e)};L.prototype.isLiveMode=function(){return this._isPhone()?false:this.getLiveMode()};L.prototype._clearDelayedSearch=function(){if(this._iDelayedSearchId){clearTimeout(this._iDelayedSearchId);this._iDelayedSearchId=null}};L.prototype.isPending=function(){return!this._oFilterProvider?false:this._oFilterProvider.isPending()};L.prototype._validateMandatoryFields=function(){var e=true,t,i=this.determineMandatoryFilterItems(),r,a=this.getFilterData(false,true),n=0,o;this._bExpandAdvancedFilterArea=false;if(i&&a){n=i.length;while(n--){r=i[n];o=this._determineControlByFilterItem(r,true);if(o&&o.setValueState){t=this._checkForValues(a,r,o);if(t&&o.isA("sap.m.ComboBox")){t=this._validateComboBox(r,o)}if(t){if(o.data("__mandatoryEmpty")){o.data("__mandatoryEmpty",null);o.setValueState(E.None)}}else{e=false;if(o.setValueStateText){if(r.getLabel&&r.getLabel()){o.setValueStateText(this._oResourceBundle.getText("MANDATORY_FIELD_WITH_LABEL_ERROR",[r.getLabel()]))}else{o.setValueStateText(this._oResourceBundle.getText("MANDATORY_FIELD_ERROR"))}}o.setValueState(E.Error);o.data("__mandatoryEmpty",true);if(r.getGroupName){this._bExpandAdvancedFilterArea=true}}}}}return e};L.prototype._validateBasicSearch=function(){return this.getBasicSearchControl()&&this.getBasicSearchControl().validateValue?this.getBasicSearchControl().validateValue():true};L.prototype._validateNonMandatoryFields=function(){var e=true;this.determineAsyncFilters({bNonMandatory:true}).forEach(function(t){var i=t._getControl();if(i.isA("sap.m.ComboBox")){if(this._validateComboBox(t,i)){i.setValueStateText("");i.setValueState(E.None)}else{e=false;i.setValueStateText(this._oResourceBundle.getText("FILTER_BAR_FIELD_ERROR"));i.setValueState(E.Error)}}}.bind(this));return e};L.prototype._validateComboBox=function(e,t){var i,r,a,n=true,o=e.getName();if(o.indexOf(N)===0&&Array.isArray(this._aAnalyticalFilterBarViewMetadata)){r=u._getAnalyticalFieldMetadata(this._aAnalyticalFilterBarViewMetadata,o)}else{r=u._getFieldMetadata(this._aFilterBarViewMetadata,o)}if(t.isA("sap.m.ComboBox")&&r.hasValidation){if(e.data("isCustomField")){a=t.data("hasValue");if(a!==undefined&&a!=null){n=this._checkHasValueData(a)}}else{i=t.getSelectedKey();if(i&&!t.getItemByKey(i)){n=false}}}return n};L.prototype._checkMandatoryFields=function(){this._logAccessWhenNotInitialized("checkMandatoryFields");var e=false,t=false,i=this.determineMandatoryFilterItems(),r,a=this.getFilterData(),n=0,o;if(i&&a){n=i.length;while(n--){r=i[n];o=this._determineControlByFilterItem(r,true);if(o){if(!this._checkForValues(a,r,o)){e=true}if(o.getValueState&&o.getValueState()===E.Error){t=true}}}}return{emptyMandatory:e,valueStateInError:t}};L.prototype._setSmartVariant=function(e){var t;if(!e){return}t=_.getElementById(e);if(t){if(t.isA("sap.ui.comp.smartvariants.SmartVariantManagement")){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._replaceVariantManagement(t);this._oSmartVariantManagement=t}}else{P.error("Control with the id="+e+" not of expected type")}}else{P.error("Control with the id="+e+" not found")}};L.prototype.setSmartVariant=function(e){if(this.getAdvancedMode()){P.error("not supported for the advanced mode");return this}this.setAssociation("smartVariant",e);this._setSmartVariant(e);return this};L.prototype.getSmartVariant=function(){if(this.getAdvancedMode()){P.error("not supported for the advanced mode");return null}var e=this.getAssociation("smartVariant");if(e){return _.getElementById(e)}return this._oSmartVariantManagement};L.prototype._createVariantManagement=function(){if(this.getAdvancedMode()){return r.prototype._createVariantManagement.apply(this)}this._setSmartVariant(this.getSmartVariant());if(!this._oSmartVariantManagement){this._oSmartVariantManagement=new p(this.getId()+"-variant",{showExecuteOnSelection:true,showShare:true})}return this._oSmartVariantManagement};L.prototype._initializeVariantManagement=function(){if(!this.getIsRunningInValueHelpDialog()&&this._oSmartVariantManagement&&this.getPersistencyKey()){var e=new c({type:"filterBar",keyName:"persistencyKey",dataSource:this.getEntitySet()||this.getEntityType()});e.setControl(this);if(this.getConsiderSelectionVariants()&&!this._oSmartVariantManagement.isPageVariant()){this._oSmartVariantManagement._createMetadataPromise();this._prepareSelectionVariants();this._oSmartVariantManagement._resolveMetadataPromise()}this._oSmartVariantManagement.addPersonalizableControl(e);if(this._checkHasValueData(this.data("executeStandardVariantOnSelect"))){this._oSmartVariantManagement._executeOnSelectForStandardVariantByXML(true)}r.prototype._initializeVariantManagement.apply(this,arguments)}else{this.fireInitialise();this.fireInitialized()}};L.prototype.fireInitialized=function(){var e=this._getVisibleControlsLoadingPromises();if(e.length&&this.getDomRef()&&!this.getSuppressValueListsAssociation()){Promise.all(e).then(this._fireInitialized.bind(this)).catch(this._fireInitialized.bind(this))}else{this._fireInitialized()}};L.prototype._fireInitialized=function(){if(this.getConsiderSelectionVariants()&&this._oSmartVariantManagement&&!this._oSmartVariantManagement.isPageVariant()){if(this._oStandardSelectionVariant){this._oSmartVariantManagement._oStandardVariant=A({},this._defaultSelectionVariantHandling(this._oStandardSelectionVariant))}if(!this._oSmartVariantManagement._getDefaultVariantKey()){if(this.getDefaultSelectionVariantName()){var e=L.SELECTION_VARIANT_KEY_PREFIX+this.getDefaultSelectionVariantName();this._oSmartVariantManagement.setInitialSelectionKey(e);this._oSmartVariantManagement.fireSelect({key:e})}else if(this._oStandardSelectionVariant){this._oSmartVariantManagement.fireSelect({key:this._oSmartVariantManagement.STANDARDVARIANTKEY})}}this._oStandardSelectionVariant=null}r.prototype.fireInitialized.apply(this,arguments)};L.prototype._prepareSelectionVariants=function(){var e,t=L.SELECTION_VARIANT_KEY_PREFIX,i=[],r=this._oSmartVariantManagement;e=this.getSelectionVariants();if(e){var a={callback:this.getSelectionVariant,handler:this};e.forEach(function(e){var r=t+e.qualifier;if(e.qualifier){i.push({id:r,favorite:true,name:e.annotation.Text.String})}else{this._oStandardSelectionVariant=e}}.bind(this));if(i.length>0){a.variants=i;r.registerSelectionVariantHandler(a,t)}}};L.prototype._defaultSelectionVariantHandling=function(e){var t={},i=this._oSmartVariantManagement,r,a;if(!i||i._sAppStandardVariantKey||!(e&&e.annotation)){return t}t=this.convertSelectionVariantToInternalVariant(e.annotation);if(!t){return t}if(!i.isPageVariant()){t.version="V1";a=JSON.parse(t.filterBarVariant);if(i._oStandardVariant){r=JSON.parse(i._oStandardVariant.filterBarVariant);if(r._CUSTOM){a._CUSTOM=r._CUSTOM;t.filterBarVariant=JSON.stringify(a)}}}return t};L.prototype._adaptFilterVisibilityProperties=function(e){var t,i=[];if(this._oSmartVariantManagement&&this._oSmartVariantManagement._oStandardVariant&&this._oSmartVariantManagement._oStandardVariant.filterbar){A(i,this._oSmartVariantManagement._oStandardVariant.filterbar)}Object.keys(e).forEach(function(e){t=false;i.some(function(i){if(i.name===e){t=true;i.partOfCurrentVariant=true}return t});if(!t){i.push({group:this._determineGroupNameByName(e),name:e,partOfCurrentVariant:true,visibleInFilterBar:false,visible:true})}}.bind(this));return i};L.prototype.getSelectionVariant=function(e){var t=null,i=null,r=e.substring(L.SELECTION_VARIANT_KEY_PREFIX.length);this.getSelectionVariants().some(function(e){if(e.qualifier===r){i=e;return true}return false});if(i){if(i.variantContent){t=i.variantContent}else{t=this.convertSelectionVariantToInternalVariant(i.annotation);i.variantContent=t}}return t};L.prototype.convertSelectionVariantToInternalVariant=function(e){var t=JSON.parse(JSON.stringify(e)),i,r,a,n=t.SelectOptions,o=t.Parameters,s;if(n||o){a=new b(null,"/")}if(n){n.forEach(function(e){e.PropertyName=e.PropertyName.PropertyPath;e.Ranges.forEach(function(e){e.Sign=e.Sign.EnumMember.split("/")[1];e.Option=e.Option.EnumMember.split("/")[1];e.Low=e.Low&&V.format(a,e.Low)||null;e.High=e.High&&V.format(a,e.High)||null})})}if(o){o.forEach(function(e){e.PropertyName=e.PropertyName.PropertyPath.split("/")[1]||e.PropertyName.PropertyPath;e.PropertyValue=V.format(a,e.PropertyValue)||null})}s=new C;i=s.convert(JSON.stringify(t),this,true);r=JSON.parse(i.payload);i={version:"V2",filterbar:this._adaptFilterVisibilityProperties(r),filterBarVariant:JSON.stringify(r)};return i};L.prototype.getBasicSearchControl=function(){return _.getElementById(this.getBasicSearch())};L.prototype.addFieldToAdvancedArea=function(e){var t;this._logAccessWhenNotInitialized("addFieldToAdvancedArea");t=this._getFilterItemByName(e);if(t&&t.setVisibleInFilterBar){t.setVisibleInFilterBar(true)}};L.prototype._onCustomFieldCustomDataChange=function(e){var t=e.getParameter("newValue"),i=e.getParameter("oldValue"),r=e.getParameter("name");if(i!==t&&r==="value"){this._updateToolbarText();this.fireAssignedFiltersChanged()}};L.prototype._attachCustomControlCustomDataChange=function(e){var t,i;for(i=0;i<e.length;i++){t=e[i];if(t.getKey()==="hasValue"){t.attachEvent("_change",this._onCustomFieldCustomDataChange,this);break}}};L.prototype.getConditionTypeByKey=function(e){if(this._oFilterProvider&&this._oFilterProvider._mConditionTypeFields[e]){return this._oFilterProvider._mConditionTypeFields[e].conditionType}if(this._oFilterProvider&&e.indexOf(N)===-1&&this._oFilterProvider._mConditionTypeFields[N+e]){return this._oFilterProvider._mConditionTypeFields[N+e].conditionType}};L.prototype.getDateRangeTypeByKey=function(e){return this.getInitializedPromise().then(function(){if(this._oFilterProvider._mConditionTypeFields[e]){return this._oFilterProvider._mConditionTypeFields[e].conditionType}if(e.indexOf(N)===-1&&this._oFilterProvider._mConditionTypeFields[N+e]){return this._oFilterProvider._mConditionTypeFields[N+e].conditionType}}.bind(this))};L.prototype.setDateRangeTypeOperationByKey=function(e,t){return this.getDateRangeTypeByKey(e).then(function(e){if(e&&typeof e.setOperation==="function"){e.setOperation(t)}})};L.prototype.isInUTCMode=function(){if(this._oFilterProvider&&this._oFilterProvider._oDateFormatSettings){return this._oFilterProvider._oDateFormatSettings.UTC}return false};L.prototype.isInitialised=function(){return!!this.bIsInitialised};L.prototype.associateValueLists=function(){if(this.getSuppressValueListsAssociation()&&this._oFilterProvider){this._oFilterProvider._fireEvent(u.ASSOCIATE_VALUE_LISTS);this._oFilterProvider._bSuppressValueListsAssociation=false;this._valueListAnnotationsLoaded();if(typeof this._enhanceFilterItemsWithTextOnValueListAssociation==="function"){this._enhanceFilterItemsWithTextOnValueListAssociation()}}};L.prototype._refreshFiltersCountOnValueListAnnotationLoaded=function(){for(var e=0;e<this._oFilterProvider._aFilterBarDropdownFieldMetadata.length;e++){var t=this._oFilterProvider._aFilterBarDropdownFieldMetadata[e].control;if(t&&t.isA("sap.m.ComboBox")){t.addEventDelegate({onAfterRendering:function(){this.refreshFiltersCount()}.bind(this)})}}};L.prototype._enhanceFilterItemsWithTextValue=function(e,t){if(!this._enhanceFilterItemsWithTextOnValueListAssociation&&this.getSuppressValueListsAssociation()){this._enhanceFilterItemsWithTextOnValueListAssociation=function(){var e=this.getUiState();r.prototype._enhanceFilterItemsWithTextValue.call(this,e.getValueTexts(),e.getSelectionVariant())}.bind(this)}else{r.prototype._enhanceFilterItemsWithTextValue.apply(this,arguments)}};L.prototype._createVisibleFilters=function(){r.prototype._createVisibleFilters.apply(this,arguments);if(!this.getSuppressValueListsAssociation()&&this._oFilterProvider){this._valueListAnnotationsLoaded()}if(!this.getIsRunningInValueHelpDialog()){this._setInitialFocus()}};L.prototype._valueListAnnotationsLoaded=function(){return this._fireValueListAnnotationLoaded().then(this._refreshFiltersCountOnValueListAnnotationLoaded.bind(this))};L.prototype._attachValueListAnnotationLoaded=function(e,t,i){this.attachEvent("valueListAnnotationLoaded",e,t,i)};L.prototype._fireValueListAnnotationLoaded=function(e){var t=this._oFilterProvider&&Array.isArray(this._oFilterProvider.aFilterAnnotations)?this._oFilterProvider.aFilterAnnotations:[];return Promise.allSettled(t).then(function(){this.fireEvent("valueListAnnotationLoaded",e)}.bind(this))};L.prototype._suspendSuggestionBindingOnhiddenItems=function(){};L.prototype.getSuppressValueListsAssociation=function(){return false};L.prototype.setCustomFilterData=function(e){if(this._oFilterProvider&&this._oFilterProvider.getModel()){this._oFilterProvider.getModel().setProperty("/"+u.CUSTOM_FIELDS_MODEL_PROPERTY,e)}};L.prototype.getCustomFilterData=function(){if(this._oFilterProvider&&this._oFilterProvider.getModel()){return this._oFilterProvider.getModel().getProperty("/"+u.CUSTOM_FIELDS_MODEL_PROPERTY)}};L.prototype.refreshFiltersCount=function(){return Promise.all(this._oFilterProvider._getCurrentValidationPromises()).then(function(){return this._updateToolbarText()}.bind(this))};L.prototype.hasDateRangeTypeFieldsWithValue=function(){var e=this._oFilterProvider,t=this.getFilterData(),i=Object.keys(e._mConditionTypeFields).some(function(e){return!!t[e]});return this.getInitializedPromise().then(function(){return i})};L.prototype.openValueHelpRequestForFilterItem=function(e){var t=this._getFilterItemByName(e)?.getControl();t?.fireValueHelpRequest()};L.prototype.getFlexConfig=function(){if(this.bIsInitialised){return{entitySetName:this.getEntitySet()}}};L.prototype.destroy=function(){this._clearDelayedSearch();if(this._oFilterProvider&&this._oFilterProvider.destroy){this._oFilterProvider.destroy()}this._oFilterProvider=null;if(this._oSmartVariantManagement&&this.getConsiderSelectionVariants()){this._oSmartVariantManagement.unregisterSelectionVariantHandler(this)}r.prototype.destroy.apply(this,arguments);y.unregisterObject(this);this._oObservers.forEach(function(e){e.disconnect();e.destroy()});this._aFilterBarViewMetadata=null;this._oFilterBarViewMetadataExtend=null;this._bExpandAdvancedFilterArea=null;this._oResourceBundle=null;this._sMandatoryErrorMessage=null;this._sValidationErrorMessage=null;this._oSmartVariantManagement=null;this.bNotFirstTimeOpen=null;this._oRulesLog.destroy()};return L});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SmartFilterBarFilterGroupItem", ["sap/ui/comp/filterbar/FilterGroupItem","sap/ui/comp/library","sap/base/Log"],function(t,r,e){"use strict";var o=t.extend("sap.ui.comp.smartfilterbar.SmartFilterBarFilterGroupItem",{metadata:{library:"sap.ui.comp"}});o.prototype.getControl=function(){e.warning("Using deprecated method: sap.ui.comp.smartfilterbar.SmartFilterBarFilterGroupItem#getControl. Use sap.ui.core.Core.byId instead.");return o.prototype._getControl.apply(this,arguments)};o.prototype._getControl=function(){return t.prototype.getControl.apply(this,arguments)};return o});
/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartfilterbar/SortingUtil", [],function(){"use strict";var e={sortByIndex:function(e){var n,r,t,i;if(!e||!e.length){return e}r=[];n=[];for(var s=0;s<e.length;s++){i=e[s];t=i.index;if(t>=0){n.push(i)}else{r.push(i)}}if(n.length){n=n.sort(function(e,n){return e.index-n.index});if(!r.length){r=n}else{for(var f=0;f<n.length;f++){i=n[f];if(i.index>=r.length){r.push(i)}else{r.splice(i.index,0,i)}}}}return r},groupSorting:function(e){var n=[];n=this.sortByIndex(e);for(var r=0;r<n.length;r++){if(n[r].fields){n[r].fields=this.sortByIndex(n[r].fields)}}return n},destroy:function(){}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/ColumnLayout", ["sap/ui/comp/library","sap/ui/layout/library","sap/ui/core/Element"],function(a,e,u){"use strict";var p=u.extend("sap.ui.comp.smartform.ColumnLayout",{metadata:{interfaces:["sap.ui.comp.smartform.SmartFormLayout"],library:"sap.ui.comp",properties:{columnsXL:{type:"sap.ui.layout.form.ColumnsXL",group:"Appearance",defaultValue:2},columnsL:{type:"sap.ui.layout.form.ColumnsL",group:"Appearance",defaultValue:2},columnsM:{type:"sap.ui.layout.form.ColumnsM",group:"Appearance",defaultValue:1},labelCellsLarge:{type:"sap.ui.layout.form.ColumnCells",group:"Appearance",defaultValue:4},emptyCellsLarge:{type:"sap.ui.layout.form.EmptyCells",group:"Appearance",defaultValue:0}}}});return p});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/Group", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/layout/library","sap/ui/layout/form/FormContainer","sap/base/Log","sap/m/Label","sap/m/Button","sap/m/Text"],function(t,e,i,r,o,a,s,n){"use strict";var l;var u=r.extend("sap.ui.comp.smartform.Group",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartform/Group.designtime",properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null,deprecated:true},label:{type:"string",group:"Misc",defaultValue:null,deprecated:true}},defaultAggregation:"groupElements",aggregations:{groupElements:{type:"sap.ui.comp.IFormGroupElement",multiple:true,singularName:"groupElement"},layout:{type:"sap.ui.layout.GridData",multiple:false}},_bVisibleElements:false}});u.prototype.init=function(){r.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["useHorizontalLayout","horizontalLayoutGroupElementMinWidth","label"]})};function p(t){var e=this.getGroupElements();for(var i=0;i<e.length;i++){if(e[i].isA("sap.ui.comp.smartform.SemanticGroupElement")){o.error("useHorizontalLayout can't be used for SemanticGroupElement",this)}else if(e[i].getUseHorizontalLayout()!=t){e[i].setUseHorizontalLayout(t)}}this._updateLayoutData()}u.prototype._updateLayoutData=function(){if(this.getUseHorizontalLayout&&this.getUseHorizontalLayout()){var t=this.getParent();while(t&&!t.addGroup&&t.getParent){t=t.getParent()}if(t){var e=t.getLayout();if(!e||!e.getGridDataSpan()){if(!this.getLayoutData()){if(!l&&!this._bResponsiveFlowLayoutDataRequested){l=sap.ui.require("sap/ui/layout/ResponsiveFlowLayoutData");if(!l){sap.ui.require(["sap/ui/layout/ResponsiveFlowLayoutData"],h.bind(this));this._bResponsiveFlowLayoutDataRequested=true}}if(l&&!this._bResponsiveFlowLayoutDataRequested){var i=new l({linebreak:true,linebreakable:true});i._bCreatedByGroup=true;this.setLayoutData(i)}}}else{this._updateLineBreaks()}}}else{var r=this.getLayoutData();if(r&&r._bCreatedByGroup){this.destroyLayoutData()}}};function h(t){l=t;this._bResponsiveFlowLayoutDataRequested=false;if(!this._bIsBeingDestroyed){this._updateLayoutData()}}function m(t){o.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);var e=this.getGroupElements();for(var i=0;i<e.length;i++){e[i].setHorizontalLayoutGroupElementMinWidth(t)}}u.prototype.setEditMode=function(t){this._setEditable(t);return this};u.prototype._updateLineBreaks=function(){if(this.getUseHorizontalLayout&&!this.getUseHorizontalLayout()){return}var t=this.getParent();if(!t){return}while(t&&!t._getGridDataSpanNumbers&&t.getParent){t=t.getParent()}if(t&&!t._getGridDataSpanNumbers){return}var e=t&&t._getGridDataSpanNumbers();if(!e){return}var i=this.getGroupElements();i=i.filter(function(t){return t.isVisible()});var r=0;var o=0;var a=0;var s=0;var n=false;var l=false;var u=false;var p=false;for(var h=0;h<i.length;h++){var m=i[h];r++;o++;a++;s++;if(e.XL*r>12){n=true;r=1}else{n=false}if(e.L*o>12){l=true;o=1}else{l=false}if(e.M*a>12){u=true;a=1}else{u=false}if(e.S*s>12){p=true;s=1}else{p=false}m._setLinebreak(n,l,u,p)}};u.prototype._updateGridDataSpan=function(){if(this.getUseHorizontalLayout&&!this.getUseHorizontalLayout()){return}var t=this.getGroupElements();for(var e=0;e<t.length;e++){t[e]._updateGridDataSpan()}};u.prototype._updateFormContainerVisibility=function(){var t=this.getGroupElements();var e=false;e=t.some(function(t){return t.isVisible()});if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){this.fireEvent("_visibleChanged")}}};function y(t){var e=this.getTitle();if(e&&typeof e!=="string"){o.error("Title already set, Label can not be set",this)}else{this.setTitle(t)}}u.prototype.setVisible=function(t){var e=this.getVisible();r.prototype.setVisible.apply(this,arguments);if(t!=e||t!=this._bVisibleElements){this.fireEvent("_visibleChanged")}return this};u.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};u.prototype.addGroupElement=function(t){return this.addFormElement(t)};u.prototype.insertGroupElement=function(t,e){return this.insertFormElement(t,e)};u.prototype.getGroupElements=function(){return this.getFormElements()};u.prototype.indexOfGroupElement=function(t){return this.indexOfFormElement(t)};u.prototype.removeGroupElement=function(t){return this.removeFormElement(t)};u.prototype.removeAllGroupElements=function(){return this.removeAllFormElements()};u.prototype.destroyGroupElements=function(){return this.destroyFormElements()};u.prototype.addFormElement=function(t){if(!t){return this}t=this.validateAggregation("groupElements",t,true);f.call(this,t);r.prototype.addFormElement.apply(this,arguments);d.call(this,t);return this};u.prototype.insertFormElement=function(t,e){if(!t){return this}t=this.validateAggregation("groupElements",t,true);f.call(this,t);r.prototype.insertFormElement.apply(this,arguments);d.call(this,t);return this};u.prototype.removeFormElement=function(t){var e=r.prototype.removeFormElement.apply(this,arguments);if(e){e.detachVisibleChanged(this._updateFormContainerVisibility,this);v.call(this,e);this._updateFormContainerVisibility();this._updateLineBreaks()}return e};u.prototype.removeAllFormElements=function(){var t=r.prototype.removeAllFormElements.apply(this,arguments);for(var e=0;e<t.length;e++){var i=t[e];i.detachVisibleChanged(this._updateFormContainerVisibility,this);v.call(this,i)}this._updateFormContainerVisibility();this._updateLineBreaks();return t};u.prototype.destroyFormElements=function(){r.prototype.destroyFormElements.apply(this,arguments);this._updateFormContainerVisibility();this._updateLineBreaks();return this};function f(t){if(!t.isA("sap.ui.comp.smartform.SemanticGroupElement")){const e=this.getHorizontalLayoutGroupElementMinWidth();if(e!=t.getHorizontalLayoutGroupElementMinWidth()){t.setHorizontalLayoutGroupElementMinWidth(e)}const i=this.getUseHorizontalLayout();if(i!=t.getUseHorizontalLayout()){t.setUseHorizontalLayout(i)}}t.attachVisibleChanged(this._updateFormContainerVisibility,this);g.call(this,t)}function d(t){this._updateFormContainerVisibility();if(this.getUseHorizontalLayout()&&this.getUseHorizontalLayout()){t._updateGridDataSpan();this._updateLineBreaks()}}u.prototype.setLayout=function(t){t=this.validateAggregation("layout",t,false);return this.setLayoutData(t)};u.prototype.getLayout=function(){return this.getLayoutData()};u.prototype.destroyLayout=function(t){return this.destroyLayoutData()};u.prototype.addCustomData=function(t){if(!t){return this}r.prototype.addCustomData.apply(this,arguments);var e=this.getGroupElements();for(var i=0;i<e.length;i++){c.call(this,e[i],t)}return this};u.prototype.insertCustomData=function(t,e){if(!t){return this}r.prototype.insertCustomData.apply(this,arguments);var i=this.getGroupElements();for(var o=0;o<i.length;o++){c.call(this,i[o],t)}return this};u.prototype.removeCustomData=function(t){var e=r.prototype.removeCustomData.apply(this,arguments);if(e){var i=this.getGroupElements();for(var o=0;o<i.length;o++){v.call(this,i[o],e.getId())}}return e};u.prototype.removeAllCustomData=function(){var t=r.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){var e=this.getGroupElements();for(var i=0;i<e.length;i++){v.call(this,e[i])}}return t};u.prototype.destroyCustomData=function(){r.prototype.destroyCustomData.apply(this,arguments);var t=this.getGroupElements();for(var e=0;e<t.length;e++){v.call(this,t[e])}return this};function g(t){var e=this.getCustomData();for(var i=0;i<e.length;i++){c.call(this,t,e[i])}}function c(e,i){if(t.smartform.inheritCostomDataToFields(i)){var r=i.clone();r._bFromGroup=true;r._sOriginalId=i.getId();e.addCustomData(r)}}function v(t,e){var i=t.getCustomData();for(var r=0;r<i.length;r++){var o=i[r];if(o._bFromGroup&&(!e||e==o._sOriginalId)){t.removeCustomData(o)}}}u.prototype.clone=function(t,e){var i=this.removeAllGroupElements();var o=r.prototype.clone.apply(this,arguments);for(var a=0;a<i.length;a++){var s=i[a];var n=s.clone(t,e);this.addGroupElement(s);o.addGroupElement(n)}return o};u.prototype._observeChanges=function(t){r.prototype._observeChanges.apply(this,arguments);if(t.name=="label"){y.call(this,t.current)}else if(t.name=="useHorizontalLayout"){p.call(this,t.current)}else if(t.name=="horizontalLayoutGroupElementMinWidth"){m.call(this,t.current)}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/GroupElement", ["sap/ui/comp/library","sap/ui/core/Element","sap/ui/core/Control","sap/ui/layout/form/FormElement","sap/m/Label","sap/m/Button","sap/m/Text","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/SmartField","sap/base/Log"],function(e,t,i,a,l,s,r,o,n,u){"use strict";var f;var h;var p;var b;var d;var m=e.smartfield.ControlContextType;var g=a.extend("sap.ui.comp.smartform.GroupElement",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IFormGroupElement"],properties:{useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null,deprecated:true},elementForLabel:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"elements",aggregations:{elements:{type:"sap.ui.core.Control",multiple:true,singularName:"element"}},events:{visibleChanged:{}},designtime:"sap/ui/comp/designtime/smartform/GroupElement.designtime"},_bVisibleElements:false,_bHorizontalLayoutUsed:false});g._myVBox=undefined;g.prototype.init=function(){a.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["useHorizontalLayout","horizontalLayoutGroupElementMinWidth","elementForLabel","_editable"]})};g.prototype._getFieldRelevantForLabel=function(){var e=this.getElements();var t=this.getElementForLabel();if(e.length>t&&e[t]instanceof n){return e[t]}return null};g.prototype._extractFields=function(e,t){var i=[];e.forEach(function(e){if(e instanceof f||e instanceof h){i=i.concat(e.getItems())}else{i.push(e)}});if(i.some(function(e){return e instanceof f||e instanceof h})){i=this._extractFields(i)}if(t){i=i.filter(function(e){return!(e instanceof l)})}return i};g.prototype.setTooltip=function(e){a.prototype.setTooltip.apply(this,[e]);var t=this._getFieldRelevantForLabel();var i=this._getLabel();c.call(this,i,t);return this};function c(e,t){if(e==this._oSetLabel){return}var a;if(this._oSetLabel&&this._oSetLabel instanceof i){a=W.call(this._oSetLabel)}if(!a){a=W.call(this)}if(a){if(e instanceof o){if(t&&t.setTooltipLabel){t.setTooltipLabel(a)}}else{e.setTooltip(a)}}}g.prototype.setLabel=function(e){if(!e&&this._bMoveLabelToVBox){return this.setAggregation("label",e)}if(this._oSetLabel&&typeof this._oSetLabel!=="string"){this._oSetLabel.detachEvent("_change",L,this)}var t;var i;var l;if(typeof e==="string"){t=this._getLabel();if(t){i=t.getText()}}else if(!e&&this._oSetLabel){i=this.getLabelText()}a.prototype.setLabel.apply(this,[e]);this._oSetLabel=e;y.call(this);if(typeof e==="string"){if(this._oLabel instanceof o&&e!=i&&(e.length>0||i.length>0)){l=this._getFieldRelevantForLabel();if(l&&e!=null){if(l.getComputedTextLabel){if(!l._oTextLabelSetByGroupElement){l._oTextLabelSetByGroupElement={oldText:l.getComputedTextLabel()}}l.setTextLabel(e)}}}if(!this._bHorizontalLayoutUsed){this.setAggregation("_label",this._oLabel,true)}this._oLabel.isRequired=v;this._oLabel.isDisplayOnly=_}else{if(e){if(e.isRequired){e.isRequired=v}if(e.isDisplayOnly){e.isDisplayOnly=_}e.attachEvent("_change",L,this)}else{l=this._getFieldRelevantForLabel();if(l){k.call(this,l,i)}}this.updateLabelOfFormElement()}return this};g.prototype.destroyLabel=function(){var e=this.getLabelText();a.prototype.destroyLabel.apply(this);delete this._oSetLabel;y.call(this);var t=this._getFieldRelevantForLabel();if(t){k.call(this,t,e)}this.updateLabelOfFormElement();return this};function L(e){if(e.getParameter("name")=="text"){var t=e.oSource;var i=t.getText();if(this._oLabel){this._oLabel.setText(i)}var a=this._getFieldRelevantForLabel();if(a&&a.getComputedTextLabel){if(!a._oTextLabelSetByGroupElement){a._oTextLabelSetByGroupElement={oldText:a.getComputedTextLabel()}}a.setTextLabel(i)}}}function y(){if(!this._bHorizontalLayoutUsed){return}var e=this.getFields();var t;if(e.length>0){var i=this.getFields()[0];if(i instanceof f){var a=i.getItems();var s=this._getLabel();if(a.length>0&&a[0]instanceof l){t=a[0]}this._bMoveLabelToVBox=true;if(t&&t!=s){i.removeItem(0);if(t._bCreatedByGroupElement){this.setAggregation("_label",t,true)}else{this.setAggregation("label",t)}}if(s&&t!=s){i.insertItem(s,0)}this._bMoveLabelToVBox=false;E.call(this)}}}function v(){if(this.getRequired&&this.getRequired()){return true}var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}var t=e.getElements();for(var i=0;i<t.length;i++){var a=t[i];if(a.getRequired&&a.getRequired()===true&&(!a.getEditable||a.getEditable())&&(!a.getContextEditable||a.getContextEditable())){return true}}return false}function _(){if(this.getDisplayOnly){if(!this.isPropertyInitial("displayOnly")){return this.getDisplayOnly()}var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}var t=e.getParent();if(t){var i=t.getParent();if(i){return!i.getEditable()}}}return false}function F(){var e=this.getParent();if(e&&e.isA("sap.m.VBox")){e=e.getParent()}if(e._oSetLabel&&!(typeof e._oSetLabel==="string")&&e._oSetLabel.getWrapping&&!e._oSetLabel.isPropertyInitial("wrapping")){return e._oSetLabel.getWrapping()}return true}function E(){var e=this._getFieldRelevantForLabel();if(e){if(this._oLabel){this._oLabel.setLabelFor(e)}return}var t=this.getFields();e=t.length>0?t[0]:null;if(e instanceof f){var a=e.getItems();if(a[1]instanceof h){e=a[1].getItems()[0]}else{e=a[1]}}var l=this._oLabel;if(l){l.setLabelFor(e)}else{l=this.getLabel();if(l instanceof i){l.setAlternativeLabelFor(e)}}}g.prototype.getLabel=function(){return this._oSetLabel};g.prototype._getLabel=function(){if(this._oLabel){return this._oLabel}else{return this._oSetLabel}};g.prototype.getLabelControl=function(){if(this._bHorizontalLayoutUsed){return null}else{return this._getLabel()}};g.prototype.getLabelText=function(){var e="";var t=this._getLabel();if(t){e=t.getText()}return e};g.prototype.getDataSourceLabel=function(){var e=this._getFieldRelevantForLabel();if(e&&e.isA("sap.ui.comp.smartfield.SmartField")){return e.getDataSourceLabel()}};g.prototype._createLabel=function(e){var t=null;var i=this._getFieldRelevantForLabel();if(i){if(i.getShowLabel&&i.getShowLabel()){t=new o(i.getId()+"-label");if(e){if(!i._oTextLabelSetByGroupElement){i._oTextLabelSetByGroupElement={oldText:i.getComputedTextLabel()}}i.setTextLabel(e);t.setText(e)}t.setLabelFor(i)}}else{t=new l(this.getId()+"-label",{text:e})}if(t){t._bCreatedByGroupElement=true;t.isRequired=v;t.isDisplayOnly=_;t.isWrapping=F;this._oLabel=t;if(!this._bHorizontalLayoutUsed){this.setAggregation("_label",t,true)}if(this._oSetLabel&&typeof this._oSetLabel!=="string"){this._oSetLabel.setAlternativeLabelFor(null)}}return t};g.prototype.updateLabelOfFormElement=function(){var e=false,t=null;var i=this.getElements();var l=this._getFieldRelevantForLabel();var s=this._getLabel();var r=false;if(s&&s._bCreatedByGroupElement){if(s instanceof o){if(!l||s._sSmartFieldId&&s._sSmartFieldId!=l.getId()){r=true}}else if(l){r=true}if(r){s.destroy();delete this._oLabel;s=null;if(this._oSetLabel&&!l){if(typeof this._oSetLabel==="string"){a.prototype.setLabel.apply(this,[this._oSetLabel]);s=this._oLabel;this._oLabel.isRequired=v;this._oLabel.isDisplayOnly=_}else{s=this._oSetLabel}y.call(this)}}}else if(s&&l){if(s==this._oLabel){s.destroy();delete this._oLabel}s=null}if(!s){if(this._oSetLabel){if(typeof this._oSetLabel==="string"){t=this._oSetLabel}else{t=this._oSetLabel.getText()}}else{t=""}}if(!s&&i.length>0){s=this._createLabel(t);e=true}if(s){if(s instanceof o){if(l&&l.setTextLabel&&l.getComputedTextLabel()){s.setText(l.getComputedTextLabel())}}c.call(this,s,l)}if(e){y.call(this);if(s&&s.setLabelFor&&!(s instanceof o)&&!l&&i.length>0){s.setLabelFor(i[0])}}};g.prototype.setEditMode=function(e){this._setEditable(e);return this};function x(e){var t=this.getElements();for(var i=0;i<t.length;i++){var a=t[i];C.call(this,a,e)}}function C(e,t){if(e instanceof n){if(!(e.data("editable")===false)){e.setContextEditable(t)}}}g.prototype.invalidateLabel=function(){var e=this._getLabel();if(e){e.invalidate()}};g.prototype._updateFormElementVisibility=function(){var e=this.getVisibleBasedOnElements();if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){O.call(this);this.invalidate()}}};g.prototype._updateLayout=function(){var e=null;var t=null;var i=null;var a=this.getUseHorizontalLayout&&this.getUseHorizontalLayout();var l;var s=0;var r;if(a==this._bHorizontalLayoutUsed){return}if(a&&!S.call(this)){return}var o=this.getElements();var n=this._getLabel();this._bNoObserverChange=true;if(a){if(o.length>0){if(o[0].getLayoutData()){i=o[0].getLayoutData()}this.removeAllFields();if(o.length>1){for(s=0;s<o.length;s++){r=o[s];if(s>0){D.call(this,r)}}t=V.call(this,o.slice(0))}if(t){l=[t]}else{l=o.slice(0)}e=B.call(this,l,n,i);this.addField(e);if(n){E.call(this)}}}else{var u=this.getFields();if(u[0]instanceof f){e=u[0];l=e.getItems();if(o.length>1&&l.length>0){if(n){if(l.length>1&&l[1]instanceof h){t=l[1]}}else if(l[0]instanceof h){t=l[0]}if(t){t.removeAllItems();t.destroy()}}e.removeAllItems();e.destroy()}this.removeAllFields();for(s=0;s<o.length;s++){r=o[s];T.call(this,r);this.addField(r)}if(n){if(n==this._oLabel){this.setAggregation("_label",n,true)}else{this.setAggregation("label",n)}}}this._bHorizontalLayoutUsed=a;this._bNoObserverChange=false};function S(){if((!f||!h||!p||!b||!d)&&!this._bVBoxRequested){f=sap.ui.require("sap/m/VBox");h=sap.ui.require("sap/m/HBox");p=sap.ui.require("sap/m/FlexItemData");b=sap.ui.require("sap/ui/core/VariantLayoutData");d=sap.ui.require("sap/ui/layout/GridData");if(!f||!h||!p||!b||!d){sap.ui.require(["sap/m/VBox","sap/m/HBox","sap/m/FlexItemData","sap/ui/core/VariantLayoutData","sap/ui/layout/GridData"],I.bind(this));this._bVBoxRequested=true}}if(f&&h&&p&&b&&d&&!this._bVBoxRequested){return true}else{return false}}function I(e,t,i,a,l){f=e;h=t;p=i;b=a;d=l;this._bVBoxRequested=false;if(!this._bIsBeingDestroyed){this._updateLayout()}}function D(e){var t=e.getLayoutData();if(t){if(t.getStyleClass&&!t.getStyleClass()){t.setStyleClass("sapUiCompGroupElementHBoxPadding")}}else{t=new p({styleClass:"sapUiCompGroupElementHBoxPadding"});t._bCreatedByGroupElement=true;e.setLayoutData(t)}}function T(e){var t=e.getLayoutData();if(t){if(t._bCreatedByGroupElement){t.destroy()}else if(t.getStyleClass&&t.getStyleClass()=="sapUiCompGroupElementHBoxPadding"){t.setStyleClass()}}}function B(e,t,i){if(!g._myVBox){g._myVBox=f.extend("SmartFormVBox",{metadata:{interfaces:["sap.ui.core.IFormContent"]},enhanceAccessibilityState:G,renderer:{apiVersion:2}})}this._bMoveLabelToVBox=true;var a=e.slice(0);if(t){a.splice(0,0,t)}var l=new g._myVBox(this.getId()+"--VBox",{items:a});this._bMoveLabelToVBox=false;l.addStyleClass("sapUiCompGroupElementVBox");l._oGroupElement=this;if(i&&(i instanceof d||i instanceof b||i.isA("sap.ui.layout.ResponsiveFlowLayoutData"))){l.setLayoutData(i.clone())}A.call(this,l);return l}function V(e){var t=new h(this.getId()+"--HBox",{items:e});t._oGroupElement=this;t.enhanceAccessibilityState=G;return t}function G(e,t){var i=this._oGroupElement._getLabel();if(i&&i!=e&&!(e instanceof h)){var a=t["labelledby"];if(!a){a=i.getId()}else{var l=a.split(" ");if((l?Array.prototype.indexOf.call(l,i.getId()):-1)<0){l.splice(0,0,i.getId());a=l.join(" ")}}t["labelledby"]=a}}g.prototype._updateGridDataSpan=function(){if(!this._bHorizontalLayoutUsed){return}var e=this.getFields();if(e.length>0){var t=e[0];if(t instanceof f){A.call(this,t)}}};function A(e){var t=this.getParent();if(!t||!t.addGroupElement){return}var i=t.getParent();while(i&&!i.addGroup&&i.getParent){i=i.getParent()}if(!i){return}var a="";var l=i.getLayout();if(l){a=l.getGridDataSpan()}var s=e.getLayoutData();var r;if(s){if(!(s instanceof d)&&!(s instanceof b)&&a){r=new d({span:a});r._bFromGroupElement=true;var o=new b({multipleLayoutData:[s,r]});o._bFromGroupElement=true;e.setLayoutData(o)}else if(s instanceof d){if(s._bFromGroupElement){if(!a){s.destroy()}else{s.setSpan(a)}}}else if(s instanceof b){var n=false;s.getMultipleLayoutData().forEach(function(e){if(e instanceof d){n=true;if(e._bFromGroupElement){if(!a){e.destroy()}else{e.setSpan(a)}}}});if(!n&&a){r=new d({span:a});r._bFromGroupElement=true;s.addMultipleLayoutData(r)}if(s._bFromGroupElement&&s.getMultipleLayoutData().length==1){r=s.getMultipleLayoutData()[0];e.setLayoutData(r);s.destroy()}}}else if(a){r=new d({span:a});r._bFromGroupElement=true;e.setLayoutData(r)}var u=this.getElements();for(var f=0;f<u.length;f++){var h=u[f];if(h&&h.setControlContext){if(a){h.setControlContext(m.SmartFormGrid)}else{h.setControlContext(m.Form)}}}}g.prototype._setLinebreak=function(e,t,i,a){if(!this._bHorizontalLayoutUsed){return}var l=this.getFields();if(l.length>0){var s=l[0];if(!(s instanceof f)){return}var r=s.getLayoutData();if(r){if(r instanceof b){var o=r.getMultipleLayoutData();for(var n=0;n<o.length;n++){r=o[n];if(r instanceof d){r.setLinebreakXL(e);r.setLinebreakL(t);r.setLinebreakM(i);r.setLinebreakS(a)}}}else if(r instanceof d){r.setLinebreakXL(e);r.setLinebreakL(t);r.setLinebreakM(i);r.setLinebreakS(a)}}}};g.prototype.setVisible=function(e){var t=this.isVisible();a.prototype.setVisible.apply(this,arguments);if(t!=e){O.call(this)}return this};g.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};function O(){this.fireVisibleChanged({visible:this.isVisible()});if(this.getParent()){this.getParent()._updateLineBreaks()}}g.prototype.getFormElement=function(){return this};g.prototype.addElement=function(e){if(!e){return this}e=this.validateAggregation("elements",e,true);R.call(this,e);var t;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){t=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){H.call(this,e,undefined,true)}else{this.addField(e)}if(t&&t!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(t)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};g.prototype.insertElement=function(e,t){if(!e){return this}e=this.validateAggregation("elements",e,true);R.call(this,e);var i;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){H.call(this,e,t,false)}else{this.insertField(e,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};g.prototype.getElements=function(){var e;var t;if(this._bHorizontalLayoutUsed){e=this.getFields();t=this._extractFields(e,true)}else{t=this.getFields()}return t};g.prototype.indexOfElement=function(e){var t=-1;if(this._bHorizontalLayoutUsed){var i=this.getElements();for(var a=0;a<i.length;a++){if(e==i[a]){t=a;break}}}else{t=this.indexOfField(e)}return t};g.prototype.removeElement=function(e){var t;var i;if(this._oLabel&&this._oLabel._bCreatedByGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}if(this._bHorizontalLayoutUsed){t=M.call(this,e,false)}else{t=this.removeField(e)}if(t){q.call(this,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return t};g.prototype.removeAllElements=function(){var e;if(this._bHorizontalLayoutUsed){e=M.call(this,undefined,true)}else{e=this.removeAllFields()}if(e&&Array.isArray(e)){for(var t=0;t<e.length;t++){q.call(this,e[t])}}this.updateLabelOfFormElement();this._updateFormElementVisibility();return e};g.prototype.destroyElements=function(){if(this._bHorizontalLayoutUsed){var e=this.getFields();if(e.length>0){var t=this._getLabel();if(t){e[0].removeItem(t);if(t==this._oLabel){this.setAggregation("_label",t,true)}else{this.setAggregation("label",t)}}this.destroyFields()}}else{this.destroyFields()}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};g.prototype._observeChanges=function(e){a.prototype._observeChanges.apply(this,arguments);if(e.object==this){switch(e.name){case"useHorizontalLayout":this._updateLayout();break;case"horizontalLayoutGroupElementMinWidth":u.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);this._updateLayout();break;case"elementForLabel":this.updateLabelOfFormElement();break;case"_editable":x.call(this,e.current);break;default:break}}else{U.call(this,e)}};function H(e,t,i){var a=this._getLabel();var l=this.getFields();var s;var r;var o;if(l.length>0){s=l[0]}else{o=[e];var n=e.getLayoutData();s=B.call(this,o,a,n);this.addField(s);if(a){E.call(this)}return}if(!(s instanceof f)){return}o=s.getItems();if(a){if(o.length>1){r=o[1]}}else if(o.length>0){r=o[0]}if(r instanceof h){o=r.getItems();if((i||t>0)&&o.length>0){D.call(this,e)}if(i){r.addItem(e)}else{if(t==0&&o.length>0){D.call(this,o[0])}r.insertItem(e,t)}}else{var u=r;o=[];if(u){s.removeItem(u);if(i||t>0){o.push(u);o.push(e);D.call(this,e)}else{o.push(e);o.push(u);D.call(this,u)}r=V.call(this,o);s.addItem(r)}else{s.addItem(e)}if(a){E.call(this)}}}function R(e){if(e.getEditable){if(!e.getEditable()){e.data("editable",false)}}this._oObserver.observe(e,{properties:["visible"]});if(e.attachInnerControlsCreated){e.attachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(m.Form)}if(e.getMetadata().getProperty("mandatory")){this._oObserver.observe(e,{properties:["mandatory"]})}C.call(this,e,this.getProperty("_editable"));z.call(this,e)}function z(e){if(e instanceof n){var t=this.getCustomData();for(var i=0;i<t.length;i++){P.call(this,e,t[i])}}}function P(t,i){if(t instanceof n&&e.smartform.inheritCostomDataToFields(i)&&!t.data(i.getKey())){var a=i.clone();a._bFromGroupElement=true;a._sOriginalId=i.getId();t.addCustomData(a)}}function U(e){if(e.name=="mandatory"){this.invalidateLabel()}else if(e.name=="visible"){this._updateFormElementVisibility()}}function M(e,t){var i=this._getLabel();var a=this.getFields();var l;var s;var r;var o;var n=false;var u;if(a.length>0){l=a[0]}if(!(l instanceof f)){return null}r=l.getItems();if(i){if(r.length>1){s=r[1]}}else if(r.length>0){s=r[0]}if(s instanceof h){if(t){o=s.removeAllItems();n=true}else{o=s.removeItem(e);r=s.getItems();if(r.length>0){T.call(this,r[0]);if(r.length==1){u=r[0];s.removeAllItems();l.removeItem(s);s.destroy();l.addItem(u)}}}}else{if(t){o=l.removeAllItems()}else{o=l.removeItem(e)}if(o){n=true}}if(n){if(i){l.removeItem(i);if(i==this._oLabel){this.setAggregation("_label",i,true)}else{this.setAggregation("label",i)}}this.removeField(l);l.destroy()}if(o){if(Array.isArray(o)){for(var p=0;p<o.length;p++){u=o[p];T.call(this,u)}}else{T.call(this,o)}}return o}function q(e){if(e.detachInnerControlsCreated){e.detachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(m.None)}w.call(this,e);k.call(this,e,this.getLabelText())}function k(e,t){if(e._oTextLabelSetByGroupElement){if(e.getComputedTextLabel()==t){e.setTextLabel(e._oTextLabelSetByGroupElement.oldText)}delete e._oTextLabelSetByGroupElement}}function w(e,t){if(e instanceof n){var i=e.getCustomData();for(var a=0;a<i.length;a++){var l=i[a];if(l._bFromGroupElement&&(!t||t==l._sOriginalId)){e.removeCustomData(l);l.destroy()}}}}g.prototype._updateFormElementLabel=function(e){var t=this._getFieldRelevantForLabel();var i=this._getLabel();var a=e.oSource;var l=e.getParameters();if(i instanceof o&&a&&l&&a===t){i.updateLabelFor(l)}};g.prototype.addCustomData=function(e){if(!e){return this}a.prototype.addCustomData.apply(this,arguments);var t=this.getElements();for(var i=0;i<t.length;i++){P.call(this,t[i],e)}return this};g.prototype.insertCustomData=function(e,t){if(!e){return this}a.prototype.insertCustomData.apply(this,arguments);var i=this.getElements();for(var l=0;l<i.length;l++){P.call(this,i[l],e)}return this};g.prototype.removeCustomData=function(e){var t=a.prototype.removeCustomData.apply(this,arguments);if(t){var i=this.getElements();for(var l=0;l<i.length;l++){w.call(this,i[l],t.getId())}}return t};g.prototype.removeAllCustomData=function(){var e=a.prototype.removeAllCustomData.apply(this,arguments);if(e.length>0){var t=this.getElements();for(var i=0;i<t.length;i++){w.call(this,t[i])}}return e};g.prototype.destroyCustomData=function(){a.prototype.destroyCustomData.apply(this,arguments);var e=this.getElements();for(var t=0;t<e.length;t++){w.call(this,e[t])}return this};g.prototype.getVisibleBasedOnElements=function(){var e=false;var t=this.getElements();if(t&&t.length>0){e=t.some(function(e){return e.getVisible()})}return e};function W(){var e=this.getTooltip();if(!e||typeof e==="string"||e instanceof String){return e}else{return e.getText()}}g.prototype.clone=function(e,t){var i=this.removeAllElements();var l=a.prototype.clone.apply(this,arguments);for(var s=0;s<i.length;s++){var r=i[s];var o=r.clone(e,t);this.addElement(r);l.addElement(o)}return l};g.prototype.getFlexConfig=function(){var e=this._getFieldRelevantForLabel();if(e&&e.isA("sap.ui.comp.smartfield.SmartField")){return{entitySetName:e._getEntitySet()}}};return g});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/Layout", ["sap/ui/comp/library","sap/ui/layout/library","sap/ui/core/Element"],function(t,a,e){"use strict";var u=e.extend("sap.ui.comp.smartform.Layout",{metadata:{interfaces:["sap.ui.comp.smartform.SmartFormLayout"],library:"sap.ui.comp",properties:{labelSpanXL:{type:"int",group:"Misc",defaultValue:null},labelSpanL:{type:"int",group:"Misc",defaultValue:null},labelSpanM:{type:"int",group:"Misc",defaultValue:null},labelSpanS:{type:"int",group:"Misc",defaultValue:null},emptySpanXL:{type:"int",group:"Misc",defaultValue:null},emptySpanL:{type:"int",group:"Misc",defaultValue:null},emptySpanM:{type:"int",group:"Misc",defaultValue:null},emptySpanS:{type:"int",group:"Misc",defaultValue:null},columnsXL:{type:"int",group:"Misc",defaultValue:null},columnsL:{type:"int",group:"Misc",defaultValue:null},columnsM:{type:"int",group:"Misc",defaultValue:null},singleGroupFullSize:{type:"boolean",group:"Misc",defaultValue:true},breakpointXL:{type:"int",group:"Misc",defaultValue:null},breakpointL:{type:"int",group:"Misc",defaultValue:null},breakpointM:{type:"int",group:"Misc",defaultValue:null},gridDataSpan:{type:"sap.ui.layout.GridSpan",group:"Misc",defaultValue:""}}},_oSpan:{XL:0,L:0,M:0,S:0}});u.prototype.setGridDataSpan=function(t){var a=[];var e=/XL([1-9]|1[0-2])(?:\s|$)/i;a=e.exec(t);if(a&&a[1]){this._oSpan.XL=parseInt(a[1])}else{this._oSpan.XL=0}e=/\bL([1-9]|1[0-2])(?:\s|$)/i;a=e.exec(t);if(a&&a[1]){this._oSpan.L=parseInt(a[1]);if(!this._oSpan.XL){this._oSpan.XL=this._oSpan.L}}e=/M([1-9]|1[0-2])(?:\s|$)/i;a=e.exec(t);if(a&&a[1]){this._oSpan.M=parseInt(a[1])}e=/S([1-9]|1[0-2])(?:\s|$)/i;a=e.exec(t);if(a&&a[1]){this._oSpan.S=parseInt(a[1])}this.setProperty("gridDataSpan",t);return this};u.prototype._getGridDataSpanNumbers=function(){return this._oSpan};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/SemanticGroupElement", ["sap/ui/comp/library","sap/ui/core/Control","sap/ui/layout/form/SemanticFormElement","sap/ui/layout/form/FormHelper","sap/m/Label","sap/m/Button","sap/m/Text","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/SmartField","sap/base/Log","sap/ui/core/InvisibleText"],function(e,t,i,a,r,o,l,s,n,u,h){"use strict";var f;var p;var m=e.smartfield.ControlContextType;var d=i.extend("sap.ui.comp.smartform.SemanticGroupElement",{metadata:{library:"sap.ui.comp",interfaces:["sap.ui.comp.IFormGroupElement"],properties:{elementForLabel:{type:"int",group:"Misc",defaultValue:0}},defaultAggregation:"elements",aggregations:{elements:{type:"sap.ui.core.Control",multiple:true,singularName:"element"}},events:{visibleChanged:{}}},_bVisibleElements:false});function b(e,i){if(e==this._oSetLabelFromOutside){return}var a;if(this._oSetLabelFromOutside&&this._oSetLabelFromOutside instanceof t){a=g.call(this._oSetLabelFromOutside)}if(!a){a=g.call(this)}if(a){if(e instanceof s){if(i&&i.setTooltipLabel){i.setTooltipLabel(a)}}else{e.setTooltip(a)}}}function g(){var e=this.getTooltip();if(!e||typeof e==="string"||e instanceof String){return e}else{return e.getText()}}function c(e){if(e.getParameter("name")=="text"){var t=e.oSource;var i=t.getText();if(this._oLabel){this._oLabel.setText(i)}var a=this._getFieldRelevantForLabel();if(a&&a.getComputedTextLabel){if(!a._oTextLabelSetBySemanticGroupElement){a._oTextLabelSetBySemanticGroupElement={oldText:a.getComputedTextLabel()}}a.setTextLabel(i)}}}function y(){if(this.getRequired&&this.getRequired()){return true}var e=this.getParent();var t=e.getElements();for(var i=0;i<t.length;i++){var a=t[i];if(a.getRequired&&a.getRequired()===true&&(!a.getEditable||a.getEditable())&&(!a.getContextEditable||a.getContextEditable())){return true}}return false}function L(){if(this.getDisplayOnly){if(!this.isPropertyInitial("displayOnly")){return this.getDisplayOnly()}var e=this.getParent();var t=e.getParent();if(t){var i=t.getParent();if(i){return!i.getEditable()}}}return false}function _(){var e=this.getParent();if(e._oSetLabelFromOutside&&!(typeof e._oSetLabelFromOutside==="string")&&e._oSetLabelFromOutside.getWrapping&&!e._oSetLabelFromOutside.isPropertyInitial("wrapping")){return e._oSetLabelFromOutside.getWrapping()}return true}function v(e,t){if(e._oTextLabelSetBySemanticGroupElement){if(e.getComputedTextLabel()==t){e.setTextLabel(e._oTextLabelSetBySemanticGroupElement.oldText)}delete e._oTextLabelSetBySemanticGroupElement}}function F(e){e._bCreatedBySemanticGroupElement=true;e.isRequired=y;e.isDisplayOnly=L;e.isWrapping=_;return e}function S(e){if(e.getEditable){if(!e.getEditable()){e.data("editable",false)}}this._oObserver.observe(e,{properties:["visible"]});if(e.attachInnerControlsCreated){e.attachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(m.Form)}if(e.getMetadata().getProperty("mandatory")){this._oObserver.observe(e,{properties:["mandatory"]})}O.call(this,e,this.getProperty("_editable"));D.call(this,e);if(e.isA("sap.ui.comp.smartfield.SmartField")&&e._isInnerControlCreationDelayed&&e.getMode()==="display"){e._forceInitialise()}if(e.isA("sap.ui.comp.smartfield.SmartField")){e.attachInnerControlsCreated(function(){this._observeChanges({object:e,name:"visible"});e.getInnerControls().forEach(function(t){var i=t.getBinding("text");if(i){i.attachChange(function(){this._observeChanges({object:e,name:"visible"})}.bind(this))}}.bind(this))}.bind(this))}}function E(e){if(e.name=="mandatory"){this.invalidateLabel()}else if(e.name=="visible"){this._updateFormElementVisibility()}}function C(){this.fireVisibleChanged({visible:this.isVisible()});if(this.getParent()){this.getParent()._updateLineBreaks()}}function x(e){var t=this.getElements();for(var i=0;i<t.length;i++){var a=t[i];O.call(this,a,e)}}function O(e,t){if(e instanceof n){if(!(e.data("editable")===false)){e.setContextEditable(t)}}}function D(e){if(e instanceof n){var t=this.getCustomData();for(var i=0;i<t.length;i++){I.call(this,e,t[i])}}}function T(e,t){if(e instanceof n){var i=e.getCustomData();for(var a=0;a<i.length;a++){var r=i[a];if(r._bFromSemanticGroupElement&&(!t||t==r._sOriginalId)){e.removeCustomData(r);r.destroy()}}}}function I(t,i){if(t instanceof n&&e.smartform.inheritCostomDataToFields(i)&&!t.data(i.getKey())){var a=i.clone();a._bFromSemanticGroupElement=true;a._sOriginalId=i.getId();t.addCustomData(a)}}function A(e){if(e.detachInnerControlsCreated){e.detachInnerControlsCreated(this._updateFormElementLabel,this)}if(e.setControlContext){e.setControlContext(m.None)}T.call(this,e);v.call(this,e,this.getLabelText())}d.prototype.init=function(){i.prototype.init.apply(this,arguments);this._oObserver.observe(this,{properties:["elementForLabel","_editable","delimiter"]})};d.prototype._getFieldRelevantForLabel=function(){var e=this.getElements();var t=this.getElementForLabel();if(e.length>t&&e[t]instanceof n){return e[t]}return null};d.prototype._extractFields=function(e,t){var i=[];e.forEach(function(e){i.push(e)});if(t){i=i.filter(function(e){return!(e instanceof r)})}return i};d.prototype._observeChanges=function(e){i.prototype._observeChanges.apply(this,arguments);if(e.object==this){switch(e.name){case"useHorizontalLayout":u.error("useHorizontalLayout can't be used with SemanticGroupElement",this);break;case"elementForLabel":this.updateLabelOfFormElement();break;case"_editable":x.call(this,e.current);break;default:break}}else{E.call(this,e)}};d.prototype._getLabel=function(){if(this._oLabel){return this._oLabel}else{return this._oSetLabelFromOutside}};d.prototype._createLabel=function(e){var t=null;var i=this._getFieldRelevantForLabel();if(i){if(i.getShowLabel&&i.getShowLabel()){t=new s(i.getId()+"-label");if(e){if(!i._oTextLabelSetBySemanticGroupElement){i._oTextLabelSetBySemanticGroupElement={oldText:i.getComputedTextLabel()}}i.setTextLabel(e);t.setText(e)}t.setLabelFor(i)}}else{t=new r(this.getId()+"-label",{text:e})}if(t){t=F(t);this._oLabel=t;this.setAggregation("_label",t,true);if(this._oSetLabelFromOutside&&typeof this._oSetLabelFromOutside!=="string"){this._oSetLabelFromOutside.setAlternativeLabelFor(null)}}return t};d.prototype._updateFormElementLabel=function(e){var t=this._getFieldRelevantForLabel();var i=this._getLabel();var a=e.oSource;var r=e.getParameters();if(i instanceof s&&a&&r&&a===t){i.updateLabelFor(r)}};d.prototype._updateFormElementVisibility=function(){var e=this.getVisibleBasedOnElements();if(this._bVisibleElements!==e){this._bVisibleElements=e;if(this.isPropertyInitial("visible")){C.call(this);this.invalidate()}}};d.prototype._updateGridDataSpan=function(){};d.prototype._setLinebreak=function(e,t,i,a){var r=this.getFields();if(r.length>0){var o=r[0];if(!(o instanceof f)){return}var l=o.getLayoutData();if(l instanceof p){l.setLinebreakXL(e);l.setLinebreakL(t);l.setLinebreakM(i);l.setLinebreakS(a)}}};d.prototype.getFieldsForRendering=function(){var e,t,i,r,o=this.getDelimiter(),l=this.getId()+"-delimiter-",s=true,n=true,u=false,h=true,f=[],p=this.getFields();for(e=0;e<p.length;e++){r=p[e];if(!r.isA("sap.ui.core.ISemanticFormContent")){s=false;break}if(n){var m=r.isA("sap.ui.comp.smartfield.SmartField"),d=r._getEmbeddedSmartField(),b=m&&!!d;if(m&&!r.getEditable()){n=b?!d.getEditable():true}else{n=false}if(!n){h=false}}if(r._hasSemanticObject()||r._hasCriticality()){u=true}}if(!s){return}if(!this._bLayoutDataCreated){V.call(this)}if(this.getProperty("_editable")&&!h||u){i=this.getAggregation("_delimiters",[]);for(var g=0;g<p.length;g++){r=p[g];if(r.getVisible()){if(f.length>0){t=i[g-1];if(t===undefined){t=a.createDelimiter(o,l+g);t.addStyleClass("sapUiFormDelimiter");this.addAggregation("_delimiters",t)}f.push(t)}f.push(r)}}}else{var c=this.getAggregation("_displayField");if(!c){G.call(this,true);c=this.getAggregation("_displayField")}f.push(c)}return f};function V(){var e=this.getFields().filter(function(e){return e.getVisible()});var t=this.getAggregation("_delimiters",[]);var i=this.getParent();var a=i&&i.getParent();var r=a&&a.getLayout();var o;var l=0;if(!r||!r.getLayoutDataForDelimiter){return}if(this.getProperty("_editable")){for(l=0;l<t.length;l++){var s=t[l];if(!s.getLayoutData()){o=r.getLayoutDataForDelimiter();if(o){if(o instanceof Promise){o.then(function(e){e._bSetBySemanticFormElement=true;this.setLayoutData(e)}.bind(s))}else if(o.isA("sap.ui.core.LayoutData")){o._bSetBySemanticFormElement=true;s.setLayoutData(o)}}}}if(e.length>1){for(l=0;l<e.length;l++){var n=e[l];o=n.getLayoutData();if(!o||o._bSetBySemanticFormElement){o=r.getLayoutDataForSemanticField(e.length,l+1,o);if(o){if(o instanceof Promise){o.then(function(e){e._bSetBySemanticFormElement=true;this.setLayoutData(e)}.bind(n))}else if(o.isA("sap.ui.core.LayoutData")&&!o._bSetBySemanticFormElement){o._bSetBySemanticFormElement=true;n.setLayoutData(o)}}}}}this._bLayoutDataCreated=true}}var B={onBeforeRendering:function(){P.call(this,true)}};function G(e){var t=this.getAggregation("_displayField");if(t){P.call(this,false)}else{var i=this.getId()+"-display";t=a.createSemanticDisplayControl("",i);t.addDelegate(B,true,this);this.setAggregation("_displayField",t)}}function P(e){var t=this.getAggregation("_displayField");if(t&&(t.getDomRef()||e)){if(e&&t._bNoForceUpdate){t._bNoForceUpdate=false;return}var i=this.getFields();var r=[];var o=false;for(var l=0;l<i.length;l++){var s=i[l];if(s.getVisible()){var n=s.getFormValueProperty?s.getFormValueProperty():null;var u;if(s.getFormFormattedValue){u=s.getFormFormattedValue();if(u instanceof Promise){o=true}}else if(n){u=s.getProperty(n)}else if(s.getMetadata().getProperty("value")){u=s.getValue()}else if(s.getMetadata().getProperty("text")){u=s.getText()}r.push(u)}}t._bNoForceUpdate=true;if(o){Promise.all(r).then(function(e){var t=this.getAggregation("_displayField");var i=R.call(this,e);t._bNoForceUpdate=true;a.updateSemanticDisplayControl(t,i)}.bind(this))}else{var h=R.call(this,r);a.updateSemanticDisplayControl(t,h)}}else if(t&&t._bNoForceUpdate){t._bNoForceUpdate=false}}function R(e){var t=this.getDelimiter();var i="";for(var a=0;a<e.length;a++){i=i+e[a];if(a<e.length-1){i=i+" "+t+" "}}return i}d.prototype.setTooltip=function(e){i.prototype.setTooltip.apply(this,[e]);var t=this._getFieldRelevantForLabel();var a=this._getLabel();b.call(this,a,t);return this};d.prototype.setLabel=function(e){if(this._oSetLabelFromOutside&&typeof this._oSetLabelFromOutside!=="string"){this._oSetLabelFromOutside.detachEvent("_change",c,this)}var t;var a;var r;if(typeof e==="string"){t=this._getLabel();if(t){a=t.getText()}}else if(!e&&this._oSetLabelFromOutside){a=this.getLabelText()}i.prototype.setLabel.apply(this,[e]);this._oSetLabelFromOutside=e;if(typeof e==="string"){if(this._oLabel instanceof s&&e!=a&&(e.length>0||a.length>0)){r=this._getFieldRelevantForLabel();if(r&&e!=null){if(r.getComputedTextLabel){if(!r._oTextLabelSetBySemanticGroupElement){r._oTextLabelSetBySemanticGroupElement={oldText:r.getComputedTextLabel()}}r.setTextLabel(e)}}}this.setAggregation("_label",this._oLabel,true);this._oLabel.isRequired=y;this._oLabel.isDisplayOnly=L}else{if(e){if(e.isRequired){e.isRequired=y}if(e.isDisplayOnly){e.isDisplayOnly=L}e.attachEvent("_change",c,this)}else{r=this._getFieldRelevantForLabel();if(r){v.call(this,r,a)}}this.updateLabelOfFormElement()}return this};d.prototype.destroyLabel=function(){var e=this.getLabelText();i.prototype.destroyLabel.apply(this);delete this._oSetLabelFromOutside;var t=this._getFieldRelevantForLabel();if(t){v.call(this,t,e)}this.updateLabelOfFormElement();return this};d.prototype.getLabel=function(){return this._oSetLabelFromOutside};d.prototype.getLabelControl=function(){return this._getLabel()};d.prototype.getLabelText=function(){var e="";var t=this._getLabel();if(t){e=t.getText()}return e};d.prototype.getDataSourceLabel=function(){var e=this._getFieldRelevantForLabel();if(e&&e.isA("sap.ui.comp.smartfield.SmartField")){return e.getDataSourceLabel()}};d.prototype.updateLabelOfFormElement=function(){var e=false,t=null;var a=this.getElements();var r=this._getFieldRelevantForLabel();var o=this._getLabel();var l=false;if(o&&o._bCreatedBySemanticGroupElement){if(o instanceof s){if(!r||o._sSmartFieldId&&o._sSmartFieldId!=r.getId()){l=true}}else if(r){l=true}if(l){o.destroy();delete this._oLabel;o=null;if(this._oSetLabelFromOutside&&!r){if(typeof this._oSetLabelFromOutside==="string"){i.prototype.setLabel.apply(this,[this._oSetLabelFromOutside]);o=this._oLabel;this._oLabel.isRequired=y;this._oLabel.isDisplayOnly=L}else{o=this._oSetLabelFromOutside}}}}else if(o&&r){if(o==this._oLabel){o.destroy();delete this._oLabel}o=null}if(!o){if(this._oSetLabelFromOutside){if(typeof this._oSetLabelFromOutside==="string"){t=this._oSetLabelFromOutside}else{t=this._oSetLabelFromOutside.getText()}}else{t=""}}if(!o&&a.length>0){o=this._createLabel(t);e=true}if(o){if(o instanceof s){if(r&&r.setTextLabel&&r.getComputedTextLabel()){o.setText(r.getComputedTextLabel())}}b.call(this,o,r)}if(e){if(o&&o.setLabelFor&&!(o instanceof s)&&!r&&a.length>0){o.setLabelFor(a[0])}}};d.prototype.invalidateLabel=function(){var e=this._getLabel();if(e){e.invalidate()}};d.prototype.getUseHorizontalLayout=function(){u.error("getUseHorizontalLayout can't be used with SemanticGroupElement",this)};d.prototype.setUseHorizontalLayout=function(e){u.error("setUseHorizontalLayout can't be used with SemanticGroupElement",this)};d.prototype.getHorizontalLayoutGroupElementMinWidth=function(){u.error("getHorizontalLayoutGroupElementMinWidth can't be used with SemanticGroupElement",this)};d.prototype.setHorizontalLayoutGroupElementMinWidth=function(e){u.error("setHorizontalLayoutGroupElementMinWidth can't be used with SemanticGroupElement",this)};d.prototype.setVisible=function(e){var t=this.isVisible();i.prototype.setVisible.apply(this,arguments);if(t!=e){C.call(this)}return this};d.prototype.isVisible=function(){if(this.isPropertyInitial("visible")){return this._bVisibleElements}else{return this.getVisible()}};d.prototype.getVisibleBasedOnElements=function(){var e=false;var t=this.getElements();if(t&&t.length>0){e=t.some(function(e){return e.getVisible()})}return e};d.prototype.getFormElement=function(){return this};d.prototype.addElement=function(e){if(!e){return this}e=this.validateAggregation("elements",e,true);S.call(this,e);var t;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){t=this._oLabel._sSmartFieldId}this.addField(e);if(t&&t!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(t)}this.updateLabelOfFormElement();this._updateFormElementVisibility();if(e.isA("sap.ui.comp.smartfield.SmartField")){e.attachEventOnce("innerControlsCreated",function(){this._enhanceAriaLabelledBy(e)}.bind(this))}return this};d.prototype._enhanceAriaLabelledBy=function(e){const t=e.getDataSourceLabel(),i=new h({text:t});e.addAriaLabelledBy(i);e.addAggregation("_ariaLabelInvisibleText",i)};d.prototype.insertElement=function(e,t){if(!e){return this}e=this.validateAggregation("elements",e,true);S.call(this,e);var i;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}this.insertField(e,t);if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};d.prototype.getElements=function(){var e;e=this.getFields();return e};d.prototype.indexOfElement=function(e){var t=-1;t=this.indexOfField(e);return t};d.prototype.removeElement=function(e){var t;var i;if(this._oLabel&&this._oLabel._bCreatedBySemanticGroupElement&&this._oLabel._sSmartFieldId){i=this._oLabel._sSmartFieldId}t=this.removeField(e);if(t){A.call(this,t)}if(i&&i!=this._oLabel._sSmartFieldId){this._oLabel.setLabelFor(i)}this.updateLabelOfFormElement();this._updateFormElementVisibility();return t};d.prototype.removeAllElements=function(){var e=this.removeAllFields();if(e&&Array.isArray(e)){for(var t=0;t<e.length;t++){A.call(this,e[t])}}this.updateLabelOfFormElement();this._updateFormElementVisibility();return e};d.prototype.destroyElements=function(){this.destroyFields();this.updateLabelOfFormElement();this._updateFormElementVisibility();return this};d.prototype.addCustomData=function(e){if(!e){return this}i.prototype.addCustomData.apply(this,arguments);var t=this.getElements();for(var a=0;a<t.length;a++){I.call(this,t[a],e)}return this};d.prototype.insertCustomData=function(e,t){if(!e){return this}i.prototype.insertCustomData.apply(this,arguments);var a=this.getElements();for(var r=0;r<a.length;r++){I.call(this,a[r],e)}return this};d.prototype.removeCustomData=function(e){var t=i.prototype.removeCustomData.apply(this,arguments);if(t){var a=this.getElements();for(var r=0;r<a.length;r++){T.call(this,a[r],t.getId())}}return t};d.prototype.removeAllCustomData=function(){var e=i.prototype.removeAllCustomData.apply(this,arguments);if(e.length>0){var t=this.getElements();for(var a=0;a<t.length;a++){T.call(this,t[a])}}return e};d.prototype.destroyCustomData=function(){i.prototype.destroyCustomData.apply(this,arguments);var e=this.getElements();for(var t=0;t<e.length;t++){T.call(this,e[t])}return this};d.prototype.clone=function(e,t){var a=this.removeAllElements();var r=i.prototype.clone.apply(this,arguments);for(var o=0;o<a.length;o++){var l=a[o];var s=l.clone(e,t);this.addElement(l);r.addElement(s)}return r};return d});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/SmartForm", ["sap/ui/comp/library","sap/ui/core/Control","sap/ui/core/Lib","sap/ui/core/theming/Parameters","sap/ui/layout/form/Form","sap/ui/base/ManagedObjectObserver","sap/base/Log","sap/m/Label","sap/m/Button","sap/m/Text"],function(t,e,i,o,s,a,r,n,l,u){"use strict";var h;var p;var c;var f;var g;var l;var d;var m;var y=t.smartform.SmartFormValidationMode;var b=t.smartform.Importance;var _={ResponsiveGridLayout:{layout:undefined,path:"sap/ui/layout/form/ResponsiveGridLayout",name:"sap.ui.layout.form.ResponsiveGridLayout",requested:false,loaded:ut,promise:undefined},ResponsiveLayout:{layout:undefined,path:"sap/ui/layout/form/ResponsiveLayout",name:"sap.ui.layout.form.ResponsiveLayout",requested:false,loaded:ht,promise:undefined},ColumnLayout:{layout:undefined,path:"sap/ui/layout/form/ColumnLayout",name:"sap.ui.layout.form.ColumnLayout",requested:false,loaded:pt,promise:undefined}};var v={apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartForm");t.openEnd();var i=e.getAggregation("content");t.renderControl(i);t.close("div")}};var L=e.extend("sap.ui.comp.smartform.SmartForm",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartform/SmartForm.designtime",properties:{title:{type:"string",group:"Misc",defaultValue:null},useHorizontalLayout:{type:"boolean",group:"Misc",defaultValue:null,deprecated:true},horizontalLayoutGroupElementMinWidth:{type:"int",group:"Misc",defaultValue:null,deprecated:true},checkButton:{type:"boolean",group:"Misc",defaultValue:false},entityType:{type:"string",group:"Misc",defaultValue:null},expandable:{type:"boolean",group:"Misc",defaultValue:false},expanded:{type:"boolean",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},editable:{type:"boolean",group:"Misc",defaultValue:false},ignoredFields:{type:"string",group:"Misc",defaultValue:null},flexEnabled:{type:"boolean",group:"Misc",defaultValue:true},validationMode:{type:"sap.ui.comp.smartform.SmartFormValidationMode",group:"Misc",defaultValue:y.Standard},importance:{type:"sap.ui.comp.smartform.Importance",group:"Misc",defaultValue:b.Low}},defaultAggregation:"groups",aggregations:{groups:{type:"sap.ui.comp.smartform.Group",multiple:true,singularName:"group"},content:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},layout:{type:"sap.ui.comp.smartform.SmartFormLayout",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},customToolbar:{type:"sap.m.Toolbar",multiple:false},toolbar:{type:"sap.m.Toolbar",multiple:false,visibility:"hidden"}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{editToggled:{parameters:{editable:{type:"boolean"}}},checked:{parameters:{erroneousFields:{type:"sap.ui.comp.smartfield.SmartField[]"}}}}},renderer:v});L.prototype.init=function(){this._oForm=new s(this.getId()+"--Form");this._oForm.getToolbar=function(){var t=this.getParent();if(t&&!t.getExpandable()){return t._getToolbar()}};this.setAggregation("content",this._oForm);this._oRb=i.getResourceBundleFor("sap.ui.comp");this._oObserver=new a(F.bind(this));this._oObserver.observe(this,{properties:["editTogglable","title","checkButton","useHorizontalLayout","horizontalLayoutGroupElementMinWidth","expandable","expanded"],aggregations:["layout","customData"],associations:["ariaLabelledBy"]})};L.prototype.onBeforeRendering=function(){nt.call(this)};L.prototype.onAfterRendering=function(){var t=this.getSmartFields(false,false),e=this.getImportance();if(!this.isPropertyInitial("importance")){t.forEach(function(t){t._setVisibilityBasedOnImportance(e)})}};L.prototype.addGroup=function(t){var e=this,i,o,s;if(!t){return this}s=this._getSmartFieldsByGroup(t,false);s.forEach(function(t){i=t.setImportance;t.setImportance=function(){i.apply(this,arguments);o=e.getImportance();this._setVisibilityBasedOnImportance(o)}});t=this.validateAggregation("groups",t,true);D.call(this,t);this._oForm.addFormContainer(t);C.call(this,t);return this};L.prototype.getGroups=function(){return this._oForm.getFormContainers()};L.prototype.indexOfGroup=function(t){return this._oForm.indexOfFormContainer(t)};L.prototype.insertGroup=function(t,e){if(!t){return this}t=this.validateAggregation("groups",t,true);D.call(this,t);this._oForm.insertFormContainer(t,e);C.call(this,t);return this};L.prototype.removeGroup=function(t){var e=this._oForm.removeFormContainer(t);if(e){e.detachEvent("_visibleChanged",gt,this);X.call(this,e);gt.call(this)}return e};L.prototype.removeAllGroups=function(){var t=this._oForm.removeAllFormContainers();for(var e=0;e<t.length;e++){t[e].detachEvent("_visibleChanged",gt,this);X.call(this,t[e])}gt.call(this);return t};L.prototype.destroyGroups=function(){var t=this.getGroups();for(var e=0;e<t.length;e++){t[e].detachEvent("_visibleChanged",gt,this)}this._oForm.destroyFormContainers();gt.call(this);return this};L.prototype.getFlexConfig=function(){const t=this.getSmartFields();if(!t.length){return}return{entitySetName:t[0]._getEntitySet()}};function C(t){var e=this.getUseHorizontalLayout();var i=this.getHorizontalLayoutGroupElementMinWidth();t.attachEvent("_visibleChanged",gt,this);if(i!=t.getHorizontalLayoutGroupElementMinWidth()){t.setHorizontalLayoutGroupElementMinWidth(i)}if(e!=t.getUseHorizontalLayout()){t.setUseHorizontalLayout(e)}if(e){t._updateGridDataSpan();t._updateLineBreaks()}else{gt.call(this)}}L.prototype._getToolbar=function(){var t=this.getCustomToolbar();return t||this.getAggregation("toolbar")};L.prototype.propagateGridDataSpan=function(){var t=this.getGroups();for(var e=0;e<t.length;e++){var i=t[e];i._updateGridDataSpan();i._updateLineBreaks()}return this};L.prototype._getGridDataSpanNumbers=function(){var t=this.getLayout();var e;if(t&&t._getGridDataSpanNumbers){e=t._getGridDataSpanNumbers()}return e};L.prototype._toggleEditMode=function(){var t=this.getEditable();this.setEditable(!t)};L.prototype.check=function(t){var e={considerOnlyVisible:true,handleSuccess:false};if(typeof t==="boolean"){e.considerOnlyVisible=t}else{e=Object.assign(e,t)}if(this.getValidationMode()===y.Standard){return this._checkClientError(e)}else{return this._checkClientErrorAsync(e)}};L.prototype._checkClientError=function(t){if(t.considerOnlyVisible===undefined){t.considerOnlyVisible=true}var e=this.getSmartFields(t.considerOnlyVisible,t.considerOnlyVisible);var i=[];var o=null;e.forEach(function(e){if(e.checkClientError&&e.checkClientError({handleSuccess:t.handleSuccess})){if(t.considerOnlyVisible&&e.getVisible){if(!e.getVisible()){return}}o=e.getParent();while(o.getParent){o=o.getParent();if(o.isA("sap.ui.comp.smartform.Group")){if(!o.getExpanded()){o.setExpanded(true)}break}}i.push(e.getId())}});return i};L.prototype._checkClientErrorAsync=function(t){var e=this.getSmartFields(t.considerOnlyVisible,t.considerOnlyVisible),i,o=[],s;this.setBusy(true);if(t.considerOnlyVisible===undefined){t.considerOnlyVisible=true}i=e.map(function(e){if(t.considerOnlyVisible&&!e.getVisible()){return false}return e.checkValuesValidity({handleSuccess:t.handleSuccess}).catch(function(){s=e.getParent();while(s.getParent){s=s.getParent();if(s.isA("sap.ui.comp.smartform.Group")){if(!s.getExpanded()){s.setExpanded(true)}break}}o.push(e.getId())})});return Promise.all(i).then(function(){this.setBusy(false);return o}.bind(this))};L.prototype._displayError=function(t){var e=this._oRb.getText("FORM_CLIENT_CHECK_ERROR_TITLE");var i=this._oRb.getText("FORM_CLIENT_CHECK_ERROR");if(!d&&!this._bMessageBoxRequested){d=sap.ui.require("sap/m/MessageBox");if(!d){sap.ui.require(["sap/m/MessageBox"],T.bind(this));this._bMessageBoxRequested=true}}if(d){d.show(i,{icon:d.Icon.ERROR,title:e,styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""})}};function T(t){d=t;this._bMessageBoxRequested=false;if(!this._bIsBeingDestroyed){E.call(this)}}function E(){var t=this.check(true);if(t&&t.length>0){this._displayError(t);return true}return false}function S(){return this.check(true).then(function(t){if(t&&t.length){this._displayError(t)}return t}.bind(this))}L.prototype.setEditable=function(t){var e=this.getEditable();t=this.validateProperty("editable",t);if(e===t){return this}if(!t&&this.hasListeners("editToggled")){if(this.getValidationMode()===y.Standard){if(E.call(this)){return this}}else{S.call(this).then(function(e){if(e.length){return this.setProperty("editable",true)}B.call(this,t)}.bind(this));return this.setProperty("editable",t)}}this.setProperty("editable",t);B.call(this,t);return this};function B(t){if(this._oForm){this._oForm.setEditable(t)}this.fireEditToggled({editable:t});if(this._oEditToggleButton){this._oEditToggleButton.setIcon(t?"sap-icon://display":"sap-icon://edit");var e=this._oRb.getText(t?"FORM_TOOLTIP_DISPLAY":"FORM_TOOLTIP_EDIT");this._oEditToggleButton.setTooltip(e)}if(this.getCheckButton()&&t){tt.call(this)}else{et.call(this)}}function F(t){if(t.object==this){if(t.name=="editTogglable"){M.call(this,t.current)}else if(t.name=="title"){k.call(this,t.current)}else if(t.name=="checkButton"){I.call(this,t.current)}else if(t.name=="useHorizontalLayout"){R.call(this,t.current)}else if(t.name=="horizontalLayoutGroupElementMinWidth"){O.call(this,t.current)}else if(t.name=="expanded"){x.call(this,t.current)}else if(t.name=="expandable"){P.call(this,t.current)}else if(t.name=="layout"){G.call(this,t.child,t.mutation)}else if(t.name=="customData"){z.call(this,t.child,t.mutation)}else if(t.name=="ariaLabelledBy"){w.call(this,t.ids,t.mutation)}}else if(t.object.isA("sap.ui.comp.smartform.SmartFormLayout")){yt.call(this,t.object,t.name,t.current,t.old)}}function M(t){if(t){Q.call(this)}else{Z.call(this)}W.call(this)}function k(t){if(this._oPanel){this._oPanel.setHeaderText(t)}W.call(this)}function I(t){if(t){tt.call(this)}else{et.call(this)}W.call(this)}function R(t){if(t){this.addStyleClass("sapUiCompSmartFormHorizontalLayout")}else{this.removeStyleClass("sapUiCompSmartFormHorizontalLayout")}var e=this.getGroups();if(e){e.forEach(function(e){if(e.getUseHorizontalLayout()!=t){e.setUseHorizontalLayout(t)}})}var i=this.getLayout();if(t){ct.call(this,i)}else{nt.call(this);ct.call(this,i)}}function G(t,e){if(e==="remove"){this._oObserver.unobserve(t)}else{this._oObserver.observe(t,{properties:true})}if(t.isA("sap.ui.comp.smartform.Layout")){this.propagateGridDataSpan()}nt.call(this);ct.call(this,e==="insert"?t:null)}function O(t){r.error("HorizontalLayoutGroupElementMinWidth is deprecated",this);var e=this.getGroups();if(e){e.forEach(function(e){e.setHorizontalLayoutGroupElementMinWidth(t)})}}L.prototype.getVisibleProperties=function(){var t=[];var e=this.getGroups();if(e){e.forEach(function(e){var i=e.getGroupElements();if(i.length>0){i.forEach(function(e){var i=e.getElements();if(i.length>0){i.forEach(function(e){if(e.getVisible()){var i=e.getBindingPath("value");if(i){t.push(i)}}})}})}})}return t};L.prototype.setCustomToolbar=function(t){var e=this.getCustomToolbar();if(e==t){return this}Y.call(this);Z.call(this);et.call(this);this.setAggregation("customToolbar",t);if(this.getTitle()){W.call(this)}if(this.getEditTogglable()){Q.call(this)}if(this.getCheckButton()){tt.call(this)}return this};L.prototype.destroyCustomToolbar=function(){var t=this.getCustomToolbar();if(t){Y.call(this);Z.call(this);et.call(this)}this.destroyAggregation("customToolbar");if(this.getTitle()){W.call(this)}if(this.getEditTogglable()){Q.call(this)}if(this.getCheckButton()){tt.call(this)}return this};function P(t){if(t){if(!h&&!this._bPanelRequested){h=sap.ui.require("sap/m/Panel");if(!h){sap.ui.require(["sap/m/Panel"],A.bind(this));this._bPanelRequested=true}}if(h){q.call(this)}}else if(this._oPanel){this.setAggregation("content",this._oForm);this._oPanel.destroy();this._oPanel=null}W.call(this)}function q(){this._oPanel=new h(this.getId()+"--Panel",{expanded:this.getExpanded(),expandable:true,headerText:this.getTitle(),expandAnimation:false});this._oPanel.getHeaderToolbar=function(){var t=this.getParent();if(t){return t._getToolbar()}};this._oPanel.attachExpand(V,this);this.setAggregation("content",this._oPanel);this._oPanel.addContent(this._oForm)}function A(t){h=t;this._bPanelRequested=false;if(this.getExpandable()&&!this._bIsBeingDestroyed){q.call(this)}}function V(t){this.setProperty("expanded",t.getParameter("expand"),true)}function x(t){if(this._oPanel){this._oPanel.setExpanded(t)}}function z(t,e){var i=this.getGroups();for(var o=0;o<i.length;o++){if(e==="insert"){H.call(this,i[o],t)}else{X.call(this,i[o],t.getId())}}}function D(t){var e=this.getCustomData();for(var i=0;i<e.length;i++){H.call(this,t,e[i])}}function H(e,i){if(t.smartform.inheritCostomDataToFields(i)){var o=i.clone();o._bFromSmartForm=true;o._sOriginalId=i.getId();e.addCustomData(o)}}function X(t,e){var i=t.getCustomData();for(var o=0;o<i.length;o++){var s=i[o];if(s._bFromSmartForm&&(!e||e==s._sOriginalId)){t.removeCustomData(s)}}}function w(t,e){var i;if(Array.isArray(t)){i=t}else{i=[t]}for(var o=0;o<i.length;o++){var s=i[o];if(e==="insert"){this._oForm.addAriaLabelledBy(s)}else{this._oForm.removeAriaLabelledBy(s)}}}L.prototype._getSmartFieldsByGroup=function(t,e){var i=[],o=[],s=[];i=t.getGroupElements();for(var a=0;a<i.length;a++){var r=i[a];if(!e||e&&r.isVisible()){o=r.getElements();for(var n=0;n<o.length;n++){var l=o[n];if(l.isA("sap.ui.comp.smartfield.SmartField")){s.push(l)}}}}return s};L.prototype.getSmartFields=function(t,e){var i=[],o,s=[];if(t===undefined){t=true}i=this.getGroups();for(var a=0;a<i.length;a++){var r=i[a];if(!t||t&&r.isVisible()){o=this._getSmartFieldsByGroup(r,e);s=s.concat(o)}}return s};L.prototype.setFocusOnEditableControl=function(){var t=[];this.getGroups().forEach(function(e){if(e.isVisible()){e.getGroupElements().forEach(function(e){if(e.isVisible()){t=t.concat(e.getElements())}})}});t.some(function(t){if(t.getEditable&&t.getEditable()&&t.focus&&t.getVisible()){if(t.isA("sap.ui.comp.smartfield.SmartField")){t.attachEventOnce("innerControlsCreated",function(t){setTimeout(t.oSource._oControl[t.oSource._oControl.current]["focus"].bind(t.oSource._oControl[t.oSource._oControl.current]),0)})}else{t.focus()}return true}})};L.prototype.clone=function(t,i){this.setAggregation("content",null);var o=this.getAggregation("toolbar");var s=this.getCustomToolbar();var a=this.getCustomData();var r=this.getGroups();var n=0;if(s){Y.call(this);Z.call(this);et.call(this)}else if(o){this.setAggregation("toolbar",null)}if(a.length>0){for(n=0;n<r.length;n++){X.call(this,r[n])}}var l=e.prototype.clone.apply(this,arguments);for(n=0;n<r.length;n++){var u=r[n].clone(t,i);l.addGroup(u)}if(this.getExpandable()&&this._oPanel){this.setAggregation("content",this._oPanel)}else{this.setAggregation("content",this._oForm)}if(s){if(this.getTitle()){W.call(this)}if(this.getEditTogglable()){Q.call(this)}if(this.getCheckButton()){tt.call(this)}}else if(o){this.setAggregation("toolbar",o)}if(a.length>0){for(n=0;n<r.length;n++){D.call(this,r[n])}}return l};L.prototype.exit=function(){if(this._oForm){this._oForm.destroy()}if(this._oPanel){this._oPanel.destroy()}if(this._oTitle){this._oTitle.destroy()}if(this._oEditToggleButton){this._oEditToggleButton.destroy()}this._oForm=null;this._oPanel=null;this._oTitle=null;this._oRb=null;this._oEditToggleButton=null;this._oObserver.disconnect();this._oObserver=undefined};function U(){var t=this.getAggregation("toolbar");if(!t){t=new c(this.getId()+"-toolbar-sfmain",{height:"3rem",design:m.ToolbarDesign.Transparent});t._bCreatedBySmartForm=true;this.setAggregation("toolbar",t)}return t}function N(t){var e=this.getAggregation("toolbar");if(e){if(t){var i=e.getContent();if(i.length>0){return}}this.destroyAggregation("toolbar")}}function W(){var t=this.getTitle();if(t){if(!this.getCustomToolbar()&&!this.getCheckButton()&&!this.getEditTogglable()){if(this._oTitle){if(this._getToolbar()){Y.call(this)}this._oForm.removeAriaLabelledBy(this._oTitle);this._oTitle.destroy();this._oTitle=null}if(!this._oPanel){this._oForm.setTitle(t)}}else{this._oForm.setTitle();if(!this._oTitle){if((!p||!c||!f||!g||!m)&&!this._bTitleRequested){p=sap.ui.require("sap/m/Title");c=sap.ui.require("sap/m/OverflowToolbar");f=sap.ui.require("sap/m/ToolbarSpacer");g=sap.ui.require("sap/m/ToolbarSeparator");m=sap.ui.require("sap/m/library");if(!p||!c||!f||!g||!m){sap.ui.require(["sap/m/Title","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/ToolbarSeparator","sap/m/library"],j.bind(this));this._bTitleRequested=true}}if(p&&!this._bTitleRequested){var e=o.get("sap.ui.layout.FormLayout:_sap_ui_layout_FormLayout_FormTitleSize");this._oTitle=new p(this.getId()+"-title-sfmain",{level:e.toUpperCase()})}}if(this._oTitle){this._oTitle.setText(t);this._oForm.addAriaLabelledBy(this._oTitle);K.call(this)}}}else{if(this._oTitle){Y.call(this);this._oForm.removeAriaLabelledBy(this._oTitle);this._oTitle.destroy();this._oTitle=null}else{this._oForm.setTitle()}}}function j(t,e,i,o,s){p=t;c=e;f=i;g=o;m=s;this._bTitleRequested=false;if(!this._bIsBeingDestroyed){W.call(this)}}function K(){if(!this._oTitle){return}var t=this._getToolbar();if(!t){t=U.call(this)}t.insertContent(this._oTitle,0)}function Y(){if(!this._oTitle){return}var t=this._getToolbar();t.removeContent(this._oTitle);N.call(this,true)}function $(){if((!l||!c||!f||!g||!m)&&!this._bButtonRequested){l=sap.ui.require("sap/m/Button");c=sap.ui.require("sap/m/OverflowToolbar");f=sap.ui.require("sap/m/ToolbarSpacer");g=sap.ui.require("sap/m/ToolbarSeparator");m=sap.ui.require("sap/m/library");if(!l||!c||!f||!g||!m){sap.ui.require(["sap/m/Button","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/ToolbarSeparator","sap/m/library"],J.bind(this));this._bButtonRequested=true}}if(l&&!this._bButtonRequested){return true}return false}function J(t,e,i,o,s){l=t;c=e;f=i;g=o;m=s;this._bButtonRequested=false;if(!this._bIsBeingDestroyed){if(this._bEditRequested){this._bEditRequested=false;Q.call(this)}if(this._bCheckRequested){this._bCheckRequested=false;tt.call(this)}}}function Q(){if(!this.getEditTogglable()){return}if(!$.call(this)){this._bEditRequested=true;return}var t=this._getToolbar();if(!t){t=U.call(this)}if(!this._oCheckButton){st.call(this,t)}if(!this._oEditToggleButton){var e=this.getEditable()?"sap-icon://display":"sap-icon://edit";var i=this._oRb.getText(this.getEditable()?"FORM_TOOLTIP_DISPLAY":"FORM_TOOLTIP_EDIT");this._oEditToggleButton=new l(t.getId()+"-button-sfmain-editToggle",{icon:e,tooltip:i});this._oEditToggleButton.attachPress(this._toggleEditMode,this)}var o=t.getContent().length;if(this._oCheckButton){o--}t.insertContent(this._oEditToggleButton,o)}function Z(){if(!this._oEditToggleButton){return}var t=this._getToolbar();t.removeContent(this._oEditToggleButton);this._oEditToggleButton.destroy();this._oEditToggleButton=null;at.call(this,t);N.call(this,true)}function tt(){if(!this.getCheckButton()||!this.getEditable()){return}if(!$.call(this)){this._bCheckRequested=true;return}var t=this._getToolbar();if(!t){t=U.call(this)}if(!this._oEditToggleButton){st.call(this,t)}if(!this._oCheckButton){this._oCheckButton=new l(this.getId()+"-"+t.getId()+"-button-sfmain-check",{text:this._oRb.getText("SMART_FORM_CHECK")});this._oCheckButton.attachPress(this.getValidationMode()===y.Standard?it:ot,this)}var e=t.getContent().length;t.insertContent(this._oCheckButton,e)}function et(){if(!this._oCheckButton){return}var t=this._getToolbar();t.removeContent(this._oCheckButton);this._oCheckButton.destroy();this._oCheckButton=null;at.call(this,t);N.call(this,true)}function it(t){var e=[];e=this.check(true);this.fireChecked({erroneousFields:e})}function ot(t){this.check(true).then(function(t){this.fireChecked({erroneousFields:t})}.bind(this))}function st(t){var e;if(!t._bCreatedBySmartForm){var i=t.getContent();var o=false;for(var s=0;s<i.length;s++){if(i[s]instanceof f){o=true;break}}if(!o){e=new f(this.getId()+"-"+t.getId()+"-spacer");e._bCreatedBySmartForm=true;t.addContent(e)}if(!(i[i.length-1]instanceof g)){var a=new g(this.getId()+"-"+t.getId()+"-separator");a._bCreatedBySmartForm=true;t.addContent(a)}}else{e=new f(t.getId()+"-spacer");e._bCreatedBySmartForm=true;t.addContent(e)}}function at(t){var e=t.getContent();var i;if(!t._bCreatedBySmartForm){i=e[e.length-1];if(i instanceof g&&i._bCreatedBySmartForm){i.destroy()}e=t.getContent()}i=e[e.length-1];if(i instanceof f&&i._bCreatedBySmartForm){i.destroy()}}function rt(t,e){if(!t.layout&&!t.requested){t.layout=sap.ui.require(t.path);if(!t.layout){t.promise=new Promise(function(e){sap.ui.require([t.path],t.loaded.bind(this));t.resolve=e;t.requestIds=[this.getId()]}.bind(this));t.requested=true}}else if(!t.layout&&t.requested&&t.promise&&t.requestIds.indexOf(this.getId())<0){t.promise.then(function(){if(!this._bIsBeingDestroyed){nt.call(this)}}.bind(this));t.requestIds.push(this.getId())}if(t.layout&&!t.requested&&!(e instanceof t.layout)){if(e){e.destroy()}e=new t.layout(this._oForm.getId()+"-layout");this._oForm.setLayout(e);return true}return false}function nt(){var t=this.getLayout();var e=this._oForm.getLayout();var i=this.getUseHorizontalLayout();var o=false;if(t&&t.isA("sap.ui.comp.smartform.ColumnLayout")){if(i){throw new Error("ColumnLayout and useHorizontalLayout must not ne used at the same time on "+this)}o=rt.call(this,_.ColumnLayout,e);if(o){mt.call(this,t)}}else if(i&&(!t||!t.getGridDataSpan())){o=rt.call(this,_.ResponsiveLayout,e)}else if(!e||!_.ResponsiveGridLayout.layout||!(e instanceof _.ResponsiveGridLayout.layout)){o=rt.call(this,_.ResponsiveGridLayout,e);if(o){this._oFormLayoutNotInitial=true;ft.call(this,t)}}if(o){var s=this.getGroups();for(var a=0;a<s.length;a++){var r=s[a];r._updateLayoutData()}}}function lt(t,e){t.layout=e;t.requested=false;t.resolve();delete t.resolve;delete t.requestIds;t.promise=undefined;if(!this._bIsBeingDestroyed){nt.call(this)}}function ut(t){lt.call(this,_.ResponsiveGridLayout,t)}function ht(t){lt.call(this,_.ResponsiveLayout,t)}function pt(t){lt.call(this,_.ColumnLayout,t)}function ct(t){if(!t||t.isA("sap.ui.comp.smartform.Layout")){ft.call(this,t)}else if(t.isA("sap.ui.comp.smartform.ColumnLayout")){mt.call(this,t)}}function ft(t){var e=this._oForm.getLayout();if(!e||!e.isA(_.ResponsiveGridLayout.name)){return}if(this.getUseHorizontalLayout()){if(t&&t.getGridDataSpan()){dt.call(this,e);e.setColumnsL(1);e.setColumnsM(1);if(t.getBreakpointM()>0){e.setBreakpointM(t.getBreakpointM())}if(t.getBreakpointL()>0){e.setBreakpointL(t.getBreakpointL())}if(t.getBreakpointXL()>0){e.setBreakpointXL(t.getBreakpointXL())}this._oFormLayoutNotInitial=true}}else{if(t){e.setLabelSpanXL(t.getLabelSpanXL()?t.getLabelSpanXL():-1);e.setLabelSpanL(t.getLabelSpanL()?t.getLabelSpanL():4);e.setLabelSpanM(t.getLabelSpanM()?t.getLabelSpanM():4);e.setLabelSpanS(t.getLabelSpanS()?t.getLabelSpanS():12);e.setEmptySpanXL(t.getEmptySpanXL()?t.getEmptySpanXL():-1);e.setEmptySpanL(t.getEmptySpanL()?t.getEmptySpanL():0);e.setEmptySpanM(t.getEmptySpanM()?t.getEmptySpanM():0);e.setColumnsXL(t.getColumnsXL()?t.getColumnsXL():-1);e.setColumnsL(t.getColumnsL()?t.getColumnsL():3);e.setColumnsM(t.getColumnsM()?t.getColumnsM():2);e.setSingleContainerFullSize(t.getSingleGroupFullSize());e.setBreakpointXL(t.getBreakpointXL()?t.getBreakpointXL():1440);e.setBreakpointL(t.getBreakpointL()?t.getBreakpointL():1024);e.setBreakpointM(t.getBreakpointM()?t.getBreakpointM():600);this._oFormLayoutNotInitial=true}else{dt.call(this,e)}gt.call(this,t,e)}}function gt(t,e){if(this.getUseHorizontalLayout()){return}if(!e){e=this._oForm.getLayout();t=this.getLayout()}if(!e||!e.isA(_.ResponsiveGridLayout.name)){return}var i=this.getGroups();var o=-1;var s=3;var a=true;var r=0;for(var n=0;n<i.length;n++){if(i[n].isVisible()){r++}}if(t){s=t.getColumnsL()?t.getColumnsL():3;o=t.getColumnsXL()>0?t.getColumnsXL():-1;a=t.getSingleGroupFullSize()}if(i&&r>0&&r<o&&a){e.setColumnsXL(r)}else if(e.getColumnsXL()!=o){e.setColumnsXL(o)}if(i&&r>0&&r<s&&a){e.setColumnsL(r)}else if(e.getColumnsL()!=s){e.setColumnsL(s)}}function dt(t){if(this._oFormLayoutNotInitial){t.setLabelSpanXL(-1);t.setLabelSpanL(4);t.setLabelSpanM(4);t.setLabelSpanS(12);t.setEmptySpanXL(-1);t.setEmptySpanL(0);t.setEmptySpanM(0);t.setColumnsXL(-1);t.setColumnsL(3);t.setColumnsM(2);t.setSingleContainerFullSize(true);t.setBreakpointXL(1440);t.setBreakpointL(1024);t.setBreakpointM(600);this._oFormLayoutNotInitial=false}}function mt(t){var e=this._oForm.getLayout();if(!e||!e.isA(_.ColumnLayout.name)){return}if(this.getUseHorizontalLayout()){throw new Error("ColumnLayout and useHorizontalLayout must not ne used at the same time on "+this)}else{e.setColumnsXL(t.getColumnsXL());e.setColumnsL(t.getColumnsL());e.setColumnsM(t.getColumnsM());e.setLabelCellsLarge(t.getLabelCellsLarge());e.setEmptyCellsLarge(t.getEmptyCellsLarge())}}function yt(t,e,i,o){ct.call(this,t);if(e==="gridDataSpan"){this.propagateGridDataSpan();if(i===""||o===""){nt.call(this)}}}L.prototype._suggestTitleId=function(t){this._oForm._suggestTitleId(t);return this};return L});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/SmartForm.flexibility", ["sap/ui/comp/smartform/flexibility/changes/RemoveGroup","sap/ui/comp/smartform/flexibility/changes/AddGroup","sap/ui/comp/smartform/flexibility/changes/MoveGroups","sap/ui/comp/smartform/flexibility/changes/RenameTitle","sap/ui/comp/smartform/flexibility/changes/CombineFields","sap/ui/comp/smartform/flexibility/changes/SplitField","sap/ui/comp/smartform/flexibility/changes/MoveFields","sap/ui/fl/apply/api/DelegateMediatorAPI"],function(e,i,r,t,a,o,l,m){"use strict";m.registerWriteDelegate({controlType:"sap.ui.comp.smartform.SmartForm",delegate:"sap/ui/comp/smartfield/flexibility/SmartFieldWriteDelegate"});m.registerWriteDelegate({controlType:"sap.ui.comp.smartform.Group",delegate:"sap/ui/comp/smartfield/flexibility/SmartFieldWriteDelegate"});return{removeGroup:e,addGroup:i,moveGroups:r,renameField:t,combineFields:a,splitField:o,moveControls:l}},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddField", ["sap/ui/fl/changeHandler/Base","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/comp/smartform/flexibility/changes/AddFields"],function(e,r,t){"use strict";var i={};i.applyChange=function(r,i,n){var l=r.getTexts();var o=r.getContent();var a=function(){var e=l&&l.fieldLabel&&l.fieldLabel.value;var r=o;var t=false;if(r){t=o.field&&(o.field.selector||o.field.id)&&o.field.jsType&&o.field.value&&o.field.valueProperty}return e&&r&&t};var f=n.modifier;var d=n.appComponent;var u=n.view;if(a()){var s=o.field.selector;var p=o.field.id;var c=l.fieldLabel.value;var v=o.field.jsType;var C=o.field.valueProperty;var g=o.field.value;var h=o.field.entitySet;var y=o.field.index;if(f.bySelector(s||p,d,u)){return e.markAsNotApplicable("Control to be created already exists:"+s||p,true)}return Promise.resolve().then(f.createControl.bind(f,"sap.ui.comp.smartform.GroupElement",d,u,s||p)).then(function(e){if(!s){s=f.getSelector(p,d)}r.setRevertData({newFieldSelector:s});f.setProperty(e,"label",undefined);f.setProperty(e,"label",c);return Promise.resolve().then(f.insertAggregation.bind(f,i,"groupElements",e,y,u)).then(function(){return t.addElementIntoGroupElement(f,u,e,v,C,g,h,y,d)})})}return Promise.resolve()};i.completeChangeContent=function(e,t,i){var n=i.appComponent;if(t.fieldLabel){e.setText("fieldLabel",t.fieldLabel,"XFLD")}else{throw new Error("oSpecificChangeInfo.fieldLabel attribute required")}var l={field:{}};if(t.fieldValue){l.field.value=t.fieldValue}else{throw new Error("oSpecificChangeInfo.fieldValue attribute required")}if(t.valueProperty){l.field.valueProperty=t.valueProperty}else{throw new Error("oSpecificChangeInfo.valueProperty attribute required")}if(t.newControlId){l.field.selector=r.getSelector(t.newControlId,n,{index:t.index})}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(t.jsType){l.field.jsType=t.jsType}else{throw new Error("oSpecificChangeInfo.jsType attribute required")}if(t.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{l.field.index=t.index}if(t.entitySet){l.field.entitySet=t.entitySet}e.setContent(l)};i.revertChange=function(e,r,i){return t.revertChange(e,r,i)};i.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().field.selector]}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddFields", ["sap/ui/fl/changeHandler/Base","sap/ui/fl/apply/api/DelegateMediatorAPI","sap/ui/core/util/reflection/JsControlTreeModifier","sap/base/util/merge","sap/base/util/ObjectPath","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t,r,n,o,i){"use strict";function a(e){return typeof e==="function"}function l(e,t){return e+"-element"+t}function u(e){var t=false;t=e.field&&(e.field.selector||e.field.id)&&e.field.jsTypes&&e.field.value&&e.field.valueProperty;if(!t){throw new Error("Change does not contain sufficient information to be applied.")}}function f(e,t){var r=n({},e);r.fieldSelector.id=l(r.fieldSelector.id,0);return t.createControlForProperty(r).then(function(r){var n=e.modifier.getId(r.control);e.labelFor=n;return t.createLabel(e).then(function(e){return{label:e,control:r.control}})})}function d(e,t){var r=n({aggregationName:"formElements",payload:e.payload||{}},t);var i=e.instance;return Promise.resolve().then(function(){if(a(i.createLayout)){return i.createLayout(r)}}).then(function(e){if(o.get("control",e)){e.layoutControl=true;return e}return f(r,i)})}var s={};s.applyChange=function(t,r,n){var o=t.getContent();var i=n.modifier;var a=n.appComponent;var l=o.field.selector;var f=n.view;var d=o.field.id;if(i.bySelector(l||d,a,f)){return e.markAsNotApplicable("Control to be created already exists:"+l||d,true)}var c=o.field.index;var g=t.getDependentControl("form",n);var p=g&&i.getFlexDelegate(g);if(!p){u(o);var v;return Promise.resolve().then(i.createControl.bind(i,"sap.ui.comp.smartform.GroupElement",a,f,l||d)).then(function(e){v=e;if(!l){l=i.getSelector(d,a)}t.setRevertData({newFieldSelector:l});return o.field.jsTypes.reduce(function(e,t,r){var n=o.field.valueProperty[r];var l=o.field.value[r];var u=o.field.entitySet;return e.then(this.addElementIntoGroupElement.bind(this,i,f,v,t,n,l,u,r,a))}.bind(this),Promise.resolve())}.bind(this)).then(function(){return i.insertAggregation(r,"groupElements",v,c)})}return s._addFieldFromDelegate(g,r,l,d,c,o.field.value[0],t,i,f,a)};s._addFieldFromDelegate=function(e,r,n,o,i,a,l,u,f,s){var c;var g;return t.getWriteDelegateForControl({control:e,modifier:u}).then(function(t){var r={appComponent:s,view:f,fieldSelector:n||o,bindingPath:a,modifier:u,element:e};return d(t,r)}).then(function(e){g=e;if(!g.layoutControl){return Promise.resolve().then(u.createControl.bind(u,"sap.ui.comp.smartform.GroupElement",s,f,n||o)).then(function(e){c=e;return Promise.resolve().then(u.insertAggregation.bind(u,c,"label",g.label,0,f)).then(u.insertAggregation.bind(u,c,"fields",g.control,0,f)).then(function(){return c})})}return g.control}).then(function(e){return u.insertAggregation(r,"groupElements",e,i,f)}).then(function(){if(g.valueHelp){return u.insertAggregation(e,"dependents",g.valueHelp,0,f)}}).then(function(){if(!n){n=u.getSelector(o,s)}l.setRevertData({newFieldSelector:n,valueHelpSelector:g.valueHelp&&u.getSelector(g.valueHelp,s)})})};s.addElementIntoGroupElement=function(t,r,n,o,i,a,u,f,d){var s;var c=t.getId(n);var g=l(c,f);return Promise.resolve().then(t.createControl.bind(t,o,d,r,g)).then(function(e){s=e;t.bindProperty(s,i,a);t.setProperty(s,"expandNavigationProperties",true);return t.insertAggregation(n,"elements",s,f,r,true)}).then(function(){if(u){t.setProperty(s,"entitySet",u)}}).catch(function(t){return e.markAsNotApplicable(t&&t.message||"Control couldn't be created",true)})};s.completeChangeContent=function(e,t,n){var o=n.appComponent;var i={field:{}};if(t.fieldValues){i.field.value=t.fieldValues}else if(t.bindingPath){i.field.value=[t.bindingPath]}else{throw new Error("oSpecificChangeInfo.fieldValue or bindingPath attribute required")}if(t.valueProperty){i.field.valueProperty=t.valueProperty}else if(t.bindingPath){i.field.valueProperty=["value"]}else{throw new Error("oSpecificChangeInfo.valueProperty or bindingPath attribute required")}if(t.newControlId){i.field.selector=r.getSelector(t.newControlId,o)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(t.jsTypes){i.field.jsTypes=t.jsTypes}else if(t.bindingPath){i.field.jsTypes=["sap.ui.comp.smartfield.SmartField"]}else{throw new Error("oSpecificChangeInfo.jsTypes or bindingPath attribute required")}if(t.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{i.field.index=t.index}if(t.entitySet){i.field.entitySet=t.entitySet}e.setContent(i);if(t.relevantContainerId){e.addDependentControl(t.relevantContainerId,"form",n)}};s.revertChange=function(e,t,r){var n=r.appComponent;var o=r.view;var i=r.modifier;var a=e.getRevertData();var l=a.newFieldSelector;var u=i.bySelector(l,n,o);return Promise.resolve().then(i.removeAggregation.bind(i,t,"groupElements",u)).then(function(){i.destroy(u);var t=a.valueHelpSelector;if(t){var l=i.bySelector(t,n,o);var f=e.getDependentControl("form",r);return Promise.resolve().then(i.removeAggregation.bind(i,f,"dependents",l)).then(function(){i.destroy(l)})}}).then(function(){e.resetRevertData()})};s.getCondenserInfo=function(e){return{affectedControl:e.getContent().field.selector,classification:i.Create,targetContainer:e.getSelector(),targetAggregation:"groupElements",setTargetIndex:function(e,t){e.getContent().field.index=t},getTargetIndex:function(e){return e.getContent().field.index}}};s.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().field.selector]}};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/AddGroup", ["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/changeHandler/condenser/Classification"],function(e,r){"use strict";var t={};t.applyChange=function(e,r,t){var o=t.modifier;var n=t.appComponent;var i=t.view;var a=e.getContent();var g=e.getTexts();if(g&&g.groupLabel&&g.groupLabel.value&&a&&a.group&&(a.group.selector||a.group.id)){var u=g.groupLabel.value;var s=a.group.index;var p=a.group.selector;return Promise.resolve().then(o.createControl.bind(o,"sap.ui.comp.smartform.Group",n,i,a.group.selector||a.group.id)).then(function(t){if(!p){p=o.getSelector(a.group.id,n)}e.setRevertData({newGroupSelector:p});o.setProperty(t,"visible",true);o.setProperty(t,"title",u);return o.insertAggregation(r,"groups",t,s,i)})}return Promise.resolve()};t.completeChangeContent=function(r,t,o){var n=o.appComponent;var i={group:{}};if(t.newLabel){r.setText("groupLabel",t.newLabel,"XFLD")}else{throw new Error("oSpecificChangeInfo.groupLabel attribute required")}if(t.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{i.group.index=t.index}if(t.newControlId){i.group.selector=e.getSelector(t.newControlId,n)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}r.setContent(i)};t.revertChange=function(e,r,t){var o=t.appComponent;var n=t.view;var i=t.modifier;var a=e.getRevertData().newGroupSelector;var g=i.bySelector(a,o,n);return Promise.resolve().then(i.removeAggregation.bind(i,r,"groups",g)).then(function(){i.destroy(g);e.resetRevertData()})};t.getChangeVisualizationInfo=function(e){var r=e.getText("groupLabel");return{affectedControls:[e.getContent().group.selector],descriptionPayload:{originalLabel:r}}};t.getCondenserInfo=function(e,t){const o=e.getContent();const n=t.modifier;const i=t.appComponent;const a=t.view;const g=n.bySelector(o.group.selector,i,a);const u=g.getParent().getParent();return{affectedControl:o.group.selector,classification:r.Create,targetContainer:u.getId(),targetAggregation:"groups",setTargetIndex(e,r){const t=e.getContent();t.group.index=r;e.setContent(t)},getTargetIndex(e){return e.getContent().group.index}}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/CombineFields", ["sap/base/i18n/Localization","sap/ui/comp/smartform/flexibility/changes/RenameField"],function(e,n){"use strict";var t={};function r(e,n,t){return Promise.all(n.map(function(n){if(!t.found){t.index++;return e.getProperty(n,"mandatory").then(function(e){t.found=t.found||e})}return undefined}))}function o(e,n){var t={found:false,index:-1};return n.reduce(function(n,o){return n.then(e.getAggregation.bind(e,o,"fields")).then(function(n){if(!t.found){return r(e,n,t)}return undefined})},Promise.resolve()).then(function(){return t.found?t.index:-1})}t._getPreviousLabelPropertyOnControl=function(e,n,t){return Promise.resolve().then(n.getProperty.bind(n,e,t)).then(function(r){if(r&&typeof r!=="string"){t="text";e=r}return n.getPropertyBindingOrProperty(e,t)}).then(function(e){return e?e:"$$Handled_Internally$$"})};function i(e){return!!e.newElementId}function l(e,n,t){var r=e.modifier;var o=e.appComponent;var l=e.view;if(i(n)){return r.getAggregation(t,"dependents").then(function(i){var u=i.find(function(e){return r.bySelector(n.newElementId,o,l)});if(u){return r.removeAggregation(t,"dependents",u).then(function(){return u})}return r.createControl("sap.ui.comp.smartform.GroupElement",e.appComponent,e.view,n.newElementId)})}return Promise.resolve(r.bySelector(n.sourceSelector,o,l))}function u(e,n,t,r){return r.getAggregation(e,"groupElements").then(function(e){var r=e.indexOf(n);return t.reduce(function(n,t){var o=e.indexOf(t);if(o>-1&&o<r){n=n-1}return n},r)})}function a(e,n,t,r,o,i,l){if(o.newElementId||e!==n){var u=t.getParent(e);return l.reduce(function(o,l,u){return o.then(t.removeAggregation.bind(t,e,"elements",l)).then(t.insertAggregation.bind(t,n,"elements",l,i+u,r))},Promise.resolve()).then(t.removeAggregation.bind(t,u,"groupElements",e)).then(t.insertAggregation.bind(t,u,"dependents",e,0,r)).then(function(){return i+(l.length||0)})}return Promise.resolve(0)}t.applyChange=function(t,r,g){var s=t.getContent();var c=g.modifier;var d=g.appComponent;var f=g.view;var m=c.bySelector(s.sourceSelector,d,f);var v=c.getParent(m);var p=[];var h;var b;var S;var P;var C=s.combineFieldSelectors.map(function(e){return c.bySelector(e,d,f)});return l(g,s,v).then(function(e){if(e){return u(v,m,C,c).then(function(n){if(n>-1){P=n;m=e}}).then(this._collectRevertDataForElements.bind(this,c,C,d,e,v))}return this._collectRevertDataForElements(c,C,d)}.bind(this)).then(function(e){S=e}).then(function(){return o(c,C).then(function(e){if(e>0){c.setProperty(m,"elementForLabel",e)}})}).then(function(){var n=e.getRTL();var r=0;return C.reduce(function(e,o,i){return e.then(function(e){r=r+e;var l="fieldLabel"+i.toString();b=t.getText(l);if(b&&b!==h){if(n){p.unshift(b)}else{p.push(b)}h=b}return c.getAggregation(o,"elements")}).then(function(e){return a(o,m,c,f,s,r,e)})},Promise.resolve(0))}).then(function(){return n.setLabelPropertyOnControl(m,p.join("/"),c,"label")}).then(function(){if(i(s)){return c.insertAggregation(v,"groupElements",m,P,f)}return undefined}).then(function(){t.setRevertData(S)})};t._collectRevertDataForElements=function(e,n,t,r,o){var i={elementStates:[]};var l=0;var u=0;var a=[];if(r){a.push(r);a=a.concat(n)}return Promise.all(a.map(function(n){var r=e.getParent(n)||o;return Promise.all([e.getAggregation(n,"elements"),e.getAggregation(r,"groupElements"),this._getPreviousLabelPropertyOnControl(n,e,"label"),e.getProperty(n,"elementForLabel")]).then(function(o){u=l+o[0].length-1;i.elementStates.push({groupElementSelector:e.getSelector(e.getId(n),t),parentSelector:e.getSelector(e.getId(r),t),groupElementIndex:o[1].indexOf(n),firstFieldIndex:l,lastFieldIndex:u,label:o[2],elementForLabel:o[3]});l=u+1})}.bind(this))).then(function(){return i})};t.revertChange=function(e,t,r){var o=e.getRevertData();var l=r.modifier;var u=r.appComponent;var a=[];o.elementStates=o.elementStates.sort(function(e,n){return e.groupElementIndex-n.groupElementIndex});return o.elementStates.reduce(function(n,t){var r=l.bySelector(t.parentSelector,u);var o=l.bySelector(t.groupElementSelector,u);return n.then(l.getAggregation.bind(l,r,"groupElements")).then(function(n){if(n.indexOf(o)===-1){return Promise.resolve().then(l.removeAggregation.bind(l,r,"dependents",o)).then(l.insertAggregation.bind(l,r,"groupElements",o,t.groupElementIndex))}else{return Promise.resolve().then(l.getAggregation.bind(l,o,"elements")).then(function(e){a=e;return l.removeAllAggregation(o,"elements")}).then(function(){if(i(e.getContent())){return l.removeAggregation(r,"groupElements",o).then(l.insertAggregation.bind(l,r,"dependents",o))}return undefined})}})},Promise.resolve()).then(function(){return o.elementStates.reduce(function(e,t){var r;var o;return e.then(function(){r=l.bySelector(t.groupElementSelector,u);var e=[];for(var n=t.firstFieldIndex;n<=t.lastFieldIndex;n++){e.push(l.insertAggregation(r,"elements",a[n],a.length))}return Promise.all(e)}).then(function(){o=t.label;if(o==="$$Handled_Internally$$"){o=undefined;return l.getAggregation(r,"fields")}return undefined}).then(function(e){if(e&&e.length){var i=e[t.elementForLabel];l.setProperty(i,"textLabel",undefined)}l.setProperty(r,"elementForLabel",t.elementForLabel);return n.setLabelPropertyOnControl(r,o,l,"label")})},Promise.resolve())}).then(e.resetRevertData.bind(e))};t.completeChangeContent=function(e,n,t){var r=t.modifier;var o=t.view;var i=t.appComponent;var l={};if(n.newElementId){l.newElementId=n.newElementId}var u=n.combineElementIds;if(u&&u.length>=2){l.combineFieldSelectors=u.map(function(e){return r.getSelector(e,i)});e.addDependentControl(u,"combinedFields",t)}else{throw new Error("oSpecificChangeInfo.combineElementIds attribute required")}if(n.sourceControlId){l.sourceSelector=r.getSelector(n.sourceControlId,i);e.addDependentControl(n.sourceControlId,"sourceControl",t)}else{throw new Error("oSpecificChangeInfo.sourceControlId attribute required")}var a;var g;var s;for(var c=0;c<l.combineFieldSelectors.length;c++){var d=l.combineFieldSelectors[c];s=r.bySelector(d,i,o);a=s.getLabelText();if(a){g="fieldLabel"+c;e.setText(g,a,"XFLD")}}e.setContent(l)};t.getChangeVisualizationInfo=function(e){var n=e.getContent();return{displayControls:[n.newElementId],affectedControls:[n.sourceSelector],descriptionPayload:{originalSelectors:n.combineFieldSelectors}}};return t},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/MoveFields", ["sap/ui/fl/changeHandler/MoveControls"],function(e){"use strict";var n=Object.assign({},e);n.applyChange=function(n,t,r){var g=Object.assign({},r,{targetAggregation:"groupElements",sourceAggregation:"groupElements"});return e.applyChange.call(this,n,t,g)};n.getCondenserInfo=function(n){var t=e.getCondenserInfo.call(this,n);t.targetAggregation="groupElements";return t};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/MoveGroups", ["sap/base/Log","sap/ui/core/Element","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/changeHandler/condenser/Classification"],function(e,n,t,r){"use strict";var o={};o._checkCompleteChangeContentConditions=function(e){if(!e.movedElements){throw new Error("oSpecificChangeInfo.movedElements attribute required")}if(e.movedElements.length===0){throw new Error("MovedElements array is empty")}e.movedElements.forEach(function(e){if(!e.id){throw new Error("MovedElements element has no id attribute")}if(typeof e.targetIndex!=="number"){throw new Error("Index attribute at MovedElements element is no number")}})};o._buildStableChangeInfo=function(e){var n=e.source.id;var t=e.target.id;var r={changeType:e.changeType,selector:{id:n},targetId:t!==n?t:null};r[e.changeType]=[];e.movedElements.forEach(function(n){r[e.changeType].push({id:n.id,sourceIndex:n.sourceIndex,index:n.targetIndex})});return r};o.applyChange=function(n,t,r){function o(n,r){if(!n){return Promise.reject(new Error("No change instance"))}var o=n.getContent();return Promise.resolve().then(r.getAggregation.bind(r,t,"groups")).then(function(n){if(!n){e.error("Object has no smartform elements aggregation",r.getId(t))}if(!o||!o.moveGroups||o.moveGroups.length===0){return Promise.reject(new Error("Change format invalid"))}return undefined})}function i(e,n,t,r){if(!e.selector&&!e.id){return Promise.reject(new Error("Change format invalid - moveGroups element has no id attribute"))}if(typeof e.index!=="number"){return Promise.reject(new Error("Change format invalid - moveGroups element index attribute is no number"))}return Promise.resolve(n.bySelector(e.selector||e.id,t,r))}var s=r.modifier;var a=r.view;var u=r.appComponent;var c=[];function d(n,r){if(!r){return Promise.resolve(e.warning("Group to move not found"))}return Promise.resolve().then(s.findIndexInParentAggregation.bind(s,r)).then(function(e){if(e===n.index&&typeof n.sourceIndex==="number"){e=n.sourceIndex}c.push({selector:s.getSelector(r,u),index:e})}).then(s.removeAggregation.bind(s,t,"groups",r,a)).then(s.insertAggregation.bind(s,t,"groups",r,n.index))}return o(n,s).then(function(){var e=n.getContent();return e.moveGroups.reduce(function(e,n){return e.then(i.bind(null,n,s,u,a)).then(function(e){return d(n,e)})},Promise.resolve())}).then(function(){n.setRevertData({movedGroups:c})})};o.completeChangeContent=function(e,r,o){this._checkCompleteChangeContentConditions(r);r=this._buildStableChangeInfo(r);var i={moveGroups:[]};var s=r.moveGroups.map(function(e){var r=n.getElementById(e.id);var s=t.getSelector(r,o.appComponent);i.moveGroups.push({selector:s,sourceIndex:e.sourceIndex,index:e.index});return r});e.addDependentControl(s,"movedGroups",o);e.setContent(i)};o.revertChange=function(e,n,t){var r=t.appComponent;var o=t.view;var i=t.modifier;var s=e.getRevertData().movedGroups;return s.reduce(function(e,t){var s=i.bySelector(t.selector,r,o);return e.then(i.removeAggregation.bind(i,n,"groups",s,o)).then(i.insertAggregation.bind(i,n,"groups",s,t.index))},Promise.resolve()).then(function(){e.resetRevertData()})};o.getChangeVisualizationInfo=function(e){var n=e.getContent();return{affectedControls:[n.moveGroups[0].selector],dependentControls:[n.moveGroups[0].selector.source||e.getSelector()]}};o.getCondenserInfo=function(e,n){const t=e.getContent();const o=n.modifier;const i=n.appComponent;const s=n.view;const a=o.bySelector(t.moveGroups[0].selector,i,s);const u=a.getParent().getParent();return{affectedControl:t.moveGroups[0].selector,classification:r.Move,sourceContainer:u.getId(),targetContainer:u.getId(),sourceIndex:t.moveGroups[0].sourceIndex,sourceAggregation:"groups",targetAggregation:"groups",setTargetIndex(e,n){const t=e.getContent();t.moveGroups[0].index=n;e.setContent(t)},getTargetIndex(e){return e.getContent().moveGroups[0].index},setIndexInRevertData(e,n){const t=e.getRevertData();t.movedGroups[0].index=n;e.setRevertData(t)}}};return o},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RemoveField", [],function(){"use strict";var e={};e.applyChange=function(e,r,n){var t=n.modifier;var i=n.view;var a=t.getParent(r);if(a){return Promise.resolve().then(t.findIndexInParentAggregation.bind(t,r)).then(function(n){e.setRevertData({fieldIndex:n});return t.removeAggregation(a,"groupElements",r,i)})}return Promise.resolve()};e.completeChangeContent=function(e,r){};e.revertChange=function(e,r,n){var t=n.view;var i=n.modifier;var a=e.getRevertData().fieldIndex;var o=i.getParent(r);return Promise.resolve().then(i.insertAggregation.bind(i,o,"groupElements",r,a,t)).then(e.resetRevertData.bind(e))};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RemoveGroup", [],function(){"use strict";var e={};e.applyChange=function(e,n,r){var t=r.modifier;var a=r.view;var o=t.getParent(n);var i;var g;return Promise.resolve().then(t.findIndexInParentAggregation(n)).then(function(e){g=e;if(t.getControlType(o)==="sap.ui.layout.form.Form"){i="formContainers";return t.removeAggregation(o,"formContainers",n,a)}i="groups";return t.removeAggregation(o,"groups",n,a)}).then(t.insertAggregation.bind(t,o,"dependents",n,0,a)).then(function(){e.setRevertData({groupIndex:g,aggregation:i})})};e.completeChangeContent=function(e,n){};e.revertChange=function(e,n,r){var t=r.view;var a=r.modifier;var o=e.getRevertData();var i=a.getParent(n);return Promise.resolve().then(a.removeAggregation.bind(a,i,"dependents",n)).then(a.insertAggregation.bind(a,i,o.aggregation,n,o.groupIndex,t)).then(e.resetRevertData.bind(e))};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameField", ["sap/ui/fl/changeHandler/BaseRename","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier"],function(e,t,r){"use strict";var n="label";var a="fieldLabel";var i="XFLD";var o=e.createRenameChangeHandler({changePropertyName:a,translationTextType:i});o.applyChange=function(e,t,r){var i=e.getText(a);if(typeof i==="string"){return this.setLabelPropertyOnControl(t,i,r.modifier,n).then(function(t){e.setRevertData(t)})}return Promise.resolve()};o.revertChange=function(e,r,a){var i=e.getRevertData();if(i||i===""){if(i==="$$Handled_Internally$$"){i=undefined}return this.setLabelPropertyOnControl(r,i,a.modifier,n).then(function(){e.resetRevertData()})}t.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");return Promise.resolve()};o.setLabelPropertyOnControl=function(e,t,r,n){return Promise.resolve().then(r.getProperty.bind(r,e,n)).then(function(t){if(t&&typeof t!=="string"){n="text";e=t}}).then(r.getPropertyBindingOrProperty.bind(r,e,n)).then(function(a){r.setPropertyBindingOrProperty(e,n,t);return a||"$$Handled_Internally$$"})};o.getChangeVisualizationInfo=function(e,t){var n=e.getText(a),i=e.getRevertData(),o,l,s;if(i==="$$Handled_Internally$$"){i=undefined;o=e.getSelector();l=r.bySelector(o,t);if(l.isA("sap.ui.comp.smartform.GroupElement")){s=l.getDataSourceLabel();if(s){i=s}}}return{descriptionPayload:{originalLabel:i,newLabel:n}}};return o},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameGroup", ["sap/ui/fl/changeHandler/BaseRename","sap/base/Log"],function(e,t){"use strict";var r="label";var n="groupLabel";var a="XFLD";var i=e.createRenameChangeHandler({propertyName:r,changePropertyName:n,translationTextType:a});i.applyChange=function(e,t,a){var i=e.getText(n);if(typeof i==="string"){return this.setLabelOrTitleOnControl(t,i,a.modifier,r).then(function(t){e.setRevertData(t)})}return Promise.resolve()};i.revertChange=function(e,n,a){var i=e.getRevertData();if(i||i===""){return this.setLabelOrTitleOnControl(n,i,a.modifier,r).then(e.resetRevertData())}t.error("Change doesn't contain sufficient information to be reverted. Most Likely the Change didn't go through applyChange.");return Promise.resolve()};i.setLabelOrTitleOnControl=function(e,t,r,n){return Promise.all([r.getProperty(e,n),r.getAggregation(e,"title")]).then(function(t){var a=t[0];var i=t[1];if(!a&&i){if(typeof i==="string"){n="title"}else{n="text";e=i}}return r.getPropertyBindingOrProperty(e,n)}).then(function(a){r.setPropertyBindingOrProperty(e,n,t);return a})};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/RenameTitle", ["sap/ui/fl/changeHandler/BaseRename"],function(e){"use strict";var a=e.createRenameChangeHandler({propertyName:"title",changePropertyName:"fieldLabel",translationTextType:"XFLD"});return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/SplitField", [],function(){"use strict";var e={};e.applyChange=function(e,t,r){var n=e.getContent();var o=r.modifier;var i=r.appComponent;var l=r.view;var a=o.bySelector(n.sourceSelector,i,l);var s;var u=function(e,t){if(e.index>t.index){return 1}else if(e.index<t.index){return-1}};var g=o.bySelector(n.parentSelector,i,l);var c=n.newElementIds.slice();var p=[];var d;var f;var m;var v;return Promise.all([o.getAggregation(a,"elements"),o.getProperty(a,"elementForLabel"),o.getAggregation(g,"groupElements")]).then(function(e){d=e[0];f=e[1];m=e[2];v=m.indexOf(a);return o.getProperty(a,"label")}).then(function(e){if(e&&typeof e!=="string"){return o.getProperty(e,"text")}return e}).then(function(e){s=e;return d.reduce(function(e,t,n){if(n!==f){var u=c.pop();var d;return e.then(o.createControl.bind(o,"sap.ui.comp.smartform.GroupElement",r.appComponent,l,u)).then(function(e){d=e;p.push({groupElementSelector:o.getSelector(d,i),index:n});return Promise.resolve().then(o.removeAggregation.bind(o,a,"elements",t)).then(o.insertAggregation.bind(o,d,"elements",t,0,l)).then(o.insertAggregation.bind(o,g,"groupElements",d,v+n,l)).then(o.getProperty.bind(o,d,"label")).then(function(e){if(e&&typeof e!=="string"){o.setProperty(e,"text",s)}else{o.setProperty(d,"label",s)}})})}else{p.push({groupElementSelector:o.getSelector(a,i),index:n});if(f!==0){o.setProperty(a,"elementForLabel",0)}return e.then(o.removeAggregation.bind(o,a,"elements",t)).then(o.insertAggregation.bind(o,a,"elements",t,0,l)).then(o.getProperty.bind(o,a,"label")).then(function(e){if(e&&typeof e!=="string"){o.setProperty(e,"text",s)}else{o.setProperty(a,"label",s)}})}},Promise.resolve())}).then(function(){e.setRevertData({sourceControlSelector:n.sourceSelector,labelText:s,splittedFields:p.sort(u)})})};e.completeChangeContent=function(e,t,r){var n=r.modifier;var o=r.appComponent;var i={};if(t.newElementIds){i.newElementIds=t.newElementIds.slice(0,-1)}else{throw new Error("oSpecificChangeInfo.newElementIds attribute required")}if(t.sourceControlId){i.sourceSelector=n.getSelector(t.sourceControlId,o);e.addDependentControl(t.sourceControlId,"sourceControl",r)}else{throw new Error("oSpecificChangeInfo.sourceControlId attribute required")}if(t.parentId){i.parentSelector=n.getSelector(t.parentId,o);e.addDependentControl(t.parentId,"parent",r)}else{throw new Error("oSpecificChangeInfo.parentId attribute required")}e.setContent(i)};e.revertChange=function(e,t,r){var n=r.view;var o=r.modifier;var i=r.appComponent;var l=e.getRevertData();var a=l.splittedFields;var s=o.bySelector(l.sourceControlSelector,i,n);return a.reduce(function(e,t){var r=o.bySelector(t.groupElementSelector,i,n);return e.then(o.getAggregation.bind(o,r,"elements")).then(function(e){var i=e[0];return Promise.resolve().then(o.removeAggregation.bind(o,r,"elements",i)).then(o.insertAggregation.bind(o,s,"elements",i,t.index,n))}).then(function(){if(r!==s){o.destroy(r)}})},Promise.resolve()).then(o.getProperty.bind(o,s,"label")).then(function(t){if(t&&typeof t!=="string"){o.setProperty(t,"text",l.labelText)}else{o.setProperty(s,"label",l.labelText)}e.resetRevertData()})};e.getChangeVisualizationInfo=function(e){return{affectedControls:[e.getContent().sourceSelector],dependentControls:e.getContent().newElementIds}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartform/flexibility/changes/UnhideControl", ["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/changeHandler/condenser/Classification"],function(e,t){"use strict";var n={};n.applyChange=function(e,t,n){var i=n.modifier;var r;var s=[];return Promise.resolve().then(i.getAggregation.bind(i,t,"elements")).then(function(e){s=e;return s.reduce(function(e,t){return e.then(function(e){return e||i.getVisible(t)})},Promise.resolve(false))}).then(function(e){r=e;if(!r){s.forEach(function(e){i.setVisible(e,true)})}return i.getAggregation(t,"label")}).then(function(n){var s=false;if(n&&typeof n!=="string"){i.setVisible(n,true);s=true}i.setVisible(t,true);e.setRevertData({partiallyVisible:r,visibleLabel:s})})};n.completeChangeContent=function(e,t){};n.revertChange=function(e,t,n){var i=n.modifier;var r=e.getRevertData();return Promise.resolve().then(i.getAggregation.bind(i,t,"elements")).then(function(e){if(!r.partiallyVisible){e.forEach(function(e){i.setVisible(e,false)})}if(r.visibleLabel){return Promise.resolve().then(i.getAggregation.bind(i,t,"label")).then(function(e){i.setVisible(e,false)})}}).then(function(){i.setVisible(t,false);e.resetRevertData()})};n.getCondenserInfo=function(e){return{affectedControl:e.getSelector(),classification:t.Reverse,uniqueKey:"visible"}};n.getChangeVisualizationInfo=function(t,n){const i=t.getSelector();const r=e.bySelector(i,n);const s={updateRequired:true};if(!r.getVisible()){const e=r.getParent();if(e.getVisible()){s.displayControls=[e.getId()]}else{const t=e.getParent();s.displayControls=[t.getId()]}}return s};return n},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartlist/SmartList", ["sap/ui/comp/library","sap/m/library","sap/m/VBox","sap/m/FlexItemData","sap/m/List","sap/m/Tree","sap/m/Title","sap/m/Toolbar","sap/m/OverflowToolbar","sap/m/ToolbarSpacer","sap/m/OverflowToolbarButton","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/util/FullScreenUtil","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/format/NumberFormat","sap/base/util/deepEqual"],function(t,e,i,s,o,r,a,n,l,h,u,d,p,_,c,f,g){"use strict";var m=e.ToolbarDesign;var T=i.extend("sap.ui.comp.smartlist.SmartList",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},selectFields:{type:"string",group:"Misc",defaultValue:null},expandFields:{type:"string",group:"Misc",defaultValue:null},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},listBindingPath:{type:"string",group:"Misc",defaultValue:null},listType:{type:"sap.ui.comp.smartlist.ListType",group:"Misc",defaultValue:null},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false}},associations:{smartFilter:{type:"sap.ui.core.Control"}},aggregations:{listItemTemplate:{type:"sap.m.ListItemBase",multiple:false}},events:{initialise:{},beforeRebindList:{},dataReceived:{}}},renderer:{apiVersion:2},constructor:function(){i.apply(this,arguments);this.addStyleClass("sapUiCompSmartList");this._createToolbar();this._createList();this.attachModelContextChange(this._initialiseMetadata,this)}});T.prototype._sAggregation="items";T.prototype.setHeader=function(t){this.setProperty("header",t,true);this._refreshHeaderText();return this};T.prototype.setShowRowCount=function(t){this.setProperty("showRowCount",t,true);this._refreshHeaderText();return this};T.prototype.setShowFullScreenButton=function(t){this.setProperty("showFullScreenButton",t,true);if(this._oFullScreenButton){this._oFullScreenButton.setVisible(this.getShowFullScreenButton())}return this};T.prototype.setEntitySet=function(t){this.setProperty("entitySet",t);this._initialiseMetadata();return this};T.prototype._refreshHeaderText=function(){if(!this._headerText){return}var t=this.getHeader();var e=!!t;this._headerText.setVisible(e);if(e&&this.getShowRowCount()){var i=parseInt(this._getRowCount(true));if(i>0){if(!this._oNumberFormatter){this._oNumberFormatter=f.getFloatInstance()}var s=this._oNumberFormatter.format(i);t+=" ("+s+")"}}this._headerText.setText(t)};T.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton)}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new u(this.getId()+"-btnFullScreen",{press:function(){this._toggleFullScreen(!this.bFullScreen)}.bind(this)})}this._toggleFullScreen(this.bFullScreen,true);this._oToolbar.addContent(this._oFullScreenButton)}};T.prototype._createToolbar=function(){var t,e,i;if(!this._oToolbar){t=this.getItems();e=t?t.length:0;while(e--){i=t[e];if(i instanceof n){break}i=null}if(i){this._oToolbar=i}else{this._oToolbar=new l(this.getId()+"-toolbar",{design:m.Transparent});this.insertItem(this._oToolbar,0)}if(!this._oToolbar.getLayoutData()){this._oToolbar.setLayoutData(new s({shrinkFactor:0}))}}};T.prototype._toggleFullScreen=function(t,e){var i=c.getResourceBundleFor("sap.ui.comp"),s;if(!this._oFullScreenButton||t===this.bFullScreen&&!e){return}this.bFullScreen=t;p.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen);s=this.bFullScreen?i.getText("CHART_MINIMIZEBTN_TOOLTIP"):i.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(s);this._oFullScreenButton.setText(s);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};T.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar()}this._addHeaderToToolbar();this._addSpacerToToolbar();this._addFullScreenButton();this._oToolbar.addStyleClass("sapMTBHeader-CTX")};T.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText)}if(!this._headerText){this._headerText=new a(this.getId()+"-header");this._headerText.addStyleClass("sapMH4Style");this._headerText.addStyleClass("sapUiCompSmartTableHeader")}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)};T.prototype._addSpacerToToolbar=function(){var t=false,e=this._oToolbar.getContent(),i,s;if(e){s=e.length;i=0;for(i;i<s;i++){if(e[i]instanceof h){t=true;break}}}if(!t){this._oToolbar.addContent(new h(this.getId()+"-toolbarSpacer"))}};T.prototype._getRowCount=function(t){var e=this._getRowBinding();if(!e){return t?undefined:0}var i;if(!t){i=e.getLength()}else{if(typeof e.getCount==="function"){i=e.getCount()}else if(!e.isA("sap.ui.model.TreeBinding")&&typeof e.isLengthFinal==="function"&&e.isLengthFinal()){i=e.getLength()}}if(i<0||i==="0"){i=0}return i};T.prototype._getRowBinding=function(){if(this._oList){return this._oList.getBinding(this._sAggregation)}};T.prototype._initialiseMetadata=function(){if(!this.bIsInitialised){d.handleModelInit(this,this._onMetadataInitialised)}};T.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){this.detachModelContextChange(this._initialiseMetadata,this);this.bIsInitialised=true;this._listenToSmartFilter();this._createToolbarContent();this._createContent();this.fireInitialise();this._checkAndTriggerBinding()}};T.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindList()}}}};T.prototype._listenToSmartFilter=function(){var t=null;t=this.getSmartFilter();if(typeof t==="string"){this._oSmartFilter=_.getElementById(t)}else{this._oSmartFilter=t}if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindList,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this);this._oSmartFilter.attachCancel(this._cancelEvent,this);this._setNoDataText(c.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_DATA"))}};T.prototype._filterChangeEvent=function(){if(this._isListBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()){this._showOverlay(true)}};T.prototype._cancelEvent=function(){if(this._oSmartFilter&&!this._oSmartFilter.getLiveMode()){this._showOverlay(false)}};T.prototype._showOverlay=function(t){};T.prototype.rebindList=function(t){this._reBindList(null,t)};T.prototype._reBindList=function(t,e){var i,s,o,r,a,n={},l={preventListBind:false};if(this._oSmartFilter){o=this._oSmartFilter.getFilters();n=this._oSmartFilter.getParameters()||{}}r=o;if(!a){a=[]}n["select"]=this.getSelectFields();if(this.getExpandFields()){n["expand"]=this.getExpandFields()}n["useBatchRequests"]=true;l.filters=r;l.sorter=a;l.parameters=n;l.length=undefined;l.startIndex=undefined;this.fireBeforeRebindList({bindingParams:l});if(!l.preventListBind){a=l.sorter;r=l.filters;n=l.parameters;s=this.getListBindingPath()||"/"+this.getEntitySet();this._bDataLoadPending=true;this._bIgnoreChange=false;if(!e){i=this._oList.getBinding(this._sAggregation);if(i&&i.mParameters){e=!(g(n,i.mParameters,true)&&g(n.custom,i.mParameters.custom)&&!l.length&&!l.startIndex&&s===i.getPath())}}if(!i||!this._bIsListBound||e){this._oList.bindItems({path:s,filters:r,sorter:a,parameters:n,length:l.length,startIndex:l.startIndex,template:this._oTemplate,templateShareable:true,events:{dataRequested:function(){this._bIgnoreChange=true}.bind(this),dataReceived:function(t){this._bIgnoreChange=false;this._onDataLoadComplete(t,true);this.fireDataReceived(t)}.bind(this),change:function(t){if(this._bIgnoreChange){return}var e,i=false;e=t&&t.getParameter?t.getParameter("reason"):undefined;if(!e||e==="filter"||e==="context"){i=true}if(e==="change"||i){this._onDataLoadComplete(t,i)}}.bind(this)}});this._bIsListBound=true}else{i.sort(a);i.filter(r,"Application")}this._showOverlay(false)}};T.prototype._onDataLoadComplete=function(t,e){if(this._bDataLoadPending||e){this._bDataLoadPending=false;if(!this._bNoDataUpdated&&!this._getRowCount()){this._bNoDataUpdated=true;this._setNoDataText()}this._refreshHeaderText()}};T.prototype._isListBound=function(){if(this._bIsListBound){return true}if(this._oList){return this._oList.isBound(this._sAggregation)}return false};T.prototype._setNoDataText=function(t){if(this._oList){if(!t){t=c.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS")}this._oList.setNoDataText(t)}};T.prototype._createContent=function(){if(!this._oTemplate){this._oTemplate=this.getListItemTemplate()}};T.prototype._createList=function(){var t=this.getItems(),e=t?t.length:0,i,a;while(e--){i=t[e];if(i instanceof o||i instanceof r){break}i=null}if(i){this._oList=i;if(i instanceof r){this._isTree=true}else{this._isList=true}this._oTemplate=i.getItems()&&i.getItems().length>0?i.getItems()[0]:this.getListItemTemplate();i.removeAllItems()}else{a=this.getId()+"-ui5list";if(this.getListType()==="Tree"){this._oList=new r(a);this._isTree=true}else{this._oList=new o(a,{growing:true,growingScrollToLoad:true});this._isList=true}this.insertItem(this._oList,2)}if(!this._oList.getLayoutData()){this._oList.setLayoutData(new s({growFactor:1,baseSize:"auto"}))}};T.prototype.getList=function(){return this._oList};T.prototype.isInitialised=function(){return!!this.bIsInitialised};T.prototype.exit=function(){if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindList,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter.detachCancel(this._cancelEvent,this);this._oSmartFilter=null}p.cleanUpFullScreen(this);if(this._oTemplate){this._oTemplate.destroy()}this._oTemplate=null;this._oToolbar=null;this._headerText=null;this._oFullScreenButton=null;this._oNumberFormatter=null;this._oList=null};return T});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartAreaMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/AreaMicroChart","sap/suite/ui/microchart/AreaMicroChartPoint","sap/suite/ui/microchart/AreaMicroChartItem","sap/suite/ui/microchart/AreaMicroChartLabel","sap/ui/core/Control","sap/m/library","sap/ui/model/odata/CountMode","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer","sap/ui/model/odata/type/Decimal"],function(t,e,a,r,i,o,n,h,s,c,g){"use strict";var l=n.ValueColor;var u=s.extend("sap.ui.comp.smartmicrochart.SmartAreaMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartAreaMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:true}}},renderer:c});u.prototype._CHART_TYPE=["Area","Line"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Area",true);this.setAggregation("_chart",new e,true)};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true);t.setSize(this.getSize(),true)};u.prototype.setShowLabel=function(t){if(this.getShowLabel()!==t){this.setProperty("showLabel",t,true);this.getAggregation("_chart").setProperty("showLabel",t,true);this.invalidate()}return this};u.prototype.setEnableAutoBinding=function(){return this.setProperty("enableAutoBinding",true,true)};u.prototype.bindElement=function(){return this};u.prototype._createAndBindInnerChart=function(){this._createChartLabels();this._createChartItem("chart",this._oDataPointAnnotations.Value.Path);this._createChartItem("target",this._oDataPointAnnotations.TargetValue.Path);this._buildThreshold()};u.prototype._buildThreshold=function(){var t=this._oDataPointAnnotations.CriticalityCalculation;if(this._hasMember(t,"ImprovementDirection.EnumMember")){switch(t.ImprovementDirection.EnumMember){case s._MINIMIZE:this._createChartItem("minThreshold",t.ToleranceRangeHighValue.Path,l.Good);this._createChartItem("maxThreshold",t.DeviationRangeHighValue.Path,l.Error);break;case s._MAXIMIZE:this._createChartItem("minThreshold",t.DeviationRangeLowValue.Path,l.Error);this._createChartItem("maxThreshold",t.ToleranceRangeLowValue.Path,l.Good);break;case s._TARGET:this._createChartItem("minThreshold",t.DeviationRangeLowValue.Path,l.Error);this._createChartItem("maxThreshold",t.DeviationRangeHighValue.Path,l.Error);this._createChartItem("innerMinThreshold",t.ToleranceRangeLowValue.Path,l.Good);this._createChartItem("innerMaxThreshold",t.ToleranceRangeHighValue.Path,l.Good);break;default:break}}};u.prototype._createChartLabels=function(){var t,e=this._getLabelsMap();for(var a in e){t=new i;this.getAggregation("_chart").setAggregation(e[a],t,true)}};u.prototype._createChartItem=function(t,e,i){var o,n;o=new a({x:{path:this._oChartViewMetadata.dimensionFields[0],formatter:this._formatDimension.bind(this)},y:{path:e,type:new g}});n=new r({points:{path:this._getBindingPath(),template:o,parameters:{countMode:h.None},events:{change:this._onBindingDataChange.bind(this)}},color:i});this.getAggregation("_chart").setAggregation(t,n,true)};u.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getAggregation("chart").getBinding("points");this._updateAssociations(t);this.updateChartLabels.call(this,t)};u.prototype._updateLabel=function(t,e){var a=this.getAggregation("_chart").getAggregation(t);a.setProperty("label",e.text,true);if(e.color){a.setProperty("color",e.color,true)}};u.prototype._getLabelsMap=function(){return{leftTop:"firstYLabel",rightTop:"lastYLabel",leftBottom:"firstXLabel",rightBottom:"lastXLabel"}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartBulletMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/suite/ui/microchart/BulletMicroChart","sap/suite/ui/microchart/BulletMicroChartData","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer","sap/ui/model/odata/type/Decimal"],function(t,a,e,i,o,n,r,s,h){"use strict";var l=n.ValueColor;var u=r.extend("sap.ui.comp.smartmicrochart.SmartBulletMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartBulletMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:s});u._CRITICAL_COLOR=l.Critical;u._ERROR_COLOR=l.Error;u.prototype._CHART_TYPE=["Bullet"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Bullet",true);this.setAggregation("_chart",new i({showValueMarker:true}),true)};u.prototype.setShowLabel=function(t){if(this.getShowLabel()!==t){this.setProperty("showLabel",t,true);var a=this.getAggregation("_chart");a.setProperty("showActualValue",t,true);a.setProperty("showTargetValue",t,true);a.setProperty("showDeltaValue",t,true);a.setProperty("showValueMarker",t,true);this.invalidate()}return this};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};u.prototype._createAndBindInnerChart=function(){this._bindValueProperties();this._bindActualValue();this._bindChartThresholds();this._updateAssociations.call(this);this._setMode()};u.prototype._setMode=function(){if(this._hasMember(this,"_oDataPointAnnotations.Visualization.EnumMember")){if(this._oDataPointAnnotations.Visualization.EnumMember===r._DELTABULLET){this.getAggregation("_chart").setMode(e.BulletMicroChartModeType.Delta)}}};u.prototype._bindValueProperties=function(){var t,a,e=this.getAggregation("_chart");if(this._hasMember(this,"_oDataPointAnnotations.TargetValue.Path")){e.bindProperty("targetValue",{path:this._oDataPointAnnotations.TargetValue.Path,type:new h});var i=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.TargetValue.Path);e.bindProperty("targetValueLabel",{path:this._oDataPointAnnotations.TargetValue.Path,formatter:i.format.bind(i)})}if(this._hasMember(this,"_oDataPointAnnotations.ForecastValue.Path")){e.bindProperty("forecastValue",{path:this._oDataPointAnnotations.ForecastValue.Path,type:new h})}if(this._oDataPointAnnotations.MaximumValue){if(this._oDataPointAnnotations.MaximumValue.hasOwnProperty("Path")){e.bindProperty("maxValue",{path:this._oDataPointAnnotations.MaximumValue.Path,type:new h})}else if(this._oDataPointAnnotations.MaximumValue.hasOwnProperty("Decimal")){t=parseFloat(this._oDataPointAnnotations.MaximumValue.Decimal);e.setMaxValue(t,true)}}if(this._oDataPointAnnotations.MinimumValue){if(this._oDataPointAnnotations.MinimumValue.hasOwnProperty("Path")){e.bindProperty("minValue",{path:this._oDataPointAnnotations.MinimumValue.Path,type:new h})}else if(this._oDataPointAnnotations.MinimumValue.hasOwnProperty("Decimal")){a=parseFloat(this._oDataPointAnnotations.MinimumValue.Decimal);e.setMinValue(a,true)}}};u.prototype._bindActualValue=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.Value.Path);var e=new o({value:{path:this._oDataPointAnnotations.Value.Path,type:new h},color:{parts:[this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path||"",this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path||""],formatter:this._getValueColor.bind(this)}});t.setAggregation("actual",e,true);t.bindProperty("actualValueLabel",{path:this._oDataPointAnnotations.Value.Path,formatter:a.format.bind(a)})};u.prototype._bindChartThresholds=function(){var t,a;if(this._hasMember(this._oDataPointAnnotations,"CriticalityCalculation.ImprovementDirection.EnumMember")){a=this._oDataPointAnnotations.CriticalityCalculation;t=a.ImprovementDirection.EnumMember;if(t!==r._MINIMIZE&&a.DeviationRangeLowValue&&a.DeviationRangeLowValue.Path){this._bindThresholdAggregation(a.DeviationRangeLowValue.Path,u._ERROR_COLOR)}if(t!==r._MINIMIZE&&a.ToleranceRangeLowValue&&a.ToleranceRangeLowValue.Path){this._bindThresholdAggregation(a.ToleranceRangeLowValue.Path,u._CRITICAL_COLOR)}if(t!==r._MAXIMIZE&&a.ToleranceRangeHighValue&&a.ToleranceRangeHighValue.Path){this._bindThresholdAggregation(a.ToleranceRangeHighValue.Path,u._CRITICAL_COLOR)}if(t!==r._MAXIMIZE&&a.DeviationRangeHighValue&&a.DeviationRangeHighValue.Path){this._bindThresholdAggregation(a.DeviationRangeHighValue.Path,u._ERROR_COLOR)}}};u.prototype._bindThresholdAggregation=function(t,a){var e=new o({value:{path:t,type:new h},color:a});this.getAggregation("_chart").addAggregation("thresholds",e,true)};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartColumnMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/suite/ui/microchart/ColumnMicroChart","sap/suite/ui/microchart/ColumnMicroChartData","sap/suite/ui/microchart/ColumnMicroChartLabel","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer","sap/ui/model/odata/type/Decimal"],function(t,a,i,e,o,r,n,s,h,l,c,p,u){"use strict";var g=c.extend("sap.ui.comp.smartmicrochart.SmartColumnMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartColumnMicroChart.designtime"},renderer:p});g.prototype._CHART_TYPE=["Column"];g.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Column",true);this.setAggregation("_chart",new s,true)};g.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};g.prototype.setShowLabel=function(t){var a;if(this.getShowLabel()!==t){a=this.getAggregation("_chart");this.setProperty("showLabel",t,true);a.setProperty("showTopLabels",t,true);a.setProperty("showBottomLabels",t,true);a.invalidate()}return this};g.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length===0){n.error("DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}if(!(this._aDataPointAnnotations[0].Value&&this._aDataPointAnnotations[0].Value.Path)){n.error("Value DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}var t=this.getAggregation("_chart"),a=new h({value:{path:this._aDataPointAnnotations[0].Value.Path,type:new u}});if(this._aDataPointAnnotations[0].Criticality&&this._aDataPointAnnotations[0].Criticality.Path){a.bindProperty("color",{path:this._aDataPointAnnotations[0].Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}if(this._aDataPointAnnotations[0].Title&&this._aDataPointAnnotations[0].Title.Path){a.bindProperty("label",this._aDataPointAnnotations[0].Title.Path)}var i=this._getPropertyAnnotation.call(this,this._aDataPointAnnotations[0].Value.Path);var e=i["com.sap.vocabularies.Common.v1.Text"];if(e&&e.Path){t.setAllowColumnLabels(true);a.bindProperty("displayValue",e.Path)}t.bindAggregation("columns",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}});this._createChartLabels()};g.prototype._createChartLabels=function(){var t,a=this._getLabelsMap();for(var i in a){t=new l;this.getAggregation("_chart").setAggregation(a[i],t,true)}};g.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("columns");this._updateAssociations(t);this.updateChartLabels.call(this,t)};g.prototype._updateLabel=function(t,a){var i=this.getAggregation("_chart").getAggregation(t);if(i!==null){i.setProperty("label",a.text,true);if(a.color){i.setProperty("color",a.color,true)}}};g.prototype._getLabelsMap=function(){return{leftTop:"leftTopLabel",rightTop:"rightTopLabel",leftBottom:"leftBottomLabel",rightBottom:"rightBottomLabel"}};return g});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartComparisonMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/ComparisonMicroChart","sap/suite/ui/microchart/ComparisonMicroChartData","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer","sap/ui/model/odata/type/Decimal"],function(t,a,i,o,n,e,r,s,h,p,c){"use strict";var m=h.extend("sap.ui.comp.smartmicrochart.SmartComparisonMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartComparisonMicroChart.designtime"},renderer:p});m.prototype._CHART_TYPE=["Comparison"];m.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Comparison",true);this.setAggregation("_chart",new a,true)};m.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};m.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartComparisonMicroChart");return}var t=this.getAggregation("_chart"),a=new i({value:{path:this._oDataPointAnnotations.Value.Path,type:new c}});if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("color",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}if(this._oDataPointAnnotations.Title&&this._oDataPointAnnotations.Title.Path){a.bindProperty("title",this._oDataPointAnnotations.Title.Path)}var o=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations.Value.Path);var n=o["com.sap.vocabularies.Common.v1.Text"];if(n&&n.Path){a.bindProperty("displayValue",n.Path)}t.bindAggregation("data",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}})};m.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("data");this._updateAssociations(t)};return m});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartDeltaMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/DeltaMicroChart","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/base/Log","./SmartMicroChartRenderer","sap/ui/model/odata/type/Decimal"],function(t,a,i,n,e,o,r){"use strict";var s=n.extend("sap.ui.comp.smartmicrochart.SmartDeltaMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartDeltaMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:o});s.prototype._CHART_TYPE=["Delta"];s.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType",this._CHART_TYPE,true);this.setAggregation("_chart",new i,true)};s.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true)};s.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length<2){e.error("Two DataPoint annotation are needed! Cannot create the SmartColumnMicroChart");return}if(!(this._aDataPointAnnotations[0].Value&&this._aDataPointAnnotations[0].Value.Path&&this._aDataPointAnnotations[1].Value&&this._aDataPointAnnotations[1].Value.Path)){e.error("Value DataPoint annotation missing! Cannot create the SmartColumnMicroChart");return}this.bindProperties();this._updateAssociations()};s.prototype.bindProperties=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[0].Value.Path),i=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[1].Value.Path);t.bindProperty("value1",{path:this._aDataPointAnnotations[0].Value.Path,type:new r,events:{change:this._onBindingDataChange.bind(this)}});t.bindProperty("value2",{path:this._aDataPointAnnotations[1].Value.Path,type:new r,events:{change:this._onBindingDataChange.bind(this)}});t.bindProperty("displayValue1",{path:this._aDataPointAnnotations[0].Value.Path,formatter:a.format.bind(a)});t.bindProperty("displayValue2",{path:this._aDataPointAnnotations[1].Value.Path,formatter:a.format.bind(i)});if(this._aDataPointAnnotations[0].Title&&this._aDataPointAnnotations[0].Title.Path){t.bindProperty("title1",{path:this._aDataPointAnnotations[0].Title.Path})}if(this._aDataPointAnnotations[1].Title&&this._aDataPointAnnotations[1].Title.Path){t.bindProperty("title2",{path:this._aDataPointAnnotations[1].Title.Path})}if(this._aDataPointAnnotations[0].Criticality&&this._aDataPointAnnotations[0].Criticality.Path){t.bindProperty("color",{path:this._aDataPointAnnotations[0].Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}};s.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart"),a=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[0].Value.Path);t.setDeltaDisplayValue(a.format(t._getDeltaValue()));this._updateAssociations()};return s});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartHarveyBallMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/suite/ui/microchart/HarveyBallMicroChart","sap/suite/ui/microchart/HarveyBallMicroChartItem","sap/base/Log","./SmartMicroChartRenderer","sap/ui/model/odata/type/Decimal"],function(t,a,i,e,o,r,n,s,h,l){"use strict";var u=o.extend("sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartHarveyBallMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}},associations:{freeText:{type:"sap.m.Label",group:"Misc",multiple:false}}},renderer:h});u._CHART_TYPE=["Pie"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Pie",true);this.setAggregation("_chart",new r,true)};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};u.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartHarveyBallMicroChart");return}var t=this.getAggregation("_chart"),a=new n({fraction:{path:this._oDataPointAnnotations.Value.Path,type:new l}});var i=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.Value.Path);a.bindProperty("fractionLabel",{path:this._oDataPointAnnotations.Value.Path,formatter:i.format.bind(i)});var e=this._getLabelNumberFormatter.call(this,this._oDataPointAnnotations.MaximumValue.Path);if(this._oDataPointAnnotations.MaximumValue&&this._oDataPointAnnotations.MaximumValue.Path){t.bindProperty("total",{path:this._oDataPointAnnotations.MaximumValue.Path,type:new l});t.bindProperty("totalLabel",{path:this._oDataPointAnnotations.MaximumValue.Path,formatter:e.format.bind(e)})}if(this._getAnnotation("unitOfMeasure").Path){t.bindProperty("totalScale",{path:this._getAnnotation("unitOfMeasure").Path});a.bindProperty("fractionScale",{path:this._getAnnotation("unitOfMeasure").Path})}if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("color",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}t.addItem(a);this._updateAssociations()};u.prototype._getSupportedChartTypes=function(){return u._CHART_TYPE};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartLineMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/library","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/suite/ui/microchart/LineMicroChart","sap/suite/ui/microchart/LineMicroChartLine","sap/suite/ui/microchart/LineMicroChartPoint","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer"],function(t,i,e,a,r,o,n,s,h,c,g,p){"use strict";var u=g.extend("sap.ui.comp.smartmicrochart.SmartLineMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartLineMicroChart.designtime"},renderer:p});u.prototype._CHART_TYPE=["Line"];u.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Line",true);this.setAggregation("_chart",new s({showThresholdLine:false}),true)};u.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};u.prototype.setShowLabel=function(t){var i;if(this.getShowLabel()!==t){i=this.getAggregation("_chart");this.setProperty("showLabel",t,true);i.setProperty("showTopLabels",t,true);i.setProperty("showBottomLabels",t,true);i.invalidate()}return this};u.prototype._createAndBindInnerChart=function(){if(this._aDataPointAnnotations.length===0){n.error("DataPoint annotation missing! Cannot create the SmartLineMicroChart");return}for(var t=0;t<this._aDataPointAnnotations.length;t++){if(!(this._aDataPointAnnotations[t].Value&&this._aDataPointAnnotations[t].Value.Path)){n.error("Value DataPoint annotation missing! Cannot create the SmartLineMicroChart");return}}var i=this.getAggregation("_chart"),e;this._aDataPointAnnotations.forEach(function(t,a){e=new h(this.getId()+"-line-"+a,{points:{path:this._getBindingPath(),factory:this._pointFactory.bind(this),events:{change:this._onBindingDataChange.bind(this)}}});i.addLine(e)},this)};u.prototype._pointFactory=function(t,i){var e,a,r,o=t.split("-").slice(-2,-1),n=this.getAggregation("_chart").getLines()[o],s=this._aDataPointAnnotations[o],h;e=i.getProperty(this._oChartViewMetadata.dimensionFields[o]);e=this._formatDimension.call(this,e);a=i.getProperty(s.Value.Path);a=Number(a);r=new c({x:e,y:a});if(n&&s.Criticality&&s.Criticality.Path){h=this._mapCriticalityTypeWithColor(i.getProperty(s.Criticality.Path));this.getAggregation("_chart").getLines()[o].setColor(h)}return r};u.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getLines()[0].getBinding("points");this._updateAssociations(t);this.updateChartLabels.call(this,t)};u.prototype._updateLabel=function(t,i){this.getAggregation("_chart").setProperty(t,i.text,true)};u.prototype._getLabelsMap=function(){return{leftTop:"leftTopLabel",rightTop:"rightTopLabel",leftBottom:"leftBottomLabel",rightBottom:"rightBottomLabel"}};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChart", ["sap/ui/core/Control","sap/ui/comp/providers/ChartProvider","sap/suite/ui/microchart/library","sap/m/library","sap/ui/core/CustomData","sap/ui/comp/smartmicrochart/SmartMicroChartBase","sap/base/Log","./SmartMicroChartRenderer","sap/ui/comp/smartmicrochart/SmartLineMicroChart","sap/ui/comp/smartmicrochart/SmartAreaMicroChart","sap/ui/comp/smartmicrochart/SmartBulletMicroChart","sap/ui/comp/smartmicrochart/SmartRadialMicroChart","sap/ui/comp/smartmicrochart/SmartStackedBarMicroChart","sap/ui/comp/smartmicrochart/SmartColumnMicroChart","sap/ui/comp/smartmicrochart/SmartHarveyBallMicroChart"],function(t,a,e,i,r,o,s,n,h,l,c,u,p,d,m){"use strict";var g=i.Size;var M=t.extend("sap.ui.comp.smartmicrochart.SmartMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartMicroChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},freeText:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:n});M.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false};M.prototype.setChartType=function(){return this};M.prototype.getChartType=function(){return this.getAggregation("_chart").getChartType()};M.prototype.propagateProperties=function(){if(t.prototype.propagateProperties){t.prototype.propagateProperties.apply(this,arguments)}this._initializeMetadata()};M.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");if(t){if(t.getMetadata().hasProperty("height")){t.setHeight(this.getHeight(),true)}if(t.getMetadata().hasProperty("width")){t.setWidth(this.getWidth(),true)}if(t.getMetadata().hasProperty("size")){t.setSize(this.getSize(),true)}e._passParentContextToChild(this,t);if(t.getMetadata().hasProperty("showLabel")){t.setShowLabel(this.getShowLabel(),true)}if(t.getMetadata().hasAssociation("chartTitle")){t.setAssociation("chartTitle",this.getChartTitle(),true)}if(t.getMetadata().hasAssociation("chartDescription")){t.setAssociation("chartDescription",this.getChartDescription(),true)}if(t.getMetadata().hasAssociation("unitOfMeasure")){t.setAssociation("unitOfMeasure",this.getUnitOfMeasure(),true)}if(t.getMetadata().hasAssociation("freeText")){t.setAssociation("freeText",this.getFreeText(),true)}}};M.prototype.setSize=function(t){if(this.getSize()!==t){this.setProperty("size",t)}return this};M.prototype.addAriaLabelledBy=function(t){this.addAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").addAriaLabelledBy(t);return this};M.prototype.removeAriaLabelledBy=function(t){this.removeAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").removeAriaLabelledBy(t);return this};M.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this};M.prototype._initializeMetadata=function(){if(!this._bIsInitialized){var t=this.getModel();if(t&&(t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"||t.getMetadata().getName()==="sap.ui.model.odata.ODataModel")){if(!this._bMetaModelLoadAttached){t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this));this._bMetaModelLoadAttached=true}}else if(t){this._onMetadataInitialized()}}};M.prototype._createChartProvider=function(){var t=this.getEntitySet(),e=this.getModel();if(e&&t){this._oChartProvider=new a({entitySet:t,model:e,chartQualifier:this.data("chartQualifier")})}};M.prototype._onMetadataInitialized=function(){var t,a;this._bMetaModelLoadAttached=false;if(!this._bIsInitialized){this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._bIsInitialized=true;this._createInnerChart()}else{t=this.data("chartQualifier");a=this._oChartProvider.getChartDataPointMetadata();if(a){a=t?a.additionalAnnotations[t]:a.primaryAnnotation;if(a){this._bIsInitialized=true;this._createInnerChartFromDataPoint(a)}else{s.error("There is no UI.Chart annotation nore DataPoint annotation. We cannot initialize SmartMicroChart.")}}else{s.error("There is no UI.Chart annotation nore DataPoint annotation. We cannot initialize SmartMicroChart.")}}}}};M.prototype._createInnerChartFromDataPoint=function(t){var a=t.Visualization.EnumMember;if(o._isBulletVizualizationType(a)){this._buildSmartBulletMicroChart()}else{s.error("Only Bullet chart can be initialize with just DataPoint annotation. Type: "+a+" is not a Bullet chart type.");return}this.invalidate()};M.prototype._createInnerChart=function(){if(!this._checkChartMetadata()){s.error("Created annotations not valid. Please review the annotations and metadata.");return}var t=this._oChartViewMetadata.chartType;switch(t){case"line":case"area":var a=this._oChartViewMetadata.annotation.ChartType.EnumMember.split("/").pop().toLowerCase();if(a==="area"){this._buildSmartAreaMicroChart()}else if(a==="line"){this._buildSmartLineMicroChart()}else{s.error("Not supported chart type used.");return}break;case"bullet":this._buildSmartBulletMicroChart();break;case"donut":this._buildSmartRadialMicroChart();break;case"stacked_bar":this._buildSmartStackedBarMicroChart();break;case"column":this._buildSmartColumnMicroChart();break;case"pie":this._buildSmartHarveyBallMicroChart();break;default:s.error("Not supported chart type used.");return}this.invalidate()};M.prototype._buildSmartLineMicroChart=function(){this._buildSmartMicroChart(h)};M.prototype._buildSmartAreaMicroChart=function(){this._buildSmartMicroChart(l)};M.prototype._buildSmartBulletMicroChart=function(){this._buildSmartMicroChart(c)};M.prototype._buildSmartRadialMicroChart=function(){this._buildSmartMicroChart(u)};M.prototype._buildSmartStackedBarMicroChart=function(){this._buildSmartMicroChart(p)};M.prototype._buildSmartColumnMicroChart=function(){this._buildSmartMicroChart(d)};M.prototype._buildSmartHarveyBallMicroChart=function(){this._buildSmartMicroChart(m)};M.prototype._buildSmartMicroChart=function(t){var a=new t({entitySet:this.getEntitySet(),chartBindingPath:this.getChartBindingPath(),initialize:[this._onChartInitialized,this],customData:[new r({key:"chartQualifier",value:this.data("chartQualifier")})]});if(a.getMetadata().hasProperty("enableAutoBinding")){a.setProperty("enableAutoBinding",this.getEnableAutoBinding(),true)}this.setAggregation("_chart",a,true)};M.prototype._onChartInitialized=function(){this.fireInitialize()};M.prototype._checkChartMetadata=function(){if(this._oChartViewMetadata.chartType&&this._oChartViewMetadata.annotation&&this._oChartViewMetadata.annotation.ChartType&&this._oChartViewMetadata.annotation.ChartType.EnumMember&&this._oChartViewMetadata.annotation.ChartType.EnumMember.length>0){return true}else{return false}};M.prototype.getAccessibilityInfo=function(){var t={};var a=this.getAggregation("_chart");if(a&&a.getAccessibilityInfo){t=a.getAccessibilityInfo()}return t};M.prototype._isResponsive=function(){return this.getSize()===g.Responsive};return M});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChartBase", ["sap/ui/core/Element","sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/m/library","sap/ui/comp/providers/ChartProvider","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ui/model/BindingMode","sap/ui/model/type/Date","sap/base/Log","sap/ui/core/Control","./SmartMicroChartRenderer","sap/suite/ui/microchart/library"],function(t,jQuery,e,a,i,r,n,o,s,l,h,u,p){"use strict";var c=a.ValueColor;var y=p.MicroChartColorType;var m=a.Size;var d=h.extend("sap.ui.comp.smartmicrochart.SmartMicroChartBase",{metadata:{abstract:true,library:"sap.ui.comp",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc"},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},showLabel:{type:"boolean",group:"Appearance",defaultValue:true},width:{type:"sap.ui.core.CSSSize",group:"Misc"},height:{type:"sap.ui.core.CSSSize",group:"Misc"},size:{type:"sap.m.Size",group:"Misc",defaultValue:"Auto"},isResponsive:{type:"boolean",group:"Appearance",defaultValue:false}},defaultAggregation:"_chart",aggregations:{_chart:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"}},associations:{chartTitle:{type:"sap.m.Label",group:"Misc",multiple:false},chartDescription:{type:"sap.m.Label",group:"Misc",multiple:false},unitOfMeasure:{type:"sap.m.Label",group:"Misc",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{initialize:{}}},renderer:u});d._MINIMIZE="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Minimize";d._MAXIMIZE="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Maximize";d._TARGET="com.sap.vocabularies.UI.v1.ImprovementDirectionType/Target";d._DELTABULLET="com.sap.vocabularies.UI.v1.VisualizationType/DeltaBulletChart";d._BULLET="com.sap.vocabularies.UI.v1.VisualizationType/BulletChart";d._CALENDAR_TERMS_PATTERNS={"com.sap.vocabularies.Common.v1.IsCalendarYear":"yyyy","com.sap.vocabularies.Common.v1.IsCalendarQuarter":"Q","com.sap.vocabularies.Common.v1.IsCalendarMonth":"MM","com.sap.vocabularies.Common.v1.IsCalendarWeek":"ww","com.sap.vocabularies.Common.v1.IsCalendarDate":"yyyyMMdd","com.sap.vocabularies.Common.v1.IsCalendarYearMonth":"yyyyMM"};d._ASSOCIATIONS=["chartTitle","chartDescription","unitOfMeasure","freeText"];d._ASSOCIATIONS_ANNOTATIONS_MAP={chartDescription:"Description",chartTitle:"Title",unitOfMeasure:{propertyAnnotationPath:"Value",propertyAnnotationProperties:["ISOCurrency","Unit"]},freeText:{propertyAnnotationPath:"Value",propertyAnnotationProperties:["Label"]}};d._isBulletVizualizationType=function(t){return t===d._BULLET||t===d._DELTABULLET};d.prototype._initializeMetadata=function(){if(!this._bIsInitialized){var t=this.getModel();if(t&&(t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"||t.getMetadata().getName()==="sap.ui.model.odata.ODataModel")){if(!this._bMetaModelLoadAttached){t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this));this._bMetaModelLoadAttached=true}}else if(t){this._onMetadataInitialized.call(this)}}};d.prototype._onMetadataInitialized=function(){this._bMetaModelLoadAttached=false;if(this._bIsInitialized){return}this._createChartProvider.call(this);this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();this._oDataPointMetadata=this._oChartProvider.getChartDataPointMetadata();this._bIsInitialized=true;this.fireInitialize();if(this.getEnableAutoBinding&&this.getEnableAutoBinding()){if(this.getChartBindingPath()){this.bindElement(this.getChartBindingPath())}else{l.error("The property chartBindingPath needs to be set in order for property enableAutoBinding to be applied.")}}if(this._checkChartMetadata.call(this)){this._aDataPointAnnotations=this._getDataPointAnnotations.call(this);this._oDataPointAnnotations=this._aDataPointAnnotations[0];if(this._aDataPointAnnotations.every(this._checkDataPointAnnotation.bind(this))){this._createAndBindInnerChart()}}else{l.error("Created annotations not valid. Please review the annotations and metadata.")}};d.prototype._getDataPointAnnotations=function(){var t=[],e;if(this._oChartViewMetadata&&this._oChartViewMetadata.measureFields){for(var a=0;a<this._oChartViewMetadata.measureFields.length;a++){e=this._getDataPointAnnotation.call(this,this._oChartViewMetadata.measureFields[a]);t.push(e)}}else{e=this._getDataPointAnnotation.call(this);t.push(e)}return t};d.prototype._cleanup=function(){if(this._oDateType){this._oDateType.destroy();this._oDateType=null}};d.prototype._createChartProvider=function(){var t,e;e=this.getEntitySet();t=this.getModel();if(t&&e){this._oChartProvider=new i({entitySet:e,model:t,chartQualifier:this.data("chartQualifier")})}else{l.error("Property entitySet is not set or no model has been attached to the control.")}};d.prototype._checkChartMetadata=function(){if(jQuery.isEmptyObject(this._oChartViewMetadata)){if(jQuery.isEmptyObject(this._oDataPointMetadata)){l.error("DataPoint annotation must be provided if chart annotation is missing.");return false}return true}else{if(!this._oChartViewMetadata.fields||this._oChartViewMetadata.fields.length===0){l.error("No fields exist in the metadata.");return false}if(this._hasMember(this,"_oChartViewMetadata.annotation.ChartType")){return this._checkChartType.call(this)}else if(this.getChartType()==="Comparison"||this.getChartType()==="Delta"){return true}else{l.error("The Chart annotation is invalid.");return false}}};d.prototype._checkChartType=function(){var t=this._getSupportedChartTypes();for(var e=0;e<t.length;e++){if(this._oChartViewMetadata.annotation.ChartType.EnumMember==="com.sap.vocabularies.UI.v1.ChartType/"+t[e]){return true}}l.error('The ChartType property in the Chart annotation is not part of the list of valid types: "'+t.toString()+'".');return false};d.prototype._getDataPointQualifier=function(t){var e;if(!this._oChartViewMetadata&&this._oDataPointMetadata){return this.data("chartQualifier")}if(!this._hasMember(this,"_oChartViewMetadata.annotation.MeasureAttributes.length")||!this._oChartViewMetadata.annotation.MeasureAttributes.length){return""}if(t&&this._oChartViewMetadata.measureAttributes&&this._oChartViewMetadata.measureAttributes[t]){return(this._oChartViewMetadata.measureAttributes[t].dataPoint.match(/\#([^\#]*)$/)||[])[1]||""}e=this._oChartViewMetadata.annotation.MeasureAttributes[0];if(this._hasMember(e,"DataPoint.AnnotationPath")){return(e.DataPoint.AnnotationPath.match(/\#([^\#]*)$/)||[])[1]||""}};d.prototype._getDataPointAnnotation=function(t){var e=this._getDataPointQualifier.call(this,t),a;if(e){a=this._oDataPointMetadata.additionalAnnotations[e]}else{a=this._oDataPointMetadata.primaryAnnotation}return a};d.prototype._checkDataPointAnnotation=function(t){var e=null;if(jQuery.isEmptyObject(t)){l.error("The DataPoint annotation is empty. Please check it!");return false}if(this._hasMember(t,"Visualization.EnumMember")){e=t.Visualization.EnumMember;if(!d._isBulletVizualizationType(e)){l.error("The only support visualization types for micro charts are BulletChart and DeltaBulletChart.");return false}}if(jQuery.isEmptyObject(this._oChartViewMetadata)&&e===null){l.error("If only DataPoint annotation is provided the VisualizationType is expected to be set.");return false}if(this._hasMember(t,"Value.Path")){if(jQuery.isEmptyObject(t.Criticality)){this._checkCriticalityMetadata(t.CriticalityCalculation)}return true}else{l.error("The Value property does not exist in the DataPoint annotation. This property is essential for creating the smart chart.");return false}};d.prototype._checkCriticalityMetadata=function(t){if(jQuery.isEmptyObject(t)){l.warning("The CriticalityCalculation property in DataPoint annotation is not provided.");return false}if(this._hasMember(t,"ImprovementDirection.EnumMember")){var e=t.ImprovementDirection.EnumMember;switch(e){case d._MINIMIZE:return this._checkCriticalityMetadataForMinimize(t);case d._MAXIMIZE:return this._checkCriticalityMetadataForMaximize(t);case d._TARGET:return this._checkCriticalityMetadataForTarget(t);default:l.warning("The improvement direction in DataPoint annotation must be either Minimize, Maximize or Target.")}}else{l.warning("The ImprovementDirection property in DataPoint annotation is not provided.")}return false};d.prototype._checkCriticalityMetadataForMinimize=function(t){if(!this._hasMember(t,"ToleranceRangeHighValue.Path")){l.warning("The ToleranceRangeHighValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeHighValue.Path")){l.warning("The DeviationRangeHighValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}return true};d.prototype._checkCriticalityMetadataForMaximize=function(t){if(!this._hasMember(t,"ToleranceRangeLowValue.Path")){l.warning("The ToleranceRangeLowValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeLowValue.Path")){l.warning("The DeviationRangeLowValue property in DataPoint annotation is missing for Minimize improvement direction.");return false}return true};d.prototype._checkCriticalityMetadataForTarget=function(t){if(!this._hasMember(t,"ToleranceRangeLowValue.Path")){l.warning("The DeviationRangeLowValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"ToleranceRangeHighValue.Path")){l.warning("The ToleranceRangeHighValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeLowValue.Path")){l.warning("The ToleranceRangeLowValue property in DataPoint annotation is missing for Target improvement direction.");return false}if(!this._hasMember(t,"DeviationRangeHighValue.Path")){l.warning("The DeviationRangeHighValue property in DataPoint annotation is missing for Target improvement direction.");return false}return true};d.prototype._mapCriticalityTypeWithColor=function(t){var e;if(!t){return y.Neutral}else{e=t.toString()}e=(e.match(/(?:CriticalityType\/)?([^\/]*)$/)||[])[1]||"";if(y.hasOwnProperty(e)){switch(e){case"Negative":case"Error":case"1":return y.Error;case"Critical":case"Warning":case"2":return y.Critical;case"Good":case"Positive":case"3":return y.Good;case"Sequence1":return y.Sequence1;case"Sequence2":return y.Sequence2;case"Sequence3":return y.Sequence3;case"Sequence4":return y.Sequence4;case"Sequence5":return y.Sequence5;case"Sequence6":return y.Sequence6;case"Sequence7":return y.Sequence7;case"Sequence8":return y.Sequence8;case"Sequence9":return y.Sequence9;case"Sequence10":return y.Sequence10;case"Sequence11":return y.Sequence11;case"Sequence12":return y.Sequence12;default:return y.Neutral}}else{e=(e.match(/(?:CriticalityType\/)?([^\/]*)$/)||[])[1]||"";switch(e){case"Negative":case"1":return c.Error;case"Critical":case"2":return c.Critical;case"Positive":case"3":return c.Good;default:return c.Neutral}}};d.prototype._getThresholdValues=function(t){var e={},a=this.getBindingContext();for(var i in t){if(t.hasOwnProperty(i)&&i!=="ImprovementDirection"){e[i]=t[i].Path&&a&&a.getProperty(t[i].Path)||t[i].Decimal||0}}return e};d.prototype._getValueColorForMinimize=function(t,e,a){if(t<=e){return this._mapCriticalityTypeWithColor("Positive")}else if(t>e&&t<=a){return this._mapCriticalityTypeWithColor("Critical")}else if(t>a){return this._mapCriticalityTypeWithColor("Negative")}};d.prototype._getValueColorForMaximize=function(t,e,a){if(t>=e){return this._mapCriticalityTypeWithColor("Positive")}else if(t<e&&t>=a){return this._mapCriticalityTypeWithColor("Critical")}else if(t<a){return this._mapCriticalityTypeWithColor("Negative")}};d.prototype._getValueColorForTarget=function(t,e,a,i,r){if(t>=e&&t<=i){return this._mapCriticalityTypeWithColor("Positive")}else if(t>=a&&t<e||t>i&&t<=r){return this._mapCriticalityTypeWithColor("Critical")}else if(t<a||t>r){return this._mapCriticalityTypeWithColor("Negative")}};d.prototype._getValueColor=function(t,e){var a=this._oDataPointAnnotations.CriticalityCalculation,i,r;t=parseFloat(t)||0;if(typeof e==="string"){r=this._mapCriticalityTypeWithColor(e)}else if(a&&typeof t!=="undefined"&&t!==null){i=this._getThresholdValues.call(this,a);r=this._criticalityCalculation(t,a.ImprovementDirection.EnumMember,i)}return r||this._mapCriticalityTypeWithColor()};d.prototype._getTopLabelColor=function(t,e,a){var i=this._aDataPointAnnotations[a].CriticalityCalculation,r=parseFloat(t)||0,n={},o;for(var s in i){if(i.hasOwnProperty(s)&&s!=="ImprovementDirection"){n[s]=e[i[s].Path]}}if(i&&typeof r!=="undefined"&&r!==null){o=this._criticalityCalculation(r,i.ImprovementDirection.EnumMember,n)}return o};d.prototype._criticalityCalculation=function(t,e,a){var i;switch(e){case d._MINIMIZE:i=this._getValueColorForMinimize(t,a.ToleranceRangeHighValue,a.DeviationRangeHighValue);break;case d._MAXIMIZE:i=this._getValueColorForMaximize(t,a.ToleranceRangeLowValue,a.DeviationRangeLowValue);break;case d._TARGET:i=this._getValueColorForTarget(t,a.ToleranceRangeLowValue,a.DeviationRangeLowValue,a.ToleranceRangeHighValue,a.DeviationRangeHighValue);break;default:l.warning("The improvement direction in DataPoint annotation must be either Minimize, Maximize or Target.")}return i};d.prototype._getAnnotation=function(t){var e=d._ASSOCIATIONS_ANNOTATIONS_MAP[t];if(!e){l.warning('No annotation connected to association "'+t+'".');return{}}if(!jQuery.isEmptyObject(this._oChartViewMetadata)&&typeof e==="string"){return this._oChartViewMetadata.annotation[e]}if(!jQuery.isEmptyObject(this._oDataPointAnnotations)&&this._hasMember(e,"propertyAnnotationPath")&&this._hasMember(e,"propertyAnnotationProperties")){var a;if(this._hasMember(this._oDataPointAnnotations,e.propertyAnnotationPath+".Path")){a=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations[e.propertyAnnotationPath].Path)}if(a){return this._getValueFromPropertyAnnotation(a,e.propertyAnnotationProperties)}}return{}};d.prototype._getValueFromPropertyAnnotation=function(t,e){for(var a in t){for(var i=0;i<e.length;i++){if(a.indexOf(e[i])>-1){return t[a]}}}return{}};d.prototype._updateAssociation=function(e,a){var i,r;if(this.getMetadata().hasAssociation(e)){i=t.getElementById(this.getAssociation(e));if(i&&i.getMetadata().hasProperty("text")){r=this._getAnnotation.call(this,e);this._setAssociationText(i,r,a)}}};d.prototype._updateAssociations=function(t){var e=t&&t.getContexts(0,1)[0],a=e&&e.getObject();var i=d._ASSOCIATIONS.length;for(var r=0;r<i;r++){this._updateAssociation.call(this,d._ASSOCIATIONS[r],a)}};d.prototype.updateChartLabels=function(t){var e={value:Infinity},a={value:-Infinity},i={value:Infinity},r={value:-Infinity},n,o,s,l,h;h=t.getContexts();h.forEach(function(t){for(var h=0;h<this._oChartViewMetadata.dimensionFields.length;h++){s=this._oChartViewMetadata.dimensionFields[h];n=t.getProperty(s);l=this._oChartViewMetadata.measureFields[h];o=t.getProperty(l);e=n<e.value?{context:t,value:n,index:h}:e;a=n>a.value?{context:t,value:n,index:h}:a;i=o<i.value?{context:t,value:o,index:h}:i;r=o>r.value?{context:t,value:o,index:h}:r}},this);if(i.context&&e.context&&r.context&&a.context){this._updateTopLabel.call(this,this._getLabelsMap()["leftTop"],i.context.getObject(),i.index);this._updateBottomLabel.call(this,this._getLabelsMap()["leftBottom"],e.context.getObject(),e.index);this._updateTopLabel.call(this,this._getLabelsMap()["rightTop"],r.context.getObject(),r.index);this._updateBottomLabel.call(this,this._getLabelsMap()["rightBottom"],a.context.getObject(),a.index)}};d.prototype._updateTopLabel=function(t,e,a){var i=e[this._aDataPointAnnotations[a].Value.Path],r=this._getTopLabelColor.call(this,i,e,a),n=this._getLabelNumberFormatter.call(this,this._aDataPointAnnotations[a].Value.Path),o;o=n.format(i);this._updateLabel(t,{text:o,color:r})};d.prototype._updateBottomLabel=function(t,e,a){var i,r,n,o;i=this._oChartViewMetadata.dimensionFields[a];if(i){n=e[i];r=this._getPropertyAnnotation.call(this,this._oChartViewMetadata.dimensionFields[a]);if(r.hasOwnProperty("sap:text")||r.hasOwnProperty("com.sap.vocabularies.Common.v1.Text")){var s=r["sap:text"]||r["com.sap.vocabularies.Common.v1.Text"].Path;o=e[s]}else{o=this._formatBottomLabel.call(this,n,r)}if(o){this._updateLabel(t,{text:o})}}};d.prototype._formatBottomLabel=function(t,e){var a=this._getSemanticsPattern.call(this,e);if(a){return this._formatSemanticsValue.call(this,t,a)}a=this._getCalendarPattern.call(this,e);if(a){return this._formatSemanticsValue.call(this,t,a)}return this._formatDateAndNumberValue.call(this,t)};d.prototype._formatSemanticsValue=function(t,e){if(e){if(!this._oDateType){this._oDateType=new s({style:"short",source:{pattern:e}})}return this._oDateType.formatValue(t,"string")}return null};d.prototype._formatDateAndNumberValue=function(t){if(t instanceof Date){return this._getLabelDateFormatter.call(this).format(t)}else if(!isNaN(t)){return this._getLabelNumberFormatter.call(this,this._oChartViewMetadata.dimensionFields[0]).format(t)}else{return null}};d.prototype._getSemanticsPattern=function(t){if(t.hasOwnProperty("sap:semantics")){switch(t["sap:semantics"]){case"yearmonthday":return"yyyyMMdd";case"yearmonth":return"yyyyMM";case"year":return"yyyy";default:return null}}return null};d.prototype._getCalendarPattern=function(t){for(var e in d._CALENDAR_TERMS_PATTERNS){if(t.hasOwnProperty(e)){return d._CALENDAR_TERMS_PATTERNS[e]}}return null};d.prototype._getLabelNumberFormatter=function(t){var e=this._getPropertyAnnotation.call(this,t).precision||null;var a=this._getPropertyAnnotation.call(this,t).scale||null;return r.getFloatInstance({style:"short",precision:e,decimals:a})};d.prototype._getLabelDateFormatter=function(){return n.getInstance({style:"short"})};d.prototype._setAssociationText=function(t,e,a){if(!e){return}if(e.Path&&a){t.setProperty("text",a[e.Path],false)}else if(e.Path){t.bindProperty("text",{path:e.Path,mode:o.OneWay});t.invalidate()}else if(e.String){if(e.String.indexOf("{")===0){var i=e.String.split(">");t.bindProperty("text",{path:i[1].substr(0,i[1].length-1),model:i[0].substr(1),mode:o.OneWay});t.invalidate()}else{t.setProperty("text",e.String,false)}}};d.prototype._getPropertyAnnotation=function(t){var e,a,i,r;e=this.getModel().getMetaModel();a=this._oChartProvider._oMetadataAnalyser.getEntityTypeNameFromEntitySetName(this.getEntitySet());i=e.getODataEntityType(a);r=e.getODataProperty(i,t);return r};d.prototype._hasMember=function(t,e){var a=".",i=e.split(a),r=i.shift();return!!t&&(i.length>0?this._hasMember(t[r],i.join(a)):t.hasOwnProperty(r))};d.prototype.getAccessibilityInfo=function(){var t={};var e=this.getAggregation("_chart");if(e&&e.getAccessibilityInfo){t=e.getAccessibilityInfo()}return t};d.prototype._formatDimension=function(t){if(typeof t==="string"){var e=this._getPropertyAnnotation.call(this,this._oChartViewMetadata.dimensionFields[0]),a=this._getSemanticsPattern.call(this,e);if(a){t=n.getInstance({pattern:a}).parse(t)}}if(t instanceof Date){return parseFloat(t.getTime())}else if(!isNaN(t)){return parseFloat(t)}else{this.getAggregation("_chart").enableXIndexing(true);return 0}};d.prototype.exit=function(){this._cleanup.call(this)};d.prototype.setEntitySet=function(t){if(this.getProperty("entitySet")!==t){this.setProperty("entitySet",t,true);this._initializeMetadata.call(this)}return this};d.prototype.addAriaLabelledBy=function(t){this.addAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").addAriaLabelledBy(t);return this};d.prototype.removeAriaLabelledBy=function(t){this.removeAssociation("ariaLabelledBy",t,true);this.getAggregation("_chart").removeAriaLabelledBy(t);return this};d.prototype.removeAllAriaLabelledBy=function(){this.removeAllAssociation("ariaLabelledBy",true);this.getAggregation("_chart").removeAllAriaLabelledBy();return this};d.prototype.setChartType=function(){return this};d.prototype.propagateProperties=function(){if(h.prototype.propagateProperties){h.prototype.propagateProperties.apply(this,arguments)}this._initializeMetadata.call(this)};d.prototype._getBindingPath=function(){if(this.getChartBindingPath()){return this.getChartBindingPath()}else if(this.getEntitySet()){return"/"+this.getEntitySet()}else{return""}};d.prototype._getSupportedChartTypes=function(){return this._CHART_TYPE};d.prototype.setSize=function(t){if(this.getSize()!==t){this.setProperty("size",t)}return this};d.prototype.setAssociation=function(t,e,a){if(h.prototype.setAssociation){h.prototype.setAssociation.apply(this,arguments)}this._updateAssociation.call(this,t);return this};d.prototype._isResponsive=function(){return this.getSize()===m.Responsive};return d});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartMicroChartRenderer", [],function(){"use strict";var e={apiVersion:2};e.render=function(e,i){if(i._bIsInitialized){e.openStart("div",i);if(i._isResponsive()){e.class("sapSuiteUiSmartMicroChartResponsive")}e.openEnd();e.renderControl(i.getAggregation("_chart"));e.close("div")}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartRadialMicroChart", ["sap/ui/comp/library","sap/ui/core/Control","sap/suite/ui/microchart/library","sap/suite/ui/microchart/RadialMicroChart","sap/m/library","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer","sap/ui/model/odata/type/Decimal"],function(t,a,i,e,o,r,n,s){"use strict";var h=r.extend("sap.ui.comp.smartmicrochart.SmartRadialMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartRadialMicroChart.designtime",properties:{enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false}},associations:{freeText:{type:"sap.m.Label",group:"Misc",multiple:false}}},renderer:n});h.prototype._CHART_TYPE=["Donut"];h.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","Donut",true);this.setAggregation("_chart",new e,true)};h.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);i._passParentContextToChild(this,t)};h.prototype._createAndBindInnerChart=function(){this._bindProperties();this._updateAssociations.call(this)};h.prototype._bindProperties=function(){var t=this.getAggregation("_chart");if(this._oDataPointAnnotations.Value&&!this._oDataPointAnnotations.TargetValue){if(this._hasMember(this._oDataPointAnnotations.Value,"Path")){t.bindProperty("percentage",{path:this._oDataPointAnnotations.Value.Path,type:new s})}}else if(this._hasMember(this,"_oDataPointAnnotations.TargetValue.Path")&&this._hasMember(this,"_oDataPointAnnotations.Value.Path")){t.bindProperty("total",{path:this._oDataPointAnnotations.TargetValue.Path,type:new s});t.bindProperty("fraction",{path:this._oDataPointAnnotations.Value.Path,type:new s})}t.bindProperty("valueColor",{parts:[this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path||"",this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path||""],formatter:this._getValueColor.bind(this)})};return h});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmicrochart/SmartStackedBarMicroChart", ["sap/ui/comp/library","sap/suite/ui/microchart/StackedBarMicroChart","sap/suite/ui/microchart/StackedBarMicroChartBar","sap/ui/core/Control","sap/ui/model/odata/CountMode","sap/ui/core/format/DateFormat","sap/m/library","sap/base/Log","sap/ui/comp/smartmicrochart/SmartMicroChartBase","./SmartMicroChartRenderer","sap/ui/model/odata/type/Decimal"],function(t,a,i,e,r,o,n,s,h,c,p){"use strict";var d=h.extend("sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmicrochart/SmartStackedBarMicroChart.designtime"},renderer:c});d.prototype._CHART_TYPE=["BarStacked"];d.prototype.init=function(){this._bIsInitialized=false;this._bMetaModelLoadAttached=false;this.setProperty("chartType","BarStacked",true);this.setAggregation("_chart",new a,true)};d.prototype.onBeforeRendering=function(){var t=this.getAggregation("_chart");t.setSize(this.getSize(),true);t.setWidth(this.getWidth(),true);t.setHeight(this.getHeight(),true)};d.prototype._createAndBindInnerChart=function(){if(!(this._oDataPointAnnotations.Value&&this._oDataPointAnnotations.Value.Path)){s.error("Value DataPoint annotation missing! Cannot create the SmartStackedBarMicroChart");return}var t=this.getAggregation("_chart"),a=new i({value:{path:this._oDataPointAnnotations.Value.Path,type:new p}});if(this._oDataPointAnnotations.Criticality&&this._oDataPointAnnotations.Criticality.Path){a.bindProperty("valueColor",{path:this._oDataPointAnnotations.Criticality.Path,formatter:this._mapCriticalityTypeWithColor.bind(this)})}var e=this._getPropertyAnnotation.call(this,this._oDataPointAnnotations.Value.Path);var r=e["com.sap.vocabularies.Common.v1.Text"];if(r&&r.Path){a.bindProperty("displayValue",r.Path)}t.bindAggregation("bars",{path:this._getBindingPath(),template:a,events:{change:this._onBindingDataChange.bind(this)}})};d.prototype._onBindingDataChange=function(){var t=this.getAggregation("_chart").getBinding("bars");this._updateAssociations(t)};return d});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/Container", ["sap/ui/thirdparty/jquery",".././library","sap/ui/core/Control","sap/ui/comp/smartmultiedit/Field","sap/ui/model/Context","sap/base/Log"],function(jQuery,t,e,i,a,o){"use strict";var n=e.extend("sap.ui.comp.smartmultiedit.Container",{metadata:{library:"sap.ui.comp",properties:{entitySet:{type:"string",defaultValue:null},contexts:{type:"any[]",defaultValue:[]}},defaultAggregation:"layout",aggregations:{layout:{type:"sap.ui.comp.smartform.SmartForm",multiple:false}},designTime:"sap/ui/comp/designtime/smartmultiedit/Container.designtime"},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartMultiEditContainer");t.openEnd();if(e._bReadyToRender){t.renderControl(e.getLayout())}t.close("div")}}});n.prototype.init=function(){this._bIsInitialized=false;this._bReadyToRender=false;this._aFields=null;this._oAnnotatedTimezoneFields={};this.attachEvent("modelContextChange",this._initializeMetadata,this)};n.prototype.setEntitySet=function(t){if(t!==this.getProperty("entitySet")){this.setProperty("entitySet",t,true);if(t){this._initializeMetadata()}}return this};n.prototype.setContexts=function(t){if(Array.isArray(t)){for(var e=0;e<t.length;e++){if(!(t[e]instanceof a)){return this}}this.setProperty("contexts",t,true);this._getFields().forEach(function(t){t._updateContextItems()})}else{o.error("Parameter contexts is expected to be an array.")}return this};n.prototype.setLayout=function(t){this.setAggregation("layout",t,true);this._refreshFields();return this};n.prototype.addCustomData=function(t){var i;if(!t){return this}e.prototype.addCustomData.apply(this,arguments);this._getFields().forEach(function(e){i=t.clone();e._oSmartField.addCustomData(i)});return this};n.prototype.insertCustomData=function(t,i){var a;if(!t){return this}e.prototype.insertCustomData.apply(this,arguments);this._getFields().forEach(function(e){a=t.clone();e._oSmartField.addCustomData(a)});return this};n.prototype.removeCustomData=function(t){var i=e.prototype.removeCustomData.apply(this,arguments);if(i){this._getFields().forEach(function(t){t._oSmartField.removeCustomData(i)})}return i};n.prototype.removeAllCustomData=function(){var t=e.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){this._getFields().forEach(function(e){t.forEach(function(t){e._oSmartField.removeCustomData(t)})})}return t};n.prototype.destroyCustomData=function(){e.prototype.destroyCustomData.apply(this,arguments);this._getFields().forEach(function(t){t._oSmartField.destroyCustomData()});return this};n.prototype.getAllUpdatedContexts=function(t){var e=this.getContexts(),i=[],a=this,o=0,n=10;if(e.length===0){return Promise.resolve(i)}return new Promise(function(r){function s(u,l,d){for(o=l;o<Math.min(d,u.length);o++){i.push({context:u[o],data:a._getUpdatedDataObject(u[o].getObject(),t)})}if(o<u.length){setTimeout(s.bind(null,e,o,o+n),0)}else{r(i)}}s(e,o,o+n)})};n.prototype.getErroneousFields=function(){return this._getFields().filter(function(t){t._performValidation();return t.hasClientError()})};n.prototype.getErroneousFieldsAndTokens=function(){var t=this._getFields().map(function(t){return t._performValidation()});return Promise.all(t).then(function(){var t=this._getFields().filter(function(t){return t.hasClientError()});return t}.bind(this))};n.prototype.indexField=function(t){var e;if(!(t instanceof i)){o.error("Container.indexField","Element '"+JSON.stringify(t)+"' must be of type sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container");return}this._aFields.push(t);t._setContainer(this);this.getCustomData().forEach(function(i){if(t.getSmartField()){e=i.clone();t.getSmartField().addCustomData(e)}})};n.prototype._getUpdatedDataObject=function(t,e){var i=e?Object.assign({},t):{},a,n,r,s;this._getFields().forEach(function(e){a=e.getPropertyName();n=e.getUnitOfMeasurePropertyName();s=e.getRawValue();if(s.hasOwnProperty(a)){if(e.isDate()||e.isDateTime()){if(!t[a]){if(s[a]){i[a]=s[a]}}else if(!s[a]){i[a]=null}else if(!t[a].getTime){o.error("Container._getUpdatedDataObject","Field "+a+" has incompatible data and metadata, expected: Date/DateTime, but found "+typeof i[a],"sap.ui.comp.smartmultiedit.Container");return}else if(s[a].getTime()!==t[a].getTime()){i[a]=s[a]}}else{if(s[a]!==t[a]&&(s[a]!==""&&s[a]!=null||t[a]!==""&&t[a]!=null)){i[a]=s[a]}}}if(e.isComposite()&&s.hasOwnProperty(n)&&s[n]!==t[n]){i[n]=s[n]}else if(e.isComboBox()){r=e.getRecordTextPath();if(s.hasOwnProperty(r)&&s[r]!==t[r]){i[r]=s[r]}}});return i};n.prototype.getFields=function(t){return this._getFields(t)};n.prototype._getFields=function(t){var e=[];if((t||!this._aFields||Array.isArray(this._aFields)&&!this._aFields.length)&&this.getLayout()){this._aFields=[];this.getLayout().getGroups().forEach(function(a){a.getGroupElements().forEach(function(a){a.getElements().forEach(function(a){if(a instanceof i){this.indexField(a)}else if(t){e.push(a)}}.bind(this))}.bind(this))}.bind(this))}return e.concat(this._aFields||[])};n.prototype._initializeMetadata=function(){var t=this.getModel();if(!this._bIsInitialized&&this.getEntitySet()&&t&&t.getMetadata().getName()==="sap.ui.model.odata.v2.ODataModel"){if(!this.getBindingContext()){var e=t.createEntry("/"+this.getEntitySet());this.setBindingContext(e);this.getModel().resetChanges([e.getPath()],undefined,true)}t.getMetaModel().loaded().then(this._onMetadataInitialized.bind(this))}};n.prototype._onMetadataInitialized=function(){if(this._bIsInitialized){return}this._bIsInitialized=true;this._bReadyToRender=true;this.invalidate()};n.prototype.resetContainer=function(){this._aFields.forEach(function(t){t.resetField()});this._bIsInitialized=false};n.prototype._refreshFields=function(){this._aFields=null;this._getFields()};return n});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/Field", ["../library","sap/ui/core/library","sap/ui/core/Control","sap/ui/core/Item","sap/m/Select","sap/ui/comp/smartfield/SmartField","sap/ui/comp/smartfield/SmartLabel","sap/ui/comp/smartfield/ODataControlFactory","sap/ui/model/BindingMode","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/HBox","sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/m/CheckBox","sap/m/Label","sap/m/Input","sap/base/Log","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/smartfield/ComboBox","sap/ui/comp/smartfield/type/Decimal","sap/ui/core/Lib"],function(t,e,i,o,s,a,n,r,l,u,p,h,m,d,c,_,g,f,y,S,C,I){"use strict";var F=e.ValueState;var T=r.extend("sap.ui.comp.smartmultiedit.HackedControlFactory");T.prototype.createAttributes=function(t,e,i,o){var s=r.prototype.createAttributes.apply(this,arguments);if(t&&s[t]){s[t].mode=l.OneWay}return s};T.prototype._createEdmUOMAttributes=function(){var t=r.prototype._createEdmUOMAttributes.apply(this,arguments);if(t.value){t.value.mode=l.OneWay}return t};T.prototype._createEdmDateTime=function(){var t=r.prototype._createEdmDateTime.apply(this);t.params.getValue=function(){if(t.control.getDateValue()){return t.params.type.type.parseValue(t.control.getValue(),"string")}else{return null}};return t};T.prototype._createEdmDateTimeOffset=function(){var t=r.prototype._createEdmDateTimeOffset.apply(this);var e=t.params.type.property.property["com.sap.vocabularies.Common.v1.Timezone"];if(e){if(e.Path){t.control.customTimezonePath=e.Path}}t.params.getValue=function(){if(e){var i=t.control.getValue();return t.params.type.type.parseValue(i,"string",[i,undefined])[0]}else if(t.control.getDateValue()){return t.params.type.type.parseValue(t.control.getValue(),"string")}else{return null}};return t};T.prototype._onCreate=function(t,e){var i;if(e&&typeof e.getValue==="function"){i=e.getValue;e.getValue=null}if(r.prototype._onCreate){r.prototype._onCreate.call(this,t,e)}if(i){e.getValue=i}};T.createFromFactory=function(t){if(!t){return null}return new T(t._oModel,t._oParent,t._oMeta)};var v=10;var V=i.extend("sap.ui.comp.smartmultiedit.Field",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartmultiedit/Field.designtime",properties:{propertyName:{type:"string",defaultValue:null},useApplyToEmptyOnly:{type:"boolean",defaultValue:false},applyToEmptyOnly:{type:"boolean",defaultValue:false},description:{type:"string",defaultValue:null},validateTokenExistence:{type:"boolean",defaultValue:true}},aggregations:{configuration:{type:"sap.ui.comp.smartfield.Configuration",multiple:false}},associations:{},events:{change:{parameters:{selectedItem:{type:"sap.ui.core.Item"}}}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.class("sapUiCompSmartMultiEditField");t.openEnd();t.renderControl(e._oSelect);t.openStart("div");t.class("sapUiCompSmartMultiEditFieldSFWrapper");t.openEnd();if(e._oSmartField&&e._oSmartField.aCustomStyleClasses.indexOf("sapUiCompSmartMultiEditSmartField")>=0){t.renderControl(e._oSmartField)}t.close("div");if(e.getDescription()){t.openStart("div");t.class("sapUiCompSmartMultiEditSmartFieldDescription");t.openEnd();e._oDescription.setText(e.getDescription());t.renderControl(e._oDescription);t.close("div")}if(e.getUseApplyToEmptyOnly()){t.renderControl(e._oApplyToEmptyOnlyCheckBox)}t.close("div")}}});V.ACTION_ITEM_KEY={KEEP:"keep",BLANK:"blank",NEW:"new",TRUE:"true",FALSE:"false"};V.prototype.init=function(){this._createSelect();this._createSpecialSelectItems();this._createDescription();this._createApplyToEmptyOnlyCheckBox();this._oContainer=null;this._bNullable=true;this._bShowValueHelp=true;this._bClientError=null;this._oAnnotations=null;this._aDistinctValues=[];this._mRecordKeyTextMap={}};V.prototype.onBeforeRendering=function(){this._updateSpecialSelectItems()};V.prototype.getNullable=function(){return this._bNullable};V.prototype.getShowValueHelp=function(){return this._bShowValueHelp};V.prototype.getLabel=function(){if(this.getParent()&&this.getParent().getLabel){return this.getParent().getLabel()}else{return null}};V.prototype.getSmartField=function(){return this._oSmartField};V.prototype.getValue=function(){return this._oSmartField?this._oSmartField.getValue():null};V.prototype.getDataType=function(){if(!this._oSmartField){return null}try{return this._oSmartField.getDataType()}catch(t){return null}};V.prototype.isComposite=function(){return!!(this._oAnnotations&&this._oAnnotations.uom)};V.prototype.isString=function(){return this.getDataType()==="Edm.String"};V.prototype.isInteger=function(){return this.getDataType()==="Edm.Byte"||this.getDataType()==="Edm.Int16"||this.getDataType()==="Edm.Int32"||this.getDataType()==="Edm.Int64"||this.getDataType()==="Edm.SByte"};V.prototype.isFloat=function(){return this.getDataType()==="Edm.Decimal"||this.getDataType()==="Edm.Double"||this.getDataType()==="Edm.Float"||this.getDataType()==="Edm.Single"};V.prototype.isDate=function(){return this.getDataType()==="Edm.DateTime"};V.prototype.isDateTime=function(){return this.getDataType()==="Edm.DateTimeOffset"};V.prototype.isTime=function(){return this.getDataType()==="Edm.Time"};V.prototype.isBoolean=function(){return this.getDataType()==="Edm.Boolean"};V.prototype.isComboBox=function(){var t=this._getCurrentValueControl();return t&&t.isA("sap.m.ComboBox")||false};V.prototype.getRecordTextPath=function(){if(this._oAnnotations&&this._oAnnotations.text){return this._oAnnotations.text.path}else{return null}};V.prototype.getUnitOfMeasure=function(){return this._oSmartField?this._oSmartField.getUnitOfMeasure():null};V.prototype.getUnitOfMeasurePropertyName=function(){return this._oAnnotations&&this._oAnnotations.uom?this._oAnnotations.uom.path:null};V.prototype.setParent=function(t,e,o){i.prototype.setParent.call(this,t,e,o);if(t&&t.getLabel&&!t.getLabel()){this._oLabel=new n(this.getId()+"-SmartLabel");this._oLabel.onFieldVisibilityChange=function(){};this._oLabel.setLabelFor(this._oSmartField.getId());t.setLabel(this._oLabel);this._oSelect.addAriaLabelledBy(this._oLabel);if(this.getDescription()){this._oSelect.addAriaLabelledBy(this._oDescription)}}return this};V.prototype.addCustomData=function(t){var e;if(!t){return this}i.prototype.addCustomData.apply(this,arguments);e=t.clone();this._oSmartField.addCustomData(e);return this};V.prototype.insertCustomData=function(t,e){var o;if(!t){return this}i.prototype.insertCustomData.apply(this,arguments);o=t.clone();this._oSmartField.addCustomData(o);return this};V.prototype.removeCustomData=function(t){var e=i.prototype.removeCustomData.apply(this,arguments);if(e){this._oSmartField.removeCustomData(e)}return e};V.prototype.removeAllCustomData=function(){var t=i.prototype.removeAllCustomData.apply(this,arguments);if(t.length>0){t.forEach(function(t){this._oSmartField.removeCustomData(t)}.bind(this))}return t};V.prototype.destroyCustomData=function(){i.prototype.destroyCustomData.apply(this,arguments);this._oSmartField.destroyCustomData();return this};V.prototype.setPropertyName=function(t){this.setProperty("propertyName",t,true);this._createSmartField();return this};V.prototype.setConfiguration=function(t){var e;this.setAggregation("configuration",t,true);if(this._oSmartField){e=t?t.clone():null;this._oSmartField.setConfiguration(e)}return this};V.prototype.getSelectedItem=function(){return this._oSelect.getSelectedItem()};V.prototype.setSelectedItem=function(t,e){this._handleSelectionChange(t,e);return this};V.prototype.setSelectedIndex=function(t){this.setSelectedItem(this._oSelect.getItems()[t]);return this};V.prototype.exit=function(){this._getKeep().destroy();this._getBlank().destroy();this._getValueHelp().destroy();this._getBoolTrueItem().destroy();this._getBoolFalseItem().destroy()};V.prototype.isBlankSelected=function(){return this._oSelect.getSelectedItem()===this._getBlank()};V.prototype.isKeepExistingSelected=function(){return this._oSelect.getSelectedItem()===this._getKeep()};V.prototype.isValueHelpSelected=function(){return this._oSelect.getSelectedItem()===this._getValueHelp()};V.prototype.getRawValue=function(){var t={},e,i,o,s=this.getSelectedItem(),a=this.getPropertyName();if(s===this._getBoolTrueItem()){e=true}else if(s===this._getBoolFalseItem()){e=false}else if(this.isBlankSelected()){e=null}else if(s===this._getValueHelp()){if(this.isComposite()){i=this.getValue();if(i==null||typeof i==="string"&&!i.trim()){e={value:null}}else{e={value:m.getFloatInstance().parse(i).toString()}}o=this.getUnitOfMeasure();if(o==null||typeof o==="string"&&!o.trim()){e.unit=null}else{e.unit=o}}else if(this.isInteger()&&this.getDataType()!=="Edm.Int64"){e=m.getIntegerInstance().parse(this.getValue())}else if(this.getDataType()==="Edm.Decimal"){e=C.prototype.parseValue(this.getValue(),"string")}else{e=this.getValue()}}else if(s){e=this._mContextItemsData[s.getKey()]}if(!this.isKeepExistingSelected()&&typeof e!=="undefined"){if(this.isComposite()){if(e!=null){t[a]=e.value;t[this.getUnitOfMeasurePropertyName()]=e.unit}else{t[a]=null;t[this.getUnitOfMeasurePropertyName()]=null}}else{t[a]=e;if(this.isComboBox()&&this.getRecordTextPath()){if(e!=null){t[this.getRecordTextPath()]=this._mRecordKeyTextMap[e]}else{t[this.getRecordTextPath()]=null}}}}return t};V.prototype.hasClientError=function(){return this._bClientError};V.prototype._setNullable=function(t){if(t!==this._bNullable){this._bNullable=t;this._updateSpecialSelectItems();this.getLabel().setRequired(true);this._oSelect.setRequired(!t)}return this};V.prototype._setShowValueHelp=function(t){if(t!==this._bShowValueHelp){this._bShowValueHelp=t;this._updateSpecialSelectItems()}return this};V.prototype._isSpecialValueItem=function(t){return t===this._getKeep()||t===this._getBlank()||t===this._getValueHelp()};V.prototype._handleSelectionChangeEvent=function(t){var e=t.getParameter("selectedItem");this._handleSelectionChange(e)};V.prototype._handleSelectionChange=function(t,e){this._oSelect.setSelectedItem(t);if(this.isKeepExistingSelected()||this.isBlankSelected()){this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")}else{this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")}if(e){return}var i=this.isValueHelpSelected();this._oSmartField.setContextEditable(i);this._oSmartField._updateInnerControlsIfRequired();this._oApplyToEmptyOnlyCheckBox.setVisible(i);this._bClientError=null;if(this._isSpecialValueItem(t)){this._setSmartFieldDisplayText(null,null)}else{this._oApplyToEmptyOnlyCheckBox.setVisible(true);if(!this.isBoolean()){this._oSmartField.setContextEditable(true);this._oSmartField._updateInnerControlsIfRequired()}var o=this._mContextItemsData[t.getKey()];if(this.isComposite()){if(this._isCurrencyValue()){this._setSmartFieldDisplayText(this._formatCurrencyValue(m.getFloatInstance().format(o.value),o.unit,true),o.unit)}else{this._setSmartFieldDisplayText(m.getFloatInstance().format(o.value),o.unit)}}else if(this.isBoolean()){this._setSmartFieldDisplayText(t.getText())}else if(this.isTimezoneSet){this._setSmartFieldDisplayText(t.getText())}else if(this.isDate()){this._setSmartFieldDisplayText(d.getDateInstance().format(o))}else if(this.isDateTime()){this._setSmartFieldDisplayText(d.getDateTimeInstance().format(o))}else if(this.isInteger()){this._setSmartFieldDisplayText(m.getIntegerInstance().format(o))}else if(this.isFloat()){this._setSmartFieldDisplayText(m.getFloatInstance().format(o))}else{this._setSmartFieldDisplayText(o.toString())}if(!this.isBoolean()){this.setSelectedItem(this._getValueHelp(),true)}this._performValidation()}this.fireChange({selectedItem:t});this.invalidate()};V.prototype._extractValueDisplayText=function(t){var e;if(t==null||t==undefined){return null}if(this.isComposite()){if(this._isCurrencyValue()){e=this._formatCurrencyValue(m.getFloatInstance().format(t.value),t.unit)}else{e=m.getFloatInstance().format(t.value)+" "+t.unit}}else if(this.isBoolean()){e=t?this._getBoolTrueItem().getText():this._getBoolFalseItem().getText()}else if(this.isDate()){e=d.getDateInstance().format(t)}else if(this.isDateTime()){e=d.getDateTimeInstance().format(t)}else if(this.isInteger()){e=m.getIntegerInstance().format(t)}else if(this.isFloat()){e=m.getFloatInstance().format(t)}else{e=String(t)}return e};V.prototype._createSelect=function(){this._oSelect=new s(this.getId()+"-select");this._oSelect.setWidth("100%");this._oSelect.attachChange(this._handleSelectionChangeEvent,this);this.addDependent(this._oSelect)};V.prototype._getResourceBundle=function(){if(this._oRb==null){this._oRb=I.getResourceBundleFor("sap.ui.comp")}return this._oRb};V.prototype._createSpecialSelectItems=function(){var t=new o({key:V.ACTION_ITEM_KEY.KEEP,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_KEEP_TEXT")+" >"});this._getKeep=function(){return t};var e=new o({key:V.ACTION_ITEM_KEY.BLANK,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_BLANK_TEXT")+" >"});this._getBlank=function(){return e};var i=new o({key:V.ACTION_ITEM_KEY.NEW,text:"< "+this._getResourceBundle().getText("MULTI_EDIT_NEW_TEXT")+" >"});this._getValueHelp=function(){return i};var s=new o({key:V.ACTION_ITEM_KEY.TRUE,text:this._getResourceBundle().getText("SMARTFIELD_CB_YES")});this._getBoolTrueItem=function(){return s};var a=new o({key:V.ACTION_ITEM_KEY.FALSE,text:this._getResourceBundle().getText("SMARTFIELD_CB_NO")});this._getBoolFalseItem=function(){return a}};V.prototype._createDescription=function(){if(!this._oDescription){this._oDescription=new _;this.addDependent(this._oDescription)}};V.prototype._createApplyToEmptyOnlyCheckBox=function(){this._oApplyToEmptyOnlyCheckBox=new c(this.getId()+"-ApplyToEmptyOnly");this._oApplyToEmptyOnlyCheckBox.setText(this._getResourceBundle().getText("MULTI_EDIT_APPLY_TO_EMPTY_ONLY"));this._oApplyToEmptyOnlyCheckBox.attachSelect(function(t){this.setApplyToEmptyOnly(t.getSource().getSelected())}.bind(this));this.addDependent(this._oApplyToEmptyOnlyCheckBox)};V.prototype._createSmartField=function(){this._bIsSmartFieldInitialized=false;this._oSmartField=new a({id:this.getId()+"-SmartField",value:{path:this.getPropertyName(),mode:"OneWay"}});this._oSmartField.addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden");this._oSmartField._createFactory=function(){var t=a.prototype._createFactory.apply(this,arguments);return T.createFromFactory(t)};this.addDependent(this._oSmartField);this._oSmartField.setValue=this._handleSmartFieldSetValue;this._pInitialised=new Promise(function(t,e){this._oSmartField.attachInitialise({resolve:t,reject:e},this._handleSmartFieldInitialized,this)}.bind(this));this._oSmartField.attachInnerControlsCreated(this._handleInnerControlsCreation.bind(this),this);if(this.getConfiguration()){this._oSmartField.setConfiguration(this.getConfiguration().clone())}this._oSmartFieldValue=null};V.prototype._getCurrentValueControl=function(){return this._oSmartField?this._oSmartField._oControl[this._oSmartField._oControl.current]:null};V.prototype._setSmartFieldDisplayText=function(t,e){var i,o;this._oSmartFieldValue=t;this._oSmartField.setValue(t);var s=this._getCurrentValueControl();if(s){if(this.isComboBox()){s.setSelectedKey(t)}else if(this.isComposite()&&s.getItems){i=s.getItems()[0];if(i.setValue){i.setValue(t)}else if(i.setText){i.setText(t)}else if(i.setSelectedKey){i.setSelectedKey(t)}i=s.getItems()[1];if(i._oControl.current==="display"){o=i._oControl.display;if(o.setText){o.setText(e)}}else if(i._oControl.current==="edit"){o=i._oControl.edit;if(o.setEnteredValue){o.setEnteredValue(e)}else if(o.setValue){o.setValue(e)}}}else if(s.setText){s.setText(t)}else if(s.setValue){s.setValue(t)}}};V.prototype._getSmartFieldDisplayText=function(){var t=this._oSmartField._oControl.display,e="";if(t){if(this.isComposite()&&t.getItems){if(t.getItems()[0].getText){e+=t.getItems()[0].getText()}var i=t.getItems()[1]._oControl.display;if(i&&i.getText){e+=t.getItems()[1]._oControl.display.getText()}return e}else if(t.isA("sap.m.ComboBox")){return this._mRecordKeyTextMap[t.getSelectedKey()]||""}else if(t.getText){return t.getText()}else{return null}}else{return null}};V.prototype._handleSmartFieldSetValue=function(t){if(t===this.getParent()._oSmartFieldValue){a.prototype.setValue.call(this.getParent()._oSmartField,t);var e=this.getBinding("value")?.sPath,i=this.getParent()._oContainer._oAnnotatedTimezoneFields[e]||[];if(t&&i.length>0){for(var o=0;o<i.length;o++){var s=i[o];var n=s.getSmartField().getAllInnerControls()?.[1]||{};n.setTimezone(t)}}}};V.prototype._setSFUserInteraction=function(){if(this._oSmartField._oControl.edit&&this._oSmartField._oControl.edit._setPreferUserInteraction){this._oSmartField._oControl.edit._setPreferUserInteraction(false)}};V.prototype._handleSmartFieldInitialized=function(t,e){if(this.isTime()){f.error("Field._handleSmartFieldInitialized","Edm.Time data type is not supported, field: '"+this.getPropertyName()+"'","sap.ui.comp.smartmultiedit.Field");return}this._oAnnotations=this._oSmartField._oFactory._oMetaData.annotations;this._bIsSmartFieldInitialized=true;this._oSmartField.setContextEditable(false);this._oSmartField._updateInnerControlsIfRequired();this._updateContextItems();this._setSFUserInteraction();this._oApplyToEmptyOnlyCheckBox.setVisible(false);var i=(this.getSmartField().getAllInnerControls()?.[1]||{}).customTimezonePath;if(i){if(!this._oContainer._oAnnotatedTimezoneFields[i]){this._oContainer._oAnnotatedTimezoneFields[i]=[]}this._oContainer._oAnnotatedTimezoneFields[i].push(this)}e.resolve()};V.prototype._handleInnerControlsCreation=function(t){var e;t.mParameters.forEach(function(t){if(t.getParent()&&t.getParent()._oControl){if(t.getParent()._oControl.display===t){if(t.mBindingInfos.text){t.mBindingInfos.text.skipModelUpdate=true}}else if(t.getParent()._oControl.edit===t){if(t.mBindingInfos.value){t.mBindingInfos.value.skipModelUpdate=true;t.setValue(null)}else if(t.mBindingInfos.selected){t.mBindingInfos.selected.skipModelUpdate=true;t.setSelected(false)}}}if(t===this._oSmartField._oControl.display){return}if(t.attachChange){t.attachChange(this._performValidation,this)}if(t.getParent()&&t.getParent().getParent()instanceof a&&t.getParent().getParent()._oControl.edit instanceof h&&this._oAnnotations&&this.isComposite()){var e=t.getParent().getParent()._oControl.edit;var i=e.getItems();i[0].attachChange(this._handleCompositeInputChange,this);if(i[1]&&i[1]._oControl&&i[1]._oControl.edit){i[1]._oControl.edit.attachChange(this._handleCompositeInputChange,this)}}else if(t.getParent()instanceof a&&!(t.getParent().getParent()instanceof h)&&t.getParent()._oControl.edit instanceof g){t.getParent()._oControl.edit.attachChange(this._handleInputChange,this)}}.bind(this));e=this._oSmartField.getMandatory();this._setNullable(!e)};V.prototype._getInnerEdit=function(){return this._oSmartField._oControl.edit};V.prototype._getFirstInnerEdit=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[0]:null};V.prototype._getSecondInnerEdit=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[1]._oControl.edit:null};V.prototype._getSecondInnerDisplay=function(){return this._oSmartField._oControl.edit?this._oSmartField._oControl.edit.getItems()[1]._oControl.display:null};V.prototype._performTokenValidation=function(t,e,i){return new Promise(function(o,s){var a=new y(i.getModel());a.getValueListAnnotationLazy(e).then(function(e){var a=e.primaryValueListAnnotation;if(!a){o();return}i.getModel().read("/"+a.valueListEntitySetName,{success:function(e){if(e.results&&e.results.length===0&&t._oControl.edit){var s=i.getNullable()&&i.getValue()==="";t._oControl?.edit?.setValueState(s?F.None:F.Error);i._bClientError=!s}else if(!i._bClientError){t._oControl?.edit?.setValueState(F.None);i._bClientError=null}o()},filters:[new u({path:a.keyField,operator:p.EQ,value1:t.getValue()})],error:function(t){s(t)}})})})};V.prototype._fnGetInnerValuesHelper=function(){var t=[this._getFirstInnerEdit().getValue()];var e=this._getSecondInnerEdit();if(e instanceof S){t.push(e.getSelectedKey())}else{if(e){t.push(e.getValue())}else{var i=this._getSecondInnerDisplay();if(i){t.push(i.getText())}}}return t};V.prototype._performValidation=function(){var t=this._oSmartField._oError,e;t.bComplex=false;t.bFirst=false;t.bSecond=false;var i=this._oSmartField.getInnerControls();var o=()=>{if(this.isKeepExistingSelected()||this.isBlankSelected()){return undefined}if(this.getValidateTokenExistence()){var t=[];if("valuelist"in this._oAnnotations){t.push(this._performTokenValidation(this.getSmartField(),this._oAnnotations.valuelist,this))}if(this.isComposite()&&"valuelistuom"in this._oAnnotations&&this.getSmartField()._oControl.edit){t.push(this._performTokenValidation(this.getSmartField()._oControl.edit.getItems()[1],this._oAnnotations.valuelistuom,this))}return Promise.all(t)}else{return Promise.resolve()}};var s=t=>this._oSmartField.checkValuesValidity({handleSuccess:true}).then(()=>{this._bClientError=false;t?.();return o()}).catch(()=>{this._bClientError=true;t?.();return Promise.resolve()});if(this.isComposite()&&i.length===2&&i[0].getBinding("value")){var a=i[0].getBinding("value");var n=a.getValue;a.getValue=this._fnGetInnerValuesHelper.bind(this);e=()=>{a.getValue=n}}return s(e)};V.prototype._handleCompositeInputChange=function(t){var e=this._fnGetInnerValuesHelper(),i=e[0],o=e[1]||"",s;if(this._isCurrencyValue()){s=this._formatCurrencyValue(i,o,true)}else{var a=m.getFloatInstance({parseAsString:true}).parse(i);s=m.getFloatInstance().format(a)}if(!this._oSmartField._oError.bFirst&&!this._oSmartField._oError.bSecond){this._setSmartFieldDisplayText(s,o)}};V.prototype._handleInputChange=function(){var t=this._getInnerEdit().getValue();if(!this.isString()){var e=m.getFloatInstance({parseAsString:true}).parse(t);t=m.getFloatInstance().format(e)}if(!this._oSmartField._oError.bFirst){this._setSmartFieldDisplayText(t,this._getInnerEdit().getValue())}};V.prototype._formatCurrencyValue=function(t,e,i){var o=m.getFloatInstance().parse(t),s=m.getCurrencyInstance().format(o,e);if(i){s=s.replace(e,"").trim()}return s};V.prototype._updateSpecialSelectItems=function(){this._oSelect.removeAggregation("items",this._getKeep(),true);this._oSelect.removeAggregation("items",this._getBlank(),true);this._oSelect.removeAggregation("items",this._getValueHelp(),true);this._oSelect.insertAggregation("items",this._getKeep(),0,true);if(this.getShowValueHelp()){this._oSelect.insertAggregation("items",this._getValueHelp(),1,true)}if(this.getNullable()){this._oSelect.insertAggregation("items",this._getBlank(),this.getShowValueHelp()?2:1,true)}this.invalidate()};V.prototype._removeContextItems=function(){this._oSelect.removeAllItems();this._updateSpecialSelectItems()};V.prototype._updateContextItems=function(){var t,e,i,o;if(!this._oContainer||!this.getDataType()||!this._bIsSmartFieldInitialized){return}this._removeContextItems();if(this.isBoolean()){this._oSelect.addAggregation("items",this._getBoolTrueItem(),true);this._oSelect.addAggregation("items",this._getBoolFalseItem(),true);this._setShowValueHelp(false)}this._aDistinctValues=[];this._mContextItemsData={};this._mValueOccurences={};this._oContainer.getContexts().forEach(function(o){t=this.getModel().getObject(o.getPath())[this.getPropertyName()];if(typeof t==="undefined"||t==null||typeof t==="string"&&!t.trim()){return}if(this.isComposite()){e=this.getModel().getObject(o.getPath())[this.getUnitOfMeasurePropertyName()]||"";i={value:t,unit:e};if(this._aDistinctValues.map(JSON.stringify).indexOf(JSON.stringify(i))===-1){this._aDistinctValues.push(i);this._mValueOccurences[i.unit+i.value]={count:1,value:i,context:o}}else{this._mValueOccurences[i.unit+i.value].count++}}else if(this.isDate()||this.isDateTime()){var s=this.getSmartField().getAllInnerControls()?.[1]||{};var a=s.customTimezonePath;if(a&&!this.isTimezoneSet){this._oTimezoneInfo={control:s,timezonePath:a};this.isTimezoneSet=true;s.setTimezone(o.getObject()[a])}if(this._aDistinctValues.map(Number).indexOf(+t)===-1){this._aDistinctValues.push(t);this._mValueOccurences[t]={count:1,value:t,context:o}}else{this._mValueOccurences[t].count++}}else if(this._aDistinctValues.indexOf(t)===-1){this._aDistinctValues.push(t);this._mValueOccurences[t]={count:1,value:t,context:o}}else{this._mValueOccurences[t].count++}}.bind(this));o=Object.keys(this._mValueOccurences).map(function(t){return[t,this._mValueOccurences[t]]}.bind(this));o.sort(function(t,e){if(e[1].count!==t[1].count){return e[1].count-t[1].count}else if(this.isComposite()){return e[1].value.value-t[1].value.value}else if(this.isInteger()||this.isFloat()){return e[1].value-t[1].value}else if(this.isDate()||this.isDateTime()){return e[1].value.getTime()-t[1].value.getTime()}else if(t[1].value.localeCompare&&e[1].value.localeCompare){return t[1].value.localeCompare(e[1].value)}else{return 0}}.bind(this));o=o.slice(0,v);this._aDistinctValues=[];o.forEach(function(t){this._addInnerSelectItem(t[1].value,t[1].context,this.isTimezoneSet);this._aDistinctValues.push(t[1].value)}.bind(this));this._setSmartFieldDisplayText(null,null)};V.prototype._addInnerSelectItem=function(t,e,i){var s,a;if(typeof t==="undefined"||t==null||this.isBoolean()){return}if(this.isComposite()){s=JSON.stringify([t.value,t.unit])}else if(this.isDate()){s=d.getDateInstance().format(t)}else if(i){var n=e.getObject()[this._oTimezoneInfo.timezonePath];s=d.getDateTimeWithTimezoneInstance({showTimezone:false}).format(t,n);a=s}else if(this.isDateTime()){s=d.getDateTimeInstance().format(t)}else{s=String(t)}if(this.isComboBox()){var r=this.getRecordTextPath();a=r?e.getObject(r):s;this._mRecordKeyTextMap[s]=a}else{a=a||this._extractValueDisplayText(t)}this._oSelect.addItem(new o({key:s,text:a}),true);this._mContextItemsData[s]=t};V.prototype._setContainer=function(t){this._oContainer=t;this._oSmartField.setEntitySet(t.getEntitySet());this._oSmartField._forceInitialise();this._updateContextItems()};V.prototype._isCurrencyValue=function(){return this._oAnnotations&&this._oAnnotations.uom&&this._oAnnotations.uom.property.property["sap:semantics"]=="currency-code"};V.prototype.resetField=function(){this.isTimezoneSet=false;this._oSelect.setSelectedItem(this._getKeep());this.getSmartField().setValue("");this.getSmartField().setValueStateText("");this.getSmartField().setValueState(F.None);this.getSmartField().removeStyleClass("sapUiCompSmartMultiEditSmartField");this.getSmartField().addStyleClass("sapUiCompSmartMultiEditSmartFieldHidden")};return V});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiedit/flexibility/changes/AddMultiEditFields", ["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/comp/smartmultiedit/Container","sap/ui/comp/smartform/flexibility/changes/AddFields"],function(e,t,n){"use strict";var r={};r.applyChange=function(e,t,r){var i=e.getContent();var o=r.modifier;var a=r.appComponent;var d=i.field.selector;var l=r.view;var f=i.field.id;var p=i.field.index;var s=i.field.propertyName;var u=e.getDependentControl("form",r);var c=u&&o.getFlexDelegate(u);if(!c){if(this._checkChangeContent(i)){var g=i.field.jsType;var v=i.field.entitySet;var m;var h;return Promise.resolve().then(o.createControl.bind(o,"sap.ui.comp.smartform.GroupElement",r.appComponent,r.view,d||f)).then(function(e){m=e;return this._createGroupElementField(o,r.view,m,g,s,v,r.appComponent)}.bind(this)).then(function(e){h=e;return o.insertAggregation(t,"groupElements",m,p,r.view)}).then(function(){var n=this._getContainerFromGroup(t);if(n){n.indexField(h)}e.setRevertData({newFieldSelector:o.getSelector(m,r.appComponent)})}.bind(this))}}return n._addFieldFromDelegate(u,t,d,f,p,s,e,o,l,a)};r.revertChange=function(e,t,n){var r=e.getRevertData(),i=r.newFieldSelector,o=n.modifier;if(i){var a=o.bySelector(i,n.appComponent,n.view);return Promise.resolve().then(o.removeAggregation.bind(o,t,"groupElements",a)).then(function(){o.destroy(a);var i=this._getContainerFromGroup(t);if(i){i._refreshFields()}var d=r.valueHelpSelector;if(d){var l=n.appComponent;var f=n.view;var p=o.bySelector(d,l,f);var s=e.getDependentControl("form",n);return Promise.resolve().then(o.removeAggregation.bind(o,s,"dependents",p)).then(o.destroy.bind(o,p))}}.bind(this)).then(function(){e.resetRevertData()})}else{return Promise.resolve()}};r.completeChangeContent=function(t,n,r){var i=r.appComponent;var o={field:{}};if(n.bindingPath){o.field.propertyName=n.bindingPath}else{throw new Error("oSpecificChangeInfo.bindingPath or bindingPath attribute required")}if(n.newControlId){o.field.selector=e.getSelector(n.newControlId,i)}else{throw new Error("oSpecificChangeInfo.newControlId attribute required")}if(n.jsTypes){o.field.jsType=n.jsType}else if(n.bindingPath){o.field.jsType="sap.ui.comp.smartmultiedit.Field"}else{throw new Error("oSpecificChangeInfo.jsTypes or bindingPath attribute required")}if(n.index===undefined){throw new Error("oSpecificChangeInfo.index attribute required")}else{o.field.index=n.index}if(n.entitySet){o.field.entitySet=n.entitySet}if(n.relevantContainerId){t.addDependentControl(n.relevantContainerId,"form",r)}t.setContent(o)};r._checkChangeContent=function(e){var t=e,n=false;if(t){n=e.field&&(e.field.selector||e.field.id)&&e.field.jsType&&e.field.propertyName}return t&&n};r._createGroupElementField=function(e,t,n,r,i,o,a){return Promise.resolve().then(e.createControl.bind(e,r,a,t)).then(function(r){e.setProperty(r,"propertyName",i);if(o){e.setProperty(r,"entitySet",o)}return Promise.resolve().then(e.insertAggregation.bind(e,n,"elements",r,0,t,true)).then(function(){return r})})};r._getContainerFromGroup=function(e){if(e&&typeof e.getParent==="function"&&typeof e.getParent().getParent==="function"&&typeof e.getParent().getParent().getParent==="function"){var n=e.getParent().getParent().getParent();if(n instanceof t){return n}}};return r},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartmultiinput/SmartMultiInput", ["sap/m/library","sap/m/List","sap/m/Popover","sap/m/StandardListItem","sap/m/MultiInput","sap/m/MultiComboBox","sap/m/Select","sap/m/Token","sap/m/Tokenizer","sap/ui/comp/smartfield/SmartField","sap/ui/comp/odata/MetadataAnalyser","sap/ui/core/Messaging","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/model/BindingMode","sap/ui/comp/odata/ODataType","sap/ui/comp/providers/ValueHelpProvider","sap/ui/comp/util/FormatUtil","sap/ui/core/format/DateFormat","sap/ui/comp/smartfilterbar/FilterProvider","sap/base/Log","sap/base/util/deepEqual","sap/ui/comp/library","sap/ui/core/library","sap/ui/core/ResizeHandler","sap/m/Link","sap/m/Text","sap/m/FlexBox","sap/m/HBox","sap/base/util/isEmptyObject","sap/base/security/sanitizeHTML","sap/ui/thirdparty/jquery","sap/ui/core/date/UI5Date","sap/ui/core/Lib","sap/ui/core/InvisibleText"],function(t,e,i,o,a,n,s,r,l,h,u,p,d,g,_,f,c,y,m,T,v,x,M,b,k,I,B,C,S,E,D,P,R,F,H){"use strict";var V=M.valuehelpdialog.ValueHelpRangeOperation;var L=M.smartfilterbar.DisplayBehaviour;var N=M.smartfield.TextInEditModeSource;var O=b.ValueState;var w=t.PlacementType;var A="-mInput";var z="-mInputTokenizer";var W="-mInputHBox";var K="-mMoreLink";var q=F.getResourceBundleFor("sap.ui.comp");var U={SELECT:"SELECT",DESELECT:"DESELECT"};var G=h.extend("sap.ui.comp.smartmultiinput.SmartMultiInput",{metadata:{library:"sap.ui.comp",properties:{supportRanges:{type:"boolean",defaultValue:false},supportMultiSelect:{type:"boolean",defaultValue:true},enableODataSelect:{type:"boolean",defaultValue:false},requestAtLeastFields:{type:"string",defaultValue:""},textSeparator:{type:"string",defaultValue:null},singleTokenMode:{type:"boolean",defaultValue:false},enableValueHelpSelectAll:{type:"boolean",defaultValue:undefined}},aggregations:{initialTokens:{type:"sap.m.Token",multiple:true}},events:{beforeCreate:{allowPreventDefault:true,parameters:{oData:{type:"object"},mParameters:{type:"object"}}},beforeRemove:{allowPreventDefault:true,parameters:{mParameters:{type:"object"}}},tokenUpdate:{parameters:{type:{type:"string"},addedTokens:{type:"sap.m.Token[]"},removedTokens:{type:"sap.m.Token[]"}}},selectionChange:{parameters:{changedItem:{type:"sap.ui.core.Item"},selected:{type:"boolean"}}},selectionFinish:{parameters:{selectedItems:{type:"sap.ui.core.Item[]"}}}}},renderer:function(t,e){h.getMetadata().getRenderer().render(t,e);if(e._oEmptyDash){var i=e.getTokens().length>0?false:true;e._oEmptyDash.setVisible(i);if(i&&e._oMoreLink){e._oMoreLink.setVisible(false)}}}});G.prototype.getTokens=function(){if(this._isReadMode()&&this._oTokenizer){return this._oTokenizer.getTokens()}else if(this._oMultiComboBox&&this._oMultiComboBox.getAggregation("tokenizer")){return this._oMultiComboBox.getAggregation("tokenizer").getTokens()}else if(this._oMultiInput){return this._oMultiInput.getTokens()}return[]};G.prototype.getValue=function(){return this.getTokens()};G.prototype._createMultiInput=function(){var t=this._createAttributes(),e;if(this._oMultiComboBox){this._oMultiComboBox.destroy();this._oMultiComboBox=null}if(this.getSingleTokenMode()&&!this.getBindingContext()){t["maxTokens"]=1}this._oMultiInput=new a(this.getId()+A,t);this._oMultiInput.attachChange(function(t){this._validateValueOnChange(t.getParameter("value"))},this);if(this.getBindingContext()){this._bindMultiInput()}else{e=this.getAggregation("initialTokens")||[];e.forEach(function(t){this._oMultiInput.addToken(t)}.bind(this))}this._oMultiInput.attachTokenUpdate(function(t){this._validateValueOnChange(this._oMultiInput.getValue());var e=t.getParameters();delete e.id;if(this.getBinding("value").getBindingMode()!=="TwoWay"||!this.getBindingContext()){if(t.getParameter("removedTokens")){t.getParameter("removedTokens").forEach(function(t){t.destroy()})}}this.fireTokenUpdate(e)},this);var i={control:this._oMultiInput,onCreate:"_onMultiInputCreate",params:{type:{type:this._getType(),property:this._oFactory._oMetaData.property}}};this._initMultiInputValueHelp(i);return i};G.prototype._createMultiComboBox=function(){var t=this._createAttributes();if(this.getSingleTokenMode()&&!this.getBindingContext()){t["width"]="100%";delete t["placeholder"]}this._oMultiComboBoxRequestStack={};this._oMultiComboBox=this.getSingleTokenMode()&&!this.getBindingContext()?new s(this.getId()+"mComboBox",t):new n(this.getId()+"mComboBox",t);if(this.getBindingContext()){this._bindMultiComboBox()}else{this._oMultiInput=this._oMultiComboBox._oTokenizer}if(!this.getSingleTokenMode()){this._oMultiComboBox.attachSelectionChange(function(t){var e=t.getParameters();delete e.id;this.fireSelectionChange(e)},this);this._oMultiComboBox.attachSelectionFinish(function(t){(()=>{var t=Object.keys(this._oMultiComboBoxRequestStack);var e=(this._oMultiInput.getTokens()||[]).map(t=>t.getKey());if(t.length>0){t.forEach(t=>{var i=this._oMultiComboBoxRequestStack[t],o=e.indexOf(t),a=i[i.length-1],n=this._getModel();if(o===-1){if(a.action===U.SELECT){n.createEntry(...i[0].params)}}else if(a.action===U.DESELECT){n.remove(...i[0].params)}})}this._oMultiComboBoxRequestStack={}})();var e=t.getParameters();delete e.id;this.fireSelectionFinish(e)},this)}else if(this.getSingleTokenMode()&&!this.getBindingContext()){this._oMultiComboBox.attachChange(function(t){var e=t.getParameters();delete e.id;this.fireSelectionChange(e)},this)}var e={control:this._oMultiComboBox,onCreate:"_onCreate",params:{type:{type:this._getType(),property:this._oFactory._oMetaData.property},valuehelp:{annotation:this._getValueListAnnotation(),aggregation:"items",noDialog:true,noTypeAhead:true}}};return e};G.prototype._createAttributes=function(){var t={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var e=this._oFactory.createAttributes(null,this._oFactory._oMetaData.property,t,{event:"change",parameter:"value"});return e};function j(t){var e=t.getParameter("tokens"),i,o,n=0,s=[],r=null,l;this._onCancel();if(this.oControl instanceof a){this.oControl.setValue("");var h=this.oControl.getTokens();var u=[];var p=[];var d=[];h.forEach(function(t){var i=e.some(function(e){return t.getKey()===e.getKey()});if(!i){p.push(t)}else{var o=e.filter(function(e){return t.getKey()===e.getKey()})[0];if(!this.oControl.getBindingContext()&&this.bSupportRanges&&o.getKey().startsWith("range_")){d.push(o)}else{t.setText(o.getText());d.push(t)}}}.bind(this));e.forEach(function(t){var e=h.some(function(e){return e.getKey()===t.getKey()});if(!e){u.push(t);d.push(t)}});this.oControl.setTokens(d);var g=this.oControl.getParent();if(g&&g.getBindingContext()&&g.getBinding("value").getBindingMode()==="TwoWay"){var _=g._getModel(),f=g._getEntitySetName(),c=_._resolveGroup(f),y=_.getDeferredGroups().indexOf(c.groupId)>=0;if(!y&&(p.length||u.length)&&d.length){g.setBusyIndicatorDelay(g.getBusyIndicatorDelay());g.setBusy(true)}}this.oControl.fireTokenUpdate({type:"tokensChanged",removedTokens:p,addedTokens:u});n=e.length;while(n--){r=e[n].data("row");if(r){s.push(r)}}}else{if(e[0]){if(this.bIsSingleIntervalRange){i=e[0].data("range");if(i){if(this._sType==="datetime"){l=m.getDateTimeInstance(Object.assign({},this._oDateFormatSettings,{UTC:false}));if(typeof i.value1==="string"){i.value1=R.getInstance(i.value1)}if(i.operation==="BT"){if(typeof i.value2==="string"){i.value2=R.getInstance(i.value2)}o=l.format(i.value1)+"-"+l.format(i.value2)}else{o=l.format(i.value1)}}else if(i.operation==="BT"){o=i.value1+"-"+i.value2}else{o=i.value1}}}else{o=e[0].getKey()}r=e[0].data("row");if(r){s.push(r)}}this.oControl.setValue(o);this.oControl.fireChange({value:o,validated:true})}this._calculateAndSetFilterOutputData(s)}function Q(t){var e,i,o,a={};if(t&&this.mOutParams){for(e in this.mOutParams){if(e){i=this.mOutParams[e];if(i!==this.sKey){o=t[i];a[e]=o}}}if(a&&!E(a)){this.fireEvent("valueListChanged",{changes:a})}}}function J(t,e){var i=document.createElement("span");i.style.whiteSpace="nowrap";i.style.maxWidth="fit-content";i.innerHTML=t;i.className="sapMText";e.appendChild(i);var o=e.childNodes;var a=o[o.length-1].offsetWidth;e.removeChild(e.childNodes[o.length-1]);return a}G.prototype._initMultiInputValueHelp=function(t){var e=this._getFilterType(this._oFactory._oMetaData.property.property),i={},o=this._getDateFormatSettings(),a,n=this.getEnableValueHelpSelectAll();this._oFactory._getValueHelpDialogTitle(i);if(this._getValueListAnnotation()){t.params.valuehelp={annotation:this._getValueListAnnotation(),aggregation:"suggestionRows",noDialog:false,noTypeAhead:false,supportMultiSelect:this.getSingleTokenMode()?false:this.getSupportMultiSelect(),supportRanges:this.getBindingContext()?false:this.getSupportRanges(),type:e,displayBehaviour:this._getDisplayBehaviour(),enabledMultiSelectionPlugin:n===undefined?undefined:!n}}else if(this.getSupportRanges()&&!this.getBindingContext()){a=new c({fieldName:this._getPropertyName(),preventInitialDataFetchInValueHelpDialog:true,model:this.getModel(),control:this._oMultiInput,title:i.dialogtitle,supportMultiSelect:this.getSingleTokenMode()?false:this.getSupportMultiSelect(),supportRanges:true,type:e,dateFormatSettings:o,isUnrestrictedFilter:this._isTimeType(e),displayBehaviour:this._getDisplayBehaviour(),enabledMultiSelectionPlugin:n===undefined?undefined:!n});a._onOK=j;a._calculateAndSetODataModelOutputData=Q;this._oMultiInput.addValidator(this._validateToken.bind(this))}else{this._oMultiInput.setShowValueHelp(false);this._oMultiInput.addValidator(this._validateToken.bind(this))}};G.prototype._bindMultiInput=function(){var t=this.getBinding("value").getBindingMode();switch(t){case _.OneTime:this._bindMultiInputOneTime();break;case _.OneWay:this._bindMultiInputOneWay();break;case _.TwoWay:default:this._bindMultiInputTwoWay()}};G.prototype._bindMultiInputOneTime=function(){var t=this;this._readNavigationPropertySet().then(function(e){e.results.forEach(function(e){var i=e[t._getPropertyName()];var o=t._getDescriptionFieldName();var a=o?e[o]:"";t._oMultiInput.addToken(t._createToken(i,a))})})};G.prototype._bindMultiInputOneWay=function(){this._bindMultiInputTokens(this._oMultiInput)};G.prototype._bindMultiInputTwoWay=function(){this._bindMultiInputTokens(this._oMultiInput);this._oMultiInput.attachTokenUpdate(function(t){t.getParameter("addedTokens").forEach(this._addToken.bind(this));t.getParameter("removedTokens").forEach(this._removeToken.bind(this))},this)};G.prototype._bindMultiInputTokens=function(t){var e=this._getNavigationPath(),i=this._getSelectExpandParameter();if(!E(i)){t.bindAggregation("tokens",{path:e,parameters:{...i,usePreliminaryContext:true},factory:this._tokensFactory.bind(this),events:{aggregatedDataStateChange:this._processDataState.bind(this)}})}else{t.bindAggregation("tokens",{path:e,factory:this._tokensFactory.bind(this),events:{aggregatedDataStateChange:this._processDataState.bind(this)}})}};G.prototype._processDataState=function(t){var e=t.getParameter("dataState"),i=this.getBinding("value");if(!e||!e.getChanges().messages){return}if(i&&i.bIsBeingDestroyed){return}var o=e.getMessages();if(o.length){var a=false;var n=o[0];o.forEach(function(t){if(t.getControlIds().indexOf(this.getId())==-1){t.addControlId(this.getId());a=true}}.bind(this));this.setValueState(n.getType());this.setValueStateText(n.getMessage());if(a){p.getMessageModel().checkUpdate(false,true)}}else{this.setValueState(O.None);this.setValueStateText("")}};G.prototype._getSelectExpandParameter=function(){var t={};if(this.getEnableODataSelect()){t.select=this._addODataSelectParameters()}if(this._oFactory._oMetaData.annotations.text&&this._oFactory._oMetaData.annotations.text.navigationPathHelp){t.expand=this._oFactory._oMetaData.annotations.text.navigationPathHelp}return t};G.prototype._addODataSelectParameters=function(t){var e=this._getPropertyName();if(this._getDescriptionFieldName()){e=e+","+this._getDescriptionFieldName()}if(this.getRequestAtLeastFields()){e=e+","+this.getRequestAtLeastFields()}return e};G.prototype._calculateFieldGroupMetaData=function(){var t,e,i,o;if(this._oFactory._oMeta){e=this._oFactory._oMeta.entitySet;i=this.getModel().getMetaModel().getODataEntitySet(e);o=this.getModel().getMetaModel().getODataEntityType(i.entityType);t={entitySet:i,entityType:o,path:this._getNavigationPath()}}return t};G.prototype._bindMultiComboBox=function(){var t=this.getBinding("value").getBindingMode();switch(t){case _.OneTime:this._bindMultiComboBoxOneTime();break;case _.OneWay:this._bindMultiComboBoxOneWay();break;case _.TwoWay:default:this._bindMultiComboBoxTwoWay()}};G.prototype._bindMultiComboBoxOneTime=function(){var t=this;this._readNavigationPropertySet().then(function(e){var i=e.results.map(function(e){return e[t._getPropertyName()]});t._oMultiComboBox.setSelectedKeys(i)})};G.prototype._bindMultiComboBoxOneWay=function(){this._createAndAttachHelperMultiInput()};G.prototype._bindMultiComboBoxTwoWay=function(){this._createAndAttachHelperMultiInput();this._oMultiComboBox.attachSelectionChange(function(t){var e=t.getParameter("selected"),i=t.getParameter("changedItem"),o={},a,n,s;this.setValueState(O.None);this.setValueStateText("");if(e){o[this._getPropertyName()]=i.getKey();s=i.getBindingContext("list")||i.getBindingContext();a=s.getProperty();this._getEntityType().key.propertyRef.forEach(function(t){if(a&&a[t.name]){o[t.name]=a[t.name]}})}else{n=this._oMultiInput.getTokens().filter(function(t){return t.getKey()===i.getKey()})[0]}if(e){this._createEntity(o,i.getKey())}else{this._removeEntity(n?.getBindingContext(),i.getKey())}},this)};G.prototype._readNavigationPropertySet=function(){var t=this;return new Promise(function(e,i){var o=t.getBindingContext(),a=t._getModel(),n=t._getNavigationPath();a.read(n,{context:o,success:function(t){e(t)},error:function(e){t.setValueState(O.Error);t.setValueStateText(e.responseText);i(e)}})})};G.prototype._createAndAttachHelperMultiInput=function(){this._oMultiInput=new a({maxTokens:this.getSingleTokenMode()?1:undefined});this._oMultiInput.setBindingContext(this.getBindingContext());this._oMultiInput.setModel(this._getModel());this._bindMultiInputTokens(this._oMultiInput);var t=this._oMultiInput.getBinding("tokens");this._updateSelectedKeys.call(this);t.attachChange(this._updateSelectedKeys,this)};G.prototype._updateSelectedKeys=function(){var t=this?._oMultiInput?.getTokens().map(function(t){return t.getKey()})||[];if(this._oMultiComboBox){var e=this.getBinding("value").getBindingMode();if(e==_.TwoWay){if(this._oFactory){var i=this._oFactory.getValueListProvider();if(i&&i.bInitialised){i._calculateFilterInputData();if(i._mLastFilterInputData&&!x(i._mLastFilterInputData,i.mFilterInputData)){i._filterDropdownRowsByInParameters()}}}}this._oMultiComboBox.setSelectedKeys(t)}};G.prototype._getReadTokenList=function(){if(!this.oReadTokenList){this.oReadTokenList=new e;this.addDependent(this.oReadTokenList)}return this.oReadTokenList};G.prototype._getReadTokenListPopover=function(){if(!this.oReadTokenListPopover){this.oReadTokenListPopover=new i({showArrow:true,placement:w.Auto,showHeader:false,contentMinWidth:"auto",content:[this.oReadTokenList]});this.addDependent(this.oReadTokenListPopover)}return this.oReadTokenListPopover};G.prototype._handleNMoreIndicatorPress=function(){var t=this.getTokens();if(!t){return}var e=this._getReadTokenList();var i=this._getReadTokenListPopover();e.removeAllItems();for(var a=0,n=t.length;a<n;a++){var s=t[a],r=new o({title:s.getText()});e.addItem(r)}if(this._oMoreLink.getDomRef()){i.openBy(this._oMoreLink.getDomRef())}};G.prototype._onResize=function(){if(this._isReadMode()&&this._oTokenizer){this._deregisterResizeHandler();this._oTokenizer.setMaxWidth(this.$().width()+"px");this._oTokenizer.setRenderMode("Narrow");this._oTokenizer.scrollToEnd();if(this.getMode()==="display"&&this.getTokens().length>0){this._onDisplayResize()}this._registerResizeHandler()}};G.prototype._onDisplayResize=function(){if(this.getDomRef()&&this.getDomRef().offsetWidth>0){var t=this.getDomRef().clientWidth,e=this._iHiddenLabelsCount?J("999 "+q.getText("POPOVER_DEFINE_MORE_LINKS"),this.getDomRef()):0,i=!this._iHBoxWidth||this._iHBoxWidth+e>t,o=this._iHiddenLabelsCount>0&&this._iHBoxWidth+e+this._iFirstHiddenTokenLength<t;if(i||o){this._oHBox.removeAllItems();this.getTokens().forEach(function(t){this._oHBox.addItem(this._generateDisplayText(t.getText()))}.bind(this))}}};G.prototype.onBeforeRendering=function(){if(h.prototype.onBeforeRendering){h.prototype.onBeforeRendering.apply(this,arguments)}this._deregisterResizeHandler()};G.prototype.onAfterRendering=function(){if(h.prototype.onAfterRendering){h.prototype.onAfterRendering.apply(this,arguments)}if(this._oTokenizer&&this._oTokenizer.getBinding("tokens")){this._oTokenizer.getBinding("tokens").attachChange(this._onTokenizerBindingChange.bind(this))}if(this.getMode()==="display"&&this.bControlNotRendered){this._oHBox.removeAllItems();this._oMoreLink.setVisible(false);this.getTokens().forEach(function(t){var e=this._generateDisplayText(t.getText());this._oHBox.addItem(e)},this)}if(this._oMultiComboBox&&this._oMultiInput&&this._oMultiInput.getBindingContext()&&this.getBindingContext()){var t=this.getBindingContext().getPath();var e=this._oMultiInput.getBindingContext().getPath();if(e!==t){this._oMultiInput.setBindingContext(this.getBindingContext())}}this._registerResizeHandler()};G.prototype._onTokenizerBindingChange=function(){if(this.getMode()==="display"&&this._oTokenizer.getTokens()?.length===0&&this._oMoreLink.getVisible()===true){this._oMoreLink.setVisible(false);this._oEmptyDash.setVisible(true)}};G.prototype._registerResizeHandler=function(){if(!this._iResizeHandlerId){this._iResizeHandlerId=k.register(this,this._onResize.bind(this))}};G.prototype._deregisterResizeHandler=function(){if(this._iResizeHandlerId){k.deregister(this._iResizeHandlerId);this._iResizeHandlerId=null}};G.prototype._hasHTML=function(t){var e=/<[a-z][\s\S]*>/i;return e.test(t)};G.prototype._createTokenizer=function(){this._oTokenizer=new l(this.getId()+z,{editable:false,visible:false,width:"100%"});this._oHBox=new S(this.getId()+W);this._oMoreLink=new I(this.getId()+K,{press:this._handleNMoreIndicatorPress.bind(this),ariaLabelledBy:this.getId()+"-label"});this._oEmptyDash=new B({text:"",visible:true});var t=this._getNavigationPath(),e=this._getSelectExpandParameter();if(this.getBindingContext()){this._bindMultiInputTokens(this._oTokenizer);this._oHBox.bindAggregation("items",{path:t,parameters:e,factory:this._textFactory.bind(this)})}else{this.attachInnerControlsCreated(this._mirrorTokensToDisplayTokenizer,this)}var i=new C({height:"100%",items:[this._oEmptyDash,this._oHBox,this._oMoreLink,this._oTokenizer]});return{control:i,onCreate:"_onCreate"}};G.prototype._textFactory=function(t,e){var i=e.getProperty(this._getPropertyName())||"";var o=i instanceof Date?this._formatValue(i):i.toString(),a=this._getDescriptionFieldName(),n=a?e.getProperty(a):"",s=this._getFormattedText(o,n),r;if(this.getDomRef()&&this.getDomRef().offsetWidth){this.bControlNotRendered=false;r=this._generateDisplayText(s)}else{this.bControlNotRendered=true;r=new B({text:s})}if(this._oEmptyDash){this._oEmptyDash.setVisible(false)}return r};G.prototype._generateDisplayText=function(t){var e=this.getDomRef(),i=e.offsetWidth,o=J("999 "+q.getText("POPOVER_DEFINE_MORE_LINKS"),e),a=new B,n,s,r;t=this._hasHTML(t)?D(t):t;if(!t){return a}if(this._oHBox.getItems().length===0){this._iHBoxWidth=0;this._iHiddenLabelsCount=0;this._iFirstHiddenTokenLength=0}this._oHBox.getItems().filter(function(t){return!t.getVisible()}).forEach(function(t){this._oHBox.removeItem(t)}.bind(this));a.setTooltip(t);t=this._iHBoxWidth===0?t:""+this.getTextSeparator()+""+t;a.setText(t);var l=J(t,e);this._iHBoxWidth+=l;if(this._iHiddenLabelsCount===0&&this._iHBoxWidth<=i){this._oMoreLink.setVisible(false)}else{while(this._iHBoxWidth&&this._iHBoxWidth>i-o){this._iHiddenLabelsCount+=1;if(this._oHBox.getItems()[0]){this._iFirstHiddenTokenLength=J(this._oHBox.getItems()[0].getText(),e);this._iHBoxWidth-=this._iFirstHiddenTokenLength;this._oHBox.removeItem(0)}else{this._iHBoxWidth-=l;a.setVisible(false)}}if(this._oHBox.getItems().length===0&&this._iHiddenLabelsCount===1&&!a.getVisible()){this._iHiddenLabelsCount=0;this._iHBoxWidth+=l;a.setVisible(true);this._oMoreLink.setVisible(false)}else{if(this._oHBox.getItems().length>0){n=this._oHBox.getItems()[0];n.setText(n.getTooltip());if(this._oHBox.getItems().length-1>0){s=this._oHBox.getItems()[this._oHBox.getItems().length-1];r=""+this.getTextSeparator()+""+s.getTooltip();s.setText(r)}a.setText(a.getText()+""+this.getTextSeparator()+"")}else{a.setText(a.getTooltip()+""+this.getTextSeparator()+"")}this._oMoreLink.setVisible(true);this._oMoreLink.setText(this._iHiddenLabelsCount+" "+this._getDisplaySubText())}}return a};G.prototype._getDisplaySubText=function(){return this.getValue().length===this._iHiddenLabelsCount?q.getText("SMARTMULTIINPUT_ITEMS"):q.getText("POPOVER_DEFINE_MORE_LINKS")};G.prototype._mirrorTokensToDisplayTokenizer=function(){if(this.getMode()==="display"){var t=this._oMultiInput&&this._oMultiInput.getTokens();this._oTokenizer.removeAllTokens();this._oHBox.removeAllItems();this._oMoreLink.setVisible(false);if(!t){t=this.getAggregation("initialTokens")||[]}t.forEach(function(t){var e=new r({text:t.getText(),key:t.getKey()});this._oTokenizer.addToken(e);var i=this._generateDisplayText(t.getText());this._oHBox.addItem(i)},this)}};G.prototype.getTextSeparator=function(){var t=this.getProperty("textSeparator");if(t){return t}return q.getText("SMARTMULTIINPUT_SEPARATOR")};G.prototype._tokensFactory=function(t,e){var i;this.setBusy(false);if(this._oFactory){var o=e.getProperty(this._getPropertyName());if(o===null||o===undefined){i=new r;Promise.resolve().then(function(){i.destroy()});return i}var a=o instanceof Date?this._formatValue(o):o.toString();var n=this._getDescriptionFieldName();var s=n?e.getProperty(n):"";i=this._createToken(a,s,e)}else{i=new r}return i};G.prototype._createToken=function(t,e,i){var o=this._getFormattedText(t,e);var a;a=new r;a.setKey(t);a.setText(o);return a};G.prototype._addToken=function(t){var e={},i,o,a,n=t.data("row"),s=t.data("range");e[this._getPropertyName()]=t.getKey();if(n){this._getEntityType().key.propertyRef.forEach(function(t){var i=n[t.name];if(i||i===0){e[t.name]=i}});if(this._oFactory._aProviders&&this._oFactory._aProviders[0].mOutParams){var r=this._oFactory._aProviders[0].mOutParams;for(o in r){if(o&&o!==this._getPropertyName()){a=r[o];e[o]=n[a]}}}}if(s){e["range"]=s}this.setValueState(O.None);this.setValueStateText("");i=this._createEntity(e);t.setBindingContext(i)};G.prototype._createEntity=function(t,e){var i=this._getModel(),o=this._getEntitySetName(),a=i._resolveGroup(o),n=this._getNavigationPath(),s=this.fireBeforeCreate({oData:t,mParameters:a});a.refreshAfterChange=true;a.context=this.getBindingContext();var r=a.context;var l=r&&r.isTransient&&r.isTransient();if(l){a={}}a.properties=t;if(s){if(e){if(!this._oMultiComboBoxRequestStack[e]){this._oMultiComboBoxRequestStack[e]=[]}this._oMultiComboBoxRequestStack[e].push({action:U.SELECT,params:[n,a]})}else{return i.createEntry(n,a)}}};G.prototype._removeToken=function(t){this._removeEntity(t.getBindingContext());t.destroy()};G.prototype._removeEntity=function(t,e){var i=this._getModel(),o=this._getEntitySetName(),a=i._resolveGroup(o),n=this.fireBeforeRemove({mParameters:a});var s=i.getDeferredGroups().indexOf(a.groupId)>=0;if(t&&s&&this._entityHasPendingCreateChange(i,t)){i.deleteCreatedEntry(t);n=false}a.refreshAfterChange=true;a.context=t;if(n){var r="";if(e){if(!this._oMultiComboBoxRequestStack[e]){this._oMultiComboBoxRequestStack[e]=[]}this._oMultiComboBoxRequestStack[e].push({action:U.DESELECT,params:[r,a]})}else{i.remove(r,a)}}};G.prototype._entityHasPendingCreateChange=function(t,e){var i=t.getPendingChanges();var o=t.getKey(e);return!!i[o]&&x(i[o],e.getObject())};G.prototype._getEntityKeyProperties=function(t){var e=this._getModel(),i=e.oMetadata._getEntityTypeByPath(t.getPath()),o={};i.key.propertyRef.forEach(function(e){var i=e.name;o[i]=t.getProperty(i)});return o};G.prototype.checkClientError=function(){if(this.getMode()==="display"){return false}return!this._validateMultiInput()};G.prototype.getRangeData=function(){var t=this.getTokens(),e=[];t.forEach(function(t){var i;if(t.data("range")){i=t.data("range")}else{i=this._getDefaultTokenRangeData(t)}e.push(i)},this);return e};G.prototype.setRangeData=function(t){if(!this.getBindingContext()){var e=Array.isArray(t)?t:[t];if(!this._oMultiInput){var i=this.getEditable(),o=this.getEnabled(),a=this.getContextEditable();this.setEditable(true);this.setEnabled(true);this.setContextEditable(true);this._updateInnerControlsIfRequired();this.setEditable(i);this.setEnabled(o);this.setContextEditable(a);this._updateInnerControlsIfRequired()}this._oMultiInput.removeAllTokens();e.forEach(function(t){var e=this._getTokenTextFromRangeData(t);var i=new r({text:e,key:e});i.data("range",t);this._oMultiInput.addToken(i)},this);this._mirrorTokensToDisplayTokenizer()}else{v.warning("setRangeData can only be used without property binding")}};G.prototype._getTokenTextFromRangeData=function(t){var e="";switch(t.operation){case V.EQ:e="="+t.value1;break;case V.GT:e=">"+t.value1;break;case V.GE:e=">="+t.value1;break;case V.LT:e="<"+t.value1;break;case V.LE:e="<="+t.value1;break;case V.Contains:e="*"+t.value1+"*";break;case V.StartsWith:e=t.value1+"*";break;case V.EndsWith:e="*"+t.value1;break;case V.BT:e=t.value1+"...";if(t.value2){e+=t.value2}break;default:e=""}if(t.exclude&&e!==""){e="!("+e+")"}return e};G.prototype._getComputedTextInEditModeSource=function(){var t=this.getTextInEditModeSource();if(this.isPropertyInitial("textInEditModeSource")&&this.getMode()==="edit"){t=N.None}return t};G.prototype.getFilter=function(){var t=[this._getPropertyName()],e={},i=this.getRangeData(),o;e[this._getPropertyName()]={ranges:i,items:[]};o=T.generateFilters(t,e);return o&&o.length===1&&o[0]};G.prototype._getDefaultTokenRangeData=function(t){var e={exclude:false,operation:V.EQ,value1:this._parseValue(t.getKey()),value2:"",keyField:this._getPropertyName()};return e};G.prototype._validateToken=function(t){var e=t.text;var i=this._validateValue(e);if(i){var o=new r({key:e,text:e});if(this.getSupportRanges()){var a=this._getDefaultTokenRangeData(o);o.data("range",a);o.setText("="+e)}return o}return undefined};G.prototype._validateMultiInput=function(){if(this._oMultiInput.getValueState()!==O.None){return false}if(this.getRequired()&&this.getTokens().length===0){this.setValueStateText(F.getResourceBundleFor("sap.ui.comp").getText("VALUEHELPVALDLG_FIELDMESSAGE"));this.setValueState(O.Error);return false}else{this.setValueState(O.None);this.setValueStateText("");return true}};G.prototype._validateValueOnChange=function(t){if(t===""){this.setValueState(O.None);this.setValueStateText("");this._validateMultiInput()}else{this._validateValue(t)}};G.prototype._parseValue=function(t){return this._getType().parseValue(t,"string")};G.prototype._formatValue=function(t){return this._getType().formatValue(t,"string")};G.prototype._validateValue=function(t){try{var e=this._parseValue(t);this._getType().validateValue(e);this.setValueState(O.None);this.setValueStateText("");return true}catch(e){this.setValueState(O.Error);this.setValueStateText(e.message);var i={element:this._oMultiInput,property:"value",type:this._getType(),newValue:t,oldValue:null,exception:e,message:e.message};if(e instanceof d){this.fireParseError(i)}else if(e instanceof g){this.fireValidationError(i)}return false}};G.prototype._getModel=function(){if(this._oFactory){return this._oFactory._oModel}return null};G.prototype._getDateFormatSettings=function(){var t=this.data("dateFormatSettings");if(typeof t==="string"){try{t=JSON.parse(t)}catch(t){}}return t};G.prototype._getNavigationPath=function(){return this._oFactory._oMetaData.navigationPath};G.prototype._getDescriptionFieldName=function(){var t=this._oFactory._oMetaData.annotations.text;if(t){if(t.navigationPathHelp){return t.navigationPathHelp+"/"+t.property.property.name}return t.property.property.name}};G.prototype._getType=function(){if(!this._oType){var t;if(this._isEdmTimeType()){t=this._getDateFormatSettings()}this._oType=this._oFactory._oTypes.getType(this._oFactory._oMetaData.property,t)}return this._oType};G.prototype._isEdmTimeType=function(){var t=["Edm.DateTime","Edm.DateTimeOffset","Edm.Time"];return t.indexOf(this._oFactory._oMetaData.property.property.type)>-1};G.prototype._isTimeType=function(t){var e=["date","datetime","time"];return e.indexOf(t)>-1};G.prototype._getPropertyName=function(){return this._oFactory._oMetaData.property.property.name};G.prototype._getEntitySetName=function(){return this._oFactory._oMetaData.entitySet.name};G.prototype._getEntityType=function(){return this._oFactory._oMetaData.entityType};G.prototype._getValueListAnnotation=function(){return this._oFactory._oMetaData.annotations.valuelist};G.prototype._getDisplayBehaviour=function(){var t=this._oFactory._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour");if(!t||t===L.auto){t=L.descriptionAndId}return t};G.prototype._getFormattedText=function(t,e){var i=this._getDisplayBehaviour();var o=y.getFormattedExpressionFromDisplayBehaviour(i,t,e);return this._hasHTML(o)?D(o):o};G.prototype._getFilterType=function(t){if(f.isNumeric(t.type)){return"numeric"}else if(t.type==="Edm.DateTime"&&t["sap:display-format"]==="Date"){return"date"}else if(t.type==="Edm.String"){return"string"}else if(t.type==="Edm.Boolean"){return"boolean"}else if(t.type==="Edm.Time"){return"time"}else if(t.type==="Edm.DateTimeOffset"){return"datetime"}return undefined};G.prototype.setEntitySet=function(){h.prototype.setEntitySet.apply(this,arguments);this.updateBindingContext(false,this._getModel());return this};G.prototype.bindProperty=function(t,e){h.prototype.bindProperty.apply(this,arguments);if(t==="value"){this.updateBindingContext(false,this._getModel())}return this};G.prototype._checkComboBox=function(){var t=this._oFactory._oSelector.checkComboBox();return t&&t.combobox};G.prototype._isReadMode=function(){return!this.getEditable()||!this.getEnabled()||!this.getContextEditable()};function $(){this._onCreate.apply(this,arguments);if(this._aProviders.length>0){this._aProviders[0]._onOK=j;this._aProviders.forEach(function(t){t._calculateAndSetODataModelOutputData=Q})}}G.prototype._init=function(){var t=this;this._oRb=F.getResourceBundleFor("sap.ui.comp");if(this.getSingleTokenMode()&&!this._oInvisibleText){this._oInvisibleText=new H;this._oInvisibleText.toStatic();this.addAssociation("ariaLabelledBy",this._oInvisibleText.getId());this._oInvisibleText.setText(this._oRb.getText("SMARTMULTIINPUT_SINGLETOKENMODE"));this.addDependent(this._oInvisibleText)}h.prototype._init.apply(this,arguments);if(this._oFactory){this._oFactory._createMultiInput=this._createMultiInput.bind(this);this._oFactory._createMultiComboBox=this._createMultiComboBox.bind(this);this._oFactory._createTokenizer=this._createTokenizer.bind(this);this._oFactory._onMultiInputCreate=$;this._oFactory._oSelector.getCreator=function(e){var i=e!==undefined&&e.mode!==undefined?e.mode==="display":t._isReadMode();if(i){return"_createTokenizer"}else if(t._checkComboBox()){return"_createMultiComboBox"}else{return"_createMultiInput"}}}};G.prototype._getEditableForNotExpandedNavigation=function(){return true};G.prototype.exit=function(){h.prototype.exit.apply(this,arguments);this._deregisterResizeHandler();if(this._oMultiInput){this._oMultiInput.destroy()}if(this._oMultiComboBox){this._oMultiComboBox.destroy()}if(this._oTokenizer){this._oTokenizer.destroy()}if(this._oHBox){this._oHBox.destroy()}this._oMultiInput=null;this._oMultiComboBox=null;this._oTokenizer=null;this._oHBox=null};return G});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/SmartTable", ["sap/m/library","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/library","sap/ui/core/Messaging","sap/ui/core/ShortcutHintsMixin","sap/ui/core/format/ListFormat","sap/ui/events/KeyCodes","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/util/FilterUtil","sap/ui/comp/smartfilterbar/FilterProviderUtils","sap/m/Column","sap/m/ColumnListItem","sap/m/Label","sap/m/MessageBox","sap/m/Table","sap/m/Text","sap/m/Title","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/OverflowToolbarButton","sap/m/ToolbarSeparator","sap/m/VBox","sap/m/FlexItemData","sap/ui/comp/library","sap/ui/comp/providers/TableProvider","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/table/AnalyticalColumn","sap/ui/table/AnalyticalTable","sap/ui/table/Column","sap/ui/table/Table","sap/ui/table/TreeTable","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","sap/ui/comp/util/DateRangeTypeUtils","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/FullScreenUtil","sap/ui/comp/util/TableUtil","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/ODataType","sap/ui/comp/state/UIState","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/core/format/NumberFormat","sap/ui/Device","sap/base/Log","sap/base/util/deepEqual","sap/base/util/merge","sap/m/Menu","sap/m/OverflowToolbarMenuButton","sap/m/MenuItem","sap/m/Button","sap/m/Link","sap/m/MessageStrip","sap/ui/util/openWindow","sap/ui/core/theming/Parameters","sap/m/plugins/ColumnResizer","sap/m/table/Util","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/table/columnmenu/Menu","sap/m/table/columnmenu/QuickAction","sap/m/table/columnmenu/QuickSort","sap/m/table/columnmenu/QuickSortItem","sap/m/table/columnmenu/QuickGroup","sap/m/table/columnmenu/QuickGroupItem","./flexibility/Utils","sap/base/util/isEmptyObject","sap/ui/performance/trace/FESRHelper","sap/ui/base/DesignTime","sap/m/plugins/CellSelector","sap/m/plugins/CopyProvider","sap/ui/core/date/UI5Date"],function(t,e,i,o,a,n,s,r,l,u,h,p,d,f,g,c,_,m,b,y,T,C,S,v,P,I,E,M,D,x,F,B,A,w,V,R,O,L,U,N,W,H,k,K,z,G,Q,j,q,$,X,Y,J,Z,tt,et,it,ot,at,nt,st,rt,lt,ut,ht,pt,dt,ft,gt,ct,_t,mt,bt,yt,Tt,Ct,St){"use strict";const vt=t.ButtonType;const Pt=t.MenuButtonMode;const It=t.ToolbarDesign;const Et=t.ToolbarStyle;const Mt=t.IllustratedMessageType;const Dt=o.SortOrder;const xt=o.TitleLevel;const Ft=I.smarttable.InfoToolbarBehavior;const Bt=I.smarttable.TableType;var At=v.extend("sap.ui.comp.smarttable.SmartTable",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smarttable/SmartTable.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},initiallyVisibleFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},tableType:{type:"sap.ui.comp.smarttable.TableType",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useColumnLabelsAsTooltips:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useExportToExcel:{type:"boolean",group:"Misc",defaultValue:true},enableExport:{type:"boolean",group:"Misc",defaultValue:true},exportType:{type:"sap.ui.comp.smarttable.ExportType",group:"Misc",defaultValue:"UI5ClientPDF"},enableCopy:{type:"boolean",group:"Misc",defaultValue:true},useTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},customizeConfig:{type:"object",group:"Misc",defaultValue:null},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:xt.Auto},headerStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance"},toolbarStyleClass:{type:"string",group:"Misc",defaultValue:null},enableCustomFilter:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},useOnlyOneSolidToolbar:{type:"boolean",group:"Misc",defaultValue:false},placeToolbarInTable:{type:"boolean",group:"Misc",defaultValue:false},currentVariantId:{type:"string",group:"Misc",defaultValue:null},editable:{type:"boolean",group:"Misc",defaultValue:false},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},tableBindingPath:{type:"string",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},demandPopin:{type:"boolean",group:"Misc",defaultValue:false},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false},initialNoDataText:{type:"string",group:"Misc",defaultValue:null},useInfoToolbar:{type:"sap.ui.comp.smarttable.InfoToolbarBehavior",group:"Behavior",defaultValue:Ft.Auto},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false},detailsButtonSetting:{type:"sap.ui.core.Priority[]",group:"Behavior"},enableAutoColumnWidth:{type:"boolean",group:"Misc",defaultValue:false},showPasteButton:{type:"boolean",group:"Behavior",defaultValue:false},enablePaste:{type:"boolean",group:"Behavior",defaultValue:true},useDateRangeType:{type:"boolean",group:"Misc",defaultValue:false},showDetails:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{customToolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},noData:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},semanticKeyAdditionalControl:{type:"sap.ui.core.Control",multiple:false},dataStateIndicator:{type:"sap.m.plugins.DataStateIndicator",multiple:false},copyProvider:{type:"sap.m.plugins.CopyProvider",multiple:false},filterControlConfiguration:{type:"sap.ui.comp.config.FilterControlConfiguration",multiple:true}},events:{initialise:{},beforeRebindTable:{},editToggled:{},dataRequested:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"},variantContext:{type:"string"}}},showOverlay:{},fieldChange:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},beforeExport:{allowPreventDefault:true,parameters:{exportSettings:{type:"object"},userExportSettings:{type:"object"},filterSettings:{type:"object[]"}}},beforePaste:{allowPreventDefault:true,parameters:{columnInfos:{type:"sap.ui.comp.smarttable.ColumnInfoForPaste[]"},rawData:{type:"string[][]"}}},paste:{parameters:{result:{type:"object"}}},uiStateChange:{},changeModelValue:{}}},renderer:{apiVersion:2},constructor:function(){this._oTableReady=function(){var t={};t.promise=new Promise(function(e){t.resolve=e});return t}();v.apply(this,arguments);this._aExistingColumns=[];this._aAlwaysSelect=[];this._oTemplate=null;this._mFieldMetadataByKey={};this._createToolbar();this._updateP13nDialogSettings();this._createTable();this.attachModelContextChange(this._initialiseMetadata,this)}});At.prototype._getP13nDialogSettings=function(){var t=this.data("p13nDialogSettings");if(typeof this._oP13nDialogSettings==="string"){try{t=JSON.parse(this._oP13nDialogSettings)}catch(e){t=null;$.error("Assigned p13nDialogSettings is not a valid JSON object")}}return t};["DataStateIndicator","CopyProvider","CellSelector"].forEach(t=>{At.prototype[`get${t}PluginOwner`]=function(){return this._oTable||this._oTableReady?.promise}});At.prototype.setDataStateIndicator=function(t){this._handeDataStateEvents(this.getDataStateIndicator(),"detach");this.setAggregation("dataStateIndicator",t,true);this._handeDataStateEvents(this.getDataStateIndicator(),"attach");return this};At.prototype.setCopyProvider=function(t){this.setAggregation("copyProvider",t,true);if(window.isSecureContext&&t&&this._bToolbarInsertedIntoItems){this._createToolbarContent()}this._updateCopy();return this};At.prototype.insertDependent=function(t,e){if(this._oCellSelector&&this.indexOfDependent(this._oCellSelector)>=0){this.removeAggregation("dependents",this._oCellSelector)}v.prototype.insertAggregation.apply(this,arguments);this._updateCopy();return this};At.prototype.addDependent=function(t){if(this._oCellSelector&&this.indexOfDependent(this._oCellSelector)>=0){this.removeAggregation("dependents",this._oCellSelector)}v.prototype.addDependent.apply(this,arguments);this._updateCopy();return this};At.prototype.removeDependent=function(t){var e=v.prototype.removeDependent.apply(this,arguments);this._updateCopy();return e};At.prototype.removeAllDependents=function(){var t=v.prototype.removeAllDependents.apply(this,arguments);this._updateCopy();return t};At.prototype.destroyDependents=function(){v.prototype.destroyDependents.apply(this,arguments);this._updateCopy();return this};At.prototype.setEnableCopy=function(t){this.setProperty("enableCopy",t,true);this._updateCopy();return this};At.prototype._updateCopy=function(){if(this.isDestroyed()||this.isDestroyStarted()){return}const t=this.getCopyProvider();const e=Tt.findOn(this);const i=this.getEnableCopy();if(i&&!t&&!e){if(!this._oCopyProvider||this._oCopyProvider.isDestroyed()){this._oCopyProvider=new Ct(this.getId()+"-cp")}if(!this._oCellSelector||this._oCellSelector.isDestroyed()){this._oCellSelector=new Tt(this.getId()+"-cs")}this.setCopyProvider(this._oCopyProvider);this.addDependent(this._oCellSelector)}else if(!i||t&&t!==this._oCopyProvider||e&&e!==this._oCellSelector){if(this._oCopyProvider&&t===this._oCopyProvider){this.setCopyProvider(null)}if(this._oCellSelector&&e===this._oCellSelector){this.removeDependent(this._oCellSelector)}}};At.prototype.getColumnClipboardSettings=function(t){var e=t.data("p13nData");var i=this._getColumnLeadingProperty(t,e);if(!e||!i){return null}var o,a;var n=[i];var s="{0}";if(e.unit){s="{0} {1}";n.push(e.unit);a=W[e.isCurrency?"getAmountCurrencyFormatter":"getMeasureUnitFormatter"](this._bPreserveDecimals)}else{o=e.typeInstance||(this._oTableProvider.getFieldMetadata(i)||{}).modelType;if(e.description&&e.displayBehaviour!=="idOnly"){if(e.displayBehaviour==="descriptionOnly"){n=[e.description]}else{s=W.getFormattedExpressionFromDisplayBehaviour(e.displayBehaviour,"{0}","{1}");n.push(e.description)}}}return{types:[o],properties:n,unitFormatter:a,template:s}};At.prototype.setCustomizeConfig=function(t){this.setProperty("customizeConfig",t,true);return this};At.prototype.setUseExportToExcel=function(t){var e=this.getUseExportToExcel();this.setProperty("useExportToExcel",t,true);if(e!==this.getUseExportToExcel()){this.setEnableExport(t)}return this};(()=>{At.prototype.setEnableExport=function(t){var e=this.getEnableExport();this.setProperty("enableExport",t,true);if(e!==this.getEnableExport()){this.setUseExportToExcel(t)}return this}})();At.prototype._validateCustomizeConfig=function(t){if(!t){return}if(t.isA){$.error("Invalid config property. Provided configuration has been deleted from the customizeConfig property - "+this.getId());this.setCustomizeConfig(null);return}for(var e in t){switch(e){case"textInEditModeSource":this._validateTextInEditModeSource(t);break;case"ignoreInsertRestrictions":this._validateIgnoreInsertRestrictions(t);break;case"autoColumnWidth":this._validateAutoColumnWidth(t);break;case"clientSideMandatoryCheck":this._validateClientSideMandatoryCheck(t);break;default:$.error(e+" is not a supported configuration for the customizeConfig property - "+this.getId());delete t[e];break}}};At.prototype._validateTextInEditModeSource=function(t){if(this._validateCustomizeConfigObjectType(t["textInEditModeSource"])){delete t.textInEditModeSource;$.error("Invalid config property textInEditModeSource. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["textInEditModeSource"],Object.keys(I.smartfield.TextInEditModeSource),"textInEditModeSource")};At.prototype._validateCustomizeConfigObjectType=function(t){if(typeof t!=="object"||!Object.keys(t).length||t.isA){return true}return false};At.prototype._checkAllowedValuesForCustomizeConfig=function(t,e,i){for(var o in t){if(!e.includes(t[o])){$.error(`Invalid config property '${o}' for the ${i} property of the customizeConfig - ${this.getId()}`);delete t[o]}}};At.prototype._validateIgnoreInsertRestrictions=function(t){if(this._validateCustomizeConfigObjectType(t["ignoreInsertRestrictions"])){delete t.ignoreInsertRestrictions;$.error("Invalid config property ignoreInsertRestrictions. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["ignoreInsertRestrictions"],[true,false],"ignoreInsertRestrictions")};At.prototype._validateClientSideMandatoryCheck=function(t){if(this._validateCustomizeConfigObjectType(t["clientSideMandatoryCheck"])){delete t.clientSideMandatoryCheck;$.error("Invalid config property clientSideMandatoryCheck. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["clientSideMandatoryCheck"],[true,false],"clientSideMandatoryCheck")};At.prototype._validateAutoColumnWidth=function(t){if(!this.getEnableAutoColumnWidth()&&t.hasOwnProperty("autoColumnWidth")){delete t.autoColumnWidth;$.error("The autoColumnWidth property is deleted from the customizeConfig, since enableAutoColumnWidth=false on the SmartTable - "+this.getId())}if(this._validateCustomizeConfigObjectType(t["autoColumnWidth"])){delete t.autoColumnWidth;$.error("Invalid config property autoColumnWidth. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}if(typeof t["autoColumnWidth"]==="boolean"||typeof t["autoColumnWidth"]==="object"){var e=t["autoColumnWidth"];for(var i in e){if(typeof e[i]==="boolean"){continue}if(typeof e[i]!=="object"){$.error(`Expected 'object' or 'boolean', instead ${typeof e[i]} was passed for '${i}' autoColumnWidth customizeConfig property - ${this.getId()}`);delete e[i];continue}var o=e[i];for(var a in o){var n=null;switch(a){case"truncateLabel":n=typeof o[a];if(n!=="boolean"){$.error("The "+a+" property must be of type boolean, instead "+n+" was passed - "+this.getId());delete o[a]}break;case"min":case"max":case"gap":n=typeof o[a];if(n!=="number"){$.error("The "+a+" property must be of type number, instead "+n+" was passed - "+this.getId());delete o[a]}break;default:$.error(`Invalid config property '${a}' for the autoColumnWidth property of the customizeConfig - ${this.getId()}`);delete o[a]}}}}};At.prototype._handeDataStateEvents=function(t,e){if(t){t[e+"ApplyFilter"](this._onApplyMessageFilter,this);t[e+"ClearFilter"](this._onClearMessageFilter,this);t[e+"Event"]("filterInfoPress",this._handleInfoToolbarPress,this)}};At.prototype.setHeaderLevel=function(t){if(this.getHeaderLevel()===t){return this}this.setProperty("headerLevel",t,true);this._headerText?.setLevel(t);this._updateVariantManagement();return this};At.prototype.setHeaderStyle=function(t){if(this.getHeaderStyle()===t){return this}this.setProperty("headerStyle",t,true);this._headerText?.setTitleStyle(t||xt[nt.get({name:"_sap_ui_comp_SmartTable_HeaderStyle"})]);this._updateVariantManagement();return this};At.prototype._getP13nFilterMessageStrip=function(){var e,o;if(this._oMessageFilter){o=i.getResourceBundleFor("sap.ui.comp");e=new ot({text:o.getText("SMARTTABLE_P13N_FILTER_MESSAGESTRIP"),link:new it({text:o.getText("SMARTTABLE_MESSAGESTRIP_CLEAR_FILTER"),reactiveAreaMode:t.ReactiveAreaMode.Overlay,press:[function(){this._fnClearMessageFilter();e.setVisible(false)},this]})})}return e};At.prototype._onApplyMessageFilter=function(t){this._fnClearMessageFilter=t.getParameter("revert");this._oMessageFilter=t.getParameter("filter");t.preventDefault();this._reBindTable()};At.prototype._onClearMessageFilter=function(t){this._oMessageFilter=null;t.preventDefault();this._reBindTable()};At.prototype.init=function(){v.prototype.init.call(this);this.addStyleClass("sapUiCompSmartTable");this.setFitContainer(true);this._aColumnKeys=[];this._aDeactivatedColumns=[];this._mLazyColumnMap={};this._mMenuShowEntryMap=new window.WeakMap};At.prototype._getVariantManagementControl=function(t){var i=null;if(t){if(typeof t==="string"){i=e.getElementById(t)}else{i=t}if(i){if(!(i instanceof M)){$.error("Control with the id="+t.getId?t.getId():t+" not of expected type");return null}}}return i};At.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||!this.getUseVariantManagement()&&!this.getUseTablePersonalisation()||!this.getPersistencyKey()){return}var t=new Q({type:"table",keyName:"persistencyKey",dataSource:"TODO"});t.setControl(this);var e=this.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){e=this._oSmartFilter.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}}else{this._oVariantManagement=new M(this.getId()+"-variant",{showShare:true})}if(this._oVariantManagement){this._oVariantManagement.addPersonalizableControl(t);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this);this._updateVariantManagement()}};At.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD"}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding()}};At.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}};At.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()})};At.prototype.setTableBindingPath=function(t){this.setProperty("tableBindingPath",t,true);return this};At.prototype.setTableType=function(t){if(this.getTableType()===t){return this}if(this._bInitialising){throw new Error("tableType changed while SmartTable control was initializing - "+this.getId())}if(this.getTable()){$.error("The inner table is already created. Changing the table type is not supported.");return this}this.setProperty("tableType",t);return this};At.prototype.setShowTablePersonalisation=function(t){this.setProperty("showTablePersonalisation",t,true);if(this._oTablePersonalisationButton){this._oTablePersonalisationButton.setVisible(t)}return this};At.prototype.setUseVariantManagement=function(t){this.setProperty("useVariantManagement",t,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!t)}return this};At.prototype.setShowVariantManagement=function(t){this.setProperty("showVariantManagement",t,true);if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(t);if(this._oSeparator){this._oSeparator.setVisible(t)}}return this};At.prototype.setToolbarStyleClass=function(t){this.setProperty("toolbarStyleClass",t,true);return this};At.prototype.setCustomToolbar=function(t){this._oCustomToolbar=t;return this};At.prototype.getCustomToolbar=function(){return this._oCustomToolbar};At.prototype.setHeader=function(t){var e=this.getProperty("header"),i;this.setProperty("header",t,true);if(this.bIsInitialised&&this._oToolbar){i=!e===!t;if(!i){this._createToolbarContent()}else{this._refreshHeaderText()}}this._updateVariantManagement();return this};At.prototype.setShowRowCount=function(t){this.setProperty("showRowCount",t,true);this._refreshHeaderText();return this};At.prototype.setEditable=function(t){if((t=!!t)==this.getEditable()){return this}this.setProperty("editable",t,true);if(this._oEditModel){this._oEditModel.setProperty("/editable",t)}if(this._oEditButton){this._oEditButton.setIcon(t?"sap-icon://display":"sap-icon://edit")}if(this._isOfType(Bt.ResponsiveTable)&&this._oTable?.setKeyboardMode){this._oTable.setKeyboardMode(t?"Edit":"Navigation")}this._updateVisibleColumnsWidthForEdit();return this};At.prototype.setDemandPopin=function(t){var e=this.getDemandPopin();if(e===t){return this}this.setProperty("demandPopin",t,true);if(this.bIsInitialised){if(t){this._updateColumnsPopinFeature()}else{this._deactivateColumnsPopinFeature()}}return this};At.prototype._refreshHeaderText=function(){if(!this._headerText){return}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=j.getFloatInstance()}var t;var e=this.getHeader();this._headerText.setVisible(!!e);if(this.getShowRowCount()){var i=this._getRowBinding();t=i?i.getCount():0;if(t>0){var o=this._oNumberFormatInstance.format(t);e+=" ("+o+")"}}this._headerText.setText(e);this._updateAriaLabelledByInfo();if(this._bDataLoadPending===false&&this._bUpdateTableAnnouncement){this._bUpdateTableAnnouncement=false;rt.announceTableUpdate(this.getHeader(),t)}};At.prototype._updateAriaLabelledByInfo=function(){var t=this._headerText.getId();if(this._oTable&&this._oTable.addAriaLabelledBy){if(this._headerText.getVisible()){if(this._oTable.getAriaLabelledBy().indexOf(t)===-1){this._oTable.addAriaLabelledBy(t)}}else{this._oTable.removeAriaLabelledBy(t)}}};At.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton)}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new C(this.getId()+"-btnFullScreen",{press:[function(){this._toggleFullScreen(!this.bFullScreen)},this]});this._oFullScreenButton.addStyleClass("sapUiCompSmartTableToolbarContent");if(q.system.phone){this._oFullScreenButton.setLayoutData(new y({priority:"NeverOverflow"}))}}this._renderFullScreenButton();this._oToolbar.addContent(this._oFullScreenButton)}};At.prototype._addCopyButton=function(){var t=this.getId()+"-btnCopy";var i=e.getElementById(t);if(i){this._oToolbar.removeContent(i)}var o=this.getCopyProvider();if(o&&window.isSecureContext){if(!i){i=o.getCopyButton({id:t});i.addStyleClass("sapUiCompSmartTableToolbarContent")}this._oToolbar.addContent(i)}};At.prototype._addPasteButton=function(){var t=this.getId()+"-btnPaste";var i=e.getElementById(t);if(i){this._oToolbar.removeContent(i)}if(this.getShowPasteButton()){if(!i){i=new C(t);bt.setSemanticStepname(i,"press","sc:tbl:paste");i.addStyleClass("sapUiCompSmartTableToolbarContent");sap.ui.require(["sap/m/plugins/PasteProvider"],function(t){i.addDependent(new t({pasteFor:this._oTable.getId()}))}.bind(this))}i.setEnabled(this.getEnablePaste());this._oToolbar.addContent(i)}};At.prototype._createToolbar=function(){var t=null;if(!this._oToolbar){t=this.getCustomToolbar();if(t){this._oToolbar=t}else{this._oToolbar=new b({design:It[nt.get({name:"_sap_ui_comp_SmartTable_ToolbarDesign"})],style:this._isOfType(Bt.ResponsiveTable)?Et.Standard:Et.Clear});this._oToolbar.addStyleClass("sapUiCompSmartTableToolbar");if(this.getToolbarStyleClass()){this._oToolbar.addStyleClass(this.getToolbarStyleClass())}}this._oToolbar.setLayoutData(new P({shrinkFactor:0}))}};At.prototype.setShowDetails=function(t){if(!this._isOfType(Bt.ResponsiveTable)||t===this.getProperty("showDetails")){return}if(this.getUseTablePersonalisation()){this._oPersController._setShowDetails(t)}else{this._setShowDetails(t)}};At.prototype._setShowDetails=function(t){this.setProperty("showDetails",t,true);if(this.getProperty("showDetails")){this._oTable.setHiddenInPopin([]);this._oShowHideDetailsButton?.setSelectedKey("showDetails")}else{this._oTable.setHiddenInPopin(this._getImportanceToHide());this._oShowHideDetailsButton?.setSelectedKey("hideDetails")}};At.prototype._getImportanceToHide=function(){var t=this.getDetailsButtonSetting()||[];var e=[];if(t.length){e=t}else{e=q.system.phone?["Low","Medium"]:["Low"]}return e};At.prototype._toggleFullScreen=function(t,e){if(!this._oFullScreenButton||t===this.bFullScreen&&!e){return}this.bFullScreen=t;H.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen);this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:t})};At.prototype._renderFullScreenButton=function(){var t=i.getResourceBundleFor("sap.ui.comp"),e;e=this.bFullScreen?t.getText("CHART_MINIMIZEBTN_TOOLTIP"):t.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(e);this._oFullScreenButton.setText(e);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};At.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar()}this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addCopyButton();this._addPasteButton();this._addEditTogglableToToolbar();this._addShowHideDetailsButton();this._addTablePersonalisationToToolbar();this._addExportToExcelToToolbar();this._addFullScreenButton();this._bToolbarInsertedIntoItems=true;this._placeToolbar()};At.prototype._applyToolbarContentOrder=function(){if(!this.bIsInitialised||!this.getCustomToolbar()){return}var t=this.data("p13nData_ToolbarContentMove");if(!t){return}t=_t.parseChangeContent(t,function(t){this.data("p13nData_ToolbarContentMove",t)}.bind(this));if(!t||!t.order){return}var e=_t.getAppComponentForControl(this)||null;var i=-1;var o=t.order;var a=[];var n=this._oToolbar.getContent();for(let t=0;t<o.length;t++){for(let s=0;s<n.length;s++){if(o[t].id===_t.getSelectorForControl(n[s],e)?.id){if(i<0||i>s){i=s}a.push(n[s])}}}for(let t=0;t<a.length;t++){this._oToolbar.removeContent(a[t]);this._oToolbar.insertContent(a[t],i);i++}};At.prototype._placeToolbar=function(){if(!this.getPlaceToolbarInTable()){this.insertItem(this._oToolbar,0)}else if(this._isOfType(Bt.ResponsiveTable)){this._oTable.setHeaderToolbar(this._oToolbar)}else{this._oTable.addExtension(this._oToolbar)}};At.prototype.getToolbar=function(){return this._oToolbar};At.prototype._addEditTogglableToToolbar=function(){var t;if(this._oEditButton){this._oToolbar.removeContent(this._oEditButton)}if(this.getEditTogglable()){if(!this._oEditButton){t=i.getResourceBundleFor("sap.ui.comp").getText("TABLE_EDITTOGGLE_TOOLTIP");this._oEditButton=new C(this.getId()+"-btnEditToggle",{icon:this.getEditable()?"sap-icon://display":"sap-icon://edit",text:t,tooltip:t,press:[function(){var t=this.getEditable();t=!t;this.setEditable(t,true);this.fireEditToggled({editable:t})},this]});this._oEditButton.addStyleClass("sapUiCompSmartTableToolbarContent");bt.setSemanticStepname(this._oEditButton,"press","sc:tbl:edit")}this._oToolbar.addContent(this._oEditButton)}};At.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText)}if(!this._headerText){this._headerText=new m(this.getId()+"-header");this._headerText.addStyleClass("sapUiCompSmartTableHeader");this._headerText.addStyleClass("sapUiCompSmartTableToolbarContent");this._headerText.setLevel(this.getHeaderLevel());this._headerText.setTitleStyle(this.getHeaderStyle()||xt[nt.get({name:"_sap_ui_comp_SmartTable_HeaderStyle"})])}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)};At.prototype._addSeparatorToToolbar=function(){if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator)}if(this.getHeader()&&this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(!this._oSeparator){this._oSeparator=new S(this.getId()+"-toolbarSeperator");if(!this.getShowVariantManagement()){this._oSeparator.setVisible(false)}this._oSeparator.addStyleClass("sapUiCompSmartTableToolbarContent")}this._oToolbar.insertContent(this._oSeparator,0)}if(this._oToolbar){this._oToolbar.addStyleClass("sapMTBHeader-CTX")}};At.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oToolbar.removeContent(this._oVariantManagement);if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0);this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContent");this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContentAllowAdaption");if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement())}}}};At.prototype._addSpacerToToolbar=function(){var t=false,e=this._oToolbar.getContent(),i,o;if(e){o=e.length;i=0;for(i;i<o;i++){if(e[i]instanceof T){t=true;break}}}if(!t){this._oToolbar.addContent(new T(this.getId()+"-toolbarSpacer").addStyleClass("sapUiCompSmartTableToolbarContent"))}};At.prototype._createShowHideDetailsButton=function(){var t=i.getResourceBundleFor("sap.ui.comp");this._oShowHideDetailsButton=new lt(this.getId()+"-btnShowHideDetails",{visible:false,items:[new ut({icon:"sap-icon://detail-more",key:"showDetails",tooltip:t.getText("TABLE_SHOWDETAILS_TEXT"),press:[function(){this.setShowDetails(true)},this]}),new ut({icon:"sap-icon://detail-less",key:"hideDetails",tooltip:t.getText("TABLE_HIDEDETAILS_TEXT"),press:[function(){this.setShowDetails(false)},this]})]});this._oShowHideDetailsButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oShowHideDetailsButton.setSelectedKey("hideDetails")};At.prototype._addShowHideDetailsButton=function(){if(this._oShowHideDetailsButton){this._oToolbar.removeContent(this._oShowHideDetailsButton)}if(this.getShowDetailsButton()&&this._isOfType(Bt.ResponsiveTable)){if(!this._oShowHideDetailsButton){this._createShowHideDetailsButton()}this._oToolbar.addContent(this._oShowHideDetailsButton)}};At.prototype._addTablePersonalisationToToolbar=function(){var t;if(this._oTablePersonalisationButton){this._oToolbar.removeContent(this._oTablePersonalisationButton)}if(this.getUseTablePersonalisation()){if(!this._oTablePersonalisationButton){t=i.getResourceBundleFor("sap.ui.comp").getText("TABLE_PERSOBTN_TOOLTIP");this._oTablePersonalisationButton=new C(this.getId()+"-btnPersonalisation",{icon:"sap-icon://action-settings",text:t,tooltip:t,press:[function(t){if(!this._bPersDialogOpen){this._bPersDialogOpen=true;this._bMissingColumnsCreated=true;this._oPersController.openDialog()}},this]});n.addConfig(this._oTablePersonalisationButton,{messageBundleKey:q.os.macintosh?"SMARTTABLE_SHORTCUT_SHOW_SETTINGS_MAC":"SMARTTABLE_SHORTCUT_SHOW_SETTINGS"},this);this._oTablePersonalisationButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oTablePersonalisationButton.setVisible(this.getShowTablePersonalisation());bt.setSemanticStepname(this._oTablePersonalisationButton,"press","sc:tbl:p13n")}this._oToolbar.addContent(this._oTablePersonalisationButton)}};At.prototype._triggerGWExport=function(){var t=i.getResourceBundleFor("sap.ui.comp");var e=function(){var t=this._getRowBinding();var e=t.getDownloadUrl("xlsx");e=this._removeExpandParameter(e);var i={url:e};this.fireBeforeExport({exportSettings:i});at(i.url)}.bind(this);var o=this._getRowBinding();var a=o?o.getCount():0;if(a>1e4){g.confirm(t.getText("DOWNLOAD_CONFIRMATION_TEXT",[a]),{actions:[g.Action.YES,g.Action.NO],emphasizedAction:g.Action.YES,onClose:function(t){if(t===g.Action.YES){e()}}})}else{e()}};At.prototype._addExportToExcelToToolbar=function(){if(this._oExportButton){this._oToolbar.removeContent(this._oExportButton)}if(!this.getEnableExport()){return}if(!this._oExportButton){var t=this.getId()+"-btnExcelExport";var e="sap-icon://excel-attachment";var o=i.getResourceBundleFor("sap.ui.comp");if(this.getExportType().indexOf("UI5Client")>-1){this._oExportButton=this._createClientExportButton(t,e)}else if(this._bTableSupportsExcelExport&&this.getExportType()=="GW"){var a;a=o.getText("TABLE_EXPORT_TEXT");this._oExportButton=new C(t,{icon:e,text:a,tooltip:a,press:[this._triggerGWExport,this]});bt.setSemanticStepname(this._oExportButton,"press","OI:QE")}this._setExcelExportEnableState();if(this._oExportButton){this._oExportButton.addStyleClass("sapUiCompSmartTableToolbarContent")}}this._oToolbar.addContent(this._oExportButton)};At.prototype._createClientExportButton=function(t,e){var o=i.getResourceBundleFor("sap.ui.comp");var a={fileName:this.getHeader()};if(!this._cachedExcelSettings){this._cachedExcelSettings=a}var s=new Z(t,{icon:e,tooltip:o.getText("TABLE_EXPORT_TEXT"),type:vt[nt.get({name:"_sap_ui_comp_SmartTable_ExportButton"})],buttonMode:Pt.Split,useDefaultActionOnly:true,text:o.getText("QUICK_EXPORT"),defaultAction:[function(){this._triggerUI5ClientExport()},this],menu:[new J({items:[new tt({text:o.getText("QUICK_EXPORT"),press:[function(){this._triggerUI5ClientExport()},this]}),new tt({text:o.getText("EXPORT_WITH_SETTINGS"),press:[function(){this._triggerUI5ClientExport(true)},this]})]})]});bt.setSemanticStepname(s,"defaultAction","OI:QE");bt.setSemanticStepname(s.getMenu().getItems()[0],"press","OI:QE");bt.setSemanticStepname(s.getMenu().getItems()[1],"press","OI:EXP:SETTINGS");n.addConfig(s._getButtonControl(),{addAccessibilityLabel:true,messageBundleKey:q.os.macintosh?"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL_MAC":"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL"},this);return s};At.prototype.onkeydown=function(t){if(t.isMarked()){return}if((t.metaKey||t.ctrlKey)&&t.shiftKey&&t.which===r.E){if(this.getEnableExport()&&this.getExportType().indexOf("UI5Client")>-1&&this._oExportButton&&this._oExportButton.getEnabled()){this._triggerUI5ClientExport(true);t.setMarked();t.preventDefault()}}else if((t.metaKey||t.ctrlKey)&&t.which===r.COMMA){if(this.getUseTablePersonalisation()&&this._oTablePersonalisationButton&&this._oTablePersonalisationButton.getVisible()){this._oPersController.openDialog();t.setMarked();t.preventDefault()}}};At.prototype.onThemeChanged=function(){if(this._oExportButton){const t=vt[nt.get({name:"_sap_ui_comp_SmartTable_ExportButton"})];this._oExportButton.setType(t)}if(this._oToolbar){const t=It[nt.get({name:"_sap_ui_comp_SmartTable_ToolbarDesign"})];this._oToolbar.setDesign(t)}if(this._headerText&&!this.getHeaderStyle()){const t=xt[nt.get({name:"_sap_ui_comp_SmartTable_HeaderStyle"})];this._headerText.setTitleStyle(t);this._updateVariantManagement()}};At.prototype._getColumnLabel=function(t){var e,i;if(typeof t==="string"){e=t;t=this._getColumnByKey(e)}if(!t){var o=this._oTableProvider.getFieldLabel(this.getEntitySet(),e);if(o&&o.match(/{@i18n>.+}/gi)){var a=this.getModel("@i18n");if(a&&a.isA("sap.ui.model.resource.ResourceModel")){return a.getProperty(o.slice(1,-1).substring(6))||o}}if(!o){var n=this._mFieldMetadataByKey[e];if(n){o=n.label}}return o}if(t.getLabel){i=t.getLabel()}else if(t.getHeader){i=t.getHeader()}return i&&i.getText?i.getText():null};At.prototype._getColumnLeadingProperty=function(t,e){var i;if(t.getLeadingProperty){i=t.getLeadingProperty()}if(!i){var o=e||t.data("p13nData");if(o){i=o["leadingProperty"]}}return i};At.prototype.triggerExport=function(){if(!this.getEnableExport()){return Promise.reject("Export is not enabled for this table - "+this.getId())}return this._triggerUI5ClientExport(false,true)};At.prototype._triggerUI5ClientExport=async function(t,e=false){const o=this._createExportColumnConfiguration();if(!o||!o.length){const t=i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_COLS_EXPORT");if(!e){g.error(t,{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""})}return Promise.reject(t)}const a=this._getRowBinding();const n=this._getColumnLabel.bind(this);const s={workbook:{columns:o,context:{title:this.getHeader()}},dataSource:a,fileName:this.getHeader()};const r=t=>{var e=t.getParameter("filterSettings");e.forEach(t=>{var e=t.getProperty();var i=this._getColumnByKey(e)||this._getColumnFromP13nMap(e);t.setLabel(n(e));if(i?.data("p13nData")){t.setType(i.data("p13nData").typeInstance)}});const i=this.fireBeforeExport({exportSettings:t.getParameter("exportSettings"),userExportSettings:t.getParameter("userExportSettings"),filterSettings:e});if(!i){t.preventDefault()}};if(!this._oExportHandler){const t=await this._loadExportHandler();const e=this._oTableProvider.getExportCapabilities(this.getExportType());const i=new t(e);i.attachBeforeExport(r);this._oExportHandler=i}const l=(t?this._oExportHandler.exportAs:this._oExportHandler.export).bind(this._oExportHandler);return l(s,n)};At.prototype._loadExportHandler=function(){return i.load({name:"sap.ui.export"}).then(()=>new Promise((t,e)=>{sap.ui.require(["sap/ui/export/ExportHandler"],i=>{if(i){t(i)}else{e(new Error("Failed to load ExportHandler"))}})})).catch(()=>{const t=i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_ERROR_MISSING_EXPORT_LIBRARY");g.error(t);throw new Error(t+" - "+this.getId())})};At.prototype._createExportColumnConfiguration=function(){const t=[];const e=this.data("useUTCDateTime");let i;if(e!=null){if(typeof e==="string"){i=e==="true"}else if(typeof e==="boolean"){i=e}}const o=this._oTable.getColumns(this._isOfType(Bt.ResponsiveTable));o.filter(t=>t.getVisible()).forEach(e=>{const o=this._getExportColumnConfiguration(e,i);if(o){t.push(o)}});return t};At.prototype._getExportColumnConfiguration=function(t,e){let i=this._getColumnLeadingProperty(t);if(Array.isArray(i)){i=i[0]}if(!i){return undefined}const o=t.data("p13nData");const a=this._getColumnLabel(t);const n=t.getWidth().toLowerCase()||o.width;let s=o.typeInstance;let r=o.type==="numeric"?"Number":o.type;let l,u,h,p;if(o.unit){r=o.isCurrency?"Currency":"Number";p=o.unit}else if(s&&(s.isA("sap.ui.comp.odata.type.FiscalDate")||s.isA("sap.ui.comp.odata.type.CalendarDate"))){var d=s.getFormatter();u=d.getTemplate().replace(/\$(\d)/g,(t,e)=>`{${parseInt(e)-1}}`);l=d.getRegExPattern().toString().slice(1,-1);r="String"}else if(r!="date"&&z.isDateOrTime(o.edmType)){r=z.getTypeName(o.edmType);if(r==="DateTimeOffset"){r="DateTime";e=false;if(o.timezone){h=o.timezone}else if(this._aExistingColumns.includes(i)&&typeof o.additionalProperty==="string"){[h]=o.additionalProperty.split(",")}}}else if(r==="stringdate"){r="Date";l="YYYYMMDD"}else if(r==="boolean"){r="Boolean";s=s?s:z.getType(o.edmType)}else if(o.description&&o.displayBehaviour!=="idOnly"){r="String";u=W.getFormattedExpressionFromDisplayBehaviour(o.displayBehaviour,"{0}","{1}");if(o.displayBehaviour==="descriptionOnly"){i=o.description}else{i=[i,o.description]}}else if(o.isDigitSequence){r="Number"}else if(o.isTimezone){r="Timezone"}else if(r){r=r.slice(0,1).toUpperCase()+r.slice(1)}else{r="String"}return{columnId:t.getId(),property:i,type:r,inputFormat:l,label:a,width:n,textAlign:t.getHAlign(),template:u,trueValue:r==="Boolean"&&s?s.formatValue(true,"string"):undefined,falseValue:r==="Boolean"&&s?s.formatValue(false,"string"):undefined,unitProperty:p,displayUnit:r==="Currency"?true:undefined,precision:o.precision,scale:o.scale,autoScale:r==="Number",utc:r==="DateTime"&&e!=null?e:undefined,timezoneProperty:h}};At.prototype._removeExpandParameter=function(t){var e=t.replace(new RegExp("([\\?&]\\$expand=[^&]+)(&?)"),function(t,e,i){return i?e.substring(0,1):""});return e};At.prototype._setExcelExportEnableState=function(){this._oExportButton?.setEnabled(!this._bDataLoadPending&&rt.isExportable(this._getRowBinding()))};At.prototype._createPersonalizationController=function(){if(this._oPersController||!this.getUseTablePersonalisation()){return}var t=this._oP13nDialogSettings;t=this._setIgnoreFromPersonalisationToSettings(t);t=t||{};if(this._isOfType(Bt.TreeTable)){t.stableColumnKeys=[];t.stableColumnKeys.push(this._aColumnKeys[0])}if(this._bIsFilterPanelEnabled){t.filter=t.filter?t.filter:{};t.filter.createMessageStrip=this._getP13nFilterMessageStrip.bind(this)}this._oPersController=new L(this.getId()+"-persoController",{table:this._oTable,columnKeys:this._aColumnKeys,redundantColumnKeys:k.getRedundantProperties(this),setting:t,resetToInitialTableState:!this.getUseVariantManagement(),beforePotentialTableChange:[this._beforePersonalisationModelDataChange,this],afterPotentialTableChange:[this._afterPersonalisationModelDataChange,this],afterP13nModelDataChange:[this._personalisationModelDataChange,this],requestColumns:[this._personalisationRequestColumns,this]});this._oPersController.attachDialogAfterClose(function(t){if(this._fGetDataForKeyUser){if(t.getParameter("cancel")){this._fGetDataForKeyUser([])}this._cleanUpKeyUser()}this._bPersDialogOpen=false}.bind(this));if(this._aDeactivatedColumns.length>0){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns)}};At.prototype.getVariantManagement=function(){return this._oVariantManagement};At.prototype.openDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;return this._oPersController.openDialog({showReset:false,useAvailablePanels:true,styleClass:t}).then(function(t){if(t){return i.load({name:"sap.ui.mdc"}).then(function(){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder"],function(e){return e.addRTACustomFieldButton(t,this)}.bind(this))}.bind(this))}}.bind(this))};At.prototype._cleanUpKeyUser=function(){this._fGetDataForKeyUser=null};At.prototype._createKeyUserChange=function(){return[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]};At.prototype._setIgnoreFromPersonalisationToSettings=function(t){var e=U.createArrayFromString(this.getIgnoreFromPersonalisation());if(e.length){if(!t){t={}}var i=function(i){if(!t[i]){t[i]={}}t[i].ignoreColumnKeys=e};i("filter");i("sort");i("group");i("columns")}return t};At.prototype._getRowBinding=function(){return this._oTable?.getBinding(this._sAggregation)};At.prototype.setEntitySet=function(t){if(this.getEntitySet()===t){return this}if(this._bInitialising){throw new Error("entitySet changed while SmartTable control was initializing - "+this.getId())}this.setProperty("entitySet",t,true);this._initialiseMetadata();return this};At.prototype._initialiseMetadata=function(t){var e=this,i=e;if(t){i=t.getSource()}if(!i.bIsInitialised){K.handleModelInit(i,i._onMetadataInitialised,[{selector:i},{selector:i._oTable,changeTypes:["addXML","addXMLAtExtensionPoint"]}])}};function wt(t){var e=Object.assign({},t);delete e.binding;delete e.modelChangeHandler;delete e.dataStateChangeHandler;delete e.modelRefreshHandler;return e}At.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(this.bIsInitialised){return}this._bUseColumnLabelsAsTooltips=this.getUseColumnLabelsAsTooltips();this._updateInitialColumns();this._fireBeforeInitialiseAndValidate();this._validateCustomizeConfig(this.getCustomizeConfig());this._createTableProvider();if(!this._oTableProvider){return}this._aTableViewMetadata=this._oTableProvider.getTableViewMetadata();if(!this._aTableViewMetadata){return}if(this._bUseColumnLabelsAsTooltips){this._oTable.getColumns().forEach(function(t){var e=null;if(t.getHeader){e=t.getHeader()}else if(t.getLabel){e=t.getLabel()}var i=e&&e.isA&&(e.isA("sap.m.Label")||e.isA("sap.m.Text"))?e:null;var o=this._isOfType(Bt.ResponsiveTable)?i:t;var a=o?o.getTooltip():null;if(o&&i&&!a&&!o.isBound("tooltip")){if(i.isBound("text")){var n=wt(i.getBindingInfo("text"));o.bindProperty("tooltip",n)}else{o.setTooltip(i.getText())}}},this)}if(this.getEnableAutoColumnWidth()){this._oTable.getColumns().forEach(this._setWidthForCustomColumn,this)}if(!this._isOfType(Bt.ResponsiveTable)&&this.getDemandPopin()){this.setDemandPopin(false);$.error("use SmartTable property 'demandPopin' only  with responsive table, property has been set to false")}this.detachModelContextChange(this._initialiseMetadata,this);this.bIsInitialised=true;delete this._bInitialising;this._updateP13nDialogSettings(true);this._bTableSupportsExcelExport=this._oTableProvider.getSupportsExcelExport();this._bMultiUnitBehaviorEnabled=this._oTableProvider.getMultiUnitBehaviorEnabled();this._listenToSmartFilter();this._createVariantManagementControl();this._createToolbarContent();this._applyToolbarContentOrder();this._aAlwaysSelect=this._oTableProvider.getRequestAtLeastFields();this._createContent();this._createPersonalizationController();this._oEditModel=new B({editable:this.getEditable()});this.setModel(this._oEditModel,"sm4rtM0d3l");this.attachEvent("_change",this._onPropertyChange,this);this.fireInitialise();if(!this._oVariantManagement||this._oVariantManagement&&this._bVariantInitialised){this._checkAndTriggerBinding()}this._updateCopy()};At.prototype._fireBeforeInitialiseAndValidate=function(){if(!this.hasListeners("beforeInitialise")){return}this._bInitialising=true;this.fireEvent("beforeInitialise");this._validateControlConfig();this._updateInitialColumns()};At.prototype._validateControlConfig=function(){var t=this.getItems();if(!t.length){throw new Error("Internals of the SmartTable control changed via beforeInitialise event - "+this.getId())}var e=t.find(function(t){return t.isA(["sap.m.Table","sap.ui.table.Table"])});if(!e){throw new Error("Inner Table removed via beforeInitialise event - "+this.getId())}if(e!==this._oTable){throw new Error("Inner table changed via beforeInitialise event for SmartTable - "+this.getId())}};At.prototype._updateP13nDialogSettings=function(t){this._oP13nDialogSettings=this._getP13nDialogSettings();this._bIsFilterPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.filter?this._oP13nDialogSettings.filter.visible!==false:true;this._bIsSortPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.sort?this._oP13nDialogSettings.sort.visible!==false:true;this._bIsGroupPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.group?this._oP13nDialogSettings.group.visible!==false:true;this._bIsColumnsPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.columns?this._oP13nDialogSettings.columns.visible!==false:true;if(t){this._attachTableCustomFilter()}};At.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){if(this._oSmartFilter.isInitialised()){this._oSmartFilter.search()}else{this._oSmartFilter.attachEventOnce("initialise",function(){this._oSmartFilter.search()},this)}}else{this._reBindTable()}}}};At.prototype._aStaticProperties=["entitySet","ignoredFields","initiallyVisibleFields","ignoreFromPersonalisation","tableType","useTablePersonalisation","enableAutoBinding","persistencyKey","smartFilterId","showDetailsButton","enableAutoColumnWidth","customizeConfig","useColumnLabelsAsTooltips"];At.prototype._aToolbarRelatedProperties=["enableExport","exportType","showFullScreenButton","showPasteButton","editTogglable","placeToolbarInTable"];At.prototype._onPropertyChange=function(t){var e=t.getParameter("name");if(this._aStaticProperties.indexOf(e)>-1){$.error("Property "+e+" cannot be changed after the SmartTable with id "+this.getId()+" is initialised")}if(this._oToolbar&&this._aToolbarRelatedProperties.indexOf(e)>-1){if(e==="exportType"&&this._oExportButton){this._oExportButton.destroy();this._oExportButton=null}this._createToolbarContent()}};At.prototype._createTableProvider=function(){var t,e,i,o,a;e=this.getEntitySet();i=this.getIgnoredFields();t=this.getModel();o=this.data("preserveDecimals");a=this.getCustomizeConfig();if(a){for(var n in a){this["_oCustomizeConfig"+n.charAt(0).toUpperCase()+n.slice(1)]=a[n]}}if(o!=null){if(o==false||typeof o==="string"&&o==="false"){this._bPreserveDecimals=false}else{this._bPreserveDecimals=true}}else{this._bPreserveDecimals=true}if(t&&e){if(this._aExistingColumns.length){if(i){i+=","+this._aExistingColumns.toString()}else{i=this._aExistingColumns.toString()}}this._oTableProvider=new E({entitySet:e,ignoredFields:i,initiallyVisibleFields:this.getInitiallyVisibleFields(),isEditableTable:this.getEditable(),smartTableId:this.getId(),isAnalyticalTable:this._isOfType(Bt.AnalyticalTable),isMobileTable:this._isOfType(Bt.ResponsiveTable),dateFormatSettings:this.data("dateFormatSettings"),useUTCDateTime:this.data("useUTCDateTime"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),useSmartToggle:this.data("useSmartToggle"),skipAnnotationParse:this.data("skipAnnotationParse"),lineItemQualifier:this.data("lineItemQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),enableInResultForLineItem:this.data("enableInResultForLineItem"),defaultFilterBarExpanded:this.data("defaultFilterBarExpanded"),defaultShowAllFilters:this.data("defaultShowAllFilters"),_semanticKeyAdditionalControl:this.getAggregation("semanticKeyAdditionalControl"),model:t,semanticObjectController:this.getSemanticObjectController(),showDetailsButton:this.getShowDetailsButton(),enableAutoColumnWidth:this.getEnableAutoColumnWidth(),preserveDecimals:this._bPreserveDecimals,textInEditModeSource:this._oCustomizeConfigTextInEditModeSource,ignoreInsertRestrictions:this._oCustomizeConfigIgnoreInsertRestrictions,clientSideMandatoryCheck:this._oCustomizeConfigClientSideMandatoryCheck})}};At.prototype._listenToSmartFilter=function(){const t=this.getSmartFilterId();this._oSmartFilter=this._findControl(t,"sap.ui.comp.filterbar.FilterBar");if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindTable,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this)}var e=i.getResourceBundleFor("sap.ui.comp"),o,a,n={SMARTTABLE_NO_DATA:e.getText("SMARTTABLE_NO_DATA"),SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR:e.getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"),SMARTTABLE_NO_RESULTS:e.getText("SMARTTABLE_NO_RESULTS")};if(this._oTable){o=this._oTable.getNoData;a="noData";if(!o.call(this._oTable)&&this._oTable.getNoDataText){o=this._oTable.getNoDataText;a="noDataText"}}if(o){const t=o.call(this._oTable);if(t&&!this._oTable.isPropertyInitial(a)){if(Object.values(n).indexOf(t)==-1){this._vCustomNoData=t}}else if(t&&typeof t!=="string"&&!this.getNoData()){this._vCustomNoData=t;return}}let s=null;if(typeof this.getNoData()==="string"){s=this.getInitialNoDataText()!=="$NO_FILTERBAR"}this._updateNoDataText(true,s)};At.prototype._filterChangeEvent=function(){if(this._isTableBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true)}};At.prototype._showOverlay=function(t){if(t){var e={show:true};this.fireShowOverlay({overlay:e});t=e.show}this._oTable.setShowOverlay(t)};At.prototype._findControl=function(t,i){var o,a;if(t){o=e.getElementById(t);if(!o||!o.isA(i)){a=this._getView();if(a){o=a.byId(t)}}if(o&&!o.isA(i)){o=undefined}}return o};At.prototype._getView=function(){if(!this._oView){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){this._oView=t;break}t=t.getParent()}}return this._oView};At.prototype.rebindTable=function(t){if(this.isInitialised()){this._reBindTable(null,t);return}$.error("rebindTable method called before the SmartTable is initialized. Please execute the UI5 Support Assistant 'SmartTable' rules to get more information",this.getId(),"sap.ui.comp.smarttable.SmartTable")};At.prototype._reBindTable=function(t,e){var o,a,n,s,r,l,u=[],h,p,d,f,c,_,m,b={},y={preventTableBind:false};this._bUpdateTableAnnouncement=t&&t.getId&&t.getId()==="search";n=this._getTablePersonalisationData()||{};if(this._oMessageFilter){h=this._oMessageFilter}else{h=n.filters;p=n.excludeFilters}m=n.sorters;if(this._oSmartFilter){l=this._oSmartFilter.getFilters();b=this._oSmartFilter.getParameters()||{}}if(l&&l.length){if(p){u=[new x([l[0],p],true)]}else{u=l}}else if(p){u=[p]}if(h){h=u.concat(h)}else{h=u}d=this._getRequestAtLeastFields();c=this._getRelevantColumnPaths();f=c["select"];f=this._getSemanticObjectBindingPaths(f);if(!f||!f.length){f=d}else{r=d.length;for(s=0;s<r;s++){if(f.indexOf(d[s])<0){f.push(d[s])}}}if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.select){this._mSelectExpandForGroup.select.forEach(function(t){if(f.indexOf(t)<0){f.push(t)}})}o=this._oTable.getBinding(this._sAggregation);if(f.length){this._adaptTreeBindingParameters(f,b,o);b["select"]=f.toString();_=c["expand"]||[];if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.expand){this._mSelectExpandForGroup.expand.forEach(function(t){if(_.indexOf(t)<0){_.push(t)}})}if(_.length){b["expand"]=_.join(",")}}b["useBatchRequests"]=true;if(!m){m=[]}y.filters=h;y.sorter=m;y.parameters=b;y.length=undefined;y.startIndex=undefined;y.events={};this.fireBeforeRebindTable({bindingParams:y,messageFilterActive:!!this._oMessageFilter});if(!y.preventTableBind){m=y.sorter;h=y.filters;b=y.parameters;f=y.parameters["select"];if(!f||!f.length){g.error(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_COLS"),{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});return}a=this.getTableBindingPath()||"/"+this.getEntitySet();if(this._oTable.resumeUpdateAnalyticalInfo){this._oTable.resumeUpdateAnalyticalInfo(true,false)}this._bDataLoadPending=true;this._setExcelExportEnableState();this._bIgnoreChange=false;if(this._bForceTableUpdate){e=true;this._bForceTableUpdate=false}if(!e){if(o&&o.mParameters){var T=b["select"];b["select"]="";var C=o.mParameters["select"];o.mParameters["select"]="";e=!(X(b,o.mParameters,true)&&X(b.custom,o.mParameters.custom)&&!y.length&&!y.startIndex&&a===o.getPath());if(!e){e=!X(T.split(",").sort(),C.split(",").sort())}b["select"]=T;o.mParameters["select"]=C}}if(!this._bNoDataUpdated){this._bNoDataUpdated=true}this._updateNoDataText(false,h&&h.length);if(!o||!this._bIsTableBound||e){At._addBindingListener(y,"change",this._onBindingChange,this);At._addBindingListener(y,"dataRequested",this._onDataRequested,this);At._addBindingListener(y,"dataReceived",this._onDataReceived,this);if(this._isOfType(Bt.ResponsiveTable)){var S=this._oTable?this._oTable.getColumns():[];var v=this._oTemplate?this._oTemplate.getCells():[];if(S.length===v.length){S.forEach(function(t,e){v[e].setBindingContext(t.getVisible()?undefined:null)})}}this._oTable.bindRows({path:a,filters:h,sorter:m,parameters:b,length:y.length,startIndex:y.startIndex,template:this._oTemplate,templateShareable:true,events:y.events});this._bIsTableBound=true}else{o.sort(m);o.filter(h,"Application")}this._showOverlay(false)}};At.prototype._adaptTreeBindingParameters=function(t,e,i){if(!this._isOfType(Bt.TreeTable)){return}if(this._oTable.getExpandFirstLevel){e["numberOfExpandedLevels"]=this._oTable.getExpandFirstLevel()?1:0}if(this._oTable.getRootLevel){e["rootLevel"]=this._oTable.getRootLevel()}if(this._oTable.getCollapseRecursive){e["collapseRecursive"]=this._oTable.getCollapseRecursive()}if(!i||!i.getTreeAnnotation){return}var o={"hierarchy-level-for":i.getTreeAnnotation("hierarchy-level-for"),"hierarchy-parent-node-for":i.getTreeAnnotation("hierarchy-parent-node-for"),"hierarchy-node-for":i.getTreeAnnotation("hierarchy-node-for"),"hierarchy-drill-state-for":i.getTreeAnnotation("hierarchy-drill-state-for")};for(var a in o){if(o[a]&&t.indexOf(o[a])===-1){t.push(o[a])}}};At.prototype._onDataRequested=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._bIgnoreChange=true;this.fireDataRequested(t.getParameters())};At.prototype._onDataReceived=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._bIgnoreChange=false;this._onDataLoadComplete(t,true);this.fireDataReceived(t)};At.prototype._onBindingChange=function(t){if(this._bIgnoreChange){return}var e,i=false;e=t&&t.getParameter?t.getParameter("reason"):undefined;if(!e||e==="filter"||e==="context"||!this._bDataLoadPending&&e==="change"||e==="add"||e==="remove"){i=true}if(e==="change"||i){this._onDataLoadComplete(t,i)}};At._addBindingListener=function(t,e,i,o){if(!t.events){t.events={}}if(!t.events[e]){t.events[e]=i.bind(o)}else{var a=t.events[e];t.events[e]=function(){i.apply(o,arguments);a.apply(o,arguments)}}};At.prototype._onDataLoadComplete=function(t,e){if(this._bDataLoadPending||e){this._bDataLoadPending=false;this.updateTableHeaderState();this._updateNoDataText()}};At.prototype._isTableBound=function(){if(this._bIsTableBound){return true}if(this._oTable){return this._oTable.isBound(this._sAggregation)}return false};At.prototype.setNoData=function(t){if(typeof t!==typeof this._oNoData||t!==this._oNoData){this._bNoDataUpdated=true}this._oNoData=t;if(!this._oTable){return this}if(t?.isA?.("sap.m.IllustratedMessage")){this._sLastNoDataTitle="";this._vCustomNoData="";t.setEnableVerticalResponsiveness(!this._isOfType(Bt.ResponsiveTable));let e=this._oTable.getAggregation("_noColumnsMessage");if(!e){e=rt.getNoColumnsIllustratedMessage(()=>{this._oPersController.openDialog()});e.setEnableVerticalResponsiveness(!this._isOfType(Bt.ResponsiveTable));this._oTable.setAggregation("_noColumnsMessage",e,true)}}if(this._bNoDataUpdated||this._isTableBound()){this._updateNoDataText();this._bNoDataUpdated=false}return this};At.prototype.getNoData=function(){return this._oNoData};At.prototype._updateNoDataText=function(t,e){if(this._bIgnoreNoDataUpdate){return}let o=this.getNoData();const a=typeof o==="string"&&this._isOfType(Bt.ResponsiveTable)?this._oTable.setNoDataText:this._oTable.setNoData;if(this._bNoDataUpdated&&this._vCustomNoData){a.call(this._oTable,this._vCustomNoData,true);this._vCustomNoData=null;return}const n=i.getResourceBundleFor("sap.ui.comp");if(o?.isA?.("sap.m.IllustratedMessage")){if(this._sLastNoDataTitle!==o.getTitle()){a.call(this._oTable,o,true);return}const t=!this._isTableBound();Vt(o,t,this._oSmartFilter,e);this._sLastNoDataTitle=o.getTitle()}else if(typeof o==="string"||!o){const i=this.getInitialNoDataText();if(t&&i!=="$FILTERBAR"&&i!=="$NO_FILTERBAR"){o=this.getInitialNoDataText()}else if(t&&i==="$FILTERBAR"){o??=n.getText("SMARTTABLE_NO_DATA")}else if(e){o??=n.getText("SMARTTABLE_NO_RESULTS")}o||=n.getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR")}a.call(this._oTable,o,true)};function Vt(t,e,o,a){if(e){t.setDescription(" ");if(o){t.setIllustrationType(Mt.BeforeSearch);t.setTitle(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_DATA"))}else{t.setIllustrationType(Mt.NoEntries);t.setTitle(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"))}return}if(a!==false){t.setTitle(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS_TITLE"));t.setDescription(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS_DESCRIPTION"));t.setIllustrationType(Mt.NoFilterResults);return}t.setTitle(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"));t.setIllustrationType(Mt.NoEntries)}At.prototype.updateTableHeaderState=function(){this._refreshHeaderText();this._setExcelExportEnableState()};At.prototype._createContent=function(){var t,e=0,i,o,a,n=[];if(this._aExistingColumns&&this._aExistingColumns.length){this._aColumnKeys=[].concat(this._aExistingColumns.reverse())}if(this.getUseTablePersonalisation()){this._oColumnMenu=new ht({id:this.getId()+"-columnHeaderMenu",showTableSettingsButton:true,tableSettingsPressed:[this._showTableP13nDialog,this]});bt.setSemanticStepname(this._oColumnMenu,"beforeOpen","sc:tbl:p13n:col");this._bMissingColumnsCreated=false;this._oColumnMenu.attachBeforeOpen(this._createColumnMenuContent,this)}o=this._parseIndexedColumns();e=this._aTableViewMetadata.length;for(t=0;t<e;t++){i=this._aTableViewMetadata[t];if(i.isInitiallyVisible){this._aColumnKeys.push(i.name)}else{n.push(i.name)}if(!(i.isInitiallyVisible||i.inResult)){this._mLazyColumnMap[i.name]=i}else{a=this._createColumnForField(i);this._oTable.addColumn(a)}this._mFieldMetadataByKey[i.name]=i}this._insertIndexedColumns(o);this._aColumnKeys=this._aColumnKeys.concat(n);if(this._isOfType(Bt.ResponsiveTable)&&this.getEnableAutoColumnWidth()){this.setDemandPopin(true);this._oTable.setFixedLayout("Strict");this._oTable.setContextualWidth("auto");this._oTable.addDependent(new st)}this._updateColumnsPopinFeature();if(this.getShowDetailsButton()){this._oTable.setHiddenInPopin(this._getImportanceToHide())}this._storeInitialColumnSettings()};At.prototype._createColumnForField=function(t){var e,i;i=this.getId()+"-"+t.name.replace(/[^A-Za-z0-9_.:-]+/g,"_");e=this._createColumn(t,i);t.isColumnCreated=true;e.data("p13nData",{columnKey:t.name,leadingProperty:t.name,additionalProperty:t.additionalProperty,additionalSortProperty:undefined,navigationProperty:t.navigationProperty,sortProperty:t.sortable?t.name:undefined,filterProperty:t.filterable?t.name:undefined,isGroupable:t.sortable&&t.filterable&&t.aggregationRole==="dimension",fullName:t.hasValueListAnnotation?t.fullName:null,type:t.filterType,typeInstance:t.modelType,maxLength:t.maxLength,precision:t.precision,scale:t.scale,align:t.align,edmType:t.type,displayBehaviour:t.displayBehaviour,description:t.description,isDigitSequence:t.isDigitSequence,isCurrency:t.isCurrencyField,isTimezone:t.isTimezone,ignorePaste:false,unit:t.unit,width:t.width,aggregationRole:t.aggregationRole,nullable:t.nullable!=="false",timezone:t.timezone||null});if(t.filterable&&e.setFilterProperty){e.setFilterProperty(t.name)}if(t.sortable&&e.setSortProperty){e.setSortProperty(t.name)}if(!e.getAssociation("headerMenu")){e.setAssociation("headerMenu",this.getId()+"-columnHeaderMenu")}if(this.getEnableAutoColumnWidth()){t.width=e.getWidth();if(this.getEditable()){this._updateColumnWidthForEdit(e,t)}}this._registerContentTemplateEvents(t.template);return e};At.prototype._parseIndexedColumns=function(){var t,e,i,o,a,n,s,r,l;var u=this._oTable.getColumns();var h=null;if(this._oTemplate&&this._oTemplate.getCells){h=this._oTemplate.getCells()}if(!u){return null}o=[];e=u.length;for(t=0;t<e;t++){i=u[t];a=i.data("p13nData");n=null;s=null;if(a){n=a.columnIndex;s=a.columnKey}r=-1;if(n!==null&&n!==undefined){r=parseInt(n)}if(!isNaN(r)&&r>-1){if(h){l=h[t];this._oTemplate.removeCell(l)}else{l=null}this._aColumnKeys.splice(t-o.length,1);o.push({index:r,columnKey:s,column:i,template:l});this._oTable.removeColumn(i)}}o.sort(function(t,e){return t.index-e.index});return o};At.prototype._insertIndexedColumns=function(t){var e,i,o;if(!t){return}i=t.length;for(e=0;e<i;e++){o=t[e];this._aColumnKeys.splice(o.index,0,o.columnKey);this._oTable.insertColumn(o.column,o.index);if(o.template){this._oTemplate.insertCell(o.template,o.index)}}};At.prototype._updateColumnsPopinFeature=function(){if(!this._isOfType(Bt.ResponsiveTable)||!this.getDemandPopin()){return}if(!this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(true)}var t=this._oTable.getColumns(true);if(!t){return}t=t.filter(function(t){return t.getVisible()});t.forEach(function(t){if(t.getPopinDisplay()!="WithoutHeader"){t.setPopinDisplay("Inline")}})};At.prototype._storeInitialColumnSettings=function(){var t=U.createArrayFromString(this.getIgnoreFromPersonalisation());this._aInitialSorters=[];U.createSort2Json(this._oTable,this._aInitialSorters,t,this._aTableViewMetadata)};At.prototype._deactivateColumnsPopinFeature=function(){if(!this._isOfType(Bt.ResponsiveTable)){return}if(this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(false)}var t=this._oTable.getColumns();if(!t){return}var e,i=t.length;for(var o=0;o<i;o++){e=t[o];e.setDemandPopin(false);e.setMinScreenWidth("1px")}};At.prototype._registerContentTemplateEvents=function(t){if(t.isA("sap.ui.comp.SmartToggle")){t=t.getEdit()}if(t&&t.attachChange){t.attachChange(function(t){this.fireFieldChange({changeEvent:t})},this)}};At.prototype._updateInitialColumns=function(){var t=this._oTable.getColumns(),e=t.length,i,o;var a=this.getEnableAutoColumnWidth();while(e--){i=t[e];o=i.data("p13nData");if(o?.columnKey&&this._aExistingColumns.indexOf(o.columnKey)>=0){continue}if(typeof o==="string"){try{o=JSON.parse(o);i.data("p13nData",o)}catch(t){$.error(`Assigned p13nData is not a valid JSON object for column with id ${i.getId()}`)}}if(o?.columnKey){this._aExistingColumns.push(o.columnKey);if(!i.getAssociation("headerMenu")){i.setAssociation("headerMenu",this.getId()+"-columnHeaderMenu");if(!this._isOfType(Bt.ResponsiveTable)){this._mMenuShowEntryMap.set(i,{sort:i.getShowSortMenuEntry(),filter:i.getShowFilterMenuEntry()});i.setShowSortMenuEntry(false);i.setShowFilterMenuEntry(false)}}}if(a&&this._isOfType(Bt.ResponsiveTable)){var n=i.getHeader();if(n&&n.isPropertyInitial("wrapping")&&n.getMetadata().getProperty("wrapping")){n.setWrapping(false)}}}};At.prototype._getRelevantColumnPaths=function(){var t={},e=[],i=[],o=this._oTable.getColumns(),a,n=o?o.length:0,s,r,l,u,h;var p=function(t,e,i){var o,a;if(t){a=t.split(",");o=a.length;while(o--){t=a[o];if(t&&e.indexOf(t)<0){e.push(t);if(!this._isOfType(Bt.AnalyticalTable)){var n=this._getColumnFromP13nMap(t);if(n){var s=i?"additionalProperty":"navigationProperty",r=n.data("p13nData"),l=r[s];if(l){p.call(this,l,e,i)}}}}}}};for(a=0;a<n;a++){s=o[a];l=null;if(s.getVisible()||s.getInResult&&s.getInResult()){r=s.data("p13nData");l=this._getColumnLeadingProperty(s,r);if(r){u=r["additionalProperty"];h=r["navigationProperty"]}if(l&&e.indexOf(l)<0){e.push(l)}p.call(this,u,e,true);p.call(this,h,i,false)}}t["select"]=e;t["expand"]=i;return t};At.prototype._createTable=function(){const t=this.getTable();this._sAggregation="rows";if(!t){const t=this.getId()+"-ui5table";switch(this.getTableType()){case Bt.AnalyticalTable:this._oTable=new w(t,{enableCustomFilter:true});break;case Bt.ResponsiveTable:this._oTable=new c(t,{growing:true,autoPopinMode:this.getDemandPopin()});this._oTemplate=new d;break;case Bt.TreeTable:this._oTable=new O(t,{selectionMode:"MultiToggle"});break;default:this._oTable=new R(t,{selectionMode:"MultiToggle"})}if(!this._isOfType(Bt.ResponsiveTable)){Rt(this._oTable)}this.insertItem(this._oTable,2)}else{const e=t.getNoData();if(e?.isA?.("sap.m.IllustratedMessage")){this._bIgnoreNoDataUpdate=true}}this._oTableReady.resolve(this._oTable);this._fColumnPaddingBorder=this._isOfType(Bt.ResponsiveTable)?1:1.1875;if(!this._oTable.getLayoutData()){let t=false;if(!this._isOfType(Bt.ResponsiveTable)){const e=this._oTable.getRowMode();if(!e){t=this._oTable.getVisibleRowCountMode()==="Auto"}if(e){t=e==="Auto"||e.isA("sap.ui.table.rowmodes.Auto")}}if(this._oTable instanceof c||t){this._oTable.setLayoutData(new P({growFactor:1,baseSize:"auto"}))}else{this._oTable.setLayoutData(new P({growFactor:1,baseSize:"0%"}))}}this._oTable.addStyleClass("sapUiCompSmartTableInnerTable");this._oTable.setEnableBusyIndicator(true);this._oTable.setBusyIndicatorDelay(100);if(this._oTable.setEnableCustomFilter){this._oTable.setEnableCustomFilter(this.getEnableCustomFilter())}if(this._oTable.setShowColumnVisibilityMenu){this._oTable.setShowColumnVisibilityMenu(false)}this._attachTableCustomFilter();if(this._isOfType(Bt.AnalyticalTable)){this._createColumn=this._createAnalyticalColumn}else if(this._isOfType(Bt.ResponsiveTable)){if(this.getUseTablePersonalisation()){this._oTable.bActiveHeaders=true}this._sAggregation="items";this._createColumn=this._createMobileColumn;this._oTable.bindRows=this._oTable.bindItems;if(this.getShowDetailsButton()){this._oTable.attachEvent("popinChanged",this._onPopinChanged,this)}}if(!this._isOfType(Bt.ResponsiveTable)){this._oTable.attachRowsUpdated(function(){this._setExcelExportEnableState()},this)}if(this._isOfType(Bt.AnalyticalTable)){this._oTable.setProperty("extendedGroupHeaderMenu",false)}if(this._oTable._setLargeDataScrolling){this._oTable._setLargeDataScrolling(true)}this._oTable.attachPaste(this._onInnerTablePaste,this);if(!this._oTable.getNoData()&&this.getNoData()){this.setNoData(this.getNoData())}};function Rt(t){if(t.setVisibleRowCountMode){t.setVisibleRowCountMode("Auto");return}t.setRowMode("Auto")}At.prototype.onAfterRendering=function(t){if(this.bFullScreen){this._toggleFullScreen(false)}};At.prototype._attachTableCustomFilter=function(){if(this._oTable.detachCustomFilter){this._oTable.detachCustomFilter(this._onCustomFilter,this)}if(this._oTable.getEnableCustomFilter&&this._oTable.getEnableCustomFilter()&&this._bIsFilterPanelEnabled){if(this._oTable.setEnableCellFilter){this._oTable.setEnableCellFilter(false)}if(this._oTable.attachCustomFilter){this._oTable.attachCustomFilter(this._onCustomFilter,this)}}};At.prototype._createColumnMenuContent=function(t){var e=i.getResourceBundleFor("sap.ui.comp");var o=t.getParameter("openBy");var a=o.data("p13nData");var n;var s=this._isOfType(Bt.ResponsiveTable)&&this.getEnableAutoColumnWidth();var r=s&&window.matchMedia("(hover:none)").matches;this._oColumnClicked=o;this._oColumnMenu.removeAllAggregation("quickActions");if(!this._bMissingColumnsCreated){this._oPersController?.preparePersonalization();this._bMissingColumnsCreated=true}if(this.getUseTablePersonalisation()){n=this._mMenuShowEntryMap.get(o);if(this._bIsSortPanelEnabled&&(this._isOfType(Bt.ResponsiveTable)||!this._aExistingColumns.includes(a.columnKey)||n&&n.sort)){if(!this._oQuickSort){this._oQuickSort=this._createQuickSort(o)}this._updateQuickSort(o);this._oColumnMenu.addQuickAction(this._oQuickSort)}if(this._bIsGroupPanelEnabled&&this._isOfType(Bt.ResponsiveTable)){if(!this._oQuickGroup){this._oQuickGroup=this._createQuickGroup(o)}this._updateQuickGroup(o);this._oColumnMenu.addQuickAction(this._oQuickGroup)}if(s){if(this._oQuickResizeInput){this._oQuickResizeInput.destroy()}this._oQuickResizeInput=this._createQuickResizeInput(o,this._oColumnMenu);this._oColumnMenu.addQuickAction(this._oQuickResizeInput)}if(r){if(!this._oQuickResize){this._oQuickResize=this._createQuickResize(e)}this._oColumnMenu.addQuickAction(this._oQuickResize)}}this._oColumnMenu.setShowTableSettingsButton(this.getUseTablePersonalisation()&&this.getShowTablePersonalisation())};At.prototype._showTableP13nDialog=function(t){if(!this._bPersDialogOpen){this._oPersController?.openDialog({filter:{payload:{column:this._oColumnClicked}}})}};At.prototype._createQuickGroup=function(t){return new gt({items:[],change:[function(t){var e=t.getParameter("item"),i=this._getColumnFromP13nMap(e.getKey());if(!i){return}this._onCustomGroup(t,e.getGrouped(),i)},this]})};At.prototype._createQuickSort=function(t){return new dt({items:[],change:[function(t){var e=t.getParameter("item"),i=e.getSortOrder(),o=this._getColumnFromP13nMap(e.getKey());if(!o){return}if(i===Dt.None){var a=o.data("p13nData");this._onCustomSort(t,a.sorted&&a.sorted.ascending,o)}else{this._onCustomSort(t,i===Dt.Ascending,o)}},this]})};At.prototype._updateQuickGroup=function(t){var e=t.data("p13nData");var i;this._oQuickGroup.destroyItems();if(e.unit||e.displayBehaviour!=="descriptionOnly"||!e.description){var o=this._getColumnSortProperty(t);i=this._getColumnFromP13nMap(o);if(o&&i){this._oQuickGroup.addItem(new ct({key:o,label:this._getColumnLabel(t),grouped:e.grouped}))}}if(e.displayBehaviour!=="idOnly"&&e.description){i=this._getColumnFromP13nMap(e.description);if(i){this._oQuickGroup.addItem(new ct({key:e.description,label:this._getColumnLabel(i),grouped:i.data("p13nData").grouped}))}}if(e.unit){i=this._getColumnFromP13nMap(e.unit);if(i&&this._getColumnSortProperty(i)){this._oQuickGroup.addItem(new ct({key:e.unit,label:this._getColumnLabel(i),grouped:i.data("p13nData").grouped}))}}};At.prototype._updateQuickSort=function(t){var e=t.data("p13nData");var i;this._oQuickSort.destroyItems();if(e.unit||e.displayBehaviour!=="descriptionOnly"||!e.description){var o=this._getColumnSortProperty(t);i=this._getColumnFromP13nMap(o);if(o&&i){this._oQuickSort.addItem(new ft({key:o,label:this._getColumnLabel(t),sortOrder:Ot(i.data("p13nData"))}))}}if(e.displayBehaviour!=="idOnly"&&e.description){i=this._getColumnFromP13nMap(e.description);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new ft({key:e.description,label:this._getColumnLabel(i),sortOrder:Ot(i.data("p13nData"))}))}}if(e.unit){i=this._getColumnFromP13nMap(e.unit);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new ft({key:e.unit,label:this._getColumnLabel(i),sortOrder:Ot(i.data("p13nData"))}))}}if(e.additionalProperty&&e.additionalSortProperty){var a=e.additionalProperty.split(",");var n=e.additionalSortProperty.split(",");n.forEach(function(t){t=t.trim();if(a.indexOf(t)===-1){return}i=this._getColumnFromP13nMap(t);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new ft({key:t,label:this._getColumnLabel(i),sortOrder:Ot(i.data("p13nData"))}))}}.bind(this))}};At.prototype._getColumnSortProperty=function(t){let e=t?.getSortProperty?.();e=t?.data("p13nData")?.sortProperty||e;return e??""};At.prototype._createQuickResize=function(t){return new pt({label:t.getText("SMARTTABLE_RP_RESIZE"),content:new et({icon:"sap-icon://resize-horizontal",press:[function(){this._oColumnMenu.close();st.getPlugin(this._oTable).startResizing(this._oColumnClicked.getDomRef())},this]})})};At.prototype._createQuickResizeInput=function(t){const e=st.getPlugin(this._oTable);return e.getColumnResizeInputQuickAction(t)};function Ot(t){var e=Dt.None;if(t.sorted){e=t.sorted.ascending?Dt.Ascending:Dt.Descending}return e}At.prototype._onCustomSort=function(t,e,i){if(!i){i=this._oColumnClicked}var o=i.data("p13nData");var a,n;if(o){if(o.sorted&&o.sorted.ascending===e){delete o.sorted;n=Dt.None;if(this._isOfType(Bt.ResponsiveTable)){i.setSortIndicator(n)}}else{o.sorted={ascending:e};a=o.sorted;n=a&&a.ascending?Dt.Ascending:Dt.Descending}var s=this._isOfType(Bt.ResponsiveTable)?"_sort":"sort";this._oTable.fireEvent(s,{column:i,sortOrder:n,columnAdded:false})}};At.prototype._onCustomGroup=function(t,e,i){if(!i){i=this._oColumnClicked}var o=i.data("p13nData");if(o){o.grouped=e;this._oTable.fireEvent("_group",{groupedColumns:e?[i]:[]})}};At.prototype._onCustomFilter=function(t){this._showTableFilterDialog(t.getParameter("column")||this._oColumnClicked)};At.prototype._onPopinChanged=function(t){if(!this._oShowHideDetailsButton){this._createShowHideDetailsButton()}var e=t.getParameter("visibleInPopin");var i=t.getParameter("hiddenInPopin");var o=t.getSource().getVisibleItems();var a=e.some(function(t){return this._getImportanceToHide().indexOf(t.getImportance())>-1},this);if(o.length&&(i.length||a)){this._oShowHideDetailsButton.setVisible(true)}else{this._oShowHideDetailsButton.setVisible(false)}};At.prototype.getTable=function(){if(!this._oTable){const t=this.getItems().find(t=>t instanceof R||t instanceof c);if(!t){return undefined}else if(t instanceof w){this.setProperty("tableType",Bt.AnalyticalTable,true)}else if(t instanceof c){this.setProperty("tableType",Bt.ResponsiveTable,true);this._oTemplate=t.getItems()?.length>0?t.getItems()[0]:new d;t.removeAllItems()}else if(t instanceof O){this.setProperty("tableType",Bt.TreeTable,true)}else{this.setProperty("tableType",Bt.Table,true)}this._oTable=t;this._updateInitialColumns()}return this._oTable};At.prototype._showTableFilterDialog=function(){if(this._oPersController){var t={useAvailablePanels:false,filter:{visible:true}};this._oPersController.openDialog(t)}};At.prototype._calcColumnWidth=function(t,e,i){var o;if(i===false){o=true}i=Object.assign({label:e?false:true,defaultWidth:e?4:8,padding:this._fColumnPaddingBorder},i);if(!t||o){return i.defaultWidth}var a=0,n=0,s=Math.max(i.min||0,e?1:2),r=Math.max(s,i.max||19),l=t.additionalProperty||"",u=t.displayBehaviour,h=t.modelType,p=t.type||"";if(r<s){return r}if(e||t.unit||!l||u!="descriptionOnly"){if(t.isImageURL||p=="Edm.Byte"||p=="Edm.SByte"){a+=s}else if(h){a+=rt.calcTypeWidth(h,{defaultWidth:i.defaultWidth,maxWidth:i.max})}else{a+=i.defaultWidth}}if(this._isOfType(Bt.TreeTable)&&t.hierarchy&&t.index==0){a+=3}if(!e){t.ownWidth=a=Math.min(a,r)}if(!e&&u!="idOnly"&&l&&this._oTableProvider&&a<r){l.split(",").forEach(function(e){if(e==t.fieldControlProperty){return}var i=this._oTableProvider.getFieldMetadata(e);var o=Object.assign({padding:.4,max:r-a-.4},t.vertical&&{padding:0,max:r});if(e==t.unit){o.min=3}var n=this._calcColumnWidth(i,true,o);if(t.vertical){a=Math.max(n,a)}else{a+=n}},this);if(u=="descriptionOnly"){t.ownWidth=a}else{t.additionalWidth=a-t.ownWidth}}a=a+(i.gap||0);if(i.label){var d=t.label||t.fieldLabel||"";t.labelWidth=n=rt.calcHeaderWidth(d,i.truncateLabel!=false?a:0,r,s)}a=Math.max(s,a,n);a=Math.min(a,r)+i.padding;a=Math.round(a*100)/100;return a};At.prototype._fetchAutoColumnWidthConfig=function(t){var e=null;if(this._oCustomizeConfigAutoColumnWidth){if(this._oCustomizeConfigAutoColumnWidth.hasOwnProperty(t.name)){e=this._oCustomizeConfigAutoColumnWidth[t.name]}else if(this._oCustomizeConfigAutoColumnWidth.hasOwnProperty("*")){e=this._oCustomizeConfigAutoColumnWidth["*"]}}if(e&&e===true){e=null}return e};At.prototype.getFlexConfig=function(){if(this.isInitialised()){return{entitySetName:this.getEntitySet()}}};At.prototype._setWidthForCustomColumn=function(t){var e=t.data("p13nData");if(!this._oTableProvider||!e||!e.autoColumnWidth||t.getWidth()){return}var i=e.autoColumnWidth;var o=i.visibleProperty||typeof e.additionalProperty==="string";var a=i.visibleProperty||[this._getColumnLeadingProperty(t,e),e.additionalProperty].join(",");var n=a.split(",");var s=this._oTableProvider.getFieldMetadata(n.shift(),true);if(!s){return}var r=Object.assign({},s);r.label=this._getColumnLabel(t);if(o){r.additionalProperty=n?n.join(","):""}var l=this._calcColumnWidth(r,false,{truncateLabel:i.truncateLabel,min:i.min,max:i.max,gap:i.gap});s.width=l+"rem";t.setWidth(s.width);if(this.getEditable()){this._updateColumnWidthForEdit(t,s,i)}};At.prototype._updateColumnWidthForEdit=function(t,e){if(!e||!e.isColumnCreated||e.type=="Edm.Boolean"||e.semanticObjects){return}var i=this.data("useSmartField")=="true"||this.data("useSmartField")===true;if(i&&e["sap:updatable"]=="false"){return}var o=t.getWidth();if(!this.getEditable()){if(e.editWidth==o){t.setWidth(e.width)}}else if(e.width==o){if(e.editWidth){t.setWidth(e.editWidth);return}if(!this._aEditableColumnAdditionalWidth){var a=this._fColumnPaddingBorder;var n=this.$().closest(".sapUiSizeCompact").length?"_Compact":"";var s=Object.assign({_sap_m_InputBase_IconWidth:"2.375rem",_sap_m_InputBase_Compact_IconWidth:"2rem",_sap_m_InputBaseWrapper_Sum_Border:"0.125rem",_sap_m_InputBase_InnerPadding:"0 0.75rem",_sap_m_InputBase_Compact_InnerPadding:"0 0.5rem"},nt.get({name:["_sap_m_InputBase_IconWidth","_sap_m_InputBase_Compact_IconWidth","_sap_m_InputBaseWrapper_Sum_Border","_sap_m_InputBase_InnerPadding","_sap_m_InputBase_Compact_InnerPadding"],callback:function(t){Object.assign(s,t)}}));var r=parseFloat(s["_sap_m_InputBase"+n+"_IconWidth"]);a+=parseFloat(s["_sap_m_InputBaseWrapper_Sum_Border"]);a+=parseFloat(s["_sap_m_InputBase"+n+"_InnerPadding"].split(" ").pop())*2;this._aEditableColumnAdditionalWidth=[a,a+r-.25]}var l=(e.displayBehaviour||"").includes("And");var u=(e.labelWidth||0)+this._fColumnPaddingBorder;if(i&&l&&e.additionalWidth&&e.hasValueListAnnotation&&!e.hasFixedValues){e.editWidth=Math.max(e.ownWidth+this._aEditableColumnAdditionalWidth[1],u)+"rem";t.setWidth(e.editWidth);return}var h=e.isCalendarDate||z.isDateOrTime(e.type);var p=e.hasValueListAnnotation||h;var d=this._aEditableColumnAdditionalWidth[+p];if(i&&l&&!e.additionalWidth&&e.hasValueListAnnotation&&e.hasFixedValues){d+=e.ownWidth+3}else if(e.ownWidth<4||h){if(i&&e.unit){d=e.ownWidth+e.additionalWidth+this._aEditableColumnAdditionalWidth[1]}else{d+=e.ownWidth}}else{d+=2}d=Math.min(d,19);var f=parseFloat(o);if(f<d){e.editWidth=d+"rem";t.setWidth(e.editWidth)}}};At.prototype._updateVisibleColumnsWidthForEdit=function(){if(!this._oTable||!this._oTableProvider||!this.getEnableAutoColumnWidth()){return}this._oTable.getColumns().filter(t=>t.getVisible()).forEach(function(t){var e=this._getColumnLeadingProperty(t);if(e){const i=this._oTableProvider.getFieldMetadata(e);this._updateColumnWidthForEdit(t,i)}},this)};At.prototype._updateVariantManagement=function(){if(this._oVariantManagement&&!this.getSmartVariant()){this._oVariantManagement.setShowAsText(!!this.getHeader());this._oVariantManagement.setHeaderLevel(this.getHeaderLevel());this._oVariantManagement.setTitleStyle(this.getHeaderStyle()||xt[nt.get({name:"_sap_ui_comp_SmartTable_HeaderStyle"})])}};At.prototype._getColumnTooltip=function(t){return this._bUseColumnLabelsAsTooltips?t.quickInfo||t.label:t.quickInfo};At.prototype._createColumn=function(t,e){var i=new V(e,{autoResizable:true,hAlign:t.align,width:t.width,visible:t.isInitiallyVisible,label:new f(e+"-header",{textAlign:t.align,text:t.label}),sorted:t.sorted,sortOrder:t.sorted?t.sortOrder:Dt.None,tooltip:this._getColumnTooltip(t),showSortMenuEntry:!this.getUseTablePersonalisation(),showFilterMenuEntry:!this.getUseTablePersonalisation(),name:t.fieldName,template:t.template});if(!t.width&&this.getEnableAutoColumnWidth()){var o=this._fetchAutoColumnWidthConfig(t);i.setWidth(this._calcColumnWidth(t,false,o)+"rem")}return i};At.prototype._createAnalyticalColumn=function(t,e){if(t.aggregationRole!=="measure"&&t.isMeasureField&&t.unit&&t.template.addStyleClass){t.template.addStyleClass("sapUiAnalyticalTableSumCellHidden sapUiAnalyticalTableGroupCellHidden")}else if(t.isCurrencyField&&t.template.addStyleClass){t.template.addStyleClass("sapUiCompCurrencyBold")}var i=this.getModel(),o=i&&i.getMetaModel();var a=new A(e,{autoResizable:true,hAlign:t.align,width:t.width,visible:t.isInitiallyVisible,inResult:t.inResult,label:new f(e+"-header",{textAlign:t.align,text:t.label}),tooltip:this._getColumnTooltip(t),sorted:t.sorted,sortOrder:t.sorted?t.sortOrder:Dt.None,grouped:t.grouped,showIfGrouped:t.grouped,showSortMenuEntry:!this.getUseTablePersonalisation(),showFilterMenuEntry:!this.getUseTablePersonalisation(),summed:t.summed,leadingProperty:t.name,template:t.template,groupHeaderFormatter:W.getInlineGroupFormatterFunction(t,true,this._getDateFormatSettings(),this._bPreserveDecimals,true,o)});if(!t.width&&this.getEnableAutoColumnWidth()){var n=this._fetchAutoColumnWidthConfig(t);a.setWidth(this._calcColumnWidth(t,false,n)+"rem")}return a};At.prototype._createMobileColumn=function(e,i){var o=new p(i,{hAlign:e.align,visible:e.isInitiallyVisible,header:new f(i+"-header",{textAlign:e.align,text:e.label,tooltip:this._getColumnTooltip(e),wrapping:!this.getEnableAutoColumnWidth(),wrappingType:t.WrappingType.Hyphenated}),tooltip:this._getColumnTooltip(e)});if(e.importance&&!this._oTableProvider.isLineItemDefaultImportance(e)){o.setImportance(e.importance)}if(this._oTemplate){this._oTemplate.addCell(e.template)}if(e.width){return o.setWidth(e.width)}if(!this.getEnableAutoColumnWidth()){return o.setWidth(e.isImageURL?"3em":"auto")}var a=this._fetchAutoColumnWidthConfig(e);return o.setWidth(this._calcColumnWidth(e,false,a)+"rem")};At.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{}}var t=this._processDateFiltersForVariant(this._oCurrentVariant);return t};At.prototype.applyVariant=function(t,e){this._oCurrentVariant=t;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null}this._bApplyingVariant=true;if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(true)}if(this._oPersController){if(this._oCurrentVariant===null||mt(this._oCurrentVariant)){this._oPersController.resetPersonalization("ResetFull")}else{this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId(),variantContext:e})};At.prototype._processDateFiltersForVariant=function(t){if(!this._oPersController){return t}var e=U.getColumnKeysOfType("date",this._oPersController.getColumnMap()),i=U.getColumnKeysOfType("time",this._oPersController.getColumnMap());if(e.length===0||!(t&&t.filter&&t.filter.filterItems)){return t}var o=t.filter.filterItems.map(function(t){if(e.concat(i).includes(t.columnKey)&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){t=Object.assign({},t);if(t.value1 instanceof Date){t.value1=l.localToUtc(t.value1).toISOString();t.value1=t.value1.slice(0,-1)}if(t.value2 instanceof Date){t.value2=l.localToUtc(t.value2).toISOString();t.value2=t.value2.slice(0,-1)}}return t},this);t=Object.assign({},t,{filter:Object.assign({},t.filter,{filterItems:o})});return t};At.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding()};At.prototype.getUiState=function(){const t=this._oPersController?this._oPersController.getDataSuiteFormatSnapshot():null;return new G({presentationVariant:{SortOrder:t?t.SortOrder:[],GroupBy:t?t.GroupBy:[],Total:t?t.Total:[],RequestAtLeast:this._getRequestAtLeastFields(),Visualizations:t?t.Visualizations:[]},selectionVariant:{SelectOptions:t?t.SelectOptions:[]},variantName:this.getCurrentVariantId(),tableSettings:{fixedColumnCount:this.getTable().getFixedColumnCount?.(),showDetails:this.getProperty("showDetails")}})};At.prototype.setUiState=function(t){this._setUiState(t,false)};At.prototype.setUiStateAsVariant=function(t,e){this._setUiState(t,true);if(this._oVariantManagement){this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId(),variantContext:e})}};At.prototype._setUiState=function(t,e){const i=t.getPresentationVariant()&&t.getPresentationVariant().RequestAtLeast?[].concat(t.getPresentationVariant().RequestAtLeast):[];const o=t.getTableSettings();if(!X(i,this._getRequestAtLeastFields())){this._aAlwaysSelect=i}if(this._oPersController){const i=Y({},t.getPresentationVariant(),t.getSelectionVariant());if(e){this._oPersController.setPersonalizationDataAsDataSuiteFormat(i,true)}else{var a=this._oVariantManagement&&t.getVariantName()?this._oVariantManagement.getVariantContent(this,t.getVariantName()):{};if(o){a.columns??={};a.columns.showDetails=o.showDetails;a.columns.fixedColumnCount=o.fixedColumnCount}this._oPersController.setDataSuiteFormatSnapshot(i,a,true)}}};At.prototype._getRequestAtLeastFields=function(){var t=this.getRequestAtLeastFields();var e=t?t.split(","):[];return e.concat(this._aAlwaysSelect)};At.prototype._personalisationRequestColumns=function(t){var e=t.getParameter("columnKeys"),i,o,a,n,s,r={};a=e.length;for(o=0;o<a;o++){i=e[o];n=this._mLazyColumnMap[i];if(n){s=this._createColumnForField(n);if(this._isOfType(Bt.ResponsiveTable)){this._oTable.addColumn(s)}r[n.name]=s}}this._oPersController.addColumns(r)};At.prototype._beforePersonalisationModelDataChange=function(t){this._aFilteredColumnsBeforePersonalisationDataChange=this._oCurrentVariant?.filter?.filterItems;if(this._oTable.suspendUpdateAnalyticalInfo){this._oTable.suspendUpdateAnalyticalInfo()}};At.prototype._afterPersonalisationModelDataChange=function(t){this._updateColumnsPopinFeature();this._createInfoToolbar();if(this.getEditable()){this._updateVisibleColumnsWidthForEdit()}};At.prototype._personalisationModelDataChange=function(t){this._oCurrentVariant=t.getParameter("persistentData");if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}var e=t.getParameter("runtimeDeltaDataChangeType");var i=this._getChangeStatus(e);if(i==="Unchanged"){return}if(!(this._bApplyingVariant||this._bDeactivatingColumns)){if(!this.getUseVariantManagement()){this._persistPersonalisation()}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true)}}if(this._isTableBound()){if(i==="ModelChanged"){if(e&&e.columns==="ModelChanged"&&!t.getParameter("_bTriggeredFromReset")){this._bForceTableUpdate=true;var o;if(this._isOfType(Bt.ResponsiveTable)&&this._oTable.getHiddenInPopin()){o=t.getParameter("runtimeDeltaData").columns.columnsItems.some(function(t){const e=this._getColumnByKey(t.columnKey);return e&&t.visible?this._oTable.getHiddenInPopin().includes(e.getImportance()):false},this)}if(o){this.setShowDetails(true)}}if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindTable(null)}}else if(i==="TableChanged"&&this._isOfType(Bt.ResponsiveTable)&&this.getEditable()){this._updateMobileHiddenCellBindingContext(t)}}this._adaptCustomSort();this._adaptCustomGroup();this._createInfoToolbar();this.fireUiStateChange()};At.prototype._updateMobileHiddenCellBindingContext=function(t){var i=a.getMessageModel().getData();if(!i.length){return}var o=i.filter(function(t){return t.validation===true});if(!o.length){return}var n=t.getParameter("runtimeDeltaData").columns.columnsItems.filter(function(t){return t.visible===false});n.forEach(function(t){const o=this._getColumnByKey(t.columnKey);const a=this._oTemplate.getCells()[this._oTable.indexOfColumn(o)];let n;if(a.isA("sap.ui.comp.SmartToggle")){var s=a.getEdit();n=s.getId()}else{n=a.getId()}if(n){var r=i.find(function(t){return t.getControlId()?.includes(n)});if(r){var l=e.getElementById(r.getControlId());if(l){l.setBindingContext(null)}}}},this)};At.prototype._updateSortIndicator=function(t,e,i){var o=this._getSortItemsFromVariant();var a=o.find(function(t){return!!e&&t.sortProperty===e});if(a){if(i){t.setSortIndicator(a.operation)}else{t.setSorted(true);t.setSortOrder(a.operation)}return true}if(!t.data("p13nData").sorted){if(i){t.setSortIndicator(Dt.None)}else{t.setSorted(false);t.setSortOrder(Dt.None)}}return false};At.prototype._getSortItemsFromVariant=function(){var t,e=[];if(this._oCurrentVariant.sort&&this._oCurrentVariant.sort.sortItems){this._oCurrentVariant.sort.sortItems.forEach(function(i){t=this._getColumnSortProperty(this._getColumnFromP13nMap(i.columnKey));if(t){e.push({sortProperty:t,operation:i.operation})}},this)}return e};At.prototype._adaptAdditionalProperties=function(t){const e=this._isOfType(Bt.ResponsiveTable);var i=t.data("p13nData"),o;if(i.unit||i.displayBehaviour!=="descriptionOnly"){o=this._getColumnSortProperty(t);this._updateSortIndicator(t,o,e)}if(i.displayBehaviour!=="idOnly"&&i.description){const a=this._getColumnFromP13nMap(i.description);if(this._getColumnSortProperty(a)){o=i.description;this._updateSortIndicator(t,o,e)}}if(i.unit){const a=this._getColumnFromP13nMap(i.unit);if(this._getColumnSortProperty(a)){o=i.unit;this._updateSortIndicator(t,o,e)}}if(i.additionalProperty&&i.additionalSortProperty){const o=i.additionalProperty.split(",");const a=i.additionalSortProperty.split(",");a.every(function(i){if(o.indexOf(i)===-1){return false}return!this._updateSortIndicator(t,i,e)}.bind(this))}};At.prototype._updateColumnInfoSort=function(t,e){if(t){if(!e.sorted){e.sorted={ascending:false}}if(t.operation===Dt.None){delete e.sorted}else{e.sorted={ascending:t.operation!==Dt.Descending}}}else if(e&&e.sorted){e.sorted=null}};At.prototype._updateColumnInfoGroup=function(t,e){e.grouped=t?true:false};At.prototype._adaptCustomSort=function(){if(this._oCurrentVariant){var t,e,i;var o=this._getSortItemsFromVariant();this._oTable.getColumns().forEach(function(a){e=a.data("p13nData");t=e&&e.sortProperty;if(t){if(o.length){i=o.find(function(e){return t===e.sortProperty})}this._updateColumnInfoSort(i,e);this._updateSortIndicator(a,t,this._isOfType(Bt.ResponsiveTable))}this._adaptAdditionalProperties(a)},this)}};At.prototype._adaptCustomGroup=function(){if(this._oCurrentVariant){var t,e,i,o;if(this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){o=this._oCurrentVariant.group.groupItems}this._oTable.getColumns().forEach(function(a){e=a.data("p13nData");t=e&&e.sortProperty;if(t){if(o){i=o.find(e=>t===this._getColumnByKey(e.columnKey)?.data("p13nData")?.sortProperty)}this._updateColumnInfoGroup(i,e)}},this)}};At.prototype.setUseInfoToolbar=function(t){this.setProperty("useInfoToolbar",t,true);if(this.getTable()){this._createInfoToolbar()}return this};At.prototype._updateInfoToolbar=function(t){if(!this._oInfoToolbar){this._oInfoToolbar=new b({active:true,visible:true,design:It.Info,content:[new _({id:this.getId()+"-infoToolbarText",text:t,wrapping:false}),new T,new et({id:this.getId()+"-infoToolbarClearButton",icon:"sap-icon://decline",type:vt.Transparent,press:[this._handleClearAllFilterButtonPress,this],tooltip:i.getResourceBundleFor("sap.ui.mdc").getText("infobar.REMOVEALLFILTERS")})],ariaLabelledBy:this.getId()+"-infoToolbarText",press:[this._handleInfoToolbarPress,this]})}else{this._oInfoToolbar.setVisible(true);this._oInfoToolbar.getContent()[0].setText(t)}};At.prototype._handleInfoToolbarPress=function(t){this._showTableFilterDialog()};At.prototype._handleClearAllFilterButtonPress=function(){var t=this._oPersController;var e=t.getDataSuiteFormatSnapshot();e=e||{};e.SelectOptions=undefined;t.setPersonalizationDataAsDataSuiteFormat(e,false);this._updateP13nDialogSettings()};At.prototype._createInfoToolbar=function(){var t=this.getUseInfoToolbar(),e=this.getTable(),o=this.getId()+"-infoToolbarText",a,n=i.getResourceBundleFor("sap.ui.comp");var r=this._oCurrentVariant?.filter?.filterItems;var l=r&&r.length;if(t===Ft.Off||!this._isOfType(Bt.ResponsiveTable)&&t===Ft.Auto){if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);e.removeAriaLabelledBy(o)}this._aFilteredColumnsBeforePersonalisationDataChange?.forEach(t=>{a=this._getColumnByKey(t.columnKey);a?.setFiltered?.(false)});if(l){r.forEach(t=>{a=this._getColumnByKey(t.columnKey);a?.setFiltered?.(true)})}return}var u,h;if(this._isOfType(Bt.ResponsiveTable)){u=e.getInfoToolbar();h=e.setInfoToolbar}else{u=e.getExtension().find(t=>t.getDesign&&t.getDesign()===It.Info);h=e.addExtension}if(u&&!this._oInfoToolbar){$.error(`Custom infoToolbar is used, hence set useInfoToolbar property on the SmartTable with id="${this.getId()}" to Off`);return}if(l){var p=[],d=s.getInstance();r.forEach(function(t){a=this._getColumnByKey(t.columnKey);if(a){var e=this._getColumnLabel(t.columnKey);if(e&&p.indexOf(e)===-1){p.push(e)}if(!this._isOfType(Bt.ResponsiveTable)&&a.setFiltered){a.setFiltered(false)}}},this);var f=n.getText("SMARTTABLE_INFOTOOLBAR_FILTER"+(p.length>1?"S":"")+"_ACTIVE",[p.length,d.format(p)]);this._updateInfoToolbar(f);if(!u){h.call(e,this._oInfoToolbar)}if(e.getAriaLabelledBy().indexOf(o)===-1){e.addAriaLabelledBy(o)}}else if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);e.removeAriaLabelledBy(o)}};At.prototype._getChangeStatus=function(t){if(!t){return"ModelChanged"}if(t.sort==="ModelChanged"||t.filter==="ModelChanged"||t.columns==="ModelChanged"||t.group==="ModelChanged"){return"ModelChanged"}if(t.sort==="TableChanged"||t.filter==="TableChanged"||t.columns==="TableChanged"||t.group==="TableChanged"){return"TableChanged"}return"Unchanged"};At.prototype._getDateFormatSettings=function(){if(this._oTableProvider&&this._oTableProvider._oDateFormatSettings){return this._oTableProvider._oDateFormatSettings}return undefined};At.prototype._getTablePersonalisationData=function(){this._mSelectExpandForGroup=null;if(!this._oCurrentVariant){return null}var t=[],e=[],i=[],o,a,n,s,r,p,d,f,g,c,_={},m={},b="",y;if(this._isOfType(Bt.ResponsiveTable)&&this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){a=this._oCurrentVariant.group.groupItems[0];if(this._aDeactivatedColumns.indexOf(a.columnKey)<0){r=this._getColumnByKey(a.columnKey);if(r){b=r.getHeader().getText()}c=this._getPathFromColumnKeyAndProperty(a.columnKey,"sortProperty")}if(c){d=c;f=null;var T=this._mFieldMetadataByKey[a.columnKey],C;if(T){f=T.unit||T.description;var S=this.getModel(),v=S&&S.getMetaModel();C=W.getInlineGroupFormatterFunction(T,false,this._getDateFormatSettings(),this._bPreserveDecimals,true,v)}n=new D(d,a.operation==="GroupDescending",function(t){var e=t.getProperty(d),i;if(C){if(f){i=t.getProperty(f)}e=C(e,i)}if(e===undefined||e===null){e=""}return{key:e,text:b?b+": "+e:e}});this._mSelectExpandForGroup={select:[d]};if(T){if(T.additionalProperty){this._mSelectExpandForGroup.select.push(T.additionalProperty)}if(T.navigationProperty){this._mSelectExpandForGroup.expand=[T.navigationProperty]}}t.push(n)}}if(this._oCurrentVariant.sort){s=this._oCurrentVariant.sort.sortItems}else{s=this._aInitialSorters}if(s){s.forEach(function(e,i){var o=e.operation==="Descending";c=null;g=null;if(this._aDeactivatedColumns.indexOf(e.columnKey)<0){c=this._getPathFromColumnKeyAndProperty(e.columnKey,"sortProperty");if(!c&&e.initiallyNotVisibleColumn){c=e.columnKey}}if(c){if(n&&n.sPath===c){n.bDescending=o}else{var a=this._mFieldMetadataByKey[c];if(!a){r=this._getColumnByKey(e.columnKey);p=r?.data("p13nData")}if(this._bMultiUnitBehaviorEnabled&&(a?.isCurrencyField||p?.isCurrency)){g=a?a.unit:p.unit;var s=this._mFieldMetadataByKey[g];var l,u;if(!s){l=this._getColumnByKey(g);u=l?.data("p13nData")}if(g&&(s?.sortable||u?.sortProperty===g||l?.getSortProperty?.()===g)&&!_[g]){_[g]={index:i,descending:o}}}m[c]={};if(m[g]){delete _[g]}else if(_[c]){delete _[c]}t.push(new D(c,o))}}},this);var P=Object.keys(_),I;if(P.length){P.reverse().forEach(function(e){I=n?_[e].index+1:_[e].index;t.splice(I,0,new D(e,_[e].descending))})}}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(t){var o=t.value1,a=t.value2,n;if(t.conditionTypeInfo){const e=N._calculateDateRangeValues({columnKey:t.columnKey,dateFormatSettings:this._getDateFormatSettings(),conditionTypeInfo:t.conditionTypeInfo.data,fieldViewMetadata:this._oTableProvider.getFieldMetadata(t.columnKey)});if(e){o=e.oValue1;a=e.oValue2}}c=null;y=false;r=null;if(this._aDeactivatedColumns.indexOf(t.columnKey)<0){r=this._getColumnByKey(t.columnKey)}if(r){if(r.getFilterProperty){c=r.getFilterProperty()}p=r.data("p13nData");if(p){y=p.type==="time";if(!c){c=p["filterProperty"]}}}if(c){let r;const b=p?.typeInstance?.getName()==="sap.ui.model.odata.type.DateTimeOffset";try{r=this._oTableProvider&&this._oTableProvider.getFieldMetadata(c)}catch(t){}if(y){if(o instanceof Date){o=W.getEdmTimeFromDate(o)}if(a instanceof Date){a=W.getEdmTimeFromDate(a)}}else{if(o instanceof Date&&!b&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){o=l.localToUtc(o);if(a){var s=parseInt(r?.precision);a=l.localToUtc(a);a=l.adaptPrecision(a,s)}}if(b&&(r.filterRestriction=="interval"||r.filterRestriction=="auto")){if(t.operation==="EQ"||t.operation==="BT"){t.operation="BT";a=a?a:St.getInstance(o);a.setMilliseconds(999)}else if(t.operation==="LE"){o.setMilliseconds(999)}}if(b&&!this._oTableProvider.getIsUTCDateHandlingEnabled()){o=l.toTimezone(o,h.INTL_TIMEZONE);a=l.toTimezone(a,h.INTL_TIMEZONE)}if(r){o=h.adaptTime(o,r);a=h.adaptTime(a,r)}}var d=t.exclude?i:e;if(t.operation==="Empty"||t?.conditionTypeInfo?.data?.operation==="NODATE"){var f=t.exclude?F.NE:F.EQ,g=false,_=false;if(p.nullable===true||p.nullable==="true"){_=true}else if(p.nullable===undefined&&r&&r.nullable!=="false"){_=true}if(p.edmType==="Edm.String"||p.type==="string"){g=true}else if(!p.edmType&&!p.type&&r&&r.type==="Edm.String"){g=true}if(g){d.push(new x(c,f,""))}if(_){d.push(new x(c,f,null))}}else{n=t.exclude?u.getTransformedExcludeOperation(t.operation):t.operation;var m=new x(c,n,o,a);if(b&&r){m=W.adaptMilliseconds(m,r.precision,n)}d.push(m)}}},this);if(i.length){o=new x(i,true)}}return{filters:e,excludeFilters:o,sorters:t}};At.prototype._getColumnByKey=function(t){return this.getTable()?.getColumns().find(e=>e.data("p13nData")?.columnKey===t)};At.prototype._getColumnFromP13nMap=function(t){if(!this._oPersController){return null}const e=this._oPersController.getColumnMap();let i=null;for(const o in e){if(o===t){i=e[o];break}else if(e[o].getLeadingProperty&&e[o].getLeadingProperty()===t){i=e[o];break}else if(e[o].data("p13nData").leadingProperty===t){i=e[o];break}}return i};At.prototype._getPathFromColumnKeyAndProperty=function(t,e){var i=null,o,a;o=this._getColumnByKey(t)||this._getColumnFromP13nMap(t);if(o){if(e=="sortProperty"&&o.getSortProperty){i=o.getSortProperty()}else if(e=="filterProperty"&&o.getFilterProperty){i=o.getFilterProperty()}else if(e=="leadingProperty"&&o.getLeadingProperty){i=o.getLeadingProperty()}if(!i){a=o.data("p13nData");if(a){i=a[e]}}}return i};At.prototype._persistPersonalisation=function(){var t="Personalisation";if(!yt.isDesignModeEnabled()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){var e=this._oVariantManagement.getViewIdByName(t);if(e===null){e=this.getCurrentVariantId()}if(!this._bSaving){this._bSaving=true;this._oVariantManagement.fireSave({name:t,implicit:true,global:false,overwrite:!!e,key:e,def:true});delete this._bSaving}}};At.prototype.getCurrentVariantId=function(){return this._oVariantManagement?this._oVariantManagement.getCurrentVariantId():""};At.prototype.setCurrentVariantId=function(t){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(t)}else{$.error("sap.ui.comp.smarttable.SmartTable.prototype.setCurrentVariantId: VariantManagement does not exist, or is a page variant")}return this};At.prototype.setDetailsButtonSetting=function(t){this.setProperty("detailsButtonSetting",t,true);return this};At.prototype.setEnablePaste=function(t){this.setProperty("enablePaste",t,true);var i=e.getElementById(this.getId()+"-btnPaste");if(i){i.setEnabled(this.getEnablePaste())}return this};At.prototype.isInitialised=function(){return!!this.bIsInitialised};At.prototype._aAvailablePanels=["Columns","Sort","Filter","Group"];At.prototype.openPersonalisationDialog=function(t){if(!t||this._aAvailablePanels.indexOf(t)<0){$.warning("sap.ui.comp.smarttable.SmartTable.prototype.openPersonalisationDialog: "+t+" is not a valid panel!");return}if(this._oPersController){var e={useAvailablePanels:false};e[t.toLowerCase()]={visible:true,payload:undefined};this._oPersController.openDialog(e)}};At.prototype.deactivateColumns=function(t){this._aDeactivatedColumns=t||[];this._bDeactivatingColumns=true;if(this._oPersController){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns)}this._bDeactivatingColumns=false};At.prototype.getDeactivatedColumns=function(){return this._aDeactivatedColumns?this._aDeactivatedColumns.slice():[]};At.prototype._onInnerTablePaste=function(t){if(!this.getEnablePaste()||!this.hasListeners("beforePaste")&&!this.hasListeners("paste")){return}var e=t.getParameter("data");var i=e.slice(0);var o=this._getColumnInfoForPaste();if(this.fireBeforePaste({columnInfos:o,rawData:i})){sap.ui.require(["sap/ui/core/util/PasteHelper"],function(t){t.parse(i,o).then(t=>{this.firePaste({result:t})})}.bind(this))}};At.prototype._getColumnInfoForPaste=function(){var t=[],e=[],i=this._oTable.getColumns(),o,a=i.length,n,s,r,l,u,h,p,d;if(this._isOfType(Bt.ResponsiveTable)&&i.length){i=i.sort(function(t,e){return t.getOrder()-e.getOrder()})}for(o=0;o<a;o++){n=i[o];r=null;h=null;u=null;p=true;if(n.getVisible()){s=n.data("p13nData");if(s.displayBehaviour==="descriptionOnly"&&s.description){r=s.description;u=this._oTableProvider?.getFieldMetadata(r)?.modelType}else{r=this._getColumnLeadingProperty(n,s)}l=s.type==="numeric"?"number":s.type;p=!r||s.ignorePaste;d=s.customParseFunction;if(s.type==="date"){var f=this._getDateFormatSettings();if(f&&f["UTC"]){var g={displayFormat:"Date"};u=z.getType("Edm.DateTime",f,g)}}if(!u){u=s["typeInstance"]||this._oTableProvider?.getFieldMetadata(r)?.modelType}if(s.isCurrency||l==="number"){h=s.unit}else if(s.description&&s.displayBehaviour!=="idOnly"&&s.displayBehaviour!=="descriptionOnly"){h=s.description}}var c={columnId:n.getId(),property:r,ignore:p,type:u,customParseFunction:d};if(r){t.push(c)}else{e.push(c)}u=z.getType("Edm.String");if(h){t.push({columnId:n.getId(),additionalProperty:true,property:h,type:u})}}return t.concat(e)};At.prototype._getSemanticObjectBindingPaths=function(t){if(!t||!t.length){return t}var e=[];t.forEach(function(i){var o=this._aTableViewMetadata&&this._aTableViewMetadata.find(function(t){return t.name==i});if(o&&o.semanticObjectPath){if(!t.includes(o.semanticObjectPath)){e.push(o.semanticObjectPath)}}},this);return t.concat(e)};At.prototype._isOfType=function(t){return this.getTableType()===t};At.prototype.exit=function(){var t,e;this.detachEvent("_change",this._onPropertyChange,this);if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindTable,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter=null}this._oTableProvider?.destroy?.();this._oTableProvider=null;this._oPersController?.destroy?.();this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy()}}this._oNumberFormatInstance=null;H.cleanUpFullScreen(this);this._oEditModel?.destroy();this._oEditModel=null;this._oNoData?.destroy?.();this._oNoData=null;if(this._aTableViewMetadata){t=this._aTableViewMetadata.length;while(t--){e=this._aTableViewMetadata[t];if(e&&!e.isColumnCreated&&e.template){e.template.destroy()}}}this._oShowHideDetailsButton?.destroy();this._oShowHideDetailsButton=null;this._aTableViewMetadata=null;this._mFieldMetadataByKey=null;this._mSelectExpandForGroup=null;this._oVariantManagement=null;this._oCurrentVariant=null;this._aExistingColumns=null;this._mLazyColumnMap=null;this._aColumnKeys=null;this._aDeactivatedColumns=null;this._aAlwaysSelect=null;this._oCustomToolbar=null;if(this._oToolbar&&!this._bToolbarInsertedIntoItems){this._oToolbar.destroy()}this._oToolbar=null;this._oSeparator?.destroy();this._oSeparator=null;this._oExportButton?.destroy();this._oExportButton=null;this._oExportHandler?.destroy();this._oExportHandler=null;this._oTablePersonalisationButton?.destroy();this._oTablePersonalisationButton=null;this._oP13nDialogSettings=null;this._oTemplate?.destroy();this._oTemplate=null;this._oColumnMenu?.destroy();this._oColumnMenu=null;this._oCopyProvider?.destroy();this._oCopyProvider=null;this._oCellSelector?.destroy();this._oCellSelector=null;this._bMissingColumnsCreated=null;this._oInfoToolbar=null;this._oTableReady=null;this._oView=null;this._oTable=null};return At});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/flexibility/ToolbarContentMove", ["sap/ui/core/CustomData","sap/ui/fl/changeHandler/condenser/Classification","./Utils","sap/base/util/uid"],function(e,t,n,o){"use strict";function a(e,t,n,o){return new Promise(function(a,r){var i=[];for(var u=0;u<t.length;u++){i.push(e.getProperty(t[u],n))}Promise.all(i).then(function(e){var n=[];for(var r=0;r<e.length;r++){if(e[r]==o){n.push(t[r])}}a(n)})})}function r(e,t,r,i){return new Promise(function(u,s){var f=i?e.getRevertData():e.getContent();var l=r.modifier;l.getAggregation(t,"customData").then(function(s){a(l,s,"key","p13nData_ToolbarContentMove").then(function(a){var s=function(n){l.setProperty(n,"value",f);if(i){e.resetRevertData()}if(t._applyToolbarContentOrder){t._applyToolbarContentOrder()}u()};var c=a.length>0?a[0]:null;if(!c){l.createControl("sap.ui.core.CustomData",r.appComponent,r.view,(l.getId(t)||o())+"-moveChange",{key:"p13nData_ToolbarContentMove",value:null}).then(function(e){var n=l.insertAggregation(t,"customData",e,0,r.view);if(!(n instanceof Promise)){n=Promise.resolve()}n.then(function(){s(e)})})}else{l.getProperty(c,"value").then(function(t){if(!i){e.setRevertData(n.parseChangeContent(t))}s(c)})}})})})}return{applyChange:function(e,t,n){return r(e,t,n,false)},revertChange:function(e,t,n){return r(e,t,n,true)},completeChangeContent:function(e,t,n){},getCondenserInfo:function(e,n){return{affectedControl:e.getSelector(),classification:t.LastOneWins,uniqueKey:"p13nData_ToolbarContentMove"}}}});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smarttable/flexibility/Utils", ["sap/ui/fl/Utils","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/base/ManagedObjectMetadata"],function(e,t,n){"use strict";var r={getAppComponentForControl:function(t){return e.getAppComponentForControl(t)},getSelectorForControl:function(e,o){if(!o&&!(o===null)){o=r.getAppComponentForControl(e)}if(e&&e.isA&&e.isA("sap.ui.core.Control")&&!n.isGeneratedId(e.getId())){return t.getSelector(e,o)}else{return null}},parseChangeContent:function(e,t){if(typeof e==="string"){try{e=e.replace(/(\\{)/g,"{").replace(/(\\})/g,"}");e=JSON.parse(e);if(t){t(e)}}catch(t){e=null}}return e}};return r});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/PersonalizableInfo", ["sap/ui/comp/library","sap/ui/core/Element"],function(e,a){"use strict";var t=a.extend("sap.ui.comp.smartvariants.PersonalizableInfo",{metadata:{library:"sap.ui.comp",properties:{type:{type:"string",group:"Misc",defaultValue:null},dataSource:{type:"string",group:"Misc",defaultValue:null},keyName:{type:"string",group:"Misc",defaultValue:null}},associations:{control:{type:"sap.ui.core.Control",multiple:false}}}});return t});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagement", ["sap/ui/core/Element","sap/ui/comp/library","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/MetadataAnalyser","./SmartVariantManagementAdapter","./SmartVariantManagementBase","sap/base/Log","sap/base/util/merge","sap/ui/base/SyncPromise","sap/m/library"],function(t,e,a,i,r,n,o,s,l,h){"use strict";const{SharingMode:d}=h;var p=n.extend("sap.ui.comp.smartvariants.SmartVariantManagement",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartvariants/SmartVariantManagement.designtime",interfaces:["sap.ui.core.IShrinkable"],properties:{persistencyKey:{type:"string",group:"Misc",defaultValue:null},entitySet:{type:"string",group:"Misc",defaultValue:null}},aggregations:{personalizableControls:{type:"sap.ui.comp.smartvariants.PersonalizableInfo",multiple:true,singularName:"personalizableControl"}},events:{initialise:{},save:{parameters:{tile:{type:"boolean"},name:{type:"string"}}},afterSave:{}}},renderer:{apiVersion:2}});p.prototype.init=function(){n.prototype.init.apply(this);this._bIsInitialized=false;this._bIsVariantAdaptationEnabled=false;this._oStandardVariant=null;this._oControlPromise=null;this._oPersoControl=null;this._sAppStandardVariantKey=null;this._oSelectionVariantHandler={};this._oAppStdContent=null;this._aPersonalizableControls=[];this._oAdapter=null;this._bApplyingUIState=false;this._loadFlex()};p.prototype.setEntitySet=function(t){this.setProperty("entitySet",t,true);this._checkEntitySet(t);return this};p.prototype._checkEntitySet=function(t){if(!this._oMetadataPromise){this.attachModelContextChange(this._initializeMetadata,this);this._createMetadataPromise();this._initializeMetadata()}return this};p.prototype._createMetadataPromise=function(){this._oMetadataPromise=new Promise(t=>{this._fResolveMetadataPromise=t})};p.prototype._resolveMetadataPromise=function(){if(this._fResolveMetadataPromise){this._fResolveMetadataPromise()}};p.prototype._initializeMetadata=function(){if(!this.bIsInitialised){a.handleModelInit(this,this._onMetadataInitialised)}};p.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this.bIsInitialised){var t=new i(this.getModel());if(t){this._oAdapter=new r({selectionPresentationVariants:t.getSelectionPresentationVariantAnnotationList(this.getEntitySet())});this.detachModelContextChange(this._initializeMetadata,this);this.bIsInitialised=true;this._resolveMetadataPromise()}}};p.prototype.applySettings=function(t){if(!t||!t.hasOwnProperty("useFavorites")){this.setUseFavorites(true)}if(t&&Object.hasOwn(t,"entitySet")&&t.entitySet){this._checkEntitySet(t.entitySet)}n.prototype.applySettings.apply(this,arguments)};p.prototype._createControlWrapper=function(e){var a=null;var i=t.getElementById(e.getControl());if(i){let t,r;const n={promise:new l((e,a)=>{t=e;r=a}),reject:r,resolve:t};a={control:i,type:e.getType(),dataSource:e.getDataSource(),keyName:e.getKeyName(),loaded:n}}return a};p.prototype._getControlWrapper=function(t){var e=this._getAllPersonalizableControls();if(e&&e.length){for(var a=0;a<e.length;a++){if(e[a].control===t){return e[a]}}}return null};p.prototype.addPersonalizableControl=function(e){var a,i=e.getControl();var r=t.getElementById(i);if(!r){o.error("couldn't obtain the control with the id="+i);return this}this.addAggregation("personalizableControls",e,true);a=this._createControlWrapper(e);if(a){this._aPersonalizableControls.push(a)}if(this.isPageVariant()){return this}this.setPersControler(r);return this};p.prototype._loadFlex=function(){return this.oModel.loadFlex().catch(t=>{o.error(t)})};p.prototype.setPersControler=function(t){if(this.oModel.isFlexLoaded()&&this.oModel._isFlexSupported(t)){this._oPersoControl=t;this._handleGetChanges(t);return}if(!this._oPersoControl){this.oModel.isFlexSupported(t).then(e=>{if(e){this._oPersoControl=t;this._handleGetChanges(t)}})}};p.prototype.setPersistencyKey=function(t){this.setProperty("persistencyKey",t);this.setPersControler(this);return this};p.prototype.isPageVariant=function(){if(this.getPersistencyKey()){return true}return false};p.prototype._getAdapter=function(){return this._oAdapter};p.prototype._handleGetChanges=function(t){if(!t||!this.oModel.isFlexLoaded()){return}this._oControlPromise=new Promise((t,e)=>{Promise.all([this._getStandardVariantItemName(),this._oMetadataPromise]).then(a=>{if(this._bIsBeingDestroyed){return}const i=a[0];var r={control:this._oPersoControl,standardVariant:{id:this.STANDARDVARIANTKEY,name:i,executeOnSelection:this.bExecuteOnSelectForStandardViaXML}};if(this._getAdapter()){r.variants=this._getAdapter().getODataVariants()}else{if(this._getFilterBarAdapter()){r.variants=this._getFilterBarAdapter().variants}}this.oModel.loadVariants(r,t,e)})})};p.prototype._getFilterBarAdapter=function(){return this._oSelectionVariantHandler["#"]};p.prototype._getVariantById=function(t){if(this._mVariants&&this._mVariants[t]){return this._mVariants[t]}return null};p.prototype.getVariantContent=function(t,e){var a,i=this._getVariantContent(e);if(i&&this.isPageVariant()&&t){a=this._getControlPersKey(t);if(a){i=this._retrieveContent(i,a)}}return i};p.prototype._getContent=function(t){return t.getContent()};p.prototype._getVariantContent=function(t){var e=this._getVariantById(t);if(e){var a=this._getContent(e);if(a){if(t===this.STANDARDVARIANTKEY&&Object.keys(a).length<1){a=this.getStandardVariant()}return s({},a)}}return null};p.prototype._getAllPersonalizableControls=function(){return this._aPersonalizableControls};p.prototype.removeAllPersonalizableControls=function(){this.removeAllAggregation("personalizableControls");this._aPersonalizableControls=[]};p.prototype.removePersonalizableControl=function(t){var e=this.removeAggregation("personalizableControls",t);if(e){this._aPersonalizableControls.some((t,a)=>{if(t.control.getId()===e.getControl()){this._aPersonalizableControls.splice(a,1);return true}return false})}return e};p.prototype.removePersonalizableControlById=function(t){var e=this.getAggregation("personalizableControls");if(e){e.some((e,a)=>{if(e.getControl()===t.getId()){this.removePersonalizableControl(e);return true}return false})}};p.prototype._createVariantItem=function(t){try{const e={key:t.getVariantId(),title:t.getName(),sharing:t.isUserDependent()?d.Private:d.Public,remove:t.isDeleteEnabled(),favorite:t.getFavorite(),executeOnSelect:t.getExecuteOnSelection(),rename:t.isRenameEnabled(),visible:true,changeable:t.isEditEnabled(),author:t.getAuthor(),contexts:t.getContexts()};this._mVariants[t.getVariantId()]=t;this._insertVariantItem(t,e)}catch(t){o.error(t.message)}};p.prototype._createVariantEntries=function(t){if(t){if(t.defaultVariantId){this._setDefaultVariantKey(t.defaultVariantId,false)}if(t.standardVariant){this._createVariantItem(t.standardVariant);var e=this._getVariantContent(t.standardVariant.getVariantId());if(Object.keys(e).length>0){this._sAppStandardVariantKey=t.standardVariant.getVariantId();if(this._sAppStandardVariantKey!==this.STANDARDVARIANTKEY){this.setStandardVariantKey(this._sAppStandardVariantKey)}}}if(t.variants){t.variants.forEach(t=>{this._createVariantItem(t)})}this.resolveTitleBindings()}};p.prototype._addFavorites=function(t){t.forEach(t=>{if(t.key!==this.STANDARDVARIANTKEY){var e=this._getVariantById(t.key);if(e){this._flUpdateVariant(e,{favorite:t.visible});this._updateView(t.key,"favorite",t.visible)}}})};p.prototype._flUpdateVariant=function(t,e){return this.oModel.flUpdateVariant(t,e,this._oPersoControl)};p.prototype._flRemoveVariant=function(t){var e={control:this._oPersoControl,id:t.getVariantId(),layer:t.getLayer()};var a=this.oModel._flWriteRemoveVariant(e);if(a){delete this._mVariants[a.getVariantId()]}};p.prototype.flWriteOverrideStandardVariant=function(t){this.oModel.flWriteOverrideStandardVariant(t,this._oPersoControl)};p.prototype.getCurrentVariantId=function(){if(this._bDuringVariantCreation){return"SV1656651501366"}var t=this.getCurrentVariantKey();if(t===this.STANDARDVARIANTKEY){t=""}return t};p.prototype.clearVariantSelection=function(){this.setSelectionKey(this.getStandardVariantKey())};p.prototype.setCurrentVariantId=function(t,e){var a;if(this._oPersoControl){a=this._determineVariantId(t);this.setCurrentVariantKey(a);if(this._oStandardVariant){this.setModified(false);if(!e){this._triggerSelectVariant(a,"SET_VM_ID")}}}};p.prototype._determineVariantId=function(t){var e=t;if(!e||!this.getItemByKey(e)){e=this.getStandardVariantKey()}return e};p.prototype.initialise=function(t,e){var a,i;try{if(e&&t){a=this._getControlWrapper(e);if(!a){o.error("initialise on an unknown control.");return}if(a.bInitialized){o.error("initialise on "+e.getId()+" already executed");return}a.fInitCallback=t}else if(!this.isPageVariant()){a=this._getControlWrapper(this._oPersoControl)}const r=this.oModel.getPersistencyPromise();if(!r){this._errorHandling("'initialise' no '_oPersistencyPromise'  available",t,e);return}return r.then(()=>{if(!this._oControlPromise||!this._oPersoControl||!a){this._errorHandling("'initialise' no personalizable component available",t,e);return}Promise.all([this._oMetadataPromise,this._oControlPromise,...this.oModel.retrieveDataFromFlex()]).then(t=>{const[,e,i,r,n]=t;this._dataReceived(e,i,r,n,a)},a=>{i="'loadVariants' failed:";if(a&&a.message){i+=" "+a.messages}this._errorHandling(i,t,e)},a=>{if(a&&a.message){i=a.message}else{i="accessing either flexibility functionality or odata metadata."}this._errorHandling("'initialise' failed: "+i,t,e)})}).catch(a=>{if(a&&a.message){i=a.message}else{i="accessing the flexibility functionality."}this._errorHandling("'initialise' failed: "+i,t,e)})}catch(a){this._errorHandling("exception occurs during 'initialise' processing",t,e)}};p.prototype._errorHandling=function(t,e,a){var i={variantKeys:[]};this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"),t);if(e&&a){e.call(a)}else{this.fireEvent("initialise",i)}if(a.variantsInitialized){a.variantsInitialized()}this.setInErrorState(true)};p.prototype.isVariantAdaptationEnabled=function(){return this._bIsVariantAdaptationEnabled};p.prototype._dataReceived=function(t,e,a,i,r){var n,o,s={variantKeys:[]};if(this._bIsBeingDestroyed){return}if(!this._bIsInitialized){this._bIsVariantAdaptationEnabled=i;this.setVariantCreationByUserAllowed(a);this.setShowShare(e);this._bIsInitialized=true;this._createVariantEntries(t);o=this._getDefaultVariantKey();if(!o||!this._getVariantById(o)&&o.substring(0,1)!=="#"){o=this.getStandardVariantKey()}n=this._getVariantById(o);if(n){this.setDefaultVariantKey(o);this.setSelectionKey(o)}if(this._sAppStandardVariantKey){this._oAppStdContent=this._getVariantContent(this._sAppStandardVariantKey)}}this._initialize(s,r)};p.prototype._initialize=function(t,e){var a,i=null,r=this.isPageVariant();var n,s=false;if(this._oAppStdContent){if(e.type==="table"||e.type==="chart"){if(r){this._applyControlVariant(e.control,this._oAppStdContent,"STANDARD",true)}else{this._applyVariant(e.control,this._oAppStdContent,"STANDARD",true)}}}if(e.fInitCallback){e.fInitCallback.call(e.control);delete e.fInitCallback;e.bInitialized=true}else{t.variantKeys=Object.keys(this._mVariants);this.fireEvent("initialise",t)}a=this.getCurrentVariantKey();if(a&&a!==this.getStandardVariantKey()){i=this._getVariantContent(a);n=this._getVariantById(a);if(n){s=n.getExecuteOnSelection()}}else if(this._oAppStdContent){i=this._oAppStdContent;if(e.type==="table"||e.type==="chart"){i=null}}if(this._sAppStandardVariantKey){this._updateStandardVariant(e,this._oAppStdContent)}else{this._setStandardVariant(e)}try{e.loaded.resolve();if(i){if(this._getAdapter()&&a.substring(0,1)==="#"&&Object.entries(i).length===0){this._applyUiState(a,"INIT",s)}else if(r){this._applyControlVariant(e.control,i,"INIT",true,s)}else{this._applyVariant(e.control,i,"INIT",true,s)}}if(this.bConsiderXml!==undefined){this._executeOnSelectForStandardVariantByXML(this.bConsiderXml)}if(e.control.variantsInitialized){e.control.variantsInitialized()}if(this.getCurrentVariantKey()===this.getStandardVariantKey()){if(this._getApplyAutomaticallyOnStandardVariant()&&e.control.search){e.control.search()}if(this.getExecuteOnSelectForStandardVariant()&&this._oAppStdContent){var l=this.getItemByKey(this.getCurrentVariantKey());if(l){l.setExecuteOnSelect(true)}}}if(!this.getEnabled()){this.setEnabled(true)}}catch(t){o.error("'_initialize' throws an exception:"+t.message)}};p.prototype._updateVariant=function(t){return l.resolve(this._fetchContentAsync()).then(e=>{if(t.key!==this.getStandardVariantKey()){var a=this._getVariantById(t.key);if(a){if(e){var i=this.getItemByKey(t.key);var r={content:e};if(a.getPackage()){r.transportId=a.getPackage()}if(a.getRequest()){r.packageName=a.getRequest()}if(i){r.executeOnSelection=i.getExecuteOnSelect()}this._flUpdateVariant(a,r);if(t.def===true){this._setDefaultVariantKey(t.key)}}this._afterSave(t,false)}}}).catch(t=>{o.error("'_updateVariant' throws an exception:"+t.message)}).unwrap()};p.prototype._createChangeHeader=function(){if(this.isPageVariant()){return{type:"page",dataService:"n/a"}}var t=this._getAllPersonalizableControls();if(t&&t.length>0){return{type:t[0].type,dataService:t[0].dataSource}}};p.prototype._newVariant=function(t){this._bDuringVariantCreation=true;return l.resolve(this._fetchContentAsync()).then(e=>{var a=this._createChangeHeader();var i={type:a.type,ODataService:a.dataSource,texts:{variantName:t.name},content:e,isVariant:true,isUserDependent:!t.public,executeOnSelection:t.execute};var r=this.oModel._flWriteAddVariant({control:this._oPersoControl,changeSpecificData:i});if(r){var n=r.getVariantId();this._mVariants[n]=r;const e=this._flUpdateVariant(r,{favorite:true});if(e){this._mVariants[e.getVariantId()]=e}this._createVariantItem(r);this.setSelectionKey(n);this._bDuringVariantCreation=false;if(t.def===true){this._setDefaultVariantKey(n);this.setDefaultVariantKey(n)}this._afterSave(t,true)}}).catch(t=>{this._bDuringVariantCreation=false;o.error("'_newVariant' throws an exception:"+t.message)}).unwrap()};p.prototype._fetchContent=function(){var t,e,a,i={};var r=this._getAllPersonalizableControls();for(var n=0;n<r.length;n++){t=r[n];if(t&&t.control&&t.control.fetchVariant){a=t.control.fetchVariant();if(a){a=s({},a);if(this.isPageVariant()){e=this._getControlPersKey(t);if(e){i=this._assignContent(i,a,e)}else{o.error("no persistancy key retrieved")}}else{i=a;break}}}}return i};p.prototype._fetchContentAsync=function(){var t,e,a,i={},r=[],n=[];var l=this._getAllPersonalizableControls();for(var h=0;h<l.length;h++){t=l[h];if(t&&t.control&&t.control.fetchVariant){a=t.control.fetchVariant();if(a){if(a&&a instanceof Promise){this.setEnabled(false);r.push(a);n.push(t);continue}a=s({},a);if(this.isPageVariant()){e=this._getControlPersKey(t);if(e){i=this._assignContent(i,a,e)}else{o.error("no persistancy key retrieved")}}else{i=a;break}}}}if(r.length>0){var d=null;var p=new Promise((t,e)=>{d=t});Promise.all(r).then(t=>{for(var r=0;r<t.length;r++){a=s({},t[r]);if(this.isPageVariant()){e=this._getControlPersKey(n[r]);if(e){i=this._assignContent(i,a,e)}else{o.error("no persistancy key retrieved")}}else{i=a;break}}d(i)});return p}else{return i}};p.prototype._getControlInfoPersKey=function(t){var e=null;if(t.keyName==="id"){e=t.control.getId()}else{e=t.control.getProperty(t.keyName)}return e};p.prototype._getControlPersKey=function(t){var e=t;if(!t.keyName){e=this._getControlWrapper(t)}return this._getControlInfoPersKey(e)};p.prototype._appendLifecycleInformation=function(t,e){var a;if(t){a=t.getRequest();if(a===null||a===undefined){a=""}}return a};p.prototype._renameVariant=function(t){if(t.key!==this.getStandardVariantKey()){if(t){var e=this._getVariantById(t.key);if(e){var a={name:t.name};var i=this._appendLifecycleInformation(e,t.key);if(i!=undefined){a.transportId=i}this._flUpdateVariant(e,a);this._reorderList(t.key,t.name)}}}};p.prototype._deleteVariants=function(t){var e;let a=this._getDefaultVariantKey();var i=this.getCurrentVariantKey();if(t&&t.length){for(var r=0;r<t.length;r++){var n=t[r];var o=this._getVariantById(n);if(o){e=this._appendLifecycleInformation(o,n);o.setRequest(e);this._flRemoveVariant(o);var s=this.getItemByKey(n);if(s){this._removeViewItem(s.getKey());this.removeVariantItem(s)}if(a&&a===n){this._setDefaultVariantKey("")}if(n===i){a=this._getDefaultVariantKey();this.setModified(false);this.setCurrentVariantKey(a||this.getStandardVariantKey());this._selectVariant(a||this.getStandardVariantKey())}}}}};p.prototype._executeOnSelectForStandardVariantByXML=function(t){n.prototype._executeOnSelectForStandardVariantByXML.apply(this,arguments);this._reapplyExecuteOnSelectForStandardVariant(t)};p.prototype._reapplyExecuteOnSelectForStandardVariant=function(t){if(Object.keys(this._mVariants).length>0){this.bConsiderXml=undefined;this.flWriteOverrideStandardVariant(t);var e=this.getStandardVariantKey();var a=this._getVariantById(e);if(a){var i=this.getItemByKey(e);if(i){i.setExecuteOnSelect(a.getExecuteOnSelection());this._reapplyExecuteOnSelectForStandardVariantItem(a.getExecuteOnSelection())}}}else{this.bConsiderXml=t}};p.prototype.setExecuteOnStandard=function(t){this._reapplyExecuteOnSelectForStandardVariant(t)};p.prototype.getExecuteOnStandard=function(){var t=this.getStandardVariantKey();var e=this.getItemByKey(t);if(e){return e.getExecuteOnSelect()}return undefined};p.prototype._getApplyAutomaticallyOnStandardVariant=function(){var t=this.getExecuteOnSelectForStandardVariant();if(this._fRegisteredApplyAutomaticallyOnStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()){try{t=this._fRegisteredApplyAutomaticallyOnStandardVariant()}catch(t){o.error("callback for determination of apply automatically on standard variant failed")}}return t};p.prototype._getDefaultVariantKey=function(){return this.oModel._getDefaultVariantId()};p.prototype._setDefaultVariantKey=function(t,e=true){return this.oModel._setDefaultVariantId(t,e?this._oPersoControl:undefined)};p.prototype._setExecuteOnSelections=function(t){if(t&&t.length){for(var e=0;e<t.length;e++){var a=this._getVariantById(t[e].key);if(a){var i=t[e].key;this._flUpdateVariant(a,{executeOnSelection:t[e].exe});this._updateView(i,"executeOnSelect",t[e].exe)}}}};p.prototype._save=function(t,e){if(this.oModel.isFlexLoaded()){try{this.oModel.save(this._oPersoControl).then(()=>{if(!e){if(t){this._updateUser()}this.fireEvent("afterSave")}}).catch(t=>{var e="'_save' failed:";if(t&&t.message){e+=" "+t.message}this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"),e)})}catch(t){this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"),"'_save' throws an exception")}}};p.prototype._updateUser=function(){var t=this.getInitialSelectionKey();var e,a=this._getVariantById(t);if(a){e=a.getAuthor();if(e){this._assignUser(t,e)}}};p.prototype.fireSave=function(t){var e={};if(t){if(t.hasOwnProperty("tile")){e.tile=t.tile}e.name=t.name;if(t.overwrite){if(t.key!==this.getStandardVariantKey()){this.fireEvent("save",e);if(t.key===this.STANDARDVARIANTKEY){this._newVariant(t)}else{this._updateVariant(t)}}}else{this.fireEvent("save",e);this._newVariant(t)}}};p.prototype._afterSave=function(t,e){this.setEnabled(true);this.setModified(false);this._save(e)};p.prototype.fireManage=function(t){var e,a=false;if(t){if(t.renamed){for(e=0;e<t.renamed.length;e++){this._renameVariant(t.renamed[e])}}if(t.deleted){this._deleteVariants(t.deleted)}if(t.exe){this._setExecuteOnSelections(t.exe)}if(t.def){var i=this._getDefaultVariantKey();if(i!==t.def){if(!(i===""&&t.def===this.STANDARDVARIANTKEY)){this._setDefaultVariantKey(t.def);this.setDefaultVariantKey(t.def);a=true}}}if(t.fav&&t.fav.length>0){this._addFavorites(t.fav)}this._checkUpdate();if(t.deleted&&t.deleted.length>0||t.renamed&&t.renamed.length>0||t.exe&&t.exe.length>0||a){this._save()}else if(t.fav&&t.fav.length>0){this._save(false,true)}this.fireEvent("manage",t)}};p.prototype.fireSelect=function(t,e){if(this._oPersoControl&&t&&t.key){this._triggerSelectVariant(t.key,e);this.fireEvent("select",t)}};p.prototype._selectVariant=function(t,e){this.setModified(false);this.fireSelect({key:t},e)};p.prototype._checkForSelectionHandler=function(t){var e=null,a=Object.keys(this._oSelectionVariantHandler);if(a.length>-1){a.some(a=>{if(t.indexOf(a)===0){e=this._oSelectionVariantHandler[a];return true}return false})}return e};p.prototype._triggerSelectVariant=function(t,e){var a,i,r=false;var n=this._checkForSelectionHandler(t);var o=this._getVariantById(t);if(o){a=o.getExecuteOnSelection();if(t===this.getStandardVariantKey()){a=this._getApplyAutomaticallyOnStandardVariant()}r=Object.entries(this._getContent(o)).length===0?false:true}if(r){i=this._getGeneralSelectVariantContent(t,e)}else if(this._getAdapter()&&t.substring(0,1)==="#"){this._applyUiState(t,"SPV_VARIANT",a);return}else if(n){i=this._getSpecialSelectVariantContent(t,e,n)}else{i=this._getGeneralSelectVariantContent(t,e)}if(i){if(this.isPageVariant()){this._applyVariants(i,e,a)}else{this._applyVariant(this._oPersoControl,i,e,false,a)}}};p.prototype._getSpecialSelectVariantContent=function(t,e,a){return a.callback.call(a.handler,t,e)};p.prototype._getGeneralSelectVariantContent=function(t,e){var a=this._getVariantContent(t);if(a){a=s({},a)}return a};p.prototype.currentVariantSetModified=function(t){if(!this._bApplyingUIState){n.prototype.currentVariantSetModified.apply(this,arguments)}};p.prototype._applyControlUiState=function(t,e,a){if(t&&e){t.loaded.promise.then(()=>{if(t.control.setUiStateAsVariant){t.control.setUiStateAsVariant(e,a)}})}};p.prototype._applyUiState=function(t,e,a){var i,r=this._getAdapter(),n=null,o=this._getAllPersonalizableControls();var s=null;if(r){n=r.getUiState(t);this._bApplyingUIState=true;for(i=0;i<o.length;i++){if(o[i]?.control&&o[i]?.loaded){this._applyControlUiState(o[i],n,e);if(o[i].control.search){s=o[i].control}}}this._bApplyingUIState=false;if(a&&s){s.search()}}};p.prototype._applyControlWrapperVariants=function(t,e,a,i){if(t){return t.loaded.promise.then(()=>{this._applyControlVariant(t.control,e,a,false,i)})}return Promise.resolve()};p.prototype._applyVariants=function(t,e,a){var i,r=this._getAllPersonalizableControls();const n=[];for(i=0;i<r.length;i++){if(r[i]?.control&&r[i]?.loaded){n.push(this._applyControlWrapperVariants(r[i],t,e,a))}}return n};p.prototype._setStandardVariant=function(t){var a=t.control;if(a){if(a.fireBeforeVariantSave){a.fireBeforeVariantSave(e.STANDARD_VARIANT_NAME)}return this._assignStandardVariantAsync(t)}};p.prototype._retrieveContent=function(t,e){var a=t;if(this.isPageVariant()&&t){a=t[e];if(!a&&e===this.getPersistencyKey()&&this._aPersonalizableControls&&this._aPersonalizableControls.length===1){a=t}}return a};p.prototype._assignContent=function(t,e,a){if(this.isPageVariant()){t[a]=e}else{t=e}return t};p.prototype._updateStandardVariant=function(t,e){if(t.control){var a=e;if(this.isPageVariant()){var i=this._getControlPersKey(t);if(i){a=this._retrieveContent(e,i)}}return this._assignStandardVariantForControl(t,a)}return e};p.prototype._assignStandardVariantAsync=function(t){var e=null;if(t.control){if(t.control.fetchVariant){e=t.control.fetchVariant()}if(e instanceof Promise){this.setEnabled(false)}return l.resolve(e).then(e=>this._assignStandardVariantForControl(t,e)).catch(t=>{o.error("'_assignStandardVariant' throws an exception: "+t.message)}).unwrap()}return null};p.prototype._assignStandardVariantForControl=function(t,e){var a=e;if(t){if(this.isPageVariant()){var i=this._getControlPersKey(t.control);if(i){if(!this._oStandardVariant){this._oStandardVariant={}}this._oStandardVariant=this._assignContent(this._oStandardVariant,a,i)}}else{this._oStandardVariant=a}}return this._oStandardVariant};p.prototype.getStandardVariant=function(t){var e,a,i=null;if(this._oStandardVariant){if(!t){i=this._oStandardVariant}else{if(this.isPageVariant()){a=this._getControlWrapper(t);if(a){e=this._getControlPersKey(t);if(e){i=this._retrieveContent(this._oStandardVariant,e)}}}else{if(t===this._oPersoControl){i=this._oStandardVariant}}}}return i};p.prototype._applyVariant=function(t,e,a,i,r){if(t&&t.applyVariant){if(r!=undefined){e.executeOnSelection=r}t.applyVariant(e,a,i)}};p.prototype._applyVariantByPersistencyKey=function(e,a,i){var r=null;this.getAggregation("personalizableControls",[]).some(a=>{var i=t.getElementById(a.getControl());if(i){var n=a.getKeyName();if(i.getProperty(n)===e){r=i}return r!=null}});if(r){var n=this._retrieveContent(a,e);this._applyVariant(r,n,i)}};p.prototype._applyControlVariant=function(t,e,a,i,r){var n,o;o=this._getControlPersKey(t);if(o){n=this._retrieveContent(e,o);if(n){this._applyVariant(t,n,a,i,r)}}};p.prototype.registerSelectionVariantHandler=function(t,e){this._oSelectionVariantHandler[e]=t};p.prototype.unregisterSelectionVariantHandler=function(t){var e=null;if(!this._oSelectionVariantHandler){return}if(typeof t==="string"){e=t}else{Object.keys(this._oSelectionVariantHandler).some(a=>{if(this._oSelectionVariantHandler[a].handler===t){e=a;return true}return false})}if(e){delete this._oSelectionVariantHandler[e]}};p.prototype._setErrorValueState=function(t,e){this.setInErrorState(true);if(e){o.error(e)}};p.prototype.exit=function(){n.prototype.exit.apply(this,arguments);this._aPersonalizableControls=null;this._oMetadataPromise=null;this._fResolveMetadataPromise=null;this._oControlPromise=null;this._oPersoControl=null;this._oAppStdContent=null;this._sAppStandardVariantKey=null;this._oSelectionVariantHandler=null;if(this._oAdapter){this._oAdapter.destroy();this._oAdapter=null}};return p});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementAdapter", ["sap/ui/comp/state/UIState","sap/ui/core/Element"],function(t,e){"use strict";var n=e.extend("sap.ui.comp.smartvariants.SmartVariantManagementAdapter",{metadata:{library:"sap.ui.comp",properties:{selectionPresentationVariants:{type:"object",group:"Misc",defaultValue:false}}}});n.prototype.getUiState=function(e){var n,a=null,i=e.substring(1);this.getSelectionPresentationVariants().some(function(t){if(t.qualifier===i){a=t}return a!==null});if(a){if(a.uiStateContent){n=a.uiStateContent}else{n=t.createFromSelectionAndPresentationVariantAnnotation(a.text,a.selectionVariant?a.selectionVariant.annotation:null,a.presentationVariant?a.presentationVariant.annotation:null);a.uiStateContent=n}}return n};n.prototype.getODataVariants=function(){var t="#",e=[];var n=this.getSelectionPresentationVariants();if(n){n.forEach(function(n){if(n.qualifier){var a=t+n.qualifier;e.push({id:a,favorite:true,name:n.text})}})}return e};n.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments)};return n});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementBase", ["sap/m/VariantManagement","sap/ui/model/base/ManagedObjectModel","sap/ui/base/ManagedObjectObserver","sap/base/Log","./SmartVariantManagementMediator"],function(e,t,a,i,n){"use strict";const r=n.extend("sap.ui.comp.smartvariants.SmartVariantManagementBase",{metadata:{interfaces:["sap.m.IOverflowToolbarContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartvariants/SmartVariantManagementBase.designtime",properties:{standardItemAuthor:{type:"string",group:"Misc",defaultValue:"SAP"},initialSelectionKey:{type:"string",group:"Misc",defaultValue:null},lifecycleSupport:{type:"boolean",group:"Misc",defaultValue:false}}},renderer:{apiVersion:2}});r.prototype.init=function(){n.prototype.init.apply(this);this._mVariants={};this.STANDARDVARIANTKEY="*standard*";this._mTranslatablePromises={};this.addStyleClass("sapUiCompVarMngmt");this.setStandardVariantKey(this.STANDARDVARIANTKEY);this._oObserver=new a(this._observeChanges.bind(this));this._oObserver.observe(this,{properties:["standardItemText"]});this.setDefaultVariantKey(this.getStandardVariantKey());this.setPopoverTitle(this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"));this._setStandardVariantKey(this.STANDARDVARIANTKEY)};r.prototype._observeChanges=function(e){if(e.type==="property"){if(this._mTranslatablePromises[e.name]&&this._mTranslatablePromises[e.name].fnResolve){this._mTranslatablePromises[e.name].fnResolve(e.current)}else if(!this._mTranslatablePromises[e.name]){this._mTranslatablePromises[e.name]={promise:Promise.resolve(e.current)}}}};r.prototype._createEmbeddedVM=function(){n.prototype._createEmbeddedVM.apply(this);this._oVM.attachCancel(this._onCancel,this);this._oVM.attachManageCancel(this._onManageCancel,this)};r.prototype._destroyEmbeddedVM=function(){if(this._oVM){this._oVM.detachCancel(this._onCancel,this);this._oVM.detachManageCancel(this._onManageCancel,this)}n.prototype._destroyEmbeddedVM.apply(this)};r.prototype._onCancel=function(e){if(this._fGetDataForKeyUser){this._fGetDataForKeyUser();this._cleanUpSaveForKeyUser()}};r.prototype._onSave=function(e){const t=e.getParameters();if(this._fGetDataForKeyUser){this._prepareSaveAsKeyUserData(t);return}n.prototype._onSave.apply(this,arguments)};r.prototype._onManage=function(e){const t=e.getParameters();if(this._fGetDataForKeyUser){this._prepareManageKeyUserData(t);return}this.fireManage(t)};r.prototype._onManageCancel=function(e){if(this._fGetDataForKeyUser){this._fGetDataForKeyUser();this._cleanUpManageViewsForKeyUser()}};r.prototype._onSelect=function(e){if(!this._fGetDataForKeyUser){this.setModified(false)}n.prototype._onSelect.apply(this,arguments)};r.prototype._getStandardVariantItemName=function(){const e="standardItemText";if(this.getBindingInfo(e)){return this._waitForTranslation(e)}else{return Promise.resolve(this._determineStandardVariantName())}};r.prototype._waitForTranslation=function(e){if(!this._mTranslatablePromises[e]){let t=null;const a=new Promise(e=>{t=e});this._mTranslatablePromises[e]={promise:a,fnResolve:t}}return this._mTranslatablePromises[e].promise};r.prototype.setInitialSelectionKey=function(e){return this.setSelectionKey(e)};r.prototype.getInitialSelectionKey=function(){return this.getSelectionKey()};r.prototype._prepareSaveAsKeyUserData=function(e){try{this._getContentAsync().then(t=>{const a={default:e.def,executeOnSelection:e.execute,type:this._getPersoControllerType(),text:e.name,contexts:e.contexts,content:t};this._fGetDataForKeyUser(a);this._cleanUpSaveForKeyUser()})}catch(e){i.error("'_prepareSaveAsKeyUserData' throws an exception:"+e.message);this._fGetDataForKeyUser();this._cleanUpSaveForKeyUser()}};r.prototype._prepareManageKeyUserData=function(e){const t={};let a=false;if(e.hasOwnProperty("def")){const a=e.def;if(a!==this._oVM._sOriginalDefaultKey){t.default=a}}if(e.hasOwnProperty("deleted")){e.deleted.forEach(e=>{if(!t[e]){t[e]={}}t[e].deleted=true;if(this.getSelectionKey()===e){a=true}})}if(e.hasOwnProperty("exe")){e.exe.forEach(e=>{if(!t[e.key]){t[e.key]={}}t[e.key].executeOnSelection=e.exe})}if(e.hasOwnProperty("fav")){e.fav.forEach(e=>{if(!t[e.key]){t[e.key]={}}t[e.key].favorite=e.visible})}if(e.hasOwnProperty("renamed")){e.renamed.forEach(e=>{if(!t[e.key]){t[e.key]={}}t[e.key].name=e.name})}if(e.hasOwnProperty("contexts")){e.contexts.forEach(e=>{if(!t[e.key]){t[e.key]={}}t[e.key].contexts=e.contexts})}if(a){this.activateVariant(this.getStandardVariantKey())}this._fGetDataForKeyUser(t);this._cleanUpManageViewsForKeyUser()};r.prototype._updateLayerSpecificInformations=function(){this.getVariants().forEach(e=>{const t=this._getVariantById(e.getKey());if(t){e.setRemove(t.isDeleteEnabled(this._sLayer));e.setRename(t.isRenameEnabled(this._sLayer))}})};r.prototype.getPersonalizableControlPersistencyKey=function(){if(this.isPageVariant()){return this.getPersistencyKey()}const e=this._getAllPersonalizableControls();if(e&&e.length===1){return this._getControlPersKey(e[0])}return null};r.prototype.getPresentVariantId=function(){return this.getCurrentVariantId()?this.getCurrentVariantId():this.STANDARDVARIANTKEY};r.prototype.getPresentVariantText=function(){return this._oVM.getSelectedVariantText(this.getPresentVariantId())};r.prototype.getPresentVariantContent=function(){return this._getContentAsync()};r.prototype._getPersoController=function(){return this._oPersoControl};r.prototype._getPersoControllerType=function(){if(this.isPageVariant()){return"page"}const e=this._getAllPersonalizableControls();if(e&&e.length===1){return e[0].type}return null};r.prototype._getViewByName=function(e){let t;const a=e.trim();const i=this.getVariants();for(let e=0;e<i.length;e++){t=i[e].getText().trim();if(t===a){return i[e]}}return null};r.prototype.getViewIdByName=function(e){const t=this._getViewByName(e);return t?t.getKey():null};r.prototype._isDuplicateSaveAs=function(e){const t=e.trim();if(!t){return true}const a=this._determineStandardVariantName();if(a===t){return true}return this._getViewByName(t)?true:false};r.prototype.isNameDuplicate=function(e){const t=e.trim();return this._isDuplicateSaveAs(t)};r.prototype.isNameTooLong=function(t){const a=t.trim();return a.length>e.MAX_NAME_LEN};r.prototype._executeOnSelectForStandardVariantByXML=function(e){this.bExecuteOnSelectForStandardViaXML=e};r.prototype.getExecuteOnSelectForStandardVariant=function(){let e=false;const t=this.getItemByKey(this.getStandardVariantKey());if(t){e=t.getExecuteOnSelect()}return e||this.bExecuteOnSelectForStandardViaXML};r.prototype.openManageViewsDialogForKeyUser=function(e,t,a=false){this._sLayer=e.layer;this._fGetDataForKeyUser=t;this._updateLayerSpecificInformations();let i=true;if(a){i=false}this._oVM.openManagementDialog(i,e.rtaStyleClass,e.contextSharingComponentContainer)};r.prototype.getTitle=function(){return this._oVM.getTitle()};r.prototype.refreshTitle=function(){this._oVM.refreshTitle()};r.prototype.enteringDesignMode=function(){this.setDesignTimeMode(true)};r.prototype.leavingDesignMode=function(){this.setDesignTimeMode(false)};r.prototype.setDesignTimeMode=function(e){this.oModel.setVariantsEditable(!e,this.oContext?.path);return this._oVM.setDesignMode(e)};r.prototype.getManageDialog=function(){if(this._oVM){return this._oVM.oManagementDialog}return null};r.prototype.openSaveAsDialogForKeyUser=function(e,t,a){this._fGetDataForKeyUser=t;this._oVM.openSaveAsDialog(e,a)};r.prototype._cleanUpSaveForKeyUser=function(){if(this._oRolesComponentContainer){this.oSaveDialog.removeContent(this._oRolesComponentContainer)}this._cleanUpKeyUser()};r.prototype.getDefaultVariantId=function(){return this.getDefaultVariantKey()};r.prototype.setDefaultVariantId=function(e){this.setDefaultVariantKey(e)};r.prototype.activateVariant=function(e){this.setCurrentVariantKey(e);this.setModified(false);this.fireSelect({key:e})};r.prototype.getAllVariants=function(){const e=this.oModel.getVariants();const t=[];if(!e||e.length<1){return t}e.forEach(e=>{t.push(this._getVariantById(e.key))});return t};r.prototype.updateVariant=function(e){this.oModel.updateVariant(e)};r.prototype.addVariant=function(e,t){this._createVariantItem(e);if(t){this.setDefaultVariantId(e.getVariantId())}};r.prototype._insertVariantItem=function(e,t){let a=0;const i=this.oModel.getVariants();if(e.getVariantId()===this.STANDARDVARIANTKEY){t.author=this.getStandardItemAuthor()}else{a=this._getIdxSorted(e.getName())}i.splice(a,0,t);this.oModel.setVariants(i)};r.prototype.removeVariant=function(e){if(e.variantId){this.oModel.removeVariant(e.variantId);delete this._mVariants[e.variantId]}if(e.previousVariantId){this.activateVariant(e.previousVariantId)}if(e.previousDefault){this.setDefaultVariantId(e.previousDefault)}};r.prototype.removeWeakVariant=function(e){if(e.variantId){this.oModel.removeVariant(e.variantId);delete this._mVariants[e.variantId]}if(e.previousVariantId){this.setSelectionKey(e.previousVariantId)}if(e.previousDirtyFlag){this.setModified(e.previousDirtyFlag)}if(e.previousDefault){this.setDefaultVariantId(e.previousDefault)}};r.prototype._cleanUpManageViewsForKeyUser=function(){this._destroyManageDialog();this._cleanUpKeyUser()};r.prototype._cleanUpKeyUser=function(){this.setShowShare(this._bShowShare);this._fGetDataForKeyUser=null;this._sLayer=null;this._oRolesComponentContainer=null};r.prototype._getContentAsync=function(){return Promise.resolve(this._fetchContentAsync())};r.prototype.exit=function(){this._oObserver.disconnect();this._oObserver=undefined;this._mTranslatablePromises=null;this._mVariants=null;if(this._oManagedObjectModel){this._oManagedObjectModel.destroy();this._oManagedObjectModel=undefined}this._fRegisteredApplyAutomaticallyOnStandardVariant=null;n.prototype.exit.apply(this)};return r});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementMediator", ["sap/ui/model/Context","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/m/VariantItem","sap/m/VariantManagement","sap/ui/core/Control","sap/ui/core/Lib","sap/ui/core/library","sap/base/Log","./SmartVariantManagementModel","sap/ui/model/BindingMode"],function(e,t,o,a,n,r,i,s,l,p,d){"use strict";const{TitleLevel:u}=s;const c={defaultVariantKey:"defaultVariant",editable:"variantsEditable",headerLevel:"headerLevel",selectionKey:"currentVariant",showExecuteOnSelection:"showExecuteOnSelection",showSetAsDefault:"supportDefault",showShare:"supportPublic",standardItemText:"standardItemText",titleStyle:"titleStyle",useFavorites:"showFavorites",variantCreationByUserAllowed:"creationAllowed"};const h={creationAllowed:"creationAllowed",supportDefault:"supportDefault",headerLevel:"level",titleStyle:"titleStyle",variantsEditable:"showFooter",showExecuteOnSelection:"supportApplyAutomatically",supportPublic:"supportPublic",showFavorites:"supportFavorites",modified:"modified",defaultVariant:"defaultKey",currentVariant:"selectedKey"};const y=["selectedKey"];const f=r.extend("sap.ui.comp.smartvariants.SmartVariantManagementMediator",{metadata:{interfaces:["sap.ui.core.IShrinkable","sap.m.IOverflowToolbarContent","sap.m.IToolbarInteractiveControl"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartvariants/SmartVariantManagementMediator.designtime",properties:{defaultVariantKey:{type:"string",group:"Misc",defaultValue:null},displayTextForExecuteOnSelectionForStandardVariant:{type:"string",group:"Misc",defaultValue:""},editable:{type:"boolean",group:"Misc",defaultValue:true},enabled:{type:"boolean",group:"Misc",defaultValue:true},executeOnSelectionForStandardDefault:{type:"boolean",group:"Misc",defaultValue:false},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:u.Auto},inErrorState:{type:"boolean",group:"Misc",defaultValue:false},maxWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},modelName:{type:"string",group:"Misc",defaultValue:""},selectionKey:{type:"string",group:"Misc",defaultValue:null},showCreateTile:{type:"boolean",group:"Misc",defaultValue:false},showExecuteOnSelection:{type:"boolean",group:"Misc",defaultValue:false},showSetAsDefault:{type:"boolean",group:"Misc",defaultValue:true},showShare:{type:"boolean",group:"Misc",defaultValue:false},standardItemText:{type:"string",group:"Misc",defaultValue:null},titleStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:u.Auto},useFavorites:{type:"boolean",group:"Misc",defaultValue:false},variantCreationByUserAllowed:{type:"boolean",group:"Misc",defaultValue:true}},events:{cancel:{},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},exe:{type:"object[]"},fav:{type:"object[]"},def:{type:"string"},contexts:{type:"object[]"}}},save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},execute:{type:"boolean"},public:{type:"boolean"},def:{type:"boolean"},contexts:{type:"object[]"},global:{type:"boolean"}}},select:{parameters:{key:{type:"string"}}}},associations:{for:{type:"sap.ui.core.Control",multiple:true}},defaultAggregation:"variantItems",aggregations:{variantItems:{type:"sap.m.VariantItem",multiple:true},_embeddedVM:{type:"sap.m.VariantManagement",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2,render(e,t){e.openStart("div",t);e.style("max-width",t.getMaxWidth());e.openEnd();e.renderControl(t._oVM);e.close("div")}}});f.prototype.init=function(){r.prototype.init.apply(this);this.oModel=new p;this.setModel(this.oModel,"$sVM");this.setModelName(p.getDefaultModelName());this.oResourceBundle=i.getResourceBundleFor("sap.ui.comp");this.STANDARDVARIANTKEY="*standard*";this._createEmbeddedVM();this.attachModelContextChange(this._setBindingContext,this);this._setBindingContext()};f.prototype._createEmbeddedVM=function(){this._oVM=new n(`${this.getId()}-vm`);this.setAggregation("_embeddedVM",this._oVM,true);this._oVM.attachManage(this._onManage,this);this._oVM.attachSave(this._onSave,this);this._oVM.attachSelect(this._onSelect,this)};f.prototype._destroyEmbeddedVM=function(){if(this._oVM){this._oVM.detachManage(this._onManage,this);this._oVM.detachSave(this._onSave,this);this._oVM.detachSelect(this._onSelect,this);this._oVM.destroy();this._oVM=undefined}};f.prototype._setBindingContext=function(){const t=this.getModelName();if(!this.oContext&&t===p.getDefaultModelName()){const o=this.getModel(t);if(o){this.oContext=new e(o,p.getDefaultContextPath());this.setBindingContext(this.oContext,t);this._oVM.setModel(o,t);this._createItemsModel(t);const a=Object.entries(h).map(([e,t])=>({nameInModel:e,nameInVariantMangement:t}));this._bindPropertiesToVM(t,a,this._oVM);this.setPopoverTitle(this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"))}}};f.prototype._bindPropertiesToVM=function(e,t,o=this._oVM){if(!e||!t?.length){return}t.forEach(t=>{const a={};if(y.includes(t.nameInVariantMangement)){a.mode=d.TwoWay}o.bindProperty(t.nameInVariantMangement,{path:`${this.oContext}/${t.nameInModel}`,model:e,...a})})};f.prototype._createItemsModel=function(e){this._oItemsTemplate=new a({key:`{${e}>key}`,title:`{${e}>title}`,sharing:`{${e}>sharing}`,remove:`{${e}>remove}`,favorite:`{${e}>favorite}`,executeOnSelect:`{${e}>executeOnSelect}`,rename:`{${e}>rename}`,visible:`{${e}>visible}`,changeable:`{${e}>changeable}`,author:`{${e}>author}`,contexts:`{${e}>contexts}`});this._oVM.bindAggregation("items",{path:`${this.oContext}/variants`,model:e,template:this._oItemsTemplate,filters:new t({path:"visible",operator:o.EQ,value1:true})})};f.prototype.resolveTitleBindings=function(e){const t=[];this.oModel.prepareVariantsForTitleBindings(this.oContext?.sPath,e).forEach(o=>{const a=this.getModel(o.sResourceModel);if(a){const e=a.getResourceBundle().getText(o.sResourceKey);this.oModel.reorderVariants(o.key,e,-1)}else if(t.indexOf(o.sResourceModel)<0){t.push(o.sResourceModel);this.attachEventOnce("modelContextChange",this.resolveTitleBindings.bind(this,e))}})};f.prototype._onManage=function(e){const t=e.getParameters();this.fireManage(t)};f.prototype._onSave=function(e){const t=e.getParameters();if(t.hasOwnProperty("execute")){t.exe=t.execute}if(t.hasOwnProperty("public")){t.global=t.public}this.fireSave(t)};f.prototype._onSelect=function(e){this.fireSelect(e.getParameters())};f.prototype._checkUpdate=function(){this.oModel.checkUpdate(true)};f.prototype._getIdxSorted=function(e){return this.oModel.getIdxSorted(e)};f.prototype._reapplyExecuteOnSelectForStandardVariantItem=function(e){const t=this.getStandardVariantKey();const o=this.oModel.getVariants();const a=this.oModel.findVariantIndex(t,-1);if(a>-1){o[a]["executeOnSelect"]=e;o[a]["originalExecuteOnSelect"]=e;this.oModel.setVariants(o)}};f.prototype._removeViewItem=function(e){this.oModel.removeVariant(e)};f.prototype._reorderList=function(e,t){this.oModel.reorderVariants(e,t)};f.prototype._updateView=function(e,t,o){this.oModel.updateView(e,t,o)};f.prototype._setPropertyAlsoInModel=function(e,t){const o=c[e];this._setPropertyInModel(o,t);return this.setProperty(e,t)};f.prototype._setPropertyInModel=function(e,t){this.oModel._setProperty(e,t,this.oContext?.path)};f.prototype.getCurrentVariantKey=function(){return this.getSelectionKey()};f.prototype.setCurrentVariantKey=function(e){return this.setSelectionKey(e)};f.prototype.setDefaultVariantKey=function(e){return this._setPropertyAlsoInModel("defaultVariantKey",e)};f.prototype.setEditable=function(e){return this._setPropertyAlsoInModel("editable",e)};f.prototype.setHeaderLevel=function(e){return this._setPropertyAlsoInModel("headerLevel",e)};f.prototype.getModified=function(){return this.oModel.getModified(this.oContext?.sPath)};f.prototype.setModified=function(e){this.oModel.setModified(e,this.oContext?.sPath)};f.prototype.getSelectionKey=function(){return this.oModel.getCurrentVariant(this.oContext?.sPath)};f.prototype.setSelectionKey=function(e){return this._setPropertyAlsoInModel("selectionKey",e)};f.prototype.setShowExecuteOnSelection=function(e){return this._setPropertyAlsoInModel("showExecuteOnSelection",e)};f.prototype.setShowSetAsDefault=function(e){return this._setPropertyAlsoInModel("showSetAsDefault",e)};f.prototype.setShowShare=function(e){return this._setPropertyAlsoInModel("showShare",e)};f.prototype.setStandardItemText=function(e){return this._setPropertyAlsoInModel("standardItemText",e)};f.prototype.setTitleStyle=function(e){return this._setPropertyAlsoInModel("titleStyle",e)};f.prototype.setUseFavorites=function(e){return this._setPropertyAlsoInModel("useFavorites",e)};f.prototype.setVariantCreationByUserAllowed=function(e){return this._setPropertyAlsoInModel("variantCreationByUserAllowed",e)};f.prototype.getVariantItems=function(){return this.getVariants()};f.prototype.getItemByKey=function(e){const t=this.getVariantItems();for(let o=0;o<t.length;o++){if(e==t[o].getKey()){return t[o]}}return null};f.prototype._getEmbeddedVM=function(){return this._oVM};f.prototype._assignUser=function(e,t){const o=this._oVM.getItemByKey(e);if(!o){return}o.setAuthor(t)};f.prototype.currentVariantGetModified=function(){return this.getModified()};f.prototype.currentVariantSetModified=function(e){this.setModified(e)};f.prototype.setDisplayTextForExecuteOnSelectionForStandardVariant=function(e){this.setProperty("displayTextForExecuteOnSelectionForStandardVariant",e);this._oVM.setDisplayTextForExecuteOnSelectionForStandardVariant(e);return this};f.prototype.setEnabled=function(e){this.setProperty("enabled",e);const t=this._oVM.oVariantLayout.getContent();if(!e){t[0].removeStyleClass("sapMVarMngmtClickable");t[0].addStyleClass("sapMVarMngmtDisabled");t[1].addStyleClass("sapMVarMngmtDisabled");t[2].removeStyleClass("sapMVarMngmtClickable");t[2].addStyleClass("sapMVarMngmtDisabled");this._oVM.bPopoverOpen=true}else{t[0].removeStyleClass("sapMVarMngmtDisabled");t[0].addStyleClass("sapMVarMngmtClickable");t[1].removeStyleClass("sapMVarMngmtDisabled");t[2].removeStyleClass("sapMVarMngmtDisabled");t[2].addStyleClass("sapMVarMngmtClickable");this._oVM.bPopoverOpen=false}return this};f.prototype.getFocusDomRef=function(){if(this._oVM){return this._oVM.oVariantPopoverTrigger.getFocusDomRef()}return null};f.prototype.getInErrorState=function(){return this._oVM.getInErrorState()};f.prototype.setInErrorState=function(e){const t=this._oVM.getTitle();if(e&&t&&!t.getText()){t.setText(this._determineStandardVariantName())}this.setProperty("inErrorState",e);this._oVM.setInErrorState(e);return this};f.prototype._determineStandardVariantName=function(){let e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.oModel.getDefaultVariant()===this.STANDARDVARIANTKEY&&this.getStandardItemText()){e=this.getStandardItemText()}return e};f.prototype.setPopoverTitle=function(e){this._oVM.setPopoverTitle(e);return this};f.prototype.getShowAsText=function(){return this._oVM.getShowAsText()};f.prototype.setShowAsText=function(e){this._oVM.setShowAsText(e);return this};f.prototype.setShowCreateTile=function(e){this.setProperty("showCreateTile",e);this._oVM._setShowCreateTile(e);return this};f.prototype.getShowCreateTile=function(){return this._oVM._getShowCreateTile()};f.prototype.getStandardVariantKey=function(){return this._oVM.getStandardVariantKey()};f.prototype.setStandardVariantKey=function(e){this._oVM.setStandardVariantKey(e)};f.prototype._setStandardVariantKey=function(e){this._oVM.setStandardVariantKey(e)};f.prototype.getVariants=function(){return this._oVM?this._oVM.getItems():[]};f.prototype.getVariantByKey=function(e){return this._oVM?this._oVM._getItemByKey(e):null};f.prototype._createSaveAsDialog=function(){this._oVM._createSaveAsDialog()};f.prototype._handleVariantSaveAs=function(e){this._oVM._handleVariantSaveAs(e)};f.prototype.openManagementDialog=function(e,t,o){this._oVM.openManagementDialog(e,t,o)};f.prototype._destroyManageDialog=function(){if(this._oVM){this._oVM.destroyManageDialog()}};f.prototype.registerApplyAutomaticallyOnStandardVariant=function(e){this._fRegisteredApplyAutomaticallyOnStandardVariant=e;return this};f.prototype.getApplyAutomaticallyOnVariant=function(e){let t=false;if(e){t=e.executeOnSelect;if(this._fRegisteredApplyAutomaticallyOnStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()&&e.key===this.getStandardVariantKey()){try{t=this._fRegisteredApplyAutomaticallyOnStandardVariant(e)}catch(e){l.error("callback for determination of apply automatically on standard variant failed")}}}return t};f.prototype.getOverflowToolbarConfig=function(){return{canOverflow:false,invalidationEvents:["save","manage","select"]}};f.prototype._getToolbarInteractive=function(){return true};f.prototype.exit=function(...e){this._destroyEmbeddedVM();if(this._oItemsTemplate){this._oItemsTemplate.destroy();this._oItemsTemplate=undefined}if(this.oModel){this.oModel.destroy();this.oModel=undefined}this._fRegisteredApplyAutomaticallyOnStandardVariant=null;this.oContext=undefined;this.oResourceBundle=undefined;r.prototype.exit.apply(this,e)};return f});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementModel", ["sap/ui/model/json/JSONModel","sap/ui/model/BindingMode","sap/ui/core/Lib","sap/ui/core/library","sap/base/Log"],function(t,e,n,r,i){"use strict";const{TitleLevel:a}=r;const o="/data";const s="$sVM";const l=["creationAllowed","currentVariant","defaultVariant","headerLevel","modified","showExecuteOnSelection","showFavorites","standardItemText","supportDefault","supportPublic","titleStyle","variants","variantsEditable"];const p=t.extend("sap.ui.comp.smartvariants.SmartVariantManagementModel",{constructor:function(){t.apply(this,arguments);this.setSizeLimit(1e3);this.setDefaultBindingMode(e.OneWay);this._aContexts=[];if(!this.getProperty(o)){this.createContext(o)}this._sDefaultVariantId=null}});p.prototype.createContext=function(t,e){if(!t){return}if(this._aContexts.includes(t)){return}if(!t.startsWith("/")){i.warning("SmartVariantManagementModel: you've called 'createContext' with a context path that's not starting with a '/'.");return}this._aContexts.push(t);this.setProperty(t,e||{creationAllowed:true,currentVariant:"",defaultVariant:"",headerLevel:a.Auto,modified:false,showExecuteOnSelection:false,showFavorites:false,standardItemText:null,supportDefault:true,supportPublic:false,titleStyle:a.Auto,variants:[],variantsEditable:true})};l.forEach(function(t){const e=t=>t[0].toUpperCase()+t.slice(1);const n=e(t);const r=`get${n}`,i=`set${n}`;p.prototype[r]=function(e){return this._getProperty(t,e)};p.prototype[i]=function(e,n){return this._setProperty(t,e,n)}});p.prototype._getProperty=function(t,e){return this.getProperty(`${e||o}/${t}`)};p.prototype._setProperty=function(t,e,n){return this.setProperty(`${n||o}/${t}`,e)};p.prototype.getContexts=function(){return this._aContexts};p.prototype._getDefaultVariantId=function(){return this._sDefaultVariantId||""};p.prototype._setDefaultVariantId=function(t,e){if(u&&e){u.setDefaultVariantId({control:e,defaultVariantId:t})}this._sDefaultVariantId=t};p.prototype.prepareVariantsForTitleBindings=function(t,e){if(!e){const n=this.getVariants(t);e=n.map(t=>{const e=t.title&&t.title.match(/{(\w+)>(\w.+)}/);if(!e){return undefined}return{key:t.key,sResourceModel:e[1],sResourceKey:e[2]}}).filter(t=>t!==undefined)}return e};p.prototype.updateVariant=function(t){var e,n,r,i,a;if(t){n=this.getVariants();r=this.findVariantIndex(t.getVariantId());if(r>-1){e=n[r];e["executeOnSelect"]=t.getExecuteOnSelection();e["originalExecuteOnSelect"]=t.getExecuteOnSelection();e["favorite"]=t.getFavorite();e["originalFavorite"]=t.getFavorite();if(t.getContexts){e["contexts"]=t.getContexts();e["originalContexts"]=t.getContexts()}a=t.getText("variantName");if(e["title"]!==a){i=this.getIdxSorted(a);if(r!==i){n.splice(r,1);n.splice(i,0,e)}e["title"]=a;e["originalTitle"]=a}this.setVariants(n);this.checkUpdate(true)}}};p.prototype.reorderVariants=function(t,e,n=0){const r=this.getVariants();var i;var a=this.findVariantIndex(t,n);if(a>0){i=r[a];r.splice(a,1);a=this.getIdxSorted(e);if(a>0){i.title=e;r.splice(a,0,i);this.setVariants(r)}}else if(a===0){r[a]["title"]=e;this.setVariants(r)}};p.prototype.getIdxSorted=function(t){const e=this.getVariants();const n=t.toUpperCase();const r=e.findIndex((t,e)=>{if(e>0){if(t.title.toUpperCase()>n){return true}}return false});return r>-1?r:e.length};p.prototype.removeVariant=function(t){const e=this.getVariants();var n=this.findVariantIndex(t);if(n>-1){e.splice(n,1);this.setVariants(e)}};p.prototype.updateView=function(t,e,n){const r=this.getVariants();var i=this.findVariantIndex(t,-1);if(i>-1){r[i][e]=n;this.setVariants(r)}};p.prototype.findVariantIndex=function(t,e=0){return this.getVariants().findIndex((n,r)=>{if(r>e){if(n.key===t){return true}}return false})};let d,u,f;p.prototype.retrieveDataFromFlex=function(){if(!u){throw new Error("SmartVariantManagementModel.retrieveDataFromFlex: FlexWriteAPI is not available. Please call 'loadFlex' before this method.")}return[u.isVariantSharingEnabled(),u.isVariantPersonalizationEnabled(),u.isVariantAdaptationEnabled()]};p.prototype.loadFlex=function(){const t=()=>new Promise(t=>{sap.ui.require(["sap/ui/fl/apply/api/SmartVariantManagementApplyAPI","sap/ui/fl/write/api/SmartVariantManagementWriteAPI","sap/ui/fl/apply/api/FlexRuntimeInfoAPI"],function(e,n,r){d=e;u=n;f=r;t()})});if(!this._oFlLibrary){if(!this._oPersistencyPromise){this._oPersistencyPromise=new Promise((t,e)=>{this._fResolvePersistencyPromise=t;this._fRejectPersistencyPromise=e})}this._oFlLibrary=new Promise((e,r)=>{n.load({name:"sap.ui.fl"}).then(()=>{t().then(e)}).catch(t=>{if(this._fRejectPersistencyPromise){this._fRejectPersistencyPromise()}r(t)})})}return this._oFlLibrary};p.prototype._unloadFlex=function(){d=undefined;u=undefined;f=undefined;this._oFlLibrary=undefined};p.prototype.isFlexLoaded=function(){return d!==undefined&&u!==undefined&&f!==undefined};p.prototype.isFlexSupported=function(t){if(this.isFlexLoaded()){return Promise.resolve(this._isFlexSupported(t))}else{return this.loadFlex().then(()=>this._isFlexSupported(t))}};p.prototype._isFlexSupported=function(t){if(!f){throw new Error("SmartVariantManagementModel._isFlexSupported: FlexRuntimeInfoAPI is not available. Please call 'loadFlex' before this method.")}return f.isFlexSupported({element:t})};p.prototype.loadVariants=function(t,e,n){if(!d){throw new Error("SmartVariantManagementModel.loadVariant: FlexApplyAPI is not available. Please call 'loadFlex' before this method.")}return d.loadVariants(t).then(t=>{this._fResolvePersistencyPromise();e(t)}).catch(t=>{this._fRejectPersistencyPromise(t);n(t)})};p.prototype.flUpdateVariant=function(t,e,n){let r;if(e.hasOwnProperty("content")||e.hasOwnProperty("name")){r=this._handleLayerUpdate(t,e,n)}if(e.hasOwnProperty("favorite")||e.hasOwnProperty("executeOnSelection")){r=this._handleUserDependentUpdate(t,e,n)}return r};p.prototype._handleLayerUpdate=function(t,e,n){const r={control:n,id:t.getVariantId(),layer:t.getLayer()};if(e.hasOwnProperty("content")){r.content=e.content}if(e.hasOwnProperty("name")){r.name=e.name}if(e.hasOwnProperty("packageName")){r.packageName=e.packageName}if(e.hasOwnProperty("transportId")){r.transportId=e.transportId}return this._handleUpdate(r)};p.prototype._handleUserDependentUpdate=function(t,e,n){const r={control:n,id:t.getVariantId(),isUserDependent:true};if(e.hasOwnProperty("favorite")){r.favorite=e.favorite}if(e.hasOwnProperty("executeOnSelection")){r.executeOnSelection=e.executeOnSelection}return this._handleUpdate(r)};p.prototype._handleUpdate=function(t){return this._flWriteUpdateVariant(t)};p.prototype._flWriteUpdateVariant=function(t){return u?.updateVariant(t)??null};p.prototype._flWriteRemoveVariant=function(t){return u?.removeVariant(t)??null};p.prototype._flWriteAddVariant=function(t){return u?.addVariant(t)??null};p.prototype.flWriteOverrideStandardVariant=function(t,e){if(u){u.overrideStandardVariant({control:e,executeOnSelection:t})}};p.prototype.save=function(t){if(!u){throw new Error("SmartVariantManagementModel.save: FlexWriteAPI is not set. Please call 'loadFlex' before calling this method.")}return u.save({control:t})};p.prototype._createMetadataPromise=function(){this._oMetadataPromise=new Promise(t=>{this._fResolveMetadataPromise=t})};p.prototype._resolveMetadataPromise=function(){if(this._fResolveMetadataPromise){this._fResolveMetadataPromise()}};p.prototype.getPersistencyPromise=function(){return this._oPersistencyPromise};p.getDefaultContextPath=()=>o;p.getDefaultModelName=()=>s;p.prototype.destroy=function(){this._oPersistencyPromise=null;this._sDefaultVariantId=null;this._fResolveMetadataPromise=null;this._oMetadataPromise=null;this._aContexts=undefined;t.prototype.destroy.apply(this,arguments)};return p});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/smartvariants/SmartVariantManagementUi2", ["sap/ui/core/Control","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/library","sap/ui/comp/library","sap/m/VariantManagement","sap/ui/comp/variants/VariantItem","sap/ui/model/base/ManagedObjectModel","sap/base/Log"],function(t,e,a,i,r,n,o,s,l){"use strict";var h=i.TitleLevel;var u=t.extend("sap.ui.comp.smartvariants.SmartVariantManagementUi2",{metadata:{library:"sap.ui.comp",properties:{enabled:{type:"boolean",group:"Misc",defaultValue:true},maxWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:"100%"},standardItemText:{type:"string",group:"Misc",defaultValue:null},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:h.Auto},titleStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:h.Auto}},aggregations:{personalizableControl:{type:"sap.ui.comp.smartvariants.PersonalizableInfo",multiple:false},_embeddedVM:{type:"sap.m.VariantManagement",multiple:false,visibility:"hidden"}},events:{initialise:{},afterSave:{},save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},def:{type:"boolean"}}},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},def:{type:"string"}}},select:{parameters:{key:{type:"string"}}}}},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.style("max-width",e.getMaxWidth());t.openEnd();t.renderControl(e._oVM);t.close("div")}}});u.prototype.init=function(){t.prototype.init.apply(this);this.STANDARDVARIANTKEY="*standard*";this.addStyleClass("sapUiCompVarMngmt");this.oResourceBundle=a.getResourceBundleFor("sap.ui.comp");this._oVM=new n(this.getId()+"-vm",{supportFavorites:false,supportApplyAutomatically:false,supportPublic:false,supportContexts:false});this.setAggregation("_embeddedVM",this._oVM,true);this._oVM.setStandardVariantKey(this.STANDARDVARIANTKEY);this._oManagedObjectModel=new s(this);this.setModel(this._oManagedObjectModel,"$compSmartVariantsUi2");this._oVM.attachManage(this._fireManage,this);this._oVM.attachSave(this._fireSave,this);this._oVM.attachSelect(this._fireSelect,this);this._oStandardVariant=null;this._oPersController=null;this._sKeyName=null;this._oContainer=null;this._oVariantSet=null;this._bindProperties()};u.prototype._bindProperties=function(){this._oVM.bindProperty("level",{path:"/headerLevel",model:"$compSmartVariantsUi2"});this._oVM.bindProperty("titleStyle",{path:"/titleStyle",model:"$compSmartVariantsUi2"})};u.prototype.getVariantItems=function(){return this._oVM.getItems()};u.prototype.isPageVariant=function(){return false};u.prototype.getVariantContent=function(t,e){var a=null;if(e===this.getStandardVariantKey()){a=this._getStandardVariant()}else{if(this._oVariantSet){var i=this._oVariantSet.getVariant(e);if(i){a=this._getContent(i)}}}return a};u.prototype.getExecuteOnSelectForStandardVariant=function(){return false};u.prototype.currentVariantSetModified=function(t){this._oVM.setModified(t)};u.prototype.currentVariantGetModified=function(){return this._oVM.getModified()};u.prototype.getCurrentVariantId=function(){var t=this._oVM.getSelectedKey();if(t===this.getStandardVariantKey()){t=""}return t};u.prototype.setSelectionKey=function(t){this._oVM.setSelectedKey(t)};u.prototype.getItemByKey=function(t){return this._oVM._getItemByKey(t)};u.prototype.setDefaultVariantKey=function(t){this._oVM.setDefaultKey(t)};u.prototype.getDefaultVariantKey=function(){return this._oVM.getDefaultKey()};u.prototype.setInitialSelectionKey=function(t){this.setSelectionKey(t)};u.prototype.getInitialSelectionKey=function(){return this._oVM.getSelectedKey()};u.prototype.getSelectionKey=function(){return this._oVM.getSelectedKey()};u.prototype.addVariantItem=function(t){this._oVM.addItem(t)};u.prototype.insertVariantItem=function(t,e){this._oVM.insertItem(t,e)};u.prototype.removeVariantItem=function(t){this._oVM.removeItem(t)};u.prototype.setCurrentVariantKey=function(t){this.setSelectionKey(t)};u.prototype._fireSelect=function(t){this.fireSelect(t.getParameters())};u.prototype._fireSave=function(t){var e=t.getParameters();if(e.hasOwnProperty("execute")){e.exe=e.execute}this.fireSave(e)};u.prototype._fireManage=function(t){var e=t.getParameters();this.fireManage(e)};u.prototype.getStandardVariantKey=function(){return this.STANDARDVARIANTKEY};u.prototype._determineStandardVariantName=function(){var t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.getStandardItemText()){t=this.getStandardItemText()}return t};u.prototype.removeAllVariantItems=function(){this._oVM.removeAllItems()};u.prototype._createStandardVariantItem=function(){this._createVariantItem(this.getStandardVariantKey(),this._determineStandardVariantName(),{rename:false,remove:false,changeable:false});this.setSelectionKey(this.getStandardVariantKey())};u.prototype._getIdxSorted=function(t){var e=this.getVariantItems();var a=t.toUpperCase();var i=e.findIndex(function(t,e){if(e>0){if(t.getTitle().toUpperCase()>a){return true}}return false});return i>-1?i:e.length};u.prototype._variantItemChange=function(t){var e,a,i;if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.variants.VariantItem")){i=t.oSource;if(i.getKey()!==this.STANDARDVARIANTKEY){a=t.getParameter("propertyName");if(a==="text"){this.removeVariantItem(i);e=this._getIdxSorted(i.getText());this.insertVariantItem(i,e)}}}};u.prototype._createVariantItem=function(t,e,a){var i=t===this.getStandardVariantKey()?0:this._getIdxSorted(e);if(!a){a={rename:true,remove:true,changeable:true}}a.key=t;a.text=e;a.title=e;a.visible=true;var r=new o(a);r.attachChange(this._variantItemChange.bind(this));this.insertVariantItem(r,i)};u.prototype.removeVariantItemByKey=function(t){var e=null;this.getVariantItems().some(function(a){if(a.getKey()===t){e=a}return e!=null});if(e){this.removeVariantItem(e);e.destroy()}};u.prototype.getVariantItems=function(){return this._oVM.getItems()};u.prototype.getInErrorState=function(){return this._oVM.getInErrorState()};u.prototype.clearVariantSelection=function(){this.setSelectionKey(this.getStandardVariantKey())};u.prototype.setCurrentVariantId=function(t,e){var a;var i=t;if(!i){i=this.getStandardVariantKey()}else{if(!this.getItemByKey(i)){i=this.getStandardVariantKey()}}if(this._oVariantSet){a=this.getVariantContent(this._oPersController,i);if(a){this.setSelectionKey(i);if(e!==true){this._applyVariantContent(a)}}}};u.prototype.addPersonalizableControl=function(t){this.setAggregation("personalizableControl",t,true);if(t.getControl()){this._oPersController=e.getElementById(t.getControl())}this._sKeyName=t.getKeyName();return this};u.prototype._getUShellContainer=function(){return sap.ui.require("sap/ushell/Container")};u.prototype.initialise=function(){var t=this._getPersistencyKey();if(!t){l.warning("PersistencyKey not set");this.fireEvent("initialise");return}var e=this;var a=this._getUShellContainer();if(a){a.getServiceAsync("Personalization").then(function(a){a.getContainer(t,{validity:Infinity}).fail(function(){l.error("Loading personalization container failed");e._setErrorValueState(e.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));e.fireEvent("initialise")}).done(function(t){e._readPersonalization(t)})},function(){l.error("Loading personalization service failed");e._setErrorValueState(e.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));e.fireEvent("initialise")});return}l.error("Could not obtain the personalization container");this._setErrorValueState(this.oResourceBundle.getText("VARIANT_MANAGEMENT_READ_FAILED"));this.fireEvent("initialise")};u.prototype._setSelectedVariant=function(){var t=null;if(this._oVariantSet){var e=this.getSelectionKey();if(e){t=this._oVariantSet.getVariant(e);if(t){this._applyVariant(t)}}}};u.prototype._reCreateVariantEntries=function(){var t=null;var e=null;var a;if(this._oVariantSet){var i=this._getVariantNamesAndKeys();if(i){for(t in i){if(t){this._createVariantItem(i[t],t)}}e=this._oVariantSet.getCurrentVariantKey();a=this._oVariantSet.getVariant(e);if(!a){e=this.getStandardVariantKey()}this.setDefaultVariantKey(e);this.setInitialSelectionKey(e)}}};u.prototype._getVariantSetAdapter=function(t){if(!t){return Promise.resolve(null)}return new Promise(function(e){sap.ui.require(["sap/ushell/services/PersonalizationV2/VariantSetAdapter"],function(a){e(new a(t))})})};u.prototype._createVariantEntries=function(){this.removeAllVariantItems();this._createStandardVariantItem();return this._getVariantSetAdapter(this._oContainer).then(function(t){if(t){this._oVariantSet=t.getVariantSet("filterBarVariantSet");if(this._oVariantSet){this._reCreateVariantEntries()}else{this._oVariantSet=t.addVariantSet("filterBarVariantSet")}this._setStandardVariant();if(this.getDefaultVariantKey()!==this.getStandardVariantKey()){this._setSelectedVariant()}}this.fireEvent("initialise")}.bind(this))};u.prototype._readPersonalization=function(t){this._oContainer=t;if(this._oContainer){this._createVariantEntries()}};u.prototype._savePersonalizationContainer=function(){var t=this;if(this._oContainer){this._oContainer.save().fail(function(){l.error("Saving personalization data failed");t._setErrorValueState(t.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE_FAILED"))}).done(function(){l.info("Saving personalization data succeeded");t.fireEvent("afterSave")})}};u.prototype.fireSave=function(t){var e=null,a=null;var i;if(!this._oVariantSet){return}if(t){if(t.overwrite){if(t.key){e=this._oVariantSet.getVariant(t.key)}}else{if(t.name){e=this._oVariantSet.addVariant(t.name);a=e;i=a.getVariantKey();this._createVariantItem(i,t.name);this.setInitialSelectionKey(i)}}if(e){this.fireEvent("save",t);var r=this._fetchVariant();if(r){e.setItemValue("filterBarVariant",r.filterBarVariant);e.setItemValue("filterbar",r.filterbar);e.setItemValue("basicSearch","");if(r.basicSearch){e.setItemValue("basicSearch",r.basicSearch)}i=e.getVariantKey();if(t.def){if(i){this._oVariantSet.setCurrentVariantKey(i)}}else{var n=this._oVariantSet.getCurrentVariantKey();if(i===n){this._oVariantSet.setCurrentVariantKey(null)}}}this.currentVariantSetModified(false);this._savePersonalizationContainer()}}};u.prototype._setStandardVariant=function(){if(this._oPersController&&this._oPersController.fireBeforeVariantSave){this._oPersController.fireBeforeVariantSave(r.STANDARD_VARIANT_NAME)}this._oStandardVariant=this._fetchVariant()};u.prototype._getStandardVariant=function(){return this._oStandardVariant};u.prototype._getVariantNamesAndKeys=function(){return this._oVariantSet.getVariantNamesAndKeys()};u.prototype._reorderList=function(t){var e=this.getItemByKey(t);if(e){this.removeVariantItem(e);var a=this._getIdxSorted(e.getTitle());this.insertVariantItem(e,a)}};u.prototype.fireManage=function(t){var e;var a=null,i=null;var r;if(!this._oVariantSet){return}if(t){a=t.renamed;i=t.deleted;if(a){for(e=0;e<a.length;e++){r=this._oVariantSet.getVariant(a[e].key);if(r){r.setVariantName(a[e].name);this._reorderList(a[e].key)}}}if(i){var n=this._oVariantSet.getCurrentVariantKey();var o=this.getCurrentVariantId();for(e=0;e<i.length;e++){r=this._oVariantSet.getVariant(i[e]);if(r){this._oVariantSet.delVariant(i[e]);this.removeVariantItemByKey(i[e]);if(n&&n===r.getVariantKey()){this._oVariantSet.setCurrentVariantKey(null)}if(o&&o===r.getVariantKey()){this.setSelectionKey(this.getStandardVariantKey());this.fireSelect({key:this.getStandardVariantKey()})}}}}if(t.def){r=this._oVariantSet.getVariant(t.def);if(r||t.def===this.getStandardVariantKey()){this._oVariantSet.setCurrentVariantKey(t.def)}}if(i&&i.length>0||a&&a.length>0||t.def){this._savePersonalizationContainer()}}};u.prototype.fireSelect=function(t){var e=null;if(t&&t.key){if(this._oVariantSet){if(t.key===this.getStandardVariantKey()){e=this._getStandardVariant()}else{e=this._oVariantSet.getVariant(t.key)}}}if(e){this.currentVariantSetModified(false);this._applyVariant(e)}};u.prototype._getContent=function(t){var e=null;if(t){if(t.getItemValue){e={filterbar:t.getItemValue("filterbar"),filterBarVariant:t.getItemValue("filterBarVariant")};var a=t.getItemValue("basicSearch");if(a){e.basicSearch=a}}else{e=t}}return e};u.prototype._applyVariant=function(t){var e=this._getContent(t);this._applyVariantContent(e)};u.prototype._applyVariantContent=function(t){if(t&&this._oPersController&&this._oPersController.applyVariant){this._oPersController.applyVariant(t)}};u.prototype._fetchVariant=function(){if(this._oPersController&&this._oPersController.fetchVariant){return this._oPersController.fetchVariant()}return null};u.prototype._getPersistencyKey=function(){if(this._oPersController&&this._sKeyName){return this._oPersController.getProperty(this._sKeyName)}return null};u.prototype._setErrorValueState=function(t){this.setEnabled(false)};u.prototype.exit=function(){t.prototype.exit.apply(this,arguments);if(this._oManagedObjectModel){this._oManagedObjectModel.destroy();this._oManagedObjectModel=undefined}this._oVM.detachManage(this._fireManage,this);this._oVM.detachSelect(this._fireSelect,this);this._oVM.detachSave(this._fireSave,this);this._oStandardVariant=null;this._oPersController=null;this._sKeyName=null;this._oContainer=null;this._oVariantSet=null};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/state/UIState", ["sap/base/i18n/Formatting","sap/ui/comp/library","sap/ui/base/ManagedObject","sap/ui/comp/odata/MetadataAnalyser","sap/ui/core/Locale","sap/ui/model/odata/AnnotationHelper","sap/ui/model/Context","sap/base/util/isEmptyObject"],function(e,t,r,a,n,i,o,s){"use strict";var u=r.extend("sap.ui.comp.state.UIState",{metadata:{library:"sap.ui.comp",properties:{presentationVariant:{type:"object"},selectionVariant:{type:"object"},variantName:{type:"string"},valueTexts:{type:"object"},semanticDates:{type:"object"},tableSettings:{type:"object"}}}});u._getFilterNamesWithValuesForCurrentLanguage=function(t){var r=[],a=new n(e.getLanguageTag()).getLanguage();if(t&&t.Texts){t.Texts.some(function(e){if(e.Language===a){e.PropertyTexts.forEach(function(e){var t,a=false;for(var n=0;n<r.length;n++){if(r[n].filterName===e.PropertyName){t=r[n];a=true;break}}if(e.PropertyName&&e.ValueTexts&&Object.keys(e.ValueTexts).length>0){e.ValueTexts.forEach(function(r){if(!t){t={filterName:e.PropertyName,keys:[]}}t.keys.push(r.PropertyValue)})}if(!a&&t&&t.keys.length){r.push(t)}});return true}return false})}return r};u._getFilterNamesWithValuesFromSelectOption=function(e,t){var r=[];if(e&&e.SelectOptions){e.SelectOptions.forEach(function(e){var a=t?t.indexOf(e.PropertyName)<0:true;if(a){var n={filterName:e.PropertyName,keys:[]};e.Ranges.forEach(function(e){if(e.Option==="EQ"&&e.Sign==="I"){n.keys.push(e.Low)}});r.push(n)}})}return r};u._determineFiltersWithOnlyKeyValues=function(e,t){var r,a,n=[];e=e||[];t=t||[];t.forEach(function(t){var i={filterName:t.filterName,keys:[]};a=null;e.some(function(e){if(t.filterName===e.filterName){a=e}return a!==null});for(var o=0;o<t.keys.length;o++){r=false;if(a){for(var s=0;s<a.keys.length;s++){if(t.keys[o]===a.keys[s]){r=true;break}}}if(!r){i.keys.push(t.keys[o])}}if(i.keys.length){n.push(i)}});return n};u.determineFiltersWithOnlyKeyValues=function(e,t,r){var a=u._getFilterNamesWithValuesForCurrentLanguage(e);var n=u._getFilterNamesWithValuesFromSelectOption(t,r);return u._determineFiltersWithOnlyKeyValues(a,n)};u.calculateValueTexts=function(t,r){var a=null;var i=function(t,r){var i=null;if(!a){a={Texts:[{ContextUrl:"",Language:new n(e.getLanguageTag()).getLanguage(),PropertyTexts:[]}]}}for(var o=0;o<a.Texts[0].PropertyTexts.length;o++){if(a.Texts[0].PropertyTexts[o].PropertyName===t){i=a.Texts[0].PropertyTexts[o];break}}if(!i){i={PropertyName:t,ValueTexts:[]};a.Texts[0].PropertyTexts.push(i)}i.ValueTexts.push({PropertyValue:r.key,Text:r.text})};if(r&&t&&t.SelectOptions){t.SelectOptions.forEach(function(e){if(r[e.PropertyName]){if(r[e.PropertyName].ranges){r[e.PropertyName].ranges.forEach(function(t){if(t.hasOwnProperty("text")){i(e.PropertyName,t)}})}if(r[e.PropertyName].items){r[e.PropertyName].items.forEach(function(t){if(t.hasOwnProperty("text")){i(e.PropertyName,t)}})}}})}return a};u.enrichWithValueTexts=function(t,r){var a=false,i,o,s,u=t;o=new n(e.getLanguageTag()).getLanguage().toLowerCase();if(r&&r.Texts){r.Texts.some(function(e){if(e.Language&&e.Language.toLowerCase()===o){i=e}return i!==null});if(i&&i.PropertyTexts){if(!s){s=JSON.parse(t)}i.PropertyTexts.forEach(function(e){var t=s[e.PropertyName];if(t&&t.ranges&&e.ValueTexts){e.ValueTexts.forEach(function(r){var n=null,i=-1;if(r.Text){t.ranges.some(function(e,t){if(!e.exclude&&e.operation==="EQ"&&e.value1===r.PropertyValue){n=e;i=t}return n!=null})}if(n){a=true;if(!t.items){t.items=[]}t.items.push({key:r.PropertyValue,text:r.Text});s[e.PropertyName].ranges.splice(i,1)}})}});if(a){u=JSON.stringify(s)}}}return u};u.createFromSelectionAndPresentationVariantAnnotation=function(e,t,r){var n={};if(t&&t.SelectOptions&&t.SelectOptions.length){n.SelectOptions=t.SelectOptions.map(function(e){return{PropertyName:e.PropertyName.PropertyPath,Ranges:e.Ranges.map(function(e){var t=new o(null,"/");return{Sign:a.getSelectionRangeSignType([e.Sign.EnumMember]),Option:a.getSelectionRangeOptionType([e.Option.EnumMember]),Low:e.Low&&i.format(t,e.Low)||undefined,High:e.High&&i.format(t,e.High)||undefined}})}})}if(t&&t.Parameters&&t.Parameters.length){n.Parameters=t.Parameters.map(function(e){var t=new o(null,"/");return{PropertyName:e.PropertyName.PropertyPath,PropertyValue:e.PropertyValue&&i.format(t,e.PropertyValue)||undefined}})}var l={};if(r&&r.lineItemAnnotation){if(!l.Visualizations){l.Visualizations=[]}var f=[];if(r.lineItemAnnotation.fields){var p=r.lineItemAnnotation.labels;var c=r.lineItemAnnotation.urlInfo;var m=r.lineItemAnnotation.importance;var y=r.lineItemAnnotation.criticality;r.lineItemAnnotation.fields.forEach(function(e){var t={Value:e};t.Label=p[e]?p[e]:null;t.IconUrl=c[e]?c[e]:null;t.Importance=m[e]?m[e]:null;t.Criticality=y[e]?y[e]:null;f.push(t)})}l.Visualizations.push({Type:"LineItem",Content:f})}if(r&&r.chartAnnotation){if(!l.Visualizations){l.Visualizations=[]}l.Visualizations.push({Type:"Chart",Content:{ChartType:r.chartAnnotation.chartType,Measures:r.chartAnnotation.measureFields,MeasureAttributes:Object.keys(r.chartAnnotation.measureAttributes).map(function(e){return{Measure:e,Role:r.chartAnnotation.measureAttributes[e].role}}),Dimensions:r.chartAnnotation.dimensionFields,DimensionAttributes:Object.keys(r.chartAnnotation.dimensionAttributes).map(function(e){return{Dimension:e,Role:r.chartAnnotation.dimensionAttributes[e].role}})}})}if(r&&r.maxItems){l.MaxItems=parseInt(r.maxItems)}if(r&&r.sortOrderFields){l.SortOrder=r.sortOrderFields.map(function(e){return{Property:e.name,Descending:e.descending}})}if(r&&r.groupByFields){l.GroupBy=r.groupByFields}if(r&&r.requestAtLeastFields){l.RequestAtLeast=r.requestAtLeastFields}return new u({presentationVariant:!s(l)?l:undefined,selectionVariant:!s(n)?n:undefined,variantName:e?e:undefined})};u.calcSemanticDates=function(e,t){var r=null;var a=function(e,t){var a=null;if(!r){r={Dates:[]}}for(var n=0;n<r.Dates.length;n++){if(r.Dates[n].PropertyName===e){a=r.Dates[n];break}}if(!a){a={PropertyName:e,Data:t.conditionTypeInfo.data};r.Dates.push(a)}};if(t&&e&&e.SelectOptions){e.SelectOptions.forEach(function(e){if(t[e.PropertyName]){if(t[e.PropertyName].ranges){if(t[e.PropertyName].hasOwnProperty("conditionTypeInfo")){a(e.PropertyName,t[e.PropertyName])}}}})}return r};u.enrichWithSemanticDates=function(e,t){var r=false,a,n=e;if(t&&t.Dates){if(!a){a=JSON.parse(e)}t.Dates.forEach(function(e){var t=a[e.PropertyName];if(t&&t.ranges&&e.Data){r=true;if(!t.items){t.items=[]}t.ranges[0].semantic=e.Data}});if(r){n=JSON.stringify(a)}}return n};return u});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/transport/TransportDialog", ["sap/ui/fl/transport/TransportDialog"],function(r){"use strict";var a=r.extend("sap.ui.comp.transport.TransportDialog",{metadata:{library:"sap.ui.comp",deprecated:true},renderer:{apiVersion:2}});return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/type/Interval", ["sap/base/i18n/Formatting","sap/ui/comp/util/DateTimeUtil","sap/ui/core/Locale","sap/ui/model/CompositeType","sap/ui/model/FormatException","sap/ui/model/ParseException","sap/ui/model/ValidateException","sap/ui/core/LocaleData"],function(e,t,i,a,n,r,s,l){"use strict";var o=a.extend("sap.ui.comp.type.Interval",{constructor:function(){a.apply(this,arguments);this.sName="Interval";this.bUseInternalValues=true}});o.prototype.formatValue=function(e,t){if(e==undefined||e==null){return null}if(!Array.isArray(e)){throw new n("Cannot format interval: "+e+" is expected as an Array but given the wrong format")}if(e.length<1||e.length>2){throw new n("Cannot format interval: "+e+" is expected as an Array with 1 or 2 entries")}if(!t){t="string"}switch(this.getPrimitiveType(t)){case"string":case"any":if(e[0]===null&&(e.length===1||e[1]===null)){return""}var i=this.oFormatOptions.type;var a=u.call(this,i);var r;var s;var l;if(i){if(i.isA("sap.ui.model.odata.type.Time")){r=i.formatValue(f(e[0]),"string")}else{r=i.formatValue(e[0],"string")}}else{r=e[0]}if(e.length===1||e[1]===null){l=r}else{if(i){if(i.isA("sap.ui.model.odata.type.Time")){s=i.formatValue(f(e[1]),"string")}else{s=i.formatValue(e[1],"string")}}else{s=e[1]}l=a.replace(/\{0\}/g,r).replace(/\{1\}/g,s)}return l;default:throw new n("Don't know how to format Interval to "+t)}};o.prototype.parseValue=function(e,t,i){if((!t||t==="any")&&typeof e==="string"){t="string"}switch(this.getPrimitiveType(t)){case"string":if(!e){return[null,null]}var a=this.oFormatOptions.type;var n=u.call(this,a);var s=p.call(this,a);var l=[];var o=e.indexOf(s);var f=null;var h=null;if(o<0&&s.length>1){s=s.replace(/\s+/g,"");o=e.indexOf(s)}if(o<0&&s!==" - "&&s!=="-"){s=" - ";o=e.indexOf(s)}if(o<0&&s!=="-"){s="-";o=e.indexOf(s)}if(o===0&&s==="-"){o=e.slice(1).indexOf(s);if(o>=0){o++}}if(o<0){f=e;if(!f){throw new r(e+" is not a valid interval")}}else if(o===0){f="";h=e.slice(s.length);if(!h){throw new r(e+" is not a valid interval")}}else{f=e.slice(0,o);h=e.slice(o+s.length);if(!f||!h){throw new r(e+" is not a valid interval")}}if(a){f=a.parseValue(f,"string");if(a.isA("sap.ui.model.odata.type.Time")){f=m(f)}if(o>=0){h=a.parseValue(h,"string");if(a.isA("sap.ui.model.odata.type.Time")){h=m(h)}}}if(n.indexOf("{0}")<n.indexOf("{1}")){l.push(f);l.push(h)}else{l.push(h);l.push(f)}return l;default:throw new r("Don't know how to parse Interval from "+t)}};o.prototype.validateValue=function(e){if(e==undefined||e==null){return}if(!Array.isArray(e)){throw new s("An array is expected")}if(e.length<1||e.length>2){throw new s("There must be only one or two values in the array")}if(e.length===2&&e[1]!==null&&typeof e[0]!==typeof e[1]){throw new s("Low and high value must have the same type")}var t=this.oFormatOptions.type;if(t){if(t.isA("sap.ui.model.odata.type.Time")){t.validateValue(f(e[0]))}else{t.validateValue(e[0])}if(e.length===2&&e[1]!==null){if(t.isA("sap.ui.model.odata.type.Time")){t.validateValue(f(e[1]))}else{t.validateValue(e[1])}}}if(typeof e[0]==="number"){if(e.length===2&&e[1]!==null&&e[0]>e[1]){throw new s("Low value must be smaller than high value")}}else if(e[0]instanceof Date){if(e.length===2&&e[1]instanceof Date&&e[0]>e[1]){throw new s("Low value must be smaller than high value")}}};o.prototype._handleLocalizationChange=function(){delete this._sPattern;delete this._sDelimiter};function u(t){if(this.oFormatOptions.delimiter){return"{0} "+this.oFormatOptions.delimiter+" {1}"}else if(!this._sPattern){var a=new i(e.getLanguageTag());var n=l.getInstance(a);if(t&&(t.isA("sap.ui.model.type.Time")||t.isA("sap.ui.model.odata.type.Time")||t.isA("sap.ui.model.type.Date")||t.isA("sap.ui.model.odata.type.Date")||t.isA("sap.ui.model.type.DateTime")||t.isA("sap.ui.model.odata.type.DateTime")||t.isA("sap.ui.model.odata.type.DateTimeOffset")||t.isA("sap.ui.model.odata.type.TimeOfDay"))){this._sPattern=n.getIntervalPattern()}else{this._sPattern=n.getMiscPattern("range")}return this._sPattern}else{return this._sPattern}}function p(e){if(this.oFormatOptions.delimiter){return this.oFormatOptions.delimiter}else if(!this._sDelimiter){var t=u.call(this,e);this._sDelimiter=t.replace(/\{0\}/g,"").replace(/\{1\}/g,"");return this._sDelimiter}else{return this._sDelimiter}}function f(e){if(e instanceof Date){e=t.localToUtc(e);return t.dateToEdmTime(e)}else{return e}}function m(e){var i;if(e&&e.ms){i=t.edmTimeToDate(e);return t.utcToLocal(i)}else{return e}}return o});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/ComboBoxUtils", ["sap/ui/comp/util/FormatUtil"],function(t){"use strict";return{formatDisplayBehaviour:function(r,e){var i,n,a,o,p,u,s,f;if(r===null||r===undefined||!e){return}u=r.getKey();s=r&&r.getBindingInfo("text");if(u!==""&&s&&Array.isArray(s.parts)){o=s.parts[0].path;if(s.parts[1]){p=s.parts[1].path}f=r.getBindingContext();n=o&&f.getProperty(o);a=p&&f.getProperty(p);if(u!==n){return}i=t.getFormattedExpressionFromDisplayBehaviour(e,n,a)}return i}}});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/DateRangeTypeUtils", ["sap/ui/comp/config/condition/DateRangeType"],function(e){"use strict";var t={_calculateDateRangeValues:function({columnKey:t,dateFormatSettings:n,conditionTypeInfo:i,fieldViewMetadata:o}){const a=Object.assign({},o,{ui5Type:o.modelType});if(!i){return null}const l={_oDateFormatSettings:n||{UTC:true},_getType:()=>a.ui5Type,_createFilterControlId:()=>"fakeFilterControlId"},u=new e(t,l,a);u.getControls=()=>{};u.initialize({items:[],value:null});u.setCondition(i);const r=u.getFilterRanges();if(r&&r.length>0){return{oValue1:r[0].value1,oValue2:r[0].value2}}u?.destroy?.();return null}};return t});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/DateTimeUtil", ["sap/base/i18n/Localization","sap/ui/core/date/UI5Date","sap/ui/core/format/TimezoneUtil"],function(e,t,n){"use strict";var i=/^\/Date\((-?\d+)(\+|-)?(\d+)?\)\/$/,o=e.getTimezone();var a={localToUtc:function(e){var n,i="0",o=e.getFullYear().toString().padStart(4,i)+"-"+(e.getMonth()+1).toString().padStart(2,i)+"-"+e.getDate().toString().padStart(2,i)+"T00:00:00.000Z";n=t.getInstance(o);n.setUTCHours(e.getHours());n.setUTCMinutes(e.getMinutes());n.setUTCSeconds(e.getSeconds());n.setUTCMilliseconds(e.getMilliseconds());return n},utcToLocal:function(e){var n,i="0",o=e.getUTCFullYear().toString().padStart(4,i)+"-"+(e.getUTCMonth()+1).toString().padStart(2,i)+"-"+e.getUTCDate().toString().padStart(2,i)+"T00:00:00.000";n=t.getInstance(o);n.setHours(e.getUTCHours());n.setMinutes(e.getUTCMinutes());n.setSeconds(e.getUTCSeconds());n.setMilliseconds(e.getUTCMilliseconds());return n},dateToEdmTime:function(e){return{__edmType:"Edm.Time",ms:e.valueOf()}},edmTimeToDate:function(e){return t.getInstance(e.ms)},adaptPrecision:function(e,n){var i=e.getMilliseconds(),o;if(isNaN(n)||n>=3||i===0){return e}if(n===0){i=0}else if(n===1){i=Math.floor(i/100)*100}else if(n===2){i=Math.floor(i/10)*10}o=t.getInstance(e);o.setMilliseconds(i);return o},isDate:function(e,t){if(t){return e.getUTCHours()===0&&e.getUTCMinutes()===0&&e.getUTCSeconds()===0&&e.getUTCMilliseconds()===0}else{return e.getHours()===0&&e.getMinutes()===0&&e.getSeconds()===0&&e.getMilliseconds()===0}},_isValidDateObject:function(e){return e&&Object.prototype.toString.call(e)==="[object Date]"&&!isNaN(e)},normalizeDate:function(e,n){var i;if(this.isDate(e,n)){return e}i=t.getInstance(e);if(n){i.setUTCHours(0,0,0,0)}else{i.setHours(0,0,0,0)}return i},toTimezone:function(e,i){if(!(e instanceof Date)){e=t.getInstance(e)}if(n.isValidTimezone(i)){return n.convertToTimezone(e,i)}return e},localToUiTimezone:function(e){var n=t.getInstance(e.toLocaleString("en-US",{timeZone:o}));var i=e.getTime()-n.getTime();return t.getInstance(e.getTime()-i)},uiTimezoneToLocal:function(e){if(!(e instanceof Date)){e=t.getInstance(e)}var n=t.getInstance(e.toLocaleString("en-US",{timeZone:o}));var i=n.getTime()-e.getTime();return t.getInstance(e.getTime()-i)},uiTimezoneToUtc:function(e){var n=t.getInstance(e.toLocaleString("en-US",{timeZone:"UTC"}));var i=t.getInstance(e.toLocaleString("en-US",{timeZone:o}));var a=i.getTime()-n.getTime();return t.getInstance(e.getTime()-a)},localToTimezone:function(e,i){if(!n.isValidTimezone(i)){return e}var a=t.getInstance(e.toLocaleString("en-US",{timeZone:i}));var r=t.getInstance(e.toLocaleString("en-US",{timeZone:o}));var s=r.getTime()-a.getTime();return t.getInstance(e.getTime()-s)},_parseJsonDateString:function(e){var n=e&&i.exec(e);if(n){var o=t.getInstance(parseInt(n[1]));if(n[2]){var a=parseInt(n[3]);if(n[2]==="-"){a=-a}var r=o.getUTCMinutes();o.setUTCMinutes(r-a);o.__edmType="Edm.DateTimeOffset"}if(!isNaN(o.valueOf())){return o}}},_hasJsonDateString:function(e){return i.test(e)}};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FilterUtil", [],function(){"use strict";return{getTransformedExcludeOperation:function(t){var n={EQ:"NE",GE:"LT",LT:"GE",LE:"GT",GT:"LE",BT:"NB",Contains:"NotContains",StartsWith:"NotStartsWith",EndsWith:"NotEndsWith"}[t];return n?n:t}}});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FormatUtil", ["sap/ui/core/format/NumberFormat","sap/ui/core/format/DateFormat","sap/ui/comp/p13n/P13nConditionPanelBase","sap/ui/comp/odata/ODataType","sap/ui/model/odata/type/Currency","sap/ui/model/odata/type/Unit","sap/base/strings/whitespaceReplacer","sap/ui/model/FilterOperator"],function(e,t,r,n,i,a,o,u){"use strict";var s={CHAR_FIGURE_SPACE:"",CHAR_PUNCTUATION_SPACE:"",MAX_CURRENCY_DIGITS:3,getFormattedExpressionFromDisplayBehaviour:function(e,t,r){return s.getFormatterFunctionFromDisplayBehaviour(e)(t,r)},getFormatterFunctionFromDisplayBehaviour:function(e,t,r){var n=t?"Whitespace":"";var i=r?"OverrideNoData":"";if(i){switch(e){case"descriptionAndId":return s["_get"+i+"TextFormatterForDescriptionAndId"].bind(r);case"idAndDescription":return s["_get"+i+"TextFormatterForIdAndDescription"].bind(r);case"descriptionOnly":return s["_get"+i+"TextFormatterForDescriptionOnly"].bind(r);default:return s["_get"+i+"TextFormatterForIdOnly"].bind(r)}}switch(e){case"descriptionAndId":return s["_get"+n+i+"TextFormatterForDescriptionAndId"];case"idAndDescription":return s["_get"+n+i+"TextFormatterForIdAndDescription"];case"descriptionOnly":return s["_get"+n+i+"TextFormatterForDescriptionOnly"];default:return s["_get"+n+i+"TextFormatterForIdOnly"]}},_processText:function(e,t){if(t){return e}return e.secondText?e.firstText+" ("+e.secondText+")":e.firstText},_getTextFormatterForDescriptionAndId:function(e,t,r){return s._processText({firstText:t?t:e,secondText:t?e:undefined},r)},_getTextFormatterForIdAndDescription:function(e,t,r){return s._processText({firstText:e,secondText:t?t:undefined},r)},_getTextFormatterForDescriptionOnly:function(e,t,r){return s._processText({firstText:t,secondText:undefined},r)},_getTextFormatterForIdOnly:function(e,t,r){return s._processText({firstText:e,secondText:undefined},r)},_getWhitespaceTextFormatterForDescriptionAndId:function(e,t,r){return o(s._getTextFormatterForDescriptionAndId.apply(s,arguments))},_getWhitespaceTextFormatterForIdAndDescription:function(e,t,r){return o(s._getTextFormatterForIdAndDescription.apply(s,arguments))},_getWhitespaceTextFormatterForDescriptionOnly:function(e,t,r){return o(s._getTextFormatterForDescriptionOnly.apply(s,arguments))},_getWhitespaceTextFormatterForIdOnly:function(e,t,r){return o(s._getTextFormatterForIdOnly.apply(s,arguments))},_getOverrideNoDataTextFormatterForDescriptionAndId:function(e,t,r){if(e==""&&t==""){return this.getNotAssignedText()}return s._getTextFormatterForDescriptionAndId.apply(s,arguments)},_getOverrideNoDataTextFormatterForIdAndDescription:function(e,t,r){if(e==""&&t==""){return this.getNotAssignedText()}return s._getTextFormatterForIdAndDescription.apply(s,arguments)},_getOverrideNoDataTextFormatterForDescriptionOnly:function(e,t,r){if(t==""){return this.getNotAssignedText()}return s._getTextFormatterForDescriptionOnly.apply(s,arguments)},_getOverrideNoDataTextFormatterForIdOnly:function(e,t,r){if(e==""){return this.getNotAssignedText()}return s._getTextFormatterForIdOnly.apply(s,arguments)},getTextsFromDisplayBehaviour:function(e,t,r){return s.getFormatterFunctionFromDisplayBehaviour(e)(t,r,true)},getFormattedRangeText:function(e,t,n,i){return r.getFormatedConditionText(e,t,n,i)},_initialiseCurrencyFormatter:function(){if(!s._oCurrencyFormatter){s._oCurrencyFormatter=e.getCurrencyInstance({showMeasure:false})}if(!s._fAmountCurrencyFormatter){s._fAmountCurrencyFormatter=function(e,t){var r,n;r=s._oCurrencyFormatter.format(e,t);n=s._oCurrencyFormatter.oLocaleData.getCurrencyDigits(t);return s._applyPadding(r,n,s.MAX_CURRENCY_DIGITS)}}},_getUnitFormatter:function(t,r){const n={showMeasure:false,maxFractionDigits:3,minFractionDigits:0,preserveDecimals:t};if(!isNaN(r)){r=parseInt(r)}if(r>=0&&r<=3){n.maxFractionDigits=n.minFractionDigits=r}return e.getUnitInstance(n)},_applyPadding:function(e,t,r){var n;if(typeof e!=="string"){return""}if(t===0&&r>0){e+=s.CHAR_PUNCTUATION_SPACE}n=r-t;if(n){e=e.padEnd(e.length+n,s.CHAR_FIGURE_SPACE)}return e},_getFractionDigitDifference:function(e,t,r,n){if(!t){return 0}var i=t.indexOf(e.oOutputFormat.oFormatOptions.decimalSeparator);if(i<0){return 0}var a=t.substr(i+1).length;if(a<=n&&a>r){return a-r}if(a>n&&r<n){return n-r}return 0},getAmountCurrencyFormatter:function(e){var t=0,r,n;s._initialiseCurrencyFormatter();return function(i,a,o){var u,c;if(i===undefined||i===null||a==="*"){return""}if(!o){return s._fAmountCurrencyFormatter(i,a)}if(!n){n=o;t=s._getMaxCurrencyFractionDigits(n);if(!r){r=s._getCurrencyInstance(e)}}c=n&&n[a]?n[a].UnitSpecificScale:s._oCurrencyFormatter.oLocaleData.getCurrencyDigits(a);u=r.formatValue([i,a||null,n],"string");if(e){c+=s._getFractionDigitDifference(r,u,c,t)}return s._applyPadding(u,c,t)}},_getMaxCurrencyFractionDigits:function(e){var t=0;for(var r in e){if(e[r].UnitSpecificScale&&e[r].UnitSpecificScale>t){t=e[r].UnitSpecificScale}}return t},_getCurrencyInstance:function(e){return new i({showMeasure:false,preserveDecimals:e})},getCurrencySymbolFormatter:function(){s._initialiseCurrencyFormatter();if(!s._fCurrencySymbolFormatter){s._fCurrencySymbolFormatter=function(e){if(!e||e==="*"){return""}return s._oCurrencyFormatter.oLocaleData.getCurrencySymbol(e)}}return s._fCurrencySymbolFormatter},getMeasureUnitFormatter:function(e,t){const r=s._getUnitFormatter(e,t);var n=0,i,a;return function(t,o,u){if(t===undefined||t===null||o==="*"){return""}if(u){if(!a){a=u;n=s._getMaxMeasureUnitFractionDigit(a);if(!i){i=s._getUnitInstance(e,n)}}t=i.formatValue([t,o,a],"string");var c=a[o]?.UnitSpecificScale!=null?a[o].UnitSpecificScale:n;if(e){c+=s._getFractionDigitDifference(i,t,c,n)}return s._applyPadding(t,c,n)}return r.format(t,o)+s.CHAR_FIGURE_SPACE}},getInlineMeasureUnitFormatter:function(e){var t=0,r,n;if(!s._fInlineMeasureFormatter){s._fInlineMeasureFormatter=function(e,t){if(e===undefined||e===null||t==="*"){return""}if(!t){return e}return e+s.CHAR_FIGURE_SPACE+t}}return function(i,a,o){if(o){if(!n){n=o;t=s._getMaxMeasureUnitFractionDigit(n);if(!r){r=s._getUnitInstance(e,t)}}i=r.formatValue([i,a,n],"string");return i+s.CHAR_FIGURE_SPACE+a}return s._fInlineMeasureFormatter(i,a)}},_getUnitInstance:function(e,t){return new a({showMeasure:false,preserveDecimals:e,maxFractionDigits:t})},_getMaxMeasureUnitFractionDigit:function(e){let t=0;for(const n in e){var r=e[n].UnitSpecificScale;if(r>3){r=3}if(t<3&&r>t&&r<=3){t=r}}return t},_extractCompositeKey:function(e){if(!e){return}const t=/\(([^]+)\)/;const r=t.exec(e);if(r&&r[1]){const e=r[1].split(",").reduce(function(e,t){const[r,n]=t.split("=");if(r&&n){const t=n.startsWith("guid")?n.replace(/'$/g,""):n.replace(/^'|'$/g,"");e[r]=t}return e},{});return e}},getInlineAmountFormatter:function(e){var t,r;s._initialiseCurrencyFormatter();if(!s._fInlineAmountFormatter){s._fInlineAmountFormatter=function(e,t){var r;if(e===undefined||e===null||t==="*"){return""}r=s._oCurrencyFormatter.format(e,t);return r+s.CHAR_FIGURE_SPACE+t}}return function(n,i,a){if(n===undefined||n===null||i==="*"){return""}if(!a){return s._fInlineAmountFormatter(n,i)}if(!r){r=a;if(!t){t=s._getCurrencyInstance(e)}}var o=t.formatValue([n,i||null,r],"string");return o+s.CHAR_FIGURE_SPACE+i}},getInlineGroupFormatterFunction:function(e,t,r,i,a,o){var u=e.type==="Edm.String"&&!e.isCalendarDate&&!e.isDigitSequence;if(e.unit){return s.getRelevantUnitFormatterFunction(o,e,i)}else if(!t&&(u||e.displayBehaviour!=="idOnly")&&e.description){const t=s.getFormatterFunctionFromDisplayBehaviour(e.displayBehaviour,a);if(e.isDigitSequence&&e.modelType){return function(r,n){const i=e.modelType.formatValue(r,"string");return t(i,n)}}return t}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"&&r&&r["UTC"]){var c={displayFormat:"Date"};var f={isCalendarDate:e.isCalendarDate};var m=n.getType(e.type,r,c,f);return function(e){return m.formatValue(e,"string")}}else if(e.modelType){return function(t){return e.modelType.formatValue(t,"string")}}},getWidth:function(e,t,r){var n=e.maxLength||e.precision,i,a;if(!t){t=30}if(!r){r=3;a=true}if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"||e.isCalendarDate){n="9em"}else if(n){if(e.type==="Edm.String"&&e.description&&e.displayBehaviour&&(e.displayBehaviour==="descriptionAndId"||e.displayBehaviour==="descriptionOnly")){n="Max"}if(n==="Max"){n=t+""}i=parseInt(n);if(!isNaN(i)){i+=.75;if(i>t){i=t}else if(i<r){i=r}n=i+"em"}else{n=null}}if(!n){if(e.type==="Edm.Boolean"){if(a){r+=.25}n=r+"em"}else{n=t+"em"}}return n},getEdmTimeFromDate:function(e){if(!s._oTimeFormat){s._oTimeFormat=t.getTimeInstance({pattern:"'PT'HH'H'mm'M'ss'S'"})}return s._oTimeFormat.format(e)},parseFilterNumericIntervalData:function(e){var t=[],r=e.match(RegExp("^(-?[^-]*)-(-?[^-]*)$"));if(r&&r.length>=2){t.push(r[1]);t.push(r[2])}return t},parseDateTimeOffsetInterval:function(e){var t=e.split("-"),r=[e],n=0;if(t.length%2===0){r=[];for(var i=0;i<t.length/2;i++){n=e.indexOf("-",++n)}r.push(e.substr(0,n).replace(/\s+/g,""));r.push(e.substr(n+1).replace(/\s+/g,""))}return r},_getFilterType:function(e){if(e.isFiscalDate){return"date"}else if(e.isCalendarType&&e.calendarType){return"date"}else if(e.isDigitSequence){return"numc"}else if(n.isNumeric(e.type)){return"numeric"}else if(e.type==="Edm.DateTime"&&e.displayFormat==="Date"){return"date"}else if(e.type==="Edm.DateTimeOffset"){return"datetime"}else if(e.type==="Edm.String"){if(e.isCalendarDate){return"stringdate"}return"string"}else if(e.type==="Edm.Guid"){return"guid"}else if(e.type==="Edm.Boolean"){return"boolean"}else if(e.type==="Edm.Time"){return"time"}return undefined},getWhitespaceReplacer:function(e){return e?o:undefined},getDateTimeWithTimezoneFormatter:function(e){if(!e&&!s._oDateTimeWithTimezone){s._oDateTimeWithTimezone=t.getDateTimeWithTimezoneInstance()}return function(r,n){if(!r){return""}return e?t.getDateTimeWithTimezoneInstance(e).format(r,n):s._oDateTimeWithTimezone.format(r,n)}},getRelevantUnitFormatterFunction:function(e,t,r){var n,i=t.isCurrencyField,a=i?s.getInlineAmountFormatter(r):s.getInlineMeasureUnitFormatter(r);if(e){if(i){e.requestCurrencyCodes().then(function(e){n=e})}else{e.requestUnitsOfMeasure().then(function(e){n=e})}}return function(e,r){if(!n){if(i){return a(e,r)}if(t.modelType){e=t.modelType.formatValue(e,"string")}return a(e,r)}return a(e,r,n)}},adaptMilliseconds:function(e,t,r){if(t&&t>3){var n=t-3,i="9".repeat(n);if(r===u.BT||r===u.NB){e.appendFractionalSeconds2(i)}else if(r===u.LT||r===u.LE){e.appendFractionalSeconds1(i)}}return e}};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/FullScreenUtil", ["sap/ui/thirdparty/jquery","sap/m/Dialog","sap/ui/core/HTML"],function(jQuery,e,l){"use strict";var o={toggleFullScreen:function(o,a,n,i,r,t){var g;if(a){g=o.$();g.css("height","100%");if(g){if(!o._oHTML){o._oHTML=new l({preferDOM:false,afterRendering:function(){if(o&&o._oHTML){var e=o._oHTML.$(),l;if(e){l=e.children();l.remove();e.css("height","100%");e.append(o.getDomRef())}}}})}if(!o._oFullScreenDialog){o._oFullScreenDialog=new e({showHeader:false,stretch:true,horizontalScrolling:!t,verticalScrolling:!t,beforeClose:function(){if(o&&o._$placeHolder&&i){i.call(o,false)}},content:[o._oHTML]});if(r){o._oFullScreenDialog.addStyleClass(r)}if(n){o._oFullScreenDialog.attachAfterOpen(function(){n.focus();if(o._oGrowingDelegate&&o._oGrowingDelegate.onAfterRendering){o._oOldParent=o.oParent;o.oParent=o._oFullScreenDialog;o._oGrowingDelegate.onAfterRendering();o.oParent=o._oOldParent;delete o._oOldParent}});o._oFullScreenDialog.attachAfterClose(function(){n.focus()})}o._oFullScreenDialog.addStyleClass(g.closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"");o._oFullScreenDialog.addStyleClass("sapUiCompSmartFullScreenDialog")}o._$placeHolder=jQuery(document.createElement("div"));g.before(o._$placeHolder);o._oHTML.setContent("<div></div>")}if(!o._oGrowingDelegate){o._oGrowingDelegate=o._oTable||o._oList;if(o._oGrowingDelegate&&o._oGrowingDelegate.getGrowingScrollToLoad&&o._oGrowingDelegate.getGrowingScrollToLoad()){o._oGrowingDelegate=o._oGrowingDelegate._oGrowingDelegate}else{o._oGrowingDelegate=null}}if(o._oTable&&o._oTable.isA("sap.ui.table.Table")){o._oFullScreenDialog.attachEventOnce("afterOpen",function(){o._oTable.invalidate()})}o._oFullScreenDialog.open()}else if(o._$placeHolder&&o._oHTML){var c=o.getHeight&&o.getHeight();var _=o.$();if(c&&c!==_.css("height")){_.css("height",c)}g=o._oHTML.$();o._$placeHolder.replaceWith(g.children());o._$placeHolder=null;g=null;if(o._oFullScreenDialog){o._oFullScreenDialog.close()}}},cleanUpFullScreen:function(e){if(e._oFullScreenDialog){e._oFullScreenDialog.destroy();e._oFullScreenDialog=null}e._$placeHolder=null;e._oHTML=null;e._oGrowingDelegate=null}};return o},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/IdentifierUtil", ["sap/ui/base/DataType"],function(e){"use strict";var a={replace:function(a){var i=e.getType("sap.ui.core.ID");if(!i.isValid(a)){a=a.replace(/[^A-Za-z0-9_.:]+/g,"_");if(!i.isValid(a)){a="A_"+a}}return a}};return a},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/MultiUnitUtil", ["sap/m/table/Util","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/core/syncStyleClass","sap/base/util/merge"],function(e,t,r,a,n,i,o){"use strict";var l={isMultiUnit:function(e){return e==="*"},isNotMultiUnit:function(e){return e!=="*"},openMultiUnitPopover:async function(r,i){var l=t.getElementById(i.smartTableId);var s=l.getTable();var u=s.getBinding("rows");var p=i.value;var g=i.unit;var m,c;if(!u||!p||!g){return}var d=r.getSource();var v=d.getParent();if(i.additionalParent){v=v.getParent()}var f=s.getAnalyticalInfoOfRow(v.getParent());if(!f){return}var y,P=[],I=[p,g];if(u.aApplicationFilter){P=[].concat(u.aApplicationFilter)}var T=s.getBindingInfo("rows");var b=T&&T.parameters&&T.parameters.custom?o({},T.parameters.custom):undefined;if(f.groupTotal||f.group){var U=f.groupedColumns;for(y=0;y<U.length;y++){c=t.getElementById(U[y]).getLeadingProperty();if(!c){continue}m=u.getAnalyticalInfoForColumn(c);if(m){c=m.dimensionPropertyName}if(c){P.push(new a(c,n.EQ,f.context.getProperty(c)))}}}else if(!f.grandTotal){var w=Object.getOwnPropertyNames(u.getDimensionDetails());for(y=0;y<w.length;y++){P.push(new a(w[y],n.EQ,f.context.getProperty(w[y])))}}var B=t.getElementById(i.smartTableId+"-multiUnitPopover");var h=B?true:false;var E=i.smartTableId+"-multiUnitPopover";var F=B?B:E;var O={path:u.getPath(),filters:P,parameters:{select:I.join(","),custom:b}};var A={control:s,grandTotal:f.grandTotal,itemsBindingInfo:O,listItemContentTemplate:i.template};B=await e.createOrUpdateMultiUnitPopover(F,A);if(!h){s.addDependent(B)}B.openBy(d)}};return l},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/SharedUtil", ["sap/ui/comp/smartfield/SideEffectUtil"],function(e){"use strict";var i={applyFieldGroupIDs:function(i,r,t,o){var n,s,t,d;if(!i||!r){throw new Error("Missing control or metadata on applying the field group ids.")}if(!i.setFieldGroupIds){throw new Error("Control does not have setFieldGroupId method.")}if(!o){s=i}else{if(!o.isA("sap.ui.model.Context")){throw new Error("The provided context is incorrect type.")}s={getBindingContext:function(){return o}}}n=new e(s);if(!t){t=i.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){break}t=t.getParent()}if(!t||!t.isA("sap.ui.core.mvc.View")){throw new Error("Missing control's view on applying the field group ids.")}}d=n.getFieldGroupIDs(r,t);i.setFieldGroupIds(d);n.destroy();return d}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/util/TableUtil", [],function(){"use strict";var e={getCustomColumns:function(e){if(!e.isInitialised()){throw new Error("getCustomColumns method called before the SmartTable is initialized - "+e.getId())}return e._aExistingColumns.map(t=>e._getColumnByKey(t))},getRedundantProperties:function(e){const t=new Set,n=new Set(e._aColumnKeys);n.forEach(i=>{if(t.has(i)){return}const r=e._getColumnByKey(i);const o=r?.data("p13nData")??e._mLazyColumnMap[i];if(o?.displayBehaviour&&o?.description){if(n.has(o.description)){t.add(o.description)}}});return Array.from(t)}};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/valuehelpdialog/ItemsCollection", ["sap/ui/comp/util/FormatUtil","sap/ui/base/ManagedObject","sap/m/Token"],function(t,e,i){"use strict";var s=function(){this.items={}};s.prototype.add=function(t,e){this.items[t]=e};s.prototype.remove=function(t){delete this.items[t]};s.prototype.removeAll=function(){this.items={}};s.prototype.getItem=function(t){return this.items[t]};s.prototype.getItems=function(){var t=[];for(var e in this.items){t.push(e)}return t};s.prototype.getSelectedItemsTokenArray=function(s,o,r){var n=[];for(var a in this.items){var p=this.items[a];var u,f;if(typeof p==="string"){f=a;u=p}else{f=p[s];u=p[o];if(u===undefined){u=this.items[a];if(typeof u!=="string"){u=f}}else{if(!r){r="descriptionAndId"}u=t.getFormattedExpressionFromDisplayBehaviour(r,f,u)}}var m=new i({key:e.escapeSettingsValue(f)});m.setText(u);m.setTooltip(typeof u==="string"?u:"");if(typeof p!=="string"){m.data("row",p);m.data("longKey",e.escapeSettingsValue(a));a=t._extractCompositeKey(a);if(a){m.data("compositeKey",e.escapeSettingsValue(a))}}n.push(m)}return n};s.prototype.getModelData=function(){var t=[];for(var e in this.items){var i=this.items[e];if(typeof i==="string"){i={missing:e}}t.push(i)}return t};return s},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/valuehelpdialog/ValueHelpDialog", ["sap/ui/core/ControlBehavior","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/date/UI5Date","sap/base/Log","sap/ui/comp/library","sap/m/Dialog","sap/m/MessageBox","sap/m/Token","./ItemsCollection","sap/ui/core/library","sap/m/VBox","sap/m/HBox","sap/m/FlexBox","sap/ui/comp/util/FormatUtil","sap/m/FlexItemData","sap/m/Title","sap/m/Text","sap/m/Label","sap/m/Button","sap/m/Bar","sap/m/OverflowToolbarLayoutData","sap/m/Tokenizer","sap/m/Panel","sap/m/StandardListItem","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/library","sap/ui/core/InvisibleText","sap/ui/core/InvisibleMessage","sap/ui/core/IconPool","sap/ui/table/library","sap/ui/table/Table","sap/ui/table/Column","sap/ui/table/rowmodes/Type","sap/ui/table/rowmodes/Auto","sap/m/Table","sap/m/Column","sap/m/table/columnmenu/Menu","sap/m/table/columnmenu/QuickSort","sap/m/table/columnmenu/QuickSortItem","sap/ui/layout/HorizontalLayout","sap/ui/layout/Grid","sap/ui/Device","sap/m/List","sap/m/Link","sap/ui/comp/p13n/P13nFilterPanel","sap/ui/comp/p13n/P13nConditionPanel","sap/ui/comp/p13n/P13nItem","sap/ui/comp/p13n/P13nAnyFilterItem","sap/m/CheckBox","sap/ui/comp/p13n/P13nOperationsHelper","sap/ui/core/format/NumberFormat","sap/ui/core/ResizeHandler","sap/base/strings/whitespaceReplacer","sap/ui/table/plugins/MultiSelectionPlugin","sap/ui/comp/rules/RulesLog","sap/m/Toolbar","sap/ui/core/util/ResponsivePaddingsEnablement","sap/m/plugins/CellSelector","sap/m/ToolbarSpacer","sap/m/OverflowToolbar","sap/m/plugins/CopyProvider","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i,s,a,o,n,l,r,h,u,_,d,c,g,p,f,T,b,S,m,y,I,v,C,E,B,R,k,P,L,V,F,D,x,A,O,w,M,N,H,K,z,G,U,W,j,$,J,q,Q,Z,X,Y,ee,te,ie,se,ae,oe,ne,le,re,he,ue,_e){"use strict";var de;var ce;var ge=R.ButtonType;var pe=R.OverflowToolbarPriority;var fe=R.ListMode;var Te=R.ListType;var be=u.HorizontalAlign;var Se=u.InvisibleMessageMode;var me=u.TitleLevel;var ye=o.smartfilterbar.DisplayBehaviour;var Ie=u.ValueState;var ve=o.ValueHelpDeprecationCode;var Ce={DESKTOP_LIST_VIEW:"DESKTOP_LIST_VIEW",DESKTOP_CONDITIONS_VIEW:"DESKTOP_CONDITIONS_VIEW",PHONE_MAIN_VIEW:"PHONE_MAIN_VIEW",PHONE_SEARCH_VIEW:"PHONE_SEARCH_VIEW",PHONE_LIST_VIEW:"PHONE_LIST_VIEW",PHONE_CONDITIONS_VIEW:"PHONE_CONDITIONS_VIEW"};var Ee=n.extend("sap.ui.comp.valuehelpdialog.ValueHelpDialog",{metadata:{library:"sap.ui.comp",properties:{basicSearchText:{type:"string",group:"Misc",defaultValue:""},supportMultiselect:{type:"boolean",group:"Misc",defaultValue:true},supportRanges:{type:"boolean",group:"Misc",defaultValue:false},supportRangesOnly:{type:"boolean",group:"Misc",defaultValue:false},key:{type:"string",group:"Misc",defaultValue:""},keys:{type:"string[]",group:"Misc",defaultValue:null},descriptionKey:{type:"string",group:"Misc",defaultValue:""},maxIncludeRanges:{type:"string",group:"Misc",defaultValue:"-1",deprecated:true},maxExcludeRanges:{type:"string",group:"Misc",defaultValue:"-1",deprecated:true},maxConditions:{type:"string",group:"Misc",defaultValue:"-1"},displayFormat:{type:"string",group:"Misc",defaultValue:""},tokenDisplayBehaviour:{type:"string",group:"Misc",defaultValue:""},filterMode:{type:"boolean",group:"Misc",defaultValue:false},_enhancedExcludeOperations:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"},conditionPanelDefaultOperation:{type:"string",group:"Misc",defaultValue:null},enabledMultiSelectionPlugin:{type:"boolean",group:"Misc",defaultValue:false},_conditionPanelCalendarWeekSettings:{type:"string",group:"Misc",defaultValue:"",visibility:"hidden"},_conditionPanelShowCurrentDateButton:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"}},aggregations:{filterBar:{type:"sap.ui.comp.filterbar.FilterBar",multiple:false}},events:{ok:{parameters:{tokens:{type:"sap.m.Token[]"}}},cancel:{},selectionChange:{parameters:{tableSelectionParams:{type:"object"},updateTokens:{type:"object[]"},useDefault:{type:"boolean"},table:{type:"object"}}},tokenRemove:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean"}}},updateSelection:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean"}}}}},renderer:{apiVersion:2}});ae.call(Ee.prototype,{header:{suffix:"header"},subHeader:{selector:".compVHNavigationContainer .sapMITH"},content:{selector:".compVHContentContainer"},footer:{selector:".sapMDialogFooter .sapMIBar"}});Ee.prototype.setSupportMultiselect=function(e){this.setProperty("supportMultiselect",e);this._updatePropertySupportMultiselect(e);this._oTokenizerGrid.setVisible(e);this._oButtonOk.setVisible(e);return this};Ee.prototype._updatePropertySupportMultiselect=function(e){if(!this._oTable){return undefined}if(!this._isPhone()){if(this._oTable.setSelectionMode){this._oTable.setSelectionMode(e?V.SelectionMode.MultiToggle:V.SelectionMode.Single)}}else if(this._oTable.setMode){this._oTable.setMode(e?fe.MultiSelect:fe.SingleSelectLeft)}return this};Ee.prototype.setSupportRanges=function(e){this.setProperty("supportRanges",e);this._updateNavigationControl();return this};Ee.prototype.setSupportRangesOnly=function(e){this.setProperty("supportRangesOnly",e);this._updateNavigationControl();return this};Ee.prototype.setTitle=function(e){this.setProperty("title",e);this._updateDlgTitle();return this};Ee.prototype.setFilterBar=function(e){this.setAggregation("filterBar",e);if(this._oMainLayout&&e){if(this._isPhone()){if(this._oFilterBar){this._oContentContainer.removeItem(this._oFilterBar);this._oFilterBar.detachInitialise(this._handleFilterBarInitialize)}}else if(this._oFilterBar){this._oMainLayout.removeItem(this._oFilterBar);this._oFilterBar.detachInitialise(this._handleFilterBarInitialize)}this._oFilterBar=e;this._oFilterBar.attachInitialise(this._handleFilterBarInitialize,this);if(this._oFilterBar){this._oFilterBar.addStyleClass("compVHSearch");if(this._isPhone()){var i=t.getElementById(this._oFilterBar.getBasicSearch());if(i&&i.isA("sap.m.SearchField")){i.setShowSearchButton(true);i.attachSearch(function(e){if(e.mParameters.refreshButtonPressed!==undefined){this.getFilterBar().search()}}.bind(this))}this._oFilterBar.setShowGoOnFB(false);this._oColSearchBox.setLayoutData(new p({shrinkFactor:0}));this._oContentContainer.insertItem(this._oColSearchBox,0);this._oFilterBar.setLayoutData(new p({shrinkFactor:0}));this._oContentContainer.insertItem(this._oFilterBar,1);this._oFilterBar.attachSearch(function(e){this._updateView(Ce.PHONE_LIST_VIEW)}.bind(this));if(this._currentViewMode===Ce.PHONE_LIST_VIEW){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false);this._handleFilterBarInitialize()}}else{this._oFilterBar._setCollectiveSearch(this._oColSearchBox);this._oMainLayout.insertItem(this._oFilterBar,0)}}if(ke(this._oTabBar)&&this._oFilterBar?._oBasicSearchField?.getValueState?.()!==Ie.Error){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar.getAggregation("_searchButton")){this.setInitialFocus(this._oFilterBar.getAggregation("_searchButton"))}if(this._oFilterBar._oBasicSearchField){var s=this._oFilterBar._oBasicSearchField;s.setValue(this.getBasicSearchText());if(!ke(this._oTabBar)){this.setInitialFocus(s)}}}return this};Ee.prototype._handleFilterBarInitialize=function(){if(this._currentViewMode===Ce.PHONE_LIST_VIEW){var e=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(e);this._oFilterBar.setShowGoOnFB(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()))}this._setToolbarSpacerWidth();if(ke(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this.setInitialFocus(this._oFilterBar._oBasicSearchField)}};Ee.prototype.getFilterBar=function(){return this._oFilterBar};Ee.prototype.setBasicSearchText=function(e){this.setProperty("basicSearchText",e);if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this._oFilterBar._oBasicSearchField.setValue(e)}return this};Ee.prototype.setTokens=function(e){var t=true;if(e.length){var i=0,s;for(var o=0;o<e.length;o++){var n=e[o];if(n.data("range")){var l=Object.assign({},n.data("range"));s=n.getKey();if(!s){do{s="range_"+i;i++}while(this._oSelectedRanges[s])}var h=this._getFormatedRangeTokenText(l.operation,l.value1,l.value2,l.exclude,l.keyField);this._addToken2Tokenizer(s,h,this._getTokenizer(),l.keyField);this._oSelectedRanges[s]=l;t=false}else{s=n.getKey();var u=n.getText();var _=n.data("longKey");var d=n.data("compositeKey");var c=n.data("row");if(!_){_=s}var p=new r(Re.call(this,_));if(!d){d=g._extractCompositeKey(_)}let e;if(typeof d==="object"&&Object.keys(d).length>0&&this.getKeys()?.length>1){try{e=JSON.stringify(d)}catch(e){a.error(`JSON.stringify throws an exception: ${e.message}`)}}e=e?e:_;p.setKey(e);this._oSelectedItems.add(e,c?c:n.getText());p.setText(u);p.setTooltip(u);this._getTokenizer().addToken(p)}}}else{this._oSelectedItems.removeAll();this._oSelectedRanges={};this._getTokenizer().destroyTokens()}if(t){this._updateTokenizer()}};Ee.prototype.open=function(){var e,t,i,s,a;if(!this._oTable&&!(this._isPhone()&&(this.getSupportRangesOnly()||this.getFilterMode()))){return Be.call(this).then(function(){return this.open()}.bind(this))}this._bIgnoreSelectionChange=false;if(this._oColSearchBox){this._bIsMdcCollectiveSearch=this._oColSearchBox.isA("sap.ui.mdc.valuehelp.CollectiveSearchSelect");if(this._bIsMdcCollectiveSearch){this.bCollectiveSearchActive=this._oColSearchBox.getVisible()}else{this.bCollectiveSearchActive=this.oSelectionTitle.getVisible()&&this.oSelectionButton.getVisible();this._oColSearchBox.setVisible(this.bCollectiveSearchActive)}}if(!this._isPhone()){if(this.getSupportRangesOnly()||this.getFilterMode()){this._updateView(Ce.DESKTOP_CONDITIONS_VIEW)}if(this.isPropertyInitial("contentWidth")){this.setContentWidth(this._getDefaultContentWidth())}}else{this._updateView(Ce.PHONE_MAIN_VIEW)}this.addStyleClass("sapUiResponsivePadding--header sapUiResponsivePadding--subHeader sapUiResponsivePadding--content sapUiResponsivePadding--footer");n.prototype.open.apply(this);if(ke(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this.setInitialFocus(this._oFilterBar._oBasicSearchField)}else if(!this._oFilterBar&&this._currentViewMode==="DESKTOP_CONDITIONS_VIEW"){if(this._oFilterPanel){e=this._oFilterPanel&&this._oFilterPanel._oConditionPanel;t=e&&e._oConditionsGrid;i=t&&t.getAggregation("content")[0];s=t&&i.operation;if(s&&s.getEnabled()){this.setInitialFocus(s)}else{a=i.value1;this.setInitialFocus(a)}}}return this};Ee.prototype.getTable=function(){a.warning("Please use getTableAsync to prevent synchronous calls.",this);if(!this._oTable){this._createDefaultTable()}return this._oTable};Ee.prototype.getTableAsync=function(){if(this._oTablePromise){return this._oTablePromise}else if(!this._oTable){return Be.call(this)}else{return new Promise(function(e){e(this._oTable)}.bind(this))}};Ee.prototype._handleSmartTable=function(e){e.attachBeforeRebindTable(function(){var t=e.getTable();if(t&&t.isA("sap.ui.table.Table")){t.attachEventOnce("rowsUpdated",this._updateTableTitle.bind(this))}}.bind(this))};Ee.prototype.setTable=function(e){if(this._oTable){this._oMainLayout.removeItem(this._oTable);if(this._bTableCreatedInternal){this._oTable.destroy();this._oTable=null}}this._bTableCreatedInternal=arguments.length>1&&arguments[1]==true;if(e&&e.isA("sap.ui.comp.smarttable.SmartTable")){this._oTable=e.getTable();this._handleSmartTable(e)}else{this._oTable=e}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._oTable.setEnableBusyIndicator(true);if(this._oTable.isA("sap.ui.table.AnalyticalTable")){de=sap.ui.require("sap/ui/table/AnalyticalColumn")}}this._oTable.setLayoutData(new p({shrinkFactor:0,growFactor:1}));this.theTable=this._oTable;this._initializeTable();this._oMainLayout.addItem(e)};Ee.prototype._getDefaultContentWidth=function(){var e;if(G.system.desktop){e=1080}else if(G.system.tablet){if(G.orientation.landscape){e=920}else if(G.orientation.portrait){e=600}}return e+"px"};Ee.prototype.resetTableState=function(){if(this._oTable){if(this._oTable.unbindRows){this._oTable.unbindRows()}this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"))}};Ee.prototype._recreateTable=function(){this._oDefaultSmartTable&&this._oDefaultSmartTable.destroy();this._oTable&&this._oTable.destroy();this._oTablePromise=null;this._oDefaultSmartTable=null;this._oTable=null;this._initCopyProvider();return Be.call(this).then(()=>{if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){Pe(this._oTable,x.Auto)}return this._oTablePromise})};Ee.prototype.TableStateSearchData=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"))};Ee.prototype._updateNoDataText=function(e){if(this._oTable){if(this._oTable.setNoData){this._oTable.setNoData(e)}else if(this._oTable.setNoDataText){this._oTable.setNoDataText(e)}}};Ee.prototype.TableStateDataFilled=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_NODATA"))};Ee.prototype.TableStateDataSearching=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_SEARCHING"))};Ee.prototype.init=function(){n.prototype.init.apply(this);this._oTokenIdCount={};this._bTableCreatedInternal=false;this._aIncludeRangeOperations={};this._aExcludeRangeOperations={};this._iMaxIncludeRanges=-1;this._iMaxExcludeRanges=-1;this._bInitTokensHaveChanged;this.setStretch(this._isPhone());this.setResizable(!this._isPhone());this.setDraggable(!this._isPhone());this.bCollectiveSearchActive=false;this.addStyleClass("compValueHelpDialog");this._oRb=i.getResourceBundleFor("sap.ui.comp");this._sTableTitle1=this._oRb.getText("VALUEHELPDLG_TABLETITLE1");this._sTableTitle2=this._oRb.getText("VALUEHELPDLG_TABLETITLE2");this._sSmartTableTableTitle=this._oRb.getText("VALUEHELPDLG_TABLETITLE3");this._sTableTitleNoCount=this._oRb.getText("VALUEHELPDLG_TABLETITLENOCOUNT");this._currentViewMode=null;this._oSelectedItems=new h;this._oSelectedRanges={};this._oOperationsHelper=new Z;this._fnRejectTablePromise;this.update=this.update.bind(this);this._createHeaderBar();this._createCollectiveSearch();this._createTokenizer();this._updateTokenizer();this._oNavigationContainer=new _(this.getId()+"-navigationContainer",{width:"100%",layoutData:new p({growFactor:0,shrinkFactor:0})}).addStyleClass("compVHNavigationContainer");this._oContentContainer=new _(this.getId()+"-vbox",{width:"100%",height:"100%"}).addStyleClass("compVHContentContainer");this._oContainersWrapper=new c(this.getId()+"-containersWrapper",{alignItems:"Start",height:"100%",width:"100%",direction:"Column",justifyContent:"SpaceBetween",items:[this._oNavigationContainer,this._oContentContainer]});this.addContent(this._oContainersWrapper);this._oMainLayout=new _(this.getId()+"-mainLayout",{fitContainer:true,items:[this._oFilterBar],layoutData:new p({growFactor:1,shrinkFactor:0,styleClass:"mainLayout"})});this._createNavigationControl();this._updateNavigationControl();this._oContentContainer.addItem(this._oMainLayout);if(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode()){this._oContentContainer.addItem(this._oTokenizerGrid)}this._createFooterControls();this.setVerticalScrolling(false);this.setHorizontalScrolling(false);if(!G.system.desktop){this._oContentContainer.attachBrowserEvent("touchmove",function(e){e.setMarked()})}if(!this._isPhone()){this._updateView(Ce.DESKTOP_LIST_VIEW)}if(!this._oInvisibleMessage){this._oInvisibleMessage=P.getInstance()}this._oRulesLog=new ie;this._initCopyProvider();this._initResponsivePaddingsEnablement()};Ee.prototype._initCopyProvider=function(){this._oCopyProvider=new re({})};Ee.prototype._updateView=function(e){if(this._currentViewMode===e){return}switch(e){case Ce.DESKTOP_LIST_VIEW:this._validateRanges(function(){this._oTokenizerGrid.setVisible(this.getSupportMultiselect());this._oMainLayout.removeAllItems();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==Ce.DESKTOP_LIST_VIEW){this._oTabBar.setSelectedKey(Ce.DESKTOP_LIST_VIEW)}this._oMainLayout.addItem(this._oFilterBar);this._oMainLayout.addItem(this._oDefaultSmartTable||this._oTable);this._updateDlgTitle()}.bind(this),function(){this._oTabBar.setSelectedKey(Ce.DESKTOP_CONDITIONS_VIEW);this._updateView(Ce.DESKTOP_CONDITIONS_VIEW)}.bind(this));break;case Ce.DESKTOP_CONDITIONS_VIEW:if(this.getSupportRanges()){this._oMainLayout.removeAllItems();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==Ce.DESKTOP_CONDITIONS_VIEW){this._oTabBar.setSelectedKey(Ce.DESKTOP_CONDITIONS_VIEW)}this._createAddRanges();this._oButtonOk.setVisible(this.getSupportRangesOnly()||this.getSupportMultiselect());this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false)}}break;case Ce.PHONE_MAIN_VIEW:this.setVerticalScrolling(false);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(true);this._updateNavigationControl();this._oAdvancedSearchLink.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false);this._oFilterBar.setFilterBarExpanded(false)}if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false)}if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(false);this._bNoneMainView=false;if(!(this._oSelectItemLI.getVisible()&&this._oDefineConditionsLI.getVisible())){this._bNoneMainView=true;if(this._oSelectItemLI.getVisible()){this._updateView(Ce.PHONE_LIST_VIEW)}if(this._oDefineConditionsLI.getVisible()){this._updateView(Ce.PHONE_CONDITIONS_VIEW)}return}break;case Ce.PHONE_LIST_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(this.bCollectiveSearchActive);if(this._bIsMdcCollectiveSearch){this._oColSearchBox.addStyleClass("sapUiTinyMarginBegin");this._oColSearchBox.oVariantText.removeStyleClass("sapUiMdcCollectiveSearchSelectTextPhoneMaxWidth")}this._oMainListMenu.setVisible(false);if(this._oFilterBar){var t=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(t);this._oFilterBar.setShowGoOnFB(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()));this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false)}if(this._oTable){this._oTable.setVisible(true)}this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(this.getSupportMultiselect());this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;case Ce.PHONE_SEARCH_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(true)}this._oAdvancedSearchLink.setVisible(false);if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(true);this._oButtonClear.setVisible(this._oFilterBar&&this._oFilterBar.getShowClearOnFB());this._oButtonOk.setVisible(false);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(true);break;case Ce.PHONE_CONDITIONS_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false)}this._oAdvancedSearchLink.setVisible(false);if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(false);if(!this._oRanges){this._createAddRanges()}if(this._oRanges){this._oRanges.setVisible(true)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;default:break}if(this._oMainListMenu&&this._oContentContainer){(function(){this._oContentContainer.rerender()}).bind(this)()}this._currentViewMode=e;this._updateDlgTitle()};Ee.prototype._changeTableRowSelectionForKey=function(e,t){var i;var s=this._oTable;var a=s;if(this._isMultiSelectionPluginAvailable()){a=s._getSelectionPlugin()}this._bIgnoreSelectionChange=true;if(s&&s.isA("sap.ui.table.Table")){var o=s.getBinding("rows");if(o){if(o.aKeys){for(i=0;i<o.aKeys.length;i++){if(decodeURIComponent(o.aKeys[i])===e){if(t){a.addSelectionInterval(i,i)}else{a.removeSelectionInterval(i,i)}break}}}else{this.oRows=s.getBinding("rows");if(this.oRows.aIndices){for(i=0;i<this.oRows.aIndices.length;i++){var n=s.getContextByIndex(this.oRows.aIndices[i]);if(n){var l=n.getObject();if(l[this.getKey()]===e){if(t){a.addSelectionInterval(i,i)}else{a.removeSelectionInterval(i,i)}break}}}}}}}else{for(i=0;i<s.getItems().length;i++){var r=s.getItems()[i];var h=r.getBindingContext().getObject();if(h[this.getKey()]===e){s.setSelectedItem(r,t);break}}}this._bIgnoreSelectionChange=false};Ee.prototype._isComplexKeyFound=function(e,t){let i=true;Object.keys(e).forEach(s=>{if(!e[s].startsWith("guid")&&!t.includes(`${s}='${e[s]}'`)||e[s].startsWith("guid")&&!t.includes(`${s}=${e[s]}'`)){i=false}});return i};Ee.prototype.update=function(){if(this._oRulesLog){this._oRulesLog.setInvokedMethod("update",true)}if(!this._oDefaultSmartTable){this._oTable?.getBinding("rows")?.attachEventOnce("dataReceived",function(){var e=this._oTable.getBinding("rows").getLength();this._addInvisibleMessageSearchAndTableCount(e)},this)}if(!this.getEnabledMultiSelectionPlugin()){return this._updateSync()}else{return this._updateAsync()}};Ee.prototype._updateSync=function(){var e,t,i,s;var o;var n=this._oSelectedItems.getItems();var l={tokenKeys:n,useDefault:false};var r;if(this._oTable){r=this._oTable;if(this._isMultiSelectionPluginAvailable()){r=this._oTable._getSelectionPlugin()}}this._bIgnoreSelectionChange=true;if(this._hasListeners("updateSelection")){this.fireUpdateSelection(l)}else{l.useDefault=true}if(l.useDefault){if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this.oRows=this._oTable.getBinding("rows");r.clearSelection();if(this.oRows&&this.oRows.aKeys){for(t=0;t<n.length;t++){const l=this.getKeys()?.length>1;o=n[t];if(l){try{o=JSON.parse(n[t])}catch(e){a.error(`JSON.parse throws an exception: ${e.message}`)}}for(e=0;e<this.oRows.aKeys.length;e++){var h=this.oRows.aKeys[e];if(h===undefined){continue}h=decodeURIComponent(h);const t=h===o;let n;if(l){n=o&&Object.keys(o).length>1&&this._isComplexKeyFound(o,h)}if(n||t||h.includes(o)){if(l){try{o=JSON.stringify(o)}catch(e){a.error(`JSON.stringify throws an exception: ${e.message}`)}}if(!t){this._oSelectedItems.remove(o);var u=this._getTokenByKey(o,this._getTokenizer());if(u){u.setKey(h)}}s=this._oTable.getContextByIndex(e);if(s){i=s.getObject();this._oSelectedItems.add(h,i)}r.addSelectionInterval(e,e);break}}}}else if(this.oRows&&this.oRows.aIndices){r.clearSelection();var _=this._oTable.getBinding("rows").getContexts();for(t=0;t<n.length;t++){var d=n[t];for(e=0;e<this.oRows.aIndices.length;e++){s=_[e];if(s){i=s.getObject();if(i[this.getKey()]===d){this._oSelectedItems.add(i[this.getKey()],i);r.addSelectionInterval(e,e);break}}}}}}else{var c=this._oTable;for(t=0;t<n.length;t++){o=n[t];for(e=0;e<c.getItems().length;e++){var g=c.getItems()[e];var p=g.getBindingContext().getObject();if(p[this.getKey()]===o){c.setSelectedItem(g,true);break}}}}}this._bIgnoreSelectionChange=false;this._updateTitles()};Ee.prototype._updateAsync=function(){var e,t,i,s;var o;var n=this._oSelectedItems.getItems();var l={tokenKeys:n,useDefault:false};var r=[],h;if(this._oTable){h=this._oTable;if(this._isMultiSelectionPluginAvailable()){h=this._oTable._getSelectionPlugin()}}this._bIgnoreSelectionChange=true;if(this._hasListeners("updateSelection")){this.fireUpdateSelection(l)}else{l.useDefault=true}if(l.useDefault){if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this.oRows=this._oTable.getBinding("rows");h.clearSelection();if(this.oRows&&this.oRows.aKeys){for(t=0;t<n.length;t++){const l=this.getKeys()?.length>1;o=n[t];if(l){try{o=JSON.parse(n[t])}catch(e){a.error(`JSON.parse throws an exception: ${e.message}`)}}for(e=0;e<this.oRows.aKeys.length;e++){var u=this.oRows.aKeys[e];if(u===undefined){continue}u=decodeURIComponent(u);const t=u===o;let n;if(l){n=o&&Object.keys(o).length>1&&this._isComplexKeyFound(o,u)}if(n||t||u.includes(o)){if(l){try{o=JSON.stringify(o)}catch(e){a.error(`JSON.stringify throws an exception: ${e.message}`)}}if(!t){this._oSelectedItems.remove(o);var _=this._getTokenByKey(o,this._getTokenizer());if(_){_.setKey(u)}}s=this._oTable.getContextByIndex(e);if(s){i=s.getObject();this._oSelectedItems.add(u,i)}r.push(h.addSelectionInterval(e,e));break}}}}else if(this.oRows&&this.oRows.aIndices){h.clearSelection();var d=this._oTable.getBinding("rows").getContexts();for(t=0;t<n.length;t++){var c=n[t];for(e=0;e<this.oRows.aIndices.length;e++){s=d[e];if(s){i=s.getObject();if(i[this.getKey()]===c){this._oSelectedItems.add(i[this.getKey()],i);h.addSelectionInterval(e,e);break}}}}}}else{var g=this._oTable;for(t=0;t<n.length;t++){o=n[t];for(e=0;e<g.getItems().length;e++){var p=g.getItems()[e];var f=p.getBindingContext().getObject();if(f[this.getKey()]===o){g.setSelectedItem(p,true);break}}}}}this._bIgnoreSelectionChange=false;return Promise.all(r).then(function(){this._updateTitles()}.bind(this))};Ee.prototype._createHeaderBar=function(){this._oTitle=new f(this.getId()+"-title",{level:me.H1});var e=null;if(this._isPhone()){e=new S(this.getId()+"-back",{visible:false,type:ge.Back,press:function(e){if(this._currentViewMode===Ce.PHONE_SEARCH_VIEW){this._updateView(Ce.PHONE_LIST_VIEW)}else{this._updateView(Ce.PHONE_MAIN_VIEW)}}.bind(this)});this._oBackButton=e}var t=new m(this.getId()+"-header",{contentLeft:e,contentMiddle:this._oTitle,design:"Header"});this.setCustomHeader(t);this.getCustomHeader().addStyleClass("sapContrastPlus")};Ee.prototype._createCollectiveSearch=function(){this.oSelectionTitle=new T(this.getId()+"-selTitle",{visible:false,wrapping:false}).addStyleClass("compVHColSearchText");if(G.system.tablet&&!G.system.desktop){this.oSelectionTitle.addStyleClass("compVHColSearchTextTabletMaxWidth")}else{this.oSelectionTitle.addStyleClass("compVHColSearchTextMaxWidth")}this.oSelectionButton=new S(this.getId()+"-selButton",{icon:"sap-icon://slim-arrow-down",tooltip:this._oRb.getText("VALUEHELPVALDLG_SEARCHTEMPLATES_TOOLTIP"),type:ge.Transparent,visible:false,ariaLabelledBy:this.oSelectionTitle}).addStyleClass("compVHColSearchBtn");this._oColSearchBox=new d(this.getId()+"-selBox",{fitContainer:true,visible:this.oSelectionButton.getVisible(),items:[this.oSelectionTitle,this.oSelectionButton]}).addStyleClass("compVHColSearchVBox")};Ee.prototype._createFooterControls=function(){this._oButtonOk=new S(this.getId()+"-ok",{text:this._oRb.getText("VALUEHELPDLG_OK"),press:this._onCloseAndTakeOverValues.bind(this),visible:this.getSupportMultiselect(),type:ge.Emphasized,layoutData:new y({priority:pe.NeverOverflow})});this._oButtonCancel=new S(this.getId()+"-cancel",{text:this._oRb.getText("VALUEHELPDLG_CANCEL"),press:this._onCancel.bind(this),layoutData:new y({priority:pe.NeverOverflow})});if(this._isPhone()){this._oButtonGo=new S(this.getId()+"-go",{text:this._oRb.getText("VALUEHELPDLG_GO"),type:ge.Emphasized,press:this._onGo.bind(this),visible:false,layoutData:new y({priority:pe.NeverOverflow})});this._oButtonClear=new S(this.getId()+"-clear",{text:this._oRb.getText("VALUEHELPDLG_CLEAR"),press:this._onClear.bind(this),visible:false,layoutData:new y({priority:pe.NeverOverflow})});this.addButton(this._oButtonGo);this.addButton(this._oButtonClear)}this.addButton(this._oButtonOk);this.addButton(this._oButtonCancel)};Ee.prototype._handleTokenUpdateOrDelete=function(e){var t,i=[],s=[],a,o,n,l,r;if(this._ignoreRemoveToken){return}if(e.getParameter("type")===I.TokenChangeType.Removed){t=e.getParameter("removedTokens")}else if(e.getParameter("tokens")){t=e.getParameter("tokens")}for(l=0;l<t.length;l++){a=t[l];o=a.getKey();if(this._oSelectedRanges&&this._oSelectedRanges[o]){s.push(o);this._removeToken(o)}else{i.push(o);this._oSelectedItems.remove(o);this._removeTokenFromTokenizer(o,this._getTokenizer())}}this._removeRangeByKey(s);r={tokenKeys:i,useDefault:false};if(this._hasListeners("tokenRemove")){this._bIgnoreSelectionChange=true;this.fireTokenRemove(r);this._bIgnoreSelectionChange=false}else{r.useDefault=true}if(r.useDefault){i.forEach(function(e){this._changeTableRowSelectionForKey(e,false)}.bind(this))}if(t.length===1){setTimeout(function(){var e=this._getTokenizer().getTokens();if(e){n=e.length-1;if(n>=0){e[n].focus()}else{this._manageFocusAfterRemoveTokens()}}}.bind(this))}this._updateTitles()};Ee.prototype._createTokenizer=function(){const t=this.getId();if(this._oTokenizerGrid){return this._oTokenizerGrid}this._oSelectedTokenTitle=new k(`${t}-selectedTokenTitle`);this._oSelectedTokens=new I(`${t}-selectedTokens`,{ariaLabelledBy:this._oSelectedTokenTitle}).addStyleClass("compVHTokensDiv");(function(){this._oSelectedTokens.attachTokenUpdate(this._handleTokenUpdateOrDelete,this)}).bind(this)();this._oSelectedTokens.attachTokenDelete(this._handleTokenUpdateOrDelete,this);if(e.isAccessibilityEnabled()){this._oSelectedTokens.addAriaDescribedBy(this._oSelectedTokens.getTokensInfoId())}this._oRemoveAllSelectedItemsBtn=new S(`${t}-removeSelItems`,{type:ge.Transparent,icon:L.getIconURI("decline"),tooltip:this._oRb.getText("VALUEHELPVALDLG_REMOVETOKENS_TOOLTIP"),press:function(){var e=[],t=[],i;this._getTokenizer().destroyTokens();e=Object.keys(this._oSelectedItems["items"]);t=Object.keys(this._oSelectedRanges);this._removeRangeByKey(Object.keys(this._oSelectedRanges));this._oSelectedItems.removeAll();this._bIgnoreSelectionChange=true;if(this._oTable&&this._oTable.clearSelection){if(this._oTable._getSelectionPlugin&&this._oTable.data("isInternal")){this._oTable._getSelectionPlugin().clearSelection()}else{this._oTable.clearSelection()}}if(this._oTable&&this._oTable.removeSelections){this._oTable.removeSelections()}this._bIgnoreSelectionChange=false;this._updateTitles();this._manageFocusAfterRemoveTokens();if(e.length>0||t.length>0){i={tokenKeys:e.concat(t),useDefault:false};this.fireTokenRemove(i)}}.bind(this),ariaDescribedBy:this._oSelectedTokenTitle}).addStyleClass("compVHRemoveAllBtn");var i=new K(`${t}-selItemsBox`,{content:[this._getTokenizer(),this._oRemoveAllSelectedItemsBtn]}).addStyleClass("compVHTokenizerHLayout");this._oIncludeTokenGrid=new z(`${t}-selItemsGrid`,{width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:[this._oSelectedTokenTitle,i]}).addStyleClass("sapUiRespGridOverflowHidden");const s=new f(`${t}-tokenizerPanelToolbarTitle`,{level:me.H2}).addStyleClass("compVHTokenizerPanelToolbarTitle");const a=new se(`${t}-tokenizerPanelToolbar`,{content:s}).addStyleClass("compVHTokenizerPanelToolbar");this._oTokenizerPanel=new v(`${t}-tokenPanel`,{headerToolbar:a,expanded:G.system.desktop,expandable:false,expandAnimation:true,width:"auto",content:[this._oIncludeTokenGrid],expand:function(e){this._updateTokenizer();if(e.mParameters.expand&&this._oTable&&!this._oTable.isA("sap.m.Table")){var i=window.document.getElementById(`${t}-scrollCont`);if(i&&i.scrollTop){i.stop().animate({scrollTop:"1000"},1e3)}}}.bind(this)}).addStyleClass("compVHBackgroundTransparent").addStyleClass("compVHTokensPanel").addStyleClass("compValueHelpDialogTokens");if(this._isPhone()){this._getTokenizer().addStyleClass("sapMTokenizerMultiLine")}this._oTokenizerGrid=new z(`${t}-tokenizerGrid`,{width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:this._oTokenizerPanel}).addStyleClass("compVHDBackground").addStyleClass("sapUiRespGridOverflowHidden");return this._oTokenizerGrid};Ee.prototype._addToken2Tokenizer=function(e,t,i,s){var a=typeof t==="string"?t:"";var o=this._getTokenByKey(e,i);t=ee(t);if(!o){o=new r(Re.call(this,e,s));o.setKey(e);i.addToken(o);this._updateTokenizer()}if(o){o.setText(t);o.setTooltip(a)}};Ee.prototype._getTokenByKey=function(e,t){var i=t.getTokens();for(var s=0;s<i.length;s++){var a=i[s];if(a.getKey()===e){return a}}return null};Ee.prototype._removeToken=function(e){this._removeTokenFromTokenizer(e,this._getTokenizer())};Ee.prototype._removeTokenFromTokenizer=function(e,t){var i=this._getTokenByKey(e,t);if(i){this._ignoreRemoveToken=true;t.removeToken(i);i.destroy();this._ignoreRemoveToken=false;this._updateTokenizer();return true}return false};Ee.prototype._updateTokenizer=function(){this._bInitTokensHaveChanged=true;var e=false,t,i;if(this._oTokenizerPanel){e=this._oTokenizerPanel.getExpanded()}var s=this._getTokenizer().getTokens().length;if(this.getSupportRangesOnly()){t=this._oRb.getText("VALUEHELPDLG_SELECTEDCONDITIONS");i=this._oRb.getText("VALUEHELPDLG_NONESELECTEDCONDITIONS")}else if(this.getSupportRanges()){t=this._oRb.getText("VALUEHELPDLG_SELECTEDITEMS_CONDITIONS");i=this._oRb.getText("VALUEHELPDLG_NONESELECTEDITEMS_CONDITIONS")}else{t=this._oRb.getText("VALUEHELPDLG_SELECTEDITEMS");i=this._oRb.getText("VALUEHELPDLG_NONESELECTEDITEMS")}var a=t.replace("{0}",s.toString());var o=s===0?i:a;if(this._oTokenizerPanel){if(!e){o="";if(s!==0){o=a}if(o===""){o=i}}const t=this._oTokenizerPanel.getHeaderToolbar().getContent()[0];if(t){t.setText(o)}this._oSelectedTokenTitle.setText(o)}else{this._oSelectedTokenTitle.setText(o)}this._oRemoveAllSelectedItemsBtn.setEnabled(s!==0);this._oIncludeTokenGrid.removeStyleClass("displayNone")};Ee.prototype._createNavigationControl=function(){if(!this._isPhone()){this._oTabBar=new E(this.getId()+"-navigation",{expandable:false,items:[new B(this.getId()+"-itemstable",{visible:true,text:this._getTabSearchAndSelectText(),key:Ce.DESKTOP_LIST_VIEW}),new B(this.getId()+"-ranges",{visible:true,text:this._getTabRangesText(),key:Ce.DESKTOP_CONDITIONS_VIEW})],select:function(e){this._updateView(e.getParameters().key)}.bind(this)});this._oTabBar.setLayoutData(new p({shrinkFactor:0}));this._oNavigationContainer.addItem(this._oTabBar)}else{this._oSelectItemLI=new C(this.getId()+"-itemstable",{type:Te.Navigation,title:this._getTabSearchAndSelectText()}).data("key",Ce.PHONE_LIST_VIEW);this._oDefineConditionsLI=new C(this.getId()+"-ranges",{type:Te.Navigation,title:this._getTabRangesText()}).data("key",Ce.PHONE_CONDITIONS_VIEW);this._oMainListMenu=new U(this.getId()+"-navigation",{mode:fe.None,items:[this._oSelectItemLI,this._oDefineConditionsLI],itemPress:function(e){if(e){this._updateView(e.mParameters.listItem.data("key"))}}.bind(this)});this._oMainListMenu.setLayoutData(new p({shrinkFactor:0}));this._oContentContainer.addItem(this._oMainListMenu);this._oAdvancedSearchLink=new W(this.getId()+"-advancedSearchLink",{text:this._oRb.getText("FILTER_BAR_ADV_FILTERS_DIALOG"),press:function(){this._updateView(Ce.PHONE_SEARCH_VIEW)}.bind(this)}).addStyleClass("compVHAdvancedSearchLink");this._oAdvancedSearchLink.setLayoutData(new p({shrinkFactor:0,alignSelf:"End"}));this._oContentContainer.addItem(this._oAdvancedSearchLink)}};Ee.prototype._updateNavigationControl=function(){var e=!this.getSupportRangesOnly();var t=this.getSupportRangesOnly()||this.getSupportRanges();if(this._oTabBar){var i=this._oTabBar.getItems();i[0].setVisible(e);i[1].setVisible(t);this._oTabBar.setVisible(e&&t);this._updateDlgTitle()}if(this._oMainListMenu){this._oSelectItemLI.setVisible(e);this._oDefineConditionsLI.setVisible(t)}};Ee.prototype._removeRangeByKey=function(e){var t=e;if(typeof t==="string"){t=[t]}t.forEach(function(e,t,i){var s=this._oSelectedRanges[e];if(!s._oGrid){delete this._oSelectedRanges[e];if(this._oFilterPanel){var a=this._oFilterPanel.getConditionPanel();if(i.length==1){a.removeCondition(e)}else{a._removeConditionFromMap(e)}}}},this);if(t.length>1&&this._oFilterPanel){var i=this._oFilterPanel.getConditionPanel();i._clearConditions();i._fillConditions()}};Ee.prototype._createAddRanges=function(){if(!this._oRanges){this._oRanges=this._createRanges();this._oMainLayout.addItem(this._oRanges)}else{this._oMainLayout.addItem(this._oRanges)}};Ee.prototype._createRanges=function(){var e,t;this._oFilterPanel=new j(this.getId()+"-filterPanel",{maxConditions:this.getMaxConditions(),maxIncludes:this.getMaxIncludeRanges?this.getMaxIncludeRanges():this._iMaxIncludeRanges,maxExcludes:this.getMaxExcludeRanges?this.getMaxExcludeRanges():this._iMaxExcludeRanges,containerQuery:true,enableEmptyOperations:true,defaultOperation:this.getConditionPanelDefaultOperation(),filterItemChanged:function(e){var t=e.getParameter("reason");var i=e.getParameter("key");var s=e.getParameter("itemData");if(s&&t==="added"){var a={exclude:s.exclude,keyField:s.columnKey,operation:s.operation,value1:s.value1,value2:s.value2};this._oSelectedRanges[i]=a;var o=new q({key:i,exclude:s.exclude,columnKey:s.columnKey,operation:s.operation});o.setValue1(s.value1);o.setValue2(s.value2);this._oFilterPanel.addFilterItem(o);var n=this._getFormatedRangeTokenText(a.operation,a.value1,a.value2,a.exclude,a.keyField);this._addToken2Tokenizer(i,n,this._getTokenizer(),a.keyField);this._updateTokenizer()}if(s&&t==="updated"){var a=this._oSelectedRanges[i];a.exclude=s.exclude;a.keyField=s.columnKey;a.operation=s.operation;a.value1=s.value1;a.value2=s.value2;var n=this._getFormatedRangeTokenText(a.operation,a.value1,a.value2,a.exclude,a.keyField);this._addToken2Tokenizer(i,n,this._getTokenizer(),a.keyField);this._updateTokenizer()}if(t==="removed"){delete this._oSelectedRanges[i];this._removeToken(i);this._updateTokenizer()}this._updateTabRangesTitle()}.bind(this)});this._oFilterPanel._oPanel.addAriaLabelledBy(this.getId()+"-title");this._oFilterPanel.bIsSingleIntervalRange=this.bIsSingleIntervalRange;if(this.getProperty("_enhancedExcludeOperations")){this._oFilterPanel._enableEnhancedExcludeOperations()}t=this._oFilterPanel.getConditionPanel();t.setDisplayFormat(this.getDisplayFormat());t.setProperty("_calendarWeekSettings",this.getProperty("_conditionPanelCalendarWeekSettings"));t.setProperty("_showCurrentDateButton",this.getProperty("_conditionPanelShowCurrentDateButton"));this._oFilterPanel.setSuggestCallback(this._fSuggestCallback);t._sAddRemoveIconTooltipKey="CONDITION";if(this._aIncludeRangeOperations){for(e in this._aIncludeRangeOperations){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[e],e,true)}}if(this._aExcludeRangeOperations){for(e in this._aExcludeRangeOperations){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[e],e,true)}}if(this._aRangeKeyFields){this._aRangeKeyFields.forEach(function(e){this._oFilterPanel.addItem(new J({columnKey:e.key,text:e.label,typeInstance:e.typeInstance,type:e.type,maxLength:e.maxLength,formatSettings:e.formatSettings,scale:e.scale,precision:e.precision,isDefault:e.isDefault,values:null,nullable:e.nullable!=="false"}))},this)}if(this._oSelectedRanges){for(var i in this._oSelectedRanges){var s=this._oSelectedRanges[i];var a=new q({key:i,exclude:s.exclude,columnKey:s.keyField,operation:s.operation});a.setValue1(s.value1);a.setValue2(s.value2);this._oFilterPanel.addFilterItem(a)}}var o=new z(this.getId()+"-rangeFieldsGrid",{width:"100%",defaultSpan:"L12 M12 S12",vSpacing:0,hSpacing:0,content:[this._oFilterPanel]}).addStyleClass("sapUiRespGridOverflowHidden");this._sValidationDialogTitle=this._oRb.getText("VALUEHELPVALDLG_TITLE");this._sValidationDialogMessage=this._oRb.getText("VALUEHELPVALDLG_MESSAGE");this._sValidationDialogFieldMessage=this._oRb.getText("VALUEHELPVALDLG_FIELDMESSAGE");return o};Ee.prototype.suggest=function(e){this._fSuggestCallback=e;if(this._oFilterPanel){this._oFilterPanel.setSuggestCallback(this._fSuggestCallback)}};Ee.prototype._getKeyFieldByKey=function(e){var t;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(i){if(typeof i!=="string"){if(i.key===e){t=i;return true}}return false})}return t};Ee.prototype._validateRanges=function(e,t){if(this._oRanges){if(!this._oRanges.getParent()){e();return}var i=this._oFilterPanel.validateConditions();if(!i){l.show(this._sValidationDialogMessage,{icon:l.Icon.WARNING,title:this._sValidationDialogTitle,actions:[l.Action.OK,l.Action.CANCEL],emphasizedAction:l.Action.OK,styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(i){if(i===l.Action.OK&&e){e()}if(i===l.Action.CANCEL&&t){t()}}});return}}e()};Ee.prototype.setUpdateSingleRowCallback=function(e){this.fSingleRowCallback=e;this._updateNavigationControl()};Ee.prototype._createDefaultTable=function(){if(!this._isPhone()){this.setTable(new F(this.getId()+"-table"),true)}else{this.setTable(new O(this.getId()+"-table"),true);this.TableStateSearchData()}};function Be(){if(!(this._oTablePromise instanceof Promise)){this._oTablePromise=new Promise(function(e,t){var i,s=this.data("defaultSFBSmartTableConfig");this._fnRejectTablePromise=t;if(!s){i=this._createDefaultStandaloneTable();this.setTable(i,true);if(i&&i.isA("sap.ui.comp.smarttable.SmartTable")){i=i.getTable()}e(i);return}sap.ui.require(["sap/ui/comp/smarttable/SmartTable"],function(t){ce=t;if(!s){return}i=this._createDefaultSFBSmartTable(s);this.setTable(i,true);e(i.getTable())}.bind(this))}.bind(this))}return this._oTablePromise}Ee.prototype._getSmartTableColsNames=function(e){return e.cols.reduce(function(t,i){if(Array.isArray(i.fieldTemplate)){var s=e.valueListAnnotation.fields.find(function(e){return e.name===i.fieldName});if(s["com.sap.vocabularies.Common.v1.Text"]&&s["com.sap.vocabularies.Common.v1.Text"]["com.sap.vocabularies.UI.v1.TextArrangement"]){return t.concat(i.fieldName)}}return t.concat(i.fieldName,i.description)},[])};Ee.prototype._getSmartTableIgnoredColsNames=function(e,t=[],i=[]){return t.filter(function(e){return e.visible}).reduce(function(t,s){const a=i.some(function(e){return e.name===s.name});if(a&&(s.displayBehaviour==="descriptionOnly"||s.displayBehaviour==="idOnly")){t.push(s.description)}else if(!e.includes(s.name)){t.push(s.name)}return t},[])};Ee.prototype._checkForExistingRevokedFilters=function(e,t){var i=false,s;if(e.sPath===t&&e.sOperator==="EQ"&&e.oValue1===ve.RevokedCode){i=true}else if(Array.isArray(e)){for(var a=0;a<e.length;a++){s=e[a].aFilters||e[a];i=this._checkForExistingRevokedFilters(s,t);if(i){break}}}return i};Ee.prototype._ensureSelectHasAllVLFields=function(e,t){var i=t.valueListFields,s;if(!Array.isArray(i)){return}i=i.map(function(e){return e.name});s=i.join(",");if(s&&e.parameters){e.parameters.select=s}};Ee.prototype._createDefaultSFBSmartTable=function(e){var t=this._getSmartTableColsNames(e);this._oDefaultSmartTable=new ce(this.getId()+"-table",{smartFilterId:this.getId()+"-smartFilterBar",entitySet:e.entitySet,enableAutoBinding:e.autoSearch,enableAutoColumnWidth:true,tableType:this._isPhone()?o.smarttable.TableType.ResponsiveTable:o.smarttable.TableType.Table,enableExport:false,showTablePersonalisation:false,showVariantManagement:false,initiallyVisibleFields:t.join(),ignoredFields:this._getSmartTableIgnoredColsNames(t,e.valueListAnnotation.fields,e.valueListAnnotation.valueListFields).join(),header:this._sSmartTableTableTitle});this._oDefaultSmartTable.data("defaultDropDownDisplayBehaviour","idOnly");var i=this._oDefaultSmartTable.getTable();this._oDefaultSmartTable.setLayoutData(new p({growFactor:1,baseSize:"0%"}));this._oDefaultSmartTable.attachBeforeRebindTable(function(t){var i=t.getParameter("bindingParams"),s,a,o=e.smartFilterBar();delete t.mParameters.bindingParams.parameters.expand;delete i.expand;if(!e){return}if(o&&o.getAnalyticBindingPath()){t.getSource().setTableBindingPath(o.getAnalyticBindingPath())}if(e.valueListAnnotation){this._ensureSelectHasAllVLFields(i,e.valueListAnnotation)}if(e.valueListAnnotation&&e.valueListAnnotation.deprecationCodeField){a=e.valueListAnnotation.deprecationCodeField;if(i&&i.filters){var n=this._checkForExistingRevokedFilters(i.filters,a);if(!n){i.filters.push(new ue(a,_e.NE,ve.RevokedCode))}}}s=this._oDefaultSmartTable.getTable().getColumns().find(function(t){return t.data("p13nData").columnKey===e.key});if(!s||!s.data("p13nData").sortProperty){return}if(i.sorter.length===0&&i.parameters&&(!i.parameters.custom||!i.parameters.custom.search)){i.sorter.push(new he(e.key))}s.setSorted&&s.setSorted(i.sorter.some(function(t){return t.sPath===e.key}))}.bind(this));this._oDefaultSmartTable.data("p13nDialogSettings",{columns:{visible:false},filter:{visible:false},group:{visible:false}});if(this._isPhone()){i.setMultiSelectMode(R.MultiSelectMode.ClearAll);i.attachUpdateFinished(this.update)}else{if(this.getEnabledMultiSelectionPlugin()){i.addDependent(new te({limit:200,enableNotification:true}))}i.attachRowsUpdated(this.update)}i.data("isInternal",true);return this._oDefaultSmartTable};Ee.prototype._createDefaultStandaloneTable=function(){var e;if(this._isPhone()){e=new O({id:this.getId()+"-table"});e.setMultiSelectMode(R.MultiSelectMode.ClearAll);this.TableStateSearchData()}else if(this.getEnabledMultiSelectionPlugin()){e=new F({id:this.getId()+"-table"});e.addDependent(new te({limit:200,enableNotification:true}))}else{e=new F({id:this.getId()+"-table"})}e.data("isInternal",true);return e};Ee.prototype._initializeTableToolbar=function(){var e=this._oTable.getExtension()[0],t=e?e.getContent()[0]:null,i=[],s=this._oTable.isA("sap.ui.table.Table"),a=s&&this._bTableCreatedInternal&&this.getSupportMultiselect();if(a&&this._oDefaultSmartTable){try{this._oDefaultSmartTable.addDependent(new oe({rangeLimit:200}));this._oDefaultSmartTable.setCopyProvider(this._oCopyProvider)}catch(e){}}if(this._oDefaultSmartTable&&this._oDefaultSmartTable.isA("sap.ui.comp.smarttable.SmartTable")){return}if(!t){t=new f({text:G.system.desktop?this._sTableTitleNoCount:null});i.push(t);e=new le({content:[i]});this._oTable.addExtension(e)}else if(!t.isA("sap.m.Title")){t=new f({text:G.system.desktop?this._sTableTitleNoCount:null});e.insertContent(t,0)}};Ee.prototype._initializeTable=function(){var e,t=false;if(this._oTable){e=this._oTable;if(this._isMultiSelectionPluginAvailable()){e=this._oTable._getSelectionPlugin();t=true}}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._initializeTableToolbar();if(this._bTableCreatedInternal){this.getSupportMultiselect()?this._oTable.setSelectionBehavior(V.SelectionBehavior.RowSelector):this._oTable.setSelectionBehavior(V.SelectionBehavior.RowOnly)}e.setSelectionMode(this.getSupportMultiselect()?V.SelectionMode.MultiToggle:V.SelectionMode.Single);this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"));Pe(this._oTable,x.Fixed);var i=function(i){var s=i.getParameter("_internalTrigger")&&i.getParameter("_internalTrigger")===true,a=i.getParameter("userInteraction"),o=e.getSelectedIndex()!==-1;if(this._bIgnoreSelectionChange||!a&&!t||t&&!o&&s){return}var n={tableSelectionParams:i.mParameters,updateTokens:[],useDefault:false,table:this._oTable};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(n);this._bIgnoreSelectionChange=false;n.updateTokens.forEach(function(e){this._addRemoveTokenByKey(e.sKey,e.oRow,e.bSelected)}.bind(this))}else{n.useDefault=true}if(n.useDefault){var r=t?i.getSource().getParent():i.getSource();var h=r.getBinding("rows");var u=t?i.getSource().getSelectedIndices():r.getSelectedIndices();var _=i.getParameter("rowIndices");var d=i.getParameter("selectAll");var c=h&&h.isLengthFinal?h.isLengthFinal():true;var g,p=u.length;var f;var T=0;if(c){if(h.aKeys){for(g=0;g<p;g++){f=u[g];if(!h.aKeys[f]){T++}}}}else if(d){T=99999999}if(T!==0){var b=function(){h.attachEventOnce("dataReceived",function(){if(d){r.selectAll();_=e.getSelectedIndices()}this._handleSelectionUpdateTokens(r,_)}.bind(this));if(d){if(c){h.getContexts(0,p)}else{h.getContexts(0,T)}}else{h.getContexts(_[0],_[_.length-1])}}.bind(this);if(T<=400){b();return}else{l.show(this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDLOAD"),{icon:l.Icon.WARNING,title:this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDLOADTITLE"),actions:[l.Action.OK,l.Action.CANCEL],emphasizedAction:l.Action.OK,initialFocus:l.Action.CANCEL,styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(e){if(e===l.Action.OK){b()}else{this.update()}}.bind(this)});return}}this._handleSelectionUpdateTokens(r,_)}this._updateTitles();if(!this.getSupportMultiselect()){this._bIgnoreSelectionChange=true;this._onCloseAndTakeOverValues()}};if(t){e.attachSelectionChange(i.bind(this))}else{this._oTable.attachRowSelectionChange(i.bind(this))}this._oTable.addStyleClass("compVHMainTable");if(!this._oTable.getParent()||!this._oTable.getParent().isA("sap.ui.comp.smarttable.SmartTable")){this._oTable.bindAggregation("columns","columns>/cols",function(e,t){var i,s,a,o,n,l=t.getProperty("descriptionLabel"),r=t.getProperty("label"),h=t.getProperty("template"),_=Array.isArray(h);if(t.getProperty("type")==="boolean"){i=new Q(e+"-control",{enabled:false,selected:{path:h}});o=new M}else{var d,c={path:h,type:t.getProperty("oType")};if(t.getProperty("isTimezone")){c.parts=[{value:null},{path:h}]}if(_){c={parts:[{path:h[0]},{path:h[1]}],formatter:function(e,i){var s=g.getFormattedExpressionFromDisplayBehaviour(t.getProperty("displayBehaviour"),e,i);return ee(s)}};a=new N({change:function(e){var t=e.getParameter("item"),i=t.getKey(),s=t.getSortOrder();d.setSortProperty(i);d.setSortOrder(s);d.sort(s===u.SortOrder.Descending)},items:[]});o=new M({quickActions:[a],beforeOpen:function(e){d=e.getParameter("openBy");if(d){h.forEach(function(e,t){var i=new H({key:e,label:t===0?r:l,sortOrder:e===d.getSortProperty()?d.getSortOrder():u.SortOrder.None});a.addItem(i)});a.setVisible(true)}},afterClose:function(){a.removeAllItems()}})}else{o=new M}i=new T(e+"-control",{wrapping:false,renderWhitespace:true,text:c})}if(this._oTable.isA("sap.ui.table.AnalyticalTable")){s=new de(e,{label:new b({text:t.getProperty("label")}),template:i,width:"{columns>width}",hAlign:i instanceof Q?be.Center:be.Begin,filterProperty:t.getProperty("filter")})}else{s=new D(e,{label:new b({text:t.getProperty("label")}),template:i,width:"{columns>width}",hAlign:i instanceof Q?be.Center:be.Begin,sortProperty:t.getProperty("sort"),sorted:t.getProperty("sorted"),sortOrder:t.getProperty("sortOrder"),showSortMenuEntry:_?false:true,filterProperty:t.getProperty("filter")});n=s.getProperty("sortProperty");if(n){s.setAssociation("headerMenu",o)}s.data({fieldName:t.getProperty("fieldName"),fieldTemplate:t.getProperty("fieldTemplate"),fieldDisplayBehaviour:t.getProperty("displayBehaviour")})}return s}.bind(this))}}else{this._oTable.setMode(this.getSupportMultiselect()?fe.MultiSelect:fe.SingleSelectLeft);this._oTable.setGrowing(true);e.attachSelectionChange(function(e){if(this._bIgnoreSelectionChange){return}var t=e.mParameters;var i={tableSelectionParams:e.mParameters,updateTokens:[],useDefault:false,table:this._oTable};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(i);this._bIgnoreSelectionChange=false;i.updateTokens.forEach(function(e){this._addRemoveTokenByKey(e.sKey,e.oRow,e.bSelected)}.bind(this))}else{i.useDefault=true}if(i.useDefault){var s=t.selected;var a,o=t.listItems.length;for(a=0;a<o;a++){var n=t.listItems[a];var l=n.getBindingContext();var r=l?l.getObject():null;if(r){var h=r[this.getKey()];if(!this.getSupportMultiselect()){this._oSelectedItems.removeAll()}this._addRemoveTokenByKey(h,r,s)}}}if(!this.getSupportMultiselect()){this._onCloseAndTakeOverValues()}}.bind(this));if(!this._oTable.getParent()||!this._oTable.getParent().isA("sap.ui.comp.smarttable.SmartTable")){var s=0;this._oTable.bindAggregation("columns","columns>/cols",function(e,t){var i=t.getProperty("label");var a=this._oTable.getColumns().length>=2;s++;return new w(this._oTable.getId()+"-column"+s,{header:new b(this._oTable.getId()+"-column"+s+"-label",{text:i}),demandPopin:a,minScreenWidth:a?(this._oTable.getColumns().length+1)*10+"rem":"1px"})}.bind(this))}}};Ee.prototype._handleSelectionUpdateTokens=function(e,t){var i,s=t.length;var a;var o;var n;var l=false;var r=this.getEnabledMultiSelectionPlugin()&&e._getSelectionPlugin&&e._getSelectionPlugin().isA("sap.ui.table.plugins.MultiSelectionPlugin")&&e.data("isInternal")?e._getSelectionPlugin():e;if(e.getBinding("rows").aKeys){l=true}if(!this.getSupportMultiselect()){this._oSelectedItems.removeAll()}for(i=0;i<s;i++){a=t[i];o=e.getContextByIndex(a);n=o?o.getObject():null;if(n){var h;if(l){h=o.sPath.substring(1)}else{h=n[this.getKey()]}this._addRemoveTokenByKey(h,n,r.isIndexSelected(a))}}};Ee.prototype._addRemoveTokenByKey=function(e,t,i){try{e=decodeURIComponent(e)}catch(e){}if(i){this._oSelectedItems.add(e,t);this._addToken2Tokenizer(e,this._getFormatedTokenText(e),this._getTokenizer())}else{this._oSelectedItems.remove(e);this._removeTokenFromTokenizer(e,this._getTokenizer())}};Ee.prototype._onCloseAndTakeOverValues=function(){var e=this;var t=function(){var t;var i=e._oSelectedItems.getSelectedItemsTokenArray(e.getKey(),e.getDescriptionKey(),e.getTokenDisplayBehaviour());if(e._oSelectedRanges){var s=0;for(var a in e._oSelectedRanges){t=e._oSelectedRanges[a];var o=t.tokenValue;if(!o){o=e._getFormatedRangeTokenText(t.operation,t.value1,t.value2,t.exclude,t.keyField)}if(!t._oGrid||t._oGrid.select.getSelected()){var n=new r({key:"range_"+s}).data("range",{exclude:t.exclude,operation:t.operation,keyField:t.keyField,value1:t.value1,value2:t.value2});n.setText(o);n.setTooltip(typeof o==="string"?o:null);i.push(n);s++}}}e.fireOk({tokens:i,_tokensHaveChanged:e._bInitTokensHaveChanged})};this._validateRanges(t)};Ee.prototype._isMultiSelectionPluginAvailable=function(){var e=false;if(this._oTable._getSelectionPlugin&&this._oTable._getSelectionPlugin().isA("sap.ui.table.plugins.MultiSelectionPlugin")&&this._oTable.data("isInternal")){e=true}return e};Ee.prototype._onCancel=function(){this.fireCancel()};Ee.prototype._onGo=function(){this._oFilterBar.search()};Ee.prototype._onClear=function(){this._oFilterBar.clear()};Ee.prototype._updateTitles=function(){if(!this._oDefaultSmartTable){this._updateTableTitle()}this._updateTokenizer();this._updateTabSearchAndSelectTitle();this._updateTabRangesTitle()};Ee.prototype._addInvisibleMessageSearchAndTableCount=function(e){let t;const i=this._sTableTitleNoCount;if(e==undefined){t=this._oRb.getText("VALUEHELPDLG_ANNOUNCEMENT_TABLE_UPDATED",[i])}else if(e>1){t=this._oRb.getText("VALUEHELPDLG_ANNOUNCEMENT_TABLE_UPDATED_MULT",[i,e])}else if(e===1){t=this._oRb.getText("VALUEHELPDLG_ANNOUNCEMENT_TABLE_UPDATED_SING",[i,e])}else{t=this._oRb.getText("VALUEHELPDLG_ANNOUNCEMENT_TABLE_UPDATED_NOITEMS",[i])}this._oInvisibleMessage.announce(t,Se.Polite)};Ee.prototype._updateDlgTitle=function(){var e="";var t;if(this._oTitle){if(this._oTabBar&&!this._oTabBar.getVisible()&&!this.getFilterMode()){if(this._oTabBar.getSelectedKey()===Ce.DESKTOP_LIST_VIEW){e="VALUEHELPDLG_TITLE"}else if(this._oTabBar.getSelectedKey()===Ce.DESKTOP_CONDITIONS_VIEW){if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){e="VALUEHELPDLG_SINGLECONDITION_TITLE"}else{e="VALUEHELPDLG_RANGESTITLE"}}}else if(this._isPhone()&&!this.getFilterMode()){switch(this._currentViewMode){case Ce.PHONE_MAIN_VIEW:e="";break;case Ce.PHONE_LIST_VIEW:t=this._getTabSearchAndSelectText();break;case Ce.PHONE_SEARCH_VIEW:e="FILTER_BAR_ADV_FILTERS_DIALOG";break;case Ce.PHONE_CONDITIONS_VIEW:if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){e="VALUEHELPDLG_SINGLECONDITION_TITLE"}else{t=this._getTabRangesText()}break;default:break}}if(!t){t=this.getTitle()}if(e){t=this._oRb.getText(e,[t])}if(t){this._oTitle.setText(t)}}};Ee.prototype._updateTableTitle=function(){if(!this._oTable||this._oDefaultSmartTable&&this._oDefaultSmartTable.isA("sap.ui.comp.smarttable.SmartTable")){return}var e=0,t;this.oRows=this._oTable.getBinding("rows");if(this.oRows){e=this.oRows.getLength()}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=X.getFloatInstance()}t=this._oNumberFormatInstance.format(e);if(e>0&&this.oRows.isLengthFinal&&this.oRows.isLengthFinal()){this._setTableTitle(this._sTableTitle1.replace("{0}",t))}else{this._setTableTitle(this._sTableTitleNoCount)}};Ee.prototype._getTabSearchAndSelectText=function(){var e=this._oTable;if(e){if(e.isA("sap.ui.comp.smarttable.SmartTable")){e=e.getTable()}var t=0;if(this._oSelectedItems&&this._oSelectedItems.getItems){t=this._oSelectedItems.getItems().length}if(t>0){return this._oRb.getText("VALUEHELPDLG_ITEMSTABLE_SELECT",[t])}}return this._oRb.getText("VALUEHELPDLG_ITEMSTABLE_SELECT").replace("({0})","")};Ee.prototype._getTabRangesText=function(){if(this._oSelectedRanges&&Object.keys(this._oSelectedRanges).length>0){var e=Object.keys(this._oSelectedRanges).length;return this._oRb.getText("VALUEHELPDLG_RANGES",[e])}return this._oRb.getText("VALUEHELPDLG_RANGES").replace("({0})","")};Ee.prototype._updateTabSearchAndSelectTitle=function(){var e=!this.getSupportRangesOnly();if(e){if(this._oTabBar){this._oTabBar.getItems()[0].setText(this._getTabSearchAndSelectText())}if(this._oMainListMenu&&this._oSelectItemLI){this._oSelectItemLI.setTitle(this._getTabSearchAndSelectText())}}};Ee.prototype._updateTabRangesTitle=function(){var e=this.getSupportRangesOnly()||this.getSupportRanges();if(e){if(this._oTabBar){this._oTabBar.getItems()[1].setText(this._getTabRangesText())}if(this._oMainListMenu&&this._oDefineConditionsLI){this._oDefineConditionsLI.setTitle(this._getTabRangesText())}}};Ee.prototype._setTableTitle=function(e){var t=this._oTable&&this._oTable.getExtension&&this._oTable.getExtension()[0],i=t?t.getContent()[0]:null;if(i&&G.system.desktop&&this._oTable&&!this._oTable.isA("sap.m.Table")){if(this._oTable.getTitle&&this._oTable.getTitle()){this._oTable.getTitle().setText(e)}else{i.setText(e)}if(!this._oTable.getAriaLabelledBy().includes(i.getId())){this._oTable.addAriaLabelledBy(i)}}else{this._oTable.addStyleClass("compValueHelpSmallMarginTop")}};Ee.prototype._equalizeButtonsWidth=function(){var e=this._oButtonOk.getDomRef(),t=this._oButtonCancel.getDomRef(),i,s;if(!e||!t){return}i=e.getBoundingClientRect().width;s=t.getBoundingClientRect().width;if(i===s){return}if(s>i){this._oButtonOk.setWidth(s+"px")}else{this._oButtonCancel.setWidth(i+"px")}};Ee.prototype.onAfterRendering=function(){n.prototype.onAfterRendering.apply(this);this._equalizeButtonsWidth();if(this._oTable){this._updateTitles()}if(!this._isPhone()&&this.getContentHeight()===""){if(this.getSupportRangesOnly()&&(this.getMaxExcludeRanges()==="-1"||this.getMaxIncludeRanges()==="-1")){this.setContentHeight("70%")}else{var e=this.getDomRef("scroll");var t=e.clientHeight;this.setContentHeight(t+"px")}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){Pe(this._oTable,x.Auto)}}if(this._oTabBar&&this._oTabBar.getVisible()&&this.getCustomHeader()){this.getCustomHeader().addStyleClass("compValueHelpDialogHeaderNoBoxShadow")}this._bInitTokensHaveChanged=false;this._setToolbarSpacerWidth();this._registerVHResizeHandler()};Ee.prototype._getDialogOffset=function(e){var t=e||this._$Window.width();var i={small:600,large:1024};var s=function(e){var t=parseInt(window.getComputedStyle(document.body).fontSize);return e*t*2};var a=1;if(t>i.small&&t<i.large){a=2}else if(t>=i.large){a=2}return{top:s(a),left:s(a)}};Ee.prototype.exit=function(){var e=function(e){if(e&&e.destroy){e.destroy()}return null};if(this._oCopyProvider){this._oCopyProvider=e(this._oCopyProvider)}n.prototype.exit.apply(this);if(typeof this._fnRejectTablePromise==="function"){this._fnRejectTablePromise()}this.removeDelegate(this._onBeforeRenderingInputEventDelegate);this._oTokenizerGrid=e(this._oTokenizerGrid);this._oRanges=e(this._oRanges);this._oFilterPanel=e(this._oFilterPanel);if(this._bTableCreatedInternal){this._oTable=e(this._oTable);this._oDefaultSmartTable=e(this._oDefaultSmartTable)}this._oTable=null;this.theTable=null;this._oNumberFormatInstance=null;this._oTabBar=e(this._oTabBar);this._oMainListMenu=e(this._oMainListMenu);this._oContentContainer=e(this._oContentContainer);this._oVarManagment=e(this._oVarManagment);this._aRangeKeyFields=e(this._aRangeKeyFields);this._aIncludeRangeOperations=e(this._aIncludeRangeOperations);this._aExcludeRangeOperations=e(this._aExcludeRangeOperations);if(this._oFilterBar){this._oFilterBar.detachInitialise(this._handleFilterBarInitialize);this._oFilterBar=e(this._oFilterBar)}this._oRb=e(this._oRb);this._sTableTitle1=e(this._sTableTitle1);this._sTableTitle2=e(this._sTableTitle2);this._sTableTitleNoCount=e(this._sTableTitleNoCount);this._sValidationDialogTitle=e(this._sValidationDialogTitle);this._sValidationDialogMessage=e(this._sValidationDialogMessage);this._sValidationDialogFieldMessage=e(this._sValidationDialogFieldMessage);this._oSelectedItems=e(this._oSelectedItems);this._oSelectedRanges=e(this._oSelectedRanges);this._oButtonOk=e(this._oButtonOk);this._oButtonCancel=e(this._oButtonCancel);if(this._oButtonGo){this._oButtonGo=e(this._oButtonGo)}if(this._oButtonClear){this._oButtonClear=e(this._oButtonClear)}if(this._oColSearchBox){this._oColSearchBox=e(this._oColSearchBox)}this._oRulesLog.destroy()};Ee.prototype.setRangeKeyFields=function(e){this._aRangeKeyFields=e;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(e){if(e.typeInstance&&e.typeInstance.isA("sap.ui.model.odata.type.DateTime")){var t=e.typeInstance;if(!t.oFormat){t.formatValue(s.getInstance(),"string")}if(t.oFormat){t.oFormat.oFormatOptions.UTC=false}}})}};Ee.prototype.getRangeKeyFields=function(){return this._aRangeKeyFields};Ee.prototype.setIncludeRangeOperations=function(e,t){t=t||"default";this._aIncludeRangeOperations[t]=e;if(this._oFilterPanel){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[t],t)}};Ee.prototype.setExcludeRangeOperations=function(e,t){t=t||"default";this._aExcludeRangeOperations[t]=e.map(function(e){return this._oOperationsHelper.getCorrespondingExcludeOperation(e)}.bind(this));if(this._oFilterPanel){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[t],t)}};Ee.prototype._getFormatedTokenText=function(e){var t=this._oSelectedItems.getItem(e);var i=t[this.getDescriptionKey()];var s=t[this.getKey()];if(i===undefined){if(typeof t==="string"){i=t}else{i=s}}else{i=g.getFormattedExpressionFromDisplayBehaviour(this.getTokenDisplayBehaviour()?this.getTokenDisplayBehaviour():ye.descriptionAndId,s,i)}return i};Ee.prototype._getFormatedRangeTokenText=function(e,t,i,s,a){var o=this._getKeyFieldByKey(a);var n=t;var l=i;var r=true;if(o){if(!o.typeInstance&&$._createKeyFieldTypeInstance){$._createKeyFieldTypeInstance(o)}if(o.typeInstance){n=o.typeInstance.formatValue(t,"string",r);l=o.typeInstance.formatValue(i,"string",r)}}var h=g.getFormattedRangeText(e,n,l,s);if(this._aRangeKeyFields&&this._aRangeKeyFields.length>1&&o&&o.label&&h!==""){h=o.label+": "+h}return h};Ee.prototype._isPhone=function(){return G.system.phone};Ee.prototype._hasListeners=function(e){if(this._bTableCreatedInternal){return false}return this.hasListeners(e)};Ee.prototype._rotateSelectionButtonIcon=function(e){if(!G.system.phone){var i=t.getElementById(this.oSelectionButton.$("img")[0].id);if(e){i.addStyleClass("sapUiVHImageExpand")}else{i.removeStyleClass("sapUiVHImageExpand")}}};Ee.prototype._getTokenizer=function(){return this._oSelectedTokens};Ee.prototype._getTabSearchAndSelect=function(){var e=!this.getSupportRangesOnly();if(e){if(this._oTabBar){return this._oTabBar.getItems()[0]}if(this._oMainListMenu&&this._oSelectItemLI){return this._oSelectItemLI}}return null};Ee.prototype._getTabDefneConditions=function(){var e=this.getSupportRangesOnly()||this.getSupportRanges();if(e){if(this._oTabBar){return this._oTabBar.getItems()[1]}if(this._oMainListMenu&&this._oDefineConditionsLI){return this._oDefineConditionsLI}}return null};Ee.prototype._registerVHResizeHandler=function(){Y.register(this,this._onVHResize.bind(this))};Ee.prototype._onVHResize=function(){this._setToolbarSpacerWidth()};Ee.prototype._setToolbarSpacerWidth=function(){var e,t,i,s,a,o;if(!this._oFilterBar){return}if(this._oFilterBar.getAggregation("_toolbar")){i=this._oFilterBar.getAggregation("_toolbar").getContent();for(var n=0;n<i.length;n++){if(i[n].isA("sap.m.ToolbarSpacer")){t=i[n];break}}}if(t&&this._oFilterBar.getBasicSearch()){e=this.getDomRef();if(e){s=parseInt(e.style.width);a=parseInt(e.style.maxWidth);if(isNaN(s)&&isNaN(a)){return}if(isNaN(s)){o=a}else if(isNaN(a)){o=s}else{o=Math.min(s,a)}if(o>=1e3){t.setWidth("6rem")}else if(o<1e3&&o>700){t.setWidth("4rem")}else{t.setWidth("0.5rem")}}}};Ee.prototype._manageFocusAfterRemoveTokens=function(){var e,t=this._oFilterPanel?this._oFilterPanel.getConditionPanel():undefined;if(this._currentViewMode.toLowerCase().indexOf("list")>-1){this._oButtonOk.focus()}else{this._onAfterRenderingInputDelegate={onAfterRendering:function(){e.focus()}};this._onBeforeRenderingInputEventDelegate={onBeforeRendering:function(){if(e.getDomRef()){e.removeDelegate(this._onAfterRenderingInputDelegate,this)}}};e=t._oConditionsGrid.getAggregation("content")[0].value1;e.addDelegate(this._onAfterRenderingInputDelegate,this);e.addDelegate(this._onBeforeRenderingInputEventDelegate,this);e.focus()}};function Re(e,t){if(!t){t=this.getKey()}e=e.replace(/[^a-zA-Z0-9]/g,"");t=t.replace(/[^a-zA-Z0-9]/g,"");var i=t?t+"-"+e:e;if(!this._oTokenIdCount[i]){this._oTokenIdCount[i]=0}this._oTokenIdCount[i]++;return this.getId()+"-token-"+i+"_"+this._oTokenIdCount[i]}function ke(e){if(e){var t=e.getItems();return t[0].getVisible()&&t[1].getVisible()}else{return false}}function Pe(e,t){if(e.setVisibleRowCountMode){e.setVisibleRowCountMode(t);if(t===x.Auto){e.setMinAutoRowCount(G.system.desktop?5:4)}return}if(t===x.Fixed){e.setRowMode(x.Fixed)}else if(t===x.Auto){e.setRowMode(new A({minRowCount:G.system.desktop?5:4}))}}return Ee});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/EditableVariantItem", ["sap/m/ColumnListItem"],function(e){"use strict";var t=e.extend("sap.ui.comp.variants.EditableVariantItem",{metadata:{library:"sap.ui.comp",properties:{key:{type:"string",group:"Misc",defaultValue:null},global:{type:"boolean",group:"Misc",defaultValue:null},lifecyclePackage:{type:"string",group:"Misc",defaultValue:null},lifecycleTransportId:{type:"string",group:"Misc",defaultValue:null},namespace:{type:"string",group:"Misc",defaultValue:null},readOnly:{type:"boolean",group:"Misc",defaultValue:false},accessOptions:{type:"string",group:"Misc",defaultValue:null,deprecated:true},labelReadOnly:{type:"boolean",group:"Misc",defaultValue:false},author:{type:"string",group:"Misc",defaultValue:null},favorite:{type:"boolean",group:"Misc",defaultValue:false},_contexts:{type:"object",group:"Misc",visibility:"hidden",defaultValue:{}}}},renderer:{apiVersion:2}});t.prototype.setContexts=function(e){this.setProperty("_contexts",e)};t.prototype.getContexts=function(){return this.getProperty("_contexts")};return t});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/VariantItem", ["sap/ui/comp/library","sap/m/VariantItem"],function(e,t){"use strict";var a=t.extend("sap.ui.comp.variants.VariantItem",{metadata:{library:"sap.ui.comp",properties:{executeOnSelection:{type:"boolean",group:"Misc",defaultValue:false},readOnly:{type:"boolean",group:"Misc",defaultValue:false},lifecycleTransportId:{type:"string",group:"Misc",defaultValue:null},global:{type:"boolean",group:"Misc",defaultValue:null},lifecyclePackage:{type:"string",group:"Misc",defaultValue:null},namespace:{type:"string",group:"Misc",defaultValue:null},accessOptions:{type:"string",group:"Misc",defaultValue:null,deprecated:true},labelReadOnly:{type:"boolean",group:"Misc",defaultValue:false}},events:{change:{parameters:{propertyName:{type:"string"}}}}}});a.prototype.setText=function(e){this.setProperty("text",e);this.fireChange({propertyName:"text"});return this};return a});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/comp/variants/VariantManagement", ["sap/ui/Device","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/model/json/JSONModel","sap/ui/core/library","sap/m/library","sap/m/VBox","sap/m/SearchField","sap/m/ToggleButton","sap/m/RadioButton","sap/m/Column","sap/m/Text","sap/m/Bar","sap/m/Table","sap/m/Page","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/Toolbar","sap/m/ToolbarSpacer","sap/m/Button","sap/m/CheckBox","sap/m/Dialog","sap/m/Input","sap/m/Title","sap/m/Label","sap/m/ResponsivePopover","sap/m/SelectList","sap/m/ObjectIdentifier","sap/ui/comp/library","./EditableVariantItem","./VariantItem","sap/ui/core/InvisibleText","sap/ui/core/Control","sap/ui/core/Icon","sap/ui/core/Item","sap/ui/layout/HorizontalLayout","sap/ui/layout/Grid","sap/ui/events/KeyCodes"],function(e,t,a,i,n,s,r,o,l,h,d,g,u,c,p,f,y,m,S,v,V,T,_,A,I,M,E,N,b,C,x,D,R,O,K,L,w,P){"use strict";var B=n.VerticalAlign;var F=n.ValueState;var U=s.ButtonType;var k=s.PlacementType;var G=s.PopinDisplay;var H=s.ScreenSize;var W=n.TextAlign;var z=n.TitleLevel;var Y=s.OverflowToolbarPriority;var X=s.FlexAlignItems;var $=R.extend("sap.ui.comp.variants.VariantManagement",{metadata:{interfaces:["sap.m.IOverflowToolbarContent"],library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/variants/VariantManagement.designtime",properties:{initialSelectionKey:{type:"string",group:"Misc",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},defaultVariantKey:{type:"string",group:"Misc",defaultValue:null},selectionKey:{type:"string",group:"Misc",defaultValue:null},showCreateTile:{type:"boolean",group:"Misc",defaultValue:false},showExecuteOnSelection:{type:"boolean",group:"Misc",defaultValue:false},showShare:{type:"boolean",group:"Misc",defaultValue:false},showSetAsDefault:{type:"boolean",group:"Misc",defaultValue:true},lifecycleSupport:{type:"boolean",group:"Misc",defaultValue:false},standardItemText:{type:"string",group:"Misc",defaultValue:null},useFavorites:{type:"boolean",group:"Misc",defaultValue:false},inErrorState:{type:"boolean",group:"Misc",defaultValue:false},variantCreationByUserAllowed:{type:"boolean",group:"Misc",defaultValue:true},standardItemAuthor:{type:"string",group:"Misc",defaultValue:"SAP"}},defaultAggregation:"items",aggregations:{items:{type:"sap.ui.core.Item",multiple:true,singularName:"item",deprecated:true},variantItems:{type:"sap.ui.comp.variants.VariantItem",multiple:true,singularName:"variantItem"}},events:{save:{parameters:{name:{type:"string"},overwrite:{type:"boolean"},key:{type:"string"},exe:{type:"boolean"},def:{type:"boolean"},global:{type:"boolean"},lifecyclePackage:{type:"string"},lifecycleTransportId:{type:"string"}}},manage:{parameters:{renamed:{type:"object[]"},deleted:{type:"string[]"},exe:{type:"object[]"},def:{type:"string"}}},select:{parameters:{key:{type:"string"}}}}},renderer:{apiVersion:2,render:function(e,t){e.openStart("div",t);e.class("sapUiCompVarMngmt");e.openEnd();e.renderControl(t.oVariantLayout);e.close("div")}}});$.STANDARD_NAME=b.STANDARD_VARIANT_NAME;$.MAX_NAME_LEN=100;$.FAV_COLUMN=0;$.NAME_COLUMN=1;$.SHARE_COLUMN=2;$.DEF_COLUMN=3;$.EXEC_COLUMN=4;$.RESTRICT_COLUMN=5;$.AUTHOR_COLUMN=6;$.prototype.init=function(){var t=this;this.STANDARDVARIANTKEY="*standard*";this.setStandardVariantKey(this.STANDARDVARIANTKEY);this.aRemovedVariants=[];this.aRenamedVariants=[];this.aRemovedVariantTransports=[];this.aExeVariants=[];this.oResourceBundle=a.getResourceBundleFor("sap.ui.comp");this.lastSelectedVariantKey=this._sStandardVariantKey;this.bVariantItemMode=false;this.oSelectedItem=null;this.sNewDefaultKey="";this.bManagementTableInitialized=false;this.sTransport=null;this.sPackage=null;this.aEvents=[];this.bEventRunning=false;this.oVariantSelectionPage=null;this.bManualVariantKey=false;this.bFireSelect=false;this.bExecuteOnSelectForStandardViaXML=false;this.bExecuteOnSelectForStandardByUser=null;this.bSupportExecuteOnSelectOnSandardVariant=false;this._bInnerControlsCreated=false;this._bIndustrialSolutionMode=false;this._bVendorLayer=false;this.oModel=new i({enabled:false,selectedVariant:"",creationAllowed:true,saveVariantVisible:true});this.setModel(this.oModel,"save_enablement");this.oVariantInvisbletext=new D({text:{parts:[{path:"save_enablement>/selectedVariant"},{path:"save_enablement>/enabled"}],formatter:function(e,a){if(a){e=t.oResourceBundle.getText("VARIANT_MANAGEMENT_SEL_VARIANT_MOD",[e])}else{e=t.oResourceBundle.getText("VARIANT_MANAGEMENT_SEL_VARIANT",[e])}return e}}});this.oVariantText=new A(this.getId()+"-text",{text:"{save_enablement>/selectedVariant}"});this._setStandardText();this.oVariantText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantText.addStyleClass("sapUICompVarMngmtTitle");this.oVariantText.addStyleClass("sapMTitleStyleH4");if(e.system.phone){this.oVariantText.addStyleClass("sapUICompVarMngmtTextPhoneMaxWidth")}else{this.oVariantText.addStyleClass("sapUICompVarMngmtTextMaxWidth")}this.oVariantModifiedText=new g(this.getId()+"-modified",{visible:"{save_enablement>/enabled}"});this.oVariantModifiedText.setText("*");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtModified");this.oVariantPopoverTrigger=new l(this.getId()+"-trigger",{icon:"sap-icon://slim-arrow-down",type:U.Transparent,tooltip:this.oResourceBundle.getText("VARIANT_MANAGEMENT_TRIGGER_TT")});this.oVariantPopoverTrigger.addAriaLabelledBy(this.oVariantInvisbletext);this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtClickable");this.oVariantLayout=new L({content:[this.oVariantText,this.oVariantModifiedText,this.oVariantPopoverTrigger]});this.oVariantLayout.addStyleClass("sapUICompVarMngmtLayout");this.oVariantInvisbletext.setModel(this.oModel,"save_enablement");this.oVariantInvisbletext.toStatic();this.addDependent(this.oVariantLayout)};$.prototype.getOverflowToolbarConfig=function(){var e={canOverflow:false,invalidationEvents:["save","manage","select"]};return e};$.prototype._columnVisibilityManagementTable=function(e,t){if(!this.bManagementTableInitialized){return}if(this.oManagementTable){var a=this.oManagementTable.getColumns();if(a&&a.length>=e){a[e].setVisible(t)}}};$.prototype.setVariantCreationByUserAllowed=function(e){this.setProperty("variantCreationByUserAllowed",e);this.oModel.setProperty("/creationAllowed",e);return this};$.prototype.setUseFavorites=function(e){this.setProperty("useFavorites",e);this._columnVisibilityManagementTable($.FAV_COLUMN,e);return this};$.prototype.setShowShare=function(e){this.setProperty("showShare",e);this._columnVisibilityManagementTable($.SHARE_COLUMN,e);return this};$.prototype.setShowSetAsDefault=function(e){this.setProperty("showSetAsDefault",e);this._columnVisibilityManagementTable($.DEF_COLUMN,e);return this};$.prototype.setShowExecuteOnSelection=function(e){this.setProperty("showExecuteOnSelection",e);this._columnVisibilityManagementTable($.EXEC_COLUMN,e);return this};$.prototype.setStandardItemText=function(e){this.setProperty("standardItemText",e);var t=this._getSelectedItem();if(!t||t.getKey()===this.getStandardVariantKey()){this.oModel.setProperty("/selectedVariant",e)}return this};$.prototype._triggerSave=function(){var e=this._createEvent("variantSaveAs",this._handleVariantSaveAs);this._addEvent(e)};$.prototype._checkNameValidity=function(e,t){var a=false;if(t&&this._getVariantNamesAndKeys){var i=this._getVariantNamesAndKeys();var n=t.getItems();n.forEach(function(e){var t=e.getCells()[$.NAME_COLUMN];var n=e.getKey();if(t.getValue&&i.hasOwnProperty(t.getValue())&&i[t.getValue()]!==n){t.setValueState(F.Error);t.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_DUPLICATE"));a=true}}.bind(this))}return a};$.prototype._checkVariantNameConstraints=function(e,t){var a;if(!e){return}a=e.getValue().trim();if(!this._checkIsDuplicate(e,a,this.oManagementTable)){if(a===""){e.setValueState(F.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"))}else if(a.indexOf("{")>-1){e.setValueState(F.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_NOT_ALLOWED_CHAR",["{"]))}else if(a.length>$.MAX_NAME_LEN){e.setValueState(F.Error);e.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_MAX_LEN",[$.MAX_NAME_LEN]))}else{e.setValueState(F.None);e.setValueStateText(null)}}if(e.getValueState()!==F.Error){this._checkIsDuplicate(e,a,t)}if(t&&this._getVariantNamesAndKeys){this._checkNameValidity(a,t)}};$.prototype._focusOnFirstFilterInError=function(e){e.getDomRef().scrollIntoView()};$.prototype._anyItemInErrorState=function(){var e,t,a;if(this.oManagementTable){e=this.oManagementTable.getItems();if(e){for(a=0;a<e.length;a++){t=e[a].getCells()[$.NAME_COLUMN];if(t&&t.getValueState&&t.getValueState()===F.Error){this._checkVariantNameConstraints(t,this.oManagementTable);if(t.getValueState()===F.Error){this._focusOnFirstFilterInError(t);return true}}}for(a=0;a<e.length;a++){t=e[a].getCells()[$.NAME_COLUMN];if(t&&t.isA("sap.m.Input")){this._checkVariantNameConstraints(t,this.oManagementTable);if(t.getValueState()===F.Error){this._focusOnFirstFilterInError(t);return true}}}}}return false};$.prototype._anyInErrorState=function(e,t){var a,i,n;if(e){a=e.getItems();if(a){for(n=0;n<a.length;n++){i=a[n].getCells()[$.NAME_COLUMN];if(t&&t===i){continue}if(i&&i.getValueState&&i.getValueState()===F.Error){if(this._checkIsDuplicate(i,i.getValue(),e)){return true}}}}}return false};$.prototype._checkIsDuplicate=function(e,t,a){var i=this._isDuplicate(e,t,a);if(i){e.setValueState(F.Error);e.setValueStateText(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_ERROR_DUPLICATE":"VARIANT_MANAGEMENT_ERROR_EMPTY"))}else{e.setValueState(F.None);e.setValueStateText(null)}return i};$.prototype._isDuplicate=function(e,t,a){if(a){return this._isDuplicateManaged(e,t,a)}else{return this._isDuplicateSaveAs(t)}};$.prototype._isDuplicateManaged=function(e,t,a){var i,n,s;if(a){i=a.getItems();if(i&&i.length>0){for(s=0;s<i.length;s++){n=i[s].getCells()[$.NAME_COLUMN];if(n===e){continue}if(n){if(n.getValue&&t===n.getValue().trim()){return true}else if(n.getText&&t===n.getText().trim()){return true}else if(n.getTitle&&t===n.getTitle().trim()){return true}}}}else{if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey){return false}}}return false};$.prototype._isDuplicateSaveAs=function(e){var t=e.trim();if(!t){return true}var a=this._determineStandardVariantName();if(a===t){if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey){return false}return true}var i=this._getItems();for(var n=0;n<i.length;n++){a=i[n].getText().trim();if(a===t){return true}}return false};$.prototype._createSaveDialog=function(){var t=this;if(!this.oSaveDialog){this.oSaveDialog=new T(this.getId()+"-savedialog",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEDIALOG"),beginButton:this.oSaveSave,endButton:new v(this.getId()+"-variantcancel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){if(t._fGetDataForKeyUser){t._handleSaveAsCancelPressedForKeyUser()}else{t._bSaveCanceled=true;t.oSaveDialog.close()}}}),content:[this.oLabelName,this.oInputName,this.oLabelKey,this.oInputKey,this.oSaveDialogOptionsGrid],stretch:e.system.phone});this.oSaveDialog.setParent(this);this.oSaveDialog.addStyleClass("sapUiContentPadding");this.oSaveDialog.addStyleClass("sapUiCompVarMngmtSaveDialog")}};$.prototype._createManagementDialog=function(){var t=this;if(!this.oManagementDialog){this.oManagementDialog=new T(this.getId()+"-managementdialog",{contentWidth:"64%",draggable:true,resizable:true,title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGEDIALOG"),beginButton:this.oManagementSave,endButton:new v(this.getId()+"-managementcancel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CANCEL"),press:function(){if(t._fGetDataForKeyUser){t._handleManageCancelPressedForKeyUser()}else{t.aRemovedVariants=[];t.oManagementDialog.close()}}}),content:[this.oManagementTable],stretch:e.system.phone,afterClose:function(){if(t.bFireSelect==true){t.bFireSelect=false;t._fireSelectAsync()}}});this.oManagementDialog.setParent(this);var a=new u;this.oManageDialogSearchField=new o;this.oManageDialogSearchField.attachLiveChange(function(e){this._triggerSearchInManageDialog(e)}.bind(this));a.addContentMiddle(this.oManageDialogSearchField);this.oManagementDialog.setSubHeader(a)}};$.prototype._handleArrowUpDown=function(e,a){var i=null;var n=this;e.attachBrowserEvent("keydown",function(e){if(e.which===38){if(n.oVariantSelectionPage.getShowSubHeader()){i=document.activeElement.id}}});e.attachBrowserEvent("keyup",function(n){if(n.which===38){if(i&&i===document.activeElement.id){var s=e.getItems();if(s&&s.length>0){var r=t.getElementById(i);if(r===s[0]){a.focus()}}}i=null}});a.attachBrowserEvent("keyup",function(t){if(t.which===40){var a=e.getItems();if(a&&a.length>0){a[0].focus()}}})};$.prototype._triggerSearch=function(e){if(!e){return}var t=e.getParameters();if(!t){return}this._restoreCompleteList();var a=t.newValue?t.newValue:"";this._triggerSearchByValue(a.toLowerCase())};$.prototype._triggerSearchByValue=function(e){var t,a,i;this.oSelectedVariantItemKey=null;i=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(i&&i.getText().toLowerCase().indexOf(e)<0){if(this.getSelectionKey()===a){this.oSelectedVariantItemKey=a}this.oVariantList.removeItem(i);i.destroy()}var n=this._getItems();for(var s=0;s<n.length;s++){t=n[s].getText();if(t.toLowerCase().indexOf(e)<0){a=n[s].getKey();i=this.oVariantList.getItemByKey(a);if(i){if(this.getSelectionKey()===a){this.oSelectedVariantItemKey=a}this.oVariantList.removeItem(i);i.destroy()}}}};$.prototype._triggerSearchInManageDialog=function(e){var t,a,i="",n,s;if(!e){return}var r=e.getParameters();if(!r){return}t=r.newValue?r.newValue.toLowerCase():"";if(this.oManagementTable){var o=this.oManagementTable.getItems();o.forEach(function(e){a=true;i="";s=e.getCells();if(s&&s[$.NAME_COLUMN]){n=s[$.NAME_COLUMN];if(n.getTitle){i=n.getTitle()}else if(n.getValue){i=n.getValue()}if(i.toLowerCase().indexOf(t)>=0){a=false}}if(a&&s&&s[$.AUTHOR_COLUMN]){n=s[$.AUTHOR_COLUMN];if(n.getText){i=n.getText();if(i.toLowerCase().indexOf(t)>=0){a=false}}}e.setVisible(!a)})}};$.prototype._considerItem=function(e,t){if(this.getUseFavorites()&&!e){if(this._isIndustrySolutionModeAndVendorLayer()){return true}if(t.getFavorite&&t.getFavorite()){return true}return false}return true};$.prototype._restoreCompleteList=function(e){var t,a,i,n;this.oVariantList.destroyItems();n=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(!n){n=this._createStandardVariantListItem();if(n){if(this._considerItem(e,n)){this.oVariantList.insertItem(n,0)}else{n.destroy()}}}if(n){if(this.oSelectedVariantItemKey){if(this.oSelectedVariantItemKey===n.getKey()){this.oVariantList.setSelectedItem(n);this.oSelectedVariantItemKey=null}}else{if(this.getSelectionKey()==n.getKey()||this.getSelectionKey()===null){this.oVariantList.setSelectedItem(n)}}}i=this._getItems();i.sort(this._compareItems);for(t=0;t<i.length;t++){a=i[t];if(!this._considerItem(e,a)){continue}if(a.getKey()===this.getStandardVariantKey()){continue}n=this.oVariantList.getItemByKey(a.getKey());if(!n){n=this._createVariantListItem(a,t);this.oVariantList.addItem(n)}if(this.oSelectedVariantItemKey){if(this.oSelectedVariantItemKey===n.getKey()){this.oVariantList.setSelectedItem(n);this.oSelectedVariantItemKey=null}}else{if(this.getSelectionKey()==n.getKey()){this.oVariantList.setSelectedItem(n)}}}};$.prototype._determineStandardVariantName=function(){var e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD");if(this.bVariantItemMode===false){e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT")}if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY){if(this.getStandardItemText()!==null&&this.getStandardItemText()!=""){e=this.getStandardItemText()}}return e};$.prototype._createStandardVariantListItem=function(){var e,t=null;var a=this._determineStandardVariantName();if(this.bVariantItemMode===true||this.bVariantItemMode===false&&(this.getSelectionKey()===this.getStandardVariantKey()||this.getSelectionKey()===null)){t=new x(this.oVariantPopoverTrigger.getId()+"-item-standard",{key:this.getStandardVariantKey(),readOnly:true,executeOnSelection:this.getExecuteOnSelectForStandardVariant()});t.setText(a);if(this._isIndustrySolutionModeAndVendorLayer()&&this.bVariantItemMode){t.setGlobal(true);t.setReadOnly(false)}if(this.getStandardVariantKey()!==this.STANDARDVARIANTKEY){e=this.getItemByKey(this.getStandardVariantKey());if(e){this._setVariantListItemProperties(e,t);if(e.getFavorite&&!e.getFavorite()&&this.getSelectionKey()===this.getStandardVariantKey()){t.setFavorite(true)}}}else{t.setAuthor(this.getStandardItemAuthor());t.setReadOnly(true);t.setFavorite(this.getStandardFavorite())}}return t};$.prototype._createVariantListItem=function(e,t){var a=new x(this.oVariantPopoverTrigger.getId()+"-item-"+t,{key:e.getKey(),text:e.getText()});this._setVariantListItemProperties(e,a);return a};$.prototype._setVariantListItemProperties=function(e,t){if(e.getReadOnly){t.setReadOnly(e.getReadOnly())}if(e.getExecuteOnSelection){t.setExecuteOnSelection(e.getExecuteOnSelection())}if(e.getGlobal){t.setGlobal(e.getGlobal())}if(e.getLifecyclePackage){t.setLifecyclePackage(e.getLifecyclePackage())}if(e.getLifecycleTransportId){t.setLifecycleTransportId(e.getLifecycleTransportId())}if(e.getNamespace){t.setNamespace(e.getNamespace())}if(e.getAccessOptions){t.setAccessOptions(e.getAccessOptions())}if(e.getLabelReadOnly){t.setLabelReadOnly(e.getLabelReadOnly())}if(e.getAuthor){t.setAuthor(e.getAuthor())}if(e.getFavorite){t.setFavorite(e.getFavorite())}if(e.getContexts){t.setContexts(e.getContexts())}};$.prototype.exit=function(){if(this.oVariantInvisbletext){this.oVariantInvisbletext.destroy(true);this.oVariantInvisbletext=undefined}if(this.oSearchField){this.oSearchField.destroy();this.oSearchField=undefined}if(this.oManageDialogSearchField){this.oManageDialogSearchField.destroy();this.oManageDialogSearchField=undefined}if(this.oVariantManage){this.oVariantManage.destroy();this.oVariantManage=undefined}if(this.oVariantSave){this.oVariantSave.destroy();this.oVariantSave=undefined}if(this.oVariantList){this.oVariantList.destroy();this.oVariantList=undefined}if(this.oInputName){this.oInputName.destroy();this.oInputName=undefined}if(this.oLabelName){this.oLabelName.destroy();this.oLabelName=undefined}if(this.oDefault){this.oDefault.destroy();this.oDefault=undefined}if(this.oSaveSave){this.oSaveSave.destroy();this.oSaveSave=undefined}if(this.oSaveDialog){this.oSaveDialog.destroy();this.oSaveDialog=undefined}if(this.oManagementTable){this.oManagementTable.destroy();this.oManagementTable=undefined}if(this.oManagementSave){this.oManagementSave.destroy();this.oManagementSave=undefined}if(this.oManagementDialog){this.oManagementDialog.destroy();this.oManagementDialog=undefined}if(this.oVariantText){this.oVariantText.destroy();this.oVariantText=undefined}if(this.oVariantPopoverTrigger){this.oVariantPopoverTrigger.destroy();this.oVariantPopoverTrigger=undefined}if(this.oVariantLayout){this.oVariantLayout.destroy();this.oVariantLayout=undefined}if(this.oVariantPopOver){this.oVariantPopOver.destroy();this.oVariantPopOver=undefined}if(this.oVariantSaveAs){this.oVariantSaveAs.destroy();this.oVariantSaveAs=undefined}if(this.oShare){this.oShare.destroy();this.oShare=undefined}if(this.oExecuteOnSelect){this.oExecuteOnSelect.destroy();this.oExecuteOnSelect=undefined}if(this.oCreateTile){this.oCreateTile.destroy();this.oCreateTile=undefined}if(this.oSaveDialogOptionsGrid){this.oSaveDialogOptionsGrid.destroy();this.oSaveDialogOptionsGrid=undefined}if(this.oVariantSelectionPage){this.oVariantSelectionPage.destroy();this.oVariantSelectionPage=undefined}if(this.oErrorVariantPopOver){this.oErrorVariantPopOver.destroy();this.oErrorVariantPopOver=undefined}if(this.oInputKey){this.oInputKey.destroy();this.oInputKey=undefined}if(this.oLabelKey){this.oLabelKey.destroy();this.oLabelKey=undefined}if(this.oModel){this.oModel.destroy();this.oModel=undefined}};$.prototype.addItem=function(e){e=this.validateAggregation("items",e,true);this.bVariantItemMode=false;this.addAggregation("items",e,false);var t=this.getInitialSelectionKey();this._setSelection(e,t);this._setStandardText();return this};$.prototype.insertItem=function(e,t){var a=t;e=this.validateAggregation("items",e,true);this.bVariantItemMode=false;this.insertAggregation("items",e,a);var i=this.getInitialSelectionKey();this._setSelection(e,i);this._setStandardText();return this};$.prototype.removeItem=function(e){e=this.removeAggregation("items",e);return e};$.prototype.removeAllItems=function(){var e=this.removeAllAggregation("items");this._setSelectedItem(null);return e};$.prototype.destroyItems=function(){this.destroyAggregation("items");this._setSelectedItem(null);return this};$.prototype._getItems=function(){if(this.bVariantItemMode){return this.getVariantItems()}else{return this.getItems()}};$.prototype._removeItem=function(e){if(this.bVariantItemMode){return this.removeVariantItem(e)}else{return this.removeItem(e)}};$.prototype.getItemByKey=function(e){var t=this._getItems();for(var a=0;a<t.length;a++){if(e==t[a].getKey()){return t[a]}}return null};$.prototype.addVariantItem=function(e){e=this.validateAggregation("variantItems",e,true);this.bVariantItemMode=true;this.addAggregation("variantItems",e,false);var t=this.getInitialSelectionKey();this._setSelection(e,t);this._setStandardText();e.attachChange(this._variantItemChange.bind(this,null));return this};$.prototype.insertVariantItem=function(e,t){var a=t;e=this.validateAggregation("variantItems",e,true);this.bVariantItemMode=true;this.insertAggregation("variantItems",e,a);var i=this.getInitialSelectionKey();this._setSelection(e,i);this._setStandardText();e.attachChange(this._variantItemChange.bind(this,null));return this};$.prototype._variantItemChange=function(e,t){var a;if(t&&t.oSource&&t.oSource.isA("sap.ui.comp.variants.VariantItem")){a=t.getParameter("propertyName");if(a==="text"){if(t.oSource===this._getSelectedItem()){this.oModel.setProperty("/selectedVariant",this._getSelectedItem().getText())}}}};$.prototype._setSelectedItem=function(e){this.oSelectedItem=e;if(e!=null&&e.getKey()!=this.getStandardVariantKey()){this._setVariantText(e.getText())}else{this._setStandardText()}};$.prototype._getSelectedItem=function(){return this.oSelectedItem};$.prototype.setInitialSelectionKey=function(e){this.setProperty("initialSelectionKey",e,true);this._setSelectionByKey(e);return this};$.prototype.setEnabled=function(e){this.setProperty("enabled",e,false);if(!e){this.oVariantText.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtClickable");this.oVariantText.addStyleClass("sapUICompVarMngmtDisabled");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtDisabled");this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtDisabled")}else{this.oVariantText.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantModifiedText.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtDisabled");this.oVariantText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantModifiedText.addStyleClass("sapUICompVarMngmtClickable");this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtClickable")}return this};$.prototype.getFocusDomRef=function(){if(this.oVariantPopoverTrigger&&this.getEnabled()){return this.oVariantPopoverTrigger.getFocusDomRef()}};$.prototype._setSelection=function(e,t){if(e.getKey()===t){this._setSelectedItem(e);this.fireSelect({key:t})}};$.prototype.addStyleClass=function(e){if(R.prototype.addStyleClass){R.prototype.addStyleClass.apply(this,arguments)}if(this.oVariantPopOver){this.oVariantPopOver.addStyleClass(e)}if(this.oSaveDialog){this.oSaveDialog.addStyleClass(e)}if(this.oManagementDialog){this.oManagementDialog.addStyleClass(e)}};$.prototype.removeStyleClass=function(e){if(R.prototype.addStyleClass){R.prototype.removeStyleClass.apply(this,arguments)}if(this.oVariantPopOver){this.oVariantPopOver.removeStyleClass(e)}if(this.oSaveDialog){this.oSaveDialog.removeStyleClass(e)}if(this.oManagementDialog){this.oManagementDialog.removeStyleClass(e)}};$.prototype.clearVariantSelection=function(){this.setInitialSelectionKey(this.getStandardVariantKey());this._setSelectedItem(null)};$.prototype._setDialogCompactStyle=function(e,t){if(this._checkDialogCompactStyle(e)){t.addStyleClass("sapUiSizeCompact")}else{t.removeStyleClass("sapUiSizeCompact")}};$.prototype._checkDialogCompactStyle=function(e){if(e.$().closest(".sapUiSizeCompact").length>0){return true}else{return false}};$.prototype.getSelectionKey=function(){var e=null;var t=this._getSelectedItem();if(t!==null){e=t.getKey()}else if(this.bVariantItemMode){e=this.getStandardVariantKey()}else{e=null}return e};$.prototype._setSelectionByKey=function(e){var t=this._getItems();var a=false;if(t.length>0){for(var i=0;i<t.length;i++){if(t[i].getKey()===e){this._setSelectedItem(t[i]);a=true;break}}}if(!a){this._setSelectedItem(null)}};$.prototype.setCurrentVariantKey=function(e){this._setSelectionByKey(e)};$.prototype.replaceKey=function(e,t){var a=this._getItems();if(a.length>0){for(var i=0;i<a.length;i++){if(a[i].getKey()===e){a[i].setKey(t);if(this.getDefaultVariantKey()==e){this.setDefaultVariantKey(t)}if(this._getSelectedItem()===a[i]){this._setSelectedItem(null)}break}}}};$.prototype.verifyVariantKey=function(e){return this.getItemByKey(e)?true:false};$.prototype.createVariantEntry=function(e){var t="SV"+(new Date).getTime();var a=new x({key:t,text:e.name,global:e.global});this.addAggregation("variantItems",a,false);return t};$.prototype._assignUser=function(e,t){var a=this.getItemByKey(e);if(a&&a.isA("sap.ui.comp.variants.VariantItem")&&!a.getAuthor()){a.setAuthor(t)}};$.prototype.currentVariantSetModified=function(e){if(this.oModel){this.oModel.setProperty("/enabled",e)}};$.prototype.currentVariantGetModified=function(){return this.oModel.getProperty("/enabled")};$.prototype._delayedControlCreation=function(){var e=this;if(this._bInnerControlsCreated){return}this._bInnerControlsCreated=true;this.oVariantManage=new v(this.getId()+"-manage",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_MANAGE"),enabled:true,press:function(){e._openVariantManagementDialog()},layoutData:new y({priority:Y.High})});this.oVariantSave=new v(this.getId()+"-mainsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),press:function(){var t=e._createEvent("variantSavePressed",e._variantSavePressed);e._addEvent(t)},visible:{parts:[{path:"save_enablement>/creationAllowed"},{path:"save_enablement>/saveVariantVisible"}],formatter:function(e,t){return e&&t}},type:U.Emphasized,layoutData:new y({priority:Y.Low})});this.oVariantSave.setModel(this.oModel);this.oVariantSaveAs=new v(this.getId()+"-saveas",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVEAS"),press:function(){e._openSaveAsDialog()},visible:"{save_enablement>/creationAllowed}",layoutData:new y({priority:Y.Low})});this.oVariantList=new E(this.getId()+"-list",{itemPress:function(t){var a=null;if(t&&t.getParameters()){var i=t.getParameters().item;if(i){a=i.getKey()}}if(a){e.lastSelectedVariantKey=a;e._setSelectionByKey(a);e.oVariantPopOver.close();e.oModel.setProperty("/enabled",false);e.bFireSelect=true}}});this.oVariantList.setNoDataText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_NODATA"));this.oSearchField=new o;this.oSearchField.attachLiveChange(function(t){e._triggerSearch(t)});this._handleArrowUpDown(this.oVariantList,this.oSearchField);this.oVariantSelectionPage=new p(this.getId()+"selpage",{subHeader:new m({content:[this.oSearchField]}),content:[this.oVariantList],footer:new f({content:[new S(this.getId()+"-spacer"),this.oVariantSave,this.oVariantSaveAs,this.oVariantManage]}),showSubHeader:false,showNavButton:false,showHeader:false});this.oVariantPopOver=new M(this.getId()+"-popover",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"),titleAlignment:"Auto",contentWidth:"400px",placement:k.VerticalPreferredBottom,content:[this.oVariantSelectionPage],afterOpen:function(){e.bPopoverOpen=true;e.oVariantPopoverTrigger.setPressed(true);e._markSharedVariants()},afterClose:function(){e.oVariantPopoverTrigger.setPressed(false);if(e.bPopoverOpen){if(e.bFireSelect==true){e.bFireSelect=false;e._fireSelectAsync()}setTimeout(function(){e.bPopoverOpen=false},200)}},contentHeight:"300px"});this.oVariantPopOver.setParent(this);this.oVariantPopOver.addStyleClass("sapUICompVarMngmtPopover");this.oInputName=new _(this.getId()+"-name",{liveChange:function(t){e._checkVariantNameConstraints(this)}});this.oLabelName=new I(this.getId()+"-namelabel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_NAME")});this.oLabelName.setLabelFor(this.oInputName);this.oLabelName.addStyleClass("sapUiCompVarMngmtSaveDialogLabel");this.oDefault=new V(this.getId()+"-default",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SETASDEFAULT"),enabled:true,visible:true,width:"100%"});this.oExecuteOnSelect=new V(this.getId()+"-execute",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT"),enabled:true,visible:false,width:"100%"});this.oCreateTile=new V(this.getId()+"-tile",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_CREATETILE"),enabled:true,visible:false,width:"100%"});this.oShare=new V(this.getId()+"-share",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SHARE"),enabled:true,visible:false,select:function(t){var a=e._createEvent("inputfieldChange",e._handleShareSelected);a.args.push(t);e._addEvent(a)},width:"100%"});this.oInputKey=new _(this.getId()+"-key",{liveChange:function(t){e._checkVariantNameConstraints(this)}});this.oLabelKey=new I(this.getId()+"-keylabel",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_KEY"),required:true});this.oLabelKey.setLabelFor(this.oInputKey);this.oSaveSave=new v(this.getId()+"-variantsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),type:U.Emphasized,press:function(){e._checkVariantNameConstraints(e.oInputName);if(e.oInputName.getValueState()==="Error"){e.oInputName.focus();return}e._bSaveCanceled=false;if(e._fGetDataForKeyUser){e._handleSaveAsPressedForKeyUser()}else{e._triggerSave()}},enabled:true});this.oSaveDialogOptionsGrid=new w({defaultSpan:"L12 M12 S12"});this.oManagementTable=new c(this.getId()+"-managementTable",{contextualWidth:"Auto",fixedLayout:false});this.oManagementSave=new v(this.getId()+"-managementsave",{text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_SAVE"),enabled:true,type:U.Emphasized,press:function(){this._saveFromManagementDialog()}.bind(this)})};$.prototype._saveFromManagementDialog=function(){if(this._anyItemInErrorState()){return}if(!this._fGetDataForKeyUser){var e=this._createEvent("managementSave",this._handleManageSavePressed);this._addEvent(e)}else{this._handleManageSavePressedForKeyUser()}};$.prototype._openInErrorState=function(){var e=this,t;if(!this.oErrorVariantPopOver){t=new r({fitContainer:true,alignItems:X.Center,items:[new O({size:"4rem",color:"lightgray",src:"sap-icon://message-error"}),new A({titleStyle:z.H2,text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_TEXT1")}),new g({textAlign:W.Center,text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_TEXT2")})]});t.addStyleClass("sapUICompVarMngmtErrorPopover");this.oErrorVariantPopOver=new M(this.getId()+"-errorpopover",{title:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTS"),contentWidth:"400px",placement:k.VerticalPreferredBottom,content:[new p(this.getId()+"-errorselpage",{showSubHeader:false,showNavButton:false,showHeader:false,content:[t]})],afterOpen:function(){e.bPopoverOpen=true},afterClose:function(){if(e.bPopoverOpen){e.bPopoverOpen=false}},contentHeight:"300px"});this.oErrorVariantPopOver.attachBrowserEvent("keyup",function(e){if(e.which===32){this.oErrorVariantPopOver.close()}}.bind(this))}if(this.bPopoverOpen){return}this.oErrorVariantPopOver.openBy(this.oVariantLayout)};$.prototype.showSaveButton=function(e){if(e){this.oVariantSaveAs.setType(U.Default)}else{this.oVariantSaveAs.setType(U.Emphasized)}this.oModel.setProperty("/saveVariantVisible",e)};$.prototype._openVariantSelection=function(){var e=null,t;if(this.getInErrorState()){this._openInErrorState();return}this._delayedControlCreation();if(this.bPopoverOpen){return}if(this.bVariantItemMode===false&&this.getSelectionKey()!==null){this.showSaveButton(true)}else{this.showSaveButton(false)}e=this._getItems();if(e.length<9){this.oVariantSelectionPage.setShowSubHeader(false)}else{this.oVariantSelectionPage.setShowSubHeader(true);this.oSearchField.setValue("")}this._restoreCompleteList();if(this.currentVariantGetModified()){t=this.oVariantList.getItemByKey(this.getSelectionKey());if(t){if(!t.getReadOnly()||this._isIndustrySolutionModeAndVendorLayer()&&this.getStandardVariantKey()===t.getKey()){this.showSaveButton(true)}}}if(this._isIndustrySolutionModeAndVendorLayer()&&this.bManualVariantKey&&this.getStandardVariantKey()===this.STANDARDVARIANTKEY){this.showSaveButton(false)}this._setDialogCompactStyle(this,this.oVariantPopOver);t=this.oVariantList.getSelectedItem();if(t){this.oVariantPopOver.setInitialFocus(t.getId())}var a=this._oCtrlRef?this._oCtrlRef:this.oVariantLayout;this._oCtrlRef=null;this.oVariantPopOver.openBy(a)};$.prototype._obtainControl=function(e){if(e&&e.target&&e.target.id){var a=e.target.id;var i=a.indexOf("-inner");if(i>0){a=a.substring(0,i)}return t.getElementById(a)}return null};$.prototype.handleOpenCloseVariantPopover=function(e){if(this.oVariantPopOver&&this.oVariantPopOver.isOpen()){this.oVariantPopOver.close()}else if(!this.bPopoverOpen){this._oCtrlRef=this._obtainControl(e);this._openVariantSelection()}else if(this.getInErrorState()&&this.oErrorVariantPopOver&&this.oErrorVariantPopOver.isOpen()){this.oErrorVariantPopOver.close()}};$.prototype._initalizeManagementTableColumns=function(){if(this.bManagementTableInitialized){return}this.oManagementTable.addColumn(new d({width:"3rem",visible:this.getUseFavorites()&&!this._isIndustrySolutionModeAndVendorLayer()}));this.oManagementTable.addColumn(new d({header:new g({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_NAME")}),width:"16rem"}));this.oManagementTable.addColumn(new d({header:new g({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VARIANTTYPE"),wrappingType:"Hyphenated"}),demandPopin:true,popinDisplay:G.Inline,minScreenWidth:H.Tablet,visible:this.getShowShare()}));this.oManagementTable.addColumn(new d({header:new g({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"),wrappingType:"Hyphenated"}),hAlign:W.Center,demandPopin:true,popinDisplay:G.Block,minScreenWidth:H.Tablet,visible:this.getShowSetAsDefault()}));this.oManagementTable.addColumn(new d({header:new g({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_EXECUTEONSELECT"),wrappingType:"Hyphenated"}),hAlign:this.getDisplayTextForExecuteOnSelectionForStandardVariant&&this.getDisplayTextForExecuteOnSelectionForStandardVariant()?W.Begin:W.Center,demandPopin:true,popinDisplay:G.Block,minScreenWidth:H.Tablet,visible:this.getShowExecuteOnSelection()}));this.oManagementTable.addColumn(new d({header:new g({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_VISIBILITY"),wrappingType:"Hyphenated"}),width:"8rem",demandPopin:true,popinDisplay:G.Inline,minScreenWidth:H.Tablet,visible:false}));this.oManagementTable.addColumn(new d({header:new g({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_AUTHOR")}),demandPopin:true,popinDisplay:G.Block,minScreenWidth:H.Tablet}));this.oManagementTable.addColumn(new d({header:new D({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ACTION_COLUMN")}),hAlign:W.Center}));this.bManagementTableInitialized=true};$.prototype._initalizeSaveAsDialog=function(){this.oSaveDialogOptionsGrid.removeAllContent();this.oDefault.setVisible(this.getShowSetAsDefault());this.oShare.setVisible(this.getShowShare());this.oExecuteOnSelect.setVisible(this.getShowExecuteOnSelection());this.oCreateTile.setVisible(this.getShowCreateTile());if(this.getShowSetAsDefault()){this.oSaveDialogOptionsGrid.addContent(this.oDefault)}if(this.getShowShare()){this.oSaveDialogOptionsGrid.addContent(this.oShare)}if(this.getShowExecuteOnSelection()){this.oSaveDialogOptionsGrid.addContent(this.oExecuteOnSelect)}if(this.getShowCreateTile()){this.oSaveDialogOptionsGrid.addContent(this.oCreateTile)}};$.prototype.ontap=function(e){if(this.getEnabled()){if(this.oVariantPopoverTrigger&&!this.bPopoverOpen){this.oVariantPopoverTrigger.focus()}this.handleOpenCloseVariantPopover(e)}};$.prototype.onkeyup=function(e){if(e.which===P.ENTER||e.which===P.F4||e.which===P.SPACE||e.altKey===true&&e.which===P.ARROW_UP||e.altKey===true&&e.which===P.ARROW_DOWN){if(this.getEnabled()){this._oCtrlRef=this._obtainControl(e);this._openVariantSelection()}}};$.prototype.onAfterRendering=function(){this.oVariantText.$().off("mouseover").on("mouseover",function(){this.oVariantPopoverTrigger.addStyleClass("sapUICompVarMngmtTriggerBtnHover")}.bind(this));this.oVariantText.$().off("mouseout").on("mouseout",function(){this.oVariantPopoverTrigger.removeStyleClass("sapUICompVarMngmtTriggerBtnHover")}.bind(this))};$.prototype.onBeforeRendering=function(){var e=function(e){var t,a=0;for(var i=0;i<e.length;i++){t=e[i].$().width();if(t>a){a=t}}return a};if(this.oSaveDialogOptionsGrid&&this.oSaveDialog&&this.oSaveDialog.getVisible()){var t=this.oSaveDialogOptionsGrid.getContent();if(t&&t.length>0){var a=this.oSaveDialogOptionsGrid.$().width();var i=e(t);var n=32;var s=12;if(!this._checkDialogCompactStyle(this.oSaveDialog)){n=48;s=18}if(n+i+s>a/2){this.oSaveDialogOptionsGrid.setDefaultSpan("L12 M12 S12")}}}};$.prototype._markSharedVariants=function(){var e,t,a=this._getItems();for(var i=0;i<a.length;i++){t=a[i];if(t.getGlobal&&t.getGlobal()){e=this.oVariantList.getItemByKey(t.getKey());if(e){var n=e.$();if(n){n.addClass("sapUiCompVarMngmtSharedVariant")}}}}};$.prototype._variantSavePressed=function(){var e=this._getSelectedItem();if(!e){if(this.getStandardVariantKey()===this.STANDARDVARIANTKEY){e=new x({key:this.STANDARDVARIANTKEY,global:this._isIndustrySolutionModeAndVendorLayer()});e.setText(this._determineStandardVariantName())}else{e=this.getItemByKey(this.getStandardVariantKey())}}var t=false;if(this.getDefaultVariantKey()===e.getKey()){t=true}if(e.getLifecyclePackage&&e.getGlobal()==true){var a=this;var i=function(i,n){a.oVariantPopOver.close();a.sPackage=i;a.sTransport=n;a.fireSave({name:e.getText(),overwrite:true,key:e.getKey(),def:t,global:a._isIndustrySolutionModeAndVendorLayer()&&a.getStandardVariantKey()===a.getStandardVariantKey(),lifecyclePackage:a.sPackage,lifecycleTransportId:a.sTransport});e.setLifecycleTransportId(a.sTransport);a.oModel.setProperty("/enabled",false);a._eventDone()};var n=function(e){a.sTransport=null;a.sPackage=null;a._cancelAllEvents()};this._assignTransport(e,i,n,this.oVariantText)}else{this.oVariantPopOver.close();this.fireSave({name:e.getText(),overwrite:true,key:e.getKey(),def:t});this.oModel.setProperty("/enabled",false);this._eventDone()}};$.prototype._assignTransport=function(e,t,a,i){var n={type:"variant",name:"",namespace:""};n["package"]="";if(e!==null){n["package"]=e.getLifecyclePackage();n["name"]=e.getKey();n["namespace"]=e.getNamespace()}var s=function(e){var a;var i;i=e.getParameters().selectedTransport;a=e.getParameters().selectedPackage;t(a,i)};var r=function(e){a(e)};if(this.getLifecycleSupport()){var o=null;if(e){o=e.getLifecycleTransportId()}if(o!=null&&o.trim().length>0){t(n["package"],o)}else{this._getTransportSelection().then(function(e){e.selectTransport(n,s,r,this._checkDialogCompactStyle(i),i)}.bind(this))}}else{t(n["package"],"")}};$.prototype._getTransportSelection=function(){if(this.getTransportSelection){return this.getTransportSelection()}else{return this._getFlTransportSelection()}};$.prototype._getFlTransportSelection=function(){return a.load({name:"sap.ui.fl"}).then(function(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/write/api/SmartVariantManagementWriteAPI"],function(t){e(t._getTransportSelection())})})})};$.prototype.getDefaultVariantKey=function(){var e=this.getProperty("defaultVariantKey");if(e===""){if(this.bVariantItemMode){e=this.getStandardVariantKey()}}return e};$.prototype._compareItems=function(e,t){var a=e.getText();var i=t.getText();var n=a.toUpperCase();var s=i.toUpperCase();if(n==s){if(a==i){return 0}if(a<i){return-1}if(a>i){return 1}}if(n<s){return-1}if(n>s){return 1}};$.prototype._accessOptionsText=function(e){var t=null;switch(e){case"R":t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LAYER");break;case"RD":t=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LANGUAGE");break;default:t=null}return t};$.prototype._openSaveAsDialog=function(){this._initSaveAsDialog();this.oSaveDialog.open()};$.prototype._initSaveAsDialog=function(){this._initalizeSaveAsDialog();this.oInputName.setValue(this.oModel.getProperty("/selectedVariant"));this.oInputName.setEnabled(true);this.oInputName.setValueState(F.None);this.oInputName.setValueStateText(null);this.oDefault.setSelected(false);this.oShare.setSelected(false);this.oCreateTile.setSelected(false);this.oExecuteOnSelect.setSelected(false);if(this._isIndustrySolutionModeAndVendorLayer()){this.oInputName.setValue(this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD"))}this._createSaveDialog();this._setDialogCompactStyle(this,this.oSaveDialog);this.oVariantPopOver.close();this.sTransport=null;this.sPackage=null;if(this.bManualVariantKey){this.oInputKey.setVisible(true);this.oInputKey.setEnabled(true);this.oInputKey.setValueState(F.None);this.oInputKey.setValueStateText(null);this.oLabelKey.setVisible(true)}else{this.oInputKey.setVisible(false);this.oLabelKey.setVisible(false)}};$.prototype._checkManageItemNameChange=function(e){var t="";var a=null;var i=this;a=e.getCells()[$.NAME_COLUMN];t=a.getValue();t=t.trim();var n=e;var s=n.getKey();this._checkVariantNameConstraints(a,this.oManagementTable);if(a.getValueState()===F.Error){this._eventDone();return}if(this.oVariantList.getItemByKey(s).getText().trim()===t){this._eventDone();return}if(n.getGlobal()){var r=function(e,t){n.setLifecyclePackage(e);n.setLifecycleTransportId(t);i._eventDone()};var o=function(e){if(i&&i.oVariantList){var t=i.oVariantList.getItemByKey(s);a.setValue(t.getText())}i._cancelAllEvents()};this._createManagementDialog();this._assignTransport(n,r,o,this.oManagementDialog)}else{this._eventDone()}};$.prototype._handleManageSavePressed=function(){var e=this.oManagementTable.getItems();var t,a;var i=false;var n="";var s=null;var r=0;var o=[];for(var l=0;l<e.length;l++){t=this.oVariantList.getItemByKey(e[l].getKey());a=e[l].getCells()[$.NAME_COLUMN];if(a&&a.getValue){n=a.getValue()}else if(a&&a.getTitle){n=a.getTitle()}else if(a&&a.getText){n=a.getText()}n=n.trim();if(t.getText()!==n){this.aRenamedVariants.push({key:t.getKey(),name:n});s=this.getItemByKey(e[l].getKey());s.setText(n);if(s.setLifecyclePackage){s.setLifecyclePackage(e[l].getLifecyclePackage());s.setLifecycleTransportId(e[l].getLifecycleTransportId())}if(this.lastSelectedVariantKey===t.getKey()){this._setVariantText(n)}}if(this.getUseFavorites()&&!this._isIndustrySolutionModeAndVendorLayer()){var h=e[l].getKey();if(this._mFavoriteChanges&&this._mFavoriteChanges[h]!==undefined){var d=this._mFavoriteChanges[h];if(h===this.STANDARDVARIANTKEY){if(this.getStandardFavorite()!==d){o.push({key:h,visible:d});this.setStandardFavorite(d)}}else{s=this.getItemByKey(e[l].getKey());if(s&&t.getFavorite&&t.getFavorite()!==d){o.push({key:h,visible:d});s.setFavorite(d)}}}}if(this.getShowExecuteOnSelection()&&t.getExecuteOnSelection&&e[l].getCells()[$.EXEC_COLUMN].isA("sap.m.CheckBox")&&t.getExecuteOnSelection()!=e[l].getCells()[$.EXEC_COLUMN].getSelected()){var g=e[l].getCells()[$.EXEC_COLUMN].getSelected();var u=this.getItemByKey(e[l].getKey());if(!u&&this.getSupportExecuteOnSelectOnSandardVariant()&e[l].getKey()===this.getStandardVariantKey()){u=new x}if(u&&u.setExecuteOnSelection){u.setExecuteOnSelection(g);if(this.getSupportExecuteOnSelectOnSandardVariant()&e[l].getKey()===this.getStandardVariantKey()){this._executeOnSelectForStandardVariantByUser(g)}this.aExeVariants.push({key:t.getKey(),exe:g});if(u.setLifecyclePackage&&!u.getReadOnly()){u.setLifecyclePackage(e[l].getLifecyclePackage());u.setLifecycleTransportId(e[l].getLifecycleTransportId())}}}}if(this.oManagementDialog){this.oManagementDialog.close()}if(this.bVariantItemMode===false){if(this.getDefaultVariantKey()!=this.sNewDefaultKey){var c=null;if(this.sNewDefaultKey==this.getStandardVariantKey()){c=this.getItemByKey(this.getDefaultVariantKey());this.fireSave({name:c.getText(),overwrite:true,key:c.getKey(),def:false})}else{c=this.getItemByKey(this.sNewDefaultKey);this.fireSave({name:c.getText(),overwrite:true,key:c.getKey(),def:true})}}}if(this.sNewDefaultKey!=this.getDefaultVariantKey()){this.setDefaultVariantKey(this.sNewDefaultKey)}for(r=0;r<this.aRemovedVariants.length;r++){t=this.getItemByKey(this.aRemovedVariants[r]);for(var p=0;p<this.aRemovedVariantTransports.length;p++){if(this.aRemovedVariants[r]===this.aRemovedVariantTransports[p].key){var f=this.aRemovedVariantTransports[p];if(t.setLifecyclePackage){t.setLifecycleTransportId(f.transport)}break}}}this.fireManage({renamed:this.aRenamedVariants,deleted:this.aRemovedVariants,exe:this.aExeVariants,def:this.getDefaultVariantKey(),fav:o});for(r=0;r<this.aRemovedVariants.length;r++){t=this.getItemByKey(this.aRemovedVariants[r]);if(t){this._removeItem(t);t.destroy()}if(this.lastSelectedVariantKey===this.aRemovedVariants[r]){i=true;this._setSelectedItem(null);this.oModel.setProperty("/enabled",false)}}if(i){this.bFireSelect=true}this._eventDone()};$.prototype._createEvent=function(e,t){var a={name:e,fFunc:t,args:[]};return a};$.prototype._handleNextEvent=function(){if(this.aEvents.length>0){if(!this.bEventRunning){this.bEventRunning=true;var e=this.aEvents.pop();e.fFunc.apply(this,e.args)}}};$.prototype._addEvent=function(e){this.aEvents.push(e);this._handleNextEvent()};$.prototype._cancelAllEvents=function(){this.aEvents=[];this.bEventRunning=false};$.prototype._eventDone=function(){this.bEventRunning=false;this._handleNextEvent()};$.prototype._handleManageExecuteOnSelectionChanged=function(e){var t=this;var a=e.getParent();if(a&&a.getGlobal()&&!a.getReadOnly()){var i=function(e,i){a.setLifecyclePackage(e);a.setLifecycleTransportId(i);t._eventDone()};var n=function(a){e.setSelected(!e.getSelected());t._cancelAllEvents()};this._createManagementDialog();this._assignTransport(a,i,n,this.oManagementDialog)}else{this._eventDone()}};$.prototype._handleManageDeletePressed=function(e){var a=this,i;var n=function(){var e=null,t=a.oManagementTable.getItems();t.some(function(t){if(t.getKey()===a.getStandardVariantKey()){e=t;return true}});return e};this._anyInErrorState(this.oManagementTable,e.getParent().getCells()[$.NAME_COLUMN]);i=n();var s=e.getParent();if(s.getGlobal()){var r=function(e,t){var n=s.getKey();a.aRemovedVariants.push(n);a.oManagementTable.removeItem(s);if(a.getShowSetAsDefault()){if(s.getKey()===a.sNewDefaultKey){if(i){i.getCells()[$.DEF_COLUMN].setSelected(true);i.getCells()[$.DEF_COLUMN].fireSelect({selected:true})}else{a.setStandardVariantKey(a.STANDARDVARIANTKEY)}a.sNewDefaultKey=a.getStandardVariantKey()}}s.destroy();var r={key:n,transport:t};a.aRemovedVariantTransports.push(r);a._eventDone()};var o=function(e){a._cancelAllEvents()};this._createManagementDialog();this._assignTransport(s,r,o,this.oManagementDialog)}else{this.aRemovedVariants.push(s.getKey());this.oManagementTable.removeItem(s);if(this.getShowSetAsDefault()){if(s.getKey()===this.sNewDefaultKey){if(i){i.getCells()[$.DEF_COLUMN].setSelected(true);i.getCells()[$.DEF_COLUMN].fireSelect({selected:true})}this.sNewDefaultKey=this.getStandardVariantKey()}}s.destroy();this._eventDone()}var l=t.getElementById(this.getId()+"-managementcancel");if(l){l.focus()}};$.prototype._handleShareSelected=function(e){var t=this;if(e.getParameters&&e.getParameters()&&e.getParameters().selected){var a=function(e,a){t.sTransport=a;t.sPackage=e;t._eventDone()};var i=function(e){t.oShare.setSelected(false);t.sTransport=null;t.sPackage=null;t._cancelAllEvents()};this._createSaveDialog();this._assignTransport(null,a,i,this.oSaveDialog)}else{this.sTransport=null;this.sPackage=null;this._eventDone()}};$.prototype._handleVariantSaveAs=function(){var e="SV"+(new Date).getTime();var t=this.oInputName.getValue();var a=this.oInputKey.getValue();var i="";var n="";var s=false;var r=false;var o=null;t=t.trim();if(t==""){this.oInputName.setValueState(F.Error);this.oInputName.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));this._cancelAllEvents();return}a=a.trim();if(this.bManualVariantKey&&a==""){this.oInputKey.setValueState(F.Error);this.oInputKey.setValueStateText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_ERROR_EMPTY"));this._cancelAllEvents();return}if(this.bManualVariantKey){e=a}if(this.oSaveDialog){this.oSaveDialog.close()}if(this.oExecuteOnSelect!==null){s=this.oExecuteOnSelect.getSelected()}if(this.oCreateTile!==null){r=this.oCreateTile.getSelected()}if(this.bVariantItemMode){o=new x({key:e,readOnly:false,executeOnSelection:s,global:this.oShare.getSelected(),lifecycleTransportId:this.sTransport,lifecyclePackage:this.sPackage});o.setText(t);this.addVariantItem(o);this._setSelectedItem(o)}else{o=new K({key:e});o.setText(t);this.addItem(o);this._setSelectedItem(o)}if(this.oDefault.getSelected()){this.setDefaultVariantKey(e)}if(this.oShare.getSelected()){n=this.sPackage;i=this.sTransport}this.fireSave({name:t,overwrite:false,def:this.oDefault.getSelected(),key:e,exe:this.oExecuteOnSelect.getSelected(),tile:r,global:this.oShare.getSelected(),lifecyclePackage:n,lifecycleTransportId:i});this.oModel.setProperty("/enabled",false);this._eventDone()};$.prototype.setBackwardCompatibility=function(e){this._setBackwardCompatibility(e)};$.prototype._setBackwardCompatibility=function(e){if(this.getItems().length===0&&this.getVariantItems().length===0){this.bVariantItemMode=!e}this._setStandardText()};$.prototype._setStandardText=function(){var e=this.getSelectionKey();if(e===null||e===this.getStandardVariantKey()){if(this.bVariantItemMode==false){this._setVariantText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"))}else{this._setVariantText(this.oResourceBundle.getText("VARIANT_MANAGEMENT_STANDARD"))}if(this.getStandardItemText()!==null&&this.getStandardItemText()!=""){this._setVariantText(this.getStandardItemText())}}};$.prototype._setVariantText=function(e){var t,a=this.extractBindingInfo(e),i=e;if(typeof a==="object"&&a.model&&a.path){t=this.getModel(a.model);if(t){i=t.getProperty(a.path)}}this.oModel.setProperty("/selectedVariant",i)};$.prototype._getVariantText=function(e){return this.oModel.getProperty("/selectedVariant")};$.prototype._updateVariantInvisibletext=function(e,t){if(t){e=this.oResourceBundle.getText("VARIANT_MANAGEMENT_MODIFIED",[e])}return e};$.prototype._setFavoriteIcon=function(e,t){e.setSrc(t?"sap-icon://favorite":"sap-icon://unfavorite");e.setTooltip(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_FAV_DEL_TOOLTIP":"VARIANT_MANAGEMENT_FAV_ADD_TOOLTIP"));e.setAlt(this.oResourceBundle.getText(t?"VARIANT_MANAGEMENT_FAV_DEL_ACC":"VARIANT_MANAGEMENT_FAV_ADD_ACC"))};$.prototype._isFavoriteSelected=function(e){return e.getSrc()==="sap-icon://unfavorite"};$.prototype._openVariantManagementDialog=function(){var e;var t=null;var a=0;var i;var n;var s;var r;var o;var l;var d;var u;var c,p,f,y,m,S;var T=this;this._mFavoriteChanges={};this.oManagementSave.setEnabled(true);this.oManagementSave.setTooltip(null);this.oManagementTable.destroyItems();c=function(e){T._checkVariantNameConstraints(this,T.oManagementTable)};p=function(e){var t=T._createEvent("inputfieldChange",T._checkManageItemNameChange);t.args.push(this.getParent());T._addEvent(t)};m=function(e){var t=T._isFavoriteSelected(e.oSource),a=this.getParent();if(a&&T.sNewDefaultKey!==a.getKey()){T._mFavoriteChanges[a.getKey()]=t;T._setFavoriteIcon(e.oSource,t)}};f=function(e){var t=e.getParameters().selected===true,a=this.getParent();if(a){if(t){T.sNewDefaultKey=a.getKey();T._mFavoriteChanges[a.getKey()]=t}var i=a.getCells()[$.FAV_COLUMN];if(i&&a.getFavorite){if(t){T._setFavoriteIcon(i,true)}else if(T._mFavoriteChanges[a.getKey()]!==undefined){T._setFavoriteIcon(i,T._mFavoriteChanges[a.getKey()])}else{T._setFavoriteIcon(i,a.getFavorite()===true)}}}};y=function(e){var t=T._createEvent("executeOnSelectionChange",T._handleManageExecuteOnSelectionChanged);t.args.push(this);T._addEvent(t)};S=function(e){var t=T._createEvent("manageDeletePressed",T._handleManageDeletePressed);t.args.push(this);T._addEvent(t)};if(this.oManageDialogSearchField){this.oManageDialogSearchField.setValue("")}this._initalizeManagementTableColumns();this.sNewDefaultKey=this.getDefaultVariantKey();this._restoreCompleteList(true);if(this.oVariantList.getItems()[0].getKey()!==this.getStandardVariantKey()&&this.bVariantItemMode==false){e=new x(this.oVariantManage.getId()+"-item-standard",{key:this.getStandardVariantKey(),text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DEFAULT"),readOnly:true,executeOnSelection:false});this.oVariantList.insertItem(e,0)}if(this.getUseFavorites()){e=this.oVariantList.getItemByKey(this.getStandardVariantKey());if(e){this.oVariantList.removeItem(e)}}t=this.oVariantList.getItems();if(this.getUseFavorites()){t.sort(this._compareItems);if(e){this.oVariantList.insertItem(e);t.splice(0,0,e)}}for(var A=0;A<t.length;A++){if(t[A].getReadOnly()||t[A].getLabelReadOnly()){var I=t[A].getAccessOptions();u=this._accessOptionsText(I)}else{u=null}if(t[A].getReadOnly()){u=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LAYER")}else if(t[A].getLabelReadOnly()===true){u=this.oResourceBundle.getText("VARIANT_MANAGEMENT_WRONG_LANGUAGE")}if(t[A].getKey()===this.getStandardVariantKey()){u=null}i=new C(this.oVariantManage.getId()+"-edit-"+a,{key:t[A].getKey(),global:t[A].getGlobal(),readOnly:t[A].getReadOnly(),lifecyclePackage:t[A].getLifecyclePackage(),lifecycleTransportId:t[A].getLifecycleTransportId(),namespace:t[A].getNamespace(),labelReadOnly:t[A].getLabelReadOnly(),author:t[A].getAuthor(),favorite:t[A].getFavorite(),vAlign:B.Middle});n=new O(this.oVariantManage.getId()+"-fav-"+a,{press:m});n.addStyleClass("sapUICompVarMngmtFavColor");if(t[A].getFavorite){this._setFavoriteIcon(n,t[A].getFavorite())}i.addCell(n);if(t[A].getKey()===this.getStandardVariantKey()||t[A].getReadOnly()===true||t[A].getLabelReadOnly()===true){n=new N(this.oVariantManage.getId()+"-text-"+a,{});n.setTitle(t[A].getText());if(u){n.setTooltip(u)}}else{n=new _(this.oVariantManage.getId()+"-input-"+a,{liveChange:c,change:p});n.setValue(t[A].getText())}i.addCell(n);if(t[A].getGlobal()){d=this.oResourceBundle.getText("VARIANT_MANAGEMENT_SHARED")}else{d=this.oResourceBundle.getText("VARIANT_MANAGEMENT_PRIVATE")}s=new g(this.oVariantManage.getId()+"-type-"+a,{text:d,wrapping:false});s.addStyleClass("sapUICompVarMngmtType");i.addCell(s);r=new h(this.oVariantManage.getId()+"-def-"+a,{groupName:this.oVariantManage.getId(),select:f});if(this.sNewDefaultKey===t[A].getKey()||t[A].getKey()===this.getStandardVariantKey()&&this.sNewDefaultKey===""){r.setSelected(true);if(t[A].getFavorite){this._setFavoriteIcon(i.getCells()[0],true)}}i.addCell(r);o=new V(this.oVariantManage.getId()+"-exe-"+a,{selected:false,enabled:false,select:y});if(t[A].getExecuteOnSelection){if(t[A].getKey()===this.getStandardVariantKey()&&this.getSupportExecuteOnSelectOnSandardVariant()){o.setEnabled(true);if(this.bExecuteOnSelectForStandardByUser!==null){o.setSelected(this.bExecuteOnSelectForStandardByUser)}else{o.setSelected(t[A].getExecuteOnSelection())}}else{o.setEnabled(!t[A].getReadOnly());o.setSelected(t[A].getExecuteOnSelection())}if(u){o.setTooltip(u)}}i.addCell(o);i.addCell(new g);s=new g(this.oVariantManage.getId()+"-author-"+a,{text:t[A].getAuthor(),textAlign:"Begin"});i.addCell(s);l=new v(this.oVariantManage.getId()+"-del-"+a,{icon:"sap-icon://decline",enabled:true,type:U.Transparent,press:S,tooltip:this.oResourceBundle.getText("VARIANT_MANAGEMENT_DELETE")});if(t[A].getReadOnly&&t[A].getReadOnly()){l.setEnabled(false);l.setVisible(false)}i.addCell(l);this.oManagementTable.addItem(i);a++}this.aRemovedVariants=[];this.aRemovedVariantTransports=[];this.aRenamedVariants=[];this.aExeVariants=[];this._createManagementDialog();this._setDialogCompactStyle(this,this.oManagementDialog);e=this.oVariantList.getSelectedItem();if(e){this.lastSelectedVariantKey=e.getKey()}this.oVariantPopOver.close();this.oManagementDialog.open()};$.prototype._assignColumnInfoForDeleteButton=function(e){if(!this._oInvisibleDeleteColumnName){this._oInvisibleDeleteColumnName=new D({text:this.oResourceBundle.getText("VARIANT_MANAGEMENT_ACTION_COLUMN")});this._createManagementDialog();this.oManagementDialog.addContent(this._oInvisibleDeleteColumnName)}if(this._oInvisibleDeleteColumnName){e.addAriaLabelledBy(this._oInvisibleDeleteColumnName)}};$.prototype._enableManualVariantKey=function(e){this.bManualVariantKey=e};$.prototype._fireSelectAsync=function(e){var t;if(e===undefined||e===null){var a=this._getSelectedItem();if(a===null){t=this.getStandardVariantKey()}else{t=a.getKey()}}this.fireSelect({key:t})};$.prototype.setSupportExecuteOnSelectOnSandardVariant=function(e){this.bSupportExecuteOnSelectOnSandardVariant=e};$.prototype.getSupportExecuteOnSelectOnSandardVariant=function(){return this.bSupportExecuteOnSelectOnSandardVariant};$.prototype._executeOnSelectForStandardVariantByXML=function(e){this.bExecuteOnSelectForStandardViaXML=e};$.prototype._executeOnSelectForStandardVariantByUser=function(e){this.bExecuteOnSelectForStandardByUser=e};$.prototype.getExecuteOnSelectForStandardVariant=function(){if(this.getSupportExecuteOnSelectOnSandardVariant()){if(this.bExecuteOnSelectForStandardByUser!==null){return this.bExecuteOnSelectForStandardByUser}}return this.bExecuteOnSelectForStandardViaXML};$.prototype.getStandardVariantKey=function(){return this._sStandardVariantKey};$.prototype.setStandardVariantKey=function(e){this._sStandardVariantKey=e};$.prototype._setVendorLayer=function(e){this._bVendorLayer=e};$.prototype.setStandardFavorite=function(e){this._isFavorite=e};$.prototype.getStandardFavorite=function(){return this._isFavorite};$.prototype._isIndustrySolutionModeAndVendorLayer=function(){if(this._getIndustrySolutionMode()&&this._bVendorLayer){return true}return false};$.prototype._setIndustrySolutionMode=function(e){this._bIndustrialSolutionMode=e};$.prototype._getIndustrySolutionMode=function(){return this._bIndustrialSolutionMode};return $});
sap.ui.require.preload({
	"sap/ui/comp/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.comp","type":"library","embeds":[],"applicationVersion":{"version":"1.141.0"},"title":"SAPUI5 library with smart controls.","description":"SAPUI5 library with smart controls.","ach":"CA-UI5-CMP\\n\\t\\t\\t","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_base","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_bluecrystal_base","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.141","libs":{"sap.ui.core":{"minVersion":"1.141.0"},"sap.m":{"minVersion":"1.141.0"},"sap.ui.mdc":{"minVersion":"1.141.0"},"sap.ui.fl":{"minVersion":"1.141.0","lazy":true},"sap.ui.table":{"minVersion":"1.141.0","lazy":true},"sap.chart":{"minVersion":"1.141.0","lazy":true},"sap.ui.layout":{"minVersion":"1.141.0","lazy":true},"sap.suite.ui.microchart":{"minVersion":"1.141.0","lazy":true}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cnr","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","mk","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":["sap.ui.comp.filterbar.FilterBar","sap.ui.comp.navpopover.NavigationPopover","sap.ui.comp.navpopover.Panel","sap.ui.comp.navpopover.SmartLink","sap.ui.comp.smartchart.SmartChart","sap.ui.comp.smartfield.SmartField","sap.ui.comp.smartfield.SmartLabel","sap.ui.comp.smartfilterbar.SmartFilterBar","sap.ui.comp.smartform.SmartForm","sap.ui.comp.smartmultiedit.Field","sap.ui.comp.smartmultiedit.Container","sap.ui.comp.smartmicrochart.SmartAreaMicroChart","sap.ui.comp.smartmicrochart.SmartLineMicroChart","sap.ui.comp.smartmicrochart.SmartBulletMicroChart","sap.ui.comp.smartmicrochart.SmartDeltaMicroChart","sap.ui.comp.smartmicrochart.SmartRadialMicroChart","sap.ui.comp.smartmicrochart.SmartStackedBarMicroChart","sap.ui.comp.smartmicrochart.SmartComparisonMicroChart","sap.ui.comp.smartmicrochart.SmartColumnMicroChart","sap.ui.comp.smartmicrochart.SmartHarveyBallMicroChart","sap.ui.comp.smartmicrochart.SmartMicroChart","sap.ui.comp.smarttable.SmartTable","sap.ui.comp.smartlist.SmartList","sap.ui.comp.valuehelpdialog.ValueHelpDialog","sap.ui.comp.transport.TransportDialog","sap.ui.comp.variants.EditableVariantItem","sap.ui.comp.variants.VariantManagement","sap.ui.comp.smartvariants.SmartVariantManagement","sap.ui.comp.smartvariants.SmartVariantManagementUi2"],"elements":["sap.ui.comp.filterbar.FilterGroupItem","sap.ui.comp.filterbar.FilterItem","sap.ui.comp.navpopover.LinkData","sap.ui.comp.navpopover.SemanticObjectController","sap.ui.comp.smartfield.Configuration","sap.ui.comp.smartfield.ControlProposal","sap.ui.comp.smartfield.ObjectStatus","sap.ui.comp.smartfilterbar.ControlConfiguration","sap.ui.comp.smartfilterbar.GroupConfiguration","sap.ui.comp.smartfilterbar.SelectOption","sap.ui.comp.smartform.Group","sap.ui.comp.smartform.GroupElement","sap.ui.comp.smartform.SemanticGroupElement","sap.ui.comp.smartform.Layout","sap.ui.comp.smartvariants.PersonalizableInfo","sap.ui.comp.variants.VariantItem","sap.ui.comp.navpopover.NavigationContainer","sap.ui.comp.smartvariants.SmartVariantManagementAdapter"],"types":["sap.ui.comp.smartfield.ControlProposalType","sap.ui.comp.smartfield.ControlContextType","sap.ui.comp.smartfield.ControlType","sap.ui.comp.smartchart.SelectionMode","sap.ui.comp.smartfield.DisplayBehaviour","sap.ui.comp.smartfield.JSONType","sap.ui.comp.smartfield.CriticalityRepresentationType","sap.ui.comp.smartfield.TextInEditModeSource","sap.ui.comp.smartfield.Importance","sap.ui.comp.smartfield.ValueHelpTitleSource","sap.ui.comp.TextArrangementType","sap.ui.comp.smarttable.TableType","sap.ui.comp.smarttable.ExportType","sap.ui.comp.smarttable.InfoToolbarBehavior","sap.ui.comp.smartlist.ListType","sap.ui.comp.personalization.AggregationRole","sap.ui.comp.personalization.ResetType","sap.ui.comp.personalization.ChangeType","sap.ui.comp.valuehelpdialog.ValueHelpRangeOperation","sap.ui.comp.smartfilterbar.SelectOptionSign","sap.ui.comp.smartfilterbar.DisplayBehaviour","sap.ui.comp.smartfilterbar.FilterType","sap.ui.comp.smartfilterbar.ControlType","sap.ui.comp.smartfilterbar.MandatoryType","sap.ui.comp.smartform.SmartFormValidationMode","sap.ui.comp.smartform.Importance"],"interfaces":["sap.ui.comp.smartform.SmartFormLayout","sap.ui.comp.IFormGroupElement","sap.ui.comp.IDropDownTextArrangement"]}}}}',
	"sap/ui/comp/smartchart/SmartChart.js":function(){
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
(function(){"use strict";var t=sap.ui.require("sap/ui/performance/Measurement");if(t&&t.getActive()){t.start("SmartChartInit","Measurement of SmartChart init time")}})();sap.ui.define(["sap/ui/core/Element","sap/ui/core/Lib","sap/ui/thirdparty/jquery","sap/ui/comp/library","sap/ui/comp/util/DateTimeUtil","sap/m/Button","sap/m/Text","sap/m/FlexItemData","sap/m/OverflowToolbar","sap/m/OverflowToolbarButton","sap/m/OverflowToolbarToggleButton","sap/m/ToolbarSeparator","sap/m/ToolbarSpacer","sap/m/VBox","sap/ui/comp/providers/ChartProvider","sap/ui/comp/smartfilterbar/FilterProvider","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/model/json/JSONModel","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/comp/personalization/Util","sap/ui/Device","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/state/UIState","sap/m/SelectionDetails","sap/m/SelectionDetailsItem","sap/m/SelectionDetailsItemLine","sap/m/Title","sap/ui/comp/util/FormatUtil","sap/ui/comp/navpopover/SmartLink","sap/ui/core/InvisibleText","sap/m/OverflowToolbarLayoutData","sap/m/library","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/ChartWrapper","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/performance/Measurement","sap/base/Log","sap/base/util/merge","sap/ui/core/CustomData","sap/ui/core/ResizeHandler","sap/ui/comp/util/FullScreenUtil","sap/ui/comp/util/FilterUtil","sap/ui/core/library","sap/ui/core/ShortcutHintsMixin","sap/ui/events/KeyCodes","sap/ui/base/DesignTime","sap/ui/core/date/UI5Date","sap/ui/mdc/chart/SelectionButton","sap/ui/mdc/chart/SelectionButtonItem","sap/ui/mdc/chart/SelectionButtonDisplay","sap/ui/core/InvisibleMessage","sap/ui/mdc/chart/ToolbarControlFactory","sap/ui/core/theming/Parameters","sap/m/IllustratedMessage","sap/ui/mdc/chart/Util"],function(t,e,jQuery,i,a,r,o,s,n,l,h,u,c,p,d,_,f,m,g,y,C,b,v,T,S,D,B,V,P,M,w,I,O,A,F,x,L,R,N,E,U,z,j,H,k,q,K,Z,G,$,W,Q,X,J,Y,tt,et,it,at){"use strict";var rt=x.ToolbarDesign;var ot=x.ListMode;var st=x.ListType;var nt=x.PlacementType;var lt=i.personalization.ChangeType;var ht=i.personalization.ResetType;var ut=i.smartchart.SelectionMode;var ct=K.TitleLevel;const{IllustratedMessageType:pt}=x;var dt;var _t;var ft;var mt;var gt;var yt;var Ct;var bt;var vt;var Tt;var St;var Dt;var Bt;var Vt;var Pt;var Mt;var wt=p.extend("sap.ui.comp.smartchart.SmartChart",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smartchart/SmartChart.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},chartType:{type:"string",group:"Misc",defaultValue:null},ignoredChartTypes:{type:"string",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useChartPersonalisation:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:ct.Auto},headerStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:ct.Auto},persistencyKey:{type:"string",group:"Misc",defaultValue:null},currentVariantId:{type:"string",group:"Misc",defaultValue:null},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},chartBindingPath:{type:"string",group:"Misc",defaultValue:null},showDrillButtons:{type:"boolean",group:"Misc",defaultValue:true},showZoomButtons:{type:"boolean",group:"Misc",defaultValue:true},showSemanticNavigationButton:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},showDownloadButton:{type:"boolean",group:"Misc",defaultValue:false},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false},showDrillBreadcrumbs:{type:"boolean",group:"Misc",defaultValue:false},showChartTooltip:{type:"boolean",group:"Misc",defaultValue:true},showLegendButton:{type:"boolean",group:"Misc",defaultValue:true},legendVisible:{type:"boolean",group:"Misc",defaultValue:true},selectionMode:{type:"sap.ui.comp.smartchart.SelectionMode",group:"Misc",defaultValue:ut.Multi},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:true},useTooltip:{type:"boolean",group:"Misc",defaultValue:true},useListForChartTypeSelection:{type:"boolean",group:"Misc",defaultValue:true},showChartTypeSelectionButton:{type:"boolean",group:"Misc",defaultValue:true},noData:{type:"string",group:"Misc",defaultValue:null},showToolbar:{type:"boolean",group:"Misc",defaultValue:true},toolbarStyle:{type:"sap.m.ToolbarStyle",group:"Appearance"},showDimensionsTitle:{type:"boolean",group:"Misc",defaultValue:true},showMeasuresTitle:{type:"boolean",group:"Misc",defaultValue:true},activateTimeSeries:{type:"boolean",group:"Misc",defaultValue:false},notAssignedText:{type:"string",group:"Misc",defaultValue:""}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{toolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},selectionDetailsItemActions:{type:"sap.ui.core.Item",multiple:true},selectionDetailsActions:{type:"sap.ui.core.Item",multiple:true},selectionDetailsActionGroups:{type:"sap.ui.core.Item",multiple:true}},events:{initialise:{},initialized:{},beforeRebindChart:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"},variantContext:{type:"string"}}},showOverlay:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},selectionDetailsActionPress:{parameters:{action:{type:"sap.ui.core.Item"},itemContexts:{type:"sap.ui.model.Context"},level:{type:"sap.m.SelectionDetailsActionLevel"}}},chartDataChanged:{parameters:{changeTypes:{type:"object"}}},uiStateChange:{}}},renderer:{apiVersion:2}});wt.prototype.init=function(){p.prototype.init.call(this);this.addStyleClass("sapUiCompSmartChart");this.setFitContainer(true);this._oChartTypeModel=null;var t=new g({items:[]});this.setModel(t,"$smartChartTypes");this._oRb=e.getResourceBundleFor("sap.ui.comp");this._oMDCRb=e.getResourceBundleFor("sap.ui.mdc");if(!this.getLayoutData()){this.setLayoutData(new s({growFactor:1,baseSize:"auto"}))}};wt.prototype._getVariantManagementControl=function(e){var i=null;if(e){if(typeof e==="string"){i=t.getElementById(e)}else{i=e}if(i){if(!(i instanceof f)){U.error("Control with the id="+typeof e.getId=="function"?e.getId():e+" not of expected type");return null}}}return i};wt.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||!this.getUseVariantManagement()&&!this.getUseChartPersonalisation()||!this.getPersistencyKey()){return}var t=new m({type:"chart",keyName:"persistencyKey",dataSource:this.getEntitySet()});t.setControl(this);var e=this.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){e=this._oSmartFilter.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}}else{this._oVariantManagement=new f(this.getId()+"-variant",{showShare:true});if(this._headerText){this._oVariantManagement.setShowAsText(!!this._headerText.getText());this._oVariantManagement.setHeaderLevel(this.getHeaderLevel());this._oVariantManagement.setTitleStyle(this.getHeaderStyle())}}if(this._oVariantManagement){if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement())}this._oVariantManagement.addPersonalizableControl(t);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this)}};wt.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD"}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding()}};wt.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}};wt.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()})};wt.prototype.setUseTooltip=function(t){this.setProperty("useTooltip",t,true);this._createTooltipOrPopover();return this};wt.prototype._createTooltipOrPopover=function(){if(this.getUseTooltip()&&this.getShowChartTooltip()){this._toggleChartTooltipVisibility(true)}else{this._createPopover()}};wt.prototype._createPopover=function(){if(this._oChart){if(!Tt&&!this._bVizPopoverRequested){Tt=sap.ui.require("sap/viz/ui5/controls/Popover");if(!Tt){sap.ui.require(["sap/viz/ui5/controls/Popover"],It.bind(this));this._bVizPopoverRequested=true}}if(!this._oPopover&&Tt&&!this._oChart._getVizFrame()._connectPopover){this._oPopover=new Tt({})}if(this._oPopover){this._oPopover.connect(this._oChart.getVizUid())}}};function It(t){Tt=t;this._bVizPopoverRequested=false;if(!this._bIsBeingDestroyed){this._createPopover()}}wt.prototype._destroyPopover=function(){if(this._oPopover){this._oPopover.destroy();this._oPopover=null}};wt.prototype.setUseVariantManagement=function(t){this.setProperty("useVariantManagement",t,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!t)}return this};wt.prototype.setToolbar=function(t){if(this._oToolbar){this.removeItem(this._oToolbar)}this._oToolbar=t;this._oToolbar.setLayoutData(new s({shrinkFactor:0}));this.insertItem(this._oToolbar,0);this._oToolbar.setVisible(this.getShowToolbar());this._oToolbar.setStyle(this.getToolbarStyle());return this};wt.prototype.getToolbar=function(){return this._oToolbar};wt.prototype.setHeader=function(t){this.setProperty("header",t,true);this._refreshHeaderText();return this};wt.prototype.setHeaderLevel=function(t){this.setProperty("headerLevel",t,true);this._refreshHeaderText();return this};wt.prototype.setHeaderStyle=function(t){this.setProperty("headerStyle",t,true);this._refreshHeaderText();return this};wt.prototype._refreshHeaderText=function(){if(!this._headerText){return}var t=this.getHeader();this._headerText.setText(t);this._headerText.setVisible(!!t);this._headerText.setLevel(this.getHeaderLevel());this._headerText.setTitleStyle(this.getHeaderStyle());if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setShowAsText(!!t);this._oVariantManagement.setHeaderLevel(this.getHeaderLevel());this._oVariantManagement.setTitleStyle(this.getHeaderStyle())}this._oSeparator?.setVisible(!!t)};wt.prototype._createToolbar=function(){if(!this._oToolbar){this._oToolbar=new n(this.getId()+"__toolbar",{design:rt[et.get({name:"_sap_ui_comp_SmartChart_ToolbarDesign"})]});this._oToolbar.addStyleClass("sapUiCompSmartChartToolbar");this._oToolbar.addStyleClass("sapMTBHeader-CTX");this._oToolbar.setLayoutData(new s({shrinkFactor:0}));this.insertItem(this._oToolbar,0);this._oToolbar.setVisible(this.getShowToolbar());this._oToolbar.setStyle(this.getToolbarStyle())}};wt.prototype.onThemeChanged=function(){if(this._oToolbar){const t=rt[et.get({name:"_sap_ui_comp_SmartChart_ToolbarDesign"})];this._oToolbar.setDesign(t)}};wt.prototype._createToolbarContent=function(){this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addSemanticNavigationButton();this._addDetailsButton();this._addDrillUpDownButtons();this._addLegendButton();this._addZoomInOutButtons();this._addDownloadButton();this._addPersonalisationToToolbar();this._addFullScreenButton();this._addChartTypeToToolbar();if(this._oToolbar&&(this._oToolbar.getContent().length===0||this._oToolbar.getContent().length===1&&this._oToolbar.getContent()[0]instanceof c)){this.removeItem(this._oToolbar);this._oToolbar.destroy();this._oToolbar=null}};wt.prototype.setShowVariantManagement=function(t){this.setProperty("showVariantManagement",t);if(this._oVariantManagement&&this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(t)}return this};wt.prototype.setShowDetailsButton=function(t){this.setProperty("showDetailsButton",t);if(this._oSelectionDetails){this._oSelectionDetails.setVisible(t);if(this._oDrillDownTextButton){this._oDrillDownTextButton.setVisible(t)}this._setBehaviorTypeForDataSelection()}if(this._oDrillDownButton){this._oDrillDownButton.setVisible(!t)}return this};wt.prototype.setShowChartTypeSelectionButton=function(t){this.setProperty("showChartTypeSelectionButton",t);if(this._oChartTypeButton){this._oChartTypeButton.setVisible(t)}return this};wt.prototype.setShowDownloadButton=function(t){this.setProperty("showDownloadButton",t);if(this._oDownloadButton){this._oDownloadButton.setVisible(t)}return this};wt.prototype.setShowDrillBreadcrumbs=function(t){this.setProperty("showDrillBreadcrumbs",t);if(this._oDrillBreadcrumbs){this._oDrillBreadcrumbs.setVisible(t)}if(this._oDrillUpButton){this._oDrillUpButton.setVisible(!t)}return this};wt.prototype.setShowChartTooltip=function(t){this.setProperty("showChartTooltip",t);this._toggleChartTooltipVisibility(t);return this};wt.prototype._setBehaviorTypeForDataSelection=function(){if(this.getShowDetailsButton()){this._oChart.setVizProperties({interaction:{behaviorType:"noHoverBehavior"}})}else if(this._oChart.getVizProperties().interaction.behaviorType){var t=this._oChart.getVizProperties().interaction;delete t.behaviorType;this._oChart.setVizProperties({interaction:t})}};wt.prototype._addDrillBreadcrumbs=function(){if(!this._oDrillBreadcrumbs&&this.getShowDrillBreadcrumbs()&&!this._bDoFullyInitializeChart){if(this._oChart){this._oDrillBreadcrumbs=tt.createDrillBreadcrumbs(this.getId(),{visible:this.getShowDrillBreadcrumbs(),linkPressed:function(t){const e=t.getParameter("index");this._oChart.drillUp(e+1);this._oChart.fireDeselectData(t);this._updateDrillBreadcrumbs()}.bind(this)}).addStyleClass("sapUiCompSmartChartBreadcrumbs");this.insertItem(this._oDrillBreadcrumbs,1);this._updateDrillBreadcrumbs();this._oChart.attachDrilledUp(function(t){this._updateDrillBreadcrumbs()}.bind(this));this._oChart.attachDrilledDown(function(t){this._updateDrillBreadcrumbs()}.bind(this))}}};wt.prototype.getDrillStackFilters=function(){var t=this._oChart.getDrillStack();var e=[];var i=function(t){if(!t){return}if(t&&t.sPath&&t.sOperator){e.push(t)}if(t.aFilters){t.aFilters.forEach(function(t){i(t)})}};t.forEach(function(t){i(t.filter)});return e};wt.prototype._getDrillStackDimensions=function(){var t=this._oChart.getDrillStack();var e=[];t.forEach(function(t){t.dimension.forEach(function(t){if(t!=null&&t!=""&&e.indexOf(t)==-1){e.push(t)}})});return e};wt.prototype._updateDrillBreadcrumbs=function(){if(!this._oDrillBreadcrumbs||!this.getShowDrillBreadcrumbs()){return}const t=this._oChart.getDrillStack();const e=[];let i=true;if(t){t.forEach(function(t,a){const r=t.dimension.length;const o=t.dimension[r-1];const s=this._oChart.getDimensionByName(o);if(r>0&&typeof s!="undefined"){const t=s.getLabel();e.push({key:o,text:t});i=true}else if(a==0){this._oDrillBreadcrumbs.setVisible(false);i=false}}.bind(this))}if(i){this._oDrillBreadcrumbs.update(e)}};wt.prototype._addDetailsButton=function(){this._oSelectionDetails=new V(this.getId()+"-selectionDetails",{visible:this.getShowDetailsButton(),customData:[new j({key:"sap-ui-custom-settings",value:{"sap.ui.dt":{designtime:"sap/ui/comp/designtime/smartchart/SmartChartDetails.designtime"}}})]});this._oSelectionDetails.registerSelectionDetailsItemFactory([],function(t,e,i,a){var r=[];var o=function(t){if(t){return t instanceof Object?t:t.toString()}else{return t}};for(var s=0;s<t.length;s++){r.push(new M({label:t[s].label,value:o(t[s].value),unit:t[s].unit}))}return new P({enableNav:function(){if(this._determineSemanticObjectsforDetailsPopover(e,i).length>0){return true}else{return false}}.bind(this)(),lines:r}).setBindingContext(i)}.bind(this));this._oSelectionDetails.attachNavigate(function(t){if(t.getParameter("direction")==="back"){t.getParameter("content").destroy()}else{this._navigateToSemanticObjectDetails(t)}}.bind(this));this._oSelectionDetails.attachActionPress(function(t){var e=[];t.getParameter("items").forEach(function(t){e.push(t.getBindingContext())});this.fireSelectionDetailsActionPress({id:t.getParameter("id"),action:t.getParameter("action"),itemContexts:e,level:t.getParameter("level")})}.bind(this));this._oSelectionDetails.attachBeforeOpen(function(t){var e=this._oSelectionDetails.getItems();e.forEach(function(t){var e=this._getDetailsActionsClones();e.selectionDetailsItemActions.forEach(function(e){t.addAction(e)})}.bind(this));var i=this._getDetailsActionsClones().selectionDetailsActions;this._oSelectionDetails.removeAllActions();i.forEach(function(t){this._oSelectionDetails.addAction(t)}.bind(this));var a=this._getDetailsActionsClones().selectionDetailsActionGroups;this._oSelectionDetails.removeAllActionGroups();a.forEach(function(t){this._oSelectionDetails.addActionGroup(t)}.bind(this))}.bind(this));this._oSelectionDetails.attachBeforeClose(function(t){this._oSelectionDetails.setPopoverModal(false);if(this._oPanel){this._oPanel.destroy()}}.bind(this));this._oToolbar.addContent(this._oSelectionDetails);this._addDrillDownTextButton()};wt.prototype._getDetailsActionsClones=function(){var t={selectionDetailsItemActions:[],selectionDetailsActions:[],selectionDetailsActionGroups:[]};this.getSelectionDetailsItemActions().forEach(function(e){t.selectionDetailsItemActions.push(e.clone())});this.getSelectionDetailsActions().forEach(function(e){t.selectionDetailsActions.push(e.clone())});this.getSelectionDetailsActionGroups().forEach(function(e){t.selectionDetailsActionGroups.push(e.clone())});return t};wt.prototype._addDownloadButton=function(){if(!this._oDownloadButton){this._oDownloadButton=new l(this.getId()+"btnDownload",{type:"Transparent",text:this._oRb.getText("CHART_DOWNLOADBTN_TEXT"),tooltip:this._oRb.getText("CHART_DOWNLOADBTN_TOOLTIP"),icon:"sap-icon://download",visible:this.getShowDownloadButton(),enabled:false,press:function(t){if(window.navigator&&window.navigator.msSaveOrOpenBlob){var e=new window.Blob([this._getVizFrame().exportToSVGString()],{type:"image/svg+xml"});window.navigator.msSaveOrOpenBlob(e)}else{this._downloadChartPNG()}}.bind(this)});this._oToolbar.addContent(this._oDownloadButton)}};wt.prototype._downloadChartSVG=function(){var t=this.getHeader();var e=document.createElement("a");e.setAttribute("href","data:image/svg+xml,"+encodeURIComponent(this._getVizFrame().exportToSVGString()));e.setAttribute("download",t?t:"Chart"+".svg");e.click()};wt.prototype._downloadChartPNG=function(){var t=this.getHeader();var e=this._getVizFrame().exportToSVGString();var i=document.createElement("canvas");var a=i.getContext("2d");var r=new Image;r.width=i.width=document.getElementById(this._oChart.getId()).offsetWidth;r.height=i.height=document.getElementById(this._oChart.getId()).offsetHeight;r.onload=function(){a.drawImage(r,0,0);var e=document.createElement("a");e.setAttribute("href",i.toDataURL());e.setAttribute("download",t?t:"Chart"+".png");e.click()};r.setAttribute("crossOrigin","anonymous");r.src="data:image/svg+xml,"+encodeURIComponent(e)};wt.prototype._addFullScreenButton=function(){var t;if(this.getShowFullScreenButton()){t=new l(this.getId()+"-btnFullScreen",{type:"Transparent",press:function(){this._toggleFullScreen(!this.bFullScreen)}.bind(this),enabled:false});this.oFullScreenButton=t;this._renderFullScreenButton();this._oToolbar.addContent(t)}};wt.prototype._addZoomInOutButtons=function(){const t=this.getId();this._oZoomInButton=tt.createZoomInBtn(t,{visible:this.getShowZoomButtons(),enabled:false,press:function(t){if(this._oChart){this._oChart.zoom({direction:"in"});this._oZoomInPressed=true;this._toggleZoomButtonEnablement()}}.bind(this)});this._oZoomOutButton=tt.createZoomOutBtn(t,{visible:this.getShowZoomButtons(),enabled:false,press:function(t){if(this._oChart){this._oChart.zoom({direction:"out"});this._oZoomOutPressed=true;this._toggleZoomButtonEnablement()}}.bind(this)});this._oToolbar.addContent(this._oZoomInButton);this._oToolbar.addContent(this._oZoomOutButton)};wt.prototype._toggleZoomButtonEnablement=function(){var t=this._oChart.getZoomInfo().currentZoomLevel;if(t===undefined){return}else if(t===null){this._oZoomOutButton.setEnabled(false);this._oZoomInButton.setEnabled(false)}else if(t===0){if(this._oZoomOutPressed){this._oZoomInButton.focus();this._oZoomOutPressed=false}this._oZoomOutButton.setEnabled(false);this._oZoomInButton.setEnabled(true)}else if(t===1){if(this._oZoomInPressed){this._oZoomOutButton.focus();this._oZoomInPressed=false}this._oZoomInButton.setEnabled(false);this._oZoomOutButton.setEnabled(true)}else{if(this._oZoomOutButton.getEnabled()==false){this._oZoomOutButton.setEnabled(true)}if(this._oZoomInButton.getEnabled()==false){this._oZoomInButton.setEnabled(true)}}};wt.prototype.setShowZoomButtons=function(t){this.setProperty("showZoomButtons",t);if(this._oZoomInButton){this._oZoomInButton.setVisible(t)}if(this._oZoomOutButton){this._oZoomOutButton.setVisible(t)}return this};wt.prototype.setShowFullScreenButton=function(t){this.setProperty("showFullScreenButton",t);if(this.oFullScreenButton){this.oFullScreenButton.setVisible(t)}return this};wt.prototype.setLegendVisible=function(t){this.setProperty("legendVisible",t);this._setLegendVisible(t);return this};wt.prototype._setLegendVisible=function(t){var e=this._getVizFrame();if(e){e.setLegendVisible(t)}};wt.prototype._getVizFrame=function(){var t=null;if(this._oChart){t=this._oChart.getAggregation("_vizFrame")}return t};wt.prototype._addLegendButton=function(){const t=this.getId();this._oLegendButton=tt.createLegendBtn(t,{visible:this.getShowLegendButton(),enabled:false,press:function(){this.setLegendVisible(!this.getLegendVisible())}.bind(this),pressed:this.getLegendVisible()});this._oToolbar.addContent(this._oLegendButton)};wt.prototype.setShowLegendButton=function(t){this.setProperty("showLegendButton",t);if(this._oLegendButton){this._oLegendButton.setVisible(t)}return this};wt.prototype.setShowSemanticNavigationButton=function(t){this.setProperty("showSemanticNavigationButton",t);if(this._oSemanticalNavButton){this._oSemanticalNavButton.setVisible(t)}else{if(t){this._addSemanticNavigationButton()}}return this};wt.prototype._addSemanticNavigationButton=function(){var e=this;if(!this._oSemanticalNavButton&&this.getShowSemanticNavigationButton()&&this._oToolbar){this._oSemanticalNavButton=new r(this.getId()+"-btnNavigation",{type:"Transparent",text:this._oRb.getText("CHART_SEMNAVBTN"),tooltip:this._oRb.getText("CHART_SEMNAVBTN_TOOLTIP"),visible:this.getShowSemanticNavigationButton(),enabled:false});this._oSmartLink=new O({navigationTargetsObtainedCallback:function(e){const i=e.mainNavigation;if(i){const a=t.getElementById(e.originalId);const r=a.getBindingContext();const o=r.getObject();const s=this._getField(a.getFieldName());const n=I.getTextsFromDisplayBehaviour(s.displayBehaviour,o[s.name],o[s.description]);i.setDescription(n.secondText);return Promise.resolve({mainNavigationId:n.firstText,mainNavigation:i})}return Promise.resolve()}});var i=this.getSemanticObjectController();if(i){this._oSmartLink.setSemanticObjectController(i)}this._oSemanticalNavButton.attachPress(t=>{if(this._aSemanticObjects&&this._aSemanticObjects.length>0){if(this._aSemanticObjects.length===1){var i=D.getSemanticObjectsFromProperty(this._aSemanticObjects[0]);if(i){this._oSmartLink.setFieldName(this._aSemanticObjects[0].name);this._oSmartLink.setSemanticObject(i.defaultSemanticObject);this._oSmartLink.setAdditionalSemanticObjects(i.additionalSemanticObjects);this._oSmartLink.getFieldInfo().open(this._oSemanticalNavButton,t)}}else{e._semanticObjectList(this._aSemanticObjects,this._oSmartLink)}}});if(this._oChart){this._attachDataPointHandling()}else{this.attachInitialized(function(){this._attachDataPointHandling()}.bind(this))}var a=this._indexOfSpacerOnToolbar();this._oToolbar.insertContent(this._oSemanticalNavButton,a+1)}};wt.prototype._attachDataPointHandling=function(){if(this._oChart){this._oChart.attachDeselectData(function(){this._aSemanticObjects=this._setSelectionDataPointHandling(this._oSmartLink)}.bind(this));this._oChart.attachSelectData(function(){this._aSemanticObjects=this._setSelectionDataPointHandling(this._oSmartLink)}.bind(this))}};wt.prototype.setSelectionMode=function(t){this.setProperty("selectionMode",t);if(this._oChart){this._oChart.setSelectionMode(t)}return this};wt.prototype._setSelectionDataPointHandling=function(t){var e=this._setSelectionDataPoint(t);if(e&&e.length>0){this._oSemanticalNavButton.setEnabled(true)}else{this._oSemanticalNavButton.setEnabled(false)}return e};wt.prototype._setSemanticObjectsContext=function(t){var e,i,a=null;e=t.getParameter("item").getBindingContext();if(e){i=e.getObject();if(i){a=this._determineSemanticObjectsforDetailsPopover(i,e)}}return a};wt.prototype._setSelectionDataPoint=function(t){var e,i,a=null,r;var o=this._oChart.getSelectedDataPoints();if(!o||!o.dataPoints||o.dataPoints.length===0){return a}if(o.dataPoints.length===1){e=o.dataPoints[0].context;if(e){i=e.getObject();if(i){a=this._determineSemanticObjects(i,e);if(a&&a.length>0){t.setBindingContext(e)}}}return a}r=[];for(var s=0;s<o.dataPoints.length;s++){e=o.dataPoints[s].context;if(e){i=e.getObject();if(i){r.push(i)}}}if(r&&r.length>0){a=this._condensBasedOnSameValue(r);if(a&&a.length>0){t.setBindingContext(o.dataPoints[o.dataPoints.length-1].context)}}return a};wt.prototype._condensBasedOnSameValue=function(t){var e=null,i,a,r;e=this._determineSemanticObjects(t[0]);if(e&&e.length>0){for(var o=0;o<e.length;o++){a=e[o];r=a.name;if(this._bAllValuesAreEqual(t,r)){if(!i){i=[]}i.push(a)}}e=i}return e};wt.prototype._bAllValuesAreEqual=function(t,e){var i,a;for(var r=0;r<t.length;r++){i=t[r];if(r===0){a=i[e];continue}if(a!=i[e]){return false}}return true};wt.prototype._semanticObjectList=function(t,e){var i,a,r,o;if(this._oChart){if((!Dt||!Bt||!Vt)&&!this._bSemanticObjectListRequested){Dt=sap.ui.require("sap/m/ResponsivePopover");Bt=sap.ui.require("sap/m/List");Vt=sap.ui.require("sap/m/StandardListItem");if(!Dt||!Bt||!Vt){sap.ui.require(["sap/m/ResponsivePopover","sap/m/List","sap/m/StandardListItem"],Ot.bind(this));this._bSemanticObjectListRequested=true;this._oSemanticObjectListAttr={object:t,nav:e}}}if(!Dt||!Bt||!Vt){return}a=new Bt({mode:ot.SingleSelectMaster,selectionChange:t=>{if(t&&t.mParameters&&t.mParameters.listItem){var a=t.mParameters.listItem.data("semObj");if(a){e.setFieldName(t.mParameters.listItem.data("fieldName"));e.setSemanticObject(a.defaultSemanticObject);e.setAdditionalSemanticObjects(a.additionalSemanticObjects);e.getFieldInfo().open(this._oSemanticalNavButton,t)}}i.close()}});for(var s=0;s<t.length;s++){o=t[s];r=new Vt({title:o.fieldLabel,type:st.Active});r.data("semObj",D.getSemanticObjectsFromProperty(o));r.data("fieldName",o.name);a.addItem(r)}i=new Dt({title:this._oRb.getText("CHART_SEMNAVBTN"),showHeader:false,contentWidth:"12rem",placement:nt.Left});i.addContent(a);i.openBy(this._oSemanticalNavButton)}};function Ot(t,e,i){Dt=t;Bt=e;Vt=i;this._bSemanticObjectListRequested=false;if(!this._bIsBeingDestroyed){this._semanticObjectList(this._oSemanticObjectListAttr.object,this._oSemanticObjectListAttr.nav)}delete this._oSemanticObjectListAttr}wt.prototype._semanticObjectListForDetails=function(t,e){var i,a,r;if(!this._oChart){return undefined}i=new Bt({mode:ot.SingleSelectMaster,rememberSelections:false,itemPress:function(t){if(t&&t.mParameters&&t.mParameters.listItem){var i=t.mParameters.listItem.data("semObj");if(i){const a=t.mParameters.listItem.data("fieldName");this._createSemanticObjectDetails(a,e,i)}}}.bind(this)});N.getDistinctSemanticObjects().then(function(o){for(var s=0;s<t.length;s++){r=t[s];if(r["com.sap.vocabularies.Common.v1.SemanticObject"]&&r["com.sap.vocabularies.Common.v1.SemanticObject"].String&&N.hasDistinctSemanticObject([r["com.sap.vocabularies.Common.v1.SemanticObject"].String],o)){a=new Vt({title:r.fieldLabel,type:st.Navigation});a.setBindingContext(e);a.data("semObj",D.getSemanticObjectsFromProperty(r));a.data("fieldName",r.name);i.addItem(a)}}});return i};wt.prototype._determineSemanticObjects=function(t,e){var i,a,r=[];if(t){for(i in t){if(i){a=this._getField(i);if(a&&a.isDimension&&a.isSemanticObject){r.push(a)}}}}if(r){r.sort(function(t,e){return t.fieldLabel.localeCompare(e.fieldLabel)})}return r};wt.prototype._determineSemanticObjectsforDetailsPopover=function(t,e){var i,a,r=[];if(t){for(i in t){if(i){a=this._getField(i);if(a&&a.isDimension&&a.isSemanticObject){r.push(a)}}}}if(r){r.sort(function(t,e){return t.fieldLabel.localeCompare(e.fieldLabel)})}return r};wt.prototype._addDrillUpDownButtons=function(){if(this.getShowDrillButtons()){this._oDrillUpButton=new l(this.getId()+"-btnDrillUp",{type:"Transparent",tooltip:this._oRb.getText("CHART_DRILLUPBTN_TOOLTIP"),text:this._oRb.getText("CHART_DRILLUPBTN_TEXT"),icon:"sap-icon://drill-up",press:function(){if(this._oChart){this._oChart.drillUp()}}.bind(this),visible:!this.getShowDrillBreadcrumbs(),enabled:false});const t=this.getId();this._oDrillDownButton=tt.createDrillDownBtn(t,{visible:!this.getShowDetailsButton(),enabled:false,display:J.Icon,icon:"sap-icon://drill-down",beforeOpen:this._prepareDrillDown.bind(this),itemSelected:this._performDrillDown.bind(this)});this._oToolbar.addContent(this._oDrillUpButton);this._oToolbar.addContent(this._oDrillDownButton)}};wt.prototype._addDrillDownTextButton=function(){this._oDrillDownTextButton=tt.createDrillDownBtn(this.getId()+"-btnDrillDownText",{visible:this.getShowDetailsButton(),enabled:false,beforeOpen:this._prepareDrillDown.bind(this),itemSelected:this._performDrillDown.bind(this)});this._oToolbar.addContent(this._oDrillDownTextButton)};wt.prototype.setShowDrillButtons=function(t){this.setProperty("showDrillButtons",t);if(this._oDrillUpButton){this._oDrillUpButton.setVisible(t)}if(this._oDrillDownButton){this._oDrillDownButton.setVisible(t)}return this};wt.prototype._triggerSearchInPopover=function(t,e){if(!t||!e){return}var i=t.getParameter("newValue");var a=[];if(i){a=new C("text","Contains",i)}e.getBinding("items").filter(a)};wt.prototype._prepareDrillDown=function(t){const e=t.getSource();const i=new X({key:"{$smartChartDrilldown>text}",text:"{$smartChartDrilldown>text}"});const a=this._getDrillStackDimensions();const r=this._getSortedDimensions();var o={items:[]};for(var s=0;s<r.length;s++){const t=r[s];if(a.indexOf(t.getName())>-1){continue}const e=this._oChartProvider.getViewField(t.getName());if(!e.filterable&&this._oChart.getSelectedDataPoints().count>0){continue}o.items.push({text:t.getLabel()})}const n=new g;n.setSizeLimit(1e3);n.setData(o);e.setModel(n,"$smartChartDrilldown");e.bindAggregation("items",{path:"$smartChartDrilldown>/items",template:i});e.setSelectedItemKey("");e.setSearchEnabled(e.getModel("$smartChartDrilldown").getData().items.length>7)};wt.prototype._performDrillDown=function(t){const e=t.getParameter("item").key;var i=this._getSortedDimensions();var a=i.filter(function(t){return t.getLabel()===e});var r=a.length===1?a[0]:null;if(r){this._oChart.drillDown(r)}};wt.prototype._updateDrillDownTextButton=function(){const t=this._oChart.getDimensions().length;const e=this._oChart.getVisibleDimensions().length;this._oDrillDownTextButton.setEnabled(!(t==0||t==e))};wt.prototype._navigateToSemanticObjectDetails=function(t){var e=this._setSemanticObjectsContext(t);if(e&&e.length>0){if(e.length===1){var i=D.getSemanticObjectsFromProperty(e[0]);if(i){var a=t.getParameter("item");this._createSemanticObjectDetails(e[0].name,a.getBindingContext(),i)}}else{var r=t.getParameter("item").getBindingContext();if((!Bt||!Vt)&&!this._bObjectListRequested){Bt=sap.ui.require("sap/m/List");Vt=sap.ui.require("sap/m/StandardListItem");if(!Bt||!Vt){sap.ui.require(["sap/m/List","sap/m/StandardListItem"],At.bind(this));this._bObjectListRequested=true;this._oObjectListAttr={context:r,objects:e}}}if(Bt&&Vt){var o=this._semanticObjectListForDetails(e,r);this._oSelectionDetails.navTo(this._oRb.getText("CHART_SEMNAVBTN"),o)}}}};wt.prototype._createSemanticObjectDetails=async function(t,e,i){const a=new O({fieldName:t,semanticObject:i.defaultSemanticObject,additionalSemanticObjects:i.additionalSemanticObjects,navigationTargetsObtainedCallback:function(i){const a=i.mainNavigation;if(a){var r=e.getObject();var o=this._getField(t);var s=I.getTextsFromDisplayBehaviour(o.displayBehaviour,r[o.name],r[o.description]);a.setDescription(s.secondText);return Promise.resolve({mainNavigationId:s.firstText,mainNavigation:a})}return Promise.resolve()}});a.setParent(this);try{const t=await a.getFieldInfo().getContent();this._oPanel=t;const e=await a.getFieldInfo().checkDirectNavigation({getSource:()=>{}});if(e){t.destroy()}else{t.attachBeforeSelectionDialogOpen(()=>{this._oSelectionDetails.setPopoverModal(true)});t.attachAfterSelectionDialogClose(()=>{this._oSelectionDetails.setPopoverModal(false)});this._oSelectionDetails.navTo("",t)}}catch(t){U.error("NavigationContainer could not be determined: "+t)}};function At(t,e){Bt=t;Vt=e;this._bObjectListRequested=false;if(!this._bIsBeingDestroyed){var i=this._semanticObjectListForDetails(this._oObjectListAttr.objects,this._oObjectListAttr.context);this._oSelectionDetails.navTo(this._oRb.getText("CHART_SEMNAVBTN"),i)}delete this._oObjectListAttr}wt.prototype._addHeaderToToolbar=function(){if(this._oToolbar){if(!this._headerText){this._headerText=new w({})}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)}};wt.prototype._addSeparatorToToolbar=function(){if(this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oSeparator=new u;this._oToolbar.insertContent(this._oSeparator,0);if(!this._oToolbar.getHeight()){this._oToolbar.setHeight("auto")}}else if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator)}};wt.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0)}else if(this._oVariantManagement){this._oToolbar.removeContent(this._oVariantManagement)}}};wt.prototype._addSpacerToToolbar=function(){if(this._indexOfSpacerOnToolbar()===-1){this._oToolbar.addContent(new c)}};wt.prototype._indexOfSpacerOnToolbar=function(){var t=this._oToolbar.getContent(),e,i;if(t){i=t.length;e=0;for(e;e<i;e++){if(t[e]instanceof c){return e}}}return-1};wt.prototype._getP13NSettings=function(){return{dimeasure:{visible:true,payload:{availableChartTypes:this.getAvailableChartTypes()}},sort:{visible:true},filter:{visible:true},contentWidth:"48rem"}};wt.prototype._addPersonalisationToToolbar=function(){if(this.getUseChartPersonalisation()){if(!this._oChartPersonalisationButton){this._oChartPersonalisationButton=tt.createSettingsBtn(this.getId(),{enabled:false,press:function(t){if(this._oPersController){this._oPersController.openDialog(this._getP13NSettings())}}.bind(this)})}this._oToolbar.addContent(this._oChartPersonalisationButton)}else if(this._oChartPersonalisationButton){this._oToolbar.removeContent(this._oChartPersonalisationButton)}};wt.prototype.onkeydown=function(t){if(t.isMarked()){return}if((t.metaKey||t.ctrlKey)&&t.which===G.COMMA){var e=this._oChartPersonalisationButton;if(e&&e.getVisible()&&e.getEnabled()){e.firePress();t.setMarked();t.preventDefault()}}};wt.prototype.getVariantManagement=function(){return this._oVariantManagement};wt.prototype.openDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;var i=this._getP13NSettings();i.styleClass=t;i.showReset=false;if(!this._oPersController){this._bDoFullyInitializeChart=true;this.getChartAsync().then(function(){this._oPersController.openDialog(i);this._oPersController.attachDialogAfterClose(function(t){delete this._bDoFullyInitializeChart;this._bFullyInitialzeChart=true}.bind(this))}.bind(this))}else{this._oPersController.openDialog(i)}};wt.prototype._cleanUpKeyUser=function(){this._fGetDataForKeyUser=null};wt.prototype._createKeyUserChange=function(){return[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]};wt.prototype._addChartTypeToToolbar=function(){this._oChartTypeButton=this._createChartTypeButton();this._oToolbar.addContent(this._oChartTypeButton)};wt.prototype._createChartTypeButton=function(){const t=this.getId();var e=tt.createChartTypeBtn(t,{visible:this.getShowChartTypeSelectionButton(),enabled:false,selectedItemKey:this.getChartType(),beforeOpen:function(t){const e=t.getSource();const i=new X({key:"{$smartChartTypes>key}",text:"{$smartChartTypes>text}",icon:"{$smartChartTypes>icon}"});e.setModel(this.getModel("$smartChartTypes"),"$smartChartTypes");e.bindAggregation("items",{path:"$smartChartTypes>/items",template:i});e.setSearchEnabled(e.getModel("$smartChartTypes").getData().items.length>7)}.bind(this),itemSelected:function(t){const e=t.getParameter("item").key;this._setChartType(e)}.bind(this)});return e};var Ft={bar:"sap-icon://horizontal-bar-chart",bullet:"sap-icon://horizontal-bullet-chart",bubble:"sap-icon://bubble-chart",column:"sap-icon://vertical-bar-chart",combination:"sap-icon://business-objects-experience",dual_bar:"sap-icon://horizontal-bar-chart",dual_column:"sap-icon://vertical-bar-chart",dual_combination:"sap-icon://business-objects-experience",dual_horizontal_combination:"sap-icon://business-objects-experience",dual_horizontal_stacked_combination:"sap-icon://business-objects-experience",dual_line:"sap-icon://line-chart",dual_stacked_bar:"sap-icon://full-stacked-chart",dual_stacked_column:"sap-icon://vertical-stacked-chart",dual_stacked_combination:"sap-icon://business-objects-experience",donut:"sap-icon://donut-chart",heatmap:"sap-icon://heatmap-chart",horizontal_stacked_combination:"sap-icon://business-objects-experience",line:"sap-icon://line-chart",pie:"sap-icon://pie-chart",scatter:"sap-icon://scatter-chart",stacked_bar:"sap-icon://full-stacked-chart",stacked_column:"sap-icon://vertical-stacked-chart",stacked_combination:"sap-icon://business-objects-experience",treemap:"sap-icon://Chart-Tree-Map",vertical_bullet:"sap-icon://vertical-bullet-chart","100_dual_stacked_bar":"sap-icon://full-stacked-chart","100_dual_stacked_column":"sap-icon://vertical-stacked-chart","100_stacked_bar":"sap-icon://full-stacked-chart","100_stacked_column":"sap-icon://full-stacked-column-chart",waterfall:"sap-icon://vertical-waterfall-chart",horizontal_waterfall:"sap-icon://horizontal-waterfall-chart"};wt.prototype._rerenderControlInFullscreen=function(){if(this.bFullScreen){this._oChart.setLayoutData(new s({baseSize:"100%"}))}};wt.prototype._getMatchingIcon=function(t){var e=Ft[t];if(!e){e=""}return e};wt.prototype._enrichPassedButton=function(t,e,i){if(!t){return}if(i===undefined){i=e;var a=this._retrieveChartTypeDescription(e);if(a&&a.text){i=a.text}}t.data("chartType",e);var r=this._getMatchingIcon(e);t.setIcon(r?r:"sap-icon://vertical-bar-chart");var o=this._oChart.getChartType()===e?"CHART_TYPE_TOOLTIP":"CHART_TYPE_UNSEL_TOOLTIP";t.setTooltip(this._oRb.getText(o,[i]))};wt.prototype._updateAvailableChartType=function(){var t=this,e,i,a=[];e=this.getModel("$smartChartTypes");if(!e){return}i={items:a};var r=this._oChart.getChartType();this.getAvailableChartTypes().forEach(function(e){var i={key:e.key,text:e.text,icon:t._getMatchingIcon(e.key),selected:r===e.key};a.push(i)});e.setData(i);if(this._oSegmentedButton){this._updateVisibilityOfChartTypes(this._oSegmentedButton)}this._updateVizTooltipFormatter()};wt.prototype._createPersonalizationController=function(){if(this._oPersController){return}var e=this.data("p13nDialogSettings");if(typeof e==="string"){try{e=JSON.parse(e)}catch(t){e=null}}e=this._setIgnoreFromPersonalisationToSettings(e);e=e||{};var i=R.createChartWrapper(this._oChart,this._oChart.data("p13nData"),this._aColumnKeysOrdered);if(this.$()&&this.$().closest(".sapUiSizeCompact").length>0){this._oChart.addStyleClass("sapUiSizeCompact")}this._oPersController=new L(this.getId()+"-persoController",{table:i,setting:e,resetToInitialTableState:!this.getUseVariantManagement(),afterP13nModelDataChange:this._personalisationModelDataChange.bind(this)});this._oPersController.attachDialogConfirmedReset(function(){if(this._oDrillBreadcrumbs){this._updateDrillBreadcrumbs()}var e=t.getElementById(this.getId()+"-btnChartType");if(e){this._enrichPassedButton(e,this._oChart.getChartType())}}.bind(this));this._oPersController.attachDialogAfterClose(function(t){if(this._fGetDataForKeyUser){if(t.getParameter("cancel")){this._fGetDataForKeyUser([])}this._cleanUpKeyUser()}}.bind(this))};wt.prototype._setIgnoreFromPersonalisationToSettings=function(t){var e=v.createArrayFromString(this.getIgnoreFromPersonalisation());if(e.length){if(!t){t={}}var i=function(i){if(!t[i]){t[i]={}}t[i].ignoreColumnKeys=e};i("dimeasure");i("filter");i("sort")}return t};wt.prototype._personalisationModelDataChange=function(t){this._oCurrentVariant=t.getParameter("persistentData");if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}var e=t.getParameter("runtimeDeltaDataChangeType");var i=this._getChangeStatus(e);if(i===lt.Unchanged){return}this._fireChartDataChanged(e);if(!this._bApplyingVariant){if(!this.getUseVariantManagement()){this._persistPersonalisation()}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true)}}this._updateAvailableChartType();this._toggleIllustratedMessage();this._enrichPassedButton(this._oChartTypeButton,this._oChart.getChartType());this._updateDrillDownTextButton();this._checkDimensionColoring();if(this.getActivateTimeSeries()&&!this._bDisableTimeseriesUTC&&!this._oChart.getVizProperties().general.showAsUTC){try{if(!this._oChart.getVizProperties().general.showAsUTC){this._oChart.setVizProperties({general:{showAsUTC:true}})}if(this._bWorkaroundVizFormatter){this._oChart.setVizProperties({timeAxis:{levelConfig:{day:{visible:true,formatString:"MediumDay"},month:{visible:true,formatString:"MediumMonth"}}}})}}catch(t){U.error("Couldn't set showAsUTC=true")}}if(i===lt.TableChanged){if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(false)}}else if(i===lt.ModelChanged&&this._isChartBound()){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindChart()}}if(this._oDrillBreadcrumbs){this._updateDrillBreadcrumbs()}this.fireUiStateChange()};wt.prototype._toggleIllustratedMessage=function(){this._bInvalidChartType=false;if(!this._oChart?.getBlocked()){const t=this._oVBox;const e=this._oChart.getAvailableChartTypes().unavailable;const i=this._oChart.getChartType();const a=e.findIndex(t=>t.chart===i);if(a!==-1){t?.setVisible(true);this._oChart.setVisible(false);const r=e[a].error;this._sErrorMsg=at.getErrorMessageForMissingMeasuresAndDimensions(i,r);this._oIllustratedMessage?.setDescription(this._sErrorMsg);this._bInvalidChartType=true}else{t?.setVisible(false);this._oChart.setVisible(true)}}};wt.prototype._isChartBound=function(){if(this._bIsChartBound){return true}if(this._oChart){return this._oChart.isBound("data")}return false};wt.prototype._fireChartDataChanged=function(t){var e={dimeasure:false,filter:false,sort:false};for(var i in t){if(t[i]!=="Unchanged"){e[i]=true}}this.fireChartDataChanged({changeTypes:e})};wt.prototype._getChangeStatus=function(t){if(!t){return lt.ModelChanged}if(t.sort===lt.ModelChanged||t.filter===lt.ModelChanged||t.dimeasure===lt.ModelChanged||t.group===lt.ModelChanged){return lt.ModelChanged}if(t.sort===lt.TableChanged||t.filter===lt.TableChanged||t.dimeasure===lt.TableChanged||t.group===lt.TableChanged){return lt.TableChanged}return lt.Unchanged};wt.prototype.setEntitySet=function(t){this.setProperty("entitySet",t);this._initialiseMetadata();return this};wt.prototype.propagateProperties=function(){p.prototype.propagateProperties.apply(this,arguments);this._initialiseMetadata()};wt.prototype._initialiseMetadata=function(){if(!this._bMetadataIsInitialised){S.handleModelInit(this,this._onMetadataInitialised,true)}};wt.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(!this._bMetadataIsInitialised){this._listenToSmartFilter();this._createToolbar();this._createVariantManagementControl();this._createToolbarContent();this._bMetadataIsInitialised=true;if(this._bInitialiseEventInUse){this._initialiseInnerChart()}if(E.getActive()){E.end("SmartChartInit")}if(!this._oVariantManagement||this._oVariantManagement&&this._bVariantInitialised){this._checkAndTriggerBinding()}}};wt.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindChart()}}else if(!this._oChart){this._createTempNoData()}}};wt.prototype._createTempNoData=function(){var t=new o({text:this.getNoData()});this._oNoDataStruct=new p({items:[t],justifyContent:"Center",alignItems:"Center",height:"100%"});this.insertItem(this._oNoDataStruct,2)};wt.prototype._createChartProvider=function(){var t,e;e=this.getEntitySet();t=this.getModel();if(t&&!this._bChartCreated){this._aAlwaysSelect=[];this._aInitialSorters=[];this._addDrillBreadcrumbs();this._bChartCreated=true}if(t&&e){this._oChartProvider=new d({entitySet:e,ignoredFields:this.getIgnoredFields(),dateFormatSettings:this.data("dateFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDimensionDisplayBehaviour"),skipAnnotationParse:this.data("skipAnnotationParse"),chartQualifier:this.data("chartQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),model:t,chartLibrary:dt,criticalityType:Pt,notAssignedText:this.getNotAssignedText()})}};wt.prototype._listenToSmartFilter=function(){this._fetchSmartFilter();if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindChart,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this)}};wt.prototype.setNoData=function(t){if(this._oChart){this._oChart.setCustomMessages({NO_DATA:t})}this.setProperty("noData",t);return this};wt.prototype.getNoData=function(){var t=this.getProperty("noData");if(!this.getProperty("noData")){if(!this._oChart){this._fetchSmartFilter();if(this._oSmartFilter){t=this._oRb.getText("CHART_NO_DATA")}else{t=this._oRb.getText("CHART_NO_DATA_WITHOUT_FILTERBAR")}}else{t=this._oRb.getText("CHART_NO_RESULTS")}}return t};wt.prototype._fetchSmartFilter=function(){var t=null;t=this.getSmartFilterId();this._oSmartFilter=this._findControl(t)};wt.prototype._filterChangeEvent=function(){if(this._isChartBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true)}};wt.prototype._adjustOverlayHeight=function(){if(T.browser.safari||T.browser.chrome){var t=this._oChart.$(),e=t.find(".sapUiCompSmartChartOverlay");if(e.length===1){e.height(t.height())}}};wt.prototype._renderOverlay=function(t){if(this._oChart){var e=this._oChart.$(),i=e.find(".sapUiCompSmartChartOverlay");if(t&&i.length===0){i=jQuery("<div>").addClass("sapUiOverlay sapUiCompSmartChartOverlay").css("z-index","1");e.append(i);this._adjustOverlayHeight();this.sOverlayResizeListenerId=H.register(e,this._adjustOverlayHeight.bind(this))}else if(!t){i.remove();H.deregister(this.sOverlayResizeListenerId)}}};wt.prototype.showOverlay=function(t){this._showOverlay(t)};wt.prototype._showOverlay=function(t){if(t){var e={show:true};this.fireShowOverlay({overlay:e});t=e.show}this._hasOverlay=t;this._renderOverlay(t)};wt.prototype._findControl=function(e){var i,a;if(e){i=t.getElementById(e);if(!i){a=this._getView();if(a){i=a.byId(e)}}}return i};wt.prototype._getView=function(){if(!this._oView){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){this._oView=t;break}t=t.getParent()}}return this._oView};wt.prototype._updateInResultDimensions=function(){var t=this._getInResultDimensionTotal();var e=function(t){var e=this._oChart.getInResultDimensions();if(e.length!=t.length){return false}for(var i=0,a=e.length;i<a;i++){if(e[i]!=t[i]){return false}}return true}.bind(this);if(t.length>0&&!e(t)){this._oChart.setInResultDimensions(t)}};wt.prototype._initialiseInnerChart=function(){this._createChart();this._createChartProvider();if(this._oChartProvider){this._oChartViewMetadata=this._oChartProvider.getChartViewMetadata();if(this._oChartViewMetadata){this._assignData();this._createContent();this._createPersonalizationController();this._oChart.attachRenderComplete(this._toggleZoomButtonEnablement,this);this._oSelectionDetails.attachSelectionHandler("_selectionDetails",this._oChart);this._enrichPassedButton(this._oChartTypeButton,this._oChart.getChartType());this._enableToolbarButtons();this._checkDimensionColoring();this._updateDrillBreadcrumbs();this.bIsInitialised=true;this.fireInitialise();this.fireInitialized();this.applyVariant(this.fetchVariant())}}};wt.prototype._enableToolbarButtons=function(){if(this._bDoFullyInitializeChart){return}if(this._oDrillUpButton&&this._oDrillDownButton){this._oDrillUpButton.setEnabled(true);this._oDrillDownButton.setEnabled(true)}if(this._oDrillDownTextButton){this._updateDrillDownTextButton()}if(this._oLegendButton){this._oLegendButton.setEnabled(true)}if(this._oZoomInButton&&this._oZoomOutButton){this._oZoomInButton.setEnabled(true);this._oZoomOutButton.setEnabled(true)}if(this._oDownloadButton){this._oDownloadButton.setEnabled(true)}if(this._oChartPersonalisationButton){this._oChartPersonalisationButton.setEnabled(true)}if(this.oFullScreenButton){this.oFullScreenButton.setEnabled(true)}if(this._oChartTypeButton){this._oChartTypeButton.setEnabled(true)}};wt.prototype.rebindChart=function(){if(!this._bMetadataIsInitialised){U.error("rebindChart method called before the metadata is initialized. Please execute the UI5 Support Assistant 'SmartChart' rules to get more information",this.getId(),"sap.ui.comp.smartChart")}this._reBindChart()};wt.prototype._reBindChart=function(t){var i,a,r=[],o,s,n,l={},h={preventChartBind:false};if(!this._oChart){if((!dt||!_t||!ft||!gt||!yt||!Ct||!bt||!vt||!St||!mt||!Pt||!Mt)&&!this._bChartRequested){dt=sap.ui.require("sap/chart/library");_t=sap.ui.require("sap/chart/Chart");ft=sap.ui.require("sap/chart/ColoringType");gt=sap.ui.require("sap/chart/data/Dimension");yt=sap.ui.require("sap/chart/data/HierarchyDimension");Ct=sap.ui.require("sap/chart/data/TimeDimension");bt=sap.ui.require("sap/chart/data/Measure");vt=sap.ui.require("sap/chart/data/MeasureSemantics");St=sap.ui.require("sap/viz/ui5/controls/VizTooltip");mt=sap.ui.require("sap/viz/ui5/format/ChartFormatter");Pt=sap.ui.require("sap/chart/coloring/CriticalityType");Mt=sap.ui.require("sap/chart/TimeUnitType");if(!dt||!_t||!ft||!gt||!yt||!Ct||!bt||!vt||!St||!mt||!Pt||!Mt){e.load({name:"sap.chart"}).then(function(){sap.ui.require(["sap/chart/library","sap/chart/Chart","sap/chart/ColoringType","sap/chart/data/Dimension","sap/chart/data/HierarchyDimension","sap/chart/data/TimeDimension","sap/chart/data/Measure","sap/chart/data/MeasureSemantics","sap/viz/ui5/controls/VizTooltip","sap/viz/ui5/format/ChartFormatter","sap/chart/coloring/CriticalityType","sap/chart/TimeUnitType"],function(e,i,a,r,o,s,n,l,h,u,c,p){dt=e;_t=i;ft=a;gt=r;yt=o;Ct=s;bt=n;vt=l;St=h;mt=u;Pt=c;Mt=p;this._bChartRequested=false;if(!this._bIsBeingDestroyed){this._reBindChart(t)}}.bind(this));this._bChartRequested=true}.bind(this))}}if(!dt||!_t||!ft||!gt||!yt||!Ct||!bt||!vt||!St||!mt||!Pt||!Mt){return}this._initialiseInnerChart()}this._bTriggerAnnouncement=t?.getId&&t.getId()==="search";if(this._bFullyInitialzeChart){this._enableToolbarButtons();this._addDrillBreadcrumbs();delete this._bFullyInitialzeChart}i=this._getChartPersonalisationData()||{};o=i.filters;s=i.excludeFilters;n=i.sorters;if(this._oSmartFilter){a=this._oSmartFilter.getFilters();l=this._oSmartFilter.getParameters()||{}}if(a&&a.length){if(s){r=[new C([a[0],s],true)]}else{r=a}}else if(s){r=[s]}if(o){o=r.concat(o)}else{o=r}this._updateInResultDimensions();l["entitySet"]=this.getEntitySet();if(!n){n=[]}h.filters=o;h.sorter=n;h.parameters=l;h.events={};this.fireBeforeRebindChart({bindingParams:h});if(!h.preventChartBind&&this._oChartViewMetadata){n=h.sorter;o=h.filters;l=h.parameters;this._oChart.setBusy(true);this._bDataLoadPending=true;wt._addBindingListener(h,"change",this._onDataLoadComplete.bind(this));wt._addBindingListener(h,"dataReceived",this._onDataReceived.bind(this));var u={path:this.getChartBindingPath()||"/"+this.getEntitySet(),parameters:l,filters:o,events:h.events};if(!this._isChartBound()){u.sorter=n}if(h.length){u.length=h.length}else{var c=this._oChartProvider.getMaxItems();if(c>0){u.length=c}}this._oChart.bindData(u);if(this._isChartBound()){this._oChart.getBinding("data").sort(n)}this._showOverlay(false);this._bIsChartBound=true}};wt.prototype._validateSorters=function(t){var e=[];var i=this._oChart.getVisibleDimensions().concat(this._oChart.getVisibleMeasures());if(t){t.forEach(function(t){i.forEach(function(i){if(t.sPath===i){e.push(t)}})})}return e};wt.prototype._onDataReceived=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._onDataLoadComplete(t,true);try{this.fireDataReceived(t)}catch(t){}};wt._addBindingListener=function(t,e,i){if(!t.events){t.events={}}if(!t.events[e]){t.events[e]=i}else{var a=t.events[e];t.events[e]=function(){i.apply(this,arguments);a.apply(this,arguments)}}};wt.prototype._onDataLoadComplete=function(t,e){if(this._oSemanticalNavButton){this._oSemanticalNavButton.setEnabled(false)}if(this._bDataLoadPending||e){this._bDataLoadPending=false;this._updateAvailableChartType();this._oChart.setBusy(false);if(this._bTriggerAnnouncement){this._bTriggerAnnouncement=false;this._announceUpdate(this._oChart.getChartType(),this.getHeader(),this._oChart.getVisibleDimensions().length,this._oChart.getVisibleMeasures().length)}}};wt.prototype._announceUpdate=function(t,e,i,a){const r=Y.getInstance();if(r){const o=this._oRb;const s=this._getChartTypes();t=s[t]||t;let n=o.getText("CHART_ANNOUNCEMENT_UPDATED",[e,t]);let l;if(i&&a){if(i===1&&a===1){l="CHART_ANNOUNCEMENT_DIMMEA_11_UPDATED"}else if(i>1&&a===1){l="CHART_ANNOUNCEMENT_DIMMEA_N1_UPDATED"}else if(i===1&&a>1){l="CHART_ANNOUNCEMENT_DIMMEA_1N_UPDATED"}else{l="CHART_ANNOUNCEMENT_DIMMEA_NN_UPDATED"}n+=" "+o.getText(l,[i,a])}r.announce(n)}};wt.prototype._assignData=function(){if(this._oChartViewMetadata&&this._oChart){this._oChart.resetLayout();if(this._oChartViewMetadata.measureFields&&this._oChartViewMetadata.measureFields.length>0){this._oChart.setVisibleMeasures(this._oChartViewMetadata.measureFields)}if(this._oChartViewMetadata.dimensionFields&&this._oChartViewMetadata.dimensionFields.length>0){this._oChart.setVisibleDimensions(this._oChartViewMetadata.dimensionFields)}if(!this.getChartType()&&this._oChartViewMetadata.chartType){this._setChartType(this._oChartViewMetadata.chartType)}}};wt.prototype._createP13nObject=function(t){if(t.sortable&&t.sorted){var e={columnKey:t.name,operation:t.sortOrder};if(t.sortIndex!=null){this._aInitialSorters.splice(t.sortIndex,0,e)}else{this._aInitialSorters.push(e)}}return{columnKey:t.name,leadingProperty:t.name,additionalProperty:t.additionalProperty,sortProperty:t.sortable?t.name:undefined,filterProperty:t.filterable?t.name:undefined,fullName:t.hasValueListAnnotation?t.fullName:null,type:t.filterType,typeInstance:t.modelType,maxLength:t.maxLength,precision:t.precision,scale:t.scale,isMeasure:t.isMeasure,isDimension:t.isDimension,isHierarchyDimension:t.isHierarchyDimension,hierarchyLevel:t.hierarchyLevel,aggregationRole:t.aggregationRole,label:t.label,tooltip:t.quickInfo,sorted:t.sorted,sortOrder:t.sortOrder,criticality:t.valueCriticality}};wt.prototype._createContent=function(){var t,e=0,i,a,r,o=[],s;var n=[];this._aColumnKeysOrdered=[];Object.assign(this._aColumnKeysOrdered,this._oChartViewMetadata.dimensionFields);this._aColumnKeysOrdered=this._aColumnKeysOrdered.concat(this._oChartViewMetadata.measureFields);e=this._oChartViewMetadata.fields.length;var l=this._oChartViewMetadata.dimensionFields||[];var h=this._oChartViewMetadata.measureFields||[];for(t=0;t<e;t++){a=null;i=this._oChartViewMetadata.fields[t];i.label=i.fieldLabel||i.name;if(this._aColumnKeysOrdered.indexOf(i.name)===-1){this._aColumnKeysOrdered.push(i.name)}if(this._oChart.getDimensionByName(i.name)===undefined&&this._oChart.getMeasureByName(i.name)===undefined){s=this._createP13nObject(i);r={name:i.name,label:i.label,tooltip:i.quickInfo}}if(i.inResult){this._aAlwaysSelect.push(i.name)}if(i.isDimension||i.isHierarchyDimension||l.indexOf(i.name)!=-1){if(this._oChart.getDimensionByName(i.name)===undefined){if(i.isDimension){if(i.isTimeDimension&&this.getActivateTimeSeries()){a=new Ct(r);var u=i.timeUnitType;if(Mt.hasOwnProperty(i.timeUnitType)){a.setTimeUnit(Mt[u])}if(!this._bDisableTimeseriesUTC){try{a._setIsUTC(true)}catch(t){U.error("Couldn't set UTC settings on TimeDimension")}}}else{a=new gt(r)}}else{r.level=i.hierarchyLevel;a=new yt(r)}this._oChart.addDimension(a);if(i.isTimeDimension&&this.getActivateTimeSeries()){if(i.customFormatter){a.setTextFormatter(i.customFormatter)}}else if(i.description){a.setTextProperty(i.description);a.setTextFormatter(I.getFormatterFunctionFromDisplayBehaviour(i.displayBehaviour,false,this))}else if(i.customFormatter){if(i.timezone){a.setTextProperty(i.timezone)}a.setTextFormatter(i.customFormatter)}else if(i.isDimension){a.setTextFormatter(function(t,e){if(t===""){return this.getNotAssignedText()}else{return t}}.bind(this))}}else{var c=this._oChart.getDimensionByName(i.name).data("p13nData");if(c){this._oChart.getDimensionByName(i.name).data("p13nData",typeof c==="string"?JSON.parse(c):c)}}}else if(i.isMeasure||h.indexOf(i.name)!=-1){if(this._oChart.getMeasureByName(i.name)===undefined){a=new bt(r);this._oChart.addMeasure(a);if(i.dataPoint){n.push({dataPoint:i.dataPoint,measure:a})}if(i.unit){a.setUnitBinding(i.unit)}}else{var c=this._oChart.getMeasureByName(i.name).data("p13nData");if(c){this._oChart.getMeasureByName(i.name).data("p13nData",typeof c==="string"?JSON.parse(c):c)}}}else if(i.sortable||i.filterable){o.push(s)}if(a){if(i.role){a.setRole(i.role)}a.data("p13nData",s)}}if(this._oChart){this._oChart.data("p13nData",o)}if(n.length>0){this._enrichFromDataPoints(n)}};wt.prototype._getField=function(t){var e,i,a;if(t&&this._oChartViewMetadata&&this._oChartViewMetadata.fields){a=this._oChartViewMetadata.fields.length;for(i=0;i<a;i++){e=this._oChartViewMetadata.fields[i];if(e.name===t){return e}}}return null};wt.prototype.attachInitialise=function(t,e,i){this.attachEvent("initialise",t,e,i);this._bInitialiseEventInUse=true;sap.ui.getCore().loadLibrary("sap.chart");dt=sap.ui.requireSync("sap/chart/library");_t=sap.ui.requireSync("sap/chart/Chart");ft=sap.ui.requireSync("sap/chart/ColoringType");gt=sap.ui.requireSync("sap/chart/data/Dimension");yt=sap.ui.requireSync("sap/chart/data/HierarchyDimension");Ct=sap.ui.requireSync("sap/chart/data/TimeDimension");bt=sap.ui.requireSync("sap/chart/data/Measure");vt=sap.ui.requireSync("sap/chart/data/MeasureSemantics");St=sap.ui.requireSync("sap/viz/ui5/controls/VizTooltip");mt=sap.ui.requireSync("sap/viz/ui5/format/ChartFormatter");Pt=sap.ui.requireSync("sap/chart/coloring/CriticalityType");Mt=sap.ui.requireSync("sap/chart/TimeUnitType");if(this._bMetadataIsInitialised){this._initialiseInnerChart()}U.error("The event 'initialise' is deprecated, please use 'initialized' instead");return this};wt.prototype._createChart=function(){if(this._oNoDataStruct){this._oNoDataStruct.destroy()}var t=this.getItems(),e=t?t.length:0,i,a=this;var r;this._bDisableTimeseriesUTC=true;while(e--){i=t[e];if(i instanceof _t){break}i=null}if(i){this._oChart=i;try{r=this.data("dateFormatSettings")?JSON.parse(this.data("dateFormatSettings")):{};if(r.hasOwnProperty("UTC")){this._bDisableTimeseriesUTC=!r["UTC"]}if(r.hasOwnProperty("style")&&r["style"].toLowerCase()=="medium"){this._bWorkaroundVizFormatter=true}}catch(t){}}else{var o={uiConfig:{applicationSet:"fiori"},busyIndicatorDelay:0,vizProperties:{title:{text:""},plotArea:{scrollbar:{forceToShowInMobile:true},dataLabel:{hideWhenOverlap:false}},general:{groupData:false},valueAxis:{title:{visible:a.getShowMeasuresTitle()}},categoryAxis:{title:{visible:a.getShowDimensionsTitle()},layout:{autoHeight:true,autoWidth:true}}},selectionMode:this.getSelectionMode(),width:"100%"};try{r=this.data("dateFormatSettings")?JSON.parse(this.data("dateFormatSettings")):{};if(r.hasOwnProperty("UTC")){o.vizProperties.general.showAsUTC=!!r["UTC"];this._bDisableTimeseriesUTC=!r["UTC"];if(r.hasOwnProperty("style")&&r["style"].toLowerCase()=="medium"){o.vizProperties.timeAxis={levelConfig:{day:{visible:true,formatString:"MediumDay"},month:{visible:true,formatString:"MediumMonth"}}};this._bWorkaroundVizFormatter=true}}}catch(t){}this._oChart=new _t(o);const t=this._createUIErrorForInvalidChartType();this._oVBox=new p({items:[t],justifyContent:"Center",alignItems:"Center",height:"100%",width:"100%",visible:false});if(this.getHeight()){this._oChart.setHeight("100%")}this._toggleChartTooltipVisibility(this.getShowChartTooltip());this._setBehaviorTypeForDataSelection();this.insertItem(this._oChart,2);this.insertItem(this._oVBox,3)}if(T.browser.safari||T.browser.chrome||T.browser.firefox){this.addStyleClass("sapUiCompSmartChartInnerChartHeight")}this.setLegendVisible(this.getLegendVisible());if(!this._oChart.getLayoutData()){var n={growFactor:1};var l=this.getLayoutData();if(l&&l.getBaseSize){n.baseSize=l.getBaseSize()}else{n.baseSize="100%"}this._oChart.setLayoutData(new s(n))}if(this.getChartType()){this._setChartType(this.getChartType())}this._oChart.attachRenderComplete(function(){if(this._hasOverlay){setTimeout(function(){this._showOverlay(true)}.bind(this),0)}this._oChart.getLayoutData().setGrowFactor(1)}.bind(this));this._oChart.setCustomMessages({NO_DATA:this.getNoData()});this._createTooltipOrPopover()};wt.prototype._createUIErrorForInvalidChartType=function(){const t=this._oMDCRb.getText("chart.INVALID_CHART_TYPE_ERROR_MESSAGE_TITLE");const e=this._oMDCRb.getText("chart.INVALID_CHART_TYPE_DEFAULT_ERROR_MESSAGE_DESCRIPTION");this._oIllustratedMessage=new it({enableVerticalResponsiveness:true,title:t,illustrationType:pt.NoChartData,description:e,additionalContent:[new r({text:this._oMDCRb.getText("chart.CHANGE_SETTINGS"),press:function(t){this._oChartPersonalisationButton?.firePress?.()}.bind(this)}),new r({text:this._oMDCRb.getText("chart.SELECT_ANOTHER_CHART_TYPE"),press:function(t){this._oChartTypeButton?.firePress?.()}.bind(this)}).addStyleClass("sapUiTinyMarginBegin")]});return this._oIllustratedMessage};wt.prototype._toggleChartTooltipVisibility=function(t){if(this._oChart){if(t){if(!this._vizTooltip){this._vizTooltip=new St}this._vizTooltip.connect(this._oChart.getVizUid())}else if(this._vizTooltip){this._vizTooltip.destroy()}}};wt.prototype._updateVizTooltipFormatter=function(){if(this._vizTooltip){if(this._oChart.getChartType().match(/100/)!==null){this._vizTooltip.setFormatString(mt.DefaultPattern.STANDARDPERCENT_MFD2)}else{this._vizTooltip.setFormatString(mt.DefaultPattern.STANDARDFLOAT)}}};wt.prototype.getChart=function(){if(!this._oChart&&this._bMetadataIsInitialised){sap.ui.getCore().loadLibrary("sap.chart");dt=sap.ui.requireSync("sap/chart/library");_t=sap.ui.requireSync("sap/chart/Chart");ft=sap.ui.requireSync("sap/chart/ColoringType");gt=sap.ui.requireSync("sap/chart/data/Dimension");yt=sap.ui.requireSync("sap/chart/data/HierarchyDimension");Ct=sap.ui.requireSync("sap/chart/data/TimeDimension");bt=sap.ui.requireSync("sap/chart/data/Measure");vt=sap.ui.requireSync("sap/chart/data/MeasureSemantics");St=sap.ui.requireSync("sap/viz/ui5/controls/VizTooltip");mt=sap.ui.requireSync("sap/viz/ui5/format/ChartFormatter");Pt=sap.ui.requireSync("sap/chart/coloring/CriticalityType");Mt=sap.ui.requireSync("sap/chart/TimeUnitType");this._initialiseInnerChart()}else if(!this._bMetadataIsInitialised){U.error("Accesing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!")}U.error("This function is deprecated, please use getChartAsync instead");return this._oChart};wt.prototype.getChartAsync=function(){if(!this._oChart&&this._bMetadataIsInitialised){return new Promise(function(t,e){sap.ui.require(["sap/chart/library","sap/chart/Chart","sap/chart/ColoringType","sap/chart/data/Dimension","sap/chart/data/HierarchyDimension","sap/chart/data/TimeDimension","sap/chart/data/Measure","sap/chart/data/MeasureSemantics","sap/viz/ui5/controls/VizTooltip","sap/viz/ui5/format/ChartFormatter","sap/chart/coloring/CriticalityType","sap/chart/TimeUnitType"],function(){dt=arguments[0];_t=arguments[1];ft=arguments[2];gt=arguments[3];yt=arguments[4];Ct=arguments[5];bt=arguments[6];vt=arguments[7];St=arguments[8];mt=arguments[9];Pt=arguments[10];Mt=arguments[11];this._bChartRequested=false;if(!this._oChart){this._initialiseInnerChart()}if(this._oChart){t(this._oChart)}else{e("The inner chart couldn't be created")}}.bind(this))}.bind(this))}else if(!this._bMetadataIsInitialised){U.error("Accessing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!");return Promise.reject(new Error("Accessing the inner chart before the metadata is initialized will not work. Instead, wait for the initialized event!"))}else{return Promise.resolve(this._oChart)}};wt.prototype._getChartTypes=function(){var t;try{t=dt.api.getChartTypes()}catch(e){t={};U.error("sap.chart.api.getChartTypes throws an exception.\n"+e.toString())}return t};wt.prototype.getAvailableChartTypes=function(){var t,e,i=[],a,r={},o,s;if(this._oChart){o=this.getIgnoredChartTypes();if(this.getActivateTimeSeries()){o=o.concat(this._oChartProvider.getIgnoredChartTypesForTimeSeries())}s=v.createArrayFromString(o);r=this._getChartTypes();a=this._oChart.getAvailableChartTypes().available;if(a){for(t=0;t<a.length;t++){e=a[t].chart;if(s.indexOf(e)<0){i.push({key:e,text:r[e]})}}}}return i};wt.prototype._retrieveChartTypeDescription=function(t){var e=this._getChartTypes();return{key:t,text:e[t]}};wt.prototype._setChartType=function(t){if(this._oChart){var e=this._oChart.getHeight();this._oChart.setChartType(t);this._aDetailsEntries=[];this._toggleMeasureUnitBinding(t,this._oChart.getMeasures());this._oChart.setHeight(e)}};wt.prototype._toggleMeasureUnitBinding=function(t,e){if(typeof e!="undefined"&&e instanceof Array){if(t.substring(0,4)==="100_"){e.forEach(function(t){t.setUnitBinding()})}else if(this._oChartProvider){var i=this._oChartProvider._aODataFieldMetadata;e.forEach(function(t){for(var e=i.length-1;e>=0;e--){if(i[e].name==t.getName()){var a=i[e];var r=a["Org.OData.Measures.V1.ISOCurrency"]?.Path;if(r){t.setUnitBinding(r)}else{r=a["Org.OData.Measures.V1.Unit"]?.Path;if(r){t.setUnitBinding(r)}}break}}})}}};wt.prototype._getDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getDimensions()}return t};wt.prototype._getVisibleDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getVisibleDimensions()}return t};wt.prototype._getMeasures=function(){var t=[];if(this._oChart){t=this._oChart.getMeasures()}return t};wt.prototype._getVisibleMeasures=function(){var t=[];if(this._oChart){t=this._oChart.getVisibleMeasures()}return t};wt.prototype._getSortedDimensions=function(){var t=[];if(this._oChart){t=this._oChart.getDimensions();if(t){t.sort(function(t,e){if(t.getLabel()&&e.getLabel()){return t.getLabel().localeCompare(e.getLabel())}})}}return t};wt.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{}}var t=this._processDateFiltersForVariant(this._oCurrentVariant);return t};wt.prototype.applyVariant=function(t,e){this._oCurrentVariant=t;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null}this._bApplyingVariant=true;if(this._oPersController){if(this._oCurrentVariant===null||jQuery.isEmptyObject(this._oCurrentVariant)){this._oPersController.resetPersonalization(ht.ResetFull)}else{this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId(),variantContext:e})};wt.prototype._processDateFiltersForVariant=function(t){if(!this._oPersController){return t}var e=v.getColumnKeysOfType("date",this._oPersController._oColumnHelper.getColumnMap()),i=v.getColumnKeysOfType("time",this._oPersController._oColumnHelper.getColumnMap());if(e.length===0||!(t&&t.filter&&t.filter.filterItems)){return t}var r=t.filter.filterItems.map(function(t){if(e.concat(i).includes(t.columnKey)&&this._oChartProvider&&this._oChartProvider.getIsUTCDateHandlingEnabled()){t=Object.assign({},t);if(t.value1 instanceof Date){t.value1=a.localToUtc(t.value1).toISOString();t.value1=t.value1.slice(0,-1)}if(t.value2 instanceof Date){t.value2=a.localToUtc(t.value2).toISOString();t.value2=t.value2.slice(0,-1)}}return t},this);t=Object.assign({},t,{filter:Object.assign({},t.filter,{filterItems:r})});return t};wt.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding()};wt.prototype.getUiState=function(){if(!this.isInitialised()){U.error("SmartChart: Called getUiState() before inner structure was initialized. This will force a synchronous load of dependencies.");this.getChart()}var t=this._oPersController?this._oPersController.getDataSuiteFormatSnapshot():null;return new B({presentationVariant:{ContextUrl:"",MaxItems:this._oChartProvider?this._oChartProvider.getMaxItems():undefined,SortOrder:t?t.SortOrder:[],GroupBy:t?t.GroupBy:[],Total:t?t.Total:[],RequestAtLeast:this._getInResultDimensionTotal(),Visualizations:t?t.Visualizations:[]},selectionVariant:{SelectOptions:t?t.SelectOptions:[]},variantName:this.getCurrentVariantId()})};wt.prototype.setUiState=function(t){if(this._oPersController){var e=this._oVariantManagement&&t.getVariantName()?this._oVariantManagement.getVariantContent(this,t.getVariantName()):{};this._oPersController.setDataSuiteFormatSnapshot(z({},t.getPresentationVariant(),t.getSelectionVariant()),e,true)}this._setInResultDimensionFromVariant(t)};wt.prototype.setUiStateAsVariant=function(t,e){if(this._oPersController){this._oPersController.setPersonalizationDataAsDataSuiteFormat(z({},t.getPresentationVariant(),t.getSelectionVariant()),true)}this._setInResultDimensionFromVariant(t);if(this._oVariantManagement){this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId(),variantContext:e})}};wt.prototype._setInResultDimensionFromVariant=function(t){if(t.getPresentationVariant()&&this._oChart){this._oChart.setInResultDimensions(t.getPresentationVariant().RequestAtLeast)}else{this._oUiStateRequestAtLeast=t.getPresentationVariant().RequestAtLeast}};wt.prototype.setRequestAtLeastFields=function(t){this.setProperty("requestAtLeastFields",t);if(this._oChart){this._updateInResultDimensions()}return this};wt.prototype._getInResultDimensionTotal=function(){var t=[];if(this.getRequestAtLeastFields()){t=this.getRequestAtLeastFields().split(",")}t=t.concat(this._aAlwaysSelect);if(this._oChart){t=t.concat(this._oChart.getInResultDimensions())}if(this._oUiStateRequestAtLeast){t.concat(this._oUiStateRequestAtLeast);this._oUiStateRequestAtLeast=null}return t.filter(function(t,e,i){return e==i.indexOf(t)})};wt.prototype._getFieldByKey=function(t){var e,i=null;if(this._oChartViewMetadata&&this._oChartViewMetadata.fields){for(e=0;e<this._oChartViewMetadata.fields.length;e++){i=this._oChartViewMetadata.fields[e];if(t===i.name){return i}}return null}};wt.prototype._getByKey=function(t,e){var i,a,r,o;if(t){a=t.length;for(i=0;i<a;i++){r=t[i];o=r.data("p13nData");if(o&&o.columnKey===e){return r}}}return null};wt.prototype._getDimensionByKey=function(t){if(this._oChart){return this._getByKey(this._oChart.getDimensions(),t)}return null};wt.prototype._getMeasureByKey=function(t){if(this._oChart){return this._getByKey(this._oChart.getMeasures(),t)}return null};wt.prototype._getChartObjByKey=function(t){var e=this._getDimensionByKey(t);if(!e){e=this._getMeasureByKey(t)}return e};wt.prototype._getPathFromColumnKeyAndProperty=function(t,e){var i=null,a,r;a=this._getChartObjByKey(t);if(a){r=a.data("p13nData");if(r){i=r[e]}}return i};wt.prototype._getChartPersonalisationData=function(){var t=function(t){return t};if(!this._oCurrentVariant){return null}var e=[],i=[],r=[],o,s,n,l,h;if(this._oCurrentVariant.sort){s=this._oCurrentVariant.sort.sortItems}else{s=this._aInitialSorters}if(s){s.forEach(function(i){var a=i.operation==="Descending";n=t(i.columnKey);e.push(new y(n,a))},this)}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(e){var o=e.operation;var s=e.value1;var u=e.value2;n=e.columnKey;var c=this._oChartViewMetadata?.fields?.find(function(t){return t.name===n});if(c?.filterType==="time"){if(s instanceof Date){s=I.getEdmTimeFromDate(s)}if(u instanceof Date){u=I.getEdmTimeFromDate(u)}}else{h=c?.filterType==="datetime";if(h){s=s?W.getInstance(s):s;u=u?W.getInstance(u):u}if(!h&&s instanceof Date&&this._oChartProvider&&this._oChartProvider.getIsUTCDateHandlingEnabled()){s=a.localToUtc(s);u=u?a.localToUtc(u):u}if(h&&(c.filterRestriction=="interval"||c.filterRestriction=="auto")){if(o==="EQ"){o="BT";u=new Date(s);u.setMilliseconds(999)}else if(o==="LT"||o==="LE"){s.setMilliseconds(999)}else if(o==="BT"&&s&&u){u.setMilliseconds(999)}}}n=t(n);var p=function(t,e,i){if(i==="Empty"){i=e?q.getTransformedExcludeOperation("EQ"):"EQ";t.push(new C(n,i,""));if(c&&c.isNullable){t.push(new C(n,i,null))}}else{i=e?q.getTransformedExcludeOperation(i):i;l=new C(n,i,s,u);if(h&&c?.precision){l=I.adaptMilliseconds(l,c.precision,i)}t.push(l)}};p(e.exclude?r:i,e.exclude,o)},this);if(r.length){o=new C(r,true)}}return{filters:i,excludeFilters:o,sorters:e}};wt.prototype._persistPersonalisation=function(){var t="Personalisation";if(!$.isDesignModeEnabled()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){var e=this._oVariantManagement.getViewIdByName(t);if(e===null){e=this.getCurrentVariantId()}if(!this._bSaving){this._bSaving=true;this._oVariantManagement.fireSave({name:t,implicit:true,global:false,overwrite:!!e,key:e,def:true});delete this._bSaving}}};wt.prototype.getCurrentVariantId=function(){var t="";if(this._oVariantManagement){t=this._oVariantManagement.getCurrentVariantId()}return t};wt.prototype.setCurrentVariantId=function(t){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(t)}else{U.error("sap.ui.comp.smartchart.SmartChart.prototype.setCurrentVariantId: VariantManagement does not exist or is a page variant")}return this};wt.prototype._adjustHeight=function(){if(this._oChart){var t=0,e=0;var i=this.getDomRef()?this.getDomRef().offsetHeight:0;if(i===0){return}if(this._oToolbar&&this._oToolbar.getDomRef()){t=this._oToolbar.getDomRef().offsetHeight}if(this._oDrillBreadcrumbs&&this._oDrillBreadcrumbs.getDomRef()){var a=this._oDrillBreadcrumbs.getDomRef().parentNode?this._oDrillBreadcrumbs.getDomRef().parentNode:this._oDrillBreadcrumbs.getDomRef();e=a.offsetHeight}var r=i-t-e;this._oChart.setHeight(r+"px");this._updateDrillBreadcrumbs();if(this._hasOverlay){setTimeout(function(){this._showOverlay(true)}.bind(this),0)}}};wt.prototype._toggleFullScreen=function(t,e){if(!this.oFullScreenButton||t===this.bFullScreen&&!e){return}if(t==true&&this._oChart){this._sChartHeight=this._oChart.getHeight();this._oChart.setHeight("100%")}this.bFullScreen=t;k.toggleFullScreen(this,this.bFullScreen,this.oFullScreenButton,this._toggleFullScreen,"sapContrastPlus",true);if(!t){this._adjustHeight()}this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:t});if(t==false&&this._oChart){this._oChart.setHeight(this._sChartHeight)}};wt.prototype._renderFullScreenButton=function(){this.oFullScreenButton.setTooltip(this.bFullScreen?this._oRb.getText("CHART_MINIMIZEBTN_TOOLTIP"):this._oRb.getText("CHART_MAXIMIZEBTN_TOOLTIP"));this.oFullScreenButton.setText(this.bFullScreen?this._oRb.getText("CHART_MINIMIZEBTN_TEXT"):this._oRb.getText("CHART_MAXIMIZEBTN_TEXT"));this.oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};wt.prototype._enrichFromDataPoints=function(t){var e=t.length;var i=[];var a={};for(var r=0;r<e;r++){this._interpretDataPoint(t[r].dataPoint,t[r].measure,a,i)}if(i.length>0){this._oChart.setActiveColoring({coloring:ft.Criticality,parameters:{measure:i}});this._oChart.setColorings({Criticality:{MeasureValues:a}})}};wt.prototype._interpretDataPoint=function(t,e,i,a){this._setSemanticPatterns(t,e);if(e.setBoundaryValues){this._setBoundaryValues(t,e)}if(t.Criticality||t.CriticalityCalculation){i[t.Value.Path]=this._oChartProvider.provideSemanticColoring(t);a.push(t.Value.Path)}};wt.prototype._setSemanticPatterns=function(t,e){var i=t.TargetValue?t.TargetValue.Path:null;var a=t.ForecastValue?t.ForecastValue.Path:null;e.setSemantics(vt.Actual);if(i!=null){var r=this._oChart.getMeasureByName(i);if(r){r.setSemantics(vt.Reference)}else{U.error("sap.ui.comp.SmartChart: "+t.TargetValue.Path+" is not a valid measure")}}if(a){var o=this._oChart.getMeasureByName(a);if(o){o.setSemantics(vt.Projected)}else{U.error("sap.ui.comp.SmartChart: "+t.ForecastValue.Path+" is not a valid measure")}}e.setSemanticallyRelatedMeasures({referenceValueMeasure:i,projectedValueMeasure:a})};wt.prototype._setBoundaryValues=function(t,e){var i={};if(t.MinimumValue){i.minimum=t.MinimumValue}if(t.MaximumValue){i.maximum=t.MaximumValue}if(i.minimum||i.maximum){e.setBoundaryValues(i)}};wt.prototype.isInitialised=function(){return!!this.bIsInitialised};wt.prototype.exit=function(){this._oRb=null;if(this._oChartTypePopover){this._oChartTypePopover.destroy();this._oChartTypePopover=null}if(this._oDrilldownPopover){this._oDrilldownPopover.destroy();this._oDrilldownPopover=null}if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindChart,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this)}if(this._oChartProvider&&this._oChartProvider.destroy){this._oChartProvider.destroy()}this._oChartProvider=null;if(this._oPersController&&this._oPersController.destroy){this._oPersController.destroy()}if(this._oSegmentedButton){this._oSegmentedButton.removeAllButtons();this._oButtonChart1.destroy();this._oButtonChart2.destroy();this._oButtonChart3.destroy();this._oButtonChart4.destroy();this._oButtonChart5.destroy();this._oButtonChart1=null;this._oButtonChart2=null;this._oButtonChart3=null;this._oButtonChart4=null;this._oButtonChart5=null}this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy()}}this._oVariantManagement=null;this._destroyPopover();k.cleanUpFullScreen(this);if(this._oDetailsPopover){this._oDetailsPopover.destroy();if(this._oRelatedAppsMasterList){this._oRelatedAppsMasterList.destroy()}}if(this._oChart){this._oChart.detachRenderComplete(this._toggleZoomButtonEnablement,this)}this._oCurrentVariant=null;this._oChartViewMetadata=null;this._aAlwaysSelect=null;this._aInitialSorters=null;this._oSmartFilter=null;this._oToolbar=null;this._oChartPersonalisationButton=null;this._oView=null;this._oChart=null;this._bDisableTimeseriesUTC=null;this._bWorkaroundVizFormatter=null;p.prototype.exit.apply(this,arguments)};wt.prototype._processResizeHandler=function(t){if(t){this.sResizeListenerId=null;if(T.system.desktop){this.sResizeListenerId=H.register(this,this._adjustHeight.bind(this))}else{T.orientation.attachHandler(this._adjustHeight,this);T.resize.attachHandler(this._adjustHeight,this)}}else if(T.system.desktop&&this.sResizeListenerId){H.deregister(this.sResizeListenerId);this.sResizeListenerId=null}else{T.orientation.detachHandler(this._adjustHeight,this);T.resize.detachHandler(this._adjustHeight,this)}};wt.prototype.setShowToolbar=function(t){if(this._oToolbar){this._oToolbar.setVisible(t)}return this.setProperty("showToolbar",t,true)};wt.prototype.setToolbarStyle=function(t){if(this._oToolbar){this._oToolbar.setStyle(t)}return this.setProperty("toolbarStyle",t,true)};wt.prototype.setShowDimensionsTitle=function(t){if(this._oChart){this._oChart.setVizProperties({categoryAxis:{title:{visible:t}}})}return this.setProperty("showDimensionsTitle",t,true)};wt.prototype.setShowMeasuresTitle=function(t){if(this._oChart){this._oChart.setVizProperties({valueAxis:{title:{visible:t}}})}return this.setProperty("showMeasuresTitle",t,true)};wt.prototype._checkDimensionColoring=function(){var t=this._getVisibleDimensions(),e,i={Criticality:{DimensionValues:{}}},a;for(var r=0;r<t.length;r++){e=this._getField(t[r]);a=this._oChartProvider.calculateDimensionColoring(e);if(a){if(this._sColoringDimension!=e.name){i.Criticality.DimensionValues[e.name]=a;this._oChart.setActiveColoring({coloring:ft.Criticality,parameters:{dimension:e.name}});this._oChart.setColorings(i);this._sColoringDimension=e.name}return}}};wt.prototype.getIdForLabel=function(){if(this._headerText){return this._headerText.getId()}return p.prototype.getIdForLabel.apply(this,[])};return wt});
}
});
//# sourceMappingURL=library-preload.js.map
