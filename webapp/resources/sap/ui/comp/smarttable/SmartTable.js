/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/m/library","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/library","sap/ui/core/Messaging","sap/ui/core/ShortcutHintsMixin","sap/ui/core/format/ListFormat","sap/ui/events/KeyCodes","sap/ui/comp/util/DateTimeUtil","sap/ui/comp/util/FilterUtil","sap/ui/comp/smartfilterbar/FilterProviderUtils","sap/m/Column","sap/m/ColumnListItem","sap/m/Label","sap/m/MessageBox","sap/m/Table","sap/m/Text","sap/m/Title","sap/m/OverflowToolbar","sap/m/OverflowToolbarLayoutData","sap/m/ToolbarSpacer","sap/m/OverflowToolbarButton","sap/m/ToolbarSeparator","sap/m/VBox","sap/m/FlexItemData","sap/ui/comp/library","sap/ui/comp/providers/TableProvider","sap/ui/comp/smartvariants/SmartVariantManagement","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/json/JSONModel","sap/ui/table/AnalyticalColumn","sap/ui/table/AnalyticalTable","sap/ui/table/Column","sap/ui/table/Table","sap/ui/table/TreeTable","sap/ui/comp/personalization/Controller","sap/ui/comp/personalization/Util","sap/ui/comp/util/DateRangeTypeUtils","sap/ui/comp/util/FormatUtil","sap/ui/comp/util/FullScreenUtil","sap/ui/comp/util/TableUtil","sap/ui/comp/odata/ODataModelUtil","sap/ui/comp/odata/ODataType","sap/ui/comp/state/UIState","sap/ui/comp/smartvariants/PersonalizableInfo","sap/ui/core/format/NumberFormat","sap/ui/Device","sap/base/Log","sap/base/util/deepEqual","sap/base/util/merge","sap/m/Menu","sap/m/OverflowToolbarMenuButton","sap/m/MenuItem","sap/m/Button","sap/m/Link","sap/m/MessageStrip","sap/ui/util/openWindow","sap/ui/core/theming/Parameters","sap/m/plugins/ColumnResizer","sap/m/table/Util","sap/m/SegmentedButton","sap/m/SegmentedButtonItem","sap/m/table/columnmenu/Menu","sap/m/table/columnmenu/QuickAction","sap/m/table/columnmenu/QuickSort","sap/m/table/columnmenu/QuickSortItem","sap/m/table/columnmenu/QuickGroup","sap/m/table/columnmenu/QuickGroupItem","./flexibility/Utils","sap/base/util/isEmptyObject","sap/ui/performance/trace/FESRHelper","sap/ui/base/DesignTime","sap/m/plugins/CellSelector","sap/m/plugins/CopyProvider","sap/ui/core/date/UI5Date"],function(t,e,i,o,a,n,s,r,l,u,h,p,d,f,g,c,_,m,b,y,T,C,S,v,P,I,E,M,D,x,F,B,A,w,V,R,O,L,U,N,W,H,k,K,z,G,Q,j,q,$,X,Y,J,Z,tt,et,it,ot,at,nt,st,rt,lt,ut,ht,pt,dt,ft,gt,ct,_t,mt,bt,yt,Tt,Ct,St){"use strict";const vt=t.ButtonType;const Pt=t.MenuButtonMode;const It=t.ToolbarDesign;const Et=t.ToolbarStyle;const Mt=t.IllustratedMessageType;const Dt=o.SortOrder;const xt=o.TitleLevel;const Ft=I.smarttable.InfoToolbarBehavior;const Bt=I.smarttable.TableType;var At=v.extend("sap.ui.comp.smarttable.SmartTable",{metadata:{library:"sap.ui.comp",designtime:"sap/ui/comp/designtime/smarttable/SmartTable.designtime",properties:{entitySet:{type:"string",group:"Misc",defaultValue:null},smartFilterId:{type:"string",group:"Misc",defaultValue:null},ignoredFields:{type:"string",group:"Misc",defaultValue:null},initiallyVisibleFields:{type:"string",group:"Misc",defaultValue:null},requestAtLeastFields:{type:"string",group:"Misc",defaultValue:null},ignoreFromPersonalisation:{type:"string",group:"Misc",defaultValue:null},tableType:{type:"sap.ui.comp.smarttable.TableType",group:"Misc",defaultValue:null},useVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useColumnLabelsAsTooltips:{type:"boolean",group:"Misc",defaultValue:true},showVariantManagement:{type:"boolean",group:"Misc",defaultValue:true},useExportToExcel:{type:"boolean",group:"Misc",defaultValue:true},enableExport:{type:"boolean",group:"Misc",defaultValue:true},exportType:{type:"sap.ui.comp.smarttable.ExportType",group:"Misc",defaultValue:"UI5ClientPDF"},enableCopy:{type:"boolean",group:"Misc",defaultValue:true},useTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},showTablePersonalisation:{type:"boolean",group:"Misc",defaultValue:true},customizeConfig:{type:"object",group:"Misc",defaultValue:null},showRowCount:{type:"boolean",group:"Misc",defaultValue:true},header:{type:"string",group:"Misc",defaultValue:null},headerLevel:{type:"sap.ui.core.TitleLevel",group:"Appearance",defaultValue:xt.Auto},headerStyle:{type:"sap.ui.core.TitleLevel",group:"Appearance"},toolbarStyleClass:{type:"string",group:"Misc",defaultValue:null},enableCustomFilter:{type:"boolean",group:"Misc",defaultValue:true},persistencyKey:{type:"string",group:"Misc",defaultValue:null},useOnlyOneSolidToolbar:{type:"boolean",group:"Misc",defaultValue:false},placeToolbarInTable:{type:"boolean",group:"Misc",defaultValue:false},currentVariantId:{type:"string",group:"Misc",defaultValue:null},editable:{type:"boolean",group:"Misc",defaultValue:false},enableAutoBinding:{type:"boolean",group:"Misc",defaultValue:false},tableBindingPath:{type:"string",group:"Misc",defaultValue:null},editTogglable:{type:"boolean",group:"Misc",defaultValue:false},demandPopin:{type:"boolean",group:"Misc",defaultValue:false},showFullScreenButton:{type:"boolean",group:"Misc",defaultValue:false},initialNoDataText:{type:"string",group:"Misc",defaultValue:null},useInfoToolbar:{type:"sap.ui.comp.smarttable.InfoToolbarBehavior",group:"Behavior",defaultValue:Ft.Auto},showDetailsButton:{type:"boolean",group:"Misc",defaultValue:false},detailsButtonSetting:{type:"sap.ui.core.Priority[]",group:"Behavior"},enableAutoColumnWidth:{type:"boolean",group:"Misc",defaultValue:false},showPasteButton:{type:"boolean",group:"Behavior",defaultValue:false},enablePaste:{type:"boolean",group:"Behavior",defaultValue:true},useDateRangeType:{type:"boolean",group:"Misc",defaultValue:false},showDetails:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"}},associations:{smartVariant:{type:"sap.ui.core.Control",multiple:false}},aggregations:{customToolbar:{type:"sap.m.Toolbar",multiple:false},semanticObjectController:{type:"sap.ui.comp.navpopover.SemanticObjectController",multiple:false},noData:{type:"sap.ui.core.Control",altTypes:["string"],multiple:false},semanticKeyAdditionalControl:{type:"sap.ui.core.Control",multiple:false},dataStateIndicator:{type:"sap.m.plugins.DataStateIndicator",multiple:false},copyProvider:{type:"sap.m.plugins.CopyProvider",multiple:false},filterControlConfiguration:{type:"sap.ui.comp.config.FilterControlConfiguration",multiple:true}},events:{initialise:{},beforeRebindTable:{},editToggled:{},dataRequested:{},dataReceived:{},afterVariantInitialise:{},afterVariantSave:{parameters:{currentVariantId:{type:"string"}}},afterVariantApply:{parameters:{currentVariantId:{type:"string"},variantContext:{type:"string"}}},showOverlay:{},fieldChange:{},fullScreenToggled:{parameters:{fullScreen:{type:"boolean"}}},beforeExport:{allowPreventDefault:true,parameters:{exportSettings:{type:"object"},userExportSettings:{type:"object"},filterSettings:{type:"object[]"}}},beforePaste:{allowPreventDefault:true,parameters:{columnInfos:{type:"sap.ui.comp.smarttable.ColumnInfoForPaste[]"},rawData:{type:"string[][]"}}},paste:{parameters:{result:{type:"object"}}},uiStateChange:{},changeModelValue:{}}},renderer:{apiVersion:2},constructor:function(){this._oTableReady=function(){var t={};t.promise=new Promise(function(e){t.resolve=e});return t}();v.apply(this,arguments);this._aExistingColumns=[];this._aAlwaysSelect=[];this._oTemplate=null;this._mFieldMetadataByKey={};this._createToolbar();this._updateP13nDialogSettings();this._createTable();this.attachModelContextChange(this._initialiseMetadata,this)}});At.prototype._getP13nDialogSettings=function(){var t=this.data("p13nDialogSettings");if(typeof this._oP13nDialogSettings==="string"){try{t=JSON.parse(this._oP13nDialogSettings)}catch(e){t=null;$.error("Assigned p13nDialogSettings is not a valid JSON object")}}return t};["DataStateIndicator","CopyProvider","CellSelector"].forEach(t=>{At.prototype[`get${t}PluginOwner`]=function(){return this._oTable||this._oTableReady?.promise}});At.prototype.setDataStateIndicator=function(t){this._handeDataStateEvents(this.getDataStateIndicator(),"detach");this.setAggregation("dataStateIndicator",t,true);this._handeDataStateEvents(this.getDataStateIndicator(),"attach");return this};At.prototype.setCopyProvider=function(t){this.setAggregation("copyProvider",t,true);if(window.isSecureContext&&t&&this._bToolbarInsertedIntoItems){this._createToolbarContent()}this._updateCopy();return this};At.prototype.insertDependent=function(t,e){if(this._oCellSelector&&this.indexOfDependent(this._oCellSelector)>=0){this.removeAggregation("dependents",this._oCellSelector)}v.prototype.insertAggregation.apply(this,arguments);this._updateCopy();return this};At.prototype.addDependent=function(t){if(this._oCellSelector&&this.indexOfDependent(this._oCellSelector)>=0){this.removeAggregation("dependents",this._oCellSelector)}v.prototype.addDependent.apply(this,arguments);this._updateCopy();return this};At.prototype.removeDependent=function(t){var e=v.prototype.removeDependent.apply(this,arguments);this._updateCopy();return e};At.prototype.removeAllDependents=function(){var t=v.prototype.removeAllDependents.apply(this,arguments);this._updateCopy();return t};At.prototype.destroyDependents=function(){v.prototype.destroyDependents.apply(this,arguments);this._updateCopy();return this};At.prototype.setEnableCopy=function(t){this.setProperty("enableCopy",t,true);this._updateCopy();return this};At.prototype._updateCopy=function(){if(this.isDestroyed()||this.isDestroyStarted()){return}const t=this.getCopyProvider();const e=Tt.findOn(this);const i=this.getEnableCopy();if(i&&!t&&!e){if(!this._oCopyProvider||this._oCopyProvider.isDestroyed()){this._oCopyProvider=new Ct(this.getId()+"-cp")}if(!this._oCellSelector||this._oCellSelector.isDestroyed()){this._oCellSelector=new Tt(this.getId()+"-cs")}this.setCopyProvider(this._oCopyProvider);this.addDependent(this._oCellSelector)}else if(!i||t&&t!==this._oCopyProvider||e&&e!==this._oCellSelector){if(this._oCopyProvider&&t===this._oCopyProvider){this.setCopyProvider(null)}if(this._oCellSelector&&e===this._oCellSelector){this.removeDependent(this._oCellSelector)}}};At.prototype.getColumnClipboardSettings=function(t){var e=t.data("p13nData");var i=this._getColumnLeadingProperty(t,e);if(!e||!i){return null}var o,a;var n=[i];var s="{0}";if(e.unit){s="{0} {1}";n.push(e.unit);a=W[e.isCurrency?"getAmountCurrencyFormatter":"getMeasureUnitFormatter"](this._bPreserveDecimals)}else{o=e.typeInstance||(this._oTableProvider.getFieldMetadata(i)||{}).modelType;if(e.description&&e.displayBehaviour!=="idOnly"){if(e.displayBehaviour==="descriptionOnly"){n=[e.description]}else{s=W.getFormattedExpressionFromDisplayBehaviour(e.displayBehaviour,"{0}","{1}");n.push(e.description)}}}return{types:[o],properties:n,unitFormatter:a,template:s}};At.prototype.setCustomizeConfig=function(t){this.setProperty("customizeConfig",t,true);return this};At.prototype.setUseExportToExcel=function(t){var e=this.getUseExportToExcel();this.setProperty("useExportToExcel",t,true);if(e!==this.getUseExportToExcel()){this.setEnableExport(t)}return this};(()=>{At.prototype.setEnableExport=function(t){var e=this.getEnableExport();this.setProperty("enableExport",t,true);if(e!==this.getEnableExport()){this.setUseExportToExcel(t)}return this}})();At.prototype._validateCustomizeConfig=function(t){if(!t){return}if(t.isA){$.error("Invalid config property. Provided configuration has been deleted from the customizeConfig property - "+this.getId());this.setCustomizeConfig(null);return}for(var e in t){switch(e){case"textInEditModeSource":this._validateTextInEditModeSource(t);break;case"ignoreInsertRestrictions":this._validateIgnoreInsertRestrictions(t);break;case"autoColumnWidth":this._validateAutoColumnWidth(t);break;case"clientSideMandatoryCheck":this._validateClientSideMandatoryCheck(t);break;default:$.error(e+" is not a supported configuration for the customizeConfig property - "+this.getId());delete t[e];break}}};At.prototype._validateTextInEditModeSource=function(t){if(this._validateCustomizeConfigObjectType(t["textInEditModeSource"])){delete t.textInEditModeSource;$.error("Invalid config property textInEditModeSource. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["textInEditModeSource"],Object.keys(I.smartfield.TextInEditModeSource),"textInEditModeSource")};At.prototype._validateCustomizeConfigObjectType=function(t){if(typeof t!=="object"||!Object.keys(t).length||t.isA){return true}return false};At.prototype._checkAllowedValuesForCustomizeConfig=function(t,e,i){for(var o in t){if(!e.includes(t[o])){$.error(`Invalid config property '${o}' for the ${i} property of the customizeConfig - ${this.getId()}`);delete t[o]}}};At.prototype._validateIgnoreInsertRestrictions=function(t){if(this._validateCustomizeConfigObjectType(t["ignoreInsertRestrictions"])){delete t.ignoreInsertRestrictions;$.error("Invalid config property ignoreInsertRestrictions. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["ignoreInsertRestrictions"],[true,false],"ignoreInsertRestrictions")};At.prototype._validateClientSideMandatoryCheck=function(t){if(this._validateCustomizeConfigObjectType(t["clientSideMandatoryCheck"])){delete t.clientSideMandatoryCheck;$.error("Invalid config property clientSideMandatoryCheck. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}this._checkAllowedValuesForCustomizeConfig(t["clientSideMandatoryCheck"],[true,false],"clientSideMandatoryCheck")};At.prototype._validateAutoColumnWidth=function(t){if(!this.getEnableAutoColumnWidth()&&t.hasOwnProperty("autoColumnWidth")){delete t.autoColumnWidth;$.error("The autoColumnWidth property is deleted from the customizeConfig, since enableAutoColumnWidth=false on the SmartTable - "+this.getId())}if(this._validateCustomizeConfigObjectType(t["autoColumnWidth"])){delete t.autoColumnWidth;$.error("Invalid config property autoColumnWidth. Provided configuration has been deleted from the customizeConfig property - "+this.getId());return}if(typeof t["autoColumnWidth"]==="boolean"||typeof t["autoColumnWidth"]==="object"){var e=t["autoColumnWidth"];for(var i in e){if(typeof e[i]==="boolean"){continue}if(typeof e[i]!=="object"){$.error(`Expected 'object' or 'boolean', instead ${typeof e[i]} was passed for '${i}' autoColumnWidth customizeConfig property - ${this.getId()}`);delete e[i];continue}var o=e[i];for(var a in o){var n=null;switch(a){case"truncateLabel":n=typeof o[a];if(n!=="boolean"){$.error("The "+a+" property must be of type boolean, instead "+n+" was passed - "+this.getId());delete o[a]}break;case"min":case"max":case"gap":n=typeof o[a];if(n!=="number"){$.error("The "+a+" property must be of type number, instead "+n+" was passed - "+this.getId());delete o[a]}break;default:$.error(`Invalid config property '${a}' for the autoColumnWidth property of the customizeConfig - ${this.getId()}`);delete o[a]}}}}};At.prototype._handeDataStateEvents=function(t,e){if(t){t[e+"ApplyFilter"](this._onApplyMessageFilter,this);t[e+"ClearFilter"](this._onClearMessageFilter,this);t[e+"Event"]("filterInfoPress",this._handleInfoToolbarPress,this)}};At.prototype.setHeaderLevel=function(t){if(this.getHeaderLevel()===t){return this}this.setProperty("headerLevel",t,true);this._headerText?.setLevel(t);this._updateVariantManagement();return this};At.prototype.setHeaderStyle=function(t){if(this.getHeaderStyle()===t){return this}this.setProperty("headerStyle",t,true);this._headerText?.setTitleStyle(t||xt[nt.get({name:"_sap_ui_comp_SmartTable_HeaderStyle"})]);this._updateVariantManagement();return this};At.prototype._getP13nFilterMessageStrip=function(){var e,o;if(this._oMessageFilter){o=i.getResourceBundleFor("sap.ui.comp");e=new ot({text:o.getText("SMARTTABLE_P13N_FILTER_MESSAGESTRIP"),link:new it({text:o.getText("SMARTTABLE_MESSAGESTRIP_CLEAR_FILTER"),reactiveAreaMode:t.ReactiveAreaMode.Overlay,press:[function(){this._fnClearMessageFilter();e.setVisible(false)},this]})})}return e};At.prototype._onApplyMessageFilter=function(t){this._fnClearMessageFilter=t.getParameter("revert");this._oMessageFilter=t.getParameter("filter");t.preventDefault();this._reBindTable()};At.prototype._onClearMessageFilter=function(t){this._oMessageFilter=null;t.preventDefault();this._reBindTable()};At.prototype.init=function(){v.prototype.init.call(this);this.addStyleClass("sapUiCompSmartTable");this.setFitContainer(true);this._aColumnKeys=[];this._aDeactivatedColumns=[];this._mLazyColumnMap={};this._mMenuShowEntryMap=new window.WeakMap};At.prototype._getVariantManagementControl=function(t){var i=null;if(t){if(typeof t==="string"){i=e.getElementById(t)}else{i=t}if(i){if(!(i instanceof M)){$.error("Control with the id="+t.getId?t.getId():t+" not of expected type");return null}}}return i};At.prototype._createVariantManagementControl=function(){if(this._oVariantManagement||!this.getUseVariantManagement()&&!this.getUseTablePersonalisation()||!this.getPersistencyKey()){return}var t=new Q({type:"table",keyName:"persistencyKey",dataSource:"TODO"});t.setControl(this);var e=this.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}else if(this._oSmartFilter&&this._oSmartFilter.data("pageVariantPersistencyKey")){e=this._oSmartFilter.getSmartVariant();if(e){this._oVariantManagement=this._getVariantManagementControl(e)}}else{this._oVariantManagement=new M(this.getId()+"-variant",{showShare:true})}if(this._oVariantManagement){this._oVariantManagement.addPersonalizableControl(t);this._oVariantManagement.attachSave(this._variantSaved,this);this._oVariantManagement.attachAfterSave(this._variantAfterSave,this);this._oVariantManagement.initialise(this._variantInitialised,this);this._updateVariantManagement()}};At.prototype._variantInitialised=function(){if(!this._oCurrentVariant){this._oCurrentVariant="STANDARD"}this.fireAfterVariantInitialise();if(this._oVariantManagement&&!this._oVariantManagement.getEnabled()){this._checkAndTriggerBinding()}};At.prototype._variantSaved=function(){if(this._oPersController){this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}};At.prototype._variantAfterSave=function(){this.fireAfterVariantSave({currentVariantId:this.getCurrentVariantId()})};At.prototype.setTableBindingPath=function(t){this.setProperty("tableBindingPath",t,true);return this};At.prototype.setTableType=function(t){if(this.getTableType()===t){return this}if(this._bInitialising){throw new Error("tableType changed while SmartTable control was initializing - "+this.getId())}if(this.getTable()){$.error("The inner table is already created. Changing the table type is not supported.");return this}this.setProperty("tableType",t);return this};At.prototype.setShowTablePersonalisation=function(t){this.setProperty("showTablePersonalisation",t,true);if(this._oTablePersonalisationButton){this._oTablePersonalisationButton.setVisible(t)}return this};At.prototype.setUseVariantManagement=function(t){this.setProperty("useVariantManagement",t,true);if(this._oPersController){this._oPersController.setResetToInitialTableState(!t)}return this};At.prototype.setShowVariantManagement=function(t){this.setProperty("showVariantManagement",t,true);if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(t);if(this._oSeparator){this._oSeparator.setVisible(t)}}return this};At.prototype.setToolbarStyleClass=function(t){this.setProperty("toolbarStyleClass",t,true);return this};At.prototype.setCustomToolbar=function(t){this._oCustomToolbar=t;return this};At.prototype.getCustomToolbar=function(){return this._oCustomToolbar};At.prototype.setHeader=function(t){var e=this.getProperty("header"),i;this.setProperty("header",t,true);if(this.bIsInitialised&&this._oToolbar){i=!e===!t;if(!i){this._createToolbarContent()}else{this._refreshHeaderText()}}this._updateVariantManagement();return this};At.prototype.setShowRowCount=function(t){this.setProperty("showRowCount",t,true);this._refreshHeaderText();return this};At.prototype.setEditable=function(t){if((t=!!t)==this.getEditable()){return this}this.setProperty("editable",t,true);if(this._oEditModel){this._oEditModel.setProperty("/editable",t)}if(this._oEditButton){this._oEditButton.setIcon(t?"sap-icon://display":"sap-icon://edit")}if(this._isOfType(Bt.ResponsiveTable)&&this._oTable?.setKeyboardMode){this._oTable.setKeyboardMode(t?"Edit":"Navigation")}this._updateVisibleColumnsWidthForEdit();return this};At.prototype.setDemandPopin=function(t){var e=this.getDemandPopin();if(e===t){return this}this.setProperty("demandPopin",t,true);if(this.bIsInitialised){if(t){this._updateColumnsPopinFeature()}else{this._deactivateColumnsPopinFeature()}}return this};At.prototype._refreshHeaderText=function(){if(!this._headerText){return}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=j.getFloatInstance()}var t;var e=this.getHeader();this._headerText.setVisible(!!e);if(this.getShowRowCount()){var i=this._getRowBinding();t=i?i.getCount():0;if(t>0){var o=this._oNumberFormatInstance.format(t);e+=" ("+o+")"}}this._headerText.setText(e);this._updateAriaLabelledByInfo();if(this._bDataLoadPending===false&&this._bUpdateTableAnnouncement){this._bUpdateTableAnnouncement=false;rt.announceTableUpdate(this.getHeader(),t)}};At.prototype._updateAriaLabelledByInfo=function(){var t=this._headerText.getId();if(this._oTable&&this._oTable.addAriaLabelledBy){if(this._headerText.getVisible()){if(this._oTable.getAriaLabelledBy().indexOf(t)===-1){this._oTable.addAriaLabelledBy(t)}}else{this._oTable.removeAriaLabelledBy(t)}}};At.prototype._addFullScreenButton=function(){if(this._oFullScreenButton){this._oToolbar.removeContent(this._oFullScreenButton)}if(this.getShowFullScreenButton()){if(!this._oFullScreenButton){this._oFullScreenButton=new C(this.getId()+"-btnFullScreen",{press:[function(){this._toggleFullScreen(!this.bFullScreen)},this]});this._oFullScreenButton.addStyleClass("sapUiCompSmartTableToolbarContent");if(q.system.phone){this._oFullScreenButton.setLayoutData(new y({priority:"NeverOverflow"}))}}this._renderFullScreenButton();this._oToolbar.addContent(this._oFullScreenButton)}};At.prototype._addCopyButton=function(){var t=this.getId()+"-btnCopy";var i=e.getElementById(t);if(i){this._oToolbar.removeContent(i)}var o=this.getCopyProvider();if(o&&window.isSecureContext){if(!i){i=o.getCopyButton({id:t});i.addStyleClass("sapUiCompSmartTableToolbarContent")}this._oToolbar.addContent(i)}};At.prototype._addPasteButton=function(){var t=this.getId()+"-btnPaste";var i=e.getElementById(t);if(i){this._oToolbar.removeContent(i)}if(this.getShowPasteButton()){if(!i){i=new C(t);bt.setSemanticStepname(i,"press","sc:tbl:paste");i.addStyleClass("sapUiCompSmartTableToolbarContent");sap.ui.require(["sap/m/plugins/PasteProvider"],function(t){i.addDependent(new t({pasteFor:this._oTable.getId()}))}.bind(this))}i.setEnabled(this.getEnablePaste());this._oToolbar.addContent(i)}};At.prototype._createToolbar=function(){var t=null;if(!this._oToolbar){t=this.getCustomToolbar();if(t){this._oToolbar=t}else{this._oToolbar=new b({design:It[nt.get({name:"_sap_ui_comp_SmartTable_ToolbarDesign"})],style:this._isOfType(Bt.ResponsiveTable)?Et.Standard:Et.Clear});this._oToolbar.addStyleClass("sapUiCompSmartTableToolbar");if(this.getToolbarStyleClass()){this._oToolbar.addStyleClass(this.getToolbarStyleClass())}}this._oToolbar.setLayoutData(new P({shrinkFactor:0}))}};At.prototype.setShowDetails=function(t){if(!this._isOfType(Bt.ResponsiveTable)||t===this.getProperty("showDetails")){return}if(this.getUseTablePersonalisation()){this._oPersController._setShowDetails(t)}else{this._setShowDetails(t)}};At.prototype._setShowDetails=function(t){this.setProperty("showDetails",t,true);if(this.getProperty("showDetails")){this._oTable.setHiddenInPopin([]);this._oShowHideDetailsButton?.setSelectedKey("showDetails")}else{this._oTable.setHiddenInPopin(this._getImportanceToHide());this._oShowHideDetailsButton?.setSelectedKey("hideDetails")}};At.prototype._getImportanceToHide=function(){var t=this.getDetailsButtonSetting()||[];var e=[];if(t.length){e=t}else{e=q.system.phone?["Low","Medium"]:["Low"]}return e};At.prototype._toggleFullScreen=function(t,e){if(!this._oFullScreenButton||t===this.bFullScreen&&!e){return}this.bFullScreen=t;H.toggleFullScreen(this,this.bFullScreen,this._oFullScreenButton,this._toggleFullScreen);this._renderFullScreenButton();this.fireFullScreenToggled({fullScreen:t})};At.prototype._renderFullScreenButton=function(){var t=i.getResourceBundleFor("sap.ui.comp"),e;e=this.bFullScreen?t.getText("CHART_MINIMIZEBTN_TOOLTIP"):t.getText("CHART_MAXIMIZEBTN_TOOLTIP");this._oFullScreenButton.setTooltip(e);this._oFullScreenButton.setText(e);this._oFullScreenButton.setIcon(this.bFullScreen?"sap-icon://exit-full-screen":"sap-icon://full-screen")};At.prototype._createToolbarContent=function(){if(!this._oToolbar){this._createToolbar()}this._addVariantManagementToToolbar();this._addSeparatorToToolbar();this._addHeaderToToolbar();this._addSpacerToToolbar();this._addCopyButton();this._addPasteButton();this._addEditTogglableToToolbar();this._addShowHideDetailsButton();this._addTablePersonalisationToToolbar();this._addExportToExcelToToolbar();this._addFullScreenButton();this._bToolbarInsertedIntoItems=true;this._placeToolbar()};At.prototype._applyToolbarContentOrder=function(){if(!this.bIsInitialised||!this.getCustomToolbar()){return}var t=this.data("p13nData_ToolbarContentMove");if(!t){return}t=_t.parseChangeContent(t,function(t){this.data("p13nData_ToolbarContentMove",t)}.bind(this));if(!t||!t.order){return}var e=_t.getAppComponentForControl(this)||null;var i=-1;var o=t.order;var a=[];var n=this._oToolbar.getContent();for(let t=0;t<o.length;t++){for(let s=0;s<n.length;s++){if(o[t].id===_t.getSelectorForControl(n[s],e)?.id){if(i<0||i>s){i=s}a.push(n[s])}}}for(let t=0;t<a.length;t++){this._oToolbar.removeContent(a[t]);this._oToolbar.insertContent(a[t],i);i++}};At.prototype._placeToolbar=function(){if(!this.getPlaceToolbarInTable()){this.insertItem(this._oToolbar,0)}else if(this._isOfType(Bt.ResponsiveTable)){this._oTable.setHeaderToolbar(this._oToolbar)}else{this._oTable.addExtension(this._oToolbar)}};At.prototype.getToolbar=function(){return this._oToolbar};At.prototype._addEditTogglableToToolbar=function(){var t;if(this._oEditButton){this._oToolbar.removeContent(this._oEditButton)}if(this.getEditTogglable()){if(!this._oEditButton){t=i.getResourceBundleFor("sap.ui.comp").getText("TABLE_EDITTOGGLE_TOOLTIP");this._oEditButton=new C(this.getId()+"-btnEditToggle",{icon:this.getEditable()?"sap-icon://display":"sap-icon://edit",text:t,tooltip:t,press:[function(){var t=this.getEditable();t=!t;this.setEditable(t,true);this.fireEditToggled({editable:t})},this]});this._oEditButton.addStyleClass("sapUiCompSmartTableToolbarContent");bt.setSemanticStepname(this._oEditButton,"press","sc:tbl:edit")}this._oToolbar.addContent(this._oEditButton)}};At.prototype._addHeaderToToolbar=function(){if(this._headerText){this._oToolbar.removeContent(this._headerText)}if(!this._headerText){this._headerText=new m(this.getId()+"-header");this._headerText.addStyleClass("sapUiCompSmartTableHeader");this._headerText.addStyleClass("sapUiCompSmartTableToolbarContent");this._headerText.setLevel(this.getHeaderLevel());this._headerText.setTitleStyle(this.getHeaderStyle()||xt[nt.get({name:"_sap_ui_comp_SmartTable_HeaderStyle"})])}this._refreshHeaderText();this._oToolbar.insertContent(this._headerText,0)};At.prototype._addSeparatorToToolbar=function(){if(this._oSeparator){this._oToolbar.removeContent(this._oSeparator)}if(this.getHeader()&&this.getUseVariantManagement()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){if(!this._oSeparator){this._oSeparator=new S(this.getId()+"-toolbarSeperator");if(!this.getShowVariantManagement()){this._oSeparator.setVisible(false)}this._oSeparator.addStyleClass("sapUiCompSmartTableToolbarContent")}this._oToolbar.insertContent(this._oSeparator,0)}if(this._oToolbar){this._oToolbar.addStyleClass("sapMTBHeader-CTX")}};At.prototype._addVariantManagementToToolbar=function(){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oToolbar.removeContent(this._oVariantManagement);if(this.getUseVariantManagement()){this._oToolbar.insertContent(this._oVariantManagement,0);this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContent");this._oVariantManagement.addStyleClass("sapUiCompSmartTableToolbarContentAllowAdaption");if(!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setVisible(this.getShowVariantManagement())}}}};At.prototype._addSpacerToToolbar=function(){var t=false,e=this._oToolbar.getContent(),i,o;if(e){o=e.length;i=0;for(i;i<o;i++){if(e[i]instanceof T){t=true;break}}}if(!t){this._oToolbar.addContent(new T(this.getId()+"-toolbarSpacer").addStyleClass("sapUiCompSmartTableToolbarContent"))}};At.prototype._createShowHideDetailsButton=function(){var t=i.getResourceBundleFor("sap.ui.comp");this._oShowHideDetailsButton=new lt(this.getId()+"-btnShowHideDetails",{visible:false,items:[new ut({icon:"sap-icon://detail-more",key:"showDetails",tooltip:t.getText("TABLE_SHOWDETAILS_TEXT"),press:[function(){this.setShowDetails(true)},this]}),new ut({icon:"sap-icon://detail-less",key:"hideDetails",tooltip:t.getText("TABLE_HIDEDETAILS_TEXT"),press:[function(){this.setShowDetails(false)},this]})]});this._oShowHideDetailsButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oShowHideDetailsButton.setSelectedKey("hideDetails")};At.prototype._addShowHideDetailsButton=function(){if(this._oShowHideDetailsButton){this._oToolbar.removeContent(this._oShowHideDetailsButton)}if(this.getShowDetailsButton()&&this._isOfType(Bt.ResponsiveTable)){if(!this._oShowHideDetailsButton){this._createShowHideDetailsButton()}this._oToolbar.addContent(this._oShowHideDetailsButton)}};At.prototype._addTablePersonalisationToToolbar=function(){var t;if(this._oTablePersonalisationButton){this._oToolbar.removeContent(this._oTablePersonalisationButton)}if(this.getUseTablePersonalisation()){if(!this._oTablePersonalisationButton){t=i.getResourceBundleFor("sap.ui.comp").getText("TABLE_PERSOBTN_TOOLTIP");this._oTablePersonalisationButton=new C(this.getId()+"-btnPersonalisation",{icon:"sap-icon://action-settings",text:t,tooltip:t,press:[function(t){if(!this._bPersDialogOpen){this._bPersDialogOpen=true;this._bMissingColumnsCreated=true;this._oPersController.openDialog()}},this]});n.addConfig(this._oTablePersonalisationButton,{messageBundleKey:q.os.macintosh?"SMARTTABLE_SHORTCUT_SHOW_SETTINGS_MAC":"SMARTTABLE_SHORTCUT_SHOW_SETTINGS"},this);this._oTablePersonalisationButton.addStyleClass("sapUiCompSmartTableToolbarContent");this._oTablePersonalisationButton.setVisible(this.getShowTablePersonalisation());bt.setSemanticStepname(this._oTablePersonalisationButton,"press","sc:tbl:p13n")}this._oToolbar.addContent(this._oTablePersonalisationButton)}};At.prototype._triggerGWExport=function(){var t=i.getResourceBundleFor("sap.ui.comp");var e=function(){var t=this._getRowBinding();var e=t.getDownloadUrl("xlsx");e=this._removeExpandParameter(e);var i={url:e};this.fireBeforeExport({exportSettings:i});at(i.url)}.bind(this);var o=this._getRowBinding();var a=o?o.getCount():0;if(a>1e4){g.confirm(t.getText("DOWNLOAD_CONFIRMATION_TEXT",[a]),{actions:[g.Action.YES,g.Action.NO],emphasizedAction:g.Action.YES,onClose:function(t){if(t===g.Action.YES){e()}}})}else{e()}};At.prototype._addExportToExcelToToolbar=function(){if(this._oExportButton){this._oToolbar.removeContent(this._oExportButton)}if(!this.getEnableExport()){return}if(!this._oExportButton){var t=this.getId()+"-btnExcelExport";var e="sap-icon://excel-attachment";var o=i.getResourceBundleFor("sap.ui.comp");if(this.getExportType().indexOf("UI5Client")>-1){this._oExportButton=this._createClientExportButton(t,e)}else if(this._bTableSupportsExcelExport&&this.getExportType()=="GW"){var a;a=o.getText("TABLE_EXPORT_TEXT");this._oExportButton=new C(t,{icon:e,text:a,tooltip:a,press:[this._triggerGWExport,this]});bt.setSemanticStepname(this._oExportButton,"press","OI:QE")}this._setExcelExportEnableState();if(this._oExportButton){this._oExportButton.addStyleClass("sapUiCompSmartTableToolbarContent")}}this._oToolbar.addContent(this._oExportButton)};At.prototype._createClientExportButton=function(t,e){var o=i.getResourceBundleFor("sap.ui.comp");var a={fileName:this.getHeader()};if(!this._cachedExcelSettings){this._cachedExcelSettings=a}var s=new Z(t,{icon:e,tooltip:o.getText("TABLE_EXPORT_TEXT"),type:vt[nt.get({name:"_sap_ui_comp_SmartTable_ExportButton"})],buttonMode:Pt.Split,useDefaultActionOnly:true,text:o.getText("QUICK_EXPORT"),defaultAction:[function(){this._triggerUI5ClientExport()},this],menu:[new J({items:[new tt({text:o.getText("QUICK_EXPORT"),press:[function(){this._triggerUI5ClientExport()},this]}),new tt({text:o.getText("EXPORT_WITH_SETTINGS"),press:[function(){this._triggerUI5ClientExport(true)},this]})]})]});bt.setSemanticStepname(s,"defaultAction","OI:QE");bt.setSemanticStepname(s.getMenu().getItems()[0],"press","OI:QE");bt.setSemanticStepname(s.getMenu().getItems()[1],"press","OI:EXP:SETTINGS");n.addConfig(s._getButtonControl(),{addAccessibilityLabel:true,messageBundleKey:q.os.macintosh?"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL_MAC":"SMARTTABLE_SHORTCUT_EXPORT_TO_EXCEL"},this);return s};At.prototype.onkeydown=function(t){if(t.isMarked()){return}if((t.metaKey||t.ctrlKey)&&t.shiftKey&&t.which===r.E){if(this.getEnableExport()&&this.getExportType().indexOf("UI5Client")>-1&&this._oExportButton&&this._oExportButton.getEnabled()){this._triggerUI5ClientExport(true);t.setMarked();t.preventDefault()}}else if((t.metaKey||t.ctrlKey)&&t.which===r.COMMA){if(this.getUseTablePersonalisation()&&this._oTablePersonalisationButton&&this._oTablePersonalisationButton.getVisible()){this._oPersController.openDialog();t.setMarked();t.preventDefault()}}};At.prototype.onThemeChanged=function(){if(this._oExportButton){const t=vt[nt.get({name:"_sap_ui_comp_SmartTable_ExportButton"})];this._oExportButton.setType(t)}if(this._oToolbar){const t=It[nt.get({name:"_sap_ui_comp_SmartTable_ToolbarDesign"})];this._oToolbar.setDesign(t)}if(this._headerText&&!this.getHeaderStyle()){const t=xt[nt.get({name:"_sap_ui_comp_SmartTable_HeaderStyle"})];this._headerText.setTitleStyle(t);this._updateVariantManagement()}};At.prototype._getColumnLabel=function(t){var e,i;if(typeof t==="string"){e=t;t=this._getColumnByKey(e)}if(!t){var o=this._oTableProvider.getFieldLabel(this.getEntitySet(),e);if(o&&o.match(/{@i18n>.+}/gi)){var a=this.getModel("@i18n");if(a&&a.isA("sap.ui.model.resource.ResourceModel")){return a.getProperty(o.slice(1,-1).substring(6))||o}}if(!o){var n=this._mFieldMetadataByKey[e];if(n){o=n.label}}return o}if(t.getLabel){i=t.getLabel()}else if(t.getHeader){i=t.getHeader()}return i&&i.getText?i.getText():null};At.prototype._getColumnLeadingProperty=function(t,e){var i;if(t.getLeadingProperty){i=t.getLeadingProperty()}if(!i){var o=e||t.data("p13nData");if(o){i=o["leadingProperty"]}}return i};At.prototype.triggerExport=function(){if(!this.getEnableExport()){return Promise.reject("Export is not enabled for this table - "+this.getId())}return this._triggerUI5ClientExport(false,true)};At.prototype._triggerUI5ClientExport=async function(t,e=false){const o=this._createExportColumnConfiguration();if(!o||!o.length){const t=i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_COLS_EXPORT");if(!e){g.error(t,{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""})}return Promise.reject(t)}const a=this._getRowBinding();const n=this._getColumnLabel.bind(this);const s={workbook:{columns:o,context:{title:this.getHeader()}},dataSource:a,fileName:this.getHeader()};const r=t=>{var e=t.getParameter("filterSettings");e.forEach(t=>{var e=t.getProperty();var i=this._getColumnByKey(e)||this._getColumnFromP13nMap(e);t.setLabel(n(e));if(i?.data("p13nData")){t.setType(i.data("p13nData").typeInstance)}});const i=this.fireBeforeExport({exportSettings:t.getParameter("exportSettings"),userExportSettings:t.getParameter("userExportSettings"),filterSettings:e});if(!i){t.preventDefault()}};if(!this._oExportHandler){const t=await this._loadExportHandler();const e=this._oTableProvider.getExportCapabilities(this.getExportType());const i=new t(e);i.attachBeforeExport(r);this._oExportHandler=i}const l=(t?this._oExportHandler.exportAs:this._oExportHandler.export).bind(this._oExportHandler);return l(s,n)};At.prototype._loadExportHandler=function(){return i.load({name:"sap.ui.export"}).then(()=>new Promise((t,e)=>{sap.ui.require(["sap/ui/export/ExportHandler"],i=>{if(i){t(i)}else{e(new Error("Failed to load ExportHandler"))}})})).catch(()=>{const t=i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_ERROR_MISSING_EXPORT_LIBRARY");g.error(t);throw new Error(t+" - "+this.getId())})};At.prototype._createExportColumnConfiguration=function(){const t=[];const e=this.data("useUTCDateTime");let i;if(e!=null){if(typeof e==="string"){i=e==="true"}else if(typeof e==="boolean"){i=e}}const o=this._oTable.getColumns(this._isOfType(Bt.ResponsiveTable));o.filter(t=>t.getVisible()).forEach(e=>{const o=this._getExportColumnConfiguration(e,i);if(o){t.push(o)}});return t};At.prototype._getExportColumnConfiguration=function(t,e){let i=this._getColumnLeadingProperty(t);if(Array.isArray(i)){i=i[0]}if(!i){return undefined}const o=t.data("p13nData");const a=this._getColumnLabel(t);const n=t.getWidth().toLowerCase()||o.width;let s=o.typeInstance;let r=o.type==="numeric"?"Number":o.type;let l,u,h,p;if(o.unit){r=o.isCurrency?"Currency":"Number";p=o.unit}else if(s&&(s.isA("sap.ui.comp.odata.type.FiscalDate")||s.isA("sap.ui.comp.odata.type.CalendarDate"))){var d=s.getFormatter();u=d.getTemplate().replace(/\$(\d)/g,(t,e)=>`{${parseInt(e)-1}}`);l=d.getRegExPattern().toString().slice(1,-1);r="String"}else if(r!="date"&&z.isDateOrTime(o.edmType)){r=z.getTypeName(o.edmType);if(r==="DateTimeOffset"){r="DateTime";e=false;if(o.timezone){h=o.timezone}else if(this._aExistingColumns.includes(i)&&typeof o.additionalProperty==="string"){[h]=o.additionalProperty.split(",")}}}else if(r==="stringdate"){r="Date";l="YYYYMMDD"}else if(r==="boolean"){r="Boolean";s=s?s:z.getType(o.edmType)}else if(o.description&&o.displayBehaviour!=="idOnly"){r="String";u=W.getFormattedExpressionFromDisplayBehaviour(o.displayBehaviour,"{0}","{1}");if(o.displayBehaviour==="descriptionOnly"){i=o.description}else{i=[i,o.description]}}else if(o.isDigitSequence){r="Number"}else if(o.isTimezone){r="Timezone"}else if(r){r=r.slice(0,1).toUpperCase()+r.slice(1)}else{r="String"}return{columnId:t.getId(),property:i,type:r,inputFormat:l,label:a,width:n,textAlign:t.getHAlign(),template:u,trueValue:r==="Boolean"&&s?s.formatValue(true,"string"):undefined,falseValue:r==="Boolean"&&s?s.formatValue(false,"string"):undefined,unitProperty:p,displayUnit:r==="Currency"?true:undefined,precision:o.precision,scale:o.scale,autoScale:r==="Number",utc:r==="DateTime"&&e!=null?e:undefined,timezoneProperty:h}};At.prototype._removeExpandParameter=function(t){var e=t.replace(new RegExp("([\\?&]\\$expand=[^&]+)(&?)"),function(t,e,i){return i?e.substring(0,1):""});return e};At.prototype._setExcelExportEnableState=function(){this._oExportButton?.setEnabled(!this._bDataLoadPending&&rt.isExportable(this._getRowBinding()))};At.prototype._createPersonalizationController=function(){if(this._oPersController||!this.getUseTablePersonalisation()){return}var t=this._oP13nDialogSettings;t=this._setIgnoreFromPersonalisationToSettings(t);t=t||{};if(this._isOfType(Bt.TreeTable)){t.stableColumnKeys=[];t.stableColumnKeys.push(this._aColumnKeys[0])}if(this._bIsFilterPanelEnabled){t.filter=t.filter?t.filter:{};t.filter.createMessageStrip=this._getP13nFilterMessageStrip.bind(this)}this._oPersController=new L(this.getId()+"-persoController",{table:this._oTable,columnKeys:this._aColumnKeys,redundantColumnKeys:k.getRedundantProperties(this),setting:t,resetToInitialTableState:!this.getUseVariantManagement(),beforePotentialTableChange:[this._beforePersonalisationModelDataChange,this],afterPotentialTableChange:[this._afterPersonalisationModelDataChange,this],afterP13nModelDataChange:[this._personalisationModelDataChange,this],requestColumns:[this._personalisationRequestColumns,this]});this._oPersController.attachDialogAfterClose(function(t){if(this._fGetDataForKeyUser){if(t.getParameter("cancel")){this._fGetDataForKeyUser([])}this._cleanUpKeyUser()}this._bPersDialogOpen=false}.bind(this));if(this._aDeactivatedColumns.length>0){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns)}};At.prototype.getVariantManagement=function(){return this._oVariantManagement};At.prototype.openDialogForKeyUser=function(t,e){this._fGetDataForKeyUser=e;return this._oPersController.openDialog({showReset:false,useAvailablePanels:true,styleClass:t}).then(function(t){if(t){return i.load({name:"sap.ui.mdc"}).then(function(){sap.ui.require(["sap/ui/mdc/p13n/P13nBuilder"],function(e){return e.addRTACustomFieldButton(t,this)}.bind(this))}.bind(this))}}.bind(this))};At.prototype._cleanUpKeyUser=function(){this._fGetDataForKeyUser=null};At.prototype._createKeyUserChange=function(){return[{selectorControl:this._oVariantManagement._getPersoController(),changeSpecificData:{changeType:"variantContent",content:{key:this._oVariantManagement.getSelectionKey(),persistencyKey:this.getPersistencyKey(),content:this.fetchVariant()}}}]};At.prototype._setIgnoreFromPersonalisationToSettings=function(t){var e=U.createArrayFromString(this.getIgnoreFromPersonalisation());if(e.length){if(!t){t={}}var i=function(i){if(!t[i]){t[i]={}}t[i].ignoreColumnKeys=e};i("filter");i("sort");i("group");i("columns")}return t};At.prototype._getRowBinding=function(){return this._oTable?.getBinding(this._sAggregation)};At.prototype.setEntitySet=function(t){if(this.getEntitySet()===t){return this}if(this._bInitialising){throw new Error("entitySet changed while SmartTable control was initializing - "+this.getId())}this.setProperty("entitySet",t,true);this._initialiseMetadata();return this};At.prototype._initialiseMetadata=function(t){var e=this,i=e;if(t){i=t.getSource()}if(!i.bIsInitialised){K.handleModelInit(i,i._onMetadataInitialised,[{selector:i},{selector:i._oTable,changeTypes:["addXML","addXMLAtExtensionPoint"]}])}};function wt(t){var e=Object.assign({},t);delete e.binding;delete e.modelChangeHandler;delete e.dataStateChangeHandler;delete e.modelRefreshHandler;return e}At.prototype._onMetadataInitialised=function(){this._bMetaModelLoadAttached=false;if(this.bIsInitialised){return}this._bUseColumnLabelsAsTooltips=this.getUseColumnLabelsAsTooltips();this._updateInitialColumns();this._fireBeforeInitialiseAndValidate();this._validateCustomizeConfig(this.getCustomizeConfig());this._createTableProvider();if(!this._oTableProvider){return}this._aTableViewMetadata=this._oTableProvider.getTableViewMetadata();if(!this._aTableViewMetadata){return}if(this._bUseColumnLabelsAsTooltips){this._oTable.getColumns().forEach(function(t){var e=null;if(t.getHeader){e=t.getHeader()}else if(t.getLabel){e=t.getLabel()}var i=e&&e.isA&&(e.isA("sap.m.Label")||e.isA("sap.m.Text"))?e:null;var o=this._isOfType(Bt.ResponsiveTable)?i:t;var a=o?o.getTooltip():null;if(o&&i&&!a&&!o.isBound("tooltip")){if(i.isBound("text")){var n=wt(i.getBindingInfo("text"));o.bindProperty("tooltip",n)}else{o.setTooltip(i.getText())}}},this)}if(this.getEnableAutoColumnWidth()){this._oTable.getColumns().forEach(this._setWidthForCustomColumn,this)}if(!this._isOfType(Bt.ResponsiveTable)&&this.getDemandPopin()){this.setDemandPopin(false);$.error("use SmartTable property 'demandPopin' only  with responsive table, property has been set to false")}this.detachModelContextChange(this._initialiseMetadata,this);this.bIsInitialised=true;delete this._bInitialising;this._updateP13nDialogSettings(true);this._bTableSupportsExcelExport=this._oTableProvider.getSupportsExcelExport();this._bMultiUnitBehaviorEnabled=this._oTableProvider.getMultiUnitBehaviorEnabled();this._listenToSmartFilter();this._createVariantManagementControl();this._createToolbarContent();this._applyToolbarContentOrder();this._aAlwaysSelect=this._oTableProvider.getRequestAtLeastFields();this._createContent();this._createPersonalizationController();this._oEditModel=new B({editable:this.getEditable()});this.setModel(this._oEditModel,"sm4rtM0d3l");this.attachEvent("_change",this._onPropertyChange,this);this.fireInitialise();if(!this._oVariantManagement||this._oVariantManagement&&this._bVariantInitialised){this._checkAndTriggerBinding()}this._updateCopy()};At.prototype._fireBeforeInitialiseAndValidate=function(){if(!this.hasListeners("beforeInitialise")){return}this._bInitialising=true;this.fireEvent("beforeInitialise");this._validateControlConfig();this._updateInitialColumns()};At.prototype._validateControlConfig=function(){var t=this.getItems();if(!t.length){throw new Error("Internals of the SmartTable control changed via beforeInitialise event - "+this.getId())}var e=t.find(function(t){return t.isA(["sap.m.Table","sap.ui.table.Table"])});if(!e){throw new Error("Inner Table removed via beforeInitialise event - "+this.getId())}if(e!==this._oTable){throw new Error("Inner table changed via beforeInitialise event for SmartTable - "+this.getId())}};At.prototype._updateP13nDialogSettings=function(t){this._oP13nDialogSettings=this._getP13nDialogSettings();this._bIsFilterPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.filter?this._oP13nDialogSettings.filter.visible!==false:true;this._bIsSortPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.sort?this._oP13nDialogSettings.sort.visible!==false:true;this._bIsGroupPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.group?this._oP13nDialogSettings.group.visible!==false:true;this._bIsColumnsPanelEnabled=this._oP13nDialogSettings&&this._oP13nDialogSettings.columns?this._oP13nDialogSettings.columns.visible!==false:true;if(t){this._attachTableCustomFilter()}};At.prototype._checkAndTriggerBinding=function(){if(!this._bAutoBindingTriggered){this._bAutoBindingTriggered=true;if(this.getEnableAutoBinding()){if(this._oSmartFilter){if(this._oSmartFilter.isInitialised()){this._oSmartFilter.search()}else{this._oSmartFilter.attachEventOnce("initialise",function(){this._oSmartFilter.search()},this)}}else{this._reBindTable()}}}};At.prototype._aStaticProperties=["entitySet","ignoredFields","initiallyVisibleFields","ignoreFromPersonalisation","tableType","useTablePersonalisation","enableAutoBinding","persistencyKey","smartFilterId","showDetailsButton","enableAutoColumnWidth","customizeConfig","useColumnLabelsAsTooltips"];At.prototype._aToolbarRelatedProperties=["enableExport","exportType","showFullScreenButton","showPasteButton","editTogglable","placeToolbarInTable"];At.prototype._onPropertyChange=function(t){var e=t.getParameter("name");if(this._aStaticProperties.indexOf(e)>-1){$.error("Property "+e+" cannot be changed after the SmartTable with id "+this.getId()+" is initialised")}if(this._oToolbar&&this._aToolbarRelatedProperties.indexOf(e)>-1){if(e==="exportType"&&this._oExportButton){this._oExportButton.destroy();this._oExportButton=null}this._createToolbarContent()}};At.prototype._createTableProvider=function(){var t,e,i,o,a;e=this.getEntitySet();i=this.getIgnoredFields();t=this.getModel();o=this.data("preserveDecimals");a=this.getCustomizeConfig();if(a){for(var n in a){this["_oCustomizeConfig"+n.charAt(0).toUpperCase()+n.slice(1)]=a[n]}}if(o!=null){if(o==false||typeof o==="string"&&o==="false"){this._bPreserveDecimals=false}else{this._bPreserveDecimals=true}}else{this._bPreserveDecimals=true}if(t&&e){if(this._aExistingColumns.length){if(i){i+=","+this._aExistingColumns.toString()}else{i=this._aExistingColumns.toString()}}this._oTableProvider=new E({entitySet:e,ignoredFields:i,initiallyVisibleFields:this.getInitiallyVisibleFields(),isEditableTable:this.getEditable(),smartTableId:this.getId(),isAnalyticalTable:this._isOfType(Bt.AnalyticalTable),isMobileTable:this._isOfType(Bt.ResponsiveTable),dateFormatSettings:this.data("dateFormatSettings"),useUTCDateTime:this.data("useUTCDateTime"),currencyFormatSettings:this.data("currencyFormatSettings"),defaultDropDownDisplayBehaviour:this.data("defaultDropDownDisplayBehaviour"),useSmartField:this.data("useSmartField"),useSmartToggle:this.data("useSmartToggle"),skipAnnotationParse:this.data("skipAnnotationParse"),lineItemQualifier:this.data("lineItemQualifier"),presentationVariantQualifier:this.data("presentationVariantQualifier"),enableInResultForLineItem:this.data("enableInResultForLineItem"),defaultFilterBarExpanded:this.data("defaultFilterBarExpanded"),defaultShowAllFilters:this.data("defaultShowAllFilters"),_semanticKeyAdditionalControl:this.getAggregation("semanticKeyAdditionalControl"),model:t,semanticObjectController:this.getSemanticObjectController(),showDetailsButton:this.getShowDetailsButton(),enableAutoColumnWidth:this.getEnableAutoColumnWidth(),preserveDecimals:this._bPreserveDecimals,textInEditModeSource:this._oCustomizeConfigTextInEditModeSource,ignoreInsertRestrictions:this._oCustomizeConfigIgnoreInsertRestrictions,clientSideMandatoryCheck:this._oCustomizeConfigClientSideMandatoryCheck})}};At.prototype._listenToSmartFilter=function(){const t=this.getSmartFilterId();this._oSmartFilter=this._findControl(t,"sap.ui.comp.filterbar.FilterBar");if(this._oSmartFilter){this._oSmartFilter.attachSearch(this._reBindTable,this);this._oSmartFilter.attachFilterChange(this._filterChangeEvent,this)}var e=i.getResourceBundleFor("sap.ui.comp"),o,a,n={SMARTTABLE_NO_DATA:e.getText("SMARTTABLE_NO_DATA"),SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR:e.getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"),SMARTTABLE_NO_RESULTS:e.getText("SMARTTABLE_NO_RESULTS")};if(this._oTable){o=this._oTable.getNoData;a="noData";if(!o.call(this._oTable)&&this._oTable.getNoDataText){o=this._oTable.getNoDataText;a="noDataText"}}if(o){const t=o.call(this._oTable);if(t&&!this._oTable.isPropertyInitial(a)){if(Object.values(n).indexOf(t)==-1){this._vCustomNoData=t}}else if(t&&typeof t!=="string"&&!this.getNoData()){this._vCustomNoData=t;return}}let s=null;if(typeof this.getNoData()==="string"){s=this.getInitialNoDataText()!=="$NO_FILTERBAR"}this._updateNoDataText(true,s)};At.prototype._filterChangeEvent=function(){if(this._isTableBound()&&this._oSmartFilter&&!this._oSmartFilter.getLiveMode()&&!this._oSmartFilter.isDialogOpen()){this._showOverlay(true)}};At.prototype._showOverlay=function(t){if(t){var e={show:true};this.fireShowOverlay({overlay:e});t=e.show}this._oTable.setShowOverlay(t)};At.prototype._findControl=function(t,i){var o,a;if(t){o=e.getElementById(t);if(!o||!o.isA(i)){a=this._getView();if(a){o=a.byId(t)}}if(o&&!o.isA(i)){o=undefined}}return o};At.prototype._getView=function(){if(!this._oView){var t=this.getParent();while(t){if(t.isA("sap.ui.core.mvc.View")){this._oView=t;break}t=t.getParent()}}return this._oView};At.prototype.rebindTable=function(t){if(this.isInitialised()){this._reBindTable(null,t);return}$.error("rebindTable method called before the SmartTable is initialized. Please execute the UI5 Support Assistant 'SmartTable' rules to get more information",this.getId(),"sap.ui.comp.smarttable.SmartTable")};At.prototype._reBindTable=function(t,e){var o,a,n,s,r,l,u=[],h,p,d,f,c,_,m,b={},y={preventTableBind:false};this._bUpdateTableAnnouncement=t&&t.getId&&t.getId()==="search";n=this._getTablePersonalisationData()||{};if(this._oMessageFilter){h=this._oMessageFilter}else{h=n.filters;p=n.excludeFilters}m=n.sorters;if(this._oSmartFilter){l=this._oSmartFilter.getFilters();b=this._oSmartFilter.getParameters()||{}}if(l&&l.length){if(p){u=[new x([l[0],p],true)]}else{u=l}}else if(p){u=[p]}if(h){h=u.concat(h)}else{h=u}d=this._getRequestAtLeastFields();c=this._getRelevantColumnPaths();f=c["select"];f=this._getSemanticObjectBindingPaths(f);if(!f||!f.length){f=d}else{r=d.length;for(s=0;s<r;s++){if(f.indexOf(d[s])<0){f.push(d[s])}}}if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.select){this._mSelectExpandForGroup.select.forEach(function(t){if(f.indexOf(t)<0){f.push(t)}})}o=this._oTable.getBinding(this._sAggregation);if(f.length){this._adaptTreeBindingParameters(f,b,o);b["select"]=f.toString();_=c["expand"]||[];if(this._mSelectExpandForGroup&&this._mSelectExpandForGroup.expand){this._mSelectExpandForGroup.expand.forEach(function(t){if(_.indexOf(t)<0){_.push(t)}})}if(_.length){b["expand"]=_.join(",")}}b["useBatchRequests"]=true;if(!m){m=[]}y.filters=h;y.sorter=m;y.parameters=b;y.length=undefined;y.startIndex=undefined;y.events={};this.fireBeforeRebindTable({bindingParams:y,messageFilterActive:!!this._oMessageFilter});if(!y.preventTableBind){m=y.sorter;h=y.filters;b=y.parameters;f=y.parameters["select"];if(!f||!f.length){g.error(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_COLS"),{styleClass:this.$()&&this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":""});return}a=this.getTableBindingPath()||"/"+this.getEntitySet();if(this._oTable.resumeUpdateAnalyticalInfo){this._oTable.resumeUpdateAnalyticalInfo(true,false)}this._bDataLoadPending=true;this._setExcelExportEnableState();this._bIgnoreChange=false;if(this._bForceTableUpdate){e=true;this._bForceTableUpdate=false}if(!e){if(o&&o.mParameters){var T=b["select"];b["select"]="";var C=o.mParameters["select"];o.mParameters["select"]="";e=!(X(b,o.mParameters,true)&&X(b.custom,o.mParameters.custom)&&!y.length&&!y.startIndex&&a===o.getPath());if(!e){e=!X(T.split(",").sort(),C.split(",").sort())}b["select"]=T;o.mParameters["select"]=C}}if(!this._bNoDataUpdated){this._bNoDataUpdated=true}this._updateNoDataText(false,h&&h.length);if(!o||!this._bIsTableBound||e){At._addBindingListener(y,"change",this._onBindingChange,this);At._addBindingListener(y,"dataRequested",this._onDataRequested,this);At._addBindingListener(y,"dataReceived",this._onDataReceived,this);if(this._isOfType(Bt.ResponsiveTable)){var S=this._oTable?this._oTable.getColumns():[];var v=this._oTemplate?this._oTemplate.getCells():[];if(S.length===v.length){S.forEach(function(t,e){v[e].setBindingContext(t.getVisible()?undefined:null)})}}this._oTable.bindRows({path:a,filters:h,sorter:m,parameters:b,length:y.length,startIndex:y.startIndex,template:this._oTemplate,templateShareable:true,events:y.events});this._bIsTableBound=true}else{o.sort(m);o.filter(h,"Application")}this._showOverlay(false)}};At.prototype._adaptTreeBindingParameters=function(t,e,i){if(!this._isOfType(Bt.TreeTable)){return}if(this._oTable.getExpandFirstLevel){e["numberOfExpandedLevels"]=this._oTable.getExpandFirstLevel()?1:0}if(this._oTable.getRootLevel){e["rootLevel"]=this._oTable.getRootLevel()}if(this._oTable.getCollapseRecursive){e["collapseRecursive"]=this._oTable.getCollapseRecursive()}if(!i||!i.getTreeAnnotation){return}var o={"hierarchy-level-for":i.getTreeAnnotation("hierarchy-level-for"),"hierarchy-parent-node-for":i.getTreeAnnotation("hierarchy-parent-node-for"),"hierarchy-node-for":i.getTreeAnnotation("hierarchy-node-for"),"hierarchy-drill-state-for":i.getTreeAnnotation("hierarchy-drill-state-for")};for(var a in o){if(o[a]&&t.indexOf(o[a])===-1){t.push(o[a])}}};At.prototype._onDataRequested=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._bIgnoreChange=true;this.fireDataRequested(t.getParameters())};At.prototype._onDataReceived=function(t){if(t&&t.getParameter&&t.getParameter("__simulateAsyncAnalyticalBinding")){return}this._bIgnoreChange=false;this._onDataLoadComplete(t,true);this.fireDataReceived(t)};At.prototype._onBindingChange=function(t){if(this._bIgnoreChange){return}var e,i=false;e=t&&t.getParameter?t.getParameter("reason"):undefined;if(!e||e==="filter"||e==="context"||!this._bDataLoadPending&&e==="change"||e==="add"||e==="remove"){i=true}if(e==="change"||i){this._onDataLoadComplete(t,i)}};At._addBindingListener=function(t,e,i,o){if(!t.events){t.events={}}if(!t.events[e]){t.events[e]=i.bind(o)}else{var a=t.events[e];t.events[e]=function(){i.apply(o,arguments);a.apply(o,arguments)}}};At.prototype._onDataLoadComplete=function(t,e){if(this._bDataLoadPending||e){this._bDataLoadPending=false;this.updateTableHeaderState();this._updateNoDataText()}};At.prototype._isTableBound=function(){if(this._bIsTableBound){return true}if(this._oTable){return this._oTable.isBound(this._sAggregation)}return false};At.prototype.setNoData=function(t){if(typeof t!==typeof this._oNoData||t!==this._oNoData){this._bNoDataUpdated=true}this._oNoData=t;if(!this._oTable){return this}if(t?.isA?.("sap.m.IllustratedMessage")){this._sLastNoDataTitle="";this._vCustomNoData="";t.setEnableVerticalResponsiveness(!this._isOfType(Bt.ResponsiveTable));let e=this._oTable.getAggregation("_noColumnsMessage");if(!e){e=rt.getNoColumnsIllustratedMessage(()=>{this._oPersController.openDialog()});e.setEnableVerticalResponsiveness(!this._isOfType(Bt.ResponsiveTable));this._oTable.setAggregation("_noColumnsMessage",e,true)}}if(this._bNoDataUpdated||this._isTableBound()){this._updateNoDataText();this._bNoDataUpdated=false}return this};At.prototype.getNoData=function(){return this._oNoData};At.prototype._updateNoDataText=function(t,e){if(this._bIgnoreNoDataUpdate){return}let o=this.getNoData();const a=typeof o==="string"&&this._isOfType(Bt.ResponsiveTable)?this._oTable.setNoDataText:this._oTable.setNoData;if(this._bNoDataUpdated&&this._vCustomNoData){a.call(this._oTable,this._vCustomNoData,true);this._vCustomNoData=null;return}const n=i.getResourceBundleFor("sap.ui.comp");if(o?.isA?.("sap.m.IllustratedMessage")){if(this._sLastNoDataTitle!==o.getTitle()){a.call(this._oTable,o,true);return}const t=!this._isTableBound();Vt(o,t,this._oSmartFilter,e);this._sLastNoDataTitle=o.getTitle()}else if(typeof o==="string"||!o){const i=this.getInitialNoDataText();if(t&&i!=="$FILTERBAR"&&i!=="$NO_FILTERBAR"){o=this.getInitialNoDataText()}else if(t&&i==="$FILTERBAR"){o??=n.getText("SMARTTABLE_NO_DATA")}else if(e){o??=n.getText("SMARTTABLE_NO_RESULTS")}o||=n.getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR")}a.call(this._oTable,o,true)};function Vt(t,e,o,a){if(e){t.setDescription(" ");if(o){t.setIllustrationType(Mt.BeforeSearch);t.setTitle(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_DATA"))}else{t.setIllustrationType(Mt.NoEntries);t.setTitle(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"))}return}if(a!==false){t.setTitle(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS_TITLE"));t.setDescription(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_RESULTS_DESCRIPTION"));t.setIllustrationType(Mt.NoFilterResults);return}t.setTitle(i.getResourceBundleFor("sap.ui.comp").getText("SMARTTABLE_NO_DATA_WITHOUT_FILTERBAR"));t.setIllustrationType(Mt.NoEntries)}At.prototype.updateTableHeaderState=function(){this._refreshHeaderText();this._setExcelExportEnableState()};At.prototype._createContent=function(){var t,e=0,i,o,a,n=[];if(this._aExistingColumns&&this._aExistingColumns.length){this._aColumnKeys=[].concat(this._aExistingColumns.reverse())}if(this.getUseTablePersonalisation()){this._oColumnMenu=new ht({id:this.getId()+"-columnHeaderMenu",showTableSettingsButton:true,tableSettingsPressed:[this._showTableP13nDialog,this]});bt.setSemanticStepname(this._oColumnMenu,"beforeOpen","sc:tbl:p13n:col");this._bMissingColumnsCreated=false;this._oColumnMenu.attachBeforeOpen(this._createColumnMenuContent,this)}o=this._parseIndexedColumns();e=this._aTableViewMetadata.length;for(t=0;t<e;t++){i=this._aTableViewMetadata[t];if(i.isInitiallyVisible){this._aColumnKeys.push(i.name)}else{n.push(i.name)}if(!(i.isInitiallyVisible||i.inResult)){this._mLazyColumnMap[i.name]=i}else{a=this._createColumnForField(i);this._oTable.addColumn(a)}this._mFieldMetadataByKey[i.name]=i}this._insertIndexedColumns(o);this._aColumnKeys=this._aColumnKeys.concat(n);if(this._isOfType(Bt.ResponsiveTable)&&this.getEnableAutoColumnWidth()){this.setDemandPopin(true);this._oTable.setFixedLayout("Strict");this._oTable.setContextualWidth("auto");this._oTable.addDependent(new st)}this._updateColumnsPopinFeature();if(this.getShowDetailsButton()){this._oTable.setHiddenInPopin(this._getImportanceToHide())}this._storeInitialColumnSettings()};At.prototype._createColumnForField=function(t){var e,i;i=this.getId()+"-"+t.name.replace(/[^A-Za-z0-9_.:-]+/g,"_");e=this._createColumn(t,i);t.isColumnCreated=true;e.data("p13nData",{columnKey:t.name,leadingProperty:t.name,additionalProperty:t.additionalProperty,additionalSortProperty:undefined,navigationProperty:t.navigationProperty,sortProperty:t.sortable?t.name:undefined,filterProperty:t.filterable?t.name:undefined,isGroupable:t.sortable&&t.filterable&&t.aggregationRole==="dimension",fullName:t.hasValueListAnnotation?t.fullName:null,type:t.filterType,typeInstance:t.modelType,maxLength:t.maxLength,precision:t.precision,scale:t.scale,align:t.align,edmType:t.type,displayBehaviour:t.displayBehaviour,description:t.description,isDigitSequence:t.isDigitSequence,isCurrency:t.isCurrencyField,isTimezone:t.isTimezone,ignorePaste:false,unit:t.unit,width:t.width,aggregationRole:t.aggregationRole,nullable:t.nullable!=="false",timezone:t.timezone||null});if(t.filterable&&e.setFilterProperty){e.setFilterProperty(t.name)}if(t.sortable&&e.setSortProperty){e.setSortProperty(t.name)}if(!e.getAssociation("headerMenu")){e.setAssociation("headerMenu",this.getId()+"-columnHeaderMenu")}if(this.getEnableAutoColumnWidth()){t.width=e.getWidth();if(this.getEditable()){this._updateColumnWidthForEdit(e,t)}}this._registerContentTemplateEvents(t.template);return e};At.prototype._parseIndexedColumns=function(){var t,e,i,o,a,n,s,r,l;var u=this._oTable.getColumns();var h=null;if(this._oTemplate&&this._oTemplate.getCells){h=this._oTemplate.getCells()}if(!u){return null}o=[];e=u.length;for(t=0;t<e;t++){i=u[t];a=i.data("p13nData");n=null;s=null;if(a){n=a.columnIndex;s=a.columnKey}r=-1;if(n!==null&&n!==undefined){r=parseInt(n)}if(!isNaN(r)&&r>-1){if(h){l=h[t];this._oTemplate.removeCell(l)}else{l=null}this._aColumnKeys.splice(t-o.length,1);o.push({index:r,columnKey:s,column:i,template:l});this._oTable.removeColumn(i)}}o.sort(function(t,e){return t.index-e.index});return o};At.prototype._insertIndexedColumns=function(t){var e,i,o;if(!t){return}i=t.length;for(e=0;e<i;e++){o=t[e];this._aColumnKeys.splice(o.index,0,o.columnKey);this._oTable.insertColumn(o.column,o.index);if(o.template){this._oTemplate.insertCell(o.template,o.index)}}};At.prototype._updateColumnsPopinFeature=function(){if(!this._isOfType(Bt.ResponsiveTable)||!this.getDemandPopin()){return}if(!this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(true)}var t=this._oTable.getColumns(true);if(!t){return}t=t.filter(function(t){return t.getVisible()});t.forEach(function(t){if(t.getPopinDisplay()!="WithoutHeader"){t.setPopinDisplay("Inline")}})};At.prototype._storeInitialColumnSettings=function(){var t=U.createArrayFromString(this.getIgnoreFromPersonalisation());this._aInitialSorters=[];U.createSort2Json(this._oTable,this._aInitialSorters,t,this._aTableViewMetadata)};At.prototype._deactivateColumnsPopinFeature=function(){if(!this._isOfType(Bt.ResponsiveTable)){return}if(this._oTable.getAutoPopinMode()){this._oTable.setAutoPopinMode(false)}var t=this._oTable.getColumns();if(!t){return}var e,i=t.length;for(var o=0;o<i;o++){e=t[o];e.setDemandPopin(false);e.setMinScreenWidth("1px")}};At.prototype._registerContentTemplateEvents=function(t){if(t.isA("sap.ui.comp.SmartToggle")){t=t.getEdit()}if(t&&t.attachChange){t.attachChange(function(t){this.fireFieldChange({changeEvent:t})},this)}};At.prototype._updateInitialColumns=function(){var t=this._oTable.getColumns(),e=t.length,i,o;var a=this.getEnableAutoColumnWidth();while(e--){i=t[e];o=i.data("p13nData");if(o?.columnKey&&this._aExistingColumns.indexOf(o.columnKey)>=0){continue}if(typeof o==="string"){try{o=JSON.parse(o);i.data("p13nData",o)}catch(t){$.error(`Assigned p13nData is not a valid JSON object for column with id ${i.getId()}`)}}if(o?.columnKey){this._aExistingColumns.push(o.columnKey);if(!i.getAssociation("headerMenu")){i.setAssociation("headerMenu",this.getId()+"-columnHeaderMenu");if(!this._isOfType(Bt.ResponsiveTable)){this._mMenuShowEntryMap.set(i,{sort:i.getShowSortMenuEntry(),filter:i.getShowFilterMenuEntry()});i.setShowSortMenuEntry(false);i.setShowFilterMenuEntry(false)}}}if(a&&this._isOfType(Bt.ResponsiveTable)){var n=i.getHeader();if(n&&n.isPropertyInitial("wrapping")&&n.getMetadata().getProperty("wrapping")){n.setWrapping(false)}}}};At.prototype._getRelevantColumnPaths=function(){var t={},e=[],i=[],o=this._oTable.getColumns(),a,n=o?o.length:0,s,r,l,u,h;var p=function(t,e,i){var o,a;if(t){a=t.split(",");o=a.length;while(o--){t=a[o];if(t&&e.indexOf(t)<0){e.push(t);if(!this._isOfType(Bt.AnalyticalTable)){var n=this._getColumnFromP13nMap(t);if(n){var s=i?"additionalProperty":"navigationProperty",r=n.data("p13nData"),l=r[s];if(l){p.call(this,l,e,i)}}}}}}};for(a=0;a<n;a++){s=o[a];l=null;if(s.getVisible()||s.getInResult&&s.getInResult()){r=s.data("p13nData");l=this._getColumnLeadingProperty(s,r);if(r){u=r["additionalProperty"];h=r["navigationProperty"]}if(l&&e.indexOf(l)<0){e.push(l)}p.call(this,u,e,true);p.call(this,h,i,false)}}t["select"]=e;t["expand"]=i;return t};At.prototype._createTable=function(){const t=this.getTable();this._sAggregation="rows";if(!t){const t=this.getId()+"-ui5table";switch(this.getTableType()){case Bt.AnalyticalTable:this._oTable=new w(t,{enableCustomFilter:true});break;case Bt.ResponsiveTable:this._oTable=new c(t,{growing:true,autoPopinMode:this.getDemandPopin()});this._oTemplate=new d;break;case Bt.TreeTable:this._oTable=new O(t,{selectionMode:"MultiToggle"});break;default:this._oTable=new R(t,{selectionMode:"MultiToggle"})}if(!this._isOfType(Bt.ResponsiveTable)){Rt(this._oTable)}this.insertItem(this._oTable,2)}else{const e=t.getNoData();if(e?.isA?.("sap.m.IllustratedMessage")){this._bIgnoreNoDataUpdate=true}}this._oTableReady.resolve(this._oTable);this._fColumnPaddingBorder=this._isOfType(Bt.ResponsiveTable)?1:1.1875;if(!this._oTable.getLayoutData()){let t=false;if(!this._isOfType(Bt.ResponsiveTable)){const e=this._oTable.getRowMode();if(!e){t=this._oTable.getVisibleRowCountMode()==="Auto"}if(e){t=e==="Auto"||e.isA("sap.ui.table.rowmodes.Auto")}}if(this._oTable instanceof c||t){this._oTable.setLayoutData(new P({growFactor:1,baseSize:"auto"}))}else{this._oTable.setLayoutData(new P({growFactor:1,baseSize:"0%"}))}}this._oTable.addStyleClass("sapUiCompSmartTableInnerTable");this._oTable.setEnableBusyIndicator(true);this._oTable.setBusyIndicatorDelay(100);if(this._oTable.setEnableCustomFilter){this._oTable.setEnableCustomFilter(this.getEnableCustomFilter())}if(this._oTable.setShowColumnVisibilityMenu){this._oTable.setShowColumnVisibilityMenu(false)}this._attachTableCustomFilter();if(this._isOfType(Bt.AnalyticalTable)){this._createColumn=this._createAnalyticalColumn}else if(this._isOfType(Bt.ResponsiveTable)){if(this.getUseTablePersonalisation()){this._oTable.bActiveHeaders=true}this._sAggregation="items";this._createColumn=this._createMobileColumn;this._oTable.bindRows=this._oTable.bindItems;if(this.getShowDetailsButton()){this._oTable.attachEvent("popinChanged",this._onPopinChanged,this)}}if(!this._isOfType(Bt.ResponsiveTable)){this._oTable.attachRowsUpdated(function(){this._setExcelExportEnableState()},this)}if(this._isOfType(Bt.AnalyticalTable)){this._oTable.setProperty("extendedGroupHeaderMenu",false)}if(this._oTable._setLargeDataScrolling){this._oTable._setLargeDataScrolling(true)}this._oTable.attachPaste(this._onInnerTablePaste,this);if(!this._oTable.getNoData()&&this.getNoData()){this.setNoData(this.getNoData())}};function Rt(t){if(t.setVisibleRowCountMode){t.setVisibleRowCountMode("Auto");return}t.setRowMode("Auto")}At.prototype.onAfterRendering=function(t){if(this.bFullScreen){this._toggleFullScreen(false)}};At.prototype._attachTableCustomFilter=function(){if(this._oTable.detachCustomFilter){this._oTable.detachCustomFilter(this._onCustomFilter,this)}if(this._oTable.getEnableCustomFilter&&this._oTable.getEnableCustomFilter()&&this._bIsFilterPanelEnabled){if(this._oTable.setEnableCellFilter){this._oTable.setEnableCellFilter(false)}if(this._oTable.attachCustomFilter){this._oTable.attachCustomFilter(this._onCustomFilter,this)}}};At.prototype._createColumnMenuContent=function(t){var e=i.getResourceBundleFor("sap.ui.comp");var o=t.getParameter("openBy");var a=o.data("p13nData");var n;var s=this._isOfType(Bt.ResponsiveTable)&&this.getEnableAutoColumnWidth();var r=s&&window.matchMedia("(hover:none)").matches;this._oColumnClicked=o;this._oColumnMenu.removeAllAggregation("quickActions");if(!this._bMissingColumnsCreated){this._oPersController?.preparePersonalization();this._bMissingColumnsCreated=true}if(this.getUseTablePersonalisation()){n=this._mMenuShowEntryMap.get(o);if(this._bIsSortPanelEnabled&&(this._isOfType(Bt.ResponsiveTable)||!this._aExistingColumns.includes(a.columnKey)||n&&n.sort)){if(!this._oQuickSort){this._oQuickSort=this._createQuickSort(o)}this._updateQuickSort(o);this._oColumnMenu.addQuickAction(this._oQuickSort)}if(this._bIsGroupPanelEnabled&&this._isOfType(Bt.ResponsiveTable)){if(!this._oQuickGroup){this._oQuickGroup=this._createQuickGroup(o)}this._updateQuickGroup(o);this._oColumnMenu.addQuickAction(this._oQuickGroup)}if(s){if(this._oQuickResizeInput){this._oQuickResizeInput.destroy()}this._oQuickResizeInput=this._createQuickResizeInput(o,this._oColumnMenu);this._oColumnMenu.addQuickAction(this._oQuickResizeInput)}if(r){if(!this._oQuickResize){this._oQuickResize=this._createQuickResize(e)}this._oColumnMenu.addQuickAction(this._oQuickResize)}}this._oColumnMenu.setShowTableSettingsButton(this.getUseTablePersonalisation()&&this.getShowTablePersonalisation())};At.prototype._showTableP13nDialog=function(t){if(!this._bPersDialogOpen){this._oPersController?.openDialog({filter:{payload:{column:this._oColumnClicked}}})}};At.prototype._createQuickGroup=function(t){return new gt({items:[],change:[function(t){var e=t.getParameter("item"),i=this._getColumnFromP13nMap(e.getKey());if(!i){return}this._onCustomGroup(t,e.getGrouped(),i)},this]})};At.prototype._createQuickSort=function(t){return new dt({items:[],change:[function(t){var e=t.getParameter("item"),i=e.getSortOrder(),o=this._getColumnFromP13nMap(e.getKey());if(!o){return}if(i===Dt.None){var a=o.data("p13nData");this._onCustomSort(t,a.sorted&&a.sorted.ascending,o)}else{this._onCustomSort(t,i===Dt.Ascending,o)}},this]})};At.prototype._updateQuickGroup=function(t){var e=t.data("p13nData");var i;this._oQuickGroup.destroyItems();if(e.unit||e.displayBehaviour!=="descriptionOnly"||!e.description){var o=this._getColumnSortProperty(t);i=this._getColumnFromP13nMap(o);if(o&&i){this._oQuickGroup.addItem(new ct({key:o,label:this._getColumnLabel(t),grouped:e.grouped}))}}if(e.displayBehaviour!=="idOnly"&&e.description){i=this._getColumnFromP13nMap(e.description);if(i){this._oQuickGroup.addItem(new ct({key:e.description,label:this._getColumnLabel(i),grouped:i.data("p13nData").grouped}))}}if(e.unit){i=this._getColumnFromP13nMap(e.unit);if(i&&this._getColumnSortProperty(i)){this._oQuickGroup.addItem(new ct({key:e.unit,label:this._getColumnLabel(i),grouped:i.data("p13nData").grouped}))}}};At.prototype._updateQuickSort=function(t){var e=t.data("p13nData");var i;this._oQuickSort.destroyItems();if(e.unit||e.displayBehaviour!=="descriptionOnly"||!e.description){var o=this._getColumnSortProperty(t);i=this._getColumnFromP13nMap(o);if(o&&i){this._oQuickSort.addItem(new ft({key:o,label:this._getColumnLabel(t),sortOrder:Ot(i.data("p13nData"))}))}}if(e.displayBehaviour!=="idOnly"&&e.description){i=this._getColumnFromP13nMap(e.description);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new ft({key:e.description,label:this._getColumnLabel(i),sortOrder:Ot(i.data("p13nData"))}))}}if(e.unit){i=this._getColumnFromP13nMap(e.unit);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new ft({key:e.unit,label:this._getColumnLabel(i),sortOrder:Ot(i.data("p13nData"))}))}}if(e.additionalProperty&&e.additionalSortProperty){var a=e.additionalProperty.split(",");var n=e.additionalSortProperty.split(",");n.forEach(function(t){t=t.trim();if(a.indexOf(t)===-1){return}i=this._getColumnFromP13nMap(t);if(i&&this._getColumnSortProperty(i)){this._oQuickSort.addItem(new ft({key:t,label:this._getColumnLabel(i),sortOrder:Ot(i.data("p13nData"))}))}}.bind(this))}};At.prototype._getColumnSortProperty=function(t){let e=t?.getSortProperty?.();e=t?.data("p13nData")?.sortProperty||e;return e??""};At.prototype._createQuickResize=function(t){return new pt({label:t.getText("SMARTTABLE_RP_RESIZE"),content:new et({icon:"sap-icon://resize-horizontal",press:[function(){this._oColumnMenu.close();st.getPlugin(this._oTable).startResizing(this._oColumnClicked.getDomRef())},this]})})};At.prototype._createQuickResizeInput=function(t){const e=st.getPlugin(this._oTable);return e.getColumnResizeInputQuickAction(t)};function Ot(t){var e=Dt.None;if(t.sorted){e=t.sorted.ascending?Dt.Ascending:Dt.Descending}return e}At.prototype._onCustomSort=function(t,e,i){if(!i){i=this._oColumnClicked}var o=i.data("p13nData");var a,n;if(o){if(o.sorted&&o.sorted.ascending===e){delete o.sorted;n=Dt.None;if(this._isOfType(Bt.ResponsiveTable)){i.setSortIndicator(n)}}else{o.sorted={ascending:e};a=o.sorted;n=a&&a.ascending?Dt.Ascending:Dt.Descending}var s=this._isOfType(Bt.ResponsiveTable)?"_sort":"sort";this._oTable.fireEvent(s,{column:i,sortOrder:n,columnAdded:false})}};At.prototype._onCustomGroup=function(t,e,i){if(!i){i=this._oColumnClicked}var o=i.data("p13nData");if(o){o.grouped=e;this._oTable.fireEvent("_group",{groupedColumns:e?[i]:[]})}};At.prototype._onCustomFilter=function(t){this._showTableFilterDialog(t.getParameter("column")||this._oColumnClicked)};At.prototype._onPopinChanged=function(t){if(!this._oShowHideDetailsButton){this._createShowHideDetailsButton()}var e=t.getParameter("visibleInPopin");var i=t.getParameter("hiddenInPopin");var o=t.getSource().getVisibleItems();var a=e.some(function(t){return this._getImportanceToHide().indexOf(t.getImportance())>-1},this);if(o.length&&(i.length||a)){this._oShowHideDetailsButton.setVisible(true)}else{this._oShowHideDetailsButton.setVisible(false)}};At.prototype.getTable=function(){if(!this._oTable){const t=this.getItems().find(t=>t instanceof R||t instanceof c);if(!t){return undefined}else if(t instanceof w){this.setProperty("tableType",Bt.AnalyticalTable,true)}else if(t instanceof c){this.setProperty("tableType",Bt.ResponsiveTable,true);this._oTemplate=t.getItems()?.length>0?t.getItems()[0]:new d;t.removeAllItems()}else if(t instanceof O){this.setProperty("tableType",Bt.TreeTable,true)}else{this.setProperty("tableType",Bt.Table,true)}this._oTable=t;this._updateInitialColumns()}return this._oTable};At.prototype._showTableFilterDialog=function(){if(this._oPersController){var t={useAvailablePanels:false,filter:{visible:true}};this._oPersController.openDialog(t)}};At.prototype._calcColumnWidth=function(t,e,i){var o;if(i===false){o=true}i=Object.assign({label:e?false:true,defaultWidth:e?4:8,padding:this._fColumnPaddingBorder},i);if(!t||o){return i.defaultWidth}var a=0,n=0,s=Math.max(i.min||0,e?1:2),r=Math.max(s,i.max||19),l=t.additionalProperty||"",u=t.displayBehaviour,h=t.modelType,p=t.type||"";if(r<s){return r}if(e||t.unit||!l||u!="descriptionOnly"){if(t.isImageURL||p=="Edm.Byte"||p=="Edm.SByte"){a+=s}else if(h){a+=rt.calcTypeWidth(h,{defaultWidth:i.defaultWidth,maxWidth:i.max})}else{a+=i.defaultWidth}}if(this._isOfType(Bt.TreeTable)&&t.hierarchy&&t.index==0){a+=3}if(!e){t.ownWidth=a=Math.min(a,r)}if(!e&&u!="idOnly"&&l&&this._oTableProvider&&a<r){l.split(",").forEach(function(e){if(e==t.fieldControlProperty){return}var i=this._oTableProvider.getFieldMetadata(e);var o=Object.assign({padding:.4,max:r-a-.4},t.vertical&&{padding:0,max:r});if(e==t.unit){o.min=3}var n=this._calcColumnWidth(i,true,o);if(t.vertical){a=Math.max(n,a)}else{a+=n}},this);if(u=="descriptionOnly"){t.ownWidth=a}else{t.additionalWidth=a-t.ownWidth}}a=a+(i.gap||0);if(i.label){var d=t.label||t.fieldLabel||"";t.labelWidth=n=rt.calcHeaderWidth(d,i.truncateLabel!=false?a:0,r,s)}a=Math.max(s,a,n);a=Math.min(a,r)+i.padding;a=Math.round(a*100)/100;return a};At.prototype._fetchAutoColumnWidthConfig=function(t){var e=null;if(this._oCustomizeConfigAutoColumnWidth){if(this._oCustomizeConfigAutoColumnWidth.hasOwnProperty(t.name)){e=this._oCustomizeConfigAutoColumnWidth[t.name]}else if(this._oCustomizeConfigAutoColumnWidth.hasOwnProperty("*")){e=this._oCustomizeConfigAutoColumnWidth["*"]}}if(e&&e===true){e=null}return e};At.prototype.getFlexConfig=function(){if(this.isInitialised()){return{entitySetName:this.getEntitySet()}}};At.prototype._setWidthForCustomColumn=function(t){var e=t.data("p13nData");if(!this._oTableProvider||!e||!e.autoColumnWidth||t.getWidth()){return}var i=e.autoColumnWidth;var o=i.visibleProperty||typeof e.additionalProperty==="string";var a=i.visibleProperty||[this._getColumnLeadingProperty(t,e),e.additionalProperty].join(",");var n=a.split(",");var s=this._oTableProvider.getFieldMetadata(n.shift(),true);if(!s){return}var r=Object.assign({},s);r.label=this._getColumnLabel(t);if(o){r.additionalProperty=n?n.join(","):""}var l=this._calcColumnWidth(r,false,{truncateLabel:i.truncateLabel,min:i.min,max:i.max,gap:i.gap});s.width=l+"rem";t.setWidth(s.width);if(this.getEditable()){this._updateColumnWidthForEdit(t,s,i)}};At.prototype._updateColumnWidthForEdit=function(t,e){if(!e||!e.isColumnCreated||e.type=="Edm.Boolean"||e.semanticObjects){return}var i=this.data("useSmartField")=="true"||this.data("useSmartField")===true;if(i&&e["sap:updatable"]=="false"){return}var o=t.getWidth();if(!this.getEditable()){if(e.editWidth==o){t.setWidth(e.width)}}else if(e.width==o){if(e.editWidth){t.setWidth(e.editWidth);return}if(!this._aEditableColumnAdditionalWidth){var a=this._fColumnPaddingBorder;var n=this.$().closest(".sapUiSizeCompact").length?"_Compact":"";var s=Object.assign({_sap_m_InputBase_IconWidth:"2.375rem",_sap_m_InputBase_Compact_IconWidth:"2rem",_sap_m_InputBaseWrapper_Sum_Border:"0.125rem",_sap_m_InputBase_InnerPadding:"0 0.75rem",_sap_m_InputBase_Compact_InnerPadding:"0 0.5rem"},nt.get({name:["_sap_m_InputBase_IconWidth","_sap_m_InputBase_Compact_IconWidth","_sap_m_InputBaseWrapper_Sum_Border","_sap_m_InputBase_InnerPadding","_sap_m_InputBase_Compact_InnerPadding"],callback:function(t){Object.assign(s,t)}}));var r=parseFloat(s["_sap_m_InputBase"+n+"_IconWidth"]);a+=parseFloat(s["_sap_m_InputBaseWrapper_Sum_Border"]);a+=parseFloat(s["_sap_m_InputBase"+n+"_InnerPadding"].split(" ").pop())*2;this._aEditableColumnAdditionalWidth=[a,a+r-.25]}var l=(e.displayBehaviour||"").includes("And");var u=(e.labelWidth||0)+this._fColumnPaddingBorder;if(i&&l&&e.additionalWidth&&e.hasValueListAnnotation&&!e.hasFixedValues){e.editWidth=Math.max(e.ownWidth+this._aEditableColumnAdditionalWidth[1],u)+"rem";t.setWidth(e.editWidth);return}var h=e.isCalendarDate||z.isDateOrTime(e.type);var p=e.hasValueListAnnotation||h;var d=this._aEditableColumnAdditionalWidth[+p];if(i&&l&&!e.additionalWidth&&e.hasValueListAnnotation&&e.hasFixedValues){d+=e.ownWidth+3}else if(e.ownWidth<4||h){if(i&&e.unit){d=e.ownWidth+e.additionalWidth+this._aEditableColumnAdditionalWidth[1]}else{d+=e.ownWidth}}else{d+=2}d=Math.min(d,19);var f=parseFloat(o);if(f<d){e.editWidth=d+"rem";t.setWidth(e.editWidth)}}};At.prototype._updateVisibleColumnsWidthForEdit=function(){if(!this._oTable||!this._oTableProvider||!this.getEnableAutoColumnWidth()){return}this._oTable.getColumns().filter(t=>t.getVisible()).forEach(function(t){var e=this._getColumnLeadingProperty(t);if(e){const i=this._oTableProvider.getFieldMetadata(e);this._updateColumnWidthForEdit(t,i)}},this)};At.prototype._updateVariantManagement=function(){if(this._oVariantManagement&&!this.getSmartVariant()){this._oVariantManagement.setShowAsText(!!this.getHeader());this._oVariantManagement.setHeaderLevel(this.getHeaderLevel());this._oVariantManagement.setTitleStyle(this.getHeaderStyle()||xt[nt.get({name:"_sap_ui_comp_SmartTable_HeaderStyle"})])}};At.prototype._getColumnTooltip=function(t){return this._bUseColumnLabelsAsTooltips?t.quickInfo||t.label:t.quickInfo};At.prototype._createColumn=function(t,e){var i=new V(e,{autoResizable:true,hAlign:t.align,width:t.width,visible:t.isInitiallyVisible,label:new f(e+"-header",{textAlign:t.align,text:t.label}),sorted:t.sorted,sortOrder:t.sorted?t.sortOrder:Dt.None,tooltip:this._getColumnTooltip(t),showSortMenuEntry:!this.getUseTablePersonalisation(),showFilterMenuEntry:!this.getUseTablePersonalisation(),name:t.fieldName,template:t.template});if(!t.width&&this.getEnableAutoColumnWidth()){var o=this._fetchAutoColumnWidthConfig(t);i.setWidth(this._calcColumnWidth(t,false,o)+"rem")}return i};At.prototype._createAnalyticalColumn=function(t,e){if(t.aggregationRole!=="measure"&&t.isMeasureField&&t.unit&&t.template.addStyleClass){t.template.addStyleClass("sapUiAnalyticalTableSumCellHidden sapUiAnalyticalTableGroupCellHidden")}else if(t.isCurrencyField&&t.template.addStyleClass){t.template.addStyleClass("sapUiCompCurrencyBold")}var i=this.getModel(),o=i&&i.getMetaModel();var a=new A(e,{autoResizable:true,hAlign:t.align,width:t.width,visible:t.isInitiallyVisible,inResult:t.inResult,label:new f(e+"-header",{textAlign:t.align,text:t.label}),tooltip:this._getColumnTooltip(t),sorted:t.sorted,sortOrder:t.sorted?t.sortOrder:Dt.None,grouped:t.grouped,showIfGrouped:t.grouped,showSortMenuEntry:!this.getUseTablePersonalisation(),showFilterMenuEntry:!this.getUseTablePersonalisation(),summed:t.summed,leadingProperty:t.name,template:t.template,groupHeaderFormatter:W.getInlineGroupFormatterFunction(t,true,this._getDateFormatSettings(),this._bPreserveDecimals,true,o)});if(!t.width&&this.getEnableAutoColumnWidth()){var n=this._fetchAutoColumnWidthConfig(t);a.setWidth(this._calcColumnWidth(t,false,n)+"rem")}return a};At.prototype._createMobileColumn=function(e,i){var o=new p(i,{hAlign:e.align,visible:e.isInitiallyVisible,header:new f(i+"-header",{textAlign:e.align,text:e.label,tooltip:this._getColumnTooltip(e),wrapping:!this.getEnableAutoColumnWidth(),wrappingType:t.WrappingType.Hyphenated}),tooltip:this._getColumnTooltip(e)});if(e.importance&&!this._oTableProvider.isLineItemDefaultImportance(e)){o.setImportance(e.importance)}if(this._oTemplate){this._oTemplate.addCell(e.template)}if(e.width){return o.setWidth(e.width)}if(!this.getEnableAutoColumnWidth()){return o.setWidth(e.isImageURL?"3em":"auto")}var a=this._fetchAutoColumnWidthConfig(e);return o.setWidth(this._calcColumnWidth(e,false,a)+"rem")};At.prototype.fetchVariant=function(){if(this._oCurrentVariant==="STANDARD"||this._oCurrentVariant===null){return{}}var t=this._processDateFiltersForVariant(this._oCurrentVariant);return t};At.prototype.applyVariant=function(t,e){this._oCurrentVariant=t;if(this._oCurrentVariant==="STANDARD"){this._oCurrentVariant=null}this._bApplyingVariant=true;if(this._oTable._setSuppressRefresh){this._oTable._setSuppressRefresh(true)}if(this._oPersController){if(this._oCurrentVariant===null||mt(this._oCurrentVariant)){this._oPersController.resetPersonalization("ResetFull")}else{this._oPersController.setPersonalizationData(this._oCurrentVariant,true)}}this._bApplyingVariant=false;this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId(),variantContext:e})};At.prototype._processDateFiltersForVariant=function(t){if(!this._oPersController){return t}var e=U.getColumnKeysOfType("date",this._oPersController.getColumnMap()),i=U.getColumnKeysOfType("time",this._oPersController.getColumnMap());if(e.length===0||!(t&&t.filter&&t.filter.filterItems)){return t}var o=t.filter.filterItems.map(function(t){if(e.concat(i).includes(t.columnKey)&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){t=Object.assign({},t);if(t.value1 instanceof Date){t.value1=l.localToUtc(t.value1).toISOString();t.value1=t.value1.slice(0,-1)}if(t.value2 instanceof Date){t.value2=l.localToUtc(t.value2).toISOString();t.value2=t.value2.slice(0,-1)}}return t},this);t=Object.assign({},t,{filter:Object.assign({},t.filter,{filterItems:o})});return t};At.prototype.variantsInitialized=function(){this._bVariantInitialised=true;this._checkAndTriggerBinding()};At.prototype.getUiState=function(){const t=this._oPersController?this._oPersController.getDataSuiteFormatSnapshot():null;return new G({presentationVariant:{SortOrder:t?t.SortOrder:[],GroupBy:t?t.GroupBy:[],Total:t?t.Total:[],RequestAtLeast:this._getRequestAtLeastFields(),Visualizations:t?t.Visualizations:[]},selectionVariant:{SelectOptions:t?t.SelectOptions:[]},variantName:this.getCurrentVariantId(),tableSettings:{fixedColumnCount:this.getTable().getFixedColumnCount?.(),showDetails:this.getProperty("showDetails")}})};At.prototype.setUiState=function(t){this._setUiState(t,false)};At.prototype.setUiStateAsVariant=function(t,e){this._setUiState(t,true);if(this._oVariantManagement){this.fireAfterVariantApply({currentVariantId:this.getCurrentVariantId(),variantContext:e})}};At.prototype._setUiState=function(t,e){const i=t.getPresentationVariant()&&t.getPresentationVariant().RequestAtLeast?[].concat(t.getPresentationVariant().RequestAtLeast):[];const o=t.getTableSettings();if(!X(i,this._getRequestAtLeastFields())){this._aAlwaysSelect=i}if(this._oPersController){const i=Y({},t.getPresentationVariant(),t.getSelectionVariant());if(e){this._oPersController.setPersonalizationDataAsDataSuiteFormat(i,true)}else{var a=this._oVariantManagement&&t.getVariantName()?this._oVariantManagement.getVariantContent(this,t.getVariantName()):{};if(o){a.columns??={};a.columns.showDetails=o.showDetails;a.columns.fixedColumnCount=o.fixedColumnCount}this._oPersController.setDataSuiteFormatSnapshot(i,a,true)}}};At.prototype._getRequestAtLeastFields=function(){var t=this.getRequestAtLeastFields();var e=t?t.split(","):[];return e.concat(this._aAlwaysSelect)};At.prototype._personalisationRequestColumns=function(t){var e=t.getParameter("columnKeys"),i,o,a,n,s,r={};a=e.length;for(o=0;o<a;o++){i=e[o];n=this._mLazyColumnMap[i];if(n){s=this._createColumnForField(n);if(this._isOfType(Bt.ResponsiveTable)){this._oTable.addColumn(s)}r[n.name]=s}}this._oPersController.addColumns(r)};At.prototype._beforePersonalisationModelDataChange=function(t){this._aFilteredColumnsBeforePersonalisationDataChange=this._oCurrentVariant?.filter?.filterItems;if(this._oTable.suspendUpdateAnalyticalInfo){this._oTable.suspendUpdateAnalyticalInfo()}};At.prototype._afterPersonalisationModelDataChange=function(t){this._updateColumnsPopinFeature();this._createInfoToolbar();if(this.getEditable()){this._updateVisibleColumnsWidthForEdit()}};At.prototype._personalisationModelDataChange=function(t){this._oCurrentVariant=t.getParameter("persistentData");if(this._fGetDataForKeyUser){this._fGetDataForKeyUser(this._createKeyUserChange())}var e=t.getParameter("runtimeDeltaDataChangeType");var i=this._getChangeStatus(e);if(i==="Unchanged"){return}if(!(this._bApplyingVariant||this._bDeactivatingColumns)){if(!this.getUseVariantManagement()){this._persistPersonalisation()}else if(this._oVariantManagement){this._oVariantManagement.currentVariantSetModified(true)}}if(this._isTableBound()){if(i==="ModelChanged"){if(e&&e.columns==="ModelChanged"&&!t.getParameter("_bTriggeredFromReset")){this._bForceTableUpdate=true;var o;if(this._isOfType(Bt.ResponsiveTable)&&this._oTable.getHiddenInPopin()){o=t.getParameter("runtimeDeltaData").columns.columnsItems.some(function(t){const e=this._getColumnByKey(t.columnKey);return e&&t.visible?this._oTable.getHiddenInPopin().includes(e.getImportance()):false},this)}if(o){this.setShowDetails(true)}}if(this._oSmartFilter){this._oSmartFilter.search()}else{this._reBindTable(null)}}else if(i==="TableChanged"&&this._isOfType(Bt.ResponsiveTable)&&this.getEditable()){this._updateMobileHiddenCellBindingContext(t)}}this._adaptCustomSort();this._adaptCustomGroup();this._createInfoToolbar();this.fireUiStateChange()};At.prototype._updateMobileHiddenCellBindingContext=function(t){var i=a.getMessageModel().getData();if(!i.length){return}var o=i.filter(function(t){return t.validation===true});if(!o.length){return}var n=t.getParameter("runtimeDeltaData").columns.columnsItems.filter(function(t){return t.visible===false});n.forEach(function(t){const o=this._getColumnByKey(t.columnKey);const a=this._oTemplate.getCells()[this._oTable.indexOfColumn(o)];let n;if(a.isA("sap.ui.comp.SmartToggle")){var s=a.getEdit();n=s.getId()}else{n=a.getId()}if(n){var r=i.find(function(t){return t.getControlId()?.includes(n)});if(r){var l=e.getElementById(r.getControlId());if(l){l.setBindingContext(null)}}}},this)};At.prototype._updateSortIndicator=function(t,e,i){var o=this._getSortItemsFromVariant();var a=o.find(function(t){return!!e&&t.sortProperty===e});if(a){if(i){t.setSortIndicator(a.operation)}else{t.setSorted(true);t.setSortOrder(a.operation)}return true}if(!t.data("p13nData").sorted){if(i){t.setSortIndicator(Dt.None)}else{t.setSorted(false);t.setSortOrder(Dt.None)}}return false};At.prototype._getSortItemsFromVariant=function(){var t,e=[];if(this._oCurrentVariant.sort&&this._oCurrentVariant.sort.sortItems){this._oCurrentVariant.sort.sortItems.forEach(function(i){t=this._getColumnSortProperty(this._getColumnFromP13nMap(i.columnKey));if(t){e.push({sortProperty:t,operation:i.operation})}},this)}return e};At.prototype._adaptAdditionalProperties=function(t){const e=this._isOfType(Bt.ResponsiveTable);var i=t.data("p13nData"),o;if(i.unit||i.displayBehaviour!=="descriptionOnly"){o=this._getColumnSortProperty(t);this._updateSortIndicator(t,o,e)}if(i.displayBehaviour!=="idOnly"&&i.description){const a=this._getColumnFromP13nMap(i.description);if(this._getColumnSortProperty(a)){o=i.description;this._updateSortIndicator(t,o,e)}}if(i.unit){const a=this._getColumnFromP13nMap(i.unit);if(this._getColumnSortProperty(a)){o=i.unit;this._updateSortIndicator(t,o,e)}}if(i.additionalProperty&&i.additionalSortProperty){const o=i.additionalProperty.split(",");const a=i.additionalSortProperty.split(",");a.every(function(i){if(o.indexOf(i)===-1){return false}return!this._updateSortIndicator(t,i,e)}.bind(this))}};At.prototype._updateColumnInfoSort=function(t,e){if(t){if(!e.sorted){e.sorted={ascending:false}}if(t.operation===Dt.None){delete e.sorted}else{e.sorted={ascending:t.operation!==Dt.Descending}}}else if(e&&e.sorted){e.sorted=null}};At.prototype._updateColumnInfoGroup=function(t,e){e.grouped=t?true:false};At.prototype._adaptCustomSort=function(){if(this._oCurrentVariant){var t,e,i;var o=this._getSortItemsFromVariant();this._oTable.getColumns().forEach(function(a){e=a.data("p13nData");t=e&&e.sortProperty;if(t){if(o.length){i=o.find(function(e){return t===e.sortProperty})}this._updateColumnInfoSort(i,e);this._updateSortIndicator(a,t,this._isOfType(Bt.ResponsiveTable))}this._adaptAdditionalProperties(a)},this)}};At.prototype._adaptCustomGroup=function(){if(this._oCurrentVariant){var t,e,i,o;if(this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){o=this._oCurrentVariant.group.groupItems}this._oTable.getColumns().forEach(function(a){e=a.data("p13nData");t=e&&e.sortProperty;if(t){if(o){i=o.find(e=>t===this._getColumnByKey(e.columnKey)?.data("p13nData")?.sortProperty)}this._updateColumnInfoGroup(i,e)}},this)}};At.prototype.setUseInfoToolbar=function(t){this.setProperty("useInfoToolbar",t,true);if(this.getTable()){this._createInfoToolbar()}return this};At.prototype._updateInfoToolbar=function(t){if(!this._oInfoToolbar){this._oInfoToolbar=new b({active:true,visible:true,design:It.Info,content:[new _({id:this.getId()+"-infoToolbarText",text:t,wrapping:false}),new T,new et({id:this.getId()+"-infoToolbarClearButton",icon:"sap-icon://decline",type:vt.Transparent,press:[this._handleClearAllFilterButtonPress,this],tooltip:i.getResourceBundleFor("sap.ui.mdc").getText("infobar.REMOVEALLFILTERS")})],ariaLabelledBy:this.getId()+"-infoToolbarText",press:[this._handleInfoToolbarPress,this]})}else{this._oInfoToolbar.setVisible(true);this._oInfoToolbar.getContent()[0].setText(t)}};At.prototype._handleInfoToolbarPress=function(t){this._showTableFilterDialog()};At.prototype._handleClearAllFilterButtonPress=function(){var t=this._oPersController;var e=t.getDataSuiteFormatSnapshot();e=e||{};e.SelectOptions=undefined;t.setPersonalizationDataAsDataSuiteFormat(e,false);this._updateP13nDialogSettings()};At.prototype._createInfoToolbar=function(){var t=this.getUseInfoToolbar(),e=this.getTable(),o=this.getId()+"-infoToolbarText",a,n=i.getResourceBundleFor("sap.ui.comp");var r=this._oCurrentVariant?.filter?.filterItems;var l=r&&r.length;if(t===Ft.Off||!this._isOfType(Bt.ResponsiveTable)&&t===Ft.Auto){if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);e.removeAriaLabelledBy(o)}this._aFilteredColumnsBeforePersonalisationDataChange?.forEach(t=>{a=this._getColumnByKey(t.columnKey);a?.setFiltered?.(false)});if(l){r.forEach(t=>{a=this._getColumnByKey(t.columnKey);a?.setFiltered?.(true)})}return}var u,h;if(this._isOfType(Bt.ResponsiveTable)){u=e.getInfoToolbar();h=e.setInfoToolbar}else{u=e.getExtension().find(t=>t.getDesign&&t.getDesign()===It.Info);h=e.addExtension}if(u&&!this._oInfoToolbar){$.error(`Custom infoToolbar is used, hence set useInfoToolbar property on the SmartTable with id="${this.getId()}" to Off`);return}if(l){var p=[],d=s.getInstance();r.forEach(function(t){a=this._getColumnByKey(t.columnKey);if(a){var e=this._getColumnLabel(t.columnKey);if(e&&p.indexOf(e)===-1){p.push(e)}if(!this._isOfType(Bt.ResponsiveTable)&&a.setFiltered){a.setFiltered(false)}}},this);var f=n.getText("SMARTTABLE_INFOTOOLBAR_FILTER"+(p.length>1?"S":"")+"_ACTIVE",[p.length,d.format(p)]);this._updateInfoToolbar(f);if(!u){h.call(e,this._oInfoToolbar)}if(e.getAriaLabelledBy().indexOf(o)===-1){e.addAriaLabelledBy(o)}}else if(this._oInfoToolbar&&this._oInfoToolbar.getVisible()){this._oInfoToolbar.setVisible(false);e.removeAriaLabelledBy(o)}};At.prototype._getChangeStatus=function(t){if(!t){return"ModelChanged"}if(t.sort==="ModelChanged"||t.filter==="ModelChanged"||t.columns==="ModelChanged"||t.group==="ModelChanged"){return"ModelChanged"}if(t.sort==="TableChanged"||t.filter==="TableChanged"||t.columns==="TableChanged"||t.group==="TableChanged"){return"TableChanged"}return"Unchanged"};At.prototype._getDateFormatSettings=function(){if(this._oTableProvider&&this._oTableProvider._oDateFormatSettings){return this._oTableProvider._oDateFormatSettings}return undefined};At.prototype._getTablePersonalisationData=function(){this._mSelectExpandForGroup=null;if(!this._oCurrentVariant){return null}var t=[],e=[],i=[],o,a,n,s,r,p,d,f,g,c,_={},m={},b="",y;if(this._isOfType(Bt.ResponsiveTable)&&this._oCurrentVariant.group&&this._oCurrentVariant.group.groupItems){a=this._oCurrentVariant.group.groupItems[0];if(this._aDeactivatedColumns.indexOf(a.columnKey)<0){r=this._getColumnByKey(a.columnKey);if(r){b=r.getHeader().getText()}c=this._getPathFromColumnKeyAndProperty(a.columnKey,"sortProperty")}if(c){d=c;f=null;var T=this._mFieldMetadataByKey[a.columnKey],C;if(T){f=T.unit||T.description;var S=this.getModel(),v=S&&S.getMetaModel();C=W.getInlineGroupFormatterFunction(T,false,this._getDateFormatSettings(),this._bPreserveDecimals,true,v)}n=new D(d,a.operation==="GroupDescending",function(t){var e=t.getProperty(d),i;if(C){if(f){i=t.getProperty(f)}e=C(e,i)}if(e===undefined||e===null){e=""}return{key:e,text:b?b+": "+e:e}});this._mSelectExpandForGroup={select:[d]};if(T){if(T.additionalProperty){this._mSelectExpandForGroup.select.push(T.additionalProperty)}if(T.navigationProperty){this._mSelectExpandForGroup.expand=[T.navigationProperty]}}t.push(n)}}if(this._oCurrentVariant.sort){s=this._oCurrentVariant.sort.sortItems}else{s=this._aInitialSorters}if(s){s.forEach(function(e,i){var o=e.operation==="Descending";c=null;g=null;if(this._aDeactivatedColumns.indexOf(e.columnKey)<0){c=this._getPathFromColumnKeyAndProperty(e.columnKey,"sortProperty");if(!c&&e.initiallyNotVisibleColumn){c=e.columnKey}}if(c){if(n&&n.sPath===c){n.bDescending=o}else{var a=this._mFieldMetadataByKey[c];if(!a){r=this._getColumnByKey(e.columnKey);p=r?.data("p13nData")}if(this._bMultiUnitBehaviorEnabled&&(a?.isCurrencyField||p?.isCurrency)){g=a?a.unit:p.unit;var s=this._mFieldMetadataByKey[g];var l,u;if(!s){l=this._getColumnByKey(g);u=l?.data("p13nData")}if(g&&(s?.sortable||u?.sortProperty===g||l?.getSortProperty?.()===g)&&!_[g]){_[g]={index:i,descending:o}}}m[c]={};if(m[g]){delete _[g]}else if(_[c]){delete _[c]}t.push(new D(c,o))}}},this);var P=Object.keys(_),I;if(P.length){P.reverse().forEach(function(e){I=n?_[e].index+1:_[e].index;t.splice(I,0,new D(e,_[e].descending))})}}if(this._oCurrentVariant.filter){this._oCurrentVariant.filter.filterItems.forEach(function(t){var o=t.value1,a=t.value2,n;if(t.conditionTypeInfo){const e=N._calculateDateRangeValues({columnKey:t.columnKey,dateFormatSettings:this._getDateFormatSettings(),conditionTypeInfo:t.conditionTypeInfo.data,fieldViewMetadata:this._oTableProvider.getFieldMetadata(t.columnKey)});if(e){o=e.oValue1;a=e.oValue2}}c=null;y=false;r=null;if(this._aDeactivatedColumns.indexOf(t.columnKey)<0){r=this._getColumnByKey(t.columnKey)}if(r){if(r.getFilterProperty){c=r.getFilterProperty()}p=r.data("p13nData");if(p){y=p.type==="time";if(!c){c=p["filterProperty"]}}}if(c){let r;const b=p?.typeInstance?.getName()==="sap.ui.model.odata.type.DateTimeOffset";try{r=this._oTableProvider&&this._oTableProvider.getFieldMetadata(c)}catch(t){}if(y){if(o instanceof Date){o=W.getEdmTimeFromDate(o)}if(a instanceof Date){a=W.getEdmTimeFromDate(a)}}else{if(o instanceof Date&&!b&&this._oTableProvider&&this._oTableProvider.getIsUTCDateHandlingEnabled()){o=l.localToUtc(o);if(a){var s=parseInt(r?.precision);a=l.localToUtc(a);a=l.adaptPrecision(a,s)}}if(b&&(r.filterRestriction=="interval"||r.filterRestriction=="auto")){if(t.operation==="EQ"||t.operation==="BT"){t.operation="BT";a=a?a:St.getInstance(o);a.setMilliseconds(999)}else if(t.operation==="LE"){o.setMilliseconds(999)}}if(b&&!this._oTableProvider.getIsUTCDateHandlingEnabled()){o=l.toTimezone(o,h.INTL_TIMEZONE);a=l.toTimezone(a,h.INTL_TIMEZONE)}if(r){o=h.adaptTime(o,r);a=h.adaptTime(a,r)}}var d=t.exclude?i:e;if(t.operation==="Empty"||t?.conditionTypeInfo?.data?.operation==="NODATE"){var f=t.exclude?F.NE:F.EQ,g=false,_=false;if(p.nullable===true||p.nullable==="true"){_=true}else if(p.nullable===undefined&&r&&r.nullable!=="false"){_=true}if(p.edmType==="Edm.String"||p.type==="string"){g=true}else if(!p.edmType&&!p.type&&r&&r.type==="Edm.String"){g=true}if(g){d.push(new x(c,f,""))}if(_){d.push(new x(c,f,null))}}else{n=t.exclude?u.getTransformedExcludeOperation(t.operation):t.operation;var m=new x(c,n,o,a);if(b&&r){m=W.adaptMilliseconds(m,r.precision,n)}d.push(m)}}},this);if(i.length){o=new x(i,true)}}return{filters:e,excludeFilters:o,sorters:t}};At.prototype._getColumnByKey=function(t){return this.getTable()?.getColumns().find(e=>e.data("p13nData")?.columnKey===t)};At.prototype._getColumnFromP13nMap=function(t){if(!this._oPersController){return null}const e=this._oPersController.getColumnMap();let i=null;for(const o in e){if(o===t){i=e[o];break}else if(e[o].getLeadingProperty&&e[o].getLeadingProperty()===t){i=e[o];break}else if(e[o].data("p13nData").leadingProperty===t){i=e[o];break}}return i};At.prototype._getPathFromColumnKeyAndProperty=function(t,e){var i=null,o,a;o=this._getColumnByKey(t)||this._getColumnFromP13nMap(t);if(o){if(e=="sortProperty"&&o.getSortProperty){i=o.getSortProperty()}else if(e=="filterProperty"&&o.getFilterProperty){i=o.getFilterProperty()}else if(e=="leadingProperty"&&o.getLeadingProperty){i=o.getLeadingProperty()}if(!i){a=o.data("p13nData");if(a){i=a[e]}}}return i};At.prototype._persistPersonalisation=function(){var t="Personalisation";if(!yt.isDesignModeEnabled()&&this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){var e=this._oVariantManagement.getViewIdByName(t);if(e===null){e=this.getCurrentVariantId()}if(!this._bSaving){this._bSaving=true;this._oVariantManagement.fireSave({name:t,implicit:true,global:false,overwrite:!!e,key:e,def:true});delete this._bSaving}}};At.prototype.getCurrentVariantId=function(){return this._oVariantManagement?this._oVariantManagement.getCurrentVariantId():""};At.prototype.setCurrentVariantId=function(t){if(this._oVariantManagement&&!this._oVariantManagement.isPageVariant()){this._oVariantManagement.setCurrentVariantId(t)}else{$.error("sap.ui.comp.smarttable.SmartTable.prototype.setCurrentVariantId: VariantManagement does not exist, or is a page variant")}return this};At.prototype.setDetailsButtonSetting=function(t){this.setProperty("detailsButtonSetting",t,true);return this};At.prototype.setEnablePaste=function(t){this.setProperty("enablePaste",t,true);var i=e.getElementById(this.getId()+"-btnPaste");if(i){i.setEnabled(this.getEnablePaste())}return this};At.prototype.isInitialised=function(){return!!this.bIsInitialised};At.prototype._aAvailablePanels=["Columns","Sort","Filter","Group"];At.prototype.openPersonalisationDialog=function(t){if(!t||this._aAvailablePanels.indexOf(t)<0){$.warning("sap.ui.comp.smarttable.SmartTable.prototype.openPersonalisationDialog: "+t+" is not a valid panel!");return}if(this._oPersController){var e={useAvailablePanels:false};e[t.toLowerCase()]={visible:true,payload:undefined};this._oPersController.openDialog(e)}};At.prototype.deactivateColumns=function(t){this._aDeactivatedColumns=t||[];this._bDeactivatingColumns=true;if(this._oPersController){this._oPersController.addToSettingIgnoreColumnKeys(this._aDeactivatedColumns)}this._bDeactivatingColumns=false};At.prototype.getDeactivatedColumns=function(){return this._aDeactivatedColumns?this._aDeactivatedColumns.slice():[]};At.prototype._onInnerTablePaste=function(t){if(!this.getEnablePaste()||!this.hasListeners("beforePaste")&&!this.hasListeners("paste")){return}var e=t.getParameter("data");var i=e.slice(0);var o=this._getColumnInfoForPaste();if(this.fireBeforePaste({columnInfos:o,rawData:i})){sap.ui.require(["sap/ui/core/util/PasteHelper"],function(t){t.parse(i,o).then(t=>{this.firePaste({result:t})})}.bind(this))}};At.prototype._getColumnInfoForPaste=function(){var t=[],e=[],i=this._oTable.getColumns(),o,a=i.length,n,s,r,l,u,h,p,d;if(this._isOfType(Bt.ResponsiveTable)&&i.length){i=i.sort(function(t,e){return t.getOrder()-e.getOrder()})}for(o=0;o<a;o++){n=i[o];r=null;h=null;u=null;p=true;if(n.getVisible()){s=n.data("p13nData");if(s.displayBehaviour==="descriptionOnly"&&s.description){r=s.description;u=this._oTableProvider?.getFieldMetadata(r)?.modelType}else{r=this._getColumnLeadingProperty(n,s)}l=s.type==="numeric"?"number":s.type;p=!r||s.ignorePaste;d=s.customParseFunction;if(s.type==="date"){var f=this._getDateFormatSettings();if(f&&f["UTC"]){var g={displayFormat:"Date"};u=z.getType("Edm.DateTime",f,g)}}if(!u){u=s["typeInstance"]||this._oTableProvider?.getFieldMetadata(r)?.modelType}if(s.isCurrency||l==="number"){h=s.unit}else if(s.description&&s.displayBehaviour!=="idOnly"&&s.displayBehaviour!=="descriptionOnly"){h=s.description}}var c={columnId:n.getId(),property:r,ignore:p,type:u,customParseFunction:d};if(r){t.push(c)}else{e.push(c)}u=z.getType("Edm.String");if(h){t.push({columnId:n.getId(),additionalProperty:true,property:h,type:u})}}return t.concat(e)};At.prototype._getSemanticObjectBindingPaths=function(t){if(!t||!t.length){return t}var e=[];t.forEach(function(i){var o=this._aTableViewMetadata&&this._aTableViewMetadata.find(function(t){return t.name==i});if(o&&o.semanticObjectPath){if(!t.includes(o.semanticObjectPath)){e.push(o.semanticObjectPath)}}},this);return t.concat(e)};At.prototype._isOfType=function(t){return this.getTableType()===t};At.prototype.exit=function(){var t,e;this.detachEvent("_change",this._onPropertyChange,this);if(this._oSmartFilter){this._oSmartFilter.detachSearch(this._reBindTable,this);this._oSmartFilter.detachFilterChange(this._filterChangeEvent,this);this._oSmartFilter=null}this._oTableProvider?.destroy?.();this._oTableProvider=null;this._oPersController?.destroy?.();this._oPersController=null;if(this._oVariantManagement){this._oVariantManagement.detachSave(this._variantSaved,this);this._oVariantManagement.detachAfterSave(this._variantAfterSave,this);if(!this._oVariantManagement.isPageVariant()&&this._oVariantManagement.destroy){this._oVariantManagement.destroy()}}this._oNumberFormatInstance=null;H.cleanUpFullScreen(this);this._oEditModel?.destroy();this._oEditModel=null;this._oNoData?.destroy?.();this._oNoData=null;if(this._aTableViewMetadata){t=this._aTableViewMetadata.length;while(t--){e=this._aTableViewMetadata[t];if(e&&!e.isColumnCreated&&e.template){e.template.destroy()}}}this._oShowHideDetailsButton?.destroy();this._oShowHideDetailsButton=null;this._aTableViewMetadata=null;this._mFieldMetadataByKey=null;this._mSelectExpandForGroup=null;this._oVariantManagement=null;this._oCurrentVariant=null;this._aExistingColumns=null;this._mLazyColumnMap=null;this._aColumnKeys=null;this._aDeactivatedColumns=null;this._aAlwaysSelect=null;this._oCustomToolbar=null;if(this._oToolbar&&!this._bToolbarInsertedIntoItems){this._oToolbar.destroy()}this._oToolbar=null;this._oSeparator?.destroy();this._oSeparator=null;this._oExportButton?.destroy();this._oExportButton=null;this._oExportHandler?.destroy();this._oExportHandler=null;this._oTablePersonalisationButton?.destroy();this._oTablePersonalisationButton=null;this._oP13nDialogSettings=null;this._oTemplate?.destroy();this._oTemplate=null;this._oColumnMenu?.destroy();this._oColumnMenu=null;this._oCopyProvider?.destroy();this._oCopyProvider=null;this._oCellSelector?.destroy();this._oCellSelector=null;this._bMissingColumnsCreated=null;this._oInfoToolbar=null;this._oTableReady=null;this._oView=null;this._oTable=null};return At});
//# sourceMappingURL=SmartTable.js.map