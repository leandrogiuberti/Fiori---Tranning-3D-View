/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/base/Object","./Constants"],function(t,e){"use strict";var i;var n=t.extend("sap.ui.comp.historyvalues.HistoryGlobalDataService",{constructor:function(){t.apply(this,arguments);this._initialize()}});n.prototype._initialize=function(){this._initializeHistoryData=this._initializeHistoryData.bind(this);this._sContainerId=e.getHistoryPrefix()+"HistorySettings";this._sItemId=e.getHistoryPrefix()+"settings";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=this._getPersonalizer().then(t=>t.getPersData()).then(this._initializeHistoryData)};n.prototype._initializeHistoryData=function(t){this._oData=t||this._getDefaultData();return Object.assign({},this._oData)};n.prototype._getPersonalizer=function(){if(this._oPersonalizer){return Promise.resolve(this._oPersonalizer)}const t=sap.ui.require("sap/ushell/Container");return t.getServiceAsync("PersonalizationV2").then(async t=>{const e={keyCategory:t.constants.keyCategory.FIXED_KEY,writeFrequency:t.constants.writeFrequency.LOW,clientStorageAllowed:false,validity:Infinity},i={container:this._sContainerId,item:this._sItemId};this._oPersonalizer=await t.getPersonalizer(i,e);return this._oPersonalizer})};n.prototype._getDefaultData=function(){return{historyEnabled:true,apps:{}}};n.prototype._isDataReady=function(){return this._oDataReadyPromise};n.prototype.getHistoryEnabled=function(){return this._isDataReady().then(function(){return this._oData.historyEnabled}.bind(this))};n.prototype.setHistoryEnabled=function(t){return this._isDataReady().then(function(){this._oData.historyEnabled=t;return this._getPersonalizer().then(t=>t.setPersData(this._oData))}.bind(this))};n.prototype.getApps=function(){return this._isDataReady().then(function(){return Object.assign({},this._oData.apps)}.bind(this))};n.prototype.setApps=function(t){return this._isDataReady().then(function(){this._oData.apps=t;return this._getPersonalizer().then(t=>t.setPersData(this._oData))}.bind(this))};n.prototype.deleteHistory=function(){return this._isDataReady().then(function(){var t=this._oData,e=t.apps,i=sap.ui.require("sap/ushell/Container");return i.getServiceAsync("PersonalizationV2").then(t=>{const i=Object.values(e).map(function(e){return t.deleteContainer(e)});return Promise.all(i)})}.bind(this))};n.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._sContainerId="";this._sItemId="";this._oPersonalizer=null;this._oData={};this._oDataReadyPromise=null};return{getInstance:function(){if(!i){i=new n}return Promise.resolve(i)}}});
//# sourceMappingURL=HistoryGlobalDataService.js.map