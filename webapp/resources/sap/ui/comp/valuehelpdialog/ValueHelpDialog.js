/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/ControlBehavior","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/core/date/UI5Date","sap/base/Log","sap/ui/comp/library","sap/m/Dialog","sap/m/MessageBox","sap/m/Token","./ItemsCollection","sap/ui/core/library","sap/m/VBox","sap/m/HBox","sap/m/FlexBox","sap/ui/comp/util/FormatUtil","sap/m/FlexItemData","sap/m/Title","sap/m/Text","sap/m/Label","sap/m/Button","sap/m/Bar","sap/m/OverflowToolbarLayoutData","sap/m/Tokenizer","sap/m/Panel","sap/m/StandardListItem","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/library","sap/ui/core/InvisibleText","sap/ui/core/InvisibleMessage","sap/ui/core/IconPool","sap/ui/table/library","sap/ui/table/Table","sap/ui/table/Column","sap/ui/table/rowmodes/Type","sap/ui/table/rowmodes/Auto","sap/m/Table","sap/m/Column","sap/m/table/columnmenu/Menu","sap/m/table/columnmenu/QuickSort","sap/m/table/columnmenu/QuickSortItem","sap/ui/layout/HorizontalLayout","sap/ui/layout/Grid","sap/ui/Device","sap/m/List","sap/m/Link","sap/ui/comp/p13n/P13nFilterPanel","sap/ui/comp/p13n/P13nConditionPanel","sap/ui/comp/p13n/P13nItem","sap/ui/comp/p13n/P13nAnyFilterItem","sap/m/CheckBox","sap/ui/comp/p13n/P13nOperationsHelper","sap/ui/core/format/NumberFormat","sap/ui/core/ResizeHandler","sap/base/strings/whitespaceReplacer","sap/ui/table/plugins/MultiSelectionPlugin","sap/ui/comp/rules/RulesLog","sap/m/Toolbar","sap/ui/core/util/ResponsivePaddingsEnablement","sap/m/plugins/CellSelector","sap/m/ToolbarSpacer","sap/m/OverflowToolbar","sap/m/plugins/CopyProvider","sap/ui/model/Sorter","sap/ui/model/Filter","sap/ui/model/FilterOperator"],function(e,t,i,s,a,o,n,l,r,h,u,_,d,c,g,p,f,T,b,S,m,y,I,v,C,E,B,R,k,P,L,V,F,D,x,A,O,w,M,N,H,K,z,G,U,W,j,$,J,q,Q,Z,X,Y,ee,te,ie,se,ae,oe,ne,le,re,he,ue,_e){"use strict";var de;var ce;var ge=R.ButtonType;var pe=R.OverflowToolbarPriority;var fe=R.ListMode;var Te=R.ListType;var be=u.HorizontalAlign;var Se=u.InvisibleMessageMode;var me=u.TitleLevel;var ye=o.smartfilterbar.DisplayBehaviour;var Ie=u.ValueState;var ve=o.ValueHelpDeprecationCode;var Ce={DESKTOP_LIST_VIEW:"DESKTOP_LIST_VIEW",DESKTOP_CONDITIONS_VIEW:"DESKTOP_CONDITIONS_VIEW",PHONE_MAIN_VIEW:"PHONE_MAIN_VIEW",PHONE_SEARCH_VIEW:"PHONE_SEARCH_VIEW",PHONE_LIST_VIEW:"PHONE_LIST_VIEW",PHONE_CONDITIONS_VIEW:"PHONE_CONDITIONS_VIEW"};var Ee=n.extend("sap.ui.comp.valuehelpdialog.ValueHelpDialog",{metadata:{library:"sap.ui.comp",properties:{basicSearchText:{type:"string",group:"Misc",defaultValue:""},supportMultiselect:{type:"boolean",group:"Misc",defaultValue:true},supportRanges:{type:"boolean",group:"Misc",defaultValue:false},supportRangesOnly:{type:"boolean",group:"Misc",defaultValue:false},key:{type:"string",group:"Misc",defaultValue:""},keys:{type:"string[]",group:"Misc",defaultValue:null},descriptionKey:{type:"string",group:"Misc",defaultValue:""},maxIncludeRanges:{type:"string",group:"Misc",defaultValue:"-1",deprecated:true},maxExcludeRanges:{type:"string",group:"Misc",defaultValue:"-1",deprecated:true},maxConditions:{type:"string",group:"Misc",defaultValue:"-1"},displayFormat:{type:"string",group:"Misc",defaultValue:""},tokenDisplayBehaviour:{type:"string",group:"Misc",defaultValue:""},filterMode:{type:"boolean",group:"Misc",defaultValue:false},_enhancedExcludeOperations:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"},conditionPanelDefaultOperation:{type:"string",group:"Misc",defaultValue:null},enabledMultiSelectionPlugin:{type:"boolean",group:"Misc",defaultValue:false},_conditionPanelCalendarWeekSettings:{type:"string",group:"Misc",defaultValue:"",visibility:"hidden"},_conditionPanelShowCurrentDateButton:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"}},aggregations:{filterBar:{type:"sap.ui.comp.filterbar.FilterBar",multiple:false}},events:{ok:{parameters:{tokens:{type:"sap.m.Token[]"}}},cancel:{},selectionChange:{parameters:{tableSelectionParams:{type:"object"},updateTokens:{type:"object[]"},useDefault:{type:"boolean"},table:{type:"object"}}},tokenRemove:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean"}}},updateSelection:{parameters:{tokenKeys:{type:"string[]"},useDefault:{type:"boolean"}}}}},renderer:{apiVersion:2}});ae.call(Ee.prototype,{header:{suffix:"header"},subHeader:{selector:".compVHNavigationContainer .sapMITH"},content:{selector:".compVHContentContainer"},footer:{selector:".sapMDialogFooter .sapMIBar"}});Ee.prototype.setSupportMultiselect=function(e){this.setProperty("supportMultiselect",e);this._updatePropertySupportMultiselect(e);this._oTokenizerGrid.setVisible(e);this._oButtonOk.setVisible(e);return this};Ee.prototype._updatePropertySupportMultiselect=function(e){if(!this._oTable){return undefined}if(!this._isPhone()){if(this._oTable.setSelectionMode){this._oTable.setSelectionMode(e?V.SelectionMode.MultiToggle:V.SelectionMode.Single)}}else if(this._oTable.setMode){this._oTable.setMode(e?fe.MultiSelect:fe.SingleSelectLeft)}return this};Ee.prototype.setSupportRanges=function(e){this.setProperty("supportRanges",e);this._updateNavigationControl();return this};Ee.prototype.setSupportRangesOnly=function(e){this.setProperty("supportRangesOnly",e);this._updateNavigationControl();return this};Ee.prototype.setTitle=function(e){this.setProperty("title",e);this._updateDlgTitle();return this};Ee.prototype.setFilterBar=function(e){this.setAggregation("filterBar",e);if(this._oMainLayout&&e){if(this._isPhone()){if(this._oFilterBar){this._oContentContainer.removeItem(this._oFilterBar);this._oFilterBar.detachInitialise(this._handleFilterBarInitialize)}}else if(this._oFilterBar){this._oMainLayout.removeItem(this._oFilterBar);this._oFilterBar.detachInitialise(this._handleFilterBarInitialize)}this._oFilterBar=e;this._oFilterBar.attachInitialise(this._handleFilterBarInitialize,this);if(this._oFilterBar){this._oFilterBar.addStyleClass("compVHSearch");if(this._isPhone()){var i=t.getElementById(this._oFilterBar.getBasicSearch());if(i&&i.isA("sap.m.SearchField")){i.setShowSearchButton(true);i.attachSearch(function(e){if(e.mParameters.refreshButtonPressed!==undefined){this.getFilterBar().search()}}.bind(this))}this._oFilterBar.setShowGoOnFB(false);this._oColSearchBox.setLayoutData(new p({shrinkFactor:0}));this._oContentContainer.insertItem(this._oColSearchBox,0);this._oFilterBar.setLayoutData(new p({shrinkFactor:0}));this._oContentContainer.insertItem(this._oFilterBar,1);this._oFilterBar.attachSearch(function(e){this._updateView(Ce.PHONE_LIST_VIEW)}.bind(this));if(this._currentViewMode===Ce.PHONE_LIST_VIEW){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false);this._handleFilterBarInitialize()}}else{this._oFilterBar._setCollectiveSearch(this._oColSearchBox);this._oMainLayout.insertItem(this._oFilterBar,0)}}if(ke(this._oTabBar)&&this._oFilterBar?._oBasicSearchField?.getValueState?.()!==Ie.Error){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar.getAggregation("_searchButton")){this.setInitialFocus(this._oFilterBar.getAggregation("_searchButton"))}if(this._oFilterBar._oBasicSearchField){var s=this._oFilterBar._oBasicSearchField;s.setValue(this.getBasicSearchText());if(!ke(this._oTabBar)){this.setInitialFocus(s)}}}return this};Ee.prototype._handleFilterBarInitialize=function(){if(this._currentViewMode===Ce.PHONE_LIST_VIEW){var e=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(e);this._oFilterBar.setShowGoOnFB(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()))}this._setToolbarSpacerWidth();if(ke(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this.setInitialFocus(this._oFilterBar._oBasicSearchField)}};Ee.prototype.getFilterBar=function(){return this._oFilterBar};Ee.prototype.setBasicSearchText=function(e){this.setProperty("basicSearchText",e);if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this._oFilterBar._oBasicSearchField.setValue(e)}return this};Ee.prototype.setTokens=function(e){var t=true;if(e.length){var i=0,s;for(var o=0;o<e.length;o++){var n=e[o];if(n.data("range")){var l=Object.assign({},n.data("range"));s=n.getKey();if(!s){do{s="range_"+i;i++}while(this._oSelectedRanges[s])}var h=this._getFormatedRangeTokenText(l.operation,l.value1,l.value2,l.exclude,l.keyField);this._addToken2Tokenizer(s,h,this._getTokenizer(),l.keyField);this._oSelectedRanges[s]=l;t=false}else{s=n.getKey();var u=n.getText();var _=n.data("longKey");var d=n.data("compositeKey");var c=n.data("row");if(!_){_=s}var p=new r(Re.call(this,_));if(!d){d=g._extractCompositeKey(_)}let e;if(typeof d==="object"&&Object.keys(d).length>0&&this.getKeys()?.length>1){try{e=JSON.stringify(d)}catch(e){a.error(`JSON.stringify throws an exception: ${e.message}`)}}e=e?e:_;p.setKey(e);this._oSelectedItems.add(e,c?c:n.getText());p.setText(u);p.setTooltip(u);this._getTokenizer().addToken(p)}}}else{this._oSelectedItems.removeAll();this._oSelectedRanges={};this._getTokenizer().destroyTokens()}if(t){this._updateTokenizer()}};Ee.prototype.open=function(){var e,t,i,s,a;if(!this._oTable&&!(this._isPhone()&&(this.getSupportRangesOnly()||this.getFilterMode()))){return Be.call(this).then(function(){return this.open()}.bind(this))}this._bIgnoreSelectionChange=false;if(this._oColSearchBox){this._bIsMdcCollectiveSearch=this._oColSearchBox.isA("sap.ui.mdc.valuehelp.CollectiveSearchSelect");if(this._bIsMdcCollectiveSearch){this.bCollectiveSearchActive=this._oColSearchBox.getVisible()}else{this.bCollectiveSearchActive=this.oSelectionTitle.getVisible()&&this.oSelectionButton.getVisible();this._oColSearchBox.setVisible(this.bCollectiveSearchActive)}}if(!this._isPhone()){if(this.getSupportRangesOnly()||this.getFilterMode()){this._updateView(Ce.DESKTOP_CONDITIONS_VIEW)}if(this.isPropertyInitial("contentWidth")){this.setContentWidth(this._getDefaultContentWidth())}}else{this._updateView(Ce.PHONE_MAIN_VIEW)}this.addStyleClass("sapUiResponsivePadding--header sapUiResponsivePadding--subHeader sapUiResponsivePadding--content sapUiResponsivePadding--footer");n.prototype.open.apply(this);if(ke(this._oTabBar)){this.setInitialFocus(this._oTabBar.getItems()[0])}else if(this._oFilterBar&&this._oFilterBar._oBasicSearchField){this.setInitialFocus(this._oFilterBar._oBasicSearchField)}else if(!this._oFilterBar&&this._currentViewMode==="DESKTOP_CONDITIONS_VIEW"){if(this._oFilterPanel){e=this._oFilterPanel&&this._oFilterPanel._oConditionPanel;t=e&&e._oConditionsGrid;i=t&&t.getAggregation("content")[0];s=t&&i.operation;if(s&&s.getEnabled()){this.setInitialFocus(s)}else{a=i.value1;this.setInitialFocus(a)}}}return this};Ee.prototype.getTable=function(){a.warning("Please use getTableAsync to prevent synchronous calls.",this);if(!this._oTable){this._createDefaultTable()}return this._oTable};Ee.prototype.getTableAsync=function(){if(this._oTablePromise){return this._oTablePromise}else if(!this._oTable){return Be.call(this)}else{return new Promise(function(e){e(this._oTable)}.bind(this))}};Ee.prototype._handleSmartTable=function(e){e.attachBeforeRebindTable(function(){var t=e.getTable();if(t&&t.isA("sap.ui.table.Table")){t.attachEventOnce("rowsUpdated",this._updateTableTitle.bind(this))}}.bind(this))};Ee.prototype.setTable=function(e){if(this._oTable){this._oMainLayout.removeItem(this._oTable);if(this._bTableCreatedInternal){this._oTable.destroy();this._oTable=null}}this._bTableCreatedInternal=arguments.length>1&&arguments[1]==true;if(e&&e.isA("sap.ui.comp.smarttable.SmartTable")){this._oTable=e.getTable();this._handleSmartTable(e)}else{this._oTable=e}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._oTable.setEnableBusyIndicator(true);if(this._oTable.isA("sap.ui.table.AnalyticalTable")){de=sap.ui.require("sap/ui/table/AnalyticalColumn")}}this._oTable.setLayoutData(new p({shrinkFactor:0,growFactor:1}));this.theTable=this._oTable;this._initializeTable();this._oMainLayout.addItem(e)};Ee.prototype._getDefaultContentWidth=function(){var e;if(G.system.desktop){e=1080}else if(G.system.tablet){if(G.orientation.landscape){e=920}else if(G.orientation.portrait){e=600}}return e+"px"};Ee.prototype.resetTableState=function(){if(this._oTable){if(this._oTable.unbindRows){this._oTable.unbindRows()}this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"))}};Ee.prototype._recreateTable=function(){this._oDefaultSmartTable&&this._oDefaultSmartTable.destroy();this._oTable&&this._oTable.destroy();this._oTablePromise=null;this._oDefaultSmartTable=null;this._oTable=null;this._initCopyProvider();return Be.call(this).then(()=>{if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){Pe(this._oTable,x.Auto)}return this._oTablePromise})};Ee.prototype.TableStateSearchData=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"))};Ee.prototype._updateNoDataText=function(e){if(this._oTable){if(this._oTable.setNoData){this._oTable.setNoData(e)}else if(this._oTable.setNoDataText){this._oTable.setNoDataText(e)}}};Ee.prototype.TableStateDataFilled=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_NODATA"))};Ee.prototype.TableStateDataSearching=function(){this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_SEARCHING"))};Ee.prototype.init=function(){n.prototype.init.apply(this);this._oTokenIdCount={};this._bTableCreatedInternal=false;this._aIncludeRangeOperations={};this._aExcludeRangeOperations={};this._iMaxIncludeRanges=-1;this._iMaxExcludeRanges=-1;this._bInitTokensHaveChanged;this.setStretch(this._isPhone());this.setResizable(!this._isPhone());this.setDraggable(!this._isPhone());this.bCollectiveSearchActive=false;this.addStyleClass("compValueHelpDialog");this._oRb=i.getResourceBundleFor("sap.ui.comp");this._sTableTitle1=this._oRb.getText("VALUEHELPDLG_TABLETITLE1");this._sTableTitle2=this._oRb.getText("VALUEHELPDLG_TABLETITLE2");this._sSmartTableTableTitle=this._oRb.getText("VALUEHELPDLG_TABLETITLE3");this._sTableTitleNoCount=this._oRb.getText("VALUEHELPDLG_TABLETITLENOCOUNT");this._currentViewMode=null;this._oSelectedItems=new h;this._oSelectedRanges={};this._oOperationsHelper=new Z;this._fnRejectTablePromise;this.update=this.update.bind(this);this._createHeaderBar();this._createCollectiveSearch();this._createTokenizer();this._updateTokenizer();this._oNavigationContainer=new _(this.getId()+"-navigationContainer",{width:"100%",layoutData:new p({growFactor:0,shrinkFactor:0})}).addStyleClass("compVHNavigationContainer");this._oContentContainer=new _(this.getId()+"-vbox",{width:"100%",height:"100%"}).addStyleClass("compVHContentContainer");this._oContainersWrapper=new c(this.getId()+"-containersWrapper",{alignItems:"Start",height:"100%",width:"100%",direction:"Column",justifyContent:"SpaceBetween",items:[this._oNavigationContainer,this._oContentContainer]});this.addContent(this._oContainersWrapper);this._oMainLayout=new _(this.getId()+"-mainLayout",{fitContainer:true,items:[this._oFilterBar],layoutData:new p({growFactor:1,shrinkFactor:0,styleClass:"mainLayout"})});this._createNavigationControl();this._updateNavigationControl();this._oContentContainer.addItem(this._oMainLayout);if(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode()){this._oContentContainer.addItem(this._oTokenizerGrid)}this._createFooterControls();this.setVerticalScrolling(false);this.setHorizontalScrolling(false);if(!G.system.desktop){this._oContentContainer.attachBrowserEvent("touchmove",function(e){e.setMarked()})}if(!this._isPhone()){this._updateView(Ce.DESKTOP_LIST_VIEW)}if(!this._oInvisibleMessage){this._oInvisibleMessage=P.getInstance()}this._oRulesLog=new ie;this._initCopyProvider();this._initResponsivePaddingsEnablement()};Ee.prototype._initCopyProvider=function(){this._oCopyProvider=new re({})};Ee.prototype._updateView=function(e){if(this._currentViewMode===e){return}switch(e){case Ce.DESKTOP_LIST_VIEW:this._validateRanges(function(){this._oTokenizerGrid.setVisible(this.getSupportMultiselect());this._oMainLayout.removeAllItems();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==Ce.DESKTOP_LIST_VIEW){this._oTabBar.setSelectedKey(Ce.DESKTOP_LIST_VIEW)}this._oMainLayout.addItem(this._oFilterBar);this._oMainLayout.addItem(this._oDefaultSmartTable||this._oTable);this._updateDlgTitle()}.bind(this),function(){this._oTabBar.setSelectedKey(Ce.DESKTOP_CONDITIONS_VIEW);this._updateView(Ce.DESKTOP_CONDITIONS_VIEW)}.bind(this));break;case Ce.DESKTOP_CONDITIONS_VIEW:if(this.getSupportRanges()){this._oMainLayout.removeAllItems();if(this._oTabBar&&this._oTabBar.getSelectedKey()!==Ce.DESKTOP_CONDITIONS_VIEW){this._oTabBar.setSelectedKey(Ce.DESKTOP_CONDITIONS_VIEW)}this._createAddRanges();this._oButtonOk.setVisible(this.getSupportRangesOnly()||this.getSupportMultiselect());this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false)}}break;case Ce.PHONE_MAIN_VIEW:this.setVerticalScrolling(false);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(true);this._updateNavigationControl();this._oAdvancedSearchLink.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false);this._oFilterBar.setFilterBarExpanded(false)}if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(this.getSupportMultiselect());if(!(this.getMaxIncludeRanges()==="-1"&&this.getMaxExcludeRanges()!=="0"&&!this.getFilterMode())){this._oTokenizerGrid.setVisible(false)}if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(false);this._bNoneMainView=false;if(!(this._oSelectItemLI.getVisible()&&this._oDefineConditionsLI.getVisible())){this._bNoneMainView=true;if(this._oSelectItemLI.getVisible()){this._updateView(Ce.PHONE_LIST_VIEW)}if(this._oDefineConditionsLI.getVisible()){this._updateView(Ce.PHONE_CONDITIONS_VIEW)}return}break;case Ce.PHONE_LIST_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(this.bCollectiveSearchActive);if(this._bIsMdcCollectiveSearch){this._oColSearchBox.addStyleClass("sapUiTinyMarginBegin");this._oColSearchBox.oVariantText.removeStyleClass("sapUiMdcCollectiveSearchSelectTextPhoneMaxWidth")}this._oMainListMenu.setVisible(false);if(this._oFilterBar){var t=this._oFilterBar&&this._oFilterBar.getFilterGroupItems()&&this._oFilterBar.getFilterGroupItems().length>0;this._oAdvancedSearchLink.setVisible(t);this._oFilterBar.setShowGoOnFB(!(this._oFilterBar&&this._oFilterBar.getBasicSearch()));this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(false)}if(this._oTable){this._oTable.setVisible(true)}this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(this.getSupportMultiselect());this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;case Ce.PHONE_SEARCH_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(true);this._oFilterBar.setFilterBarExpanded(true)}this._oAdvancedSearchLink.setVisible(false);if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(false);if(this._oRanges){this._oRanges.setVisible(false)}this._oButtonGo.setVisible(true);this._oButtonClear.setVisible(this._oFilterBar&&this._oFilterBar.getShowClearOnFB());this._oButtonOk.setVisible(false);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(true);break;case Ce.PHONE_CONDITIONS_VIEW:this.setVerticalScrolling(true);this._oColSearchBox.setVisible(false);this._oMainListMenu.setVisible(false);if(this._oFilterBar){this._oFilterBar.setVisible(false)}this._oAdvancedSearchLink.setVisible(false);if(this._oTable){this._oTable.setVisible(false)}this._oTokenizerGrid.setVisible(false);if(!this._oRanges){this._createAddRanges()}if(this._oRanges){this._oRanges.setVisible(true)}this._oButtonGo.setVisible(false);this._oButtonClear.setVisible(false);this._oButtonOk.setVisible(true);this._oButtonCancel.setVisible(true);this._oBackButton.setVisible(!this._bNoneMainView);break;default:break}if(this._oMainListMenu&&this._oContentContainer){(function(){this._oContentContainer.rerender()}).bind(this)()}this._currentViewMode=e;this._updateDlgTitle()};Ee.prototype._changeTableRowSelectionForKey=function(e,t){var i;var s=this._oTable;var a=s;if(this._isMultiSelectionPluginAvailable()){a=s._getSelectionPlugin()}this._bIgnoreSelectionChange=true;if(s&&s.isA("sap.ui.table.Table")){var o=s.getBinding("rows");if(o){if(o.aKeys){for(i=0;i<o.aKeys.length;i++){if(decodeURIComponent(o.aKeys[i])===e){if(t){a.addSelectionInterval(i,i)}else{a.removeSelectionInterval(i,i)}break}}}else{this.oRows=s.getBinding("rows");if(this.oRows.aIndices){for(i=0;i<this.oRows.aIndices.length;i++){var n=s.getContextByIndex(this.oRows.aIndices[i]);if(n){var l=n.getObject();if(l[this.getKey()]===e){if(t){a.addSelectionInterval(i,i)}else{a.removeSelectionInterval(i,i)}break}}}}}}}else{for(i=0;i<s.getItems().length;i++){var r=s.getItems()[i];var h=r.getBindingContext().getObject();if(h[this.getKey()]===e){s.setSelectedItem(r,t);break}}}this._bIgnoreSelectionChange=false};Ee.prototype._isComplexKeyFound=function(e,t){let i=true;Object.keys(e).forEach(s=>{if(!e[s].startsWith("guid")&&!t.includes(`${s}='${e[s]}'`)||e[s].startsWith("guid")&&!t.includes(`${s}=${e[s]}'`)){i=false}});return i};Ee.prototype.update=function(){if(this._oRulesLog){this._oRulesLog.setInvokedMethod("update",true)}if(!this._oDefaultSmartTable){this._oTable?.getBinding("rows")?.attachEventOnce("dataReceived",function(){var e=this._oTable.getBinding("rows").getLength();this._addInvisibleMessageSearchAndTableCount(e)},this)}if(!this.getEnabledMultiSelectionPlugin()){return this._updateSync()}else{return this._updateAsync()}};Ee.prototype._updateSync=function(){var e,t,i,s;var o;var n=this._oSelectedItems.getItems();var l={tokenKeys:n,useDefault:false};var r;if(this._oTable){r=this._oTable;if(this._isMultiSelectionPluginAvailable()){r=this._oTable._getSelectionPlugin()}}this._bIgnoreSelectionChange=true;if(this._hasListeners("updateSelection")){this.fireUpdateSelection(l)}else{l.useDefault=true}if(l.useDefault){if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this.oRows=this._oTable.getBinding("rows");r.clearSelection();if(this.oRows&&this.oRows.aKeys){for(t=0;t<n.length;t++){const l=this.getKeys()?.length>1;o=n[t];if(l){try{o=JSON.parse(n[t])}catch(e){a.error(`JSON.parse throws an exception: ${e.message}`)}}for(e=0;e<this.oRows.aKeys.length;e++){var h=this.oRows.aKeys[e];if(h===undefined){continue}h=decodeURIComponent(h);const t=h===o;let n;if(l){n=o&&Object.keys(o).length>1&&this._isComplexKeyFound(o,h)}if(n||t||h.includes(o)){if(l){try{o=JSON.stringify(o)}catch(e){a.error(`JSON.stringify throws an exception: ${e.message}`)}}if(!t){this._oSelectedItems.remove(o);var u=this._getTokenByKey(o,this._getTokenizer());if(u){u.setKey(h)}}s=this._oTable.getContextByIndex(e);if(s){i=s.getObject();this._oSelectedItems.add(h,i)}r.addSelectionInterval(e,e);break}}}}else if(this.oRows&&this.oRows.aIndices){r.clearSelection();var _=this._oTable.getBinding("rows").getContexts();for(t=0;t<n.length;t++){var d=n[t];for(e=0;e<this.oRows.aIndices.length;e++){s=_[e];if(s){i=s.getObject();if(i[this.getKey()]===d){this._oSelectedItems.add(i[this.getKey()],i);r.addSelectionInterval(e,e);break}}}}}}else{var c=this._oTable;for(t=0;t<n.length;t++){o=n[t];for(e=0;e<c.getItems().length;e++){var g=c.getItems()[e];var p=g.getBindingContext().getObject();if(p[this.getKey()]===o){c.setSelectedItem(g,true);break}}}}}this._bIgnoreSelectionChange=false;this._updateTitles()};Ee.prototype._updateAsync=function(){var e,t,i,s;var o;var n=this._oSelectedItems.getItems();var l={tokenKeys:n,useDefault:false};var r=[],h;if(this._oTable){h=this._oTable;if(this._isMultiSelectionPluginAvailable()){h=this._oTable._getSelectionPlugin()}}this._bIgnoreSelectionChange=true;if(this._hasListeners("updateSelection")){this.fireUpdateSelection(l)}else{l.useDefault=true}if(l.useDefault){if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this.oRows=this._oTable.getBinding("rows");h.clearSelection();if(this.oRows&&this.oRows.aKeys){for(t=0;t<n.length;t++){const l=this.getKeys()?.length>1;o=n[t];if(l){try{o=JSON.parse(n[t])}catch(e){a.error(`JSON.parse throws an exception: ${e.message}`)}}for(e=0;e<this.oRows.aKeys.length;e++){var u=this.oRows.aKeys[e];if(u===undefined){continue}u=decodeURIComponent(u);const t=u===o;let n;if(l){n=o&&Object.keys(o).length>1&&this._isComplexKeyFound(o,u)}if(n||t||u.includes(o)){if(l){try{o=JSON.stringify(o)}catch(e){a.error(`JSON.stringify throws an exception: ${e.message}`)}}if(!t){this._oSelectedItems.remove(o);var _=this._getTokenByKey(o,this._getTokenizer());if(_){_.setKey(u)}}s=this._oTable.getContextByIndex(e);if(s){i=s.getObject();this._oSelectedItems.add(u,i)}r.push(h.addSelectionInterval(e,e));break}}}}else if(this.oRows&&this.oRows.aIndices){h.clearSelection();var d=this._oTable.getBinding("rows").getContexts();for(t=0;t<n.length;t++){var c=n[t];for(e=0;e<this.oRows.aIndices.length;e++){s=d[e];if(s){i=s.getObject();if(i[this.getKey()]===c){this._oSelectedItems.add(i[this.getKey()],i);h.addSelectionInterval(e,e);break}}}}}}else{var g=this._oTable;for(t=0;t<n.length;t++){o=n[t];for(e=0;e<g.getItems().length;e++){var p=g.getItems()[e];var f=p.getBindingContext().getObject();if(f[this.getKey()]===o){g.setSelectedItem(p,true);break}}}}}this._bIgnoreSelectionChange=false;return Promise.all(r).then(function(){this._updateTitles()}.bind(this))};Ee.prototype._createHeaderBar=function(){this._oTitle=new f(this.getId()+"-title",{level:me.H1});var e=null;if(this._isPhone()){e=new S(this.getId()+"-back",{visible:false,type:ge.Back,press:function(e){if(this._currentViewMode===Ce.PHONE_SEARCH_VIEW){this._updateView(Ce.PHONE_LIST_VIEW)}else{this._updateView(Ce.PHONE_MAIN_VIEW)}}.bind(this)});this._oBackButton=e}var t=new m(this.getId()+"-header",{contentLeft:e,contentMiddle:this._oTitle,design:"Header"});this.setCustomHeader(t);this.getCustomHeader().addStyleClass("sapContrastPlus")};Ee.prototype._createCollectiveSearch=function(){this.oSelectionTitle=new T(this.getId()+"-selTitle",{visible:false,wrapping:false}).addStyleClass("compVHColSearchText");if(G.system.tablet&&!G.system.desktop){this.oSelectionTitle.addStyleClass("compVHColSearchTextTabletMaxWidth")}else{this.oSelectionTitle.addStyleClass("compVHColSearchTextMaxWidth")}this.oSelectionButton=new S(this.getId()+"-selButton",{icon:"sap-icon://slim-arrow-down",tooltip:this._oRb.getText("VALUEHELPVALDLG_SEARCHTEMPLATES_TOOLTIP"),type:ge.Transparent,visible:false,ariaLabelledBy:this.oSelectionTitle}).addStyleClass("compVHColSearchBtn");this._oColSearchBox=new d(this.getId()+"-selBox",{fitContainer:true,visible:this.oSelectionButton.getVisible(),items:[this.oSelectionTitle,this.oSelectionButton]}).addStyleClass("compVHColSearchVBox")};Ee.prototype._createFooterControls=function(){this._oButtonOk=new S(this.getId()+"-ok",{text:this._oRb.getText("VALUEHELPDLG_OK"),press:this._onCloseAndTakeOverValues.bind(this),visible:this.getSupportMultiselect(),type:ge.Emphasized,layoutData:new y({priority:pe.NeverOverflow})});this._oButtonCancel=new S(this.getId()+"-cancel",{text:this._oRb.getText("VALUEHELPDLG_CANCEL"),press:this._onCancel.bind(this),layoutData:new y({priority:pe.NeverOverflow})});if(this._isPhone()){this._oButtonGo=new S(this.getId()+"-go",{text:this._oRb.getText("VALUEHELPDLG_GO"),type:ge.Emphasized,press:this._onGo.bind(this),visible:false,layoutData:new y({priority:pe.NeverOverflow})});this._oButtonClear=new S(this.getId()+"-clear",{text:this._oRb.getText("VALUEHELPDLG_CLEAR"),press:this._onClear.bind(this),visible:false,layoutData:new y({priority:pe.NeverOverflow})});this.addButton(this._oButtonGo);this.addButton(this._oButtonClear)}this.addButton(this._oButtonOk);this.addButton(this._oButtonCancel)};Ee.prototype._handleTokenUpdateOrDelete=function(e){var t,i=[],s=[],a,o,n,l,r;if(this._ignoreRemoveToken){return}if(e.getParameter("type")===I.TokenChangeType.Removed){t=e.getParameter("removedTokens")}else if(e.getParameter("tokens")){t=e.getParameter("tokens")}for(l=0;l<t.length;l++){a=t[l];o=a.getKey();if(this._oSelectedRanges&&this._oSelectedRanges[o]){s.push(o);this._removeToken(o)}else{i.push(o);this._oSelectedItems.remove(o);this._removeTokenFromTokenizer(o,this._getTokenizer())}}this._removeRangeByKey(s);r={tokenKeys:i,useDefault:false};if(this._hasListeners("tokenRemove")){this._bIgnoreSelectionChange=true;this.fireTokenRemove(r);this._bIgnoreSelectionChange=false}else{r.useDefault=true}if(r.useDefault){i.forEach(function(e){this._changeTableRowSelectionForKey(e,false)}.bind(this))}if(t.length===1){setTimeout(function(){var e=this._getTokenizer().getTokens();if(e){n=e.length-1;if(n>=0){e[n].focus()}else{this._manageFocusAfterRemoveTokens()}}}.bind(this))}this._updateTitles()};Ee.prototype._createTokenizer=function(){const t=this.getId();if(this._oTokenizerGrid){return this._oTokenizerGrid}this._oSelectedTokenTitle=new k(`${t}-selectedTokenTitle`);this._oSelectedTokens=new I(`${t}-selectedTokens`,{ariaLabelledBy:this._oSelectedTokenTitle}).addStyleClass("compVHTokensDiv");(function(){this._oSelectedTokens.attachTokenUpdate(this._handleTokenUpdateOrDelete,this)}).bind(this)();this._oSelectedTokens.attachTokenDelete(this._handleTokenUpdateOrDelete,this);if(e.isAccessibilityEnabled()){this._oSelectedTokens.addAriaDescribedBy(this._oSelectedTokens.getTokensInfoId())}this._oRemoveAllSelectedItemsBtn=new S(`${t}-removeSelItems`,{type:ge.Transparent,icon:L.getIconURI("decline"),tooltip:this._oRb.getText("VALUEHELPVALDLG_REMOVETOKENS_TOOLTIP"),press:function(){var e=[],t=[],i;this._getTokenizer().destroyTokens();e=Object.keys(this._oSelectedItems["items"]);t=Object.keys(this._oSelectedRanges);this._removeRangeByKey(Object.keys(this._oSelectedRanges));this._oSelectedItems.removeAll();this._bIgnoreSelectionChange=true;if(this._oTable&&this._oTable.clearSelection){if(this._oTable._getSelectionPlugin&&this._oTable.data("isInternal")){this._oTable._getSelectionPlugin().clearSelection()}else{this._oTable.clearSelection()}}if(this._oTable&&this._oTable.removeSelections){this._oTable.removeSelections()}this._bIgnoreSelectionChange=false;this._updateTitles();this._manageFocusAfterRemoveTokens();if(e.length>0||t.length>0){i={tokenKeys:e.concat(t),useDefault:false};this.fireTokenRemove(i)}}.bind(this),ariaDescribedBy:this._oSelectedTokenTitle}).addStyleClass("compVHRemoveAllBtn");var i=new K(`${t}-selItemsBox`,{content:[this._getTokenizer(),this._oRemoveAllSelectedItemsBtn]}).addStyleClass("compVHTokenizerHLayout");this._oIncludeTokenGrid=new z(`${t}-selItemsGrid`,{width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:[this._oSelectedTokenTitle,i]}).addStyleClass("sapUiRespGridOverflowHidden");const s=new f(`${t}-tokenizerPanelToolbarTitle`,{level:me.H2}).addStyleClass("compVHTokenizerPanelToolbarTitle");const a=new se(`${t}-tokenizerPanelToolbar`,{content:s}).addStyleClass("compVHTokenizerPanelToolbar");this._oTokenizerPanel=new v(`${t}-tokenPanel`,{headerToolbar:a,expanded:G.system.desktop,expandable:false,expandAnimation:true,width:"auto",content:[this._oIncludeTokenGrid],expand:function(e){this._updateTokenizer();if(e.mParameters.expand&&this._oTable&&!this._oTable.isA("sap.m.Table")){var i=window.document.getElementById(`${t}-scrollCont`);if(i&&i.scrollTop){i.stop().animate({scrollTop:"1000"},1e3)}}}.bind(this)}).addStyleClass("compVHBackgroundTransparent").addStyleClass("compVHTokensPanel").addStyleClass("compValueHelpDialogTokens");if(this._isPhone()){this._getTokenizer().addStyleClass("sapMTokenizerMultiLine")}this._oTokenizerGrid=new z(`${t}-tokenizerGrid`,{width:"100%",defaultSpan:"L12 M12 S12",hSpacing:0,vSpacing:0,content:this._oTokenizerPanel}).addStyleClass("compVHDBackground").addStyleClass("sapUiRespGridOverflowHidden");return this._oTokenizerGrid};Ee.prototype._addToken2Tokenizer=function(e,t,i,s){var a=typeof t==="string"?t:"";var o=this._getTokenByKey(e,i);t=ee(t);if(!o){o=new r(Re.call(this,e,s));o.setKey(e);i.addToken(o);this._updateTokenizer()}if(o){o.setText(t);o.setTooltip(a)}};Ee.prototype._getTokenByKey=function(e,t){var i=t.getTokens();for(var s=0;s<i.length;s++){var a=i[s];if(a.getKey()===e){return a}}return null};Ee.prototype._removeToken=function(e){this._removeTokenFromTokenizer(e,this._getTokenizer())};Ee.prototype._removeTokenFromTokenizer=function(e,t){var i=this._getTokenByKey(e,t);if(i){this._ignoreRemoveToken=true;t.removeToken(i);i.destroy();this._ignoreRemoveToken=false;this._updateTokenizer();return true}return false};Ee.prototype._updateTokenizer=function(){this._bInitTokensHaveChanged=true;var e=false,t,i;if(this._oTokenizerPanel){e=this._oTokenizerPanel.getExpanded()}var s=this._getTokenizer().getTokens().length;if(this.getSupportRangesOnly()){t=this._oRb.getText("VALUEHELPDLG_SELECTEDCONDITIONS");i=this._oRb.getText("VALUEHELPDLG_NONESELECTEDCONDITIONS")}else if(this.getSupportRanges()){t=this._oRb.getText("VALUEHELPDLG_SELECTEDITEMS_CONDITIONS");i=this._oRb.getText("VALUEHELPDLG_NONESELECTEDITEMS_CONDITIONS")}else{t=this._oRb.getText("VALUEHELPDLG_SELECTEDITEMS");i=this._oRb.getText("VALUEHELPDLG_NONESELECTEDITEMS")}var a=t.replace("{0}",s.toString());var o=s===0?i:a;if(this._oTokenizerPanel){if(!e){o="";if(s!==0){o=a}if(o===""){o=i}}const t=this._oTokenizerPanel.getHeaderToolbar().getContent()[0];if(t){t.setText(o)}this._oSelectedTokenTitle.setText(o)}else{this._oSelectedTokenTitle.setText(o)}this._oRemoveAllSelectedItemsBtn.setEnabled(s!==0);this._oIncludeTokenGrid.removeStyleClass("displayNone")};Ee.prototype._createNavigationControl=function(){if(!this._isPhone()){this._oTabBar=new E(this.getId()+"-navigation",{expandable:false,items:[new B(this.getId()+"-itemstable",{visible:true,text:this._getTabSearchAndSelectText(),key:Ce.DESKTOP_LIST_VIEW}),new B(this.getId()+"-ranges",{visible:true,text:this._getTabRangesText(),key:Ce.DESKTOP_CONDITIONS_VIEW})],select:function(e){this._updateView(e.getParameters().key)}.bind(this)});this._oTabBar.setLayoutData(new p({shrinkFactor:0}));this._oNavigationContainer.addItem(this._oTabBar)}else{this._oSelectItemLI=new C(this.getId()+"-itemstable",{type:Te.Navigation,title:this._getTabSearchAndSelectText()}).data("key",Ce.PHONE_LIST_VIEW);this._oDefineConditionsLI=new C(this.getId()+"-ranges",{type:Te.Navigation,title:this._getTabRangesText()}).data("key",Ce.PHONE_CONDITIONS_VIEW);this._oMainListMenu=new U(this.getId()+"-navigation",{mode:fe.None,items:[this._oSelectItemLI,this._oDefineConditionsLI],itemPress:function(e){if(e){this._updateView(e.mParameters.listItem.data("key"))}}.bind(this)});this._oMainListMenu.setLayoutData(new p({shrinkFactor:0}));this._oContentContainer.addItem(this._oMainListMenu);this._oAdvancedSearchLink=new W(this.getId()+"-advancedSearchLink",{text:this._oRb.getText("FILTER_BAR_ADV_FILTERS_DIALOG"),press:function(){this._updateView(Ce.PHONE_SEARCH_VIEW)}.bind(this)}).addStyleClass("compVHAdvancedSearchLink");this._oAdvancedSearchLink.setLayoutData(new p({shrinkFactor:0,alignSelf:"End"}));this._oContentContainer.addItem(this._oAdvancedSearchLink)}};Ee.prototype._updateNavigationControl=function(){var e=!this.getSupportRangesOnly();var t=this.getSupportRangesOnly()||this.getSupportRanges();if(this._oTabBar){var i=this._oTabBar.getItems();i[0].setVisible(e);i[1].setVisible(t);this._oTabBar.setVisible(e&&t);this._updateDlgTitle()}if(this._oMainListMenu){this._oSelectItemLI.setVisible(e);this._oDefineConditionsLI.setVisible(t)}};Ee.prototype._removeRangeByKey=function(e){var t=e;if(typeof t==="string"){t=[t]}t.forEach(function(e,t,i){var s=this._oSelectedRanges[e];if(!s._oGrid){delete this._oSelectedRanges[e];if(this._oFilterPanel){var a=this._oFilterPanel.getConditionPanel();if(i.length==1){a.removeCondition(e)}else{a._removeConditionFromMap(e)}}}},this);if(t.length>1&&this._oFilterPanel){var i=this._oFilterPanel.getConditionPanel();i._clearConditions();i._fillConditions()}};Ee.prototype._createAddRanges=function(){if(!this._oRanges){this._oRanges=this._createRanges();this._oMainLayout.addItem(this._oRanges)}else{this._oMainLayout.addItem(this._oRanges)}};Ee.prototype._createRanges=function(){var e,t;this._oFilterPanel=new j(this.getId()+"-filterPanel",{maxConditions:this.getMaxConditions(),maxIncludes:this.getMaxIncludeRanges?this.getMaxIncludeRanges():this._iMaxIncludeRanges,maxExcludes:this.getMaxExcludeRanges?this.getMaxExcludeRanges():this._iMaxExcludeRanges,containerQuery:true,enableEmptyOperations:true,defaultOperation:this.getConditionPanelDefaultOperation(),filterItemChanged:function(e){var t=e.getParameter("reason");var i=e.getParameter("key");var s=e.getParameter("itemData");if(s&&t==="added"){var a={exclude:s.exclude,keyField:s.columnKey,operation:s.operation,value1:s.value1,value2:s.value2};this._oSelectedRanges[i]=a;var o=new q({key:i,exclude:s.exclude,columnKey:s.columnKey,operation:s.operation});o.setValue1(s.value1);o.setValue2(s.value2);this._oFilterPanel.addFilterItem(o);var n=this._getFormatedRangeTokenText(a.operation,a.value1,a.value2,a.exclude,a.keyField);this._addToken2Tokenizer(i,n,this._getTokenizer(),a.keyField);this._updateTokenizer()}if(s&&t==="updated"){var a=this._oSelectedRanges[i];a.exclude=s.exclude;a.keyField=s.columnKey;a.operation=s.operation;a.value1=s.value1;a.value2=s.value2;var n=this._getFormatedRangeTokenText(a.operation,a.value1,a.value2,a.exclude,a.keyField);this._addToken2Tokenizer(i,n,this._getTokenizer(),a.keyField);this._updateTokenizer()}if(t==="removed"){delete this._oSelectedRanges[i];this._removeToken(i);this._updateTokenizer()}this._updateTabRangesTitle()}.bind(this)});this._oFilterPanel._oPanel.addAriaLabelledBy(this.getId()+"-title");this._oFilterPanel.bIsSingleIntervalRange=this.bIsSingleIntervalRange;if(this.getProperty("_enhancedExcludeOperations")){this._oFilterPanel._enableEnhancedExcludeOperations()}t=this._oFilterPanel.getConditionPanel();t.setDisplayFormat(this.getDisplayFormat());t.setProperty("_calendarWeekSettings",this.getProperty("_conditionPanelCalendarWeekSettings"));t.setProperty("_showCurrentDateButton",this.getProperty("_conditionPanelShowCurrentDateButton"));this._oFilterPanel.setSuggestCallback(this._fSuggestCallback);t._sAddRemoveIconTooltipKey="CONDITION";if(this._aIncludeRangeOperations){for(e in this._aIncludeRangeOperations){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[e],e,true)}}if(this._aExcludeRangeOperations){for(e in this._aExcludeRangeOperations){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[e],e,true)}}if(this._aRangeKeyFields){this._aRangeKeyFields.forEach(function(e){this._oFilterPanel.addItem(new J({columnKey:e.key,text:e.label,typeInstance:e.typeInstance,type:e.type,maxLength:e.maxLength,formatSettings:e.formatSettings,scale:e.scale,precision:e.precision,isDefault:e.isDefault,values:null,nullable:e.nullable!=="false"}))},this)}if(this._oSelectedRanges){for(var i in this._oSelectedRanges){var s=this._oSelectedRanges[i];var a=new q({key:i,exclude:s.exclude,columnKey:s.keyField,operation:s.operation});a.setValue1(s.value1);a.setValue2(s.value2);this._oFilterPanel.addFilterItem(a)}}var o=new z(this.getId()+"-rangeFieldsGrid",{width:"100%",defaultSpan:"L12 M12 S12",vSpacing:0,hSpacing:0,content:[this._oFilterPanel]}).addStyleClass("sapUiRespGridOverflowHidden");this._sValidationDialogTitle=this._oRb.getText("VALUEHELPVALDLG_TITLE");this._sValidationDialogMessage=this._oRb.getText("VALUEHELPVALDLG_MESSAGE");this._sValidationDialogFieldMessage=this._oRb.getText("VALUEHELPVALDLG_FIELDMESSAGE");return o};Ee.prototype.suggest=function(e){this._fSuggestCallback=e;if(this._oFilterPanel){this._oFilterPanel.setSuggestCallback(this._fSuggestCallback)}};Ee.prototype._getKeyFieldByKey=function(e){var t;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(i){if(typeof i!=="string"){if(i.key===e){t=i;return true}}return false})}return t};Ee.prototype._validateRanges=function(e,t){if(this._oRanges){if(!this._oRanges.getParent()){e();return}var i=this._oFilterPanel.validateConditions();if(!i){l.show(this._sValidationDialogMessage,{icon:l.Icon.WARNING,title:this._sValidationDialogTitle,actions:[l.Action.OK,l.Action.CANCEL],emphasizedAction:l.Action.OK,styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(i){if(i===l.Action.OK&&e){e()}if(i===l.Action.CANCEL&&t){t()}}});return}}e()};Ee.prototype.setUpdateSingleRowCallback=function(e){this.fSingleRowCallback=e;this._updateNavigationControl()};Ee.prototype._createDefaultTable=function(){if(!this._isPhone()){this.setTable(new F(this.getId()+"-table"),true)}else{this.setTable(new O(this.getId()+"-table"),true);this.TableStateSearchData()}};function Be(){if(!(this._oTablePromise instanceof Promise)){this._oTablePromise=new Promise(function(e,t){var i,s=this.data("defaultSFBSmartTableConfig");this._fnRejectTablePromise=t;if(!s){i=this._createDefaultStandaloneTable();this.setTable(i,true);if(i&&i.isA("sap.ui.comp.smarttable.SmartTable")){i=i.getTable()}e(i);return}sap.ui.require(["sap/ui/comp/smarttable/SmartTable"],function(t){ce=t;if(!s){return}i=this._createDefaultSFBSmartTable(s);this.setTable(i,true);e(i.getTable())}.bind(this))}.bind(this))}return this._oTablePromise}Ee.prototype._getSmartTableColsNames=function(e){return e.cols.reduce(function(t,i){if(Array.isArray(i.fieldTemplate)){var s=e.valueListAnnotation.fields.find(function(e){return e.name===i.fieldName});if(s["com.sap.vocabularies.Common.v1.Text"]&&s["com.sap.vocabularies.Common.v1.Text"]["com.sap.vocabularies.UI.v1.TextArrangement"]){return t.concat(i.fieldName)}}return t.concat(i.fieldName,i.description)},[])};Ee.prototype._getSmartTableIgnoredColsNames=function(e,t=[],i=[]){return t.filter(function(e){return e.visible}).reduce(function(t,s){const a=i.some(function(e){return e.name===s.name});if(a&&(s.displayBehaviour==="descriptionOnly"||s.displayBehaviour==="idOnly")){t.push(s.description)}else if(!e.includes(s.name)){t.push(s.name)}return t},[])};Ee.prototype._checkForExistingRevokedFilters=function(e,t){var i=false,s;if(e.sPath===t&&e.sOperator==="EQ"&&e.oValue1===ve.RevokedCode){i=true}else if(Array.isArray(e)){for(var a=0;a<e.length;a++){s=e[a].aFilters||e[a];i=this._checkForExistingRevokedFilters(s,t);if(i){break}}}return i};Ee.prototype._ensureSelectHasAllVLFields=function(e,t){var i=t.valueListFields,s;if(!Array.isArray(i)){return}i=i.map(function(e){return e.name});s=i.join(",");if(s&&e.parameters){e.parameters.select=s}};Ee.prototype._createDefaultSFBSmartTable=function(e){var t=this._getSmartTableColsNames(e);this._oDefaultSmartTable=new ce(this.getId()+"-table",{smartFilterId:this.getId()+"-smartFilterBar",entitySet:e.entitySet,enableAutoBinding:e.autoSearch,enableAutoColumnWidth:true,tableType:this._isPhone()?o.smarttable.TableType.ResponsiveTable:o.smarttable.TableType.Table,enableExport:false,showTablePersonalisation:false,showVariantManagement:false,initiallyVisibleFields:t.join(),ignoredFields:this._getSmartTableIgnoredColsNames(t,e.valueListAnnotation.fields,e.valueListAnnotation.valueListFields).join(),header:this._sSmartTableTableTitle});this._oDefaultSmartTable.data("defaultDropDownDisplayBehaviour","idOnly");var i=this._oDefaultSmartTable.getTable();this._oDefaultSmartTable.setLayoutData(new p({growFactor:1,baseSize:"0%"}));this._oDefaultSmartTable.attachBeforeRebindTable(function(t){var i=t.getParameter("bindingParams"),s,a,o=e.smartFilterBar();delete t.mParameters.bindingParams.parameters.expand;delete i.expand;if(!e){return}if(o&&o.getAnalyticBindingPath()){t.getSource().setTableBindingPath(o.getAnalyticBindingPath())}if(e.valueListAnnotation){this._ensureSelectHasAllVLFields(i,e.valueListAnnotation)}if(e.valueListAnnotation&&e.valueListAnnotation.deprecationCodeField){a=e.valueListAnnotation.deprecationCodeField;if(i&&i.filters){var n=this._checkForExistingRevokedFilters(i.filters,a);if(!n){i.filters.push(new ue(a,_e.NE,ve.RevokedCode))}}}s=this._oDefaultSmartTable.getTable().getColumns().find(function(t){return t.data("p13nData").columnKey===e.key});if(!s||!s.data("p13nData").sortProperty){return}if(i.sorter.length===0&&i.parameters&&(!i.parameters.custom||!i.parameters.custom.search)){i.sorter.push(new he(e.key))}s.setSorted&&s.setSorted(i.sorter.some(function(t){return t.sPath===e.key}))}.bind(this));this._oDefaultSmartTable.data("p13nDialogSettings",{columns:{visible:false},filter:{visible:false},group:{visible:false}});if(this._isPhone()){i.setMultiSelectMode(R.MultiSelectMode.ClearAll);i.attachUpdateFinished(this.update)}else{if(this.getEnabledMultiSelectionPlugin()){i.addDependent(new te({limit:200,enableNotification:true}))}i.attachRowsUpdated(this.update)}i.data("isInternal",true);return this._oDefaultSmartTable};Ee.prototype._createDefaultStandaloneTable=function(){var e;if(this._isPhone()){e=new O({id:this.getId()+"-table"});e.setMultiSelectMode(R.MultiSelectMode.ClearAll);this.TableStateSearchData()}else if(this.getEnabledMultiSelectionPlugin()){e=new F({id:this.getId()+"-table"});e.addDependent(new te({limit:200,enableNotification:true}))}else{e=new F({id:this.getId()+"-table"})}e.data("isInternal",true);return e};Ee.prototype._initializeTableToolbar=function(){var e=this._oTable.getExtension()[0],t=e?e.getContent()[0]:null,i=[],s=this._oTable.isA("sap.ui.table.Table"),a=s&&this._bTableCreatedInternal&&this.getSupportMultiselect();if(a&&this._oDefaultSmartTable){try{this._oDefaultSmartTable.addDependent(new oe({rangeLimit:200}));this._oDefaultSmartTable.setCopyProvider(this._oCopyProvider)}catch(e){}}if(this._oDefaultSmartTable&&this._oDefaultSmartTable.isA("sap.ui.comp.smarttable.SmartTable")){return}if(!t){t=new f({text:G.system.desktop?this._sTableTitleNoCount:null});i.push(t);e=new le({content:[i]});this._oTable.addExtension(e)}else if(!t.isA("sap.m.Title")){t=new f({text:G.system.desktop?this._sTableTitleNoCount:null});e.insertContent(t,0)}};Ee.prototype._initializeTable=function(){var e,t=false;if(this._oTable){e=this._oTable;if(this._isMultiSelectionPluginAvailable()){e=this._oTable._getSelectionPlugin();t=true}}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){this._initializeTableToolbar();if(this._bTableCreatedInternal){this.getSupportMultiselect()?this._oTable.setSelectionBehavior(V.SelectionBehavior.RowSelector):this._oTable.setSelectionBehavior(V.SelectionBehavior.RowOnly)}e.setSelectionMode(this.getSupportMultiselect()?V.SelectionMode.MultiToggle:V.SelectionMode.Single);this._updateNoDataText(this._oRb.getText("VALUEHELPDLG_TABLE_PRESSSEARCH"));Pe(this._oTable,x.Fixed);var i=function(i){var s=i.getParameter("_internalTrigger")&&i.getParameter("_internalTrigger")===true,a=i.getParameter("userInteraction"),o=e.getSelectedIndex()!==-1;if(this._bIgnoreSelectionChange||!a&&!t||t&&!o&&s){return}var n={tableSelectionParams:i.mParameters,updateTokens:[],useDefault:false,table:this._oTable};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(n);this._bIgnoreSelectionChange=false;n.updateTokens.forEach(function(e){this._addRemoveTokenByKey(e.sKey,e.oRow,e.bSelected)}.bind(this))}else{n.useDefault=true}if(n.useDefault){var r=t?i.getSource().getParent():i.getSource();var h=r.getBinding("rows");var u=t?i.getSource().getSelectedIndices():r.getSelectedIndices();var _=i.getParameter("rowIndices");var d=i.getParameter("selectAll");var c=h&&h.isLengthFinal?h.isLengthFinal():true;var g,p=u.length;var f;var T=0;if(c){if(h.aKeys){for(g=0;g<p;g++){f=u[g];if(!h.aKeys[f]){T++}}}}else if(d){T=99999999}if(T!==0){var b=function(){h.attachEventOnce("dataReceived",function(){if(d){r.selectAll();_=e.getSelectedIndices()}this._handleSelectionUpdateTokens(r,_)}.bind(this));if(d){if(c){h.getContexts(0,p)}else{h.getContexts(0,T)}}else{h.getContexts(_[0],_[_.length-1])}}.bind(this);if(T<=400){b();return}else{l.show(this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDLOAD"),{icon:l.Icon.WARNING,title:this._oRb.getText("VALUEHELPDLG_SELECTIONFAILEDLOADTITLE"),actions:[l.Action.OK,l.Action.CANCEL],emphasizedAction:l.Action.OK,initialFocus:l.Action.CANCEL,styleClass:this.$().closest(".sapUiSizeCompact").length?"sapUiSizeCompact":"",onClose:function(e){if(e===l.Action.OK){b()}else{this.update()}}.bind(this)});return}}this._handleSelectionUpdateTokens(r,_)}this._updateTitles();if(!this.getSupportMultiselect()){this._bIgnoreSelectionChange=true;this._onCloseAndTakeOverValues()}};if(t){e.attachSelectionChange(i.bind(this))}else{this._oTable.attachRowSelectionChange(i.bind(this))}this._oTable.addStyleClass("compVHMainTable");if(!this._oTable.getParent()||!this._oTable.getParent().isA("sap.ui.comp.smarttable.SmartTable")){this._oTable.bindAggregation("columns","columns>/cols",function(e,t){var i,s,a,o,n,l=t.getProperty("descriptionLabel"),r=t.getProperty("label"),h=t.getProperty("template"),_=Array.isArray(h);if(t.getProperty("type")==="boolean"){i=new Q(e+"-control",{enabled:false,selected:{path:h}});o=new M}else{var d,c={path:h,type:t.getProperty("oType")};if(t.getProperty("isTimezone")){c.parts=[{value:null},{path:h}]}if(_){c={parts:[{path:h[0]},{path:h[1]}],formatter:function(e,i){var s=g.getFormattedExpressionFromDisplayBehaviour(t.getProperty("displayBehaviour"),e,i);return ee(s)}};a=new N({change:function(e){var t=e.getParameter("item"),i=t.getKey(),s=t.getSortOrder();d.setSortProperty(i);d.setSortOrder(s);d.sort(s===u.SortOrder.Descending)},items:[]});o=new M({quickActions:[a],beforeOpen:function(e){d=e.getParameter("openBy");if(d){h.forEach(function(e,t){var i=new H({key:e,label:t===0?r:l,sortOrder:e===d.getSortProperty()?d.getSortOrder():u.SortOrder.None});a.addItem(i)});a.setVisible(true)}},afterClose:function(){a.removeAllItems()}})}else{o=new M}i=new T(e+"-control",{wrapping:false,renderWhitespace:true,text:c})}if(this._oTable.isA("sap.ui.table.AnalyticalTable")){s=new de(e,{label:new b({text:t.getProperty("label")}),template:i,width:"{columns>width}",hAlign:i instanceof Q?be.Center:be.Begin,filterProperty:t.getProperty("filter")})}else{s=new D(e,{label:new b({text:t.getProperty("label")}),template:i,width:"{columns>width}",hAlign:i instanceof Q?be.Center:be.Begin,sortProperty:t.getProperty("sort"),sorted:t.getProperty("sorted"),sortOrder:t.getProperty("sortOrder"),showSortMenuEntry:_?false:true,filterProperty:t.getProperty("filter")});n=s.getProperty("sortProperty");if(n){s.setAssociation("headerMenu",o)}s.data({fieldName:t.getProperty("fieldName"),fieldTemplate:t.getProperty("fieldTemplate"),fieldDisplayBehaviour:t.getProperty("displayBehaviour")})}return s}.bind(this))}}else{this._oTable.setMode(this.getSupportMultiselect()?fe.MultiSelect:fe.SingleSelectLeft);this._oTable.setGrowing(true);e.attachSelectionChange(function(e){if(this._bIgnoreSelectionChange){return}var t=e.mParameters;var i={tableSelectionParams:e.mParameters,updateTokens:[],useDefault:false,table:this._oTable};if(this._hasListeners("selectionChange")){this._bIgnoreSelectionChange=true;this.fireSelectionChange(i);this._bIgnoreSelectionChange=false;i.updateTokens.forEach(function(e){this._addRemoveTokenByKey(e.sKey,e.oRow,e.bSelected)}.bind(this))}else{i.useDefault=true}if(i.useDefault){var s=t.selected;var a,o=t.listItems.length;for(a=0;a<o;a++){var n=t.listItems[a];var l=n.getBindingContext();var r=l?l.getObject():null;if(r){var h=r[this.getKey()];if(!this.getSupportMultiselect()){this._oSelectedItems.removeAll()}this._addRemoveTokenByKey(h,r,s)}}}if(!this.getSupportMultiselect()){this._onCloseAndTakeOverValues()}}.bind(this));if(!this._oTable.getParent()||!this._oTable.getParent().isA("sap.ui.comp.smarttable.SmartTable")){var s=0;this._oTable.bindAggregation("columns","columns>/cols",function(e,t){var i=t.getProperty("label");var a=this._oTable.getColumns().length>=2;s++;return new w(this._oTable.getId()+"-column"+s,{header:new b(this._oTable.getId()+"-column"+s+"-label",{text:i}),demandPopin:a,minScreenWidth:a?(this._oTable.getColumns().length+1)*10+"rem":"1px"})}.bind(this))}}};Ee.prototype._handleSelectionUpdateTokens=function(e,t){var i,s=t.length;var a;var o;var n;var l=false;var r=this.getEnabledMultiSelectionPlugin()&&e._getSelectionPlugin&&e._getSelectionPlugin().isA("sap.ui.table.plugins.MultiSelectionPlugin")&&e.data("isInternal")?e._getSelectionPlugin():e;if(e.getBinding("rows").aKeys){l=true}if(!this.getSupportMultiselect()){this._oSelectedItems.removeAll()}for(i=0;i<s;i++){a=t[i];o=e.getContextByIndex(a);n=o?o.getObject():null;if(n){var h;if(l){h=o.sPath.substring(1)}else{h=n[this.getKey()]}this._addRemoveTokenByKey(h,n,r.isIndexSelected(a))}}};Ee.prototype._addRemoveTokenByKey=function(e,t,i){try{e=decodeURIComponent(e)}catch(e){}if(i){this._oSelectedItems.add(e,t);this._addToken2Tokenizer(e,this._getFormatedTokenText(e),this._getTokenizer())}else{this._oSelectedItems.remove(e);this._removeTokenFromTokenizer(e,this._getTokenizer())}};Ee.prototype._onCloseAndTakeOverValues=function(){var e=this;var t=function(){var t;var i=e._oSelectedItems.getSelectedItemsTokenArray(e.getKey(),e.getDescriptionKey(),e.getTokenDisplayBehaviour());if(e._oSelectedRanges){var s=0;for(var a in e._oSelectedRanges){t=e._oSelectedRanges[a];var o=t.tokenValue;if(!o){o=e._getFormatedRangeTokenText(t.operation,t.value1,t.value2,t.exclude,t.keyField)}if(!t._oGrid||t._oGrid.select.getSelected()){var n=new r({key:"range_"+s}).data("range",{exclude:t.exclude,operation:t.operation,keyField:t.keyField,value1:t.value1,value2:t.value2});n.setText(o);n.setTooltip(typeof o==="string"?o:null);i.push(n);s++}}}e.fireOk({tokens:i,_tokensHaveChanged:e._bInitTokensHaveChanged})};this._validateRanges(t)};Ee.prototype._isMultiSelectionPluginAvailable=function(){var e=false;if(this._oTable._getSelectionPlugin&&this._oTable._getSelectionPlugin().isA("sap.ui.table.plugins.MultiSelectionPlugin")&&this._oTable.data("isInternal")){e=true}return e};Ee.prototype._onCancel=function(){this.fireCancel()};Ee.prototype._onGo=function(){this._oFilterBar.search()};Ee.prototype._onClear=function(){this._oFilterBar.clear()};Ee.prototype._updateTitles=function(){if(!this._oDefaultSmartTable){this._updateTableTitle()}this._updateTokenizer();this._updateTabSearchAndSelectTitle();this._updateTabRangesTitle()};Ee.prototype._addInvisibleMessageSearchAndTableCount=function(e){let t;const i=this._sTableTitleNoCount;if(e==undefined){t=this._oRb.getText("VALUEHELPDLG_ANNOUNCEMENT_TABLE_UPDATED",[i])}else if(e>1){t=this._oRb.getText("VALUEHELPDLG_ANNOUNCEMENT_TABLE_UPDATED_MULT",[i,e])}else if(e===1){t=this._oRb.getText("VALUEHELPDLG_ANNOUNCEMENT_TABLE_UPDATED_SING",[i,e])}else{t=this._oRb.getText("VALUEHELPDLG_ANNOUNCEMENT_TABLE_UPDATED_NOITEMS",[i])}this._oInvisibleMessage.announce(t,Se.Polite)};Ee.prototype._updateDlgTitle=function(){var e="";var t;if(this._oTitle){if(this._oTabBar&&!this._oTabBar.getVisible()&&!this.getFilterMode()){if(this._oTabBar.getSelectedKey()===Ce.DESKTOP_LIST_VIEW){e="VALUEHELPDLG_TITLE"}else if(this._oTabBar.getSelectedKey()===Ce.DESKTOP_CONDITIONS_VIEW){if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){e="VALUEHELPDLG_SINGLECONDITION_TITLE"}else{e="VALUEHELPDLG_RANGESTITLE"}}}else if(this._isPhone()&&!this.getFilterMode()){switch(this._currentViewMode){case Ce.PHONE_MAIN_VIEW:e="";break;case Ce.PHONE_LIST_VIEW:t=this._getTabSearchAndSelectText();break;case Ce.PHONE_SEARCH_VIEW:e="FILTER_BAR_ADV_FILTERS_DIALOG";break;case Ce.PHONE_CONDITIONS_VIEW:if(this.getMaxIncludeRanges()==="1"&&this.getMaxExcludeRanges()==="0"){e="VALUEHELPDLG_SINGLECONDITION_TITLE"}else{t=this._getTabRangesText()}break;default:break}}if(!t){t=this.getTitle()}if(e){t=this._oRb.getText(e,[t])}if(t){this._oTitle.setText(t)}}};Ee.prototype._updateTableTitle=function(){if(!this._oTable||this._oDefaultSmartTable&&this._oDefaultSmartTable.isA("sap.ui.comp.smarttable.SmartTable")){return}var e=0,t;this.oRows=this._oTable.getBinding("rows");if(this.oRows){e=this.oRows.getLength()}if(!this._oNumberFormatInstance){this._oNumberFormatInstance=X.getFloatInstance()}t=this._oNumberFormatInstance.format(e);if(e>0&&this.oRows.isLengthFinal&&this.oRows.isLengthFinal()){this._setTableTitle(this._sTableTitle1.replace("{0}",t))}else{this._setTableTitle(this._sTableTitleNoCount)}};Ee.prototype._getTabSearchAndSelectText=function(){var e=this._oTable;if(e){if(e.isA("sap.ui.comp.smarttable.SmartTable")){e=e.getTable()}var t=0;if(this._oSelectedItems&&this._oSelectedItems.getItems){t=this._oSelectedItems.getItems().length}if(t>0){return this._oRb.getText("VALUEHELPDLG_ITEMSTABLE_SELECT",[t])}}return this._oRb.getText("VALUEHELPDLG_ITEMSTABLE_SELECT").replace("({0})","")};Ee.prototype._getTabRangesText=function(){if(this._oSelectedRanges&&Object.keys(this._oSelectedRanges).length>0){var e=Object.keys(this._oSelectedRanges).length;return this._oRb.getText("VALUEHELPDLG_RANGES",[e])}return this._oRb.getText("VALUEHELPDLG_RANGES").replace("({0})","")};Ee.prototype._updateTabSearchAndSelectTitle=function(){var e=!this.getSupportRangesOnly();if(e){if(this._oTabBar){this._oTabBar.getItems()[0].setText(this._getTabSearchAndSelectText())}if(this._oMainListMenu&&this._oSelectItemLI){this._oSelectItemLI.setTitle(this._getTabSearchAndSelectText())}}};Ee.prototype._updateTabRangesTitle=function(){var e=this.getSupportRangesOnly()||this.getSupportRanges();if(e){if(this._oTabBar){this._oTabBar.getItems()[1].setText(this._getTabRangesText())}if(this._oMainListMenu&&this._oDefineConditionsLI){this._oDefineConditionsLI.setTitle(this._getTabRangesText())}}};Ee.prototype._setTableTitle=function(e){var t=this._oTable&&this._oTable.getExtension&&this._oTable.getExtension()[0],i=t?t.getContent()[0]:null;if(i&&G.system.desktop&&this._oTable&&!this._oTable.isA("sap.m.Table")){if(this._oTable.getTitle&&this._oTable.getTitle()){this._oTable.getTitle().setText(e)}else{i.setText(e)}if(!this._oTable.getAriaLabelledBy().includes(i.getId())){this._oTable.addAriaLabelledBy(i)}}else{this._oTable.addStyleClass("compValueHelpSmallMarginTop")}};Ee.prototype._equalizeButtonsWidth=function(){var e=this._oButtonOk.getDomRef(),t=this._oButtonCancel.getDomRef(),i,s;if(!e||!t){return}i=e.getBoundingClientRect().width;s=t.getBoundingClientRect().width;if(i===s){return}if(s>i){this._oButtonOk.setWidth(s+"px")}else{this._oButtonCancel.setWidth(i+"px")}};Ee.prototype.onAfterRendering=function(){n.prototype.onAfterRendering.apply(this);this._equalizeButtonsWidth();if(this._oTable){this._updateTitles()}if(!this._isPhone()&&this.getContentHeight()===""){if(this.getSupportRangesOnly()&&(this.getMaxExcludeRanges()==="-1"||this.getMaxIncludeRanges()==="-1")){this.setContentHeight("70%")}else{var e=this.getDomRef("scroll");var t=e.clientHeight;this.setContentHeight(t+"px")}if(this._oTable&&this._oTable.isA("sap.ui.table.Table")){Pe(this._oTable,x.Auto)}}if(this._oTabBar&&this._oTabBar.getVisible()&&this.getCustomHeader()){this.getCustomHeader().addStyleClass("compValueHelpDialogHeaderNoBoxShadow")}this._bInitTokensHaveChanged=false;this._setToolbarSpacerWidth();this._registerVHResizeHandler()};Ee.prototype._getDialogOffset=function(e){var t=e||this._$Window.width();var i={small:600,large:1024};var s=function(e){var t=parseInt(window.getComputedStyle(document.body).fontSize);return e*t*2};var a=1;if(t>i.small&&t<i.large){a=2}else if(t>=i.large){a=2}return{top:s(a),left:s(a)}};Ee.prototype.exit=function(){var e=function(e){if(e&&e.destroy){e.destroy()}return null};if(this._oCopyProvider){this._oCopyProvider=e(this._oCopyProvider)}n.prototype.exit.apply(this);if(typeof this._fnRejectTablePromise==="function"){this._fnRejectTablePromise()}this.removeDelegate(this._onBeforeRenderingInputEventDelegate);this._oTokenizerGrid=e(this._oTokenizerGrid);this._oRanges=e(this._oRanges);this._oFilterPanel=e(this._oFilterPanel);if(this._bTableCreatedInternal){this._oTable=e(this._oTable);this._oDefaultSmartTable=e(this._oDefaultSmartTable)}this._oTable=null;this.theTable=null;this._oNumberFormatInstance=null;this._oTabBar=e(this._oTabBar);this._oMainListMenu=e(this._oMainListMenu);this._oContentContainer=e(this._oContentContainer);this._oVarManagment=e(this._oVarManagment);this._aRangeKeyFields=e(this._aRangeKeyFields);this._aIncludeRangeOperations=e(this._aIncludeRangeOperations);this._aExcludeRangeOperations=e(this._aExcludeRangeOperations);if(this._oFilterBar){this._oFilterBar.detachInitialise(this._handleFilterBarInitialize);this._oFilterBar=e(this._oFilterBar)}this._oRb=e(this._oRb);this._sTableTitle1=e(this._sTableTitle1);this._sTableTitle2=e(this._sTableTitle2);this._sTableTitleNoCount=e(this._sTableTitleNoCount);this._sValidationDialogTitle=e(this._sValidationDialogTitle);this._sValidationDialogMessage=e(this._sValidationDialogMessage);this._sValidationDialogFieldMessage=e(this._sValidationDialogFieldMessage);this._oSelectedItems=e(this._oSelectedItems);this._oSelectedRanges=e(this._oSelectedRanges);this._oButtonOk=e(this._oButtonOk);this._oButtonCancel=e(this._oButtonCancel);if(this._oButtonGo){this._oButtonGo=e(this._oButtonGo)}if(this._oButtonClear){this._oButtonClear=e(this._oButtonClear)}if(this._oColSearchBox){this._oColSearchBox=e(this._oColSearchBox)}this._oRulesLog.destroy()};Ee.prototype.setRangeKeyFields=function(e){this._aRangeKeyFields=e;if(this._aRangeKeyFields){this._aRangeKeyFields.some(function(e){if(e.typeInstance&&e.typeInstance.isA("sap.ui.model.odata.type.DateTime")){var t=e.typeInstance;if(!t.oFormat){t.formatValue(s.getInstance(),"string")}if(t.oFormat){t.oFormat.oFormatOptions.UTC=false}}})}};Ee.prototype.getRangeKeyFields=function(){return this._aRangeKeyFields};Ee.prototype.setIncludeRangeOperations=function(e,t){t=t||"default";this._aIncludeRangeOperations[t]=e;if(this._oFilterPanel){this._oFilterPanel.setIncludeOperations(this._aIncludeRangeOperations[t],t)}};Ee.prototype.setExcludeRangeOperations=function(e,t){t=t||"default";this._aExcludeRangeOperations[t]=e.map(function(e){return this._oOperationsHelper.getCorrespondingExcludeOperation(e)}.bind(this));if(this._oFilterPanel){this._oFilterPanel.setExcludeOperations(this._aExcludeRangeOperations[t],t)}};Ee.prototype._getFormatedTokenText=function(e){var t=this._oSelectedItems.getItem(e);var i=t[this.getDescriptionKey()];var s=t[this.getKey()];if(i===undefined){if(typeof t==="string"){i=t}else{i=s}}else{i=g.getFormattedExpressionFromDisplayBehaviour(this.getTokenDisplayBehaviour()?this.getTokenDisplayBehaviour():ye.descriptionAndId,s,i)}return i};Ee.prototype._getFormatedRangeTokenText=function(e,t,i,s,a){var o=this._getKeyFieldByKey(a);var n=t;var l=i;var r=true;if(o){if(!o.typeInstance&&$._createKeyFieldTypeInstance){$._createKeyFieldTypeInstance(o)}if(o.typeInstance){n=o.typeInstance.formatValue(t,"string",r);l=o.typeInstance.formatValue(i,"string",r)}}var h=g.getFormattedRangeText(e,n,l,s);if(this._aRangeKeyFields&&this._aRangeKeyFields.length>1&&o&&o.label&&h!==""){h=o.label+": "+h}return h};Ee.prototype._isPhone=function(){return G.system.phone};Ee.prototype._hasListeners=function(e){if(this._bTableCreatedInternal){return false}return this.hasListeners(e)};Ee.prototype._rotateSelectionButtonIcon=function(e){if(!G.system.phone){var i=t.getElementById(this.oSelectionButton.$("img")[0].id);if(e){i.addStyleClass("sapUiVHImageExpand")}else{i.removeStyleClass("sapUiVHImageExpand")}}};Ee.prototype._getTokenizer=function(){return this._oSelectedTokens};Ee.prototype._getTabSearchAndSelect=function(){var e=!this.getSupportRangesOnly();if(e){if(this._oTabBar){return this._oTabBar.getItems()[0]}if(this._oMainListMenu&&this._oSelectItemLI){return this._oSelectItemLI}}return null};Ee.prototype._getTabDefneConditions=function(){var e=this.getSupportRangesOnly()||this.getSupportRanges();if(e){if(this._oTabBar){return this._oTabBar.getItems()[1]}if(this._oMainListMenu&&this._oDefineConditionsLI){return this._oDefineConditionsLI}}return null};Ee.prototype._registerVHResizeHandler=function(){Y.register(this,this._onVHResize.bind(this))};Ee.prototype._onVHResize=function(){this._setToolbarSpacerWidth()};Ee.prototype._setToolbarSpacerWidth=function(){var e,t,i,s,a,o;if(!this._oFilterBar){return}if(this._oFilterBar.getAggregation("_toolbar")){i=this._oFilterBar.getAggregation("_toolbar").getContent();for(var n=0;n<i.length;n++){if(i[n].isA("sap.m.ToolbarSpacer")){t=i[n];break}}}if(t&&this._oFilterBar.getBasicSearch()){e=this.getDomRef();if(e){s=parseInt(e.style.width);a=parseInt(e.style.maxWidth);if(isNaN(s)&&isNaN(a)){return}if(isNaN(s)){o=a}else if(isNaN(a)){o=s}else{o=Math.min(s,a)}if(o>=1e3){t.setWidth("6rem")}else if(o<1e3&&o>700){t.setWidth("4rem")}else{t.setWidth("0.5rem")}}}};Ee.prototype._manageFocusAfterRemoveTokens=function(){var e,t=this._oFilterPanel?this._oFilterPanel.getConditionPanel():undefined;if(this._currentViewMode.toLowerCase().indexOf("list")>-1){this._oButtonOk.focus()}else{this._onAfterRenderingInputDelegate={onAfterRendering:function(){e.focus()}};this._onBeforeRenderingInputEventDelegate={onBeforeRendering:function(){if(e.getDomRef()){e.removeDelegate(this._onAfterRenderingInputDelegate,this)}}};e=t._oConditionsGrid.getAggregation("content")[0].value1;e.addDelegate(this._onAfterRenderingInputDelegate,this);e.addDelegate(this._onBeforeRenderingInputEventDelegate,this);e.focus()}};function Re(e,t){if(!t){t=this.getKey()}e=e.replace(/[^a-zA-Z0-9]/g,"");t=t.replace(/[^a-zA-Z0-9]/g,"");var i=t?t+"-"+e:e;if(!this._oTokenIdCount[i]){this._oTokenIdCount[i]=0}this._oTokenIdCount[i]++;return this.getId()+"-token-"+i+"_"+this._oTokenIdCount[i]}function ke(e){if(e){var t=e.getItems();return t[0].getVisible()&&t[1].getVisible()}else{return false}}function Pe(e,t){if(e.setVisibleRowCountMode){e.setVisibleRowCountMode(t);if(t===x.Auto){e.setMinAutoRowCount(G.system.desktop?5:4)}return}if(t===x.Fixed){e.setRowMode(x.Fixed)}else if(t===x.Auto){e.setRowMode(new A({minRowCount:G.system.desktop?5:4}))}}return Ee});
//# sourceMappingURL=ValueHelpDialog.js.map