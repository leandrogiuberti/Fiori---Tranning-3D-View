/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/base/i18n/Localization","sap/ui/core/Element","sap/ui/core/library","sap/m/library","sap/ui/comp/library","sap/ui/model/BindingMode","sap/m/TextArea","sap/m/Link","sap/m/CheckBox","sap/m/ComboBox","sap/ui/comp/smartfield/ComboBox","sap/m/DatePicker","sap/m/DateTimePicker","sap/m/HBox","sap/m/Input","sap/m/Select","sap/m/Text","sap/m/ExpandableText","sap/ui/core/Renderer","sap/ui/comp/navpopover/SmartLink","./ControlFactoryBase","./FieldControl","./ODataControlSelector","./ODataHelper","sap/ui/comp/odata/ODataModelUtilSync","./ODataTypes","./TextArrangementDelegate","sap/m/ObjectNumber","sap/m/ObjectIdentifier","sap/m/ObjectStatus","sap/m/TimePicker","sap/ui/comp/navpopover/SemanticObjectController","sap/ui/comp/util/FormatUtil","sap/ui/comp/smartfield/Configuration","sap/ui/comp/odata/MetadataAnalyser","sap/ui/comp/odata/FiscalMetadata","sap/ui/core/InvisibleText","sap/base/Log","sap/base/assert","sap/base/security/URLListValidator","sap/base/util/merge","sap/base/strings/capitalize","sap/base/util/deepClone","sap/base/strings/whitespaceReplacer","sap/m/FlexItemData","sap/ui/comp/odata/CalendarMetadata","sap/ui/comp/odata/CriticalityMetadata"],function(t,e,a,i,o,r,n,s,l,p,u,h,d,c,g,y,m,f,_,M,D,v,C,P,T,b,x,S,I,V,F,A,E,O,B,L,N,w,U,H,k,R,j,W,z,q,G){"use strict";var K=a.ValueState;var $=a.TextAlign;var Q=i.InputType;var J=i.EmptyIndicatorMode;var X=i.FlexJustifyContent;var Y=o.smartfield.CriticalityRepresentationType;var Z=o.smartfield.ControlContextType;var tt=a.TextDirection;var et=i.FlexAlignContent;var at=o.smartfield.TextInEditModeSource;var it=o.smartfield.ValueHelpTitleSource;var ot;var rt=D.extend("sap.ui.comp.smartfield.ODataControlFactory",{constructor:function(t,e,a){var i;D.call(this,t,e);this.sName="ODataControlFactory";this._oMetaData={annotations:{}};this._oMeta=a;if(t){i=t}else if(a&&a.modelObject){i=a.modelObject}this._oHelper=new P(i,this._oBinding,null,true);this._oFieldControl=new v(e,this._oHelper);this._oTypes=new b(e);this._oSelector=new C(this._oMetaData,e,this._oTypes);this.oTextArrangementDelegate=new x(this);this.oValueListDelegate=null;this._bInitialized=false;this._bInitializeFromConfig=false;this.bPending=false;this.oMeasureField=null;ot=sap.ui.require("sap/ui/comp/smartfield/SmartField");if(!ot){throw new Error("SmartField module not loaded for "+this)}}});rt.prototype._checkBoxFlag=function(t){if(!t.type){return}if(t.type==="Edm.Boolean"){this._oParent._bEdmBoolDetected=true}};rt.prototype._findProperty=function(t,e){return t.parameter.find(function(t){return t.name===e})};rt.prototype._init=function(t){var e=t.entitySetObject||this._oHelper.oMeta.getODataEntitySet(t.entitySet),a=this._oMetaData.path===t.path&&this._oMetaData.entitySet&&e&&this._oMetaData.entitySet.name===e.name&&this._oMetaData.model===t.model,i,o,r;if(!e){i=this._oHelper.oMeta.getODataFunctionImport(t.entitySet);if(i){e=this._oHelper.oMeta.getODataEntitySet(i.entitySet)||{};this._oMetaData.functionImport=i;this._oParent._isFunctionImport=true;this._oMetaData.functionImportProperty=this._findProperty(i,t.path)}}if(a){return}this._oMetaData.model=t.model;this._oMetaData.path=t.path;this._oMetaData.entitySet=e;if(this._oHelper.oMeta){U(this._oMetaData.entitySet,'The entity set named "'+t.entitySet+'" was not found in the "'+this._oHelper.oMeta.getODataEntityContainer().name+'" entity container of the service metadata document. - '+this.getMetadata().getName())}this._oMetaData.entityType=t.entityType||this._oHelper.oMeta.getODataEntityType(this._oMetaData.entitySet.entityType)||this._oMetaData?.functionImportProperty?.type;this._oMetaData.navigationPath=t.navigationPath||null;if(typeof t.ignoreInsertRestrictions==="boolean"){this._oMetaData.ignoreInsertRestrictions=t.ignoreInsertRestrictions}if(this._oModel){this._oHelper.checkNavigationProperty(this._oMetaData,this._oParent);this._oHelper.getProperty(this._oMetaData);r=Object.assign({},this.getEdmProperty());if(this._oMetaData?.functionImportProperty){if(!r){r=this._oMetaData.functionImportProperty}else{Object.assign(r,this._oMetaData.functionImportProperty)}if(r){this._oMetaData.property.property=r}}U(!!r,'The EDM property "'+t.path+'" was not found in the "'+this._oMetaData.entityType.namespace+"."+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(r){this._checkBoxFlag(r);if(!this._oParent._shouldSuppressTextAnnotation()){this._oMetaData.annotations.text=this._oHelper.getTextProperty2(this._oMetaData)}o=this._oHelper.getAnalyzer();this._oMetaData.annotations.uom=this._oHelper.getUnitOfMeasure2(this._oMetaData);this._oHelper.getValueListData(this._oMetaData);this._oMetaData.annotations.lineitem=o.getLineItemAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData.annotations.datapoint=o.getDataPointAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData.annotations.fieldgroup=o.getFieldGroupAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData.annotations.connectedfields=o.getConnectedFieldsAnnotation(this._oMetaData.entitySet.entityType);this._oHelper.getUOMValueListAnnotationPath(this._oMetaData);this._oMetaData.annotations.semantic=B.getSemanticObjectsFromProperty(r);this._oMetaData.annotations.semanticKeys=o.getSemanticKeyAnnotation(this._oMetaData.entitySet.entityType);this._oMetaData._isNumber=B.isNumber(r);this._oHelper.applyCriticality(this._oMetaData,this._getCriticalityQualifierConfiguration());if(this._oMetaData.annotations.uom){this._oMetaData.annotations.uom.annotations={};this._oHelper.getValueListData(this._oMetaData.annotations.uom)}this._oHelper.getUOMTextAnnotation(this._oMetaData);if(this._oParent&&this._oParent.getExpandNavigationProperties&&this._oParent.getExpandNavigationProperties()){var n=this._oParent.getBindingContext(),s=n&&n.getObject(),l=s&&s.__metadata.created;if(!l){var p=this._oHelper.getAutoExpandProperties(r);if(p.length>0){this._oParent.bindElement({path:"",parameters:{expand:p,select:p}})}}}}}else{this._oMetaData.modelObject=t.modelObject;this._oMetaData.property=t.property;this._oMetaData.annotations.text=t.annotations.text;this._oMetaData.annotations.uom=t.annotations.uom;if(this._oMetaData.annotations.uom&&!this._oMetaData.annotations.uom.annotations){this._oMetaData.annotations.uom.annotations={}}if(t.annotations.valueListData){this._oMetaData.annotations.valuelist=t.annotations.valueListData}else{this._oMetaData.annotations.valuelist=t.annotations.valuelist}this._oMetaData.annotations.lineitem=t.annotations.lineitem;this._oMetaData.annotations.datapoint=t.annotations.datapoint;this._oMetaData.annotations.fieldgroup=t.annotations.fieldgroup;this._oMetaData.annotations.connectedfields=t.annotations.connectedfields;this._oHelper.applyCriticality(this._oMetaData,this._getCriticalityQualifierConfiguration());this._oMetaData.annotations.valuelistType=t.annotations.valuelistType;this._oMetaData.annotations.semantic=t.annotations.semantic;this._oMetaData.annotations.valuelistuom=t.annotations.valuelistuom}};rt.prototype._initValueList=function(t){var e=this._oMetaData.property,a=t.primaryValueListAnnotation;this._oMetaData.annotations.valueListData=a;e.valueListAnnotation=a;e.valueListKeyProperty=this._oHelper.getODataValueListKeyProperty(a);e.valueListEntitySet=this._oHelper.oMeta.getODataEntitySet(a.valueListEntitySetName);e.valueListEntityType=this._oHelper.oMeta.getODataEntityType(this._oHelper.oMeta.getODataEntitySet(a.valueListEntitySetName).entityType)};rt.prototype._getTextArrangementType=function(){var t=null,e=x.getPaths("ValueList",this._oMetaData);if(e.keyField&&e.descriptionField){t=this._oTypes.getType(this._oMetaData.property,null,null,{composite:true,keyField:e.keyField,descriptionField:e.descriptionField,valueListNoValidation:this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation"});if(Array.isArray(t)){t=t[0]}if(!(t.isA("sap.ui.comp.smartfield.type.TextArrangementString")||t.isA("sap.ui.comp.smartfield.type.TextArrangementGuid"))){t=null}}return t};rt.prototype._displayFormatter=function(t,e){if(t===null){return""}if(this.oType&&!this._bTextInDisplayModeValueList){t=this.oType.formatValue(t,"string")}if(this.oType&&this.oType.isA("sap.ui.comp.odata.type.NumericText")&&t===null&&e){t=""}return this._formatDisplayBehaviour(null,t,e)};rt.prototype._createEdmDisplay=function(a){var i,o,r,n=this._getLocalTextAnnotation(),s=n&&n.path||null,l,p,u,h="getText",d=this,c={width:true,textAlign:true},g=this.getEdmProperty(),y=this._oParent.data("configdata"),_=this._oSelector.checkDatePicker()||(g?g.type.startsWith("Edm.Date"):false),D=g?g.type==="Edm.Time":false,v=g&&B.getIsTimezoneProperty(g),C=this._isObjectStatusScenario();if(this._checkLink()&&!this._oSelector.useObjectIdentifier()){return this._createLink(_)}l=this.createAttributes(null,this._oMetaData.property,c);l.emptyIndicatorMode=J.Auto;this.oType=null;var P=g&&B.getTimezonePropertyPath(g)||false;if(g&&g.type==="Edm.DateTimeOffset"&&P){this.oType=this._getDateFormatType();var T=function(){if(!arguments[0]&&!(this.oType.oFormatOptions&&this.oType.oFormatOptions.showDate===false&&this.oType.oFormatOptions.showTime===false)){return""}return this.oType.formatValue(arguments,"string")};l.text={model:this._oMetaData.model,type:this.oType,parts:[{path:this._oMetaData.path,type:this.oType},{path:P,parameters:{useUndefinedForUnresolved:true}}],useRawValues:true,formatter:T.bind(this)}}else if(_||D){this.oType=this._getDateFormatType();l.text={model:this._oMetaData.model,path:this._oMetaData.path,type:this.oType}}else if(v){this.oType=this._oTypes.getType(this._oMetaData.property,{showDate:false,showTime:false});l.text={model:this._oMetaData.model,parts:[{value:null},{path:this._oMetaData.path}],type:this.oType}}else{l.text={model:this._oMetaData.model,type:this.oType};if(this._bTextInDisplayModeValueList&&this._oMetaData.property&&this._oMetaData.property.valueListAnnotation){u={};if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){u.sDisplayFormat="UpperCase"}u.valueListNoValidation=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";p=this.oTextArrangementDelegate.getBindingInfo(u);this.oType=p.type;l.text.parts=p.parts}if(!this.oType){var x=this._oParent.data("defaultTextInEditModeSource")&&this._oParent.isPropertyInitial("textInEditModeSource");this.oTextArrangementDelegate.checkRequiredMetadata(this._oParent._getComputedTextInEditModeSource(),x);this.oType=this._oTypes.getType(this._oMetaData.property);l.text.path=this._oHelper.getEdmDisplayPath(this._oMetaData)}l.text.type=this.oType}if(g){o=this._oHelper.oAnnotation.isMasked(g);if(o){l.text.formatter=b.maskValue}if(s){r=this._oSelector.useObjectIdentifier(_,o);if(r){delete l.width;delete l.textAlign;l.text={path:this._oMetaData.path};l.title={path:this._oHelper.getEdmDisplayPath(this._oMetaData)};if(this._oParent.hasListeners("press")){l.titleActive=true;l.titlePress=function(t){d._oParent.firePress(t)}}else if(this._oMetaData.annotations.semantic&&this._oMetaData.annotations.semantic.defaultSemanticObject){var S;var F;var E=this._oMetaData.annotations.semantic.additionalSemanticObjects.concat(this._oMetaData.annotations.semantic.defaultSemanticObject);A.getDistinctSemanticObjects().then(function(t){S=A.hasDistinctSemanticObject(E,t);if(S){var a=d._oParent.getBindingInfo("value");var i=a.parts[0].path;F=new M({semanticObject:d._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:d._oMetaData.annotations.semantic.additionalSemanticObjects,fieldName:i});if(!F.hasListeners("navigationTargetsObtained")){F.attachNavigationTargetsObtained(function(t){const a=e.getElementById(t.getSource().getControl());const i=t.getParameters().mainNavigation;if(i){i.setDescription(a.getText())}t.getParameters().show(a.getTitle(),i,undefined,undefined)})}if(!F.hasListeners("navigationTargetsObtained")){F.setNavigationTargetsObtainedCallback(t=>{const a=e.getElementById(t.originalId);const i=t.mainNavigation;if(i){i.setDescription(a.getText())}return Promise.resolve({mainNavigationId:a.getTitle(),mainNavigation:i})})}}});l.titleActive={path:"$sapuicompsmartfield_distinctSO>/distinctSemanticObjects",formatter:function(t){return A.hasDistinctSemanticObject(E,t)}};l.titlePress=function(t){if(S&&F){const e=F.getFieldInfo();if(!e){return}e.open(t.getSource(),t);e.setSourceControl(t.getSource());t.getSource().addDependent(F)}}}}else if(!(y&&y.isInnerControl===true)){l.text={};l.text.parts=[];l.text.parts.push(this._oMetaData.path);l.text.parts.push(this._oHelper.getEdmDisplayPath(this._oMetaData));l.text.formatter=this._displayFormatter.bind(this)}}else if(this._oSelector.checkCheckBox()){l.text.formatter=function(t){return d._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",t)}}}if(r){i=new I(this._oParent.getId()+"-objIdentifier",l);if(this._oMetaData.annotations.semantic){i.setModel(A.getJSONModel(),"$sapuicompsmartfield_distinctSO")}}else{if(l.text.type&&l.text.type.isA("sap.ui.comp.smartfield.type.DateTime")&&l.text.type.oConstraints&&l.text.type.oConstraints.isDateOnly){l.wrapping=false}if(this._oParent.isContextTable()&&t.getRTL()){l.textDirection="LTR"}if(typeof l.text.formatter==="undefined"&&!P&&!v){l.text.formatter=function(t){return W(t)}}l.renderWhitespace=true;if(this._oHelper.oAnnotation.isMultiLineText(g)){delete l.width;i=new f(this._oParent.getId()+"-expandableText",l)}else if(C&&!this._isInnerUoM()){delete l.width;delete l.textAlign;delete l.renderWhitespace;l.emptyIndicatorMode=J.Auto;this._addMetadataObjectStatusAttributes(l,g.criticalityInfo);i=new V(this._oParent.getId()+"-objStatus",l)}else{i=new m(this._oParent.getId()+"-text",l)}}if(r&&y&&y.configdata&&y.configdata.onText){delete y.configdata.onText}var O={control:i,onCreate:"_onCreate",params:{getValue:h,noValidations:true,type:null}};if(this.oType){O.type={type:this.oType,property:this._oMetaData.property}}return O};rt.prototype._getDateFormatType=function(){var t=this.getFormatSettings("dateFormatSettings"),e=this.getEdmProperty(),a;try{a=j(t)}catch(e){a=t}if(a&&e&&e.type==="Edm.DateTimeOffset"){a.UTC=false}return this._oTypes.getType(this._oMetaData.property,a)};rt.prototype._createEdmTime=function(){var t=this.getFormatSettings("dateFormatSettings"),e={width:true,placeholder:true,valueState:true,valueStateText:true};var a=rt.getBoundPropertiesMapInfoForControl(F.getMetadata().getName(),{propertyName:"value"})[0];var i={valueFormat:"HH:mm:ss"};i=Object.assign(i,this.createAttributes(a,this._oMetaData.property,e,{event:"change",parameter:"value"}));if(i.width===""){i.width="100%"}if(t){i[a].type=this._oTypes.getType(this._oMetaData.property,t)}var o=new F(this._oParent.getId()+"-timePicker",i);this._enhanceInputControls(o);return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:i.value.type,property:this._oMetaData.property}}}};rt.prototype._createProposedObjectStatus=function(){var t=this.createAttributes(null,this._oMetaData.property,null),e=this._getLocalTextAnnotation();var a=rt.getBoundPropertiesMapInfoForControl(V.getMetadata().getName(),{propertyName:"value"})[0];if(e){t[a]={parts:[this._oHelper.getEdmDisplayPath(this._oMetaData)]}}else{t[a]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)}}t.emptyIndicatorMode=J.Auto;this._addProposedObjectStatusAttributes(t);var i=new V(this._oParent.getId()+"-objStatus",t);return{control:i,onCreate:"_onCreate",params:{getValue:"getText",noValidation:true}}};rt.prototype._addProposedObjectStatusAttributes=function(t){var e,a=this._oParent.getControlProposal(),i=a&&a.getObjectStatus();if(i){e=i.getBindingInfo("criticality")}var o=function(t){var e={0:K.None,1:K.Error,2:K.Warning,3:K.Success};var a={"com.sap.vocabularies.UI.v1.CriticalityType/Neutral":K.Neutral,"com.sap.vocabularies.UI.v1.CriticalityType/Negative":K.Warning,"com.sap.vocabularies.UI.v1.CriticalityType/Critical":K.Error,"com.sap.vocabularies.UI.v1.CriticalityType/Positive":K.Success};return a[t]||e[t]||K.None};var r=function(){var t={};t[K.Error]="sap-icon://error";t[K.Warning]="sap-icon://alert";t[K.Success]="sap-icon://sys-enter-2";t[K.None]=null;var a;if(e){if(e.formatter){a=e.formatter.apply(null,arguments)}else{a=arguments[0]}}else{a=i.getCriticality()}if(a===undefined||a===null){return null}return t[o(a)]};var n=function(){if(!i){return false}return i.getCriticalityRepresentationType()!==Y.WithoutIcon};if(e){t.state={formatter:function(){var t;if(e.formatter){t=e.formatter.apply(null,arguments)}else{t=arguments[0]}return o(t)},parts:e.parts};if(n()){t.icon={formatter:r,parts:e.parts}}}else{if(i){t.state=o(i.getCriticality())}if(n()){t.icon=r()}}};rt.prototype._addMetadataObjectStatusAttributes=function(t,e){var a;if(!e){return}a=G.getShowCriticalityIcon(e.criticalityRepresentationType);if(e.path){t.state={path:e.path,formatter:G.getCriticalityState};if(e.criticalityRepresentationPath){t.icon={parts:[{path:e.path},{path:e.criticalityRepresentationPath}],formatter:function(t,e){return G.getShowCriticalityIcon(e)?G.getCriticalityIcon(t):undefined}}}else if(a){t.icon={path:e.path,formatter:G.getCriticalityIcon}}}else{t.state=G.getCriticalityState(e.criticalityType);if(e.criticalityRepresentationPath){t.icon={path:e.criticalityRepresentationPath,formatter:function(t){return G.getShowCriticalityIcon(t)?G.getCriticalityIcon(e.criticalityType):undefined}}}else if(a){t.icon=G.getCriticalityIcon(e.criticalityType)}}};rt.prototype._isObjectStatusScenario=function(){const t=this.getEdmProperty();const e=t&&t.criticalityInfo;if(e&&e.criticalityFrom!=="ConnectedFields"){return true}if(e&&e.criticalityFrom==="ConnectedFields"&&this._oParent.getParent().isA("sap.ui.comp.smartform.SemanticGroupElement")){return true}return false};rt.prototype._createInput=function(t){var e=new g(this._oParent.getId()+"-input",t);this._enhanceInputControls(e);return e};rt.prototype._enhanceInputControls=function(t){if(t.isA("sap.m.InputBase")&&typeof t._setPreferUserInteraction==="function"){t._setPreferUserInteraction(true)}};rt.prototype._createEdmString=function(t){var e={},a=t.mode,i={},o=this.isEmptyStringSignificant(),r;if(this._oSelector.checkCheckBox()){return this._createCheckBox()}var n=this._oSelector.checkSelection();if(n.selection){return this._createSelect({valueHelp:rt.getValueHelpDropdownSettings(n)})}n=this._oSelector.checkComboBox(t);if(n.combobox){return this._createComboBox({valueHelp:rt.getValueHelpDropdownSettings(n),edit:true})}var s={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true,valueStateText:true};var l=this.getEdmProperty();if(this._oHelper.oAnnotation.isMultiLineText(l)){delete s["width"];return this._createMultiLineText({attributesNamesMap:s})}var p=this._oParent.isTextInEditModeSourceNotNone(),u=/Edm.String|Edm.Guid/.test(l.type);if(p||this._bTextInDisplayModeValueList){U(u,"The ValueList and NavigationProperty"+"members of the sap.ui.comp.smartfield.TextInEditModeSource enumeration are only supported for OData "+"EDM Properties typed as Edm.String or Edm.Guid. - "+this.getMetadata().getName())}var h=rt.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];var d=this._oParent._getComputedTextInEditModeSource(),c,y;if(this._oParent.data("defaultTextInEditModeSource")&&this._oParent.isPropertyInitial("textInEditModeSource")&&a==="edit"){c=true}if(u){this.oTextArrangementDelegate.bValidMetadata=this.oTextArrangementDelegate.checkRequiredMetadata(d,c);y=this._oHelper.checkValueListRequiredMetadataForValidation(this._oMetaData.property)}if(this.oTextArrangementDelegate.bValidMetadata){i=this.createAttributes("",this._oMetaData.property,s);e.valueListNoValidation=this._oParent._getComputedTextInEditModeSource()==="ValueListNoValidation";i[h]=this.oTextArrangementDelegate.getBindingInfo(e)}else if(d===at.ValueList&&y&&a==="edit"){i=this.createAttributes(h,this._oMetaData.property,s);i[h]=this.oTextArrangementDelegate.getBindingInfo(e)}else if(o){i=this.createAttributes(h,Object.assign({isStringNullable:true},this._oMetaData.property),s)}else{i=this.createAttributes(h,this._oMetaData.property,s)}if(L.isFiscalValue(l)){i.placeholder=i.value?.type?.formatter?.getPattern();r=this._createInput(i);this._handleEventingForEdmString({control:r,edmProperty:this._oMetaData.property.property});return{control:r,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:i.value.type,property:this._oMetaData.property}}}}if(q.isCalendarValue(l)){i.placeholder=i.value?.type?.formatter?.getPattern();const t=this._createInput(i);this._handleEventingForEdmString({control:t,edmProperty:this._oMetaData.property.property});return{control:t,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:i.value.type,property:this._oMetaData.property}}}}var m=i.value.type&&i.value.type.oConstraints;if(m&&m.maxLength&&!B.isValueList(l)){i.maxLength=m.maxLength}var f=this._createInput(i);if(this._oHelper.oAnnotation.isMasked(l)){f.setType(Q.Password)}var _=this.getCustomDataConfiguration();if(this.oTextArrangementDelegate.bValidMetadata){this._handleEventingForTextArrangement({control:f});const t=this?._oMetaData?.property?.valueListKeyProperty,e=t?t["com.sap.vocabularies.Common.v1.DocumentationRef"]:undefined;if(e){this.getODataHelper()._setControlDocumentationRef(f,e)}}else{this._handleEventingForEdmString({control:f,edmProperty:this._oMetaData.property.property,currency:_&&_.currency})}return{control:f,onCreate:"_onCreate",params:{valuehelp:{annotation:n.annotation,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"},getValue:"getValue",type:{type:i.value.type,property:this._oMetaData.property,emptyStringSignificant:o}}}};rt.prototype.isEmptyStringSignificant=function(){var t=this.getEdmProperty(),e=t&&(t["sap:semantics"]==="currency-code"||t["sap:semantics"]==="unit-of-measure"),a=this._getDisplayBehaviourConfiguration(),i=a==="descriptionAndId"||a==="idAndDescription"||false,o=this._oMetaData.annotations&&this._oMetaData.annotations.valueListData,r=o&&o.descriptionField!==undefined;return i&&!e&&r||false};rt.prototype.getLocalTextPropertyName=function(){var t,e=this._oHelper.getAnalyzer(),a=this.getEdmProperty();if(e&&a){t=e.getDescriptionFieldName(a)}return t};rt.getValueHelpDropdownSettings=function(t){return{annotation:t.annotation,noDialog:true,noTypeAhead:true}};rt.prototype._getMaxLength=function(){return this._oTypes.getMaxLength(this._oMetaData.property,this._oParent.getBindingInfo("value"))};rt.prototype._addAriaLabelledBy=function(t){var e,a,i,o=this._oParent.getControlContext();if(o===Z.None||o===Z.Form||o===Z.SmartFormGrid){D.prototype._addAriaLabelledBy.apply(this,arguments);i=this._oParent.data("configdata");if(i&&i.configdata.isInnerControl){if(t){a=t.control;if(a instanceof c){if(a.getItems().length>0){a=a.getItems()[0]}}}if(a&&a.getAriaLabelledBy&&a.getAriaLabelledBy().length===0){var r=this.getEdmProperty();if(this._oHelper.oAnnotation.getLabel(r)){e=new N({text:this._oHelper.oAnnotation.getLabel(r)});a.addAriaLabelledBy(e);this._oParent.addAggregation("_ariaLabelInvisibleText",e)}}}}};rt.prototype._addAriaDescribedBy=function(){var t=this._oParent.getControlContext();if(t===Z.None||t===Z.Form||t===Z.SmartFormGrid){D.prototype._addAriaDescribedBy.apply(this,arguments)}};rt.prototype._handleEventingForEdmString=function(t){var e=t.control;if(!e){return}e.attachChange(function a(i){var o=this._getChangeEventParams(i),r=i&&i.getParameters(),n=i&&i.getSource(),s,l,p,u,h=null;if(r){s=r.value;o.value=s;o.newValue=s;l=e._oSuggestionPopup&&e._oSuggestionPopup.isOpen();if(l){p=e._oSuggestionPopup.getContent&&e._oSuggestionPopup.getContent();u=p&&p.length>0&&p[0]&&p[0].isA("sap.m.Table")&&p[0];h=u&&u.getSelectedItem&&u.getSelectedItem();if(!r.validated&&h){return}}if(t.currency){var d=this.getCurrencyValidationSettings();d.oSource=n;if(this._oHelper.oAnnotation.isUpperCase(t.edmProperty)&&s){s=s.toUpperCase();e.setValue(s)}}try{this._oParent.fireChange(o)}catch(t){w.error(t)}}}.bind(this))};rt.prototype._handleEventingForTextArrangement=function(t){var e=t.control;if(!e){return}e.attachChange(function(t){var a=this._getChangeEventParams(t),i=e._oSuggPopover,o=e.getShowSuggestion(),r=o&&i.isOpen(),n=false;if(r){var s=i.getItemsContainer&&i.getItemsContainer();n=s&&s.getSelectedItem()!==null}if(r&&(!a.validated&&n)){return}if(!n&&!a.validated){const t=this._oParent.getFirstInnerControl?.().getBinding?.("value"),e=t&&t.getCurrentValues?.()[0],i=t&&t?.oType?.oFormatOptions?.textArrangement;if(e&&i&&(i==="idAndDescription"||i==="descriptionAndId")&&this._oParent.getValueState()!=="Error"){a.newValue=e;a.value=e}}try{var l=this._oParent.data("configdata");if(l&&l.configdata&&this._oParent.isTextInEditModeSourceNotNone()){this._oParent.checkValuesValidity().catch(function(){}).finally(function(){this._oParent.fireChange(a)}.bind(this))}else{this._oParent.fireChange(a)}}catch(t){w.error(t)}}.bind(this))};rt.prototype.getUOMChangeHandler=function(t){return function(e){try{var a=t.smartFieldRootControl,i=e.getParameters(),o=i.value,r=e.getSource(),n=t.currency,s=n?this.getCurrencyValidationSettings(t):this.getUnitValidationSettings(t);s.oSource=r;n?this.updateModelPropertiesForCurrency("value",s):this.updateModelPropertiesForUnit("value",s);a.fireChange({value:o,newValue:o,unitChanged:!!t.unit,validated:!!i.validated})}catch(e){if(e.validationUnitError){a.fireChange({value:o,newValue:o,unitChanged:!!t.unit,validated:!!i.validated})}w.error(e)}}.bind(this)};rt.prototype.getCurrencyValidationSettings=function(t){var e;if(t){e=t.smartFieldRootControl}else{var a=this.getCustomDataConfiguration();e=a&&a.smartFieldRootControl}var i=e.getInnerControls();return{amountField:i[0],currencyField:i[1],errorState:e._oError,checkValidity:e.checkValuesValidity.bind(e),rootControl:e,bindingContext:e.getBindingContext()}};rt.prototype.getUnitValidationSettings=function(t){var e;if(t){e=t.smartFieldRootControl}else{var a=this.getCustomDataConfiguration();e=a&&a.smartFieldRootControl}var i=e.getInnerControls();return{measureField:i[0],unitField:i[1],errorState:e._oError,checkValidity:e.checkUnitValidity.bind(e),rootControl:e}};rt.prototype._setCurrencyValues=function(t,e,a){var i=t.getBindings(),o=i[0].getContext(),r=i[1].getContext();t.setContext(a);t.setValue(e);i[0].setContext(o);i[1].setContext(r)};rt.prototype.updateModelPropertiesForCurrency=function(t,e){var a=e.amountField,i=e.currencyField,o=e.oSource,n=a.getValue(),s,l,p="";if(i){var u=i.getMetadata().getName();s=rt.getBoundPropertiesMapInfoForControl(u,{propertyName:t})[0];l=i.getParent();if(this._getDisplayBehaviourConfiguration()&&l&&(l.getEditable&&(!l.getEditable()||l._oFactory._getTextArrangementType()))){p=l.getBinding("value").getValue()}else{var h="get"+R(s);p=i[h]()}}var d=[n,p];var c={rawValues:d,handleSuccess:false};var g=e.checkValidity(c);function y(l){var p=a.getModel(),u=a.getBinding(t),h,c;if(i){h=i.getBinding(s);c=h.getType()}var g=u.getType(),y=u.getExternalValue(),m=h&&h.getExternalValue(),f=g.parseValue(n,"string",d),_=f[1],M=g.formatValue(f,"string"),D=c&&c.formatValue(_,"string");if(p.getDefaultBindingMode()===r.TwoWay){if(!l){this._setCurrencyValues(u,f,e.bindingContext)}}if(!l){a.setValue(M)}var v=false,C=true;if(u.hasValidation()&&!l){var P={element:a,property:t,type:g,newValue:M,oldValue:y,mParameters:{originSource:o}};a.fireValidationSuccess(P,v,C)}if(h&&h.hasValidation()){var T={element:i,property:s,type:c,newValue:D,oldValue:m,mParameters:{originSource:o}};i.fireValidationSuccess(T,v,C)}}function m(t){}function f(){var o=e.errorState;if(o.bComplex&&o.bFirst&&o.bSecond){var r=a.getBinding(t).getExternalValue();d=[r,p];var n={rawValues:d,innerControls:[i],handleSuccess:false};var s=e.checkValidity(n);s.then(function(){return y.call(this,true)}.bind(this)).catch(m)}}g.then(function(){return y.call(this)}.bind(this)).catch(m).finally(f)};rt.prototype.updateModelPropertiesForUnit=function(t,e){var a=e.measureField,i=e.unitField,o=a.getValue(),n,s="",l=e.oSource,p=a.getMetadata().getName(),u,h,d={},c,g;if(i){var y=i.getMetadata().getName();n=rt.getBoundPropertiesMapInfoForControl(y,{propertyName:t})[0];var m="get"+R(n),f=i.getParent();if(i.isA("sap.m.ComboBox")){s=i.getSelectedKey()}else if(this._getDisplayBehaviourConfiguration()&&f&&(!f.getEditable()||f._oFactory._getTextArrangementType())){s=f.getBinding("value").getValue()}else{s=i[m]()}}else if(this._checkSuppressUnit()){var _=this.getMetaData().annotations.uom.path,M=a.getBindingContext();s=this._oModel.getData(_,M)}var D=[o,s];var v={rawValues:D,handleSuccess:false};var C=e.checkValidity(v);if(C){var P=a.getModel(),T=a.getBinding(t),b,x;if(i){b=i.getBinding(n);x=b.getType()}var S=T.getType(),I=S.parseValue(o,"string",D),V=I[1],F,A;if(V===undefined&&i&&!i.getEditable){F=S.formatValue([I[0],null],"string");A=V}else{F=S.formatValue(I,"string");if(!T.isA("sap.ui.comp.smartfield.type.Unit")){V=s}A=x&&x.formatValue(V,"string")}if(P.getDefaultBindingMode()===r.TwoWay){T.setValue(I);u=false;h=true;d=rt.getBoundPropertiesMapInfoForControl(p,{propertyName:"value"});c=d&&d[0];g={element:a,property:c,type:T.getType(),newValue:o,oldValue:T.getValue(),mParameters:{originSource:l}};a.fireValidationSuccess(g,u,h)}a.setValue(F);if(i&&i.getEditable&&i.getEditable()&&i.getParent().getVisible()&&!i.isA("sap.m.ComboBox")){i.setValue(A)}}};rt.prototype._createComboBox=function(t){var e=null,a=this._isMComboBoxRequired(),i=a?p:u,o=this._oParent._getComputedTextInEditModeSource(),r=o==="ValueList"?"realValue":"value",n=a?"value":r,s={width:true,textAlign:true,placeholder:true,tooltip:true,name:true,valueState:true},l,h={},d={width:"100%"},c=false;l=rt.getBoundPropertiesMapInfoForControl(i.getMetadata().getName(),{propertyName:n})[0];h["change"]=this._oHelper.getDropdownChangeHandler(this._oParent,!a);if(t.edit){if(a){h=Object.assign(h,this.createAttributes(l,this._oMetaData.property,s),d);e=new p(this._oParent.getId()+"-comboBoxEdit",h)}else{if(B.getIsTimezoneProperty(this._oMetaData.property)){h=Object.assign(h,this.createAttributes(l,this._oMetaData.property,s),d)}else{c=true;h=Object.assign(h,this.createAttributes(l,Object.assign({isStringNullable:true},this._oMetaData.property),s),d)}e=new u(this._oParent.getId()+"-comboBoxEdit",h)}this._enhanceInputControls(e);e.attachChange(function(){this._oParent.oValidation.handleComboValidation(e)}.bind(this))}else{h=Object.assign(h,this.createAttributes(l,this._oMetaData.property,s),d);e=this._createDisplayedComboBox(h)}this._oParent.oValidation.addValidationToType(h[l].type);e.setFilterFunction(function(t,e){RegExp.escape=function(t){return t.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")};var a=RegExp.escape(t);var i=new RegExp(a,"i");return e.getText().match(new RegExp(i,"i"))||e.getKey().match(new RegExp(i,"i"))});e.useHighlightItemsWithContains=function(){return true};return{control:e,onCreate:"_onCreate",params:{valuehelp:{annotation:t.valueHelp.annotation,aggregation:"items",noDialog:t.valueHelp.noDialog,noTypeAhead:t.valueHelp.noTypeAhead},getValue:"get"+l[0].toUpperCase()+l.slice(1),type:{type:h[l].type,property:this._oMetaData.property,emptyStringSignificant:c}}}};rt.prototype._createDisplayedComboBox=function(t){var e=p.extend("sap.ui.comp.smartfield.DisplayComboBox",{metadata:{library:"sap.ui.comp",properties:{wrapping:{type:"boolean",group:"Appearance",defaultValue:true}}},renderer:{apiVersion:2,render:function(t,e){var a=e.getWidth(),i=e.getValue(),o=e.getTextDirection(),r=e.getTextAlign(),n=e.getTooltip_AsString(),s=e.getWrapping();t.openStart("span",e);t.class("sapMText");t.class("sapUiSelectable");if(s){if(i&&i.length>0&&!/\s/.test(i)){t.class("sapMTextBreakWord")}}else{t.class("sapMTextNoWrap")}if(a&&i!==""){t.style("width",a)}else{t.class("sapMTextMaxWidth")}if(o!==tt.Inherit){t.attr("dir",o.toLowerCase())}if(n){t.attr("title",n)}if(r){r=_.getTextAlign(r,o);if(r){t.style("text-align",r)}}var l=s?"sapMTextRenderWhitespaceWrap":"sapMTextRenderWhitespace";t.class(l);t.openEnd();i.replace(/\r\n|\n\r|\r/g,"\n");t.text(i);t.close("span")}},updateDomValue:function(t){if(!this.isActive()){return this}t=this._getInputValue(t);if(this.$().text()!==t){this.$().text(t);this._bCheckDomValue=true}return this},getValue:function(){return this.getProperty("value")},getFocusDomRef:function(){return this.getDomRef()},getEditable:function(){return false}});return new e(this._oParent.getId()+"-comboBoxDisp",t)};rt.prototype._createSelect=function(t){var e={width:true,name:true,valueState:true},a;var i=rt.getBoundPropertiesMapInfoForControl(y.getMetadata().getName(),{propertyName:"value"})[0];var o={change:this._oHelper.getDropdownChangeHandler(this._oParent),forceSelection:false};o=Object.assign(o,this.createAttributes(i,this._oMetaData.property,e));if(o.width===""){o.width="100%"}a=new y(this._oParent.getId()+"-select",o);this._enhanceInputControls(a);return{control:a,onCreate:"_onCreate",params:{valuehelp:{annotation:t.valueHelp.annotation,aggregation:"items",noDialog:t.valueHelp.noDialog,noTypeAhead:t.valueHelp.noTypeAhead},getValue:"getSelectedKey",type:{type:o.selectedKey.type,property:this._oMetaData.property}}}};rt.prototype._createCheckBox=function(){var t=rt.getBoundPropertiesMapInfoForControl(l.getMetadata().getName(),{propertyName:"value"})[0];var e=this.createAttributes(t,null,{},{event:"select",parameter:"selected"});e.editable=this._oParent.getEditable()&&this._oParent.getEnabled()&&this._oParent.getContextEditable();e.selected.type=this._oTypes.getAbapBoolean();return{control:new l(this._oParent.getId()+"-cBox",e),onCreate:"_onCreate",params:{getValue:"getSelected"}}};rt.prototype._createEdmDateTime=function(){var t=this.getFormatSettings("dateFormatSettings"),e,a,i;var o={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var r=this.createAttributes(null,this._oMetaData.property,o,{event:"change",parameter:"value"});if(this._oSelector.checkDatePicker()){e=rt.getBoundPropertiesMapInfoForControl(h.getMetadata().getName(),{propertyName:"value"})[0];r[e]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,t,{displayFormat:"Date"}),model:this._oMetaData.model,mode:this._oParent.getBindingMode("value")};if(t&&t.style){r.displayFormat=t.style}i=new h(this._oParent.getId()+"-datePicker",r);this._enhanceInputControls(i);return{control:i,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:r.value.type,property:this._oMetaData.property}}}}e=rt.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];r[e]={path:this._oMetaData.path,model:this._oMetaData.model,type:this._oTypes.getType(this._oMetaData.property,t),mode:this._oParent.getBindingMode("value")};a=new d(this._oParent.getId()+"-input",r);this._enhanceInputControls(a);return{control:a,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:r.value.type,property:this._oMetaData.property}}}};rt.prototype._createEdmDateTimeOffset=function(){var t,e=this.getFormatSettings("dateFormatSettings"),a=this.getEdmProperty(),i;try{t=j(e)}catch(a){t=e}if(t){t.UTC=false}var o=rt.getBoundPropertiesMapInfoForControl(d.getMetadata().getName(),{propertyName:"value"})[0];var r={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var n=this.createAttributes(null,this._oMetaData.property,r,{event:"change",parameter:"value"});var s=a&&B.getTimezonePropertyPath(a)||false;if(s){if(e&&e.showTimezone===false){n.showTimezone=false}else{n.showTimezone=true}if(t&&t.style){n.displayFormat=t.style}if(t&&t.pattern){n.displayFormat=t.pattern}this.oType=this._oTypes.getType(this._oMetaData.property,t);n[o]={model:this._oMetaData.model,type:this.oType,parts:[{path:this._oMetaData.path,parameters:{useUndefinedForUnresolved:true},type:this.oType},{path:s,parameters:{useUndefinedForUnresolved:true}}],useRawValues:true,mode:this._oParent.getBindingMode("value")}}else{n[o]={model:this._oMetaData.model,path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property,t),mode:this._oParent.getBindingMode("value")}}i=new d(this._oParent.getId()+"-input",n);this._enhanceInputControls(i);return{control:i,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:n.value.type,property:this._oMetaData.property}}}};rt.prototype._createEdmNumeric=function(e){var a=this._oSelector.checkComboBox(e),i=e?e.mode:undefined,o;if(a.combobox){return this._createComboBox({valueHelp:{annotation:a.annotation,noDialog:true,noTypeAhead:true},edit:true})}var r={width:true,textAlign:true,placeholder:true,name:true,valueState:true};var n=rt.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];var s=this.createAttributes(n,this._oMetaData.property,r,{event:"change",parameter:"value"});if(this._oParent.isContextTable()&&t.getRTL()){s.textDirection="LTR"}o=this._createInput(s);if(i==="edit"&&this._oParent.isFormContextType()){o.setTextAlign($.End)}return{control:o,onCreate:"_onCreate",params:{getValue:"getValue",type:{type:s.value.type,property:this._oMetaData.property}}}};rt.prototype._handleUoMAriaDescribedBy=function(t,e,a){var i=e?.getId(),o=t.getAriaDescribedBy();if(a==="add"){if(!o.includes(i)){t.addAriaDescribedBy(i)}}else if(a==="remove"){if(o.includes(i+"-text")){t.removeAriaDescribedBy(i+"-text")}}};rt.prototype._createEdmUOM=function(e){var a=e.mode,i=this._oParent.getEntitySet(),o=rt.getBoundPropertiesMapInfoForControl(ot.getMetadata().getName(),{propertyName:"value"})[0],r=this._getPropertyBindingMode(o),n=this.getEdmProperty(),s=this._oMetaData.annotations.uom.property.property,l=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(n,s);var p={currency:l,edmProperty:s,bindingMode:r};var u=this._createEdmUOMAttributes(p),h=t.getRTL(),d=h&&this._oParent.isContextTable(),g=this._oParent.getId(),y;if(d){u.textDirection="LTR"}var m=this._createInput(u);this.oMeasureField=m;if(a==="edit"&&this._oParent.isFormContextType()){m.setTextAlign($.End)}if(this._oParent.data("suppressUnit")==="true"){var f={getValue:"getValue"};if(!l){f.type={type:u.value.type,property:this._oMetaData.property}}return{control:m,onCreate:"_onCreate",params:f}}if(!l){y={type:u.value.type,property:this._oMetaData.property}}var _={textAlign:this._getEdmUOMTextAlignment()};if(r==="TwoWay"){_.change=this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:l,unit:true})}var M=this._oHelper.getUOMPath(this._oMetaData);_[o]={model:this._oMetaData.model,path:M,mode:r};this.mapBindings(_,rt._getEmbeddedSmartFieldMapSettings(),e);if(this._oParent.getConfiguration()){_.configuration=new O({preventInitialDataFetchInValueHelpDialog:this._getPreventInitialDataFetchInVHDialog()})}if(i){_.entitySet=i}var D=new ot(g+"-sfEdit",_),v=this;D.data("configdata",{configdata:{currency:l,smartFieldRootControl:this._oParent,measureField:this.oMeasureField,isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:M,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,valuelistType:this._oMetaData.annotations.uom.annotations.valuelistType,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(t){v._updateStaticAmountInputFlexItemData(m);v._updateStaticUOMTextFlexItemData(D);v._updateInnerControl(t,{RTLInTable:d});v._handleUoMAriaDescribedBy(m,t,"add")},onInput:function(t){var e=D&&!D.getVisible();v._updateDynamicAmountInputFlexItemData(m,{isfullWidth:e});v._updateStaticUOMInputFlexItemData(D);v._updateInnerControl(t,{RTLInTable:d});v._handleUoMAriaDescribedBy(m,D,"remove")}}});D.attachVisibleChanged(function(t){var e=this.data("configdata")?.configdata?.measureField;if(!t.getParameter("visible")){v._handleUoMAriaDescribedBy(e,this,"remove")}});D.data("errorCheck","setComplexClientErrorSecondOperandNested");if(D.getVisible()){m.addStyleClass("smartFieldPaddingRight")}m.addStyleClass("sapUiCompSmartFieldValue");var C=new c({justifyContent:X.End,items:[m,D],fitContainer:true,width:this._oParent.getWidth()});C.addStyleClass("sapUiCompUOM");C.enhanceAccessibilityState=function(t,e){this._oParent.enhanceAccessibilityState(t,e)}.bind(this);if(this._oParent.isContextTable()){if(d){C.addStyleClass("sapUiCompDirectionLTR")}C.addStyleClass("sapUiCompUOMInTable");if(a!=="edit"){C.addStyleClass("sapUiCompUOMInTableDisplay")}}return{control:C,onCreate:"_onCreateUOM",params:{getValue:true,valuehelp:true,type:y}}};rt.prototype._createEdmUOMAttributes=function(t){t=t||{};var e=this.createUOMDefaultAttributes(t);var a=rt.getBoundPropertiesMapInfoForControl(g.getMetadata().getName(),{propertyName:"value"})[0];var i=t.bindingMode||"TwoWay";var o=t.currency||this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property);e[a]={mode:r.OneWay,model:this._oMetaData.model,parts:[{mode:i,path:this._oMetaData.path},{mode:i,path:this._oHelper.getUOMPath(this._oMetaData)},{mode:"OneTime",path:o?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],type:o?this._oTypes.getCurrencyType(this._oMetaData.property):this._oTypes.getUoMType(this._oMetaData.property)};return e};rt.prototype.createUOMDefaultAttributes=function(t){return{textAlign:this._getEdmUOMTextAlignment(),placeholder:this.getAttribute("placeholder"),name:this.getAttribute("name"),valueState:this.getValueStateBindingInfoForRecommendationStateAnnotation(),change:this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:t.currency})}};rt.prototype._getEdmUOMTextAlignment=function(){var t=this.getAttribute("textAlign");if(!t){t=$.Initial}if(t===$.Initial){if(this._oParent.isContextTable()){return $.End}return $.Begin}return t};rt.prototype._createEdmUOMDisplay=function(e){var a=this,i=this._oParent.getEntitySet(),o=this._oHelper.getUOMPath(this._oMetaData),r=this._getEdmUOMTextAlignment(),n=null,s=this.getEdmProperty(),l=t.getRTL(),p=l&&this._oParent.isContextTable(),u=this._oHelper.oAnnotation.isCurrency(s),h=rt.getBoundPropertiesMapInfoForControl(ot.getMetadata().getName(),{propertyName:"value"})[0],d=this._getPropertyBindingMode(h)||"TwoWay";var g=rt.getBoundPropertiesMapInfoForControl(m.getMetadata().getName(),{propertyName:"value"})[0];var y={textAlign:r};y[g]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:o},{mode:"OneTime",path:u?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],model:this._oMetaData.model,formatter:this._oTypes.getDisplayFormatter(s,{currency:u,mask:this._oHelper.oAnnotation.isMasked(s),type:this._oTypes.getType(this._oMetaData.property)}),useRawValues:true};if(p){y.textDirection="LTR"}var f=new m(this._oParent.getId()+"-text",y);o=this._oHelper.getUOMPath(this._oMetaData);y={textAlign:this._getEdmUOMTextAlignment()};if(d==="TwoWay"){y.change=this.getUOMChangeHandler({smartFieldRootControl:this._oParent,currency:u,unit:true})}g=rt.getBoundPropertiesMapInfoForControl(ot.getMetadata().getName(),{propertyName:"value"})[0];y[g]={model:this._oMetaData.model,path:o,mode:this._getPropertyBindingMode(g)};this.mapBindings(y,rt._getEmbeddedSmartFieldMapSettings(),e);f.addStyleClass("sapUiCompSmartFieldValue");f.addStyleClass("smartFieldUoMAmountDisplayText");f.addStyleClass("smartFieldPaddingRight");if(this._checkSuppressUnit()){return{control:f}}if(i){y.entitySet=i}n=new ot(this._oParent.getId()+"-sfDisp",y);n.data("configdata",{configdata:{isInnerControl:true,isUOM:!this._oParent.data("configdata"),model:this._oMetaData.model,navigationPath:this._oMetaData.annotations.uom.navigationPath||null,path:o,entitySetObject:this._oMetaData.annotations.uom.entitySet,entityType:this._oMetaData.annotations.uom.entityType,property:this._oMetaData.annotations.uom.property,annotations:{valuelist:this._oMetaData.annotations.valuelistuom,text:this._oMetaData.annotations.textuom},modelObject:this._oMetaData.modelObject||this._oModel,onText:function(t){if(t&&t.setWrapping){t.setWrapping(false)}a._updateInnerControl(t,{RTLInTable:p})},onInput:function(t){a._updateInnerControl(t,{RTLInTable:p})},getContextEditable:function(){return a._oParent.getContextEditable()}}});n.data("errorCheck","setComplexClientErrorSecondOperandNested");var _=new c({alignItems:et.Center,items:[f,n],fitContainer:true,width:this._oParent.getWidth()});_.enhanceAccessibilityState=function(t,e){this._oParent.enhanceAccessibilityState(t,e)}.bind(this);if(this._oParent.isContextTable()){_.setJustifyContent("End");this._oParent.addStyleClass("sapUiCompUOMInTable");if(p){_.addStyleClass("sapUiCompDirectionLTR")}_.addStyleClass("sapUiCompUOMInTable")}return{control:_}};rt.prototype._createEdmUOMObjectStatus=function(){var t,e=this.getEdmProperty(),a=this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(e),i=this._oTypes.getDisplayFormatter(e,{currency:a}),o=this._oHelper.getUOMPath(this._oMetaData),r={};var n=rt.getBoundPropertiesMapInfoForControl(V.getMetadata().getName(),{propertyName:"value"})[0];r[n]={parts:[{path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)},{path:o},{mode:"OneTime",path:a?"/##@@requestCurrencyCodes":"/##@@requestUnitsOfMeasure",targetType:"any"}],formatter:function(){var t=i.apply(this,arguments);return t+arguments[1]},useRawValues:true};r.emptyIndicatorMode=J.Auto;this._addProposedObjectStatusAttributes(r);t=new V(this._oParent.getId()+"-objStatus",r);t.addStyleClass("sapUiCompUOM");return{control:t}};rt.prototype._createEdmUOMObjectNumber=function(){var t,e,a=this._getEdmUOMTextAlignment();var i=rt.getBoundPropertiesMapInfoForControl(S.getMetadata().getName(),{propertyName:"value"});if(this._oMetaData.annotations.uom&&this._oHelper.oAnnotation.isCurrency(this.getEdmProperty(),this._oMetaData.annotations.uom.property.property)){t={model:this._oMetaData.model,textAlign:a};t[i[0]]={parts:[{path:this._oMetaData.path},{path:this._oHelper.getUOMPath(this._oMetaData)},{mode:"OneTime",path:"/##@@requestCurrencyCodes",targetType:"any"}],type:this._oTypes.getCurrencyType(this._oMetaData.property)};t[i[1]]={path:this._oHelper.getUOMPath(this._oMetaData)}}else{t={model:this._oMetaData.model,textAlign:a};t[i[0]]={path:this._oMetaData.path,type:this._oTypes.getType(this._oMetaData.property)};t[i[1]]={path:this._oHelper.getUOMPath(this._oMetaData)}}e=new S(this._oParent.getId()+"-objNumber",t);e.addStyleClass("sapUiCompUOM");return{control:e}};rt.prototype._createEdmSemantic=function(){var t=this,e=this._oParent.getBindingPath("value"),a=this.getEdmProperty(),i=this._getLocalTextAnnotation(),o=i&&i.path||null;var r={semanticObject:this._oMetaData.annotations.semantic.defaultSemanticObject,additionalSemanticObjects:this._oMetaData.annotations.semantic.additionalSemanticObjects,fieldName:e,width:this.getAttribute("width"),emptyIndicatorMode:J.Auto,createControlCallback:function(){var t=this.createControl(true);if(t){return t.control}return null}.bind(this)};this.oType=this._oTypes.getType(this._oMetaData.property);if(o){r.text={parts:[this._oMetaData.path,this._oHelper.getEdmDisplayPath(this._oMetaData)],model:this._oMetaData.model,formatter:function(e,a){if(t.oType){e=t.oType.formatValue(e,"string")}if(t.oType&&t.oType.isA("sap.ui.comp.odata.type.NumericText")&&e===null&&a){e=""}if(e&&a){return t._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",e,a)}return e?e:""}};r.navigationTargetsObtained=function(e){var a=this.getBinding("text");if(!Array.isArray(a.getValue())){e.getParameters().show();return}var i=a.getValue();var o=t._getDisplayBehaviourConfiguration("defaultInputFieldDisplayBehaviour")||"idOnly";var r=E.getTextsFromDisplayBehaviour(o,i[0],i[1]);var n=e.getParameters().mainNavigation;if(n){n.setDescription(r.secondText)}e.getParameters().show(r.firstText,n,undefined,undefined)}}else{var n=this._oHelper.getUOMPath(this._oMetaData);if(n){r.text={parts:[{path:e},{path:n}],model:this._oMetaData.model,formatter:this._oHelper.oAnnotation.isCurrency(a,this._oMetaData.annotations.uom.property.property)?E.getAmountCurrencyFormatter():E.getMeasureUnitFormatter(),useRawValues:true};r.uom={path:n}}else{r.text={path:e,model:this._oMetaData.model,type:this.oType}}}return{control:new M(this._oParent.getId()+"-sl",r),onCreate:"_onCreate",params:{getValue:"getInnerControlValue"}}};rt.prototype._createMultiLineText=function(t){var e=rt.getBoundPropertiesMapInfoForControl(n.getMetadata().getName(),{propertyName:"value"})[0];var a=this.createAttributes(e,this._oMetaData.property,t.attributesNamesMap);var i=this.getFormatSettings("multiLineSettings");a=k(a,i);if(this._oParent.isContextTable()){a.width="100%"}var o=new n(this._oParent.getId()+"-textArea",a);this._enhanceInputControls(o);this._handleEventingForEdmString({control:o,edmProperty:this._oMetaData.property.property});return{control:o,onCreate:"_onCreate",params:{type:{type:a.value.type,property:this._oMetaData.property},getValue:"getValue"}}};rt.prototype._createLink=function(t){var e=this,a=this._oParent,i=a.getBindingInfo("url");var o={text:"",href:""};var r=rt.getBoundPropertiesMapInfoForControl(s.getMetadata().getName(),{propertyName:"url"})[0];if(i){o[r]=this._oBinding.toBinding(i)}else{o[r]=a.getUrl()}if(a.hasListeners("linkPress")){o.press=function(t){t.preventDefault();a.fireLinkPress(t)}}if(a.hasListeners("press")){o.press=function(t){t.preventDefault();a.firePress(t)}}var n=a.getBindingInfo("value");var l=rt.getBoundPropertiesMapInfoForControl(s.getMetadata().getName(),{propertyName:"value"});if(n){var p=this._oMetaData,u=p.path,h=p.property.property;if(p.annotations.text&&h.type==="Edm.String"){o[l[0]]={parts:[p.path,this._oHelper.getEdmDisplayPath(p)],formatter:this._formatText.bind(e)}}else if(rt.isSpecialLink(h)){var d=rt[rt._getLinkFormatterFunctionName(h)];o[l[0]]={path:u};o[l[1]]={path:u,formatter:null};if(typeof d==="function"){o[l[1]].formatter=d}}else if(t){o[l[0]]={path:u,type:this._getDateFormatType()}}else{o[l[0]]=this._oBinding.toBinding(n)}}else{o[l[0]]=a.getValue()}return{control:new s(a.getId()+"-link",o),onCreate:"_onCreate",params:{noValidation:true}}};rt.prototype._createEdmBoolean=function(t){var e=this._oSelector.checkComboBox(t),a=t.mode==="edit",i=this,o=null,r;if(e.combobox){if(a||this._oParent.getFetchValueListReadOnly()){return this._createComboBox({valueHelp:{annotation:e.annotation,noDialog:true,noTypeAhead:true},edit:a})}}var n,s;if(a){s=rt.getBoundPropertiesMapInfoForControl(l.getMetadata().getName(),{propertyName:"value"})[0];n=this.createAttributes(s,this._oMetaData.property,{},{event:"select",parameter:"selected"});r=new l(this._oParent.getId()+"-cBoxBool",n);o={getValue:"getSelected"}}else{s=rt.getBoundPropertiesMapInfoForControl(m.getMetadata().getName(),{propertyName:"value"})[0];n=this.createAttributes(s,this._oMetaData.property,{width:true,textAlign:true});n[s]={model:this._oMetaData.model,path:this._oMetaData.path,formatter:function(t){return i._formatDisplayBehaviour("defaultCheckBoxDisplayBehaviour",t)}};n.renderWhitespace=true;r=new m(this._oParent.getId()+"-text",n)}return{control:r,onCreate:"_onCreate",params:o}};rt.prototype._createValueHelp=function(){var t=this._oParent.getContent();if(!t){return}var e={annotation:this._oMetaData.annotations.valuelist,noDialog:!this._oParent.getShowValueHelp(),noTypeAhead:!this._oParent.getShowSuggestion(),aggregation:"suggestionRows"};this._getValueHelpDialogTitle(e);e.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:t,edmProperty:this.getEdmProperty(),valueHelp:e,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(t){this._oParent.fireValueListChanged({changes:t.mParameters.changes})}.bind(this)})};rt.prototype.getValueListProviderConfiguration=function(t){var e=D.prototype.getValueListProviderConfiguration.apply(this,arguments);if(this._oHelper.oAnnotation.isUpperCase(this._oMetaData.property.property)){e.displayFormat="UpperCase"}return e};rt.prototype._checkSuppressUnit=function(){if(this._oParent.data("suppressUnit")==="true"){return true}var t=this._oParent.getBindingInfo("uomVisible");return!t&&!this._oParent.getUomVisible()};rt.prototype.getEdmProperty=function(){var t=this._oHelper;if(t){return t.getEdmProperty(this._oMetaData)}return null};rt.prototype.getEntityType=function(){if(this._oMetaData){return this._oMetaData.entityType}return null};rt.prototype._checkLink=function(){var t=this._oParent.getBindingInfo("url"),e=this.getEdmProperty();if(t||this._oParent.getUrl()||rt.isSpecialLink(e)){return true}return this._oParent.hasListeners("press")||this._oParent.hasListeners("linkPress")};rt._getEmbeddedSmartFieldMapSettings=function(){return{uomEditable:"editable",uomEnabled:"enabled",uomVisible:"visible",mandatory:"mandatory",contextEditable:"contextEditable"}};rt.getBoundPropertiesMapInfoForControl=function(t,e){e=e||{};var a=null;switch(t){case"sap.m.Input":case"sap.m.TimePicker":case"sap.m.DatePicker":case"sap.m.DateTimePicker":case"sap.m.TextArea":a={value:["value"]};break;case"sap.m.Text":case"sap.m.ObjectIdentifier":case"sap.ui.comp.navpopover.SmartLink":a={value:["text"]};break;case"sap.m.Link":a={url:["href"],value:["text","href"]};break;case"sap.m.ObjectStatus":a={value:["text","state","icon"]};break;case"sap.m.ObjectNumber":a={value:["number","unit"]};break;case"sap.m.Select":case"sap.m.ComboBox":case"sap.ui.comp.smartfield.DisplayComboBox":a={value:["selectedKey"]};break;case"sap.ui.comp.smartfield.ComboBox":a={value:["enteredValue"],realValue:["realValue"]};break;case"sap.m.CheckBox":a={value:["selected"]};break;case"sap.ui.comp.smartfield.SmartField":var i=Object.keys(ot.getMetadata().getProperties());a={};i.forEach(function(t,e,i){a[t]=[i[e]]});break}if(a&&e.propertyName){return a[e.propertyName]||null}return a};rt.isSpecialLink=function(t){return B.isEmailAddress(t)||B.isPhoneNumber(t)||B.isURL(t)};rt._getLinkFormatterFunctionName=function(t){return"_format"+B.getLinkDisplayFormat(t)};rt._formatEmailAddress=function(t){return"mailto:"+t};rt._formatPhoneNumber=function(t){return"tel:"+t};rt._formatURL=function(t){return H.validate(t)?t:""};rt.prototype._formatText=function(t,e){if(t&&e){var a=this._formatDisplayBehaviour("defaultInputFieldDisplayBehaviour",t,e);return W(a)}return t||""};rt.prototype._getCreator=function(t){return this._oSelector.getCreator(t)};rt.prototype._onCreate=function(t,e){var a,i,o,r=true,n=this;if(e){if(e.noValidation){r=false}if(e.valuehelp){this._getValueHelpDialogTitle(e.valuehelp);e.valuehelp.analyser=this._oHelper.getAnalyzer(this._oModel||this._oMetaData.modelObject);this.createValueHelp({control:t,edmProperty:this.getEdmProperty(),valueHelp:e.valuehelp,model:this._oModel||this._oMetaData.modelObject,onValueListChange:function(t){n._oParent.fireValueListChanged({changes:t.mParameters.changes})}})}if(e.getValue){i=e.getValue;e.getValue=function(){return t[i]()}}if(e.type){a=e.type.emptyStringSignificant||false;o=this._oFieldControl.getMandatoryCheck(e.type.property,a);if(o){e.type.type.oFieldControl=o}}}if(r){this.addValidations(t,this._oParent.data("errorCheck")||"setSimpleClientError")}if(!this._checkUOM()){t.addStyleClass("sapUiCompSmartFieldValue")}};rt.prototype._checkUOM=function(){var t=this._oParent.data("configdata");if(t&&t.configdata){if(t.configdata.onInput||t.configdata.onText){return true}}return false};rt.prototype.getValueStateBindingInfoForRecommendationStateAnnotation=function(t,e,a){t=t||this.getEdmProperty();var i=t&&t["com.sap.vocabularies.UI.v1.RecommendationState"];if(!i){return null}U(!(i.Path===undefined),'Missing "Path" attribute of the "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+t.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());U(!(i.Path===""),'Missing path name of "com.sap.vocabularies.UI.v1.RecommendationState" annotation for "'+t.name+'" EDM property of "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());e=e||this._oHelper.findProperty(this._oMetaData.entityType.property,i.Path);U(!!e,'The EDM property was not found in the "'+this._oMetaData.entityType.name+'" entity type. - '+this.getMetadata().getName());if(e&&e.type==="Edm.Byte"){return{model:a||this._oMetaData.model,path:i.Path,formatter:rt.formatRecommendationState}}U(e&&e.type==="Edm.Byte",'The EDM property "'+e.name+'" of "'+this._oMetaData.entityType.name+'" entity type must be typed as Edm.Byte. - '+this.getMetadata().getName());return null};rt.formatRecommendationState=function(t){t=String(t);switch(t){case"0":return K.None;case"1":return K.Information;case"2":return K.Warning;default:return K.None}};rt.prototype._updateDynamicAmountInputFlexItemData=function(t,e){var a=t.getLayoutData()||new z,i="sapUiCompSmartFieldFlexItemAmountEdit",o="";if(a){if(e.isfullWidth){i="sapUiCompSmartFieldFlexItemAmountNoUnitEdit";o="100%"}a.setGrowFactor(1);a.setMaxWidth(o);a.setStyleClass(i);a.setMinWidth("0")}t.setLayoutData(a)};rt.prototype._updateStaticAmountInputFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setGrowFactor(1);e.setMaxWidth("");e.setStyleClass("")}t.setLayoutData(e)};rt.prototype._updateStaticUOMInputFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setShrinkFactor(1);e.setGrowFactor(0);e.setStyleClass("sapUiCompSmartFieldFlexItemUnitEdit");e.setMinWidth("")}t.setLayoutData(e)};rt.prototype._updateStaticUOMTextFlexItemData=function(t){var e=t.getLayoutData()||new z;if(e){e.setShrinkFactor(0);e.setGrowFactor(0);e.setStyleClass("sapUiCompSmartFieldUOMDisplayText");e.setMinWidth("auto")}t.setLayoutData(e)};rt.prototype._updateInnerControl=function(t,e){var a=e.RTLInTable,i,o;if(t){i=typeof t.getParent==="function"?t.getParent():{};o=i&&i.getInnerControls?i.getInnerControls():[];if(a&&typeof t.setTextDirection==="function"){t.setTextDirection("LTR")}t.addStyleClass("sapUiCompSmartFieldUnit");if(o.length>0&&o[0].getEditable&&o[0].getEditable()===true){t.addStyleClass("sapUiCompSmartFieldFlexItemUnitEdit")}}};rt.prototype._getValueHelpDialogTitle=function(t){var e=this.getEdmProperty();t.dialogtitle=this._oParent?.getValueHelpTitleSource()===it.ValueList?this._oHelper.oAnnotation.getValueListLabel(e):this._oParent.getComputedTextLabel();if(!t.dialogtitle){t.dialogtitle=this._oHelper.oAnnotation.getLabel(e)||e.name}};rt.prototype._onCreateUOM=function(t,e){var a=t.getItems(),i;this.addValidations(a[0],"setComplexClientErrorFirstOperand");if(e&&e.getValue){e.getValue=function(){return a[0].getValue()}}e.uom=function(){return a[1].getValue()};e.uomset=function(t){a[1].setValue(t)};if(e.type){i=this._oFieldControl.getMandatoryCheck(e.type.property);if(i){e.type.type.oFieldControl=i}}};rt.prototype.triggerCreationOfControls=function(){try{this._setUOMEditState();this._oFieldControl.bindProperties({metadata:this._oMetaData});this._addLabelAndQuickInfo();if(this._oParent.isContextTable()&&this._oMetaData._isNumber==undefined){this._oMetaData._isNumber=B.isNumber(this._oMetaData.property.property)}}catch(t){w.error(t,null,this.getMetadata().getName())}};rt.prototype._checkTextInDisplayModeValueList=function(t){var e=this._oHelper.getValueListAnnotationPath(this._oMetaData),a=this.getEdmProperty(),i,o;if(!a){return false}o=L.isFiscalValue(a);i=q.isCalendarValue(a);return!!(!o&&!i&&this._oMetaData.annotations&&this._oMetaData.annotations.valuelist!==undefined&&this._getDisplayBehaviourConfiguration()&&(this._oMetaData.property&&(this._oMetaData.property.property.type==="Edm.String"||this._oMetaData.property.property.type==="Edm.Guid"))&&t.mode==="display"&&this._oParent.getFetchValueListReadOnly()&&e&&!(this._oParent.getExpandNavigationProperties&&this._oParent.getExpandNavigationProperties()&&this._oParent.isPropertyInitial("expandNavigationProperties"))&&!this._oHelper.startWithNavigationProperty(e,this._oMetaData)&&!this.isValueInitialWithTextArrangement(a)&&this._getDisplayBehaviourConfiguration()!=="idOnly")};rt.prototype.isValueInitialWithTextArrangement=function(t){var e=this._getLocalTextAnnotation();return this._oParent._isValueInitial()&&e};rt.prototype._hasBoundFieldControl=function(){var t=this._oFieldControl.getPropertyNames();for(var e=0;e<t.length;e++){if(this._oParent.getBinding(t[e])){return true}}return false};rt.prototype.bind=function(t){var e=t.mode,t=t||{};this._bTextInDisplayModeValueList=this._checkTextInDisplayModeValueList(t);if(!(!this._bInitialized&&!this.bPending)&&(!t.rebind&&!this._bTextInDisplayModeValueList)){return Promise.resolve({skipInit:this._bInitializeFromConfig})}this._bInitialized=true;var a=this._oParent.data("configdata");if(a&&a.configdata){try{this._init(this._oMeta);if(this._oMetaData&&this._oMetaData.annotations&&typeof a.configdataVL==="function"){this._bInitializeFromConfig=true;return a.configdataVL().then(function(t){this._initValueList(t);return Promise.resolve({fetchIDAndDescription:true})}.bind(this)).catch(function(t){return Promise.resolve()})}}catch(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}return Promise.resolve()}if(!this._oModel){return Promise.reject()}var i=!!(this._oParent&&this._oParent.isTextInEditModeSourceNotNone());if(!i&&this._oModel.bMetaModelLoaded&&(e!=="display"||!this._oParent.getFetchValueListReadOnly())){try{this._init(this._oMeta)}catch(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded")}}return Promise.resolve()}this.bPending=true;return this._metadataInitialise().then(function a(){if(!this._oParent){this.bPending=false;return Promise.reject()}this._init(this._oMeta);this._bTextInDisplayModeValueList=this._checkTextInDisplayModeValueList(t);if(e!=="display"&&i||this._bTextInDisplayModeValueList){var o=this._oMetaData.annotations.valuelist;if(typeof o==="string"){var r=this._oParent&&this._oParent.getBindingContext()&&this._oParent.getBindingContext().getPath();if(this._oMetaData.functionImportProperty){return this._oHelper.getAnalyzer()._getFunctionImportValueListAnnotationLazy(this._oMetaData.functionImport,this._oMetaData.functionImportProperty,o,r)}else{return this._oHelper.loadValueListAnnotation(o,r)}}else{this.bPending=false;return Promise.reject()}}this.bPending=false}.bind(this)).then(function t(e){var a={fetchIDAndDescription:false};if(!i&&!this._bTextInDisplayModeValueList||!this._oParent){return}this.bPending=false;if(e){this._initValueList(e)}if(e&&this.oTextArrangementDelegate){a.fetchIDAndDescription=true}return a}.bind(this)).catch(function(t){if(t){w.error(t,null,this.getMetadata().getName()+".onMetaModelLoaded");this._oParent._rejectLifecyclePromises("Metadata loading problem.")}}.bind(this))};rt.prototype._metadataInitialise=function(){return Promise.resolve().then(function(){if(this._oParent._bMetaModelLoadAttached){return this._oModel.getMetaModel().loaded()}else{return T.handleModelInit(this._oParent,function(){},true)}}.bind(this)).catch(function(t){w.error("The meta model could not be loaded.",t,this.getMetadata().getName())}.bind(this))};rt.prototype._addLabelAndQuickInfo=function(){var t=this.getDataProperty();t=t.property;var e=this._oHelper.oAnnotation.getLabel(t);var a=this._oHelper.oAnnotation.getQuickInfo(t);if(e){this._oParent._sAnnotationLabel=e}if(a&&this._oParent.isPropertyInitial("tooltipLabel")){this._oParent.setTooltipLabel(a)}};rt.prototype.rebindOnCreated=function(){var t,e=this._oFieldControl.getControlFormatters(this._oMetaData,["editable"]);for(var a in e){t=this._oBinding.fromFormatter(this._oMetaData.model,e[a]);this._oParent.bindProperty(a,t)}};rt.prototype._setUOMEditState=function(){if(this._oFieldControl.hasUomEditState(this._oMetaData)){var t=this._oFieldControl.getUOMEditState(this._oMetaData);if(t){var e=this._oBinding.fromFormatter(this._oMetaData.model,t);this._oParent.bindProperty("uomEditState",e)}}};rt.prototype.getDataProperty=function(){return this._oMetaData.property};rt.prototype.getDropdownItemKeyType=function(t){var e=t.getMetadata().getName(),a=this._isMComboBoxRequired(),i=this._oParent._getComputedTextInEditModeSource(),o=i==="ValueList"?"realValue":"value",r=a?"value":o;if(e==="sap.ui.comp.smartfield.DisplayComboBox"||e==="sap.m.ComboBox"||e==="sap.ui.comp.smartfield.ComboBox"||e==="sap.m.Select"){var n=rt.getBoundPropertiesMapInfoForControl(e,{propertyName:r})[0];const{type:a}=t.getBindingInfo(n);if(a){if(a.oFormatOptions){a.oFormatOptions.bFixedKey=true}return this._oTypes.cloneType(a)}return null}return null};rt.prototype.getMetaData=function(){return this._oMetaData};rt.prototype.getODataHelper=function(){return this._oHelper};rt.prototype._getChangeEventParams=function(t){var e,a={},i=t&&t.getParameters();if(i){e=i.value;a.value=e;a.newValue=e;if(i.validated){a.validated=i.validated}}else{a=t}return a};rt.prototype._getPropertyBindingMode=function(t){var e=typeof this._oParent.getBinding==="function"&&this._oParent.getBinding(t);return e&&typeof e.getBindingMode==="function"&&e.getBindingMode()||"TwoWay"};rt.prototype._getLocalTextAnnotation=function(){var t=this.getMetaData(),e=t&&t.annotations&&t.annotations.text||null;return e};rt.prototype.fetchIDAndDescriptionCollectionIfRequired=function(t){var e=t.mode==="edit"&&this._isFixedList();if(this.oValueListDelegate&&e){this.oValueListDelegate.fetchIDAndDescriptionCollectionIfRequired()}else if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.fetchIDAndDescriptionCollectionIfRequired(t)}};rt.prototype._isFixedList=function(){var t=this.getMetaData();return t&&t.annotations&&t.annotations.valuelistType==="fixed-values"};rt.prototype._isMComboBoxRequired=function(){return this._oSelector&&this._oSelector._oParent&&this._oSelector._oParent.oParent&&this._oSelector._oParent.oParent.isA("sap.ui.comp.smartmultiedit.Field")||this._oParent&&this._oParent.getFixedValueListValidationEnabled&&this._oParent.getFixedValueListValidationEnabled()};rt.prototype.destroy=function(){if(this._oFieldControl){this._oFieldControl.destroy()}if(this._oSelector){this._oSelector.destroy()}if(this._oTypes){this._oTypes.destroy()}if(this._oHelper){this._oHelper.destroy()}if(this.oType){this.oType.destroy();this.oType=null}if(this.oValueListDelegate){this.oValueListDelegate.destroy()}if(this.oTextArrangementDelegate){this.oTextArrangementDelegate.destroy()}this._oHelper=null;this._oFieldControl=null;this._oTypes=null;this._oSelector=null;this._oMetaData=null;this.oMeasureField=null;this.oTextArrangementDelegate=null;D.prototype.destroy.apply(this,arguments)};return rt},true);
//# sourceMappingURL=ODataControlFactory.js.map