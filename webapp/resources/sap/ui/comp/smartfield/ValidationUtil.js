/*
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define("sap/ui/comp/smartfield/ValidationUtil",["sap/ui/comp/library","sap/ui/core/Lib","sap/ui/core/Messaging","sap/ui/core/message/Message","sap/ui/core/message/MessageType","sap/ui/core/message/ControlMessageProcessor","sap/ui/model/ValidateException"],function(e,t,s,i,o,r,a){"use strict";var n=e.smartfield.TextInEditModeSource;var u=function(e){this.oSmartField=e;this.oRB=t.getResourceBundleFor("sap.ui.comp")};u.prototype._getPropertyName=function(e){if(e.isA("sap.ui.comp.smartfield.ComboBox")){return"enteredValue"}else if(e.isA("sap.m.ComboBox")){return"selectedKey"}else{return"value"}};u.prototype._createMessage=function(e,t,o){var r=this._getPropertyName(t),a;this._removeMessage();a=new i({message:this.oRB.getText(e),type:o,target:t.getId()+"/"+r,processor:this._getMessageProcessor()});this._oCurrentMessage=a;s.addMessages(a)};u.prototype._removeMessage=function(){if(this._oCurrentMessage){s.removeMessages(this._oCurrentMessage);this._oCurrentMessage.destroy();this._oCurrentMessage=null}};u.prototype.handleValueListWarning=function(e){var t=this.oSmartField._oControl.edit;if(t&&this.oSmartField._isValueListWarning()){if(e.length===0){this._createMessage("SMARTFIELD_NOT_FOUND",t,o.Warning)}else if(e.length>1){this._createMessage("SMARTFIELD_DUPLICATE_VALUES",t,o.Warning)}else{this._removeMessage()}}};u.prototype._getMessageProcessor=function(){var e;if(this._oMessageProcessor){return this._oMessageProcessor}e=new r;s.registerMessageProcessor(e);this._oMessageProcessor=e;return this._oMessageProcessor};u.prototype.handleComboValidation=function(e){if(!this._isComboBoxValidationWarning()){return}if(e.getEnteredValue()&&!e.getSelectedKey()&&e.getValue()!==""){this._createMessage("SMARTFIELD_NOT_FOUND",e,o.Warning)}else{this._removeMessage()}};u.prototype._isComboBoxValueInvalid=function(e,t,s){if(s===null||s===""&&t.isA("sap.ui.comp.odata.type.NumericText")){return false}return!e.getSelectedItem()&&e.getValue()};u.prototype.addValidationToType=function(e){var t;if(!e){return}t=e.validateValue;if(this._isComboBoxValidationStrict()){e.validateValue=function(s){var i=this.oSmartField._oControl.edit;if(this._isComboBoxValueInvalid(i,e,s)){if(i.getTextArrangement()==="descriptionOnly"){throw new a(this.oRB.getText("SMARTFIELD_NOT_UNIQUE"))}else{throw new a(this.oRB.getText("SMARTFIELD_NOT_FOUND"))}}return t.apply(this,arguments)}.bind(this)}else{e.validateValue=function(){try{t.apply(e,arguments)}catch(e){throw new a(this.oRB.getText("SMARTFIELD_NOT_FOUND"))}}.bind(this)}};u.prototype._isLegacyMode=function(){var e=this.oSmartField;return e._isFixedValueList()&&e.getFixedValueListValidationEnabled()};u.prototype._isComboBoxValidationStrict=function(){if(this._isLegacyMode()){return false}return this.oSmartField._getComputedTextInEditModeSource()===n.ValueList};u.prototype._isComboBoxValidationWarning=function(){if(this._isLegacyMode()){return false}return this.oSmartField._isValueListWarning()};return u},true);
//# sourceMappingURL=ValidationUtil.js.map