/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./Command","../IncludeUsageIdType","../TransformationMatrix"],function(e,r,n){"use strict";var t={};t.createCommand=function(e,r){var n=JSON.stringify(r);return e+("["+n.length+"]")+n};t.createRequestCommand=function(e,r,n){return{command:t.createCommand(e,r),method:e,isInitial:n===true}};t.createRequest=function(e,r,n){return{method:e,parameters:r,isInitial:n===true}};function a(r,n,a){if(!r||!n||!a){throw"ProgressLogger: invalid args"}this.context=n;this.loader=a;var i=new Set;this.logPerformance=function(r,a){if(!r||!a){return}i.add(a);var o={name:r,timestamp:Date.now(),token:a};var u={method:e.addClientLog,url:this.loader.getUrl(),token:n.token,command:t.createCommand(e.addClientLog,o)};this.loader.postMessage(u)};this.getTokens=function(){return i};this.logPerformanceTiming=function(r,a){var o=this;r.sort(function(e,r){return e.timestamp-r.timestamp});if(!r.length){return}i.add(n.token);var u=[];while(r.length){u.push(r.splice(0,10))}u.forEach(function(r){var i={records:[],timestamp:Date.now()};r.forEach(function(e){i.records.push({name:e.name,timestamp:e.timestamp,uuid:e.uuid,duration:e.duration,value:e.value,parent_uuid:a})});var u=t.createCommand(e.performanceTiming,i);o.loader.postPerformanceTiming({method:e.performanceTiming,url:o.loader.getUrl(),token:n.token,command:u})})}}t.mark=function(e){window.performance.mark(e)};t.measure=function(e,r,n){var t=window.performance;if(performance.getEntriesByName(r).length!==0){if(!n){t.measure(e,r)}else{t.measure(e,r,n)}}t.clearMarks(r);if(n){t.clearMarks(n)}t.clearMeasures(e)};t.perfObserve=function(e){if(!window.PerformanceObserver){return}var r=[];var n;var a=performance.timing.navigationStart;var i=new window.PerformanceObserver(function(i){i.getEntries().forEach(function(e){e.uuid=t.generateToken();e.timestamp=a+e.startTime;if(e.name==="sceneMeasure"){n=e.uuid}r.push(e)});if(r.find(function(e){return e.name==="sceneCompleted"})){t.measure("sceneMeasure","modelRequested","sceneCompleted")}if(n){r=r.filter(function(e){return e instanceof PerformanceMeasure});e.progressLogger.logPerformanceTiming(r,n);n=""}});i.observe({entryTypes:["mark","measure"]})};t.createLogger=function(e,r,n){if(!r){return null}r.progressLogger=new a(e,r,n);t.perfObserve(r);return r.progressLogger};t.base64ToUint8Array=function(e){var r=atob(e);var n=r.length;var t=new Uint8Array(n);for(var a=0;a<n;a++){t[a]=r.charCodeAt(a)}return t};t.arrayToColumnMajorMatrixArray16=function(e){if(e.length===16){return e}if(e.length===12){return n.convertTo4x4(e)}if(e.length===3){return[1,0,0,0,0,1,0,0,0,0,1,0,e[0],e[1],e[2],1]}return null};t.pushElementIntoMapArray=function(e,r,n){var t=e.get(r);if(!t){t=[];e.set(r,t)}else if(t.length>0&&t[t.length-1]===n){return t.length}t.push(n);return t.length};t.generateToken=function(){return i()};function i(){function e(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()}var o=["annotationId","closed","contentType","entityId","highlightStyleId","materialId","meshId","name","opacity","renderOrder","renderStage","transform","visible","selectable"];var u=["annotation","bounds","meshes","box","image","highlight","nodes","markers","pointCloudGroups","dynamicContents"];var s=["annotation","drawing","geometry","hotspot","reference","sectionplane","solid","symbol","markers","pointCloudGroup","dynamicContent","svg","unknown"];t.configureSceneViewQuery=function(e){var n=o.slice();var t=u.slice();var a=s.slice();if(e.includeAnimation){t.push("animation")}if(e.includeBackground){a.push("background")}if(e.includeParametric){t.push("parametric");a.push("parametric")}if(e.includeMetadata){t.push("metadata");a.push("metadata")}if(e.includeUsageId){t=t.concat(r.to$expandQueryParameter(e.includeUsageId))}if(e.pushPMI){a.push("pmi")}var i={$select:n.join(","),$expand:t.join(","),contentTypes:a.join(","),hidden:e.includeHidden};if(e.metadataFilter!=null){i.metadataFilter=e.metadataFilter}return i};return t});
//# sourceMappingURL=TotaraUtils.js.map