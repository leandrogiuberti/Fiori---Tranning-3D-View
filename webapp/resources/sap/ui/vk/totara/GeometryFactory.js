/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./IndexCompressor"],function(e){"use strict";const r=1;const t=2;const o=4;const a=16;const n=32;var f=0;var u=3;var i=function(){};i.getGeometryInfo=function(f,u,i){var c=new DataView(u.buffer,u.byteOffset,u.byteLength);var d=0;const m=(f.flags&t)>0;const g=(f.flags&n)>0;const C=(f.flags&o)>0;const y=(f.flags&a)>0;let w=f.pointCount;const F=f.elementCount;const h=F===0;const B=h?false:(f.flags&r)>0;const p=B?2:3;const R=F*p;if(!w){throw"No points in geometry"}var U=i?i.points.subarray(0,w*3):new Float32Array(w*3);var I=null;if(m){I=i?i.normals.subarray(0,w*3):new Float32Array(w*3)}var b=null;if(g){b=i?i.colors.subarray(0,w*3):new Float32Array(w*3)}var A=null;if(C){A=i?i.uvs.subarray(0,w*2):new Float32Array(w*2)}var D;if(h){D=null}else if(i){if(i.indices.length<R){i.indices=new Uint16Array(R)}if(i.previousIndexCount<R){i.previousIndexCount=R}D=i.indices.subarray(0,R)}else{D=new Uint16Array(R)}if(f.encodingType===0){for(var M=0;M<w;++M){U[M*3]=c.getFloat32(d,true);U[M*3+1]=c.getFloat32(d+4,true);U[M*3+2]=c.getFloat32(d+8,true);d+=12;if(m){I[M*3]=c.getFloat32(d,true);I[M*3+1]=c.getFloat32(d+4,true);I[M*3+2]=c.getFloat32(d+8,true);d+=12}if(C){A[M*2]=c.getFloat32(d,true);A[M*2+1]=c.getFloat32(d+4,true);d+=8}}for(var x=0;x<R;++x){D[x]=c.getUint16(d,true);d+=2}}else{var q=new e(u,u.length);q.setCurByte(d);if(!q.ReadCommand()){throw"Buffer overflow 1"}var z=q.rvalue;if(z){if(!s(q,w,z,f.box,U)){throw"Unquantize positions failed"}}var P=1;if(m){if(!q.ReadCommand()){throw"Buffer overflow 2"}P=q.rvalue;if(P){if(!l(q,w,P,I)){throw"Unquantize normals failed"}}}var G=1;var L=false;if(C){if(!q.ReadCommand()){throw"Buffer overflow 3"}G=q.rvalue;if(G){if(!v(q,w,G,A)){throw"Unquantize uvs failed"}L=true}}if(!z||!P||!G||L){if(L){d=q.getCurByte();var N=c.getFloat32(d,true);var O=c.getFloat32(d+4,true);q.moveCurByte(8);if(N!==0||O!==1){var T=O-N;for(var V=0,j=w*2;V<j;V++){A[V]=A[V]*T+N}}}var k;if(!z){d=q.getCurByte();for(k=0;k<w;k++){U[k*3]=c.getFloat32(d+k*4,true);U[k*3+1]=c.getFloat32(d+(k+w)*4,true);U[k*3+2]=c.getFloat32(d+(k+w*2)*4,true)}q.moveCurByte(w*3*4)}if(!P&&m){d=q.getCurByte();for(k=0;k<w;k++){I[k*3]=c.getFloat32(d+k*4,true);I[k*3+1]=c.getFloat32(d+(k+w)*4,true);I[k*3+2]=c.getFloat32(d+(k+w*2)*4,true)}q.moveCurByte(w*3*4)}if(!G&&C){d=q.getCurByte();for(k=0;k<w;k++){A[k*2]=c.getFloat32(d+k*4,true);A[k*2+1]=c.getFloat32(d+(k+w)*4,true)}q.moveCurByte(w*2*4)}}let r,t;if(F>0){const e=q.getCurByte();q.Reset();q.setCurByte(e);let o=[0,0,0];for(r=0;r<F;r++){for(t=0;t<p;t++){if(!q.ReadCommand(o[t])){throw"UIC1 Decompression error - elements"}D[r*p+t]=q.rvalue;o[t]=q.rvalue}}}if(g){if(y){const e=q.getCurByte();q.Reset();q.setCurByte(e);for(r=0;r<F;r++){if(!q.ReadCommand()){throw"UIC1 Decompression error - face ids"}}}const e=q.getCurByte();q.Reset();q.setCurByte(e);if(!q.ReadCommand()){throw"UIC1 Decompression error - colors1"}if(q.rvalue===0){throw"UIC1 Decompression error - colors2"}const o=1/q.rvalue;for(t=0;t<3;++t){for(r=0;r<w;++r){if(!q.ReadCommand()){throw"UIC1 Decompression error - colors3"}b[r*3+t]=o*q.rvalue}}}}return{id:f.id,isPointCloud:h,isPolyline:B,data:{indices:D,points:U,colors:b,normals:I,uvs:A}}};function s(e,r,t,o,a){for(var n=0;n<3;n++){var i=o[f+n];var s=(o[u+n]-i)/t;for(var l=0;l<r;l++){if(!e.ReadCommand()){return false}a[l*3+n]=s*e.rvalue+i}}return true}function l(e,r,t,o){var a;for(a=0;a<r;a++){if(!e.ReadCommand()){return false}o[a*3]=e.rvalue}var n=2*Math.PI/t;var f;var u;var i;for(a=0;a<r;a++){if(!e.ReadCommand()){return false}f=n*o[a*3];u=n*e.rvalue;i=Math.sin(u);o[a*3]=i*Math.cos(f);o[a*3+1]=i*Math.sin(f);o[a*3+2]=Math.cos(u)}return true}function v(e,r,t,o){var a=1/t;for(var n=0;n<2;n++){for(var f=0;f<r;f++){if(!e.ReadCommand()){return false}o[f*2+n]=a*e.rvalue}}return true}return i});
//# sourceMappingURL=GeometryFactory.js.map