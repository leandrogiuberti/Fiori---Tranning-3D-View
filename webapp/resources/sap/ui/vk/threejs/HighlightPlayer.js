/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["sap/ui/base/Object","../HighlightDisplayState"],function(t,e){"use strict";var i=t.extend("sap.ui.vk.threejs.HighlightPlayer",{constructor:function(){this._state=e.stopped;this._startTime=0;this._timeElapsed=0;this._highlightsNodesMap=new Map}});i.prototype.reset=function(t,i){this.stop();this._highlightsNodesMap.clear();this._state=e.stopped;if(t&&i){var s=t.getHighlightIdNodesMap();var a=this;s.forEach(function(t,e){var s=i.getHighlight(e);a.addHighlights(s,t)})}return this};i.prototype.setViewStateManager=function(t){this._viewStateManager=t};i.prototype.addHighlights=function(t,e){if(t&&e&&e.length){this._highlightsNodesMap.set(t,{nodes:e})}};i.prototype.start=function(t){if(this._state===e.pausing){this._startTime=t-this._timeElapsed}else{this._startTime=t;this._timeElapsed=0}this._state=e.playing;var i=this._viewStateManager;this._highlightsNodesMap.forEach(function(t,e){var s=[];t.nodes.forEach(function(t){while(t){if(!i.getVisibilityState(t)){i.setVisibilityState(t,true,false);s.push(t)}t=t.parent}});t.hiddenNodes=s.length>0?s:undefined})};i.prototype.play=function(t){if(this._state!==e.playing){return false}this._timeElapsed=t-this._startTime;var i=[];this._highlightsNodesMap.forEach(function(t,e){const s=e.evaluate(this._timeElapsed/1e3);if(s.color!=null){this._viewStateManager.setNodesHighlightColor(t.nodes,s.isCompleted?null:s.color)}if(s.opacity!=null){this._viewStateManager.setOpacity(t.nodes,s.isCompleted?null:s.opacity)}if(s.isCompleted){if(e.isFadeOut()&&t.hiddenNodes!==undefined){this._viewStateManager.setVisibilityState(t.hiddenNodes,false,false)}if(e.isFadeInOut()){i.push(e)}}},this);i.forEach(function(t){this._highlightsNodesMap.delete(t)},this);if(this._highlightsNodesMap.size===0){this._state=e.stopped;return false}return true};i.prototype.stop=function(t){this._timeElapsed=0;this._startTime=0;var i=this;this._highlightsNodesMap.forEach(function(t,e){i._viewStateManager.setNodesHighlightColor(t.nodes,null);i._viewStateManager.setOpacity(t.nodes,null);if(e.isFadeOut()&&t.hiddenNodes!=undefined){i._viewStateManager.setVisibilityState(t.hiddenNodes,false,false)}});this._state=e.stopped;return this};i.prototype.pause=function(t){if(this._state===e.stopped){return this}this._timeElapsed=t-this._startTime;this._state=e.pausing;return this};return i});
//# sourceMappingURL=HighlightPlayer.js.map