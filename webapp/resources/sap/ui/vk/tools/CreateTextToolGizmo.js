/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./CreateParametricGizmo","../svg/Element","../svg/Text","sap/ui/richtexteditor/RichTextEditor","sap/m/Popover","sap/m/VBox","sap/m/Button","sap/m/library"],function(t,e,o,i,n,r,s,a){"use strict";const l=a.PlacementType;var p=t.extend("sap.ui.vk.tools.CreateTextToolGizmo",{metadata:{library:"sap.ui.vk"},renderer:{apiVersion:2,render:function(t,e){t.openStart("div",e);t.style("position","absolute");t.style("pointer-events","none");t.openEnd();t.close("div")}}});p.prototype.hasDomElement=function(){return true};p.prototype.show=function(t,e){this._viewport=t;this._tool=e;this._editForm=null;this.updateParentNode()};p.prototype.hide=function(){this._viewport=null;this._tool=null;this._root=null;if(this._editForm){this._editForm.close();this._editForm=null}};p.prototype._createText=function(t,i){if(this._editForm){return}var n=1/this._viewport._camera.zoom;var r=e._multiplyMatrices(e._invertMatrix(this._root._matrixWorld()),[n,0,0,n,t.x,t.y]);var s=[1,0,0,r[3]<0?-1:1,0,0];if(r[3]<0){r[2]*=-1;r[3]*=-1}var a=new o({subelement:true,text:i,style:{size:this._tool.getFontSize(),fontFace:this._tool.getFontFace()},matrix:s,lineStyle:this._tool._lineStyle,fillStyle:this._tool._fillStyle});var l=new e({name:"Text",matrix:r});l.add(a);this._root.add(l);this._editText(a)};p.prototype._editText=function(t){var o=this.getDomRef();if(!o){this._editElementWhenReady=t;return}var a=e._transformPoint(t.x,t.y,t._matrixWorld());var p=this._viewport._camera._worldToScreen(a.x,a.y);o.style.left=p.x+"px";o.style.top=p.y+"px";var h=this._editForm=new n({showHeader:false,placement:l.PreferredLeftOrFlip,content:new r({items:[new i({width:"500px",height:"200px",wrapping:false,customToolbar:true,showGroupUndo:true,showGroupFont:true,showGroupTextAlign:false,value:t.getHtmlTextContent(),change:function(e){t.setHtmlTextContent(this.getValue())},customButtons:[new s({text:"OK",press:function(){h.close()}})]}).addStyleClass("sapUiSizeCompact"),new s({text:"OK",press:function(){h.close()}})]})});h.attachAfterClose(function(){this._tool.fireCompleted({node:t.parent,request:this._createRequest(t.parent)});this._editForm=null}.bind(this));h.openBy(this)};p.prototype.onAfterRendering=function(){if(this._editElementWhenReady){this._editText(this._editElementWhenReady);this._editElementWhenReady=null}};return p});
//# sourceMappingURL=CreateTextToolGizmo.js.map