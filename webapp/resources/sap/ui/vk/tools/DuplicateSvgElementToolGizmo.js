/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./CreateParametricGizmo","../svg/Element","./ToolNodeSet"],function(t,i,e){"use strict";var o=t.extend("sap.ui.vk.tools.DuplicateSvgElementToolGizmo",{metadata:{library:"sap.ui.vk"},renderer:null});o.prototype.hasDomElement=function(){return false};var r=30;var s=30;o.prototype.show=function(t,i){this._viewport=t;this._tool=i;this._updateNodeList()};o.prototype.hide=function(){this._clearNodeList();this._viewport=null;this._tool=null};o.prototype._clearNodeList=function(){if(this._nodes&&this._nodes.length>0){this._nodes.forEach(function(t){var i=t.node;i.parent.remove(i)})}this._nodes=[]};o.prototype._updateNodeList=function(){this._clearNodeList();this._origin=null;var t=this._tool.getNodeList();if(Array.isArray(t)&&t.length>0){this.updateParentNode();this._parentMatrixWorldInv=i._invertMatrix(this._root._matrixWorld());var e=t[0]._getBBox(t[0]._matrixWorld());this._origin=e?{x:e.x+e.width*.5,y:e.y+e.height*.5}:{x:0,y:0};var o=this._viewport._camera._transformRect({x1:0,y1:0,x2:r,y2:s});this._createNodes({x:this._origin.x+o.x2-o.x1,y:this._origin.y+o.x2-o.x1})}};o.prototype._createNodes=function(t){var e=[1,0,0,1,t.x-this._origin.x,t.y-this._origin.y];this._nodes=[];this._tool.getNodeList().forEach(function(t){var o=t.clone();o.userData.duplicatedFrom=t.sid;var r=t._matrixWorld();o.matrix.set(i._multiplyMatrices(this._parentMatrixWorldInv,i._multiplyMatrices(e,r)));this._root.add(o);this._nodes.push({node:o,matrixWorld:t._matrixWorld()})}.bind(this))};o.prototype._move=function(t){if(this._nodes&&this._nodes.length>0){var e=[1,0,0,1,t.x-this._origin.x,t.y-this._origin.y];var o=this._parentMatrixWorldInv;this._nodes.forEach(function(t){var r=i._multiplyMatrices(o,i._multiplyMatrices(e,t.matrixWorld));t.node.setMatrix(r)})}};o.prototype._complete=function(t){this._move(t);if(this._nodes&&this._nodes.length>0){var i=this._nodes.map(function(t){return t.node});this._tool.fireNodesCreated({x:t.x-this._origin.x,y:t.y-this._origin.y,nodes:i,request:this._createRequest(i)});this._createNodes(t)}};return o});
//# sourceMappingURL=DuplicateSvgElementToolGizmo.js.map