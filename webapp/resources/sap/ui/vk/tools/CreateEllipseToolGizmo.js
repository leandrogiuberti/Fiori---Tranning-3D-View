/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./CreateParametricGizmo","../svg/Element","../svg/Ellipse"],function(t,e,i){"use strict";var a=t.extend("sap.ui.vk.tools.CreateEllipseToolGizmo",{metadata:{library:"sap.ui.vk"},renderer:null});a.prototype.hasDomElement=function(){return false};a.prototype.show=function(t,e){t.addStyleClass("sapVizKitViewportCreateToolActive");this._viewport=t;this._tool=e;this.updateParentNode()};a.prototype.hide=function(){this._viewport.removeStyleClass("sapVizKitViewportCreateToolActive");this._viewport=null;this._tool=null;this._root=null};a.prototype._calculateNodeMatrix=function(t,i,a,r){var o=e._multiplyMatrices(this._invParentMatrix,[t,i,-i,t,a,r]);var s=o[0]*o[3]-o[1]*o[2];if(s<0){o[2]*=-1;o[3]*=-1}if(o[3]<0){o[0]*=-1;o[1]*=-1;o[2]*=-1;o[3]*=-1}return o};a.prototype._startAdding=function(t){this._invParentMatrix=e._invertMatrix(this._root._matrixWorld());this._startPos=t;var a=this._viewport._camera._transformRect({x1:0,y1:0,x2:1,y2:1});this._minRadius=Math.max(a.x2-a.x1,a.y2-a.y1)*.5;this._activeElement=new i({subelement:true,major:this._minRadius,minor:this._minRadius,material:this._tool._material,lineStyle:this._tool._lineStyle,fillStyle:this._tool._fillStyle});var r=new e({name:"Ellipse",matrix:this._calculateNodeMatrix(1,0,t.x,t.y)});this._setPageIndexIfExists(r);r.add(this._activeElement);this._root.add(r)};a.prototype._update=function(t,e){var i=this._startPos;var a=this._activeElement;if(a){var r=t.x-i.x;var o=t.y-i.y;var s=Math.sqrt(r*r+o*o);var l=this._tool.getUniformMode()^e;if(s===0||l){r=1;o=0}else{r/=s;o/=s}var n=Math.max(s*.5,this._minRadius);var _=l?n:n*.5;a.rx=Math.max(n,this._minRadius);a.ry=Math.max(_,this._minRadius);a.parent.setMatrix(this._calculateNodeMatrix(r,o,(t.x+i.x)*.5,(t.y+i.y)*.5));a.invalidate()}};a.prototype._stopAdding=function(t){var e=this._activeElement;this._activeElement=null;if(t){this._tool.fireCompleted({node:e.parent,request:this._createRequest(e.parent)})}else{this._root.remove(e.parent)}};return a});
//# sourceMappingURL=CreateEllipseToolGizmo.js.map