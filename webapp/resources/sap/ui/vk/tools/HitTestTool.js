/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./Tool","./HitTestToolHandler","./HitTestIdMode","../thirdparty/three"],function(e,t,i,r){"use strict";var s=e.extend("sap.ui.vk.tools.HitTestTool",{metadata:{library:"sap.ui.vk",properties:{IdMode:{type:"sap.ui.vk.tools.HitTestIdMode",defaultValue:i.ThreeJS}},events:{hit:{parameters:{id:"any",object:"any",point:"any",clickType:"sap.ui.vk.tools.HitTestClickType"}}}},constructor:function(i,r){if(s._instance){return s._instance}e.apply(this,arguments);this.setToolid("63150593-75f6-c330-2a7a-c1f85d36b2b9");this._viewport=null;this._handler=new t(this);this._loco=null;s._instance=this;return this}});s.prototype.init=function(){if(e.prototype.init){e.prototype.init.call(this)}this.setFootprint(["sap.ui.vk.threejs.Viewport"])};s.prototype.setActive=function(t,i,r){e.prototype.setActive.call(this,t,i,r);if(this._viewport){if(t){this._prepare()}else{this._removeLocoHandler()}}return this};s.prototype._prepare=function(){if(!this._addLocoHandler()){return false}var e=false;if(this.isViewportType("sap.ui.vk.dvl.Viewport")&&this._viewport._dvl){this._dvlRendererId=this._viewport._dvlRendererId;this._dvl=this._viewport._dvl;e=true}else if(this.isViewportType("sap.ui.vk.threejs.Viewport")&&(this._viewport._scene&&this._viewport._scene.getSceneRef())){e=true}return e};s.prototype.queueCommand=function(e){if(this._prepare()){if(this._dvlRendererId){this._dvl.Renderer._queueCommand(e,this._dvlRendererId)}}return this};s.prototype.hitTest=function(e,t,r,s,o){if(this._prepare()){var p=null;if(this.isViewportType("sap.ui.vk.dvl.Viewport")&&this._viewport._dvl){return null}else if(this.isViewportType("sap.ui.vk.threejs.Viewport")){if(!r||!s){p=null}else if(this._viewport._renderer){p=this._viewport.hitTest(e,t)}}var n=null;if(p){var l;switch(this.getIdMode()){case i.VEsID:l=this._viewport._scene.nodeRefToPersistentId(p.object);break;case i.ThreeJS:l=p.object.id;break;default:l=p.object.id;break}n={id:l,object:p.object,point:p.point,clickType:o};this.fireHit(n)}return n}return null};return s});
//# sourceMappingURL=HitTestTool.js.map