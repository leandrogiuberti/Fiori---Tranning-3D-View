/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["./library","./Core","sap/ui/core/library","sap/ui/core/Element","./DrawerToolbarRenderer","sap/ui/core/Control","sap/ui/core/IconPool","sap/ui/core/ResizeHandler","sap/ui/core/InvisibleText","sap/ui/Device","sap/m/VBox","sap/m/HBox","sap/m/FlexItemData","sap/m/OverflowToolbar","sap/ui/core/Icon","sap/m/OverflowToolbarButton","sap/m/Button","sap/m/Input","sap/m/Text","sap/m/ToolbarSeparator","sap/m/OverflowToolbarToggleButton","sap/m/OverflowToolbarMenuButton","./tools/RectSelectTool","./tools/CrossSectionTool","sap/m/Menu","sap/m/MenuItem","./NavigationMode","./ZoomTo","./getResourceBundle","./ToggleMenuButton","./ToggleMenuItem","./Viewport","./DrawerToolbarButton","sap/ui/base/ManagedObjectObserver","sap/ui/core/Core","./tools/HighlightMeasurementTool","./tools/CalibrateDistanceMeasurementTool","./tools/DeleteMeasurementTool","./tools/DistanceMeasurementTool","./tools/AngleMeasurementTool","./tools/AreaMeasurementTool","./thirdparty/three","sap/m/library"],function(e,t,i,o,n,s,a,r,l,u,c,g,h,_,d,m,p,T,f,v,I,w,b,P,x,E,M,S,y,V,B,O,C,R,A,D,N,F,z,L,k,U,W){"use strict";const H=W.ToolbarDesign;const G=W.ButtonType;const Z=W.FlexRendertype;const K=W.FlexAlignItems;const Q=W.FlexAlignContent;const X=i.TextAlign;const j=i.ValueState;const Y=W.InputType;var q=s.extend("sap.ui.vk.DrawerToolbar",{metadata:{library:"sap.ui.vk",properties:{expanded:{type:"boolean",defaultValue:true},navigationMode:{type:"sap.ui.vk.NavigationMode",defaultValue:M.Turntable}},aggregations:{content:{type:"sap.ui.core.Control",multiple:true,forwarding:{getter:"_getToolbar",aggregation:"content",forwardBinding:true}},_container:{type:"sap.m.VBox",multiple:false,visibility:"hidden"}},associations:{viewport:{type:"sap.ui.vk.ViewportBase",multiple:false}},events:{expanded:{parameters:{expand:{type:"boolean"}}}}},constructor:function(e,t){s.apply(this,arguments)}});var J=[{name:"show",unicode:"e900"},{name:"hide",unicode:"e901"},{name:"turntable",unicode:"e902"},{name:"orbit",unicode:"e903"},{name:"pan",unicode:"e904"},{name:"zoom",unicode:"e905"},{name:"fit-to-view",unicode:"e906"},{name:"rectangular-selection",unicode:"e907"},{name:"predefined-views",unicode:"e93c"},{name:"predefined-views-left",unicode:"e94b"},{name:"predefined-views-right",unicode:"e94c"},{name:"predefined-views-top",unicode:"e94d"},{name:"predefined-views-bottom",unicode:"e949"},{name:"predefined-views-front",unicode:"e94a"},{name:"predefined-views-back",unicode:"e948"},{name:"cross-section",unicode:"e913"},{name:"cross-section-x",unicode:"e914"},{name:"cross-section-y",unicode:"e916"},{name:"cross-section-z",unicode:"e915"},{name:"reverse-direction",unicode:"e917"},{name:"distance-measurement",unicode:"e92b"},{name:"angle-measurement",unicode:"e926"},{name:"area-measurement",unicode:"e963"},{name:"settings",unicode:"e909"},{name:"calibrate-distance",unicode:"e968"},{name:"toggle-pmi",unicode:"e96d"},{name:"fit-to-page",unicode:"e96e"},{name:"fit-to-width",unicode:"e96f"},{name:"flip-board-vertically",unicode:"e973"},{name:"flip-board-horizontally",unicode:"f976"},{name:"partially-visible-layer",unicode:"e974"},{name:"partially-visible-element",unicode:"f975"},{name:"rotate-board-cw",unicode:"e970"},{name:"rotate-board-ccw",unicode:"e971"}];var $="vk-icons";var ee="vk-icons";J.forEach(function(e){a.addIcon(e.name,$,ee,e.unicode)});var te="sap-icon://vk-icons/";q.prototype.init=function(){if(s.prototype.init){s.prototype.init.apply(this)}this._measurementsToggleButton=null;this._distanceMeasurementItem=null;this._angleMeasurementItem=null;this._areaMeasurementItem=null;this._deleteMeasurementItem=null;this._measurementSettingsItem=null;this._calibrateDistanceMeasurementItem=null;this._itemsVisibility=new Map;this._itemsVisibilityObserver=new R(this._itemVisibilityChanged.bind(this));this._toolbar=new _({asyncMode:true,width:"auto",design:H.Solid,layoutData:new h({growFactor:0,shrinkFactor:0}),content:this.createButtons()}).addStyleClass("drawerToolbarMaxWidth").data("help-id","sapUiVkToolbar",true);this._toolbar.ontouchstart=function(e){e.setMarked()};this._toolbarObserver=new R(this._toolbarContentChanged.bind(this));this._toolbarObserver.observe(this._toolbar,{aggregations:["content"]});this._container=new c({renderType:Z.Bare,alignContent:Q.Center,alignItems:K.Center,items:[this._toolbar,new d({src:"sap-icon://navigation-up-arrow",tooltip:this._getTooltip(),press:function(e){this._toggleExpanded();this._updateTooltip(e.getSource())}.bind(this),layoutData:new h({growFactor:0,shrinkFactor:0})}).addStyleClass("drawerToolbarIcon")]}).data("help-id","sapUiVkToolbarContainer",true);this.setAggregation("_container",this._container);this._rectSelectTool=new b;this._distanceMeasurementTool=new z({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._distanceMeasurementItem.getId()){this._measurementsToggleButton.setPressed(e.getParameter("enabled"))}},this]});this._angleMeasurementTool=new L({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._angleMeasurementItem.getId()){this._measurementsToggleButton.setPressed(e.getParameter("enabled"))}},this]});this._areaMeasurementTool=new k({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._areaMeasurementItem.getId()){this._measurementsToggleButton.setPressed(e.getParameter("enabled"))}},this]});this._deleteMeasurementTool=new F({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._deleteMeasurementItem.getId()){this._measurementsToggleButton.setPressed(e.getParameter("enabled"));if(this._getViewport().getMeasurementSurface().getMeasurements().length===0){this._measurementsToggleButton.setDefaultItem(this._distanceMeasurementItem)}}},this]});this._calibrateDistanceMeasurementTool=new N({enabled:[function(e){if(this._measurementsToggleButton.getDefaultItem()===this._calibrateDistanceMeasurementItem.getId()){var t=e.getParameter("enabled");this._measurementsToggleButton.setPressed(t);if(!t){this._measurementsToggleButton.setDefaultItem(this._distanceMeasurementItem)}}},this]});this._highlightMeasurementTool=new D;var e=[this._distanceMeasurementTool,this._angleMeasurementTool,this._areaMeasurementTool,this._deleteMeasurementTool,this._calibrateDistanceMeasurementTool];function i(t){var i=e.find(function(e){return e.getActive()});this._highlightMeasurementTool.setActive(i==null,this._getViewport())}e.forEach(function(e){e.attachEnabled(i,this)},this);var o=t.getEventBus();o.subscribe("sap.ui.vk","viewActivated",this._onViewActivated,this);o.subscribe("sap.ui.vk","readyForAnimation",this._onReadyForAnimation,this)};q.prototype.exit=function(){o.getElementById(this.getViewport())?.detachResize(this._onViewportResize,this);var e=t.getEventBus();e.unsubscribe("sap.ui.vk","readyForAnimation",this._onReadyForAnimation,this);e.unsubscribe("sap.ui.vk","viewActivated",this._onViewActivated,this);this._distanceMeasurementTool.destroy();this._distanceMeasurementTool=null;this._angleMeasurementTool.destroy();this._angleMeasurementTool=null;this._highlightMeasurementTool.destroy();this._highlightMeasurementTool=null;this._areaMeasurementTool.destroy();this._areaMeasurementTool=null;this._deleteMeasurementTool.destroy();this._deleteMeasurementTool=null;this._calibrateDistanceMeasurementTool.destroy();this._calibrateDistanceMeasurementTool=null;this._measurementsToggleButton=null;this._distanceMeasurementItem=null;this._angleMeasurementItem=null;this._areaMeasurementItem=null;this._deleteMeasurementItem=null;this._measurementSettingsItem=null;this._calibrateDistanceMeasurementItem=null;this._toolbarObserver.disconnect();this._toolbarObserver=null;this._toolbar.destroy();this._toolbar=null};q.prototype._onViewportResize=function(e){this._toolbar.onLayoutDataChange()};q.prototype.setViewport=function(e){o.getElementById(this.getViewport())?.detachResize(this._onViewportResize,this);this.setAssociation("viewport",e);e?.attachResize(this._onViewportResize,this);e?.attachEvent("documentReplaced",{},this._onDocumentReplaced,this);e?.attachEvent("pageChanged",{},this._onPageChanged,this)};q.prototype._onDocumentReplaced=function(e){this._pdfDocument=e.getParameter("newDocument");if(this._pdfDocument==null){this._pdfTotalPages=0;this._totalPageCountText.setText("0");this._currentPageIndexInput.setValue("");this._currentPageIndexInput.setEnabled(false);this._previousPageButton.setEnabled(false);this._nextPageButton.setEnabled(false);this._zoomInButton.setEnabled(false);this._zoomOutButton.setEnabled(false);this._zoomToFitPageButton.setEnabled(false);this._zoomToFitPageWidthButton.setEnabled(false)}else{this._pdfTotalPages=this._pdfDocument.pageCount;this._totalPageCountText.setText(`${this._pdfTotalPages}`);this._currentPageIndexInput.setEnabled(true);this._previousPageButton.setEnabled(this._pdfPageIndex!==0);this._nextPageButton.setEnabled(this._pdfPageIndex+1!==this._pdfTotalPages);this._zoomInButton.setEnabled(true);this._zoomOutButton.setEnabled(true);this._zoomToFitPageButton.setEnabled(true);this._zoomToFitPageWidthButton.setEnabled(true)}};q.prototype._onPageChanged=function(e){this._pdfPageIndex=e.getParameter("newPageIndex");this._invisPageIndex.setText(y().getText("PAGE_COUNT_INPUT",[this._pdfPageIndex+1,this._pdfTotalPages]));this._currentPageIndexInput.setValue(this._pdfPageIndex+1);this._currentPageIndexInput.setValueState(j.None);this._previousPageButton.setEnabled(this._pdfPageIndex!==0);this._nextPageButton.setEnabled(this._pdfPageIndex+1!==this._pdfTotalPages)};q.prototype._toolbarContentChanged=function(){var e=this._toolbar.getContent();for(var t=0;t<e.length;t++){if(e[t].getMetadata().getName()=="sap.m.ToolbarSeparator"){if(e[t-1]==undefined||e[t+1]==undefined||e[t-1].getMetadata().getName()=="sap.m.ToolbarSeparator"){this._toolbar.removeContent(t)}}}};q.prototype._itemVisibilityChanged=function(e){if(!this._ignoreVisibilityChange){this._itemsVisibility.set(e.object,e.current)}};function ie(e){return e?e.getMetadata().getName()==="sap.ui.vk.threejs.Viewport":false}function oe(e){return e?e.getMetadata().getName()==="sap.ui.vk.svg.Viewport":false}function ne(e){return e?e.getMetadata().getName()==="sap.ui.vk.NativeViewport":false}function se(e){return e?e.getMetadata().getName()==="sap.ui.vk.pdf.Viewport":false}function ae(e){return e?oe(e)&&e.isECAD():false}function re(e){var t=e.getCurrentView&&e.getCurrentView();var i=t&&t.getDimension();return ie(e)&&!e._redlineHandler&&!e._isPlanarActivated()&&i!==2}q.prototype._getViewport=function(){var e=o.getElementById(this.getViewport());e=e instanceof O&&e.getImplementation()||e;return e&&(ie(e)||oe(e)||ne(e)||se(e))?e:null};q.prototype._getViewStateManager=function(){var e=o.getElementById(this.getViewport());var t=e.getViewStateManager();if(t){return o.getElementById(t)}return null};var le=[null,(new U.Quaternion).setFromAxisAngle(new U.Vector3(0,1,0),0),(new U.Quaternion).setFromAxisAngle(new U.Vector3(0,1,0),Math.PI),(new U.Quaternion).setFromAxisAngle(new U.Vector3(0,1,0),-Math.PI/2),(new U.Quaternion).setFromAxisAngle(new U.Vector3(0,1,0),Math.PI/2),(new U.Quaternion).setFromAxisAngle(new U.Vector3(1,0,0),-Math.PI/2),(new U.Quaternion).setFromAxisAngle(new U.Vector3(1,0,0),Math.PI/2)];q.prototype.createButtons=function(){var e=this;var t=y();var i=new V({type:G.Transparent,tooltip:t.getText("CROSS_SECTION_TOOLTIP"),items:[new B({icon:te+"cross-section-x",text:t.getText("CROSS_SECTION_X"),key:0}),new B({icon:te+"cross-section-y",text:t.getText("CROSS_SECTION_Y"),key:1}),new B({icon:te+"cross-section-z",text:t.getText("CROSS_SECTION_Z"),key:2}),new B({icon:te+"reverse-direction",text:t.getText("CROSS_SECTION_REVERSE"),startsSection:true,toggleable:false,press:function(t){var i=e._getViewport();if(i&&e._crossSectionTool&&e._crossSectionTool.getActive()){e._crossSectionTool.setFlip(!e._crossSectionTool.getFlip())}}})],itemToggled:function(t){var i=e._getViewport();if(i&&e._crossSectionTool){var o=t.getParameter("newItem");e._crossSectionTool.setActive(o!=null,i);if(o){var n=parseInt(o.getKey(),10);if(n>=0&&n<3){e._crossSectionTool.setAxis(n)}}}}});i.vitId=C.CrossSection;var n=new I({icon:te+"turntable",type:G.Transparent,text:t.getText("TURNTABLE_TOOLTIP"),tooltip:t.getText("TURNTABLE_TOOLTIP"),press:function(t){e.setNavigationMode(M.Turntable)}});n.vitId=C.Turntable;var s=new I({icon:te+"orbit",type:G.Transparent,text:t.getText("ORBIT_TOOLTIP"),tooltip:t.getText("ORBIT_TOOLTIP"),pressed:false,press:function(t){e.setNavigationMode(M.Orbit)}});s.vitId=C.Orbit;var a=new I({icon:te+"pan",type:G.Transparent,text:t.getText("PAN_TOOLTIP"),tooltip:t.getText("PAN_TOOLTIP"),press:function(t){e.setNavigationMode(M.Pan)}});a.vitId=C.Pan;var r=new I({icon:te+"zoom",type:G.Transparent,text:t.getText("ZOOM_TOOLTIP"),tooltip:t.getText("ZOOM_TOOLTIP"),press:function(){e.setNavigationMode(M.Zoom)}});r.vitId=C.Zoom;this._gestureButtons=[n,s,a,r];var u=new m({icon:te+"show",type:G.Transparent,text:t.getText("SHOW_TOOLTIP"),tooltip:t.getText("SHOW_TOOLTIP"),press:function(){var t=e._getViewStateManager();if(t){var i=[];t.enumerateSelection(function(e){i.push(e)});t.setVisibilityState(i,true,false)}}});u.vitId=C.Show;var c=new m({icon:te+"hide",type:G.Transparent,text:t.getText("HIDE_TOOLTIP"),tooltip:t.getText("HIDE_TOOLTIP"),press:function(){var t=e._getViewStateManager();if(t){var i=[];t.enumerateSelection(function(e){i.push(e)});t.setVisibilityState(i,false,false)}}});c.vitId=C.Hide;this._fitToView=new m({icon:te+"fit-to-view",type:G.Transparent,text:t.getText("FIT_TO_VIEW"),tooltip:t.getText("FIT_TO_VIEW"),press:function(){var t=o.getElementById(e.getViewport());t=t instanceof O&&t.getImplementation()||t;if(t){t.zoomTo(S.All,null,.5,0)}}});this._fitToView.vitId=C.FitToView;this._fitToViewSeparator=new v;this._fitToViewSeparator.vitId=C.FitToViewSeparator;this._rectSelectionButton=new I({icon:te+"rectangular-selection",type:G.Transparent,text:t.getText("RECTANGULAR_SELECTION_TOOLTIP"),tooltip:t.getText("RECTANGULAR_SELECTION_TOOLTIP")});this._rectSelectionButton.vitId=C.RectangularSelection;var h=new w({icon:te+"predefined-views",activeIcon:te+"predefined-views",type:G.Transparent,text:t.getText("PREDEFINED_VIEW_MENUBUTTONTOOLTIP"),tooltip:t.getText("PREDEFINED_VIEW_MENUBUTTONTOOLTIP"),menu:new x({items:[new E({icon:te+"predefined-views",text:t.getText("PREDEFINED_VIEW_INITIAL")}),new E({icon:te+"predefined-views-front",text:t.getText("PREDEFINED_VIEW_FRONT"),startsSection:true}),new E({icon:te+"predefined-views-back",text:t.getText("PREDEFINED_VIEW_BACK")}),new E({icon:te+"predefined-views-left",text:t.getText("PREDEFINED_VIEW_LEFT")}),new E({icon:te+"predefined-views-right",text:t.getText("PREDEFINED_VIEW_RIGHT")}),new E({icon:te+"predefined-views-top",text:t.getText("PREDEFINED_VIEW_TOP")}),new E({icon:te+"predefined-views-bottom",text:t.getText("PREDEFINED_VIEW_BOTTOM")})]}).attachItemSelected(function(t){var i=e._getViewport();if(i){var o=t.getParameters("item").item;var n=this.indexOfItem(o);i._viewportGestureHandler.setView(le[n],1e3)}})});h.vitId=C.PredefinedViews;var _=new m({icon:"sap-icon://full-screen",type:G.Transparent,press:()=>{const e=this._getViewport();const t=e.getDomRef();if(document.fullscreenElement===t){document.exitFullscreen()}else{t.requestFullscreen()}}}).addStyleClass("sapUiVkFullScreenDrawerToolbarButton");_.vitId=C.FullScreen;_.getTooltip=()=>{const e=this._getViewport().getDomRef();if(document.fullscreenElement===e){return t.getText("EXIT_FULLSCREEN")}else{return t.getText("ENTER_FULLSCREEN")}};this._distanceMeasurementItem=new B({icon:te+"distance-measurement",text:t.getText("MEASUREMENTS_DISTANCE_MENUITEM")});this._angleMeasurementItem=new B({icon:te+"angle-measurement",text:t.getText("MEASUREMENTS_ANGLE_MENUITEM")});this._areaMeasurementItem=new B({icon:te+"area-measurement",text:t.getText("MEASUREMENTS_AREA_MENUITEM")});this._deleteMeasurementItem=new B({icon:"sap-icon://delete",text:t.getText("MEASUREMENTS_DELETE_MENUITEM")});this._calibrateDistanceMeasurementItem=new B({icon:te+"calibrate-distance",text:t.getText("MEASUREMENTS_CALIBRATE_DISTANCE_MENUITEM")});this._measurementSettingsItem=new B({startsSection:true,icon:te+"settings",text:t.getText("MEASUREMENTS_SETTINGS_MENUITEM"),toggleable:false});this._measurementsToggleButton=new V({type:G.Transparent,tooltip:t.getText("MEASUREMENTS_TOOLTIP"),items:[this._distanceMeasurementItem,this._angleMeasurementItem,this._areaMeasurementItem,this._deleteMeasurementItem,this._calibrateDistanceMeasurementItem,this._measurementSettingsItem],itemToggled:function(t){const i=e._getViewport();const o=t.getParameter("oldItem");const n=t.getParameter("newItem");const s=i.getMeasurementSurface();for(const e of s.getMeasurementsUnderConstruction()){s.cancelMeasurementConstruction(e)}if(o===e._distanceMeasurementItem){e._distanceMeasurementTool.setActive(false,i)}else if(o===e._angleMeasurementItem){e._angleMeasurementTool.setActive(false,i)}else if(o===e._areaMeasurementItem){e._areaMeasurementTool.setActive(false,i)}else if(o===e._deleteMeasurementItem){e._deleteMeasurementTool.setActive(false,i)}else if(o===e._calibrateDistanceMeasurementItem){e._calibrateDistanceMeasurementTool.setActive(false,i)}const a=i.getTools();let r;if(n===e._distanceMeasurementItem){r=e._distanceMeasurementTool}else if(n===e._angleMeasurementItem){r=e._angleMeasurementTool}else if(n===e._areaMeasurementItem){r=e._areaMeasurementTool}else if(n===e._deleteMeasurementItem){r=e._deleteMeasurementTool}else if(n===e._calibrateDistanceMeasurementItem){r=e._calibrateDistanceMeasurementTool}if(r!=null){if(a.indexOf(r.getId())<0){i.addTool(r)}r.setActive(true,i)}},itemSelected:function(t){var i=e._getViewport();var o=t.getParameter("item");if(o===e._measurementSettingsItem){e._distanceMeasurementTool.setActive(false,i);e._angleMeasurementTool.setActive(false,i);e._areaMeasurementTool.setActive(false,i);e._deleteMeasurementTool.setActive(false,i);e._calibrateDistanceMeasurementTool.setActive(false,i);e._distanceMeasurementTool.showSettingsDialog(i)}},beforeMenuOpen:function(){var t=e._getViewport();var i=t.getMeasurementSurface();var o=i.getMeasurements().length>0;e._deleteMeasurementItem.setEnabled(o);var n=i.getMeasurements().some(function(e){return e.isDistance});e._calibrateDistanceMeasurementItem.setEnabled(n)}});this._measurementsToggleButton.vitId=C.Measurements;this._zoomInButton=new m({icon:"sap-icon://zoom-in",tooltip:t.getText("ZOOM_IN_TOOLTIP"),enabled:false,press:()=>{const e=this._getViewport();const{left:t,top:i,right:o,bottom:n}=e.getDomRef("page").getBoundingClientRect();e.zoom(1.1,(t+o)/2,(i+n)/2)}});this._zoomInButton.vitId=C.ZoomIn;this._zoomOutButton=new m({icon:"sap-icon://zoom-out",tooltip:t.getText("ZOOM_OUT_TOOLTIP"),enabled:false,press:()=>{const e=this._getViewport();const{left:t,top:i,right:o,bottom:n}=e.getDomRef("page").getBoundingClientRect();e.zoom(1/1.1,(t+o)/2,(i+n)/2)}});this._zoomOutButton.vitId=C.ZoomOut;this._zoomToFitPageButton=new m({icon:te+"fit-to-page",tooltip:t.getText("FIT_TO_PAGE_TOOLTIP"),enabled:false,press:()=>this._getViewport().zoomToFitPage()});this._zoomToFitPageButton.vitId=C.FitToPage;this._zoomToFitPageWidthButton=new m({icon:te+"fit-to-width",tooltip:t.getText("FIT_TO_WIDTH_TOOLTIP"),enabled:false,press:()=>this._getViewport().zoomToFitPageWidth()});this._zoomToFitPageWidthButton.vitId=C.FitToWidth;this._previousPageButton=new m({type:G.Transparent,tooltip:t.getText("PREVIOUS_PAGE_TOOLTIP"),icon:"sap-icon://navigation-left-arrow",enabled:false,press:()=>{this._getViewport().setCurrentPageIndex(this._pdfPageIndex-1)}});this._nextPageButton=new m({type:G.Transparent,tooltip:t.getText("NEXT_PAGE_TOOLTIP"),icon:"sap-icon://navigation-right-arrow",enabled:false,press:()=>{this._getViewport().setCurrentPageIndex(this._pdfPageIndex+1)}});this._invisPageIndex=new l;this._currentPageIndexInput=new T({ariaLabelledBy:this._invisPageIndex,type:Y.Number,enabled:false,submit:e=>{const t=e.getParameter("value");if(t<1||t>this._pdfTotalPages){return}this._getViewport().setCurrentPageIndex(t-1)},liveChange:e=>{const t=e.getParameter("value");const i=t.replaceAll(".","");this._currentPageIndexInput.setValue(i);if(i<1||i>this._pdfTotalPages){this._currentPageIndexInput.setValueState(j.Error);this._currentPageIndexInput.setValueStateText(y().getText(i===""?"PAGE_COUNT_EMPTY":"PAGE_COUNT_ERROR",[i]))}else{this._currentPageIndexInput.setValueState(j.None)}}}).addStyleClass("sapVizKitPageGalleryToolbarCurrentPageIndex").addEventDelegate({onfocusout:()=>{const e=this._currentPageIndexInput.getValue();if(e<1||e>this._pdfTotalPages){return}this._getViewport().setCurrentPageIndex(e-1)}});const d=new f({text:"/",wrapping:false,textAlign:X.Center}).addStyleClass("sapVizKitPageGalleryToolbarSlash");this._totalPageCountText=new f({text:"0",wrapping:false});const p=new v;p.vitId=C.PageNavigationSeparator;this._pageNavigation=new g({renderType:Z.Bare,alignItems:"Center",items:[this._previousPageButton,this._invisPageIndex,this._currentPageIndexInput,d,this._totalPageCountText,this._nextPageButton]}).addStyleClass("sapVizKitPageGalleryPageNavigation");this.addEventDelegate({onAfterRendering:()=>{const e=this._currentPageIndexInput.getDomRef("inner");if(e!=null){const t=parseFloat(window.getComputedStyle(e).minWidth);this._currentPageIndexInput.setWidth(Math.max(t,this._totalPageCountText.getDomRef().offsetWidth+12)+"px")}}});this._pageNavigation.vitId=C.PageNavigation;this._measurementsSeparator=new v;this._measurementsSeparator.vitId=C.MeasurementsSeparator;this._togglePmiButton=new I({pressed:true,icon:te+"toggle-pmi",type:G.Transparent,text:t.getText("PMI_TOOLTIP"),tooltip:t.getText("PMI_TOOLTIP"),press:function(){var t=e._getViewport();if(t){t.setShowPMI(this.getPressed());t.setShouldRenderFrame()}}});this._togglePmiButton.vitId=C.PMI;this._togglePmiButtonSeparator=new v;this._togglePmiButtonSeparator.vitId=C.PMISeparator;var b=new m({type:G.Transparent,tooltip:t.getText("ROTATE_BOARD_CW"),icon:"sap-icon://vk-icons/rotate-board-cw",press:function(){if(ae(e._getViewport())){e._getViewport().rotatePcbCW()}}});b.vitId=C.RotateCW;var P=new m({type:G.Transparent,tooltip:t.getText("ROTATE_BOARD_CCW"),icon:"sap-icon://vk-icons/rotate-board-ccw",press:function(){if(ae(e._getViewport())){e._getViewport().rotatePcbCCW()}}});P.vitId=C.RotateCCW;var R=new m({type:G.Transparent,tooltip:t.getText("FLIP_BOARD"),icon:"sap-icon://vk-icons/flip-board-horizontally",press:function(){if(ae(e._getViewport())){e._getViewport().flipPcb()}}});R.vitId=C.Flip;var A=new v;A.vitId=C.EcadSeparator;var D=new v;D.vitId=C.CrossSectionSeparator;var N=new v;N.vitId=C.PredefinedViewsSeparator;var F=new v;F.vitId=C.ShowHideSeparator;this._rectSelectSeparator=new v;this._rectSelectSeparator.vitId=C.RectangularSelectionSeparator;this._itemsShowHideSelect=[u,c,F,this._rectSelectionButton,this._rectSelectSeparator];this._itemTurntable=this._gestureButtons[0];this._itemPan=this._gestureButtons[2];this._itemZoom=this._gestureButtons[3];this._pdfItems=[this._zoomInButton,this._zoomOutButton,this._zoomToFitPageButton,this._zoomToFitPageWidthButton,p,this._pageNavigation];this._items3D=[this._gestureButtons[1],i,D,h,N];this._gestureButtonsSeparator=new v;this._gestureButtonsSeparator.vitId=C.GestureButtonsSeparator;var z=[u,c,F,this._togglePmiButton,this._togglePmiButtonSeparator,this._gestureButtons[0],this._gestureButtons[1],this._gestureButtons[2],this._gestureButtons[3],this._gestureButtonsSeparator,this._measurementsToggleButton,this._measurementsSeparator,P,b,R,A,this._fitToView,this._fitToViewSeparator,this._rectSelectionButton,this._rectSelectSeparator,i,D,h,N,_,this._zoomInButton,this._zoomOutButton,this._zoomToFitPageButton,this._zoomToFitPageWidthButton,p,this._pageNavigation];this._notPdfItems=[r,this._gestureButtonsSeparator,this._fitToViewSeparator,this._togglePmiButton,this._togglePmiButtonSeparator,this._measurementsSeparator,this._measurementsToggleButton,this._fitToView,this._fitToViewSeparator,this._rectSelectionButton,this._rectSelectSeparator,_];this._ecadItems=[P,b,R,A];this._notEcadItems=[this._togglePmiButton,this._togglePmiButtonSeparator,this._gestureButtons[0],this._gestureButtons[1],this._measurementsToggleButton,this._measurementsSeparator,i,D,h,N,this._zoomInButton,this._zoomOutButton,this._zoomToFitPageButton,this._zoomToFitPageWidthButton,p,this._pageNavigation];z.forEach(function(e){this._itemsVisibility.set(e,true);this._itemsVisibilityObserver.observe(e,{properties:["visible"]})}.bind(this));return z};var ue=["drawerToolbarIconTurntable","drawerToolbarIconOrbit","drawerToolbarIconPan","drawerToolbarIconZoom"];var ce=function(e,t){this.viewport=e;this._toolbar=t;this._mode=1;this._gesture=false;this._x=0;this._y=0};function ge(e,t){ue.forEach(function(i,o){if(e.hasStyleClass(i)&&o!==t){e.removeStyleClass(i)}else if(o===t){e.addStyleClass(i)}})}function he(e){var t=e.viewport;var i=e._mode;var o=t.hasStyleClass(ue[i])?i:-1;e._isScrolling=true;if(o!==3){ge(t,3);setTimeout(function(){e._isScrolling=false;ge(t,o)},500)}}ce.prototype.beginGesture=function(e){this._gesture=true;if(this._mode<3){this._x=e.points[0].x;this._y=e.points[0].y}else{this._x=e.x;this._y=e.y}if(e.scroll){he(this)}if(this._toolbar._rectSelectionButton.getPressed()||e.event&&(u.os.macintosh?e.event.metaKey:e.event.ctrlKey)){var t=this.viewport.getDomRef().getBoundingClientRect();this._selectionRect={x1:this._x-t.left,y1:this._y-t.top,x2:this._x-t.left,y2:this._y-t.top}}};ce.prototype.endGesture=function(){this._gesture=false;if(this._selectionRect&&(this._selectionRect.x1!==this._selectionRect.x2||this._selectionRect.y1!==this._selectionRect.y2)){this._toolbar._rectSelectTool._select(this._selectionRect.x1,this._selectionRect.y1,this._selectionRect.x2,this._selectionRect.y2,this.viewport,this.viewport.getScene(),this.viewport.getCamera());this._selectionRect=null;this.viewport.setSelectionRect(null)}else if(!this._isScrolling){ge(this.viewport,-1)}};ce.prototype.move=function(e){if(this._gesture){if(e.n==1){var t=e.points[0];if(this._selectionRect){var i=this.viewport.getDomRef().getBoundingClientRect();this._selectionRect.x2=t.x-i.left;this._selectionRect.y2=t.y-i.top;this.viewport.setSelectionRect(this._selectionRect)}else{ge(this.viewport,this._mode);var o=t.x-this._x;var n=t.y-this._y;switch(this._mode){case 0:this.viewport.rotate(o,n,true);break;case 1:this.viewport.rotate(o,n,false);break;case 2:this.viewport.pan(o,n);break;case 3:this.viewport.zoom(1+n*.005);break;default:break}this._x=t.x;this._y=t.y}e.handled=true}else if(!(ie(this.viewport)&&this.viewport._isPanoramicActivated())&&e.n==2&&!this._isScrolling){ge(this.viewport,2)}else if(ie(this.viewport)&&this.viewport._isPanoramicActivated()&&e.n==2&&!this._isScrolling){ge(this.viewport,0)}}};ce.prototype.hover=function(){};ce.prototype.getViewport=function(){return this.viewport};q.prototype.setNavigationMode=function(e){if(!e||e===M.NoChange){e=this.getNavigationMode()}var t=this._getViewport();if(t){if(!re(t)){if(e!==M.Pan&&e!==M.Zoom){e=M.Pan}}else if(ie(t)&&t._isPanoramicActivated()){if(e!==M.Turntable&&e!==M.Zoom){e=M.Turntable}}}this.setProperty("navigationMode",e,true);var i=[M.Turntable,M.Orbit,M.Pan,M.Zoom].indexOf(e);this._gestureButtons.forEach(function(e,t){e.setPressed(t===i)});if(t!=null&&!t.isA("sap.ui.vk.pdf.Viewport")){if(!this._cameraHandler||this._cameraHandler.getViewport()!==t){this._cameraHandler=new ce(t,this);t._loco?.addHandler(this._cameraHandler,0)}this._cameraHandler._mode=i}};q.prototype._getToolbar=function(){return this._toolbar};q.prototype._getTooltip=function(){return y().getText(this.getExpanded()?"COLLAPSE_TOOLTIP":"EXPAND_TOOLTIP")};q.prototype._updateTooltip=function(e){e.setTooltip(this._getTooltip())};q.prototype._toggleExpanded=function(){var e=!this.getExpanded();this.setExpanded(e);this.fireExpanded({expand:e})};q.prototype.setExpanded=function(e){this.setProperty("expanded",e,true);var t=this.getDomRef();if(t){if(!e){t.classList.add("drawerToolbarCollapsed");t.classList.remove("drawerToolbarExpanded");this._container.addStyleClass("vboxCollapsed")}else{t.classList.add("drawerToolbarExpanded");t.classList.remove("drawerToolbarCollapsed");this._container.removeStyleClass("vboxCollapsed")}}return this};q.prototype._onViewActivated=function(e,t,i){if(i&&i.view&&i.source&&i.source===this._getViewport()){this.invalidate()}};q.prototype._onReadyForAnimation=function(e,t,i){var o=this._getViewport();if(i?.view&&i.source&&i.source===o?._getViewStateManagerThreeJS?.()){this.invalidate()}};q.prototype.onBeforeRendering=function(){var e=this._getViewport();this._container.setVisible(!!e);if(e){var t=re(e);var i=ie(e)&&e._isPanoramicActivated();var o=ne(e);var n=se(e);var s=ae(e);this._ignoreVisibilityChange=true;this._itemsShowHideSelect.forEach(function(e){e.setVisible(!o&&!n&&this._itemsVisibility.get(e))}.bind(this));this._itemTurntable.setVisible(t&&this._itemsVisibility.get(this._itemTurntable));this._itemPan.setVisible(!i&&!n&&this._itemsVisibility.get(this._itemPan));this._items3D.forEach(function(e){e.setVisible(t&&!i&&this._itemsVisibility.get(e))}.bind(this));this._pdfItems.forEach(e=>{e.setVisible(n&&this._itemsVisibility.get(e))});this._notPdfItems.forEach(e=>{e.setVisible(!n&&this._itemsVisibility.get(e))});this._ecadItems.forEach(e=>e.setVisible(s&&this._itemsVisibility.get(e)));if(s){this._notEcadItems.forEach(e=>e.setVisible(false))}this._ignoreVisibilityChange=false;if(t&&!i){this._crossSectionTool=this._crossSectionTool||new P;e.addTool(this._crossSectionTool)}this.setNavigationMode(M.NoChange)}};q.prototype.setPageNavigationEnabled=function(e){this._previousPageButton.setEnabled(e);this._currentPageIndexInput.setEnabled(e);this._nextPageButton.setEnabled(e)};return q});
//# sourceMappingURL=DrawerToolbar.js.map