/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/Select","sap/ui/mdc/field/FieldSelectRenderer","sap/ui/mdc/field/ConditionsType","sap/ui/core/Element","sap/ui/base/ManagedObjectObserver","sap/base/util/merge"],(e,t,i,n,o,s)=>{"use strict";const l=e.extend("sap.ui.mdc.field.FieldSelect",{metadata:{library:"sap.ui.mdc",properties:{ariaAttributes:{type:"object",defaultValue:{},byValue:true}},events:{valueHelpRequest:{parameters:{fromKeyboard:{type:"boolean"}}}}},renderer:t});l.prototype.init=function(){e.prototype.init.apply(this,arguments);this._sSelectedKeyOnFocus=null;this._oObserver=new o(r.bind(this));this._oObserver.observe(this,{properties:["ariaAttributes","selectedKey"]})};l.prototype.exit=function(){e.prototype.exit.apply(this,arguments);this._sSelectedKeyOnFocus=null;if(this._oConditionsType){this._oConditionsType.destroy();this._oConditionsType=undefined}this._oObserver.disconnect();this._oObserver=undefined};l.prototype.setProperty=function(t,i,n){if(t==="ariaAttributes"){n=true}return e.prototype.setProperty.apply(this,[t,i,n])};function r(e){if(e.name==="ariaAttributes"){const t=this.getFocusDomRef();if(t){const i=(e,t,i)=>{if(e.current.aria?.[i]!==e.old.aria?.[i]){if(!e.current.aria?.[i]){t.removeAttribute("aria-"+i)}else{t.setAttribute("aria-"+i,e.current.aria[i])}}};i(e,t,"activedescendant");i(e,t,"expanded");i(e,t,"controls")}}else if(e.name==="selectedKey"&&e.current!==""){this._bSetValuePending=true}}l.prototype.createPicker=function(){return null};function a(e){const t=this.getParent();if(!t?.isA("sap.ui.mdc.field.FieldBase")){return""}const n=s({},t.getFormatOptions());n.display=t.getDisplay();n.valueHelpID=t._getValueHelp()||t?._sDefaultValueHelp;if(this._oConditionsType){this._oConditionsType.setFormatOptions(n)}else{this._oConditionsType=new i(n)}return this._oConditionsType.formatValue(e,"string")}function u(e){const t=this.getParent();let i;if(t?._oNavigateCondition){i=a.call(this,[t._oNavigateCondition])}else if(t?._oNavigateCondition===null){i=a.call(this,[])}else if(e){const e=this.getBinding("selectedKey")?.getRawValue();i=a.call(this,e)}return i}function p(){const e=this.getParent();let t;if(e?._oNavigateCondition){t=e.getContentFactory().getConditionsType().formatValue([e._oNavigateCondition])}else if(e?._oNavigateCondition===null){t=""}return t}l.prototype._getSelectedItemText=function(e){if(this._sValue!==undefined){return this._sValue}else{return u.call(this,true)}};l.prototype.setValue=function(t){this._bSetValuePending=true;Promise.all([t]).then(t=>{const[i]=t;this._sValue=i;e.prototype.setValue.call(this,i);delete this._sValue;delete this._bSetValuePending})};l.prototype.setDOMValue=function(e){const t=u.call(this,false);e=t===undefined?e:t;this.setValue(e)};l.prototype.getDOMValue=function(e){const t=this.getDomRef();const i=t?.querySelector(".sapMSelectListItemText");if(i){return i.textContent}return""};l.prototype._setHiddenSelectValue=function(){const e=this._getHiddenSelect();const t=this._getHiddenInput();let i=p.call(this);const n=this._sValue||this._getSelectedItemText();if(i===undefined){i=this.getSelectedKey()}t.attr("value",i||"");if(!this._isIconOnly()){Promise.all([n]).then(t=>{const[i]=t;e.text(i)})}};l.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);const t=this.getSelectedKey();if(this._sSelectedKeyOnFocus===t&&this.getDomRef()&&!this._bSetValuePending){this._sValue=this.getDOMValue()}};l.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.apply(this,arguments);const t=this._getSelectedItemText();this.setValue(t);delete this._sValue};l.prototype.toggleOpenState=function(){return this};l.prototype.ontap=function(e){if(!this.getEnabled()||!this.getEditable()){return}const t=d.call(this);if(this.isOpenArea(e.target)&&t?.isOpen()){this.fireValueHelpRequest()}};l.prototype.onsapdown=function(e){};l.prototype.onsapup=function(e){};l.prototype.onsappagedown=function(e){};l.prototype.onsappageup=function(e){};l.prototype.onsaphome=function(e){};l.prototype.onsapend=function(e){};l.prototype.onsapshow=function(t){if(!this.getEditable()){return}e.prototype.onsapshow.apply(this,arguments);this.fireValueHelpRequest({fromKeyboard:true})};l.prototype.onsapenter=function(t){c.call(this);e.prototype.onsapenter.apply(this,arguments)};function c(){const e=p.call(this);if(e!==undefined){this.setSelectedKey(e)}}l.prototype.onfocusin=function(t){this._sSelectedKeyOnFocus=this.getSelectedKey();e.prototype.onfocusin.apply(this,arguments)};l.prototype.onfocusout=function(t){if(this.getId()!==t.relatedControlId){c.call(this)}e.prototype.onfocusout.apply(this,arguments)};l.prototype._isKeyAvailable=function(e){return false};l.prototype._checkSelectionChange=function(){const e=this.getSelectedKey();if(this._sSelectedKeyOnFocus!==e){this.fireChange({selectedItem:null,previousSelectedItem:null,selectedKey:e});this._sSelectedKeyOnFocus=e}};l.prototype._revertSelection=function(){const e=p.call(this);if(e!==undefined){if(this._sSelectedKeyOnFocus!==e){this.fireLiveChange({escPressed:true,value:this._sSelectedKeyOnFocus});this.setValue(this._getSelectedItemText())}}};l.prototype.searchNextItemByText=function(e){if(!(typeof e==="string"&&e!=="")){return null}this.fireLiveChange({value:e});return null};l.prototype._addFocusClass=function(){const e=d.call(this);if(!e?.isOpen()){this.addStyleClass("sapMSltFocused")}};l.prototype._removeFocusClass=function(){this.removeStyleClass("sapMSltFocused")};function d(){const e=this.getParent();let t=e?._getValueHelp();let i;if(!t&&e?._sDefaultValueHelp){t=e._sDefaultValueHelp}if(t){i=n.getElementById(t)}return i}return l});
//# sourceMappingURL=FieldSelect.js.map