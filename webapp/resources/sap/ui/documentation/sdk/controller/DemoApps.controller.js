/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/m/MessageToast","sap/m/MessageBox","sap/ui/documentation/sdk/controller/BaseController","sap/ui/documentation/sdk/controller/util/ResourceDownloadUtil","sap/ui/documentation/sdk/model/formatter","sap/ui/documentation/sdk/model/libraryData","sap/ui/model/json/JSONModel","sap/ui/core/util/File","sap/ui/thirdparty/jszip","sap/ui/util/openWindow"],function(e,t,n,o,a,i,r,s,c,l,d){"use strict";return o.extend("sap.ui.documentation.sdk.controller.DemoApps",{formatter:i,onInit:function(){o.prototype.onInit.call(this);this.processDemoAppsData();this.getRouter().getRoute("demoapps").attachPatternMatched(this.onPatternMatched,this)},processDemoAppsData:function(){r.getDemoAppsData().then(function(e){var t=this.flattenDemoAppsCategories(e),n=[];t.demoAppsByCategory.forEach(function(e){e.rows.forEach(function(e){n.push(e)})});t.demoApps=n;var o=new s(t);this.setModel(o);this.addCategoryClassToGridItems("sapUiDemoKitDemoAppsMain")}.bind(this))},flattenDemoAppsCategories(e){e.demoAppsByCategory.forEach(function(e){e.rows=[].concat.apply([],e.rows)});return e},addCategoryClassToGridItems(e){this.byId(e).getItems().forEach(function(e){var t=e.data("demoAppsCategoryClass");e.addStyleClass(t)})},createArchive:function(e,t){c.save(e,t,"zip","application/zip")},onPatternMatched:function(){this.hideMasterSide()},onReadMoreButtonPress:function(){var e="topic/a3ab54ecf7ac493b91904beb2095d208",t=i.formatHttpHrefForNewWindow(e);d(t,"_blank")},onDownloadPress:function(t){var n=t.getSource().getParent();fetch(n.data("config")).then(function(e){return e.json()}).then(function(e){if(e.external){this._handleExternalDownload(e);return}this.processFiles(n,e)}.bind(this)).catch(function(t){e.error("Error: ",t);this.handleError("An error occurred: "+t.message)}.bind(this))},_handleExternalDownload:function(e){var n=e.externalResourceRef;if(n){t.show('Downloading for app "'+e.name+'" has been started');d(n,"_blank")}else{this.handleError("No external resource URL provided.")}},processFiles:function(e,t){var n=[],o=[],a=new l,i=t.files;i.forEach(function(e){var i=this.handleFilePromise(e,a,n,t);o.push(i)}.bind(this));this.addLicenseFileToZip(o,a);this.handlePromisesCompletion(o,n,a,e)},handleFilePromise:function(e,t,n,o){var i=a.fetch(o.cwd+e);var r=new Promise(function(o){i.then(function(n){if(!e.startsWith("../")){t.file(e,n,{base64:false,binary:true})}o()}).catch(function(){n.push(e);o()})});return r},
/**
		 * Adds the license file to the zip file.
		 *
		 * @param {Array} aPromises - The array of promises.
		 * @param {object} oZipFile - The zip file.
		 */
addLicenseFileToZip:function(e,t){var n=sap.ui.require.toUrl("LICENSE.txt").replace("resources/",""),o=a.fetch(n),i=new Promise(function(e,n){o.then(function(n){t.file("LICENSE.txt",n);e()}).catch(function(){e()})});e.push(i)},handlePromisesCompletion:function(e,n,o,a){Promise.all(e).then(function(){var e;if(n.length){var i=n.reduce(function(e,t){return e+t+"\n"},"Could not locate the following download files:\n");this.handleWarning(i)}e=typeof a.getLabel==="function"?a.getLabel():a.data("label");t.show('Downloading for app "'+e+'" has been started');var r=o.generate({type:"blob"});this.createArchive(r,e)}.bind(this))},handleError:function(e){n.error(e)},handleWarning:function(e){n.warning(e)}})});
//# sourceMappingURL=DemoApps.controller.js.map