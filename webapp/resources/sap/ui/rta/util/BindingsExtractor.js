/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/dt/ElementUtil","sap/ui/dt/OverlayRegistry","sap/base/util/isPlainObject","sap/base/util/restricted/_uniqWith","sap/base/util/deepEqual"],function(t,e,n,i,o){"use strict";const a={};a.collectBindingPaths=function(e,i,o,g){const r={bindingPaths:[],bindingContextPaths:[]};const s=e.sParentAggregationName;const d=e.getParent();let c=a.getBindings({element:e,model:i,relevantContainerElement:o,parent:d,depth:g});if(d){const n=d.getMetadata().getAggregation();if(n){const r=t.getAggregation(d,s).indexOf(e);const l=n.name;const u=d.getBindingInfo(l);const f=u&&u.template;if(f){const e=f.getMetadata().getAggregation();if(e){const n=e.name;const s=t.getAggregation(f,n)[r];c=c.concat(a.getBindings({model:i,element:s,template:true,relevantContainerElement:o,parent:d,depth:g}))}}}}for(let t=0,e=c.length;t<e;t++){if(c[t].getPath){const e=c[t].getPath();if(e&&r.bindingPaths.indexOf(e)===-1){r.bindingPaths.push(e)}}if(c[t].getContext&&c[t].getContext()&&c[t].getContext().getPath){const e=c[t].getContext().getPath();if(e&&r.bindingContextPaths.indexOf(e)===-1){r.bindingContextPaths.push(e)}}if(n(c[t])){const e=c[t].parts[0]&&c[t].parts[0].path;if(e&&r.bindingPaths.indexOf(e)===-1){r.bindingPaths.push(e)}}}return r};function g(t,n){if(n&&t!==n){const i=e.getOverlay(t);const o=i&&(i.getRelevantContainer()||i.getElement());return o?o.getId()===n.getId():true}return true}a.getBindings=function(t){const e=t.element;const n=t.model;const s=t.parent;const c=t.aggregationName;const l=t.relevantContainerElement;let u=[];if(g(e,l)){u=t.template?d(e,s,n):a.getBindingsFromProperties(e,n)}const f=c?[c]:Object.keys(e.getMetadata().getAllAggregations());if(!Number.isInteger(t.depth)||t.depth>0){f.forEach(function(i){u=u.concat(r(e,n,t.template,i,l,t.depth&&t.depth-1))})}return i(u,o)};function r(e,n,i,o,r,s){const c=e.getModel();const l=e.getBindingInfo(o);const u=l&&l.template;if(u&&c&&c!==n){return[]}const f=u?true:i;const p=u?[u]:t.getAggregation(e,o);let m=[];p.forEach(function(t){if(t.getMetadata){if(g(e,r)){m=m.concat(f?d(t,e,n):a.getBindingsFromProperties(t,n))}m=m.concat(a.getBindings({element:t,model:n,template:f,relevantContainerElement:r,parent:e,depth:s}))}});return m}a.filterAndFlattenBindings=function(t,e){let n=[];const i=t.getMetadata().getName();if(i==="sap.ui.model.CompositeBinding"){t.getBindings().forEach(function(t){n=n.concat(a.filterAndFlattenBindings(t,e))})}else if((i==="sap.ui.model.odata.ODataPropertyBinding"||i==="sap.ui.model.odata.v2.ODataPropertyBinding"||i==="sap.ui.model.odata.v4.ODataPropertyBinding"||i==="sap.ui.model.json.JSONPropertyBinding"||i==="sap.ui.model.json.XMLPropertyBinding"||i==="sap.ui.model.resource.ResourcePropertyBinding")&&t.getModel()===e&&t.isRelative()&&typeof t.getPath==="function"&&t.getPath()){n.push(t)}return n};function s(t){const e=[];const n=t.parts;n.forEach(function(t){e.push({parts:[t]})});return e}a.getBindingsFromProperties=function(t,e){const n=Object.keys(t.getMetadata().getAllProperties());return n.filter(t.getBinding.bind(t)).reduce(function(n,i){return n.concat(a.filterAndFlattenBindings(t.getBinding(i),e))},[])};function d(t,e,n){const i=Object.keys(t.getMetadata().getAllProperties());return i.filter(function(i){const o=t.mBindingInfos[i];const a=o&&o.parts[0]&&o.parts[0].model;let g=n===e.getModel(a);if(!a){const n=e.getDefaultModel?e.getDefaultModel():null;const i=t.getDefaultModel?t.getDefaultModel():null;g=n===i}else{g=n===e.getModel(a)}return o&&g}).reduce(function(e,n){return e.concat(s(t.mBindingInfos[n]))},[])}a.getBindingContextPath=function(t){if(t.getBindingContext()&&t.getBindingContext().getPath){return t.getBindingContext().getPath()}return undefined};return a});
//# sourceMappingURL=BindingsExtractor.js.map