/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/base/ManagedObject","sap/ui/core/Element","sap/ui/core/Fragment","sap/ui/fl/write/api/FeaturesAPI","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/rta/util/whatsNew/WhatsNewUtils"],function(e,t,a,s,i,o,n,r){"use strict";const l=e.URLHelper;const h=t.extend("sap.ui.rta.util.whatsNew.WhatsNew",{metadata:{properties:{dontShowAgainFeatureIds:{type:"array",defaultValue:[]},layer:{type:"string",defaultValue:""}},aggregations:{whatsNewDialog:{type:"sap.m.Dialog",multiple:false}}}});function u(e){const t=e.getActivePage();const s=e.getPages();const i=a.getElementById("sapUiRtaWhatsNewDialog_LearnMore");const o=t?s.findIndex(function(e){return e.getId()===t}):0;if(this.aUnseenFeatures[o]&&this.aUnseenFeatures[o].documentationUrls){i.setEnabled(true)}else{i.setEnabled(false)}}h.prototype.setDontShowAgainFeatureIds=async function(e){this.setProperty("dontShowAgainFeatureIds",e);this.aUnseenFeatures=await r.getFilteredFeatures(e,this.getLayer())};h.prototype.initializeWhatsNewDialog=async function(e,t=[]){await this.setDontShowAgainFeatureIds(e);if(this.aUnseenFeatures.length===0||this.getLayer()!=="CUSTOMER"){return}const a=new o;this.aUnseenFeatures=this.aUnseenFeatures.filter(e=>!t.includes(e.featureId));if(this.aUnseenFeatures.length===0){return}a.setData({featureCollection:this.aUnseenFeatures});if(!this.oWhatsNewDialog){await this.createWhatsNewDialog(a)}this.oWhatsNewDialog.open()};h.prototype.createWhatsNewDialog=async function(e){const t=new n({bundleName:"sap.ui.rta.messagebundle"});this.oWhatsNewDialog=await s.load({name:"sap.ui.rta.util.whatsNew.WhatsNewDialog",controller:this});this.oWhatsNewDialog.setModel(t,"i18n");this.oWhatsNewDialog.setModel(e,"whatsNewModel");const i=a.getElementById("sapWhatsNewDialogCarousel");if(i){i.attachEvent("pageChanged",()=>{u.call(this,i)});u.call(this,i)}};h.prototype.closeWhatsNewDialog=function(){if(this.oWhatsNewDialog){const e=a.getElementById("whatsNewDialog_DontShowAgain");if(e.getSelected()){const e=this.aUnseenFeatures.map(e=>e.featureId);const t=[...this.getDontShowAgainFeatureIds(),...e];const a={layer:this.getLayer(),seenFeatureIds:t};i.setSeenFeatureIds(a)}this.oWhatsNewDialog.close()}};h.prototype.onLearnMorePress=function(){const e=a.getElementById("sapWhatsNewDialogCarousel").getActivePage();const t=r.getLearnMoreURL(e,this.aUnseenFeatures);l.redirect(t,true)};h.prototype.destroy=function(...e){t.prototype.destroy.apply(this,e);if(this.oWhatsNewDialog){this.oWhatsNewDialog.destroy()}};return h});
//# sourceMappingURL=WhatsNew.js.map