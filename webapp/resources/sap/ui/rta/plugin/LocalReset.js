/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Element","sap/ui/core/Lib","sap/ui/rta/plugin/Plugin","sap/ui/dt/Util","sap/ui/fl/Utils","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/write/api/LocalResetAPI","sap/ui/rta/command/CompositeCommand","sap/m/MessageToast","sap/ui/dt/OverlayRegistry"],function(e,t,n,a,o,i,r,s,c,l){"use strict";const u=n.extend("sap.ui.rta.plugin.LocalReset",{metadata:{library:"sap.ui.rta",properties:{},associations:{},events:{}}});u.prototype._isEditable=function(e){if(!this.hasStableId(e)){return false}const t=this.getAction(e);return!!t};u.prototype.isEnabled=function(e){if(e.length!==1){return false}const t=e[0];const n=t.getElement();const a=this.getAction(t);if(!a){return false}let s=true;if(typeof a.isEnabled!=="undefined"){if(typeof a.isEnabled==="function"){s=a.isEnabled(n)}else{s=a.isEnabled}}const c=a.changeOnRelevantContainer?t.getRelevantContainer():n;const u=l.getOverlay(c);const p=o.getAppComponentForControl(c);const d=this.getVariantManagementReference(u);const g=i.getVariantManagementControlByVMReference(d,p);return s&&r.isResetEnabled(c,{layer:this.getCommandFactory().getFlexSettings().layer,currentVariant:g?.getCurrentVariantKey()})};u.prototype.getMenuItems=function(e){return this._getMenuItems(e,{pluginId:"CTX_LOCAL_RESET",icon:"sap-icon://reset",additionalInfoKey:"LOCALRESET_RTA_CONTEXT_MENU_INFO"})};u.prototype.getActionName=function(){return"localReset"};u.prototype.handler=function(n){const r=n[0];const l=r.getElement();const u=r.getDesignTimeMetadata();const p=this.getVariantManagementReference(r);const d=o.getAppComponentForControl(l);const g=i.getVariantManagementControlByVMReference(p,d);const f=g?.getCurrentVariantKey();const m=!!f;const y=m?d.byId(p)||e.getElementById(p):undefined;const E=this.getCommandFactory();const C=new s;return Promise.all([E.getCommandFor(l,"localReset",{currentVariant:f},u,p),m&&E.getCommandFor(y,"save",u,p)].filter(Boolean)).then(function(e){e.forEach(function(e){C.addCommand(e)});this.fireElementModified({command:C});if(m){const e=t.getResourceBundleFor("sap.ui.rta").getText("MSG_LOCAL_RESET_VARIANT_SAVE");c.show(e,{duration:5e3})}}.bind(this)).catch(function(e){throw a.propagateError(e,"LocalReset#handler","Error occurred during handler execution","sap.ui.rta.plugin")})};return u});
//# sourceMappingURL=LocalReset.js.map