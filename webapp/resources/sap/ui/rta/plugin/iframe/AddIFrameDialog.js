/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/ui/base/ManagedObject","sap/ui/core/Element","sap/ui/core/Fragment","sap/ui/core/Lib","sap/ui/core/library","sap/ui/fl/util/getContainerUserInfo","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/rta/plugin/iframe/AddIFrameDialogController","sap/ui/rta/Utils"],function(e,t,a,i,o,n,r,l,s,u,_){"use strict";var{ValueState:d}=n;var g=o.getResourceBundleFor("sap.ui.rta");function D(e,t,a,i,o){var n=t?g.getText("IFRAME_ADDIFRAME_DIALOG_SELECT_ADDITIONAL_TEXT_PERCENT_SECTION"):g.getText("IFRAME_ADDIFRAME_DIALOG_SELECT_ADDITIONAL_TEXT_PERCENT_HEADER");return new l({dialogTitle:e?g.getText("IFRAME_ADDIFRAME_DIALOG_UPDATE_TITLE"):g.getText("IFRAME_ADDIFRAME_DIALOG_TITLE"),asContainer:{value:t},title:{value:t?g.getText("IFRAME_ADDIFRAME_DIALOG_CONTAINER_TITLE_DEFAULT_VALUE_TEXT"):null,valueState:d.None,id:"sapUiRtaAddIFrameDialog_ContainerTitle_TitleInput"},frameWidth:{value:parseFloat(a)||100,valueState:d.None,id:"sapUiRtaAddIFrameDialog_WidthInput"},frameWidthUnit:{value:"%"},frameHeight:{value:parseFloat(i)||35,valueState:d.None,id:"sapUiRtaAddIFrameDialog_HeightInput"},frameHeightUnit:{value:"vh"},frameUrl:{value:"",valueState:d.None},previousFrameUrl:{value:""},frameUrlError:{value:undefined},previewUrl:{value:""},parameters:{value:[]},unitsOfWidthMeasure:[{unit:"%",descriptionText:n},{unit:"px",descriptionText:g.getText("IFRAME_ADDIFRAME_DIALOG_SELECT_ADDITIONAL_TEXT_PX")},{unit:"rem",descriptionText:g.getText("IFRAME_ADDIFRAME_DIALOG_SELECT_ADDITIONAL_TEXT_REM")}],unitsOfHeightMeasure:[{unit:"vh",descriptionText:g.getText("IFRAME_ADDIFRAME_DIALOG_SELECT_ADDITIONAL_TEXT_VH")},{unit:"px",descriptionText:g.getText("IFRAME_ADDIFRAME_DIALOG_SELECT_ADDITIONAL_TEXT_PX")},{unit:"rem",descriptionText:g.getText("IFRAME_ADDIFRAME_DIALOG_SELECT_ADDITIONAL_TEXT_REM")}],advancedSettings:{value:{allowForms:true,allowScripts:true,allowSameOrigin:true,additionalSandboxParameters:[],...o}},settingsUpdate:{value:false},showParameters:{value:false}})}var A=t.extend("sap.ui.rta.plugin.iframe.AddIFrameDialog",{metadata:{library:"sap.ui.rta",events:{opened:{}}}});A.prototype.open=function(e,t){return new Promise(function(a){this._fnResolve=a;this._createDialog(e,t)}.bind(this))};A.prototype._createDialog=function(t,a){this._oJSONModel=D(!!t?.updateMode,!!t?.asContainer,t?.frameWidth,t?.frameHeight,t?.advancedSettings);this._oController=new u(this._oJSONModel,t);i.load({name:"sap.ui.rta.plugin.iframe.AddIFrameDialog",controller:this._oController}).then(function(e){this._oDialog=e;this._oDialog.addStyleClass(_.getRtaStyleClassName());this._oDialog.setModel(this._oJSONModel,"dialogInfo");this._oDialog.setModel(a.getModel());this._oDialog.setBindingContext(a.getBindingContext());const t=new s({bundleName:"sap.ui.rta.messagebundle"});this._oDialog.setModel(t,"i18n");this._openDialog()}.bind(this)).catch(function(t){e.error("Error loading fragment sap.ui.rta.plugin.iframe.AddIFrameDialog: ",t)})};A.prototype._openDialog=function(){this._oDialog.attachAfterOpen(function(){const e=a.getElementById("sapUiRtaAddIFrameDialog_PreviewFrame");const t=e.getModel("$user");this._oDialog.setModel(t,"$user");this.fireOpened()}.bind(this));this._oDialog.attachAfterClose(function(){this._oDialog.destroy();this._oDialog=null;this._fnResolve(this._oController.getSettings());this._oController=null}.bind(this));this._oDialog.open()};A.buildUrlBuilderParametersFor=async function(e){const t=await r();const a=Object.keys(t).map(function(e){return{label:e,key:`{$user>/${e}}`,value:t[e]}});const i=e.getBindingContext();let o;if(i){const e=i.getObject();o=Object.keys(e).filter(function(t){return typeof e[t]!=="object"}).map(async function(t){const a=i.getModel();const o={label:t,key:`{${t}}`,value:e[t]};if(a.isA("sap.ui.model.odata.v4.ODataModel")){const e=a.getMetaModel();const n=e.getMetaPath(i.getPath());const r=await e.requestObject(`${n}/${t}/$Type`);if(r){o.type=r}}return o})}else{o=[]}return a.concat(await Promise.all(o))};return A});
//# sourceMappingURL=AddIFrameDialog.js.map