/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/fl/write/api/FeaturesAPI","sap/ui/fl/write/api/LocalResetAPI","sap/ui/fl/write/api/PersistenceWriteAPI","sap/ui/fl/LayerUtils","sap/ui/rta/command/FlexCommand","sap/ui/rta/library"],function(e,t,a,n,s,i,o){"use strict";const r=i.extend("sap.ui.rta.command.AnnotationCommand",{metadata:{library:"sap.ui.rta",properties:{changeType:{type:"string"},serviceUrl:{type:"string"},content:{type:"any"},changesToDelete:{type:"object[]",defaultValue:[]}},events:{}}});r.prototype._createChange=function(a,n,i){this._aToBeResetChanges=[];const r={...this._getChangeSpecificData(),...a,serviceUrl:this.getServiceUrl(),command:i,jsOnly:this.getJsOnly(),generator:a.generator||o.GENERATOR_NAME};if(this.getChangesToDelete().length){const n=[];if(t.isLocalResetEnabled()){this.getChangesToDelete().forEach(e=>{if(s.compareAgainstCurrentLayer(e.getLayer(),a.layer)===-1){n.push(e)}else{this._aToBeResetChanges.push(e)}})}else{n.push(...this.getChangesToDelete())}if(n.length){this._oDeactivateChange=e.create({changeSpecificData:{changeType:"deactivateChanges",content:{changeIds:n.map(e=>e.getId())},generator:a.generator||o.GENERATOR_NAME,layer:a.layer},selector:this.getAppComponent()})}}return e.create({changeSpecificData:r,annotationChange:true,selector:this.getAppComponent()})};r.prototype.execute=async function(){if(this._aToBeResetChanges.length){await a.resetChanges(this._aToBeResetChanges,this.getAppComponent(),true)}if(this._oDeactivateChange){n.add({selector:this.getAppComponent(),flexObjects:[this._oDeactivateChange]})}};r.prototype.undo=async function(){if(this._aToBeResetChanges.length){await a.restoreChanges(this._aToBeResetChanges,this.getAppComponent(),true)}if(this._oDeactivateChange){n.remove({selector:this.getAppComponent(),flexObjects:[this._oDeactivateChange]})}};r.prototype.needsReload=true;return r});
//# sourceMappingURL=AnnotationCommand.js.map