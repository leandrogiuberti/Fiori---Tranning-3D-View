/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/each","sap/ui/fl/write/api/SmartVariantManagementWriteAPI","sap/ui/rta/command/BaseCommand","sap/ui/rta/library"],function(t,e,a,i){"use strict";const r=a.extend("sap.ui.rta.command.compVariant.CompVariantUpdate",{metadata:{library:"sap.ui.rta",properties:{newVariantProperties:{type:"object"},newDefaultVariantId:{type:"string"},oldDefaultVariantId:{type:"string"},oldSelectedVariantId:{type:"string"},onlySave:{type:"boolean"},isModifiedBefore:{type:"boolean"}}}});r.prototype.prepare=function(t,e,a){this.mInformation={layer:t.layer,command:a,generator:i.GENERATOR_NAME};return true};function n(t,a,i){const r={...i,...this.mInformation,id:a,control:this.getElement()};return e[t](r)}r.prototype.execute=function(){if(this.getOnlySave()){this.setIsModifiedBefore(this.getElement().getModified());this.getElement().setModified(false);const t=Object.keys(this.getNewVariantProperties())[0];n.call(this,"saveVariantContent",t,this.getNewVariantProperties()[t])}else{t(this.getNewVariantProperties(),(t,e)=>{if(e.deleted){n.call(this,"removeVariant",t,{});this.getElement().removeVariant({variantId:t});if(this.getElement().getCurrentVariantId()===t){this.getElement().activateVariant("*standard*")}}else{const a=n.call(this,"updateVariantMetadata",t,e);this.getElement().updateVariant(a)}});if(this.getNewDefaultVariantId()){n.call(this,"setDefaultVariantId",undefined,{defaultVariantId:this.getNewDefaultVariantId()});this.getElement().setDefaultVariantId(this.getNewDefaultVariantId())}}return Promise.resolve()};r.prototype.undo=function(){if(this.getOnlySave()){const t=Object.keys(this.getNewVariantProperties())[0];n.call(this,"revert",t,{});this.getElement().setModified(this.getIsModifiedBefore())}else{t(this.getNewVariantProperties(),(t,e)=>{const a=n.call(this,"revert",t,{});if(e.deleted){this.getElement().addVariant(a);if(this.getOldSelectedVariantId()===t){this.getElement().activateVariant(t)}}else{this.getElement().updateVariant(a)}});if(this.getNewDefaultVariantId()){n.call(this,"revertSetDefaultVariantId",this.getOldDefaultVariantId());this.getElement().setDefaultVariantId(this.getOldDefaultVariantId())}}return Promise.resolve()};return r});
//# sourceMappingURL=CompVariantUpdate.js.map