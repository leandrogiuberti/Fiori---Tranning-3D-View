/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/variants/VariantManager","sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/fl/Utils","sap/ui/rta/command/BaseCommand","sap/ui/rta/library"],function(e,t,a,n,r,i,s){"use strict";const o=i.extend("sap.ui.rta.command.ControlVariantConfigure",{metadata:{library:"sap.ui.rta",properties:{control:{type:"any"},changes:{type:"array"},deletedVariants:{type:"array"}},associations:{},events:{}}});o.prototype.prepare=function(e){this.sLayer=e.layer;return true};o.prototype.getPreparedChange=function(){if(!this._aPreparedChanges){return undefined}return this._aPreparedChanges};o.prototype.execute=async function(){const t=this.getControl();this.oAppComponent=r.getAppComponentForControl(t);this.sVariantManagementReference=t.getVariantManagementReference();this._aPreparedChanges=[];if(this.getChanges().some(e=>{if(e.visible===false&&e.variantReference===t.getCurrentVariantKey()){this._sOldVReference=e.variantReference;return true}return false})){await e.activateVariant({element:t,variantReference:this.sVariantManagementReference})}this.getChanges().forEach(function(e){e.appComponent=this.oAppComponent;e.generator=s.GENERATOR_NAME;this._aPreparedChanges.push(a.addVariantChange(this.sVariantManagementReference,e))}.bind(this));this._aDeletedFlexObjects=n.deleteVariantsAndRelatedObjects({variantManagementControl:t,layer:this.sLayer,variants:this.getDeletedVariants()});return Promise.resolve()};o.prototype.undo=async function(){const r=t.getFlexReference({element:this.getControl()});n.restoreDeletedFlexObjects({reference:r,flexObjects:this._aDeletedFlexObjects});delete this._aDeletedFlexObjects;this.getChanges().forEach((e,t)=>{const n={appComponent:this.oAppComponent};Object.keys(e).forEach(function(t){const a=`original${t.charAt(0).toUpperCase()}${t.substr(1)}`;if(t==="visible"){n[t]=true}else if(e[a]){n[t]=e[a];n[a]=e[t]}else if(t.indexOf("original")===-1){n[t]=e[t]}});const r=this._aPreparedChanges[t];a.deleteVariantChange(this.sVariantManagementReference,n,r)});this._aPreparedChanges=null;if(this._sOldVReference){await e.activateVariant({element:this.getControl(),variantReference:this._sOldVReference});delete this._sOldVReference}};return o});
//# sourceMappingURL=ControlVariantConfigure.js.map