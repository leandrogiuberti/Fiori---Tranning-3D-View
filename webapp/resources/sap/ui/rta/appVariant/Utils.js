/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/IconPool","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/write/api/AppVariantWriteAPI","sap/ui/fl/Utils","sap/ui/rta/appVariant/AppVariantUtils"],function(t,e,i,a,n){"use strict";const r={};r._checkNavigationSupported=function(t){const e=a.getUshellContainer();return e.getServiceAsync("Navigation").then(function(e){return e.getLinks([t])}).catch(function(t){throw new Error(`Error retrieving ushell service Navigation: ${t}`)})};r._checkAppType=function(t,e,i){if(t&&e){return i.getText("MAA_ORIGINAL_TYPE")}else if(e){return i.getText("MAA_APP_VARIANT_TYPE")}else if(t){return i.getText("MAA_ORIGINAL_TYPE")}return undefined};r._calculateCurrentStatus=function(t,e,i){const a=n.getNewAppVariantId();if(e==="R"){return i.getText("MAA_OPERATION_IN_PROGRESS")}else if(a===t){n.setNewAppVariantId(null);if(e!=="E"){return i.getText("MAA_NEW_APP_VARIANT")}}};r._checkMenuItemOptions=function(t,e){const i={};if(t.isKeyUser){if(t.isOriginal){i.delAppVarButtonVisibility=false;i.adaptUIButtonVisibility=false;return i}if(t.appVarStatus==="U"||t.appVarStatus==="E"||t.appVarStatus==="R"){i.saveAsButtonEnabled=false}i.adaptUIButtonVisibility=true;if(e){if(t.isS4HanaCloud){i.delAppVarButtonEnabled=true;i.delAppVarButtonVisibility=true}else{i.delAppVarButtonEnabled=false;i.delAppVarButtonVisibility=true}}else{i.delAppVarButtonVisibility=true;if(t.appVarStatus==="R"){i.delAppVarButtonEnabled=false}else{i.delAppVarButtonEnabled=true}}}else{i.delAppVarButtonVisibility=false;i.adaptUIButtonVisibility=false}return i};r._getNavigationInfo=function(t){let e={};const i=t.startWith.semanticObject;const a=t.startWith.action;const n=t.startWith.parameters;const r={semanticObject:i,action:a,params:n};return this._checkNavigationSupported(r).then(function(r){if(r[0].length&&t.isKeyUser){e.adaptUIButtonEnabled=true;if(t.appVarStatus==="R"||t.appVarStatus==="U"||t.appVarStatus==="E"){e.adaptUIButtonEnabled=false;e.appVarStatus=t.appVarStatus}}else{e.adaptUIButtonEnabled=false}const s=this._checkMenuItemOptions(t,e.adaptUIButtonEnabled);e.semanticObject=i;e.action=a;if(n){Object.keys(n).forEach(function(t){if(n[t].value){n[t]=n[t].value}});e.params=n}e={...e,...s};return e}.bind(this))};r._prepareAppVariantAttributes=function(t){return{appId:t.appId,title:t.title||"",subTitle:t.subTitle||"",description:t.description||"",icon:t.iconUrl||"",iconText:t.iconText,isOriginal:t.isOriginal,isAppVariant:t.isAppVariant,descriptorUrl:t.descriptorUrl,appVarStatus:t.appVarStatus}};r.getAppVariantOverviewAttributes=function(i,a,n){let r;const s=i.iconUrl;if(s&&t.isIconURI(s)){i.iconText=s.split("//")[1]}r=this._prepareAppVariantAttributes(i);r.isKeyUser=a;r.typeOfApp=this._checkAppType(i.isOriginal,i.isAppVariant,n);r.currentStatus=this._calculateCurrentStatus(i.appId,i.appVarStatus,n);const p=e.isAtoEnabled();r.isS4HanaCloud=p;const u={isKeyUser:a,isOriginal:i.isOriginal,isS4HanaCloud:p,appVarStatus:i.appVarStatus};if(i.hasStartableIntent){u.startWith=i.startWith;return this._getNavigationInfo(u).then(function(t){r={...r,...t};return r})}r.adaptUIButtonEnabled=false;const o=this._checkMenuItemOptions(u,false);r={...r,...o};return Promise.resolve(r)};r.getAppVariantOverview=function(t,e,a){const n=e?"CUSTOMER*":"VENDOR";const r={selector:{appId:t},layer:n};return i.listAllAppVariants(r).then(function(t){const i=[];let n;if(t.response&&t.response.items){n=t.response.items}else{return Promise.resolve([])}n.forEach(function(t){if(!t.isDescriptorVariant){i.push(this.getAppVariantOverviewAttributes(t,e,a))}},this);return Promise.all(i).then(function(t){return t})}.bind(this))};r.getManifest=function(t){return i.getManifest(t).then(function(t){return t.response})};return r},true);
//# sourceMappingURL=Utils.js.map