//@ui5-bundle sap/ui/vtm/library-preload.js
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/ArrayUtilities", ["jquery.sap.global"],function(jQuery){"use strict";var r={};r.haveIntersection=function(r,n){switch(r.length){case 0:case 1:throw"At least two arrays expected when finding intersection";default:var e=r.slice();e.sort(function(r,n){return r.length-n.length});var t=e[0];var u;var f=function(r){return n(r,u)};for(var i=0;i<t.length;i++){u=t[i];var a=true;for(var o=1;o<e.length;o++){var c=n?e[o].some(f):e[o].indexOf(u)!==-1;if(!c){a=false;break}}if(a){return true}}return false}};r.intersect=function(r,n){switch(r.length){case 0:case 1:throw"At least two arrays expected when finding intersection";default:var e=r.slice();e.sort(function(r,n){return r.length-n.length});var t=[];var u=e[0];var f;var i=function(r){return n(r,f)};for(var a=0;a<u.length;a++){f=u[a];var o=true;for(var c=1;c<e.length;c++){var l=n?e[c].some(i):e[c].indexOf(f)!==-1;if(!l){o=false;break}}if(o){if(t.indexOf(f)===-1){t.push(f)}}}return t}};r.union=function(r,n){var e=[];var t;var u=function(r){return n(r,t)};for(var f=0;f<r.length;f++){var i=r[f];for(var a=0;a<i.length;a++){t=i[a];var o=n?e.some(u):e.indexOf(t)!==-1;if(!o){e.push(t)}}}return e};r.toSet=function(r){var n=new Set;r.forEach(function(r){n.add(r)});return n};r.fromSet=function(r){var n=[];r.forEach(function(r){n.push(r)});return n};r.fromArrayLike=function(r){var n=[];for(var e=0;e<r.length;e++){n.push(r[e])}return n};r.wrap=function(r){if(r===undefined){return[]}else if(Array.isArray(r)){return r}return[r]};r.unwrap=function(r){if(Array.isArray(r)){if(r.length==0){return undefined}else if(r.length==1){return r[0]}else{return r}}else{return r}};r.areEqual=function(r,n){if(!n){n=function(r,n){return r===n}}var e=r[0];var t=r.slice(1);var u=e.length;var f=t.every(function(r){return u===r.length});if(!f){return false}return t.every(function(r){return r.every(function(r,t){return n(r,e[t])})})};r.shallowClone=function(r){return r.slice(0)};r.deepClone=function(r,n){if(!n){return undefined}return r.map(function(r){return n(r)})};r.find=function(r,n){for(var e=0;e<r.length;e++){var t=r[e];if(n(t)){return t}}return undefined};r.findIndex=function(r,n){for(var e=0;e<r.length;e++){if(n(r[e])){return e}}return-1};r.flatten=function(r){return[].concat.apply([],r)};return r},true);
/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/CheckEye", ["jquery.sap.global","sap/ui/core/Icon","sap/ui/core/IconRenderer","./library"],function(jQuery,e,i,s){"use strict";var t=e.extend("sap.ui.vtm.CheckEye",{metadata:{library:"sap.ui.vtm",properties:{visibility:{type:"boolean"}}},onAfterRendering:function(){var e=this.$();e.addClass("sapUiVtmCheckEye")},renderer:i.render,setVisibility:function(e){this.setProperty("visibility",e);switch(e){case true:this.setSrc("sap-icon://show");this.setVisible(true);break;case false:this.setSrc("sap-icon://hide");this.setVisible(true);break;default:this.setVisible(false);break}}});return t},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/ChildCollectionType", [],function(){"use strict";sap.ui.vtm.ChildCollectionType={None:"None",Included:"Included",Excluded:"Excluded",IncludedAndExcluded:"IncludedAndExcluded"};return sap.ui.vtm.ChildCollectionType},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Column", ["jquery.sap.global","sap/ui/core/Element","sap/ui/commons/Label"],function(jQuery,t,e){"use strict";var i=t.extend("sap.ui.vtm.Column",{metadata:{properties:{type:{type:"sap.ui.vtm.ColumnType"},descriptor:{type:"string"},tooltip:{type:"string",defaultValue:null},hAlign:{type:"sap.ui.core.HorizontalAlign",defaultValue:"Left"},width:{type:"sap.ui.core.CSSSize",defaultValue:"200px"},resizable:{type:"boolean",defaultValue:true},label:{type:"string"},labelControl:{type:"object"},valueFormatter:{type:"any"},tooltipFormatter:{type:"any"},template:{type:"sap.ui.core.Control"}}},constructor:function(e,i){if(jQuery.type(e)=="object"){i=e;e=i.id}t.apply(this,[e,{}]);if(i){if(i.type){this.setType(i.type)}if(i.descriptor){this.setDescriptor(i.descriptor)}if(i.label){this.setLabel(i.label)}if(i.labelControl){this.setLabelControl(i.labelControl)}if(i.tooltip){this.setTooltip(i.tooltip)}if(i.hAlign){this.setHAlign(i.hAlign)}if(i.width){this.setWidth(i.width)}if(i.resizable===true||i.resizable===false){this.setResizable(i.resizable)}if(i.valueFormatter){this.setValueFormatter(i.valueFormatter)}if(i.tooltipFormatter){this.setTooltipFormatter(i.tooltipFormatter)}if(i.template){this.setTemplate(i.template)}}}});return i});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/ColumnTemplates", ["jquery.sap.global"],function(jQuery){"use strict";var t={};t.createBasicColumnTemplate=function(t,e,r,a){if(!r){r=t}if(!a){a=e}var n=new sap.m.Text({wrapping:false});n.bindProperty("text",{path:t,formatter:e});n.bindProperty("tooltip",{path:r,formatter:a});return n};t.createTreeColumnTemplate=function(){var t=new sap.ui.core.Icon({decorative:false,src:"{iconUrl}",color:"{iconColor}",tooltip:"{iconTooltip}"});t.addStyleClass("sapUiVtmTree_TreeColumn_Icon");t.bindProperty("visible",{path:"iconUrl",formatter:function(t){return t?true:false}});var e=new sap.ui.vtm.Text({wrapping:false,text:"{name}",tooltip:"{name}",textColor:"{textColor}"});e.addStyleClass("sapUiVtmTree_TreeColumn_NameText");var r=new sap.m.HBox({items:[t,e],alignContent:sap.m.FlexAlignContent.Center,alignItems:sap.m.FlexAlignItems.Center});return r};t.createMessageStatusColumnTemplate=function(){var t=new sap.ui.core.Icon({decorative:false,useIconTooltip:false,src:"{messageStatusIconUrl}",color:"{messageStatusIconColor}",tooltip:"{messageStatusIconTooltip}"});return t};t.createVisibilityColumnTemplate=function(){var t=sap.ui.vtm.getResourceBundle();var e=t.getText("COLUMNCELLTOOLTIP_VISIBILITY_CLICK_TO_SHOW");var r=t.getText("COLUMNCELLTOOLTIP_VISIBILITY_CLICK_TO_HIDE");var a=new sap.ui.vtm.CheckEye({visibility:{path:"",formatter:function(t){if(!t||t.visibility==null){return null}return t.visibility}},tooltip:{path:"",formatter:function(t){if(!t||t.visibility==null){return null}return t.visibility?r:e}}});return a};t.createTreeItemIdColumnTemplate=function(){return t.createBasicColumnTemplate("id")};t._formatValue=function(e){if(e==undefined||e===null){return null}switch(typeof e){case"string":return e;case"number":return e.toLocaleString();case"boolean":if(!t._true||!t._false){var r=sap.ui.vtm.getResourceBundle();t._trueString=r.getText("BOOLEAN_TRUE");t._falseString=r.getText("BOOLEAN_FALSE")}return e?t._trueString:t._falseString;default:return JSON.stringify(e)}};t.metadataFormatterFactory=function(e,r){return function(a){if(!a||!a.metadata){return null}var n=sap.ui.vtm.ArrayUtilities.wrap(a.metadata[e]);var i=n.map(t._formatValue);return i.join(r)}};t.createMetadataColumnTemplate=function(e){var r=e.getValueFormatter()||t.metadataFormatterFactory(e.getDescriptor(),", ");var a=e.getTooltipFormatter()||t.metadataFormatterFactory(e.getDescriptor(),"\n");return t.createBasicColumnTemplate("",r,"",a)};t.identifierFormatterFactory=function(t,e){return function(r){if(!r||!r.identifiers){return null}var a=r.identifiers[t];return a instanceof Array?a.join(e):a}};t.createIdentifierColumnTemplate=function(e){var r=e.getValueFormatter()||t.identifierFormatterFactory(e.getDescriptor(),", ");var a=e.getTooltipFormatter()||t.identifierFormatterFactory(e.getDescriptor(),"\n");return t.createBasicColumnTemplate("",r,"",a)};t.appDataFormatterFactory=function(e,r){return function(a){if(!a||!a.appData){return null}var n=sap.ui.vtm.ArrayUtilities.wrap(a.appData[e]);var i=n.map(t._formatValue);return i.join(r)}};t.createAppDataColumnTemplate=function(e){var r=e.getValueFormatter()||t.appDataFormatterFactory(e.getDescriptor(),", ");var a=e.getTooltipFormatter()||t.appDataFormatterFactory(e.getDescriptor(),"\n");return t.createBasicColumnTemplate("",r,"",a)};t.matrixFormatterFactory=function(t,e){return function(r){if(!r){return null}var a=sap.ui.vtm.MatrixUtilities.getMatrixComponentNames();var n=r.map(function(e,r){var n=e.toLocaleString();return jQuery.sap.formatMessage(t,[a[r],n])});return n.join(e)}};t.createAbsoluteMatrixColumnTemplate=function(){return t.createBasicColumnTemplate("absoluteMatrix",t.matrixFormatterFactory("{1}"," "),"absoluteMatrix",t.matrixFormatterFactory("{0}:\t{1}","\n"))};t.createRelativeMatrixColumnTemplate=function(){return t.createBasicColumnTemplate("relativeMatrix",t.matrixFormatterFactory("{1}"," "),"relativeMatrix",t.matrixFormatterFactory("{0}:\t{1}","\n"))};t.createSceneNodeIdsColumnTemplate=function(){var e=function(t){if(!t){return null}return sap.ui.vtm.TreeItemUtilities.getSceneNodeIds(t).join(", ")};return t.createBasicColumnTemplate("",e)};t.createOpacityColumnTemplate=function(){var e=function(t){if(!t||t.opacity===undefined||t.opacity===null){return null}return""+t.opacity*100+"%"};return t.createBasicColumnTemplate("",e)};t.createHighlightColorColumnTemplate=function(){var e=function(t){if(!t||t.highlightColor===undefined||t.sceneHighlightColor===null){return null}return t.highlightColor};return t.createBasicColumnTemplate("",e)};return t},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/ColumnType", [],function(){"use strict";sap.ui.vtm.ColumnType={Metadata:"Metadata",Identifier:"Identifier",AppData:"AppData",Internal:"Internal"};return sap.ui.vtm.ColumnType},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/DescriptorUtilities", ["jquery.sap.global"],function(jQuery){"use strict";var e={};e.createMetadataDescriptor=function(e,r){return JSON.stringify({category:e,field:r})};e.createIdentifierDescriptor=function(e,r){return JSON.stringify({source:e,type:r})};return e},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/DisplayGroup", ["jquery.sap.global","sap/ui/core/Element"],function(jQuery,e){"use strict";var t=e.extend("sap.ui.vtm.DisplayGroup",{metadata:{properties:{displayStatesBySceneNodeId:{type:"object",defaultValue:{}}}}});return t},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Extension", ["jquery.sap.global","sap/ui/core/Element"],function(jQuery,t){"use strict";var e=t.extend("sap.ui.vtm.Extension",{metadata:{properties:{enabled:{type:"boolean",defaultValue:true,bindable:true}},events:{enabledChanged:{},initialized:{}}},constructor:function(e,i){t.apply(this,arguments);var n=this.setParent;this.setParent=function(t,e,i){var a=n.apply(this,arguments);this.fireEvent("parentSet",{parent:t});return a}.bind(this)},init:function(){this.getVtmPromise().then(function(t){this._vtm=t;this.initialize(t);this.fireInitialized()}.bind(this))},initialize:function(t){throw"initialize() needs to be redefined"},setEnabled:function(t){this.setProperty("enabled",t);this.fireEnabledChanged()},applyPanelHandler:function(t){var e=this._vtm.getPanels();e.forEach(t);this._vtm.attachPanelAdded(function(e){t(e.getParameter("panel"))})},getVtmPromise:function(){return new Promise(function(t,e){this.attachEventOnce("parentSet",function(i){var n=i.getParameter("parent");if(n.getMetadata().getName()==="sap.ui.vtm.Vtm"){sap.ui.vtm.measure(this,"getVtmPromise resolve",function(){t(n)})}else{sap.ui.vtm.measure(this,"getVtmPromise reject",function(){e(n)})}}.bind(this))}.bind(this))},getInitializedPromise:function(){return new Promise(function(t,e){this.attachInitialized(function(e){sap.ui.vtm.measure(this,"getInitializedPromise resolve",function(){t()})}.bind(this))}.bind(this))}});return e});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/HashUtilities", ["jquery.sap.global"],function(jQuery){"use strict";var r={};r.hashString=function(r){var n=3340149426;for(var a=0;a<r.length;a++){n=(n+r.charCodeAt(a))*7|0}return n};r.hashMatrix=function(r){var n=5831;for(var a=0;a<r.length;a++){var t=Math.round(Math.round(r[a]*10)/10);n=(t+n)*7|0}return n};r.normalizeHash=function(r,n){if(!n){n=5e4}return Math.abs(r)%n};r.combineHashes=function(n,a){var t=4063827655;for(var e=0;e<n.length;e++){t=(n[e]+t)*3|0}return r.normalizeHash(t,a)};return r},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/InternalColumnDescriptor", [],function(){"use strict";sap.ui.vtm.InternalColumnDescriptor={Tree:"Tree",MessageStatus:"MessageStatus",Visibility:"Visibility",TreeItemId:"TreeItemId",AbsoluteMatrix:"AbsoluteMatrix",RelativeMatrix:"RelativeMatrix",SceneNodeIds:"SceneNodeIds",Opacity:"Opacity",HighlightColor:"HighlightColor"};return sap.ui.vtm.InternalColumnDescriptor},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/InternalColumns", ["jquery.sap.global","./ColumnType","./InternalColumnDescriptor"],function(jQuery,e,t){"use strict";var r=function(){return{type:e.Internal}};var n={};n.createTreeColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=jQuery.extend(r(),{descriptor:t.Tree,label:e.getText("COLUMNNAME_TREE"),tooltip:e.getText("COLUMNNAME_TREE"),width:"250px"});return new sap.ui.vtm.Column(n)};n.createVisibilityColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=e.getText("COLUMNTOOLTIP_VISIBILITY_CLICK_TO_HIDE_ALL");var a=e.getText("COLUMNTOOLTIP_VISIBILITY_CLICK_TO_SHOW_ALL");var o=new sap.ui.vtm.CheckEye({visibility:true,decorative:false,tooltip:{path:"",formatter:function(){return o.visibility?n:a}}});o.addEventDelegate({onfocusin:function(e){o.getDomRef().blur()}},o);var i=jQuery.extend(r(),{descriptor:t.Visibility,labelControl:o,hAlign:sap.ui.core.HorizontalAlign.Center,width:"2.5em",resizable:false});return new sap.ui.vtm.Column(i)};n.createMessageStatusColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=new sap.ui.core.Icon({src:"sap-icon://message-warning",tooltip:e.getText("COLUMNTOOLTIP_MESSAGESTATUS"),decorative:false});n.addEventDelegate({onfocusin:function(e){n.getDomRef().blur()}},n);var a=jQuery.extend(r(),{descriptor:t.MessageStatus,labelControl:n,hAlign:sap.ui.core.HorizontalAlign.Center,width:"2.5em",resizable:false});a.labelControl.addStyleClass("sapUiVtmTree_StatusColumn_HeaderIcon");return new sap.ui.vtm.Column(a)};n.createTreeItemIdColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=jQuery.extend(r(),{descriptor:t.TreeItemId,label:e.getText("COLUMNNAME_TREEITEMID"),tooltip:e.getText("COLUMNNAME_TREEITEMID")});return new sap.ui.vtm.Column(n)};n.createAbsoluteMatrixColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=jQuery.extend(r(),{descriptor:t.AbsoluteMatrix,label:e.getText("COLUMNNAME_ABSOLUTEMATRIX"),tooltip:e.getText("COLUMNNAME_ABSOLUTEMATRIX")});return new sap.ui.vtm.Column(n)};n.createRelativeMatrixColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=jQuery.extend(r(),{descriptor:t.RelativeMatrix,label:e.getText("COLUMNNAME_RELATIVEMATRIX"),tooltip:e.getText("COLUMNNAME_RELATIVEMATRIX")});return new sap.ui.vtm.Column(n)};n.createSceneNodeIdsColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=jQuery.extend(r(),{descriptor:t.SceneNodeIds,label:e.getText("COLUMNNAME_SCENENODEIDS"),tooltip:e.getText("COLUMNNAME_SCENENODEIDS")});return new sap.ui.vtm.Column(n)};n.createOpacityColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=jQuery.extend(r(),{descriptor:t.Opacity,label:e.getText("COLUMNNAME_OPACITY"),tooltip:e.getText("COLUMNNAME_OPACITY")});return new sap.ui.vtm.Column(n)};n.createHighlightColorColumn=function(){var e=sap.ui.vtm.getResourceBundle();var n=jQuery.extend(r(),{descriptor:t.HighlightColor,label:e.getText("COLUMNNAME_HIGHLIGHTCOLOR"),tooltip:e.getText("COLUMNNAME_HIGHLIGHTCOLOR")});return new sap.ui.vtm.Column(n)};return n},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Lookup", ["jquery.sap.global","sap/ui/core/Element","./ArrayUtilities"],function(jQuery,e,t){"use strict";var i=e.extend("sap.ui.vtm.Lookup",{init:function(){this.clear()},addValue:function(e,t){var i=this._valuesByKey;var u=i.get(e);if(u){u.push(t)}else{i.set(e,[t])}return this},removeValue:function(e,t,i){if(!i){i=function(e,t){return e===t}}var u=this._valuesByKey.get(e);if(u){var n=sap.ui.vtm.ArrayUtilities.findIndex(u,function(e){return i(t,e)});if(n>=0){u.splice(n,1);if(u.length==0){this._valuesByKey.delete(e)}}}return this},clear:function(){this._valuesByKey=new Map;return this},hasValue:function(e){return this._valuesByKey.has(e)},getValues:function(e){var t=this._valuesByKey.get(e);if(t){t=t.slice()}return t||[]},forEach:function(e){this._valuesByKey.forEach(e);return this}});return i});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/MatrixComponent", [],function(){"use strict";sap.ui.vtm.MatrixComponent={LOCX:0,LOCY:1,LOCZ:2,AXIS1X:3,AXIS1Y:4,AXIS1Z:5,AXIS2X:6,AXIS2Y:7,AXIS2Z:8,AXIS3X:9,AXIS3Y:10,AXIS3Z:11,SCALE:12};return sap.ui.vtm.MatrixComponent},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/MatrixUtilities", ["jquery.sap.global"],function(jQuery){"use strict";var e=0,t=1,r=2,n=3,i=4,a=5,T=6,u=7,f=8,s=9,M=10,o=11,N=12,O=0,l=1,I=2,X=3,x=4,A=5,v=6,C=7,g=8,c=9,m=10,_=11,E=12;var R={};R.isValid=function(e,t){if(!e||!Array.isArray(e)||e.length!==13){return false}if(t){return R.isInvertible(e)}return true};R.createIdentity=function(){return[0,0,0,1,0,0,0,1,0,0,0,1,1]};R.areEqual=function(e,t){for(var r=0;r<e.length;r++){if(Math.abs(e[r]-t[r])>.01){return false}}return true};R.isInvertible=function(e){var t=0,r=0,N=e[n],O=e[i],l=e[a],I=e[T],X=e[u],x=e[f],A=e[s],v=e[M],C=e[o],g=N*X*C;if(g>=0){t+=g}else{r+=g}g=I*v*l;if(g>=0){t+=g}else{r+=g}g=A*O*x;if(g>=0){t+=g}else{r+=g}g=-A*X*l;if(g>=0){t+=g}else{r+=g}g=-I*O*C;if(g>=0){t+=g}else{r+=g}g=-N*v*x;if(g>=0){t+=g}else{r+=g}var c=t+r;if(c==0||Math.abs(c)<(t-r)*1e-12){return false}return true};R.invert=function(N){var O=0,l=0,I=N[e],X=N[t],x=N[r],A=N[n],v=N[i],C=N[a],g=N[T],c=N[u],m=N[f],_=N[s],E=N[M],P=N[o],S=A*c*P,p=R.createIdentity();if(S>=0){O+=S}else{l+=S}S=g*E*C;if(S>=0){O+=S}else{l+=S}S=_*v*m;if(S>=0){O+=S}else{l+=S}S=-_*c*C;if(S>=0){O+=S}else{l+=S}S=-g*v*P;if(S>=0){O+=S}else{l+=S}S=-A*E*m;if(S>=0){O+=S}else{l+=S}var b=O+l;if(b==0||Math.abs(b)<(O-l)*1e-12){return p}var y=1/b;p[n]=(c*P-E*m)*y;p[i]=-(v*P-E*C)*y;p[a]=(v*m-c*C)*y;p[T]=-(g*P-_*m)*y;p[u]=(A*P-_*C)*y;p[f]=-(A*m-g*C)*y;p[s]=(g*E-_*c)*y;p[M]=-(A*E-_*v)*y;p[o]=(A*c-g*v)*y;p[e]=-(I*p[n]+X*p[T]+x*p[s]);p[t]=-(I*p[i]+X*p[u]+x*p[M]);p[r]=-(I*p[a]+X*p[f]+x*p[o]);return p};R.to4x4Matrix=function(O){var l=[];l[0]=[O[n],O[i],O[a],0];l[1]=[O[T],O[u],O[f],0];l[2]=[O[s],O[M],O[o],0];l[3]=[O[e],O[t],O[r],O[N]];return l};R.from4x4Matrix=function(O){var l=[];l[n]=O[0][0];l[i]=O[0][1];l[a]=O[0][2];l[T]=O[1][0];l[u]=O[1][1];l[f]=O[1][2];l[s]=O[2][0];l[M]=O[2][1];l[o]=O[2][2];l[e]=O[3][0];l[t]=O[3][1];l[r]=O[3][2];l[N]=O[3][3];return l};R.fromVkMatrix=function(O){var l=[];l[n]=O[0];l[i]=O[1];l[a]=O[2];l[T]=O[3];l[u]=O[4];l[f]=O[5];l[s]=O[6];l[M]=O[7];l[o]=O[8];l[e]=O[9];l[t]=O[10];l[r]=O[11];l[N]=1;return l};R.toVkMatrix=function(N){var O=[];O[0]=N[n];O[1]=N[i];O[2]=N[a];O[3]=N[T];O[4]=N[u];O[5]=N[f];O[6]=N[s];O[7]=N[M];O[8]=N[o];O[9]=N[e];O[10]=N[t];O[11]=N[r];return O};R.fromVsmMatrixString=function(R){var P=R.split(" ").map(function(e){return parseFloat(e)});var S=[];S[n]=P[O];S[i]=P[l];S[a]=P[I];S[T]=P[X];S[u]=P[x];S[f]=P[A];S[s]=P[v];S[M]=P[C];S[o]=P[g];S[e]=P[c];S[t]=P[m];S[r]=P[_];S[N]=P[E];return S};R.toVsmMatrixString=function(R){var P=[];P[O]=R[n];P[l]=R[i];P[I]=R[a];P[X]=R[T];P[x]=R[u];P[A]=R[f];P[v]=R[s];P[C]=R[M];P[g]=R[o];P[c]=R[e];P[m]=R[t];P[_]=R[r];P[E]=R[N];return P.join(" ")};R.multiply=function(O,l){var I=[],X=O[e],x=O[t],A=O[r],v=O[n],C=O[i],g=O[a],c=O[T],m=O[u],_=O[f],E=O[s],R=O[M],P=O[o],S=O[N],p=l[e],b=l[t],y=l[r],d=l[n],h=l[i],V=l[a],L=l[T],Y=l[u],Z=l[f],j=l[s],k=l[M],q=l[o],B=l[N];I[n]=v*d+C*L+g*j;I[i]=v*h+C*Y+g*k;I[a]=v*V+C*Z+g*q;I[T]=c*d+m*L+_*j;I[u]=c*h+m*Y+_*k;I[f]=c*V+m*Z+_*q;I[s]=E*d+R*L+P*j;I[M]=E*h+R*Y+P*k;I[o]=E*V+R*Z+P*q;I[e]=X*d+x*L+A*j+S*p;I[t]=X*h+x*Y+A*k+S*b;I[r]=X*V+x*Z+A*q+S*y;I[N]=S*B;return I};R.getMatrixComponentNames=function(){if(!R._matrixComponentNames){var e=sap.ui.vtm.getResourceBundle();R._matrixComponentNames=[e.getText("TMATRIXCOMPONENT_LOCX"),e.getText("TMATRIXCOMPONENT_LOCY"),e.getText("TMATRIXCOMPONENT_LOCZ"),e.getText("TMATRIXCOMPONENT_AXIS1X"),e.getText("TMATRIXCOMPONENT_AXIS1Y"),e.getText("TMATRIXCOMPONENT_AXIS1Z"),e.getText("TMATRIXCOMPONENT_AXIS2X"),e.getText("TMATRIXCOMPONENT_AXIS2Y"),e.getText("TMATRIXCOMPONENT_AXIS2Z"),e.getText("TMATRIXCOMPONENT_AXIS3X"),e.getText("TMATRIXCOMPONENT_AXIS3Y"),e.getText("TMATRIXCOMPONENT_AXIS3Z"),e.getText("TMATRIXCOMPONENT_SCALE")]}return R._matrixComponentNames};return R},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/MessagesPopover", ["jquery.sap.global","./library","sap/m/Popover","sap/m/PopoverRenderer","sap/m/List"],function(jQuery,e,t,o,s){"use strict";var i=sap.m.Popover.extend("sap.ui.vtm.MessagesPopover",{metadata:{properties:{messages:{type:"object[]"},maxHeight:{type:"sap.ui.core.CSSSize",defaultValue:null}}},init:function(){t.prototype.init.apply(this);this._rb=sap.ui.vtm.getResourceBundle();this.setShowHeader(false);this.attachAfterOpen(this._onAfterOpen,this)},renderer:function(e,t){o.render.call(this,e,t)},onAfterRendering:function(){var e=this.getDomRef();var t=parseInt(this.getMaxHeight(),10);if(t>0&&e.clientHeight>t){this.setContentHeight(this.getMaxHeight())}},setMessages:function(e){var t=[];e.forEach(function(e){var o={text:e.getText()};var s=e.getLevel();var i=e.getIcon();switch(s){case sap.ui.core.MessageType.Error:o.iconUrl=i||"sap-icon://error";o.iconColor=sap.ui.core.IconColor.Negative;o.iconTooltip=this._rb.getText("MESSAGESTATUS_ERROR");break;case sap.ui.core.MessageType.Warning:o.iconUrl=i||"sap-icon://alert";o.iconColor=sap.ui.core.IconColor.Critical;o.iconTooltip=this._rb.getText("MESSAGESTATUS_WARNING");break;case sap.ui.core.MessageType.Success:o.iconUrl=i||"sap-icon://sys-enter-2";o.iconColor=sap.ui.core.IconColor.Positive;o.iconTooltip=this._rb.getText("MESSAGESTATUS_SUCCESS");break;case sap.ui.core.MessageType.Information:o.iconUrl=i||"sap-icon://message-information";o.iconColor=sap.ui.core.IconColor.Neutral;o.iconUrl=i||"sap-icon://message-information";o.iconTooltip=this._rb.getText("MESSAGESTATUS_INFORMATION");break;default:e.color=sap.ui.core.IconColor.Default}t.push(o)}.bind(this));var o=new sap.ui.model.json.JSONModel;var s={messages:t};o.setData(s);var i=new sap.m.List;i.setModel(o,"model");i.bindItems("model>/messages",new sap.m.CustomListItem({content:[new sap.ui.layout.HorizontalLayout({content:[new sap.ui.core.Icon({src:"{model>iconUrl}",color:"{model>iconColor}",tooltip:"{model>iconTooltip}"}).addStyleClass("sapUiVtmTreeStatusItem"),new sap.m.Text({text:"{model>text}",tooltip:"{model>text}",wrapping:true}).addStyleClass("sapUiVtmTreeStatusItem")]})]}));this.addContent(i);return this},_onModelContextChanged:function(){this.close()},_onAfterOpen:function(e){var t=e.getParameter("openBy");if(t){t.attachModelContextChange(this._onModelContextChanged,this);this.attachAfterClose(this._onAfterClose,this)}this.detachAfterOpen(this._onAfterOpen,this)},_onAfterClose:function(e){var t=e.getParameter("openBy");if(t){t.detachModelContextChange(this._onModelContextChanged,this);this.detachAfterClose(this._onAfterClose,this)}setTimeout(function(){this.destroy()}.bind(this),0)}});return i});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Panel", ["jquery.sap.global","sap/ui/core/Control","sap/ui/commons/Panel","sap/ui/core/Title","sap/m/VBox","sap/ui/layout/Splitter","./Tree","./Viewport"],function(jQuery,e,t,r,i,n,a,o){"use strict";var s=e.extend("sap.ui.vtm.Panel",{metadata:{properties:{title:{type:"string"},showViewport:{type:"boolean",defaultValue:true},treeWidth:{type:"sap.ui.core.CSSSize",defaultValue:"50%"},height:{type:"sap.ui.core.CSSSize",defaultValue:"inherit"}},aggregations:{_panel:{type:"sap.m.VBox",multiple:false,visibility:"hidden"},titleControls:{type:"sap.ui.core.Control",multiple:"true"},treeHeaderControls:{type:"sap.ui.core.Control",multiple:"true"},viewportHeaderControls:{type:"sap.ui.core.Control",multiple:"true"}},associations:{vtmId:{type:"sap.ui.vtm.Vtm",multiple:false}},events:{initialized:{},contextMenu:{parameters:{clientX:{type:"int"},clientY:{type:"int"},pageX:{type:"int"},pageY:{type:"int"},screenX:{type:"int"},screenY:{type:"int"},eventData:{type:"object"}},allowPreventDefault:true}}},init:function(){var e=this.getId();var t=this._tree=new sap.ui.vtm.Tree(e+"_tree");var r=this._viewport=new sap.ui.vtm.Viewport(e+"_viewport");var i=this._title=new sap.m.Title({textAlign:sap.ui.core.TextAlign.Begin});var n=this._panelHeader=new sap.m.Bar({contentLeft:[i]});this._treeLayout=new sap.ui.layout.SplitterLayoutData({minSize:10});var a=new sap.ui.layout.SplitPane({content:t,demandPane:false,requiredParentWidth:50,layoutData:this._treeLayout});this._viewportLayout=new sap.ui.layout.SplitterLayoutData({minSize:10});var o=new sap.ui.layout.SplitPane({content:r,demandPane:false,requiredParentWidth:50,layoutData:this._viewportLayout});var s=new sap.ui.layout.PaneContainer({panes:[a,o]});var g=this._splitter=new sap.ui.layout.ResponsiveSplitter({rootPaneContainer:s,defaultPane:a});var l=this._page=new sap.m.Page({content:[g],customHeader:n,layoutData:new sap.m.FlexItemData({minHeight:"100%",maxHeight:"100%"})});var u=function(e){var t;sap.ui.vtm.measure(this,"fireContextMenu",function(){t=this.fireContextMenu({clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY,screenX:e.screenX,screenY:e.screenY,eventData:e})}.bind(this));if(!t){e.preventDefault()}}.bind(this);l.addEventDelegate({oncontextmenu:u},l);var p=new sap.m.VBox({fitContainer:true,renderType:sap.m.FlexRendertype.Bare,items:[l]});this.setAggregation("_panel",p);this.data("notUsed","just a bug workaround");this._oldPanes=[];this._setIsActive(false)},onAfterRendering:function(){if(!this._initialized){this._initialize()}},_initialize:function(){var e=this.getVtm();if(e){e._addPanel(this);this._initialized=true;sap.ui.vtm.measure(this,"fireInitialized",function(){this.fireInitialized()}.bind(this))}},destroy:function(){e.prototype.destroy.apply(this);this._destroyed=true;var t=this.getVtm().getPanels().every(function(e){return e._destroyed===true});if(t){this.getVtm().getScene().destroy()}},onmousedown:function(e){this.getVtm()._setActivePanel(this,false)},onfocusin:function(e){this.getVtm()._setActivePanel(this,false)},onfocusout:function(e){var t=this.getVtm();if(t.getActivePanel()===this){t._setActivePanel(null,false)}},addTreeHeaderControl:function(e){return this.getTree().addHeaderControl(e)},addViewportHeaderControl:function(e){return this.getViewport().addHeaderControl(e)},destroyTreeHeaderControls:function(){return this},destroyViewportHeaderControls:function(){return this},getTreeHeaderControls:function(){return this.getTree().getHeaderControls()},getViewportHeaderControls:function(){return this.getViewport().getHeaderControls()},indexOfTreeHeaderControl:function(e){return this.getTree().indexOfHeaderControl(e)},indexOfViewportHeaderControl:function(e){return this.getViewport().indexOfHeaderControl(e)},insertTreeHeaderControl:function(e,t){return this.getTree().insertHeaderControl(e,t)},insertViewportHeaderControl:function(e,t){return this.getViewport().insertHeaderControl(e,t)},removeAllTreeHeaderControls:function(){return this.getTree().removeAllControls()},removeAllViewportHeaderControls:function(){return this.getViewport().removeAllControls()},removeTreeHeaderControl:function(e){return this.getTree().removeControl(e)},removeViewportHeaderControl:function(e){return this.getViewport().removeControl(e)},_getDelegatedAggregation:function(e){switch(e){case"treeHeaderControls":return{control:this.getTree(),aggregationName:e};case"viewportHeaderControls":return{control:this.getViewport(),aggregationName:e};case"titleControls":return{control:this._panelHeader,name:"contentRight"};default:return null}},addAggregation:function(t,r,i){var n=this._getDelegatedAggregation(t);if(n){return n.control.addAggregation(n.name,r,i)}else{return e.prototype.addAggregation.apply(this,[t,r,i])}},bindAggregation:function(t,r){var i=this._getDelegatedAggregation(t);if(i){return i.control.bindAggregation(i.name)}else{return e.prototype.bindAggregation.apply(this,[t])}},destroyAggregation:function(t,r){var i=this._getDelegatedAggregation(t);if(i){return this}else{return e.prototype.destroyAggregation.apply(this,[t,r])}},getAggregation:function(t,r){var i=this._getDelegatedAggregation(t);if(i){return i.control.getAggregation(i.name,r)}else{return e.prototype.getAggregation.apply(this,[t,r])}},indexOfAggregation:function(t,r){var i=this._getDelegatedAggregation(t);if(i){return i.control.indexOfAggregation(i.name,r)}else{return e.prototype.indexOfAggregation.apply(this,[t,r])}},insertAggregation:function(t,r,i,n){var a=this._getDelegatedAggregation(t);if(a){return a.control.insertAggregation(a.name,r,i,n)}else{return e.prototype.insertAggregation.apply(this,[t,r,i,n])}},removeAggregation:function(t,r,i){var n=this._getDelegatedAggregation(t);if(n){return n.control.removeAggregation(n.name,t,r,i)}else{return e.prototype.removeAggregation.apply(this,[t,r,i])}},removeAllAggregation:function(t,r){var i=this._getDelegatedAggregation(t);if(i){return i.control.removeAllAggregation(i.name,t,r)}else{return e.prototype.removeAllAggregation.apply(this,[t,r])}},setAggregation:function(t,r,i){var n=this._getDelegatedAggregation(t);if(n){return n.control.setAggregation(n.name,r,i)}else{return e.prototype.setAggregation.apply(this,[t,r,i])}},unbindAggregation:function(t,r){var i=this._getDelegatedAggregation(t);if(i){return i.control.unbindAggregation(i.name,r)}else{return e.prototype.unbindAggregation.apply(this,[t,r])}},validateAggregation:function(t,r,i){var n=this._getDelegatedAggregation(t);if(n){return n.control.validateAggregation(n.name,r,i)}else{return e.prototype.validateAggregation.apply(this,[t,r,i])}},_getPanel:function(){return this.getAggregation("_panel")},_getTreeLayoutData:function(){return this._treeLayout},_getViewportLayoutData:function(){return this._viewportLayout},renderer:function(e,t){e.write("<div");e.writeControlData(t);e.addStyle("height",t.getHeight());e.writeStyles();e.writeClasses();e.write(">");var r=t._getPanel();e.renderControl(r);e.write("</div>")},setTitle:function(e){this._title.setText(e);this.setProperty("title",e);return this},getTree:function(){return this._tree},getViewport:function(){return this._viewport},setShowViewport:function(e){if(e===this.getShowViewport()){return this}var t=this.getTreeWidth();this.setProperty("showViewport",e);var r=this._splitter.getDefaultPane();var i=this._splitter.getRootPaneContainer();var n=i.getPanes();if(!e){this._oldTreeWidth=t;n.forEach(function(e){if(e.getId()!==r){i.removePane(e);this._oldPanes.push(e)}}.bind(this));this.setTreeWidth("auto")}else{this._oldPanes.forEach(function(e){i.addPane(e)});this._oldPanes=[];this.setTreeWidth(this._oldTreeWidth);this._oldTreeWidth=null}return this},getVtm:function(){if(!this._vtm){this._vtm=sap.ui.getCore().byId(this.getVtmId())}return this._vtm},_setIsActive:function(e){var t=this._isActive;if(t!==e){this._isActive=e;var r=this._getPanel();if(e){r.addStyleClass("sapUiVtmPanel_ActiveBorder");r.removeStyleClass("sapUiVtmPanel_InactiveBorder")}else{r.addStyleClass("sapUiVtmPanel_InactiveBorder");r.removeStyleClass("sapUiVtmPanel_ActiveBorder")}}return this},getIsActive:function(){return this._isActive},getTreeWidth:function(){if(!this.getShowViewport()){return"100%"}var e=this._getTreeLayoutData();var t=e.getSize();if(t==="auto"){return"50%"}return t},setTreeWidth:function(e){if(!e){return this}if(e==="auto"){e=this.getShowViewport()?"50%":"100%"}var t=e.indexOf("%")>-1;var r=this._getTreeLayoutData();var i=this._getViewportLayoutData();if(e.indexOf("px")>-1||t){var n=parseInt(e,10);if(n<0){jQuery.sap.log.error("Negative treeWidth values are not permitted",null,"sap.ui.vtm.Panel");return this}if(t&&n>100){e="100%"}}else{var a="Illegal treeWidth value: "+e;jQuery.sap.log.error(a,null,"sap.ui.vtm.Panel");return this}r.setSize(e);i.setSize("auto");return this}});return s});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/PredefinedView", [],function(){"use strict";var t={Top:"Top",Bottom:"Bottom",Front:"Front",Back:"Back",Left:"Left",Right:"Right"};return t},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Progress", ["jquery.sap.global","sap/ui/core/Control","sap/m/Text","sap/m/ProgressIndicator"],function(jQuery,e,r,s){"use strict";var t=e.extend("sap.ui.vtm.Progress",{metadata:{aggregations:{progressText:{type:"sap.m.Title",multiple:false},progressBar:{type:"sap.m.ProgressIndicator",multiple:false}}},init:function(){var e=new sap.m.ProgressIndicator({width:"100%"});e.addStyleClass("sapUiVtmProgress_progressBar");this.setProgressBar(e);var r=new sap.m.Title({width:"100%",titleStyle:sap.ui.core.TitleLevel.H3,textAlign:sap.ui.core.TextAlign.Center});r.addStyleClass("sapUiVtmProgress_progressText");this.setProgressText(r);this.addStyleClass("sapUiVtmProgress")},renderer:function(e,r){e.write("<div");e.writeControlData(r);e.addStyle("height","inherit");e.writeStyles();e.writeClasses();e.write(">");e.renderControl(r.getProgressText());e.renderControl(r.getProgressBar());e.write("</div>")}});return t});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/ProgressDialog", ["jquery.sap.global","./library","sap/ui/core/Control","sap/m/Dialog","./Progress"],function(jQuery,e,s,r,t){"use strict";var o=s.extend("sap.ui.vtm.ProgressDialog",{metadata:{properties:{progressText:{type:"string"},percentComplete:{type:"int",defaultValue:0},progressBarVisible:{type:"boolean",defaultValue:"true"}}},init:function(){this._oProgress=new sap.ui.vtm.Progress;this._oDialog=new sap.m.Dialog(this.getId()+"-Dialog",{showHeader:false,content:[this._oProgress],verticalScrolling:false,horizontalScrolling:false})},renderer:function(e,s){},open:function(){return this._oDialog.open()},isOpen:function(){return this._oDialog.isOpen()},close:function(){return this._oDialog.close()},setPercentComplete:function(e){this.setProperty("percentComplete",e);this._oProgress.getProgressBar().setPercentValue(e);sap.ui.getCore().applyChanges()},setProgressText:function(e){this.setProperty("progressText",e);this._oProgress.getProgressText().setText(e);sap.ui.getCore().applyChanges()},setProgressBarVisible:function(e){this.setProperty("progressBarVisible",e);this._oProgress.getProgressBar().setVisible(e)}});return o});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Scene", ["jquery.sap.global","sap/ui/core/Element","sap/ui/vk/dvl/GraphicsCore","sap/ui/vk/Scene","sap/ui/vk/NodeHierarchy","./ViewableLoadInfo","./SceneNode","./ArrayUtilities"],function(jQuery,e,t,i,a,s,r,n){"use strict";var o=e.extend("sap.ui.vtm.Scene",{metadata:{events:{downloadProgress:{parameters:{viewable:{type:"sap.ui.vtm.Viewable"},downloadedBytes:{type:"int"},totalBytes:{type:"int"}}},downloadStarted:{parameters:{viewableLoadInfos:{type:"sap.ui.vtm.ViewableLoadInfo[]"}}},downloadCompleted:{parameters:{viewableLoadInfos:{type:"sap.ui.vtm.ViewableLoadInfo[]"},downloadedViewables:{type:"sap.ui.vtm.Viewable[]"}}},loadStarted:{parameters:{viewableLoadInfos:{type:"sap.ui.vtm.ViewableLoadInfo[]"}}},loadProgress:{viewable:{type:"sap.ui.vtm.Viewable"},percentage:{type:"float"}},loadCompleted:{parameters:{succeeeded:{type:"boolean"},viewableLoadInfos:{type:"sap.ui.vtm.ViewableLoadInfo[]"},loadedViewables:{type:"sap.ui.vtm.Viewable[]"}}},hierarchyChanged:{}}},init:function(){this._viewablesBySource=new Map;this._viewableLoadInfosByViewable=new Map;this._rootContentResource=new sap.ui.vk.ContentResource({localMatrix:sap.ui.vtm.MatrixUtilities.toVkMatrix(sap.ui.vtm.MatrixUtilities.createIdentity())})},_getGraphicsCore:function(){var e=this;return new Promise(function(i,a){if(e._vkGraphicsCore){i(e._vkGraphicsCore)}else{t.create({},{antialias:true,alpha:true,premultipliedAlpha:false}).then(function(t){e._vkGraphicsCore=t;t.attachEvent("sceneLoadingProgress",function(t){var i=t.getParameter("sourceName"),a=t.getParameter("percentage")*100,s=e._viewablesBySource.get(i);e.fireLoadProgress({viewable:s,percentage:a})},e);i(t)})}})},destroy:function(){if(this._vkGraphicsCore!==null){this._vkGraphicsCore.destroy();this._vkGraphicsCore=null}e.prototype.destroy.apply(this)},_raiseHierarchyChanged:function(){sap.ui.vtm.measure(this,"fireHierarchyChanged",function(){this.fireHierarchyChanged()}.bind(this))},_getViewableLoadInfos:function(e){var t=[];e.forEach(function(e){var i=this._viewableLoadInfosByViewable.get(e);t.push(i)}.bind(this));return t},_raiseDownloadStarted:function(e){sap.ui.vtm.measure(this,"fireDownloadStarted",function(){var t=this._getViewableLoadInfos(e);this.fireDownloadStarted({viewableLoadInfos:t})}.bind(this))},_raiseDownloadCompleted:function(e){sap.ui.vtm.measure(this,"fireDownloadCompleted",function(){var t=this._getViewableLoadInfos(e);var i=t.filter(function(e){return e.getStatus()===sap.ui.vtm.ViewableLoadStatus.Downloaded}).map(function(e){return e.getViewable()});this.fireDownloadCompleted({viewableLoadInfos:t,downloadedViewables:i})}.bind(this))},_raiseLoadStarted:function(e){sap.ui.vtm.measure(this,"fireLoadStarted",function(){var t=this._getViewableLoadInfos(e);this.fireLoadStarted({viewableLoadInfos:t})}.bind(this))},_raiseLoadCompleted:function(e,t){sap.ui.vtm.measure(this,"fireLoadCompleted",function(){var i=this._getViewableLoadInfos(t);var a=i.filter(function(e){return e.getStatus()===sap.ui.vtm.ViewableLoadStatus.Loaded}).map(function(e){return e.getViewable()});this.fireLoadCompleted({succeeded:e,viewableLoadInfos:i,loadedViewables:a})}.bind(this))},getRootIds:function(){if(this._vkNodeHierarchy){var e=this._vkNodeHierarchy.getChildren();this.addCachedIds(e);return e}return[]},_getSceneNode:function(e){if(!this._vkNodeHierarchy){throw"Scene hierarchy is empty"}var t=new sap.ui.vtm.SceneNode({sceneNodeId:e,scene:this});return t},_getNodeHierarchy:function(){return this._vkNodeHierarchy},_traverseBranch:function(e,t,i,a){i.setSceneNodeId(e);if(t(i,a)===false){return}a.push(e);if(!i.getClosed()){var s=this.getChildIds(e);s.forEach(function(e){this._traverseBranch(e,t,i,a)}.bind(this))}a.pop()},traverseBranch:function(e,t){if(!e){throw"sceneNodeId not defined"}if(!t){throw"callback not defined"}sap.ui.vtm.measure(this,"traverseBranch ("+e+")",function(){var i=this._getSceneNode(e);var a=this.getAncestorIds(e);this._traverseBranch(e,t,i,a);i._destroy()}.bind(this));return this},traverseTree:function(e){if(!e){throw"callback not defined"}if(!this._vkNodeHierarchy){return this}sap.ui.vtm.measure(this,"traverseTree",function(){var t=this.getRootIds();var i=this._getSceneNode(null);t.forEach(function(t){this._traverseBranch(t,e,i,[])}.bind(this));i._destroy()}.bind(this));return this},traverseNodes:function(e,t){if(!e){throw"sceneNodeIds not defined"}if(!t){throw"callback not defined"}if(!Array.isArray(e)){e=[e]}sap.ui.vtm.measure(this,"traverseNodes ("+e.join(",")+")",function(){var i=this._getSceneNode(null);for(var a=0;a<e.length;a++){i.setSceneNodeId(e[a]);if(t(i,a)===false){break}}i._destroy()}.bind(this));return this},_handleLoadContentResourcesAsyncCompleted:function(e,t){t.forEach(function(t){var i=t.getSource();var a=sap.ui.vtm.ArrayUtilities.find(e,function(e){return e.source===i});var s=this._viewableLoadInfosByViewable.get(t);if(a){s.setStatus(sap.ui.vtm.ViewableLoadStatus.DownloadFailed);s.setErrorCode(a.status);s.setErrorText(a.statusText)}else{s.setStatus(sap.ui.vtm.ViewableLoadStatus.Downloaded)}}.bind(this));this._raiseDownloadCompleted(t);if(this.getDownloadedViewables().length!=0){this._raiseLoadStarted(t);setTimeout(function(){var e=function(){t.forEach(function(e){var t=this._viewableLoadInfosByViewable.get(e);var i=t.getStatus();if(i===sap.ui.vtm.ViewableLoadStatus.Loaded&&!e.getRootNodeIds()){var a=e._getContentResource().getNodeProxy();if(a){var s=a.getNodeId();this.addCachedIds(s);var r=this.getChildIds(s);e.setRootNodeIds(r)}}}.bind(this))}.bind(this);var i=function(e){var i=sap.ui.vtm.ArrayUtilities.find(t,function(t){return t.getSource()===e});if(i){var a=this._viewableLoadInfosByViewable.get(i);a.setStatus(sap.ui.vtm.ViewableLoadStatus.Loaded)}}.bind(this);var a=function(e){var i=sap.ui.vtm.ArrayUtilities.find(t,function(t){return t.getSource()===e});if(i){var a=this._viewableLoadInfosByViewable.get(i);a.setStatus(sap.ui.vtm.ViewableLoadStatus.LoadFailed)}}.bind(this);var s=function(e){var t=e.getParameter("source");var s=e.getParameter("sceneId");if(s){i(t)}else{a(t)}};this._vkGraphicsCore.attachSceneLoadingFinished(s);var r=t.filter(function(e){var t=this._viewableLoadInfosByViewable.get(e);switch(t.getStatus()){case sap.ui.vtm.ViewableLoadStatus.Downloading:case sap.ui.vtm.ViewableLoadStatus.DownloadFailed:return false;default:return true}}.bind(this));r.forEach(function(e){var t=e._getContentResource();if(this._rootContentResource.getContentResources().indexOf(t)<0){this._rootContentResource.addContentResource(t)}}.bind(this));if(!this._sceneCreated){var n=sap.ui.vtm.createMeasureId(this,"Building scene tree");jQuery.sap.measure.start(n,"",["sap.ui.vtm"]);this._vkGraphicsCore.buildSceneTreeAsync([this._rootContentResource]).then(function(i){jQuery.sap.measure.end(n);this._vkGraphicsCore.detachSceneLoadingFinished(s);this._vkScene=i.scene;this._vkNodeHierarchy=this._vkScene.getDefaultNodeHierarchy();var a=this.getRootIds();this.addCachedIds(a);e();this._sceneCreated=true;this.fireEvent("sceneCreated");this._raiseHierarchyChanged();this._raiseLoadCompleted(true,t)}.bind(this)).catch(function(e){jQuery.sap.measure.end(n);this._vkGraphicsCore.detachSceneLoadingFinished(s);this._raiseLoadCompleted(false,t)}.bind(this))}else{var o=sap.ui.vtm.createMeasureId(this,"Updating scene tree");jQuery.sap.measure.start(o,"",["sap.ui.vtm"]);this._vkGraphicsCore.updateSceneTreeAsync(this._vkScene,[this._rootContentResource]).then(function(i){jQuery.sap.measure.end(o);this._vkGraphicsCore.detachSceneLoadingFinished(s);e();this._raiseHierarchyChanged();this._raiseLoadCompleted(true,t)}.bind(this)).catch(function(e){jQuery.sap.measure.end(o);this._vkGraphicsCore.detachSceneLoadingFinished(s);if(e.contentResourcesWithEncryptedVds3){e.contentResourcesWithEncryptedVds3.forEach(function(e){var t=e.getSource();a(t)})}if(e.contentResourcesWithMissingPasswords){e.contentResourcesWithMissingPasswords.forEach(function(e){var t=e.getSource();a(t)})}this._raiseLoadCompleted(false,t)}.bind(this))}}.bind(this),50)}},_handleLoadContentResourcesAsyncProgress:function(e,t){var i=e.getParameter("source");var a=e.getParameter("loaded");var s=e.getParameter("total");var r=sap.ui.vtm.ArrayUtilities.find(t,function(e){return i===e.getSourceString()});sap.ui.vtm.measure(this,"fireDownloadProgress",function(){this.fireDownloadProgress({viewable:r,downloadedBytes:a,totalBytes:s})}.bind(this))},loadViewablesAsync:function(e){if(!e){throw"viewables not specified"}e=sap.ui.vtm.ArrayUtilities.wrap(e);if(!e.length){throw"viewables is empty"}e.forEach(function(e){var t=e.getSourceString();if(!this._viewablesBySource.has(t)){this._viewablesBySource.set(t,e)}var i=new sap.ui.vtm.ViewableLoadInfo({viewable:e,status:sap.ui.vtm.ViewableLoadStatus.Downloading});this._viewableLoadInfosByViewable.set(e,i)}.bind(this));this._raiseDownloadStarted(e);this._getGraphicsCore().then(function(){var t=e.map(function(e){return e.getSourceString()});var i=e.map(function(e){return e._getContentResource()});var a=sap.ui.vtm.createMeasureId(this,"Downloading "+t.join(", "));jQuery.sap.measure.start(a,"",["sap.ui.vtm"]);this._vkGraphicsCore.loadContentResourcesAsync(i,function(t){jQuery.sap.measure.end(a);t=t=t||[];this._handleLoadContentResourcesAsyncCompleted(t,e)}.bind(this),function(t){this._handleLoadContentResourcesAsyncProgress(t,e)}.bind(this))}.bind(this));return this},getDownloadedViewables:function(){var e=[];this._viewableLoadInfosByViewable.forEach(function(t,i){switch(t.getStatus()){case sap.ui.vtm.ViewableLoadStatus.Downloading:case sap.ui.vtm.ViewableLoadStatus.DownloadFailed:break;default:e.push(i);break}});return e},getLoadedViewables:function(){var e=[];this._viewableLoadInfosByViewable.forEach(function(t,i){if(t.getStatus()===sap.ui.vtm.ViewableLoadStatus.Loaded){e.push(i)}});return e},getViewableLoadInfos:function(){var e;this._viewableLoadInfosByViewable.forEach(function(t,i){e.push(t)});return e},getAncestorIds:function(e){if(this._vkNodeHierarchy){var t=this._vkNodeHierarchy.getAncestors(e);this.addCachedIds(t);return t}return[]},getParentId:function(e){var t=this.getAncestorIds(e);if(t&&t.length){return t[t.length-1]}return null},getChildIds:function(e){if(this._vkNodeHierarchy){var t=this._vkNodeHierarchy.getChildren(e,true);this.addCachedIds(t);return t}return[]},getDescendantIds:function(e){var t=[];sap.ui.vtm.measure(this,"getDescendantIds ("+e+")",function(){var i=function(e){var a=this.getChildIds(e);a.forEach(function(e){t.push(e);i(e)})}.bind(this);i(e)}.bind(this));this.addCachedIds(t);return t},getAllIds:function(){var e=this.getRootIds();var t=[];e.forEach(function(e){t.push(e);var i=this.getDescendantIds(e);t=t.concat(i)}.bind(this));this.setCachedIds(t);return t},getCachedIds:function(){if(!this._cachedIds||!this._cachedIds.length){this._cachedIds=this.getAllIds()}return this._cachedIds},setCachedIds:function(e){this._cachedIds=e;return this},addCachedIds:function(e){if(!this._cachedIds){this._cachedIds=[]}e=sap.ui.vtm.ArrayUtilities.wrap(e);e.forEach(function(e){if(this._cachedIds.indexOf(e)===-1){this._cachedIds.push(e)}}.bind(this));return this},removeCachedIds:function(e){if(this._cachedIds){e=sap.ui.vtm.ArrayUtilities.wrap(e);this._cachedIds=this._cachedIds.filter(function(t){return e.indexOf(t)===-1})}return this},createNode:function(e,t,i){var a=this._vkNodeHierarchy.createNode(e,i,t);this.addCachedIds(a);this._raiseHierarchyChanged();return a},cloneNode:function(e,t,i,a,s){var r=this._vkNodeHierarchy.createNodeCopy(e,t,a,i);s=s===undefined||s===null?true:s;this.addCachedIds(r);if(!s){var n=this.getChildIds(r);n.forEach(function(e){this.deleteNode(e)}.bind(this))}else{this.addCachedIds(this.getDescendantIds(r))}this._raiseHierarchyChanged();return r},deleteNode:function(e){this.removeCachedIds(e);this.removeCachedIds(this.getDescendantIds(e));this._vkNodeHierarchy.removeNode(e);this._raiseHierarchyChanged();return this},getVtm:function(){return this.getParent()}});return o});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/SceneNode", ["jquery.sap.global","sap/ui/core/Element","sap/ui/vk/NodeProxy","./ArrayUtilities","./MatrixUtilities"],function(jQuery,t,e,i,r){"use strict";var o=t.extend("sap.ui.vtm.SceneNode",{metadata:{properties:{sceneNodeId:{type:"string"},scene:{type:"object"}}},_destroy:function(){if(this._vkNodeProxy){this.getScene()._getNodeHierarchy().destroyNodeProxy(this.getSceneNodeId());this._vkNodeProxy=null}},exit:function(){this._destroy()},_checkValidity:function(){if(!this._vkNodeProxy){throw"Node has been destroyed"}},setSceneNodeId:function(t){this._destroy();this.setProperty("sceneNodeId",t);var e=this.getScene();if(e){this._vkNodeProxy=e._getNodeHierarchy().createNodeProxy(t)}return this},setScene:function(t){this._destroy();this.setProperty("scene",t);var e=this.getSceneNodeId();if(e){this._vkNodeProxy=t._getNodeHierarchy().createNodeProxy(e)}return this},getName:function(){this._checkValidity();return this._vkNodeProxy.getName()},getClosed:function(){this._checkValidity();return this._vkNodeProxy.getClosed()},getRelativeMatrix:function(){this._checkValidity();var t=this._vkNodeProxy.getLocalMatrix();return t?sap.ui.vtm.MatrixUtilities.fromVkMatrix(t):null},setRelativeMatrix:function(t){this._checkValidity();var e=sap.ui.vtm.MatrixUtilities.toVkMatrix(t);this._vkNodeProxy.setLocalMatrix(e);return this},getAbsoluteMatrix:function(){this._checkValidity();var t=this._vkNodeProxy.getWorldMatrix();return t?sap.ui.vtm.MatrixUtilities.fromVkMatrix(t):null},setAbsoluteMatrix:function(t){this._checkValidity();var e=sap.ui.vtm.MatrixUtilities.toVkMatrix(t);this._vkNodeProxy.setWorldMatrix(e);return this},_fromVkMetadata:function(t){var e={};var i=Object.getOwnPropertyNames(t);i.forEach(function(i){var r=t[i];var o=Object.getOwnPropertyNames(r);o.forEach(function(t){var o=r[t];var s={category:i,field:t};e[JSON.stringify(s)]=o})});return e},getNodeMetadata:function(){this._checkValidity();var t=this._vkNodeProxy.getNodeMetadata();return t?this._fromVkMetadata(t):{}},_fromVkVeIds:function(t){var e={};t.forEach(function(t){var i=JSON.stringify({source:t.source,type:t.type});var r=JSON.stringify(t.fields);var o=e[i];if(o){var s=sap.ui.vtm.ArrayUtilities.wrap(o);s.push(r);e[i]=s}else{e[i]=r}});return e},getIdentifiers:function(){this._checkValidity();var t=this._vkNodeProxy.getVeIds();return t?this._fromVkVeIds(t):{}}});return o},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/SelectColumnsDialog", ["jquery.sap.global","./library","./ColumnType","sap/ui/core/Control","sap/m/TableSelectDialog","./Progress","./InternalColumns"],function(jQuery,e,t,a,n,r,i){"use strict";var l=a.extend("sap.ui.vtm.SelectColumnsDialog",{metadata:{properties:{tree:{type:"object"},selectableColumns:{type:"sap.ui.vtm.Column[]"}}},init:function(){this._oDialog=this._createDialog()},renderer:function(e,t){},_createDialog:function(){var e=sap.ui.vtm.getResourceBundle();var t=new sap.m.TableSelectDialog(this.getId()+"-Dialog",{multiSelect:true,columns:[new sap.m.Column({visible:false}),new sap.m.Column({visible:false}),new sap.m.Column({header:new sap.m.Label({text:e.getText("COLUMNNAME_NAME")})})],noDataText:e.getText("SELECTCOLUMNSDIALOG_NOCOLUMNSAVAILABLE")});var a=new sap.m.ColumnListItem({type:"Active",unread:false,cells:[new sap.m.Label({text:"{mProperties/type}"}),new sap.m.Label({text:"{mProperties/descriptor}"}),new sap.m.Label({text:"{mProperties/label}"})]});t.bindItems({path:"/items",template:a});return t},open:function(){var e=this.getTree();if(!e){throw"The tree property has not been set"}var t=this.getSelectableColumns();if(!t){throw"The selectableColumns property has not been set"}t=t.slice();var a=this._oDialog;var n=sap.ui.vtm.getResourceBundle();var r=jQuery.sap.debug();if(r){var i=t.filter(function(e){return e.type===sap.ui.vtm.ColumnType.Internal}).map(function(e){return e.id});var l=[sap.ui.vtm.InternalColumns.createTreeItemIdColumn(),sap.ui.vtm.InternalColumns.createAbsoluteMatrixColumn(),sap.ui.vtm.InternalColumns.createRelativeMatrixColumn(),sap.ui.vtm.InternalColumns.createSceneNodeIdsColumn(),sap.ui.vtm.InternalColumns.createOpacityColumn(),sap.ui.vtm.InternalColumns.createHighlightColorColumn()];l.forEach(function(e){if(i.indexOf(e.id)==-1){t.push(e)}})}var o=function(e,t){return e.getLabel().localeCompare(t.getLabel())};t.sort(o);var s=function(e,t){return JSON.stringify({type:e,descriptor:t})};var u=new Map;t.forEach(function(e){var t=s(e.getType(),e.getDescriptor());u.set(t,e)});var m=function(e){var t=e.getParameter("value");var a=e.getParameter("itemsBinding");if(t!==undefined&&t.length>0){var n=[new sap.ui.model.Filter("mProperties/label",sap.ui.model.FilterOperator.Contains,t)];a.filter(new sap.ui.model.Filter(n,false),"Application")}else{a.filter([])}};var c=function(t){var n=e.getDataColumns().map(function(e){return s(e.getType(),e.getDescriptor())});var r=a.getItems();r.forEach(function(e){var t=e.getCells();var a=s(t[0].getText(),t[1].getText());var r=n.indexOf(a)!=-1;e.setSelected(r)})};var p,v;var f=function(e){a.attachConfirm(e,p);a.attachCancel(e,v);a.attachSearch(e,m);a.attachModelContextChange(e,c)};var g=function(){a.detachConfirm(p);a.detachCancel(v);a.detachSearch(m);a.detachModelContextChange(c)};p=function(t){g();var a=t.getParameter("selectedItems");var n=e.getDataColumns().map(function(e){return s(e.getType(),e.getDescriptor())});var r=a.map(function(e){var t=e.getCells();return s(t[0].getText(),t[1].getText())});var i=r.filter(function(e){return n.indexOf(e)===-1});var l=n.filter(function(e){return r.indexOf(e)!==-1});var m=l.map(function(e){return u.get(e)});var c=i.map(function(e){return u.get(e)});c.sort(o);var p=m.concat(c);e.setDataColumns(p)};v=function(e){g()};var C=e.getPanel().getTitle();var d=n.getText("SELECTCOLUMNSDIALOG_SELECT_0_COLUMNS",[C]);a.setTitle(d);f(e);var h=new sap.ui.model.json.JSONModel;h.setData({items:t});a.setModel(h);a.open();return this}});return l});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/SelectionMode", [],function(){"use strict";sap.ui.vtm.SelectionMode={Single:"Single",MultiToggle:"MultiToggle",MultiToggleWithSingleSelect:"MultiToggleWithSingleSelect"};return sap.ui.vtm.SelectionMode},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Text", ["jquery.sap.global","sap/m/Text","sap/m/TextRenderer","./TextColor"],function(jQuery,e,t,a){"use strict";sap.ui.vtm.Text=e.extend("sap.ui.vtm.Text",{metadata:{properties:{textColor:{type:"sap.ui.vtm.TextColor",defaultValue:a.Default,bindable:true}}},renderer:function(e,r){var s=r.getTextColor();switch(s){case a.Default:break;case a.Grey:case a.Gray:e.addClass("sapUiVtmText_TextColor_Gray");break;default:throw"Unexpected text color: '"+s+"'."}t.render(e,r)}});return sap.ui.vtm.Text});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/TextColor", [],function(){"use strict";sap.ui.vtm.TextColor={Default:"Default",Gray:"Gray",Grey:"Grey"};return sap.ui.vtm.TextColor},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Tree", ["jquery.sap.global","sap/ui/core/Control","sap/ui/table/TreeTable","./SelectionMode","./InternalColumnDescriptor","./ArrayUtilities","./MatrixUtilities","./TreeItemUtilities","./Column","./Lookup","./library","./Text","./ColumnType","./InternalColumns","sap/ui/model/json/JSONModel","sap/ui/commons/TextView","sap/ui/core/IconPool","sap/ui/core/Icon","sap/ui/layout/HorizontalLayout","./CheckEye"],function(jQuery,e,t,i,r,n,a,s,o,l,u,d,c,h,m,f,p,g,v,I){"use strict";var C=e.extend("sap.ui.vtm.Tree",{metadata:{properties:{selectionMode:{type:"sap.ui.vtm.SelectionMode",defaultValue:"Single"}},aggregations:{_treeTable:{type:"sap.ui.table.TreeTable",multiple:false,visibility:"hidden"},headerControls:{type:"sap.ui.core.Control",multiple:true}},events:{dragStart:{parameters:{dragItem:{type:"object"},dragTree:{type:"sap.ui.vtm.Tree"}},allowPreventDefault:true},dragOver:{parameters:{dragItem:{type:"object"},dragTree:{type:"sap.ui.vtm.Tree"},dragOverItem:{type:"object"},dragOverTree:{type:"sap.ui.vtm.Tree"}},allowPreventDefault:true},drop:{parameters:{dragItem:{type:"object"},dragTree:{type:"sap.ui.vtm.Tree"},dropItem:{type:"object"},dropTree:{type:"sap.ui.vtm.Tree"}}},selectionChanged:{parameters:{addedItems:{type:"object[]"},removedItems:{type:"object[]"},userInteraction:{type:"boolean"}}},visibilityHeaderIconClicked:{parameters:{visibility:{type:"boolean"},control:{type:"sap.ui.core.Control"}}},visibilityIconClicked:{parameters:{item:{type:"object"},visibility:{type:"boolean"},control:{type:"sap.ui.core.Control"}}},expandedChanged:{parameters:{item:{type:"object"},expanded:{type:"boolean"},userInteraction:{type:"boolean"}}},fixedColumnsChanged:{},dataColumnsChanged:{},beforeModelUpdated:{},modelUpdated:{},messageStatusIconClicked:{parameters:{items:{type:"object"},control:{type:"sap.ui.core.Control"}}},messageStatusHeaderIconClicked:{control:{type:"sap.ui.core.Control"}},hierarchyChanged:{}}},constructor:function(t,i){e.apply(this,arguments);this._rb=sap.ui.vtm.getResourceBundle();this._treeCollections=new sap.ui.vtm.TreeCollections;this._selectedItems=[];var r=new sap.ui.table.TreeTable({enableColumnReordering:true,selectionMode:sap.ui.table.SelectionMode.Single,showNoData:false,visibleRowCountMode:sap.ui.table.VisibleRowCountMode.Auto,minAutoRowCount:4,selectionBehavior:sap.ui.table.SelectionBehavior.RowOnly});this.setAggregation("_treeTable",r);r.allowTextSelection(false);var a=sap.ui.vtm.InternalColumns.createTreeColumn();var s=sap.ui.vtm.InternalColumns.createVisibilityColumn();var o=sap.ui.vtm.InternalColumns.createMessageStatusColumn();this._fixedColumns=[a,s,o];this._setColumns(this._fixedColumns);this.setRootItems([]);this.updateCollections(false);this._updateModel();r.setCollapseRecursive(false);r.attachToggleOpenState(this._handleToggleOpenState.bind(this));r.attachCellClick(function(e){if(this.getSelectionMode()==sap.ui.vtm.SelectionMode.MultiToggleWithSingleSelect){var t=e.getParameter("rowIndex");var i=this._getItemByRowIndex(t);if(i){this._selectedItems=[i];r.setSelectedIndex(t)}else{this._selectedItems=[];r.clearSelection()}}}.bind(this));var l=function(e,t){if(e.getVisible&&!e.getVisible()||e.getEnabled&&!e.getEnabled()){return false}if(e.ontap){e.ontap(t)}else if(e.userToggle){e.userToggle(t)}else if(e.onclick){e.onclick(t)}return true};var u=function(e){var t=sap.ui.table.TableUtils.getFocusedItemInfo(r);var i=this.getSelectionMode()===sap.ui.vtm.SelectionMode.MultiToggle;var n=i?t.cellInRow-1:t.cellInRow;var a=r.getColumns();var s=a[n];if(!s){return}var o=s.data("definition");var u=o.getType();var d=o.getDescriptor();var c=t.row===0;if(c){if(u===sap.ui.vtm.ColumnType.Internal&&d===sap.ui.vtm.InternalColumnDescriptor.Visibility){var h=s.getLabel();l(h,e)}}else if(u===sap.ui.vtm.ColumnType.Internal){var m=r.getRows()[t.row-1].getCells()[n];switch(d){case sap.ui.vtm.InternalColumnDescriptor.Tree:sap.ui.table.TableUtils.toggleRowSelection(r,e.target);e.preventDefault();e.stopImmediatePropagation();break;case sap.ui.vtm.InternalColumnDescriptor.Visibility:case sap.ui.vtm.InternalColumnDescriptor.MessageStatus:l(m,e);e.preventDefault();e.stopImmediatePropagation();break;default:break}}}.bind(this);r.attachBrowserEvent("keyup",function(e){if(e.which===jQuery.sap.KeyCodes.SPACE){u(e)}});r.attachRowSelectionChange(function(e){var t=e.getParameter("userInteraction");var i=e.getParameter("rowIndices");var a=r.getSelectedIndices();var s=[];var o=[];i.forEach(function(e){if(a.indexOf(e)!=-1){s.push(e)}else{o.push(e)}});var l=this._getTreeItemsFromRowIndices(s);var u=this._getTreeItemsFromRowIndices(o);if(t){var d=u.map(function(e){return e.id});var c=function(e,t){return e.id==t.id};var h=function(e){return d.indexOf(e.id)==-1};this._selectedItems=n.union([this._selectedItems.filter(h),l],c)}sap.ui.vtm.measure(this,"fireSelectionChanged",function(){this.fireSelectionChanged({addedItems:l,removedItems:u,userInteraction:t})}.bind(this));if(t){this.fireEvent("vtmInternalSetTreeSelectionComplete")}}.bind(this))},renderer:function(e,t){e.write("<div");e.writeControlData(t);e.addClass("sapUiVtmTree");e.writeStyles();e.writeClasses();e.write(">");var i=t.getHeaderControls();i.forEach(function(t){if(t){e.renderControl(t)}});var r=t._getTreeTable();e.renderControl(r);e.write("</div>")},_raiseExpandedChanged:function(e){sap.ui.vtm.measure(this,"fireExpandedChanged",function(){this.fireExpandedChanged(e)}.bind(this))},_handleToggleOpenState:function(e){var t=e.getParameter("rowContext");var i=e.getParameter("expanded");var r=t.getPath();var n=this.getItemByBindingContextPath(r);this._raiseExpandedChanged({item:n,expanded:i,userInteraction:true})},_getAncestor:function(e){var t=this.getParent();while(t&&t.getMetadata().getName()!==e){t=t.getParent()}return t},getPanel:function(){if(!this._panel){this._panel=this._getAncestor("sap.ui.vtm.Panel")}return this._panel},setExpanded:function(e,t){var i=this._getTreeTable();var r=function(){var r=this._getRowIndexForTreeItem(i,e);if(r!==-1){var n;if(t){if(!i.isExpanded(r)){n=true;i.expand(r)}}else if(i.isExpanded(r)){n=true;i.collapse(r)}if(n){this._raiseExpandedChanged({item:e,expanded:t,userInteraction:false})}}}.bind(this);if(t){this._expandToTreeItem(e,false,r)}else{r()}return this},getExpanded:function(e){var t=this._getTreeTable();var i=this._getRowIndexForTreeItem(t,e);if(i!==-1){return t.isExpanded(i)}return false},getFixedColumns:function(){var e=[];var t=this._getTreeTable();var i=t.getColumns();for(var r=0;r<this._fixedColumns.length;r++){var n=i[r];var a=n.data("definition");a.setWidth(n.getWidth());a.setHAlign(n.getHAlign());e.push(a)}return e},setFixedColumns:function(e){if(!e){throw"fixedColumns not specified"}this._fixedColumns=e;var t=this.getDataColumns();var i=this._fixedColumns.concat(t);this._setColumns(i);this.fireFixedColumnsChanged();return this},getDataColumns:function(){var e=[];var t=this._getTreeTable();var i=t.getColumns();for(var r=this._fixedColumns.length;r<i.length;r++){var n=i[r];var a=n.data("definition");a.setWidth(n.getWidth());a.setHAlign(n.getHAlign());e.push(a)}return e},setDataColumns:function(e){if(!e){throw"dataColumns not specified"}var t=this._fixedColumns.concat(e);this._setColumns(t);this.fireDataColumnsChanged();return this},_setColumns:function(e){var t=this._getTreeTable();t.removeAllColumns();e.forEach(function(e){var i=this._createColumn(e);t.addColumn(i)}.bind(this));t.setFixedColumnCount(this._fixedColumns.length)},_getTreeItemsFromRowIndices:function(e){return e.map(function(e){return this._getItemByRowIndex(e)}.bind(this)).filter(function(e){return!!e})},_getTreeTable:function(){return this.getAggregation("_treeTable")},getRootItems:function(){return this._rootItems},setRootItems:function(e){this._rootItems=e;return this},isEmpty:function(){return this._rootItems.length===0},getSelectedItems:function(){return this._selectedItems},_expandToTreeItem:function(e,t){return new Promise(function(i,r){var n=this._getTreeTable();var a=function(e,t,i){var r;if(t<e||t>=e+i){r=t-i/2}else{r=e}r=r>0?Math.floor(r):0;return r};var s=this.getAncestorItems(e.id,false);var o=function(e,t,i){if(i.getParameter("reason")==="expand"){e(t)}};var l=null;var u=0;var d=function(r){var s=function(){n.getBinding("rows").detachChange(l);var r=this._getRowIndexForTreeItem(n,e,u);if(r===-1){throw"Tree item with id '"+e.id+"' not found in treeTable"}if(t){var s=n.getVisibleRowCount(),o=n.getFirstVisibleRow(),d=a(o,r,s);if(d!==o){n.setFirstVisibleRow(d)}}i()}.bind(this);setTimeout(function(){if(r.length){while(r.length){var e=r[0];var t=this._getRowIndexForTreeItem(n,e,u);if(t===-1){return}else{r.shift();u=t+1;if(!n.isExpanded(t)){n.expand(t);this._raiseExpandedChanged({item:e,expanded:true,userInteraction:false});return}else if(!r.length){s()}}}}else{s()}}.bind(this),0)}.bind(this);l=o.bind(this,d,s);n.getBinding("rows").attachChange(l);d(s)}.bind(this))},_getRowIndexForTreeItem:function(e,t,i){var r=-1;sap.ui.vtm.measure(this,"_getRowIndexForTreeItem",function(){if(!i){i=0}var n=function(e,t){t.forEach(function(t){e=e[t]});return e};var a=this.getAllItems();for(var s=i;s<a.length;s++){var o=e.getContextByIndex(s);if(o){var l=o.getPath().split("/");l.shift();var u=o.getModel().getData();var d=n(u,l);if(d===t){r=s;break}}}}.bind(this));return r},expandAncestors:function(e){sap.ui.vtm.measure(this,"expandAncestors",function(){this._expandToTreeItem(e,false)}.bind(this));return this},expandAll:function(){sap.ui.vtm.measure(this,"expandAll",function(){this._getTreeTable().expandToLevel(1e3*1e3*1e3)}.bind(this));return this},collapseAll:function(){sap.ui.vtm.measure(this,"collapseAll",function(){this._getTreeTable().collapseAll()}.bind(this));return this},expandToLevel:function(e){sap.ui.vtm.measure(this,"expandToLevel",function(){this._getTreeTable().expandToLevel(e)}.bind(this));return this},scrollIntoView:function(e){sap.ui.vtm.measure(this,"scrollIntoView",function(){this._expandToTreeItem(e,true)}.bind(this));return this},setSelectedItems:function(e,t){e=sap.ui.vtm.ArrayUtilities.wrap(e);if(t!==true&&t!==false){t=true}if(this.getSelectionMode()==sap.ui.vtm.SelectionMode.Single&&e.length>1){e=e.slice(0,1)}if(e.length){var i=[];this.traverseTree(function(e){i.push(e.id)});e=e.filter(function(e){return i.indexOf(e.id)!=-1})}this._selectedItems=e;if(!e.length){this._getTreeTable().clearSelection();this.fireEvent("vtmInternalSetTreeSelectionComplete");return this}var r=function(e){var t=this._getTreeTable();for(var i=0;;i++){var r=this._getItemByRowIndex(i);if(!r){break}var n=e.indexOf(r)!==-1;if(n!=t.isIndexSelected(i)){if(n){t.addSelectionInterval(i,i)}else{t.removeSelectionInterval(i,i)}}}this.fireEvent("vtmInternalSetTreeSelectionComplete")}.bind(this);var n=function(){r(e)};var a=null;e.forEach(function(e){if(!a){a=this._expandToTreeItem(e,t)}else{a=a.then(function(){return this._expandToTreeItem(e,t)}.bind(this))}}.bind(this));a.then(n);return this},validateTree:function(){sap.ui.vtm.measure(this,"validateTree",function(){var e=sap.ui.vtm.TreeItemUtilities.validateTree(this.getRootItems());if(e.length!==0){e.forEach(function(e){var t="Tree error in "+this.getId()+": "+e;jQuery.sap.log.error(t,null,"sap.ui.vtm.Tree")});throw"There were errors in the "+this.getId()+" tree. See the console trace for details"}}.bind(this));return this},updateModel:function(e){sap.ui.vtm.measure(this,"updateModel",function(){sap.ui.vtm.measure(this,"fireBeforeModelUpdated",function(){this.fireBeforeModelUpdated()}.bind(this));this._updateModel(e);this.setSelectedItems(this._selectedItems,false);sap.ui.vtm.measure(this,"fireModelUpdated",function(){this.fireModelUpdated()}.bind(this))}.bind(this));return this},_updateModel:function(e){var t=this._getTreeTable();var i=t.getModel();if(!i||e){i=new sap.ui.model.json.JSONModel;i.setSizeLimit(1e6);t.bindRows({path:"/rootItems",key:"id",parameters:{arrayNames:["includedChildren"],numberOfExpandedLevels:1}});i.setData({rootItems:this.getRootItems()});t.setModel(i)}else{i.setData({rootItems:this.getRootItems()});this._updateBindings(true)}},_updateBindings:function(){this._getTreeTable().getModel().updateBindings(true)},updateCollections:function(e){sap.ui.vtm.measure(this,"updateCollections",function(){if(this._treeCollections.updateCollections(this.getRootItems(),e)){sap.ui.vtm.measure(this,"fireHierarchyChanged",function(){this.fireHierarchyChanged()}.bind(this))}}.bind(this));return this},updateTreeItemsBySceneNodeId:function(){sap.ui.vtm.measure(this,"updateTreeItemsBySceneNodeId",function(){this._treeCollections.updateTreeItemsBySceneNodeId(this.getRootItems())}.bind(this));return this},getItemByBindingContextPath:function(e){return this._getTreeTable().getModel().getProperty(e)||undefined},getItem:function(e){return this._treeCollections.getItem(e)},isIncludedItem:function(e){return this._treeCollections.isIncludedItem(e)},isExcludedItem:function(e){return this._treeCollections.isExcludedItem(e)},getItemsBySceneNodeId:function(e,t){return this._treeCollections.getItemsBySceneNodeId(e,t)},getParentItem:function(e){return this._treeCollections.getParentItem(e)},getDescendantItems:function(e,t){return this._treeCollections.getDescendantItems(e,t)},getAncestorItems:function(e){return this._treeCollections.getAncestorItems(e)},getAllItems:function(e){return this._treeCollections.getAllItems(e)},_modifyDisplayState:function(e,t,i,r,n){e=sap.ui.vtm.ArrayUtilities.wrap(e);i=i==null?true:i;n=n==null?true:n;r=r==null?true:r;var a=function(e){if(!r||sap.ui.vtm.TreeItemUtilities.hasVisibility(e)){t(e)}return sap.ui.vtm.ChildCollectionType.IncludedAndExcluded};e.forEach(function(e){if(i){sap.ui.vtm.TreeItemUtilities.traverseBranch(e,a)}else{a(e)}});if(n){this.updateModel();this.getPanel().getViewport().refresh()}},_getTreeItemData:function(e,t){if(Array.isArray(e)){return e.map(t)}else{return t(e)}},setVisibility:function(e,t,i,r,n){var a=function(e){if(t==undefined){delete e.visibility}else{e.visibility=t}};this._modifyDisplayState(e,a,i,r,n);return this},getVisibility:function(e){return this._getTreeItemData(e,function(e){return e.visibility})},setOpacity:function(e,t,i,r,n){var a=function(e){if(t==undefined){delete e.opacity}else{e.opacity=t}};this._modifyDisplayState(e,a,i,r,n);return this},getOpacity:function(e){return this._getTreeItemData(e,function(e){return e.opacity})},setHighlightColor:function(e,t,i,r,n){var a=function(e){if(t==null){delete e.highlightColor}else{e.highlightColor=t}};this._modifyDisplayState(e,a,i,r,n);return this},getHighlightColor:function(e){return this._getTreeItemData(e,function(e){return e.highlightColor})},_getItemByRowIndex:function(e){var t=this._getTreeTable();var i=t.getContextByIndex(e);var r=i?i.sPath:"";return this.getItemByBindingContextPath(r)},onAfterRendering:function(){var e=this._getTreeTable();if(e.setFixedColumnCount()!=this._fixedColumns.length){e.setFixedColumnCount(this._fixedColumns.length)}this._addDragHandlers();this._addMutationObserver()},setSelectionMode:function(e){if(e===this.getSelectionMode()){return this}var t=this._getTreeTable();this._selectedItems=[];t.clearSelection();var i;var r;switch(e){case sap.ui.vtm.SelectionMode.Single:i=sap.ui.table.SelectionMode.Single;r=sap.ui.table.SelectionBehavior.RowOnly;break;case sap.ui.vtm.SelectionMode.MultiToggle:i=sap.ui.table.SelectionMode.MultiToggle;r=sap.ui.table.SelectionBehavior.Row;break;case sap.ui.vtm.SelectionMode.MultiToggleWithSingleSelect:i=sap.ui.table.SelectionMode.MultiToggle;r=sap.ui.table.SelectionBehavior.RowSelector;break;default:throw"Unknown selection mode: '"+e+"'"}t.setSelectionBehavior(r);t.setSelectionMode(i);this.setProperty("selectionMode",e);return this},_addMutationObserver:function(){var e=false;var t=new MutationObserver(function(t){if(e){return}e=true;var i=false;t.forEach(function(e){if(i){return}if(e.type==="childList"){this._addDragHandlers();i=true}}.bind(this));e=false}.bind(this));var i={subtree:true,childList:true};jQuery("#"+this.getId()).each(function(e,r){t.observe(r,i)})},_getRowIndexForTableRow:function(e){var t=jQuery(e).attr("data-sap-ui-rowindex");var i=this._getTreeTable().getFirstVisibleRow()+parseInt(t,10);return i},_addDragHandlers:function(){var e=this.getId();var t="#"+e+" tr.sapUiTableTr";if(jQuery(t).attr("draggable")){return}var i=this.getPanel().getVtm();var r=function(e){e.dataTransfer.setData("text","");var t=e.currentTarget;var r=this._getRowIndexForTableRow(t);var n=this._getItemByRowIndex(r);if(!n){e.preventDefault();return}var a=this.getSelectedItems();if(a&&a.length&&a.indexOf(n)<0){e.preventDefault();return}i._dragStartParameters={dragItem:n,dragTree:this};var s;sap.ui.vtm.measure(this,"fireDragStart",function(){s=this.fireDragStart(i._dragStartParameters)}.bind(this));if(!s){e.preventDefault()}}.bind(this);var n=function(e){var t=i._dragStartParameters;if(!t){return}var r=e.currentTarget;var n=this._getRowIndexForTableRow(r);var a={dragItem:t.dragItem,dragTree:t.dragTree,dragOverItem:this._getItemByRowIndex(n),dragOverTree:this};var s;sap.ui.vtm.measure(this,"fireDragOver",function(){s=this.fireDragOver(a)}.bind(this));if(!s){e.preventDefault()}}.bind(this);var a=function(e){var t=i._dragStartParameters;if(!t){return}var r=e.currentTarget;var n=this._getRowIndexForTableRow(r);var a={dragItem:t.dragItem,dragTree:t.dragTree,dropItem:this._getItemByRowIndex(n),dropTree:this};i._dragStartParameters=null;sap.ui.vtm.measure(this,"fireDrop",function(){this.fireDrop(a)}.bind(this))}.bind(this);var s=function(e){e.addEventListener("dragstart",r,false);e.addEventListener("dragover",n,false);e.addEventListener("drop",a,false)};jQuery(t).each(function(){var e=jQuery(this);e.attr("draggable","true");e.attr("droppable","true");s(this)})},_createColumn:function(e){var t=e.getTemplate()||this._createColumnTemplate(e);var i=e.getLabel();var r=e.getLabelControl();this._attachColumnHeaderEvents(e);var n={label:r?r:i,tooltip:e.getTooltip()||i,hAlign:e.getHAlign()||sap.ui.core.HorizontalAlign.Left,width:e.getWidth()||"auto",resizable:e.getResizable(),template:t};var a=new sap.ui.table.Column(n);a.setTemplate(t);a.data("definition",e);return a},traverseBranch:function(e,t){var i=this.getAncestorItems(e);sap.ui.vtm.TreeItemUtilities.traverseBranch(e,t,i);return this},traverseTree:function(e){this.getRootItems().forEach(function(t){this.traverseBranch(t,e,[])}.bind(this));return this},removeRoot:function(e){return sap.ui.vtm.TreeItemUtilities.removeRoot(this._rootItems,e)},addRoot:function(e){sap.ui.vtm.TreeItemUtilities.addRoot(this._rootItems,e);return this},_attachColumnHeaderEvents:function(e){var t=e.getLabelControl();if(!t){return}var i=e.getType();if(!i){throw"Column type not specified"}switch(i){case sap.ui.vtm.ColumnType.Internal:{var r=e.getDescriptor();if(!r){throw"Column descriptor not specified"}switch(r){case sap.ui.vtm.InternalColumnDescriptor.MessageStatus:t.attachPress(function(){this.fireMessageStatusHeaderIconClicked({control:t})}.bind(this));break;case sap.ui.vtm.InternalColumnDescriptor.Visibility:t.attachPress(function(){this.fireVisibilityHeaderIconClicked({visibility:t.getVisibility(),control:t})}.bind(this));break;default:break}switch(r){case sap.ui.vtm.InternalColumnDescriptor.MessageStatus:case sap.ui.vtm.InternalColumnDescriptor.Visibility:t.addEventDelegate({onfocusin:function(e){t.getDomRef().blur()}},t);break;default:break}}break;default:break}return t},_createColumnTemplate:function(e){var t=sap.ui.vtm.ColumnTemplates;var i=e.getType();if(!i){throw"Column type not specified"}switch(i){case sap.ui.vtm.ColumnType.Internal:{var r=e.getDescriptor();switch(r){case sap.ui.vtm.InternalColumnDescriptor.TreeItemId:return t.createTreeItemIdColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.Tree:return t.createTreeColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.MessageStatus:var n=t.createMessageStatusColumnTemplate();n.attachPress(function(e){var t=e.getSource();var i=t.getBindingContext();var r=i.getPath();var n=this.getItemByBindingContextPath(r);this.fireMessageStatusIconClicked({item:n,control:t})}.bind(this));n.addEventDelegate({onfocusin:function(e){var t=sap.ui.getCore();var i=t.getCurrentFocusedControlId();var r=t.byId(i);if(r){var n=r.getDomRef();if(n){n.blur()}}}},n);return n;case sap.ui.vtm.InternalColumnDescriptor.AbsoluteMatrix:return t.createAbsoluteMatrixColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.RelativeMatrix:return t.createRelativeMatrixColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.SceneNodeIds:return t.createSceneNodeIdsColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.Visibility:var a=t.createVisibilityColumnTemplate();var s=function(e){var t=e.getBindingContext().getPath();var i=this.getItemByBindingContextPath(t);if(i){sap.ui.vtm.measure(this,"fireVisibilityIconClicked",function(){this.fireVisibilityIconClicked({item:i,visibility:i.visibility,control:e})}.bind(this))}}.bind(this);a.attachPress(function(e){var t=e.getSource();s(t)});a.addEventDelegate({onfocusin:function(e){var t=sap.ui.getCore();var i=t.getCurrentFocusedControlId();var r=t.byId(i);if(r){var n=r.getDomRef();if(n){n.blur()}}}},a);return a;case sap.ui.vtm.InternalColumnDescriptor.Opacity:return t.createOpacityColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.HighlightColor:return t.createHighlightColorColumnTemplate();default:throw"Unknown internal column type: "+r}break}case sap.ui.vtm.ColumnType.Metadata:return t.createMetadataColumnTemplate(e);case sap.ui.vtm.ColumnType.Identifier:return t.createIdentifierColumnTemplate(e);case sap.ui.vtm.ColumnType.AppData:return t.createAppDataColumnTemplate(e);default:throw"Invalid column type: "+i}}});return C});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/TreeCollections", ["jquery.sap.global","sap/ui/core/Element","./ArrayUtilities"],function(jQuery,e,t){"use strict";var i=e.extend("sap.ui.vtm.TreeCollections",{getTreeItem:function(e){if(!e){return null}if(typeof e==="string"){var t=this._treeItemsById.get(e);if(!t){throw e+" was not found in tree with tree id "+this.getId()}return t}return e},getTreeItemId:function(e){if(!e){return null}return typeof e==="string"?e:e.id},updateCollections:function(e,t){t=t!==false;var i=this._parentIdsById;var r=this._includedTreeItems;var n=this._excludedTreeItems;this._treeItemsById=new Map;this._parentIdsById=new Map;this._treeItemsBySceneNodeId=new sap.ui.vtm.Lookup;this._includedTreeItems=[];this._excludedTreeItems=[];var d=this._parentIdsById;var s=false;var u=function(e,c,l){var a=e.id;if(!a){throw"id is not set for tree item with name "+e.name}if(this._treeItemsById.has(a)){throw a+" is not unique in the tree"}var I;if(l){this._excludedTreeItems.push(e);if(t&&n&&!s){I=this._excludedTreeItems.length-1;if(I>=n.length||n[I]!=e){s=true}}}else{this._includedTreeItems.push(e);if(t&&r&&!s){I=this._includedTreeItems.length-1;if(I>=r.length||r[I]!=e){s=true}}}this._treeItemsById.set(a,e);if(c){if(!c.id){throw"id is not set for tree item with name "+c.name}d.set(a,c.id);if(t&&i&&!s){if(i.get(a)!==c.id){s=true}}}else if(t&&i&&!s){if(i.get(a)){s=true}}if(e.includedChildren){e.includedChildren.forEach(function(t){u(t,e,l)})}if(e.excludedChildren){e.excludedChildren.forEach(function(t){u(t,e,true)})}if(e.sceneNodeIds){sap.ui.vtm.TreeItemUtilities.getSceneNodeIds(e).forEach(function(t){this._treeItemsBySceneNodeId.addValue(t,e)}.bind(this))}}.bind(this);e.forEach(function(e){u(e,null)});if(t&&!s){if(r&&r.length!==this._includedTreeItems.length){s=true}if(n&&n.length!==this._excludedTreeItems.length){s=true}}return t&&s},updateTreeItemsBySceneNodeId:function(e){this._treeItemsBySceneNodeId=new sap.ui.vtm.Lookup;sap.ui.vtm.TreeItemUtilities.traverseTree(e,function(e){sap.ui.vtm.TreeItemUtilities.getSceneNodeIds(e).forEach(function(t){this._treeItemsBySceneNodeId.addValue(t,e)}.bind(this));return sap.ui.vtm.ChildCollectionType.IncludedAndExcluded}.bind(this))},getItem:function(e){return this._treeItemsById.get(e)},isIncludedItem:function(e){e=this.getTreeItem(e);return this._includedTreeItems.indexOf(e)!==-1},isExcludedItem:function(e){e=this.getTreeItem(e);return this._excludedTreeItems.indexOf(e)!==-1},getItemsBySceneNodeId:function(e,t){e=sap.ui.vtm.ArrayUtilities.wrap(e);if(!e.length){return[]}t=t||sap.ui.vtm.TreeItemType.Included;var i=function(e,t){switch(t){case sap.ui.vtm.TreeItemType.IncludedOrExcluded:return true;case sap.ui.vtm.TreeItemType.Included:return this.isIncludedItem(e);case sap.ui.vtm.TreeItemType.Excluded:return this.isExcludedItem(e);default:throw"Unexpected sap.ui.vtm.TreeItemType value "+t}}.bind(this);var r=[];e.forEach(function(e){var n=this._treeItemsBySceneNodeId.getValues(e);n.forEach(function(e){if(r.indexOf(e)===-1&&i(e,t)){r.push(e)}})}.bind(this));return r},getParentItem:function(e){var t=this.getTreeItemId(e);var i=this._parentIdsById.get(t);if(!i){return undefined}return this._treeItemsById.get(i)},getDescendantItems:function(e,t){e=this.getTreeItem(e);t=t||sap.ui.vtm.TreeItemType.Included;var i=[];switch(t){case sap.ui.vtm.TreeItemType.IncludedOrExcluded:sap.ui.vtm.TreeItemUtilities.traverseBranch(e,function(t){if(t!==e){i.push(t)}return sap.ui.vtm.ChildCollectionType.IncludedAndExcluded});break;case sap.ui.vtm.TreeItemType.Included:sap.ui.vtm.TreeItemUtilities.traverseBranch(e,function(t){if(t===e){return this.isIncludedItem(t)?sap.ui.vtm.ChildCollectionType.Included:sap.ui.vtm.ChildCollectionType.None}else{i.push(t);return sap.ui.vtm.ChildCollectionType.Included}}.bind(this));break;case sap.ui.vtm.TreeItemType.Excluded:sap.ui.vtm.TreeItemUtilities.traverseBranch(e,function(t){if(t===e){return sap.ui.vtm.ChildCollectionType.IncludedAndExcluded}else{if(this.isExcludedItem(t)){i.push(t)}return sap.ui.vtm.ChildCollectionType.IncludedAndExcluded}}.bind(this));break;default:throw"Unexpected sap.ui.vtm.TreeItemType value "+t}return i},getAncestorItems:function(e){e=this.getTreeItem(e);var t=[];var i=this.getParentItem(e.id);while(i){t.push(i);i=this.getParentItem(i.id)}return t.reverse()},getAllItems:function(e){e=e||sap.ui.vtm.TreeItemType.Included;switch(e){case sap.ui.vtm.TreeItemType.IncludedOrExcluded:return this._includedTreeItems.concat(this._excludedTreeItems);case sap.ui.vtm.TreeItemType.Included:return this._includedTreeItems.slice();case sap.ui.vtm.TreeItemType.Excluded:return this._excludedTreeItems.slice();default:throw"Unexpected sap.ui.vtm.TreeItemType value "+e}}});return i});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/TreeItemType", [],function(){"use strict";sap.ui.vtm.TreeItemType={Included:"Included",Excluded:"Excluded",IncludedOrExcluded:"IncludedOrExcluded"};return sap.ui.vtm.TreeItemType},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/TreeItemUtilities", ["jquery.sap.global","sap/ui/core/Message","./ArrayUtilities"],function(jQuery,e,i){"use strict";var n={};n.mapBranch=function(e,i){var d=i(e);if(e.includedChildren){d.includedChildren=e.includedChildren.map(function(e){return n.mapBranch(e,i)})}if(e.excludedChildren){d.excludedChildren=e.excludedChildren.map(function(e){return n.mapBranch(e,i)})}return d};n.mapTree=function(e,i){var d=[];e.forEach(function(e){d.push(n.mapBranch(e,i))});return d};var d=function(e){return Array.isArray(e)?sap.ui.vtm.ArrayUtilities.shallowClone(e):e};var t=function(e){if(e===null||e===undefined){return e}var i={};var n=Object.keys(e);n.forEach(function(n){i[n]=d(e[n])});return i};n.cloneMetadata=function(e){return t(e.metadata)};n.cloneIdentifiers=function(e){return t(e.identifiers)};n.cloneAppData=function(e){return t(e.appData)};n.hasVisibility=function(e){return e.visibility===true||e.visibility===false};n.getAppDataDescriptors=function(e){if(!e.appData){return[]}return Object.keys(e.appData)};n.getAppDataValues=function(e,n){if(!e.appData){return[]}return i.wrap(e.appData[n])};n.setAppDataValues=function(e,n,d){var t=i.unwrap(d);if(t===undefined){if(e.appData){delete e.appData[n]}}else{if(!e.appData){e.appData={}}e.appData[n]=d}};n.getMetadataDescriptors=function(e){if(!e.metadata){return[]}return Object.keys(e.metadata)};n.getMetadataValues=function(e,n){if(!e.metadata){return[]}return i.wrap(e.metadata[n])};n.setMetadataValues=function(e,n,d){var t=i.unwrap(d);if(t===undefined){if(e.metadata){delete e.metadata[n]}}else{if(!e.metadata){e.metadata={}}e.metadata[n]=d}};n.getIdentifierDescriptors=function(e){if(!e||!e.identifiers){return[]}return Object.keys(e.identifiers)};n.getIdentifierValues=function(e,n){if(!e.identifiers){return[]}return i.wrap(e.identifiers[n])};n.setIdentifierValues=function(e,n,d){var t=i.unwrap(d);if(t===undefined){if(e.identifiers){delete e.identifiers[n]}}else{if(!e.identifiers){e.identifiers={}}e.identifiers[n]=d}};n.getSceneNodeIds=function(e){if(!e.sceneNodeIds){return[]}return i.wrap(e.sceneNodeIds)};n.setSceneNodeIds=function(e,n){n=i.unwrap(n);if(n===undefined){if(e.sceneNodeIds){delete e.sceneNodeIds}}else{e.sceneNodeIds=n}};n.getIncludedChildren=function(e){if(!e.includedChildren){return[]}return e.includedChildren};n.getExcludedChildren=function(e){if(!e.excludedChildren){return[]}return e.excludedChildren};n.getChildren=function(e,i){switch(i){case sap.ui.vtm.ChildCollectionType.None:return[];case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:return n.getIncludedChildren(e);case sap.ui.vtm.ChildCollectionType.Excluded:return n.getExcludedChildren(e);case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:return n.getIncludedChildren(e).concat(n.getExcludedChildren(e));default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+i}};n.setIncludedChildren=function(e,i){i=sap.ui.vtm.ArrayUtilities.wrap(i);if(i.length==0){delete e.includedChildren}else{e.includedChildren=i}};n.setExcludedChildren=function(e,i){i=sap.ui.vtm.ArrayUtilities.wrap(i);if(i.length==0){delete e.excludedChildren}else{e.excludedChildren=i}};n.setChildren=function(e,i,d){switch(d){case sap.ui.vtm.ChildCollectionType.None:break;case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:n.setIncludedChildren(e,i);break;case sap.ui.vtm.ChildCollectionType.Excluded:n.setExcludedChildren(e,i);break;case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:throw"sap.ui.vtm.ChildCollectionType.IncludedAndExcluded cannot be used in sap.ui.vtm.TreeItemUtilities.setChildren";default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+d}};n.hasIncludedChildren=function(e){return e.includedChildren&&e.includedChildren.length};n.hasExcludedChildren=function(e){return e.excludedChildren&&e.excludedChildren.length};n.hasChildren=function(e,i){switch(i){case sap.ui.vtm.ChildCollectionType.None:return false;case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:return n.hasIncludedChildren(e);case sap.ui.vtm.ChildCollectionType.Excluded:return n.hasExcludedChildren(e);case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:return n.hasIncludedChildren(e)||n.hasExcludedChildren(e);default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+i}};n.calculateAbsoluteMatrix=function(e,i){if(!e){return i||sap.ui.vtm.MatrixUtilities.createIdentity()}return i?sap.ui.vtm.MatrixUtilities.multiply(e,i):e};n.calculateRelativeMatrix=function(e,i){if(!e){throw"An absolute matrix value is needed to calculate a relative matrix value"}return i?sap.ui.vtm.MatrixUtilities.multiply(e,sap.ui.vtm.MatrixUtilities.invert(i)):e};n.addIncludedChild=function(e,i){if(e.includedChildren){e.includedChildren.push(i)}else{e.includedChildren=[i]}};n.addExcludedChild=function(e,i){if(e.excludedChildren){e.excludedChildren.push(i)}else{e.excludedChildren=[i]}};n.addChild=function(e,i,d){switch(d){case sap.ui.vtm.ChildCollectionType.None:break;case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:n.addIncludedChild(e,i);break;case sap.ui.vtm.ChildCollectionType.Excluded:n.addExcludedChild(e,i);break;case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:throw"sap.ui.vtm.ChildCollectionType.IncludedAndExcluded cannot be used in sap.ui.vtm.TreeItemUtilities.addChild";default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+d}};n.removeIncludedChild=function(e,i){var n=typeof i==="string"?i:i.id;if(e.includedChildren){var d=sap.ui.vtm.ArrayUtilities.findIndex(e.includedChildren,function(e){return e.id===n});if(d!==undefined){var t=e.includedChildren[d];e.includedChildren.splice(d,1);if(e.includedChildren.length==0){delete e.includedChildren}return t}}return undefined};n.removeExcludedChild=function(e,i){var n=typeof i==="string"?i:i.id;if(e.excludedChildren){var d=sap.ui.vtm.ArrayUtilities.findIndex(e.excludedChildren,function(e){return e.id===n});if(d!==undefined){var t=e.excludedChildren[d];e.excludedChildren.splice(d,1);if(e.excludedChildren.length==0){delete e.excludedChildren}return t}}return undefined};n.removeChild=function(e,i,d){switch(d){case sap.ui.vtm.ChildCollectionType.None:break;case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:return n.removeIncludedChild(e,i);case sap.ui.vtm.ChildCollectionType.Excluded:return n.removeExcludedChild(e,i);case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:return n.removeIncludedChild(e,i)||n.removeExcludedChild(e,i);default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+d}};n.includeAllChildren=function(e,i){e=sap.ui.vtm.ArrayUtilities.wrap(e);e.forEach(function(e){var d=n.getChildren(e,sap.ui.vtm.ChildCollectionType.IncludedAndExcluded);n.setIncludedChildren(e,d);n.setExcludedChildren(e,[]);if(i){d.forEach(function(e){n.includeAllChildren(e,true)})}})};n.excludeAllChildren=function(e,i){e=sap.ui.vtm.ArrayUtilities.wrap(e);e.forEach(function(e){var d=n.getChildren(e,sap.ui.vtm.ChildCollectionType.IncludedAndExcluded);n.setChildren(e,[]);n.setExcludedChildren(e,d);if(i){d.forEach(function(e){n.excludeAllChildren(e,true)})}})};n.removeRoot=function(e,i){var n=typeof i==="string"?i:i.id;var d=sap.ui.vtm.ArrayUtilities.findIndex(e,function(e){return e.id===n});if(d!==undefined){var t=e[d];e.splice(d,1);return t}return undefined};n.addRoot=function(e,i){e.push(i)};n.validateTreeItem=function(e){var i=function(e){return e===null||e===undefined};var n=[];if(e){if(i(e.id)){n.push("id is not specified")}if(!i(e.absoluteMatrix)){if(!sap.ui.vtm.MatrixUtilities.isValid(e.absoluteMatrix,true)){n.push("absoluteMatrix is not valid")}}if(!i(e.relativeMatrix)){if(!sap.ui.vtm.MatrixUtilities.isValid(e.relativeMatrix,true)){n.push("relativeMatrix is not valid")}}}return n};n.validateTree=function(e){var i=[];var d=function(e,t){var l=n.validateTreeItem(e);if(l&&l.length!==0){var r=t+": "+l.join(", ");i.push(r)}var u;var a=e.includedChildren;if(a){for(u=0;u<a.length;u++){d(a[u],t+"/includedChildren/"+u)}}var c=e.excludedChildren;if(c){for(u=0;u<c.length;u++){d(c[u],t+"/excludedChildren/"+u)}}};for(var t=0;t<e.length;t++){d(e[t],""+t)}return i};n.traverseBranch=function(e,i,d){if(!e){return}var t=i(e,d)||sap.ui.vtm.ChildCollectionType.Included;if(d&&t!==sap.ui.vtm.ChildCollectionType.None){d.push(e)}if(t===sap.ui.vtm.ChildCollectionType.IncludedAndExcluded||t===sap.ui.vtm.ChildCollectionType.Included){var l=e.includedChildren;if(l){l.forEach(function(e){n.traverseBranch(e,i,d)})}}if(t===sap.ui.vtm.ChildCollectionType.IncludedAndExcluded||t===sap.ui.vtm.ChildCollectionType.Excluded){var r=e.excludedChildren;if(r){r.forEach(function(e){n.traverseBranch(e,i,d)})}}if(d&&t!==sap.ui.vtm.ChildCollectionType.None){d.pop()}};n.traverseTree=function(e,i){if(e){e.forEach(function(e){n.traverseBranch(e,i,[])})}};n.getMessages=function(e){if(!e.messages||!e.messages.length){return[]}var i=JSON.parse(e.messages);var n=i.map(function(e){return new sap.ui.core.Message(e)});return n};n.setMessages=function(e,i){if(!i||!i.length){delete e.messages;return}var n=i.map(function(e){var i={};var n=e.getLevel();if(n){i.level=n}var d=e.getText();if(d){i.text=d}var t=e.getIcon();if(t){i.icon=t}var l=e.getTimestamp();if(l){i.timestamp=l}var r=e.getReadOnly();if(r){i.readOnly=r}return i});e.messages=JSON.stringify(n)};return n},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Viewable", ["jquery.sap.global","sap/ui/core/Element","sap/ui/vk/ContentResource"],function(jQuery,t,e){"use strict";var i=t.extend("sap.ui.vtm.Viewable",{metadata:{properties:{source:{type:"any"},name:{type:"string"},rootNodeIds:{type:"string[]"},relativeMatrix:{type:"sap.ui.vtm.Matrix"}}},init:function(){this._vkContentResource=new sap.ui.vk.ContentResource({sourceId:this.getId(),sourceType:"vds"});this.setRelativeMatrix(sap.ui.vtm.MatrixUtilities.createIdentity())},getSourceId:function(){return this.getId()},setSource:function(t){this.setProperty("source",t);this._vkContentResource.setSource(t);return this},setName:function(t){this.setProperty("name",t);this._vkContentResource.setName(t);return this},setRelativeMatrix:function(t){this.setProperty("relativeMatrix",t);this._vkContentResource.setLocalMatrix(sap.ui.vtm.MatrixUtilities.toVkMatrix(t))},_getContentResource:function(){return this._vkContentResource},getSourceString:function(){var t=this.getSource();return typeof t==="string"?t:t.name}});return i});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/ViewableLoadInfo", ["jquery.sap.global","sap/ui/core/Element"],function(jQuery,e){"use strict";var t=e.extend("sap.ui.vtm.ViewableLoadInfo",{metadata:{properties:{viewable:{type:"object"},status:{type:"sap.ui.vtm.ViewableLoadStatus"},errorCode:{type:"string"},errorText:{type:"string"}}}});return t});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/ViewableLoadStatus", [],function(){"use strict";sap.ui.vtm.ViewableLoadStatus={Downloading:"Downloading",Downloaded:"Downloaded",DownloadFailed:"DownloadFailed",Loading:"Loading",Loaded:"Loaded",LoadFailed:"LoadFailed"};return sap.ui.vtm.ViewableLoadStatus},true);
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Viewport", ["jquery.sap.global","sap/ui/core/Control","sap/ui/vk/dvl/Viewport","sap/m/OverflowToolbar","./ViewportHandler","sap/ui/vk/FlexibleControl","sap/ui/vk/FlexibleControlLayoutData"],function(jQuery,e,t,i,r,a,n){"use strict";var s=e.extend("sap.ui.vtm.Viewport",{metadata:{properties:{backgroundGradientTopColor:{type:"sap.ui.core.CSSColor",defaultValue:"black"},backgroundGradientBottomColor:{type:"sap.ui.core.CSSColor",defaultValue:"white"},overrideDisplayGroups:{type:"object[]",defaultValue:[]},contextDisplayGroups:{type:"object[]",defaultValue:[]}},aggregations:{_container:{type:"sap.m.VBox",multiple:false,visibility:"hidden"}},associations:{headerControls:{type:"sap.ui.core.Control",multiple:true}},events:{selectionChanged:{parameters:{selectedIds:{type:"string[]"},unselectedIds:{type:"string[]"},userInteraction:{type:"boolean"}}},nodeClicked:{sceneNode:{type:"sap.ui.vtm.SceneNode"}},visibilityChanged:{parameters:{visibleIds:{type:"string[]"},hiddenIds:{type:"string[]"},userInteraction:{type:"boolean"}}},viewChanged:{parameters:{cameraInfo:{type:"object"}}},refreshRequested:{},hover:{parameters:{x:{type:"float"},y:{type:"float"},nodeId:{type:"string"}}},beginGesture:{},endGesture:{}}},_getVkViewport:function(){return this.vkViewport},_getContainer:function(){return this.getAggregation("_container")},init:function(){this._programmaticSelectionChangeInProgress=false;this._programmaticVisibilityChangeInProgress=false},_initialize:function(e){this._setScene(e);var t=this._getVkViewport();var i=t._loco;if(t._viewportHandler){i.removeHandler(t._viewportHandler)}if(t._smart2DHandler){i.removeHandler(t._smart2DHandler)}var a=new r(this);i.addHandler(a)},renderer:function(e,t){e.write("<div");e.writeControlData(t);e.addStyle("height","inherit");e.addStyle("overflow","hidden");e.writeStyles();e.writeClasses();e.write(">");var i=t._getContainer();e.renderControl(i);e.write("</div>")},onBeforeRendering:function(){var e=this.getPanel().getVtm();if(e){var t=e.getScene();t.attachEvent("sceneCreated",function(){this._onSceneCreated(t)}.bind(this))}},getInitialized:function(){return this._initialized},refresh:function(){sap.ui.vtm.measure(this,"fireRefreshRequested",function(){this.fireRefreshRequested()}.bind(this));return this},_raiseHover:function(e,t,i){this.fireHover({x:e,y:t,nodeId:i})},_raiseBeginGesture:function(){this.fireBeginGesture()},_raiseEndGesture:function(){this.fireEndGesture()},setBackgroundGradientTopColor:function(e){this.setProperty("backgroundGradientTopColor",e);this._getVkViewport().setBackgroundColorTop(e);return this},setBackgroundGradientBottomColor:function(e){this.setProperty("backgroundGradientBottomColor",e);this._getVkViewport().setBackgroundColorBottom(e);return this},_getAncestor:function(e){var t=this.getParent();while(t&&t.getMetadata().getName()!==e){t=t.getParent()}return t},getPanel:function(){if(!this._panel){this._panel=this._getAncestor("sap.ui.vtm.Panel")}return this._panel},getScene:function(){return this._scene},_onSceneCreated:function(e){if(!this._initialized){this._initialized=true;this._initialize(e)}var t=e._vkScene;if(!this._vkScene&&t){var i=this._getVkViewport();this._vkScene=t;i.setScene(t);this._vkDefaultNodeHierarchy=t.getDefaultNodeHierarchy();if(this._vkDefaultNodeHierarchy&&this._vkGraphicsCore){this._vkViewStateManager=this._vkGraphicsCore.createViewStateManager(this._vkDefaultNodeHierarchy,true,true);if(this._vkViewStateManager){i.setViewStateManager(this._vkViewStateManager);this._vkViewStateManager.attachSelectionChanged(function(e){var t=e.getParameter("selected");var i=e.getParameter("unselected");sap.ui.vtm.measure(this,"fireSelectionChanged",function(){this.fireSelectionChanged({selectedIds:t,unselectedIds:i,userInteraction:!this._programmaticSelectionChangeInProgress})}.bind(this))}.bind(this));this._vkViewStateManager.attachVisibilityChanged(function(e){var t=e.getParameter("visible");var i=e.getParameter("hidden");sap.ui.vtm.measure(this,"fireVisibilityChanged",function(){this.fireVisibilityChanged({visibleIds:t,hiddenIds:i,userInteraction:!this._programmaticVisibilityChangeInProgress})}.bind(this))}.bind(this));var r=function(){sap.ui.vtm.measure(this,"fireViewChanged",function(){this.fireViewChanged({cameraInfo:this.getCameraInfo()})}.bind(this))}.bind(this);i.attachZoom(r);i.attachPan(r);i.attachRotate(r);i.attachNodeClicked(function(t){var i=t.getParameters().nodeId;sap.ui.vtm.measure(this,"fireNodeClicked",function(){var t=e._getSceneNode(i);try{this.fireNodeClicked({sceneNode:t})}finally{t.destroy()}}.bind(this))}.bind(this));i.attachFrameRenderingFinished(function(e){this.fireEvent("frameRenderingFinished",e)}.bind(this))}}}},getHeaderControls:function(){var e=this.getAssociation("headerControls");var t=[];if(e){e.forEach(function(e){var i=sap.ui.getCore().byId(e);if(i){t.push(i)}})}return t},_setScene:function(e){if(!e||this._scene){return this}var t=new sap.ui.vk.dvl.Viewport(this.getId()+"_sapUiVkViewport",{height:"100%"});this.vkViewport=t;this._scene=e;if(e){this._vkGraphicsCore=this._scene._vkGraphicsCore;if(this._vkGraphicsCore){t.setGraphicsCore(this._vkGraphicsCore);t.setBackgroundColorTop(this.getBackgroundGradientTopColor());t.setBackgroundColorBottom(this.getBackgroundGradientBottomColor())}}var i=this.getHeaderControls();i.forEach(function(e){if(e){e.setLayoutData(new sap.m.FlexItemData({growFactor:0,shrinkFactor:0}))}});t.setLayoutData(new sap.m.FlexItemData({growFactor:1,shrinkFactor:1,minHeight:"10px"}));var r=new sap.m.VBox({fitContainer:true,renderType:sap.ui.Device.browser.msie?sap.m.FlexRendertype.Div:sap.m.FlexRendertype.Bare,items:[i,t]});this.setAggregation("_container",r);return this},zoomToSelected:function(e){sap.ui.vtm.measure(this,"zoomToSelected",function(){if(e===null||e===undefined){e=.2}this._getVkViewport().zoomTo(sap.ui.vk.ZoomTo.Selected,null,e,0)}.bind(this));return this},zoomToVisible:function(e){sap.ui.vtm.measure(this,"zoomToVisible",function(){if(e===null||e===undefined){e=.2}this._getVkViewport().zoomTo(sap.ui.vk.ZoomTo.Visible,null,e,0)}.bind(this));return this},zoomToFit:function(e){var t=false;if(this._vkViewStateManager){this._vkViewStateManager.enumerateSelection(function(){t=true})}if(t){this.zoomToSelected(e)}else{this.zoomToVisible(e)}return this},zoomToAll:function(e){sap.ui.vtm.measure(this,"zoomToAll",function(){if(e===null||e===undefined){e=.2}this._getVkViewport().zoomTo(sap.ui.vk.ZoomTo.All,null,e,0)}.bind(this));return this},getVisibility:function(e){var t;sap.ui.vtm.measure(this,"getVisibility",function(){if(this._vkViewStateManager){t=this._vkViewStateManager.getVisibilityState(e)}}.bind(this));return t},setVisibility:function(e,t,i){if(jQuery.sap.debug()){var r={viewport:this.getId(),visibility:t,recursive:i,sceneNodeIds:e};jQuery.sap.log.warning("setVisibility "+JSON.stringify(r))}sap.ui.vtm.measure(this,"setVisibility",function(){if(Array.isArray(e)&&!e.length){return this}if(this._vkViewStateManager){try{this._programmaticVisibilityChangeInProgress=true;this._vkViewStateManager.setVisibilityState(e,t,i)}finally{this._programmaticVisibilityChangeInProgress=false}}}.bind(this));return this},getOpacity:function(e){var t;sap.ui.vtm.measure(this,"getOpacity",function(){if(this._vkViewStateManager){t=this._vkViewStateManager.getOpacity(e);this._scene.traverseNodes(e,function(i,r){if(Array.isArray(e)){if(t[r]==null){t[r]=i._vkNodeProxy.getOpacity()}}else if(t==null){t=i._vkNodeProxy.getOpacity()}})}}.bind(this));return t},setOpacity:function(e,t,i){if(jQuery.sap.debug()){var r={viewport:this.getId(),opacity:t,recursive:i,sceneNodeIds:e};jQuery.sap.log.warning("setOpacity "+JSON.stringify(r))}sap.ui.vtm.measure(this,"setOpacity",function(){if(Array.isArray(e)&&!e.length){return this}if(this._vkViewStateManager){this._vkViewStateManager.setOpacity(e,t,i)}}.bind(this));return this},getHighlightColor:function(e){var t;sap.ui.vtm.measure(this,"getHighlightColor",function(){if(this._vkViewStateManager){t=this._vkViewStateManager.getTintColor(e);this._scene.traverseNodes(e,function(i,r){if(Array.isArray(e)){if(t[r]==null){t[r]=i._vkNodeProxy.getTintColor()}}else if(t==null){t=i._vkNodeProxy.getTintColor()}})}}.bind(this));return t},setHighlightColor:function(e,t,i){if(jQuery.sap.debug()){var r={viewport:this.getId(),color:t,recursive:i,sceneNodeIds:e};jQuery.sap.log.warning("setHighlightColor "+JSON.stringify(r))}sap.ui.vtm.measure(this,"setHighlightColor",function(){if(Array.isArray(e)&&!e.length){return this}if(this._vkViewStateManager){this._vkViewStateManager.setTintColor(e,t,i)}}.bind(this));return this},getSelected:function(e){var t;sap.ui.vtm.measure(this,"getSelected",function(){if(this._vkViewStateManager){t=this._vkViewStateManager.getSelectionState(e)}}.bind(this));return t},setSelected:function(e,t,i){if(jQuery.sap.debug()){var r={viewport:this.getId(),selected:t,recursive:i,sceneNodeIds:e};jQuery.sap.log.warning("setSelected "+JSON.stringify(r))}sap.ui.vtm.measure(this,"setSelected",function(){if(Array.isArray(e)&&!e.length){return this}if(this._vkViewStateManager){try{this._programmaticSelectionChangeInProgress=true;this._vkViewStateManager.setSelectionState(e,t,i)}finally{this._programmaticSelectionChangeInProgress=false}}}.bind(this));return this},getSelectedIds:function(){var e=[];sap.ui.vtm.measure(this,"getSelectedIds",function(){if(this._vkViewStateManager){this._vkViewStateManager.enumerateSelection(function(t){e.push(t)})}}.bind(this));return e},setPredefinedView:function(e){var t;switch(e){case sap.ui.vtm.PredefinedView.Top:t=sap.ui.vk.ZoomTo.ViewTop;break;case sap.ui.vtm.PredefinedView.Bottom:t=sap.ui.vk.ZoomTo.ViewBottom;break;case sap.ui.vtm.PredefinedView.Front:t=sap.ui.vk.ZoomTo.ViewFront;break;case sap.ui.vtm.PredefinedView.Back:t=sap.ui.vk.ZoomTo.ViewBack;break;case sap.ui.vtm.PredefinedView.Left:t=sap.ui.vk.ZoomTo.ViewLeft;break;case sap.ui.vtm.PredefinedView.Right:t=sap.ui.vk.ZoomTo.ViewRight;break;default:throw"Unexpected view value: '"+e+"'."}this._getVkViewport().zoomTo(t,null,.2,0);return this},getCameraInfo:function(){var e=this._getVkViewport().getViewInfo({camera:{useTransitionCamera:true},animation:false});return e.camera},setCameraInfo:function(e,t){var i={camera:e,flyToDuration:t||0};this._getVkViewport().setViewInfo(i);return this},addOverrideDisplayGroup:function(e){var t=this.getOverrideDisplayGroups();t.push(e);this.setOverrideDisplayGroups(t);return this},addContextDisplayGroup:function(e){var t=this.getContextDisplayGroups();t.push(e);this.setContextDisplayGroups(t);return this}});return s});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/ViewportHandler", ["jquery.sap.global","sap/ui/vk/ViewportHandler"],function(jQuery,t){"use strict";var e=sap.ui.vk.ViewportHandler.extend("sap.ui.vtm.ViewportHandler",{constructor:function(t){sap.ui.vk.ViewportHandler.prototype.constructor.call(this,t._getVkViewport());this._vtmViewport=t},hover:function(t){if(t.n==1&&this._inside(t)&&this._rect){var e=t.x-this._rect.x,i=t.y-this._rect.y;var r=this._viewport.hitTest(e,i);this._vtmViewport._raiseHover(e,i,r)}},beginGesture:function(e){this._vtmViewport._raiseBeginGesture();t.prototype.beginGesture.call(this,e)},endGesture:function(e){this._vtmViewport._raiseEndGesture();t.prototype.endGesture.call(this,e)}});return e});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/Vtm", ["jquery.sap.global","sap/ui/core/Element","./Panel","./Scene","./ArrayUtilities","./Viewable","sap/m/Toolbar"],function(jQuery,e,n,t,i,s,a){"use strict";var o=e.extend("sap.ui.vtm.Vtm",{metadata:{properties:{addDefaultExtensions:{type:"boolean"}},events:{panelAdded:{parameters:{panel:{type:"sap.ui.vtm.Panel"}}},activePanelChanged:{},initialized:{}},aggregations:{extensions:{type:"sap.ui.vtm.Extension",multiple:true}},defaultAggregation:"extensions"},constructor:function(n,t){e.apply(this,arguments);this._panels=[];this._scene=new sap.ui.vtm.Scene(this.getId()+"_scene");this.addDependent(this._scene);this._dragStartParameters={};var i=this.getExtensions().map(function(e){return e.getInitializedPromise()});Promise.all(i).then(function(){sap.ui.vtm.measure(this,"fireInitialized",function(){this.fireInitialized()}.bind(this))}.bind(this))},setAddDefaultExtensions:function(e){if(e){[new sap.ui.vtm.extensions.LoadProgressExtension,new sap.ui.vtm.extensions.MessageStatusCalculationExtension,new sap.ui.vtm.extensions.MessageStatusIconClickExtension,new sap.ui.vtm.extensions.ViewportSelectionLinkingExtension,new sap.ui.vtm.extensions.VisibilityIconClickExtension,new sap.ui.vtm.extensions.DisplayStateCalculationExtension,new sap.ui.vtm.extensions.SelectionLinkingExtension({enabled:false}),new sap.ui.vtm.extensions.ViewLinkingExtension({enabled:false}),new sap.ui.vtm.extensions.InitialViewExtension,new sap.ui.vtm.extensions.SceneNodeHoverHighlightExtension,new sap.ui.vtm.extensions.SceneNodeHoverTooltipExtension].forEach(function(e){this.addExtension(e)}.bind(this))}},getPanels:function(){return this._panels},getPanel:function(e){return sap.ui.vtm.ArrayUtilities.find(this._panels,function(n){return n.getId()===e})},getScene:function(){return this._scene},createPanel:function(e,n){n=jQuery.extend(n,{vtmId:this});return new sap.ui.vtm.Panel(e,n)},_setActivePanel:function(e,n){if(this._activePanel===e){return}this._activePanel=e;var t=this.getPanels();t.forEach(function(t){var i=t===e;t._setIsActive(i);if(n){e.focus()}});sap.ui.vtm.measure(this,"fireActivePanelChanged",function(){this.fireActivePanelChanged()}.bind(this))},getActivePanel:function(){return this._activePanel||null},setActivePanel:function(e){this._setActivePanel(e,true);return this},_addPanel:function(e){var n=this.getPanels();n.push(e);sap.ui.vtm.measure(this,"firePanelAdded",function(){this.firePanelAdded({panel:e})}.bind(this));return this},getExtensionsByName:function(e){return this.getExtensions().filter(function(n){return n.getMetadata().getName()===e})},getExtensionByName:function(e){var n=this.getExtensionsByName(e);return n.length===1?n[0]:undefined},getExtensionsByInterface:function(e){return this.getExtensions().filter(function(n){return n.getMetadata().isInstanceOf(e)})},getExtensionByInterface:function(e){var n=this.getExtensionsByInterface(e);return n.length===1?n[0]:undefined}});return o});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/DisplayStateCalculationExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension"],function(jQuery,t,i){"use strict";var e=i.extend("sap.ui.vtm.extensions.DisplayStateCalculationExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.IDisplayStateCalculationExtension"]},constructor:function(t,e){i.apply(this,arguments)},initialize:function(){this._handlingEvent=false;this._defaultVisibility=false;this._defaultOpacity=null;this._defaultHighlightColor=null;this.applyPanelHandler(function(t){var i=t.getViewport();i.attachRefreshRequested(function(i){if(!this.getEnabled()){return}this._updateDisplayStates(t)}.bind(this))}.bind(this))},_updateDisplayStates:function(t){var i=new sap.ui.vtm.Lookup,e=new sap.ui.vtm.Lookup,a=[],s=[];this._calculateDisplayStates(t,a,s,i,e);this._applyDisplayStates(t,a,s,i,e)},_applyContextUpdates:function(t,i){var e=t.getViewport();var a=e.getScene();var s=e.getContextDisplayGroups();s.reverse().forEach(function(t){var e=t.getDisplayStatesBySceneNodeId();if(e){var s=Object.getOwnPropertyNames(e);s.forEach(function(t){var s=e[t];var n=s.visibility;var l=s.opacity;var r=s.highlightColor;var o=s.recursive;var u=[t];if(o===true){Array.prototype.push.apply(u,a.getDescendantIds(t))}u.forEach(function(t){var e=i.get(t);if(n!==null&&n!==undefined){e.visibility=n}if(l!==null&&l!==undefined){e.opacity=l}if(r!==null&&r!==undefined){e.highlightColor=r===""?this._defaultHighlightColor:r}})})}})},_applyTreeItemUpdates:function(t,i){var e=t.getTree();var a=e.getAllItems();a.forEach(function(t){var e=t.visibility===true;if(e){var a=sap.ui.vtm.TreeItemUtilities.getSceneNodeIds(t);var s=t.opacity;var n=t.highlightColor;a.forEach(function(t){var a=i.get(t);a.visibility=e;a.opacity=s||this._defaultOpacity;a.highlightColor=n||this._defaultHighlightColor}.bind(this))}}.bind(this))},_applyOverrideUpdates:function(t,i){var e=t.getViewport();var a=e.getScene();var s=e.getOverrideDisplayGroups();s.reverse().forEach(function(t){var e=t.getDisplayStatesBySceneNodeId();if(e){var s=Object.getOwnPropertyNames(e);s.forEach(function(t){var s=e[t];var n=s.visibility;var l=s.opacity;var r=s.highlightColor;var o=s.recursive;var u=[t];if(o===true){Array.prototype.push.apply(u,a.getDescendantIds(t))}u.forEach(function(t){var e=i.get(t);if(n!==null&&n!==undefined){e.visibility=n}if(l!==null&&l!==undefined){e.opacity=l}if(r!==null&&r!==undefined){e.highlightColor=r===""?this._defaultHighlightColor:r}})})}})},_calculateDisplayStates:function(t,i,e,a,s){sap.ui.vtm.measure(this,"_calculateDisplayStates",function(){var n;var l=new Map;sap.ui.vtm.measure(this,"_calculateDisplayStates - Get all ids",function(){n=this._vtm.getScene().getCachedIds()}.bind(this));sap.ui.vtm.measure(this,"creating display states",function(){n.forEach(function(t){l.set(t,{visibility:this._defaultVisibility,opacity:this._defaultOpacity,highlightColor:this._defaultHighlightColor})}.bind(this))}.bind(this));sap.ui.vtm.measure(this,"_applyContextUpdates ("+t.getId()+")",function(){this._applyContextUpdates(t,l)}.bind(this));sap.ui.vtm.measure(this,"_applyTreeItemUpdates ("+t.getId()+")",function(){this._applyTreeItemUpdates(t,l)}.bind(this));sap.ui.vtm.measure(this,"_applyOverrideUpdates ("+t.getId()+")",function(){this._applyOverrideUpdates(t,l)}.bind(this));sap.ui.vtm.measure(this,"_calculateDisplayStates - Populating lookups",function(){l.forEach(function(t,n){if(t.visibility){e.push(n);a.addValue(t.opacity,n);s.addValue(t.highlightColor,n)}else{i.push(n)}})})}.bind(this))},_applyDisplayStates:function(t,i,e,a,s){sap.ui.vtm.measure(this,"_applyDisplayStates",function(){var n=t.getViewport();n.setVisibility(i,false,false);if(e.length){n.setVisibility(e,true,false);a.forEach(function(t,i){n.setOpacity(t,i,false)});s.forEach(function(t,i){n.setHighlightColor(t,i,false)})}})}});return e});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/InitialViewExtension", ["jquery.sap.global","../Extension"],function(jQuery,e){"use strict";var t=e.extend("sap.ui.vtm.extensions.InitialViewExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.IInitialViewExtension"],properties:{predefinedView:{type:"sap.ui.vtm.PredefinedView"}}},constructor:function(t,i){e.apply(this,arguments)},initialize:function(e){var t=false;e.getScene().attachLoadCompleted(function(i){var n=e.getPanels();var a=i.getParameter("succeeded");if(!this.getEnabled()||!a||t||!n.length){return}t=true;var r=e.getExtensionByInterface("sap.ui.vtm.interfaces.IViewLinkingExtension");var s=r&&r.getEnabled();var o=this.getPredefinedView();var f=function(e){var t=e.getViewport();if(o){t.setPredefinedView(o)}else{t.zoomToAll(0)}};if(s){var c=e.getActivePanel()||n[0];f(c)}else{n.forEach(f)}}.bind(this))}});return t});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/LoadProgressExtension", ["jquery.sap.global","../Extension"],function(jQuery,e){"use strict";var t=e.extend("sap.ui.vtm.extensions.LoadProgressExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.IDownloadProgressExtension","sap.ui.vtm.interfaces.ILoadProgressExtension"]},constructor:function(t,o){e.apply(this,arguments)},initialize:function(e){this._scene=e.getScene();this._rb=sap.ui.vtm.getResourceBundle();this._oDialog=new sap.ui.vtm.ProgressDialog({progressBarVisible:false});this._downloadInfoByViewable=new Map;this._loadInfoByViewable=new Map;this._boundDownloadStartedHandler=this._downloadStartedHandler.bind(this);this._boundDownloadProgressHandler=this._downloadProgressHandler.bind(this);this._boundDownloadCompletedHandler=this._downloadCompletedHandler.bind(this);this._boundLoadStartedHandler=this._loadStartedHandler.bind(this);this._boundLoadProgressHandler=this._loadProgressHandler.bind(this);this._boundLoadCompletedHandler=this._loadCompletedHandler.bind(this);this._scene.attachDownloadStarted(this._boundDownloadStartedHandler)},_setDownloadPercentComplete:function(e){if(this._oDialog.getPercentComplete()!==e){this._oDialog.setPercentComplete(e);this._oDialog.setProgressText(this._rb.getText("PROGRESS_DOWNLOADING_0",[e]));sap.ui.getCore().applyChanges()}},_downloadProgressHandler:function(e){if(!this.getEnabled()){return}var t=e.getParameter("viewable");var o=e.getParameter("downloadedBytes");var a=e.getParameter("totalBytes");this._downloadInfoByViewable.set(t,{downloadedBytes:o,totalBytes:a});var n=0,s=0;this._downloadInfoByViewable.forEach(function(e){n+=e.downloadedBytes;s+=e.totalBytes});var d=s==0?0:Math.floor(n/s*100);this._setDownloadPercentComplete(d)},_downloadStartedHandler:function(e){if(!this.getEnabled()){return}this._openDialog()},_setLoadPercentComplete:function(e){if(this._oDialog.getPercentComplete()!==e){this._oDialog.setPercentComplete(e);this._oDialog.setProgressText(this._rb.getText("PROGRESS_LOADING_0",[e]));sap.ui.getCore().applyChanges()}},_loadProgressHandler:function(e){if(!this.getEnabled()){return}var t=e.getParameter("viewable");var o=e.getParameter("percentage");this._loadInfoByViewable.set(t,{percentComplete:o});var a=0;var n=0;this._loadInfoByViewable.forEach(function(e){a+=e.percentComplete;n++});var s=n==0?0:Math.floor(a/n);this._setLoadPercentComplete(s)},_downloadCompletedHandler:function(e){this._downloadInfoByViewable.clear();var t=e.getParameter("viewableLoadInfos");var o=t.every(function(e){return e.getStatus()===sap.ui.vtm.ViewableLoadStatus.DownloadFailed});if(o){this._closeDialog()}},_loadStartedHandler:function(e){this._oDialog.setProgressText(this._rb.getText("PROGRESS_LOADING"));sap.ui.getCore().applyChanges()},_loadCompletedHandler:function(e){this._loadInfoByViewable.clear();this._closeDialog()},_openDialog:function(){if(!this._oDialog.isOpen()){this._scene.attachDownloadProgress(this._boundDownloadProgressHandler);this._scene.attachDownloadCompleted(this._boundDownloadCompletedHandler);this._scene.attachLoadStarted(this._boundLoadStartedHandler);this._scene.attachLoadProgress(this._boundLoadProgressHandler);this._scene.attachLoadCompleted(this._boundLoadCompletedHandler);this._oDialog.open();this._setDownloadPercentComplete(0)}},_closeDialog:function(){this._scene.detachDownloadProgress(this._boundDownloadProgressHandler);this._scene.detachDownloadCompleted(this._boundDownloadCompletedHandler);this._scene.detachLoadStarted(this._boundLoadStartedHandler);this._scene.detachLoadProgress(this._boundLoadProgressHandler);this._scene.detachLoadCompleted(this._boundLoadCompletedHandler);this._oDialog.close()}});return t});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/MessageStatusCalculationExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension"],function(jQuery,e,t){"use strict";var s={Error:"Error",ErrorOnDescendant:"ErrorOnDescendant",Warning:"Warning",WarningOnDescendant:"WarningOnDescendant",Information:"Information",None:"None"};var a=t.extend("sap.ui.vtm.extensions.MessageStatusCalculationExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.IMessageStatusCalculationExtension"]},constructor:function(e,s){t.apply(this,arguments)},initialize:function(){this._rb=sap.ui.vtm.getResourceBundle();this.applyPanelHandler(function(e){var t=e.getTree();t.attachBeforeModelUpdated(function(t){this._handleBeforeModelUpdated(e)}.bind(this));this._handleBeforeModelUpdated(e)}.bind(this))},_getMessageStatusPriority:function(e){switch(e){case s.Error:return 1;case s.ErrorOnDescendant:return 2;case s.Warning:return 3;case s.WarningOnDescendant:return 4;case s.Information:return 5;case s.None:return 6;default:throw"Unknown message status: '"+e+"'"}},_makeCascadedMessageStatus:function(e){switch(e){case s.Error:case s.ErrorOnDescendant:return s.ErrorOnDescendant;case s.Warning:case s.WarningOnDescendant:return s.WarningOnDescendant;case s.Information:case s.None:return s.None;default:throw"Unknown message status: '"+e+"'"}},_messageStatusCompareFunction:function(e,t){return this._getMessageStatusPriority(e)-this._getMessageStatusPriority(t)},_calculateHighestPriorityMessageStatus:function(e){var t=e.messages;if(t){var s=sap.ui.vtm.TreeItemUtilities.getMessages(e);s.sort(sap.ui.core.Message.compareByType).reverse();return s[0].getLevel()}else{return sap.ui.core.MessageType.None}},_calculateHighestPriorityChildMessageStatus:function(e){var t=sap.ui.vtm.TreeItemUtilities.getIncludedChildren(e);if(t.length){var s=t.filter(function(e){return e.messageStatus});if(s.length){s.sort(function(e,t){return this._getMessageStatusPriority(e.messageStatus)-this._getMessageStatusPriority(t.messageStatus)}.bind(this));return s[0].messageStatus}}return sap.ui.core.MessageType.None},_calculateMessageStatus:function(e){var t=this._calculateHighestPriorityMessageStatus(e);var s=this._calculateHighestPriorityChildMessageStatus(e);if(this._messageStatusCompareFunction(t,s)>0){if(s===sap.ui.core.MessageType.None){if(e.messageStatus){delete e.messageStatus}}else{e.messageStatus=this._makeCascadedMessageStatus(s)}}else if(t===sap.ui.core.MessageType.None){if(e.messageStatus){delete e.messageStatus}}else{e.messageStatus=t}if(s===sap.ui.core.MessageType.None){if(e.childMessageStatus){delete e.childMessageStatus}else{e.childMessageStatus=s}}},_getIconSource:function(e){switch(e){case s.Error:return"sap-icon://error";case s.ErrorOnDescendant:return"sap-icon://message-error";case s.Warning:return"sap-icon://alert";case s.WarningOnDescendant:return"sap-icon://message-warning";case s.Information:return"sap-icon://message-information";case s.None:return null;default:throw"Unknown message type: '"+e+"'"}},_getStatusTooltip:function(e){switch(e){case s.Error:return this._rb.getText("MESSAGESTATUS_ERROR");case s.ErrorOnDescendant:return this._rb.getText("MESSAGESTATUS_ERRORONDESCENDANT");case s.Warning:return this._rb.getText("MESSAGESTATUS_WARNING");case s.WarningOnDescendant:return this._rb.getText("MESSAGESTATUS_WARNINGONDESCENDANT");case s.Information:return this._rb.getText("MESSAGESTATUS_INFORMATION");case s.None:return null;default:throw"Unknown message type: '"+e+"'"}},_getMessagesToShowTootip:function(e){if(e.messages){return this._rb.getText("MESSAGESTATUS_CLICKTOSHOWMESSAGES")}else{return this._rb.getText("MESSAGESTATUS_NOMESSAGESONTHISITEM")}},_getIconColor:function(e){switch(e){case s.Error:case s.ErrorOnDescendant:return sap.ui.core.IconColor.Negative;case s.Warning:case s.WarningOnDescendant:return sap.ui.core.IconColor.Critical;case s.Information:return sap.ui.core.IconColor.Neutral;case s.None:return null;default:throw"Unknown message type: '"+e+"'"}},_calculateMessageStatusForTree:function(e){var t=this._calculateMessageStatus.bind(this);var s=function(e,t){var a=sap.ui.vtm.TreeItemUtilities.getChildren(e);a.forEach(function(e){s(e,t)});if(t){t(e)}};e.getRootItems().forEach(function(e){s(e,t)});var a=false;sap.ui.vtm.TreeItemUtilities.traverseTree(e.getRootItems(),function(e){if(e.messageStatus){var t=this._getIconSource(e.messageStatus);if(e.messageStatusIconUrl!==t){e.messageStatusIconUrl=t;a=true}var s=this._getIconColor(e.messageStatus);if(e.messageStatusIconColor!==s){e.messageStatusIconColor=s;a=true}var n=this._getMessagesToShowTootip(e);var r=this._getStatusTooltip(e.messageStatus);var i=r?r+"\n"+n:n;if(e.messageStatusIconTooltip!=i){e.messageStatusIconTooltip=i;a=true}}else if(e.messageStatusIconUrl||e.messageStatusIconColor||e.messageStatusIconTooltip){delete e.messageStatusIconUrl;delete e.messageStatusIconColor;delete e.messageStatusIconTooltip;a=true}delete e.messageStatus;delete e.childMessageStatus}.bind(this));if(a){e._updateBindings()}},_handleBeforeModelUpdated:function(e){if(!this.getEnabled()){return}var t=e.getTree();this._calculateMessageStatusForTree(t)}});return a});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/MessageStatusIconClickExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension"],function(jQuery,e,t){"use strict";var s=t.extend("sap.ui.vtm.extensions.MessageStatusIconClickExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.IMessageStatusIconClickExtension"]},constructor:function(e,s){t.apply(this,arguments)},initialize:function(){this.applyPanelHandler(function(e){var t=e.getTree();var s;t.attachMessageStatusIconClicked(function(e){if(!this.getEnabled()){return}if(s&&s.isOpen()){s.close()}var t=e.getParameter("item");var a=e.getParameter("control");var i=sap.ui.vtm.TreeItemUtilities.getMessages(t);if(i.length){i.sort(sap.ui.core.Message.compareByType).reverse();s=new sap.ui.vtm.MessagesPopover({messages:i,maxHeight:"300px"});s.openBy(a)}}.bind(this))}.bind(this))}});return s});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/SceneNodeHoverHighlightExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension"],function(jQuery,e,t){"use strict";var i=t.extend("sap.ui.vtm.extensions.SceneNodeHoverHighlightExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.ISceneNodeHoverHighlightExtension"],properties:{highlightColor:{type:"sap.ui.core.CSSColor",defaultValue:"rgba(0, 0, 255, 0.7)"}}},constructor:function(e,i){t.apply(this,arguments)},initialize:function(){this._panelPanelInitialized=new Map;this.applyPanelHandler(function(e){var t=e.getViewport();var i=this._vtm.getScene();i.attachLoadCompleted(function(i){if(!i.getParameter("succeeded")){return}if(this._panelPanelInitialized.get(e)){return}this._panelPanelInitialized.set(e,true);var n=new sap.ui.vtm.DisplayGroup;var a=n.getDisplayStatesBySceneNodeId();var r=sap.ve.dvl.DVLID_INVALID;t.addOverrideDisplayGroup(n);var s=function(){if(r){if(a[r]){delete a[r]}}};var o=function(e,t){if(e!==sap.ve.dvl.DVLID_INVALID){a[e]={highlightColor:t}}};this.attachEnabledChanged(function(e){if(this.getEnabled()&&r){o(r,this.getHighlightColor())}else{s()}t.refresh()}.bind(this));t.addEventDelegate({onmouseout:function(){s();r=sap.ve.dvl.DVLID_INVALID;t.refresh()}},t);t.attachHover(function(e){var i=e.getParameter("nodeId");if(!this.getEnabled()){r=i;return}if(i!==r){s();r=i;o(i,this.getHighlightColor());t.refresh()}}.bind(this));t.attachBeginGesture(function(e){s();r=sap.ve.dvl.DVLID_INVALID;t.refresh()})}.bind(this))}.bind(this))}});return i});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/SceneNodeHoverTooltipExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension","../ViewportHandler"],function(jQuery,e,t,n){"use strict";var a=t.extend("sap.ui.vtm.extensions.SceneNodeHoverTooltipExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.ISceneNodeHoverTooltipExtension"],properties:{tooltipCallback:{type:"any",group:"Behavior",defaultValue:null}}},constructor:function(e,n){t.apply(this,arguments)},createTooltip:function(e,t){var n=document.createElement("div");n.className="sapUiVtmSceneNode-Tooltip";n.innerText=t;return n},initialize:function(){this._panelPanelInitialized=new Map;this.applyPanelHandler(function(e){var t=e.getViewport();var n=this._vtm.getScene();n.attachLoadCompleted(function(a){if(!a.getParameter("succeeded")){return}if(this._panelPanelInitialized.get(e)){return}this._panelPanelInitialized.set(e,true);var i=sap.ve.dvl.DVLID_INVALID;var r=t._getVkViewport();var o,l;var s;var d=function(e){return{text:e.getName()}};var c=new sap.ui.vtm.SceneNode({scene:n});var u=function(){if(s){r.getDomRef().removeChild(s);s=undefined}};var p=function(e,t,n){if(e!==sap.ve.dvl.DVLID_INVALID){c.setSceneNodeId(e);var a=this.getTooltipCallback()||d;var i=a(c);if(i){s=this.createTooltip(e,i.text);s.style.left="calc("+Math.floor(t)+"px + 1em)";s.style.top="calc("+Math.floor(n)+"px + 1.5em)";r.getDomRef().appendChild(s)}}}.bind(this);this.attachEnabledChanged(function(e){if(this.getEnabled()&&i){p(i,o,l)}else{u()}r.renderFrame()}.bind(this));t.addEventDelegate({onmouseout:function(){u();i=sap.ve.dvl.DVLID_INVALID;o=l=null;t.refresh()}},t);t.attachHover(function(e){var t=e.getParameter("nodeId");o=e.getParameter("x");l=e.getParameter("y");if(!this.getEnabled()){i=t;return}if(t!==i){u();i=t;p(t,o,l)}r.renderFrame()}.bind(this));t.attachBeginGesture(function(e){u();i=sap.ve.dvl.DVLID_INVALID;o=l=null;t.refresh()})}.bind(this))}.bind(this))}});return a});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/SelectionLinkingExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension"],function(jQuery,e,t){"use strict";var n=t.extend("sap.ui.vtm.extensions.SelectionLinkingExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.ISelectionLinkingExtension"],properties:{findMatchingTreeItems:{type:"any",group:"Behavior",defaultValue:null}}},constructor:function(e,n){t.apply(this,arguments)},initialize:function(){this._handlingEvent=new Map;this.applyPanelHandler(function(e){var t=e.getTree();t.attachSelectionChanged(function(n){if(!this.getEnabled()){return}if(this._handlingEvent.get(e)){return}this._onSelectionChanged(t.getPanel())}.bind(this));t.attachEvent("vtmInternalSetTreeSelectionComplete",function(t){this._handlingEvent.set(e,false)}.bind(this));t.attachModelUpdated(function(e){if(!this.getEnabled()){return}var t=this._getPrimaryPanel();if(t){this._onSelectionChanged(t)}}.bind(this))}.bind(this));this.attachEnabledChanged(function(){if(this.getEnabled()){var e=this._getPrimaryPanel();if(e){this._onSelectionChanged(e)}}})},_getPrimaryPanel:function(){var e=this._vtm.getPanels();if(!e||!e.length){return null}return this._vtm.getActivePanel()||e[0]},_onSelectionChanged:function(e){var t=e.getTree();var n=t.getSelectedItems();var i=this._vtm.getPanels();var a=this.getFindMatchingTreeItems();if(!a){return}i.forEach(function(i){var r=i.getTree();var s=[];if(i!==e){n.forEach(function(e){var n=a(e,t,r);Array.prototype.push.apply(s,n)});this._handlingEvent.set(i,true);r.setSelectedItems(s)}}.bind(this));return}});return n});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/ViewLinkingExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension"],function(jQuery,t,i){"use strict";var e=i.extend("sap.ui.vtm.extensions.ViewLinkingExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.IViewLinkingExtension"]},constructor:function(t,e){i.apply(this,arguments)},initialize:function(){this._skipCount=new Map;this.applyPanelHandler(function(t){var i=t.getViewport();i.attachEvent("frameRenderingFinished",function(i){if(!this.getEnabled()){return}var e=this._getPrimaryPanel();if(i.getSource()!=e.getViewport()){return}this._updateViews(t)}.bind(this))}.bind(this));this.attachEnabledChanged(function(t){if(this.getEnabled()){var i=this._getPrimaryPanel();if(i){this._updateViews(i)}}}.bind(this))},_getPrimaryPanel:function(){var t=this._vtm.getPanels();if(!t||!t.length){return null}return this._vtm.getActivePanel()||t[0]},_updateViews:function(t){var i=t.getViewport();if(!i.getInitialized()){return}var e=i.getCameraInfo();var n=this._vtm.getPanels();n.forEach(function(i){if(i!==t){var n=i.getViewport();if(n.getInitialized()){n.setCameraInfo(e)}}})}});return e});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/ViewportSelectionLinkingExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension"],function(jQuery,e,t){"use strict";var n=t.extend("sap.ui.vtm.extensions.ViewportSelectionLinkingExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.IViewportSelectionLinkingExtension"]},constructor:function(e,n){t.apply(this,arguments)},initialize:function(){this.applyPanelHandler(function(e){var t=e.getTree();var n=e.getViewport();var a=false;t.attachSelectionChanged(function(e){if(!this.getEnabled()){return}if(a){return}a=true;var t=e.getParameter("addedItems");var i=e.getParameter("removedItems");var r=[];i.forEach(function(e){if(e.sceneNodeIds){Array.prototype.push.apply(r,sap.ui.vtm.TreeItemUtilities.getSceneNodeIds(e))}});n.setSelected(r,false,false);var s=[];t.forEach(function(e){if(e.sceneNodeIds){Array.prototype.push.apply(s,sap.ui.vtm.TreeItemUtilities.getSceneNodeIds(e))}});n.setSelected(s,true,false);a=false}.bind(this));t.attachEvent("vtmInternalSetTreeSelectionComplete",function(e){a=false});n.attachSelectionChanged(function(e){if(!this.getEnabled()){return}var n=e.getParameter("selectedIds");var a=e.getParameter("userInteraction");if(a){var i=t.getItemsBySceneNodeId(n);t.setSelectedItems(i)}}.bind(this))}.bind(this))}});return n});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/extensions/VisibilityIconClickExtension", ["jquery.sap.global","sap/ui/core/Control","../Extension"],function(jQuery,i,t){"use strict";var e=t.extend("sap.ui.vtm.extensions.VisibilityIconClickExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.IVisibilityIconClickExtension","sap.ui.vtm.interfaces.IVisibilityHeaderIconClickExtension"]},constructor:function(i,e){t.apply(this,arguments)},initialize:function(){this.applyPanelHandler(function(i){var t=i.getTree();var e=i.getViewport();t.attachVisibilityIconClicked(function(i){if(!this.getEnabled()){return}var n=i.getParameter("item");var a=i.getParameter("visibility");var r=!a;var s=i.getParameter("control");s.setVisibility(r);this._onTreeItemVisibilityClicked(t,e,n,r)}.bind(this));t.attachVisibilityHeaderIconClicked(function(i){if(!this.getEnabled()){return}var e=i.getParameter("visibility");var n=!e;var a=i.getParameter("control");a.setVisibility(n);t.setVisibility(t.getRootItems(),n,true)}.bind(this))}.bind(this))},_onTreeItemVisibilityClicked:function(i,t,e,n){var a=i.getSelectedItems();var r=a&&a.indexOf(e)>=0;if(!r){a=[e]}i.setVisibility(a,n,true)}});return e});
/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.predefine("sap/ui/vtm/library", ["jquery.sap.global","sap/ui/core/Core","sap/ui/base/DataType","sap/ui/core/library","sap/ui/table/library","sap/m/library","sap/ui/vk/library","./ArrayUtilities","./MatrixComponent","./MatrixUtilities","./TreeItemUtilities","./HashUtilities","./DescriptorUtilities","./InternalColumns","./ColumnType","./PredefinedView","./TextColor","./SelectionMode","./InternalColumnDescriptor","./ChildCollectionType","./TreeItemType","./ColumnTemplates","./ViewableLoadStatus"],function(jQuery,e,i,t,s,n,a,o,r,u,p,l,m,c,v,x,g,d,f,I,E,y,C){"use strict";var S=e.initLibrary({name:"sap.ui.vtm",dependencies:["sap.ui.core","sap.ui.table","sap.m","sap.ui.vk"],interfaces:["sap.ui.vtm.interfaces.IDisplayStateCalculationExtension","sap.ui.vtm.interfaces.IInitialViewExtension","sap.ui.vtm.interfaces.IDownloadProgressExtension","sap.ui.vtm.interfaces.ILoadProgressExtension","sap.ui.vtm.interfaces.IMessageStatusCalculationExtension","sap.ui.vtm.interfaces.IMessageStatusIconClickExtension","sap.ui.vtm.interfaces.IMessageStatusHeaderIconClickExtension","sap.ui.vtm.interfaces.ISelectionLinkingExtension","sap.ui.vtm.interfaces.ISceneNodeHoverHighlightExtension","sap.ui.vtm.interfaces.ISceneNodeHoverTooltipExtension","sap.ui.vtm.interfaces.IViewLinkingExtension","sap.ui.vtm.interfaces.IViewportSelectionLinkingExtension","sap.ui.vtm.interfaces.IVisibilityIconClickExtension","sap.ui.vtm.interfaces.IVisibilityHeaderIconClickExtension"],types:["sap.ui.vtm.Matrix"],controls:["sap.ui.vtm.Panel","sap.ui.vtm.Tree","sap.ui.vtm.Text","sap.ui.vtm.Viewport","sap.ui.vtm.MessagesPopover","sap.ui.vtm.Progress","sap.ui.vtm.ProgressDialog","sap.ui.vtm.SelectColumnsDialog"],elements:["sap.ui.vtm.Vtm","sap.ui.vtm.Column","sap.ui.vtm.Lookup","sap.ui.vtm.ViewableLoadInfo","sap.ui.vtm.Viewable","sap.ui.vtm.Scene","sap.ui.vtm.SceneNode","sap.ui.vtm.Extension","sap.ui.vtm.DisplayGroup","sap.ui.vtm.TreeCollections","sap.ui.vtm.extensions.MessageStatusCalculationExtension","sap.ui.vtm.extensions.MessageStatusIconClickExtension","sap.ui.vtm.extensions.ViewportSelectionLinkingExtension","sap.ui.vtm.extensions.SelectionLinkingExtension","sap.ui.vtm.extensions.VisibilityIconClickExtension","sap.ui.vtm.extensions.DisplayStateCalculationExtension","sap.ui.vtm.extensions.ViewLinkingExtension","sap.ui.vtm.extensions.InitialViewExtension","sap.ui.vtm.extensions.LoadProgressExtension","sap.ui.vtm.extensions.SceneNodeHoverHighlightExtension","sap.ui.vtm.extensions.SceneNodeHoverTooltipExtension"],noLibraryCSS:false,version:"1.141.0"});S.createVtm=function(e,i){return new sap.ui.vtm.Vtm(e,jQuery.extend(i,{addDefaultExtensions:true}))};var V;S.getResourceBundle=function(){if(!V){V=sap.ui.getCore().getLibraryResourceBundle("sap.ui.vtm.i18n")}return V};S.createMeasureId=function(e,i){return typeof e==="string"?e+"#"+i:e.getMetadata().getName()+"#"+i+" "+e.getId()};S.measure=function(e,i,t){var s=sap.ui.vtm.createMeasureId(e,i);jQuery.sap.measure.start(s,"",["sap.ui.vtm"]);try{t()}finally{jQuery.sap.measure.end(s)}return s};S.Matrix=i.createType("sap.ui.vtm.Matrix",{isValid:function(e){return sap.ui.vtm.Matrix.getBaseType().isValid(e)&&e.length===13}},i.getType("float[]"));return S});
sap.ui.require.preload({
	"sap/ui/vtm/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.vtm","type":"library","embeds":[],"applicationVersion":{"version":"1.141.0"},"title":"SAPUI5 Visual Tree Mapper.","description":"SAPUI5 Visual Tree Mapper.","resources":"resources.json","offline":true},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_base","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_bluecrystal_base","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.141","libs":{"sap.ui.core":{"minVersion":"1.141.0"},"sap.ui.unified":{"minVersion":"1.141.0","lazy":true},"sap.m":{"minVersion":"1.141.0","lazy":true},"sap.ui.layout":{"minVersion":"1.141.0","lazy":true}}},"library":{"i18n":false,"content":{"controls":["sap.ui.vtm.Panel","sap.ui.vtm.Tree","sap.ui.vtm.Text","sap.ui.vtm.Viewport","sap.ui.vtm.MessagesPopover","sap.ui.vtm.Progress","sap.ui.vtm.ProgressDialog","sap.ui.vtm.SelectColumnsDialog"],"elements":["sap.ui.vtm.Vtm","sap.ui.vtm.Column","sap.ui.vtm.Lookup","sap.ui.vtm.ViewableLoadInfo","sap.ui.vtm.Viewable","sap.ui.vtm.Scene","sap.ui.vtm.SceneNode","sap.ui.vtm.Extension","sap.ui.vtm.DisplayGroup","sap.ui.vtm.TreeCollections","sap.ui.vtm.extensions.MessageStatusCalculationExtension","sap.ui.vtm.extensions.MessageStatusIconClickExtension","sap.ui.vtm.extensions.ViewportSelectionLinkingExtension","sap.ui.vtm.extensions.SelectionLinkingExtension","sap.ui.vtm.extensions.VisibilityIconClickExtension","sap.ui.vtm.extensions.DisplayStateCalculationExtension","sap.ui.vtm.extensions.ViewLinkingExtension","sap.ui.vtm.extensions.InitialViewExtension","sap.ui.vtm.extensions.LoadProgressExtension","sap.ui.vtm.extensions.SceneNodeHoverHighlightExtension","sap.ui.vtm.extensions.SceneNodeHoverTooltipExtension"],"types":["sap.ui.vtm.Matrix"],"interfaces":["sap.ui.vtm.interfaces.IDisplayStateCalculationExtension","sap.ui.vtm.interfaces.IInitialViewExtension","sap.ui.vtm.interfaces.IDownloadProgressExtension","sap.ui.vtm.interfaces.ILoadProgressExtension","sap.ui.vtm.interfaces.IMessageStatusCalculationExtension","sap.ui.vtm.interfaces.IMessageStatusIconClickExtension","sap.ui.vtm.interfaces.IMessageStatusHeaderIconClickExtension","sap.ui.vtm.interfaces.ISelectionLinkingExtension","sap.ui.vtm.interfaces.ISceneNodeHoverHighlightExtension","sap.ui.vtm.interfaces.ISceneNodeHoverTooltipExtension","sap.ui.vtm.interfaces.IViewLinkingExtension","sap.ui.vtm.interfaces.IViewportSelectionLinkingExtension","sap.ui.vtm.interfaces.IVisibilityIconClickExtension","sap.ui.vtm.interfaces.IVisibilityHeaderIconClickExtension"]}}}}'
});
//# sourceMappingURL=library-preload.js.map
