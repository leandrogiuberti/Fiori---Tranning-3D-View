/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/Control","../Extension","../ViewportHandler"],function(jQuery,e,t,n){"use strict";var a=t.extend("sap.ui.vtm.extensions.SceneNodeHoverTooltipExtension",{metadata:{interfaces:["sap.ui.vtm.interfaces.ISceneNodeHoverTooltipExtension"],properties:{tooltipCallback:{type:"any",group:"Behavior",defaultValue:null}}},constructor:function(e,n){t.apply(this,arguments)},createTooltip:function(e,t){var n=document.createElement("div");n.className="sapUiVtmSceneNode-Tooltip";n.innerText=t;return n},initialize:function(){this._panelPanelInitialized=new Map;this.applyPanelHandler(function(e){var t=e.getViewport();var n=this._vtm.getScene();n.attachLoadCompleted(function(a){if(!a.getParameter("succeeded")){return}if(this._panelPanelInitialized.get(e)){return}this._panelPanelInitialized.set(e,true);var i=sap.ve.dvl.DVLID_INVALID;var r=t._getVkViewport();var o,l;var s;var d=function(e){return{text:e.getName()}};var c=new sap.ui.vtm.SceneNode({scene:n});var u=function(){if(s){r.getDomRef().removeChild(s);s=undefined}};var p=function(e,t,n){if(e!==sap.ve.dvl.DVLID_INVALID){c.setSceneNodeId(e);var a=this.getTooltipCallback()||d;var i=a(c);if(i){s=this.createTooltip(e,i.text);s.style.left="calc("+Math.floor(t)+"px + 1em)";s.style.top="calc("+Math.floor(n)+"px + 1.5em)";r.getDomRef().appendChild(s)}}}.bind(this);this.attachEnabledChanged(function(e){if(this.getEnabled()&&i){p(i,o,l)}else{u()}r.renderFrame()}.bind(this));t.addEventDelegate({onmouseout:function(){u();i=sap.ve.dvl.DVLID_INVALID;o=l=null;t.refresh()}},t);t.attachHover(function(e){var t=e.getParameter("nodeId");o=e.getParameter("x");l=e.getParameter("y");if(!this.getEnabled()){i=t;return}if(t!==i){u();i=t;p(t,o,l)}r.renderFrame()}.bind(this));t.attachBeginGesture(function(e){u();i=sap.ve.dvl.DVLID_INVALID;o=l=null;t.refresh()})}.bind(this))}.bind(this))}});return a});
//# sourceMappingURL=SceneNodeHoverTooltipExtension.js.map