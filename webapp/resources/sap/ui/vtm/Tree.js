/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/Control","sap/ui/table/TreeTable","./SelectionMode","./InternalColumnDescriptor","./ArrayUtilities","./MatrixUtilities","./TreeItemUtilities","./Column","./Lookup","./library","./Text","./ColumnType","./InternalColumns","sap/ui/model/json/JSONModel","sap/ui/commons/TextView","sap/ui/core/IconPool","sap/ui/core/Icon","sap/ui/layout/HorizontalLayout","./CheckEye"],function(jQuery,e,t,i,r,n,a,s,o,l,u,d,c,h,m,f,p,g,v,I){"use strict";var C=e.extend("sap.ui.vtm.Tree",{metadata:{properties:{selectionMode:{type:"sap.ui.vtm.SelectionMode",defaultValue:"Single"}},aggregations:{_treeTable:{type:"sap.ui.table.TreeTable",multiple:false,visibility:"hidden"},headerControls:{type:"sap.ui.core.Control",multiple:true}},events:{dragStart:{parameters:{dragItem:{type:"object"},dragTree:{type:"sap.ui.vtm.Tree"}},allowPreventDefault:true},dragOver:{parameters:{dragItem:{type:"object"},dragTree:{type:"sap.ui.vtm.Tree"},dragOverItem:{type:"object"},dragOverTree:{type:"sap.ui.vtm.Tree"}},allowPreventDefault:true},drop:{parameters:{dragItem:{type:"object"},dragTree:{type:"sap.ui.vtm.Tree"},dropItem:{type:"object"},dropTree:{type:"sap.ui.vtm.Tree"}}},selectionChanged:{parameters:{addedItems:{type:"object[]"},removedItems:{type:"object[]"},userInteraction:{type:"boolean"}}},visibilityHeaderIconClicked:{parameters:{visibility:{type:"boolean"},control:{type:"sap.ui.core.Control"}}},visibilityIconClicked:{parameters:{item:{type:"object"},visibility:{type:"boolean"},control:{type:"sap.ui.core.Control"}}},expandedChanged:{parameters:{item:{type:"object"},expanded:{type:"boolean"},userInteraction:{type:"boolean"}}},fixedColumnsChanged:{},dataColumnsChanged:{},beforeModelUpdated:{},modelUpdated:{},messageStatusIconClicked:{parameters:{items:{type:"object"},control:{type:"sap.ui.core.Control"}}},messageStatusHeaderIconClicked:{control:{type:"sap.ui.core.Control"}},hierarchyChanged:{}}},constructor:function(t,i){e.apply(this,arguments);this._rb=sap.ui.vtm.getResourceBundle();this._treeCollections=new sap.ui.vtm.TreeCollections;this._selectedItems=[];var r=new sap.ui.table.TreeTable({enableColumnReordering:true,selectionMode:sap.ui.table.SelectionMode.Single,showNoData:false,visibleRowCountMode:sap.ui.table.VisibleRowCountMode.Auto,minAutoRowCount:4,selectionBehavior:sap.ui.table.SelectionBehavior.RowOnly});this.setAggregation("_treeTable",r);r.allowTextSelection(false);var a=sap.ui.vtm.InternalColumns.createTreeColumn();var s=sap.ui.vtm.InternalColumns.createVisibilityColumn();var o=sap.ui.vtm.InternalColumns.createMessageStatusColumn();this._fixedColumns=[a,s,o];this._setColumns(this._fixedColumns);this.setRootItems([]);this.updateCollections(false);this._updateModel();r.setCollapseRecursive(false);r.attachToggleOpenState(this._handleToggleOpenState.bind(this));r.attachCellClick(function(e){if(this.getSelectionMode()==sap.ui.vtm.SelectionMode.MultiToggleWithSingleSelect){var t=e.getParameter("rowIndex");var i=this._getItemByRowIndex(t);if(i){this._selectedItems=[i];r.setSelectedIndex(t)}else{this._selectedItems=[];r.clearSelection()}}}.bind(this));var l=function(e,t){if(e.getVisible&&!e.getVisible()||e.getEnabled&&!e.getEnabled()){return false}if(e.ontap){e.ontap(t)}else if(e.userToggle){e.userToggle(t)}else if(e.onclick){e.onclick(t)}return true};var u=function(e){var t=sap.ui.table.TableUtils.getFocusedItemInfo(r);var i=this.getSelectionMode()===sap.ui.vtm.SelectionMode.MultiToggle;var n=i?t.cellInRow-1:t.cellInRow;var a=r.getColumns();var s=a[n];if(!s){return}var o=s.data("definition");var u=o.getType();var d=o.getDescriptor();var c=t.row===0;if(c){if(u===sap.ui.vtm.ColumnType.Internal&&d===sap.ui.vtm.InternalColumnDescriptor.Visibility){var h=s.getLabel();l(h,e)}}else if(u===sap.ui.vtm.ColumnType.Internal){var m=r.getRows()[t.row-1].getCells()[n];switch(d){case sap.ui.vtm.InternalColumnDescriptor.Tree:sap.ui.table.TableUtils.toggleRowSelection(r,e.target);e.preventDefault();e.stopImmediatePropagation();break;case sap.ui.vtm.InternalColumnDescriptor.Visibility:case sap.ui.vtm.InternalColumnDescriptor.MessageStatus:l(m,e);e.preventDefault();e.stopImmediatePropagation();break;default:break}}}.bind(this);r.attachBrowserEvent("keyup",function(e){if(e.which===jQuery.sap.KeyCodes.SPACE){u(e)}});r.attachRowSelectionChange(function(e){var t=e.getParameter("userInteraction");var i=e.getParameter("rowIndices");var a=r.getSelectedIndices();var s=[];var o=[];i.forEach(function(e){if(a.indexOf(e)!=-1){s.push(e)}else{o.push(e)}});var l=this._getTreeItemsFromRowIndices(s);var u=this._getTreeItemsFromRowIndices(o);if(t){var d=u.map(function(e){return e.id});var c=function(e,t){return e.id==t.id};var h=function(e){return d.indexOf(e.id)==-1};this._selectedItems=n.union([this._selectedItems.filter(h),l],c)}sap.ui.vtm.measure(this,"fireSelectionChanged",function(){this.fireSelectionChanged({addedItems:l,removedItems:u,userInteraction:t})}.bind(this));if(t){this.fireEvent("vtmInternalSetTreeSelectionComplete")}}.bind(this))},renderer:function(e,t){e.write("<div");e.writeControlData(t);e.addClass("sapUiVtmTree");e.writeStyles();e.writeClasses();e.write(">");var i=t.getHeaderControls();i.forEach(function(t){if(t){e.renderControl(t)}});var r=t._getTreeTable();e.renderControl(r);e.write("</div>")},_raiseExpandedChanged:function(e){sap.ui.vtm.measure(this,"fireExpandedChanged",function(){this.fireExpandedChanged(e)}.bind(this))},_handleToggleOpenState:function(e){var t=e.getParameter("rowContext");var i=e.getParameter("expanded");var r=t.getPath();var n=this.getItemByBindingContextPath(r);this._raiseExpandedChanged({item:n,expanded:i,userInteraction:true})},_getAncestor:function(e){var t=this.getParent();while(t&&t.getMetadata().getName()!==e){t=t.getParent()}return t},getPanel:function(){if(!this._panel){this._panel=this._getAncestor("sap.ui.vtm.Panel")}return this._panel},setExpanded:function(e,t){var i=this._getTreeTable();var r=function(){var r=this._getRowIndexForTreeItem(i,e);if(r!==-1){var n;if(t){if(!i.isExpanded(r)){n=true;i.expand(r)}}else if(i.isExpanded(r)){n=true;i.collapse(r)}if(n){this._raiseExpandedChanged({item:e,expanded:t,userInteraction:false})}}}.bind(this);if(t){this._expandToTreeItem(e,false,r)}else{r()}return this},getExpanded:function(e){var t=this._getTreeTable();var i=this._getRowIndexForTreeItem(t,e);if(i!==-1){return t.isExpanded(i)}return false},getFixedColumns:function(){var e=[];var t=this._getTreeTable();var i=t.getColumns();for(var r=0;r<this._fixedColumns.length;r++){var n=i[r];var a=n.data("definition");a.setWidth(n.getWidth());a.setHAlign(n.getHAlign());e.push(a)}return e},setFixedColumns:function(e){if(!e){throw"fixedColumns not specified"}this._fixedColumns=e;var t=this.getDataColumns();var i=this._fixedColumns.concat(t);this._setColumns(i);this.fireFixedColumnsChanged();return this},getDataColumns:function(){var e=[];var t=this._getTreeTable();var i=t.getColumns();for(var r=this._fixedColumns.length;r<i.length;r++){var n=i[r];var a=n.data("definition");a.setWidth(n.getWidth());a.setHAlign(n.getHAlign());e.push(a)}return e},setDataColumns:function(e){if(!e){throw"dataColumns not specified"}var t=this._fixedColumns.concat(e);this._setColumns(t);this.fireDataColumnsChanged();return this},_setColumns:function(e){var t=this._getTreeTable();t.removeAllColumns();e.forEach(function(e){var i=this._createColumn(e);t.addColumn(i)}.bind(this));t.setFixedColumnCount(this._fixedColumns.length)},_getTreeItemsFromRowIndices:function(e){return e.map(function(e){return this._getItemByRowIndex(e)}.bind(this)).filter(function(e){return!!e})},_getTreeTable:function(){return this.getAggregation("_treeTable")},getRootItems:function(){return this._rootItems},setRootItems:function(e){this._rootItems=e;return this},isEmpty:function(){return this._rootItems.length===0},getSelectedItems:function(){return this._selectedItems},_expandToTreeItem:function(e,t){return new Promise(function(i,r){var n=this._getTreeTable();var a=function(e,t,i){var r;if(t<e||t>=e+i){r=t-i/2}else{r=e}r=r>0?Math.floor(r):0;return r};var s=this.getAncestorItems(e.id,false);var o=function(e,t,i){if(i.getParameter("reason")==="expand"){e(t)}};var l=null;var u=0;var d=function(r){var s=function(){n.getBinding("rows").detachChange(l);var r=this._getRowIndexForTreeItem(n,e,u);if(r===-1){throw"Tree item with id '"+e.id+"' not found in treeTable"}if(t){var s=n.getVisibleRowCount(),o=n.getFirstVisibleRow(),d=a(o,r,s);if(d!==o){n.setFirstVisibleRow(d)}}i()}.bind(this);setTimeout(function(){if(r.length){while(r.length){var e=r[0];var t=this._getRowIndexForTreeItem(n,e,u);if(t===-1){return}else{r.shift();u=t+1;if(!n.isExpanded(t)){n.expand(t);this._raiseExpandedChanged({item:e,expanded:true,userInteraction:false});return}else if(!r.length){s()}}}}else{s()}}.bind(this),0)}.bind(this);l=o.bind(this,d,s);n.getBinding("rows").attachChange(l);d(s)}.bind(this))},_getRowIndexForTreeItem:function(e,t,i){var r=-1;sap.ui.vtm.measure(this,"_getRowIndexForTreeItem",function(){if(!i){i=0}var n=function(e,t){t.forEach(function(t){e=e[t]});return e};var a=this.getAllItems();for(var s=i;s<a.length;s++){var o=e.getContextByIndex(s);if(o){var l=o.getPath().split("/");l.shift();var u=o.getModel().getData();var d=n(u,l);if(d===t){r=s;break}}}}.bind(this));return r},expandAncestors:function(e){sap.ui.vtm.measure(this,"expandAncestors",function(){this._expandToTreeItem(e,false)}.bind(this));return this},expandAll:function(){sap.ui.vtm.measure(this,"expandAll",function(){this._getTreeTable().expandToLevel(1e3*1e3*1e3)}.bind(this));return this},collapseAll:function(){sap.ui.vtm.measure(this,"collapseAll",function(){this._getTreeTable().collapseAll()}.bind(this));return this},expandToLevel:function(e){sap.ui.vtm.measure(this,"expandToLevel",function(){this._getTreeTable().expandToLevel(e)}.bind(this));return this},scrollIntoView:function(e){sap.ui.vtm.measure(this,"scrollIntoView",function(){this._expandToTreeItem(e,true)}.bind(this));return this},setSelectedItems:function(e,t){e=sap.ui.vtm.ArrayUtilities.wrap(e);if(t!==true&&t!==false){t=true}if(this.getSelectionMode()==sap.ui.vtm.SelectionMode.Single&&e.length>1){e=e.slice(0,1)}if(e.length){var i=[];this.traverseTree(function(e){i.push(e.id)});e=e.filter(function(e){return i.indexOf(e.id)!=-1})}this._selectedItems=e;if(!e.length){this._getTreeTable().clearSelection();this.fireEvent("vtmInternalSetTreeSelectionComplete");return this}var r=function(e){var t=this._getTreeTable();for(var i=0;;i++){var r=this._getItemByRowIndex(i);if(!r){break}var n=e.indexOf(r)!==-1;if(n!=t.isIndexSelected(i)){if(n){t.addSelectionInterval(i,i)}else{t.removeSelectionInterval(i,i)}}}this.fireEvent("vtmInternalSetTreeSelectionComplete")}.bind(this);var n=function(){r(e)};var a=null;e.forEach(function(e){if(!a){a=this._expandToTreeItem(e,t)}else{a=a.then(function(){return this._expandToTreeItem(e,t)}.bind(this))}}.bind(this));a.then(n);return this},validateTree:function(){sap.ui.vtm.measure(this,"validateTree",function(){var e=sap.ui.vtm.TreeItemUtilities.validateTree(this.getRootItems());if(e.length!==0){e.forEach(function(e){var t="Tree error in "+this.getId()+": "+e;jQuery.sap.log.error(t,null,"sap.ui.vtm.Tree")});throw"There were errors in the "+this.getId()+" tree. See the console trace for details"}}.bind(this));return this},updateModel:function(e){sap.ui.vtm.measure(this,"updateModel",function(){sap.ui.vtm.measure(this,"fireBeforeModelUpdated",function(){this.fireBeforeModelUpdated()}.bind(this));this._updateModel(e);this.setSelectedItems(this._selectedItems,false);sap.ui.vtm.measure(this,"fireModelUpdated",function(){this.fireModelUpdated()}.bind(this))}.bind(this));return this},_updateModel:function(e){var t=this._getTreeTable();var i=t.getModel();if(!i||e){i=new sap.ui.model.json.JSONModel;i.setSizeLimit(1e6);t.bindRows({path:"/rootItems",key:"id",parameters:{arrayNames:["includedChildren"],numberOfExpandedLevels:1}});i.setData({rootItems:this.getRootItems()});t.setModel(i)}else{i.setData({rootItems:this.getRootItems()});this._updateBindings(true)}},_updateBindings:function(){this._getTreeTable().getModel().updateBindings(true)},updateCollections:function(e){sap.ui.vtm.measure(this,"updateCollections",function(){if(this._treeCollections.updateCollections(this.getRootItems(),e)){sap.ui.vtm.measure(this,"fireHierarchyChanged",function(){this.fireHierarchyChanged()}.bind(this))}}.bind(this));return this},updateTreeItemsBySceneNodeId:function(){sap.ui.vtm.measure(this,"updateTreeItemsBySceneNodeId",function(){this._treeCollections.updateTreeItemsBySceneNodeId(this.getRootItems())}.bind(this));return this},getItemByBindingContextPath:function(e){return this._getTreeTable().getModel().getProperty(e)||undefined},getItem:function(e){return this._treeCollections.getItem(e)},isIncludedItem:function(e){return this._treeCollections.isIncludedItem(e)},isExcludedItem:function(e){return this._treeCollections.isExcludedItem(e)},getItemsBySceneNodeId:function(e,t){return this._treeCollections.getItemsBySceneNodeId(e,t)},getParentItem:function(e){return this._treeCollections.getParentItem(e)},getDescendantItems:function(e,t){return this._treeCollections.getDescendantItems(e,t)},getAncestorItems:function(e){return this._treeCollections.getAncestorItems(e)},getAllItems:function(e){return this._treeCollections.getAllItems(e)},_modifyDisplayState:function(e,t,i,r,n){e=sap.ui.vtm.ArrayUtilities.wrap(e);i=i==null?true:i;n=n==null?true:n;r=r==null?true:r;var a=function(e){if(!r||sap.ui.vtm.TreeItemUtilities.hasVisibility(e)){t(e)}return sap.ui.vtm.ChildCollectionType.IncludedAndExcluded};e.forEach(function(e){if(i){sap.ui.vtm.TreeItemUtilities.traverseBranch(e,a)}else{a(e)}});if(n){this.updateModel();this.getPanel().getViewport().refresh()}},_getTreeItemData:function(e,t){if(Array.isArray(e)){return e.map(t)}else{return t(e)}},setVisibility:function(e,t,i,r,n){var a=function(e){if(t==undefined){delete e.visibility}else{e.visibility=t}};this._modifyDisplayState(e,a,i,r,n);return this},getVisibility:function(e){return this._getTreeItemData(e,function(e){return e.visibility})},setOpacity:function(e,t,i,r,n){var a=function(e){if(t==undefined){delete e.opacity}else{e.opacity=t}};this._modifyDisplayState(e,a,i,r,n);return this},getOpacity:function(e){return this._getTreeItemData(e,function(e){return e.opacity})},setHighlightColor:function(e,t,i,r,n){var a=function(e){if(t==null){delete e.highlightColor}else{e.highlightColor=t}};this._modifyDisplayState(e,a,i,r,n);return this},getHighlightColor:function(e){return this._getTreeItemData(e,function(e){return e.highlightColor})},_getItemByRowIndex:function(e){var t=this._getTreeTable();var i=t.getContextByIndex(e);var r=i?i.sPath:"";return this.getItemByBindingContextPath(r)},onAfterRendering:function(){var e=this._getTreeTable();if(e.setFixedColumnCount()!=this._fixedColumns.length){e.setFixedColumnCount(this._fixedColumns.length)}this._addDragHandlers();this._addMutationObserver()},setSelectionMode:function(e){if(e===this.getSelectionMode()){return this}var t=this._getTreeTable();this._selectedItems=[];t.clearSelection();var i;var r;switch(e){case sap.ui.vtm.SelectionMode.Single:i=sap.ui.table.SelectionMode.Single;r=sap.ui.table.SelectionBehavior.RowOnly;break;case sap.ui.vtm.SelectionMode.MultiToggle:i=sap.ui.table.SelectionMode.MultiToggle;r=sap.ui.table.SelectionBehavior.Row;break;case sap.ui.vtm.SelectionMode.MultiToggleWithSingleSelect:i=sap.ui.table.SelectionMode.MultiToggle;r=sap.ui.table.SelectionBehavior.RowSelector;break;default:throw"Unknown selection mode: '"+e+"'"}t.setSelectionBehavior(r);t.setSelectionMode(i);this.setProperty("selectionMode",e);return this},_addMutationObserver:function(){var e=false;var t=new MutationObserver(function(t){if(e){return}e=true;var i=false;t.forEach(function(e){if(i){return}if(e.type==="childList"){this._addDragHandlers();i=true}}.bind(this));e=false}.bind(this));var i={subtree:true,childList:true};jQuery("#"+this.getId()).each(function(e,r){t.observe(r,i)})},_getRowIndexForTableRow:function(e){var t=jQuery(e).attr("data-sap-ui-rowindex");var i=this._getTreeTable().getFirstVisibleRow()+parseInt(t,10);return i},_addDragHandlers:function(){var e=this.getId();var t="#"+e+" tr.sapUiTableTr";if(jQuery(t).attr("draggable")){return}var i=this.getPanel().getVtm();var r=function(e){e.dataTransfer.setData("text","");var t=e.currentTarget;var r=this._getRowIndexForTableRow(t);var n=this._getItemByRowIndex(r);if(!n){e.preventDefault();return}var a=this.getSelectedItems();if(a&&a.length&&a.indexOf(n)<0){e.preventDefault();return}i._dragStartParameters={dragItem:n,dragTree:this};var s;sap.ui.vtm.measure(this,"fireDragStart",function(){s=this.fireDragStart(i._dragStartParameters)}.bind(this));if(!s){e.preventDefault()}}.bind(this);var n=function(e){var t=i._dragStartParameters;if(!t){return}var r=e.currentTarget;var n=this._getRowIndexForTableRow(r);var a={dragItem:t.dragItem,dragTree:t.dragTree,dragOverItem:this._getItemByRowIndex(n),dragOverTree:this};var s;sap.ui.vtm.measure(this,"fireDragOver",function(){s=this.fireDragOver(a)}.bind(this));if(!s){e.preventDefault()}}.bind(this);var a=function(e){var t=i._dragStartParameters;if(!t){return}var r=e.currentTarget;var n=this._getRowIndexForTableRow(r);var a={dragItem:t.dragItem,dragTree:t.dragTree,dropItem:this._getItemByRowIndex(n),dropTree:this};i._dragStartParameters=null;sap.ui.vtm.measure(this,"fireDrop",function(){this.fireDrop(a)}.bind(this))}.bind(this);var s=function(e){e.addEventListener("dragstart",r,false);e.addEventListener("dragover",n,false);e.addEventListener("drop",a,false)};jQuery(t).each(function(){var e=jQuery(this);e.attr("draggable","true");e.attr("droppable","true");s(this)})},_createColumn:function(e){var t=e.getTemplate()||this._createColumnTemplate(e);var i=e.getLabel();var r=e.getLabelControl();this._attachColumnHeaderEvents(e);var n={label:r?r:i,tooltip:e.getTooltip()||i,hAlign:e.getHAlign()||sap.ui.core.HorizontalAlign.Left,width:e.getWidth()||"auto",resizable:e.getResizable(),template:t};var a=new sap.ui.table.Column(n);a.setTemplate(t);a.data("definition",e);return a},traverseBranch:function(e,t){var i=this.getAncestorItems(e);sap.ui.vtm.TreeItemUtilities.traverseBranch(e,t,i);return this},traverseTree:function(e){this.getRootItems().forEach(function(t){this.traverseBranch(t,e,[])}.bind(this));return this},removeRoot:function(e){return sap.ui.vtm.TreeItemUtilities.removeRoot(this._rootItems,e)},addRoot:function(e){sap.ui.vtm.TreeItemUtilities.addRoot(this._rootItems,e);return this},_attachColumnHeaderEvents:function(e){var t=e.getLabelControl();if(!t){return}var i=e.getType();if(!i){throw"Column type not specified"}switch(i){case sap.ui.vtm.ColumnType.Internal:{var r=e.getDescriptor();if(!r){throw"Column descriptor not specified"}switch(r){case sap.ui.vtm.InternalColumnDescriptor.MessageStatus:t.attachPress(function(){this.fireMessageStatusHeaderIconClicked({control:t})}.bind(this));break;case sap.ui.vtm.InternalColumnDescriptor.Visibility:t.attachPress(function(){this.fireVisibilityHeaderIconClicked({visibility:t.getVisibility(),control:t})}.bind(this));break;default:break}switch(r){case sap.ui.vtm.InternalColumnDescriptor.MessageStatus:case sap.ui.vtm.InternalColumnDescriptor.Visibility:t.addEventDelegate({onfocusin:function(e){t.getDomRef().blur()}},t);break;default:break}}break;default:break}return t},_createColumnTemplate:function(e){var t=sap.ui.vtm.ColumnTemplates;var i=e.getType();if(!i){throw"Column type not specified"}switch(i){case sap.ui.vtm.ColumnType.Internal:{var r=e.getDescriptor();switch(r){case sap.ui.vtm.InternalColumnDescriptor.TreeItemId:return t.createTreeItemIdColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.Tree:return t.createTreeColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.MessageStatus:var n=t.createMessageStatusColumnTemplate();n.attachPress(function(e){var t=e.getSource();var i=t.getBindingContext();var r=i.getPath();var n=this.getItemByBindingContextPath(r);this.fireMessageStatusIconClicked({item:n,control:t})}.bind(this));n.addEventDelegate({onfocusin:function(e){var t=sap.ui.getCore();var i=t.getCurrentFocusedControlId();var r=t.byId(i);if(r){var n=r.getDomRef();if(n){n.blur()}}}},n);return n;case sap.ui.vtm.InternalColumnDescriptor.AbsoluteMatrix:return t.createAbsoluteMatrixColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.RelativeMatrix:return t.createRelativeMatrixColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.SceneNodeIds:return t.createSceneNodeIdsColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.Visibility:var a=t.createVisibilityColumnTemplate();var s=function(e){var t=e.getBindingContext().getPath();var i=this.getItemByBindingContextPath(t);if(i){sap.ui.vtm.measure(this,"fireVisibilityIconClicked",function(){this.fireVisibilityIconClicked({item:i,visibility:i.visibility,control:e})}.bind(this))}}.bind(this);a.attachPress(function(e){var t=e.getSource();s(t)});a.addEventDelegate({onfocusin:function(e){var t=sap.ui.getCore();var i=t.getCurrentFocusedControlId();var r=t.byId(i);if(r){var n=r.getDomRef();if(n){n.blur()}}}},a);return a;case sap.ui.vtm.InternalColumnDescriptor.Opacity:return t.createOpacityColumnTemplate();case sap.ui.vtm.InternalColumnDescriptor.HighlightColor:return t.createHighlightColorColumnTemplate();default:throw"Unknown internal column type: "+r}break}case sap.ui.vtm.ColumnType.Metadata:return t.createMetadataColumnTemplate(e);case sap.ui.vtm.ColumnType.Identifier:return t.createIdentifierColumnTemplate(e);case sap.ui.vtm.ColumnType.AppData:return t.createAppDataColumnTemplate(e);default:throw"Invalid column type: "+i}}});return C});
//# sourceMappingURL=Tree.js.map