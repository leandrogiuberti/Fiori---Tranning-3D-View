/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5)

        (c) Copyright 2009-2015 SAP SE. All rights reserved
    
 */
sap.ui.define(["jquery.sap.global","sap/ui/core/Message","./ArrayUtilities"],function(jQuery,e,i){"use strict";var n={};n.mapBranch=function(e,i){var d=i(e);if(e.includedChildren){d.includedChildren=e.includedChildren.map(function(e){return n.mapBranch(e,i)})}if(e.excludedChildren){d.excludedChildren=e.excludedChildren.map(function(e){return n.mapBranch(e,i)})}return d};n.mapTree=function(e,i){var d=[];e.forEach(function(e){d.push(n.mapBranch(e,i))});return d};var d=function(e){return Array.isArray(e)?sap.ui.vtm.ArrayUtilities.shallowClone(e):e};var t=function(e){if(e===null||e===undefined){return e}var i={};var n=Object.keys(e);n.forEach(function(n){i[n]=d(e[n])});return i};n.cloneMetadata=function(e){return t(e.metadata)};n.cloneIdentifiers=function(e){return t(e.identifiers)};n.cloneAppData=function(e){return t(e.appData)};n.hasVisibility=function(e){return e.visibility===true||e.visibility===false};n.getAppDataDescriptors=function(e){if(!e.appData){return[]}return Object.keys(e.appData)};n.getAppDataValues=function(e,n){if(!e.appData){return[]}return i.wrap(e.appData[n])};n.setAppDataValues=function(e,n,d){var t=i.unwrap(d);if(t===undefined){if(e.appData){delete e.appData[n]}}else{if(!e.appData){e.appData={}}e.appData[n]=d}};n.getMetadataDescriptors=function(e){if(!e.metadata){return[]}return Object.keys(e.metadata)};n.getMetadataValues=function(e,n){if(!e.metadata){return[]}return i.wrap(e.metadata[n])};n.setMetadataValues=function(e,n,d){var t=i.unwrap(d);if(t===undefined){if(e.metadata){delete e.metadata[n]}}else{if(!e.metadata){e.metadata={}}e.metadata[n]=d}};n.getIdentifierDescriptors=function(e){if(!e||!e.identifiers){return[]}return Object.keys(e.identifiers)};n.getIdentifierValues=function(e,n){if(!e.identifiers){return[]}return i.wrap(e.identifiers[n])};n.setIdentifierValues=function(e,n,d){var t=i.unwrap(d);if(t===undefined){if(e.identifiers){delete e.identifiers[n]}}else{if(!e.identifiers){e.identifiers={}}e.identifiers[n]=d}};n.getSceneNodeIds=function(e){if(!e.sceneNodeIds){return[]}return i.wrap(e.sceneNodeIds)};n.setSceneNodeIds=function(e,n){n=i.unwrap(n);if(n===undefined){if(e.sceneNodeIds){delete e.sceneNodeIds}}else{e.sceneNodeIds=n}};n.getIncludedChildren=function(e){if(!e.includedChildren){return[]}return e.includedChildren};n.getExcludedChildren=function(e){if(!e.excludedChildren){return[]}return e.excludedChildren};n.getChildren=function(e,i){switch(i){case sap.ui.vtm.ChildCollectionType.None:return[];case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:return n.getIncludedChildren(e);case sap.ui.vtm.ChildCollectionType.Excluded:return n.getExcludedChildren(e);case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:return n.getIncludedChildren(e).concat(n.getExcludedChildren(e));default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+i}};n.setIncludedChildren=function(e,i){i=sap.ui.vtm.ArrayUtilities.wrap(i);if(i.length==0){delete e.includedChildren}else{e.includedChildren=i}};n.setExcludedChildren=function(e,i){i=sap.ui.vtm.ArrayUtilities.wrap(i);if(i.length==0){delete e.excludedChildren}else{e.excludedChildren=i}};n.setChildren=function(e,i,d){switch(d){case sap.ui.vtm.ChildCollectionType.None:break;case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:n.setIncludedChildren(e,i);break;case sap.ui.vtm.ChildCollectionType.Excluded:n.setExcludedChildren(e,i);break;case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:throw"sap.ui.vtm.ChildCollectionType.IncludedAndExcluded cannot be used in sap.ui.vtm.TreeItemUtilities.setChildren";default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+d}};n.hasIncludedChildren=function(e){return e.includedChildren&&e.includedChildren.length};n.hasExcludedChildren=function(e){return e.excludedChildren&&e.excludedChildren.length};n.hasChildren=function(e,i){switch(i){case sap.ui.vtm.ChildCollectionType.None:return false;case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:return n.hasIncludedChildren(e);case sap.ui.vtm.ChildCollectionType.Excluded:return n.hasExcludedChildren(e);case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:return n.hasIncludedChildren(e)||n.hasExcludedChildren(e);default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+i}};n.calculateAbsoluteMatrix=function(e,i){if(!e){return i||sap.ui.vtm.MatrixUtilities.createIdentity()}return i?sap.ui.vtm.MatrixUtilities.multiply(e,i):e};n.calculateRelativeMatrix=function(e,i){if(!e){throw"An absolute matrix value is needed to calculate a relative matrix value"}return i?sap.ui.vtm.MatrixUtilities.multiply(e,sap.ui.vtm.MatrixUtilities.invert(i)):e};n.addIncludedChild=function(e,i){if(e.includedChildren){e.includedChildren.push(i)}else{e.includedChildren=[i]}};n.addExcludedChild=function(e,i){if(e.excludedChildren){e.excludedChildren.push(i)}else{e.excludedChildren=[i]}};n.addChild=function(e,i,d){switch(d){case sap.ui.vtm.ChildCollectionType.None:break;case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:n.addIncludedChild(e,i);break;case sap.ui.vtm.ChildCollectionType.Excluded:n.addExcludedChild(e,i);break;case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:throw"sap.ui.vtm.ChildCollectionType.IncludedAndExcluded cannot be used in sap.ui.vtm.TreeItemUtilities.addChild";default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+d}};n.removeIncludedChild=function(e,i){var n=typeof i==="string"?i:i.id;if(e.includedChildren){var d=sap.ui.vtm.ArrayUtilities.findIndex(e.includedChildren,function(e){return e.id===n});if(d!==undefined){var t=e.includedChildren[d];e.includedChildren.splice(d,1);if(e.includedChildren.length==0){delete e.includedChildren}return t}}return undefined};n.removeExcludedChild=function(e,i){var n=typeof i==="string"?i:i.id;if(e.excludedChildren){var d=sap.ui.vtm.ArrayUtilities.findIndex(e.excludedChildren,function(e){return e.id===n});if(d!==undefined){var t=e.excludedChildren[d];e.excludedChildren.splice(d,1);if(e.excludedChildren.length==0){delete e.excludedChildren}return t}}return undefined};n.removeChild=function(e,i,d){switch(d){case sap.ui.vtm.ChildCollectionType.None:break;case null:case undefined:case sap.ui.vtm.ChildCollectionType.Included:return n.removeIncludedChild(e,i);case sap.ui.vtm.ChildCollectionType.Excluded:return n.removeExcludedChild(e,i);case sap.ui.vtm.ChildCollectionType.IncludedAndExcluded:return n.removeIncludedChild(e,i)||n.removeExcludedChild(e,i);default:throw"Unknown sap.ui.vtm.ChildCollectionType value: "+d}};n.includeAllChildren=function(e,i){e=sap.ui.vtm.ArrayUtilities.wrap(e);e.forEach(function(e){var d=n.getChildren(e,sap.ui.vtm.ChildCollectionType.IncludedAndExcluded);n.setIncludedChildren(e,d);n.setExcludedChildren(e,[]);if(i){d.forEach(function(e){n.includeAllChildren(e,true)})}})};n.excludeAllChildren=function(e,i){e=sap.ui.vtm.ArrayUtilities.wrap(e);e.forEach(function(e){var d=n.getChildren(e,sap.ui.vtm.ChildCollectionType.IncludedAndExcluded);n.setChildren(e,[]);n.setExcludedChildren(e,d);if(i){d.forEach(function(e){n.excludeAllChildren(e,true)})}})};n.removeRoot=function(e,i){var n=typeof i==="string"?i:i.id;var d=sap.ui.vtm.ArrayUtilities.findIndex(e,function(e){return e.id===n});if(d!==undefined){var t=e[d];e.splice(d,1);return t}return undefined};n.addRoot=function(e,i){e.push(i)};n.validateTreeItem=function(e){var i=function(e){return e===null||e===undefined};var n=[];if(e){if(i(e.id)){n.push("id is not specified")}if(!i(e.absoluteMatrix)){if(!sap.ui.vtm.MatrixUtilities.isValid(e.absoluteMatrix,true)){n.push("absoluteMatrix is not valid")}}if(!i(e.relativeMatrix)){if(!sap.ui.vtm.MatrixUtilities.isValid(e.relativeMatrix,true)){n.push("relativeMatrix is not valid")}}}return n};n.validateTree=function(e){var i=[];var d=function(e,t){var l=n.validateTreeItem(e);if(l&&l.length!==0){var r=t+": "+l.join(", ");i.push(r)}var u;var a=e.includedChildren;if(a){for(u=0;u<a.length;u++){d(a[u],t+"/includedChildren/"+u)}}var c=e.excludedChildren;if(c){for(u=0;u<c.length;u++){d(c[u],t+"/excludedChildren/"+u)}}};for(var t=0;t<e.length;t++){d(e[t],""+t)}return i};n.traverseBranch=function(e,i,d){if(!e){return}var t=i(e,d)||sap.ui.vtm.ChildCollectionType.Included;if(d&&t!==sap.ui.vtm.ChildCollectionType.None){d.push(e)}if(t===sap.ui.vtm.ChildCollectionType.IncludedAndExcluded||t===sap.ui.vtm.ChildCollectionType.Included){var l=e.includedChildren;if(l){l.forEach(function(e){n.traverseBranch(e,i,d)})}}if(t===sap.ui.vtm.ChildCollectionType.IncludedAndExcluded||t===sap.ui.vtm.ChildCollectionType.Excluded){var r=e.excludedChildren;if(r){r.forEach(function(e){n.traverseBranch(e,i,d)})}}if(d&&t!==sap.ui.vtm.ChildCollectionType.None){d.pop()}};n.traverseTree=function(e,i){if(e){e.forEach(function(e){n.traverseBranch(e,i,[])})}};n.getMessages=function(e){if(!e.messages||!e.messages.length){return[]}var i=JSON.parse(e.messages);var n=i.map(function(e){return new sap.ui.core.Message(e)});return n};n.setMessages=function(e,i){if(!i||!i.length){delete e.messages;return}var n=i.map(function(e){var i={};var n=e.getLevel();if(n){i.level=n}var d=e.getText();if(d){i.text=d}var t=e.getIcon();if(t){i.icon=t}var l=e.getTimestamp();if(l){i.timestamp=l}var r=e.getReadOnly();if(r){i.readOnly=r}return i});e.messages=JSON.stringify(n)};return n},true);
//# sourceMappingURL=TreeItemUtilities.js.map