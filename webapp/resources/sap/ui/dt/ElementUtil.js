/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/isPlainObject","sap/ui/base/Object","sap/ui/core/Component","sap/ui/core/Element","sap/ui/core/UIArea","sap/ui/dt/DOMUtil","sap/ui/dt/Util"],function(e,t,n,r,a,i,g){"use strict";var o={};o.iterateOverAllPublicAggregations=function(e,t){var n=e.getMetadata().getAllAggregations();var r=Object.keys(n);r.forEach(function(r){var a=n[r];var i=o.getAggregation(e,r);t(a,i)})};o.getElementInstance=function(e){if(typeof e==="string"){var t=r.getElementById(e);return t||n.getComponentById(e)}return e};o.hasAncestor=function(e,t){t=o.fixComponentContainerElement(t);var n;while(e&&e!==t){n=o.fixComponentParent(e);if(e===n){e=e.getParent()}else{e=n}}return!!e};o.getClosestElementForNode=function(e){var t=e.closest("[data-sap-ui]");return t?r.getElementById(t.getAttribute("data-sap-ui")):undefined};o.fixComponentParent=function(e){if(t.isObjectA(e,"sap.ui.core.UIComponent")){var n=e.oContainer;if(n){return n.getParent()}}else{return e}};o.fixComponentContainerElement=function(e){if(t.isObjectA(e,"sap.ui.core.ComponentContainer")){if(!e.getComponentInstance()){return undefined}return e.getComponentInstance().getRootControl()}return e};o.getDomRef=function(e){if(e){var t;if(e.getDomRef){t=e.getDomRef()}if(!t&&e.getRenderedDomRef){t=e.getRenderedDomRef()}return t}};o.findAllSiblingsInContainer=function(e,t){var n=e&&e.getParent();if(!n){return[]}if(n!==t){var r=o.findAllSiblingsInContainer(n,t);return r.map(function(t){return o.getAggregation(t,e.sParentAggregationName)}).reduce(function(e,t){return e.concat(t)},[])}return o.getAggregation(n,e.sParentAggregationName)};o.getAggregationAccessors=function(e,t){var n=e.getMetadata();n.getJSONKeys();var r=n.getAggregation(t);if(r){var a=r._sGetter;if(r.altTypes&&r.altTypes.length&&e[`${r._sGetter}Control`]){a=`${r._sGetter}Control`}return{get:a,add:r._sMutator,remove:r._sRemoveMutator,insert:r._sInsertMutator,removeAll:r._sRemoveAllMutator}}return{}};o.getAggregation=function(e,t){var n;var r=o.getAggregationAccessors(e,t).get;if(r){n=e[r]()}else{n=e.getAggregation(t)}n=n&&n.splice?n:n?[n]:[];return n};o.getIndexInAggregation=function(e,t,n){return o.getAggregation(t,n).indexOf(e)};o.addAggregation=function(e,t,n){if(o.hasAncestor(e,n)){throw new Error("Trying to add an element to itself or its successors")}var r=o.getAggregationAccessors(e,t).add;if(r){e[r](n)}else{e.addAggregation(t,n)}};o.removeAggregation=function(e,t,n,r){var a=o.getAggregationAccessors(e,t).remove;if(a){e[a](n,r)}else{e.removeAggregation(t,n,r)}};o.insertAggregation=function(e,t,n,r){if(o.hasAncestor(e,n)){throw new Error("Trying to add an element to itself or its successors")}if(o.getIndexInAggregation(n,e,t)!==-1){n.__bSapUiDtSupressParentChangeEvent=true;try{o.removeAggregation(e,t,n,true)}finally{delete n.__bSapUiDtSupressParentChangeEvent}}var a=o.getAggregationAccessors(e,t).insert;if(a){e[a](n,r)}else{e.insertAggregation(t,n,r)}};o.isValidForAggregation=function(e,n,r){var a=e.getMetadata().getAggregation(n);if(o.hasAncestor(e,r)){return false}if(a){var i=a.type;if(a.multiple===false&&o.getAggregation(e,n)&&o.getAggregation(e,n).length>0){return false}return t.isObjectA(r,i)||o.hasInterface(r,i)}};o.getAssociationAccessors=function(e,t){var n=e.getMetadata();n.getJSONKeys();var r=n.getAssociation(t);if(r){return{get:r._sGetter,add:r._sMutator,remove:r._sRemoveMutator,insert:r._sInsertMutator,removeAll:r._sRemoveAllMutator}}return{}};o.getAssociation=function(e,t){var n;var r=o.getAssociationAccessors(e,t).get;if(r){n=e[r]()}return n};o.getIndexInAssociation=function(e,t,n){return o.getAssociationInstances(t,n).indexOf(e)};o.getAssociationInstances=function(e,t){var n=g.castArray(o.getAssociation(e,t));return n.map(function(e){return o.getElementInstance(e)})};o.hasInterface=function(e,t){var n=e.getMetadata().getInterfaces();return n.indexOf(t)!==-1};o.isElementInTemplate=function(e){var t=o.getAggregationInformation(e);if(t.templateId){var n=o.extractTemplateId(t);if(!n){return false}}return true};o.isElementDirectTemplateChild=function(e){var t=o.getAggregationInformation(e);if(t.templateId){var n=o.extractTemplateId(t);if(n&&t.stack.length===1){return true}}return false};o.isElementValid=function(e){var t=(e instanceof r||e instanceof n)&&!e.bIsDestroyed&&o.isElementInTemplate(e);return t};o.getLabelForElement=function(e,t){if(!o.isElementValid(e)){throw g.createError("ElementUtil#getLabelForElement","A valid managed object instance should be passed as parameter","sap.ui.dt")}if(typeof t==="function"){return t(e)}function n(e){var t=typeof e.getText==="function"&&e.getText()||typeof e.getLabelText==="function"&&e.getLabelText()||typeof e.getLabel==="function"&&e.getLabel()||typeof e.getTitle==="function"&&e.getTitle()||typeof e.getHeading==="function"&&e.getHeading()||typeof e.getDataSourceLabel==="function"&&e.getDataSourceLabel();if(o.isElementValid(t)){return n(t)}return t}var r=n(e);return typeof r!=="string"?e.getId():r};o.extractTemplateId=function(t){if(e(t)&&t.templateId){if(t.stack.length>1){var n;var a=r.getElementById(t.templateId);var i;var g;for(var s=t.stack.length-2;s>=0;s--){i=t.stack[s].aggregation;g=t.stack[s].index;n=o.getAggregation(a,i)[g];if(!n){return undefined}a=n}return a.getId()}else if(t.stack.length===1){return t.templateId}}else{return undefined}};o.getAggregationInformation=function(e){var t=[];return o._evaluateBinding(e,t)};o._evaluateBinding=function(e,t){var n;var r;var i;var g;var{aAPIParentInfos:s}=e;if(s&&s.length>0){g=s.some(function(t){i=t.parent;n=t.aggregationName;r=o.getAggregation(i,n).indexOf(e);return i.getBinding(n)})}if(!g){i=e.getParent();if(i){n=e.sParentAggregationName;r=o.getAggregation(i,n).indexOf(e)}else{r=-1}}t.push({element:e.getId(),type:e.getMetadata().getName(),aggregation:n,index:r});if(n&&i?.getBinding(n)){var u=i.getBindingInfo(n);var f=u&&u.template;return{elementId:i.getId(),aggregation:n,templateId:f?f.getId():undefined,stack:t}}return!i||i instanceof a?{elementId:undefined,aggregation:undefined,templateId:undefined,stack:t}:o._evaluateBinding(i,t)};o.getAggregationBindingTemplate=function(e,t){var n=e&&e.getBindingInfo(t);return n&&n.template};o.adjustIndexForMove=function(e,t,n,r){if(e===t&&n<r&&n>-1){return r-1}return r};o.checkTargetZone=function(e,t,n){var r=e.getGeometry();var a=r&&r.size.height>0&&r.size.width>0;var g=e.getElement();var s=t.getElement();var u=e.getAggregationName();if(!s||!o.isValidForAggregation(g,u,s)){return Promise.resolve(false)}function f(e,t){var n=e.getDomRef();var r=i.isVisible(n);if(!n){return r}var a=t&&t.getDomRef&&t.getDomRef();var g=a?i.isVisible(a):true;return r||g}if(n&&!a||!n&&!f(e,g)||!(g&&g.getVisible&&g.getVisible())||!g.getParent()){return Promise.resolve(false)}return Promise.resolve(true)};return o});
//# sourceMappingURL=ElementUtil.js.map