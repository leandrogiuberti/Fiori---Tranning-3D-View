//@ui5-bundle sap/ui/fl/library-preload-write.js
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/FakeLrepConnector", ["sap/ui/fl/initial/_internal/FlexConfiguration","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils","sap/ui/fl/write/_internal/connectors/ObjectPathConnector"],function(e,t,r,i){"use strict";var n={};var a="sap.ui.fl";n.prototype={};n.enableFakeConnector=function(e){this.setFlexibilityServicesAndClearCache("LocalStorageConnector",e)};n.setFlexibilityServicesAndClearCache=function(r,n){this._oFlexibilityServices=e.getFlexibilityServices();var a=[];if(n){i.setJsonPath(n);a.push({connector:"ObjectPathConnector"})}a.push({connector:r});e.setFlexibilityServices(a);t.clearState()};n.disableFakeConnector=function(){n.prototype={};t.clearState();if(this._oFlexibilityServices){e.setFlexibilityServices(this._oFlexibilityServices);delete this._oFlexibilityServices}};n.forTesting={getNumberOfChanges(e,t){return e.loadFlexData({reference:t}).then(function(e){return e.reduce(function(e,t){return e+t.changes.length},0)})},spyMethod(e,t,r,i){var n=e.spy(r,i);return function(e,r){r||=0;var a=n.getCall(r).args[0].flexObjects.length;t.equal(a,e,`${i} was called ${e} times`)}},clear(e,r){t.clearState();return e.reset(r)},setStorage(e,t){e.storage=t},synchronous:{clearAll(e){var t=function(t){var r=t.includes(a);if(!r){return}e.removeItem(t)};Object.keys(e).map(t)},store(e,t,i){var n=r.createFlexKey(t);var a=JSON.stringify(i);e.setItem(n,a)},getNumberOfChanges(e,t){return Object.keys(e).filter(function(i){return i.includes(a)&&r.isSameReference(JSON.parse(e.getItem(i)),t)}).length}}};return n},true);
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/FakeLrepConnectorLocalStorage", ["sap/ui/fl/FakeLrepConnector","sap/ui/fl/write/_internal/connectors/LocalStorageConnector"],function(e,n){"use strict";return{enableFakeConnector(n){var o=n?n.sInitialComponentJsonPath:undefined;e.setFlexibilityServicesAndClearCache("LocalStorageConnector",o)},disableFakeConnector(){e.disableFakeConnector()},forTesting:{spyWrite(o,r){return e.forTesting.spyMethod(o,r,n,"write")},getNumberOfChanges(o){return e.forTesting.getNumberOfChanges(n,o)},synchronous:{clearAll(){e.forTesting.synchronous.clearAll(window.localStorage)},store(n,o){e.forTesting.synchronous.store(window.localStorage,n,o)}}}}},true);
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/FakeLrepConnectorSessionStorage", ["sap/ui/fl/FakeLrepConnector","sap/ui/fl/write/_internal/connectors/SessionStorageConnector"],function(e,n){"use strict";return{enableFakeConnector(n){var r=n?n.sInitialComponentJsonPath:undefined;e.setFlexibilityServicesAndClearCache("SessionStorageConnector",r)},disableFakeConnector(){e.disableFakeConnector()},forTesting:{spyWrite(r,t){return e.forTesting.spyMethod(r,t,n,"write")},getNumberOfChanges(r){return e.forTesting.getNumberOfChanges(n,r)},clear(r){return e.forTesting.clear(n,r)},setStorage(r){e.forTesting.setStorage(n,r)},synchronous:{clearAll(){e.forTesting.synchronous.clearAll(window.sessionStorage)},getNumberOfChanges(r){return e.forTesting.synchronous.getNumberOfChanges(n.storage,r)}}}}},true);
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/FakeLrepLocalStorage", ["sap/ui/fl/FakeLrepConnectorLocalStorage"],function(e){"use strict";return{deleteChanges(){return e.forTesting.synchronous.clearAll()}}},true);
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/descriptorRelated/Utils", [],function(){"use strict";var e=function(){};e.prototype.getNameAndNameSpace=function(e,t){return{fileName:"manifest",namespace:`apps/${t}/appVariants/${e}/`}};e.prototype.checkChildPageChange=function(e){this.checkParameterAndType(e,"childPage","object");if(e.childPage instanceof Array){for(var t=0;t<e.childPage.length;t++){var r=e.childPage[t];this.checkChildPageChangeContent(r)}}else if(e.childPage instanceof Object){this.checkChildPageChangeContent(e.childPage)}};e.prototype.checkChildPageChangeContent=function(e){this.checkParameterAndType(e,"id","string");this.checkParameterAndType(e,"definition","object");this.checkParameterAndType(e.definition,"navigationProperty","string");this.checkParameterAndType(e.definition,"entitySet","string")};e.prototype.checkEntityPropertyChange=function(e){this.checkParameterAndType(e,"entityPropertyChange","object");if(e.entityPropertyChange instanceof Array){for(var t=0;t<e.entityPropertyChange.length;t++){var r=e.entityPropertyChange[t];this.checkEntityPropertyChangeContent(r)}}else if(e.entityPropertyChange instanceof Object){this.checkEntityPropertyChangeContent(e.entityPropertyChange)}};e.prototype.checkEntityPropertyChangeContent=function(e){this.checkParameterAndType(e,"propertyPath","string");this.checkParameterAndType(e,"operation","string");if(["INSERT","UPDATE","UPSERT","DELETE"].indexOf(e.operation)===-1){throw new Error("Parameter \"entityPropertyChange.operation\" needs to be one of 'INSERT', 'UPDATE', 'UPSERT', 'DELETE'")}if(e.propertyValue===undefined&&e.operation!=="DELETE"){throw new Error('No parameter "entityPropertyChange.propertyValue" provided')}};e.prototype.checkParameterAndType=function(e,t,r){if(typeof r==="string"){r=[r]}var n;r.forEach(function(r){if(r==="array"){if(e!==undefined&&e[t]!==undefined&&Array.isArray(e[t])){n=true}}else if(e!==undefined&&e[t]!==undefined&&typeof e[t]===r){n=true}});if(!n){throw new Error(`No parameter "${t}" of type ${r} provided`)}};e.prototype.checkTexts=function(e){if(e!==undefined&&typeof e!=="object"){throw new Error('Wrong format for provided "texts" parameter')}};e.prototype.checkTransportRequest=function(e){if(!/^[A-Z0-9]{1,20}$/.test(e)&&e!=="ATO_NOTIFICATION"){throw new Error('Wrong format for provided "sTransportRequest" parameter')}};e.prototype.checkPackage=function(e){if(!/^[A-Z0-9/_$-]{1,30}$/.test(e)&&e!=="$TMP"){throw new Error(`Wrong format for provided "sPackage" parameter. '${e}' as package name is not allowed.`)}};return new e},true);
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/descriptorRelated/api/DescriptorChange", ["sap/base/util/merge","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/write/_internal/flexState/changes/UIChangeManager","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/Utils"],function(e,t,n,i,a){"use strict";const r=function(e,t){this._mChangeFile=e;this._mChangeFile.packageName="";this._oInlineChange=t};r.prototype.submit=function(){this.store();return i.saveFlexObjects({reference:this._mChangeFile.reference,selector:this._mChangeFile.selector})};r.prototype.store=function(){const e=this._mChangeFile.reference;const t=a.getComponentForControl(this._mChangeFile.selector);const i=this._getChangeToSubmit();n.addDirtyChanges(e,[i],t);return i};r.prototype._getChangeToSubmit=function(){return t.createAppDescriptorChange(this._getMap())};r.prototype._getMap=function(){var e=this._oInlineChange.getMap();this._mChangeFile.content=e.content;this._mChangeFile.texts=e.texts;return this._mChangeFile};r.prototype.getJson=function(){return e({},this._getMap())};return r});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/descriptorRelated/api/DescriptorChangeFactory", ["sap/ui/fl/descriptorRelated/api/DescriptorChange"],function(e){"use strict";var t=function(){};t.prototype.createNew=function(t,r,a,n,o){if(r.setHostingIdForTextKey){r.setHostingIdForTextKey(t)}var i={};const p=r.getMap();i.changeType=p.changeType;i.fileName=r.fileName;i.componentName=t;i.reference=t;i.generator=o;i.support=p.support;i.adaptationId=p.adaptationId;i.layer=a||"CUSTOMER";return Promise.resolve(new e(i,r))};return t});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/descriptorRelated/api/DescriptorInlineChangeFactory", ["sap/ui/fl/write/_internal/appVariant/AppVariantInlineChangeFactory","sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes","sap/base/util/merge"],function(e,a,r){"use strict";function t(e,a,t){var n=r({},{changeType:e},{content:a});if(t){n.texts=t}return n}var n={};n.getDescriptorChangeTypes=function(){return a.getChangeTypes()};n.getCondensableDescriptorChangeTypes=function(){return a.getCondensableChangeTypes()};n.createNew=function(a,r,n){var p=t(a,r,n);return e.createNew(p)};n.createDescriptorInlineChange=function(a,r,n){var p=t(a,r,n);return e.createDescriptorInlineChange(p)};n.create_ovp_addNewCard=function(a,r){var n=t("appdescr_ovp_addNewCard",a,r);return e.create_ovp_addNewCard(n)};n.create_ovp_removeCard=function(a){var r=t("appdescr_ovp_removeCard",a);return e.create_ovp_removeCard(r)};n.create_ovp_changeCard=function(a,r){var n=t("appdescr_ovp_changeCard",a,r);return e.create_ovp_changeCard(n)};n.create_app_addNewInbound=function(a,r){var n=t("appdescr_app_addNewInbound",a,r);return e.create_app_addNewInbound(n)};n.create_app_removeInbound=function(a){var r=t("appdescr_app_removeInbound",a);return e.create_app_removeInbound(r)};n.create_app_removeAllInboundsExceptOne=function(a){var r=t("appdescr_app_removeAllInboundsExceptOne",a);return e.create_app_removeAllInboundsExceptOne(r)};n.create_app_changeInbound=function(a,r){var n=t("appdescr_app_changeInbound",a,r);return e.create_app_changeInbound(n)};n.create_app_addNewOutbound=function(a){var r=t("appdescr_app_addNewOutbound",a);return e.create_app_addNewOutbound(r)};n.create_app_removeOutbound=function(a){var r=t("appdescr_app_removeOutbound",a);return e.create_app_removeOutbound(r)};n.create_app_changeOutbound=function(a){var r=t("appdescr_app_changeOutbound",a);return e.create_app_changeOutbound(r)};n.create_app_addNewDataSource=function(a){var r=t("appdescr_app_addNewDataSource",a);return e.create_app_addNewDataSource(r)};n.create_app_removeDataSource=function(a){var r=t("appdescr_app_removeDataSource",a);return e.create_app_removeDataSource(r)};n.create_app_changeDataSource=function(a){var r=t("appdescr_app_changeDataSource",a);return e.create_app_changeDataSource(r)};var p={BEGINNING:"BEGINNING",END:"END"};n.create_app_addAnnotationsToOData=function(a){var r=t("appdescr_app_addAnnotationsToOData",a);return e.create_app_addAnnotationsToOData(r)};n.create_app_setTitle=function(a,r){if(!r){r={"":a};a={}}var n=t("appdescr_app_setTitle",a,r);return e.create_app_setTitle(n)};n.create_app_setSubTitle=function(a,r){if(!r){r={"":a};a={}}var n=t("appdescr_app_setSubTitle",a,r);return e.create_app_setSubTitle(n)};n.create_app_setShortTitle=function(a,r){if(!r){r={"":a};a={}}var n=t("appdescr_app_setShortTitle",a,r);return e.create_app_setShortTitle(n)};n.create_app_setDescription=function(a,r){if(!r){r={"":a};a={}}var n=t("appdescr_app_setDescription",a,r);return e.create_app_setDescription(n)};n.create_app_setInfo=function(a,r){if(!r){r={"":a};a={}}var n=t("appdescr_app_setInfo",a,r);return e.create_app_setInfo(n)};n.create_app_setAch=function(a){var r=t("appdescr_app_setAch",a);return e.create_app_setAch(r)};n.create_app_setDestination=function(a){var r=t("appdescr_app_setDestination",a);return e.create_app_setDestination(r)};n.create_app_setKeywords=function(a,r){var n=t("appdescr_app_setKeywords",a,r);return e.create_app_setKeywords(n)};n.create_app_addTechnicalAttributes=function(a){var r=t("appdescr_app_addTechnicalAttributes",a);return e.create_app_addTechnicalAttributes(r)};n.create_app_removeTechnicalAttributes=function(a){var r=t("appdescr_app_removeTechnicalAttributes",a);return e.create_app_removeTechnicalAttributes(r)};n.create_app_addCdsViews=function(a){var r=t("appdescr_app_addCdsViews",a);return e.create_app_addCdsViews(r)};n.create_app_removeCdsViews=function(a){var r=t("appdescr_app_removeCdsViews",a);return e.create_app_removeCdsViews(r)};n.create_flp_setConfig=function(a){var r=t("appdescr_flp_setConfig",a);return e.create_flp_setConfig(r)};n.create_ui5_addNewModel=function(a){var r=t("appdescr_ui5_addNewModel",a);return e.create_ui5_addNewModel(r)};n.create_ui5_removeModel=function(a){var r=t("appdescr_ui5_removeModel",a);return e.create_ui5_removeModel(r)};n.create_ui5_addNewModelEnhanceWith=function(a,r){var n=t("appdescr_ui5_addNewModelEnhanceWith",a,r);return e.create_ui5_addNewModelEnhanceWith(n)};n.create_ui5_replaceComponentUsage=function(a){var r=t("appdescr_ui5_replaceComponentUsage",a);return e.create_ui5_replaceComponentUsage(r)};n.create_ui5_addLibraries=function(a){var r=t("appdescr_ui5_addLibraries",a);return e.create_ui5_addLibraries(r)};n.create_ui5_setMinUI5Version=function(a){var r=t("appdescr_ui5_setMinUI5Version",a);return e.create_ui5_setMinUI5Version(r)};n.create_smb_addNamespace=function(a){var r=t("appdescr_smb_addNamespace",a);return e.create_smb_addNamespace(r)};n.create_smb_changeNamespace=function(a){var r=t("appdescr_smb_changeNamespace",a);return e.create_smb_changeNamespace(r)};n.create_ui_generic_app_setMainPage=function(a,r){var n=t("appdescr_ui_generic_app_setMainPage",a,r);return e.create_ui_generic_app_setMainPage(n)};n.create_ui_setIcon=function(a){var r=t("appdescr_ui_setIcon",a);return e.create_ui_setIcon(r)};n.create_ui_setDeviceTypes=function(a){var r=t("appdescr_ui_setDeviceTypes",a);return e.create_ui_setDeviceTypes(r)};n.create_url_setUri=function(a){var r=t("appdescr_url_setUri",a);return e.create_url_setUri(r)};n.create_fiori_setRegistrationIds=function(a){var r=t("appdescr_fiori_setRegistrationIds",a);return e.create_fiori_setRegistrationIds(r)};n.create_ui5_setFlexExtensionPointEnabled=function(a){var r=t("appdescr_ui5_setFlexExtensionPointEnabled",a);return e.create_ui5_setFlexExtensionPointEnabled(r)};n.create_fiori_setAbstract=function(a){var r=t("appdescr_fiori_setAbstract",a);return e.create_fiori_setAbstract(r)};return n});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/descriptorRelated/api/DescriptorVariantFactory", ["sap/ui/fl/write/_internal/appVariant/AppVariantFactory"],function(e){"use strict";var r={};r.createNew=function(e){return r.createAppVariant(e)};r.createAppVariant=function(r){return e.prepareCreate(r)};r.createForExisting=function(r){return e.prepareUpdate({id:r})};r.createDeletion=function(r){return e.prepareDelete({id:r})};return r});
/*
 * ! OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/variants/VariantManager", ["sap/base/util/restricted/_difference","sap/base/util/merge","sap/base/util/ObjectPath","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Element","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/flexState/FlexObjectState","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/write/_internal/controlVariants/ControlVariantWriteUtils","sap/ui/fl/write/_internal/flexState/changes/UIChangeManager","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/write/api/ContextBasedAdaptationsAPI","sap/ui/fl/Layer","sap/ui/fl/Utils"],function(e,n,a,t,r,i,c,o,l,s,f,p,g,u,d,v,m,C,R){"use strict";var h={};function V(e){const n=R.getAppComponentForControl(e);return n.getModel(p.getVariantModelName())}function y(e,n){const a=e.map(e=>e.getId());return f.getDirtyFlexObjects(n).filter(function(e){return a.includes(e.getId())&&!e.getSavedToVariant()})}async function x(e){var n=y(e.changes,e.reference);n=n.reverse();if(e.revert){await c.revertMultipleChanges(n,{appComponent:e.appComponent,modifier:t,reference:e.reference})}v.deleteFlexObjects({reference:e.reference,flexObjects:n})}function F(e,n,a){const t=s.waitForVariantSwitch(n,a).catch(function(){}).then(e);s.setVariantSwitchPromise(n,a,t);return t}async function w(e,n,a,t){if(!t._bDesignTimeMode){const r=await v.saveFlexObjects({flexObjects:e,selector:a});if(r){const e=r.response.find(e=>e.fileType==="ctrl_variant");const a=t.oData[n].variants.find(n=>n.key===e.fileName);const i=a.instance.getSupportInformation();i.user=e.support.user;a.instance.setSupportInformation(i)}t.invalidateMap()}}function b(e,n,a){var t={layer:e,control:n,reference:a};var r=m.hasAdaptationsModel(t);return r&&m.getDisplayedAdaptationId(t)}h.handleSelectVariant=function(e,n){return F(async function(e,n){var t=n.model;var r=n.vmReference;var i=false;var c=a.get([r,"modified"],t.oData);var o=e.key;var l=e.key;if(a.get([r,"currentVariant"],t.oData)&&t.oData[r].currentVariant!==o){l=t.oData[r].currentVariant;i=true;await t.updateCurrentVariant({variantManagementReference:r,newVariantReference:o,appComponent:t.oAppComponent,internallyCalled:true})}if(c){var f=s.getControlChangesForVariant({reference:t.sFlexReference,vmReference:r,vReference:l});await x({changes:f,reference:t.sFlexReference,vmReference:r,vReference:l,appComponent:t.oAppComponent,revert:!i})}if(!i){t.callVariantSwitchListeners(r,t.oData[r].currentVariant)}}.bind(null,e.getParameters(),n),n.model,n.vmReference)};h.handleManageEvent=async function(n,a,t){const r=a.variantManagementReference;if(!t.getData()){return}const{changes:i,variantsToBeDeleted:c}=t._collectModelChanges(r,C.USER,n);if(!i.length&&!c.length){return}if(i.some(e=>e.visible===false&&e.variantReference===t.getCurrentVariantReference(r))){const e=n.getParameter("def")||s.getDefaultVariantReference({reference:t.sFlexReference,vmReference:r});await t.updateCurrentVariant({variantManagementReference:r,newVariantReference:e})}i.forEach(function(e){e.appComponent=t.oAppComponent});const o=h.addVariantChanges(r,i);const f=c.map(e=>{const n=s.getVariant({reference:t.sFlexReference,vmReference:r,vReference:e});if(n.layer===C.USER){return u.deleteVariant(t.sFlexReference,r,e)}return[]}).flat();const p=[...e(o,f),...f.filter(e=>e.getState()!==l.LifecycleState.NEW)];const g=Object.values(C).reverse();for(const e of g){const n=p.filter(n=>n.getLayer()===e);if(n.length>0){await v.saveFlexObjects({flexObjects:n,selector:t.oAppComponent})}}};h.handleSaveEvent=async function(e,a,r){var i=R.getAppComponentForControl(e);r||=V(e);var c=r.getLocalId(e.getId(),i);var l;await F(async function(e,a,i){var c=r.getCurrentVariantReference(e);var f=s.getControlChangesForVariant({reference:r.sFlexReference,vmReference:e,vReference:c});if(i.overwrite){l=y(f,r.sFlexReference);if(r.getVariant(c,e).layer===C.PUBLIC){l.forEach(e=>e.setLayer(C.PUBLIC))}const n=await v.saveFlexObjects({flexObjects:l,selector:a});r.invalidateMap();return n}var p=i.layer||(i.public?C.PUBLIC:C.USER);var g=i.layer||C.USER;var u=i.newVariantReference||R.createDefaultFileName("flVariant");var d={variantManagementReference:e,appComponent:a,layer:p,title:i.name,contexts:i.contexts,sourceVariantReference:c,newVariantReference:u,generator:i.generator,additionalVariantChanges:[],adaptationId:b(g,a,r.sFlexReference),executeOnSelection:i.execute};var m={content:{},reference:r.sFlexReference,generator:d.generator,layer:g,adaptationId:d.adaptationId};if(i.def){var V=n({changeType:"setDefault",content:{defaultVariant:u},fileType:"ctrl_variant_management_change",selector:t.getSelector(e,d.appComponent)},m);d.additionalVariantChanges.push(o.createVariantManagementChange(V))}const F=await h.copyVariant(d);l=F;await x({changes:f,reference:r.sFlexReference,vmReference:e,vReference:c,appComponent:a});return w(l,e,a,r)}.bind(r,c,i,a),r,c);return l};h.addAndApplyChangesOnVariant=function(e,n){const a=V(n);const c=d.addDirtyChanges(a.sFlexReference,e,a.oAppComponent);return c.reduce(async function(e,n){await e;const c=r.getElementById(t.getControlIdBySelector(n.getSelector(),a.oAppComponent));const o=await i.applyChangeOnControl(n,c,{modifier:t,appComponent:a.oAppComponent,view:R.getViewForControl(c)});if(!o.success){var l=o.error||new Error("The change could not be applied.");v.deleteFlexObjects({reference:a.sFlexReference,flexObjects:[n]});throw l}},Promise.resolve())};h.eraseDirtyChangesOnVariant=async function(e,n,a){const t=g.getFlexReference({element:a});var r=s.getControlChangesForVariant({reference:t,vmReference:e,vReference:n});var i=y(r,t);await x({changes:r,reference:t,vmReference:e,vReference:n,appComponent:R.getAppComponentForControl(a),revert:true});return i};h.copyVariant=async function(e){const n=V(e.appComponent);var a=n._duplicateVariant(e);a.generator=e.generator;n.oData[e.variantManagementReference].variants.push({key:a.instance.getId(),rename:true,change:true,remove:true,sharing:e.layer===C.USER?n.sharing.PRIVATE:n.sharing.PUBLIC});var t=[];if(e.layer===C.PUBLIC){a.instance.setFavorite(false);var r={variantId:e.newVariantReference,changeType:"setFavorite",fileType:"ctrl_variant_change",generator:e.generator,layer:C.USER,reference:n.sFlexReference,content:{favorite:true}};t.push(o.createVariantChange(r))}t=v.addDirtyFlexObjects(n.sFlexReference,t.concat([a.instance].concat(a.controlChanges).concat(e.additionalVariantChanges)));await n.updateCurrentVariant({variantManagementReference:e.variantManagementReference,newVariantReference:a.instance.getId(),appComponent:e.appComponent,internallyCalled:true,scenario:"saveAs"});return t};h.removeVariant=async function(e){const n=V(e.appComponent);var a=f.getDirtyFlexObjects(n.sFlexReference).filter(function(n){return n.getVariantReference&&n.getVariantReference()===e.variant.getId()||n.getId()===e.variant.getId()});await n.updateCurrentVariant({variantManagementReference:e.variantManagementReference,newVariantReference:e.sourceVariantReference,appComponent:e.component});v.deleteFlexObjects({reference:n.sFlexReference,flexObjects:a})};h.addVariantChange=function(e,n){const a=V(n.appComponent);var t=h.createVariantChange(e,n);v.addDirtyFlexObjects(a.sFlexReference,[t]);return t};h.addVariantChanges=function(e,n){const a=V(n[0].appComponent);var t=n.map(function(n){return h.createVariantChange(e,n)});v.addDirtyFlexObjects(a.sFlexReference,t);return t};h.deleteVariantChange=function(e,n,a){const t=V(n.appComponent);t.setVariantProperties(e,n);v.deleteFlexObjects({reference:t.sFlexReference,flexObjects:[a]})};h.createVariantChange=function(e,n){const a=V(n.appComponent);var r=a.setVariantProperties(e,n);var i={changeType:n.changeType,layer:n.layer,generator:n.generator,reference:a.sFlexReference};if(n.adaptationId!==undefined){i.adaptationId=n.adaptationId}else{i.adaptationId=b(n.layer,n.appComponent,a.sFlexReference)}let c;if(n.changeType==="setDefault"){i.fileType="ctrl_variant_management_change";i.selector=t.getSelector(e,n.appComponent);c=o.createVariantManagementChange(i)}else{i.fileType="ctrl_variant_change";i.variantId=n.variantReference;c=o.createVariantChange(i)}c.setContent(r);if(n.changeType==="setTitle"){c.setText("title",n.title,"XFLD")}return c};h.manageVariants=function(e,n,a,t,r){const i=V(e);return new Promise(function(c){e.attachEventOnce("manage",{resolve:c,variantManagementReference:n,layer:a},i.fnManageClickRta,i);e.openManagementDialog(true,t,r)})};h.getDirtyChangesFromVariantChanges=function(e,n){return y(e,n)};h.updateVariantManagementMap=function(e){s.getVariantManagementMap().checkUpdate({reference:e})};h.getControlChangesForVariant=function(e,n,a){return s.getVariant({reference:e,vmReference:n,vReference:a}).controlChanges};return h});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/SaveAs", ["sap/base/util/restricted/_omit","sap/base/util/merge","sap/base/Log","sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes","sap/ui/fl/apply/_internal/flexState/FlexObjectState","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/write/_internal/appVariant/AppVariantFactory","sap/ui/fl/write/_internal/appVariant/AppVariantInlineChangeFactory","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/Layer","sap/ui/fl/Utils"],function(e,t,r,n,a,i,c,s,o,u,l,p,f){"use strict";function g(e){return s.getInstance().then(function(t){if(!e.package&&(e.layer===p.VENDOR||e.layer===p.CUSTOMER_BASE&&!t.getIsAtoEnabled())){return Promise.reject("Package must be provided or is valid")}if(e.isForSmartBusiness&&(e.package!=="$TMP"&&e.package!=="")&&!e.transport&&!t.getIsAtoEnabled()){return Promise.reject("Transport must be provided")}if(e.isForSmartBusiness&&e.transport||e.package==="$TMP"){return Promise.resolve({packageName:e.package,transport:e.transport})}return Promise.resolve({packageName:"",transport:""})})}function h(e,t){var r=t.transport?e.setTransportRequest(t.transport):Promise.resolve();return r.then(function(){if(t.packageName){return e.setPackage(t.packageName)}return Promise.resolve()})}function d(e){var t=[];e.forEach(function(e){var r={changeType:e.getChangeType(),content:e.getContent()};if(e.getTexts()){r.texts=e.getTexts()}t.push(u.createNew(r))});return Promise.all(t)}function m(e,t){var r={reference:t.getId()};var n=f.createNamespace(r,"changes");var a=e.getFlexObjectMetadata();a.namespace=n;a.reference=t.getId();e.setFlexObjectMetadata(a)}function A(e,t){var r=[];e.forEach(function(e){e.replaceHostingIdForTextKey(t.getId(),t.getReference(),e.getContent(),e.getTexts());r.push(t.addDescriptorInlineChange(e))});return Promise.all(r)}function v(e){const t=i.getFlexReferenceForSelector(e);return a.getDirtyFlexObjects(t).filter(function(e){return n.getChangeTypes().includes(e.getChangeType())})}function y(e){const t=i.getFlexReferenceForSelector(e);return a.getDirtyFlexObjects(t).slice()}function _(e){const t=i.getFlexReferenceForSelector(e);var r=[];v(e).forEach(function(e){if(n.getChangeTypes().includes(e.getChangeType())){r.push(e)}});l.deleteFlexObjects({reference:t,flexObjects:r})}function P(e,t){if(!e){throw new Error(`App variant with ID: ${t.id}does not exist`)}t.package=e.getPackage();t.layer=e.getDefinition().layer;return g(t).then(function(t){return h(e,t)}).then(function(){return e})}var F={saveAs(e){var a;var i;return o.prepareCreate(e).then(function(r){a=t({},r);return g(e)}).then(function(e){return h(a,e)}).then(function(){var t=[];y(e.selector).forEach(function(e){if(n.getChangeTypes().includes(e.getChangeType())){t.push(e)}else{m(e,a)}});return d(t)}).then(function(e){return A(e,a)}).then(function(){return a.submit().catch(function(e){e.messageKey="MSG_SAVE_APP_VARIANT_FAILED";throw e})}).then(function(r){i=t({},r);_(e.selector);var n=y(e.selector);if(n.length){return l.saveFlexObjects({selector:e.selector,skipUpdateCache:true}).then(function(){const t=c.getFlexReference({element:e.selector});l.removeDirtyFlexObjects({reference:t})}).catch(function(t){return this.deleteAppVariant({id:e.id}).then(function(){t.messageKey="MSG_COPY_UNSAVED_CHANGES_FAILED";throw t})}.bind(this))}return Promise.resolve()}.bind(this)).then(function(){return i}).catch(function(t){if(v(e.selector).length){_(e.selector)}r.error("the app variant could not be created.",t.message||t);throw t})},updateAppVariant(a){var i;var c;return o.prepareUpdate(e(a,"selector")).catch(function(e){e.messageKey="MSG_LOAD_APP_VARIANT_FAILED";throw e}).then(function(e){if(!e){throw new Error(`App variant with ID: ${a.id}does not exist`)}i=t({},e);a.package=i.getPackage();a.layer=i.getDefinition().layer;return g(a)}).then(function(e){return h(i,e)}).then(function(){var e=[];v(a.selector).forEach(function(t){if(n.getChangeTypes().includes(t.getChangeType())){e.push(t)}});return d(e)}).then(function(e){return A(e,i)}).then(function(){return i.submit().catch(function(e){if(a.isForSmartBusiness){_(a.selector);throw e}e.messageKey="MSG_UPDATE_APP_VARIANT_FAILED";throw e})}).then(function(e){c=t({},e);_(a.selector);return c}).catch(function(e){if(v(a.selector).length){_(a.selector)}r.error("the app variant could not be updated.",e.message||e);throw e})},deleteAppVariant(t){return o.prepareDelete(e(t,"selector")).catch(function(e){e.messageKey="MSG_LOAD_APP_VARIANT_FAILED";throw e}).then(function(e){return t.isForSmartBusiness?Promise.resolve(e):P(e,t)}).then(function(e){return e.submit().catch(function(e){if(e==="cancel"){return Promise.reject("cancel")}e.messageKey="MSG_DELETE_APP_VARIANT_FAILED";throw e})}).catch(function(e){if(e==="cancel"){return Promise.reject("cancel")}r.error("the app variant could not be deleted.",e.message||e);throw e})}};return F});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/Storage", ["sap/base/util/ObjectPath","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/VersionInfo"],function(e,t,n,r){"use strict";var a="sap/ui/fl/write/_internal/connectors/";function i(){return n.getConnectors(a,false)}function o(e,t){var n=t.filter(function(t){return t.layers.indexOf("ALL")!==-1||t.layers.indexOf(e)!==-1});if(n.length===1){return n[0]}if(n.length===0){throw new Error(`No Connector configuration could be found to write into layer: ${e}`)}if(n.length>1){throw new Error("sap.ui.core.Configuration 'flexibilityServices' has a misconfiguration: Multiple "+`Connector configurations were found to write into layer: ${e}`)}return undefined}function s(e){if(!e){return Promise.reject("No layer was provided")}return i().then(o.bind(this,e))}function u(e){if(e.draft){return new Promise(function(t,n){sap.ui.require(["sap/ui/fl/write/api/FeaturesAPI"],function(r){r.isVersioningEnabled(e.layer).then(function(r){if(r){t()}else{n(`Draft is not supported for the given layer: ${e.layer}`)}})})})}return Promise.resolve()}function c(e,n){var r=n.filter(function(n){return n.getState()===t.LifecycleState.NEW&&n.getFileType()===e.getFileType()});var a=r.findIndex(function(t){return t.getId()===e.getId()});return a}async function d(e){var n;if(e.allChanges&&e.allChanges.length&&e.condensedChanges){await l(e.condensedChanges);n={namespace:e.allChanges[0].convertToFileContent().namespace,layer:e.layer};var r=0;var a=false;e.reference||=e.allChanges[0].convertToFileContent().reference;e.allChanges.forEach(function(i,o){var s=i.getFileType();var u=c(i,e.condensedChanges);if(i.condenserState){var d=false;if(i.condenserState==="delete"){if(i.getState()===t.LifecycleState.PERSISTED||i.getState()===t.LifecycleState.DELETED){n.delete||={};n.delete[s]||=[];n.delete[s].push(i.getId())}r++}else if(e.condensedChanges.length){d=e.allChanges[o].getId()!==e.condensedChanges[o-r].getId()}if((i.condenserState==="select"&&i.getState()!==t.LifecycleState.NEW||i.condenserState==="update")&&d&&!a){var l=e.condensedChanges.slice(o-r).map(function(e){return e.getId()});n.reorder||={};n.reorder[s]||=[];n.reorder[s]=l;a=true}if(i.condenserState==="select"&&i.getState()===t.LifecycleState.NEW){n.create||={};n.create[s]||=[];n.create[s][u]={};n.create[s][u][i.getId()]=i.convertToFileContent()}else if(i.condenserState==="update"){n.update||={};n.update[s]||=[];var f=n.update[s].length;n.update[s][f]={};n.update[s][f][i.getId()]={content:i.getContent()}}delete i.condenserState}else if(i.getState()===t.LifecycleState.NEW){n.create||={};n.create[s]||=[];n.create[s][u]={};n.create[s][u][i.getId()]=i.convertToFileContent()}})}return n}async function l(e){const t=await r.load();const n=t.version;e.forEach(e=>{if(e.isA&&e.isA("sap.ui.fl.apply._internal.flexObjects.FlexObject")){const t=e.getSupportInformation();t.sapui5Version||=n;e.setSupportInformation(t)}else{e.support||={};e.support.sapui5Version||=n}})}function f(t,n){return u(n).then(s.bind(undefined,n.layer)).then(function(r){n.url=r.url;var a=e.get(t,r.writeConnectorModule);return a.call(r.writeConnectorModule,n)})}var p={};p.write=async function(e){await l(e.flexObjects);return f("write",e)};p.condense=async function(e){const t={...e};const n=await d(t);if(!n){return Promise.reject("No changes were provided")}if(n.create||n.reorder||n.update||n.delete){let e=[];if(n.create){e=(n.create.change?n.create.change:[]).concat(n.create.ctrl_variant?n.create.ctrl_variant:[])}t.flexObjects=n;const r=await f("condense",t);if(r&&r.status&&r.status===205&&e.length){const t=e.map(function(e){return Object.values(e).pop()});r.response=t}else if(r&&r.status&&r.status===200){r.response=r.response.flexObjects}return r}return undefined};p.remove=function(e){return f("remove",e)};p.update=function(e){return f("update",e)};p.reset=function(e){return f("reset",e)};p.getFlexInfo=function(e){return f("getFlexInfo",e)};p.getSeenFeatureIds=function(e){return f("getSeenFeatureIds",e)};p.setSeenFeatureIds=function(e){return f("setSeenFeatureIds",e)};p.deleteUserVariantsForVM=function(e){return f("deleteUserVariantsForVM",e)};p.getContexts=function(e){return f("getContexts",e)};p.loadContextDescriptions=function(e){return f("loadContextDescriptions",e)};p.publish=function(e){return f("publish",e)};p.contextBasedAdaptation={create(e){return i().then(f.bind(undefined,"contextBasedAdaptation.create",e))},reorder(e){return i().then(f.bind(undefined,"contextBasedAdaptation.reorder",e))},update(e){return i().then(f.bind(undefined,"contextBasedAdaptation.update",e))},load(e){return i().then(f.bind(undefined,"contextBasedAdaptation.load",e))},remove(e){return i().then(f.bind(undefined,"contextBasedAdaptation.remove",e))}};p.versions={load(e){return i().then(f.bind(undefined,"versions.load",e))},activate(e){return i().then(f.bind(undefined,"versions.activate",e))},discardDraft(e){return i().then(f.bind(undefined,"versions.discardDraft",e))},publish(e){return i().then(f.bind(undefined,"versions.publish",e))}};p.translation={getSourceLanguages(e){return i().then(f.bind(undefined,"translation.getSourceLanguages",e))},getTexts(e){return i().then(f.bind(undefined,"translation.getTexts",e))},postTranslationTexts(e){return i().then(f.bind(undefined,"translation.postTranslationTexts",e))}};return p});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/Versions", ["sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/fl/initial/api/Version","sap/ui/fl/write/_internal/Storage","sap/ui/fl/write/api/FeaturesAPI","sap/ui/model/json/JSONModel","sap/ui/model/BindingMode"],function(e,r,n,t,i,s){"use strict";var a={};var o=9;var l=o+1;function d(e){var n=p(e);n.setDefaultBindingMode(s.OneWay);n.setSizeLimit(o);n.setDirtyChanges=function(e){n.setProperty("/dirtyChanges",e);n.updateDraftVersion();n.updateBindings(true)};n.updateDraftVersion=function(){var e=n.getProperty("/versions");var t=n.getProperty("/versioningEnabled");var i=n.getProperty("/dirtyChanges");var s=n.getProperty("/backendDraft");var a=t&&(i||s);n.setProperty("/draftAvailable",a);if(i){n.setProperty("/displayedVersion",r.Number.Draft)}if(!u(e)&&a){e.splice(0,0,{version:r.Number.Draft,type:r.Type.Draft,filenames:[],isPublished:false})}if(u(e)&&!a){e.shift();n.setProperty("/displayedVersion",n.getProperty("/persistedVersion"))}var o=n.getProperty("/displayedVersion")!==n.getProperty("/activeVersion");n.setProperty("/activateEnabled",o)};return n}function f(e,n){if(n!==r.Number.Original&&n!==r.Number.Draft){return e.some(function(e){return e.version===n&&e.isPublished===false})}return false}function p(n){var t;var s=r.Number.Original;var a=n.versions;var o=n.versionsModel;var l=u(a);var d=[];if(a.length>0){t=a[0].version}else{t=r.Number.Original}a.forEach(function(e){if(e.version===r.Number.Draft){e.type=r.Type.Draft;e.isPublished=false;d=e.filenames}else if(s===r.Number.Original){e.type=r.Type.Active;s=e.version}else{e.type=r.Type.Inactive}});if(o){o.setProperty("/publishVersionEnabled",f(a,t));o.setProperty("/versioningEnabled",n.versioningEnabled);o.setProperty("/versions",a);o.setProperty("/backendDraft",l);o.setProperty("/dirtyChanges",false);o.setProperty("/draftAvailable",l);o.setProperty("/activateEnabled",l);o.setProperty("/activeVersion",s);o.setProperty("/persistedVersion",t);o.setProperty("/displayedVersion",t);o.setProperty("/draftFilenames",d);o.updateBindings(true)}else{var p=e.getByReference(n.reference);return new i({publishVersionEnabled:f(a,p.version||t),versioningEnabled:n.versioningEnabled,versions:a,backendDraft:l,dirtyChanges:false,draftAvailable:l,activateEnabled:l,activeVersion:s,persistedVersion:p.version||t,displayedVersion:p.version||t,draftFilenames:d})}return o}function u(e){return e.some(function(e){return e.version===r.Number.Draft})}function v(e,r){e.setProperty("/backendDraft",false);e.setProperty("/dirtyChanges",false);e.setProperty("/draftAvailable",false);e.setProperty("/activateEnabled",false);e.setProperty("/displayedVersion",r);e.setProperty("/persistedVersion",r);e.updateBindings(true)}var c={};c.initialize=async function(e){var r=e.reference;var i=e.layer;e.limit=l;const s=await t.isVersioningEnabled(i);if(a&&a[r]&&a[r][i]){return a[r][i]}var o=s?n.versions.load(e):Promise.resolve([]);return o.then(function(r){e.versioningEnabled=s;e.versions=r;return d(e)}).then(function(e){a[r]||={};a[r][i]||={};a[r][i]=e;return a[r][i]})};c.getVersionsModel=function(e){var r=e.reference;var n=e.layer;if(!c.hasVersionsModel(e)){throw Error(`Versions Model for reference '${r}' and layer '${n}' were not initialized.`)}return a[r][n]};c.hasVersionsModel=function(e){var r=e.reference;var n=e.layer;return!!(a[r]&&a[r][n])};c.clearInstances=function(){a={}};c.updateAfterSave=async function(e){const r={reference:e.reference,layer:e.layer};if(e.backendResponse?.response?.length>0){const n=e.backendResponse.response.map(e=>e.fileName);r.draftFilenames=n;c.onAllChangesSaved(r)}else{await c.updateModelFromBackend(r)}};c.updateModelFromBackend=function(e){if(c.hasVersionsModel(e)&&c.getVersionsModel(e).getProperty("/versioningEnabled")){e.limit=l;return n.versions.load(e).then(function(r){var n=c.getVersionsModel(e);e.versioningEnabled=n.getProperty("/versioningEnabled");e.versions=r;e.versionsModel=n;return p(e)})}return undefined};c.onAllChangesSaved=function(n){const t=c.getVersionsModel(n);const i=t.getProperty("/versioningEnabled");const s=t.getProperty("/dirtyChanges");const a=t.getProperty("/draftFilenames");t.setProperty("/draftFilenames",a.concat(n.draftFilenames));t.setProperty("/dirtyChanges",true);t.setProperty("/backendDraft",i&&s||!!n.contextBasedAdaptation);t.updateDraftVersion();t.setProperty("/persistedVersion",r.Number.Draft);t.updateBindings(true);const o=e.getByReference(n.reference);o.version=r.Number.Draft;e.setByReference(o,n.reference)};c.activate=function(e){var t=c.getVersionsModel(e);var i=t.getProperty("/versions");var s=u(i);var a=t.getProperty("/activeVersion");if(e.displayedVersion===a){return Promise.reject("Version is already active")}e.version=e.displayedVersion;return n.versions.activate(e).then(function(e){i.forEach(function(e){e.type=r.Type.Inactive});e.type=r.Type.Active;e.isPublished=false;if(s){i.shift()}i.splice(0,0,e);t.setProperty("/activeVersion",e.version);t.setProperty("/publishVersionEnabled",true);t.setProperty("/draftFilenames",[]);v(t,e.version)})};c.discardDraft=function(e){var r=c.getVersionsModel(e);var t=r.getProperty("/backendDraft");var i=t?n.versions.discardDraft(e):Promise.resolve();return i.then(function(){var n=r.getProperty("/versions");n.shift();let i=r.getProperty("/activeVersion");if(e.discardDraftAndKeepActiveVersion){i=r.getProperty("/displayedVersion")}v(r,i);return{backendChangesDiscarded:t}})};c.publish=function(e){var r=c.getVersionsModel({reference:e.reference,layer:e.layer});return n.versions.publish(e).then(function(n){if(n!=="Error"&&n!=="Cancel"){r.setProperty("/publishVersionEnabled",false);var t=r.getProperty("/versions");var i=false;t.forEach(function(r){if(r.isPublished){return}if(r.version===e.version){i=true}if(i&&!r.isPublished){r.isPublished=true}})}return n})};return c});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/appVariant/AppVariant", ["sap/ui/base/ManagedObject","sap/ui/fl/descriptorRelated/Utils","sap/ui/fl/write/_internal/connectors/LrepConnector","sap/base/util/merge","sap/base/Log","sap/base/util/isPlainObject"],function(e,i,t,n,o,r){"use strict";var s=e.extend("sap.ui.fl.write._internal.appVariant.AppVariant",{constructor:function(i){e.apply(this);if(!r(i)){o.error("Constructor : sap.ui.fl.write._internal.appVariant.AppVariant: mPropertyBag is not defined")}this._oDefinition=i;return this},metadata:{library:"sap.ui.fl",properties:{mode:{type:"string"}}}});s.modes={NEW:"NEW",EXISTING:"EXISTING",DELETION:"DELETION"};s.prototype._isValidMode=function(e){var i=false;Object.keys(s.modes).some(function(t){if(s.modes[t]===e){i=true}});return i};s.prototype.setMode=function(e){if(this._isValidMode(e)){this.setProperty("mode",e)}else{throw new Error("Provide a correct operation mode")}};s.prototype.setTransportRequest=function(e){try{i.checkTransportRequest(e)}catch(e){return Promise.reject(e)}this._oDefinition.transport=e;return Promise.resolve()};s.prototype.setReference=function(e){if(e===undefined||typeof e!=="string"){throw new Error("No parameter sReference of type string provided")}this._oDefinition.reference=e};s.prototype.setPackage=function(e){try{i.checkPackage(e)}catch(e){return Promise.reject(e)}this._oDefinition.packageName=e;return Promise.resolve()};s.prototype.getDefinition=function(){return this._oDefinition};s.prototype.getId=function(){return this._oDefinition.id};s.prototype.getParsedHash=function(){return this._oDefinition.parsedHash};s.prototype.getNamespace=function(){return this._oDefinition.namespace||i.getNameAndNameSpace(this._oDefinition.id,this._oDefinition.reference).namespace};s.prototype.getFileName=function(){return this._oDefinition.fileName||i.getNameAndNameSpace(this._oDefinition.id,this._oDefinition.reference).fileName};s.prototype.getReference=function(){return this._oDefinition.reference};s.prototype.getPackage=function(){return this._oDefinition.packageName};s.prototype.getVersion=function(){return this._oDefinition.version};s.prototype.getTransportRequest=function(){return this._oDefinition.transport};s.prototype.getJson=function(){return n({},this._getMap())};s.prototype._getMap=function(){var e={};switch(this.getMode()){case s.modes.NEW:e={fileName:this.getFileName(),fileType:"appdescr_variant",namespace:this.getNamespace(),layer:this._oDefinition.layer,packageName:this._oDefinition.packageName?this._oDefinition.packageName:"",reference:this._oDefinition.reference,id:this._oDefinition.id,content:this._oDefinition.content||[]};if(this._oDefinition.referenceVersion){e.referenceVersion=this._oDefinition.referenceVersion}if(this._oDefinition.version){e.version=this._oDefinition.version}break;case s.modes.EXISTING:e={fileName:this._oDefinition.fileName,fileType:this._oDefinition.fileType,namespace:this._oDefinition.namespace,layer:this._oDefinition.layer,packageName:this._oDefinition.packageName,reference:this._oDefinition.reference,id:this._oDefinition.id,content:this._oDefinition.content};if(this._oDefinition.referenceVersion){e.referenceVersion=this._oDefinition.referenceVersion}if(this._oDefinition.version){e.version=this._oDefinition.version}break;case s.modes.DELETION:e={id:this._oDefinition.id};break;default:}return e};s.prototype.addDescriptorInlineChange=function(e){return new Promise(function(i){var t=function(e,i){if(e.setHostingIdForTextKey){e.setHostingIdForTextKey(i)}};t(e,this.getId());this._oDefinition.content.push(e.getMap());i(null)}.bind(this))};s.prototype.submit=function(){var e=this._getMap();var i={flexObject:{},appVariant:this};if(this._oDefinition.transport){i.transport=this._oDefinition.transport}if(this._oDefinition.skipIam){i.skipIam=this._oDefinition.skipIam}if(this._oDefinition.isForSmartBusiness){i.isForSmartBusiness=this._oDefinition.isForSmartBusiness}if(this._oDefinition.parentVersion){i.parentVersion=this._oDefinition.parentVersion}if(this._oDefinition.parsedHash){i.parsedHash=this._oDefinition.parsedHash}if(e.layer){i.layer=e.layer}i.url="/sap/bc/lrep";var n;switch(this.getMode()){case s.modes.NEW:Object.assign(i.flexObject,e);n=t.appVariant.create(i);break;case s.modes.EXISTING:i.reference=e.id;Object.assign(i.flexObject,e);n=t.appVariant.update(i);break;case s.modes.DELETION:i.reference=e.id;n=t.appVariant.remove(i);break;default:return Promise.reject("Please provide a valid operation.")}return n.then(function(e){return e})};return s});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/appVariant/AppVariantFactory", ["sap/ui/fl/write/_internal/appVariant/AppVariant","sap/ui/fl/Layer","sap/ui/fl/descriptorRelated/Utils","sap/ui/fl/write/_internal/connectors/LrepConnector","sap/base/util/merge","sap/base/util/isPlainObject"],function(e,r,t,n,a,i){"use strict";function s(e){e.url||="/sap/bc/lrep";return n.appVariant.load(e)}var p={};p.load=function(r){if(r.id===undefined||typeof r.id!=="string"){throw new Error(`Parameter ${r.id} must be provided of type string`)}return s({reference:r.id}).then(function(t){var n=t.response;if(!i(n)){n=JSON.parse(n)}r=a({},r,n);return new e(r)})};p.prepareCreate=function(n){try{t.checkParameterAndType(n,"reference","string");t.checkParameterAndType(n,"id","string");if(n.parsedHash){t.checkParameterAndType(n,"parsedHash","object")}if(n.version){t.checkParameterAndType(n,"version","string")}if(!n.layer){n.layer=r.CUSTOMER}else{t.checkParameterAndType(n,"layer","string")}if(n.skipIam){t.checkParameterAndType(n,"skipIam","boolean")}if(n.transport){t.checkTransportRequest(n.transport)}if(n.package){t.checkPackage(n.package)}}catch(e){return Promise.reject(e)}n.content=[];var a=new e(n);a.setMode("NEW");return Promise.resolve(a)};p.prepareUpdate=function(e){return p.load(e).then(function(e){e.setMode("EXISTING");return e})};p.prepareDelete=function(r){return(r.isForSmartBusiness?Promise.resolve(new e(r)):p.load(r)).then(function(e){e.setMode("DELETION");return e})};return p});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/appVariant/AppVariantInlineChange", ["sap/ui/base/ManagedObject","sap/ui/fl/descriptorRelated/Utils","sap/base/Log","sap/base/util/isPlainObject"],function(t,i,e,n){"use strict";var o=t.extend("sap.ui.fl.write._internal.appVariant.AppVariantInlineChange",{metadata:{library:"sap.ui.fl"},constructor:function(o){t.apply(this);if(!n(o)){e.error("Constructor : sap.ui.fl.write._internal.appVariant.AppVariantInlineChange: mPropertyBag is not defined")}i.checkTexts(o.texts);this._oDefinition=o;return this}});o.prototype._getChangeType=function(){return this._oDefinition.changeType};o.prototype.getMap=function(){return this._oDefinition};o.prototype.getContent=function(){return this._oDefinition.content};o.prototype.getTexts=function(){return this._oDefinition.texts};o.prototype.getHostingIdSuffix=function(){return this._sHostingIdSuffix};o.prototype.setHostingIdSuffix=function(t){this._sHostingIdSuffix=t};o.prototype.replaceHostingIdForTextKey=function(t,i,e,n){var o=JSON.stringify(e);if(n){Object.keys(n).forEach(function(e){var n;if(e.indexOf(i)===0){n=t+e.substring(i.length);this._oDefinition.texts[n]=this._oDefinition.texts[e];delete this._oDefinition.texts[e];o=o.split(`{{${e}}}`).join(`{{${n}}}`)}},this);this._oDefinition.content=JSON.parse(o)}};o.prototype.setHostingIdForTextKey=function(t){if(this.getHostingIdSuffix()){var i=t+this.getHostingIdSuffix();if(this._oDefinition.texts){this._oDefinition.texts[i]=this._oDefinition.texts[""];delete this._oDefinition.texts[""]}}};return o});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/appVariant/AppVariantInlineChangeFactory", ["sap/ui/fl/descriptorRelated/Utils","sap/ui/fl/Utils","sap/ui/fl/write/_internal/appVariant/AppVariantInlineChange"],function(e,t,n){"use strict";function r(e){if(!e.texts){e.texts={"":e.content};e.content={}}}function c(e){var t=new n(e);return Promise.resolve(t)}var a={};a.createNew=function(e){var t=new n(e);return Promise.resolve(t)};a.createDescriptorInlineChange=function(e){var t=e.changeType.replace("appdescr","create");if(!this[t]){throw new Error(`Change type '${e.changeType}' is not supported`)}return this[t](e)};a.create_ovp_addNewCard=function(t){e.checkParameterAndType(t.content,"card","object");return c(t)};a.create_ovp_removeCard=function(t){e.checkParameterAndType(t.content,"cardId","string");return c(t)};a.create_ovp_changeCard=function(t){e.checkParameterAndType(t.content,"cardId","string");e.checkEntityPropertyChange(t.content);return c(t)};a.create_app_addNewInbound=function(t){e.checkParameterAndType(t.content,"inbound","object");return c(t)};a.create_app_removeInbound=function(t){e.checkParameterAndType(t.content,"inboundId","string");return c(t)};a.create_app_removeAllInboundsExceptOne=function(t){e.checkParameterAndType(t.content,"inboundId","string");return c(t)};a.create_app_changeInbound=function(t){e.checkParameterAndType(t.content,"inboundId","string");e.checkEntityPropertyChange(t.content);return c(t)};a.create_app_addNewOutbound=function(t){e.checkParameterAndType(t.content,"outbound","object");return c(t)};a.create_app_removeOutbound=function(t){e.checkParameterAndType(t.content,"outboundId","string");return c(t)};a.create_app_changeOutbound=function(t){e.checkParameterAndType(t.content,"outboundId","string");e.checkEntityPropertyChange(t.content);return c(t)};a.create_app_addNewDataSource=function(t){e.checkParameterAndType(t.content,"dataSource","object");return c(t)};a.create_app_removeDataSource=function(t){e.checkParameterAndType(t.content,"dataSourceId","string");return c(t)};a.create_app_changeDataSource=function(t){e.checkParameterAndType(t.content,"dataSourceId","string");e.checkEntityPropertyChange(t.content);return c(t)};var o={BEGINNING:"BEGINNING",END:"END"};a.create_app_addAnnotationsToOData=function(t){e.checkParameterAndType(t.content,"dataSourceId","string");e.checkParameterAndType(t.content,"annotations","array");e.checkParameterAndType(t.content,"dataSource","object");return c(t)};a.create_app_setTitle=function(e){r(e);return c(e).then(function(e){e.setHostingIdSuffix("_sap.app.title");return e})};a.create_app_setSubTitle=function(e){r(e);return c(e).then(function(e){e.setHostingIdSuffix("_sap.app.subTitle");return e})};a.create_app_setShortTitle=function(e){r(e);return c(e).then(function(e){e.setHostingIdSuffix("_sap.app.shortTitle");return e})};a.create_app_setDescription=function(e){r(e);return c(e).then(function(e){e.setHostingIdSuffix("_sap.app.description");return e})};a.create_app_setInfo=function(e){r(e);return c(e).then(function(e){e.setHostingIdSuffix("_sap.app.info");return e})};a.create_app_setAch=function(t){e.checkParameterAndType(t.content,"ach","string");return c(t)};a.create_app_setDestination=function(t){e.checkParameterAndType(t.content,"destination","object");return c(t)};a.create_app_setKeywords=function(t){e.checkParameterAndType(t.content,"keywords","array");return c(t)};a.create_app_addTechnicalAttributes=function(t){e.checkParameterAndType(t.content,"technicalAttributes","array");return c(t)};a.create_app_removeTechnicalAttributes=function(t){e.checkParameterAndType(t.content,"technicalAttributes","array");return c(t)};a.create_app_addCdsViews=function(t){e.checkParameterAndType(t.content,"cdsViews","array");return c(t)};a.create_app_removeCdsViews=function(t){e.checkParameterAndType(t.content,"cdsViews","array");return c(t)};a.create_flp_setConfig=function(t){e.checkParameterAndType(t.content,"config","object");return c(t)};a.create_ui5_addNewModel=function(t){e.checkParameterAndType(t.content,"model","object");return c(t)};a.create_ui5_removeModel=function(t){e.checkParameterAndType(t.content,"modelId","string");return c(t)};a.create_ui5_addNewModelEnhanceWith=function(t){e.checkParameterAndType(t.content,"modelId","string");return c(t)};a.create_ui5_replaceComponentUsage=function(t){e.checkParameterAndType(t.content,"componentUsageId","string");e.checkParameterAndType(t.content,"componentUsage","object");return c(t)};a.create_ui5_addLibraries=function(t){e.checkParameterAndType(t.content,"libraries","object");return c(t)};a.create_ui5_addComponentUsages=function(t){e.checkParameterAndType(t.content,"componentUsages","object");return c(t)};a.create_ui5_setMinUI5Version=function(t){e.checkParameterAndType(t.content,"minUI5Version",["string","array"]);return c(t)};a.create_smb_addNamespace=function(t){e.checkParameterAndType(t.content,"smartBusinessApp","object");return c(t)};a.create_smb_changeNamespace=function(t){e.checkParameterAndType(t.content,"smartBusinessApp","object");return c(t)};a.create_ui_generic_app_setMainPage=function(t){e.checkParameterAndType(t.content,"page","object");return c(t)};a.create_ui_setIcon=function(t){e.checkParameterAndType(t.content,"icon","string");return c(t)};a.create_ui_setDeviceTypes=function(t){e.checkParameterAndType(t.content,"deviceTypes","object");return c(t)};a.create_url_setUri=function(t){e.checkParameterAndType(t.content,"uri","string");return c(t)};a.create_fiori_setRegistrationIds=function(t){e.checkParameterAndType(t.content,"registrationIds","array");return c(t)};a.create_ui5_setFlexExtensionPointEnabled=function(t){e.checkParameterAndType(t.content,"flexExtensionPointEnabled","boolean");e.checkParameterAndType(t,"changeType","string");return c(t)};a.create_ui5_changeModel=function(t){e.checkParameterAndType(t.content,"modelId","string");e.checkEntityPropertyChange(t.content);return c(t)};a.create_fiori_setAbstract=function(t){e.checkParameterAndType(t.content,"abstract","boolean");e.checkParameterAndType(t,"changeType","string");return c(t)};a.create_fe_changePageConfiguration=function(t){e.checkParameterAndType(t.content,"page","string");e.checkEntityPropertyChange(t.content);return c(t)};a.create_fe_addNewPage=function(t){e.checkParameterAndType(t.content.sourcePage,"id","string");e.checkParameterAndType(t.content.sourcePage,"navigationSource","string");e.checkParameterAndType(t.content.targetPage,"id","string");e.checkParameterAndType(t.content.targetPage,"type","string");e.checkParameterAndType(t.content.targetPage,"name","string");e.checkParameterAndType(t.content.targetPage,"routePattern","string");e.checkParameterAndType(t.content.targetPage,"settings","object");e.checkParameterAndType(t.content.targetPage.settings,"contextPath","string");e.checkParameterAndType(t.content.targetPage.settings,"pageLayout","string");e.checkParameterAndType(t.content.targetPage.settings,"controlConfiguration","object");return c(t)};a.create_ui_generic_app_changePageConfiguration=function(n){e.checkParameterAndType(n.content,"parentPage","object");e.checkEntityPropertyChange(n.content);return c(n).then(function(e){e.fileName=t.createDefaultFileName("appdescr_ui_gen_app_changePageConfig");return Promise.resolve(e)})};a.create_ui_generic_app_addNewObjectPage=function(t){e.checkParameterAndType(t.content,"parentPage","object");e.checkChildPageChange(t.content);return c(t)};return a});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/Condenser", ["sap/base/util/restricted/_isEqual","sap/base/util/each","sap/base/util/isPlainObject","sap/base/util/ObjectPath","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Element","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/apply/_internal/flexObjects/FlexObject","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UIChange","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/write/_internal/condenser/classifications/LastOneWins","sap/ui/fl/write/_internal/condenser/classifications/Reverse","sap/ui/fl/write/_internal/condenser/classifications/Update","sap/ui/fl/write/_internal/condenser/UIReconstruction","sap/ui/fl/write/_internal/condenser/Utils","sap/ui/fl/Utils","sap/ui/performance/Measurement"],function(e,t,n,a,s,o,r,i,c,f,l,d,u,p,g,C,h,E,y){"use strict";const _={};const S="unclassified";const I={lastOneWins:u,reverse:p,update:g};const O=["affectedControl","sourceContainer","targetContainer","updateControl"];function N(e,t){const n=e[d.Move];return t.classification===d.Create&&n&&n[n.length-1].targetContainer===t.targetContainer}function D(e,t){return t.classification===d.Move&&e[d.Destroy]}function T(e,t){return t.classification===d.Create&&e[d.Destroy]}async function v(e,t,n,a){if(!D(e,n)&&!T(e,n)){const t=n.classification;if(!e[t]){n.change=a;a.condenserState="select";e[t]=[n]}else{a.condenserState="delete"}e[t][0].updateChange=a}else{a.condenserState="delete"}if(N(e,n)||T(e,n)){if(e[d.Move]){e[d.Move].forEach(e=>{e.change.condenserState="delete"});delete e[d.Move]}if(e[d.Destroy]){e[d.Destroy].forEach(e=>{e.change.condenserState="delete"});delete e[d.Destroy]}}await C.addChange(t,n)}function m(e,t,n){e[t.classification]||={};const a=e[t.classification];I[t.classification].addToChangesMap(a,t,n)}async function A(e,t,n,a,s){e[a.type]||={};const o=e[a.type];if(a.type===h.NOT_INDEX_RELEVANT){m(o,a,s)}else{n.push(s);o[a.targetAggregation]||={};await v(o[a.targetAggregation],t,a,s)}}function R(e,t,n){e[t]||=[];e[t].push(n);n.condenserState="select"}async function w(e,t){let n;let a=false;const s={modifier:o,appComponent:e};try{if(t instanceof l){const c=o.getControlIdBySelector(t.getSelector(),e);const f=r.getElementById(c);if(f){s.view=E.getViewForControl(f);const e=i.getControlIfTemplateAffected(t,f,s);a=e.bTemplateAffected;n=await i.getChangeHandler({flexObject:t,control:e.control,controlType:e.controlType,modifier:s.modifier})}}else{n=await i.getChangeHandler({flexObject:t})}if(typeof n.getCondenserInfo==="function"){const e=await n.getCondenserInfo(t,s);if(e&&a){x(e,t)}return e}}catch(e){return undefined}return undefined}function x(e,t){const n=t.getOriginalSelector();const a=t.getSelector();O.forEach(t=>{if(e[t]&&e[t]===a){e[t]=n}})}function b(e,t,n,s){const o=n.getIdForCondensing(t,s);e[o]||={};if(t&&t.updateControl){const n=t.updateControl;const s=[h.NOT_INDEX_RELEVANT,d.Update,t.uniqueKey];const r=a.get(s,e[n]);if(r){a.set(s,r,e[o]);delete e[n][h.NOT_INDEX_RELEVANT][d.Update][t.uniqueKey]}}return e[o]}async function L(e,t,n,a,s){for(const o of s){await U(e,t,n,a,o)}}async function U(e,t,n,a,s){const o=await w(e,s);j(o,e);const r=b(t,o,s,e);if(o!==undefined){M(o);await A(r,n,a,o,s);if(o.update){V(r,o,s)}}else{R(r,S,s);t[S]=true}}function M(e){if(I[e.classification]){e.type=h.NOT_INDEX_RELEVANT}else{e.type=h.INDEX_RELEVANT}}function j(e,t){O.forEach(n=>{if(e&&e[n]){e[n]=o.getControlIdBySelector(e[n],t)}})}function V(e,t,n){const s=[h.NOT_INDEX_RELEVANT,d.Update,t.uniqueKey];const o=a.get(s,e);if(o){o.change.condenserState="delete";if(n.condenserState==="delete"){return}if(n.isPersisted()){n.condenserState="update"}t.update(n,o.updateContent);n.setState(f.LifecycleState.UPDATED);delete e[h.NOT_INDEX_RELEVANT][d.Update][t.uniqueKey]}}function X(e,a){t(e,(t,s)=>{if(I[t]&&I[t].getChangesFromMap){I[t].getChangesFromMap(e,t).forEach(e=>{a.push(e)})}else if(n(s)){return X(s,a)}else if(Array.isArray(s)){s.forEach(e=>{if(e instanceof c){a.push(e)}else{a.push(e.change)}})}});return a}function q(e){return X(e,[])}function F(e,t){Object.values(e).forEach(e=>{if(n(e)){F(e,t)}else if(Array.isArray(e)){e.forEach(e=>{if(!(e instanceof c)){t.push(e)}})}});return t}function P(e,t){t.sort((t,n)=>e.indexOf(t)-e.indexOf(n))}function B(e,t){t.sort((t,n)=>e.indexOf(t.change)-e.indexOf(n.change))}function K(e,t){const n=e.map(e=>e.getId());t.forEach(t=>{if(n.indexOf(t.getId())===-1){e.push(t)}})}function W(e){for(const t in e){for(const n of["lastOneWins","update"]){const s=a.get([t,h.NOT_INDEX_RELEVANT,n],e);if(s){for(const e of Object.values(s)){if(e.oldestChange?.getRevertData){e.change.setRevertData(e.oldestChange.getRevertData())}}}}}}function H(t,n,a){t.forEach(t=>{const s=t.updateChange;if(s&&!e(s.getContent(),t.change.getContent())&&s.getState()!==f.LifecycleState.NEW){const e=t.change;if(s.getId()!==e.getId()){const t=e.getContent();s.setContent(t);s.setRevertData(e.getRevertData());e.condenserState="delete";n=n.map(t=>{if(t.getId()===e.getId()){return s}return t});const o=t=>{if(t.getId()===e.getId()){return s}return t};a.forEach((e,t)=>{a[t]=e.map(o)})}else{s.setState(f.LifecycleState.UPDATED)}s.condenserState="update"}});return n}_.condense=async function(e,t){y.start("Condenser_overall","Condenser overall - CondenserClass",["sap.ui.fl","Condenser"]);const n={};const a={};const o=[];const r=[];const i=[];t.slice(0).reverse().forEach(e=>{if(e.getState()===f.LifecycleState.DELETED){e.condenserState="delete"}else if(e.canBeCondensed()){i.push(e)}else{r.push(e)}});y.start("Condenser_defineMaps","defining of maps - CondenserClass",["sap.ui.fl","Condenser"]);await L(e,n,a,o,i);y.end("Condenser_defineMaps");W(n);const c=n[S];if(!c){C.compareAndUpdate(n,a)}let l=q(n);if(c){o.forEach(e=>{if(e.condenserState!=="update"){e.condenserState="select"}});K(l,o)}l=l.concat(r);P(t,l);if(!c){y.start("Condenser_handleIndexRelatedChanges","handle index related changes - CondenserClass",["sap.ui.fl","Condenser"]);let e=true;let r=F(n,[]);B(t,r);let i;try{y.start("Condenser_sort","sort index related changes - CondenserClass",["sap.ui.fl","Condenser"]);i=C.sortIndexRelatedChanges(a,r)}catch(t){s.error(`Error during Condensing: ${t.message}`,"No Condensing performed for index-relevant changes.");e=false}y.end("Condenser_sort");if(e){l=l.filter(e=>e.condenserState!=="delete");r=r.filter(e=>e.change.condenserState!=="delete");l=H(r,l,i);P(t,l);i.forEach(e=>{C.swapChanges(e,l)})}else{o.forEach(e=>{e.condenserState="select"});K(l,o);P(t,l)}y.end("Condenser_handleIndexRelatedChanges")}y.end("Condenser_overall");return l};return _});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/UIReconstruction", ["sap/base/util/restricted/_isEqual","sap/base/util/each","sap/base/util/ObjectPath","sap/ui/fl/changeHandler/condenser/Classification","sap/ui/fl/write/_internal/condenser/classifications/Create","sap/ui/fl/write/_internal/condenser/classifications/Destroy","sap/ui/fl/write/_internal/condenser/classifications/Move","sap/ui/fl/write/_internal/condenser/Utils"],function(e,n,t,s,i,c,o,a){"use strict";const r={};const f={create:i,destroy:c,move:o};function l(e,t){n(e,(e,s)=>{n(s,(n,i)=>{t(s,e,i,n)})})}function u(e,n,t){e.splice(t,0,e.splice(n,1)[0])}function d(e,n){const t={};l(e,(e,s,i,c)=>{const o=i[a.TARGET_UI];const r=i[a.INITIAL_UI];n.forEach(e=>{const n=o.indexOf(e.affectedControl)>-1||r.indexOf(e.affectedControl)>-1;if(c===e.targetAggregation&&n){t[s]||={};const n=t[s];n[c]||=[];const i=n[c];i.push(e)}})});return t}function h(e){return!e.some(e=>e.classification!==s.Create)}function g(e){return!e.some(e=>a.isUnknown(e))}function I(e){return e.classification==="destroy"?-1:e.getTargetIndex(e.change)}function E(e){e.sort((e,n)=>{const t=I(e);const s=I(n);return t-s})}function T(e){return!e.some(e=>!a.isUnknown(e))}function p(n,t){let s;if(n.length<t.length){s=t.slice(n.length);if(!T(s)){return false}t=t.slice(0,n.length)}else if(n.length>t.length){s=n.slice(t.length,n.length);if(!T(s)){return false}n=n.slice(0,t.length)}return e(n,t)}function _(e,n,t,s,i){const c={};i.forEach(e=>{const s=e.targetContainer;c[s]||={};const i=c[s];i[n]||=a.initializeArrayWithPlaceholders(0,t.length-1);f[e.classification].simulate(i[n],e,t)});const o=c[e][n];if(p(s,o)){i.forEach(e=>{if(e.sameIndex){e.change.condenserState="delete"}});return true}return false}function A(e,n){function t(e,n){if(I(n)!==e){const t=n.change.getState();n.setTargetIndex(n.change,e);n.change.setState(t);if(n.change.isPersisted()){n.change.condenserState="update"}}}function i(n,i,c){c[a.TARGET_UI].forEach((n,i)=>{if(!a.isUnknown(n)){const c=e[n];const o=c[a.INDEX_RELEVANT];l(o,(e,n,c,o)=>{if(o!==s.Destroy){c.forEach(t.bind(this,i))}})}})}l(n,i)}function U(e,n){l(n,(n,t,s,i)=>{const c=s[a.INITIAL_UI];const o=s[a.TARGET_UI];if(p(c,o)){o.forEach(n=>{const t=e[n];if(t!==undefined){l(t[a.INDEX_RELEVANT],(e,n,t)=>{t.forEach(e=>{e.change.condenserState="delete"})});delete t[a.INDEX_RELEVANT]}});delete n[i]}})}function x(e,n){l(n,(n,s,i,c)=>{const o=i[a.INITIAL_UI];const r=i[a.TARGET_UI];o.forEach((n,s)=>{const i=e[n];if(!i||!t.get([a.INDEX_RELEVANT,c],i)){const e=a.PLACEHOLDER+s;const t=r.indexOf(n);if(t>=0){r[t]=e}}})})}r.swapChanges=function(e,n){const t=e.map(e=>n.indexOf(e)).sort();e.forEach(e=>{n[t.shift()]=e})};r.sortIndexRelatedChanges=function(e,n){const t=[];const s=d(e,n);l(s,(n,s,i,c)=>{const o=e[s][c][a.TARGET_UI];const r=e[s][c][a.INITIAL_UI];let f=true;if(g(o)||h(i)){E(i);f=_(s,c,r,o,i)}else if(!_(s,c,r,o,i)){f=false;let e=i.length;while(e!==0&&!f){let n=0;let t=1;while(t<i.length&&!f){u(i,n,t);f=_(s,c,r,o,i);n++;t++}e--}}if(!f){throw Error(`no correct sorting found for the container: ${s}`)}i=i.filter(e=>e.change.condenserState!=="delete");t.push(i.map(e=>{if(e.revertIndex>-1){e.setIndexInRevertData(e.change,e.revertIndex);e.sourceIndex=e.revertIndex}return e.change}))});return t};r.addChange=async function(e,n){await f[n.classification].addToReconstructionMap(e,n)};r.compareAndUpdate=function(e,n){U(e,n);x(e,n);A(e,n)};return r});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/Utils", ["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Element"],function(e,n){"use strict";const t={};t.TARGET_UI="targetUI";t.INITIAL_UI="initialUI";t.PLACEHOLDER="X";t.INDEX_RELEVANT="indexRelevant";t.NOT_INDEX_RELEVANT="notIndexRelevant";function i(e,n){return(Math.max(e,n)||0)+1}t.getInitialUIContainerElementIds=function(e,n,i,r){e[n]||={};const l=e[n];l[i]||={};const s=l[i];s[t.TARGET_UI]||=r;s[t.INITIAL_UI]||=r.slice(0);return s[t.INITIAL_UI]};t.getContainerElementIds=async function(t,i,r,l){const s=n.getElementById(t);const o=r||await e.getAggregation(s,i);return o.map(e=>l?e[l]:e.getId())};t.initializeArrayWithPlaceholders=function(e,n){const r=i(n,e);return Array(r).fill(t.PLACEHOLDER).map((e,n)=>e+n)};t.extendArrayWithPlaceholders=function(e,n,r){const l=i(n,r);if(e.length<l){let n;for(let i=e.length;i<=l;i++){n=t.PLACEHOLDER+e.length;e.splice(e.length,0,n)}}};t.extendElementsArray=function(e,n,i,r){t.extendArrayWithPlaceholders(e,n,i);const l=e.indexOf(r);const s=e.indexOf(t.PLACEHOLDER+n);if(l!==n&&n!==undefined){if(l>=0){t.shiftElement(e,l,n)}else if(s>-1){e[s]=r}else if(t.isUnknown(e[n])){e[n]=r}}};t.shiftElement=function(e,n,t){e.splice(t,0,e.splice(n,1)[0])};t.isUnknown=function(e){if(e!==undefined&&e.indexOf(t.PLACEHOLDER)===0){const n=e.slice(1,e.length);const t=parseInt(n);if(isNaN(t)){return false}return true}return false};return t});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Create", ["sap/ui/core/Element","sap/ui/fl/write/_internal/condenser/Utils"],function(t,e){"use strict";return{async addToReconstructionMap(n,a){const o=t.getElementById(a.affectedControl);const r=a.targetAggregation||o&&o.sParentAggregationName;const i=await e.getContainerElementIds(a.targetContainer,r,a.customAggregation,a.affectedControlIdProperty);const g=e.getInitialUIContainerElementIds(n,a.targetContainer,a.targetAggregation,i);const s=g.indexOf(a.affectedControl);if(s>-1){g.splice(s,1)}},simulate(t,e){t.splice(e.getTargetIndex(e.change),0,e.affectedControl)}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Destroy", ["sap/ui/fl/write/_internal/condenser/Utils"],function(e){"use strict";return{async addToReconstructionMap(t,n){const o=await e.getContainerElementIds(n.targetContainer,n.targetAggregation,n.customAggregation,n.affectedControlIdProperty);const r=e.getInitialUIContainerElementIds(t,n.targetContainer,n.targetAggregation,o);if(r.length-1<n.sourceIndex){while(r.length-1<n.sourceIndex){const t=r.length;r.splice(r.length,0,e.PLACEHOLDER+t)}r[n.sourceIndex]=n.affectedControl}else{r.splice(n.sourceIndex,0,n.affectedControl)}},simulate(t,n,o){let r=t.indexOf(n.affectedControl);if(r===-1){const i=e.PLACEHOLDER+o.indexOf(n.affectedControl);r=t.indexOf(i)}n.revertIndex=r;if(r>-1){t.splice(r,1)}}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/LastOneWins", [],function(){"use strict";return{addToChangesMap(e,n,t){if(!e[n.uniqueKey]){n.change=t;e[n.uniqueKey]=n;t.condenserState="select"}else{e[n.uniqueKey].oldestChange=t;t.condenserState="delete"}},getChangesFromMap(e,n){return Object.values(e[n]).map(e=>e.change)}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Move", ["sap/ui/fl/write/_internal/condenser/Utils"],function(e){"use strict";return{async addToReconstructionMap(t,n){const[r,o]=await Promise.all([e.getContainerElementIds(n.sourceContainer,n.sourceAggregation,n.customAggregation,n.affectedControlIdProperty),e.getContainerElementIds(n.targetContainer,n.targetAggregation,n.customAggregation,n.affectedControlIdProperty)]);let a;let i;if(n.targetContainer===n.sourceContainer&&n.targetAggregation===n.sourceAggregation){a=e.getInitialUIContainerElementIds(t,n.targetContainer,n.targetAggregation,o);i=a.indexOf(n.affectedControl);e.shiftElement(a,i,n.sourceIndex)}else{a=e.getInitialUIContainerElementIds(t,n.targetContainer,n.targetAggregation,o);i=a.indexOf(n.affectedControl);a.splice(i,1);a=e.getInitialUIContainerElementIds(t,n.sourceContainer,n.sourceAggregation,r);a.splice(n.sourceIndex,0,n.affectedControl)}},simulate(t,n,r){const o=n.affectedControl;const a=r.indexOf(o);e.extendElementsArray(t,a,undefined,o);const i=t.indexOf(o);const g=n.getTargetIndex(n.change);if(a===-1){t.splice(g,0,o)}else{t.splice(g,0,t.splice(i,1)[0])}n.sameIndex=i===g;n.revertIndex=i}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Reverse", ["sap/base/util/each"],function(e){"use strict";return{addToChangesMap(e,n,t){e[n.uniqueKey]||=[];e[n.uniqueKey].push(t)},getChangesFromMap(n,t){var a=[];e(n[t],function(e,n){n.reverse();var t;n.forEach(function(e,a){if(t&&t.getChangeType()!==e.getChangeType()){t=null;n[a].condenserState="delete";n[a-1].condenserState="delete"}else{t=e;if(a>0){n[a-1].condenserState="delete"}n[a].condenserState="select"}});if(t){a.push(t)}});return a}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/condenser/classifications/Update", [],function(){"use strict";return{addToChangesMap(e,n,t){if(!e[n.uniqueKey]){n.change=t;e[n.uniqueKey]=n;t.condenserState="select"}else{e[n.uniqueKey].oldestChange=t;t.condenserState="delete"}},getChangesFromMap(e,n){return Object.values(e[n]).map(e=>e.change)}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/BackendConnector", ["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/initial/_internal/connectors/BackendConnector","sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils","sap/base/util/restricted/_pick"],function(e,t,n,r,i,s){"use strict";function a(e){var t={};if(e.parentVersion!==undefined){t.parentVersion=e.parentVersion}if(this.isLanguageInfoRequired){r.addLanguageInfo(t)}var n=r.getUrl(this.ROUTES.CHANGES,e,t);delete e.fileName;delete t["sap-language"];var s=r.getUrl(this.ROUTES.TOKEN,e,t);var a=i.getRequestOptions(this.initialConnector,s,e.flexObjects||e.flexObject,"application/json; charset=utf-8","json");return i.sendRequest(n,e.method,a)}function o(e){e.fileName=e.flexObject.fileName;return a.call(this,e)}var l=e({},t,{xsrfToken:null,reset(e){var t=["reference","generator","layer"];var n=s(e,t);if(e.selectorIds){n.selector=e.selectorIds}if(e.changeTypes){n.changeType=e.changeTypes}delete e.reference;var a=r.getUrl(this.ROUTES.CHANGES,e,n);var o=r.getUrl(this.ROUTES.TOKEN,e);var l=i.getRequestOptions(this.initialConnector,o);return i.sendRequest(a,"DELETE",l)},write(e){e.method="POST";return a.call(this,e).then(function(e){if(e.response&&!Array.isArray(e.response)){e.response=[e.response]}return e})},update(e){e.method="PUT";return o.call(this,e)},remove(e){var t={namespace:e.flexObject.namespace};if(e.parentVersion!==undefined){t.parentVersion=e.parentVersion}e.fileName=e.flexObject.fileName;var n=r.getUrl(this.ROUTES.CHANGES,e,t);delete e.fileName;var s=r.getUrl(this.ROUTES.TOKEN,e);var a=i.getRequestOptions(this.initialConnector,s,undefined,"application/json; charset=utf-8","json");return i.sendRequest(n,"DELETE",a)}});l.initialConnector=n;return l});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/BtpServiceConnector", ["sap/base/util/merge","sap/ui/fl/Layer","sap/ui/fl/write/_internal/connectors/KeyUserConnector","sap/ui/fl/initial/_internal/connectors/BtpServiceConnector","sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils"],function(e,n,t,s,a,i){"use strict";const r=e({},t,{layers:[n.CUSTOMER,n.PUBLIC,n.USER],ROUTES:{CONDENSE:`${s.ROOT}/actions/condense`,CHANGES:`${s.ROOT}/changes`,SETTINGS:`${s.ROOT}/settings`,TOKEN:`${s.ROOT}/settings`,VERSIONS:{GET:`${s.ROOT}/versions`,ACTIVATE:`${s.ROOT}/versions/activate`,DISCARD:`${s.ROOT}/versions/draft`,PUBLISH:`${s.ROOT}/versions/publish`},TRANSLATION:{UPLOAD:`${s.ROOT}/translation/texts`,DOWNLOAD:`${s.ROOT}/translation/texts`,GET_SOURCELANGUAGE:`${s.ROOT}/translation/sourcelanguages`},CONTEXTS:`${s.ROOT}/contexts`,SEEN_FEATURES:`${s.ROOT}/seenFeatures`,DELETE_USER_VARIANTS:`${s.ROOT}/variantdata/delete`},async getSeenFeatureIds(e){const n=a.getUrl(this.ROUTES.SEEN_FEATURES,e);const t=await a.sendRequest(n,"GET",{initialConnector:s});return t.response?.seenFeatureIds},async setSeenFeatureIds(e){const n={seenFeatureIds:e.seenFeatureIds};const t=a.getUrl(this.ROUTES.SEEN_FEATURES,e);const r=await i.sendRequest(t,"PUT",{tokenUrl:this.ROUTES.TOKEN,initialConnector:s,payload:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8"});return r.response?.seenFeatureIds},condense(e){const n={};if(e.parentVersion!==undefined){n.parentVersion=e.parentVersion}if(this.isLanguageInfoRequired){a.addLanguageInfo(n)}const t=a.getUrl(this.ROUTES.CONDENSE,e,n);const r=i.getRequestOptions(s,this.ROUTES.TOKEN,e.flexObjects,"application/json; charset=utf-8","json");return i.sendRequest(t,"POST",r)},deleteUserVariantsForVM(e){const n={flexReference:e.flexReference,variantManagementReferences:e.variantManagementReferences};const t=a.getUrl(this.ROUTES.DELETE_USER_VARIANTS,e);return i.sendRequest(t,"POST",{tokenUrl:this.ROUTES.TOKEN,initialConnector:s,payload:JSON.stringify(n),dataType:"json",contentType:"application/json; charset=utf-8"})}});r.initialConnector=s;return r});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/JsObjectConnector", ["sap/base/util/merge","sap/ui/fl/write/api/connectors/ObjectStorageConnector"],function(e,t){"use strict";var r={_itemsStoredAsObjects:true,_items:{},setItem(e,t){r._items[e]=t},removeItem(e){delete r._items[e]},clear(){r._items={}},getItem(e){return r._items[e]},getItems(){return r._items}};var i=e({},t,{storage:r});i.loadFeatures=function(...r){return t.loadFeatures.apply(this,r).then(function(t){return e({isPublicLayerAvailable:true,isVariantAdaptationEnabled:true},t)})};return i});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/KeyUserConnector", ["sap/base/util/merge","sap/ui/core/Lib","sap/ui/fl/Layer","sap/ui/fl/write/_internal/connectors/BackendConnector","sap/ui/fl/initial/_internal/connectors/KeyUserConnector","sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/write/_internal/connectors/Utils","sap/base/util/restricted/_pick","sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/core/BusyIndicator","sap/base/Log","sap/m/MessageBox"],function(e,t,n,r,s,i,a,o,u,l,c,S){"use strict";var R="/flex/keyuser";var E=e({},r,{layers:[n.CUSTOMER,n.PUBLIC],ROUTES:{CHANGES:`${R+s.API_VERSION}/changes/`,SETTINGS:`${R+s.API_VERSION}/settings`,TOKEN:`${R+s.API_VERSION}/settings`,VERSIONS:{GET:`${R+s.API_VERSION}/versions/`,ACTIVATE:`${R+s.API_VERSION}/versions/activate/`,DISCARD:`${R+s.API_VERSION}/versions/draft/`,PUBLISH:`${R+s.API_VERSION}/versions/publish/`},TRANSLATION:{UPLOAD:`${R+s.API_VERSION}/translation/texts`,DOWNLOAD:`${R+s.API_VERSION}/translation/texts/`,GET_SOURCELANGUAGE:`${R+s.API_VERSION}/translation/sourcelanguages/`},CONTEXTS:`${R+s.API_VERSION}/contexts/`},isLanguageInfoRequired:true,getContexts(e){var t=["type","$skip","$filter"];var n=o(e,t);var r=i.getUrl(this.ROUTES.CONTEXTS,e,n);return i.sendRequest(r,"GET",{initialConnector:s}).then(function(e){return e.response})},loadContextDescriptions(e){var t={};i.addLanguageInfo(t);T.call(this,e);var n=i.getUrl(this.ROUTES.CONTEXTS,e,t);e.payload=JSON.stringify(e.flexObjects);e.dataType="json";e.contentType="application/json; charset=utf-8";return a.sendRequest(n,"POST",e).then(function(e){return e.response})},getFlexInfo(e){return u.getByReference(e.reference)}});function T(e){e.initialConnector=s;e.tokenUrl=this.ROUTES.TOKEN}function O(e){var t={title:e.title};e.payload=JSON.stringify(t);e.dataType="json";e.contentType="application/json; charset=utf-8"}function g(e){e.version=e.versionNumber.toString();delete e.versionNumber;return e}E.versions={load(e){T.call(this,e);var t={};i.addLanguageInfo(t);t.limit=e.limit;var n=i.getUrl(this.ROUTES.VERSIONS.GET,e,t);return i.sendRequest(n,"GET",e).then(function(e){return e.response.versions.map(function(e){return g(e)})})},activate(e){T.call(this,e);O(e);var t={version:e.version};i.addLanguageInfo(t);var n=i.getUrl(this.ROUTES.VERSIONS.ACTIVATE,e,t);return a.sendRequest(n,"POST",e).then(function(e){var t=e.response;return g(t)})},discardDraft(e){T.call(this,e);var t=i.getUrl(this.ROUTES.VERSIONS.DISCARD,e);return a.sendRequest(t,"DELETE",e)},publish(e){var n=t.getResourceBundleFor("sap.ui.fl");var r=function(t){l.hide();var r=n.getText("MSG_CF_PUBLISH_ERROR",t?[t.message||t]:undefined);var s=n.getText("HEADER_TRANSPORT_ERROR");c.error(`publish version error${t}`);S.show(r,{icon:S.Icon.ERROR,title:s,styleClass:e.styleClass});return"Error"};T.call(this,e);var s={version:e.version};var o=i.getUrl(this.ROUTES.VERSIONS.PUBLISH,e,s);return a.sendRequest(o,"POST",e).then(function(){l.hide();return n.getText("MSG_CF_PUBLISH_SUCCESS")}).catch(r)}};E.translation={getTexts(e){T.call(this,e);var t=o(e,["sourceLanguage","targetLanguage"]);var n=i.getUrl(this.ROUTES.TRANSLATION.DOWNLOAD,e,t);return i.sendRequest(n,"GET",e).then(function(e){return e.response})},getSourceLanguages(e){T.call(this,e);var t={};var n=i.getUrl(this.ROUTES.TRANSLATION.GET_SOURCELANGUAGE,e,t);return i.sendRequest(n,"GET",e).then(function(e){return e&&e.response&&e.response.sourceLanguages?e.response.sourceLanguages:[]})},postTranslationTexts(e){T.call(this,e);var t=i.getUrl(this.ROUTES.TRANSLATION.UPLOAD,e,{});return i.sendRequest(t,"POST",e)}};E.initialConnector=s;return E});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/LocalStorageConnector", ["sap/base/util/merge","sap/ui/fl/write/api/connectors/ObjectStorageConnector"],function(e,a){"use strict";var t=e({},a,{storage:window.localStorage});t.loadFeatures=function(...t){return a.loadFeatures.apply(this,t).then(function(a){return e({isPublicLayerAvailable:true,isPublicFlVariantEnabled:true,isVariantAdaptationEnabled:true,isCondensingEnabled:false},a)})};return t});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/LrepConnector", ["sap/base/util/merge","sap/ui/core/Lib","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/initial/_internal/connectors/LrepConnector","sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/write/_internal/connectors/Utils","sap/ui/fl/write/_internal/transport/TransportSelection","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/core/Component","sap/ui/core/BusyIndicator","sap/base/Log","sap/m/MessageBox","sap/base/util/restricted/_pick"],function(e,t,r,n,a,s,i,o,l,u,c,p,f,d,T){"use strict";var g={FLEX_INFO:"/flex/info/",PUBLISH:"/actions/make_changes_transportable/",CHANGES:"/changes/",CONDENSE:"/actions/condense/",VARIANTS:"/variants/",TOKEN:"/actions/getcsrftoken/",APPVARIANTS:"/appdescr_variants/",APPVARIANTS_OVERVIEW:"/app_variant_overview/",UI2PERSONALIZATION:"/ui2personalization/",CONTEXTS:"/flex/contexts/",VERSIONS:{GET:"/flex/versions/",ACTIVATE:"/flex/versions/activate/",DISCARD:"/flex/versions/draft/",PUBLISH:"/flex/versions/publish/"},CONTEXT_BASED_ADAPTATION:"/flex/apps/",MANI_FIRST_SUPPORTED:"/sap/bc/ui2/app_index/ui5_app_mani_first_supported",SEEN_FEATURES:"/seen_features/"};var E="/adaptations/";var v=function(e){var t;if(e.isLegacyVariant){t=g.VARIANTS}else if(e.isAppVariant){t=g.APPVARIANTS}else if(e.isContextSharing){t=g.CONTEXTS}else if(e.isCondensingEnabled){t=g.CONDENSE}else if(e.isContextBasedAdaptationEnabled){t=g.CONTEXT_BASED_ADAPTATION+e.appId+E}else{t=g.CHANGES}var r=e.transport?{changelist:e.transport}:{};if(e.skipIam){r.skipIam=e.skipIam}if(e.parentVersion){r.parentVersion=e.parentVersion}if(e.parsedHash){r.parsedHash=JSON.stringify(e.parsedHash)}a.addSAPLogonLanguageInfo(r);n._addClientInfo(r);if(e.flexObject&&!e.isAppVariant){e.fileName=e.flexObject.fileName}var s=a.getUrl(t,e,r);delete e.reference;delete e.fileName;var o=a.getUrl(g.TOKEN,e);var l=i.getRequestOptions(n,o,e.flexObjects||e.flexObject,"application/json; charset=utf-8","json");return i.sendRequest(s,e.method,l)};var O=function(e){var t=e.getDefinition().layer===l.VENDOR?e.getPackage():"";return{package:t,namespace:e.getNamespace(),name:e.getDefinition().fileName,type:e.getDefinition().fileType}};var R=function(e){var t;if(e.transport){t=Promise.resolve({transport:e.transport})}else if(e.isForSmartBusiness){return Promise.resolve()}else{var r=O(e.appVariant);t=(new o).openTransportSelection(r)}return t.then(function(e){if(e==="cancel"){return Promise.reject("cancel")}if(e&&e.transport!==undefined){return e.transport}return Promise.reject(new Error("Transport information could not be determined"))})};function S(e){e.version=e.versionId;delete e.versionId;return e}return e({},r,{initialConnector:n,layers:n.layers,reset(e){p.show(0);var t=[];var r=Promise.resolve();if(e.layer!==l.USER){t=e.changes;r=s.getInstance().then(function(r){if(!r.getIsProductiveSystem()){return(new o).setTransports(t,c.getComponentById(e.reference)).then(function(){t.some(function(t){if(t.getRequest()){e.changelist=t.getRequest();return true}return false})})}})}return r.then(function(){p.show(0);var t=["reference","layer","changelist","generator"];var r=T(e,t);n._addClientInfo(r);if(e.selectorIds){r.selector=e.selectorIds}if(e.changeTypes){r.changeType=e.changeTypes}delete e.reference;var s=a.getUrl(g.CHANGES,e,r);var o=a.getUrl(g.TOKEN,e);var l=i.getRequestOptions(n,o);return i.sendRequest(s,"DELETE",l).then(function(e){if(e&&e.response){e.response.forEach(function(e){e.fileName=e.name;delete e.name})}p.hide();return e}).catch(function(e){p.hide();return Promise.reject(e)})})},publish(e){var r=t.getResourceBundleFor("sap.ui.fl");var n=function(t){p.hide();var n=r.getText("MSG_TRANSPORT_ERROR",t?[t.message||t]:undefined);var a=r.getText("HEADER_TRANSPORT_ERROR");f.error(`transport error: ${t}`);d.show(n,{icon:d.Icon.ERROR,title:a,styleClass:e.transportDialogSettings.styleClass});return"Error"};var a=new o;return a.openTransportSelection(null,e.transportDialogSettings.rootControl,e.transportDialogSettings.styleClass).then(function(t){if(a.checkTransportInfo(t)){p.show(0);var n={reference:e.reference,layer:e.layer};return a._prepareChangesForTransport(t,e.localChanges,e.appVariantDescriptors,n).then(function(){p.hide();if(t.transport==="ATO_NOTIFICATION"){return r.getText("MSG_ATO_NOTIFICATION")}return r.getText("MSG_TRANSPORT_SUCCESS")})}return"Cancel"}).catch(n)},getFlexInfo(e){var t=["layer"];var r=T(e,t);n._addClientInfo(r);var s=a.getUrl(g.FLEX_INFO,e,r);return a.sendRequest(s,"GET",{initialConnector:n}).then(function(e){return e.response})},getContexts(e){var t=["type","$skip","$filter"];var r=T(e,t);n._addClientInfo(r);var s=a.getUrl(g.CONTEXTS,e,r);return a.sendRequest(s,"GET",{initialConnector:n}).then(function(e){return e.response})},loadContextDescriptions(e){e.method="POST";e.isContextSharing=true;return v(e).then(function(e){return e.response})},async getSeenFeatureIds(e){const t={};n._addClientInfo(t);const r=a.getUrl(g.SEEN_FEATURES,e,t);const s=await a.sendRequest(r,"GET",{initialConnector:n});return s.response?.seenFeatureIds||[]},async setSeenFeatureIds(e){const t={seenFeatureIds:e.seenFeatureIds};const r={};n._addClientInfo(r);const s=a.getUrl(g.SEEN_FEATURES,e,r);const o=a.getUrl(g.TOKEN,e);const l=i.getRequestOptions(n,o,t,"application/json; charset=utf-8","json");const u=await i.sendRequest(s,"PUT",l);return u.response?.seenFeatureIds},write(e){e.method="POST";return v(e)},condense(e){const t=e.flexObjects;const r={};function n(e,n,a,s,i){r[n]||={namespace:n,layer:t.layer};r[n][e]||={};r[n][e][a]||=[];if(e==="delete"||e==="reorder"){r[n][e][a].push(s)}else{r[n][e][a].push({[s]:i[s]||i})}}["create","reorder","update","delete"].forEach(r=>{const a=t[r];if(a){Object.keys(a).forEach(t=>{a[t].forEach(a=>{const s=a.fileName||(typeof a==="object"?Object.keys(a)[0]:a);var i=a[s]?.namespace||a[t]?.namespace;if(!i){const t=e.allChanges.find(e=>e.getId()===s);i=t?t.getNamespace():undefined}if(i){n(r,i,t,s,a)}})})}});e.flexObjects=Object.values(r);e.method="POST";e.isCondensingEnabled=true;return v(e)},update(e){if(e.flexObject.fileType==="variant"){e.isLegacyVariant=true}e.method="PUT";return v(e)},remove(e){var t={namespace:e.flexObject.namespace,layer:e.flexObject.layer};if(e.transport){t.changelist=e.transport}if(e.parentVersion){t.parentVersion=e.parentVersion}n._addClientInfo(t);e.fileName=e.flexObject.fileName;var r=e.flexObject.fileType==="variant"?g.VARIANTS:g.CHANGES;var s=a.getUrl(r,e,t);s=decodeURIComponent(s);delete e.fileName;var o=a.getUrl(g.TOKEN,e);var l=i.getRequestOptions(n,o,undefined,"application/json; charset=utf-8","json");return i.sendRequest(s,"DELETE",l)},appVariant:{getManifirstSupport(e){var t=`${g.MANI_FIRST_SUPPORTED}/?id=${e.appId}`;return a.sendRequest(t,"GET",{initialConnector:n}).then(function(e){return e.response})},getManifest(e){var t=e.appVarUrl;var r=i.getRequestOptions(n,u.getLrepUrl()+g.TOKEN,undefined,"application/json; charset=utf-8","json");return i.sendRequest(t,"GET",r)},load(e){var t=a.getUrl(g.APPVARIANTS,e);var r=i.getRequestOptions(n,u.getLrepUrl()+g.TOKEN,undefined,"application/json; charset=utf-8","json");return i.sendRequest(t,"GET",r)},create(e){e.method="POST";e.isAppVariant=true;return v(e)},assignCatalogs(e){var t={};t.action=e.action;delete e.action;t.assignFromAppId=e.assignFromAppId;delete e.assignFromAppId;var r=a.getUrl(g.APPVARIANTS,e,t);delete e.reference;var s=a.getUrl(g.TOKEN,e);var o=i.getRequestOptions(n,s,undefined,"application/json; charset=utf-8","json");return i.sendRequest(r,"POST",o)},unassignCatalogs(e){var t={};t.action=e.action;delete e.action;var r=a.getUrl(g.APPVARIANTS,e,t);delete e.reference;var s=a.getUrl(g.TOKEN,e);var o=i.getRequestOptions(n,s,undefined,"application/json; charset=utf-8","json");return i.sendRequest(r,"POST",o)},update(e){return R(e).then(function(t){if(t){e.transport=t}delete e.isForSmartBusiness;e.method="PUT";e.isAppVariant=true;return v(e)})},remove(e){return R(e).then(function(t){var r={};if(t){r.changelist=t}delete e.isForSmartBusiness;var s=a.getUrl(g.APPVARIANTS,e,r);delete e.reference;var o=a.getUrl(g.TOKEN,e);var l=i.getRequestOptions(n,o,undefined,"application/json; charset=utf-8","json");return i.sendRequest(s,"DELETE",l)})},list(e){var t={};t.layer=e.layer;t["sap.app/id"]=e.reference;delete e.layer;delete e.reference;var r=a.getUrl(g.APPVARIANTS_OVERVIEW,e,t);var s=i.getRequestOptions(n,undefined,undefined,"application/json; charset=utf-8","json");return i.sendRequest(r,"GET",s)}},contextBasedAdaptation:{create(e){e.isContextBasedAdaptationEnabled=true;e.method="POST";return v(e)},reorder(e){e.isContextBasedAdaptationEnabled=true;e.method="PUT";return v(e)},update(e){e.isContextBasedAdaptationEnabled=true;e.method="PUT";e.reference=e.adaptationId;return v(e)},load(e){var t=["version"];var r=T(e,t);n._addClientInfo(r);e.reference=e.appId+E;var s=a.getUrl(g.CONTEXT_BASED_ADAPTATION,e,r);return a.sendRequest(s,"GET",{initialConnector:n}).then(function(e){return e.response})},remove(e){e.isContextBasedAdaptationEnabled=true;e.method="DELETE";e.reference=e.adaptationId;return v(e)}},ui2Personalization:{create(e){e.initialConnector=this.initialConnector;var t=u.getLrepUrl();var r=i.getRequestOptions(n,t+g.TOKEN,e.flexObjects||e.flexObject,"application/json; charset=utf-8","json");var a=t+g.UI2PERSONALIZATION;return i.sendRequest(a,"PUT",r)},remove(e){e.initialConnector=this.initialConnector;var t=a.getUrl(g.UI2PERSONALIZATION,{url:u.getLrepUrl()},{reference:e.reference,containerkey:e.containerKey,itemname:e.itemName});return i.sendRequest(t,"DELETE")}},versions:{load(e){var t=i.getRequestOptions(n,a.getUrl(g.TOKEN,e));var r={};a.addSAPLogonLanguageInfo(r);r.limit=e.limit;var s=a.getUrl(g.VERSIONS.GET,e,r);return i.sendRequest(s,"GET",t).then(function(e){return e.response.versions.map(function(e){return S(e)})})},activate(e){var t=i.getRequestOptions(n,a.getUrl(g.TOKEN,e),{title:e.title},"application/json; charset=utf-8","json");var r={version:e.version};a.addSAPLogonLanguageInfo(r);var s=a.getUrl(g.VERSIONS.ACTIVATE,e,r);return i.sendRequest(s,"POST",t).then(function(e){var t=e.response;return S(t)})},discardDraft(e){var t=i.getRequestOptions(n,a.getUrl(g.TOKEN,e));var r=a.getUrl(g.VERSIONS.DISCARD,e);return i.sendRequest(r,"DELETE",t)},publish(e){var r=t.getResourceBundleFor("sap.ui.fl");var s=function(t){p.hide();var n=r.getText("MSG_TRANSPORT_ERROR",t?[t.message||t]:undefined);var a=r.getText("HEADER_TRANSPORT_ERROR");f.error(`transport error${t}`);d.show(n,{icon:d.Icon.ERROR,title:a,styleClass:e.styleClass});return"Error"};var l=new o;return l.openTransportSelection(null,e.rootControl,e.styleClass,false).then(function(t){if(l.checkTransportInfo(t)){p.show(0);if(!t.transport){return Promise.reject(new Error("no transport provided as attribute of mParameters"))}if(!e.reference){return Promise.reject(new Error("no reference provided as attribute of mParameters"))}if(!e.version){return Promise.reject(new Error("no version provided as attribute of mParameters"))}var s={transport:t.transport,version:e.version};var o=a.getUrl(g.VERSIONS.PUBLISH,{url:u.getLrepUrl(),reference:e.reference},s);var c=a.getUrl(g.TOKEN,{url:u.getLrepUrl()});var f=i.getRequestOptions(n,c,undefined,"application/json; charset=utf-8","json");return i.sendRequest(o,"POST",f).then(function(){p.hide();if(t.transport==="ATO_NOTIFICATION"){return r.getText("MSG_ATO_NOTIFICATION")}return r.getText("MSG_TRANSPORT_SUCCESS")})}return"Cancel"}).catch(s)}}})});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/NeoLrepConnector", ["sap/base/util/merge","sap/ui/fl/write/_internal/connectors/LrepConnector","sap/ui/fl/initial/_internal/connectors/NeoLrepConnector"],function(e,n,i){"use strict";return e({},n,{initialConnector:i,layers:i.layers})});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/ObjectPathConnector", ["sap/base/util/merge","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/initial/_internal/StorageUtils","sap/base/util/LoaderExtensions"],function(e,t,r,n){"use strict";var s;return e({},t,{layers:[],setJsonPath(e){s=e},loadFlexData(e){const t=s||e.path;if(t){return n.loadResource({dataType:"json",url:t,async:true}).then(function(e){return{...r.getEmptyFlexDataResponse(),...e}})}return Promise.resolve()},loadFeatures(e){var t=s||e.path;if(t){return n.loadResource({dataType:"json",url:t,async:true}).then(function(e,t){t.componentClassName=e;return t.settings||{}}.bind(null,e.flexReference))}return Promise.resolve({})},loadVariantsAuthors(){return Promise.resolve({})}})});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/ObjectStorageConnector", ["sap/base/util/merge","sap/ui/fl/write/api/connectors/ObjectStorageConnector"],function(e,t){"use strict";var r=e({},t,{oStorage:undefined});r.storage=r.oStorage;return r});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/PersonalizationConnector", ["sap/base/util/merge","sap/ui/fl/write/_internal/connectors/BackendConnector","sap/ui/fl/initial/_internal/connectors/PersonalizationConnector"],function(n,e,a){"use strict";var i="/flex/personalization";var r="/v1";var t=n({},e,{layers:a.layers,ROUTES:{CHANGES:`${i+r}/changes/`,TOKEN:`${i+r}/actions/getcsrftoken`}});t.initialConnector=a;return t});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/connectors/SessionStorageConnector", ["sap/base/util/merge","sap/ui/fl/write/api/connectors/ObjectStorageConnector"],function(e,t){"use strict";var a=e({},t,{storage:window.sessionStorage});a.loadFeatures=function(...a){return t.loadFeatures.apply(this,a).then(function(t){return e({isPublicLayerAvailable:true,isPublicFlVariantEnabled:true,isVariantAdaptationEnabled:true},t)})};return a});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/controlVariants/ControlVariantWriteUtils", ["sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/write/_internal/flexState/FlexObjectManager"],function(e,n,t){"use strict";const a={};a.deleteVariant=function(a,r,i){if(!n.getInstanceOrUndef()?.getIsCondensingEnabled()){return[]}const s={reference:a,vmReference:r,vReference:i};const c=e.getVariantManagementChanges(s);const l=e.getControlChangesForVariant({...s,includeReferencedChanges:false});const f=e.getVariant(s).instance;const o=e.getVariantChangesForVariant(s);const g=[f,...c,...o,...l];t.deleteFlexObjects({reference:a,flexObjects:g});return g};return a});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/delegates/ODataV2ReadDelegate", ["sap/ui/model/ListBinding"],function(e){"use strict";function t(e){return!!(e&&e.type&&e.type.toLowerCase().indexOf("edm")!==0)}function n(e,t){if(!e){return false}const n=e.getBindingInfo(t);const o=n&&n.path;if(!o){return false}return o.indexOf("/")===0}function o(e,t,n){let o;if(t){o=e.getBindingInfo(n);if(typeof o.model==="string"&&o.model!==""){o=undefined}}else{o=e.getBindingContext()}return o}function a(t,n,o,a){const i={name:t.name,bindingPath:t.name,entityType:n.name};const r=t["com.sap.vocabularies.Common.v1.Label"];i.label=r&&r.String;const s=t["com.sap.vocabularies.Common.v1.QuickInfo"];i.tooltip=s&&s.String;const c=t["com.sap.vocabularies.UI.v1.Hidden"];i.hideFromReveal=!!c&&c.Bool==="true";if(!i.hideFromReveal){const n=t["com.sap.vocabularies.Common.v1.FieldControl"];if(n&&n.EnumMember){i.hideFromReveal=n.EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"}else{const t=n&&n.Path;if(t){const n=o.getBinding(a)instanceof e;if(!n){const e=o.getBindingContext().getProperty(t);i.hideFromReveal=e===0}}}}return i}function i(e,n,o,i){const r=e.property.map(e=>e["sap:field-control"]).filter(Boolean);const s=e=>!r.includes(e.name);const c=e.property.map(r=>{const c=a(r,e,o,i);if(t(r)){const t=n.getODataComplexType(r.type);if(t){c.properties=t.property.map(t=>{const n=a(t,e,o,i);n.bindingPath=`${r.name}/${t.name}`;n.referencedComplexPropertyName=c.label||c.name;return n}).filter(s)}}return c});if(e.navigationProperty){const t=e.navigationProperty.map(t=>{const o=n.getODataAssociationEnd(e,t.name)?.type;return{name:t.name,entityType:o,bindingPath:t.name,unsupported:true}});c.push(...t)}return c.filter(s)}function r(e,t,a){if(a?.path){return a?.path}return n(e,t)?o(e,true,t)?.path:o(e,false,t)?.getPath()}async function s(e,t){const n=e.getModel(t?.modelName);if(n&&["sap.ui.model.odata.ODataModel","sap.ui.model.odata.v2.ODataModel"].includes(n.getMetadata().getName())){const e=n.getMetaModel();await e.loaded();return e}return null}function c(e,t){const n=e.getMetaContext(t);return n.getObject()}function l(e,t,n){const o=e.getMetadata().getAggregation();if(o){const a=e.getBindingInfo(o.name);const i=a&&a.template;if(i){const a=e.getBindingPath(o.name);const i=t.getODataAssociationEnd(n,a);const r=i&&i.type;if(r){const e=t.getODataEntityType(r);n=e}}}return n}async function m(e,t,n){const o=await s(e,n);let a=[];if(o){const s=r(e,t,n);if(s){let n=c(o,s);n=l(e,o,n);a=i(n,o,e,t)}}return a}var u={};u.getPropertyInfo=function(e){return m(e.element,e.aggregationName,e.payload)};return u});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/delegates/ODataV4ReadDelegate", ["sap/ui/base/Object"],function(e){"use strict";function a(e){if(e&&e.$Type){if(e.$Type.toLowerCase().indexOf("edm")!==0){return true}}return false}function t(e,a){return a.some(function(a){if(e.startsWith(a)){return true}})}function r(r,i,o,n,v,u,s){var l={name:r,bindingPath:r,entityType:n};var d=o["@com.sap.vocabularies.UI.v1.DataFieldDefault"];var p=d&&d.Label||o["@com.sap.vocabularies.Common.v1.Label"];l.label=p||`[LABEL_MISSING: ${r}]`;var c=o["@com.sap.vocabularies.UI.v1.Hidden"];l.hideFromReveal=c;if(c&&c.$Path){l.hideFromReveal=v.getBindingContext().getProperty(c.$Path)}var m;if(!l.hideFromReveal){m=o["@com.sap.vocabularies.Common.v1.FieldControl"];if(m){l.hideFromReveal=m.$EnumMember==="com.sap.vocabularies.Common.v1.FieldControlType/Hidden"}}m=o["@com.sap.vocabularies.Common.v1.FieldControl"];var f=m&&m.Path;if(f&&!l.hideFromReveal){var g=e.isObjectA(v.getBinding(u),"sap/ui/model/ListBinding");if(!g){var b=v.getBindingContext().getProperty(f);l.hideFromReveal=b===0}}if(d&&(d.$Type==="com.sap.vocabularies.UI.v1.DataFieldForAction"||d.$Type==="com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation"||d.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithAction"||d.$Type==="com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation")){l.unsupported=true}if(t(r,s)||a(i)){l.unsupported=true}return l}function i(e,a,t,i,o){var n=[];var v="";var u=[];var s;for(v in e){s=e[v];if(s.$kind==="NavigationProperty"){u.push(v)}}for(v in e){s=e[v];if(s.$kind==="Property"){var l=t.getObject(`/${a}/${v}@`);var d=r(v,s,l,a,i,o,u);n.push(d)}}return n}function o(e,a){if(a.path){return a.path}var t=e.getBindingContext();if(t){return t.getPath()}}function n(e,a,t){var r=e.getModel(t.modelName);if(r){if(r.isA("sap.ui.model.odata.v4.ODataModel")){var n=r.getMetaModel();var v=o(e,t);if(v){var u=n.getMetaContext(v);var s=u.getObject();var l=u.getObject(s.$Type);return i(l,s.$Type,n,e,a)}}}return Promise.resolve([])}var v={getPropertyInfo(e){return Promise.resolve().then(function(){return n(e.element,e.aggregationName,e.payload)})}};return v});
/*!
* OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.predefine("sap/ui/fl/write/_internal/extensionPoint/Processor", ["sap/ui/fl/apply/_internal/extensionPoint/Processor","sap/base/util/merge"],function(n,t){"use strict";function e(i,o){var r=t({defaultContent:[]},i);return n.registerExtensionPoint(r).then(n.createDefaultContent.bind(this,i,o,e,[])).then(n.addDefaultContentToExtensionPointInfo.bind(this,r,o))}var i={applyExtensionPoint(n){return e(n,false)}};return i});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/ABAPAccess", ["sap/ui/util/openWindow","sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariantFactory","sap/ui/fl/write/_internal/fieldExtensibility/ServiceValidation"],function(n,t,e){"use strict";var i=null;var r=null;function u(){if(!r){return t.getInstance(i).then(function(n){r=n;return n})}return Promise.resolve(r)}var o={};o.getTexts=function(){return u(i).then(function(n){return n.getTexts().then(function(n){return n})})};o.isExtensibilityEnabled=function(n){return u(n).then(function(n){return n.getNavigationUri().then(function(n){return Boolean(n)})})};o.getExtensionData=function(){return u(i).then(function(n){return n.getExtensionData().then(function(n){return n})})};o.onControlSelected=function(n){if(n!==i){i=n;r=null}};o.onTriggerCreateExtensionData=function(t,e,i){return u().then(function(t){return t.getNavigationUri(i).then(function(t){if(t){n(t,"_blank")}})})};o.reset=function(){i=null;r=null};o.isServiceOutdated=function(n){return e.isServiceOutdated(n)};o.setServiceValid=function(n){e.setServiceValid(n)};o.setServiceInvalid=function(n){e.setServiceInvalid(n)};return o},true);
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariant", ["sap/ui/base/Object"],function(e){"use strict";var t=e.extend("sap.ui.fl.write._internal.fieldExtensibility.ABAPExtensibilityVariant",{_sServiceUri:null,_mBindingInfo:null,_mServiceInfo:null,constructor:function(e,t,i){this._sServiceUri=e;this._mBindingInfo=i;this._mServiceInfo=t;this._oExtensionDataPromise=this._determineExtensionData()},getExtensionData(){return Promise.resolve(null)},getMetadata(){return this.getMetadata()},getNavigationUri(){return Promise.resolve(null)},getTexts(){return Promise.resolve(null)},isActive(){return Promise.resolve(true)}});t.prototype._determineExtensionData=function(){return Promise.resolve(null)};return t});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariantFactory", ["sap/base/Log","sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariant","sap/ui/fl/write/_internal/fieldExtensibility/MultiTenantABAPExtensibilityVariant","sap/ui/fl/write/_internal/fieldExtensibility/SingleTenantABAPExtensibilityVariant","sap/ui/fl/write/_internal/fieldExtensibility/Utils","sap/ui/fl/write/_internal/fieldExtensibility/UriParser"],function(e,r,t,i,n,a){"use strict";var s={};var u=new r;function o(e){return Promise.all([n.getBoundEntitySet(e),n.getBoundEntityType(e)]).then(function(e){return{entitySetName:e[0],entityTypeName:e[1]}})}function l(r){e.error("Error occurred:");if(r){if(Array.isArray(r.errorMessages)){r.errorMessages.forEach(function(r){e.error(r.text)})}else{e.error(r)}}}function f(e,r){try{var n=a.parseServiceUri(e);var s=new t(e,n,r);var o=new i(e,n,r);return Promise.all([s.isActive(),o.isActive()]).then(function(e){var r=u;if(e[0]===true){r=s}else if(e[1]===true){r=o}return r}).catch(function(e){l(e);return Promise.resolve(u)})}catch(e){l(e);return Promise.resolve(u)}}function c(e,r){if(s[e]){return s[e][r.entityTypeName]}return null}function y(e,r,t){s[e]||={};s[e][r.entityTypeName]=t}function v(e,r){var t=n.getServiceUri(e);var i=c(t,r);if(!i){return f(t,r).then(function(e){y(t,r,e);return Promise.resolve(e)})}return Promise.resolve(i)}var P={};P.getInstance=function(e){if(n.checkControlPrerequisites(e)){return o(e).then(function(r){return v(e,r).then(function(e){return e.getInterface()})}).catch(function(e){l(e);return Promise.resolve(u.getInterface())})}return Promise.resolve(u.getInterface())};P.reset=function(){s={}};return P});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/MultiTenantABAPExtensibilityVariant", ["sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariant","sap/ui/fl/write/_internal/fieldExtensibility/Utils"],function(t,e){"use strict";var i="/sap/opu/odata/sap/APS_PREDEFINED_FIELD_SRV/GetExtensionDataByResourcePath";var n={semanticObject:"PredefinedCustomField",action:"configure"};var s=t.extend("sap.ui.fl.write._internal.fieldExtensibility.MultiTenantABAPExtensibilityVariant",{getExtensionData(){return this._oExtensionDataPromise.then(function(t){if(this._containsData(t)){return this._convertExtensionData(t)}return null}.bind(this))},getNavigationUri(){return this._oExtensionDataPromise.then(function(t){if(this._containsData(t)){return e.getNavigationUriForIntent({target:n,params:{businessObjectNodeName:t.BusinessObjectNodeName,cdsEntityName:t.CdsEntityName,serviceVersion:this._mServiceInfo.serviceVersion,serviceName:this._mServiceInfo.serviceName}})}return null}.bind(this))},getTexts(){return this._oExtensionDataPromise.then(function(t){if(this._containsData(t)){return{tooltip:e.getText("BTN_ADD_FIELD"),headerText:e.getText("BUSINESS_OBJECT_NODE_TITLE")}}return null}.bind(this))},isActive(){return this._oExtensionDataPromise.then(function(t){return this._containsData(t)}.bind(this))},_containsData(t){return Boolean(t&&t.BusinessObjectNodeName&&t.CdsEntityName)},_convertExtensionData(t){return{extensionData:[{businessContext:t.BusinessObjectNodeName,description:t.BusinessObjectNodeDescription}]}},_determineExtensionData(){return new Promise(function(t,s){e.isNavigationSupportedForIntents([n]).then(function(n){var a=n.some(function(t){return t===true});if(a){e.executeRequest(i,{ResourcePath:this._sServiceUri,EntitySetName:this._mBindingInfo.entitySetName}).then(function(e){if(e.errorOccurred===false){t(this._extractExtensionDataFromResponse(e.result))}else{s(e)}}.bind(this))}else{t(null)}}.bind(this))}.bind(this))},_extractExtensionDataFromResponse(t){return t.GetExtensionDataByResourcePath}});return s});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/ServiceValidation", ["sap/ui/fl/Utils","sap/ui/util/Storage","sap/ui/fl/write/_internal/fieldExtensibility/UriParser"],function(e,r,t){"use strict";var i={};var n="sap.ui.fl.fieldExt.Access";var u=1*7*24*60*60*1e3;function a(){return Date.now()}function f(){return i.getLocalStorage()}function s(){return f()&&f().isSupported()}function c(){if(!s()){return{}}var e=f().get(n);if(!e){return{}}return JSON.parse(e)}function o(e){return e.expirationDate<=a()}function l(e){return c()[e.serviceKey]||null}function v(e){var r=a()+u;var t=S();var i=p(e);return{serviceKey:t.getName()+t.getClient()+i.serviceName+i.serviceVersion,expirationDate:r}}function p(e){if(typeof e==="string"){return t.parseServiceUri(e)}return e}function g(){return S()}function S(){var r=e.getUshellContainer();return r&&r.getLogonSystem()}function d(e){if(s()){f().put(n,JSON.stringify(e))}}i.getLocalStorage=function(){return new r(r.Type.local)};i.isServiceOutdated=function(e){if(!g()){return false}var r=l(v(e));if(r){if(o(r)){this.setServiceValid(e);return false}return true}return false};i.setServiceValid=function(e){if(g()){var r=c();delete r[v(e).serviceKey];d(r)}};i.setServiceInvalid=function(e){if(g()){var r=c();var t=v(e);r[t.serviceKey]=t;d(r)}};return i});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/SingleTenantABAPExtensibilityVariant", ["sap/ui/fl/write/_internal/fieldExtensibility/ABAPExtensibilityVariant","sap/ui/fl/write/_internal/fieldExtensibility/UriParser","sap/ui/fl/write/_internal/fieldExtensibility/Utils"],function(t,e,n){"use strict";const s="/sap/opu/odata/SAP/APS_CUSTOM_FIELD_MAINTENANCE_SRV/";const i="/sap/opu/odata/sap/ui_sclg_implementation/";const o="sap.ui.fl.write._internal.fieldExtensibility.SingleTenantABAPExtensibilityVariant";const r={CustomField:"CUSTOM_FIELD",CustomLogic:"CUSTOM_LOGIC"};const u={[r.CustomField]:{semanticObject:"CustomField",action:"manage"},[r.CustomLogic]:{semanticObject:"CustomLogic",action:"develop"}};const a={BusinessContextTitle:"BUSINESS_CONTEXT_TITLE",MenuButtonLabel:"BTN_CREATE",MenuButtonTooltip:"BTN_FREP_CCF",MenuCreateCustomField:"BTN_MENU_CREATE_CUSTOM_FIELD",StandaloneCreateCustomField:"BTN_CREATE_CUSTOM_FIELD",MenuCreateCustomLogic:"BTN_MENU_CREATE_CUSTOM_LOGIC",StandaloneCreateCustomLogic:"BTN_CREATE_CUSTOM_LOGIC"};const c=t.extend(o,{async getExtensionData(){const t=await this._oExtensionDataPromise;if(t===null){return null}if(!this._containsExtensionData(t)){return null}const e=[];for(const n of t.businessContexts){const t={description:n.BusinessContextDescription,businessContext:n.BusinessContext};e.push(t)}return{extensionData:e}},async getNavigationUri(t){const e=t??await this._getFallbackNavigationActionKey();if(e===null){return null}const s=await this._oExtensionDataPromise;if(s===null){return null}if(!this._containsExtensionData(s)){return null}const i=s.navigationSupported;if(!i[e]){return null}const o=s.businessContexts;const r=o.map(function(t){return t.BusinessContext});const a=s.businessObjects;const c=a.map(function(t){return t.SAPObjectNodeType});return n.getNavigationUriForIntent({target:u[e],params:{businessContexts:r,businessObjects:c,serviceVersion:this._mServiceInfo.serviceVersion,serviceName:this._mServiceInfo.serviceName,entityType:this._mBindingInfo.entityTypeName}})},async getTexts(){const t=await this._oExtensionDataPromise;if(t===null){return null}if(!this._containsExtensionData(t)){return null}const e=await this._getMenuButtonLabel();const s=await this._getMenuButtonTooltip();const i=await this._getMenuButtonOptions();if(i.length===1){i[0].text=e;i[0].tooltip=s}return{headerText:n.getText(a.BusinessContextTitle),buttonText:e,tooltip:s,options:i}},async isActive(){const t=await this._oExtensionDataPromise;if(t===null){return false}return this._containsExtensionData(t)},_containsExtensionData({businessContexts:t,businessObjects:e}){const n=Array.isArray(t)&&t.length>0;const s=Array.isArray(e)&&e.length>0;return n||s},async _determineExtensionData(){let[t,e]=await n.isNavigationSupportedForIntents([u[r.CustomField],u[r.CustomLogic]]);if(!(t||e)){return null}const s=await this._getBusinessContexts();if(s===null){return null}const i=await this._getBusinessObjects(s);if(i===null){return null}const{supportsStructuralEnhancements:o,supportsLogicEnhancements:a}=this._determineSupportedExtensibilityTypes(s,i);t&&=o;e&&=a;if(!(t||e)){return null}return{businessContexts:s,businessObjects:i,navigationSupported:{[r.CustomField]:t,[r.CustomLogic]:e}}},async _getBusinessContexts(){const t=this._getBusinessContextDataServiceUrl();const s=this._getBusinessContextDataServiceParameters();const i=await n.executeRequest(t,s);if(i.statusCode===404&&this._mServiceInfo.serviceType===e.mServiceType.v4){return null}if(i.errorOccurred!==false){throw i}const o=i.result.results||[];for(const t of o){t.SupportsLogicEnhancements??=true;t.SupportsStructuralEnhancements??=true}return o},async _getBusinessObjects(t){const e=this._getBusinessObjectDataServiceUrl();const s=this._getBusinessObjectDataServiceParameters(t);const i=await n.executeRequest(e,s);if(i.errorOccurred!==false){return[]}return i.result.results||[]},_determineSupportedExtensibilityTypes(t,e){const n=t.some(t=>t.SupportsLogicEnhancements)||e.some(t=>t.SupportsLogicEnhancements);const s=t.some(t=>t.SupportsStructuralEnhancements)||e.some(t=>t.SupportsStructuralEnhancements);return{supportsLogicEnhancements:n,supportsStructuralEnhancements:s}},_getBusinessContextDataServiceParameters(){const t={EntitySetName:"",EntityTypeName:this._mBindingInfo.entityTypeName};if(this._mServiceInfo.serviceType===e.mServiceType.v4){t.ResourcePath=`${e.sODataV4ResourcePathPrefix+this._mServiceInfo.serviceName}/${this._mServiceInfo.serviceVersion}`}else{t.ServiceName=this._mServiceInfo.serviceName;t.ServiceVersion=this._mServiceInfo.serviceVersion}return t},_getBusinessContextDataServiceUrl(){if(this._mServiceInfo.serviceType===e.mServiceType.v4){return`${s}GetBusinessContextsByResourcePath`}return`${s}GetBusinessContextsByEntityType`},_getBusinessObjectDataServiceParameters(t){const e=t.map(t=>t.BusinessContext);return{BusinessContexts:JSON.stringify(e)}},_getBusinessObjectDataServiceUrl(){return`${i}getSONTsFromBusinessContexts`},async _getMenuButtonText(t){const e=await this._oExtensionDataPromise;if(e===null){return undefined}const s=e.navigationSupported;let i=0;for(const t in s){if(!s[t]){continue}i++}if(i>1){return n.getText(t)}if(i===0){return undefined}if(s[r.CustomField]){return n.getText(a.StandaloneCreateCustomField)}if(s[r.CustomLogic]){return n.getText(a.StandaloneCreateCustomLogic)}return undefined},_getMenuButtonLabel(){return this._getMenuButtonText(a.MenuButtonLabel)},_getMenuButtonTooltip(){return this._getMenuButtonText(a.MenuButtonTooltip)},async _getMenuButtonOptions(){const t=await this._oExtensionDataPromise;if(t===null){return[]}const e=t.navigationSupported;const n=[];if(e[r.CustomField]){n.push(this._getFieldsMenuButtonOption())}if(e[r.CustomLogic]){n.push(this._getLogicMenuButtonOption())}return n},_getFieldsMenuButtonOption(){const t=n.getText(a.MenuCreateCustomField);return{actionKey:r.CustomField,text:t,tooltip:t}},_getLogicMenuButtonOption(){const t=n.getText(a.MenuCreateCustomLogic);return{actionKey:r.CustomLogic,text:t,tooltip:t}},async _getFallbackNavigationActionKey(){const t=await this._oExtensionDataPromise;if(t===null){return null}const e=t.navigationSupported;if(!this._containsExtensionData(t)){return null}for(const t in e){if(!e[t]){continue}return t}return null}});return c});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/UriParser", [],function(){"use strict";var e={v2:"v2",v4:"v4"};function r(r){var i=/.*sap\/opu\/odata\/([^\/]+)\/([^\/]+)/i;var a=/([^;]+);v=(\d{1,4})/i;var s="sap/opu/odata";var t;if(r.toLowerCase().indexOf(s)!==-1){var v=r.match(i);if(!v||v.length!==3){throw new Error("sap.ui.fl.fieldExt.UriParser.parseV2ServiceUri: Malformed service URI (Invalid service name)")}if(v[1].toLowerCase()!=="sap"){t=`/${v[1]}/${v[2]}`}else{[,,t]=v}}else{if(r.length>0&&r.lastIndexOf("/")+1===r.length){r=r.substring(0,r.length-1)}t=r.substring(r.lastIndexOf("/")+1)}if(t.indexOf(";v=")!==-1){var n=t.match(a);if(!n||n.length!==3){throw new Error("sap.ui.fl.fieldExt.UriParser.parseV2ServiceUri: Malformed service URI (Invalid version)")}return{serviceName:n[1],serviceVersion:n[2],serviceType:e.v2}}return{serviceName:t,serviceVersion:"0001",serviceType:e.v2}}function i(r){var i=/^\/?sap\/opu\/odata4((?:\/[^/]+){5})(\/[^/]+){1}(\/.*)?/i;var a=r.match(i);if(!a||a.length!==4){throw new Error("sap.ui.fl.fieldExt.UriParser.parseV4ServiceUri: Malformed service URI")}var s=a[1].split("/");s.splice(0,3);var t=/(\d{1,4})/i;var v=a[2].match(t);return{serviceName:s.join("/"),serviceVersion:v[1],serviceType:e.v4}}var a={};a.mServiceType=e;a.sODataV4ResourcePathPrefix="sap/opu/odata4/";a.parseServiceUri=function(e){if(e.toLowerCase().indexOf(this.sODataV4ResourcePathPrefix)!==-1){return i(e)}return r(e)};return a});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/Utils", ["sap/base/Log","sap/base/security/encodeURL","sap/ui/core/Lib","sap/ui/fl/Utils","sap/ui/thirdparty/jquery"],function(e,t,r,n,jQuery){"use strict";var a={v2:"v2",v4:"v4"};function i(e){if(e&&e.split){var t=e.split(".");return t[t.length-1]}return null}function u(e){var t=[];try{var r=JSON.parse(e.responseText);if(r&&r.error&&r.error.message&&r.error.message.value){t.push({severity:"error",text:r.error.message.value})}else{t.push({severity:"error",text:e.responseText})}}catch(e){}return t}function o(t){var r=i(v(t));if(!r){var n=t.getBindingContext?t.getBindingContext():null;if(n&&n.getPath){r=n.getPath()}}if(!r){e.warning("Control not bound to a path")}return r}function s(e,t,r){return e.metadataLoaded().then(function(){var n=null;if(r){var a=e.oMetadata._getEntityTypeByName(r);n=e.oMetadata._getEntitySetByType(a)}n||=e.oMetadata._getEntitySetByPath(t);return n?n.name:null})}function l(e,t){var r=e.getMetaModel();var n=r.getMetaPath(t);return r.requestObject(n).then(function(e){var t=r.fetchEntityContainer().getResult();var n=t[t.$EntityContainer];var a=Object.keys(n).filter(function(t){return n[t]===e});return a.length>0&&a[0]})}function c(e,t,r){return e.metadataLoaded().then(function(){var n=null;if(r){n=e.oMetadata._getEntityTypeByName(r)}n||=e.oMetadata._getEntityTypeByPath(t);return n?n.name:null})}function f(e,t){var r=e.getMetaModel();var n=r.getMetaPath(t);return r.requestObject(n).then(function(e){return i(e.$Type)})}function v(e){return e.getEntitySet?e.getEntitySet():null}function g(e){return e.getEntityType?e.getEntityType():null}function d(t){var r=null;if(t&&t.sServiceUrl){r=t.sServiceUrl}if(!r){e.warning("Model has no Service Uri")}return r}function p(e){if(e){if(e.isA("sap.ui.model.odata.v2.ODataModel")){return a.v2}else if(e.isA("sap.ui.model.odata.v4.ODataModel")){return a.v4}}return null}function y(t){if(t){var r=t.getModel?t.getModel():null;if(p(r)){return r}e.warning("Unsupported model type or protocol");return null}e.warning("No Control passed");return null}var h={};h.checkControlPrerequisites=function(t){if(t){var r=y(t);var n=d(r);var a=o(t);var i=g(t);return Boolean(n&&(a||i))}e.warning("No Control passed");return false};h.executeRequest=function(e,t){var r=e+this.getUriParameters(t);return new Promise(function(e){var t={type:"GET",async:true,dataType:"json"};jQuery.ajax(r,t).done(function(t){var r=t&&t.d;e({errorOccurred:false,result:r})}).fail(function(t){e({errorOccurred:true,errorMessages:u(t),statusCode:t.status})})})};h.getBoundEntitySet=function(e){var t=y(e);var r=p(t);if(r===a.v2){return s(t,o(e),g(e))}else if(r===a.v4){return l(t,o(e))}return Promise.resolve(null)};h.getBoundEntityType=function(e){var t=y(e);var r=p(t);if(r===a.v2){return c(t,o(e),g(e))}else if(r===a.v4){return f(t,o(e))}return Promise.resolve(null)};h.getNavigationUriForIntent=async function(e){const t=await n.getUShellService("Navigation");return t?.getHref?.(e)||null};h.getServiceUri=function(e){var t=y(e);return d(t)};h.getText=function(e){return r.getResourceBundleFor("sap.ui.fl").getText(e)};h.getUriParameters=function(e){if(!e){return""}var r=[];Object.keys(e).forEach(function(n){if(n){var a=`'${t(e[n]||"")}'`;r.push(`${t(n)}=${a}`)}});return r.length===0?"":`?${r.join("&")}`};h.isNavigationSupportedForIntents=async function(e){const t=await n.getUShellService("Navigation");if(t?.isNavigationSupported){const r=await t.isNavigationSupported(e);return r.map(e=>e&&e.supported===true)}return e.map(()=>false)};return h});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/cap/CAPAccess", ["sap/ui/core/Lib","sap/ui/fl/write/_internal/fieldExtensibility/ServiceValidation","sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog"],function(e,t,i){"use strict";var n=null;var r=null;var a=e.getResourceBundleFor("sap.ui.fl");var o={};o.getTexts=function(){return{headerText:a.getText("BUSINESS_CONTEXT_TITLE"),tooltip:a.getText("BTN_ADD_FIELD")}};o.isExtensibilityEnabled=function(){return true};o.getExtensionData=function(){var e=n.getModel();var t=n.getBindingContext().getPath();if(e.isA("sap.ui.model.odata.v2.ODataModel")){return Promise.reject()}else if(e.isA("sap.ui.model.odata.v4.ODataModel")){var i=e.getMetaModel();var r=i.getMetaPath(t);return i.requestObject(r).then(function(e){var t=i.fetchEntityContainer().getResult();var n=t[t.$EntityContainer];return{boundEntitySet:e,entityTypes:Object.values(n).map(function(e){return e.$Type}).filter(Boolean)}})}return Promise.reject()};o.onControlSelected=function(e){n=e};o.onTriggerCreateExtensionData=function(e,t){r||=new i;r.open(e,t)};o.isServiceOutdated=function(e){return t.isServiceOutdated(e)};o.setServiceValid=function(e){t.setServiceValid(e)};o.setServiceInvalid=function(e){t.setServiceInvalid(e)};return o});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog", ["sap/ui/base/ManagedObject","sap/ui/core/Fragment","sap/ui/core/Lib","sap/m/MessageToast","sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/getEditorConfig","sap/base/util/ObjectPath","sap/base/util/deepClone","sap/ui/model/resource/ResourceModel","sap/ui/model/json/JSONModel"],function(e,t,n,o,i,s,a,l,r){"use strict";const d=n.getResourceBundleFor("sap.ui.fl");function u(e,t,n){const o=e.getContent()[0];o.setJson(a(t));o.setConfig(i(n));return o}function c(e){if(!e||!e.element){return{}}const t=a(e);if(!s.get(["element","@Common.Label"],t)){const e=s.get(["element","name"],t);s.set(["element","@Common.Label"],e,t)}const n=s.get(["element","@assert.range"],t);if(s.get(["element","type"],t)==="cds.String"&&Array.isArray(n)){s.set(["element","enum"],n.reduce(function(e,t){e[t]={};return e},{}),t);s.set(["element","@assert.range"],true,t)}if(t.element.annotations){t.element={...t.element,...t.element.annotations};delete t.element.annotations}const o={extend:t.extend,elements:{}};o.elements[t.element.name]=t.element;return o}const p=e.extend("sap.ui.fl.write._internal.fieldExtensibility.cap.dialog.CustomFieldCAPDialog",{metadata:{library:"sap.ui.fl",properties:{_dialog:{type:"any",visibility:"hidden"}}}});p.prototype.open=function(e,n){const o={element:{name:"NewField",type:"cds.String"},extend:e.boundEntitySet.$Type};const i=this.getProperty("_dialog");if(i){this._oEditor.setJson(a(o));i.open()}else{t.load({name:"sap.ui.fl.write._internal.fieldExtensibility.cap.dialog.CustomFieldCAPDialog",controller:this}).then(function(t){this._oDialogModel=new r({isValid:true});this._oDialogModel.setDefaultBindingMode("OneWay");t.setModel(this._oDialogModel,"dialog");t.setModel(new l({bundle:d}),"i18n");t.addStyleClass(n);this.setProperty("_dialog",t);this._oJson=a(o);this._oEditor=u(t,this._oJson,{entityTypes:e.entityTypes});this._oEditor.attachJsonChange(function(e){this._oJson=e.getParameter("json")}.bind(this));this._oEditor.attachValidationErrorChange(function(e){const t=e.getParameter("hasError");this._oDialogModel.setData({isValid:!t})}.bind(this));t.open()}.bind(this))}};p.prototype.exit=function(){const e=this.getProperty("_dialog");if(e){e.destroy()}if(this.oEditor){this.oEditor.destroy()}};p.prototype.onSave=function(){const e=c(this._oJson);const t={extensions:[JSON.stringify(e)]};const n=new Promise(function(e,n){const o=new XMLHttpRequest;o.open("POST","/-/cds/extensibility/addExtension");o.setRequestHeader("Content-Type","application/json");o.onload=function(){if(o.status>=200&&o.status<400){e(o.response)}else{n({status:o.status,message:o.statusText})}};o.send(JSON.stringify(t))});n.then(function(){o.show(d.getText("CAP_ADD_FIELD_SUCCESS"))});this.getProperty("_dialog").close()};p.prototype.onCancel=function(){this.getProperty("_dialog").close()};return p});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 *
 * @private
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/getEditorConfig", [],function(){"use strict";return function(e){return{context:"/element",properties:{entityType:{tags:["general"],label:"Entity Type",path:"/extend",type:"select",items:(e.entityTypes||[]).map(function(e){return{key:e}}),allowCustomValues:false,validators:{isRequired:{type:"isRequired"}}},name:{tags:["general"],label:"Name",path:"name",type:"string",validators:{isRequired:{type:"isRequired"},namePattern:{type:"pattern",errorMessage:"CAP_ERR_WHITESPACE",config:{pattern:"^\\S+$"}}}},label:{tags:["general"],label:"Label",path:"@Common.Label",type:"string",placeholder:"{/element/name}"},type:{tags:["general"],label:"Type",path:"type",type:"select",items:[{key:"cds.String",title:"String"},{key:"cds.Integer",title:"Integer"},{key:"cds.Decimal",title:"Decimal"},{key:"cds.Date",title:"Date"},{key:"cds.Time",title:"Time"},{key:"cds.DateTime",title:"DateTime"},{key:"cds.Boolean",title:"Boolean"}],allowCustomValues:false,validators:{isRequired:{type:"isRequired"}}},numberPrecision:{tags:["general"],label:"Precision",path:"precision",type:"number",defaultValue:"",visible:"{= ${/element/type} === 'cds.Decimal' }"},numberScale:{tags:["general"],label:"Scale",path:"scale",type:"number",defaultValue:"",visible:"{= ${/element/type} === 'cds.Decimal' }"},stringLength:{tags:["general"],label:"Length",path:"length",type:"number",defaultValue:"",visible:"{= ${/element/type} === 'cds.String' }"},defaultValue:{tags:["general"],label:"Default",path:"default/val",defaultValue:"",type:"{/element/type}"},readonly:{tags:["validation"],label:"Readonly",path:"@readonly",type:"bool"},mandatory:{tags:["validation"],label:"Mandatory",path:"@mandatory",type:"bool"},format:{tags:["validation"],label:"Format",path:"@assert.format",type:"string",defaultValue:"",visible:"{= ${/element/type} === 'cds.String' }"},stringRange:{tags:["validation"],label:"Allowed Values",path:"@assert.range",type:"list",visible:"{= ${/element/type} === 'cds.String' }",active:"{= ${/element/type} === 'cds.String' }"},arrayRange:{tags:["validation"],label:"Range",path:"@assert.range",type:"range",rangeType:"{/element/type}",visible:"{= ${/element/type} === 'cds.Integer' || ${/element/type} === 'cds.Decimal' || ${/element/type} === 'cds.DateTime' || ${/element/type} === 'cds.Date' || ${/element/type} === 'cds.Time'}",active:"{= ${/element/type} === 'cds.Integer' || ${/element/type} === 'cds.Decimal' || ${/element/type} === 'cds.DateTime' || ${/element/type} === 'cds.Date' || ${/element/type} === 'cds.Time'}"},annotations:{tags:["advanced"],label:"Additional Annotations",allowedTypes:["json"],path:"annotations",type:"map",allowTypeChange:false,addItemLabelI18n:"CAP_ADD_FIELD_EDITOR.ANNOTATION",defaultType:"json"}},layout:{form:{groups:[{label:"General",items:[{type:"tag",value:"general"}]},{label:"Input Validation",items:[{type:"tag",value:"validation"}]},{label:"Advanced",items:[{type:"tag",value:"advanced"}]}]}},propertyEditors:{select:"sap/ui/integration/designtime/baseEditor/propertyEditor/selectEditor/SelectEditor",string:"sap/ui/integration/designtime/baseEditor/propertyEditor/stringEditor/StringEditor",integer:"sap/ui/integration/designtime/baseEditor/propertyEditor/integerEditor/IntegerEditor",number:"sap/ui/integration/designtime/baseEditor/propertyEditor/numberEditor/NumberEditor",map:"sap/ui/integration/designtime/baseEditor/propertyEditor/mapEditor/MapEditor",list:"sap/ui/integration/designtime/baseEditor/propertyEditor/listEditor/ListEditor",bool:"sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor",range:"sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor",json:"sap/ui/integration/designtime/baseEditor/propertyEditor/jsonEditor/JsonEditor","cds.String":"sap/ui/integration/designtime/baseEditor/propertyEditor/stringEditor/StringEditor","cds.Integer":"sap/ui/integration/designtime/baseEditor/propertyEditor/integerEditor/IntegerEditor","cds.Decimal":"sap/ui/integration/designtime/baseEditor/propertyEditor/numberEditor/NumberEditor","cds.Date":"sap/ui/integration/designtime/baseEditor/propertyEditor/dateEditor/DateEditor","cds.Time":"sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor","cds.DateTime":"sap/ui/integration/designtime/baseEditor/propertyEditor/dateTimeEditor/DateTimeEditor","cds.Boolean":"sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor"},i18n:"sap/ui/fl/messagebundle.properties",validators:{isRequired:"sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/validators/IsRequired"},propertyEditorConfigs:{"cds.Date":{pattern:"YYYY-MM-dd"},"cds.DateTime":{pattern:"YYYY-MM-dd'T'HH:mm:ss'Z'"}}}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor", ["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor"],function(e){"use strict";var t=e.extend("sap.ui.fl.write._internal.fieldExtensibility.cap.editor.propertyEditor.booleanEditor.BooleanEditor",{xmlFragment:"sap.ui.fl.write._internal.fieldExtensibility.cap.editor.propertyEditor.booleanEditor.BooleanEditor",metadata:{library:"sap.ui.fl"},renderer:e.getMetadata().getRenderer().render});t.prototype._onChange=function(e){var t=!!e.getParameter("selected");this.setValue(t)};return t});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor", ["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor","sap/ui/model/json/JSONModel"],function(t,e){"use strict";const i=t.extend("sap.ui.fl.write._internal.fieldExtensibility.cap.editor.propertyEditor.rangeEditor.RangeEditor",{xmlFragment:"sap.ui.fl.write._internal.fieldExtensibility.cap.editor.propertyEditor.rangeEditor.RangeEditor",metadata:{library:"sap.ui.fl"},renderer:t.getMetadata().getRenderer().render});i.configMetadata={...t.configMetadata,rangeType:{defaultValue:"string"}};i.prototype.init=function(...i){t.prototype.init.apply(this,i);this._oContentModel=new e;this._oContentModel.setDefaultBindingMode("OneWay");this.setModel(this._oContentModel,"contentModel")};i.prototype.getExpectedWrapperCount=function(){return 2};i.prototype.setConfig=function(...e){t.prototype.setConfig.apply(this,e);this.setValue(this.getValue())};i.prototype.setValue=function(...e){const[i]=e;t.prototype.setValue.apply(this,e);const o={type:this.getConfig().rangeType};const n=Array.isArray(i)?i:[];this._oContentModel.setData([{value:n[0],config:{index:0,...o}},{value:n[1],config:{index:1,...o}}])};i.prototype._onChange=function(t){const e=t.getParameter("value");const i=t.getSource().getConfig().index;const o=(this.getValue()||[]).slice();o[i]=e;this.setValue(o)};return i});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor", ["sap/ui/integration/designtime/baseEditor/propertyEditor/BasePropertyEditor","sap/ui/integration/designtime/baseEditor/propertyEditor/dateEditor/DateEditor","sap/ui/core/format/DateFormat"],function(t,e,r){"use strict";const i=e.extend("sap.ui.fl.write._internal.fieldExtensibility.cap.editor.propertyEditor.timeEditor.TimeEditor",{xmlFragment:"sap.ui.fl.write._internal.fieldExtensibility.cap.editor.propertyEditor.timeEditor.TimeEditor",metadata:{library:"sap.ui.fl"},renderer:t.getMetadata().getRenderer().render});i.configMetadata={...e.configMetadata,pattern:{defaultValue:"HH:mm:ss"},utc:{defaultValue:false}};i.prototype.getDefaultValidators=function(){return{...e.prototype.getDefaultValidators.call(this)}};i.prototype.getFormatterInstance=function(t){return r.getTimeInstance(t||{pattern:"HH:mm:ss.SSSS"})};return i});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/validators/IsRequired", [],function(){"use strict";return{async:false,errorMessage:"CAP_ERR_REQUIRED",validate(e){return e===false||e===0||!!e}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/flexState/FlexObjectManager", ["sap/base/util/restricted/_omit","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/apply/_internal/flexState/changes/UIChangesState","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/flexState/FlexObjectState","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/initial/api/Version","sap/ui/fl/write/_internal/condenser/Condenser","sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantManagementState","sap/ui/fl/write/_internal/flexState/compVariants/CompVariantManager","sap/ui/fl/write/_internal/Storage","sap/ui/fl/write/_internal/Versions","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,r,a,c,i,s,l,o,f,p,g,y,u,d,x,F,S,h,O){"use strict";const b={};function C(e,t){if(t.isValidForDependencyMap()){c.removeChangeFromMap(l.getLiveDependencyMap(e),t.getId());c.removeChangeFromDependencies(l.getLiveDependencyMap(e),t.getId())}}function j(e){return typeof e.isA==="function"&&e.isA("sap.ui.fl.apply._internal.flexObjects.FlexObject")?e:r.createFromFileContent(e)}async function m(e,r,a){const c=Object.values(S).filter(e=>e!==r);const i=b.removeDirtyFlexObjects({reference:a,layers:c,component:e});if(i.length){await n.revertMultipleChanges([...i].reverse(),{appComponent:e,modifier:t,reference:a})}}function L(e,t){return e.map(e=>e[t]()).filter((e,t,n)=>n.indexOf(e)===t).length===1}function D(e,t,n){if(!e||!L(t,"getLayer")){return false}const r=new URLSearchParams(window.location.search);if(r.has("sap-ui-xx-condense-changes")){return r.get("sap-ui-xx-condense-changes")==="true"}return n||[S.CUSTOMER,S.PUBLIC,S.USER].includes(t[0].getLayer())}function E(e,t,n,r,a){const c=t.map(e=>V(e,n)).filter(Boolean);e.filter(e=>!t.some(t=>e.getId()===t.getId())).forEach(e=>{if(r){o.removeDirtyFlexObjects(a,[e]);C(a,e);c.push({type:"delete",flexObject:e.convertToFileContent()})}else{b.deleteFlexObjects({reference:a,flexObjects:[e]})}});if(c.length){o.getFlexObjectsDataSelector().checkUpdate({reference:a});o.update(a,c)}}function v(e,t,n,r,c){if(!e.length&&!n){return[]}const i=o.getFlexObjectsDataSelector().get({reference:c}).filter(e=>{if(r===S.CUSTOMER&&t){return e.getState()===a.LifecycleState.PERSISTED&&t.includes(e.getId())}return e.getState()===a.LifecycleState.PERSISTED&&h.compareAgainstCurrentLayer(e.getLayer(),r)===0});return i.concat(e)}async function T(e,t,n,r){let c;if(n){[c]=e.filter(e=>e.getState()===a.LifecycleState.NEW)}const i={response:[]};const s=[];for(const r of e){const e={layer:r.getLayer(),transport:r.getRequest(),parentVersion:n};let l;if(r.getState()===a.LifecycleState.NEW){if(e.parentVersion!==undefined){e.parentVersion=r===c?e.parentVersion:g.Number.Draft}e.flexObjects=[r.convertToFileContent()];l=await x.write(e)}else if(r.getState()===a.LifecycleState.DELETED){e.flexObject=r.convertToFileContent();l=await x.remove(e)}const o=V(r,t);if(o){s.push(o)}if(l?.response){i.response.push(...l.response)}}if(s.length){o.update(r,s)}o.getFlexObjectsDataSelector().checkUpdate({reference:r});return i}function V(e,t){if(!t){let t;switch(e.getState()){case a.LifecycleState.NEW:t={type:"add",flexObject:e.convertToFileContent()};break;case a.LifecycleState.DELETED:t={type:"delete",flexObject:e.convertToFileContent()};break;case a.LifecycleState.UPDATED:t={type:"update",flexObject:e.convertToFileContent()};break;default:}e.setState(a.LifecycleState.PERSISTED);return t}return undefined}async function I(e){const t=v(e.dirtyFlexObjects,e.draftFilenames,e.condenseAnyLayer,e.layer,e.reference);const n=p.getInstanceOrUndef()?.getIsCondensingEnabled()&&D(e.appComponent,t,e.condenseAnyLayer);const r=n?t:e.dirtyFlexObjects;const c=r.slice(0);if(L(e.dirtyFlexObjects,"getRequest")&&(p.getInstanceOrUndef()?.getHasPersoConnector()?L(e.dirtyFlexObjects,"getLayer"):true)){const t=D(e.appComponent,c,e.condenseAnyLayer)?await y.condense(e.appComponent,c):c;let i;const s=c[0].getRequest();if(n){i=await x.condense({allChanges:r,condensedChanges:t,layer:e.layer,transport:s,isLegacyVariant:false,parentVersion:e.parentVersion})}else{const n=r.filter(e=>e.getState()===a.LifecycleState.DELETED);const c=t.filter(e=>e.getState()!==a.LifecycleState.DELETED);if(n.length){await T(n,e.skipUpdateCache,e.parentVersion,e.reference)}if(c.length){i=await x.write({layer:e.layer,flexObjects:c.map(e=>e.convertToFileContent()),transport:s,isLegacyVariant:false,parentVersion:e.parentVersion})}}E(r,t,e.skipUpdateCache,n,e.reference);return i||{response:[]}}return T(e.dirtyFlexObjects,e.skipUpdateCache,e.parentVersion,e.reference)}b.filterHiddenFlexObjects=function(e,t){const n=s.filterHiddenFlexObjects(e,t);return d.filterHiddenFlexObjects(n,t)};b.getFlexObjects=async function(e){e.reference=f.getFlexReferenceForControl(e.selector);if(e.invalidateCache){const t=O.getAppComponentForSelector(e.selector);e.componentId=t.getId();await o.reinitialize(e)}let t=i.getVariantIndependentUIChanges(e.reference).concat(u.getCompEntities(e));if(!e.includeCtrlVariants){t=t.concat(s.getInitialUIChanges({reference:e.reference,includeDirtyChanges:true}))}else if(!e.onlyCurrentVariants){t=t.concat(s.getVariantDependentFlexObjects(e.reference))}else{t=t.concat(s.getAllCurrentFlexObjects({reference:e.reference}))}if(e.includeManifestChanges){t=t.concat(o.getAppDescriptorChanges(e.reference))}if(e.includeAnnotationChanges){t=t.concat(o.getAnnotationChanges(e.reference))}if(e.currentLayer){t=t.filter(t=>t.getLayer()===e.currentLayer)}return t};b.hasDirtyFlexObjects=function(e){const t=f.getFlexReferenceForSelector(e.selector);return l.getDirtyFlexObjects(t).length>0};b.addDirtyFlexObjects=function(e,t){return o.addDirtyFlexObjects(e,t.map(j))};b.removeDirtyFlexObjects=function(e){const n=[].concat(e.layers||[]);const r=l.getDirtyFlexObjects(e.reference);const a=r.filter(r=>{let a=true;if(n.length&&!n.includes(r.getLayer())){return false}if(e.generator&&r.getSupportInformation().generator!==e.generator){return false}if(e.control){const n=t.getControlIdBySelector(r.getSelector(),e.component);a=e.control.getId()===n}if(e.changeTypes){a&&=e.changeTypes.includes(r.getChangeType())}return a});return o.removeDirtyFlexObjects(e.reference,a)};b.saveFlexObjects=async function(e){const t=O.getAppComponentForSelector(e.selector);const n=f.getFlexReferenceForControl(e.selector);const r=e.layer===S.CUSTOMER;const a=r&&F.getVersionsModel({reference:n,layer:e.layer});const c=a&&a.getProperty("/versioningEnabled");if(e.removeOtherLayerChanges&&e.layer){await m(t,e.layer,n)}const i=e.flexObjects||l.getDirtyFlexObjects(n);if(!i.length){return{response:[]}}const s=await I({reference:n,layer:e.layer||i[0].getLayer(),dirtyFlexObjects:i,skipUpdateCache:e.skipUpdateCache,condenseAnyLayer:e.condenseAnyLayer,appComponent:t,parentVersion:c?a.getProperty("/persistedVersion"):undefined,draftFilenames:c?a.getProperty("/draftFilenames"):undefined});if(r&&c){F.updateAfterSave({reference:n,layer:e.layer,backendResponse:s})}return s};b.deleteFlexObjects=function(e){const t=l.getDirtyFlexObjects(e.reference);const n=[];const r=[];e.flexObjects.forEach(c=>{if(t.indexOf(c)>-1&&c.getState()===a.LifecycleState.NEW){r.push(c)}else{c.markForDeletion();n.push(c)}C(e.reference,c)});o.removeDirtyFlexObjects(e.reference,r);const c=b.addDirtyFlexObjects(e.reference,n);if(!r.length&&!c.length){const t=o.getFlexObjectsDataSelector();t.checkUpdate({reference:e.reference})}};b.restoreDeletedFlexObjects=function(e){const t=e.flexObjects.filter(e=>e.getState()===a.LifecycleState.DELETED||e.getState()===a.LifecycleState.NEW);t.forEach(e=>{e.restorePreviousState()});const n=t.filter(e=>e.getState()!==a.LifecycleState.PERSISTED);b.addDirtyFlexObjects(e.reference,n)};b.resetFlexObjects=async function(e){const r=f.getFlexReferenceForControl(e.appComponent);const a=await b.getFlexObjects({selector:e.appComponent,currentLayer:e.layer,includeCtrlVariants:true});const c={reference:r,layer:e.layer,changes:a};if(e.generator){c.generator=e.generator}if(e.selectorIds){c.selectorIds=e.selectorIds}if(e.changeTypes){c.changeTypes=e.changeTypes}const i=await x.reset(c);if(e.selectorIds||e.changeTypes||e.generator){const c=[];if(i?.response?.length>0){i.response.forEach(e=>{c.push(e.fileName)})}const s=a.filter(e=>c.indexOf(e.getId())!==-1);o.update(r,s.map(e=>({flexObject:e.convertToFileContent(),type:"delete"})));if(s.length){await n.revertMultipleChanges([...s].reverse(),{appComponent:e.appComponent,modifier:t,reference:r})}}};return b});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/flexState/UI2Personalization/UI2PersonalizationState", ["sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/_internal/flexState/UI2Personalization/UI2PersonalizationState","sap/ui/fl/write/_internal/connectors/LrepConnector"],function(e,n,t){"use strict";const o={};o.setPersonalization=async function(n){if(!n||!n.reference||!n.containerKey||!n.itemName||!n.content){throw new Error("not all mandatory properties were provided for the storage of the personalization")}const o=await t.ui2Personalization.create({flexObjects:n});const a=e.getUI2Personalization(o.response.reference);a[o.response.containerKey]||=[];a[o.response.containerKey].push(o.response);e.update(o.response.reference,[{type:"ui2",newData:a}])};o.deletePersonalization=async function(o,a,r){if(!o||!a||!r){throw new Error("not all mandatory properties were provided for the storage of the personalization")}await t.ui2Personalization.remove({reference:o,containerKey:a,itemName:r});const i=e.getUI2Personalization(o);const s=i[a];const l=n.getPersonalization(o,a,r);const c=s.indexOf(l);s.splice(c,1);e.update(o,[{type:"ui2",newData:i}])};return o});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/flexState/changes/UIChangeManager", ["sap/base/util/restricted/_omit","sap/ui/core/Component","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/changes/DependencyHandler","sap/ui/fl/apply/_internal/flexState/FlexObjectState","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/write/_internal/flexState/FlexObjectManager"],function(e,t,n,a,l,i,r,s,p){"use strict";const c={};function o(e,a,l){i.addRuntimeChangeToMap(a,l,r.getLiveDependencyMap(e));if(l instanceof t){const t=l.getPropagationListeners().every(e=>!e._bIsFlexApplyChangesFunction);if(t){const t=n.applyAllChangesForControl.bind(n,l,e);t._bIsFlexApplyChangesFunction=true;l.addPropagationListener(t)}}}function f(e){return typeof e.isA==="function"&&e.isA("sap.ui.fl.apply._internal.flexObjects.FlexObject")?e:a.createFromFileContent(e)}c.addDirtyChanges=function(e,t,n){const a=s.addDirtyFlexObjects(e,t.map(f));a.forEach(t=>{o(e,t,n)});return a};c.restoreDeletedChanges=function(e,t,n){p.restoreDeletedFlexObjects({reference:e,flexObjects:t});const a=t.filter(e=>e.getState()!==l.LifecycleState.PERSISTED);a.forEach(t=>{o(e,t,n)})};return c});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/flexState/compVariants/CompVariantManager", ["sap/base/util/restricted/_omit","sap/base/util/restricted/_pick","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/CompVariantRevertData","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/RevertData","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UpdatableChange","sap/ui/fl/apply/_internal/flexState/compVariants/applyChangesOnVariant","sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantManagementState","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/initial/api/Version","sap/ui/fl/write/_internal/Storage","sap/ui/fl/write/_internal/Versions"],function(e,t,n,a,r,i,o,s,c,p,l,f,u,d,g,y,v){"use strict";function S(e,t){const n=C("/draftFilenames",t);if(n){return e.getState()===c.LifecycleState.NEW||n.includes(e.getId())}return true}function C(e,t){const n={reference:t.reference,layer:t.layer};if(v.hasVersionsModel(n)){return v.getVersionsModel(n).getProperty(e)}return undefined}function m(e,t){const n=e.getFlexObjectMetadata?e.getFlexObjectMetadata().changeType:e.getChangeType();if(!["defaultVariant","updateVariant"].includes(n)){return false}const a=e.getLayer()===t.layer;const r=e.getFlexObjectMetadata().packageName;const i=!r||r==="$TMP";return a&&i&&S(e,t)}function x(e,t){if(t.isVariant&&t.isVariant()){return e.variants}const n=t.getChangeType();switch(n){case"defaultVariant":return e.defaultVariants;case"standardVariant":return e.standardVariants;default:return e.changes}}function V(e,t){for(let n=0;n<e.length;n++){if(e[n].fileName===t.fileName){e.splice(n,1,t);break}}}async function h(e,t,n,a){const r=await y.update({flexObject:e.convertToFileContent(),layer:e.getLayer(),transport:e.getRequest(),parentVersion:n});if(r?.response){e.setResponse(r.response);if(n){v.onAllChangesSaved({reference:r.response.reference,layer:r.response.layer,draftFilenames:r.response.fileName})}}else{e.setState(c.LifecycleState.PERSISTED)}const i=x(t.changes.comp,e);const o=e.convertToFileContent();u.getFlexObjectsDataSelector().checkUpdate({reference:a});V(i,o);return o}async function D(e,t,n,a){var r=e.convertToFileContent();await y.remove({flexObject:r,layer:e.getLayer(),transport:e.getRequest(),parentVersion:n});await v.updateModelFromBackend({reference:r.reference,layer:r.layer});u.update(a,[{type:"delete",flexObject:r}]);u.getFlexObjectsDataSelector().checkUpdate({reference:a});return r}function O(e){var t={};if(typeof e.texts==="object"){Object.keys(e.texts).forEach(function(n){t[n]={value:e.texts[n],type:"XFLD"}})}return t}function T(e){return e&&[c.LifecycleState.NEW,c.LifecycleState.UPDATED,c.LifecycleState.DELETED].includes(e.getState())}function U(e){if(e.layer){return e.layer}if(e.isUserDependent){return n.USER}var t=new URLSearchParams(window.location.search).get("sap-ui-layer")||"";t=t.toUpperCase();if(t){return t}if(!e.fileType==="variant"){return n.CUSTOMER}var a=d.getInstanceOrUndef()?.getIsPublicLayerAvailable?.();return a?n.PUBLIC:n.CUSTOMER}function b(e){if(e instanceof r){e.removeAllRevertData()}}function E(e,t){e.storeExecuteOnSelection(t.executeOnSelection);e.storeFavorite(t.favorite);e.storeContexts(t.contexts);e.storeName(t.name);e.storeContent(t.content||e.getContent());return e}function F(e,t){e.setExecuteOnSelection(t.executeOnSelection);e.setFavorite(t.favorite);e.setContexts(t.contexts);e.setName(t.name);e.setContent(t.content||e.getContent());return e}function I(e){if(e&&e.getRevertData().length){let t;e.getRevertData().reverse().some(e=>{t=e.getContent();return t.previousAction===L.updateActionType.SAVE});E(e,{name:t.previousName,content:t.previousContent,favorite:t.previousFavorite,executeOnSelection:t.previousExecuteOnSelection,contexts:t.previousContexts});e.setState(t.previousState)}}function R(e){if(e.layer===n.VENDOR){e.support={user:"SAP"}}else if(d.getInstanceOrUndef()?.getUserId()){e.support={user:d.getInstanceOrUndef().getUserId()}}}var L={};L.checkSVMControlsForDirty=function(e){return u.getSVMControls(e).some(e=>{if(e?.oModel){return e?.getModified?.()}return false})};L.setDefault=function(e){const t={defaultVariantName:e.defaultVariantId};e.layer||=new URLSearchParams(window.location.search).get("sap-ui-layer")||n.USER;let r=f.getDefaultChanges(e).slice(-1)[0];if(!r||!m(r,e)){const n="defaultVariant";const i={fileName:a.createDefaultFileName(n),fileType:"change",changeType:n,layer:e.layer,content:t,namespace:a.createNamespace(e,"changes"),reference:e.reference,selector:{persistencyKey:e.persistencyKey},support:e.support||{}};i.adaptationId=e.changeSpecificData?.adaptationId;i.support.generator||=`CompVariantState.${n}`;r=o.createFromFileContent(i,p);r.addRevertInfo(new s({type:L.operationType.NewChange}));u.addDirtyFlexObjects(e.reference,[r])}else{r.addRevertInfo(new s({type:L.operationType.ContentUpdate,content:{previousState:r.getState(),previousContent:r.getContent()}}));r.setContent(t);f.getSetDefaultDataSelector().checkUpdate({reference:e.reference})}return r};L.revertSetDefaultVariantId=function(e){const t=f.getDefaultChanges(e);const n=t?.slice(-1)[0];const a=n.popLatestRevertInfo();if(a.getType()===L.operationType.ContentUpdate){n.setContent(a.getContent().previousContent);n.setState(a.getContent().previousState)}else{n.setState(c.LifecycleState.DELETED);t.pop()}};L.addVariant=function(t){if(!t){return undefined}const a=t.changeSpecificData;a.layer=U(a);a.changeType=a.type;a.texts=O(a);R(a);const r={...a,...e(t,"changeSpecificData")};const i=o.createCompVariant(r);u.addDirtyFlexObjects(t.reference,[i]);if(a.layer!==n.USER&&a.layer!==n.PUBLIC){t.id=t.control.getCurrentVariantId();I(f.getVariant(t))}return i};L.updateVariant=function(e){function a(t,n){const a=t.getLayer()===n;const r=t.getFlexObjectMetadata().packageName;const i=!r||r==="$TMP";const o=f.getVariantChanges(t).some(e=>e.getLayer()===n);return t.getPersisted()&&a&&i&&!o&&S(t,e)}function r(t){return f.getVariantChanges(t).reverse().find(t=>t.getChangeType()==="updateVariant"&&m(t,e))}function s(e,t,n,a){const r={type:n,change:a,content:{previousState:t.getState(),previousContent:t.getContent(),previousFavorite:t.getFavorite(),previousVisible:t.getVisible(),previousExecuteOnSelection:t.getExecuteOnSelection(),previousContexts:t.getContexts(),previousName:t.getName(),previousAction:e.action}};t.addRevertData(new i(r))}function c(e,t){s(e,t,L.operationType.ContentUpdate);if(e.executeOnSelection!==undefined){t.storeExecuteOnSelection(e.executeOnSelection)}if(e.layer===n.PUBLIC){t.storeFavorite(false)}else if(e.favorite!==undefined){t.storeFavorite(e.favorite)}if(e.visible!==undefined){t.storeVisible(e.visible)}if(e.contexts){t.storeContexts(e.contexts)}if(e.name){t.storeName(e.name)}if(e.transportId){t.setRequest(e.transportId)}t.storeContent(e.content||t.getContent())}function p(e,n,a){const r=a.getRevertData()||[];const i={...a.getContent()};const o={previousContent:{...i},previousState:a.getState(),change:t(e,["favorite","visible","executeOnSelection","contexts","content","name"])};r.push(o);a.setRevertData(r);if(e.executeOnSelection!==undefined){i.executeOnSelection=e.executeOnSelection}if(e.favorite!==undefined){i.favorite=e.favorite}if(e.visible!==undefined){i.visible=e.visible}if(e.contexts){i.contexts=e.contexts}if(e.content){i.variantContent=e.content}if(e.adaptationId){a.setAdaptationId(e.adaptationId)}if(e.name){a.setText("variantName",e.name)}a.setContent(i);if(e.transportId){a.setRequest(e.transportId)}s(e,n,L.operationType.UpdateVariantViaChangeUpdate,a);l(n,[a]);f.getCompEntitiesDataSelector().checkUpdate({reference:e.reference})}function d(e,t){const n={};["favorite","visible","executeOnSelection","contexts"].forEach(t=>{if(e[t]!==undefined){n[t]=e[t]}});if(e.content!==undefined){n.variantContent=e.content}const a=o.createUIChange({changeType:"updateVariant",layer:e.layer,fileType:"change",reference:e.reference,packageName:e.packageName,content:n,selector:{persistencyKey:e.persistencyKey,variantId:t.getVariantId()}});const r=e.adaptationId||e?.changeSpecificData?.adaptationId;if(r){a.setAdaptationId(r)}if(e.name){a.setText("variantName",e.name,"XFLD",true)}if(e.transportId){a.setRequest(e.transportId)}u.addDirtyFlexObjects(e.reference,[a]);s(e,t,L.operationType.NewChange,a);l(t,[a]);f.getCompEntitiesDataSelector().checkUpdate({reference:e.reference})}const g=f.getVariant(e);const y=U(e);e.layer||=y;if(e.forceCreate){d(e,g)}else if(a(g,y)){c(e,g)}else{const t=r(g);if(t){p(e,g,t)}else{d(e,g)}}f.getCompEntitiesDataSelector().checkUpdate({reference:e.reference});return g};L.discardVariantContent=function(e){const t=f.getVariant(e);const n=t.getRevertData();if(n.length!==0){const t=n.slice().reverse().some(function(t){e.layer=t.getChange()?.getLayer();if(t.getContent().previousAction===L.updateActionType.SAVE){e.content=t.getContent().previousContent;e.action=L.updateActionType.DISCARD;return true}});if(!t){e.content=n[0].getContent().previousContent;e.action=L.updateActionType.DISCARD}L.updateVariant(e)}return t};L.updateActionType={UPDATE:"update",SAVE:"save",DISCARD:"discard",UPDATE_METADATA:"update_metadata"};L.operationType={StateUpdate:"StateUpdate",ContentUpdate:"ContentUpdate",NewChange:"NewChange",UpdateVariantViaChange:"UpdateVariantViaChange",UpdateVariantViaChangeUpdate:"UpdateVariantViaChangeUpdate"};L.removeVariant=function(e){const t=f.getVariant(e);const n=t.getState();if(!e.revert){const e=new i({type:L.operationType.StateUpdate,content:{previousState:n}});t.addRevertData(e)}t.markForDeletion();u.getFlexObjectsDataSelector().checkUpdate({reference:e.reference});return t};L.revert=function(e){const n=f.getVariant(Object.assign({includeDeleted:true},e));const a=n.getRevertData().pop();n.removeRevertData(a);const r=a.getContent();let i;let o;switch(a.getType()){case L.operationType.ContentUpdate:E(n,{name:r.previousName,content:r.previousContent,favorite:r.previousFavorite,executeOnSelection:r.previousExecuteOnSelection,contexts:r.previousContexts,...t(e,["reference","persistencyKey","id"])});break;case L.operationType.NewChange:i=a.getChange();u.removeDirtyFlexObjects(i.getFlexObjectMetadata().reference,[i]);F(n,{name:r.previousName,content:r.previousContent,favorite:r.previousFavorite,executeOnSelection:r.previousExecuteOnSelection,contexts:r.previousContexts,...t(e,["reference","persistencyKey","id"])});break;case L.operationType.UpdateVariantViaChangeUpdate:i=a.getChange();F(n,{...{name:r.previousName,content:r.previousContent,favorite:r.previousFavorite,executeOnSelection:r.previousExecuteOnSelection,contexts:r.previousContexts},...t(e,["reference","persistencyKey","id"])});o=i.getRevertData().pop();i.setContent(o.previousContent);i.setState(o.previousState);break;case L.operationType.StateUpdate:default:break}n.setState(r.previousState);f.getCompEntitiesDataSelector().checkUpdate({reference:e.reference});return n};L.overrideStandardVariant=function(e){const t=f.assembleVariantList(e);const n=t.find(e=>e.getStandardVariant());n.setExecuteOnSelection(!!e.executeOnSelection);f.applyChangesOnVariants(e.reference,e.persistencyKey,[n])};L.persist=async function(e){async function t(t,a,r){if(t.getLayer()===n.PUBLIC){t.setFavorite(false)}const i=await y.write({flexObjects:[t.convertToFileContent()],layer:t.getLayer(),transport:t.getRequest(),isLegacyVariant:t.isVariant&&t.isVariant(),parentVersion:r});if(i?.response?.[0]){t.setResponse(i.response[0]);if(r){v.onAllChangesSaved({reference:i.response[0].reference,layer:i.response[0].layer,draftFilenames:[i.response[0].fileName]})}}else{t.setState(c.LifecycleState.PERSISTED)}const o=t.convertToFileContent();x(a.changes.comp,t).push(o);u.getFlexObjectsDataSelector().checkUpdate({reference:e.reference});return o}function a(n,a,r){switch(n.getState()){case c.LifecycleState.NEW:b(n);return t(n,a,r);case c.LifecycleState.UPDATED:b(n);return h(n,a,r,e.reference);case c.LifecycleState.DELETED:if(n._sPreviousState!==c.LifecycleState.NEW){b(n);return D(n,a,r,e.reference)}return Promise.resolve();default:return undefined}}const r=f.getCompEntitiesByPersistencyKey(e);const i=await u.getStorageResponse(e.reference);const o=r.filter(T);const s=o.map(async(e,t)=>{if(t===0){const t=C("/persistedVersion",{layer:e.getLayer(),reference:e.getFlexObjectMetadata().reference});await a(e,i,t);const n=o.map((e,n)=>{if(n!==0){const n=t?g.Number.Draft:undefined;return a(e,i,n)}return undefined});return Promise.all(n)}return undefined});return Promise.all(s)};L.filterHiddenFlexObjects=function(e,t){const n=f.getCompEntities({reference:t}).filter(e=>e.getFileType()==="variant").map(e=>e.getId());return e.filter(e=>{if(e.getFileType()==="change"){if(e.getChangeType()==="updateVariant"){return n.includes(e.getSelector().variantId)}if(e.getChangeType()==="defaultVariant"){return!e.getContent().defaultVariantName||n.includes(e.getContent().defaultVariantName)}}return true})};return L});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/_internal/init", ["sap/ui/fl/apply/_internal/init"],function(){"use strict"});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/Adaptations", ["sap/ui/fl/write/_internal/init"],function(){"use strict";return{UrlParameter:"sap-ui-fl-adaptation",Type:{Default:"DEFAULT",Baseline:"BASELINE",ContextBased:"CONTEXTBASED"}}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/AppVariantWriteAPI", ["sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/write/_internal/SaveAs","sap/ui/fl/write/_internal/connectors/LrepConnector","sap/ui/fl/write/api/FeaturesAPI","sap/ui/fl/write/_internal/Versions","sap/ui/fl/write/_internal/init"],function(e,r,t,i,n){"use strict";var a=function(r,i){if(!i.layer){return Promise.reject("Layer must be provided")}i.reference=e.getFlexReferenceForSelector(i.selector);i.url="/sap/bc/lrep";return t.appVariant[r](i)};var s={saveAs(t){if(!t.layer){return Promise.reject("Layer must be provided")}if(!t.id){return Promise.reject("App variant ID must be provided")}t.reference=e.getFlexReferenceForSelector(t.selector);return i.isVersioningEnabled(t.layer).then(function(e){if(e){t.parentVersion=n.getVersionsModel(t).getProperty("/displayedVersion")}return r.saveAs(t)})},deleteAppVariant(t){if(!t.layer){return Promise.reject("Layer must be provided")}t.id=e.getFlexReferenceForSelector(t.selector);return r.deleteAppVariant(t)},listAllAppVariants(e){if(!e.layer){return Promise.reject("Layer must be provided")}return a("list",e)},getManifest(e){if(!e.layer){return Promise.reject("Layer must be provided")}if(!e.appVarUrl){return Promise.reject("appVarUrl must be provided")}return t.appVariant.getManifest(e)},assignCatalogs(e){if(!e.layer){return Promise.reject("Layer must be provided")}if(!e.assignFromAppId){return Promise.reject("assignFromAppId must be provided")}if(!e.action){return Promise.reject("action must be provided")}return a("assignCatalogs",e)},unassignCatalogs(e){if(!e.layer){return Promise.reject("Layer must be provided")}if(!e.action){return Promise.reject("action must be provided")}return a("unassignCatalogs",e)}};return s});
/*
 * ! OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/BusinessNetworkAPI", ["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/write/_internal/Storage","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],(e,a,n,r,t,i,s,c,l,o)=>{"use strict";const f={};f.createAndSaveVariant=async function(e){const r={id:e.id,variantManagementReference:e.variantManagementReference,variantReference:e.variantReference||e.variantManagementReference,variantName:e.variantName,layer:e.layer||l.CUSTOMER,user:e.author||a.DEFAULT_AUTHOR,reference:e.reference,generator:e.generator||"BusinessNetworkAPI.createVariant"};const t=[n.createFlVariant(r)];const i=await c.condense({layer:e.layer||l.CUSTOMER,reference:e.reference,allChanges:t,condensedChanges:t});return i.response};f.createDefaultVariant=function(a){const r=o.getAppComponentForControl(a.control);const t=i.getFlexReferenceForControl(r);const c=r.getLocalId(a.control.getId())||a.control.getId();const f={id:a.id,variantManagementReference:c,variantReference:a.variantReference||c,variantName:a.variantName,reference:t,layer:a.layer||l.USER,generator:a.generator||"BusinessNetworkAPI.createDefaultVariant"};const u=[n.createFlVariant(f)];u.push(n.createVariantManagementChange({changeType:"setDefault",layer:f.layer,generator:f.generator,reference:t,selector:e.getSelector(a.control,r),content:{defaultVariant:f.variantReference}}));s.addDirtyFlexObjects(t,u);return u};f.save=function(e){return s.saveFlexObjects({selector:e,includeCtrlVariants:true})};f.disablePersonalization=function(e){const a=t.getByReference(e);if(!a||Object.keys(a).length===0){throw new Error(`Invalid reference provided: ${e}`)}a.maxLayer=l.CUSTOMER;a.saveChangeKeepSession=true;t.setByReference(a,e);window.sessionStorage.setItem("sap.ui.rta.skipReload",true)};f.deleteVariants=async function(e){const a=e.layer||l.CUSTOMER;const t="variants";const i=e.variants.map(n=>({fileName:n,fileType:"ctrl_variant",layer:a,reference:e.reference,namespace:`apps/${e.reference}/${t}/`})).map(e=>n.createFromFileContent(e));i.forEach(e=>{e.condenserState="delete";e.setState(r.LifecycleState.DELETED)});await c.condense({layer:a,reference:e.reference,allChanges:i,condensedChanges:i})};f.resetPersonalizationVariants=function(e){return c.deleteUserVariantsForVM({flexReference:e.reference,variantManagementReferences:[e.variantManagementReference],layer:l.USER})};return f});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/ChangesWriteAPI", ["sap/base/util/restricted/_omit","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Component","sap/ui/core/Element","sap/ui/core/Lib","sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/changes/Utils","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/apply/_internal/flexState/FlexObjectState","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/descriptorRelated/api/DescriptorChangeFactory","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/write/_internal/appVariant/AppVariantInlineChangeFactory","sap/ui/fl/write/_internal/controlVariants/ControlVariantWriteUtils","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/write/api/ContextBasedAdaptationsAPI","sap/ui/fl/write/api/FeaturesAPI","sap/ui/fl/write/api/VersionsAPI","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],function(e,t,n,a,r,i,o,c,p,l,s,g,f,h,u,d,C,m,y,S,D,v,F,w,x){"use strict";var T={};function I(e){let n;if(e.changeSpecificData.layer){n=e.changeSpecificData.layer;delete e.changeSpecificData.layer}const a={changeType:e.changeSpecificData.changeType,content:e.changeSpecificData.content};if(e.changeSpecificData.texts){a.texts=e.changeSpecificData.texts}if(e.changeSpecificData.support){a.support={compositeCommand:e.changeSpecificData.support.compositeCommand||""}}if(e.changeSpecificData.adaptationId){a.adaptationId=e.changeSpecificData.adaptationId}return m.createDescriptorInlineChange(a).then(t=>(new d).createNew(e.changeSpecificData.reference,t,n,undefined,e.generator)).catch(e=>{t.error("the change could not be created.",e.message);throw e})}async function A(e){const t=await C.getAnnotationChangeHandler({changeType:e.changeSpecificData.changeType});const a=s.createAnnotationChange(e.changeSpecificData);t.completeChangeContent(a,e.changeSpecificData,{modifier:n,appComponent:e.appComponent});return a}function _(e){const a=s.createUIChange(e.changeSpecificData);return C.getChangeHandler(a.getChangeType(),e.controlType,e.selector,n,a.getLayer()).then(r=>{const i={...e.changeSpecificData};if(i.content){Object.keys(i.content).forEach(e=>{if(!i[e]){i[e]=i.content[e]}else{t.warning(`The property '${e}' is defined both in the change specific data and its content.`)}})}return r.completeChangeContent(a,i,{modifier:n,appComponent:e.appComponent,view:x.getViewForControl(e.selector)})}).then(()=>{a.setState(g.LifecycleState.NEW);return a})}T.create=function(e){const{changeSpecificData:t,selector:r}=e;if(t.changeType==="codeExt"){return s.createControllerExtensionChange(t)}e.appComponent=x.getAppComponentForSelector(r.view||r);if(r?.appId||u.getFlexReferenceForControl(e.appComponent)){t.reference=r?.appId||u.getFlexReferenceForControl(e.appComponent)}const i={layer:t.layer,control:e.appComponent,reference:t.reference};if(D.hasAdaptationsModel(i)){t.adaptationId=D.getDisplayedAdaptationId(i)}if(o.getChangeTypes().includes(t.changeType)){return I(e)}if(e.changeSpecificData.changeType==="deactivateChanges"){return s.createFlexObject(e.changeSpecificData)}if(e.annotationChange){return A(e)}if(r instanceof a){return Promise.resolve(s.createUIChange(t))}if(r.name&&r.view){t.selector={name:r.name,viewSelector:n.getSelector(r.view.getId(),e.appComponent)};return _(e)}const c=r.id||r.getId();t.selector||={};Object.assign(t.selector,n.getSelector(c,e.appComponent));e.controlType=r.controlType||x.getControlType(r);return _(e)};T.apply=function(t){if(!(t.element instanceof r)){return Promise.reject("Please provide an Element")}t.appComponent=x.getAppComponentForSelector(t.element);t.modifier||=n;return c.applyChangeOnControl(t.change,t.element,e(t,["element","change"])).then(function(e){var a=h.getOpenDependentChangesForControl(n.getControlIdBySelector(t.change.getSelector(),t.appComponent),t.appComponent);if(a.length>0){return T.revert({change:t.change,element:t.element}).then(function(){var e=i.getResourceBundleFor("sap.ui.fl");var n=a.map(function(e){return e.getId()}).join(", ");throw Error(e.getText("MSG_DEPENDENT_CHANGE_ERROR",[t.change.getId(),n]))})}return e})};T.revert=function(e){var t=x.getAppComponentForSelector(e.element||{});var a=[];var r={modifier:n,appComponent:t};if(!Array.isArray(e.change)){return p.revertChangeOnControl(e.change,e.element,r)}var i=e.change.slice(0).reverse();return i.reduce(function(t,n){return t.then(function(){return p.revertChangeOnControl(n,e.element,r).then(function(e){a.unshift(e)})})},Promise.resolve()).then(function(){return a})};T.getChangeHandler=function(e){var t=e.controlType||e.modifier?.getControlType(e.element);return l.getChangeHandler({changeType:e.changeType,control:e.element,controlType:t,modifier:e.modifier,layer:e.layer,appDescriptorChange:e.appDescriptorChange,annotationChange:e.annotationChange})};T.deleteVariantsAndRelatedObjects=function(e){if(!e.variantManagementControl?.isA("sap.ui.fl.variants.VariantManagement")){throw new Error("Please provide a valid Variant Management control")}const a=e.variantManagementControl;const r=x.getAppComponentForControl(a);const i=n.getSelector(a,r).id;const o=u.getFlexReferenceForControl(r);let c=e.variants.filter(n=>{const a=f.getVariant({vmReference:i,reference:o,vReference:n});if(!a){t.warning(`Variant with ID '${n}' does not exist in the Variant Management control.`);return false}return a.layer===e.layer});if(!e.forceDelete){const t=F.getDraftFilenames({control:a,layer:e.layer});const n=h.getDirtyFlexObjects(o).map(e=>e.getId());c=c.filter(e=>t.includes(e)||n.includes(e))}return c.map(e=>y.deleteVariant(o,i,e)).flat()};T.restoreDeletedFlexObjects=function(e){S.restoreDeletedFlexObjects(e)};return T});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/ContextBasedAdaptationsAPI", ["sap/ui/core/Lib","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexState/controlVariants/VariantManagementState","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/fl/apply/_internal/flexState/compVariants/applyChangesOnVariant","sap/ui/fl/apply/_internal/flexState/compVariants/CompVariantManagementState","sap/ui/fl/write/_internal/flexState/compVariants/CompVariantManager","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/write/_internal/Storage","sap/ui/fl/write/_internal/Versions","sap/ui/fl/write/api/Adaptations","sap/ui/fl/write/api/FeaturesAPI","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/model/json/JSONModel","sap/ui/fl/write/_internal/init"],function(e,t,n,r,a,i,o,s,l,d,c,p,u,f,y,v,g){"use strict";var h={};var A;var I=[f.VENDOR,f.PARTNER,f.CUSTOMER_BASE,f.CUSTOMER];var x={};function m(e){var t=r.getFlexReferenceForControl(e);if(!t){throw Error("The application ID could not be determined")}return t}function C(e,t,n){if(n){return c.updateModelFromBackend({reference:t.appId,layer:t.layer}).then(function(){return e})}c.onAllChangesSaved({reference:t.appId,layer:t.layer,contextBasedAdaptation:true});return Promise.resolve(e)}x.initialize=function(t){A||=e.getResourceBundleFor("sap.ui.fl");if(!t.layer){return Promise.reject("No layer was provided")}if(!t.control){return Promise.reject("No control was provided")}var n=m(t.control);t.reference=n;var r=t.layer;if(h&&h[n]&&h[n][r]){return Promise.resolve(h[n][r])}var i;return u.isContextBasedAdaptationAvailable(r).then(function(e){i=e;return i?x.load(t):Promise.resolve({adaptations:[]})}).then(function(e){var n=a.getByReference(t.reference);var r=e.adaptations[0];if(n.adaptationId){r=e.adaptations.find(function(e){return e.id===n.adaptationId})||r}return x.createModel(e.adaptations,r,i)}).then(function(e){h[n]||={};h[n][r]||={};h[n][r]=e;return h[n][r]})};x.createModel=function(e,t,n){if(!Array.isArray(e)){throw Error("Adaptations model can only be initialized with an array of adaptations")}if(n&&!t){throw Error("Invalid call, must pass displayed adaptation")}if(!n&&e.length){throw Error("Invalid call, must not pass adaptations if feature is disabled")}const r=new g({allAdaptations:[],adaptations:[],count:0,displayedAdaptation:{},contextBasedAdaptationsEnabled:n});r.updateAdaptations=function(e){const t=e.filter(function(e,t){e.rank=t+1;return e.type!==p.Type.Default});r.setProperty("/adaptations",t);r.setProperty("/allAdaptations",e);r.setProperty("/count",t.length);let n=r.getProperty("/displayedAdaptation");const a=e.find(function(e){return!!n&&e.id===n.id});if(a){n={...a};r.setProperty("/displayedAdaptation",n)}r.updateBindings(true)};r.insertAdaptation=function(e){const t=r.getProperty("/allAdaptations");t.splice(e.priority,0,e);delete e.priority;r.updateAdaptations(t)};r.deleteAdaptation=function(){const e=r.getProperty("/displayedAdaptation").rank-1;const t=r.getProperty("/adaptations");const n=r.getProperty("/count");let a;if(n>1){a=t[e+(e===n-1?-1:1)].id}t.splice(e,1);const i=r.getProperty("/allAdaptations").pop();t.push(i);r.updateAdaptations(t);return a};r.switchDisplayedAdaptation=function(e){const t=r.getIndexByAdaptationId(e);const n=t?r.getProperty("/allAdaptations")[t]:r.getProperty("/allAdaptations")[0];r.setProperty("/displayedAdaptation",n);r.updateBindings(true)};r.updateAdaptationContent=function(e){const t=r.getProperty("/allAdaptations");const n=t.find(function(t){return e.adaptationId===t.id});n.title=e.title;n.contexts=e.contexts;const a=n.rank-1;if(a!==e.priority){const n=t.splice(a,1);t.splice(e.priority,0,n[0])}r.updateAdaptations(t)};r.getIndexByAdaptationId=function(e){const t=r.getProperty("/allAdaptations");const n=t.findIndex(function(t){return t.id===e});return n>-1?n:undefined};if(e.length>0){r.updateAdaptations(e);r.setProperty("/displayedAdaptation",t)}return r};x.getAdaptationsModel=function(e){if(!e.layer){throw Error("No layer was provided")}if(!e.control){throw Error("No control was provided")}e.reference=m(e.control);var t=e.reference;var n=e.layer;if(!x.hasAdaptationsModel(e)){throw Error(`Adaptations model for reference '${t}' and layer '${n}' were not initialized.`)}return h[t][n]};x.getDisplayedAdaptationId=function(e){var t=this.getAdaptationsModel(e).getProperty("/displayedAdaptation/id");return t!==p.Type.Default?t:undefined};x.hasAdaptationsModel=function(e){var t=e.reference;var n=e.layer;return h[t]&&h[t][n]};x.adaptationExists=function(e){var t=e.reference;var n=e.layer;return this.hasAdaptationsModel({reference:t,layer:n})&&h[t][n].getProperty("/count")>0};x.clearInstances=function(){h={}};x.refreshAdaptationModel=function(e){this.clearInstances();return this.initialize(e).then(function(e){return e.getProperty("/displayedAdaptation/id")})};function V(e,t){return e.get(t)||t}function P(e,t){return d.contextBasedAdaptation.create({layer:e.layer,flexObject:t,appId:e.appId,parentVersion:S(e)}).then(function(n){var r=this.getAdaptationsModel(e);r.insertAdaptation(t);return C(n,e)}.bind(this))}function w(e,t){return d.write({layer:e.layer,flexObjects:t,transport:"",isLegacyVariant:false,parentVersion:S(e)})}function j(e,t,n){if(n.isA("sap.ui.fl.apply._internal.flexObjects.CompVariant")){var r=t.filter(function(e){return e.getChangeType()==="updateVariant"&&e.getSelector().variantId===n.getId()});var a=n.clone();i(a,r);a.destroy();return a.mProperties}return e.find(function(e){return e.key===n.getId()})}function b(e,t){var n={};var r=[];e.forEach(function(e){var a=t[e.getId()];if(a.visible){var i=true;var o=Object.keys(a.contexts);o.forEach(function(t){var r=Array.from(a.contexts[t]);r.forEach(function(t){i=false;if(n[t]){n[t].variants.push(e)}else{n[t]={contextBasedAdaptationId:v.createDefaultFileName(),variants:[e]}}})});if(i){r.push(e)}}});return{uniqueContexts:n,unrestrictedViews:r}}function O(e,t,n,r){if(e.isA("sap.ui.fl.apply._internal.flexObjects.CompVariant")){var a=e.getPersistencyKey();e=s.updateVariant({reference:t.appId,persistencyKey:a,id:e.getId(),layer:t.layer,visible:false,adaptationId:n,forceCreate:true});return o.getVariantChanges(e).reverse()[0].convertToFileContent()}var i=v.getAppComponentForControl(t.control);var l=r.createVariantChange(e.getVariantManagementReference(),{changeType:"setVisible",visible:false,variantReference:e.getId(),layer:t.layer,appComponent:i,adaptationId:n});return l.convertToFileContent()}function E(e,t,n){return e.filter(e=>n===e.isA("sap.ui.fl.apply._internal.flexObjects.Variant")&&e.getLayer()===t)}function F(e){var t=e.getFileType();if(t==="change"){if(e.getSelector().variantId){return e.getSelector().variantId}if(e.getVariantReference()){return e.getVariantReference()}}else if(t==="ctrl_variant_change"){return e.getVariantId()}return undefined}function M(e){return e.getFileType()==="ctrl_variant_change"&&e.getChangeType()==="setContexts"}function B(e,t){return t.filter(function(t){var n=F(t);if(M(t)){return false}return!n||e.indexOf(n)<0})}function T(e,t){var n=[];var r=[];var a=new Map;e.forEach(function(e){if(e.isA("sap.ui.fl.apply._internal.flexObjects.Variant")){n.push(e)}else{r.push(e)}});var i=N(n,a,t);var o=_(r,a,t);return i.concat(o).map(function(e){return e.convertToFileContent()})}function N(e,n,r){var a=[];e.forEach(function(e){var i=t.createFromFileContent(e.cloneFileContentWithNewId());i.setAdaptationId(r);i.setContexts();n.set(e.getId(),i.getId());a.push(i)});return a}function _(e,n,r){const a=[];e.forEach(function(e){const i=t.createFromFileContent(e.cloneFileContentWithNewId());const o=i.getContent();if(e.getFileType()==="change"){if(e.getSelector().variantId){const e=i.getSelector();e.variantId=V(n,i.getSelector().variantId);i.setSelector(e)}else if(e.getContent().defaultVariantName){o.defaultVariantName=V(n,i.getContent().defaultVariantName);i.setContent(o)}if(e.getVariantReference()){i.setVariantReference(V(n,i.getVariantReference()))}if(e.getChangeType()==="updateVariant"){delete i.getContent().contexts;if(!Object.keys(i.getContent()).length){return}}}else if(e.getFileType()==="ctrl_variant_change"){i.setVariantId(V(n,i.getVariantId()))}else if(e.getFileType()==="ctrl_variant_management_change"&&e.getContent().defaultVariant){o.defaultVariant=V(n,i.getContent().defaultVariant);i.setContent(o)}i.setAdaptationId(r);a.push(i)});return a}function S(e){return c.getVersionsModel({layer:e.layer,reference:e.appId}).getProperty("/persistedVersion")}function R(e,t,n,r,a){var i={contextBasedAdaptations:[],flexObjects:[]};var o={};e.forEach(function(e){o[e.getId()]=j(t,n,e)});var s=b(e,o);var l=s.uniqueContexts;var d=s.unrestrictedViews;Object.entries(l).forEach(function(t){var o=t[0];var s=t[1];s.variants=s.variants.concat(d);var l=s.contextBasedAdaptationId;var c={id:l,title:A.getText("CBA_MIGRATED_ADAPTATION_TITLE",[o]),contexts:{role:[o]},priority:0};i.contextBasedAdaptations.push(c);var p=s.variants.filter(function(e){return e.getLayer()===f.CUSTOMER});var u=new Map;var y=N(p,u,l);y.forEach(function(e){i.flexObjects.push(e.convertToFileContent())});var v=s.variants.map(function(e){return e.getId()});var g=e.map(function(e){return e.getId()}).filter(function(e){return v.indexOf(e)<0});var h=B(g,n);var I=_(h,u,l);I.forEach(function(e){i.flexObjects.push(e.convertToFileContent())});e.forEach(function(e){if(e.getLayer()!==f.CUSTOMER&&v.indexOf(e.getId())<0){i.flexObjects.push(O(e,r,l,a))}})});e.forEach(function(e){var t=o[e.getId()];var n=d.indexOf(e)<0;if(t.visible===true&&n){i.flexObjects.push(O(e,r,undefined,a))}});return i}function D(){return new Promise(function(e){sap.ui.require(["sap/ui/fl/variants/VariantManager"],function(t){e(t)})})}x.migrate=async function(e){e.appId=m(e.control);var t=S(e);e.parentVersion=t;var a=[];var i=n.getAllVariants(r.getFlexReferenceForControl(e.control));var o={contextBasedAdaptation:[],flexObjects:[]};const s=await D();return l.getFlexObjects({selector:e.control,includeManifestChanges:true,includeAnnotationChanges:true,includeCtrlVariants:true,includeDirtyChanges:true}).then(function(e){I.forEach(function(t){a.push(E(e,t,true))});a.push(E(e,f.CUSTOMER,false));return Promise.all(a)}).then(function(t){var n=t.pop();var r=t.flat();o=R(r,i,n,e,s);var a=Promise.resolve();o.contextBasedAdaptations.forEach(function(t){a=a.then(P.bind(this,e,t))}.bind(this));return a}.bind(this)).then(function(){if(o.flexObjects.length>0){return w(e,o.flexObjects)}return Promise.resolve()}).then(function(){return this.refreshAdaptationModel({control:e.control,layer:e.layer})}.bind(this))};x.canMigrate=function(e){var t=x.getAdaptationsModel(e);if(t.getProperty("/count")!==0){return Promise.resolve(false)}return l.getFlexObjects({selector:e.control,invalidateCache:false,includeCtrlVariants:true,includeDirtyChanges:true}).then(function(t){var a=[];I.forEach(function(e){a.push(E(t,e,true))});a=a.flat();var i=n.getAllVariants(r.getFlexReferenceForControl(e.control));return a.some(function(e){var n=j(i,t,e);return n.visible===true&&Object.keys(n.contexts).some(function(e){return n.contexts[e].length!==0})})})};x.create=function(e){if(!e.layer){return Promise.reject("No layer was provided")}if(!e.control){return Promise.reject("No control was provided")}if(!e.contextBasedAdaptation){return Promise.reject("No contextBasedAdaptation was provided")}e.contextBasedAdaptation.id=v.createDefaultFileName();e.appId=m(e.control);return P.call(this,e,e.contextBasedAdaptation).then(function(){return l.getFlexObjects({selector:e.control,includeManifestChanges:true,includeAnnotationChanges:true,invalidateCache:false,includeCtrlVariants:true,includeDirtyChanges:true,currentLayer:f.CUSTOMER})}).then(function(t){var n=y.filterChangeOrChangeDefinitionsByCurrentLayer(t,f.CUSTOMER);var r=T(n,e.contextBasedAdaptation.id);return w(e,r)})};x.update=function(e){if(!e.layer){return Promise.reject("No layer was provided")}if(!e.control){return Promise.reject("No control was provided")}if(!e.contextBasedAdaptation){return Promise.reject("No contextBasedAdaptation was provided")}if(!e.adaptationId){return Promise.reject("No adaptationId was provided")}e.appId=m(e.control);return d.contextBasedAdaptation.update({layer:e.layer,flexObject:e.contextBasedAdaptation,appId:e.appId,adaptationId:e.adaptationId,parentVersion:S(e)}).then(function(t){return C(t,e)})};x.reorder=function(e){if(!e.layer){return Promise.reject("No layer was provided")}if(!e.control){return Promise.reject("No control was provided")}if(!e.parameters||!e.parameters.priorities){return Promise.reject("No valid priority list was provided")}e.appId=m(e.control);return d.contextBasedAdaptation.reorder({layer:e.layer,flexObjects:e.parameters,appId:e.appId,parentVersion:S(e)}).then(function(t){return C(t,e)})};x.load=function(e){if(!e.layer){return Promise.reject("No layer was provided")}if(!e.control){return Promise.reject("No control was provided")}e.appId=m(e.control);return d.contextBasedAdaptation.load({layer:e.layer,appId:e.appId,version:S(e)}).then(function(e){e||={adaptations:[]};return e})};x.remove=function(e){if(!e.layer){return Promise.reject("No layer was provided")}if(!e.control){return Promise.reject("No control was provided")}if(!e.adaptationId){return Promise.reject("No adaptationId was provided")}e.appId=m(e.control);return d.contextBasedAdaptation.remove({layer:e.layer,appId:e.appId,adaptationId:e.adaptationId,parentVersion:S(e)}).then(function(t){return C(t,e,true)})};return x});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/ContextSharingAPI", ["sap/ui/core/Component","sap/ui/core/ComponentContainer","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/write/api/ContextBasedAdaptationsAPI","sap/ui/fl/Layer","sap/ui/fl/write/_internal/init"],function(e,t,n,a,i,r){"use strict";let o=Promise.resolve();var s={async isContextSharingEnabled(e){if(e.layer!==r.CUSTOMER){return false}const t=n.getFlexReferenceForControl(e.variantManagementControl);const o=await a.getInstance();const s=o.getIsContextSharingEnabled()&&!i.adaptationExists({reference:t,layer:r.CUSTOMER});return s},async createComponent(n){if(await this.isContextSharingEnabled(n)){o=o.then(async n=>{if(n&&!n.isDestroyed()){return n}const a=await e.create({name:"sap.ui.fl.variants.context",id:"contextSharing"});a.showMessageStrip(true);a.setSelectedContexts({role:[]});n=new t("contextSharingContainer",{component:a});await a.getRootControl().oAsyncState.promise;return n});return o}return undefined}};return s});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/ControlPersonalizationWriteAPI", ["sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/core/Element","sap/ui/fl/apply/_internal/changes/Reverter","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexState/FlexObjectState","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/api/ControlVariantApplyAPI","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/initial/_internal/changeHandlers/ChangeHandlerStorage","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/write/_internal/flexState/changes/UIChangeManager","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],function(e,t,n,r,o,a,c,l,i,s,p,f,u,g,d,h){"use strict";var m={};function C(e,r){if(!e.changeSpecificData){return Promise.reject(new Error("No changeSpecificData available"))}if(!e.changeSpecificData.changeType){return Promise.reject(new Error("No valid changeType"))}if(!(e.selectorControl instanceof n)){return Promise.reject(new Error("No valid selectorControl"))}var o=e.selectorControl.getMetadata().getName();return s.getChangeHandler(e.changeSpecificData.changeType,o,e.selectorControl,t,r)}function y(e,n,r){var a=o.getRelevantVariantManagementControlId(n,[],r);return t.getSelector(a,e).id}function v(t){e.error(t);return Promise.reject(t)}var S={async add(t){if(!t.changes.length){return Promise.resolve([])}const n=t.changes[0].selectorElement||t.changes[0].selectorControl;const r=h.getAppComponentForControl(n);const o=i.getFlexReference({element:n});const a=r.getModel(l.getVariantModelName());const c=d.USER;const s=[];const p={};function v(){const n=[];const l=[];return t.changes.reduce(function(o,i){return o.then(function(){i.selectorControl=i.selectorElement;return C(i,c)}).then(function(){if(!i.transient&&!t.ignoreVariantManagement){if(!i.changeSpecificData.variantReference){let e;const n=i.selectorControl.getId();e=p[n]||y(r,i.selectorControl,t.useStaticArea);if(!e&&!t.useStaticArea){e=y(r,i.selectorControl,true)}if(e){p[n]=e;const t=a.oData[e].currentVariant;i.changeSpecificData.variantReference=t}}}else{delete i.changeSpecificData.variantReference}i.changeSpecificData={...i.changeSpecificData,developerMode:false,layer:c};return g.create({changeSpecificData:i.changeSpecificData,selector:i.selectorControl})}).then(function(e){if(!i.transient){l.push(e)}n.push({changeInstance:e,selectorControl:i.selectorControl})}).catch(function(t){e.error("A Change was not created successfully. Reason: ",t.message)})},Promise.resolve()).then(function(){f.addDirtyChanges(o,l,r);return n}).catch(function(t){e.error("Changes were not added successfully. Reason: ",t.message)})}function S(t){return t.reduce(function(t,n){return t.then(function(){n.changeInstance.setQueuedForApply();return g.apply({change:n.changeInstance,element:n.selectorControl})}).then(function(e){if(e.success){s.push(n.changeInstance)}else{throw e.error||new Error("ChangesWriteAPI.apply failed with unspecified error")}}).catch(function(t){u.deleteFlexObjects({reference:o,flexObjects:[n.changeInstance]});e.error("A Change was not applied successfully. Reason: ",t.message)})},Promise.resolve())}const I=await v();await S(I);(m[o]||[]).forEach(function(e){e(s)});return s},reset(e){if(!e.selectors||e.selectors.length===0){return v("At least one control ID has to be provided as a parameter")}var t=e.selectors[0].appComponent||h.getAppComponentForControl(e.selectors[0]);if(!t){return v("App Component could not be determined")}var n=e.selectors.map(function(e){var n=e.id||e.getId();var r=t.getLocalId(n);return r||n});return u.resetFlexObjects({layer:d.USER,appComponent:t,selectorIds:n,changeTypes:e.changeTypes})},async restore(e){if(!e||!e.selector){return Promise.reject("No selector was provided")}var n=h.getAppComponentForControl(e.selector);if(!n){return Promise.reject("App Component could not be determined")}const o=i.getFlexReference({element:e.selector});if(c.isInitialized({control:n})){const a=u.removeDirtyFlexObjects({reference:o,layers:d.USER,component:n,control:e.selector,generator:e.generator,changeTypes:e.changeTypes});if(a.length!==0){await r.revertMultipleChanges([...a].reverse(),{appComponent:n,modifier:t,reference:o})}}return undefined},hasDirtyFlexObjects(e){if(!e||!e.selector){throw Error("No selector was provided")}var n=h.getAppComponentForControl(e.selector);if(!n){throw Error("App Component could not be determined")}const r=i.getFlexReference({element:e.selector});var o=a.getDirtyFlexObjects(r);return o.some(function(r){if(r.getLayer()!==d.USER){return false}if(e.generator&&r.getSupportInformation().generator!==e.generator){return false}if(e.changeTypes&&e.changeTypes.indexOf(r.getChangeType())===-1){return false}var o=r.getSelector();return e.selector.getId()===t.getControlIdBySelector(o,n)})},save(e){var t=e.selector.appComponent||h.getAppComponentForControl(e.selector);if(!t){return v("App Component could not be determined")}if(c.isInitialized({control:t})){return u.saveFlexObjects({flexObjects:e.changes,selector:t})}return Promise.resolve()},buildSelectorFromElementIdAndType(e){var t=h.getAppComponentForControl(e.element);if(!t||!e.elementId||!e.elementType){throw new Error("Not enough information given to build selector.")}return{elementId:e.elementId,elementType:e.elementType,appComponent:t,id:e.elementId,controlType:e.elementType}},async isCondensingEnabled(){const e=await p.getInstance();return e.getIsCondensingEnabled()},attachChangeCreation(e,t){var n=i.getFlexReference({element:e});m[n]=(m[n]||[]).concat(t)},detachChangeCreation(e,t){var n=i.getFlexReference({element:e});if(Array.isArray(m[n])){m[n]=m[n].filter(function(e){return e!==t})}},detachAllChangeCreationListeners(e){if(e){var t=i.getFlexReference({element:e});delete m[t]}else{m={}}}};return S});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/FeaturesAPI", ["sap/ui/fl/initial/_internal/Settings","sap/ui/fl/initial/api/InitialFlexAPI","sap/ui/fl/write/_internal/Storage","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],function(e,t,n,a,s){"use strict";var r={isPublishAvailable(){return e.getInstance().then(function(e){return e.getIsPublishAvailable()||!!(!e.getIsProductiveSystem()&&e.getSystem()&&e.getClient())})},isSaveAsAvailable(t){return Promise.all([e.getInstance(),s.getUShellService("Navigation")]).then(function(e){var n=e[0];var s=e[1];return!n.getIsContextBasedAdaptationEnabled()&&n.getIsAppVariantSaveAsEnabled()&&t===a.CUSTOMER&&s!==undefined}).catch(function(){return false})},isContextBasedAdaptationAvailable(t){return e.getInstance().then(function(e){if(e.getIsContextBasedAdaptationEnabled()&&t===a.CUSTOMER){return true}return false})},isKeyUser(){return t.isKeyUser()},async isVersioningEnabled(t){const n=await e.getInstance();const a=n.getVersioning();return!!(a[t]||a.ALL)},isKeyUserTranslationEnabled(t){if(t===a.CUSTOMER){return e.getInstance().then(function(e){return e.getIsKeyUserTranslationEnabled()})}return Promise.resolve(false)},isContextSharingEnabled(t){if(t!==a.CUSTOMER){return Promise.resolve(false)}return e.getInstance().then(function(e){return e.getIsContextSharingEnabled({layer:t})})},async isSeenFeaturesAvailable(){const t=await e.getInstance();return t.getIsSeenFeaturesAvailable()},async getSeenFeatureIds(e){if(!await this.isSeenFeaturesAvailable()){return[]}return n.getSeenFeatureIds(e)},async setSeenFeatureIds(e){if(!await this.isSeenFeaturesAvailable()){return Promise.reject("The backend does not support saving seen features.")}return n.setSeenFeatureIds(e)},isVariantAdaptationEnabled(){const t=e.getInstanceOrUndef();return t?.getIsVariantAdaptationEnabled()},isLocalResetEnabled(){const t=e.getInstanceOrUndef();return t?.getIsLocalResetEnabled()},areAnnotationChangesEnabled(){const t=e.getInstanceOrUndef();return t?.getIsAnnotationChangeEnabled()}};return r});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/FieldExtensibility", ["sap/ui/fl/write/_internal/fieldExtensibility/ABAPAccess","sap/ui/fl/write/_internal/fieldExtensibility/cap/CAPAccess","sap/ui/base/ManagedObject","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],function(e,n,t,i){"use strict";var r={};var a;function s(r){if(!a){if(!(r instanceof t)){return undefined}var s=i.getAppComponentForControl(r);var o=s&&s.getManifestEntry("/sap.ui5/config")||{};var u=new URLSearchParams(window.location.search);if(o.experimentalCAPScenario||u.get("sap-ui-fl-xx-capScenario")==="true"){a=n}else{a=e}}return a}function o(...e){var n=e.shift();var t=s(...e);if(!t){return Promise.reject("Could not determine field extensibility scenario")}return Promise.resolve(t[n].apply(null,e))}r.onControlSelected=function(e){return o("onControlSelected",e)};r.isExtensibilityEnabled=function(e){return o("isExtensibilityEnabled",e)};r.isServiceOutdated=function(e){return o("isServiceOutdated",e)};r.setServiceValid=function(e){return o("setServiceValid",e)};r.getTexts=function(){return o("getTexts")};r.getExtensionData=function(){return o("getExtensionData")};r.onTriggerCreateExtensionData=function(e,n,t){return o("onTriggerCreateExtensionData",e,n,t)};r._resetCurrentScenario=function(){a=null};return r});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/LocalResetAPI", ["sap/base/util/restricted/_union","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexState/changes/UIChangesState","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/write/_internal/flexState/changes/UIChangeManager","sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/fl/write/api/PersistenceWriteAPI","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],function(e,t,n,r,a,i,l,s,o){"use strict";var u={};function c(e,t,i){return r.getAllUIChanges(a.getFlexReferenceForControl(e)).filter(function(e){return e.getFileType()==="change"&&e.getLayer()===t&&e.getState()!==n.LifecycleState.DELETED&&e.getVariantReference()===(i||undefined)})}function f(n){var r=o.getAppComponentForControl(n);var a=[];var i=[];function l(t,r){var s=(r||[]).concat(t);if(t===n||a.includes(t)){a=e(a,s);return true}var o=t.getParent();if(i.includes(t)||!o){i=e(i,s);return false}return l(o,s)}function s(e){return e.getDependentSelectorList().map(function(e){return t.bySelector(e,r)}).filter(Boolean).some(function(e){return l(e)})}return s}u.resetChanges=async function(e,n,r){const a=[];const i=e.slice().reverse();if(!r){a.push(...i.map(function(e){const r=t.bySelector(e.getSelector(),n);return function(){e.setQueuedForRevert();return l.revert({change:e,element:r})}}))}await s.remove({flexObjects:i,selector:n});await o.execPromiseQueueSequentially(a)};u.restoreChanges=async function(e,n,r){const s=a.getFlexReferenceForControl(n);i.restoreDeletedChanges(s,e,n);if(!r){const r=e.map(e=>()=>{const r=t.bySelector(e.getSelector(),n);return l.apply({change:e,element:r,modifier:t})});await o.execPromiseQueueSequentially(r)}};u.getNestedUIChangesForControl=function(e,t){var n=c(e,t.layer,t.currentVariant);var r=f(e);return n.filter(r)};u.isResetEnabled=function(e,t){var n=c(e,t.layer,t.currentVariant);var r=f(e);return n.some(r)};return u});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/PersistenceWriteAPI", ["sap/base/util/restricted/_omit","sap/base/Log","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/appVariant/DescriptorChangeTypes","sap/ui/fl/apply/_internal/changes/FlexCustomData","sap/ui/fl/apply/_internal/flexObjects/UIChange","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/apply/api/FlexRuntimeInfoAPI","sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/fl/initial/_internal/Loader","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/write/_internal/condenser/Condenser","sap/ui/fl/write/_internal/flexState/changes/UIChangeManager","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/write/_internal/Storage","sap/ui/fl/write/api/FeaturesAPI","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],function(e,t,n,r,s,a,i,o,l,c,f,u,g,p,d,h,y,C,x,b){"use strict";var F={};function m(e){return e._getMap&&r.getChangeTypes().includes(e._getMap().changeType)||e.getChangeType&&r.getChangeTypes().includes(e.getChangeType())}function w(e){return F._getUIChanges({...e,includeCtrlVariants:true}).then(function(e){return e.length>0})}F.hasDirtyChanges=function(e){return d.hasDirtyFlexObjects(e)};F.hasHigherLayerChanges=async function(e){e.upToLayer||=x.getCurrentLayer();const t=await d.getFlexObjects(e);const n=t.filter(t=>x.isOverLayer(t.getLayer(),e.upToLayer));if(n.length===0){return false}return d.filterHiddenFlexObjects(n,e.reference).length>0};F.save=async function(t){const n=f.getFlexReferenceForSelector(t.selector);let r=l.getByReference(n);r.saveChangeKeepSession=true;l.setByReference(r,n);await d.saveFlexObjects(t);r.version=t.version;l.setByReference(r,n);const s=await d.getFlexObjects({...e(t,["skipUpdateCache","layer","version"]),invalidateCache:true,currentLayer:t.layer,includeCtrlVariants:true});if(s?.length>0){await F.updateResetAndPublishInfo(t)}r=l.getByReference(n);delete r.saveChangeKeepSession;l.setByReference(r,n);return s};F.updateResetAndPublishInfo=async function(e){const n=f.getFlexReferenceForSelector(e.selector);const[r,s]=await Promise.all([w(e),y.isPublishAvailable()]);const a={isResetEnabled:r,isPublishEnabled:false,allContextsProvided:true};const i=e.layer!==C.USER&&e.layer!==C.PUBLIC;if(i){try{const t=await h.getFlexInfo({...e,reference:n});a.allContextsProvided=t.allContextsProvided!==false;a.isResetEnabled=t.isResetEnabled;a.isPublishEnabled=s&&t.isPublishEnabled}catch(e){t.error(`Sending request to flex/info route failed: ${e.message}`)}}const o=l.getByReference(n);const u={...o,...a};l.setByReference(u,n);c.setAllContextsProvided(n,u.allContextsProvided)};F.getResetAndPublishInfoFromSession=function(e){var t=f.getFlexReferenceForControl(e)||"true";return JSON.parse(window.sessionStorage.getItem(`sap.ui.fl.info.${t}`))};F.reset=function(t){var n=b.getAppComponentForSelector(t.selector);return d.resetFlexObjects({...e(t,"selector"),appComponent:n})};F.add=function(e){const t=b.getAppComponentForSelector(e.selector);const n=f.getFlexReferenceForSelector(e.selector);function r(e){if(m(e)){return e.store()}if(e instanceof a){return p.addDirtyChanges(n,[e],t)?.[0]}return d.addDirtyFlexObjects(n,[e])?.[0]}if(e.change&&e.flexObjects){throw new Error("Using 'flexObjects' and 'change' properties together not supported. Please use the 'flexObjects' property.")}if(e.change){return r(e.change)}const s=e.flexObjects.some(function(e){return m(e)});if(s){return e.flexObjects.map(r)}const i=[];const o=[];e.flexObjects.forEach(e=>{if(e instanceof a){i.push(e)}else{o.push(e)}});const l=d.addDirtyFlexObjects(n,o);const c=p.addDirtyChanges(n,i,t);return e.flexObjects.map(e=>l.find(t=>t===e)||c.find(t=>t===e))};F.remove=function(e){if(e.change&&e.flexObjects){return Promise.reject(new Error("Using 'flexObjects' and 'change' properties together not supported. Please use the 'flexObjects' property."))}if(!e.selector){return Promise.reject(new Error(`An invalid selector was passed so change could not be removed with id: ${e.change.getId()}`))}const t=b.getAppComponentForSelector(e.selector);if(!t){return Promise.reject(new Error(`Invalid application component for selector, change could not be removed with id: ${e.change.getId()}`))}const r=e.change?[e.change]:e.flexObjects;const a=f.getFlexReferenceForSelector(e.selector);r.forEach(function(e){if(e.isValidForDependencyMap()){const r=n.bySelector(e.getSelector(),t);if(r){s.destroyAppliedCustomData(r,e,n)}}});d.deleteFlexObjects({reference:a,flexObjects:r});return Promise.resolve()};F.getChangesWarning=function(e){return this._getUIChanges(e).then(function(e){const t=e.some(function(e){return e.isChangeFromOtherSystem()});const n=u.getInstanceOrUndef();const r=n&&n.getIsProductiveSystem()&&n.getSystem()&&n.getClient();const s=e.length===0;let a={showWarning:false};if(t){a={showWarning:true,warningType:"mixedChangesWarning"}}if(r&&s){a={showWarning:true,warningType:"noChangesAndPSystemWarning"}}return a})};F._condense=function(e){return Promise.resolve().then(function(){if(!e.selector){throw Error("An invalid selector was passed")}var t=b.getAppComponentForSelector(e.selector);if(!t){throw Error("Invalid application component for selector")}if(!e.changes||e.changes&&!Array.isArray(e.changes)){throw Error("Invalid array of changes")}return g.condense(t,e.changes)})};F._getUIChanges=function(e){if(e.layer){e.currentLayer=e.layer}e.invalidateCache=false;return d.getFlexObjects(e)};F._getAnnotationChanges=function(e){const t=f.getFlexReferenceForControl(e.control);return i.getAnnotationChanges(t)};F._getFlexObjectsForUser=async function(e){const t=o.getUserId();const n=await F._getUIChanges(e);return n.filter(e=>e.getSupportInformation().user===t)};F.setAdaptationLayer=function(e,t){const n=f.getFlexReferenceForControl(t);const r=l.getByReference(n);r.adaptationLayer=e;l.setByReference(r,n)};return F});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/ReloadInfoAPI", ["sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/fl/initial/_internal/Loader","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/initial/api/Version","sap/ui/fl/write/_internal/flexState/compVariants/CompVariantManager","sap/ui/fl/write/api/FeaturesAPI","sap/ui/fl/write/api/PersistenceWriteAPI","sap/ui/fl/write/api/VersionsAPI","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/write/_internal/init"],function(e,r,a,t,n,i,l,s,o,f,c,u){"use strict";async function v(e,a){if(r.getByReference(a).version){return false}const t=await s.isVersioningEnabled(e.layer);return t&&f.isDraftAvailable({control:e.selector,layer:e.layer})}async function y(e,a){var t=r.getByReference(a);var n=e.layer===c.USER;if(n||t.maxLayer&&t.maxLayer===e.layer){return false}const i=await o.hasHigherLayerChanges({selector:e.selector,ignoreMaxLayerParameter:e.ignoreMaxLayerParameter,upToLayer:e.layer,includeCtrlVariants:e.includeCtrlVariants,includeDirtyChanges:true});return i||g(e)}function g(e){if(u.isOverLayer(c.USER,e.layer)){return l.checkSVMControlsForDirty(t.getFlexReferenceForControl(e.selector))}return false}async function d(e,t){let n=r.getByReference(t);if(n.initialAllContexts){return false}if(n.allContextsProvided===undefined){const a={selector:e.selector,layer:e.layer};await o.updateResetAndPublishInfo(a);n=r.getByReference(t)}else{a.setAllContextsProvided(t,n.allContextsProvided)}n.initialAllContexts=!n.allContextsProvided;r.setByReference(n,t);return!n.allContextsProvided}function h(e){if(!n.getInstanceOrUndef()?.getIsContextSharingEnabled()){return false}return r.getByReference(e).allContextsProvided===false}function x(e){return r.getByReference(e).isEndUserAdaptation===false}var C={async getReloadReasonsForStart(e){const r=t.getFlexReferenceForControl(e.selector);const a=await Promise.all([y.call(this,e,r),v(e,r),d(e,r)]);const n={};[n.hasHigherLayerChanges,n.isDraftAvailable,n.allContexts]=a;return n},hasVersionStorage(e,a){const n=t.getFlexReferenceForControl(a);var i=r.getByReference(n);return!!(i.version&&i.version===e.value)},removeInfoSessionStorage(e){const a=t.getFlexReferenceForControl(e);r.removeByReference(a)},hasMaxLayerStorage(e,a){const n=t.getFlexReferenceForControl(a);var i=r.getByReference(n);return!!(i.maxLayer&&i.maxLayer===e.value)},handleReloadInfo(e){const a=t.getFlexReferenceForControl(e.selector);var n=false;var l=r.getByReference(a);if(!e.ignoreMaxLayerParameter&&e.hasHigherLayerChanges){delete l.maxLayer;delete l.adaptationLayer;n=true}if(e.versionSwitch&&l.version!==e.version){l.version=e.version;n=true}if(l.version&&e.removeVersionParameter||l.version===i.Number.Draft&&e.removeDraft){delete l.version;n=true}r.setByReference(l,a);return n},handleReloadInfoOnStart(e){const a=t.getFlexReferenceForControl(e.selector);var n=false;var l=r.getByReference(a);if(e.hasHigherLayerChanges){l.maxLayer=e.layer;n=true}if(e.isDraftAvailable){l.version=i.Number.Draft;n=true}r.setByReference(l,a);return n},initialDraftGotActivated(e){if(e.versioningEnabled){var r=this.hasVersionStorage({value:i.Number.Draft},e.selector);return!f.isDraftAvailable({control:e.selector,layer:e.layer})&&r}return false},getReloadInfo(e){const a=t.getFlexReferenceForControl(e.selector);const n={};n.isDraftAvailable=e.isDraftAvailable||C.hasVersionStorage({value:i.Number.Draft},e.selector);n.hasVersionStorage=!!r.getByReference(a).version;if(e.activeVersion&&e.activeVersion!==i.Number.Original&&n.hasVersionStorage){n.activeVersionNotSelected=!C.hasVersionStorage({value:e.activeVersion},e.selector)}n.hasHigherLayerChanges=C.hasMaxLayerStorage({value:e.layer},e.selector);n.initialDraftGotActivated=C.initialDraftGotActivated(e);if(n.initialDraftGotActivated){n.isDraftAvailable=false}n.allContexts=h(a);n.switchEndUserAdaptation=x(a);n.reloadNeeded=n.isDraftAvailable||n.hasHigherLayerChanges||n.initialDraftGotActivated||n.activeVersionNotSelected||n.allContexts||n.switchEndUserAdaptation;return n}};return C});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/SACIntegrationUpdateVariant", ["sap/ui/fl/write/_internal/flexState/compVariants/CompVariantManager","sap/ui/fl/apply/_internal/flexState/compVariants/Utils","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/Layer","sap/ui/fl/write/_internal/init"],function(e,t,r,i,n){"use strict";return a=>{if(!a){return Promise.reject("A property bag must be provided")}if(!a.control){return Promise.reject("variant management control must be provided")}if(!a.id){return Promise.reject("variant ID must be provided")}if(!a.content){return Promise.reject("content must be provided")}a.reference=i.getFlexReferenceForControl(a.control);a.persistencyKey=t.getPersistencyKey(a.control);const o=r.getFlexObjectsDataSelector().get(a);const s=o.find(e=>e.getId()===a.id);if(s?.getFileType()!=="variant"){return Promise.reject("no variant with the ID found")}a.layer=s.getLayer();if(![n.USER,n.PUBLIC].includes(a.layer)){return Promise.reject("only variants in the USER and PUBLIC layer can be updated")}if(!s.isEditEnabled()){return Promise.reject("the user is not authorized to edit the PUBLIC variant (no author nor key user)")}e.updateVariant(a);return e.persist(a)}});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/SmartBusinessWriteAPI", ["sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/write/_internal/appVariant/AppVariantFactory","sap/ui/fl/write/_internal/connectors/LrepConnector","sap/ui/fl/write/_internal/SaveAs","sap/ui/fl/write/api/ChangesWriteAPI","sap/ui/fl/write/api/PersistenceWriteAPI","sap/base/util/restricted/_pick","sap/ui/fl/write/_internal/init"],function(e,r,t,i,n,a,p,s){"use strict";function c(e,t){return r.getInstance().then(function(r){if(r.getIsAtoEnabled()){t.skipIam=true;t.transport="ATO_NOTIFICATION"}return n[e](t)})}function o(r){if(!r.appId){return Promise.reject("App Variant ID must be provided")}r.selector={appId:r.appId};r.id=e.getFlexReferenceForSelector(r.selector);r.isForSmartBusiness=true;return Promise.resolve(r)}var u={create(r){if(!r.layer){return Promise.reject("Layer must be provided")}if(!r.selector||!r.selector.appId){return Promise.reject("selector.appId must be provided")}if(!r.id){return Promise.reject("App variant ID must be provided")}r.reference=e.getFlexReferenceForSelector(r.selector);r.isForSmartBusiness=true;return c("saveAs",r)},update(e){return o(e).then(c.bind(this,"updateAppVariant"))},remove(e){return o(e).then(c.bind(this,"deleteAppVariant"))},getDesignTimeVariant(e){if(!e.id){return Promise.reject("App Variant ID must be provided")}return t.load(e)},getRunTimeVariant(e){if(!e.appId){return Promise.reject("Reference App ID must be provided")}if(!e.id){return Promise.reject("App Variant ID must be provided")}var r=`/sap/bc/lrep/content/apps/${e.appId}/appVariants/${e.id}/manifest.appdescr_variant`;return i.appVariant.getManifest({appVarUrl:r})},createDescriptorInlineChanges(e){if(!e.appId){return Promise.reject("appId must be provided")}if(!e.changeSpecificData){return Promise.reject("changeSpecificData must be provided")}e.selector={appId:e.appId};return a.create(e)},add(e){if(!e.appId){return Promise.reject("appId must be provided")}if(!e.change){return Promise.reject("Change instance must be provided")}e.selector={appId:e.appId};return p.add(e)},createDescriptorChangeString(e){return this.createDescriptorInlineChanges(e).then(function(e){var r=s(e.getJson(),["changeType","content","texts"]);return Promise.resolve(JSON.stringify(r))})}};return u});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/SmartVariantManagementWriteAPI", ["sap/ui/fl/apply/_internal/flexState/compVariants/Utils","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/write/api/ContextBasedAdaptationsAPI","sap/ui/fl/write/_internal/flexState/compVariants/CompVariantManager","sap/ui/fl/write/_internal/transport/TransportSelection","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],function(t,e,a,n,r,i,o){"use strict";function c(a,n){a.componentId=o.getAppComponentForControl(a.control).getId();a.persistencyKey=t.getPersistencyKey(a.control);a.reference||=e.getFlexReferenceForControl(a.control);return n(a)}function l(t){var a=t.layer||t.changeSpecificData&&t.changeSpecificData.layer;if(a){t.changeSpecificData||={};t.reference||=e.getFlexReferenceForControl(t.control);var r={layer:a,control:t.control,reference:t.reference};if(n.hasAdaptationsModel(r)){t.changeSpecificData.adaptationId=n.getDisplayedAdaptationId(r)}}}var s={addVariant(t){l(t);return c(t,r.addVariant)},updateVariant(t){l(t);return c(t,r.updateVariant)},updateVariantContent(t){l(t);t.action=r.updateActionType.UPDATE;return c(t,r.updateVariant)},saveVariantContent(t){t.action=r.updateActionType.SAVE;return c(t,r.updateVariant)},discardVariantContent(t){t.action=r.updateActionType.DISCARD;return c(t,r.discardVariantContent)},updateVariantMetadata(t){l(t);t.action=r.updateActionType.UPDATE_METADATA;return c(t,r.updateVariant)},removeVariant(t){l(t);return c(t,r.removeVariant)},revert(t){return c(t,r.revert)},save(t){return c(t,r.persist)},setDefaultVariantId(t){l(t);return c(t,r.setDefault)},isVariantSharingEnabled(){return a.getInstance().then(function(t){return t.getIsVariantSharingEnabled()})},isVariantPersonalizationEnabled(){return a.getInstance().then(function(t){return t.getIsVariantPersonalizationEnabled()})},isVariantAdaptationEnabled(){return a.getInstance().then(function(t){return t.getIsVariantAdaptationEnabled()})},overrideStandardVariant(t){c(t,r.overrideStandardVariant)},revertSetDefaultVariantId(t){return c(t,r.revertSetDefaultVariantId)},_getTransportSelection(){function t(){var t=new URLSearchParams(window.location.search).get("sap-ui-layer")||"";return!!t}var e=new i;e.selectTransport=function(a,n,r,o,c,l){if(!t()){n(e._createEventObject(a,{transportId:""}));return}i.prototype.selectTransport.call(this,a,n,r,o,c,l)};return e}};return s});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/TranslationAPI", ["sap/ui/fl/apply/_internal/flexState/FlexObjectState","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/write/_internal/Storage","sap/ui/fl/Utils","sap/base/util/isEmptyObject","sap/base/i18n/Localization","sap/ui/fl/write/_internal/init"],function(e,r,t,n,a,o){"use strict";var i={};i.hasTranslationRelevantDirtyChanges=function(t){return e.getDirtyFlexObjects(r.getFlexReferenceForControl(t.selector)).some(function(e){return!a(e.getTexts())})};i.getTexts=function(e){if(!e.selector){return Promise.reject("No selector was provided")}if(!e.sourceLanguage){return Promise.reject("No sourceLanguage was provided")}if(!e.targetLanguage){return Promise.reject("No targetLanguage was provided")}if(!e.layer){return Promise.reject("No layer was provided")}var a=n.getAppComponentForControl(e.selector);e.reference=r.getFlexReferenceForControl(a);return Promise.resolve().then(t.translation.getTexts.bind(undefined,e))};i.getSourceLanguages=function(e){if(!e.selector){return Promise.reject("No selector was provided")}if(!e.layer){return Promise.reject("No layer was provided")}var a=n.getAppComponentForControl(e.selector);e.reference=r.getFlexReferenceForControl(a);return t.translation.getSourceLanguages(e).then(function(r){var t=o.getLanguage();if(!r.includes(t)&&i.hasTranslationRelevantDirtyChanges(e)){r.push(t)}return r})};i.uploadTranslationTexts=function(e){if(!e.layer){return Promise.reject("No layer was provided")}if(!e.payload){return Promise.reject("No payload was provided")}return Promise.resolve().then(t.translation.postTranslationTexts.bind(undefined,e))};return i});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/UI2PersonalizationWriteAPI", ["sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/write/_internal/flexState/UI2Personalization/UI2PersonalizationState","sap/base/util/restricted/_omit","sap/ui/fl/write/_internal/init"],function(e,t,r){"use strict";var n={async create(n){n.reference=e.getFlexReferenceForSelector(n.selector);if(!n.reference||!n.containerKey||!n.itemName||!n.content||!n.category||!n.containerCategory){throw new Error("not all mandatory properties were provided for the storage of the personalization")}await t.setPersonalization(r(n,["selector"]))},async deletePersonalization(r){r.reference=e.getFlexReferenceForSelector(r.selector);if(!r.reference||!r.containerKey||!r.itemName){throw new Error("not all mandatory properties were provided for the deletion of the personalization")}await t.deletePersonalization(r.reference,r.containerKey,r.itemName)}};return n});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/VersionsAPI", ["sap/ui/fl/apply/_internal/flexState/FlexObjectState","sap/ui/fl/apply/_internal/flexState/FlexState","sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/initial/api/Version","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/write/_internal/Versions","sap/ui/fl/write/api/ContextBasedAdaptationsAPI","sap/ui/fl/write/api/FeaturesAPI","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],function(e,r,t,n,i,o,a,s,l,c){"use strict";function d(e){const r=n.getFlexReferenceForControl(e);if(!r){throw Error("The application ID could not be determined")}return r}function f(r){const t=e.getDirtyFlexObjects(r);return t.length>0}function p(e){if(!e.control){throw Error("No control was provided")}if(!e.layer){throw Error("No layer was provided")}var r=d(e.control);const t=a.getVersionsModel({reference:r,layer:e.layer});if(f(r)){t.updateDraftVersion()}return t}function u(e){var r=d(e.control);var t=s.hasAdaptationsModel({layer:e.layer,reference:r});if(!e.adaptationId&&t){return s.refreshAdaptationModel(e)}else if(e.adaptationId&&t){var n=s.getAdaptationsModel(e);n.switchDisplayedAdaptation(e.adaptationId);return Promise.resolve(e.adaptationId)}return Promise.resolve()}var v={};v.initialize=function(e){if(!e.control){return Promise.reject("No control was provided")}if(!e.layer){return Promise.reject("No layer was provided")}var r=c.getAppComponentForControl(e.control);return a.initialize({reference:d(r),layer:e.layer})};v.clearInstances=function(){a.clearInstances()};v.isDraftAvailable=function(e){var r=p(e);var t=r.getProperty("/versions");var n=t.find(function(e){return e.version===i.Number.Draft});return!!n};v.getDraftFilenames=function(e){const r=p(e);return r.getProperty("/draftFilenames")};v.isOldVersionDisplayed=function(e){var r=p(e);var t=r.getProperty("/displayedVersion");var n=r.getProperty("/activeVersion");return t!==i.Number.Draft&&t!==n};v.loadDraftForApplication=function(e){e.version=i.Number.Draft;return v.loadVersionForApplication(e)};v.loadVersionForApplication=function(e){if(!e.control){return Promise.reject("No control was provided")}if(!e.layer){return Promise.reject("No layer was provided")}const n=p(e);if(n){if(e.version===undefined){e.version=n.getProperty("/activeVersion")}n.setProperty("/displayedVersion",e.version);n.setProperty("/persistedVersion",e.version);if(e.version!==i.Number.Draft&&l.isPublishAvailable()){const r=n.getProperty("/versions");if(r.length){const t=r.find(function(r){return r.version===e.version});if(t){n.setProperty("/publishVersionEnabled",!t.isPublished)}}}}return u(e).then(function(n){const i=c.getAppComponentForControl(e.control);const o=d(i);const a=t.getByReference(o);a.version=e.version;a.displayedAdaptationId=n;t.setByReference(a,o);r.clearState(o)})};v.activate=function(e){if(!e.control){return Promise.reject("No control was provided")}if(!e.layer){return Promise.reject("No layer was provided")}if(!e.title){return Promise.reject("No version title was provided")}const r=d(e.control);if(f(r)){return Promise.reject("Unsaved changes exist")}const n=t.getByReference(r);delete n.version;t.setByReference(n,r);return a.activate({reference:r,layer:e.layer,title:e.title,appComponent:c.getAppComponentForControl(e.control),displayedVersion:e.displayedVersion})};v.discardDraft=function(n){const i=c.getAppComponentForControl(n.control);const l=d(i);function f(){const r=e.getDirtyFlexObjects(l);o.deleteFlexObjects({reference:l,flexObjects:r});return r.length>0}if(!n.control){return Promise.reject("No control was provided")}if(!n.layer){return Promise.reject("No layer was provided")}return a.discardDraft({reference:l,layer:n.layer,discardDraftAndKeepActiveVersion:n.discardDraftAndKeepActiveVersion}).then(function(e){var i=false;if(!n.discardDraftAndKeepActiveVersion){i=f()}e.dirtyChangesDiscarded=i;if(e.backendChangesDiscarded){const i=s.hasAdaptationsModel({layer:n.layer,reference:l});if(i){return s.refreshAdaptationModel(n).then(function(i){const o=t.getByReference(l);o.displayedAdaptationId=i;t.setByReference(o,l);if(!n.discardDraftAndKeepActiveVersion){r.clearState(l)}return e})}}if(!n.discardDraftAndKeepActiveVersion){r.clearState(l)}return e})};v.publish=function(e){if(!e.selector){return Promise.reject("No selector was provided")}if(!e.layer){return Promise.reject("No layer was provided")}if(!e.version){return Promise.reject("No version was provided")}e.styleClass||="";e.reference=d(e.selector);return a.publish(e)};v.getCreatedVersionsByUser=function(e,r){const t=p(e);const n=t.getProperty("/versions");return n.filter(e=>e.activatedBy===r)};return v});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/connectors/FileListBaseConnector", ["sap/base/util/merge","sap/base/util/LoaderExtensions","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/write/_internal/init"],function(e,t,n,r){"use strict";return e({},r,{getFileList(){return Promise.reject("not implemented")},layers:[],loadFlexData(e){return this.getFileList(e.reference).then(function(e){return Promise.all(e.map(function(e){return t.loadResource({dataType:"json",url:e,async:true})})).then(function(e){var t=n.getGroupedFlexObjects(e);return n.filterAndSortResponses(t)})})}})});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/api/connectors/ObjectStorageConnector", ["sap/base/strings/hash","sap/base/util/restricted/_uniqBy","sap/base/util/each","sap/base/util/merge","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/initial/api/Version","sap/ui/fl/write/connectors/BaseConnector","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/apply/_internal/connectors/ObjectStorageUtils","sap/ui/fl/write/_internal/init"],function(e,t,r,n,i,s,a,o,c,l){"use strict";const f={isKeyUser:true,isVariantSharingEnabled:true,isProductiveSystem:false,isCondensingEnabled:true,isContextSharingEnabled:false,isVersioningEnabled:true,logonUser:"DEFAULT_USER",isVariantAuthorNameAvailable:false,isAnnotationChangeEnabled:true,isSeenFeaturesAvailable:false};function u(e){var t=[];return l.forEachObjectInStorage(e,function(e){t.push(e.changeDefinition)}).then(function(){return t})}function d(e,t){var r=true;if(e.selectorIds){if(t.selector){r=e.selectorIds.indexOf(t.selector.id)>-1}else{r=false}}if(r&&e.changeTypes){r=e.changeTypes.indexOf(t.changeType)>-1}return r}function h(e,t){if(!e.creation){var r=Date.now()+t;e.creation=new Date(r).toISOString()}return e}function v(t){return e(t.reduce(function(e,t){return e+new Date(t.creation).getTime()},""))}function g(e,t){r(e,function(e,n){n.forEach(function(e){r(e,function(e,r){t(r,e)})})})}function m(e,t){var r=[];var n=0;g(e,function(e,i){var s=l.createFlexKey(i);var a=t.condensedChanges.find(function(t){return t.getId()===e.fileName});if(!a.getCreation()){var o=Date.now()+n;n++;a.setCreation(new Date(o).toISOString())}r.push({key:s,value:a})});return r}function y(e,t){var r=[];g(e,function(e,n){var i=l.createFlexKey(n);var s;t.some(function(e){if(e.getId()===n){s=e;return true}});r.push({key:i,value:s})});return r}function b(e,t){var n=[];r(e,function(e,r){if(r.length<2){return}var i=t.filter(function(t){return t.getFileType()===e});i.forEach(function(e,t){if(r.indexOf(e.getId())>-1&&t<i.length-1){var s=i[t+1];var a=new Date(e.getCreation());var o=new Date(s.getCreation());if(s&&a>=o){var c=a.getTime()+1;s.setCreation(new Date(c).toISOString());var f=l.createFlexKey(s.getId());n.push({key:f,value:s})}}})});return n}function p(e){var t=[];if(e){Object.values(e).forEach(function(e){e.forEach(function(e){var r=l.createFlexKey(e);t.push(this.storage.removeItem(r))}.bind(this))}.bind(this))}return t}var O=n({},o,{storage:undefined,layers:["ALL"],async loadFlexData(e){const t=await u({storage:this.storage,reference:e.reference});const r=await this.versions.getVersionChain.call(this,e,e.version);const n=t.filter(e=>e.version===undefined||r.includes(e.version));const i=c.sortFlexObjects(n);const s=c.getGroupedFlexObjects(i);const a=c.filterAndSortResponses(s);if(a.length){a[0].cacheKey=v(i)}return a},async write(e){const t=await this.loadFeatures();let r;if(t.isVersioningEnabled&&e.layer===i.CUSTOMER){e.reference=e.flexObjects[0]?.reference;r=await this.versions.getDraftId.call(this,e)}let n=0;const s=[];for(const t of e.flexObjects){if(r){t.version=r}const e=l.createFlexObjectKey(t);const i=h(t,++n);const a=this.storage._itemsStoredAsObjects?i:JSON.stringify(i);await this.storage.setItem(e,a);s.push(i)}return{response:s}},async update(e){var t=e.flexObject;if(f.isVersioningEnabled&&e.layer===i.CUSTOMER){e.reference=t.reference;const r=await this.versions.load.call(this,e);const n=r.find(e=>e.isDraft)?.id;if(n){t.version=n}}var r=l.createFlexObjectKey(e.flexObject);var n=this.storage._itemsStoredAsObjects?t:JSON.stringify(t);var s=this.storage.setItem(r,n);return Promise.resolve(s)},reset(e){return l.forEachObjectInStorage({storage:this.storage,reference:e.reference,layer:e.layer},function(t){if(d(e,t.changeDefinition)){return Promise.resolve(this.storage.removeItem(t.key)).then(function(){return{fileName:t.changeDefinition?.fileName||t.changeDefinition?.id}})}}.bind(this)).then(function(e){return{response:e.filter(function(e){return!!e})}})},remove(e){var t=l.createFlexObjectKey(e.flexObject);this.storage.removeItem(t);var r=this.storage.removeItem(t);return Promise.resolve(r)},loadFeatures(){return Promise.resolve(f)},loadVariantsAuthors(){return Promise.reject("loadVariantsAuthors is not implemented")},getFlexInfo(e){e.storage=this.storage;return l.getAllFlexObjects(e).then(function(e){return{isResetEnabled:e.length>0}})},async condense(e){var r=e.flexObjects;var n=[];n=n.concat(m(r.create,e));n=n.concat(y(r.update,e.condensedChanges));n=n.concat(b(r.reorder,e.condensedChanges));n=t(n,"key");var s=[];var a=[];s=s.concat(p.call(this,r.delete));const o=await this.loadFeatures();let c;if(o.isVersioningEnabled&&e.layer===i.CUSTOMER&&(r.create&&Object.keys(r.create).length!==0||r.update&&Object.keys(r.update).length!==0||r.reorder&&Object.keys(r.reorder).length!==0)){c=await this.versions.getDraftId.call(this,e)}n.forEach(function(e){var t=e.value.convertToFileContent();if(c){t.version=c}a.push(t);var r=this.storage._itemsStoredAsObjects?t:JSON.stringify(t);s.push(this.storage.setItem(e.key,r))}.bind(this));if(o.isVersioningEnabled&&e.layer===i.CUSTOMER&&r.delete&&Object.keys(r.delete).length!==0){const t=await this.versions.load.call(this,e);if(t.length){const n=t.find(e=>e.isDraft);Object.values(r.delete).forEach(function(e){e.forEach(function(e){n.filenames=n.filenames.filter(function(t){return t!==e})})});if(!n.filenames.length){await this.versions.discardDraft.call(this,e)}}}return Promise.all(s).then(function(){return Promise.resolve({response:a})})},versions:{async getDraftId(e){let t=[];if(e.condensedChanges){t=e.condensedChanges.map(e=>e.sId)}else{t=e.flexObjects.map(e=>e.fileName)}const r=await this.versions.load.call(this,e);let n=r.find(e=>e.isDraft);if(n&&e.parentVersion===a.Number.Draft){if(e.condensedChanges){n.filenames=[]}n.filenames=t.concat(n.filenames)}else{if(n&&e.parentVersion!==a.Number.Draft){await this.versions.discardDraft.call(this,e)}n={version:a.Number.Draft,id:s.createDefaultFileName("version"),isDraft:true,activatedAt:"",activatedBy:"",fileType:"version",layer:i.CUSTOMER,title:"",reference:e.reference,filenames:t};if(e.parentVersion!==a.Number.Original){n.parentVersion=e.parentVersion}}const o=l.createFlexKey(`${n.id}`);const c=this.storage._itemsStoredAsObjects?n:JSON.stringify(n);await this.storage.setItem(o,c);return n.id},async getVersionChain(e,t){const r=[];const n=(e,t)=>e===t.version;const i=await this.versions.load.call(this,e);t||=i.find(e=>!e.isDraft)?.id;while(t&&t!==a.Number.Original){const e=i.find(n.bind(undefined,t));r.push(e.id);t=e.parentVersion}return r},async load(e){const t=await u({storage:this.storage,reference:e.reference});return t.filter(e=>e.fileType==="version").sort((e,t)=>{if(e.isDraft){return-1}if(t.isDraft){return 1}return e.activatedAt<t.activatedAt?1:-1})},async activate(e){const t=await this.loadFeatures();const r=await this.versions.load.call(this,e);var n=r.find(t=>t.version===e.version);if(n){if(!n.isDraft){n.id=s.createDefaultFileName("version");n.parentVersion=e.version}}else{const t=s.createDefaultFileName("version");n={version:t,id:t,fileType:"version",layer:i.CUSTOMER,reference:e.reference}}if(e.version!==a.Number.Draft){const t=r.find(e=>e.isDraft);if(t){await this.versions.discardDraft.call(this,e)}}const o=l.createFlexKey(n.id);n.title=e.title;n.activatedAt=new Date(Date.now()).toISOString();n.activatedBy=t.logonUser;n.isDraft=false;n.version=n.id;delete n.filenames;const c=this.storage._itemsStoredAsObjects?n:JSON.stringify(n);this.storage.setItem(o,c);return n},async discardDraft(e){e.storage=this.storage;const t=await this.versions.load.call(this,e);const r=t.find(e=>e.isDraft)?.id;if(!r){return Promise.reject("no version to discard")}const n=await u(e);const i=n.filter(e=>e.version===r);const s=t.find(e=>e.id===r);i.push(s);const a=i.map(e=>{var t=l.createFlexKey(e.fileName||e.id);return this.storage.removeItem(t)});await Promise.all(a)}}});return O});
/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.predefine("sap/ui/fl/write/connectors/BaseConnector", [],function(){"use strict";var e={layers:[],write(){return Promise.reject("write is not implemented")},condense(){return Promise.reject("condense is not implemented")},update(){return Promise.reject("write is not implemented")},remove(){return Promise.reject("remove is not implemented")},reset(){return Promise.reject("reset is not implemented")},publish(){return Promise.reject("publish is not implemented")},getFlexInfo(){return Promise.resolve({})},getSeenFeatureIds(){return Promise.reject("getSeenFeatureIds is not implemented")},setSeenFeatureIds(){return Promise.reject("setSeenFeatureIds is not implemented")},deleteUserVariantsForVM(){return Promise.reject("deleteUserVariantsForVM is not implemented")},getContexts(){return Promise.reject("getContexts is not implemented")},loadContextDescriptions(){return Promise.reject("loadContextDescriptions is not implemented")},contextBasedAdaptation:{create(){return Promise.reject("contextBasedAdaptation.create is not implemented")},reorder(){return Promise.reject("contextBasedAdaptation.reorder is not implemented")},load(){return Promise.reject("contextBasedAdaptation.load is not implemented")},update(){return Promise.reject("contextBasedAdaptation.update is not implemented")},remove(){return Promise.reject("contextBasedAdaptation.remove is not implemented")}},versions:{load(){return Promise.reject("versions.load is not implemented")},activate(){return Promise.reject("versions.activate is not implemented")},discardDraft(){return Promise.reject("versions.discardDraft is not implemented")}},translation:{getSourceLanguages(){return Promise.reject("translation.getSourceLanguages is not implemented")},getTexts(){return Promise.reject("translation.getTexts is not implemented")},postTranslationTexts(){return Promise.reject("translation.postTranslationTexts is not implemented")}}};return e});
sap.ui.require.preload({
	"sap/ui/fl/write/_internal/fieldExtensibility/cap/dialog/CustomFieldCAPDialog.fragment.xml":'<core:FragmentDefinition\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n\txmlns:editor="sap.ui.integration.designtime.baseEditor"\n><Dialog\n\t\tclass="sapUiContentPadding"\n\t\ttitle="{i18n>CAP_ADD_FIELD_TITLE}"\n\t\tverticalScrolling="true"\n\t\tresizable="false"\n\t\tdraggable="true"\n\t\tcontentWidth="42rem"\n\t\tcontentHeight="80vh"\n\t><content><editor:BaseEditor layout="form" /></content><beginButton><Button\n\t\t\t\tenabled="{dialog>/isValid}"\n\t\t\t\ttype="Emphasized"\n\t\t\t\ttext="{i18n>CAP_ADD_FIELD_CREATE}"\n\t\t\t\tpress="onSave"\n\t\t\t/></beginButton><endButton><Button\n\t\t\t\ttype="Transparent"\n\t\t\t\ttext="{i18n>CAP_ADD_FIELD_CANCEL}"\n\t\t\t\tpress="onCancel"\n\t\t\t/></endButton></Dialog></core:FragmentDefinition>\n',
	"sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/booleanEditor/BooleanEditor.fragment.xml":'<core:FragmentDefinition\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n><CheckBox select="_onChange" /></core:FragmentDefinition>',
	"sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/rangeEditor/RangeEditor.fragment.xml":'<core:FragmentDefinition\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n\txmlns:baseEditor="sap.ui.integration.designtime.baseEditor"\n><HBox><baseEditor:PropertyEditor\n\t\t\tinit="wrapperInit"\n\t\t\tconfig="{contentModel>/0/config}"\n\t\t\tvalue="{contentModel>/0/value}"\n\t\t\trenderLabel="false"\n\t\t\tvalueChange="_onChange"\n\t\t/><baseEditor:PropertyEditor\n\t\t\tinit="wrapperInit"\n\t\t\tconfig="{contentModel>/1/config}"\n\t\t\tvalue="{contentModel>/1/value}"\n\t\t\trenderLabel="false"\n\t\t\tvalueChange="_onChange"\n\t\t/></HBox></core:FragmentDefinition>',
	"sap/ui/fl/write/_internal/fieldExtensibility/cap/editor/propertyEditor/timeEditor/TimeEditor.fragment.xml":'<core:FragmentDefinition\n\txmlns="sap.m"\n\txmlns:core="sap.ui.core"\n><TimePicker\n\t\tvalue="{displayValue}"\n\t\tvalueFormat="HH:mm:ss.SSSS"\n\t\tchange="_onChange"\n\t/></core:FragmentDefinition>'
},"sap/ui/fl/library-preload-write");
//# sourceMappingURL=library-preload-write.js.map
