/* !
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/restricted/_pick","sap/base/util/isPlainObject","sap/base/util/ObjectPath","sap/ui/fl/apply/_internal/flexObjects/AnnotationChange","sap/ui/fl/apply/_internal/flexObjects/AppDescriptorChange","sap/ui/fl/apply/_internal/flexObjects/CompVariant","sap/ui/fl/apply/_internal/flexObjects/ControllerExtensionChange","sap/ui/fl/apply/_internal/flexObjects/FlexObject","sap/ui/fl/apply/_internal/flexObjects/FlVariant","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/apply/_internal/flexObjects/UIChange","sap/ui/fl/apply/_internal/flexObjects/UpdatableChange","sap/ui/fl/apply/_internal/flexObjects/VariantChange","sap/ui/fl/apply/_internal/flexObjects/VariantManagementChange","sap/ui/fl/initial/_internal/Settings","sap/ui/fl/Layer","sap/ui/fl/LayerUtils","sap/ui/fl/Utils"],function(e,t,n,a,r,i,c,o,l,s,p,u,f,g,m,C,y,O){"use strict";const N={COMP_VARIANT_OBJECT:i,FL_VARIANT_OBJECT:l,CONTROLLER_EXTENSION:c,APP_DESCRIPTOR_CHANGE:r,ANNOTATION_CHANGE:a,UI_CHANGE:p,UPDATABLE_CHANGE:u,VARIANT_CHANGE:f,VARIANT_MANAGEMENT_CHANGE:g,FLEX_OBJECT:o};function _(e){return t(e)?{...e}:e}function T(e){if(e.fileType==="variant"){return N.COMP_VARIANT_OBJECT}else if(e.fileType==="ctrl_variant"){return N.FL_VARIANT_OBJECT}else if(e.changeType==="codeExt"){return N.CONTROLLER_EXTENSION}else if(e.appDescriptorChange){return N.APP_DESCRIPTOR_CHANGE}else if(e.fileType==="annotation_change"){return N.ANNOTATION_CHANGE}else if(e.fileType==="change"&&e.changeType==="defaultVariant"){return N.UPDATABLE_CHANGE}else if(e.fileType==="ctrl_variant_change"){return N.VARIANT_CHANGE}else if(e.fileType==="ctrl_variant_management_change"){return N.VARIANT_MANAGEMENT_CHANGE}else if(e.changeType==="deactivateChanges"){return N.FLEX_OBJECT}return N.UI_CHANGE}function d(e){const t=_(e);const n=t.type||t.changeType;let a=t.fileName||t.id;if(!a){a=O.createDefaultFileName(n);if(a.length>64){throw Error(`File name '${a}' must not exceed 64 characters`)}}const r=t.user||(!y.isDeveloperLayer(t.layer)?m.getInstanceOrUndef()?.getUserId():undefined);return{id:a,adaptationId:t.adaptationId,layer:t.layer,content:_(t.content),texts:_(t.texts),supportInformation:{service:t.ODataService,oDataInformation:_(t.oDataInformation),command:t.command,compositeCommand:t.compositeCommand,generator:t.generator,sourceChangeFileName:t.support&&t.support.sourceChangeFileName,sourceSystem:t.sourceSystem,sourceClient:t.sourceClient,originalLanguage:t.originalLanguage,user:r},flexObjectMetadata:{changeType:n,reference:t.reference,packageName:t.packageName,projectId:t.projectId}}}const A={};A.createFromFileContent=function(e,t,a){const r={...e};var i=t||T(r);if(!i){throw new Error("Unknown file type")}r.support={generator:"FlexObjectFactory.createFromFileContent",...r.support||{}};const c=i.getMappingInfo();const l=o.mapFileContent(r,c);const p=Object.entries(l).reduce(function(e,t){n.set(t[0].split("."),t[1],e);return e},{});const u=new i(p);if(a){u.setProperty("state",s.LifecycleState.PERSISTED)}return u};A.createFlexObject=function(e){const t=d({...e,...{packageName:e.packageName||"$TMP"}});return new o(t)};A.createUIChange=function(e){e.packageName||="$TMP";const t=d(e);t.layer||=e.isUserDependent?C.USER:y.getCurrentLayer();t.selector=e.selector;t.jsOnly=e.jsOnly;t.variantReference=e.variantReference;t.isChangeOnStandardVariant=e.isChangeOnStandardVariant;t.fileType=e.fileType||"change";return new p(t)};A.createVariantChange=function(e){e.packageName||="$TMP";const t=d(e);t.variantId=e.variantId||e.selector?.id;t.fileType=e.fileType||"ctrl_variant_change";return new f(t)};A.createVariantManagementChange=function(e){e.packageName||="$TMP";const t=d(e);t.selector=e.selector;t.fileType=e.fileType||"ctrl_variant_management_change";return new g(t)};A.createAppDescriptorChange=function(e){e.compositeCommand||=e.support&&e.support.compositeCommand;if(!(e.fileName||e.id)){const t=e.type||e.changeType;e.fileName=O.createDefaultFileName(t).substring(0,64)}const t=d(e);return new r(t)};A.createAnnotationChange=function(e){e.compositeCommand||=e.support&&e.support.compositeCommand;const t=d(e);t.serviceUrl=e.serviceUrl;return new a(t)};A.createControllerExtensionChange=function(e){e.generator||="FlexObjectFactory.createControllerExtensionChange";e.changeType="codeExt";e.content={codeRef:e.codeRef};const t=d(e);t.flexObjectMetadata.moduleName=e.moduleName;t.controllerName=e.controllerName;return new c(t)};A.createFlVariant=function(e){const t=_(e);t.generator||="FlexObjectFactory.createFlVariant";const n=d(t);n.variantManagementReference=t.variantManagementReference;n.variantReference=t.variantReference;n.contexts=t.contexts;n.executeOnSelection=t.executeOnSelection;n.texts={variantName:{value:t.variantName,type:"XFLD"}};return new l(n)};A.createCompVariant=function(e){const t=_(e);t.generator||="FlexObjectFactory.createCompVariant";t.user=n.get("support.user",t);const a=d(t);a.variantId=t.variantId||a.id;a.contexts=t.contexts;a.favorite=t.favorite;a.persisted=t.persisted;a.persistencyKey=t.persistencyKey||n.get("selector.persistencyKey",t);if(t.layer===C.VENDOR||t.layer===C.CUSTOMER_BASE){a.favorite=true}if(t.executeOnSelection!==undefined){a.executeOnSelection=t.executeOnSelection}else{a.executeOnSelection=a.content&&(a.content.executeOnSelect||a.content.executeOnSelection)}return new i(a)};return A});
//# sourceMappingURL=FlexObjectFactory.js.map