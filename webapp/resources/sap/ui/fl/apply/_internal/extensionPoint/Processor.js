/*!
* OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
*/
sap.ui.define(["sap/base/util/merge","sap/ui/base/DesignTime","sap/ui/base/SyncPromise","sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/changes/Applier","sap/ui/fl/apply/_internal/extensionPoint/Registry","sap/ui/fl/apply/_internal/flexState/changes/ExtensionPointState","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/Utils"],function(e,n,t,i,r,o,a,s,u){"use strict";var f;function l(e,n,t,i,r){return r(e,true).then(function(r){r.forEach(function(e,r){n.splice(t+r+i,0,e)});e.index+=i;return r.length-1})}function g(e,n,i){var r=[];var o=[];var a=0;var s;i.forEach(function(t,i){if(t._isExtensionPoint){t.targetControl=e.targetControl;t.aggregationName=e.aggregationName;t.fragmentId=e.fragmentId;t.index=i;if(s){s._nextSibling=t}s=t;t.referencedExtensionPoint=e;r.push(function(){return l(t,o,i,a,n).then(function(e){a+=e})})}else{o.push(t)}});if(r.length>0){return r.reduce(function(e,n){return e.then(n)},t.resolve()).then(function(){return o})}return t.resolve(o)}function d(n,t){var r=u.getAppComponentForControl(n.targetControl);var o={};var l=e({defaultContent:[]},n);o.appComponent=r;o.modifier=i;o.viewId=n.view.getId();o.componentId=r.getId();o.reference=s.getFlexReferenceForControl(r);return f.registerExtensionPoint(l).then(a.enhanceExtensionPointChanges.bind(a,o,n)).then(f.createDefaultContent.bind(this,n,t,d)).then(f.addDefaultContentToExtensionPointInfo.bind(this,l,t))}f={oExtensionPointRegistry:undefined,oRegistryPromise:Promise.resolve(),registerExtensionPoint(e){if(n.isDesignModeEnabled()){o.registerExtensionPoint(e)}return t.resolve()},createDefaultContent(e,n,r,o){if(o.length===0){return e.createDefault().then(g.bind(undefined,e,r)).then(function(t){if(!n){t.forEach(function(n,t){i.insertAggregation(e.targetControl,e.aggregationName,n,e.index+t,e.view)});e.ready(t)}return t})}return t.resolve([])},addDefaultContentToExtensionPointInfo(e,n,t){if(!n){e.defaultContent=e.defaultContent.concat(t)}return t},applyExtensionPoint(e){var n=d(e,false);r.addPreConditionForInitialChangeApplying(n);return n}};return f});
//# sourceMappingURL=Processor.js.map