/*
 * ! OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/util/reflection/JsControlTreeModifier","sap/ui/fl/apply/_internal/controlVariants/Utils","sap/ui/fl/apply/_internal/flexObjects/FlexObjectFactory","sap/ui/fl/apply/_internal/flexObjects/States","sap/ui/fl/initial/_internal/FlexInfoSession","sap/ui/fl/initial/_internal/ManifestUtils","sap/ui/fl/write/_internal/flexState/FlexObjectManager","sap/ui/fl/write/_internal/Storage","sap/ui/fl/Layer","sap/ui/fl/Utils","sap/ui/fl/write/_internal/init"],(e,a,n,r,t,i,s,c,l,o)=>{"use strict";const f={};f.createAndSaveVariant=async function(e){const r={id:e.id,variantManagementReference:e.variantManagementReference,variantReference:e.variantReference||e.variantManagementReference,variantName:e.variantName,layer:e.layer||l.CUSTOMER,user:e.author||a.DEFAULT_AUTHOR,reference:e.reference,generator:e.generator||"BusinessNetworkAPI.createVariant"};const t=[n.createFlVariant(r)];const i=await c.condense({layer:e.layer||l.CUSTOMER,reference:e.reference,allChanges:t,condensedChanges:t});return i.response};f.createDefaultVariant=function(a){const r=o.getAppComponentForControl(a.control);const t=i.getFlexReferenceForControl(r);const c=r.getLocalId(a.control.getId())||a.control.getId();const f={id:a.id,variantManagementReference:c,variantReference:a.variantReference||c,variantName:a.variantName,reference:t,layer:a.layer||l.USER,generator:a.generator||"BusinessNetworkAPI.createDefaultVariant"};const u=[n.createFlVariant(f)];u.push(n.createVariantManagementChange({changeType:"setDefault",layer:f.layer,generator:f.generator,reference:t,selector:e.getSelector(a.control,r),content:{defaultVariant:f.variantReference}}));s.addDirtyFlexObjects(t,u);return u};f.save=function(e){return s.saveFlexObjects({selector:e,includeCtrlVariants:true})};f.disablePersonalization=function(e){const a=t.getByReference(e);if(!a||Object.keys(a).length===0){throw new Error(`Invalid reference provided: ${e}`)}a.maxLayer=l.CUSTOMER;a.saveChangeKeepSession=true;t.setByReference(a,e);window.sessionStorage.setItem("sap.ui.rta.skipReload",true)};f.deleteVariants=async function(e){const a=e.layer||l.CUSTOMER;const t="variants";const i=e.variants.map(n=>({fileName:n,fileType:"ctrl_variant",layer:a,reference:e.reference,namespace:`apps/${e.reference}/${t}/`})).map(e=>n.createFromFileContent(e));i.forEach(e=>{e.condenserState="delete";e.setState(r.LifecycleState.DELETED)});await c.condense({layer:a,reference:e.reference,allChanges:i,condensedChanges:i})};f.resetPersonalizationVariants=function(e){return c.deleteUserVariantsForVM({flexReference:e.reference,variantManagementReferences:[e.variantManagementReference],layer:l.USER})};return f});
//# sourceMappingURL=BusinessNetworkAPI.js.map