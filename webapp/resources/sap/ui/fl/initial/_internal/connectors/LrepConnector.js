/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/merge","sap/base/util/restricted/_pick","sap/ui/dom/includeScript","sap/ui/fl/initial/_internal/connectors/Utils","sap/ui/fl/initial/_internal/StorageUtils","sap/ui/fl/interfaces/BaseLoadConnector","sap/ui/fl/Utils"],function(e,t,s,i,n,a,r){"use strict";const o={DATA:"/flex/data/",MODULES:"/flex/modules/",SETTINGS:"/flex/settings",VARIANTS_AUTHORS:"/variants/authors/"};let l={};return e({},a,{layers:["ALL"],xsrfToken:undefined,settings:undefined,_loadModules(e){return new Promise(function(t,i){s(e,undefined,t,i)})},_addClientInfo(e){var t=r.getUrlParameter("sap-client");if(!e&&t){e={}}if(t){e["sap-client"]=t}},loadFeatures(e){if(this.settings){return Promise.resolve(this.settings)}var t={};this._addClientInfo(t);var s=i.getUrl(o.SETTINGS,e,t);return i.sendRequest(s,"GET",{initialConnector:this}).then(function(e){e.response.isVariantAdaptationEnabled=!!e.response.isPublicLayerAvailable;e.response.isContextSharingEnabled=true;e.response.isLocalResetEnabled=true;return e.response})},loadFlexData(e){if(e.cacheKey==="<NO CHANGES>"){return Promise.resolve({...n.getEmptyFlexDataResponse()})}var s=t(e,["version","allContexts","adaptationId"]);this._addClientInfo(s);i.addSAPLogonLanguageInfo(s);var a;if(e.appDescriptor&&e.appDescriptor["sap.app"]){a=e.appDescriptor["sap.app"].id}if(e.preview){e.reference=e.preview.reference;s.upToLayerType=e.preview.maxLayer}l=s;var r=i.getUrl(o.DATA,e,s);return i.sendRequest(r,"GET",{initialConnector:this,xsrfToken:this.xsrfToken,siteId:e.siteId,cacheable:true,sAppDescriptorId:a}).then(function(t){var n=t.response;if(t.etag){n.cacheKey=t.etag}else if(e.cacheKey){n.cacheKey=e.cacheKey}n.changes=n.changes.concat(n.compVariants||[]);if(n.settings){this.settings=n.settings;this.settings.isVariantAdaptationEnabled=!!this.settings.isPublicLayerAvailable;this.settings.isContextSharingEnabled=true;this.settings.isLocalResetEnabled=true}if(!n.loadModules){return n}var a=i.getUrl(o.MODULES,e,s);return this._loadModules(a).then(function(){return n})}.bind(this))},loadVariantsAuthors(e){const t=i.getUrl(o.VARIANTS_AUTHORS,e,l);return i.sendRequest(t,"GET",{initialConnector:this}).then(function(e){return e.response})}})});
//# sourceMappingURL=LrepConnector.js.map