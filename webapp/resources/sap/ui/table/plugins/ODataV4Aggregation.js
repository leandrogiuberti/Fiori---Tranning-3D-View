/*
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./ODataV4MultiLevel","./PluginBase","../utils/TableUtils"],function(e,t,o){"use strict";const n=e.extend("sap.ui.table.plugins.ODataV4Aggregation",{metadata:{library:"sap.ui.table",properties:{enabled:{type:"boolean",defaultValue:true},groupHeaderFormatter:{type:"function"}}}});n.findOn=t.findOn;n.prototype.onActivate=function(t){e.prototype.onActivate.apply(this,arguments);i.call(this);o.Grouping.setHierarchyMode(t,o.Grouping.HierarchyMode.Group);o.Hook.register(t,o.Hook.Keys.Row.UpdateState,r,this);o.Hook.register(t,o.Hook.Keys.Table.RefreshRows,i,this)};n.prototype.onDeactivate=function(t){e.prototype.onDeactivate.apply(this,arguments);for(const e of t.getColumns()){e._setCellContentVisibilitySettings()}o.Hook.deregister(t,o.Hook.Keys.Row.UpdateState,r,this);o.Hook.deregister(t,o.Hook.Keys.Table.RefreshRows,i,this)};n.prototype.declareColumnsHavingTotals=function(e){const t=this.getControl()?.getColumns()??[];for(const o of t){const t=e.includes(o);o._setCellContentVisibilitySettings({groupHeader:t,summary:t})}};function i(){const e=this.getControl()?.getBinding();const t=e?.getAggregation();if(e&&(!t||"hierarchyQualifier"in t)){throw new Error("Only data aggregation is supported")}}function r(e){const t=e.context.getProperty("@$ui5.node.level")??1;const o=e.context.getProperty("@$ui5.node.isTotal")===true;const n=e.context.getProperty("@$ui5.node.isExpanded");const i=o&&t===0;const r=o&&n===undefined;const a=t>0&&n!==undefined;e.level=t;e.expandable=n!==undefined;e.expanded=n;if(i||r){e.type=e.Type.Summary;e.level=t+1;e.expandable=false}else if(a){e.type=e.Type.GroupHeader;s(e,this.getGroupHeaderFormatter())}}function s(e,t){const o=e.context.getBinding().getAggregation()?.groupLevels??[];if(o.length===0){return}const n=o[e.level-1];if(t){const o=t(e.context,n);if(typeof o!=="string"){throw new Error("The group header title must be a string")}e.title=o}else{e.title=e.context.getProperty(n,true)}}return n});
//# sourceMappingURL=ODataV4Aggregation.js.map