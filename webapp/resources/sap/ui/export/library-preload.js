//@ui5-bundle sap/ui/export/library-preload.js
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportBase", ["sap/ui/core/Core","sap/ui/base/EventProvider","sap/base/Log","sap/ui/export/ExportUtils"],function(t,e,o,r){"use strict";const i=e.extend("sap.ui.export.ExportBase",{constructor:function(t,o){e.call(this,t);this._mCapabilities=o||{};this._mSettings={fileName:"Export"};["count","dataSource","fileName","fileType","workbook"].forEach(function(e){if(typeof t[e]!=="undefined"){this._mSettings[e]=e!=="dataSource"?t[e]:this.processDataSource(t[e])}}.bind(this));if(this._mSettings.workbook){this._mSettings.workbook.hierarchyLevel=r.getHierarchyLevel(t.dataSource)||this._mSettings.workbook.hierarchyLevel;this._mSettings.workbook.drillState=r.getHierarchyDrillState(t.dataSource)||this._mSettings.workbook.drillState}}});i.prototype.attachBeforeExport=function(t,e,o){return this.attachEvent("beforeExport",t,e,o)};i.prototype.detachBeforeExport=function(t,e){return this.detachEvent("beforeExport",t,e)};i.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this.cancel();this._mSettings=null;this._mCapabilities=null;this.bIsDestroyed=true};i.prototype.cancel=function(){throw new Error("Abstract function not implemented")};i.prototype.processDataSource=function(t){throw new Error("Abstract function not implemented")};i.prototype.setDefaultExportSettings=function(t){throw new Error("Abstract function not implemented")};i.prototype.createBuildPromise=function(t){throw new Error("Abstract function not implemented")};i.prototype.getMimeType=function(){throw new Error("Abstract function not implemented")};i.prototype.build=async function(){const t=this._mSettings;if(this.bIsDestroyed){const t=this.getMetadata().getName()+": Cannot trigger build - the object has been destroyed";o.error(t);return Promise.reject(t)}await this.setDefaultExportSettings(t);const e=this.fireEvent("beforeExport",{exportSettings:t},true,false);if(!e){return Promise.resolve()}r.validateSettings(t);return this.createBuildPromise(t)};return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportDialog", ["sap/ui/core/library","sap/ui/core/format/NumberFormat","sap/ui/export/ExportUtils","sap/m/library","sap/m/Dialog","sap/m/Button","sap/m/ProgressIndicator","sap/m/Text","sap/m/MessageBox","./library"],function(e,t,n,s,i,r,a,o,u,T){"use strict";var l=e.ValueState;var c=s.DialogType;var g=s.ButtonType;const f=T.Status;function p(){return new Promise(function(e,t){var s;n.getResourceBundle().then(function(t){var u=new r({text:t.getText("CANCEL_BUTTON"),press:function(){if(s&&s.oncancel){s.oncancel()}s.finish()}});var T=new a({displayAnimation:false,displayValue:"0 / 0",showValue:true,height:"0.75rem"});T.addStyleClass("sapUiMediumMarginTop");var g=new o({text:t.getText("PROGRESS_FETCHING_MSG")});s=new i({title:t.getText("PROGRESS_TITLE"),type:c.Message,contentWidth:"500px",content:[g,T],endButton:u,ariaLabelledBy:[g]});s.updateStatus=function(e,s,i){var r;if(typeof e==="string"&&e){i=e;g.setText(i)}if(!isNaN(e)&!isNaN(s)){r=e/s*100}n.announceExportStatus(f.UPDATE,{values:[e,s]});if(r>=100){T.setState(l.Success);u.setEnabled(false);g.setText(i||t.getText("PROGRESS_BUNDLE_MSG"))}T.setPercentValue(r);if(isNaN(s)||s<=0||s>=1048575){s="âˆž"}if(!isNaN(e)){T.setDisplayValue(""+e+" / "+s)}};s.finish=function(){s.close();s.destroy()};e(s)})})}function _(e){return new Promise(function(s,a){n.getResourceBundle().then(function(n){var u,T,f,p,_,N,R,x,E,S;u=[];T=false;_=t.getIntegerInstance({groupingEnabled:true});S=n.getText(e.fileType+"_FILETYPE");E=_.format(e.rowLimit);if(e.rows){N=_.format(e.rows);if(e.columns){R=_.format(e.rows*e.columns);u.push(n.getText("MSG_WARNING_CELL_COUNT",[N,e.columns,R]))}else{u.push(n.getText("MSG_WARNING_ROW_COUNT",[N]))}if(e.rows>e.rowLimit){u.push(n.getText("MSG_WARNING_ROW_LIMIT",[E,S]))}if(e.count&&e.rows<e.count){u.push(n.getText("MSG_WARNING_ROW_LIMIT",[e.rows,S]))}if(e.rows*e.columns>e.cellLimit){x=_.format(e.cellLimit);u.push(n.getText("MSG_WARNING_CELL_LIMIT",[x]))}}else{u.push(n.getText("MSG_WARNING_COUNT_UNKNOWN"));u.push(n.getText("MSG_WARNING_ROW_LIMIT",[E,S]));u.push(n.getText("MSG_WARNING_ADVICE"))}u.push(n.getText("MSG_WARNING_EXPORT_ANYWAY"));p=new o({text:u.join("\n\n")});f=new i({title:n.getText("WARNING_TITLE"),type:c.Message,state:l.Warning,content:p,contentWidth:"550px",ariaLabelledBy:p,endButton:new r({type:g.Transparent,text:n.getText("CANCEL_BUTTON"),press:function(){f.close()}}),beginButton:new r({type:g.Emphasized,text:n.getText("EXPORT_BUTTON"),press:function(){T=true;f.close()}}),afterClose:function(){f.destroy();T?s():a()}});f.open()})})}function N(e){if(!e){return}if(e instanceof Error){e=e.message}n.getResourceBundle().then(function(t){var n=e||t.getText("PROGRESS_ERROR_DEFAULT");if(e.toLowerCase().indexOf("invalid string length")>-1){n=t.getText("MSG_ERROR_OUT_OF_MEMORY")}u.error(n,{title:t.getText("PROGRESS_ERROR_TITLE")})})}return{getProgressDialog:p,showErrorMessage:N,showWarningDialog:_}},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportHandler", ["./library","./ExportUtils","./ExportDialog","./util/PDFCapabilities","sap/base/Log","sap/m/MessageToast","sap/ui/base/EventProvider","sap/ui/model/odata/v4/ODataModel","sap/ui/util/openWindow"],function(e,t,i,o,r,a,n,s,l){"use strict";const h=e.Destination;const c=e.FileType;const p=n.extend("sap.ui.export.ExportHandler",{constructor:function(e){const t=this;n.call(this);this._mCapabilities=e instanceof Object?e:{XLSX:{}};if(this._mCapabilities.PDF){const e=this._mCapabilities.PDF;if(!e?.isA?.("sap.ui.export.util.PDFCapabilities")){this._mCapabilities.PDF=new o(e)}if(!this._mCapabilities.PDF.isValid()){delete this._mCapabilities.PDF}}this._initialized=new Promise(e=>{this.isGoogleSheetSupported().then(e=>{if(e){t._mCapabilities[c.GSHEET]={};t._mDialogSettings={destination:h.REMOTE,fileType:c.GSHEET}}}).finally(e)})}});p.prototype.attachBeforeExport=function(e,t,i){return this.attachEvent("beforeExport",e,t,i)};p.prototype.detachBeforeExport=function(e,t){return this.detachEvent("beforeExport",e,t)};p.prototype.initialized=function(){return this._initialized};p.prototype.destroy=function(){n.prototype.destroy.apply(this,arguments);this._oExportDialog?.destroy();this._oFilePicker?.destroy();this._oFileShareBinding?.destroy();this._oModel?.destroy();this._mCapabilities=null;this._mDialogSettings=null;this._oDataSource=null;this._oExportDialog=null;this._oFilePicker=null;this._oFileShareBinding=null;this._oModel=null;this.bIsDestroyed=true};p.prototype.getFileShareContexts=async function(){const e=await this.getFileShareModel();if(!e){return Promise.resolve([])}if(!this._oFileShareBinding){this._oFileShareBinding=e.bindList("/FileShares")}try{return await this._oFileShareBinding.requestContexts(0)}catch(e){r.error(e?.message??e);return[]}};p.prototype.getRemoteFileLocation=async function(e){const[i,o,r]=await Promise.all([t.getResourceBundle(),this.getFileShareModel(),t.loadClass("sap/suite/ui/commons/CloudFilePicker")]);const a=this._oFilePicker=new r({sharedModel:o,suggestedFileName:e,enableDuplicateCheck:true,fileNameMandatory:true,confirmButtonText:i.getText("EXPORT_BUTTON"),title:i.getText("DESTINATION_DIALOG_TITLE")});return new Promise((e,t)=>{a.attachSelect(function(o){const r=o.getParameter("selectedFiles");const a=o.getParameter("selectedFolder");const n=o.getParameter("replaceExistingFile");const s={FileShare:a.getFileShareId(),FileShareItemKind:"document",FileShareItemName:o.getParameter("selectedFileName"),ParentFileShareItem:a.getFileShareItemId()};if(n&&Array.isArray(r)&&r.length>0){const e=r.shift();s.FileShareItem=e.getFileShareItemId()}if(!s.FileShare){t(i.getText("DESTINATION_SELECTION_INCOMPLETE"))}e(s)});a.open()})};p.prototype.getExportInstance=async function(e,o,r){const n=this;const[s,l]=await Promise.all([t.getResourceBundle(),t.getExportInstance(e,this._mCapabilities,r)]);let h=[];const p={name:s.getText("FILTER_HEADER"),items:[]};if(o?.includeFilterSettings){let i=e.workbook.context;if(!i){i=e.workbook.context={metainfo:[]}}h=t.getFilters(e.dataSource);i.metaSheetName=p.name;i.metainfo.push(p)}l.attachBeforeExport(function(e){const t=n.fireEvent("beforeExport",{exportSettings:e.getParameter("exportSettings"),userExportSettings:o||{},filterSettings:h},true,false);if(!t){e.preventDefault();return}h.filter(e=>e?.isA?.("sap.ui.export.util.Filter")).sort((e,t)=>{const i=e.getLabel().toLowerCase();const o=t.getLabel().toLowerCase();if(i>o){return 1}if(i<o){return-1}return 0}).forEach(e=>{p.items.push({key:e.getLabel(),value:e.getValue()})})});if(r&&typeof l.attachBeforeSave==="function"){l.attachBeforeSave(function(t){const o=t.getParameter("data");const n=t.getParameter("exportDialog");r.FileShareItemContentType=l.getMimeType();r.FileShareItemConvertToMimeType=l.getMimeType();if(e.fileType===c.GSHEET){r.FileShareItemConvertToMimeType="application/vnd.google-apps.spreadsheet"}const h=new Uint8Array(o);const p=new Array(h.length);for(let e=0;e<h.length;e++){p[e]=String.fromCharCode(h[e])}r.FileShareItemContent=btoa(p.join(""));n.updateStatus(s.getText("DESTINATION_DIALOG_STATUS"));t.preventDefault();this.uploadFile(r).then(()=>{a.show(s.getText("DESTINATION_TRANSFER_SUCCESS"))}).catch(()=>{i.showErrorMessage(s.getText("DESTINATION_TRANSFER_ERROR"))}).finally(()=>{n.finish()})},this)}return l};p.prototype.uploadFile=async function(e){let t;const i=await this.getFileShareModel();const o="FileShareItemContent";const r="FileShareItemContentType";if(e.FileShareItem){const a=i.getKeepAliveContext(`/FileShareItems(FileShare='${e.FileShare}',FileShareItem='${e.FileShareItem}')`);a.setProperty("FileShareItemContentLink","",null);a.setProperty(r,e[r]);await a.setProperty(o,e[o]);t=a.getProperty("FileShareItemContentLink")}else{const o=e.ParentFileShareItem?`/FileShareItems(FileShare='${e.FileShare}',FileShareItem='${e.ParentFileShareItem}')/_Children`:`/FileShares(FileShare='${e.FileShare}')/_Root/_Children`;const r=i.bindList(o);t=await this._createFile(r,e)}if(t){l(t)}};p.prototype._createFile=function(e,t){return new Promise((i,o)=>{function r(t){const{success:a,context:n}=t.getParameters();if(a){e.detachCreateCompleted(r);i(n.getProperty("FileShareItemContentLink"))}else{n.destroy();o()}}e.attachCreateCompleted(r);e.create(t,true)})};p.prototype.export=async function(e){if(this.bIsDestroyed){throw new Error("ExportHandler must not be used after calling #destroy")}const t=await this.getExportInstance(e);try{await t.build()}finally{t.destroy()}};p.prototype.exportAs=async function(e,o){if(this.bIsDestroyed){throw new Error("ExportHandler must not be used after calling #destroy")}await this.initialized();const r=Object.assign({},e,this._mDialogSettings);const a=await this.getFileShareContexts();const n=await t.getExportSettingsViaDialog(r,this._mCapabilities,a.length>0,e=>{this._oExportDialog=e});this._mDialogSettings=n;Object.assign(r,n);t.validateFileSettings(r);const s={splitCells:n.splitCells,includeFilterSettings:n.includeFilterSettings};if(r.fileType===c.PDF||n.splitCells){r.workbook.columns=t.splitColumns(r.workbook.columns,o)}if(r.includeFilterSettings){const e=await t.parseTechnicalConfiguration();let i=r.workbook.context;if(!i){i=r.workbook.context={}}i.metainfo=Array.isArray(i.metainfo)?i.metainfo.push(e):[e]}let l;if(r.destination===h.REMOTE){l=await this.getRemoteFileLocation(r.fileName)}if(l&&!l.FileShareItem){l.FileShareItemName=t.validateFileName(l.FileShareItemName,r.fileType)}if(r.fileType===c.GSHEET){await this.validateFileShare(l)}const p=await this.getExportInstance(r,s,l);try{await p.build()}catch(e){i.showErrorMessage(e);throw new Error(e)}finally{p.destroy()}};p.prototype.validateFileShare=function(e){return Promise.all([t.getResourceBundle(),this.getFileShareContexts()]).then(t=>{const[i,o]=t;const r=o.find(t=>t.getProperty("FileShare")===e.FileShare);return this.isGoogleWorkspace(r)?e:Promise.reject(i.getText("DESTINATION_ERROR_NOT_GOOGLE"))})};p.prototype.getFileShareModel=async function(){if(this._oModel){return this._oModel}const e=await t.fetchDataSource();if(e){this._oModel=new s({serviceUrl:e.uri,autoExpandSelect:true})}return this._oModel};p.prototype.isGoogleSheetSupported=async function(){const e=await this.getFileShareContexts();return e.some(this.isGoogleWorkspace)};p.prototype.isGoogleWorkspace=function(e){const t=e.getProperty("FileShareVendorType");const i=e.getProperty("FileShareDescription");return t==="GOOGLE"||typeof i==="string"&&i.indexOf("Google")>-1};return p},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/ExportUtils", ["./library","./util/Filter","sap/base/config","sap/base/Log","sap/base/i18n/Formatting","sap/base/i18n/Localization","sap/base/i18n/date/CalendarType","sap/ui/core/Element","sap/ui/core/Fragment","sap/ui/core/InvisibleMessage","sap/ui/core/Lib","sap/ui/core/Locale","sap/ui/core/format/DateFormat","sap/ui/core/library","sap/ui/core/syncStyleClass","sap/ui/core/LocaleData","sap/ui/model/json/JSONModel","sap/ui/model/resource/ResourceModel","sap/ui/performance/trace/FESRHelper","sap/ui/util/openWindow","sap/ui/VersionInfo"],function(e,t,n,a,i,r,o,l,s,u,c,f,p,d,g,y,m,h,S,T,v){"use strict";const b=d.ValueState;const E=e.FileType;const w=e.EdmType;const P=e.Destination;const _=d.InvisibleMessageMode;let A=null;let x=null;let L;const C="sap.ui.export.ExportUtils";const N=/[\\\/\?\*:\[\]]/g;const F=256;v.load().then(function(e){const t=/^[0-9]+\.[0-9]+/.exec(e.version);A=t?t[0]:null});i.attachChange(()=>{x=null});function D(e,t,n,a){const i=Object.keys(n);const r={fileName:"Standard",fileTypeCollection:[],fileType:"XLSX",destinationCollection:[{key:P.LOCAL,text:t.getText("DESTINATION_LOCAL")}],destination:P.LOCAL,paperSize:"DIN_A4",orientation:"LANDSCAPE",splitCells:false,includeFilterSettings:false,addDateTime:false,doEnableAccessibility:false,pdfArchive:false,capabilities:n,fitToPage:false,paperSizeCollection:[{key:"DIN_A4",text:t.getText("PAPER_SIZE_A4")},{key:"US_LETTER",text:t.getText("PAPER_SIZE_US_LETTER")}],orientationCollection:[{key:"LANDSCAPE",text:t.getText("ORIENTATION_LAND")},{key:"PORTRAIT",text:t.getText("ORIENTATION_PORT")}],fontSize:10,signature:false,signatureReason:"",showPageNumber:true};i.forEach(function(e){const n=e.toUpperCase();const a=`${n}_FILETYPE`;r.fileTypeCollection.push({key:n,text:t.getText(a)})});if(a){r.destinationCollection.push({key:"REMOTE",text:t.getText("DESTINATION_REMOTE")})}const o=Object.assign({},r,e||{});if(!o.fileTypeCollection.some(function(e){return e.key===o.fileType})){o.fileType=o.fileTypeCollection[0].key}return o}function I(e){const t={};["fileName","fileType","paperSize","orientation","splitCells","includeFilterSettings","addDateTime","doEnableAccessibility","fitToPage","fontSize","signature","signatureReason","pdfArchive","destination","showPageNumber"].forEach(function(n){t[n]=e[n]});return t}const R={_INTERCEPTSERVICE:"sap/ushell/cloudServices/interceptor/InterceptService",interceptUrl:function(e){const t=sap.ui.require(R._INTERCEPTSERVICE);if(t){const n=t.getInstance();if(n&&n.interceptUrl){e=n.interceptUrl(e)}}return e},fetchDataSource:function(){if(R._oDataSource){return Promise.resolve(R._oDataSource)}const e=n.get({name:"sapUiFileShareSupport",type:n.Type.String,defaultValue:undefined});if(!e){return Promise.resolve()}return new Promise(function(t){sap.ui.require([e],function(e){e.getDataSource().then(function(e){R._oDataSource=e;t(e)}).catch(function(){t()})})})},normalizeUrl:function(e){return e?new URL(e,document.baseURI).toString():e},getExportSettingsViaDialog:function(e,t,n,a,i){return new Promise(function(r,o){let u;let c=false;let f=false;if(typeof n==="object"){i=a;a=n;n=undefined}else if(typeof n==="function"){i=n;n=undefined}else if(typeof a==="function"){i=a;a=null}R.getResourceBundle().then(p=>{const d=new m;function y(e,t){const n=e.getProperty("/destination");const a=e.getProperty("/fileType");let i="OI:EXP:";i+=n===P.REMOTE?"CL:":"LOC:";switch(a){case E.PDF:i+="PDF";break;case E.XLSX:i+="XLS";break;case E.GSHEET:i+="GS";break;default:i="OI:EXP"}S.setSemanticStepname(t,"press",i)}d.setData(D(e,p,t,n));s.load({name:"sap.ui.export.fragments.SettingsDialog",type:"XML",controller:{isSupported:function(e,t){return e!==E.PDF||t},isPDF:function(e,t){return e===E.PDF&&t!==false},isSpreadsheet:function(e){return e===E.XLSX||e===E.GSHEET},isDestinationEnabled:function(e){return t?.PDF?.UploadToFileShare?e!==E.GSHEET:e===E.XLSX},hasDestinations:function(e){return e.length>1},formatExportButton:function(e){return e===P.LOCAL?p.getText("EXPORT_BUTTON"):p.getText("DIALOG_BUTTON_CLOUD_DESTINATION")},onCancel:function(){u._bSuccess=false;u.close()},onExport:function(){u._bSuccess=true;u.close()},onFileNameChange:function(e){const t=e.getSource();const n=e.getParameter("value");const a=/[\\/:|?"*<>]/;const i=l.getElementById("exportSettingsDialog-exportButton");let r=a.test(n);if(r){t.setValueState(b.Error);t.setValueStateText(p.getText("FILENAME_ERROR"))}else if(n.length>F){t.setValueState(b.Error);t.setValueStateText(p.getText("FILENAME_LENGTH_ERROR",[F]));r=true}else if(n.length>100){t.setValueState(b.Warning);t.setValueStateText(p.getText("FILENAME_WARNING"))}else{t.setValueState(b.None);t.setValueStateText(null)}c=r;i.setEnabled(!r&&!f)},onSignatureReasonChange:function(e){const t=e.getSource();const n=e.getParameter("value");const a=l.getElementById("exportSettingsDialog-exportButton");const i=n.length>F;if(i){t.setValueState(b.Error);t.setValueStateText(p.getText("SIGNATURE_REASON_LENGTH_ERROR",[F]))}else{t.setValueState(b.None);t.setValueStateText(null)}f=i;a.setEnabled(!i&&!c)},onFileTypeChange:function(e){const n=e.getParameter("selectedItem");if(!n){return}const a=n.getKey();switch(a){case E.PDF:if(!t?.PDF?.CoverPage){d.setProperty("/includeFilterSettings",false)}y(d,u.getBeginButton());break;case E.GSHEET:d.setProperty("/destination",P.REMOTE);y(d,u.getBeginButton());break;default:l.getElementById("exportSettingsDialog-signatureReason").setVisible(false);l.getElementById("exportSettingsDialog-signatureReasonLabel").setVisible(false);y(d,u.getBeginButton())}d.setProperty("/fileType",a)},onDestinationChange:function(e){if(!e.getParameter("selectedItem")){return}y(d,u.getBeginButton())},onFontSizeChange:function(e){const t=e.getSource();const n=e.getParameter("value");const a=/[^\d]/g;const i=l.getElementById("exportSettingsDialog-exportButton");const r=a.test(n);if(r){t.setValueState(b.Error);t.setValueStateText(p.getText("NUMBER_ERROR"))}else{t.setValueState(b.None);t.setValueStateText(null)}i.setEnabled(!r)},onAfterClose:function(){if(u._bSuccess){r(I(d.getData()))}else{o(null)}u.destroy();u=null}}}).then(function(e){u=e;if(t.PDF&&!t.PDF["HeaderFooter"]){d.oData.showPageNumber=false}u.setModel(d);u.setModel(new h({bundle:p}),"i18n");if(a){g("sapUiSizeCompact",a,u)}y(d,u.getBeginButton());S.setSemanticStepname(u.getEndButton(),"press","OI:EXP:CANCEL");u.open();if(i){i(u)}})})})},_getReadableFilterValue:function(e){switch(e.op||e.name){case"==":case">":case"<":case"!=":case"<=":case">=":return{operator:e.op||e.name,value:e.right.value};case"between":return{operator:e.op||e.name,value:[e.args[1].value,e.args[2].value]};case"contains":case"endswith":case"startswith":return{operator:e.op||e.name,value:e.args[1].value};default:throw Error("getReadableFilter")}},_parseFilter:function(e){switch(e.type){case"Logical":return R._parseLogical(e);case"Binary":return R._parseBinary(e);case"Unary":return R._parseUnary(e);case"Call":return R._parseCall(e);default:throw Error(`Filter type ${e.type} not supported`)}},_parseLogical:function(e){let t;try{if(e.op=="&&"&&e.left.type==="Binary"&&e.right.type==="Binary"&&e.left.op===">="&&e.right.op==="<="&&e.left.left.path===e.right.left.path){return R._parseCall({args:[{path:e.left.left.path,type:"Reference"},{type:"Literal",value:e.left.right.value},{type:"Literal",value:e.right.right.value}],name:"between",type:"Call"})}t=R._parseFilter(e.left).concat(R._parseFilter(e.right));if(e.op==="||"&&t.length){const e=t[0].key;if(t.every(function(t){return t.key===e})){t=[{key:e,value:t.reduce(function(e,t){if(Array.isArray(t.value)){return e.concat(t.value)}e.push(t.value);return e},[])}]}}}catch(e){t=[]}return t},_parseBinary:function(e){if(!e.left||e.left.type!="Reference"||!e.right||e.right.type!="Literal"){return[]}return[{key:e.left.path,value:R._getReadableFilterValue(e)}]},_parseUnary:function(e){if(!e.arg){return[]}const t=R._parseFilter(e.arg);if(e.op==="!"&&t[0].value){t[0].value.exclude=true}return t},_parseCall:function(e){if(!e.args||e.args.length<2){return[]}return[{key:e.args[0].path,value:R._getReadableFilterValue(e)}]},parseFilterConfiguration:function(){a.error("Function is deprecated and must not be used anymore");return R.getResourceBundle().then(function(e){return{name:e.getText("FILTER_HEADER"),items:[]}})},getFilters:function(e){const n=[];if(!e||!e.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){a.error("A ListBinding or TreeBinding is required for parsing the filter settings");return n}const i=e.getFilterInfo();if(i){R._parseFilter(i).forEach(function(e){n.push(new t(e.key,e.value))})}return n},parseTechnicalConfiguration:async function(){const e={};const t=sap.ui.require("sap/ushell/Container");const[n,a]=await Promise.all([R.getResourceBundle(),t?.getServiceAsync("UserInfo")]);e.name=n.getText("TECHNICAL_INFORMATION");e.items=[{key:n.getText("CREATED_TIME"),value:p.getDateTimeWithTimezoneInstance().format(new Date)}];if(a?.getFullName()){e.items.unshift({key:n.getText("USER_NAME"),value:a.getFullName()})}return e},saveAsFile:function(e,t){let n;if(!(e instanceof Blob)){return}const a=document.createElementNS("http://www.w3.org/1999/xhtml","a");const i="download"in a;if(i){n=function(e,t){a.download=t;a.href=URL.createObjectURL(e);a.dispatchEvent(new MouseEvent("click"))}}if(typeof n==="undefined"){n=function(e){const t=new FileReader;t.onloadend=function(){const e=t.result.replace(/^data:[^;]*;/,"data:attachment/file;");const n=T(e,"_blank");if(!n){window.location.href=e}};t.readAsDataURL(e)}}n(e,t)},validateSettings:function(e){R._validateDataSource(e.dataSource);R.validateFileSettings(e);if(typeof e.showProgress!=="boolean"){e.showProgress=true}R._validateWorkbook(e.workbook);if(typeof e.worker!=="boolean"){e.worker=true}R._validateScaleCustomizing(e.customizing,"currency");R._validateScaleCustomizing(e.customizing,"unit")},validateFileSettings:function(e){e.fileType=E[e.fileType]?e.fileType:E.XLSX;e.fileName=R.validateFileName(e.fileName,e.fileType)},validateFileName:function(e,t){const n="."+t.toLowerCase();e=e||"export";if(!e.endsWith(n)&&t!==E.GSHEET){e+=n;a.info(`${C}: fileName was missing the proper file extension - extension has been added`)}return e},_validateDataSource:function(e){if(!e||typeof e!=="object"){throw new Error(`${C}: dataSource has not been specified`)}e.type=typeof e.type==="string"&&e.type.toLowerCase()||"odata";if(e.type==="array"&&!Array.isArray(e.data)){a.warning(`${C}: Defined type does not match the provided data`)}if(Array.isArray(e.data)){e.count=e.data.length}if(e.type==="odata"){if(typeof e.dataUrl!=="string"||e.dataUrl.length===0){throw new Error(`${C}: Unable to export data. No dataUrl provided.`)}if(e.dataUrl){e.dataUrl=R.normalizeUrl(e.dataUrl)}if(e.serviceUrl){e.serviceUrl=R.normalizeUrl(e.serviceUrl)}}if(typeof e.count!=="number"||e.count<0||isNaN(e.count)||e.count%1!==0){a.info(`${C}: Invalid value for dataSource.count - value will be ignored`);e.count=null}if(typeof e.downloadLimit!=="number"||e.downloadLimit<0||isNaN(e.downloadLimit)||e.downloadLimit%1!==0){a.info(`${C}: Invalid value for dataSource.downloadLimit - value will be ignored`);e.downloadLimit=null}if(typeof e.useBatch!=="boolean"){e.useBatch=false;a.info(`${C}: Parameter useBatch not provided. The value false will be applied as default`)}else if(e.useBatch===true){if(typeof e.serviceUrl!=="string"||e.serviceUrl.length===0){e.useBatch=false;a.warning(`${C}: serviceUrl is required for OData batch requests`)}if(typeof e.headers!=="object"){e.useBatch=false;a.warning(`${C}: headers are required for OData batch requests`)}}let t=e.sizeLimit;if(!t||isNaN(t)||t%1!==0){const n=5e3;const i=200;t=e.count?Math.round(e.count/(i*5))*i:i;t=Math.min(n,Math.max(t,i));e.sizeLimit=t;a.info(`${C}: No valid sizeLimit provided. sizeLimit is set to ${t}`)}},_validateWorkbook:function(e){if(!(e instanceof Object)||!Array.isArray(e.columns)){throw new Error(`${C}: column configuration is not provided. Export is not possible`)}e.columns=e.columns.filter(function(e,t){if(!(e instanceof Object)){a.error(`${C}: Column ${t} skipped due to invalid configuration`);return false}if(Array.isArray(e.property)&&e.type!==w.String&&e.type!=null){a.warning(`${C}: Type ${e.type} does not support an array of properties`);e.property=e.property[0]}if(typeof e.property!=="string"&&!Array.isArray(e.property)){a.error(`${C}: Column ${t} skipped due to missing mandatory property`);return false}e.label=e.label||(e.property instanceof Array?e.property[0]:e.property);let n=e.width;if(typeof n==="string"){const e=n.toLowerCase();n=parseFloat(e);if(e.indexOf("em")>0){n=Math.floor((n*16-5)/8*100+.5)/100}else if(e.indexOf("px")>0){n=Math.floor((n-5)/8*100+.5)/100}}if(isNaN(n)||n<1){n=10}e.width=Math.round(n);R._validateType(e,t);R._validateString(e,"textAlign");if(e.textAlign){let t=String(e.textAlign).toLowerCase();if(["begin","end"].indexOf(t)>-1){const e=["left","right"];t=(r.getRTL()?e.reverse():e)[["begin","end"].indexOf(t)]}if(t!==""&&["left","right","center"].indexOf(t)==-1){a.warning(`${C}: Incorrect column alignment value ${t} on column "${e.label||e.property}". Default alignment is used.`);t=""}e.textAlign=t}["autoScale","delimiter","displayTimezone","displayUnit","utc","wrap"].forEach(function(t){R._validateProperty(e,t,"boolean")});["inputFormat","unit","unitProperty","template","trueValue","falseValue","timezone","timezoneProperty"].forEach(function(t){R._validateString(e,t)});if(e.template&&!Array.isArray(e.property)&&typeof e.inputFormat!=="string"){a.warning(`${C}: Template is not applicable on a single property without inputFormat - value will be discarded on column "${e.label||e.property}".`);delete e.template}if(typeof e.calendar==="string"&&[o.Gregorian,o.Islamic,o.Japanese].indexOf(e.calendar)<0){a.warning(`${C}: Unsupported calendar ${e.calendar} on column "${e.label||e.property}". Value will be discarded.`);delete e.calendar}if(e.type===w.Boolean&&(e.trueValue===null||e.falseValue===null)){a.warning(`${C}: The properties trueValue and falseValue have to be assigned correctly on column "${e.label||e.property}". Values will be discarded.`);delete e.trueValue;delete e.falseValue}if(e.autoScale===true&&(e.type!==w.Number||!e.unit&&!e.unitProperty)){a.warning(`${C}: autoScale cannot be taken into account due to invalid configuration.`);delete e.autoScale}if(e.type===w.DateTime){if(!e.timezone){e.timezone=e.utc===false?r.getTimezone():"UTC"}if(e.property===e.timezoneProperty||typeof e.timezoneProperty==="string"&&e.timezoneProperty.split(",").length>1){a.warning(`${C}: Property timezoneProperty is invalid.`);delete e.timezoneProperty}}else if(typeof e.utc==="boolean"){a.warning(`${C}: Property utc is only supported for type DateTime.`);delete e.utc}let i=e.scale;if(e.type===w.Number&&isNaN(i)&&i!=="variable"){a.warning(`${C}: scale parameter for numerical column configuration is missing.`)}if(typeof i==="string"){i=parseInt(i)}if(isNaN(i)){i=null}e.scale=i;if(e.valueMap&&typeof e.valueMap!=="object"){a.warning(`${C}: Invalid value for property valueMap on column "${e.label||e.property}". Value will be discarded.`);delete e.valueMap}return true});R._validateWorkbookContext(e.context);R._validateString(e,"hierarchyLevel");R._validateString(e,"drillState")},_validateType:function(e){if(typeof e.type!=="string"){e.type=w.String;return}if(!w[e.type]){let t=w.String;for(const n in w){if(n.toLowerCase()==e.type.toLowerCase()){t=n}}a.warning(`${C}: Unsupported column type ${e.type} on column ${e.label||e.property}. EdmType.${t} is applied.`);e.type=t}switch(e.type){case w.Date:if(!e.format&&!e.calendar){R._validateString(e,"format",R.getFormatSettings().datePattern);R._validateString(e,"calendar",R.getFormatSettings().calendar)}break;case w.DateTime:if(!e.format&&!e.calendar){R._validateString(e,"format",R.getFormatSettings().dateTimePattern);R._validateString(e,"calendar",R.getFormatSettings().calendar)}break;case w.Time:R._validateString(e,"format",R.getFormatSettings().timePattern);break;case w.Number:break;case w.Currency:if(!e.unitProperty){a.warning(`${C}: Missing unitProperty for type Currency on column "${e.label||e.property}". Type is reverted to String.`);e.type=w.String}break;case w.Enumeration:if(!e.valueMap||typeof e.valueMap!=="object"){a.warning(`${C}: Invalid valueMap for type Enumeration on column "${e.label||e.property}". Type is reverted to String.`);e.type=w.String}break;default:}},_validateWorkbookContext:function(e){if(!(e instanceof Object)){return}R._validateString(e,"application","SAP UI5");R._validateString(e,"version",A);R._validateString(e,"title");R._validateString(e,"modifiedBy");R._validateString(e,"sheetName","SAPUI5 Spreadsheet Export",31,N);R._validateString(e,"metaSheetName","Metadata",31,N);if(e.metainfo){if(!Array.isArray(e.metainfo)){a.warning(`${C}: Invalid value for property metainfo. Value will be discarded.`);e.metainfo=null}else{e.metainfo.filter(function(e,t){if(typeof e.name!=="string"||e.name.length===0){a.warning(`${C}: Invalid name for metainfo group at index ${t}. Entry will be discarded.`);return false}return true})}}},_validateString:function(e,t,n,i,r){R._validateProperty(e,t,"string",n);let o=e[t];if(typeof o==="string"&&(typeof r==="string"||r instanceof RegExp)){o=o.replace(r,"")}if(typeof o==="string"&&i&&o.length>i){a.warning(`${C}: The value of ${t} exceeds the max length of ${i} and will be truncated.`);o=o.slice(0,i)}e[t]=o},_validateProperty:function(e,t,n,i){let r=e[t];if(r!=null&&typeof r!==n){a.warning(`${C}: Invalid value for property ${t}. Value will be discarded.`);r=null}if(r==null&&typeof i!=="undefined"){r=i}if(r==null){delete e[t]}else{e[t]=r}},_validateScaleCustomizing:function(e,t){if(!e){return}const n=e[t];if(!(n instanceof Object)||Array.isArray(n)){a.warning(`${C}: Invalid scale customizing for ${t}.`);e[t]={}}else{for(const e in n){if(!(n[e]instanceof Object)){a.warning(`${C}: Key ${e} has been removed from customizing`);delete n[e]}else if(typeof n[e].scale!=="number"||n[e].scale<0){a.warning(`${C}: Key ${e} has been removed from customizing due to invalid scale`);delete n[e]}}}},getExportInstance:function(e,t,n){const a=typeof e.fileType==="string"?e.fileType.toUpperCase():e.fileType;let i;t=t?t:{};switch(a){case E.PDF:i="sap/ui/export/PortableDocument";break;default:i="sap/ui/export/Spreadsheet"}return new Promise(function(r){sap.ui.require([i],function(i){r(new i(e,t[a],n))})})},getCountFromBinding:function(e){let t;if(typeof e.getCount==="function"){t=e.getCount()}else if(!e.isA("sap.ui.model.TreeBinding")&&typeof e.isLengthFinal==="function"&&e.isLengthFinal()){t=e.getLength()}if(typeof t!=="number"||t<0||isNaN(t)){t=null}return t},getHierarchyLevel:function(e){if(!e||typeof e.isA!=="function"){return undefined}if(e.isA("sap.ui.model.odata.v2.ODataTreeBinding")&&typeof e.getTreeAnnotation==="function"){return e.getTreeAnnotation("hierarchy-level-for")}if(e.isA("sap.ui.model.odata.v4.ODataListBinding")){return e.getAggregation(true)?.$DistanceFromRoot}return undefined},getHierarchyDrillState:function(e){if(!e||typeof e.isA!=="function"){return undefined}if(e.isA("sap.ui.model.odata.v2.ODataTreeBinding")&&typeof e.getTreeAnnotation==="function"){return e.getTreeAnnotation("hierarchy-drill-state-for")}if(e.isA("sap.ui.model.odata.v4.ODataListBinding")){return e.getAggregation(true)?.$DrillState}return undefined},splitColumns:function(e,t){const n=[];if(typeof t!=="function"){t=function(){}}e.forEach(function(e){let a,i,r,o;if(Array.isArray(e.property)&&e.property.length>1){i=Object.assign({},e);i.property=e.property[0];i.label=t(i.property)||e.label;delete i.template;a=[i];e.property.slice(1).forEach(function(n,i){o=t(n);r={property:n,label:o||`${e.label} (${i+1})`};a.push(r)})}if(e.unitProperty&&e.displayUnit!==false){i=Object.assign({},e);o=t(e.unitProperty);a=[i,{property:e.unitProperty,label:o||`${e.label} (1)`}];i.displayUnit=false}if(e.timezoneProperty&&e.displayTimezone!==false){i=Object.assign({},e);o=t(e.timezoneProperty);a=[i,{property:e.timezoneProperty,label:o||`${e.label} (1)`}];i.displayTimezone=false}n.push(a||e)});return n.flat()},getResourceBundle:function(){if(!L){return c.load({name:"sap.ui.export"}).then(()=>{L=c.getResourceBundleFor("sap.ui.export");return L})}return Promise.resolve(L)},getFormatSettings:function(e="short",t="medium"){const n=["full","long","medium","short"];if(n.includes(e)===false||n.includes(t)===false){throw new Error(`Invalid date or time style provided. Valid styles are: ${n.join(", ")}`)}if(!x){const n={};const a=new f(r.getLanguageTag());const o=y.getInstance(a);n.calendar=i.getCalendarType();n.datePattern=o.getDatePattern(e,n.calendar);n.timePattern=o.getTimePattern(t,n.calendar);n.delimiter=!!i.getNumberSymbol("group");if(typeof n.datePattern==="string"){n.datePattern=n.datePattern.toLowerCase()}if(typeof n.timePattern==="string"){n.timePattern=n.timePattern.toLowerCase().replace(/\Wa/," AM/PM")}if(n.datePattern&&n.timePattern){n.dateTimePattern=o.getCombinedDateTimePattern(e,t,n.calendar).toLowerCase().replace(/\Wa/," AM/PM")}x=n}return x},getTimezoneTranslations:function(){const e=new f(r.getLanguageTag());const t=y.getInstance(e);return t.getTimezoneTranslations()},announceExportStatus:async function(e,t){if(!e){throw new Error("Missing parameter")}const n=u.getInstance();const a=await R.getResourceBundle();const i=a.getText(`MSG_INFO_EXPORT_${e}`,t?.values);n.announce(i,t?.assertive?_.Assertive:_.Polite)},loadClass:function(e){return new Promise(t=>{sap.ui.require([e],t)})}};return R},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/PortableDocument", ["./ExportDialog","./ExportBase","./ExportUtils","./library","./util/PDFCapabilities","sap/base/i18n/Localization","sap/base/Log","sap/m/BusyDialog","sap/ui/base/Object","sap/ui/model/odata/v4/ODataModel","sap/ui/util/openWindow"],function(e,t,o,i,r,n,s,a,c,l,u){"use strict";const p=i.FileType;const d=i.EdmType;const h=i.Status;const m="application/pdf";const f=t.extend("sap.ui.export.PortableDocument",{constructor:function(e,o,i){t.call(this,e,o);if(!c.isA(this._mCapabilities,"sap.ui.export.util.PDFCapabilities")){this._mCapabilities=new r(this._mCapabilities)}if(i?.FileShare&&i?.ParentFileShareItem){this._mCloudFileInfo=i}["paperSize","orientation","font","fontSize","doEnableAccessibility","fitToPage","signature","signatureReason","pdfArchive","showPageNumber"].forEach(t=>{if(typeof e[t]!=="undefined"){this._mSettings[t]=e[t]}})}});f.prototype.processDataSource=function(e){let t=null;const o=typeof e;if(!e){return null}if(o!="object"){s.error("Spreadsheet#processDataSource: Unable to apply data source of type "+o);return null}if(e.dataUrl&&e.serviceUrl){t=e}if(e.isA&&e.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){t=this.createDataSourceFromBinding(e)}return t};f.prototype.createDataSourceFromBinding=function(e){let t=null;if(e.isA(["sap.ui.model.ClientListBinding","sap.ui.model.ClientTreeBinding"])){s.error("Unable to create dataSource configuration due to not supported Binding: "+e.getMetadata().getName())}if(typeof e.getDownloadUrl==="function"){const i=e.getModel(),r=o.interceptUrl(e.getDownloadUrl("pdf")),n=o.interceptUrl(i.sServiceUrl),s=i.isA("sap.ui.model.odata.v4.ODataModel");const a=new URL(r,document.baseURI);a.hash="";this._oModel=i;a.search=a.search.split("&").filter(e=>e.indexOf("$format")==-1).join("&");t={type:"odata",version:s?4:2,dataUrl:a.toString(),commonServiceUrl:this._resolveCommonServiceUrl(n),serviceUrl:f.harmonizeUrl(n),headers:s?i.getHttpHeaders(true):i.getHeaders(),count:o.getCountFromBinding(e),useBatch:s||i.bUseBatch}}return t};f.prototype._resolveCommonServiceUrl=function(e){e=f.harmonizeUrl(e);const t=/^[\./]/.test(e);let o=this._mCapabilities.DocumentDescriptionReference;if(typeof o!=="string"||!o){return e.split("/").slice(0,-5).join("/")+"/default/iwbep/common/0001/"}o=o.endsWith("/")?o:o.split("/").slice(0,-1).join("/")+"/";let i=new URL(e,document.baseURI);i=new URL(o,i.href);return t?i.pathname:i.href};f.prototype._createDocumentDescription=function(e){const t=e.workbook;const o=e.dataSource.version;const i={Title:t.context.title,Format:{PaperSize:e.paperSize,Orientation:e.orientation},PDFStandard:{DoEnableAccessibility:e.doEnableAccessibility},TableColumns:[]};if(this._mCapabilities.ArchiveFormat){i.PDFStandard.UsePDFAConformance=e.pdfArchive}if(this._mCapabilities.CoverPage){const e=t.context.metainfo;i.CoverPage=[];if(e instanceof Array){e.forEach(e=>{if(o===2){e.items.forEach(t=>{const o={Title:e.name,Name:t.key,Value:t.value};i.CoverPage.push(o)})}else{const t={Title:e.name,Content:[]};e.items.forEach(e=>{t.Content.push({Name:e.key,Value:e.value})});i.CoverPage.push(t)}})}}if(this._mCapabilities.FitToPage){i.Format.FitToPage={IsEnabled:e.fitToPage,MinimumFontSize:1}}if(this._mCapabilities.FontSize){i.Format.FontSize=Number(e.fontSize)}if(this._mCapabilities.HeaderFooter&&e.showPageNumber){i.Footer={Center:{Type:"PAGENUM"}}}if(this._mCapabilities.Signature){i.Signature={DoSign:e.signature,Reason:e.signatureReason}}if(this._mCapabilities.TextDirectionLayout){i.Format.TextDirectionLayout=n.getRTL()?"RTL":"LTR"}if(this._mCapabilities.Treeview&&t.hierarchyLevel&&t.drillState){if(o===2){i.Hierarchy={DistanceFromRootElement:t.hierarchyLevel,DrillStateElement:t.drillState}}else{i.Format.TableFormat="TREE"}}if(this._mCapabilities.UploadToFileShare&&this._mCloudFileInfo){i.FileName=this._mCloudFileInfo.FileShareItemName;i.FileShare={Repository:this._mCloudFileInfo.FileShare,Folder:this._mCloudFileInfo.ParentFileShareItem};e.dataSource.headers["SAP-Upload-To-File-Share"]=true}t.columns.filter((e,t,o)=>{const i=Array.isArray(e.property)?e.property[0]:e.property;if(!i){return false}return o.findIndex(e=>{const t=Array.isArray(e.property)?e.property[0]:e.property;return i===t})===t}).forEach(e=>{const t={Name:Array.isArray(e.property)?e.property[0]:e.property,Header:e.label};if(this._mCapabilities.IANATimezoneFormat&&e.type===d.DateTime){t.Format={DisplayFormat:o==2?"IANATSSHOR":"IANA-Timestamp-Short"};if(e.timezoneProperty){t.Format.IANATimezoneProperty=e.timezoneProperty}else if(e.timezone){t.Format.IANATimezone=e.timezone}}i.TableColumns.push(t)});return i};f.prototype._getEntitySetName=function(e){let t;const o=e?.version||2;if(this._mCapabilities&&typeof this._mCapabilities.DocumentDescriptionCollection==="string"){t=this._mCapabilities.DocumentDescriptionCollection}return t||(o==4?"MyDocumentDescriptions":"SAP__MyDocumentDescriptions")};f.prototype._getModel=function(e){const t=e.version||2;return t===4?new l({serviceUrl:e.commonServiceUrl}):this._oModel};f.prototype._showWarning=function(t){let o=Promise.resolve();const i={rows:t.dataSource.count,rowLimit:this._mCapabilities.ResultSizeMaximum,fileType:p.PDF};if(isNaN(i.rows)||i.rows>i.rowLimit){o=e.showWarningDialog(i)}return o};f.showErrorMessage=async t=>{const i=await o.getResourceBundle();if(!t){return}if(typeof t.text==="function"){t.text().then(t=>{e.showErrorMessage(t)}).catch(()=>{e.showErrorMessage(i.getText("PDF_GENERIC_ERROR"))})}else if(t.message){e.showErrorMessage(t.message)}};f.prototype._applyResultSize=function(e){const t=parseInt(this._mCapabilities.ResultSizeMaximum);if(!isNaN(t)&&t>0){const o=new URL(e);o.search+="&$top="+t;e=o.toString()}return e};f.prototype.setDefaultExportSettings=function(e){let t=e?.workbook?.context;if(!(t instanceof Object)){t=e.workbook.context={}}if(typeof t.title==="string"&&t.title){return Promise.resolve()}return o.getResourceBundle().then(e=>{t.title=e.getText("XLSX_DEFAULT_TITLE")})};f.prototype.postDocumentDescription=function(e,t){const o=this._getModel(t);const i="/"+this._getEntitySetName(t);if(!o?.isA(["sap.ui.model.odata.v4.ODataModel","sap.ui.model.odata.v2.ODataModel"])){throw new Error("Unsupported Model")}if(o.isA("sap.ui.model.odata.v4.ODataModel")){const t=o.bindList(i);const r=t.create(e);return r.created().then(()=>r.getObject()["Id"])}else{return new Promise((t,r)=>{o.create(i,e,{groupId:"documentDescription",success:e=>{t(e["Id"])},error:r})})}};f.prototype.createBuildPromise=async function(e){const t=await o.getResourceBundle();const i=this._createDocumentDescription(e);let r=new a("PDFExportBusyDialog",{title:t.getText("PROGRESS_TITLE"),text:t.getText("PDF_GENERATION_IN_PROGRESS"),showCancelButton:true,close:e=>{if(e.getParameter("cancelPressed")){this.cancel()}r.destroy();r=null}});r.open();try{await this._showWarning(e);this._request=new AbortController;const t=await this.postDocumentDescription(i,e.dataSource);const r=await this.sendRequest(e.dataSource,t);o.saveAsFile(r,e.fileName);o.announceExportStatus(h.FINISHED,{assertive:true})}catch(e){f.showErrorMessage(e)}r?.destroy()};f.prototype.sendRequest=async function(e,t){if(this._request?.signal.aborted){throw null}e.dataUrl=this._applyResultSize(e.dataUrl);const o=e.useBatch?f.createBatchRequest(e,t,this._request):f.createGetRequest(e,t,this._request);try{let t=await fetch(o);if(e.useBatch){t=await f.getBatchResponse(t)}if(t.status===301&&t.headers.has("Location")){u(t.headers.get("Location"),"_blank");return undefined}if(t.ok){return t.blob()}else{throw t.text()}}catch(e){if(e.name==="AbortError"){throw null}else{throw e}}};f.harmonizeUrl=function(e){return e.endsWith("/")?e:e+"/"};f.createGetRequest=function(e,t,o){const i=new Headers(e.headers);i.set("Accept",m);i.set("SAP-Document-Description-Id",t);return new Request(e.dataUrl,{signal:o.signal,headers:i})};f.createBatchRequest=function(e,t,o){const i=e.dataUrl.split(e.serviceUrl)[1];const r="batch_"+f._createGuid();const n=new Headers(e.headers);n.set("Accept",m);n.set("SAP-Document-Description-Id",t);const s=f.createRequestBody(i,r,n);n.set("Accept","multipart/mixed");n.set("Content-Type","multipart/mixed;boundary="+r);n.delete("SAP-Document-Description-Id");n.delete("SAP-Upload-To-File-Share");return new Request(e.serviceUrl+"$batch",{body:s,cache:"no-store",headers:n,method:"POST",signal:o.signal})};f.createRequestBody=function(e,t,o){const i=[];i.push("--"+t);i.push("Content-Type: application/http");i.push("Content-Transfer-Encoding: binary");i.push("");i.push(`GET ${e} HTTP/1.1`);for(const[e,t]of o.entries()){i.push(e+":"+t)}i.push("");i.push("");i.push("--"+t+"--");i.push("");return i.join("\r\n")};f.getBatchResponse=async function(e){if(!e.ok){return e}const t=await e.arrayBuffer();const o=new Uint8Array(t);const{status:i,statusText:r,headers:n,pdfContent:s}=f.parseResponseBody(o);return new Response(s,{status:i,statusText:r,headers:n})};f.getStartIndex=function(e){return e.findIndex((t,o)=>{const i="%PDF-";return t===i.charCodeAt(0)&&e[o+1]===i.charCodeAt(1)&&e[o+2]===i.charCodeAt(2)&&e[o+3]===i.charCodeAt(3)&&e[o+4]===i.charCodeAt(4)})};f.getEndIndex=function(e){return e.findLastIndex((t,o)=>{const i="%%EOF";return t===i.charCodeAt(4)&&e[o-1]===i.charCodeAt(3)&&e[o-2]===i.charCodeAt(2)&&e[o-3]===i.charCodeAt(1)&&e[o-4]===i.charCodeAt(0)})};f.parseResponseBody=function(e){let t;const o=f.getStartIndex(e);const i=f.getEndIndex(e);if(o!==-1&&i!==-1){t=e.subarray(o,i+1)}const r=(new TextDecoder).decode(e.subarray(0,o));const n=r.split("\r\n");n.splice(0,n.findIndex(e=>/^HTTP\/1\.[0|1] ([1-9][0-9]{2})/.test(e)));const[,s,a]=n[0].match(/^HTTP\/1\.[0|1] ([1-9][0-9]{2}) ?([\w ]*)$/);const c=/^([\w\-]+): ?(.+)$/;const l=n.filter(e=>c.test(e)).reduce((e,t)=>{const[,o,i]=t.match(c);e.set(o,i);return e},new Headers);return{status:s,statusText:a,headers:l,pdfContent:t}};f._createGuid=function(){if(globalThis.crypto?.randomUUID){return globalThis.crypto.randomUUID()}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0,o=e==="x"?t:t&3|8;return o.toString(16)})};f.prototype.getMimeType=function(){return m};f.prototype.cancel=function(){this._request?.abort()};f.prototype.destroy=function(){t.prototype.destroy.apply(this,arguments);this._request=null;this._oModel=null};return f});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/Spreadsheet", ["./library","./ExportBase","./ExportDialog","./ExportUtils","./SpreadsheetExport","sap/base/Log","sap/base/i18n/Localization","sap/ui/Device","sap/ui/core/LocaleData"],function(e,t,o,s,n,r,i,a,c){"use strict";const u="sap.ui.export.Spreadsheet";const l=e.Status;const p=t.extend(u,{constructor:function(e){t.call(this,e);this._mSettings.customizing={};this._mSettings.showProgress=true;this._mSettings.worker=true;["showProgress","worker"].forEach(function(t){if(typeof e[t]!=="undefined"){this._mSettings[t]=e[t]}}.bind(this));this.codeListsPromise=this.codeListsPromise instanceof Promise?this.codeListsPromise:Promise.resolve([null,null])}});function f(e,t,o){if(!(o[e]instanceof Object)){o[e]={}}if(!isNaN(t)){o[e].scale=t}if(!isNaN(t.UnitSpecificScale)){o[e].scale=t.UnitSpecificScale}if(isNaN(o[e].scale)){delete o[e]}}p.prototype.setDefaultExportSettings=async function(e){const t=await s.getResourceBundle();e.customizing.timezone=s.getTimezoneTranslations();let o=e.workbook.context;if(!(o instanceof Object)){o=e.workbook.context={}}if(!o.title){o.title=t.getText("XLSX_DEFAULT_TITLE")}if(!o.sheetName){o.sheetName=t.getText("XLSX_DEFAULT_SHEETNAME")}const n=e.customizing.currency={};const r=e.customizing.unit={};const a=c.getInstance(i.getLanguageTag());const u=a.getAllCurrencyDigits();if(u){for(const e in u){f(e,u[e],n)}}let l;const[p,d]=await this.codeListsPromise;for(l in p){f(l,p[l],n)}for(l in d){f(l,d[l],r)}};p.requestCodeLists=function(e){if(!e.isA(["sap.ui.model.odata.ODataMetaModel","sap.ui.model.odata.v4.ODataMetaModel"])){return Promise.resolve([null,null])}return Promise.all([e.requestCurrencyCodes(),e.requestUnitsOfMeasure()]).catch(function(e){r.warning(u+": Code lists cannot be processed due to the following error - "+e);return Promise.resolve([null,null])})};p.prototype.attachBeforeSave=function(e,t,o){return this.attachEvent("beforeSave",e,t,o)};p.prototype.detachBeforeSave=function(e,t){return this.detachEvent("beforeSave",e,t)};p.prototype.cancel=function(){if(this.process){this.process.cancel();this.process=null}return this};p.prototype.getMimeType=function(){return"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"};p.prototype.onprogress=function(e,t){if(isNaN(e)||isNaN(t)){return}const o=Math.round(e/t*100);r.debug(`Spreadsheet export: ${o}% loaded.`)};p.prototype.createDataSourceFromBinding=function(e){let t=[];if(e.isA("sap.ui.model.ClientListBinding")){const o=[];e.getAllCurrentContexts().forEach(function(e){o.push(e.getObject())});t={data:o,type:"array"}}if(e.isA("sap.ui.model.ClientTreeBinding")){r.error("Unable to create dataSource configuration due to not supported Binding: "+e.getMetadata().getName())}if(typeof e.getDownloadUrl==="function"){const o=e.getModel();const n=o.isA("sap.ui.model.odata.v4.ODataModel");let r=e.getDownloadUrl("json");let i=o.sServiceUrl;r=s.interceptUrl(r);i=s.interceptUrl(i);const a=r.split(/[?&]/g).some(e=>e?.includes("$apply")&&e?.includes("com.sap.vocabularies.Hierarchy.v1.TopLevels"));t={type:"odata",dataUrl:r,serviceUrl:i,headers:n?o.getHttpHeaders(true):o.getHeaders(),count:a?undefined:s.getCountFromBinding(e),useBatch:n||o.bUseBatch};if(o.getMetaModel()&&typeof o.getMetaModel().requestCurrencyCodes==="function"&&typeof o.getMetaModel().requestUnitsOfMeasure==="function"){this.codeListsPromise=p.requestCodeLists(o.getMetaModel(),this._mSettings)}}return t};p.prototype.processDataSource=function(e){const t=typeof e;let o=null;if(!e){return null}if(t=="string"){return{count:this._mSettings.count,dataUrl:e,type:"odata",useBatch:false}}if(t!="object"){r.error("Spreadsheet#processDataSource: Unable to apply data source of type "+t);return null}if(e instanceof Array){o={data:e,type:"array"}}if(e.dataUrl){o=e}if(e.isA&&e.isA(["sap.ui.model.ListBinding","sap.ui.model.TreeBinding"])){o=this.createDataSourceFromBinding(e)}return o};p.prototype.createBuildPromise=function(t){const r=this;return new Promise(function(i,c){let u;const p=1048576;const f=t.dataSource.count;const d=t.dataSource.downloadLimit;const g=a.system.desktop?2e6:1e5;const h=t.dataSource.type=="array"?t.dataSource.data.length:d||f;const m=t.workbook.columns.length;function y(e){if(e.progress){if(u){u.updateStatus(e.fetched,e.total)}r.onprogress(e.fetched,e.total)}if(e.finished&&r.process!==null){r.process=null;if(!e.spreadsheet){c();return}const o=r.fireEvent("beforeSave",{data:e.spreadsheet,exportDialog:u},true,false);if(o){if(u){window.setTimeout(u.finish,1e3)}s.saveAsFile(new Blob([e.spreadsheet],{type:r.getMimeType()}),t.fileName)}s.announceExportStatus(l.FINISHED,{assertive:true});i()}if(typeof e.error!="undefined"){const t=e.error.message||e.error;r.process=null;if(u){u.finish()}c(t);o.showErrorMessage(t)}}function S(e,t){return e<t}function w(){if(!t.showProgress){if(r.process){c("Cannot start export: the process is already running");return}r.process=n.execute(t,y);return}o.getProgressDialog().then(function(e){u=e;if(r.process){c("Cannot start export: the process is already running");return}u.oncancel=function(){return r.process&&r.process.cancel()};u.open();u.updateStatus(0,Math.min(d||p,f||p));r.process=n.execute(t,y)})}if(m<=0){c("No columns to export.")}else if(h*m>g||!h||h>=p||S(h,f)){const t={rows:h,columns:m,cellLimit:g,rowLimit:p,fileType:e.FileType.XLSX,count:f};o.showWarningDialog(t).then(w).catch(c)}else{w()}})};return p});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/SpreadsheetExport", ["sap/base/Log","sap/ui/export/ExportUtils"],function(e,r){"use strict";var t="sap/ui/export/provider/DataProviderBase",n="sap/ui/export/js/XLSXBuilder",o="sap/ui/export/js/libs/JSZip3";var i={execute:function(i,a){function s(e){if(e instanceof MessageEvent&&e.data){e=e.data}if(typeof a==="function"){a(e)}}function u(e,r){s({progress:true,fetched:e||0,total:r||0})}function c(e){s({error:e.message||e})}function f(e){s({finished:true,spreadsheet:e})}function l(){var e;var r;function a(t,n){r=t.getDataConverter(i);e=new n(i.workbook.columns,i.workbook.context,i.workbook.hierarchyLevel,i.customizing);var o=i.dataSource.data||[];var a=o.length;var s=r(o.slice());e.append(s);u(a,a);e.build().then(f)}sap.ui.require([t,n,o],a);return{cancel:f}}function p(){var e,r;function a(t,n){var o=new t(i);e=new n(i.workbook.columns,i.workbook.context,i.workbook.hierarchyLevel,i.customizing);r=o.requestData(s)}function s(r){if(r.error||typeof r.error==="string"){c(r.error);return}e.append(r.rows);u(r.fetched,r.total);if(r.finished){e.build().then(f)}}function l(){r.cancel();f()}sap.ui.require([t,n,o],a);return{cancel:l}}function d(){var t;var n={};var o=function(){t.postMessage({cancel:true});f()};function a(e){var r=new Worker(e);r.onmessage=s;if(navigator.userAgent.indexOf("Firefox")===-1||u(e)){r.onerror=c}r.postMessage(i);return r}function u(e){return e.indexOf(window.location.host)>0||/^[^/]+\/[^/].*$|^\/[^/].*$/i.test(e)}function l(){var r,t;e.warning("Direct worker is not allowed. Load the worker via blob.");r='self.origin = "'+n.base+'"; '+'importScripts("'+n.src+'")';t=window.URL.createObjectURL(new Blob([r]));return a(t)}function d(){e.warning("Blob worker is not allowed. Use in-process export.");o=p(i).cancel}function v(){try{t=a(n.src);t.addEventListener("error",function(e){t=l();t.addEventListener("error",function(e){d();e.preventDefault()});e.preventDefault()})}catch(e){try{t=l()}catch(e){d()}}}n.base=r.normalizeUrl(sap.ui.require.toUrl("sap/ui/export/js/"));n.src=n.base+"SpreadsheetWorker.js";v();return{cancel:function(){o()}}}if(i.dataSource.type==="array"){return l()}else if(i.worker===false){return p()}else{return d()}}};return i},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/library", ["sap/ui/core/Lib"],function(e){"use strict";var i=e.init({name:"sap.ui.export",apiVersion:2,dependencies:["sap.ui.core"],types:["sap.ui.export.Destination","sap.ui.export.EdmType","sap.ui.export.FileType","sap.ui.export.Status"],interfaces:[],controls:[],elements:[],version:"1.141.0"});i.EdmType={BigNumber:"BigNumber",Boolean:"Boolean",Currency:"Currency",Date:"Date",DateTime:"DateTime",Enumeration:"Enumeration",Number:"Number",Percentage:"Percentage",String:"String",Time:"Time",Timezone:"Timezone"};i.FileType={CSV:"CSV",GSHEET:"GSHEET",PDF:"PDF",XLSX:"XLSX"};i.Destination={LOCAL:"LOCAL",REMOTE:"REMOTE"};i.Status={FINISHED:"FINISHED",UPDATE:"UPDATE"};sap.ui.loader.config({shim:{"sap/ui/export/js/XLSXBuilder":{amd:true,exports:"XLSXBuilder"},"sap/ui/export/js/XLSXExportUtils":{amd:true,exports:"XLSXExportUtils"}}});return i});
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/util/Filter", ["sap/ui/base/Object"],function(t){"use strict";var e=t.extend("sap.ui.export.util.Filter",{constructor:function(t,e,r){this.property=t;this.rawValues=Array.isArray(e)?e:[e];this.label=typeof r==="string"?r:undefined}});e.prototype.getProperty=function(){return this.property};e.prototype.getLabel=function(){return this.label||this.property};e.prototype.getValue=function(){var t,e;t=[];e=this.type?this.format||this.type.formatValue.bind(this.type):this.format;this.getRawValues().forEach(function(r){var i=r.value;if(typeof e==="function"){if(Array.isArray(r.value)){i=[];r.value.forEach(function(t){try{i.push(e(t,"string"))}catch(e){i.push(t)}})}else{try{i=e(r.value,"string")}catch(t){}}}switch(r.operator){case"==":i="="+i;break;case"between":i=i[0]+"..."+i[1];break;case"contains":i="*"+i+"*";break;case"endswith":i="*"+i;break;case"startswith":i+="*";break;default:i=r.operator+i}if(r.exclude){i="!"+i}t.push(i)});return t.join("; ")};e.prototype.getRawValues=function(){return this.rawValues};e.prototype.setFormat=function(t){if(typeof t!=="function"&&t!==null){return}this.format=t};e.prototype.setLabel=function(t){if(typeof t!=="string"||!t){return}this.label=t};e.prototype.setType=function(t){if(!t||typeof t.isA!=="function"||!t.isA("sap.ui.model.SimpleType")){return}this.type=t};return e},true);
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.predefine("sap/ui/export/util/PDFCapabilities", ["sap/ui/base/Object"],function(e){"use strict";const t={ArchiveFormat:false,Border:false,CoverPage:false,DocumentDescriptionCollection:"",DocumentDescriptionReference:"",FitToPage:false,FontName:false,FontSize:false,HeaderFooter:false,IANATimezoneFormat:false,Margin:false,Padding:false,ResultSizeDefault:2e4,ResultSizeMaximum:2e4,Signature:false,TextDirectionLayout:false,Treeview:false,UploadToFileShare:false};const i=e.extend("sap.ui.export.util.PDFCapabilities",{constructor:function(e){e=e||{};for(const[i,o]of Object.entries(t)){this[i]=typeof e[i]===typeof o?e[i]:o}}});i.prototype.isValid=function(){return this["DocumentDescriptionReference"]&&this["DocumentDescriptionCollection"]&&this["ResultSizeMaximum"]>0};return i});
sap.ui.require.preload({
	"sap/ui/export/fragments/SettingsDialog.fragment.xml":'<Dialog xmlns="sap.m" xmlns:core="sap.ui.core" id="exportSettingsDialog" title="{i18n>EXPORT_SETTINGS_TITLE}" horizontalScrolling="false" verticalScrolling="true" afterClose=".onAfterClose" class="sapUiContentPadding sapUiExportSettings"><content><VBox renderType="Bare" width="100%" class="sapUiExportSettingsLabel"><Label text="{i18n>FILE_NAME}" labelFor="exportSettingsDialog-fileName"/><Input id="exportSettingsDialog-fileName" value="{/fileName}" liveChange=".onFileNameChange" class="sapUiTinyMarginBottom"/><Label text="{i18n>SELECT_FORMAT}" labelFor="exportSettingsDialog-fileType"/><Select id="exportSettingsDialog-fileType" selectedKey="{path: \'/fileType\', mode: \'OneWay\' }" items="{/fileTypeCollection}" change=".onFileTypeChange" width="100%" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>SELECT_DESTINATION}" labelFor="exportSettingsDialog-destination" visible="{path: \'/destinationCollection\', formatter: \'.hasDestinations\'}"/><Select id="exportSettingsDialog-destination" selectedKey="{/destination}" items="{/destinationCollection}" change=".onDestinationChange" visible="{path: \'/destinationCollection\', formatter: \'.hasDestinations\'}" enabled="{path: \'/fileType\', formatter: \'.isDestinationEnabled\'}" width="100%" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><CheckBox id="exportSettingsDialog-includeFilterSettings" selected="{/includeFilterSettings}" text="{i18n>INCLUDE_FILTER_SETTINGS}"  visible="{parts:[\'/fileType\', \'/capabilities/PDF/CoverPage\'], formatter: \'.isSupported\'}" tooltip="{i18n>TOOLTIP_FILTER_SETTINGS}"/><CheckBox id="exportSettingsDialog-pdfArchive" selected="{/pdfArchive}" text="{i18n>ARCHIVE_FORMAT}"  visible="{parts:[\'/fileType\', \'/capabilities/PDF/ArchiveFormat\'], formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_ARCHIVE_FORMAT}"/><CheckBox id="exportSettingsDialog-splitCells" selected="{/splitCells}" text="{i18n>SPLIT_CELLS}" visible="{path:\'/fileType\', formatter: \'.isSpreadsheet\'}"/><CheckBox id="exportSettingsDialog-addDateTime" selected="{/addDateTime}" text="{i18n>ADD_DATE_TIME}" visible="false"/><Label text="{i18n>PAPER_SIZE}" labelFor="exportSettingsDialog-papersize" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Select id="exportSettingsDialog-papersize" selectedKey="{/paperSize}" items="{/paperSizeCollection}" width="100%" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>ORIENTATION}" labelFor="exportSettingsDialog-orientation" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><Select id="exportSettingsDialog-orientation" selectedKey="{/orientation}" items="{/orientationCollection}" width="100%" visible="{path:\'/fileType\', formatter: \'.isPDF\'}" class="sapUiTinyMarginBottom"><items><core:Item key="{key}" text="{text}"/></items></Select><Label text="{i18n>FONT_SIZE}" labelFor="exportSettingsDialog-fontSize" visible="{parts:[\'/fileType\', \'/capabilities/PDF/FontSize\'], formatter: \'.isPDF\'}"/><Input id="exportSettingsDialog-fontSize" value="{/fontSize}" liveChange=".onFontSizeChange" class="sapUiTinyMarginBottom" visible="{parts:[\'/fileType\', \'/capabilities/PDF/FontSize\'], formatter: \'.isPDF\'}" tooltip="{i18n>TOOLTIP_FONT_SIZE}"/><CheckBox id="exportSettingsDialog-accessibility" selected="{/doEnableAccessibility}" text="{i18n>ENABLE_ACCESSIBILITY}" tooltip="{i18n>TOOLTIP_PDF_ACCESSIBILITY}" visible="{path:\'/fileType\', formatter: \'.isPDF\'}"/><CheckBox id="exportSettingsDialog-fitToPage" selected="{/fitToPage}" text="{i18n>FITTOPAGE}" tooltip="{i18n>TOOLTIP_FITTOPAGE}" visible="{parts:[\'/fileType\', \'/capabilities/PDF/FitToPage\'], formatter: \'.isPDF\'}"/><CheckBox id="exportSettingsDialog-signature" selected="{/signature}" text="{i18n>ENABLE_SIGNATURE}" tooltip="{i18n>TOOLTIP_PDF_SIGNATURE}" visible="{parts:[\'/fileType\', \'/capabilities/PDF/Signature\'], formatter: \'.isPDF\'}"/><Label id="exportSettingsDialog-signatureReasonLabel" text="{i18n>SIGNATURE_REASON}" labelFor="exportSettingsDialog-signatureReason" visible="{/signature}"/><Input id="exportSettingsDialog-signatureReason" value="{/signatureReason}" liveChange=".onSignatureReasonChange"  class="sapUiTinyMarginBottom" visible="{/signature}"/><CheckBox id="exportSettingsDialog-showPageNumber" selected="{/showPageNumber}" text="{i18n>SHOW_PAGENUM}" tooltip="{i18n>TOOLTIP_PDF_PAGENUMBER}" visible="{parts:[\'/fileType\', \'/capabilities/PDF/HeaderFooter\'], formatter: \'.isPDF\'}"/></VBox></content><beginButton><Button id="exportSettingsDialog-exportButton" press=".onExport" text="{path:\'/destination\', formatter:\'.formatExportButton\'}" type="Emphasized"/></beginButton><endButton><Button id="exportSettingsDialog-cancelButton" press=".onCancel" text="{i18n>CANCEL_BUTTON}" type="Transparent"/></endButton></Dialog>',
	"sap/ui/export/manifest.json":'{"_version":"1.21.0","sap.app":{"id":"sap.ui.export","type":"library","embeds":[],"applicationVersion":{"version":"1.141.0"},"title":"UI5 library: sap.ui.export","description":"UI5 library: sap.ui.export","ach":"CA-UI5-TBL","resources":"resources.json","offline":true,"openSourceComponents":[{"name":"JSZip3","packagedWithMySelf":true,"version":"3.10.1"}]},"sap.ui":{"technology":"UI5","supportedThemes":["base","sap_belize","sap_belize_base","sap_belize_hcb","sap_belize_hcw","sap_belize_plus","sap_bluecrystal","sap_bluecrystal_base","sap_fiori_3","sap_fiori_3_dark","sap_fiori_3_hcb","sap_fiori_3_hcw","sap_hcb","sap_horizon","sap_horizon_dark","sap_horizon_hcb","sap_horizon_hcw"]},"sap.ui5":{"dependencies":{"minUI5Version":"1.141","libs":{"sap.ui.core":{"minVersion":"1.141.0"}}},"library":{"i18n":{"bundleUrl":"messagebundle.properties","supportedLocales":["","ar","bg","ca","cnr","cs","cy","da","de","el","en","en-GB","en-US-sappsd","en-US-saprigi","en-US-saptrc","es","es-MX","et","fi","fr","fr-CA","hi","hr","hu","id","it","iw","ja","kk","ko","lt","lv","mk","ms","nl","no","pl","pt","pt-PT","ro","ru","sh","sk","sl","sr","sv","th","tr","uk","vi","zh-CN","zh-TW"]},"content":{"controls":[],"elements":[],"types":["sap.ui.export.Destination","sap.ui.export.EdmType","sap.ui.export.FileType","sap.ui.export.Status"],"interfaces":[]}}}}',
	"sap/ui/export/provider/DataProviderBase.js":function(){
/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
(function(t){"use strict";if(typeof globalThis.sap?.ui?.define==="function"){globalThis.sap.ui.define([],t,true)}else{globalThis.DataProviderBase=t()}})(function(){"use strict";const t=function(e){this.mSettings=e;this.bCanceled=false;this.iAvailableRows=0;this.mRequest=null;this.iCount=Math.min(e.dataSource.count||t.MAX_ROWS,t.MAX_ROWS);this.iTotalRows=e.dataSource.downloadLimit??t.MAX_ROWS;this.iBatchSize=Math.min(e.dataSource.sizeLimit||t.MAX_ROWS,this.iTotalRows);this.fnConvertData=t.getDataConverter(e);this._prepareDataUrl()};t.MAX_ROWS=1048575;t.HTTP_ERROR_MSG="HTTP connection error";t.HTTP_WRONG_RESPONSE_MSG="Unexpected server response:\n";t._createGuid=function(){if(globalThis.crypto?.randomUUID){return globalThis.crypto.randomUUID()}return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0,n=t==="x"?e:e&3|8;return n.toString(16)})};t.getColumnsToConvert=function(t){return t.reduce(function(t,e){const n=e.property instanceof Array?e.property:[e.property];if(e.unitProperty){n.push(e.unitProperty)}n.forEach(function(e){const n=e.split("/");if(n.length>1){t.push({property:e,keys:n})}});return t},[])};t.getDataConverter=function(e){let n=e.workbook.columns;if(e.workbook.hierarchyLevel){n=n.concat([{property:e.workbook.hierarchyLevel}])}const s=this.getColumnsToConvert(n);return function(e){return t._convertData(e,s)}};t._convertData=function(e,n){n.forEach(function(n){e.forEach(function(e){e[n.property]=t._getValue(e,n)})});return e};t._getValue=function(t,e){const n=e.keys.reduce(function(t,e){return t&&t[e]},t);return n};t.prototype.requestData=function(t){const e=this.mSettings.dataSource;this.fnProcessCallback=t;this.mRequest={serviceUrl:this._cleanUrl(e.serviceUrl),dataUrl:this._getUrl(0,this.iBatchSize),useBatch:e.useBatch,headers:e.headers};this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this));return{cancel:function(){this.bCanceled=true;if(this._oPendingRequest instanceof AbortController){this._oPendingRequest.abort()}}.bind(this)}};t.prototype.fnOnDataReceived=async function(e){this._oPendingRequest=null;if(this.bCanceled){return}const{data:n,nextUrl:s}=await t.getHarmonizedBodyFrom(e);const r=this.mRequest?.dataUrl.includes("$skiptoken");const i=n.length;this.iAvailableRows+=i;const o=this.iTotalRows-this.iAvailableRows;const a={};a.finished=this._isFinished(i,s,o,r);a.progress=this.iTotalRows;a.total=this.iTotalRows<this.iCount?this.iTotalRows:this.iCount;a.fetched=this.iAvailableRows;if(!a.finished){this.mRequest.dataUrl=this._getUrl(this.iAvailableRows,Math.min(this.iBatchSize,o),s);this.sendRequest(this.mRequest).then(this.fnOnDataReceived.bind(this)).catch(this.fnOnError.bind(this))}if(i<this.iBatchSize&&s){this.iBatchSize=i}a.rows=this.fnConvertData(n);this.fnProcessCallback(a)};t.prototype._isFinished=function(t,e,n,s){if(t===0||n<=0){return true}if(t===this.iBatchSize){return false}if(e){return false}if(t<this.iBatchSize&&s){return false}return true};t.prototype.fnOnError=function(t){this.fnProcessCallback({error:t})};t.prototype._cleanUrl=function(t){if(!t){return""}const e=new URL(t);e.hash=e.search="";e.pathname+=e.pathname.endsWith("/")?"":"/";return e.toString()};t.prototype._prepareDataUrl=function(){const t=this.mSettings.dataSource;const e=/\$skip\=[0-9]+/,n=/\$top\=[0-9]+/;if(!t.dataUrl){throw"Unable to load data - no URL provided."}const s=new URL(t.dataUrl);s.search=s.search||"";if(!e.test(s.search)){s.search+=(s.search.length?"&$skip=":"$skip=")+0}if(!n.test(s.search)){s.search+="&$top="+0}this.mSettings.dataSource.dataUrl=s.toString()};t.prototype._getUrl=function(t,e,n){const s=new URL(this.mSettings.dataSource.dataUrl);if(n){const t=new URL(n,s.origin);s.search=t.search}else{s.search=(s.search||"").replace(/\$skip\=[0-9]+/g,"$skip="+t).replace(/\$top\=[0-9]+/g,"$top="+e)}return s.toString()};t.prototype.sendRequest=async function(e){if(typeof e!=="object"||e===null||typeof e.dataUrl!=="string"){throw new Error("Unable to send request - Mandatory parameters missing.")}const n=e.useBatch&&e.serviceUrl;const s=new AbortController;const r=n?t.createBatchRequest(e,s):t.createGetRequest(e,s);let i;try{this._oPendingRequest=s;i=await fetch(r)}catch(t){this._oPendingRequest=null;if(t.name==="AbortError"){throw null}else{throw t}}i=n?await t.getBatchResponse(i):i;if(!i.ok){const e=await i.text();throw new Error(t.HTTP_WRONG_RESPONSE_MSG+e)}return i};t.createGetRequest=function(t,e){const n=new Headers(t.headers);n.set("Accept","application/json");return new Request(t.dataUrl,{cache:"no-store",headers:n,signal:e.signal})};t.createBatchRequest=function(e,n){const s=e.dataUrl.split(e.serviceUrl)[1];const r="batch_"+t._createGuid();const i=new Headers(e.headers);const o=t.createRequestBody(s,r,i);i.set("Accept","multipart/mixed");i.set("Content-Type","multipart/mixed;boundary="+r);return new Request(e.serviceUrl+"$batch",{body:o,cache:"no-store",headers:i,method:"POST",signal:n.signal})};t.createRequestBody=function(t,e,n){const s=[];s.push("--"+e);s.push("Content-Type: application/http");s.push("Content-Transfer-Encoding: binary");s.push("");s.push(`GET ${t} HTTP/1.1`);s.push("Accept:application/json");for(const[t,e]of n.entries()){if(t!="accept"){s.push(t+":"+e)}}s.push("");s.push("");s.push("--"+e+"--");s.push("");return s.join("\r\n")};t.getBatchResponse=async function(e){const n=await e.text();if(!e.ok){throw new Error(t.HTTP_WRONG_RESPONSE_MSG+n)}const s=n.split("\r\n");s.splice(0,s.findIndex(t=>/^HTTP\/1\.[0|1] ([1-9][0-9]{2})/.test(t)));const[,r,i]=s[0].match(/^HTTP\/1\.[0|1] ([1-9][0-9]{2}) ?([\w ]*)$/);const o=s.find(t=>t.startsWith("{")&&t.endsWith("}"));const a=/^([\w\-]+): ?([\d\w\./]+)/;const c=s.filter(t=>a.test(t)).reduce((t,e)=>{const[,n,s]=e.match(a);t.set(n,s);return t},new Headers);return new Response(o,{status:r,statusText:i,headers:c})};t.getHarmonizedBodyFrom=async function(t){const e={data:[]};if(!t){return e}const n=await t.json();if(!n){return e}const s=n.value||n.d?.results||n.d||n;e.nextUrl=n["@odata.nextLink"]??n.d?.__next;if(Array.isArray(s)){e.data=s}return e};return t});
}
});
//# sourceMappingURL=library-preload.js.map
