/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/Core","sap/ui/base/EventProvider","sap/base/Log","sap/ui/export/ExportUtils"],function(t,e,o,r){"use strict";const i=e.extend("sap.ui.export.ExportBase",{constructor:function(t,o){e.call(this,t);this._mCapabilities=o||{};this._mSettings={fileName:"Export"};["count","dataSource","fileName","fileType","workbook"].forEach(function(e){if(typeof t[e]!=="undefined"){this._mSettings[e]=e!=="dataSource"?t[e]:this.processDataSource(t[e])}}.bind(this));if(this._mSettings.workbook){this._mSettings.workbook.hierarchyLevel=r.getHierarchyLevel(t.dataSource)||this._mSettings.workbook.hierarchyLevel;this._mSettings.workbook.drillState=r.getHierarchyDrillState(t.dataSource)||this._mSettings.workbook.drillState}}});i.prototype.attachBeforeExport=function(t,e,o){return this.attachEvent("beforeExport",t,e,o)};i.prototype.detachBeforeExport=function(t,e){return this.detachEvent("beforeExport",t,e)};i.prototype.destroy=function(){e.prototype.destroy.apply(this,arguments);this.cancel();this._mSettings=null;this._mCapabilities=null;this.bIsDestroyed=true};i.prototype.cancel=function(){throw new Error("Abstract function not implemented")};i.prototype.processDataSource=function(t){throw new Error("Abstract function not implemented")};i.prototype.setDefaultExportSettings=function(t){throw new Error("Abstract function not implemented")};i.prototype.createBuildPromise=function(t){throw new Error("Abstract function not implemented")};i.prototype.getMimeType=function(){throw new Error("Abstract function not implemented")};i.prototype.build=async function(){const t=this._mSettings;if(this.bIsDestroyed){const t=this.getMetadata().getName()+": Cannot trigger build - the object has been destroyed";o.error(t);return Promise.reject(t)}await this.setDefaultExportSettings(t);const e=this.fireEvent("beforeExport",{exportSettings:t},true,false);if(!e){return Promise.resolve()}r.validateSettings(t);return this.createBuildPromise(t)};return i});
//# sourceMappingURL=ExportBase.js.map