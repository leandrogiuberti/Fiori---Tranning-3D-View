{"version":3,"file":"Spreadsheet.js","names":["sap","ui","define","Library","ExportBase","ExportDialog","ExportUtils","SpreadsheetExport","Log","Localization","Device","LocaleData","CLASS_NAME","Status","Spreadsheet","extend","constructor","mSettings","call","this","_mSettings","customizing","showProgress","worker","forEach","sProperty","bind","codeListsPromise","Promise","resolve","addUnit","sCurrencyCode","oCurrency","mCurrencies","Object","isNaN","scale","UnitSpecificScale","prototype","setDefaultExportSettings","async","mParameters","oResourceBundle","getResourceBundle","timezone","getTimezoneTranslations","oWorkbookContext","workbook","context","title","getText","sheetName","mCurrencySettings","currency","mUnitSettings","unit","oLocaleData","getInstance","getLanguageTag","oLocaleDataCurrencies","getAllCurrencyDigits","sUnitCode","mCurrencyCodes","mUnitsOfMeasure","requestCodeLists","oMetaModel","isA","all","requestCurrencyCodes","requestUnitsOfMeasure","catch","oError","warning","attachBeforeSave","oData","fnHandler","oListener","attachEvent","detachBeforeSave","detachEvent","cancel","process","getMimeType","onprogress","iFetched","iTotal","iProgress","Math","round","debug","createDataSourceFromBinding","oBinding","oDataSource","aData","getAllCurrentContexts","oContext","push","getObject","data","type","error","getMetadata","getName","getDownloadUrl","oModel","getModel","bV4ODataModel","sDataUrl","sServiceUrl","interceptUrl","bIgnoreCount","split","some","sQuery","includes","dataUrl","serviceUrl","headers","getHttpHeaders","getHeaders","count","undefined","getCountFromBinding","useBatch","bUseBatch","getMetaModel","processDataSource","sDataSourceType","mDataSource","Array","createBuildPromise","that","fnResolve","fnReject","progressDialog","MAX_ROWS","iCount","dataSource","iDownloadLimit","downloadLimit","nSizeLimit","system","desktop","nRows","length","nColumns","columns","onmessage","oMessage","progress","updateStatus","fetched","total","finished","spreadsheet","executeDefaultAction","fireEvent","exportDialog","window","setTimeout","finish","saveAsFile","Blob","fileName","announceExportStatus","FINISHED","assertive","sError","message","showErrorMessage","isDownloadLimitLessThanCount","startExport","execute","getProgressDialog","then","oDialogResolve","oncancel","open","min","oDialogSettings","rows","cellLimit","rowLimit","fileType","FileType","XLSX","showWarningDialog"],"sources":["Spreadsheet-dbg.js"],"mappings":"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","ignoreList":[]}