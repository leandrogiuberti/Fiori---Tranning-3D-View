ace.define("ace/ext/elastic_tabstops_lite",["require","exports","module","ace/editor","ace/config"],function(t,e,s){"use strict";var i=function(){function t(t){this.$editor=t;var e=this;var s=[];var i=false;this.onAfterExec=function(){i=false;e.processRows(s);s=[]};this.onExec=function(){i=true};this.onChange=function(t){if(i){if(s.indexOf(t.start.row)==-1)s.push(t.start.row);if(t.end.row!=t.start.row)s.push(t.end.row)}}}t.prototype.processRows=function(t){this.$inChange=true;var e=[];for(var s=0,i=t.length;s<i;s++){var o=t[s];if(e.indexOf(o)>-1)continue;var r=this.$findCellWidthsForBlock(o);var n=this.$setBlockCellWidthsToMax(r.cellWidths);var a=r.firstRow;for(var h=0,l=n.length;h<l;h++){var c=n[h];e.push(a);this.$adjustRow(a,c);a++}}this.$inChange=false};t.prototype.$findCellWidthsForBlock=function(t){var e=[],s;var i=t;while(i>=0){s=this.$cellWidthsForRow(i);if(s.length==0)break;e.unshift(s);i--}var o=i+1;i=t;var r=this.$editor.session.getLength();while(i<r-1){i++;s=this.$cellWidthsForRow(i);if(s.length==0)break;e.push(s)}return{cellWidths:e,firstRow:o}};t.prototype.$cellWidthsForRow=function(t){var e=this.$selectionColumnsForRow(t);var s=[-1].concat(this.$tabsForRow(t));var i=s.map(function(t){return 0}).slice(1);var o=this.$editor.session.getLine(t);for(var r=0,n=s.length-1;r<n;r++){var a=s[r]+1;var h=s[r+1];var l=this.$rightmostSelectionInCell(e,h);var c=o.substring(a,h);i[r]=Math.max(c.replace(/\s+$/g,"").length,l-a)}return i};t.prototype.$selectionColumnsForRow=function(t){var e=[],s=this.$editor.getCursorPosition();if(this.$editor.session.getSelection().isEmpty()){if(t==s.row)e.push(s.column)}return e};t.prototype.$setBlockCellWidthsToMax=function(t){var e=true,s,i,o;var r=this.$izip_longest(t);for(var n=0,a=r.length;n<a;n++){var h=r[n];if(!h.push){console.error(h);continue}h.push(NaN);for(var l=0,c=h.length;l<c;l++){var f=h[l];if(e){s=l;o=0;e=false}if(isNaN(f)){i=l;for(var u=s;u<i;u++){t[u][n]=o}e=true}o=Math.max(o,f)}}return t};t.prototype.$rightmostSelectionInCell=function(t,e){var s=0;if(t.length){var i=[];for(var o=0,r=t.length;o<r;o++){if(t[o]<=e)i.push(o);else i.push(0)}s=Math.max.apply(Math,i)}return s};t.prototype.$tabsForRow=function(t){var e=[],s=this.$editor.session.getLine(t),i=/\t/g,o;while((o=i.exec(s))!=null){e.push(o.index)}return e};t.prototype.$adjustRow=function(t,e){var s=this.$tabsForRow(t);if(s.length==0)return;var i=0,o=-1;var r=this.$izip(e,s);for(var n=0,a=r.length;n<a;n++){var h=r[n][0],l=r[n][1];o+=1+h;l+=i;var c=o-l;if(c==0)continue;var f=this.$editor.session.getLine(t).substr(0,l);var u=f.replace(/\s*$/g,"");var p=f.length-u.length;if(c>0){this.$editor.session.getDocument().insertInLine({row:t,column:l+1},Array(c+1).join(" ")+"\t");this.$editor.session.getDocument().removeInLine(t,l,l+1);i+=c}if(c<0&&p>=-c){this.$editor.session.getDocument().removeInLine(t,l+c,l);i+=c}}};t.prototype.$izip_longest=function(t){if(!t[0])return[];var e=t[0].length;var s=t.length;for(var i=1;i<s;i++){var o=t[i].length;if(o>e)e=o}var r=[];for(var n=0;n<e;n++){var a=[];for(var i=0;i<s;i++){if(t[i][n]==="")a.push(NaN);else a.push(t[i][n])}r.push(a)}return r};t.prototype.$izip=function(t,e){var s=t.length>=e.length?e.length:t.length;var i=[];for(var o=0;o<s;o++){var r=[t[o],e[o]];i.push(r)}return i};return t}();e.ElasticTabstopsLite=i;var o=t("../editor").Editor;t("../config").defineOptions(o.prototype,"editor",{useElasticTabstops:{set:function(t){if(t){if(!this.elasticTabstops)this.elasticTabstops=new i(this);this.commands.on("afterExec",this.elasticTabstops.onAfterExec);this.commands.on("exec",this.elasticTabstops.onExec);this.on("change",this.elasticTabstops.onChange)}else if(this.elasticTabstops){this.commands.removeListener("afterExec",this.elasticTabstops.onAfterExec);this.commands.removeListener("exec",this.elasticTabstops.onExec);this.removeListener("change",this.elasticTabstops.onChange)}}}})});(function(){ace.require(["ace/ext/elastic_tabstops_lite"],function(t){if(typeof module=="object"&&typeof exports=="object"&&module){module.exports=t}})})();
//# sourceMappingURL=ext-elastic_tabstops_lite.js.map