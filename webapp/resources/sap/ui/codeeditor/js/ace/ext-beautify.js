ace.define("ace/ext/beautify",["require","exports","module","ace/token_iterator"],function(e,t,a){"use strict";var r=e("../token_iterator").TokenIterator;function i(e,t){return e.type.lastIndexOf(t+".xml")>-1}t.singletonTags=["area","base","br","col","command","embed","hr","html","img","input","keygen","link","meta","param","source","track","wbr"];t.blockTags=["article","aside","blockquote","body","div","dl","fieldset","footer","form","head","header","html","nav","ol","p","script","section","style","table","tbody","tfoot","thead","ul"];t.formatOptions={lineBreaksAfterCommasInCurlyBlock:true};t.beautify=function(e){var a=new r(e,0,0);var s=a.getCurrentToken();var f=e.getTabString();var l=t.singletonTags;var o=t.blockTags;var n=t.formatOptions||{};var u;var c=false;var m=false;var p=false;var h="";var v="";var y="";var b=0;var d=0;var g=0;var k=0;var $=0;var w=0;var x=0;var T;var C=0;var R=0;var B=[];var O=false;var I;var q=false;var _=false;var j=false;var A=false;var F={0:0};var S=[];var K=false;var L=function(){if(u&&u.value&&u.type!=="string.regexp")u.value=u.value.replace(/^\s*/,"")};var V=function(){var e=h.length-1;while(true){if(e==0)break;if(h[e]!==" ")break;e=e-1}h=h.slice(0,e+1)};var z=function(){h=h.trimRight();c=false};while(s!==null){C=a.getCurrentTokenRow();B=a.$rowTokens;u=a.stepForward();if(typeof s!=="undefined"){v=s.value;$=0;j=y==="style"||e.$modeId==="ace/mode/css";if(i(s,"tag-open")){_=true;if(u)A=o.indexOf(u.value)!==-1;if(v==="</"){if(A&&!c&&R<1)R++;if(j)R=1;$=1;A=false}}else if(i(s,"tag-close")){_=false}else if(i(s,"comment.start")){A=true}else if(i(s,"comment.end")){A=false}if(!_&&!R&&s.type==="paren.rparen"&&s.value.substr(0,1)==="}"){R++}if(C!==T){R=C;if(T)R-=T}if(R){z();for(;R>0;R--)h+="\n";c=true;if(!i(s,"comment")&&!s.type.match(/^(comment|string)$/))v=v.trimLeft()}if(v){if(s.type==="keyword"&&v.match(/^(if|else|elseif|for|foreach|while|switch)$/)){S[b]=v;L();p=true;if(v.match(/^(else|elseif)$/)){if(h.match(/\}[\s]*$/)){z();m=true}}}else if(s.type==="paren.lparen"){L();if(v.substr(-1)==="{"){p=true;q=false;if(!_)R=1}if(v.substr(0,1)==="{"){m=true;if(h.substr(-1)!=="["&&h.trimRight().substr(-1)==="["){z();m=false}else if(h.trimRight().substr(-1)===")"){z()}else{V()}}}else if(s.type==="paren.rparen"){$=1;if(v.substr(0,1)==="}"){if(S[b-1]==="case")$++;if(h.trimRight().substr(-1)==="{"){z()}else{m=true;if(j)R+=2}}if(v.substr(0,1)==="]"){if(h.substr(-1)!=="}"&&h.trimRight().substr(-1)==="}"){m=false;k++;z()}}if(v.substr(0,1)===")"){if(h.substr(-1)!=="("&&h.trimRight().substr(-1)==="("){m=false;k++;z()}}V()}else if((s.type==="keyword.operator"||s.type==="keyword")&&v.match(/^(=|==|===|!=|!==|&&|\|\||and|or|xor|\+=|.=|>|>=|<|<=|=>)$/)){z();L();m=true;p=true}else if(s.type==="punctuation.operator"&&v===";"){z();L();p=true;if(j)R++}else if(s.type==="punctuation.operator"&&v.match(/^(:|,)$/)){z();L();if(v.match(/^(,)$/)&&x>0&&w===0&&n.lineBreaksAfterCommasInCurlyBlock){R++}else{p=true;c=false}}else if(s.type==="support.php_tag"&&v==="?>"&&!c){z();m=true}else if(i(s,"attribute-name")&&h.substr(-1).match(/^\s$/)){m=true}else if(i(s,"attribute-equals")){V();L()}else if(i(s,"tag-close")){V();if(v==="/>")m=true}else if(s.type==="keyword"&&v.match(/^(case|default)$/)){if(K)$=1}if(c&&!(s.type.match(/^(comment)$/)&&!v.substr(0,1).match(/^[/#]$/))&&!(s.type.match(/^(string)$/)&&!v.substr(0,1).match(/^['"@]$/))){k=g;if(b>d){k++;for(I=b;I>d;I--)F[I]=k}else if(b<d)k=F[b];d=b;g=k;if($)k-=$;if(q&&!w){k++;q=false}for(I=0;I<k;I++)h+=f}if(s.type==="keyword"&&v.match(/^(case|default)$/)){if(K===false){S[b]=v;b++;K=true}}else if(s.type==="keyword"&&v.match(/^(break)$/)){if(S[b-1]&&S[b-1].match(/^(case|default)$/)){b--;K=false}}if(s.type==="paren.lparen"){w+=(v.match(/\(/g)||[]).length;x+=(v.match(/\{/g)||[]).length;b+=v.length}if(s.type==="keyword"&&v.match(/^(if|else|elseif|for|while)$/)){q=true;w=0}else if(!w&&v.trim()&&s.type!=="comment")q=false;if(s.type==="paren.rparen"){w-=(v.match(/\)/g)||[]).length;x-=(v.match(/\}/g)||[]).length;for(I=0;I<v.length;I++){b--;if(v.substr(I,1)==="}"&&S[b]==="case"){b--}}}if(s.type=="text")v=v.replace(/\s+$/," ");if(m&&!c){V();if(h.substr(-1)!=="\n")h+=" "}h+=v;if(p)h+=" ";c=false;m=false;p=false;if(i(s,"tag-close")&&(A||o.indexOf(y)!==-1)||i(s,"doctype")&&v===">"){if(A&&u&&u.value==="</")R=-1;else R=1}if(u&&l.indexOf(u.value)===-1){if(i(s,"tag-open")&&v==="</"){b--}else if(i(s,"tag-open")&&v==="<"){b++}else if(i(s,"tag-close")&&v==="/>"){b--}}if(i(s,"tag-name")){y=v}T=C}}s=u}h=h.trim();e.doc.setValue(h)};t.commands=[{name:"beautify",description:"Format selection (Beautify)",exec:function(e){t.beautify(e.session)},bindKey:"Ctrl-Shift-B"}]});(function(){ace.require(["ace/ext/beautify"],function(e){if(typeof module=="object"&&typeof exports=="object"&&module){module.exports=e}})})();
//# sourceMappingURL=ext-beautify.js.map