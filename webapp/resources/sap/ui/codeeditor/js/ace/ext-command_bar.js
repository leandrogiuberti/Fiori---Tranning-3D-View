ace.define("ace/ext/command_bar",["require","exports","module","ace/tooltip","ace/lib/event_emitter","ace/lib/lang","ace/lib/dom","ace/lib/oop","ace/lib/useragent"],function(t,e,i){var o=this&&this.__values||function(t){var e=typeof Symbol==="function"&&Symbol.iterator,i=e&&t[e],o=0;if(i)return i.call(t);if(t&&typeof t.length==="number")return{next:function(){if(t&&o>=t.length)t=void 0;return{value:t&&t[o++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")};var n=t("../tooltip").Tooltip;var s=t("../lib/event_emitter").EventEmitter;var r=t("../lib/lang");var a=t("../lib/dom");var l=t("../lib/oop");var h=t("../lib/useragent");var d="command_bar_tooltip_button";var c="command_bar_button_value";var p="command_bar_button_caption";var u="command_bar_keybinding";var m="command_bar_tooltip";var f="MoreOptionsButton";var v=100;var g=4;var b=function(t,e){if(e.row>t.row){return t}else if(e.row===t.row&&e.column>t.column){return t}return e};var $={Ctrl:{mac:"^"},Option:{mac:"⌥"},Command:{mac:"⌘"},Cmd:{mac:"⌘"},Shift:"⇧",Left:"←",Right:"→",Up:"↑",Down:"↓"};var y=function(){function t(t,e){var i,s;e=e||{};this.parentNode=t;this.tooltip=new n(this.parentNode);this.moreOptions=new n(this.parentNode);this.maxElementsOnTooltip=e.maxElementsOnTooltip||g;this.$alwaysShow=e.alwaysShow||false;this.eventListeners={};this.elements={};this.commands={};this.tooltipEl=a.buildDom(["div",{class:m}],this.tooltip.getElement());this.moreOptionsEl=a.buildDom(["div",{class:m+" tooltip_more_options"}],this.moreOptions.getElement());this.$showTooltipTimer=r.delayedCall(this.$showTooltip.bind(this),e.showDelay||v);this.$hideTooltipTimer=r.delayedCall(this.$hideTooltip.bind(this),e.hideDelay||v);this.$tooltipEnter=this.$tooltipEnter.bind(this);this.$onMouseMove=this.$onMouseMove.bind(this);this.$onChangeScroll=this.$onChangeScroll.bind(this);this.$onEditorChangeSession=this.$onEditorChangeSession.bind(this);this.$scheduleTooltipForHide=this.$scheduleTooltipForHide.bind(this);this.$preventMouseEvent=this.$preventMouseEvent.bind(this);try{for(var l=o(["mousedown","mouseup","click"]),h=l.next();!h.done;h=l.next()){var d=h.value;this.tooltip.getElement().addEventListener(d,this.$preventMouseEvent);this.moreOptions.getElement().addEventListener(d,this.$preventMouseEvent)}}catch(t){i={error:t}}finally{try{if(h&&!h.done&&(s=l.return))s.call(l)}finally{if(i)throw i.error}}}t.prototype.registerCommand=function(t,e){var i=Object.keys(this.commands).length<this.maxElementsOnTooltip;if(!i&&!this.elements[f]){this.$createCommand(f,{name:"···",exec:function(){this.$shouldHideMoreOptions=false;this.$setMoreOptionsVisibility(!this.isMoreOptionsShown())}.bind(this),type:"checkbox",getValue:function(){return this.isMoreOptionsShown()}.bind(this),enabled:true},true)}this.$createCommand(t,e,i);if(this.isShown()){this.updatePosition()}};t.prototype.isShown=function(){return!!this.tooltip&&this.tooltip.isOpen};t.prototype.isMoreOptionsShown=function(){return!!this.moreOptions&&this.moreOptions.isOpen};t.prototype.getAlwaysShow=function(){return this.$alwaysShow};t.prototype.setAlwaysShow=function(t){this.$alwaysShow=t;this.$updateOnHoverHandlers(!this.$alwaysShow);this._signal("alwaysShow",this.$alwaysShow)};t.prototype.attach=function(t){if(!t||this.isShown()&&this.editor===t){return}this.detach();this.editor=t;this.editor.on("changeSession",this.$onEditorChangeSession);if(this.editor.session){this.editor.session.on("changeScrollLeft",this.$onChangeScroll);this.editor.session.on("changeScrollTop",this.$onChangeScroll)}if(this.getAlwaysShow()){this.$showTooltip()}else{this.$updateOnHoverHandlers(true)}};t.prototype.updatePosition=function(){if(!this.editor){return}var t=this.editor.renderer;var e;if(this.editor.selection.getAllRanges){e=this.editor.selection.getAllRanges()}else{e=[this.editor.getSelectionRange()]}if(!e.length){return}var i=b(e[0].start,e[0].end);for(var o=0,n;n=e[o];o++){i=b(i,b(n.start,n.end))}var s=t.$cursorLayer.getPixelPosition(i,true);var r=this.tooltip.getElement();var a=window.innerWidth;var l=window.innerHeight;var h=this.editor.container.getBoundingClientRect();s.top+=h.top-t.layerConfig.offset;s.left+=h.left+t.gutterWidth-t.scrollLeft;var d=s.top>=h.top&&s.top<=h.bottom&&s.left>=h.left+t.gutterWidth&&s.left<=h.right;if(!d&&this.isShown()){this.$hideTooltip();return}else if(d&&!this.isShown()&&this.getAlwaysShow()){this.$showTooltip();return}var c=s.top-r.offsetHeight;var p=Math.min(a-r.offsetWidth,s.left);var u=c>=0&&c+r.offsetHeight<=l&&p>=0&&p+r.offsetWidth<=a;if(!u){this.$hideTooltip();return}this.tooltip.setPosition(p,c);if(this.isMoreOptionsShown()){c=c+r.offsetHeight;p=this.elements[f].getBoundingClientRect().left;var m=this.moreOptions.getElement();var l=window.innerHeight;if(c+m.offsetHeight>l){c-=r.offsetHeight+m.offsetHeight}if(p+m.offsetWidth>a){p=a-m.offsetWidth}this.moreOptions.setPosition(p,c)}};t.prototype.update=function(){Object.keys(this.elements).forEach(this.$updateElement.bind(this))};t.prototype.detach=function(){this.tooltip.hide();this.moreOptions.hide();this.$updateOnHoverHandlers(false);if(this.editor){this.editor.off("changeSession",this.$onEditorChangeSession);if(this.editor.session){this.editor.session.off("changeScrollLeft",this.$onChangeScroll);this.editor.session.off("changeScrollTop",this.$onChangeScroll)}}this.$mouseInTooltip=false;this.editor=null};t.prototype.destroy=function(){if(this.tooltip&&this.moreOptions){this.detach();this.tooltip.destroy();this.moreOptions.destroy()}this.eventListeners={};this.commands={};this.elements={};this.tooltip=this.moreOptions=this.parentNode=null};t.prototype.$createCommand=function(t,e,i){var o=i?this.tooltipEl:this.moreOptionsEl;var n=[];var s=e.bindKey;if(s){if(typeof s==="object"){s=h.isMac?s.mac:s.win}s=s.split("|")[0];n=s.split("-");n=n.map(function(t){if($[t]){if(typeof $[t]==="string"){return $[t]}else if(h.isMac&&$[t].mac){return $[t].mac}}return t})}var r;if(i&&e.iconCssClass){r=["div",{class:["ace_icon_svg",e.iconCssClass].join(" "),"aria-label":e.name+" ("+e.bindKey+")"}]}else{r=[["div",{class:c}],["div",{class:p},e.name]];if(n.length){r.push(["div",{class:u},n.map(function(t){return["div",t]})])}}a.buildDom(["div",{class:[d,e.cssClass||""].join(" "),ref:t},r],o,this.elements);this.commands[t]=e;var l=function(i){if(this.editor){this.editor.focus()}this.$shouldHideMoreOptions=this.isMoreOptionsShown();if(!this.elements[t].disabled&&e.exec){e.exec(this.editor)}if(this.$shouldHideMoreOptions){this.$setMoreOptionsVisibility(false)}this.update();i.preventDefault()}.bind(this);this.eventListeners[t]=l;this.elements[t].addEventListener("click",l.bind(this));this.$updateElement(t)};t.prototype.$setMoreOptionsVisibility=function(t){if(t){this.moreOptions.setTheme(this.editor.renderer.theme);this.moreOptions.setClassName(m+"_wrapper");this.moreOptions.show();this.update();this.updatePosition()}else{this.moreOptions.hide()}};t.prototype.$onEditorChangeSession=function(t){if(t.oldSession){t.oldSession.off("changeScrollTop",this.$onChangeScroll);t.oldSession.off("changeScrollLeft",this.$onChangeScroll)}this.detach()};t.prototype.$onChangeScroll=function(){if(this.editor.renderer&&(this.isShown()||this.getAlwaysShow())){this.editor.renderer.once("afterRender",this.updatePosition.bind(this))}};t.prototype.$onMouseMove=function(t){if(this.$mouseInTooltip){return}var e=this.editor.getCursorPosition();var i=this.editor.renderer.textToScreenCoordinates(e.row,e.column);var o=this.editor.renderer.lineHeight;var n=t.clientY>=i.pageY&&t.clientY<i.pageY+o;if(n){if(!this.isShown()&&!this.$showTooltipTimer.isPending()){this.$showTooltipTimer.delay()}if(this.$hideTooltipTimer.isPending()){this.$hideTooltipTimer.cancel()}}else{if(this.isShown()&&!this.$hideTooltipTimer.isPending()){this.$hideTooltipTimer.delay()}if(this.$showTooltipTimer.isPending()){this.$showTooltipTimer.cancel()}}};t.prototype.$preventMouseEvent=function(t){if(this.editor){this.editor.focus()}t.preventDefault()};t.prototype.$scheduleTooltipForHide=function(){this.$mouseInTooltip=false;this.$showTooltipTimer.cancel();this.$hideTooltipTimer.delay()};t.prototype.$tooltipEnter=function(){this.$mouseInTooltip=true;if(this.$showTooltipTimer.isPending()){this.$showTooltipTimer.cancel()}if(this.$hideTooltipTimer.isPending()){this.$hideTooltipTimer.cancel()}};t.prototype.$updateOnHoverHandlers=function(t){var e=this.tooltip.getElement();var i=this.moreOptions.getElement();if(t){if(this.editor){this.editor.on("mousemove",this.$onMouseMove);this.editor.renderer.getMouseEventTarget().addEventListener("mouseout",this.$scheduleTooltipForHide,true)}e.addEventListener("mouseenter",this.$tooltipEnter);e.addEventListener("mouseleave",this.$scheduleTooltipForHide);i.addEventListener("mouseenter",this.$tooltipEnter);i.addEventListener("mouseleave",this.$scheduleTooltipForHide)}else{if(this.editor){this.editor.off("mousemove",this.$onMouseMove);this.editor.renderer.getMouseEventTarget().removeEventListener("mouseout",this.$scheduleTooltipForHide,true)}e.removeEventListener("mouseenter",this.$tooltipEnter);e.removeEventListener("mouseleave",this.$scheduleTooltipForHide);i.removeEventListener("mouseenter",this.$tooltipEnter);i.removeEventListener("mouseleave",this.$scheduleTooltipForHide)}};t.prototype.$showTooltip=function(){if(this.isShown()){return}this.tooltip.setTheme(this.editor.renderer.theme);this.tooltip.setClassName(m+"_wrapper");this.tooltip.show();this.update();this.updatePosition();this._signal("show")};t.prototype.$hideTooltip=function(){this.$mouseInTooltip=false;if(!this.isShown()){return}this.moreOptions.hide();this.tooltip.hide();this._signal("hide")};t.prototype.$updateElement=function(t){var e=this.commands[t];if(!e){return}var i=this.elements[t];var o=e.enabled;if(typeof o==="function"){o=o(this.editor)}if(typeof e.getValue==="function"){var n=e.getValue(this.editor);if(e.type==="text"){i.textContent=n}else if(e.type==="checkbox"){var s=n?a.addCssClass:a.removeCssClass;var r=i.parentElement===this.tooltipEl;i.ariaChecked=n;if(r){s(i,"ace_selected")}else{i=i.querySelector("."+c);s(i,"ace_checkmark")}}}if(o&&i.disabled){a.removeCssClass(i,"ace_disabled");i.ariaDisabled=i.disabled=false;i.removeAttribute("disabled")}else if(!o&&!i.disabled){a.addCssClass(i,"ace_disabled");i.ariaDisabled=i.disabled=true;i.setAttribute("disabled","")}};return t}();l.implement(y.prototype,s);a.importCssString("\n.ace_tooltip.".concat(m,"_wrapper {\n    padding: 0;\n}\n\n.ace_tooltip .").concat(m," {\n    padding: 1px 5px;\n    display: flex;\n    pointer-events: auto;\n}\n\n.ace_tooltip .").concat(m,".tooltip_more_options {\n    padding: 1px;\n    flex-direction: column;\n}\n\ndiv.").concat(d," {\n    display: inline-flex;\n    cursor: pointer;\n    margin: 1px;\n    border-radius: 2px;\n    padding: 2px 5px;\n    align-items: center;\n}\n\ndiv.").concat(d,".ace_selected,\ndiv.").concat(d,":hover:not(.ace_disabled) {\n    background-color: rgba(0, 0, 0, 0.1);\n}\n\ndiv.").concat(d,".ace_disabled {\n    color: #777;\n    pointer-events: none;\n}\n\ndiv.").concat(d," .ace_icon_svg {\n    height: 12px;\n    background-color: #000;\n}\n\ndiv.").concat(d,".ace_disabled .ace_icon_svg {\n    background-color: #777;\n}\n\n.").concat(m,".tooltip_more_options .").concat(d," {\n    display: flex;\n}\n\n.").concat(m,".").concat(c," {\n    display: none;\n}\n\n.").concat(m,".tooltip_more_options .").concat(c," {\n    display: inline-block;\n    width: 12px;\n}\n\n.").concat(p," {\n    display: inline-block;\n}\n\n.").concat(u," {\n    margin: 0 2px;\n    display: inline-block;\n    font-size: 8px;\n}\n\n.").concat(m,".tooltip_more_options .").concat(u," {\n    margin-left: auto;\n}\n\n.").concat(u," div {\n    display: inline-block;\n    min-width: 8px;\n    padding: 2px;\n    margin: 0 1px;\n    border-radius: 2px;\n    background-color: #ccc;\n    text-align: center;\n}\n\n.ace_dark.ace_tooltip .").concat(m," {\n    background-color: #373737;\n    color: #eee;\n}\n\n.ace_dark div.").concat(d,".ace_disabled {\n    color: #979797;\n}\n\n.ace_dark div.").concat(d,".ace_selected,\n.ace_dark div.").concat(d,":hover:not(.ace_disabled) {\n    background-color: rgba(255, 255, 255, 0.1);\n}\n\n.ace_dark div.").concat(d," .ace_icon_svg {\n    background-color: #eee;\n}\n\n.ace_dark div.").concat(d,".ace_disabled .ace_icon_svg {\n    background-color: #979797;\n}\n\n.ace_dark .").concat(d,".ace_disabled {\n    color: #979797;\n}\n\n.ace_dark .").concat(u," div {\n    background-color: #575757;\n}\n\n.ace_checkmark::before {\n    content: '✓';\n}\n"),"commandbar.css",false);e.CommandBarTooltip=y;e.TOOLTIP_CLASS_NAME=m;e.BUTTON_CLASS_NAME=d});(function(){ace.require(["ace/ext/command_bar"],function(t){if(typeof module=="object"&&typeof exports=="object"&&module){module.exports=t}})})();
//# sourceMappingURL=ext-command_bar.js.map