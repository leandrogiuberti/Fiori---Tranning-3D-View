/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
sap.ui.define(["sap/ui/unified/Menu","sap/ui/unified/MenuItem","sap/ui/vbm/vector/PayloadGenerator","./sapvbi"],function(e,n,t){"use strict";VBI.Menus=function(){var a={};a.m_menus=[];a.clear=function(){for(var e=a.m_menus.length-1;e>=0;--e){a.m_menus[e].destroy();a.m_menus.pop()}a.m_menus=[]};a.loadMainMenu=function(n,t){var i=new e;a.loadMenu(i,n,t,i.getId());i.vbi_data={};i.vbi_data.menuRef=n.id;i.vbi_data.VBIName=n.name;if(VBI.vectorFlag==true){i.vbi_data.object=t.object;i.vbi_data.instance=t.instance}i.attachItemSelect(function(e){var n={};n.refid=e.mParameters.item.vbi_data.refid;n.menu=i;a.OnSelected(n)});a.m_menus.push(i);return i};a.loadMenu=function(t,i,u,r){var m=jQuery.type(i.MenuItem)=="object";var d=m?1:i.MenuItem.length;for(var f=0;f<d;++f){var c=m?i.MenuItem:i.MenuItem[f];if(c.active=="false"){continue}var o;o=r+"_"+f;var _=c.Separator==undefined?c.text:"---------------------------";var s=new n("vbimi_"+o,{text:_});s.vbi_data={};if(c.disabled=="true"||c.Separator!=undefined){s.setEnabled(false)}t.addItem(s);if(c.icon){s.setIcon(c.icon)}if(VBI.m_bTrace){VBI.Trace("Adding Menuitem: menuitem_"+o+" with text "+_)}if(c.MenuItem!=undefined){var v=new e("vbim_"+o);s.setSubmenu(v);a.loadMenu(v,c,u,o)}else if(c.id!=""){s.vbi_data.refid=c.id}}};a.deleteMenu=function(e){var n=a.findMenuIdxByName(e);if(n>=0){var t=a.m_menus.length-1;a.m_menus[n].destroy();if(n!=t){a.m_menus[n]=a.m_menus[t]}a.m_menus.pop();return n}return-1};a.getMainScene=function(e){if(e.m_SceneManager.m_SceneArray.length==1){return e.m_SceneManager.m_SceneArray[0].m_ID}return undefined};a.load=function(e,n){sap.ui.require(["sap/ui/core/Lib"],function(e){e.load({name:"sap.ui.unified"})});a.m_context=n;if(e.Set){if(e.Set.name!=undefined){a.deleteMenu(e.Set.name)}else{a.clear()}if(jQuery.type(e.Set)=="object"){if(e.Set.Menu){a.loadMainMenu(e.Set.Menu,n)}}else if(jQuery.type(e.Set)=="array"){for(var t=0;t<e.Set.length;++t){if(e.Set[t].Menu){a.loadMainMenu(e.Set[t].Menu,n)}}}}};a.findMenuByID=function(e){if(a.m_menus){for(var n=0;n<a.m_menus.length;++n){if(a.m_menus[n].vbi_data.menuRef==e){return a.m_menus[n]}}}return null};a.findMenuIdxByName=function(e){if(a.m_menus){for(var n=0;n<a.m_menus.length;++n){if(a.m_menus[n].vbi_data.VBIName==e){return n}}}return-1};a.OnSelected=function(e){var n=e.menu.vbi_data.object;if(VBI.vectorFlag==true){if(_adapter._actions){var i="FCODE_SELECT";var u=e.refid;t.fcodeSelect(i,u,n,e.menu.vbi_data.instance)}}else{if(e.refid==undefined){return}var r=a.m_context.m_SceneManager.GetSceneByName(e.menu.vbi_data.scene);var m=a.m_context.m_Actions;if(m){if(m.findAction("ContextMenu",r,n)){var d=new VBI.Actions.Action;d.m_name="FCODE_SELECT";d.m_id=e.refid;r.m_Ctx.FireAction(d,r,n,null,null,e.menu.vbi_data.instance)}}}};return a}});
//# sourceMappingURL=sapvbmenu.js.map