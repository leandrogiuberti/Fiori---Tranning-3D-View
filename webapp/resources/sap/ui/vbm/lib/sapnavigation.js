/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
sap.ui.define(["./sapvbi","sap/ui/core/Lib","./saputilities"],function(e,o){"use strict";VBI.NavigationControl=function(e){var i={};i.scene=null;i.suppressedVisibility=e;i.m_MinLOD=null;i.m_MaxLOD=null;i.m_lengthScrollLine=94-18;i.m_startScrollPoint=null;i.m_ID=null;i.zoomtimerfrq=40;i.zoomtimer=0;i.movetimer=0;i.bInitDrag=false;i.offsetX=0;i.offsetY=0;i.curMoveX=0;i.curMoveY=0;i.curZoomY=0;i.tint=20;i.midpointForZoom=[0,0];i.timer_mapnav=null;i.m_Div=i.m_Divmapnav=i.m_Divmapscrollarea=i.m_Divmapscrollpoint=i.m_Divmapcursorgrip=i.m_Divmapcursor=i.m_Divmapcursorreset=i.m_Divmapcursorleft=i.m_Divmapcursortop=i.m_Divmapcursorright=i.m_Divmapcursordown=i.m_DivmapmobileHome=i.m_DivmapmobileHomeIcon=i.m_DivmapmobileZoomin=i.m_DivmapmobileZoominIcon=i.m_DivmapmobileZoomout=i.m_DivmapmobileZoomoutIcon=null;i.clear=function(){if(i.timer_mapnav){window.clearInterval(i.timer_mapnav)}i.DetachEvents();i.scene=null;i.m_Div=i.m_Divmapnav=i.m_Divmapscrollarea=i.m_Divmapscrollpoint=i.m_Divmapcursorgrip=i.m_Divmapcursor=i.m_Divmapcursorreset=i.m_Divmapcursorleft=i.m_Divmapcursortop=i.m_Divmapcursorright=i.m_Divmapcursordown=i.m_DivmapmobileHome=i.m_DivmapmobileHomeIcon=i.m_DivmapmobileZoomin=i.m_DivmapmobileZoominIcon=i.m_DivmapmobileZoomout=i.m_DivmapmobileZoomoutIcon=null};i.getId=function(e,o){return o+"-"+e};i.DetachEvents=function(){if(VBI.m_bIsMobile){jQuery(i.m_DivmapmobileHome).off();jQuery(i.m_DivmapmobileZoomin).off();jQuery(i.m_DivmapmobileZoomout).off()}else{jQuery(i.m_Divmapnav).off();jQuery(i.m_Divmapscrollpoint).off();jQuery(i.m_Divmapcursorgrip).off();jQuery(i.m_Divmapcursorleft).off();jQuery(i.m_Divmapcursorright).off();jQuery(i.m_Divmapcursortop).off();jQuery(i.m_Divmapcursordown).off();jQuery(i.m_Divmapcursorreset).off();document.removeEventListener("mouseup",i.zoom_processmouseup,true);document.removeEventListener("mousemove",i.zoom_processmousemove,true)}};i.AttachEvents=function(){if(VBI.m_bIsMobile){i.AttachTouchEvents()}else{i.AttachMouseEvents()}};i.AttachTouchEvents=function(){jQuery(i.m_DivmapmobileHome).on("click",function(){if(VBI.m_bTrace){VBI.Trace("Home Button : click")}i.scene.GoToInitialStart()});jQuery(i.m_DivmapmobileHome).on("touchstart",function(){if(VBI.m_bTrace){VBI.Trace("Home Button : touchstart")}i.scene.GoToInitialStart()});jQuery(i.m_DivmapmobileHome).on("touchend",function(e){if(VBI.m_bTrace){VBI.Trace("Home Button : touchend")}e.preventDefault()});jQuery(i.m_DivmapmobileZoomin).on("touchstart",function(){if(VBI.m_bTrace){VBI.Trace("ZoomIn Button : touchstart")}i.StartAnimatedZoom(1)});jQuery(i.m_DivmapmobileZoomin).on("touchend",function(e){if(VBI.m_bTrace){VBI.Trace("ZoomIn Button : touchend")}if(i.zoomtimer){window.clearInterval(i.zoomtimer);i.ZoomToNextIntegerLOD(true)}e.preventDefault()});jQuery(i.m_DivmapmobileZoomin).on("touchleave",function(){if(VBI.m_bTrace){VBI.Trace("ZoomIn Button : touchleave")}if(i.zoomtimer){window.clearInterval(i.zoomtimer);i.ZoomToNextIntegerLOD(true)}});jQuery(i.m_DivmapmobileZoomout).on("touchstart",function(){if(VBI.m_bTrace){VBI.Trace("ZoomOut Button : touchstart")}i.StartAnimatedZoom(-1)});jQuery(i.m_DivmapmobileZoomout).on("touchend",function(e){if(VBI.m_bTrace){VBI.Trace("ZoomOut Button : touchend")}if(i.zoomtimer){window.clearInterval(i.zoomtimer);i.ZoomToNextIntegerLOD(false)}e.preventDefault()});jQuery(i.m_DivmapmobileZoomout).on("touchleave",function(){if(VBI.m_bTrace){VBI.Trace("ZoomOut Button : touchleave")}if(i.zoomtimer){window.clearInterval(i.zoomtimer);i.ZoomToNextIntegerLOD(false)}})};i.AttachMouseEvents=function(){var e=1;var o=50;i.timer_mapnav=null;var t=null;if(i.suppressedVisibility.fade){i.m_Divmapnav.style.opacity=1}jQuery(i.m_Divmapnav).on("mouseenter",function(e){t=e.fromElement});jQuery(i.m_Divmapnav).on("mouseup",function(){if(t){t.focus({preventScroll:true})}});jQuery(i.m_Divmapnav).on("mouseleave",function(){if(!i.suppressedVisibility.fade){e=1;i.timer_mapnav=window.setInterval(function(){if(!i.m_Divmapnav||e<=.5){window.clearInterval(i.timer_mapnav)}else{e-=.01;i.m_Divmapnav.style.opacity=e}},o)}});jQuery(i.m_Divmapnav).on("mouseenter",function(){window.clearInterval(i.timer_mapnav);i.m_Divmapnav.style.opacity=1});if(!i.suppressedVisibility.zoom){if(i.suppressedVisibility.move){jQuery(i.m_Divmapscrollarea).css("top",10+"px")}jQuery(i.m_Divmapscrollpoint).on("mousedown",function(e){if(e.which==1){i.midpointForZoom=i.scene.GetCenterPos();i.curZoomY=jQuery(i.m_Divmapscrollpoint).position().top;i.offsetY=e.pageY-i.curZoomY;document.addEventListener("mouseup",i.zoom_processmouseup,true);document.addEventListener("mousemove",i.zoom_processmousemove,true)}});jQuery(i.m_Divmapscrollpoint).on("dragstart",function(e){e.preventDefault()})}if(!i.suppressedVisibility.move){jQuery(i.m_Divmapcursorgrip).on("mouseenter",function(){jQuery(i.m_Divmapcursor).css("background-position","-5px 228px")}).on("mouseleave",function(){jQuery(i.m_Divmapcursor).css("background-position","-5px 305px")});var r=10;jQuery(i.m_Divmapcursorleft).on("mousedown",function(e){if(e.which==1){jQuery(this).css("background-position","-134px 194px");window.clearInterval(i.movetimer);i.movetimer=window.setInterval(function(){i.scene.MoveMap(r,0)},i.tint)}}).on("mouseup",function(e){window.clearInterval(i.movetimer);jQuery(this).css("background-position","-134px 211px")}).on("mouseout",function(e){if(i.bInitDrag==false){window.clearInterval(i.movetimer);jQuery(this).css("background-position","-134px 228px")}}).on("mousemove",function(e){if(i.bInitDrag==true){jQuery(this).css("background-position","-134px 177px")}});jQuery(i.m_Divmapcursorright).on("mousedown",function(e){if(e.which==1){jQuery(this).css("background-position","-116px 194px");window.clearInterval(i.movetimer);i.movetimer=window.setInterval(function(){i.scene.MoveMap(-r,0)},i.tint)}}).on("mouseup",function(e){window.clearInterval(i.movetimer);jQuery(this).css("background-position","-116px 211px")}).on("mouseout",function(e){if(i.bInitDrag==false){window.clearInterval(i.movetimer);jQuery(this).css("background-position","-116px 228px")}}).on("mousemove",function(e){if(i.bInitDrag==true){jQuery(this).css("background-position","-116px 177px")}});jQuery(i.m_Divmapcursortop).on("mousedown",function(e){if(e.which==1){jQuery(this).css("background-position","-82px 192px");window.clearInterval(i.movetimer);i.movetimer=window.setInterval(function(){i.scene.MoveMap(0,r)},i.tint)}}).on("mouseup",function(e){window.clearInterval(i.movetimer);jQuery(this).css("background-position","-82px 210px")}).on("mouseout",function(e){if(i.bInitDrag==false){window.clearInterval(i.movetimer);jQuery(this).css("background-position","-82px 228px")}}).on("mousemove",function(e){if(i.bInitDrag==true){jQuery(this).css("background-position","-82px 174px")}});jQuery(i.m_Divmapcursordown).on("mousedown",function(e){if(e.which==1){jQuery(this).css("background-position","-99px 192px");window.clearInterval(i.movetimer);i.movetimer=window.setInterval(function(){i.scene.MoveMap(0,-r)},i.tint)}}).on("mouseup",function(e){window.clearInterval(i.movetimer);jQuery(this).css("background-position","-99px 210px")}).on("mouseout",function(e){if(i.bInitDrag==false){window.clearInterval(i.movetimer);jQuery(this).css("background-position","-99px 228px")}}).on("mousemove",function(e){if(i.bInitDrag==true){jQuery(this).css("background-position","-99px 174px")}});jQuery(i.m_Divmapcursorreset).on("dragstart",function(e){e.preventDefault()});jQuery(i.m_Divmapcursorreset).on("mousedown",function(e){if(e.which==1){i.curMoveX=jQuery(i.m_Divmapcursorreset).position().left;i.curMoveY=jQuery(i.m_Divmapcursorreset).position().top;jQuery(i.m_Divmapcursorleft).css("background-position","-134px 177px");jQuery(i.m_Divmapcursorright).css("background-position","-116px 177px");jQuery(i.m_Divmapcursordown).css("background-position","-99px 174px");jQuery(i.m_Divmapcursortop).css("background-position","-82px 174px");jQuery(this).css("background-position","-222px 263px");i.offsetX=e.pageX-i.curMoveX;i.offsetY=e.pageY-i.curMoveY;window.clearInterval(i.movetimer);i.movetimer=0;i.bInitDrag=true;document.addEventListener("mouseup",i.processmouseup,true);document.addEventListener("mousemove",i.processmousemove,true)}});jQuery(i.m_Divmapcursorreset).css("position","");jQuery(i.m_Divmapcursorreset).on("dblclick",function(){i.scene.GoToInitialStart()})}};i.AppendButton=function(){i.m_Divmapnav=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-nav",i.m_ID),"vbi-nav");i.m_Divmapnav.setAttribute("role",sap.ui.core.AccessibleRole.Navigation);i.m_Divmapnav.setAttribute("tabindex","-1");i.m_Divmapnav.m_VBIType="N";i.m_DivmapmobileHome=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-navmobile-home",i.m_ID),"vbi-navmobile-home");i.m_DivmapmobileHome.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_DivmapmobileHome.setAttribute("tabindex","-1");i.m_DivmapmobileHome.innerHTML="";i.m_Divmapnav.appendChild(i.m_DivmapmobileHome);if(!i.suppressedVisibility.zoom){i.m_DivmapmobileZoomin=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-navmobile-zoomin",i.m_ID),"vbi-navmobile-zoomin");i.m_DivmapmobileZoomin.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_DivmapmobileZoomin.setAttribute("tabindex","-1");i.m_DivmapmobileZoomin.innerHTML="+";i.m_Divmapnav.appendChild(i.m_DivmapmobileZoomin);i.m_DivmapmobileZoomout=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-navmobile-zoomout",i.m_ID),"vbi-navmobile-zoomout");i.m_DivmapmobileZoomout.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_DivmapmobileZoomout.setAttribute("tabindex","-1");i.m_DivmapmobileZoomout.innerHTML="-";i.m_Divmapnav.appendChild(i.m_DivmapmobileZoomout)}i.scene.m_Div.appendChild(i.m_Divmapnav)};i.AppendDiv=function(){var e=o.getResourceBundleFor("sap.ui.vbm");var t=e.getText("NAVCTL_TITLE_ZOOM",[0]);t=t.substr(0,t.search(/[0-9]/));i.m_Divmapnav=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-nav",i.m_ID),"vbi-nav");i.m_Divmapnav.setAttribute("role",sap.ui.core.AccessibleRole.Navigation);i.m_Divmapnav.setAttribute("tabindex","-1");i.m_Divmapnav.m_VBIType="N";i.m_Divmapcursor=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-cursor",i.m_ID),"vbi-cursor");i.m_Divmapcursor.setAttribute("role",sap.ui.core.AccessibleRole.Presentation);i.m_Divmapcursor.setAttribute("tabindex","-1");i.m_Divmapscrollarea=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-scrollarea",i.m_ID),"vbi-scrollarea");i.m_Divmapscrollarea.setAttribute("role",sap.ui.core.AccessibleRole.Slider);i.m_Divmapscrollarea.setAttribute("tabindex","0");i.m_Divmapcursorgrip=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-cursor-grip",i.m_ID),"vbi-cursor-grip");i.m_Divmapcursorgrip.setAttribute("role",sap.ui.core.AccessibleRole.Img);i.m_Divmapcursorgrip.setAttribute("tabindex","-1");var r=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-cursor-middle",i.m_ID),"vbi-cursor-middle");r.setAttribute("role",sap.ui.core.AccessibleRole.Img);r.setAttribute("tabindex","0");var m=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-scrolllineupperending",i.m_ID),"vbi-scrolllineupperending");m.setAttribute("role",sap.ui.core.AccessibleRole.Img);m.setAttribute("tabindex","-1");var n=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-scrollline",i.m_ID),"vbi-scrollline");n.setAttribute("role",sap.ui.core.AccessibleRole.Img);n.setAttribute("tabindex","-1");var s=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-scrolllinelowerending",i.m_ID),"vbi-scrolllinelowerending");s.setAttribute("role",sap.ui.core.AccessibleRole.Img);s.setAttribute("tabindex","-1");i.m_Divmapscrollpoint=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-scrollpoint",i.m_ID),"vbi-scrollpoint",t);i.m_Divmapscrollpoint.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_Divmapscrollpoint.setAttribute("aria-label",t);i.m_Divmapscrollpoint.setAttribute("tabindex","0");i.m_Divmapcursorleft=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-cursor-left",i.m_ID),"vbi-cursor-left",e.getText("NAVCTL_TITLE_MOVE_LEFT"));i.m_Divmapcursorleft.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_Divmapcursorleft.setAttribute("aria-label",e.getText("NAVCTL_TITLE_MOVE_LEFT"));i.m_Divmapcursorleft.setAttribute("tabindex","2");i.m_Divmapcursorright=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-cursor-right",i.m_ID),"vbi-cursor-right",e.getText("NAVCTL_TITLE_MOVE_RIGHT"));i.m_Divmapcursorright.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_Divmapcursorright.setAttribute("aria-label",e.getText("NAVCTL_TITLE_MOVE_RIGHT"));i.m_Divmapcursorright.setAttribute("tabindex","4");i.m_Divmapcursortop=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-cursor-top",i.m_ID),"vbi-cursor-top",e.getText("NAVCTL_TITLE_MOVE_UP"));i.m_Divmapcursortop.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_Divmapcursortop.setAttribute("aria-label",e.getText("NAVCTL_TITLE_MOVE_UP"));i.m_Divmapcursortop.setAttribute("tabindex","1");i.m_Divmapcursordown=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-cursor-down",i.m_ID),"vbi-cursor-down",e.getText("NAVCTL_TITLE_MOVE_DOWN"));i.m_Divmapcursordown.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_Divmapcursordown.setAttribute("aria-label",e.getText("NAVCTL_TITLE_MOVE_DOWN"));i.m_Divmapcursordown.setAttribute("tabindex","5");i.m_Divmapcursorreset=VBI.Utilities.CreateGeoSceneDivCSS(i.getId("vbi-cursor-reset",i.m_ID),"vbi-cursor-reset",e.getText("NAVCTL_TITLE_MOVE"));i.m_Divmapcursorreset.setAttribute("role",sap.ui.core.AccessibleRole.Button);i.m_Divmapcursorreset.setAttribute("aria-label",e.getText("NAVCTL_TITLE_MOVE"));i.m_Divmapcursorreset.setAttribute("tabindex","3");r.appendChild(i.m_Divmapcursorleft);r.appendChild(i.m_Divmapcursorright);r.appendChild(i.m_Divmapcursortop);r.appendChild(i.m_Divmapcursordown);r.appendChild(i.m_Divmapcursorreset);i.m_Divmapcursorgrip.appendChild(r);i.m_Divmapscrollarea.appendChild(m);i.m_Divmapscrollarea.appendChild(n);i.m_Divmapscrollarea.appendChild(s);i.m_Divmapscrollarea.appendChild(i.m_Divmapscrollpoint);if(!i.suppressedVisibility.zoom){i.m_Divmapnav.appendChild(i.m_Divmapscrollarea)}if(!i.suppressedVisibility.move){i.m_Divmapnav.appendChild(i.m_Divmapcursor);i.m_Divmapnav.appendChild(i.m_Divmapcursorgrip)}i.scene.m_Div.appendChild(i.m_Divmapnav)};i.AdaptMinMaxLOD=function(e){i.m_MinLOD=i.scene.GetMinLOD();i.m_MaxLOD=i.scene.GetMaxLOD()};i.Awake=function(e,o){i.scene=e;i.m_MinLOD=i.scene.GetMinLOD();i.m_MaxLOD=i.scene.GetMaxLOD();var t=jQuery.sap.byId(o);i.m_ID=jQuery(t).attr("id");if(VBI.m_bIsMobile){i.AppendButton()}else{i.AppendDiv();i.m_Divmapnav.style.opacity=.5;i.m_startScrollPoint=0}i.AttachEvents()};i.AdjustScrollPoint=function(e){if(VBI.m_bIsMobile){return}var o;if(e){o=i.m_lengthScrollLine*(e-i.m_MinLOD)/(i.m_MaxLOD-i.m_MinLOD)+i.m_startScrollPoint;jQuery(i.m_Divmapscrollpoint).css("top",o+"px")}else{var t=i.scene.GetCurrentZoomlevel();o=i.m_lengthScrollLine*(t-i.m_MinLOD)/(i.m_MaxLOD-i.m_MinLOD)+i.m_startScrollPoint;jQuery(i.m_Divmapscrollpoint).css("top",o+"px")}};i.StopAnimatedMove=function(){window.clearInterval(i.movetimer);i.movetimer=0;jQuery(i.m_Divmapcursorleft).removeAttr("style");jQuery(i.m_Divmapcursorright).removeAttr("style");jQuery(i.m_Divmapcursordown).removeAttr("style");jQuery(i.m_Divmapcursortop).removeAttr("style");jQuery(i.m_Divmapcursorreset).removeAttr("style");jQuery(i.m_Divmapcursorreset).css("top",i.curMoveX+"px");jQuery(i.m_Divmapcursorreset).css("left",i.curMoveY+"px")};i.ZoomToNextIntegerLOD=function(e){var o=i.scene.m_Canvas[0].m_nExactLOD;var t=e?Math.ceil(o):Math.floor(o);if(o!=t){i.scene.AnimateZoomToGeo(i.scene.GetCenterPos(),t,i.zoomtimerfrq)}else{i.scene.InternalOnZoomLayer(i.scene.m_Canvas[i.scene.m_nOverlayIndex])}};i.StartAnimatedZoom=function(e){var o=i.scene.GetCenterPos();if(i.zoomtimer){window.clearInterval(i.zoomtimer)}i.zoomtimer=window.setInterval(function(){var t=i.scene.GetCurrentZoomlevel()+.2*e;i.scene.ZoomToZoomlevel(o,t,true)},i.zoomtimerfrq)};i.processmouseup=function(){i.bInitDrag=false;i.StopAnimatedMove();document.removeEventListener("mouseup",i.processmouseup,true);document.removeEventListener("mousemove",i.processmousemove,true)};i.zoom_processmouseup=function(e){document.removeEventListener("mouseup",i.zoom_processmouseup,true);document.removeEventListener("mousemove",i.zoom_processmousemove,true);if(i.bInitDrag){var o=e.pageY-i.offsetY;if(o<0){o=0}if(o>i.m_lengthScrollLine){o=i.m_lengthScrollLine}var t=i.m_MinLOD+(i.m_MaxLOD-i.m_MinLOD)*o/i.m_lengthScrollLine;i.scene.AnimateZoomToGeo(i.midpointForZoom,Math.round(t),5)}i.bInitDrag=false};i.processmousemove=function(e){var o,t;if(i.bInitDrag==true){window.clearInterval(i.movetimer);i.movetimer=0;var r=e.pageX-i.offsetX;var m=e.pageY-i.offsetY;var n=parseInt(Math.sqrt(Math.pow(r-i.curMoveX,2)+Math.pow(m-i.curMoveY,2)),10);var s=17;if(n>s){var a=Math.atan2(r-i.curMoveX,m-i.curMoveY);o=Math.ceil(i.curMoveX+Math.sin(a)*s);t=Math.ceil(i.curMoveY+Math.cos(a)*s);n=s}else{o=r;t=m}jQuery(i.m_Divmapcursorreset).css("top",t+"px");jQuery(i.m_Divmapcursorreset).css("left",o+"px");var u=-(jQuery(i.m_Divmapcursorreset).position().left-i.curMoveX)*(n/s);var c=-(jQuery(i.m_Divmapcursorreset).position().top-i.curMoveY)*(n/s);i.movetimer=window.setInterval(function(){i.scene.MoveMap(u,c)},i.tint)}};i.zoom_processmousemove=function(e){var o=e.pageY-i.offsetY;if(!i.bInitDrag){if(o!=i.curZoomY){i.bInitDrag=true}}if(i.bInitDrag){if(o<0){o=0}if(o>i.m_lengthScrollLine){o=i.m_lengthScrollLine}jQuery(i.m_Divmapscrollpoint).css("top",o+"px");var t=i.m_MinLOD+(i.m_MaxLOD-i.m_MinLOD)*o/i.m_lengthScrollLine;i.scene.ZoomToZoomlevel(i.midpointForZoom,t)}};return i}});
//# sourceMappingURL=sapnavigation.js.map