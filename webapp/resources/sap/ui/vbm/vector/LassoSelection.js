sap.ui.define(["sap/ui/base/Object","./PayloadGenerator"],function(t,e){"use strict";const n=t.extend("sap.ui.vbm.vector.LassoSelection",{constructor:function(e){t.call(this);this._map=e;this._coordinates=[]},mouseDown(t,n){const o=this._map;const s=o.getCanvasContainer();const r=h();if(!(n&&t.button===0))return;o.dragPan.disable();var i=this;this._coordinates=[c(t)];document.addEventListener("mousemove",a);document.addEventListener("mouseup",u);document.addEventListener("keydown",l);function c(t){const e=s.getBoundingClientRect();return new maplibregl.Point(t.clientX-e.left-s.clientLeft,t.clientY-e.top-s.clientTop)}function a(t){const e=c(t);i._coordinates.push(e);m(r,i._coordinates)}function u(t){const n=d();if(n&&n.length>0){e.selectObjects(n)}}function l(t){if(t.keyCode===27)d()}function m(t,e){let n="";for(let t=0;t<e.length;t++){n+=`${e[t].x},${e[t].y} `}t.setAttribute("points",n.trim())}function d(){document.removeEventListener("mousemove",a);document.removeEventListener("keydown",l);document.removeEventListener("mouseup",u);r?.parentNode?.remove();const t=i._coordinates.map(t=>i._map.unproject([t.x,t.y]));const e=i._coordinates.reduce((t,e)=>{t.minX=Math.min(t.minX,e.x);t.minY=Math.min(t.minY,e.y);t.maxX=Math.max(t.maxX,e.x);t.maxY=Math.max(t.maxY,e.y);return t},{minX:Infinity,minY:Infinity,maxX:-Infinity,maxY:-Infinity});const n=[new maplibregl.Point(e.minX,e.minY),new maplibregl.Point(e.maxX,e.maxY)];const o=i._map.queryRenderedFeatures(n,{layers:["geojson-source-route","geojson-source-point"]});const s=o.filter(e=>{const n=e.geometry.coordinates;if(e.geometry.type==="Point"){return f(n,t)}else if(e.geometry.type==="LineString"){return p(n,t)}return false});i._map.dragPan.enable();return s}function f(t,e){let n=false;for(let o=0,s=e.length-1;o<e.length;s=o++){const r=e[o].lng,i=e[o].lat;const c=e[s].lng,a=e[s].lat;const u=i>t[1]!==a>t[1]&&t[0]<(c-r)*(t[1]-i)/(a-i)+r;if(u)n=!n}return n}function p(t,e){if(t.some(t=>f(t,e))){return true}for(let n=0;n<t.length-1;n++){const o=t[n];const s=t[n+1];for(let t=0;t<e.length-1;t++){const n=[e[t].lng,e[t].lat];const r=[e[t+1].lng,e[t+1].lat];if(g(o,s,n,r)){return true}}}return false}function g(t,e,n,o){const s=(t,e,n)=>{const o=(e[1]-t[1])*(n[0]-e[0])-(e[0]-t[0])*(n[1]-e[1]);return o===0?0:o>0?1:2};const r=s(t,e,n);const i=s(t,e,o);const c=s(n,o,t);const a=s(n,o,e);if(r!==i&&c!==a)return true;return false}function h(){const t="http://www.w3.org/2000/svg";const e=document.createElementNS(t,"svg");e.setAttribute("class","lasso-svg");e.setAttribute("style","position: absolute; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none;");const n=document.createElementNS(t,"polygon");n.setAttribute("style","fill: rgba(205, 245, 255, 0.5); stroke: #000000; stroke-width: 2; stroke-dasharray: 1, 1;");e.appendChild(n);s.appendChild(e);return n}}});return n});
//# sourceMappingURL=LassoSelection.js.map