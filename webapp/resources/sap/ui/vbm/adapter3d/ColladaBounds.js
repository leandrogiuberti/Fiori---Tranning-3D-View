/*
 * ! SAP UI development toolkit for HTML5 (SAPUI5) (c) Copyright 2009-2012 SAP AG. All rights reserved
 */
sap.ui.define(["sap/ui/base/Object","./Utilities","./thirdparty/three","sap/base/Log"],function(t,e,a,o){"use strict";var r={},i={};var s=0;var n=t.extend("sap.ui.vbm.adapter3d.ColladaBounds",{constructor:function(e){t.call(this);this._adapter=e;this._context=e._context;this._viewport=e._viewport;this._root=this._viewport._root;this._scene=this._viewport._scene;this._camera=this._viewport._camera;this._cameraControls=this._viewport._cameraController;this._bbox=new a.Box3;this._colladaBoundingBoxes=[];this._adapter._colladaBoundingBoxMesh=[]}});n.prototype.initialize=function(){var t=this;this._scene._cm.forEach(function(e,a){for(var o=0;o<e.length;o++){var n=e[o];r=Array.from(n.instances);i=Array.from(n.objects3D);s=n.hitInfo[0].matrices.length;t.transform(r,i,s)}})};n.prototype.transform=function(t,e,o){var r,i,s;var n=new a.Matrix4;for(i=0;i<t.length;i++){for(r=0;r<e.length;r++){var l=e[r];var c=l.geometry;l.updateMatrixWorld(false,false);if(l.visible&&c){if(!c.boundingBox){c.computeBoundingBox()}if(l.isInstancedMesh){c=l.geometry.clone();l.getMatrixAt(i,n);s=t[i].instance;c.applyMatrix4(n);this.createBBoxMeshes(c,l,o,s)}}}}};n.prototype.createBBoxMeshes=function(t,e,o,r){if(r["VB:c"]=="true"&&e.userData._sapInstance!=undefined){var i=r;var s=new a.MeshBasicMaterial({color:8421504,transparent:true,wireframe:true,opacity:1,visible:false});var n=new a.Mesh(t,s);var l=this._root.matrixWorld.clone();n.applyMatrix4(l);n.scale.set(1,1,1);n.rotation.set(0,0,0);n.updateMatrixWorld();n.userData={name:"ColladaBounds",_sapInstance:i,id:i.id,count:o};this._adapter._colladaBoundingBoxMesh.push(n);this._scene.add(n)}};n.prototype._destroy=function(){this._adapter=null;this._context=null;this._viewport=null;this._root=null;this._scene=null;this._camera=null;this._cameraControls=null;this._bbox=null;this._colladaBoundingBoxes=null;this._adapter._colladaBoundingBoxMesh=null};return n});
//# sourceMappingURL=ColladaBounds.js.map