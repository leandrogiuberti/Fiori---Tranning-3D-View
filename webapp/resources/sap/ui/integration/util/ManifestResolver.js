/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/core/Lib","sap/ui/integration/util/BindingHelper","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/Utils","sap/m/IllustratedMessageType","sap/m/IllustratedMessageSize","sap/base/Log"],function(e,t,r,n,a,i,o){"use strict";var s={};s.resolveCard=function(e){e.startManifestProcessing();return s._awaitReadyEvent(e).then(function(){return e.getModel("context").waitForPendingProperties()}).then(function(){return s._handleCardReady(e)}).catch(function(t){return s._handleCardSevereError(e,t)})};s._awaitReadyEvent=function(e){if(e.isReady()){return Promise.resolve(e)}return new Promise(function(t,r){e.attachEvent("_ready",function(r){t(e)})})};s._handleCardReady=function(e){var a=e.getManifestEntry("/"),i=[],o=e.getSevereErrors(),l=e.getContentMessage();if(o.length){return Promise.reject(o.join(" "))}try{a=t.createBindingInfos(a,e.getBindingNamespaces());if(e.getAggregation("_filterBar")){i=e.getAggregation("_filterBar")._getFilters().map(function(e){return["/sap.card/configuration/filters/"+e.getKey(),e]})}var d=0;i.concat([["/sap.card/content",e.getCardContent()],["/sap.card/header",e.getCardHeader()],["/sap.card/footer",e.getCardFooter()],["/sap.card",e]]).filter(function(t){return!!e.getManifestEntry(t[0])}).forEach(function(e){var t=e[0];var i=e[1];var o;var s;if(l&&t==="/sap.card/content"){o={message:l}}else if(i.getStaticConfiguration){o=i.getStaticConfiguration(n.getNestedPropertyValue(a,t));if(t.startsWith("/sap.card/configuration/filters/")){o.index=d;d++}}else{o=n.getNestedPropertyValue(a,t)}if(i.extendStaticConfiguration){i.extendStaticConfiguration(o)}if(o.data){s=o.data.path;delete o.data}o=r.resolveValue(o,i,s,true);n.setNestedPropertyValue(a,t,o)});s._makeEnabledAndVisibleBooleans(a);return Promise.resolve(JSON.parse(JSON.stringify(a)))}catch(e){return Promise.reject(e)}};s._makeEnabledAndVisibleBooleans=function(e){for(const t in e){if(!e.hasOwnProperty(t)){continue}const r=e[t];if(r&&typeof r==="object"){s._makeEnabledAndVisibleBooleans(r)}else if(t==="enabled"||t==="visible"){e[t]=!!r}}};s._handleCardSevereError=function(t,r){var n=t.getManifestEntry("/"),s=e.getResourceBundleFor("sap.ui.integration");o.error(r,"sap.ui.integration.util.ManifestResolver");if(n===null){n={}}n["sap.card"]={content:{message:{type:"error",title:s.getText("CARD_ERROR_CONFIGURATION_TITLE"),description:s.getText("CARD_ERROR_CONFIGURATION_DESCRIPTION"),details:r.toString(),illustrationType:a.UnableToLoad,illustrationSize:i.Small}}};return JSON.parse(JSON.stringify(n))};return s});
//# sourceMappingURL=ManifestResolver.js.map