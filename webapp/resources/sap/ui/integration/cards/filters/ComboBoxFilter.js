/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseFilter","sap/ui/integration/controls/ComboBox","sap/ui/core/ListItem","sap/ui/model/json/JSONModel","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/ComboBoxHelper","sap/base/util/merge","sap/ui/integration/util/SorterHelper"],function(e,t,o,i,a,s,l,n){"use strict";const r=e.extend("sap.ui.integration.cards.filters.ComboBoxFilter",{metadata:{library:"sap.ui.integration",aggregations:{_comboBox:{type:"sap.m.ComboBox",multiple:false,visibility:"hidden"}}},renderer:{apiVersion:2}});r.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this._oItemTemplate){this._oItemTemplate.destroy()}};r.prototype.getField=function(){return this._getComboBox()};r.prototype.onDataChanged=function(){const e=this._getComboBox();s.setValueAndKey(e,e.getSelectedKey(),e.getValue());this._syncValue()};r.prototype.getValueForModel=function(){const e=this._getComboBox();let t=e.getSelectedItem();const o=e.getCustomSelectedIndex();if(!t&&o>-1){t=this._getComboBox().getItems()[o];if(t&&!this._getComboBox().getValue()){e.setSelectedItem(t)}}if(t){return{value:this._getComboBox().getValue(),selectedItem:{title:t.getText(),key:t.getKey(),additionalText:t.getAdditionalText()}}}return{value:this._getComboBox().getValue()}};r.prototype.setValueFromOutside=function(e){const t=a.resolveValue(e,this.getCardInstance());s.setValueAndKey(this._getComboBox(),t?.selectedKey,t?.value);this._syncValue()};r.prototype.getStaticConfiguration=function(){const e=this.getParsedConfiguration();let t="/";let o=[];let i;if(e.item&&e.item.path){t=e.item.path}const s=this.getModel().getProperty(t);if(e.item&&e.item.template){i=e.item.template;o=s.map(function(e,o){const s=t==="/"?t+o:t+"/"+o;return a.resolveValue(i,this,s)}.bind(this))}else{o=s}o=o.map(e=>({key:e.key&&e.key.toString(),title:e.title&&e.title.toString(),additionalText:e.additionalText&&e.additionalText.toString()}));const n=l({},e);delete n.item;n.items=o;const r=this.getValueForModel();n.value=r.value;n.selectedKey=r.selectedItem?.key;return n};r.prototype.writeValueToConfiguration=function(e){const t=this.getValueForModel();e.value=t.value;if(t.selectedItem){e.selectedKey=t.selectedItem.key}};r.prototype._getComboBox=function(){let e=this.getAggregation("_comboBox");if(!e){e=this._createComboBox();this.setAggregation("_comboBox",e)}return e};r.prototype._createComboBox=function(){const e=this.getConfig();const l=new t({placeholder:e.placeholder,showSecondaryValues:true,filterSecondaryValues:true,customSelectedIndex:e.selectedIndex});let r,u,m,d="/";l.attachChange(e=>{this._syncValue()});if(e&&e.item){d=e.item.path||d}if(e&&e.item&&e.item.template){r=e.item.template.key;u=e.item.template.title;m=e.item.template.additionalText}const c=this.getCardInstance();if(e&&e.items){r="{key}";u="{title}";m="{additionalText}";const t=new i(e.items);t.setSizeLimit(c.getModelSizeLimit());this.setModel(t)}this._oItemTemplate=new o({key:r,text:u,additionalText:m});const g=e.group;if(g){this._oSorter=n.getGroupSorter(g)}l.bindItems({path:d,template:this._oItemTemplate,sorter:this._oSorter});s.setValueAndKey(l,a.resolveValue(e.selectedKey,c),a.resolveValue(e.value,c));const p=this.createLabel(e);if(p){l.addAriaLabelledBy(p)}return l};return r});
//# sourceMappingURL=ComboBoxFilter.js.map