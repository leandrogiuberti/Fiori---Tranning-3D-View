/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/util/extend","sap/base/util/merge","sap/f/cards/NumericHeader","sap/f/cards/NumericHeaderRenderer","sap/f/cards/NumericSideIndicator","sap/m/library","sap/m/Text","sap/ui/core/Element","sap/ui/integration/util/BindingHelper","sap/ui/model/json/JSONModel","sap/ui/integration/util/BindingResolver","sap/ui/integration/util/LoadingProvider","sap/ui/integration/util/subtitleToSubTitle","sap/ui/integration/controls/Microchart"],function(t,e,i,a,r,n,o,s,d,c,l,u,h,p){"use strict";var g=n.AvatarColor;var f=i.extend("sap.ui.integration.cards.NumericHeader",{metadata:{library:"sap.ui.integration",properties:{interactive:{type:"boolean",defaultValue:false}},aggregations:{_loadingProvider:{type:"sap.ui.core.Element",multiple:false,visibility:"hidden"}},associations:{card:{type:"sap.ui.integration.widgets.Card",multiple:false}}},renderer:a});f.create=function(e,i,a,n){i=i||{};var s={title:i.title,titleMaxLines:i.titleMaxLines,subtitle:i.subtitle||i.subTitle,subtitleMaxLines:i.subtitleMaxLines||i.subTitleMaxLines,dataTimestamp:i.dataTimestamp,visible:i.visible,wrappingType:i.wrappingType};if(i.status&&i.status.text&&!i.status.text.format){s.statusText=i.status.text;s.statusVisible=i.status.visible}if(i.icon){var c=i.icon.initials||i.icon.text;var l=i.icon.backgroundColor||(c?g.Accent6:g.Transparent);s.iconSrc=i.icon.src;s.iconDisplayShape=i.icon.shape;s.iconInitials=c;s.iconAlt=i.icon.alt;s.iconBackgroundColor=l;s.iconVisible=i.icon.visible;s.iconFitType=i.icon.fitType}if(s.iconSrc){s.iconSrc=d.formattedProperty(s.iconSrc,function(t){return n.formatSrc(t)})}t(s,{unitOfMeasurement:i.unitOfMeasurement,details:i.details?.text??i.details,detailsMaxLines:i.details?.maxLines||i.detailsMaxLines,sideIndicatorsAlignment:i.sideIndicatorsAlignment});if(i.details?.state){s.detailsState=i.details.state}if(i.mainIndicator){s.number=i.mainIndicator.number;s.scale=i.mainIndicator.unit;s.trend=i.mainIndicator.trend;s.state=i.mainIndicator.state;s.numberVisible=i.mainIndicator.visible}if(i.sideIndicators){s.sideIndicators=i.sideIndicators.map(function(t){return new r(t)})}if(i.banner){s.bannerLines=i.banner.map(function(t){var e=new o({text:t.text,visible:t.visible});if(t.diminished){e.addStyleClass("sapFCardHeaderBannerLineDiminished")}return e})}s.toolbar=a;const u=new f(e,s);if(i.chart){p.loadDependencies().then(()=>{u.setMicroChart(p.create(i.chart,true))});if(i.sideIndicators){u.addStyleClass("sapFCardNumericHeaderSIMC")}else{u.addStyleClass("sapFCardNumericHeaderMC")}}u._oConfiguration=i;return u};f.prototype.init=function(){i.prototype.init.call(this);this._bReady=false;this.setAggregation("_loadingProvider",new u);this._aReadyPromises=[];this._awaitEvent("_dataReady");Promise.all(this._aReadyPromises).then(function(){this._bReady=true;this.fireEvent("_ready")}.bind(this))};f.prototype.exit=function(){i.prototype.exit.call(this);this._oServiceManager=null;this._oDataProviderFactory=null;if(this._oDataProvider){this._oDataProvider.destroy();this._oDataProvider=null}if(this._oActions){this._oActions.destroy();this._oActions=null}};f.prototype.isInteractive=function(){return this.getInteractive()};f.prototype.isReady=function(){return this._bReady};f.prototype.isLoading=function(){if(!this.isReady()){return true}if(this._oDataProvider){return this.getAggregation("_loadingProvider").getLoading()}var t=this.getCardInstance();return t&&t.isLoading()};f.prototype._awaitEvent=function(t){this._aReadyPromises.push(new Promise(function(e){this.attachEventOnce(t,function(){e()})}.bind(this)))};f.prototype.setServiceManager=function(t){this._oServiceManager=t;return this};f.prototype.setDataProviderFactory=function(t){this._oDataProviderFactory=t;return this};f.prototype.getStaticConfiguration=function(){const t=e({},this._oConfiguration);h(t);return t};f.prototype._setDataConfiguration=function(t){var e=this.getCardInstance(),i="/",a;if(t&&t.path){i=l.resolveValue(t.path,this.getCardInstance())}this.bindObject(i);if(this._oDataProvider){this._oDataProvider.destroy()}this._oDataProvider=this._oDataProviderFactory.create(t,this._oServiceManager);if(t&&t.name){a=e.getModel(t.name)}else if(this._oDataProvider){a=new c;this.setModel(a)}if(this._oDataProvider){this._oDataProvider.attachDataRequested(function(){this.showLoadingPlaceholders()}.bind(this));this._oDataProvider.attachDataChanged(function(t){a.setData(t.getParameter("data"));this.onDataRequestComplete()}.bind(this));this._oDataProvider.attachError(function(t){this._handleError({requestErrorParams:t.getParameters(),requestSettings:this._oDataProvider.getResolvedConfiguration()});this.onDataRequestComplete()}.bind(this));this._oDataProvider.triggerDataUpdate()}else{this.fireEvent("_dataReady")}};f.prototype._handleError=function(t){this.fireEvent("_error",{errorInfo:t})};f.prototype.refreshData=function(){if(this._oDataProvider){this._oDataProvider.triggerDataUpdate()}};f.prototype.showLoadingPlaceholders=function(){if(!this._isDataProviderJson()){this.getAggregation("_loadingProvider").setLoading(true)}};f.prototype.hideLoadingPlaceholders=function(){this.getAggregation("_loadingProvider").setLoading(false)};f.prototype.onDataRequestComplete=function(){this.fireEvent("_dataReady");this.hideLoadingPlaceholders()};f.prototype.getCardInstance=function(){return s.getElementById(this.getCard())};f.prototype._isDataProviderJson=function(){return!!this._oDataProvider?.getConfiguration()?.json};return f});
//# sourceMappingURL=NumericHeader.js.map