/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./BaseContent","./WebPageContentRenderer","sap/ui/util/isCrossOriginURL","sap/m/IllustratedMessageType","sap/ui/integration/util/BindingHelper","sap/ui/core/Lib"],function(e,t,i,a,o,r){"use strict";var n="_frameLoaded";var s=15*1e3;const d=r.getResourceBundleFor("sap.ui.integration");var l=e.extend("sap.ui.integration.cards.WebPageContent",{metadata:{properties:{minHeight:{type:"sap.ui.core.CSSSize",defaultValue:t.MIN_WEB_PAGE_CONTENT_HEIGHT,bindable:true},src:{type:"sap.ui.core.URI",bindable:true},sandbox:{type:"string",defaultValue:"",bindable:true},allow:{type:"string",bindable:true},allowFullscreen:{type:"boolean",defaultValue:false,bindable:true},omitSandbox:{type:"boolean",defaultValue:false,bindable:true}},library:"sap.ui.integration"},renderer:t});l.prototype.init=function(){e.prototype.init.apply(this,arguments);this._onFrameLoadedBound=this._onFrameLoaded.bind(this);this._sPrevSrc=this.getSrc();this.attachEventOnce("_dataReady",()=>{this._bDataReady=true})};l.prototype.exit=function(){e.prototype.exit.apply(this,arguments);if(this._iLoadTimeout){clearTimeout(this._iLoadTimeout)}};l.prototype.onBeforeRendering=function(){e.prototype.onBeforeRendering.apply(this,arguments);if(this.getDomRef("frame")){this.getDomRef("frame").removeEventListener("load",this._onFrameLoadedBound)}const t=this.getSrc();if(this._isDataReady()&&t!==undefined&&this._sPrevSrc!==t){this._sPrevSrc=t;if(this._checkSrc()){this._bSrcChecked=true;this._raceFrameLoad()}}};l.prototype.onAfterRendering=function(){e.prototype.onAfterRendering.apply(this,arguments);if(this.getDomRef("frame")){this.getDomRef("frame").addEventListener("load",this._onFrameLoadedBound)}};l.prototype.applyConfiguration=function(){const e=this.getParsedConfiguration();this.fireEvent("_actionContentReady");if(!e){return}this.applySettings({src:o.formattedProperty(e.src,e=>this._oIconFormatter.formatSrc(e)),sandbox:e.sandbox,minHeight:e.minHeight,allow:e.allow,allowFullscreen:e.allowFullscreen||e.allowfullscreen,omitSandbox:e.omitSandbox})};l.prototype._supportsOverflow=function(){return false};l.prototype._isDataReady=function(){if(!this.getCardInstance()){return this._bDataReady}return this._bDataReady&&this.getCardInstance().isDataReady()};l.prototype._checkSrc=function(){const e=this.getCardInstance(),t=this.getSrc();if(!e){return false}if(!t){this.handleError({illustrationType:a.UnableToLoad,title:d.getText("CARD_WEB_PAGE_EMPTY_URL_ERROR"),description:d.getText("CARD_ERROR_CONFIGURATION_DESCRIPTION")});return false}if(i(t)&&!t.startsWith("https")){this.handleError({illustrationType:a.UnableToLoad,title:d.getText("CARD_WEB_PAGE_HTTPS_URL_ERROR"),description:d.getText("CARD_ERROR_REQUEST_ACCESS_DENIED_DESCRIPTION")});return false}return true};l.prototype._raceFrameLoad=function(){this.awaitEvent(n);if(this._iLoadTimeout){clearTimeout(this._iLoadTimeout)}this._iLoadTimeout=setTimeout(function(){this.fireEvent(n);var e=s/1e3;this.handleError({illustrationType:a.UnableToLoad,title:d.getText("CARD_WEB_PAGE_TIMEOUT_ERROR",[e]),details:"Failed to load '"+this.getSrc()+"' after "+e+" seconds."})}.bind(this),s)};l.prototype._onFrameLoaded=function(){this.fireEvent(n);clearTimeout(this._iLoadTimeout)};return l});
//# sourceMappingURL=WebPageContent.js.map