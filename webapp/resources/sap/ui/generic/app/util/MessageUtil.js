/*
 * ! SAPUI5

(c) Copyright 2009-2020 SAP SE. All rights reserved
 */
sap.ui.define(["sap/ui/core/library","sap/ui/core/message/Message","sap/ui/core/message/MessageType","sap/ui/model/json/JSONModel","sap/m/MessageToast","sap/ui/core/syncStyleClass","sap/ui/core/Fragment","sap/ui/core/Messaging"],function(e,t,r,s,a,n,o,i){"use strict";const u=e.ValueState;var c={badRequest:"400",unauthorized:"401",forbidden:"403",notFound:"404",methodNotAllowed:"405",preconditionFailed:"428",internalServerError:"500",notImplemented:"501",badGateway:"502",serviceUnavailable:"503",gatewayTimeout:"504",httpVersionNotSupported:"505"};var l={callAction:"callAction",addEntry:"addEntry",saveEntity:"saveEntity",deleteEntity:"deleteEntity",editEntity:"editEntity",modifyEntity:"modifyEntity",activateDraftEntity:"activateDraftEntity",saveAndPrepareDraftEntity:"saveAndPrepareDraftEntity",getCollection:"getCollection"};var g;function p(e){var t=[],r;var s=i.getMessageModel().getData();var a=[];for(var n=0;n<s.length;n++){r=s[n];var o=r.technicalDetails&&r.technicalDetails.statusCode==="404"&&r.type==="Error";if(r.persistent){if(o){a.push(r)}else{t.push(r)}}}return e?t.concat(a):t}function f(e,t){var r;r=function(r,s){var a;var i={onMessageDialogClose:function(){s.onMessageDialogClose();a.destroy()},onActionButtonPressed:function(){s.onActionButtonPressed();a.destroy()}};return o.load({name:r,controller:i}).then(function(r){if(t){n(t,e,r)}e.addDependent(e);return r})};return r}function v(e,t,n){var o=p();var i=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app");if(o.length===0){return Promise.resolve()}d();var c=u.None;for(var l=0;l<o.length&&c!==u.Error;l++){var g=o[l];switch(g.type){case r.Error:c=u.Error;break;case r.Warning:c=u.Warning;break;case r.Success:if(c===u.None){c=u.Success}break;default:break}}if(o.length===1&&(c===u.Success||c===u.None)){a.show(o[0].message);return Promise.resolve()}var v=typeof e==="function"?e:f(e.owner,e.contentDensityClass);var y;var m,E;var b=function(){y.close();E.setProperty("/backButtonVisible",false);E.setProperty("/messages",[]);E.setProperty("/messageToGroupName",Object.create(null));m.navigateBack();E.getProperty("/resolve")()};var T={onMessageDialogClose:function(){b(E)},onActionButtonPressed:function(){E.getProperty("/actionButtonCallback")();b(E)},onBackButtonPress:function(){E.setProperty("/backButtonVisible",false);m.navigateBack()},onMessageSelect:function(){E.setProperty("/backButtonVisible",true)}};return v("sap.ui.generic.app.fragments.MessageDialog",T).then(function(e){y=e;m=y.getContent()[0];var r=y.getModel();var a=r&&r.getMetaModel();var u=false;var l=!!(n&&n.action);var g=Object.create(null);if(a){o.forEach(function(e){var t=e.getTargets()[0];if(!t){return}if(t.lastIndexOf("/")>0){t=t.substring(0,t.lastIndexOf("/"))}var s=t.substring(1,t.indexOf("("));var n=s&&a.getODataEntitySet(s);var o=n&&a.getODataEntityType(n.entityType);var i=o&&o["com.sap.vocabularies.UI.v1.HeaderInfo"];var c=i&&i.Title&&i.Title.Value&&i.Title.Value.Path;var l=r.getProperty(t);var p=l&&l[c];if(p){g[e.getId()]=p;u=true}})}E=y.getModel("settings");if(!E){E=new s({genericGroupName:i.getText("GENERAL_TITLE"),backButtonVisible:false,cancelButtonText:i.getText("DIALOG_CANCEL"),closeButtonText:i.getText("DIALOG_CLOSE")});y.setModel(E,"settings")}E.setProperty("/showActionButton",l);if(l){E.setProperty("/actionButtonText",n.actionLabel);E.setProperty("/actionButtonCallback",n.action)}E.setSizeLimit(9999);E.setProperty("/title",t||i.getText("DIALOG_TITLE"));E.setProperty("/messages",o);E.setProperty("/grouping",u);E.setProperty("/state",c);E.setProperty("/resolve",function(){return Promise.resolve()});E.setProperty("/messageToGroupName",g);y.open();return null})}function d(){var e=p(true);if(e.length>0){i.removeMessages(e)}}function y(e,s,a){var n=new t({message:e,description:s,type:r.Error,processor:a,target:"",persistent:true});i.addMessages(n)}function m(e){var t;g=e&&e.url;if(g){g="/"+g.substring(0,g.indexOf(")")+1)}var r=sap.ui.getCore().getLibraryResourceBundle("sap.ui.generic.app").getText("ERROR_UNKNOWN");var s;if(e instanceof Error){if(e.message){r=e.message}}else if(e.response){if(e.response.message){r=e.response.message}var a=e.response.statusCode;s=!Number.isInteger(a)?Number(a):a;if(e.response.headers){for(var n in e.response.headers){if(n.toLowerCase()==="content-type"){var o=e.response.headers[n];if(o.toLowerCase().indexOf("application/json")===0){if(e.response.responseText){var i=JSON.parse(e.response.responseText);if(i&&i.error&&i.error.message&&i.error.message.value){r=i.error.message.value}}}else if(e.message){r=e.message}break}}}}var u=p();t={httpStatusCode:s,messageText:r,description:null,containsTransientMessage:u.length===0?false:true};return t}return{operations:l,httpStatusCodes:c,handleTransientMessages:v,removeTransientMessages:d,addTransientErrorMessage:y,parseErrorResponse:m,getTransientMessages:p}},true);
//# sourceMappingURL=MessageUtil.js.map