/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/assert","sap/base/config","sap/base/i18n/Localization","sap/base/i18n/ResourceBundle","sap/base/future","sap/base/Log","sap/base/util/deepExtend","sap/base/util/isEmptyObject","sap/base/util/isPlainObject","sap/base/util/LoaderExtensions","sap/base/util/fetch","sap/base/util/mixedFetch","sap/base/util/ObjectPath","sap/base/util/Version","sap/base/util/array/uniqueSort","sap/ui/base/OwnStatics","sap/ui/Global","sap/ui/VersionInfo","sap/ui/base/DataType","sap/ui/base/EventProvider","sap/ui/base/Object","sap/ui/base/SyncPromise","sap/ui/core/_UrlResolver","sap/ui/core/Supportability","sap/ui/core/Theming"],function(e,n,t,r,i,a,s,o,u,l,c,f,d,p,h,y,g,m,b,v,_,S,j,L,w){"use strict";const{includeLibraryTheme:T}=y.get(w);var P={};var E={};var O={};var C=new Set(["sap.suite.ui.generic.template","sap.ui.comp","sap.ui.layout","sap.ui.unified"]);function z(e,n){return sap.ui.require.toUrl(e.replace(/\./g,"/")+n)}function B(e,n){l.registerResourcePath(e.replace(/\./g,"/"),n)}function F(e,n){var t=e.modules,r=function(e){return/^jquery\.sap\./.test(e)?e:e.replace(/\./g,"/")};if(p(e.version||"1.0").compareTo("2.0")<0){t={};for(var i in e.modules){t[r(i)+".js"]=e.modules[i]}}sap.ui.require.preload(t,e.name,n)}var x={};n.get({name:"sapUiXxLibraryPreloadFiles",type:n.Type.StringArray,external:true}).forEach(function(e){var n=String(e).trim().split(/\s*:\s*/),t=n[0],r=n[1];if(n.length===1){r=t;t=""}if(/^(?:none|js|json|both)$/.test(r)){x[t]=r}});var R=Symbol("sap.ui.core.Lib");var M={configurable:true,enumerable:true,writable:false};function A(e){M.value=e;return M}function $(e){if(e&&typeof e==="object"&&!Object.isFrozen(e)){Object.freeze(e);for(var n in e){if(Object.hasOwn(e,n)){$(e[n])}}}}function k(e){const n=[];if(e){e.forEach(function(e){if(!e.lazy){n.push({name:e.name})}else if(C.has(e.name)){n.push({name:e.name,lazy:true})}})}return n}var U=_.extend("sap.ui.core.Lib",{constructor:function(n){_.call(this);e(typeof n==="object","A settings object must be given to the constructor of sap/ui/core/Lib");e(typeof n.name==="string"&&n.name,"The settings object that is given to the constructor of sap/ui/core/Lib must contain a 'name' property which is a non-empty string");if(n._key!==R){throw new Error("The constructor of sap/ui/core/Lib is restricted to the internal usage. To get an instance of Library with name '"+n.name+"', use the static method 'get' from sap/ui/core/Lib instead.")}this.name=n.name;this.namespace=n.name.replace(/\./g,"/");var t=["dependencies","types","interfaces","controls","elements"];t.forEach(function(e){Object.defineProperty(this,e,A([]))}.bind(this));Object.defineProperty(this,"_resourceBundles",{value:{},writable:true});Object.defineProperty(this,"_loadingStatus",{value:null,writable:true});Object.defineProperty(this,"_settingsEnhanced",{value:false,writable:true});Object.defineProperty(this,"_manifestFailed",{value:false,writable:true})},getInterface:function(){return this},isSettingsEnhanced:function(){return this._settingsEnhanced},enhanceSettings:function(e){if(this._settingsEnhanced){return this}this._settingsEnhanced=true;var n,t,r;for(n in e){t=e[n];r=undefined;if(t!==undefined){if(Array.isArray(this[n])){if(this[n].length===0){r=t}else{r=h(this[n].concat(t))}}else if(this[n]===undefined){r=t}else if(n!="name"){i.warningThrows("library info setting ignored: "+n+"="+t)}if(r!==undefined){Object.defineProperty(this,n,A(r))}}}return this},_getFileType:function(e){var n;var t=x[this.name]||x[""]||"both";if(e===true){n="json"}else if(e===false){n="js"}else{n=t}if(t!=="both"&&n!=="both"&&t!==n){n="none"}return n},preload:function(e){if(e&&(e.hasOwnProperty("async")||e.hasOwnProperty("sync"))){i.errorThrows("The 'preload' function of class sap/ui/core/Lib only supports preloading a library asynchronously.",{suffix:"The given 'async' or 'sync' setting is ignored."})}if(e&&e.hasOwnProperty("json")){i.errorThrows("The 'preload' function of class sap/ui/core/Lib only supports preloading in JS Format.",{suffix:"The given 'json' setting is ignored."})}return this._preload(["url","lazy"].reduce(function(n,t){if(e&&e.hasOwnProperty(t)){n[t]=e[t]}return n},{}))},_preload:function(e){e=e||{};var n=this._getFileType(e.json),t=!!sap.ui.loader._.getModuleState(this.namespace+"/library.js"),r=U.isDepCacheEnabled();if(n==="none"){return e.sync?this:Promise.resolve(this)}if(this._loadingStatus==null&&e.url){B(this.name,e.url)}this._loadingStatus=this._loadingStatus||{};if(this._loadingStatus.pending){if(e.sync){if(e.lazy){return this}else if(this._loadingStatus.async){a.warning("request to load "+this.name+" synchronously while async loading is pending; this causes a duplicate request and should be avoided by caller")}else{a.warning("request to load "+this.name+" synchronously while sync loading is pending (cycle, ignored)");return this}}else if(this._loadingStatus.preloadFinished){return Promise.resolve(this)}}if(e.sync&&this._loadingStatus.pending===false||!e.sync&&this._loadingStatus.promise){return e.sync?this:this._loadingStatus.promise}if(e.lazy){a.debug("Lazy dependency to '"+this.name+"' encountered, loading library-preload-lazy.js");if(e.sync){try{sap.ui.requireSync(this.namespace+"/library-preload-lazy")}catch(e){a.error("failed to load '"+this.namespace+"/library-preload-lazy.js"+"' synchronously ("+(e&&e.message||e)+")")}return this}return sap.ui.loader._.loadJSResourceAsync(this.namespace+"/library-preload-lazy.js",true)}this._loadingStatus.pending=true;this._loadingStatus.async=!e.sync;var i;if(t){i=(e.sync?S:Promise).resolve()}else{i=n!=="json"?this._preloadJSFormat({fallbackToJSON:n!=="js",http2:r,sync:e.sync}):this._preloadJSONFormat({sync:e.sync})}this._loadingStatus.promise=i.then(function(n){const t=this.getManifest();var r=t?.["sap.ui5"]?.dependencies?.libs;if(!n&&r){n=Object.keys(r).map(e=>({name:e,lazy:r[e].lazy||false}))}this._loadingStatus.preloadFinished=true;let i;if(n&&n.length){if(!e.sync){n=m._getTransitiveDependencyForLibraries(n)}n=k(n);i=n.map(function(n){var t=U._get(n.name,true);return t._preload({sync:e.sync,lazy:n.lazy})})}else{i=[]}if(!e.sync&&t&&p(t._version).compareTo("1.9.0")>=0){i.push(this.loadResourceBundle())}const a=e.sync?S.all(i):Promise.all(i);return a.then(function(){this._loadingStatus.pending=false;return this}.bind(this))}.bind(this));return e.sync?this._loadingStatus.promise.unwrap():this._loadingStatus.promise},_preloadJSFormat:function(e){e=e||{};var n=this;var t=this.namespace+(e.http2?"/library-h2-preload":"/library-preload")+(e.sync?"":".js");var r;if(e.sync){r=S.resolve().then(function(){sap.ui.requireSync(t)})}else{r=sap.ui.loader._.loadJSResourceAsync(t)}return r.catch(function(r){if(e.fallbackToJSON){var i;if(e.sync){var s=r;while(s&&s.cause){s=s.cause}i=s&&s.name==="XHRLoadError"}else{i=true}if(i){a.error("failed to load '"+t+"' ("+(r&&r.message||r)+"), falling back to library-preload.json");return n._preloadJSONFormat({sync:e.sync})}}})},_preloadJSONFormat:function(e){e=e||{};var n=z(this.name,"/library-preload.json");c=f?f:c;return c(n,{headers:{Accept:c.ContentTypes.JSON}},e.sync).then(function(e){if(e.ok){return e.json().then(function(e){if(e){F(e,n);if(Array.isArray(e.dependencies)){return e.dependencies.map(function(e){return{name:e.replace(/\.library-preload$/,"")}})}else{return e.dependencies}}})}else{throw Error(e.statusText||e.status)}}).catch(function(e){a.error("failed to load '"+n+"': "+e.message)})},getManifest:function(e){if(!this.oManifest){var n=this.namespace+"/manifest.json";if(sap.ui.loader._.getModuleState(n)||e&&!this._manifestFailed){try{this.oManifest=l.loadResource(n,{dataType:"json",async:false,failOnError:!this.isSettingsEnhanced()});if(this._oManifest){$(this.oManifest)}else{this._manifestFailed=true}}catch(e){this._manifestFailed=true}}}return this.oManifest},_getI18nSettings:function(){var e=this.getManifest(),n;if(e&&p(e._version).compareTo("1.9.0")>=0){n=e["sap.ui5"]&&e["sap.ui5"].library&&e["sap.ui5"].library.i18n}n=this._normalizeI18nSettings(n);return n},_normalizeI18nSettings:function(e){if(e==null||e===true){e={bundleUrl:"messagebundle.properties"}}else if(typeof e==="string"){e={bundleUrl:e}}else if(typeof e==="object"){e=s({},e)}return e},_includeTheme:function(e){T({libName:this.name,variant:e})},getResourceBundle:function(e){return this._loadResourceBundle(e,true)},loadResourceBundle:function(e){return this._loadResourceBundle(e)},_loadResourceBundle:function(n,i){var a=this,s=this.getManifest(i),o=!!s,u,l,c,f;e(n===undefined||typeof n==="string","sLocale must be a string or omitted");n=n||t.getLanguage();c=n+"/manifest-not-available";if(o){f=n;delete this._resourceBundles[c]}else{f=c}u=this._resourceBundles[f];if(!u||i&&u instanceof Promise){l=this._getI18nSettings();if(l){var d=z(this.name+"/",l.bundleUrl);E[d]=this;u=r.create({bundleUrl:d,supportedLocales:l.supportedLocales,fallbackLocale:l.fallbackLocale,locale:n,async:!i,activeTerminologies:t.getActiveTerminologies()});if(u instanceof Promise){u=u.then(function(e){a._resourceBundles[f]=e;return e})}this._resourceBundles[f]=u}}return i?u:Promise.resolve(u)}});U.isLoaded=function(e){return P[e]?true:false};U._get=function(e,n){var t=P[e];if(!t&&n){P[e]=t=new U({name:e,_key:R});O={}}return t};U._getByBundleUrl=function(e){if(e){if(E[e]){return E[e]}if(e in O){return undefined}var n=sap.ui.loader._.guessResourceName(e);if(n){for(var t in P){var r=P[t];if(!r.isSettingsEnhanced()){continue}if(r.namespace!==""&&n.startsWith(r.namespace+"/")){var i=n.replace(r.namespace+"/","");var a=r._getI18nSettings();if(a){var s=z(r.namespace,"/"+a.bundleUrl);i=z(r.namespace,"/"+i);if(i===s){E[e]=r;return r}O[e]=undefined}}}}}};U.all=function(){return U._all(false)};U._all=function(e){var n={};Object.keys(P).forEach(function(t){if(e||P[t].isSettingsEnhanced()){n[t]=P[t]}});return n};const q=Symbol("isProxy");function I(e,n){const t=new WeakMap;t.set(n,`${e}.`);const r={set(e,n,i){if(u(i)&&!i[q]){const s=o(i);let u=s;if(!s){if(b._isEnumCandidate(i)){e[n]=i;const r=t.get(e);b.registerEnum(`${r}${n}`,i);a.debug(`[Library API-Version 2] If you intend to use API-Version 2 in your library, make sure to call 'sap/ui/base/DataType.registerEnum' for ${r}${n}.`)}else{const t=n.charAt(0);if(t===t.toLowerCase()&&t!==t.toUpperCase()){u=true}else{e[n]=i}}}if(u){e[n]=new Proxy(i,r);const a=`${t.get(e)}${n}.`;t.set(i,a)}}else{e[n]=i}return true},get(e,n){if(n===q){return true}return e[n]}};return r}U.init=function(n){if(!sap.ui.require("sap/ui/core/Core")){throw new Error("Library "+n.name+": Library must not be used before the core is ready!")}e(typeof n==="object","mSettings given to 'sap/ui/core/Lib.init' must be an object");e(typeof n.name==="string"&&n.name,"mSettings given to 'sap/ui/core/Lib.init' must have the 'name' property set");var t="sap/ui/core/Lib.init";a.debug("Analyzing Library "+n.name,null,t);var r=U._get(n.name,true);r.enhanceSettings(n);var i=Object.create(null),s;i=d.create(n.name);let o=n.apiVersion;if(!o){o=1}const l=[1,2];if(!l.includes(o)){let e=`The library '${n.name}' has defined 'apiVersion: ${o}', which is an unsupported value. The supported values are: ${l.join(", ")}`;e+=" and undefined (defaults to 1).";throw new TypeError(e)}if(o<2){const e=I(n.name,i);i=new Proxy(i,e);d.set(n.name,i)}for(s=0;s<r.dependencies.length;s++){var c=r.dependencies[s];var f=U._get(c,true);a.debug("resolve Dependencies to "+c,null,t);if(!f.isSettingsEnhanced()){a.warning("Dependency from "+n.name+" to "+c+" has not been resolved by library itself",null,t);U._load({name:c},{sync:true})}}b.registerInterfaceTypes(r.interfaces);function p(e){const n=d.get(e);if(n instanceof b){return` to ensure that the type is defined. You can then access it by calling 'DataType.getType("${e}")'.`}else if(u(n)){return`. You can then reference this type via the library's module export.`}else{return`.`}}for(s=0;s<r.types.length;s++){if(!/^(any|boolean|float|int|string|object|void)$/.test(r.types[s])){const e=r.types[s];sap.ui.loader._.declareModule(e.replace(/\./g,"/")+".js",()=>`Importing the pseudo module '${e.replace(/\./g,"/")}' is deprecated.`+` To access the type '${e}', please import '${r.namespace}/library'`+p(e)+` For more information, see documentation under 'Best Practices for Loading Modules'.`);var h=e.substring(0,e.lastIndexOf("."));if(d.get(h)===undefined){d.create(h)}}}(()=>{var e=r.controls.concat(r.elements);for(s=0;s<e.length;s++){sap.ui.lazyRequire(e[s],"new extend getMetadata")}})();if(!r.noLibraryCSS){T({libName:r.name,version:r.version})}r.sName=r.name;r.aControls=r.controls;U.fireLibraryChanged({name:n.name,stereotype:"library",operation:"add",metadata:r});return i};function N(e){return e.map(function(e){return e.namespace+"/library"})}function D(e){var n=N(e);return new Promise(function(t,r){sap.ui.require(n,function(){t(e)},r)})}U.load=function(e){if(typeof e==="string"){e={name:e}}else{e=["name","url"].reduce(function(n,t){if(e&&e.hasOwnProperty(t)){n[t]=e[t]}return n},{})}return U._load(e).then(function(e){return e[0]})};U._load=function(e,n){n=n||{};if(!Array.isArray(e)){e=[e]}var t={};var r=[];e.forEach(function(e){if(typeof e==="object"){if(e.hasOwnProperty("url")||e.hasOwnProperty("json")){t[e.name]=e}r.push(e)}else{r.push({name:e})}});var i=U.getPreloadMode()==="sync"||U.getPreloadMode()==="async",s=!n.preloadOnly;if(!n.sync){r=k(m._getTransitiveDependencyForLibraries(r))}var o=r.map(function(e){var n=U._get(e.name,true);if(n._loadingStatus==null&&t[e.name]&&t[e.name].url){B(e.name,t[e.name].url)}return n});if(n.sync){if(i){o.forEach(function(e){var n={sync:true};if(t[e.name]&&t[e.name].hasOwnProperty("json")){n.json=t[e.name].json}e._preload(n)})}if(s){N(o).forEach(function(e,n){if(o[n].isSettingsEnhanced()){return}sap.ui.requireSync(e);if(!o[n].isSettingsEnhanced()){a.warning("library "+o[n].name+" didn't initialize itself");U.init({name:o[n].name})}})}return o}const u=i?Promise.all(o.map(function(e){const n={};if(t[e.name]&&t[e.name].hasOwnProperty("json")){n.json=t[e.name].json}return e._preload(n)})):Promise.resolve(o);return s?u.then(D):u};U.getResourceBundleFor=function(e,n){var t=U._get(e,true);return t.getResourceBundle(n)};U._registerElement=function(e){var n=e.getName(),t=e.getLibraryName()||"";if(!t&&!n.includes(".")){return}let r=U._get(t);const i=e.isA("sap.ui.core.Control")?"controls":"elements";if(!r){d.create(t);r=U._get(t,true)}if(r[i].indexOf(n)<0){r[i].push(n);a.debug("Class "+n+" registered for library "+t);U.fireLibraryChanged({name:n,stereotype:e.getStereotype(),operation:"add",metadata:e})}};var J=new v;U.attachLibraryChanged=function(e,n){J.attachEvent("LibraryChanged",e,n)};U.detachLibraryChanged=function(e,n){J.detachEvent("LibraryChanged",e,n)};U.fireLibraryChanged=function(e){J.fireEvent("LibraryChanged",e)};r._enrichBundleConfig=function(e){if(!e.terminologies||!e.enhanceWith){var n=U._getByBundleUrl(e.url);if(n){var r=n._getI18nSettings();if(r){var i=sap.ui.require.toUrl(n.namespace+"/");j._processResourceConfiguration(r,{alreadyResolvedOnRoot:true,relativeTo:i});e.fallbackLocale=e.fallbackLocale||r.fallbackLocale;e.supportedLocales=e.supportedLocales||r.supportedLocales;e.terminologies=e.terminologies||r.terminologies;e.enhanceWith=e.enhanceWith||r.enhanceWith;e.activeTerminologies=e.activeTerminologies||t.getActiveTerminologies()}}}return e};U.getVersionedLibCss=function(){return n.get({name:"sapUiVersionedLibCss",type:n.Type.Boolean,external:true})};U.isDepCacheEnabled=function(){return n.get({name:"sapUiXxDepCache",type:n.Type.Boolean,external:true})};U.getPreloadMode=function(){if(L.isDebugModeEnabled()===true){return""}let e=n.get({name:"sapUiPreload",type:n.Type.String,defaultValue:"auto",external:true});if(e==="auto"){if(window["sap-ui-optimized"]){e=sap.ui.loader.config().async?"async":"sync"}else{e=""}}return e};return U});
//# sourceMappingURL=Lib.js.map