/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/ovp/insights/helpers/i18n","sap/ovp/app/resources"],function(t,e){"use strict";function a(e,a,r,i){var n=e.data.request.batch&&e.data.request.batch.header;if(i&&i>0){var o="";if(a.valueSelectionInfo&&n||a.description){var s=t.createKeysFromText(r,a.valueSelectionInfo||a.description,"Label","card valueselection info","header.details");var l=s.isNew?s.text:s.key;var p=s.key;e.configuration.parameters._detailsString1={value:l};t.seti18nValueToMap("configuration.parameters._detailsString1.value",p,s.isNew);o="{{parameters._detailsString1}} | "}var d=t.createKeysFromText(r,a.tabs[i-1].value,"Label","card view switch text","header.details");var u=d.isNew?d.text:d.key;var c=d.key;e.configuration.parameters._detailsString2={value:u};t.seti18nValueToMap("configuration.parameters._detailsString2.value",c,d.isNew);o=o+"{{parameters._detailsString2}}";t.seti18nValueToMap("header.details",o,false);return o}if(a.valueSelectionInfo&&n||a.description){t.createKeysFromText(r,a.valueSelectionInfo||a.description,"Label","card valueselection info","header.details")}return n&&a.valueSelectionInfo?a.valueSelectionInfo:a.description}function r(t){var e={path:[]};if(t&&t.parts){for(var a=0;a<t.parts.length;a++){if(t.parts[a].path){e.path.push(t.parts[a].path)}else if(t.parts[a].model=="ovpCardProperties"){e.ovpProp=t.parts[a].value}}return e}}function i(t){var e=t.getBindingInfo?t.getBindingInfo("text").parts:"";var a=[];a[0]=e&&e.length?e[0].path:"";a[1]=e&&e.length>1?e[1].path:"";if(a.length){return a}else{return[]}}function n(t){if(t.cardComponentData.settings.dataPointAnnotationPath||t.cardComponentData.settings.kpiAnnotationPath){return"Numeric"}else if(t.cardComponentData.settings.tabs){return t.cardComponentData.settings.tabs[0].dataPointAnnotationPath||t.cardComponentData.settings.tabs[0].kpiAnnotationPath?"Numeric":"Default"}return"Default"}function o(a){var n=a.cardComponent.getRootControl();var o=n.byId("kpiNumberValue");if(o){var s=o.getBindingInfo?o.getBindingInfo("value"):"";var l=o.getBindingInfo?o.getBindingInfo("valueColor"):"";var p=o.getBindingInfo?o.getBindingInfo("indicator"):""}var d=n.byId("ovpTargetValue");var u=n.byId("kpiNumberPercentage");var c={path:[]};if(s&&s.parts){for(var g=0;g<s.parts.length;g++){if(s.parts[g].path){c.path.push(s.parts[g].path)}else if(s.parts[g].model=="ovpCardProperties"){c.ovpProp=s.parts[g].value}}c.valueColor=l?r(l):"";c.indicator=p?r(p):""}if(d){c.target={parts:[],text:e.getText("KPI_Target_Text")};c.target.parts=c.target.parts.concat(i(d));var f=a.cardComponentData.cardId+"_"+"KPI_Target_Text";t.seti18nValueToMap("header.sideIndicators.0.title","{{"+f+"}}",true);t.inserti18nPayLoad(a.cardComponentData.cardId,f,e.getText("KPI_Target_Text"),"Label","target Label")}if(u){c.deviation={parts:[],text:e.getText("KPI_Deviation_Text")};c.deviation.parts=c.deviation.parts.concat(i(u));var v=a.cardComponentData.cardId+"_"+"KPI_Deviation_Text";if(d){t.seti18nValueToMap("header.sideIndicators.1.title","{{"+v+"}}",true)}else{t.seti18nValueToMap("header.sideIndicators.0.title","{{"+v+"}}",true)}t.inserti18nPayLoad(a.cardComponentData.cardId,v,e.getText("KPI_Deviation_Text"),"Label","deviation label")}return c}function s(t,e,a){if(t.parts.length>1&&t.parts[1]){return"{= extension.formatters."+a+"(${"+t.parts[0]+"}, ${"+t.parts[1]+"},{NumberOfFractionalDigits:"+e.getProperty("/iNumberOfFractionalDigits")+", manifestTarget:"+e.getProperty("/sManifestTargetValue")+"})}"}return"{= extension.formatters."+a+"(${"+t.parts[0]+"},"+null+",{NumberOfFractionalDigits:"+e.getProperty("/iNumberOfFractionalDigits")+", manifestTarget:"+e.getProperty("/sManifestTargetValue")+"})}"}function l(t,e,a){var r="";r="{= extension.formatters.kpiformatter(${"+t[0]+"},{NumberOfFractionalDigits:"+e.NumberOfFractionalDigits+", percentageAvailable:"+e.percentageAvailable+"}";r+=a?","+a+")}":")}";return r}return{generateDetailsExpression:a,getHeaderDetails:n,mainIndicatorDetails:o,targetDeviationValuePath:s,mainIndicatorNumberPath:l}},true);
//# sourceMappingURL=CardHeader.js.map