/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/ovp/app/NavigationHelper","sap/ovp/cards/CommonUtils","sap/ovp/cards/NavigationHelper","sap/ovp/app/OVPLogger"],function(e,t,a,r){"use strict";var i=new r("OVP.insights.helpers.CardAction");return{getCardActions:function(r,n){var o={header:{enabled:false,actions:[]},content:{enabled:false,actions:[]}};var s=false,c=false;var m=r.view;var p=m.getController();var l=this.checkCustomNavigationForCard(r);if(r.cardComponentName==="Analytical"){c=!a.checkHeaderNavigationDisabledForAnalyticalCard(p.getCardPropertiesModel())}s=e.bCheckNavigationForCard(p);if(!s){return Promise.resolve(o)}var u=e.getNavigationParameters(p,r);return u.then(function(e){if(e===undefined){return o}if(r.cardComponentName==="List"||r.cardComponentName==="Table"){c=e["semanticObject"]&&e["action"]}var a={ibnTarget:{},ibnParams:{}};var i={type:"Navigation"};var s={type:"Navigation"};if(e&&e.type==="url"){a={type:"Navigation",parameters:{target:"_self"}};t.updatePropertyValueForObject(a.parameters,e.url,"url")}else{if(e.semanticObject||e.action||e.staticParams){a.ibnTarget={semanticObject:e.semanticObject,action:e.action};if(!n.configuration.parameters.state&&r.cardComponentName==="Analytical"){n.configuration.parameters.state={value:""}}var m=[];if(e.staticParams){if(e.staticParams.sNavPresentationVariant){a.ibnParams.presentationVariant=e.staticParams.sNavPresentationVariant}if(e.staticParams.sensitiveProperties){m=e.staticParams.sensitiveProperties}var p=e.staticParams.staticPropertyMap;var u=p&&Object.keys(p)||[];for(var v=0;v<u.length;v++){if(u[v]&&p[u[v]]&&!m.includes(u[v])){a.ibnParams[u[v]]=p[u[v]]}}}a.sensitiveProps=m}}o.content.enabled=true;o.content.actions.push(s);if(c){o.header.enabled=true;o.header.actions.push(i)}if(r.cardComponentName==="Analytical"){var g="{= extension.formatters.getNavigationContext(${parameters>/state/value})}";t.updatePropertyValueForObject(i,g,"parameters");if(!l){g="{= extension.formatters.getNavigationContext(${parameters>/state/value}, ${})}"}t.updatePropertyValueForObject(s,g,"parameters");n.configuration.parameters.state.value=JSON.stringify(a)}else{if(a.ibnTarget["semanticObject"]&&a.ibnTarget["action"]){t.updatePropertyValueForObject(i,"{= extension.formatters.getNavigationContext(${parameters>/headerState/value})}","parameters");n.configuration.parameters.headerState={value:""};n.configuration.parameters.headerState.value=JSON.stringify(a);e["lineItemSemanticObject"]=e["lineItemSemanticObject"]||a.ibnTarget["semanticObject"];e["lineItemAction"]=e["lineItemAction"]||a.ibnTarget["action"]}if(e["lineItemSemanticObject"]&&e["lineItemAction"]){a.ibnTarget["semanticObject"]=e["lineItemSemanticObject"];a.ibnTarget["action"]=e["lineItemAction"];var f="{= extension.formatters.getNavigationContext(${parameters>/lineItemState/value})}";if(!l){f="{= extension.formatters.getNavigationContext(${parameters>/lineItemState/value}, ${})}"}t.updatePropertyValueForObject(s,f,"parameters");n.configuration.parameters.lineItemState={value:""};n.configuration.parameters.lineItemState.value=JSON.stringify(a)}}return o}).catch(function(e){i.error(e)})},checkCustomNavigationForCard:function(e){var t=e&&e.cardComponentData.settings,a=t&&!!t.customParams,r=e&&e.view.getController(),i=r&&r.oCardComponentData&&r.oCardComponentData.mainComponent,n=i&&!!i.doCustomNavigation;return a||n},getOVPDefaultActions:function(e){var t={ibnTarget:{semanticObject:e.semanticObject,action:e.action},ibnParams:{},sensitiveProps:[]};return JSON.stringify(t)}}},true);
//# sourceMappingURL=CardAction.js.map