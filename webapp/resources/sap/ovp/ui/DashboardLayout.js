/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/ui/core/Control","sap/ui/thirdparty/jquery","sap/ui/Device","sap/ui/core/ResizeHandler","sap/ovp/app/resources","sap/ui/events/KeyCodes","sap/ui/events/F6Navigation","sap/ui/core/Component","sap/ui/core/Element","sap/base/i18n/Localization","sap/ui/dom/jquery/Selectors"],function(t,jQuery,a,e,s,o,r,i,n,l){"use strict";var d=t.extend("sap.ovp.ui.DashboardLayout",{metadata:{designTime:true,library:"sap.ovp",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"}},defaultAggregation:"content",events:{afterRendering:{},afterDragEnds:{}},properties:{dragAndDropRootSelector:{group:"Misc",type:"string"},dragAndDropEnabled:{group:"Misc",type:"boolean",defaultValue:true},debounceTime:{group:"Misc",type:"int",defaultValue:150}}},renderer:{apiVersion:2,render:function(t,e){var s=function(t){return t.getVisible()};var o=function(t){var a=this.getId();var e=a.indexOf("---")+3;var s=a.substring(e);return t.id===s.split("--")[1]};var r=e.$().width();var i=l.getRTL();var n=e.dashboardLayoutUtil.updateLayoutData(r?r:window.innerWidth);var d=e.dashboardLayoutUtil.getCards(n.colCount);var u=e.getContent().filter(s);t.openStart("div",e);t.class("sapUshellEasyScanLayout");t.class("sapOvpDashboard");if(!a.system.phone){t.class("sapOvpDashboardDragAndDrop")}if(i){t.style("margin-right",n.marginPx+"px")}else{t.style("margin-left",n.marginPx+"px")}t.openEnd();t.openStart("div");t.class("sapUshellEasyScanLayoutInner");t.accessibilityState(undefined,{role:"list"});t.attr("aria-label","Cards");if(d.length>0){t.attr("tabindex",0)}t.openEnd();if(d.length>0){var h={},c,p,y,f=e.getDashboardLayoutModel().getColCount();for(c=0,p=u.length;c<p;c++){var b=["easyScanLayoutItemWrapper","sapOvpDashboardLayoutItem"];h=d.filter(o.bind(u[c]))[0];e.dashboardLayoutUtil.setCardCssValues(h);y=h.dashboardLayout.column+h.dashboardLayout.colSpan===f+1;if(y){h.dashboardLayout.colSpan===1?b.push("sapOvpNotResizableLeftRight"):b.push("sapOvpNotResizableRight")}if(h.template==="sap.ovp.cards.stack"||h.settings.stopResizing||!a.system.desktop){b.push("sapOvpDashboardLayoutItemNoDragIcon")}t.openStart("div",e.dashboardLayoutUtil.getCardDomId(h.id));for(var g=0;g<b.length;g++){t.class(b[g])}var m="translate3d("+h.dashboardLayout.left+" ,"+h.dashboardLayout.top+" ,0px)";t.style("transform",m);t.style("-ms-transform",m);t.style("-moz-transform",m);t.style("-webkit-transform",m);t.style("height",h.dashboardLayout.height);t.style("width",h.dashboardLayout.width);t.attr("aria-setsize",p);t.attr("aria-posinset",c+1);t.attr("tabindex",0);t.accessibilityState(undefined,{role:"listitem"});t.openEnd();t.renderControl(u[c]);t.openStart("div").class("lastElement").accessibilityState(undefined,{role:"none"}).attr("tabindex",0).openEnd();t.close("div");t.close("div")}}t.close("div");t.openStart("div");t.class("after");if(d.length>0){t.attr("tabindex",0).accessibilityState(undefined,{role:"none"})}t.openEnd();t.close("div");t.close("div")}},init:function(){this.oColumnLayoutData={};this.resizeHandlerId=this.initResizeHandler();var t=i.getComponentById(this._sOwnerId);this.dashboardLayoutUtil=t.getDashboardLayoutUtil();this.dashboardLayoutUtil.setLayout(this);if(this.dashboardLayoutUtil.dashboardLayoutModel.getCards().length===0){this.data("sap-ui-fastnavgroup","false",false)}else{this.data("sap-ui-fastnavgroup","true",true)}},exit:function(){if(this.resizeHandlerId){e.deregister(this.resizeHandlerId)}if(this.layoutDragAndDrop){this.layoutDragAndDrop.destroy();delete this.layoutDragAndDrop}},onBeforeRendering:function(){},onAfterRendering:function(){this.keyboardNavigation=new u(this);if(!this.getDragAndDropRootSelector()){this.setDragAndDropRootSelector("#"+this.getId())}if(this.layoutDragAndDrop){this.layoutDragAndDrop.destroy()}if(this.getDragAndDropEnabled()){this.layoutDragAndDrop=this.dashboardLayoutUtil.getRearrange({rootSelector:this.getDragAndDropRootSelector(),layout:this});this.dashboardLayoutUtil.setAriaPos();this.fireAfterRendering()}},getLayoutDataJSON:function(){return this.dashboardLayoutUtil.getDashboardLayoutModel().getLayoutVariants4Pers()},filterVisibleCards:function(t){return t.getVisible()},getDashboardLayoutUtil:function(){return this.dashboardLayoutUtil},getDashboardLayoutModel:function(){return this.dashboardLayoutUtil.getDashboardLayoutModel()},getVisibleLayoutItems:function(){var t=this.getContent();var a=t.filter(this.filterVisibleCards);return a},initResizeHandler:function(){var t;var a=this.getDebounceTime();var s=function(e){window.clearTimeout(t);t=window.setTimeout(this.oControl.resizeHandler.bind(this,e),a)};return e.register(this,s)},resizeHandler:function(t){this.oControl.dashboardLayoutUtil.resizeLayout(t.size.width)},setActive:function(t){if(t){this.removeStyleClass("ovpOverlay")}else{this.addStyleClass("ovpOverlay")}},getActive:function(){return!this.hasStyleClass("ovpOverlay")}});var u=function(t){this.init(t)};u.prototype.init=function(t){this.sCurrentFocusId="";this.layoutUtil=t.getDashboardLayoutUtil();this.layoutModel=t.getDashboardLayoutModel();this.keyCodes=o;this.jqElement=t.$();this.bIgnoreSelfFocus=false;this.sLastFocusableCard=null;this.lastFocussedElement=null;var a=this;this.jqElement.on("keydown",function(t){a.keyDownHandler.call(a,t)});this.jqElement.on("keyup",function(t){a.keyUpHandler.call(a,t)});this.jqElement.find(".sapUshellEasyScanLayoutInner").on("focus.keyboardNavigation",function(t){a.layoutFocusHandler.call(a,t)});this.jqElement.on("focus.keyboardNavigation",".easyScanLayoutItemWrapper",this.layoutItemFocusHandler);var e=document.querySelectorAll(".ovpWrapper .sapFDynamicPageContent");var s=function(t){a.layoutClickHandler.call(a,t)};for(var r=0;r<e.length;r++){e[r].addEventListener("click",s)}this.jqElement.find(".after").on("focus.keyboardNavigation",function(t){a.afterFocusHandler.call(a,t)})};u.prototype.spacebarHandler=function(t){var a=n.getElementById(t.target.id);if(a&&a.mEventRegistry.hasOwnProperty("press")){var e="#"+t.target.id;var s=document.querySelectorAll(e);for(var o=0;o<s.length;o++){s[o].classList.add("sapMLIBActive")}a.firePress()}};u.prototype.layoutItemFocusHandler=function(){var t=jQuery(document.activeElement);if(t){var a,e="";if(t.find(".valueStateText").length==1){var o=t.find(".valueStateText").find(".sapMObjectNumberText").text();var r=t.find(".valueStateText").find(".sapUiInvisibleText").text();t.find(".valueStateText").attr("aria-label",o+" "+r);t.find(".valueStateText").attr("aria-labelledby","")}t.find("[role='listitem']").attr("aria-label","");if(t.hasClass("easyScanLayoutItemWrapper")){var i="";var n=t.find(".cardCount");if(n.length===0){i="countDiv_"+(new Date).getTime();var l='<div id="'+i+'" class="cardCount"'+'" hidden></div>';t.append(l)}else{i=n[0].id}e+=i+" ";var d=t.find(".cardType");if(d.length!==0){e+=d[0].id+" "}}var u="cardHeaderType_";if(t.hasClass("sapOvpCardHeader")&&!t.hasClass("sapOvpStackCardContent")){var h="";var c=t.find(".cardHeaderType");if(c.length===0){var p=s.getText("CardHeaderType");h=u+(new Date).getTime();var y='<div id="'+h+'" class="cardHeaderType" aria-label="'+p+'" hidden></div>';t.append(y)}else{h=c[0].id}e+=h+" "}var f,b;if(t.hasClass("easyScanLayoutItemWrapper")){b=t.find(".sapOvpCardHeader");f=b.find("[aria-label]")}else{f=t.find("[aria-label]")}var g=t.find(".sapOvpStackCardHeader").length!==1;if(g){var m=[u,"sapOvpCardAdditionalActions","listItem","linkListItem"];var v=function(t){return!m.some(function(a){return t.includes(a)})};for(a=0;a<f.length;a++){var C=f[a].id;var L=C&&v(C);if(L){e+=C+" "}}}if(t.hasClass("sapOvpCardHeader")){var S=t.find(".cardHeaderText");if(S.length!==0){for(var a=0;a<S.length;a++){if(e.indexOf(S[a].id)===-1){e+=S[a].id+" "}}}}if(e.length){t.attr("aria-labelledby",e)}if(t.prop("nodeName")==="LI"&&t.find(".linkListHasPopover").length!==0){if(t.find("#hasDetails").length===0){t.append("<div id='hasDetails' hidden>"+s.getText("HAS_DETAILS")+"</div>");t.attr("aria-describedby","hasDetails")}}var I=t.attr("id");if(I&&I.indexOf("ovpTable")!=-1&&t.find("[role='Link']")&&!t.hasClass("sapUiCompSmartLink")){var E=t.closest("td").attr("data-sap-ui-column"),F=t.closest("tbody").siblings().children().filter("tr").children();for(var a=0;a<F.length;a++){if(F[a].getAttribute("data-sap-ui")==E&&F[a].hasChildNodes("span")){var D=F[a].firstElementChild.getAttribute("id");t.attr("aria-labelledby",D)}}}}};u.prototype.layoutFocusHandler=function(t){t.stopImmediatePropagation();if(jQuery(t.relatedTarget).hasClass("easyScanLayoutItemWrapper")){return}if(this.sLastFocusableCard){this.sLastFocusableCard=jQuery(this.sLastFocusableCard);if(!this.sLastFocusableCard.is(this.lastFocussedElement)&&t.relatedTarget){this.sLastFocusableCard.focus();this.layoutUtil.sLastFocusableCard=this.sLastFocusableCard}else{this.lastFocussedElement=undefined}return}this.jqElement.find(".easyScanLayoutItemWrapper").first().focus();this.sLastFocusableCard=this.jqElement.find(".easyScanLayoutItemWrapper").first();this.layoutUtil.sLastFocusableCard=this.sLastFocusableCard};u.prototype.layoutClickHandler=function(t){if(t&&t.target&&t.target.getAttribute("id")&&t.target.getAttribute("id").indexOf("mainView")!==-1){if(this.sLastFocusableCard){this.sLastFocusableCard.focus();this.layoutUtil.sLastFocusableCard=this.sLastFocusableCard;return}this.jqElement.find(".easyScanLayoutItemWrapper").first().focus();this.sLastFocusableCard=this.jqElement.find(".easyScanLayoutItemWrapper").first();this.layoutUtil.sLastFocusableCard=this.sLastFocusableCard}};u.prototype.ctrlArrowHandler=function(t,a){var e=this.layoutUtil.dashboardLayoutModel.getCardById(a),s=t.dashboardLayout.row,o=e.dashboardLayout.row,r=e.dashboardLayout.column,i=[],n;if(o>s&&e.dashboardLayout.rowSpan>=t.dashboardLayout.rowSpan){n=s+e.dashboardLayout.rowSpan}else{n=o}this.layoutUtil.dashboardLayoutModel._arrangeCards(t,{row:n,column:r},"drag",i);this.layoutUtil.dashboardLayoutModel._removeSpaceBeforeCard(i);this.layoutUtil._positionCards(this.layoutModel.aCards);this.layoutUtil.oLayoutCtrl.fireAfterDragEnds({positionChanges:i})};u.prototype.shiftArrowHandler=function(t,a,e){if(t.template==="sap.ovp.cards.stack"){return}this.resizeStartHandler(t,e);var s=this.layoutUtil.calculateCardProperties(t.id),o=s.leastHeight+2*this.layoutUtil.CARD_BORDER_PX,r=Math.ceil(o/this.layoutUtil.getRowHeightPx());if(a.rowSpan<=r){a.rowSpan=r;a.showOnlyHeader=true;e.classList.add("sapOvpMinHeightContainer")}else{a.showOnlyHeader=false;e.classList.remove("sapOvpMinHeightContainer")}var i=this.layoutUtil.dashboardLayoutModel.resizeCard(t.id,a,true,this.layoutUtil.dragOrResizeChanges);this.resizeStopHandler(i.resizeCard,e)};u.prototype.resizeStartHandler=function(t,a){this.layoutUtil.dragOrResizeChanges=[];this.layoutUtil.resizeStartCard={cardId:t.id,rowSpan:t.dashboardLayout.rowSpan,colSpan:t.dashboardLayout.colSpan,maxColSpan:t.dashboardLayout.maxColSpan,noOfItems:t.dashboardLayout.noOfItems,autoSpan:t.dashboardLayout.autoSpan,showOnlyHeader:t.dashboardLayout.showOnlyHeader};a.classList.add("sapOvpCardResize");t.dashboardLayout.autoSpan=false};u.prototype.resizeStopHandler=function(t,a){a.classList.remove("sapOvpCardResize");a.style.zIndex="auto";this.layoutUtil._sizeCard(t);this.layoutUtil._positionCards(this.layoutModel.aCards);t.dashboardLayout.maxColSpan=t.dashboardLayout.colSpan;this.layoutUtil.dragOrResizeChanges.push({changeType:"dragOrResize",content:{cardId:t.id,dashboardLayout:{rowSpan:t.dashboardLayout.rowSpan,oldRowSpan:this.layoutUtil.resizeStartCard.rowSpan,colSpan:t.dashboardLayout.colSpan,oldColSpan:this.layoutUtil.resizeStartCard.colSpan,maxColSpan:t.dashboardLayout.maxColSpan,oldMaxColSpan:this.layoutUtil.resizeStartCard.maxColSpan,noOfItems:t.dashboardLayout.noOfItems,oldNoOfItems:this.layoutUtil.resizeStartCard.noOfItems,autoSpan:t.dashboardLayout.autoSpan,oldAutoSpan:this.layoutUtil.resizeStartCard.autoSpan,showOnlyHeader:t.dashboardLayout.showOnlyHeader,oldShowOnlyHeader:this.layoutUtil.resizeStartCard.showOnlyHeader}},isUserDependent:true});this.layoutUtil.getDashboardLayoutModel().extractCurrentLayoutVariant();this.layoutUtil.oLayoutCtrl.fireAfterDragEnds({positionChanges:this.layoutUtil.dragOrResizeChanges})};u.prototype.keyUpHandler=function(t){switch(t.keyCode){case this.keyCodes.SPACE:this.spacebarHandler(t);break;case this.keyCodes.F6:if(t.shiftKey){var a=document.getElementsByClassName("sapUshellEasyScanLayoutInner");if(a[0].firstElementChild){document.getElementById(a[0].firstElementChild.id).focus()}this.handleScrollBar(true)}break;default:break}};u.prototype.keyDownHandler=function(t){var a=document.activeElement,e=this.layoutUtil.getCardId(a.id),s=Object.assign([],this.layoutModel.aCards),o=this.layoutModel.getCardById(e),i=this.layoutModel.iColCount,n={},d,u,h,c,p,y,f,b,g=l.getRTL(),m=jQuery(document.activeElement);this.layoutModel._sortCardsByRow(s);for(var v=1;v<=i;v++){n[v]=[]}for(var C=0;C<s.length;C++){d=s[C].dashboardLayout.column;u=s[C].dashboardLayout.colSpan;if(u===1){n[d].push(s[C])}else{for(var L=d;L<d+u;L++){n[L].push(s[C])}}}if(o){c=this.getCardPosition(e,n[o.dashboardLayout.column])}if(this.layoutUtil.getCards().length===0){this.sLastFocusableCard=null}switch(t.keyCode){case this.keyCodes.TAB:if(t.shiftKey){this.shiftTabButtonHandler(t)}else{this.tabButtonHandler(t)}break;case this.keyCodes.F6:t.stopImmediatePropagation();if(t.shiftKey){this.bIgnoreSelfFocus=true;this.jqElement.find(".sapUshellEasyScanLayoutInner").focus();r.handleF6GroupNavigation(t);var S=document.activeElement;this.sCurrentFocusId=S.id;if(this.sCurrentFocusId){document.getElementById(this.sCurrentFocusId).focus()}}else{this.bIgnoreSelfFocus=true;var I=this.jqElement.scrollTop();this.jqElement.find(".after").focus();r.handleF6GroupNavigation(t);this.jqElement.scrollTop(I);var E=document.getElementById("shell-header")&&document.getElementById("shell-header").firstChild;var F=E&&E.firstChild;if(F&&F.tabIndex===0){document.getElementById(F.id).focus()}this.handleScrollBar(true)}break;case this.keyCodes.F7:t.preventDefault();if(m.hasClass("easyScanLayoutItemWrapper")){m.find(":sapTabbable").first().focus()}else{m.closest(".easyScanLayoutItemWrapper").focus()}break;case this.keyCodes.ARROW_UP:t.preventDefault();h=o.dashboardLayout.column;c--;p=n[h][c]&&n[h][c].id;if(p&&t.ctrlKey){this.ctrlArrowHandler(o,p);this.setFocusOnCard(e)}else if(t.shiftKey){b={rowSpan:o.dashboardLayout.rowSpan-3,colSpan:o.dashboardLayout.colSpan};this.shiftArrowHandler(o,b,t.target);this.setFocusOnCard(e)}else if(m&&m.hasClass("easyScanLayoutItemWrapper")){this.setFocusOnCard(p);this.handleScrollBar(false)}break;case this.keyCodes.ARROW_DOWN:t.preventDefault();h=o.dashboardLayout.column;c++;p=n[h][c]&&n[h][c].id;if(p&&t.ctrlKey){this.ctrlArrowHandler(o,p);this.setFocusOnCard(e)}else if(t.shiftKey){if((o.template==="sap.ovp.cards.linklist"||o.template==="sap.ovp.cards.v4.linklist")&&o.settings.listFlavor==="carousel"&&o.dashboardLayout.rowSpan>=45){return}b={rowSpan:o.dashboardLayout.rowSpan+3,colSpan:o.dashboardLayout.colSpan};this.shiftArrowHandler(o,b,t.target);this.setFocusOnCard(e)}else{this.setFocusOnCard(p)}break;case this.keyCodes.ARROW_LEFT:var D=jQuery(document.activeElement);if(!D.hasClass("easyScanLayoutItemWrapper")){return}t.preventDefault();h=o.dashboardLayout.column;h--;if(!n[h]||!n[h][c]){do{if(h===0){h=i;c--;break}if(c<0){break}h--}while(!n[h]||!n[h][c])}p=n[h][c]&&n[h][c].id;if(p&&t.ctrlKey){this.ctrlArrowHandler(o,p);this.setFocusOnCard(e)}else if(t.shiftKey){if(g){if(o.template==="sap.ovp.cards.list"&&o.dashboardLayout.colSpan===2||(o.template==="sap.ovp.cards.linklist"||o.template==="sap.ovp.cards.v4.linklist")&&o.settings.listFlavor==="carousel"&&o.dashboardLayout.colSpan===3){return}b={rowSpan:o.dashboardLayout.rowSpan,colSpan:o.dashboardLayout.colSpan+1}}else{if(o.dashboardLayout.colSpan===1){return}b={rowSpan:o.dashboardLayout.rowSpan,colSpan:o.dashboardLayout.colSpan-1}}this.shiftArrowHandler(o,b,t.target);this.setFocusOnCard(e)}else{this.setFocusInCaseOfSpace(o,"Left");t.stopImmediatePropagation()}break;case this.keyCodes.ARROW_RIGHT:t.preventDefault();h=o.dashboardLayout.column+o.dashboardLayout.colSpan;if(!n[h]||!n[h][c]){do{if(h>i){h=1;c++;break}h++}while(!n[h]||!n[h][c])}p=n[h][c]&&n[h][c].id;if(p&&t.ctrlKey){this.ctrlArrowHandler(o,p);this.setFocusOnCard(e)}else if(t.shiftKey){if(g){if(o.dashboardLayout.colSpan===1){return}b={rowSpan:o.dashboardLayout.rowSpan,colSpan:o.dashboardLayout.colSpan-1}}else{if(o.template==="sap.ovp.cards.list"&&o.dashboardLayout.colSpan===2||(o.template==="sap.ovp.cards.linklist"||o.template==="sap.ovp.cards.v4.linklist")&&o.settings.listFlavor==="carousel"&&o.dashboardLayout.colSpan===3){return}b={rowSpan:o.dashboardLayout.rowSpan,colSpan:o.dashboardLayout.colSpan+1}}this.shiftArrowHandler(o,b,t.target);this.setFocusOnCard(e)}else{this.setFocusInCaseOfSpace(o,"Right");t.stopImmediatePropagation()}break;case this.keyCodes.PAGE_UP:t.preventDefault();h=o.dashboardLayout.column;if(t.altKey==true){h===1?c=0:h=1;p=n[h][c]&&n[h][c].id}else{y=n[h].length-1;for(var v=y;v>0;v--){f=document.getElementById(this.layoutUtil.getCardDomId(n[h][v].id));if(f.getBoundingClientRect().bottom<0){p=n[h][v].id;break}}if(!p){p=n[h][0].id}}this.setFocusOnCard(p);break;case this.keyCodes.PAGE_DOWN:t.preventDefault();h=o.dashboardLayout.column;if(t.altKey==true){p=h+o.dashboardLayout.colSpan>i?s[s.length-1].id:n[i][c]&&n[i][c].id}else{var O=jQuery(window).height();y=n[h].length;for(var v=0;v<y;v++){f=document.getElementById(this.layoutUtil.getCardDomId(n[h][v].id));if(f.getBoundingClientRect().top>O){p=n[h][v].id;break}}if(!p){p=n[h][y-1].id}}this.setFocusOnCard(p);break;case this.keyCodes.HOME:t.preventDefault();h=o.dashboardLayout.column;if(t.ctrlKey==true){c===0?h=1:c=0}else{h===1?c=0:h=1}p=n[h][c]&&n[h][c].id;this.setFocusOnCard(p);break;case this.keyCodes.END:t.preventDefault();h=o.dashboardLayout.column;if(t.ctrlKey==true){var w=n[h].length-1;p=w===c?s[s.length-1].id:n[h][w]&&n[h][w].id}else{p=h+o.dashboardLayout.colSpan>i?s[s.length-1].id:n[i][c]&&n[i][c].id}this.setFocusOnCard(p);break;case this.keyCodes.ENTER:t.stopImmediatePropagation();this.spacebarHandler(t);break;default:break}};u.prototype.handleScrollBar=function(t){var a=this.layoutUtil.componentDomId+"--ovpMain";if(a){var e=n.getElementById(a);if(e){setTimeout(function(){var a=e.getScrollDelegate();if(a){var s=a.getScrollTop();var o=document.activeElement.getBoundingClientRect().top;var r=t?0:s-o-32;a.scrollTo(0,r)}},0)}}};u.prototype.setFocusInCaseOfSpace=function(t,a){var e=Object.assign([],this.layoutModel.aCards),s=this.layoutUtil.ariaPos,o=s[t.id],r=e.filter(function(t){return a==="Right"?s[t.id]===o+1:s[t.id]===o-1},s);this.setFocusOnCard(r[0]&&r[0].id)};u.prototype.setFocusOnCard=function(t){if(t){var a=document.getElementById(this.layoutUtil.getCardDomId(t));a&&a.focus();this.sLastFocusableCard=a;this.layoutUtil.sLastFocusableCard=this.sLastFocusableCard}};u.prototype.getCardPosition=function(t,a){for(var e=0;e<a.length;e++){if(a[e].id===t){break}}return e};u.prototype.tabButtonHandler=function(t){var a=jQuery(document.activeElement);this.lastFocussedElement=a;if(a.hasClass("easyScanLayoutItemWrapper")){return}var e=a.closest(".easyScanLayoutItemWrapper");if(!e.length){return}var s=e.find(jQuery(".lastElement"));if(a.is(s)){t.stopPropagation();t.stopImmediatePropagation();var o=this.jqElement.scrollTop();this._ignoreSelfFocus=true;this.jqElement.find(".after").focus();this.jqElement.scrollTop(o)}};u.prototype.shiftTabButtonHandler=function(t){var a=jQuery(document.activeElement);if(a.hasClass("after")&&this.lastFocussedElement){this.lastFocussedElement.focus();return}if(!a.hasClass("easyScanLayoutItemWrapper")){return}this._ignoreSelfFocus=true;this.lastFocussedElement=a;this.jqElement.find(".sapUshellEasyScanLayoutInner").focus()};u.prototype.afterFocusHandler=function(t){t.stopImmediatePropagation();if(this._ignoreSelfFocus){this._ignoreSelfFocus=false;return}var a,e;if(this.lastFocussedElement&&this.lastFocussedElement.hasClass("lastElement")){a=this.jqElement.find(this.lastFocussedElement.parent());e=a.find(":sapTabbable").last()}else if(this.lastFocussedElement&&this.lastFocussedElement.hasClass("easyScanLayoutItemWrapper")){e=this.lastFocussedElement}else{a=this.jqElement.find(".easyScanLayoutItemWrapper:sapTabbable").first();e=a.find(":sapTabbable").last()}if(!e.length){e=a}e.focus()};return d});
//# sourceMappingURL=DashboardLayout.js.map