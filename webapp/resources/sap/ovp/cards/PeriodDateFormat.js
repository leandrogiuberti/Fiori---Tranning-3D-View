/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/base/i18n/Formatting","sap/ui/base/Object","sap/ui/core/Locale","sap/ui/core/LocaleData"],function(e,t,a,r){"use strict";var o=t.extend("sap.ovp.cards.PeriodDateFormat",{metadata:{library:"sap.ovp"},constructor:function(o,s){t.call(this,o,s);var i,n,f,p,l=new a(e.getLanguageTag()),u=r.getInstance(l),m=e.getCustomLocaleData(),h=/(m|y)(?:.*)(\W)(m|y)/i,y=m["dateFormats-short"];this.oFormatOptions=s;if(this.oFormatOptions.format.length>4){i="yM"}else if(this.oFormatOptions.format==="PPP"){i="M"}else{i=this.oFormatOptions.format}if(y&&i==="yM"){p=y.match(h).splice(1).join("");if(p){n=p}}else{n=u.getCustomDateTimePattern(i,this.oFormatOptions.calendarType)}n=n.replace(/([\u4e00-\u9faf\u3000-\u303f\u3040-\u309f\u30a0-\u30ff\uff00-\uffef])+/gi,"");if(this.oFormatOptions.format.length>4){n=n.replace(/y+/i,this.oFormatOptions.format.slice(0,this.oFormatOptions.format.lastIndexOf("Y")+1));n=n.replace(/m+/i,this.oFormatOptions.format.slice(this.oFormatOptions.format.lastIndexOf("Y")+1))}else if(this.oFormatOptions.format==="PPP"){n="PPP"}f=this.parseCldrDatePattern(n);this.oFormatOptions.pattern=f.length>1?n:"";this._setFormatRegex(f);this._setParseRegex(f);this._setValidationRegex(f)}});o.prototype._setFormatRegex=function(e){var t=[],a=[],r,o,s,i=false,f;for(f=0;f<e.length;f++){r=e[f];o=r.symbol||"";s=n[o].format;if(o===""){a[f]=r.value}else if(o==="y"||o==="Y"){t.unshift("("+s.source+")");a[f]="$"+1}else{t.push("("+s.source+")");for(var p=0;p<e.length;p++){if(e[p].symbol==="y"||e[p].symbol==="Y"){i=true}}a[f]=i?"$"+2:"$"+1}}this.sFormatRegExPattern=new RegExp(t.join(""));this.sFormatRegExGroups=a.join("")};o.prototype._setParseRegex=function(e){var t,a,r,o,s,i=[],p={},l=0;for(o=0;o<e.length;o++){t=e[o];a=t.symbol||"";r=n[a].parse;if(a===""){i.push("\\D+?")}else{i.push("("+r.source+")");s=++l;p[s]=t}}this.sParseRegExPattern=new RegExp("^"+i.join("")+"$");this.fnParseRegExReplacer=function(){var e,t,a=[];for(var r in p){e=p[r];t=arguments[r];if(t.length<e.digits){if(e.symbol==="y"||e.symbol==="Y"){t=f(t)}else{t=t.padStart(e.digits,"0")}}if(e.symbol==="y"||e.symbol==="Y"){a.unshift(t)}else{a.push(t)}}return a.join("")}};o.prototype._setValidationRegex=function(e){var t,a,r,o,s=[];for(t=0;t<e.length;t++){a=e[t];r=a.symbol||"";o=n[r].format;if(r===""){continue}else if(r==="y"||r==="Y"){s.unshift(o.source)}else{s.push(o.source)}}this.sValidationRegExPattern=new RegExp("^("+s.join(")(")+")$")};o.prototype.parseCldrDatePattern=function(e){var t,a,r,o,s=[];for(t=0;t<e.length;t++){a=e[t];if(r!==a){o={}}else{o.digits+=1;continue}if(typeof n[a]==="undefined"){o.value=a;o.type="text"}else{o.symbol=a;o.digits=1}r=a;s.push(o)}return s};o.prototype.getPattern=function(){return this.oFormatOptions.pattern};var s={year:/[1-9][0-9]{3}/,period:/[0-9]{3}/,quarter:/[1-4]/,week:/0[1-9]|[1-4][0-9]|5[0-3]/,day:/371|370|3[0-6][0-9]|[1-2][0-9][0-9]|[1-9][0-9]|[1-9]/};var i={year:/[0-9]{1,4}/,period:/[0-9]{1,3}/,quarter:/[1-4]/,week:/[0-9]{1,2}/,day:/[1-9]/};var n={"":"",y:{format:s.year,parse:i.year},Y:{format:s.year,parse:i.year},P:{format:s.period,parse:i.period},W:{format:s.week,parse:i.week},d:{format:s.day,parse:i.day},Q:{format:s.quarter,parse:i.quarter},q:{format:s.quarter,parse:i.quarter}};function f(e){var t,a=Number.parseInt(e),r=(new Date).getUTCFullYear(),o=Math.floor(r/100);t=o*100+a-r;if(e.length===3){a+=Math.floor((o-1)/10)*1e3}else if(t<-70){a+=(o+1)*100}else if(t<30){a+=o*100}else{a+=(o-1)*100}return a}return o});
//# sourceMappingURL=PeriodDateFormat.js.map