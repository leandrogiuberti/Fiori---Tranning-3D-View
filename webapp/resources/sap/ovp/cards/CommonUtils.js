/*!
 * Copyright (c) 2009-2014 SAP SE, All Rights Reserved
 */
sap.ui.define(["sap/ovp/cards/OVPCardAsAPIUtils","sap/ui/Device","sap/base/util/each","sap/ui/model/json/JSONModel","sap/ovp/app/OVPLogger"],function(e,t,r,n,a){"use strict";var i=new a("OVP.cards.CommonUtils");return{app:undefined,mUpdatedCardTitle:{},navigationHandler:undefined,supportedCardTypes:["sap.ovp.cards.list","sap.ovp.cards.table","sap.ovp.cards.stack","sap.ovp.cards.linklist","sap.ovp.cards.v4.list","sap.ovp.cards.v4.table","sap.ovp.cards.v4.linklist","sap.ovp.cards.charts.analytical","sap.ovp.cards.charts.smart.chart","sap.ovp.cards.charts.bubble","sap.ovp.cards.charts.donut","sap.ovp.cards.charts.line"],ovpConstantModel:new n({dontIncludeUOM:true,firstDataPointIndex:0,secondDataPointIndex:1,thirdDataPointIndex:2,fourthDataPointIndex:3,fifthDataPointIndex:4,sixthDataPointIndex:5,firstDataFieldIndex:0,secondDataFieldIndex:1,thirdDataFieldIndex:2,fourthDataFieldIndex:3,fifthDataFieldIndex:4,sixthDataFieldIndex:5}),deviceModel:new n(t).setDefaultBindingMode("OneWay"),checkIfCardTypeSupported:function(e){return this.supportedCardTypes.indexOf(e)!==-1},enable:function(e,t){this.app=e;this.navigationHandler=t},getApp:function(){return this.app},getCustomCards:function(e){var t=[];if(e){t=e.filter(function(e){return!e.template.startsWith("sap.ovp.cards")})}return t},getNavigationHandler:function(){return this.navigationHandler},createKeyForCB:function(e,t){return e.indexOf(t)+1},createCardComponent:function(t,r,n,a,i){return e.createCardComponent(t,r,n,a,i)},_getLayer:function(){var e=new URL(window.location.href).searchParams;return e.get("sap-ui-layer")},getQueryParameterValue:function(e){var t=new URL(window.location.href).searchParams;return t.get(e)},_getLayerNamespace:function(){var e=this._getLayer();if(!e){return"customer"}return e.toLowerCase()},getUnitColumn:function(e,t,r){var n,a=t.property;var i,s;var o="Org.OData.Measures.V1.ISOCurrency";var u="Org.OData.Measures.V1.Unit";for(var c=0,l=a.length;c<l;c++){if(a[c].name!==e){continue}if(a[c].hasOwnProperty(o)){i=a[c][o].Path;s=a[c][o].String;if(i){return i}else{return r?s:""}}if(a[c].hasOwnProperty(u)){i=a[c].hasOwnProperty(u).Path;s=a[c][u].String;if(i){n=i}else{n=r?s:""}if(n&&n!="%"){return n}else{return null}}if(a[c].hasOwnProperty("sap:unit")){return a[c]["sap:unit"]}break}return null},getUnitColumnForODataV4:function(e,t,r,n){var a,i,s;var o="@Org.OData.Measures.V1.ISOCurrency";var u="@Org.OData.Measures.V1.Unit";var c=t.getObject("/"+r+"/"+e+"@");if(c&&c[o]){i=c[o].$Path;s=c[o].$String;if(i){return i}else{return n?s:""}}if(c&&c[u]){i=c[u].$Path;s=c[u].$String;if(i){a=i}else{a=n?s:""}if(a&&a!="%"){return a}else{return null}}return null},onHeaderClicked:function(){},onContentClicked:function(e){},getContentDensityClass:function(){if(this._sContentDensityClass===undefined){if(document.body.classList.contains("sapUiSizeCozy")||document.body.classList.contains("sapUiSizeCompact")){if(document.body.classList.contains("sapUiSizeCozy")===true){this._sContentDensityClass="sapUiSizeCozy"}else if(document.body.classList.contains("sapUiSizeCompact")===true){this._sContentDensityClass="sapUiSizeCompact"}else{this._sContentDensityClass=""}}else if(!t.support.touch){this._sContentDensityClass="sapUiSizeCompact"}else{this._sContentDensityClass="sapUiSizeCozy"}}return this._sContentDensityClass},_setCardpropertyDensityAttribute:function(){var e=this.getContentDensityClass();if(e==="sapUiSizeCompact"){return"compact"}else if(e==="sapUiSizeCozy"){return"cozy"}else if(!t.support.touch){return"compact"}else{return"cozy"}},getPixelPerRem:function(){var e=parseFloat(getComputedStyle(document.documentElement).fontSize);return e},showODataErrorMessages:function(e){var t=[],n,a,s="";if(e&&e.responseText){var o=e.responseText;if(o){try{a=JSON.parse(o)}catch(e){i.error("Failed parsing response as JSON: "+o)}if(a&&a.error){n=a.error}}}if(n&&n.innererror&&n.innererror.errordetails){t=n.innererror.errordetails}if(n&&n.message&&Array.isArray(t)){t.unshift({message:n.message.value,severity:"error"})}if(t&&t.length>0){var u={};r(t,function(e,t){var r=t.message;if(r.endsWith(".")){r=r.substr(0,r.length-1)}if(!u[r]){u[r]=true;s=s+r+" "}})}return s},isODataV4:function(e){return e&&e.getODataVersion&&e.getODataVersion()=="4.0"||false},isJSONData:function(e){try{if(JSON.parse(e)){return true}}catch(e){return false}},isDate:function(e){if((e["type"]==="Edm.DateTime"&&e["sap:display-format"]==="Date"||e["type"]==="Edm.String"&&e["com.sap.vocabularies.Common.v1.IsCalendarDate"]&&e["com.sap.vocabularies.Common.v1.IsCalendarDate"].Bool==="true")&&(e["sap:filter-restriction"]==="interval"||e["sap:filter-restriction"]==="single-value"||e["_filterRestriction"]==="single-value")){return true}return false},updatePropertyValueForObject:function(e,t,r){if(e&&t&&r){if(r==="unitOfMeasurement"){e["unitOfMeasurement"]="{"+t+"}"}else if(Array.isArray(t)&&t.length){e[r]=t}else if(!Array.isArray(t)){e[r]=t}}},removePrefixAndReturnLocalId:function(e){if(e.indexOf("---")>-1){return e.split("---")[1]}return e},getCurrentAppIntent:function(){var e=this.getUshellContainer();if(e){return e.getServiceAsync("AppLifeCycle").then(function(e){return e.getCurrentApplication()}).then(function(e){return e.getIntent()}).catch(function(e){i.error(e);return Promise.reject(e)})}},getUshellContainer:function(){return sap.ui.require("sap/ushell/Container")},updateCardTitle:function(e,t){this.mUpdatedCardTitle[t]={title:e}},getUpdatedTitle:function(e){return this.mUpdatedCardTitle[e]&&this.mUpdatedCardTitle[e].title}}},true);
//# sourceMappingURL=CommonUtils.js.map