/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["./library","sap/ui/core/Control","sap/suite/ui/microchart/RadialMicroChartRenderer","sap/ui/core/ResizeHandler","sap/base/Log","sap/ui/events/KeyCodes","sap/suite/ui/microchart/MicroChartUtils","./RadialMicroChartRenderer","sap/ui/core/Core","sap/ui/core/Theming","sap/m/library"],function(e,t,i,r,s,a,o,n,u,l,p){"use strict";const h=e.MicroChartColorType;const c=p.ValueCSSColor;var d=t.extend("sap.suite.ui.microchart.RadialMicroChart",{constructor:function(e,i){var r;if(i&&typeof i.percentage==="number"){r=true}else if(e&&typeof e.percentage==="number"){r=true}else{r=false}try{t.apply(this,arguments);this._bPercentageMode=r}catch(e){this.destroy();throw e}},metadata:{library:"sap.suite.ui.microchart",properties:{total:{group:"Data",type:"float"},fraction:{group:"Data",type:"float",defaultValue:null},percentage:{group:"Data",type:"float",defaultValue:null},valueColor:{group:"Appearance",type:"string",defaultValue:h.Neutral},size:{group:"Misc",type:"sap.m.Size",defaultValue:"Auto"},width:{group:"Misc",type:"sap.ui.core.CSSSize"},height:{group:"Misc",type:"sap.ui.core.CSSSize"},alignContent:{group:"Misc",type:"sap.suite.ui.microchart.HorizontalAlignmentType",defaultValue:"Left"},hideOnNoData:{type:"boolean",group:"Appearance",defaultValue:false},showPercentageSymbol:{type:"boolean",group:"Appearance",defaultValue:true}},associations:{ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"}},events:{press:{}}},renderer:n});d.THRESHOLD_LOOK_XS=1.125;d.THRESHOLD_LOOK_S=3.5;d.THRESHOLD_LOOK_M=4.5;d.THRESHOLD_LOOK_L=5.875;d.THRESHOLD_WIDTH_NO_LABEL=6;d.prototype.init=function(){this._oRb=u.getLibraryResourceBundle("sap.suite.ui.microchart");this.setAggregation("tooltip","((AltText))",true);this._bThemeApplied=false;u.ready(this._handleCoreInitialized.bind(this))};d.prototype._handleCoreInitialized=function(){l.attachApplied(this._handleThemeApplied.bind(this))};d.prototype._handleThemeApplied=function(){this._bThemeApplied=true;this.invalidate();l.detachApplied(this._handleThemeApplied.bind(this))};d.prototype.onBeforeRendering=function(){if(!this._getPercentageMode()){if(this.getTotal()===0){s.info("Total cannot be 0. Please add a valid total value.")}else{this.setProperty("percentage",Math.round(this.getFraction()*100/this.getTotal()*10)/10,true)}}this._unbindMouseEnterLeaveHandler()};d.prototype.onAfterRendering=function(){this._bindMouseEnterLeaveHandler();this._sResizeHandlerId=r.register(this,this._onResize.bind(this));this._onResize()};d.prototype.ontouchstart=function(e){if(this.hasListeners("press")===true){e.setMarked()}};d.prototype.ontap=function(e){if(this.hasListeners("press")===true){e.setMarked()}this.firePress()};d.prototype.onkeydown=function(e){if(e.which===a.SPACE){if(this.hasListeners("press")===true){e.setMarked()}e.preventDefault()}};d.prototype.onkeyup=function(e){if(e.which===a.ENTER||e.which===a.SPACE){if(this.hasListeners("press")===true){e.setMarked()}this.firePress();e.preventDefault()}};d.prototype.attachEvent=function(e,i,r,s){t.prototype.attachEvent.call(this,e,i,r,s);if(e==="press"){this.invalidate()}return this};d.prototype.detachEvent=function(e,i,r){t.prototype.detachEvent.call(this,e,i,r);if(e==="press"){this.invalidate()}return this};d.prototype.exit=function(){this._deregisterResizeHandler()};d.prototype._getPercentageMode=function(){return this._bPercentageMode};d.prototype.setPercentage=function(e){if(typeof e==="number"){var t=Math.floor(e*10)/10;this._bPercentageMode=true;if(t!==this.getPercentage()){this.setProperty("percentage",t)}}else{this._bPercentageMode=false;this.setProperty("percentage",null)}return this};d.prototype.setValueColor=function(e,t){var i=false;if(h.hasOwnProperty(e)){i=true}else{i=c.isValid(e)}if(e!=null&&!i){throw new Error(`Value ${e} is not valid for property "valueColor"`)}return this.setProperty("valueColor",i?e:null,t)};d.prototype._onResize=function(){var e=this.$(),t=e.height(),i=e.width(),r=e.find(".sapSuiteRMCOutsideLabel"),s=e.find(".sapSuiteRMCInsideLabel"),a=e.find(".sapSuiteRMCInnerContainer");e.removeClass("sapSuiteRMCLookL sapSuiteRMCLookM sapSuiteRMCLookS sapSuiteRMCLookXS");r.removeClass("sapSuiteRMCLabelHide");s.removeClass("sapSuiteRMCLabelHide");a.css("width",a.height());if(t<this.convertRemToPixels(d.THRESHOLD_LOOK_S)){e.addClass("sapSuiteRMCLookXS");s.addClass("sapSuiteRMCLabelHide")}else if(t<this.convertRemToPixels(d.THRESHOLD_LOOK_M)||i<this.convertRemToPixels(d.THRESHOLD_LOOK_M)){e.addClass("sapSuiteRMCLookS");r.addClass("sapSuiteRMCLabelHide")}else if(t<this.convertRemToPixels(d.THRESHOLD_LOOK_L)||i<this.convertRemToPixels(d.THRESHOLD_LOOK_L)){e.addClass("sapSuiteRMCLookM");r.addClass("sapSuiteRMCLabelHide")}else{e.addClass("sapSuiteRMCLookL");r.addClass("sapSuiteRMCLabelHide")}if(this._isAnyLabelTruncated(r)){r.addClass("sapSuiteRMCLabelHide")}if(this._isAnyLabelTruncated(s)){s.addClass("sapSuiteRMCLabelHide")}};d.prototype._isValueColorValid=function(){return h.hasOwnProperty(this.getValueColor())};d.prototype._isTooltipSuppressed=function(){var e=this.getTooltip_Text();if(e&&e.trim().length===0){return true}else{return false}};d.prototype._getAltHeaderText=function(e){var t=this._oRb.getText("RADIALMICROCHART");if(e){t+=" "+this._oRb.getText("IS_ACTIVE")}t+="\n";if(!this._hasData()){t+=this._oRb.getText("NO_DATA");return t}var i=this.getPercentage();if(i>100){i=100}else if(i<0){i=0}if(this._isValueColorValid()){t+=this._oRb.getText("RADIALMICROCHART_ARIA_LABEL",[this.getPercentage(),this._getStatusText()])}else{t+=this._oRb.getText("RADIALMICROCHART_PERCENTAGE_TEXT",[i])}return t};d.prototype._getStatusText=function(){var e=this.getValueColor();switch(e){case h["Error"]:return this._oRb.getText("SEMANTIC_COLOR_ERROR");case h["Critical"]:return this._oRb.getText("SEMANTIC_COLOR_CRITICAL");case h["Good"]:return this._oRb.getText("SEMANTIC_COLOR_GOOD");case h["Neutral"]:return this._oRb.getText("SEMANTIC_COLOR_NEUTRAL");case h["Sequence1"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE1");case h["Sequence2"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE2");case h["Sequence3"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE3");case h["Sequence4"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE4");case h["Sequence5"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE5");case h["Sequence6"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE6");case h["Sequence7"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE7");case h["Sequence8"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE8");case h["Sequence9"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE9");case h["Sequence10"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE10");case h["Sequence11"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE11");case h["Sequence12"]:return this._oRb.getText("SEMANTIC_COLOR_SEQUENCE12");default:return""}};d.prototype._addTitleAttribute=function(){if(!this.$().attr("title")&&this._hasData()){this.$().attr("title",this.getTooltip_AsString())}};d.prototype._removeTitleAttribute=function(){if(this.$().attr("title")){this.$().removeAttr("title")}};d.prototype._bindMouseEnterLeaveHandler=function(){this.$().on("mouseenter.tooltip",this._addTitleAttribute.bind(this));this.$().on("mouseleave.tooltip",this._removeTitleAttribute.bind(this))};d.prototype._unbindMouseEnterLeaveHandler=function(){this.$().off("mouseenter.tooltip");this.$().off("mouseleave.tooltip")};d.prototype._isActuallyANumber=function(e){return!isNaN(e)&&e!==null&&(e!=="Infinity"&&e!=="-Infinity")};d.prototype._hasData=function(){return this._getPercentageMode()||this._isActuallyANumber(this.getTotal())};d.prototype.firePress=function(){if(this._hasData()){t.prototype.fireEvent.call(this,"press",arguments)}};d.prototype._deregisterResizeHandler=function(){if(this._sResizeHandlerId){r.deregister(this._sResizeHandlerId);this._sResizeHandlerId=null}};o.extendMicroChart(d);return d});
//# sourceMappingURL=RadialMicroChart.js.map