/*!
 * SAPUI5
 * (c) Copyright 2025 SAP SE. All rights reserved.
 */
sap.ui.define(["sap/ui/core/Theming","sap/m/library","sap/base/Log"],function(t,e,a){"use strict";var i;var s={apiVersion:2};s.TOTAL_RADIUS_ABSOLUTE=3.625;s.OUTER_RADIUS_ABSOLUTE=3.25;s.SELECTION_THICKNESS_ABSOLUTE=.375;s.HOLE_SIZE_RATIO_COMPACT=.48;s.HOLE_SIZE_RATIO_COZY=.48;s.SEGMENT_HALF_GAP_SIZE=0;s.SEGMENT_HALF_GAP_SIZE_HCB=.5;s.GHOST_BORDER_HALF_THICKNESS_HCB=.5;s.render=function(t,e){if(!e._bThemeApplied){return}i=i||sap.ui.require("sap/suite/ui/microchart/InteractiveDonutChart");this._aSegments=e.getSegments();var a=e._iVisibleSegments;this._fSegmentHalfGapSize=this.SEGMENT_HALF_GAP_SIZE;this._fGhostHalfGapSize=0;if(this._isThemeHighContrast()){this._fSegmentHalfGapSize=this.SEGMENT_HALF_GAP_SIZE_HCB;this._fGhostHalfGapSize=this.GHOST_BORDER_HALF_THICKNESS_HCB}if(e.getShowError()){t.openStart("div",e);t.class("sapSuiteUiMicroChartNoData");t.openEnd();t.renderControl(e._oIllustratedMessageControl);t.close("div");return}t.openStart("div",e);t.class("sapSuiteIDC");if(!e._isChartEnabled()){var s=e.getTooltip_AsString();if(typeof s==="string"||s instanceof String){t.attr("title",s)}}var n={};n.role="listbox";n.roledescription=e._oRb.getText("INTERACTIVEDONUTCHART");n.multiselectable=true;n.disabled=!e._isChartEnabled();n.labelledby=e.getAriaLabelledBy();t.accessibilityState(e,n);t.openEnd();if(!e.getSelectionEnabled()){this._renderDisabledOverlay(t,e)}this._renderDonut(t,e,a);this._renderLegend(t,e,a);t.close("div")};s._renderDonut=function(t,e,a){var s,n,r,o,l,S,_,c,h=e._bCompact;t.openStart("div");t.class("sapSuiteIDCChart");t.openEnd();t.openStart("svg");t.class("sapSuiteIDCChartSVG");t.attr("viewBox","-2 -2 104 104");t.attr("focusable","false");t.openEnd();t.openStart("g");t.attr("transform","translate(50.5 50.5)");t.openEnd();l=50;_=this.OUTER_RADIUS_ABSOLUTE/this.TOTAL_RADIUS_ABSOLUTE*l;if(h){S=this.HOLE_SIZE_RATIO_COMPACT*_}else{S=this.HOLE_SIZE_RATIO_COZY*_}c=l*(this.SELECTION_THICKNESS_ABSOLUTE/this.TOTAL_RADIUS_ABSOLUTE);n=this._calculateSum(e);r=0;var d;for(d=0;d<a;d++){s=this._aSegments[d];if(s.getValue()>0){o=this._calculateSegmentPath(n,s.getValue(),r,_+c,S-c,this._fGhostHalfGapSize);t.openStart("path");t.attr("d",o);t.attr("data-sap-ui-idc-selection-index",d);t.class(i.CHART_SEGMENT_GHOST.CSSCLASS);if(s.getSelected()){t.class(i.CHART_SEGMENT_GHOST.CSSCLASS_SELECTED)}t.openEnd();if(e._isChartEnabled()){this._renderTitle(s.getTooltip_AsString(),t)}t.close("path");r+=this._aSegments[d].getValue()}}r=0;for(d=0;d<a;d++){s=this._aSegments[d];if(s.getValue()>0){o=this._calculateSegmentPath(n,s.getValue(),r,_,S,0);t.openStart("path");t.attr("d",o);t.attr("fill",this._getSegmentColor(d,a,e));t.attr("cursor","pointer");t.attr("data-sap-ui-idc-selection-index",d);t.class(i.CHART_SEGMENT.CSSCLASS);if(s.getSelected()){t.class(i.CHART_SEGMENT.CSSCLASS_SELECTED)}t.openEnd();if(e._isChartEnabled()){this._renderTitle(s.getTooltip_AsString(),t)}t.close("path");r+=this._aSegments[d].getValue()}}t.close("g");t.close("svg");t.close("div")};s._renderLegend=function(t,e,a){t.openStart("div");t.class("sapSuiteIDCLegend");t.openEnd();for(var i=0;i<a;i++){this._renderLegendSegment(t,e,i,a)}t.close("div")};s._renderLegendSegment=function(t,a,s,n){var r=this._aSegments[s],o=r.getLabel(),l=r.getDisplayedValue()||String(r.getValue()),S,_=r._getSemanticColor();if(r._bNullValue){l=a._oRb.getText("INTERACTIVECHART_NA")}l=l.substring(0,i.CHART_SEGMENT_LABEL_MAXLENGTH);var S=r.getTooltip_Text();var c;if(S&&S.trim()){c=S}else{c=o;if(c){c=c+" "+l}else{c=l}if(_){c+=" "+_}}var h={};h.role="option";h.label=c.trim();h.selected=r.getSelected();h.posinset=s+1;h.setsize=n;t.openStart("div",a.getId()+"-interactionArea-"+s);t.accessibilityState(r,h);t.attr("data-sap-ui-idc-selection-index",s);t.class("sapSuiteIDCLegendSegment");if(r.getSelected()){t.class(i.SEGMENT_CSSCLASS_SELECTED)}if(s===0&&a.getSelectionEnabled()){t.attr("tabindex","0")}t.openEnd();_=r.getColor();if(_!==e.ValueColor.Neutral){t.openStart("div");t.class("sapSuiteIDCSemanticMarker");t.class("sapSuiteICSemanticColor"+_);t.openEnd();t.close("div")}t.openStart("div");t.class("sapSuiteIDCLegendMarker");t.style("background-color",this._getSegmentColor(s,n,a));t.openEnd();t.close("div");t.openStart("div");t.class("sapSuiteIDCLegendLabelValue");t.openEnd();t.openStart("div");t.class("sapSuiteIDCLegendLabel");t.openEnd();t.text(o);t.close("div");t.openStart("div");t.class("sapSuiteIDCLegendValue");t.openEnd();t.text(l);t.close("div");t.close("div");t.close("div")};s._getSegmentColor=function(t,e,a){var i=1-(e-t)/e,s=a.DEFAULT_SEGMENT_COLOR||"white";if(this._isThemeHighContrast()){return s}return this._mixColors(s,"#ffffff",i)};s._calculateSegmentPath=function(t,e,a,i,s,n){var r=.01,o,l,S,_,c,h,d,g,u,f=this._fSegmentHalfGapSize+n,E=Math.pow(2*f,2),p,T,C,A;i=this._formatFloat(i);s=this._formatFloat(s);h=this._calculateCircleFraction(t,a);d=this._calculateCircleFraction(t,a+e);g=this._calculateCircleFraction(t,e);if(g<=Math.PI){u=0}else{u=1}if(t===e){p=s;T=i;C=0;A=0}else{p=Math.sqrt(Math.pow(s,2)+E);T=Math.sqrt(Math.pow(i,2)+E);C=Math.atan(f/s);A=Math.atan(f/i)}l={x:this._formatFloat(p*Math.sin(h+C)),y:this._formatFloat(-p*Math.cos(h+C))};S={x:this._formatFloat(T*Math.sin(h+A)),y:this._formatFloat(-T*Math.cos(h+A))};_={x:this._formatFloat(i*Math.sin(d-A)-r),y:this._formatFloat(-i*Math.cos(d-A))};c={x:this._formatFloat(s*Math.sin(d-C)-r),y:this._formatFloat(-s*Math.cos(d-C))};o="";o+="M"+l.x+" "+l.y+" ";o+="L"+S.x+" "+S.y+" ";o+="A"+i+","+i+" 0 "+u+",1"+" "+_.x+","+_.y+" ";o+="L"+c.x+" "+c.y+" ";o+="A"+s+","+s+" 0 "+u+",0"+" "+l.x+","+l.y;return o};s._formatFloat=function(t){return parseFloat(t.toFixed(2))};s._calculateSum=function(t){var e=0;var a=t.getDisplayedSegments();for(var i=0;i<this._aSegments.length&&i<a;i++){var s=this._aSegments[i].getValue();if(s>0){e+=s}}return e};s._calculateCircleFraction=function(t,e){return 2*Math.PI*e/t};s._renderDisabledOverlay=function(t){t.openStart("div");t.class("sapSuiteIDCDisabledOverlay");t.openEnd();t.close("div")};s._getAriaDescribedBy=function(t,e){var a=[];for(var i=0;i<e;i++){a.push(t.getId()+"-interactionArea-"+i)}return a.join(",")};s._mixColors=function(t,e,a){if(a===1||t.toLowerCase()===e.toLowerCase()){return t}var i=this._hexToRgb(t);var s=this._hexToRgb(e);var n=Math.round((i[0]+Math.abs(i[0]-s[0])*a)%255);var r=Math.round((i[1]+Math.abs(i[1]-s[1])*a)%255);var o=Math.round((i[2]+Math.abs(i[2]-s[2])*a)%255);return"#"+this._intToHex(n)+this._intToHex(r)+this._intToHex(o)};s._isThemeHighContrast=function(){return/(hcw|hcb)/g.test(t.getTheme())};s._hexToRgb=function(t){var e=[];t=t.replace(/[^0-9a-f]+/gi,"");if(t.length===3){e=t.split("")}else if(t.length===6){e=t.match(/(\w{2})/g)}else{a.warning("Invalid color input: hex string must be in the format #FFFFFF or #FFF")}return e.map(function(t){return parseInt(t,16)})};s._intToHex=function(t){var e=t.toString(16);if(e.length===1){e="0"+e}return e};s._renderTitle=function(t,e){if(typeof t==="string"||t instanceof String){e.openStart("title");e.style("visibility","hidden");e.openEnd();e.text(t);e.close("title")}};return s},true);
//# sourceMappingURL=InteractiveDonutChartRenderer.js.map