/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/base/Log","sap/ui/core/Lib"],function(e,s){"use strict";let n;const o=e.getLogger("sap.suite.ui.commons.windowmessages.CollaborationMessageBroker");function t(e){o.info("CollaborationMessageBroker instance is created");const s="sap-suite-ui-commons-collaboration-message-broker";const n="collaboration-channel";const t="get-provider-config";const i="update-top-level-url";const a=sap.ui.require("sap/ushell/Container");const c=sap.ui.require("sap/suite/ui/commons/collaboration/CollaborationHelper");if(!a){o.info("UShell Container instance doesn't exist");return}const r=[{channelId:n,version:"1.0"}];const l=async function(e,t,i){try{const c=await a.getServiceAsync("MessageBroker");const r=JSON.stringify(i);await c.publish(n,s,Date.now().toString(),t,[e],r);o.info(`Published successfully to CLIENT_ID: ${e} on CHANNEL_ID: ${n} DATA: ${r}`)}catch(e){o.error(`Failed to publish message: ${e}`)}};const u=function(e,s,n){l(e,s,n)};const f=function(e,s,n){if(!n){return}try{const t=JSON.parse(n);if(t?.url){const n=t.url;const o=c._stripTeamsParams(n);l(e,s,{success:true});window.location.replace(o)}else{o.info("Invalid URL in the message data.")}}catch(e){o.error("Failed to parse the message data: "+e)}};const g=function(s,n,a,c){o.info("Message Received from CLIENT_ID: "+s+" on CHANNEL_ID: "+n);switch(a){case t:u(s,a,e);break;case i:f(s,a,c);break;default:o.info("Message: '"+a+"' is not supported")}};a.getServiceAsync("MessageBroker").then(function(e){e.connect(s).then(function(){o.info("Client ID: "+s+" is connected successfully");e.subscribe(s,r,g,Function.prototype)})})}return{startInstance:function(e){o.info("CollaborationMessageBroker=>startInstance method is being called");if(!n){n=new t(e)}}}});
//# sourceMappingURL=CollaborationMessageBroker.js.map