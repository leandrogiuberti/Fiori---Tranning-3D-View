/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","../library","sap/ui/core/Control","sap/suite/ui/commons/util/HtmlElement","sap/suite/ui/commons/statusindicator/util/ThemingUtil","sap/base/Log","sap/m/library"],function(jQuery,t,i,e,n,r,o){"use strict";var l=t.statusindicator.FillingType;var a=t.statusindicator.FillingDirectionType;var s=t.statusindicator.VerticalAlignmentType;var u=t.statusindicator.HorizontalAlignmentType;var g=t.SemanticColorType;var p=o.ValueCSSColor;var d=i.extend("sap.suite.ui.commons.statusindicator.Shape",{metadata:{abstract:true,library:"sap.suite.ui.commons",properties:{fullAnimationDuration:{type:"int",defaultValue:0},fillColor:{type:"string",defaultValue:"Neutral"},animationOnStartup:{type:"boolean",defaultValue:false},animationOnChange:{type:"boolean",defaultValue:true},animationOnStartupDelay:{type:"int",defaultValue:0},fillingDirection:{type:"sap.suite.ui.commons.statusindicator.FillingDirectionType",defaultValue:a.Up},fillingType:{type:"sap.suite.ui.commons.statusindicator.FillingType",defaultValue:l.Linear},fillingAngle:{type:"int",defaultValue:undefined},verticalAlignment:{type:"sap.suite.ui.commons.statusindicator.VerticalAlignmentType",defaultValue:s.Middle},horizontalAlignment:{type:"sap.suite.ui.commons.statusindicator.HorizontalAlignmentType",defaultValue:u.Middle}}},renderer:null});d.prototype.GRADIENT_ID="gradient";d.prototype.STOP_ID="stop";d.prototype.getDisplayedValue=function(){r.fatal("Must be overridden!")};d.prototype._setInitialValue=function(t){r.fatal("Must be overridden!")};d.prototype._updateDom=function(t,i){r.fatal("Must be overridden!")};d.prototype.init=function(){if(i.prototype.init){i.prototype.init.apply(this,arguments)}this._oAnimationPropertiesResolver=null};d.prototype.onBeforeRendering=function(){if(i.prototype.onBeforeRendering){i.prototype.onBeforeRendering.apply(this,arguments)}this._clearBoundingBox()};d.prototype.setFillColor=function(t,i){var e=false;if(g.hasOwnProperty(t)){e=true}else{e=p.isValid(t)}if(t!=null&&!e){throw new Error(`Value ${t} is not valid for property "fillColor"`)}return this.setProperty("fillColor",e?t:null,i)};d.prototype._getCssFillColor=function(){return n.resolveColor(this.getFillColor())};d.prototype._resolveFillColor=function(){return this._oAnimationPropertiesResolver.getColor(this,this.getDisplayedValue())};d.prototype._injectAnimationPropertiesResolver=function(t){this._oAnimationPropertiesResolver=t};d.prototype.getDisplayedFillColor=function(t){return this._oAnimationPropertiesResolver.getColor(this,t)};d.prototype.getFullAnimationDuration=function(){return 250};d.prototype._buildPreserveAspectRatioAttribute=function(){var t="x";switch(this.getHorizontalAlignment()){case u.Left:t+="Min";break;case u.Middle:t+="Mid";break;case u.Right:t+="Max";break}t+="Y";switch(this.getVerticalAlignment()){case s.Top:t+="Min";break;case s.Middle:t+="Mid";break;case s.Bottom:t+="Max";break}t+=" meet";return t};d.prototype._getGradientElement=function(t){var i=new e(this.getFillingType()===l.Linear?"linearGradient":"radialGradient");i.setId(this._buildIdString(this.getId(),this.GRADIENT_ID));if(this.getFillingType()===l.Linear){var n=this.computeLinearFillingAngle();i.setAttribute("x1",n===90?1:0);i.setAttribute("y1",n===0?1:0);i.setAttribute("x2",n===270?1:0);i.setAttribute("y2",n===180?1:0)}var r=this._getDisplayedGradientOffset(t);var o=new e(this.STOP_ID);o.setAttribute("offset",r);o.setAttribute("stop-color","white");i.addChild(o);var a=new e(this.STOP_ID);a.setAttribute("offset",r);a.setAttribute("stop-color","transparent");i.addChild(a);return i};d.prototype.getPolygonElement=function(t){var i=new e("polygon");i.setId(this._buildIdString(this.getId(),"polygon"));i.setAttribute("fill","white");return i};d.prototype.computeLinearFillingAngle=function(){if(this.getFillingAngle()!==undefined){return this._getNormalizedFillingAngle()}switch(this.getFillingDirection()){case a.Up:return 0;case a.Down:return 180;case a.Left:return 90;case a.Right:return 270;default:r.error("Unknown FillingDirection '"+this.getFillingDirection()+"'");return 0}};d.prototype._useGradientForAnimation=function(){var t=this._getNormalizedFillingAngle();var i=this.getFillingType();return i===l.Radial||i===l.Linear&&(t===undefined||[0,90,180,270].indexOf(t)>-1)};d.prototype._getPolygonPoints=function(t){var i;switch(this.getFillingType()){case l.Linear:i=this._getPolygonPointsForLinearFilling(t);break;case l.Circular:i=this._getPolygonPointsForCircularFilling(t);break;default:r.error("Unknown FillingType '"+this.getFillingType()+"' given.");i=this._getPolygonPointsForLinearFilling(t)}i=i.map(function(t){t.x=Number(t.x.toFixed(3));t.y=Number(t.y.toFixed(3));return t});return i};d.prototype._getPolygonPointsForLinearFilling=function(t){var i=180-this._getNormalizedFillingAngle();var e=Math.tan(i*Math.PI/180);var n=this._getBoundingPoints();var r=n.start;var o=n.end;var l=r.y-e*r.x;var a=o.y-e*o.x;var s=l+(a-l)/100*t;var u=r.x;var g=u*e+s;var p=r.y;var d=(p-s)/e;var h=[r,{x:u,y:g},{x:d,y:p}];return h};d.prototype._getPolygonPointsForCircularFilling=function(t){var i=this,e=3.6*t,n=this._getBoundingBox(),r=[];var o,l,s;var u=h(n.x+n.width/2,n.y);var g=h(n.x+n.width/2,n.y+n.height/2);function p(t){var e=Object.assign({},t);if(i.getFillingDirection()===a.CounterClockwise){var n=t.x-g.x;e.x=g.x-n}return e}function d(t,i,e){var n=Math.tan((i-t)*Math.PI/180);return n*e/2}r.push(u);if(0<e&&e<45){o=d(e,0,n.height);s=h(u.x-o,u.y);r.push(p(s))}if(45<=e){r.push(p(h(n.x+n.width,n.y)))}if(45<e&&e<135){l=d(e,90,n.width);s=h(n.x+n.width,n.y+n.height/2-l);r.push(p(s))}if(135<=e){r.push(p(h(n.x+n.width,n.y+n.height)))}if(135<e&&e<225){o=d(e,180,n.height);s=h(n.x+n.width/2+o,n.y+n.height);r.push(p(s))}if(225<=e){r.push(p(h(n.x,n.y+n.height)))}if(225<e&&e<315){l=d(e,270,n.width);s=h(n.x,n.y+n.height/2+l);r.push(p(s))}if(315<=e){r.push(p(h(n.x,n.y)))}if(315<e&&e<=360){o=d(e,360,n.height);s=h(n.x+n.width/2-o,n.y);r.push(p(s))}r.push(g);return r};d.prototype._isFillingAngleInFirstQuadrant=function(){var t=this._getNormalizedFillingAngle();return 0<t&&t<90};d.prototype._isFillingAngleInSecondQuadrant=function(){var t=this._getNormalizedFillingAngle();return 90<t&&t<180};d.prototype._isFillingAngleInThirdQuadrant=function(){var t=this._getNormalizedFillingAngle();return 180<t&&t<270};d.prototype._isFillingAngleInForthQuadrant=function(){var t=this._getNormalizedFillingAngle();return 270<t&&t<360};d.prototype._getBoundingPoints=function(){var t=this._getBoundingBox();var i=t.x+t.width;var e=t.y+t.height;var n=t.x;var o=t.y;if(this._isFillingAngleInFirstQuadrant()){}else if(this._isFillingAngleInSecondQuadrant()){i=t.x+t.width;e=t.y;n=t.x;o=t.y+t.height}else if(this._isFillingAngleInThirdQuadrant()){i=t.x;e=t.y;n=t.x+t.width;o=t.y+t.height}else if(this._isFillingAngleInForthQuadrant()){i=t.x;e=t.y+t.height;n=t.x+t.width;o=t.y}else{r.error("Invalid call of _getBoundingPoints. FillingAngle '"+this.getFillingAngle()+"' is not in any quadrant")}return{start:h(i,e),end:h(n,o)}};d.prototype._getBoundingBox=function(){if(!this._oBoundingBox){this._oBoundingBox=this.$()[0].getBBox()}return this._oBoundingBox};d.prototype._clearBoundingBox=function(){this._oBoundingBox=null};d.prototype._getNormalizedFillingAngle=function(){if(this.getFillingAngle()===undefined){return this.getFillingAngle()}var t=this.getFillingAngle()%360;if(t<0){t+=360}return t};d.prototype.isFillable=function(){return this.getFillingType()!==l.None};d.prototype._getDisplayedGradientOffset=function(t){if(this.isFillable()){var i=t/100;return i}else{return 1}};d.prototype._getMaskElement=function(t){var i=new e("mask");i.setId(t);if(this._useGradientForAnimation()){var n=this._getSimpleShapeElement(this._buildIdString(this.getId(),"mask-shape"));n.setAttribute("stroke-width",0);n.setAttribute("stroke","white");n.setAttribute("fill",this._buildSvgUrlString(this.getId(),this.GRADIENT_ID));i.addChild(n)}else{i.addChild(this.getPolygonElement(this._iDisplayedValue))}return i};d.prototype._buildSvgUrlString=function(){return"url(#"+this._buildIdString.apply(this,arguments)+")"};d.prototype._buildIdString=function(){var t=jQuery.makeArray(arguments).join("-");return t};function h(t,i){return{x:t,y:i}}return d});
//# sourceMappingURL=Shape.js.map