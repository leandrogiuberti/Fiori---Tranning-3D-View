sap.ui.require.preload({"sap/suite/ui/commons/collaboration/flpplugins/msplugin/Component.js":function(){sap.ui.define(["sap/ui/core/Component","sap/ushell/EventHub","sap/base/Log","../../ServiceContainer","../../CollaborationHelper"],function(e,t,a,n,o){var i=a.getLogger("sap.suite.ui.commons.collaboration.flpplugins.msplugin.Component");const r="sap-collaboration-authEndUrl";const s="CollaborationMSPluginLoaded";return e.extend("sap.suite.ui.commons.collaboration.flpplugins.msplugin.Component",{metadata:{manifest:"json",properties:{isShareAsLinkEnabled:{name:"isShareAsLinkEnabled",type:"string"},isShareAsTabEnabled:{name:"isShareAsTabEnabled",type:"string"},isShareAsCardEnabled:{name:"isShareAsCardEnabled",type:"string"},applicationId:{name:"applicationId",type:"string"},tenantId:{name:"tenantId",type:"string"},isDirectCommunicationEnabled:{name:"isDirectCommunicationEnabled",type:"string"}}},init:function(){var e=this._loadPluginConfigData();if(e){o._getCurrentUrl().then(function(e){try{const t=new URL(e);if(t.searchParams.has(r)){const e=decodeURIComponent(t.searchParams.get(r));window.location.replace(e)}}catch(e){i.error(`Error while redirecting to auth end url`)}});n.setCollaborationType("COLLABORATION_MSTEAMS",e)}else{i.error("Collaboration configuration for Microsoft Teams Integration could not be loaded.")}t.emit(s)},_loadPluginConfigData:function(){var e=this.getComponentData();if(e){return e.config}}})})},"sap/suite/ui/commons/collaboration/BaseHelperService.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){var t=e.extend("sap.suite.ui.commons.collaboration.BaseHelperService",{constructor:function(e){this._providerConfig=e}});t.prototype.getProviderConfig=function(){return this._providerConfig};t.prototype.getOptions=function(e){return[]};t.prototype.share=function(e,t){};t.prototype.isContactsCollaborationSupported=function(){return false};t.prototype.enableContactsCollaboration=async function(e,t){return Promise.resolve({})};t.prototype.getTeamsContactCollabOptions=async function(){return Promise.resolve({})};t.prototype.isFeatureFlagEnabled=function(){return false};t.prototype.getTeamsContactStatus=async function(e){return Promise.resolve({})};t.prototype.getCollaborationPopover=function(e,t,a,n,o){};return t})},"sap/suite/ui/commons/collaboration/CollaborationCardHelper.js":function(){sap.ui.define(["sap/ui/base/Object","sap/base/Log"],function(e,t){var a="/sap/opu/odata4/sap/aps_ui_card_srv/srvd_a2x/sap/";var n=a+"aps_ui_card/0001/";var o="Card";var i=a+"aps_ui_card/0001/"+o;var r="POST";var s="HEAD";var l=t.getLogger("sap.suite.ui.commons.collaboration.CollaborationCardHelper");var c=e.extend("sap.suite.ui.commons.collaboration.CollaborationCardHelper");c.fetchCSRFToken=function(){return fetch(n,{method:s,headers:{"X-CSRF-Token":"Fetch"}}).then(function(e){var t=e.headers.get("X-CSRF-Token");if(e.ok&&t){return t}return undefined})};c.postCard=function(e,t){return this.fetchCSRFToken().then(function(a){let n=JSON.stringify(t);try{n=btoa(JSON.stringify(t))}catch(e){l.error("Error while encoding the card content to base64 so original content passed to API: "+e)}var o=JSON.stringify({content:n,card_id:e});return fetch(i,{method:r,headers:{"X-CSRF-Token":a,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"},body:o}).then(function(e){return e.json()})})};return c})},"sap/suite/ui/commons/collaboration/CollaborationContactInfoHelper.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){var t="/sap/opu/odata4/sap/aps_ui_contact_srv/srvd_a2x/sap/";var a=t+"aps_ui_contact/0001/";var n="APS_UI_C_CONTACT";var o=t+"aps_ui_contact/0001/"+n;var i=t+"aps_ui_contact/0001/"+n;var r="APS_UI_C_PRESENCE";var s=t+"aps_ui_contact/0001/"+r;var l="APS_UI_C_CALENDAR";var c=t+"aps_ui_contact/0001/"+l;var u=t+"aps_ui_contact/0001/"+"APS_UI_C_CHECK_SERVICE";var p="GET";var d="HEAD";var f=e.extend("sap.suite.ui.commons.collaboration.CollaborationContactInfoHelper");f.fetchCSRFToken=function(){return fetch(a,{method:d,headers:{"X-CSRF-Token":"Fetch"}}).then(function(e){var t=e.headers.get("X-CSRF-Token");if(e.ok&&t){return t}return undefined})};f.fetchContact=function(e){return this.fetchCSRFToken().then(function(t){return fetch(o+"/"+e,{method:p,headers:{"X-CSRF-Token":t,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"}}).then(function(e){return e.json()})})};f.fetchContactCalendar=function(e){var t=new Date;var a=c+"?$filter=mail eq '"+e+"'";if(t){a=c+"?$filter=(mail eq '"+e+"'&start_datetime eq '"+t.toISOString()+"')"}return this.fetchCSRFToken().then(function(e){return fetch(a,{method:p,headers:{"X-CSRF-Token":e,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"}}).then(function(e){return e.json()})})};f.fetchContactPicture=function(e){return this.fetchCSRFToken().then(function(t){return fetch(i+"/"+e+"/photo",{method:p,headers:{"X-CSRF-Token":t}}).then(function(e){return e.blob()})})};f.fetchContactStatus=function(e){return this.fetchCSRFToken().then(function(t){return fetch(s+"?$filter=id eq '"+e+"'",{method:p,headers:{"X-CSRF-Token":t,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"}}).then(function(e){return e.json()})})};f.fetchServiceStatus=function(){return this.fetchCSRFToken().then(function(e){return fetch(u,{method:p,headers:{"X-CSRF-Token":e,"content-type":"application/json;odata.metadata=minimal;charset=utf-8"}}).then(function(e){return e.json()})})};return f})},"sap/suite/ui/commons/collaboration/CollaborationHelper.js":function(){sap.ui.define(["sap/base/Log","sap/ui/base/Object","sap/ui/core/Element","../windowmessages/CollaborationMessageConsumer"],function(e,t,a,n){var o="sap-url-hash";var i="&sap-ui-cardTitle";var r="&sap-stageview-hash";var s="&sap-ui-cardId";var l="&sap-ui-xx-cardId";var c="&info=";var u="sap-ushell-config";var p="sap-collaboration-teams";var d="sap-ui-fesr-env";var f="transient";var h=e.getLogger("sap.suite.ui.commons.collaboration.CollaborationHelper");var m=t.extend("sap.suite.ui.commons.collaboration.CollaborationHelper");m.compactHash=function(e){const t=sap.ui.require("sap/ushell/Container");if(!t){return{url:e}}return t&&t.getServiceAsync("AppState").then(async function(t){var a=t.createEmptyAppState(undefined,false);var n=this._getNextKey(a);if(!this._isEligibleForBackendPersistency(t)){h.warning("Transient flag is true. URL will not be shortened");return{url:e}}var i=this._extractURLBeforeHash(e);var r=await this._extractSemanticObjectAndAction(e);var s=false;try{s=await this._isMinificationFeasible(e)}catch(e){}if(!r||!s){return{url:e}}return this._storeUrl(e,a).then(function(){return{url:i+"#"+r+"&/"+o+"="+n}}).catch(function(t){h.warning("URL is not shortened due to an error."+t.toString());return{url:e}})}.bind(this))};m._getCurrentUrl=function(){const e=sap.ui.require("sap/ushell/Container");return e&&e?new Promise(function(t){e.getFLPUrlAsync(true).then(function(e){t(e)})}):Promise.resolve(document.URL)};m.processAndExpandHash=function(){this._hideAvatarFromShellbar();return this._getCurrentUrl().then(async function(e){if(e.indexOf(o)>-1){var t=e.split(o)[1].split("=")[1];if(e.indexOf(r)>0){t=t.split(r)[0]}else if(e.includes("info=")){t=t.includes(",")?t.split(",")[0]:t.split("&")[0]}else if(e.indexOf(s)>0||e.indexOf(l)>0){if(e.indexOf(s)>0){t=t.split(s)[0]}else{t=t.split(l)[0]}}else if(e.indexOf(i)>0){t=t.split(i)[0]}return this._retrieveURL(t).then(function(t){if(t.getData()){window.location.replace(t.getData())}else{const t=e.split(o)[0];window.location.replace(t)}return Promise.resolve()})}else if(e.indexOf(s)>-1){const t=e.split(s)[0];window.location.replace(t)}else if(e.indexOf(i)>-1){const t=e.split(i)[0];await this._redirectBasedOnRuntime(t)}else if(e.includes(c)&&this._isFromTeams(e)){const t=e.split(c)[0];await this._redirectBasedOnRuntime(t)}return Promise.resolve()}.bind(this))};m._isFromTeams=function(e){const t=new URL(e);const a=t.searchParams.get("sap-collaboration-teams");return a==="true"};m._redirectBasedOnRuntime=async function(e){const t=sap.ui.require("sap/ushell/Container");if(t&&t.inAppRuntime()){await n.updateTopLevelURLforAppRuntime(e)}else{const t=this._stripTeamsParams(e);window.location.replace(t)}};m._removeTeamsParams=function(e){try{const t=e.split("#");const a=t[0];const n=t[1]?"#"+t[1]:"";const[o,i]=a.split("?");if(!i){return e}const r=new URLSearchParams(i);r.delete(u);r.delete(p);r.delete(d);const s=r.toString()?`${o}?${r.toString()}`:o;return s+n}catch(t){return e}};m._stripTeamsParams=function(e){if(this._isTopWindow()){return this._removeTeamsParams(e)}return e};m._isTopWindow=function(){return window.self===window.top};m._hideAvatarFromShellbar=function(){this.isTeamsModeActive().then(function(e){if(e){var t=a.getElementById("userActionsMenuHeaderButton");if(t){t.setVisible(false)}}})};m.isTeamsModeActive=function(){var e=false;const t=sap.ui.require("sap/ushell/Container");if(t){return t.getServiceAsync("URLParsing").then(function(t){return this._getCurrentUrl().then(function(a){var n=a.split("#")[0];if(n.indexOf("?")!==-1){var o=t&&t.parseParameters(n.substring(n.indexOf("?")));if(o&&o["sap-collaboration-teams"]&&o["sap-collaboration-teams"][0]&&o["sap-collaboration-teams"][0]==="true"){e=true}var i=false;if(o&&o["sap-ushell-config"]&&o["sap-ushell-config"][0]&&o["sap-ushell-config"][0]==="lean"){i=true}return Promise.resolve(e&&i)}else{return Promise.resolve(false)}})}.bind(this))}else{return Promise.resolve(false)}};m._retrieveURL=function(e){const t=sap.ui.require("sap/ushell/Container");return t&&t.getServiceAsync("AppState").then(function(t){return t.getAppState(e)})};m._isEligibleForBackendPersistency=function(e){return e&&e._oConfig&&f in e._oConfig&&!e._oConfig[f]};m._getNextKey=function(e){return e.getKey()};m._extractSemanticObjectAndAction=function(e){const t=sap.ui.require("sap/ushell/Container");return t&&t.getServiceAsync("URLParsing").then(function(t){var a=t.parseShellHash(this._extractURLHash(e));if(a){return Promise.resolve(a.contextRaw?a.semanticObject+"-"+a.action+"~"+a.contextRaw:a.semanticObject+"-"+a.action)}}.bind(this))};m._isMinificationFeasible=async function(e){const t=sap.ui.require("sap/ushell/Container");if(t){const o=await t.getServiceAsync("NavTargetResolution");const i=await t.getServiceAsync("URLParsing");var a=i.parseShellHash(this._extractURLHash(e));var n=Object.keys(a.params).length;if(n>0){return o.resolveHashFragment(`#${a.semanticObject}-${a.action}`).then(function(e){return true}).catch(function(e){return false})}else{return Promise.resolve(true)}}return Promise.resolve(false)};m._extractURLBeforeHash=function(e){var t=e.split("#")[0];return t};m._extractURLHash=function(e){var t=e.substring(e.indexOf("#"));return t};m._storeUrl=function(e,t){t.setData(e);return t.save()};return m})},"sap/suite/ui/commons/collaboration/CollaborationManagerService.js":function(){sap.ui.define(["sap/base/Log","sap/ui/core/Core","./BaseHelperService","sap/ui/Device","sap/ui/core/Lib","sap/suite/ui/commons/collaboration/channels/MessageChannel"],function(e,t,a,n,o,i){var r=a.extend("sap.suite.ui.commons.collaboration.CollaborationManagerService");var s=o.getResourceBundleFor("sap.suite.ui.commons");var l=e.getLogger("sap.suite.ui.commons.collaboration.CollaborationManagerService");r.prototype.triggerH2HChat=function(e,t,a){this.publishData({sAppTitle:e,sCurrentURL:t,sEmailId:a})};r.prototype.getOptions=function(){var e=window["sap-ushell-config"]&&window["sap-ushell-config"].bootstrapPlugins&&window["sap-ushell-config"].bootstrapPlugins.H2H_CHAT_PLUGIN;if(n.system.desktop){if(e){return{text:s.getText("COLLABORATION_MANGER"),icon:"sap-icon://BusinessSuiteInAppSymbols/icon-collaboration-manager",press:this.triggerH2HChat.bind(this),fesrStepName:"CM:ShareLink"}}else{l.info("Consumer disable Collaboration Manager option")}}else{l.info("Collaboration Manager is not supported in Phone and Tablet")}return null};r.prototype.publishData=async function(e){try{const t=await i.getInstance();t.postMessage(e)}catch(e){l.error("Failed to publish data:",e)}};return r})},"sap/suite/ui/commons/collaboration/ContactHelper.js":function(){sap.ui.define(["sap/ui/core/mvc/Controller","sap/ui/core/Fragment","sap/ui/model/json/JSONModel","sap/m/library","sap/ui/core/Lib","sap/ui/core/Core","sap/ui/model/resource/ResourceModel","./CollaborationContactInfoHelper","sap/ui/performance/trace/FESRHelper","sap/ui/core/Element"],function(e,t,a,n,o,i,r,s,l,c){var u=o.getResourceBundleFor("sap.suite.ui.commons");return e.extend("sap.suite.ui.commons.collaboration.ContactHelper",{constructor:function(){},getFullProfileByEmail:async function(e){var t=await s.fetchContact(e);if(t&&t.mail===""){return t}if(t&&t.data!=""){t.photo="data:image/png;base64,"+t.data}t=this.determineContactStatus(t);return t},getTeamsContactOptions:function(){var e=this;return Promise.resolve([{key:"chat",icon:"sap-icon://discussion",tooltip:u.getText("CHAT_BUTTON_TOOLTIP"),fesrStepName:"MST:ContactAction",callBackHandler:function(t){e.handleMSTeamsPress(t)}},{key:"call",icon:"sap-icon://call",tooltip:u.getText("CALL_BUTTON_TOOLTIP"),fesrStepName:"MST:ContactAction",callBackHandler:function(t){e.handleMSTeamsPress(t)}},{key:"videoCall",icon:"sap-icon://video",tooltip:u.getText("VIDEOCALL_BUTTON_TOOLTIP"),fesrStepName:"MST:ContactAction",callBackHandler:function(t){e.handleMSTeamsPress(t)}}])},getTeamsContactStatus:async function(e){let t={calendar:[]};if(e){const a=await Promise.all([s.fetchContact(e),s.fetchContactCalendar(e)]);t=a[0];t.calendar=a[1]}const a=this.determineContactStatus(t);return[{key:"profileStatus",badgeIcon:a.badgeIcon,badgeValueState:a.badgeValueState,badgeTooltip:a.badgeTooltip,fesrStepName:"MST:ContactAction",calendar:a.calendar}]},handleMSTeamsPress:function(e){var t=e.getSource().data("email");var a=e.getSource().data("type");var o="";switch(a){case"chat":o="https://teams.microsoft.com/l/chat/0/0?users="+t;break;case"call":o="https://teams.microsoft.com/l/call/0/0?users="+t;break;case"videoCall":o="https://teams.microsoft.com/l/call/0/0?users="+t+"&withVideo=true";break;default:break}n.URLHelper.redirect(o,true)},formatUri:function(e,t){var a=/^\w+[\w-+\.]*\@\w+([-\.]\w+)*\.[a-zA-Z]{2,}$/;if(a.test(e)){return"mailto:"+e+(t&&t.subject?"?subject="+t.subject:"")+(t&&t.body?"&body="+t.body:"")}else{return"tel:"+e}},loadContactPopover:function(e,n,o){this.afterClose();return t.load({name:"sap.suite.ui.commons.collaboration.ContactPopover",controller:this,type:"XML"}).then(function(t){l.setSemanticStepname(t,"afterClose","MST:ContactDetails");this._oContactPopover=t;this.sEmail=e;this.oParams=n;t.setBusy(true);var i={setFamily:"tnt",setURI:sap.ui.require.toUrl("sap/tnt/themes/base/illustrations")};sap.m.IllustrationPool.registerIllustrationSet(i,false);var r=new a({isUserExistsInTeams:true});this._oContactPopover.setModel(r,"userData");this.isDirectCommunicationEnabled=o;this._oContactPopover.setModel(new sap.ui.model.resource.ResourceModel({bundle:u}),"i18n");return t}.bind(this))},loadMinimalContactPopover:function(e,n){this.afterClose();var o=new a({mail:e,params:n});return t.load({name:"sap.suite.ui.commons.collaboration.MinimalContactPopover",controller:this,type:"XML"}).then(function(e){this._oMinContactPopover=e;l.setSemanticStepname(e,"afterClose","MST:ContactDetails");e.setModel(o,"userData");e.setModel(new sap.ui.model.resource.ResourceModel({bundle:u}),"i18n");return e}.bind(this))},afterClose:function(){if(this._oContactPopover){this._oContactPopover.destroy()}if(this._oMinContactPopover){this._oMinContactPopover.destroy()}},afterOpen:function(){var e=this;this.getFullProfileByEmail(this.sEmail).then(function(t){e._oContactPopover.setBusy(false);if(t&&t.mail===""){t.isUserExistsInTeams=false;t.mail=e.sEmail;t.params=e.oParams;e._oContactPopover.setInitialFocus(c.getElementById("mail"))}else{t.isUserExistsInTeams=true;t.isDirectCommunicationEnabled=!!e.isDirectCommunicationEnabled;e._oContactPopover.setInitialFocus(c.getElementById("avatar"))}var n=new a(t);n.setData(t);e._oContactPopover.setModel(n,"userData");l.setSemanticStepname(e._oContactPopover,"afterClose","MST:ContactDetails")})},afterContinue:function(){var e=this.formatUri(this.sEmail,this.oParams);n.URLHelper.redirect(e,true)},determineContactStatus:function(e){const t=new Map([["OOO",{badgeValueState:"Information",badgeIcon:"sap-icon://offsite-work"}],["BUSYOOO",{badgeValueState:"Error",badgeIcon:"sap-icon://circle-task"}],["ONLINEOOO",{badgeValueState:"Success",badgeIcon:"sap-icon://sys-enter"}],["AVAILABLE",{badgeValueState:"Success",badgeIcon:"sap-icon://sys-enter-2"}],["AWAY",{badgeValueState:"Warning",badgeIcon:"sap-icon://pending"}],["BUSY",{badgeValueState:"Error",badgeIcon:"sap-icon://circle-task-2"}],["PRESENTING",{badgeValueState:"Error",badgeIcon:"sap-icon://sys-minus"}],["OFFLINE",{badgeValueState:"Error",badgeIcon:"sap-icon://message-error"}]]);const a=new Map([["Available","AVAILABLE"],["Away","AWAY"],["Inactive","AWAY"],["Busy","BUSY"],["DoNotDisturb","PRESENTING"],["InACall","BUSY"],["InAMeeting","BUSY"],["Presenting","PRESENTING"],["BeRightBack","AWAY"],["OffWork","OFFLINE"],["Offline","OFFLINE"]]);let n={};if(!!e.isoutofoffice){if(e.activity==="Available"){n=t.get("ONLINEOOO");n.badgeTooltip=`${u.getText("AVAILABLE")}, ${u.getText("OOO")}`}else if(e.activity==="Busy"){n=t.get("BUSYOOO");n.badgeTooltip=`${u.getText("BUSY")}, ${u.getText("OOO")}`}else if(e.activity==="DoNotDisturb"){n=t.get("PRESENTING");n.badgeTooltip=`${u.getText("DONOTDISTURB")}, ${u.getText("OOO")}`}else{n=t.get("OOO");n.badgeTooltip=u.getText("OOO")}}else{const o=e.activity?a.get(e.activity):"OFFLINE";n=t.get(o);n.badgeTooltip=u.getText(e.activity.toUpperCase())}Object.assign(e,n);return e}})})},"sap/suite/ui/commons/collaboration/ServiceContainer.js":function(){sap.ui.define(["sap/base/Log","./BaseHelperService","./TeamsHelperService","./CollaborationManagerService","../windowmessages/CollaborationMessageBroker","../windowmessages/CollaborationMessageConsumer","./CollaborationHelper","sap/ui/core/Element"],function(e,t,a,n,o,i,r,s){var l=e.getLogger("sap.suite.ui.commons.collaboration.ServiceContainer");var c;var u;function p(){var e;if(c&&Object.keys(c).length){var n=c.sProvider;var o=c.oProviderConfig;if(n==="COLLABORATION_MSTEAMS"){e=new a(o)}u=Promise.resolve(e);return u}e=new t({});l.info("Collaboration provider is not activated on the tenant");return Promise.resolve(e)}function d(){}var f=new d;f.getServiceAsync=async function(){const e=sap.ui.require("sap/ushell/Container");if(u){return u}if(e&&e.inAppRuntime()){c=await i.getProviderConfiguration()}return p()};f.getCollaborationServices=async function(){var e=await f.getServiceAsync();var t={oTeamsHelperService:e,oCMHelperService:new n};return Promise.resolve(t)};f.hidePluginsInMSTeams=async function(){try{const e=await r.isTeamsModeActive();if(e){let e=0;const t=1*1e3;const a={chatButton:true,"sap.das.webclientplugin.s4.shellitem":true};const n=setInterval(()=>{e++;if(e>10){clearInterval(n);return}Object.keys(a).forEach(e=>{const t=s.getElementById(e);if(t?.getVisible()===true){t.setVisible(false);a[e]=false}});const t=Object.values(a).every(e=>!e);if(t){clearInterval(n)}},t)}}catch(e){l.error("Error hiding the plugins in MS Teams",e)}};f.setCollaborationType=function(e,t){l.info("Collaboration properties are now configured");f.hidePluginsInMSTeams();c={sProvider:e,oProviderConfig:t};p();o.startInstance(c)};return f},true)},"sap/suite/ui/commons/collaboration/TeamsHelperService.js":function(){sap.ui.define(["sap/base/Log","sap/ui/core/Core","sap/base/security/URLListValidator","./CollaborationHelper","./BaseHelperService","sap/ui/core/Element","./ContactHelper","sap/ui/Device","./CollaborationCardHelper","sap/ui/core/Fragment","sap/m/MessageBox","sap/ui/core/Lib","sap/m/Popover","sap/m/HBox","sap/m/VBox","sap/m/MessageStrip","sap/m/Button","./CollaborationContactInfoHelper","sap/m/library","sap/m/FlexBox","sap/base/i18n/Localization","./CollaborationManagerService","sap/m/FlexItemData"],function(e,t,a,n,o,i,r,s,l,c,u,p,d,f,h,m,C,g,v,b,S,T,A){var _=o.extend("sap.suite.ui.commons.collaboration.TeamsHelperService",{constructor:function(e){this._providerConfig=e;this._providerConfig.shareAsLinkUrl="https://teams.microsoft.com/share";this._getShareAsTabUrl().then(function(e){this._providerConfig.shareAsTabUrl=e}.bind(this))}});var y="db5b69c6-0430-4ae1-8d6e-a65c2220b50c";var O=e.getLogger("sap.suite.ui.commons.collaboration.TeamsHelperService");var E="https://saps4hana.azure-api.net/bot/redirect?target-url=";var L=p.getResourceBundleFor("sap.suite.ui.commons");var P="info";var I;let M;const R=60*1e3;var w={};var x="width=720,height=720";_.prototype.getOptions=function(e){w={isShareAsLinkEnabled:e&&typeof e.isShareAsLinkEnabled!=="undefined"?e.isShareAsLinkEnabled:true,isShareAsTabEnabled:e&&typeof e.isShareAsTabEnabled!=="undefined"?e.isShareAsTabEnabled:true,isShareAsCardEnabled:e&&typeof e.isShareAsCardEnabled!=="undefined"?e.isShareAsCardEnabled:false};var t=[];var a=[];if(s.system.desktop){if(w.isShareAsLinkEnabled){if(this._providerConfig.isShareAsLinkEnabled==="X"){t.push({text:L.getText("COLLABORATION_MSTEAMS_CHAT"),key:"COLLABORATION_MSTEAMS_CHAT",icon:"sap-icon://post",fesrStepName:"MST:ShareAsLink"})}else{O.info("Share as Chat option is not enabled in the tenant")}}else{O.info("Consumer disable Share as Chat option")}}else{O.info("Share as Chat option is not supported in Phone and Tablet")}if(s.system.desktop){if(w.isShareAsTabEnabled){if(this._providerConfig.isShareAsTabEnabled==="X"){t.push({text:L.getText("COLLABORATION_MSTEAMS_TAB"),key:"COLLABORATION_MSTEAMS_TAB",icon:"sap-icon://image-viewer",fesrStepName:"MST:ShareAsTab"})}else{O.info("Share as Tab option is not enabled in the tenant")}}else{O.info("Consumer disable Share as Tab option")}}else{O.info("Share as Tab option is not supported in Phone and Tablet")}if(s.system.desktop){if(w.isShareAsCardEnabled){const e=this._providerConfig.isShareAsCardEnabled;const a=this._providerConfig.isShareAsTabEnabled==="X";const n={text:L.getText("COLLABORATION_MSTEAMS_CARD"),key:"COLLABORATION_MSTEAMS_CARD",icon:"sap-icon://ui-notifications",fesrStepName:"MST:ShareAsCard"};switch(e){case"DISABLED":O.info("Share as Card option is not enabled in the tenant");break;case"ENABLED":case"AUTHENABLE":t.push(n);break;case"":case undefined:if(a){t.push(n)}else{O.info("Share as Card option is not enabled in the tenant")}break;default:O.info("Share as Card option is not enabled in the tenant");break}}else{O.info("Consumer disable Share as Card option")}}else{O.info("Share as Card option is not supported in Phone and Tablet")}if(t.length===1){a=t;if(a[0].key==="COLLABORATION_MSTEAMS_CHAT"){a[0].text=L.getText("COLLABORATION_MSTEAMS_CHAT_SINGLE")}else if(a[0].key==="COLLABORATION_MSTEAMS_TAB"){a[0].text=L.getText("COLLABORATION_MSTEAMS_TAB_SINGLE")}else if(a[0].key==="COLLABORATION_MSTEAMS_CARD"){a[0].text=L.getText("COLLABORATION_MSTEAMS_CARD_SINGLE")}return a}if(t.length>1){a.push({type:"microsoft",text:L.getText("COLLABORATION_MSTEAMS_SHARE"),icon:"sap-icon://collaborate",subOptions:t})}return a};_.prototype.share=function(e,t){if(!t.url){O.error("url is not supplied in object so terminating Click");return}if(!a.validate(t.url)){O.error("Invalid URL supplied");return}if(e.key==="COLLABORATION_MSTEAMS_CHAT"){this._shareAsChat(t);return}if(e.key==="COLLABORATION_MSTEAMS_TAB"){this._shareAsTab(t);return}if(e.key==="COLLABORATION_MSTEAMS_CARD"){this._shareAsCard(t);return}};_.prototype._shareAsChat=function(e){var t=window.open("","_blank",x);var a=e.appTitle;if(e.subTitle.length>0){a+=": "+e.subTitle}t.opener=null;if(e.minifyUrlForChat){n.compactHash(e.url,[]).then(async function(n){var o=await this._modifyUrlForNavigationContext(e.url,n.url);t.location=this._providerConfig.shareAsLinkUrl+"?msgText="+encodeURIComponent(a)+"&preview=false"+"&href="+encodeURIComponent(o)}.bind(this))}else{t.location=this._providerConfig.shareAsLinkUrl+"?msgText="+encodeURIComponent(a)+"&preview=false"+"&href="+encodeURIComponent(e.url)}};_.prototype._modifyUrlForShareAsTab=async function(e,t){var a=e;var n=a.indexOf("#");if(n!==-1){var o=a.substring(0,n);var i=o.indexOf("?",0);var r="sap-ushell-config=lean&sap-collaboration-teams=true&sap-ui-fesr-env="+t;if(i!==-1){o=o.substring(0,i+1)+r+"&"+o.substring(i+1)}else{o+="?"+r}a=o+a.substring(n);a=await this._addNavmodeInUrl(a,"explace")}return a};_.prototype._shareAsTab=async function(e){var t=await this._modifyUrlForShareAsTab(e.url,"MST:T");var a={subEntityId:{url:t,appTitle:e.appTitle,subTitle:e.subTitle,mode:"tab"}};if(e.minifyUrlForChat){n.compactHash(t,[]).then(async function(e){var n=await this._modifyUrlForNavigationContext(t,e.url);a.subEntityId.url=await this._addNavmodeInUrl(n,"explace");var o=this._providerConfig.shareAsTabUrl+"?&context="+encodeURIComponent(JSON.stringify(a));sap.m.URLHelper.redirect(o,true)}.bind(this))}else{var o=this._providerConfig.shareAsTabUrl+"?&context="+encodeURIComponent(JSON.stringify(a));sap.m.URLHelper.redirect(o,true)}};_.prototype._addNavmodeInUrl=function(e,t){const a=sap.ui.require("sap/ushell/Container");return a&&a.getServiceAsync("URLParsing").then(function(a){var n=e;var o=n.indexOf("#");var i=a.parseShellHash(n.substring(o));i.params["sap-ushell-navmode"]=t;i.params["sap-ushell-next-navmode"]=t;var r=a.constructShellHash(i);n=n.substring(0,o)+"#"+r;return Promise.resolve(n)})};_.prototype._modifyUrlForNavigationContext=function(e,t){if(e===t){return Promise.resolve(t)}const a=sap.ui.require("sap/ushell/Container");return a&&a.getServiceAsync("URLParsing").then(function(a){var n=e;var o=n.indexOf("#");var i=a.parseShellHash(n.substring(o));var r=Object.keys(i.params).length;var s=new URL(t);if(r>0){if(!s.searchParams.has("sap-collaboration-teams")){s.searchParams.set("sap-collaboration-teams","true")}else{s.searchParams.delete("sap-collaboration-teams")}}return Promise.resolve(s.toString())})};_.prototype._shareAsCard=function(e){if(e.cardId&&e.cardId.length>0&&e.cardManifest&&this.isFeatureFlagEnabled()){e.cardManifest["rtl"]=S.getRTL();c.load({name:"sap.suite.ui.commons.collaboration.CollaborationBusyDialog",controller:this,type:"XML"}).then(function(t){I=t;I.open();M=setTimeout(function(){I.close();I.destroy()},R);l.postCard(e.cardId,e.cardManifest).then(function(t){var a=true;var n={cardId:t.card_id,version:t.version};if(t.error){if(t.error.code==="APS_UI_MSG/001"){a=true;n.cardId=e.cardId;if(t.error.message.length>0){try{var o=JSON.parse(atob(t.error.message)).version;n.version=o}catch(e){a=false}}}else{a=false}}if(a){this._updateUrl(e,n)}else{u.error(L.getText("SAVE_CARD_ERROR"));this._closeBusyDailog()}}.bind(this))}.bind(this))}else{this._updateUrl(e,{})}};_.prototype._updateUrl=async function(e,t){if(e.minifyUrlForChat){n.compactHash(e.url,[]).then(async function(a){var o=await this._modifyUrlForNavigationContext(e.url,a.url);if(w.isShareAsTabEnabled&&this._providerConfig.isShareAsTabEnabled){var i=await this._modifyUrlForShareAsTab(e.url,"MST:C");var r=await n.compactHash(i,[]);var s=r.url.split("sap-url-hash=")[1];if(s){o+=`,${s}`}else{i=await this._modifyUrlForShareAsTab(o,"MST:C");o=await this._addNavmodeInUrl(i,"inplace")}this._closeBusyDialogAndOpenTeamsDialog(o,e,t)}else{this._closeBusyDialogAndOpenTeamsDialog(o,e,t)}}.bind(this))}else{var a=e.url;if(w.isShareAsTabEnabled&&this._providerConfig.isShareAsTabEnabled){var o=await this._modifyUrlForShareAsTab(a,"MST:C");a=await this._addNavmodeInUrl(o,"inplace")}this._closeBusyDialogAndOpenTeamsDialog(a,e,t)}};_.prototype._closeBusyDailog=function(){if(I){I.close();I.destroy();clearTimeout(M)}};_.prototype._closeBusyDialogAndOpenTeamsDialog=function(e,t,a){this._closeBusyDailog();var n=window.open("","_blank",x);n.opener=null;n.location=this._addCardParamsInUrl(e,t.appTitle,a)};_.prototype._addCardParamsInUrl=function(e,t,a){var n=[a.cardId||"",a.version||"",encodeURIComponent(t)].filter(Boolean);e+=`&${P}=${n.join(",")}`;return`${this._providerConfig.shareAsLinkUrl}?href=${encodeURIComponent(E+e)}`};_.prototype._getShareAsTabUrl=function(){return this._getApplicationID().then(function(e){return"https://teams.microsoft.com/l/entity/"+e+"/tab"})};_.prototype._getApplicationID=function(){const e=sap.ui.require("sap/ushell/Container");return e&&e.getServiceAsync("URLParsing").then(function(e){return n._getCurrentUrl().then(function(t){var a=t.split("#")[0];if(a.indexOf("?")!==-1){var n=e&&e.parseParameters(a.substring(a.indexOf("?")));if(n&&n["sap-collaboration-xx-TeamsAppId"]&&n["sap-collaboration-xx-TeamsAppId"][0]&&n["sap-collaboration-xx-TeamsAppId"][0].length>0){return Promise.resolve(n["sap-collaboration-xx-TeamsAppId"][0])}return Promise.resolve(y)}else{return Promise.resolve(y)}})})};_.prototype.isFeatureFlagEnabled=function(){const e=this._providerConfig.isShareAsCardEnabled;return e==="AUTHENABLE"};_.prototype.isContactsCollaborationSupported=function(){return true};_.prototype.enableContactsCollaboration=async function(e,t){const a=await n.isTeamsModeActive();const o=await g.fetchServiceStatus();if(e&&o.value&&o.value&&o.value[0].FetchContacts==="Active"){if(!this.oContactHelper){this.oContactHelper=new r}if(this._providerConfig.isDirectCommunicationEnabled==="ENABLED"){return this.oContactHelper.loadContactPopover(e,t,true)}else{return this.oContactHelper.loadContactPopover(e,t)}}else if(a||!e||this._providerConfig.isDirectCommunicationEnabled!=="ENABLED"){return Promise.reject()}else{if(!this.oContactHelper){this.oContactHelper=new r}return this.oContactHelper.loadMinimalContactPopover(e,t)}};_.prototype.getTeamsContactCollabOptions=async function(){const e=await n.isTeamsModeActive();if(e||this._providerConfig.isDirectCommunicationEnabled!=="ENABLED"){return Promise.reject()}if(!this.oContactHelper){this.oContactHelper=new r}return this.oContactHelper.getTeamsContactOptions()};_.prototype.getTeamsContactStatus=async function(e){const t=await n.isTeamsModeActive();if(t){return Promise.reject()}if(!this.oContactHelper){this.oContactHelper=new r}return this.oContactHelper.getTeamsContactStatus(e)};_.prototype.getCollaborationPopover=function(e,t,a,n,o){if(t.data===undefined||t.data.trim()===""){O.error("Popover cannnot be opened without data");return}var i={isShareAsLinkEnabled:e&&typeof e.isShareAsLinkEnabled!=="undefined"?e.isShareAsLinkEnabled:true};var o={shareToTeams:o&&typeof o.shareToTeams!=="undefined"?o.shareToTeams:true,shareToEmail:o&&typeof o.shareToEmail!=="undefined"?o.shareToEmail:true,shareToCM:o&&typeof o.shareToCM!=="undefined"?o.shareToCM:false};var r=[];if(s.system.desktop){if(i.isShareAsLinkEnabled){if(this._providerConfig.isShareAsLinkEnabled==="X"&&o.shareToTeams){r.push({text:L.getText("COLLABORATION_POPOVER_TEAMS"),icon:"sap-icon://discussion",key:"COLLABORATION_POPOVER_TEAMS"})}else{O.info("Share as Chat option is not enabled in the tenant")}}else{O.info("Consumer disable Share as Chat option")}}else{O.info("Share as Chat option is not supported in Phone and Tablet")}if(o.shareToEmail){r.push({text:L.getText("COLLABORATION_POPOVER_MAIL"),icon:"sap-icon://email",key:"COLLABORATION_POPOVER_MAIL"})}this.oCollaborationManager=new T;var l=this.oCollaborationManager.getOptions();if(l&&o.shareToCM){r.push({text:l.text,icon:l.icon,key:"COLLABORATION_POPOVER_CM"})}if(r.length===1&&!n&&r[0].key==="COLLABORATION_POPOVER_MAIL"){this._shareData(t,r[0],n);return}var c=this._getPopover(t,r,n);c.openBy(a)};_.prototype._getPopover=function(e,t,a){var n=new d({showHeader:false,placement:e.placement?e.placement:"Auto",verticalScrolling:false,horizontalScrolling:false,content:this._getPopoverContent(e,t,a)});return n};_.prototype._getPopoverContent=function(e,t,a){var n=new b({items:[],direction:v.FlexDirection.Column});var o=new b({direction:e.sFormat==="Vertical"?v.FlexDirection.Column:v.FlexDirection.Row,justifyContent:v.FlexJustifyContent.SpaceAround,items:[]});t.forEach(i=>{var r=new C({text:i.text,icon:i.icon,width:e.sFormat==="Horizontal"&&t.length===3?"120px":"180px",press:t=>{t.getSource().getParent().getParent().getParent().close();this._shareData(e,i,a)}}).addStyleClass("sapUiTinyMarginTop").addStyleClass("sapUiTinyMarginBegin");if(i.key==="COLLABORATION_POPOVER_TEAMS"){r.addStyleClass("sapSuiteUiCollaborationBarMSTeamsButton"+(e.sFormat?e.sFormat:"Horizontal"))}else if(i.key==="COLLABORATION_POPOVER_CM"){r.addStyleClass("sapSuiteUiCollaborationBarCMButton"+(e.sFormat?e.sFormat:"Horizontal"))}else{r.addStyleClass("sapSuiteUiCollaborationBarEmailButton"+(e.sFormat?e.sFormat:"Horizontal"))}o.addItem(r);n.addItem(o)});if(a){var i=new b({justifyContent:e.sFormat==="Vertical"?v.FlexJustifyContent.Center:v.FlexJustifyContent.SpaceBetween,alignItems:v.FlexAlignItems.Center,items:[new C({text:L.getText("COLLABORATION_POPOVER_COPYURL_BUTTON"),width:e.sFormat==="Vertical"?"150px":"",press:async()=>{await this._writeToClipBoard(e.data)}}).addStyleClass("sapUiTinyMarginBeginEnd")]});if(e.sFormat==="Horizontal"||e.sFormat===undefined){i.insertItem(new m({text:L.getText("COLLABORATION_POPOVER_MSGSTRIP"),showIcon:true}).addStyleClass("sapUiTinyMarginBeginEnd").addStyleClass("sapSuiteCollaborationBarMsgStrip"),0);i.addStyleClass("sapSuiteUiCollaborationBarMsgStripHBox")}i.addStyleClass("sapUiTinyMarginBeginEnd").addStyleClass("sapUiTinyMarginTopBottom");n.addItem(i)}if(e.sFormat==="Vertical"){o.setHeight(t.length>1?t.length*50+50+"px":"80px");o.addStyleClass("sapUiSmallMarginBottom").addStyleClass("sapUiTinyMarginEnd")}else{o.setHeight("110px");o.addStyleClass("sapUiTinyMarginEnd")}return n};_.prototype._writeToClipBoard=async function(e){try{await navigator.clipboard.writeText(e)}catch(e){O.info(e)}};_.prototype._shareData=function(e,t,a){if(t.key==="COLLABORATION_POPOVER_TEAMS"){if(a){var n={url:e.data,appTitle:e.title?e.title:"",subTitle:"",minifyUrlForChat:true};this._shareAsChat(n)}else{var n={appTitle:e.title?e.title:"",message:e.data,showPreview:typeof e.showPreview!==undefined?e.showPreview:true};this._shareSummary(n)}}else if(t.key==="COLLABORATION_POPOVER_MAIL"){sap.m.URLHelper.triggerEmail(null,e.title&&e.title.trim()!==""?e.title:null,e.data)}else if(t.key==="COLLABORATION_POPOVER_CM"){this.oCollaborationManager.triggerH2HChat(e.title,e.data)}};_.prototype._shareSummary=function(e){var t={subEntityId:{appTitle:e.appTitle,mode:"summary",message:e.message,showPreview:e.showPreview}};var a=this._providerConfig.shareAsTabUrl+"?&context="+encodeURIComponent(JSON.stringify(t));sap.m.URLHelper.redirect(a,true)};return _})},"sap/suite/ui/commons/collaboration/channels/MessageChannel.js":function(){sap.ui.define(["sap/ui/base/Object"],function(e){var t;var a=e.extend("sap.suite.ui.commons.collaboration.channels.MessageChannel",{postMessage:function(e,t){window.parent.postMessage({...e,_fromMessageChannel:true},t||"*")},subscribe:function(e){window.addEventListener("message",function(t){if(t?.data?._fromMessageChannel&&typeof e==="function"){e(t)}})}});return{getInstance:function(){if(!t){t=new a}return Promise.resolve(t)}}})}});
//# sourceMappingURL=Component-preload.js.map