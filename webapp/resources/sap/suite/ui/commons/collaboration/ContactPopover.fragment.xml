<core:FragmentDefinition
	xmlns="sap.m"
	xmlns:core="sap.ui.core"
    xmlns:fesr="http://schemas.sap.com/sapui5/extension/sap.ui.core.FESR/1"
    xmlns:macrodata="http://schemas.sap.com/sapui5/extension/sap.ui.core.CustomData/1">
	<Popover
		class="sapUiContentPadding"
		placement="Auto"
        showHeader="false"
        contentWidth="21.875rem"
        afterClose="afterClose"
        afterOpen="afterOpen">
        <VBox visible="{userData>/isUserExistsInTeams}">
            <HBox>
                <Avatar id="avatar" src="{= ${userData>/photo} ? ${userData>/photo} : 'sap-icon://person-placeholder' }"
                    displaySize="M" class="sapUiSmallMarginEnd" displayShape="Circle" macrodata:email="{userData>/mail}" fesr:press="MST:ContactAction"
                    macrodata:type="chat" tooltip="{userData>/badgeTooltip}" badgeValueState="{userData>/badgeValueState}" badgeTooltip="{userData>/badgeTooltip}" badgeIcon="{userData>/badgeIcon}"/>
                <VBox>
                    <Title text="{userData>/displayname}" level="H3" />
                    <Text text="{userData>/jobtitle}"/>
                </VBox>
            </HBox>
            <OverflowToolbar visible="{userData>/isDirectCommunicationEnabled}" class="sapMFlexItem sapUiNoContentPadding sapUiTinyMarginTop">
				<Title text="{i18n>COLLABORATION_MSTEAMS_SHARE}" level="H5"/>
				<ToolbarSpacer/>
                <Button
                    press="handleMSTeamsPress"
                    macrodata:email="{userData>/mail}"
                    macrodata:type="chat"
                    tooltip="{i18n>CHAT_BUTTON_TOOLTIP}"
                    icon="sap-icon://discussion"
                    type="Transparent"
					class="sapUiTinyMarginEnd"
                    fesr:press="MST:ContactAction"
                />
                <Button
                    press="handleMSTeamsPress"
                    macrodata:email="{userData>/mail}"
                    macrodata:type="videoCall"
                    tooltip="{i18n>VIDEOCALL_BUTTON_TOOLTIP}"
                    icon="sap-icon://video"
                    type="Transparent"
					class="sapUiTinyMarginEnd"
                    fesr:press="MST:ContactAction"
                />
                <Button
                    press="handleMSTeamsPress"
                    macrodata:email="{userData>/mail}"
                    macrodata:type="call"
                    tooltip="{i18n>CALL_BUTTON_TOOLTIP}"
                    icon="sap-icon://call"
                    type="Transparent"
					class="sapUiTinyMarginEnd"
                    fesr:press="MST:ContactAction"
                />
            </OverflowToolbar >

            <VBox class="sapMFlexItem sapUiNoContentPadding sapUiSmallMarginTop">

                <Title text="{i18n>POPOVER_CONTACT_DETAILS}" level="H5" class="sapUiTinyMarginBottom sapUiTinyMarginTop" />

                <VBox visible="{= !!${userData>/mobilephone}}" class="sapUiTinyMarginTop sapUiTinyMarginBottom" >
                    <Label id="UserMobile" text="{i18n>POPOVER_CONTACT_SECTION_MOBILE}:" />
                    <Link text="{userData>/mobilephone}" href="{path: 'userData>/mobilephone', formatter: '.formatUri'}" ariaLabelledBy="UserMobile"/>
                </VBox>

                <VBox visible="{= !!${userData>/businessphone}}"  class="sapUiTinyMarginTop sapUiTinyMarginBottom" >
                    <Label id="UserPhone" text="{i18n>POPOVER_CONTACT_SECTION_PHONE}:" />
                    <Link text="{userData>/businessphone}" href="{path: 'userData>/businessphone', formatter: '.formatUri'}" ariaLabelledBy="UserPhone"/>
                </VBox>

                <VBox visible="{= !!${userData>/mail}}"  class="sapUiTinyMarginTop sapUiTinyMarginBottom" >
                    <Label id="UserEmail" text="{i18n>POPOVER_CONTACT_SECTION_EMAIL}:" />
                    <Link text="{userData>/mail}" href="{path: 'userData>/mail', formatter: '.formatUri'}" ariaLabelledBy="UserEmail"/>
                </VBox>

                <VBox visible="{= !!${userData>/officelocation}}"  class="sapUiTinyMarginTop sapUiTinyMarginBottom" >
                    <Label text="{i18n>POPOVER_CONTACT_SECTION_OFFICE_LOCATION}:" />
                    <Text text="{userData>/officelocation}" />
                </VBox>
			</VBox>
        </VBox>
        <HBox class="sapUiTinyMarginTop" visible="{= !${userData>/isUserExistsInTeams}}">
            <IllustratedMessage illustrationType="tnt-NoUsers" illustrationSize="Dialog" title="{i18n>POPOVER_NO_CONTACT_TITLE}"
                description="{i18n>POPOVER_NO_CONTACT_DESCRIPTION}" >
			    <additionalContent>
					<Button id="mail" text="{i18n>POPOVER_CONTINUE}" press="afterContinue" type="Emphasized" class="sapUiTinyMarginEnd"/>
					<Button text="{i18n>POPOVER_CANCEL}" press="afterClose"/>
				</additionalContent>
			</IllustratedMessage >
        </HBox>
	</Popover>
</core:FragmentDefinition>
