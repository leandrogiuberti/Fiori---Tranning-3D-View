/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["sap/ui/thirdparty/jquery","./SvgBase","./Line","./Node","./Group","sap/m/ResponsivePopover","sap/m/Popover","sap/m/List","sap/m/OverflowToolbar","sap/m/Button","sap/m/CustomListItem","sap/m/FlexBox","sap/m/HBox","sap/m/IconTabBar","sap/m/IconTabFilter","sap/m/Panel","sap/m/StandardListItem","sap/m/Text","sap/m/ToolbarSpacer","sap/ui/core/Icon","sap/m/FlexItemData","sap/ui/core/library","sap/m/library","sap/suite/ui/commons/library","sap/ui/Device","sap/ui/core/Lib","sap/ui/core/Element"],function(jQuery,t,e,o,i,n,s,r,p,a,l,d,h,c,u,m,_,f,g,T,w,v,y,C,S,P,A){"use strict";var N=y.PlacementType;var x=C.networkgraph.LineArrowOrientation;var b=P.getResourceBundleFor("sap.suite.ui.commons");var L=t.extend("sap.suite.ui.commons.networkgraph.Tooltip",{metadata:{library:"sap.suite.ui.commons",events:{afterOpen:{},afterClose:{}}},renderer:null});L.prototype.init=function(){this._oPopover=null;this._oElement=null};L.prototype.create=function(t){var e;this._oPopover=new n(this.getId()+"-tooltip",{showHeader:false,placement:this.getParent()._bIsRtl?N.PreferredLeftOrFlip:N.PreferredRightOrFlip,afterOpen:function(){this.fireAfterOpen()}.bind(this),afterClose:function(){this.fireAfterClose()}.bind(this),beforeOpen:function(){this._fnCreate();this._oPopover.setInitialFocus(A.getElementById(this.getId()+"-detailsSection"))}.bind(this),contentWidth:"350px"}).addStyleClass("sapSuiteUiCommonsNetworkTooltip");this._oSimpleTooltip=new s({contentMinWidth:"350px",showHeader:false});this.addDependent(this._oPopover);e=this._oPopover.getAggregation("_popup");if(e){e._afterAdjustPositionAndArrowHook=function(){var t=this.$("arrow"),e=this.$().position().top,o=t.position().top,i=15,n=jQuery(window).height(),s=e+o-i;if(n>s+this.$().height()){t.css("top",i+"px");this.$().css("top",s+"px")}}}};L.prototype.instantClose=function(){var t=this._oPopover.getAggregation("_popup");if(t&&t.oPopup&&t.oPopup.close){t.oPopup.close(0)}if(this._oSimpleTooltip.oPopup&&this._oSimpleTooltip.oPopup.close){this._oSimpleTooltip.oPopup.close(0)}};L.prototype.close=function(){this._oPopover.close()};L.prototype.openDetail=function(t){var e=t.opener||this._getOpener(t.item,t.point);if(t.item instanceof o&&!t.item._hasDetailData()){this._oSimpleTooltip.removeAllContent();var i=t.item.getTitle();var n=i?i:t.item.getAltText();this._appendHeader(n,this._oSimpleTooltip);this._oSimpleTooltip.openBy(e);return}this._fnCreate=this._createDetail;this._oElement=t.item;this._oPopover.openBy(e)};L.prototype._createDetail=function(){var t=this._getTooltipCreateFunction(this._oElement);this._oPopover.removeAllContent();this._appendFooter();t(this._oElement)};L.prototype.openLink=function(t){this._oElement=t.item;this._fnCreate=this._createLink;this._oPopover.openBy(t.opener)};L.prototype._createLink=function(t){var e=new r,o=this._oElement;this._oPopover.removeAllContent();this._appendHeader(b.getText("NETWORK_GRAPH_TOOLTIP_EXTERNAL_LINKS"));o.getActionLinks().forEach(function(t){e.addItem(new l({content:[new h({renderType:"Bare",items:t.clone(null,null,{cloneChildren:true,cloneBindings:false}).addStyleClass("sapUiTinyMargin")})]}))});this._oPopover.addContent(e);this._appendFooter()};L.prototype._getOpener=function(t,o){if(t instanceof e&&o){if(this._oElement===t&&this._tooltipRect){var i=parseInt(this._tooltipRect.getAttribute("x"),10),n=parseInt(this._tooltipRect.getAttribute("y"),10),s=10;if(Math.abs(i-o.x)<s&&Math.abs(n-o.y)<s){return this._tooltipRect}}this._cleanUpLineTooltip();this._tooltipRect=this._createElement("rect",{x:o.x,y:o.y,width:S.browser.firefox?.01:0,height:S.browser.firefox?.01:0});this.getParent().$svg.append(this._tooltipRect);return this._tooltipRect}return t};L.prototype._getTooltipCreateFunction=function(t){if(t instanceof o){return this._createNodeTooltip.bind(this)}if(t instanceof e){return this._createLineTooltip.bind(this)}if(t instanceof i){return this._createGroupTooltip.bind(this)}return null};L.prototype._cleanUpLineTooltip=function(){if(this._tooltipRect){jQuery(this._tooltipRect).remove()}};L.prototype._appendDescription=function(t,e){if(t.getDescription()){e=e||this._oPopover;e.addContent(new m({content:new f({textAlign:"Initial",text:t.getDescription()}).addStyleClass("sapSuiteUiCommonsNetworkTooltipDescription")}).addStyleClass("sapSuiteUiCommonsNetworkTooltipArea"))}};L.prototype._appendAttributes=function(t,e){var o=new r,i=e||this._oPopover;if(t.length>0){t.forEach(function(t){o.addItem(new l({content:[new h({items:[new f({layoutData:[new w({baseSize:"50%"})],text:t.getLabel()}),new f({layoutData:[new w({baseSize:"50%"})],text:t.getValue(),width:"100%",textAlign:v.TextAlign.End})]}).addStyleClass("sapSuiteUiCommonsNetworkTooltipLine")]}));i.addContent(o)})}};L.prototype._appendNodesList=function(t,e){var o=new r;t.aNodes.forEach(function(t){var e=t.getTitle();var i=e?e:t.getAltText();if(t.getTitle()){o.addItem(new _({title:i,icon:t.getIcon()}))}});e.addContent(o)};L.prototype._appendFooter=function(){var t=this;this.oCloseButton=new a({text:b.getText("NETWORK_GRAPH_CLOSE"),press:function(){t._oPopover.close()}});this._oPopover.setEndButton(this.oCloseButton)};L.prototype._appendHeader=function(t,e){e=e||this._oPopover;if(t){var o=new f({width:"100%",textAlign:v.TextAlign.Center,text:t});e.insertContent(new m({width:"100%",content:[o]}).addStyleClass("sapSuiteUiCommonsNetworkTooltipArea"),0);e.addAriaLabelledBy(o)}};L.prototype._createGroupTooltip=function(t){var e=function(){return t.getAttributes().length>0||t.getDescription()};var o,i;this._appendHeader(t.getTitle());if(e()){i=new u({id:this.getId()+"-nodesSection",text:b.getText("NETWORK_GRAPH_TOOLTIP_LIST_OF_NODES")});o=new u({id:this.getId()+"-detailsSection",text:b.getText("NETWORK_GRAPH_TOOLTIP_INFORMATION")});this._oPopover.addContent(new c({items:[o,i]}));this._oPopover.addStyleClass("sapSuiteUiCommonsNetworkGroupTooltipTabBar");this._appendDescription(t,o);this._appendAttributes(t.getAttributes(),o);this._appendNodesList(t,i)}else{this._appendNodesList(t,this._oPopover)}};L.prototype._createNodeTooltip=function(t){this._appendDescription(t);this._appendAttributes(t.getAttributes());var e=t.getTitle();var o=e?e:t.getAltText();this._appendHeader(o)};L.prototype._createLineTooltip=function(t,e){var o=function(){var e=t.getFromNode().getTitle();var o=t.getToNode().getTitle();var i=new f({width:"50%",text:e?e:t.getFromNode().getAltText()}).addStyleClass("sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipLabel"),n=new T({src:"sap-icon://arrow-right"}).addStyleClass("sapUiTinyMarginEnd sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipFromToIcon"),s=new T({src:"sap-icon://arrow-left"}).addStyleClass("sapUiTinyMarginBegin sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipFromToIcon"),r=new T({src:"sap-icon://less"}).addStyleClass("sapUiTinyMarginBegin sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipFromToIcon"),p=new f({textAlign:v.TextAlign.End,width:"50%",text:o?o:t.getToNode().getAltText()}).addStyleClass("sapSuiteUiCommonsNetworkGraphNoPointerEvents sapSuiteUiCommonsNetworkLineTooltipLabel"),a=new d({renderType:"Bare",width:"100%",justifyContent:"Center",items:[i]}).addStyleClass("sapSuiteUiCommonsNetworkLineTooltipFromTo");t._isBothArrow()?a.addItem(s):n.addStyleClass("sapUiTinyMarginBegin");if(t.getArrowOrientation()===x.ChildOf){a.addItem(s)}else if(t.getArrowOrientation()===x.None){a.addItem(r)}else{a.addItem(n)}a.addItem(p);return a},i=function(){var e=t.getTitle();this._oPopover.addContent(o());if(e){this._appendHeader(e)}this._appendDescription(t);this._appendAttributes(t.getAttributes())}.bind(this);i(t)};return L});
//# sourceMappingURL=Tooltip.js.map