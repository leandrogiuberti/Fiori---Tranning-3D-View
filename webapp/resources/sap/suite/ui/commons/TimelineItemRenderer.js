/*!
 * 
		SAP UI development toolkit for HTML5 (SAPUI5)
		(c) Copyright 2009-2015 SAP SE. All rights reserved
	
 */
sap.ui.define(["./library","sap/suite/ui/commons/util/HtmlElement","sap/ui/core/format/DateFormat","sap/ui/core/Icon","sap/base/security/encodeXML","sap/base/security/encodeCSS","sap/ui/core/InvisibleText","sap/ui/core/date/UI5Date","sap/ui/core/Lib"],function(e,i,t,a,d,s,l,n,o){"use strict";var r=e.TimelineAlignment;var m=e.TimelineGroupType;var p={apiVersion:2};var C=o.getResourceBundleFor("sap.suite.ui.commons"),u=24*60*60*1e3,T="";p.render=function(e,i){this._getTimelineItemElement(i).getRenderer().render(e)};p._getTimelineItemElement=function(e){if(e._orientation==="V"){return this._getVerticalTimelineItemElement(e)}else{return this._getHorizontalTimelineItemElement(e)}};p._getFormatedDateTime=function(e,i){i=i||{};var a=i.resBundle||C,d=i.dateFormat||t.getDateInstance({style:"short"}),s=i.timeFormat||t.getTimeInstance({style:"short"}),l=e.getDateTimeWithoutStringParse(),o,r,m,p;if(!(l instanceof Date)||isNaN(l.getTime())){return l}o=Date.UTC(l.getFullYear(),l.getMonth(),l.getDate());r=n.getInstance();r=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate());m=Math.floor((r-o)/u);switch(m){case 0:p=a.getText("TIMELINE_TODAY");break;case 1:p=a.getText("TIMELINE_YESTERDAY");break;default:p=d.format(l)}T=p+" "+a.getText("TIMELINE_AT")+" "+this._formatTimeForAriaLabel(s.format(l));return p+" "+a.getText("TIMELINE_AT")+" "+s.format(l)};p._formatTimeForAriaLabel=function(e){const i=e.replace(/\u202F/g," ");const[t,a]=i.split(" ");const[d,s]=t.split(":").map(Number);if(a){return e}else{return`${d} hours : ${s} minutes`}};p._getHorizontalTimelineItemElement=function(e){var t=e._placementLine==="top",a=t?"sapSuiteUiCommonsTimelineItemHTop":"sapSuiteUiCommonsTimelineItemHBottom",l=e.getText()==="GroupHeader",n=e._groupID,o,r;if(l){return this._getGroupHeaderElement(e)}var m=new i("li"),p=new i("div"),C=new i("div"),u=new i("div"),T=new i("div"),I=new i("div"),g=new i("div"),S=this._getTimelineItemShell(e);if(n){m.setAttribute("groupid",e._groupID)}if(e._isFirstGroupEvenItem){m.setAttribute("firstgroupevenitem",e._isFirstGroupEvenItem)}m.addControlData(e);m.addClass("sapSuiteUiCommonsTimelineItemLiWrapperV");m.addClass(d(a));p.addClass("sapSuiteUiCommonsTimelineItemWrapperH");p.addClass("sapSuiteUiCommonsTimelineItemBaseLength");m.addChild(p);C.addClass("sapSuiteUiCommonsTimelineItemBubbleSpacer");p.addChild(C);u.addClass("sapSuiteUiCommonsTimelineItemBubble");C.addChild(u);T.addClass("sapSuiteUiCommonsTimelineItemOutline");T.setId(e.getId()+"-outline");T.setAttribute("tabindex","0");this._addAccessibilityTags(T,e);I.addClass("sapSuiteUiCommonsTimelineItemBox");T.addChild(I);g.addClass("sapSuiteUiCommonsTimelineItemArrow");if(t){u.addChild(T);u.addChild(g)}else{u.addChild(g);u.addChild(T)}if(!e._callParentFn("_isGrouped")&&e._callParentFn("getEnableDoubleSided")&&e._index===1){r=e.getParent();o="margin-left";if(r&&r._bRtlMode){o="margin-right"}m.addStyle(s(o),"100px")}I.addChild(S);if(e._isGroupCollapsed()){m.addStyle("display","none")}return m};p._getGroupHeaderElement=function(e){var t=new i("li"),s=new i("div"),l=new i("div"),n=new i("div"),o=new i("div"),m=new i("div"),p=new i("span"),C=new i("div"),u=new i("div"),T=new i("div"),I=e._orientation==="V"?l:n,g=new i("div"),S=new i("div"),h=new i("div");var _=e._isGroupCollapsed(),c=e._callParentFn("getShowIcons"),E;if(e._groupID){t.setAttribute("groupid",e._groupID)}if(e._isLastGroup){t.addClass("sapSuiteUiCommonsTimelineLastItem")}t.addControlData(e);t.addClass("sapSuiteUiCommonsTimelineGroupHeader");t.addChild(s);s.addChild(l);s.addClass("sapSuiteUiCommonsTimelineGroupHeaderDirectChild");l.addClass("sapSuiteUiCommonsTimelineGroupHeaderMainWrapper");l.setId(e.getId()+"-outline");l.setAttribute("tabindex","0");this._addAccessibilityTags(l,e,true);l.setAttribute("data-sap-ui-fastnavgroup",true);l.addChild(n);t.addChild(T);t.setAttribute("nodetype","GroupHeader");o.addClass("sapSuiteUiCommonsTimelineGroupHeaderSpanWrapper");if(e._orientation==="V"){t.addClass(e._position===r.Left?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight");t.setAttribute("role","treeitem");t.setAttribute("aria-level",1)}else{t.setAttribute("role","presentation")}n.addClass("sapSuiteUiCommonsTimelineGroupHeaderWrapper");n.addClass("sapSuiteUiCommonsTimelineGroupHeaderPointer");I.addChild(m);n.addChild(u);n.addChild(o);t.addClass(_?"sapSuiteUiCommonsTimelineGroupCollapsed":"sapSuiteUiCommonsTimelineGroupExpanded");u.addClass("sapSuiteUiCommonsTimelineGroupHeaderIconWrapper");E=e._getCorrectGroupIcon();e._objects.register("groupCollapseIcon",function(){var i=new a(e.getId()+"-groupCollapseIcon",{src:E,decorative:true});i.addStyleClass("sapSuiteUiCommonsTimelineGroupHeaderPointer");i.setParent(e);return i});u.addChild(e._objects.getGroupCollapseIcon());m.addClass("sapSuiteUiCommonsTimelineItemArrow");T.addClass("sapSuiteUiCommonsTimelineGroupHeaderLineWrapper");C.addClass("sapSuiteUiCommonsTimelineGroupHeaderLine");T.addChild(C);o.addChild(p);p.addClass("sapSuiteUiCommonsTimelineGroupHeaderSpan");var U=this._getGroupTypeLabel(e);if(U){p.addChildEscaped(" "+U+": "+e.getTitle())}else{p.addChildEscaped(" "+e.getTitle())}if(e._orientation==="V"){t.addChild(g);S.addChild(e._getLineIcon());g.addChild(S);S.addClass("sapSuiteUiCommonsTimelineItemBarIconWrapperV");g.addClass("sapSuiteUiCommonsTimelineGroupHeaderBarWrapper");if(!e._isGroupCollapsed()){g.addStyle("display","none")}h.addClass("sapSuiteUiCommonsTimelineItemBarV");if(!c){h.addClass("sapSuiteUiCommonsTimelineItemBarNoIcon")}g.addChild(h);if(e._additionalBarClass){h.addClass(d(e._additionalBarClass))}}return t};p._getVerticalTimelineItemElement=function(e){var t=new i("li"),a=new i("div"),s=new i("div"),l=new i("div"),n=new i("div"),o=new i("div"),m=new i("div"),p=new i("div"),C=new i("div"),u=new i("div"),T=new i("div"),I,g=new i("ul");var S=e._callParentFn("getShowIcons"),h=e._groupID,_=e.getText()==="GroupHeader",c=e._getStatusColorClass();if(_){return this._getGroupHeaderElement(e)}if(h){t.setAttribute("groupid",h);t.setAttribute("aria-level",2)}t.addClass("sapSuiteUiCommonsTimelineItem");t.setAttribute("aria-labelledby",e.getAriaLabelledBy().join(" "),true);if(e._isLast){t.addClass("sapSuiteUiCommonsTimelineLastItem")}a.addClass(_?"sapSuiteUiCommonsTimelineItemWrapperGrp":"sapSuiteUiCommonsTimelineItemWrapperV");t.addChild(a);a.addClass(e._position===r.Left?"sapSuiteUiCommonsTimelineItemWrapperVLeft":"sapSuiteUiCommonsTimelineItemWrapperVRight");a.addChild(n);a.addChild(s);s.addClass("sapSuiteUiCommonsTimelineItemBarWrapperV");l.addClass("sapSuiteUiCommonsTimelineItemBarIconWrapperV");if(c){l.addClass(d(c))}else{l.addClass("sapSuiteUiCommonsTimelineNoStatus")}if(S){s.addChild(l);l.addChild(e._getLineIcon("",h))}else{T.addChild(u);T.addClass("sapSuiteUiCommonsTimelineItemNoIconWrapper");u.addClass("sapSuiteUiCommonsTimelineItemNoIcon");s.addChild(T);if(c){u.addClass(d(c))}o.addClass("sapSuiteUiCommonsTimelineItemBarNoIcon")}o.addClass("sapSuiteUiCommonsTimelineItemBarV");s.addChild(o);if(e._additionalBarClass){o.addClass(d(e._additionalBarClass))}n.addClass("sapSuiteUiCommonsTimelineItemBubble");C.addClass("sapSuiteUiCommonsTimelineItemArrow");n.addChild(C);n.addChild(p);p.addClass("sapSuiteUiCommonsTimelineItemOutline");p.setId(e.getId()+"-outline");p.setAttribute("tabindex","0");this._addAccessibilityTags(p,e);m.addClass("sapSuiteUiCommonsTimelineItemBox");p.addChild(m);I=this._getTimelineItemShell(e);m.addChild(I);if(e._isGroupCollapsed()){g.addStyle("display","none")}if(h){g.addControlData(e);g.addClass("sapSuiteUiCommonsTimelineItemUlWrapper");g.addChild(t);return g}else{t.addControlData(e)}return t};p._getTimelineItemShell=function(e){var t=new i("div"),a=new i("div"),d=new i("div"),s=new i("span"),l,n,o=new i("span"),r=new i("div"),m=new i("div"),p=new i("div"),C=new i("span"),u=new i("div"),I=new i("span"),g=new i("div"),S;var h=e.getEmbeddedControl();t.setId(e.getId()+"-shell");t.addClass("sapSuiteUiCommonsTimelineItemShell");t.addChild(e._objects.getInfoBar());t.addChild(a);a.addClass("sapSuiteUiCommonsTimelineItemHeaderWrapper");l=e._getUserPictureControl();if(l){l.addStyleClass("sapSuiteUiCommonsTimelineItemUserPicture");a.addChild(l)}d.setId(e.getId()+"-header");d.addClass("sapSuiteUiCommonsTimelineItemHeader");d.addClass("sapSuiteUiCommonsTimelineItemTextLineClamp");s.setId(e.getId()+"-username");s.addClass("sapSuiteUiCommonsTimelineItemShellUser");d.addChild(s);n=e._getUserNameLinkControl();if(n){s.addChild(n)}else{s.addChildEscaped(e.getUserName());s.addClass("sapUiSelectable")}a.addChild(d);o.addClass("sapSuiteUiCommonsTimelineItemShellHdr");o.addClass("sapUiSelectable");o.addChildEscaped(" "+e.getTitle());d.addChild(o);r.addClass("sapSuiteUiCommonsTimelineItemShellDateTime");r.addClass("sapUiSelectable");r.addChildEscaped(this._getFormatedDateTime(e));r.setAttribute("aria-label",T,false);d.addChild(r);m.addClass("sapSuiteUiCommonsTimelineItemShellBody");t.addChild(m);if(h!==null){m.addChild(h)}else if(e.getText()){p.addChild(C);p.addClass("sapSuiteUiCommonsTimelineItemTextWrapper");C.setId(e.getId()+"-realtext");C.addClass("sapUiSelectable");m.addChild(p);S=e._checkTextIsExpandable();if(S){I.setId(e.getId()+"-threeDots");I.addClass("sapMFeedListItemTextString");I.addChildEscaped(" ");p.addChild(I);C.addChildEscaped(e._getCollapsedText(),true);I.addChildEscaped("... ");p.setAttribute("expandable",true)}else{C.addChildEscaped(e.getText(),true);u.addStyle("display","none")}m.addChild(u);u.addClass("sapSuiteUiCommonsTimelineItemShowMore");u.addChild(e._getButtonExpandCollapse())}if(e.getParent()&&e.getParent()._aFilterList&&(e._callParentFn("getEnableSocial")||e.getCustomAction().length>0)){g.addClass("sapSuiteUiCommonsTimelineItemShellBottom");g.addChild(e._objects.getSocialBar());t.addChild(g)}return t};p._addAccessibilityTags=function(e,i,t){var a;var d=i.getParent();if(d.isA("sap.suite.ui.commons.Timeline")&&d.getGroupByType()!==m.None&&d.getAxisOrientation()==="Vertical"){e.setAttribute("role","option")}else{e.setAttribute("role","listitem")}if(i.getStatus()){var s=new l;s.setText("status "+i.getStatus());s.toStatic();e.setAttribute("aria-describedby",s.getId(),true)}if(typeof i._index==="number"){e.setAttribute("aria-posinset",i._index+1);e.setAttribute("aria-setsize",i._callParentFn("_getItemsCount"))}if(t){var n=this._getGroupTypeLabel(i);if(!i._isGroupCollapsed()){if(n){a=C.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+n+" "+i.getTitle()+" "+C.getText("TIMELINE_ACCESSIBILITY_GROUP_EXPAND")}else{a=C.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+i.getTitle()+" "+C.getText("TIMELINE_ACCESSIBILITY_GROUP_EXPAND")}}else{if(n){a=C.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+n+" "+i.getTitle()+" "+C.getText("TIMELINE_ACCESSIBILITY_GROUP_COLLAPSE")}else{a=C.getText("TIMELINE_ACCESSIBILITY_GROUP_HEADER")+": "+i.getTitle()+" "+C.getText("TIMELINE_ACCESSIBILITY_GROUP_COLLAPSE")}}e.setAttribute("aria-label",a,false)}};p._getGroupTypeLabel=function(i){var t=i.getParent();var a=t.getGroupByType();var d={};d[e.TimelineGroupType.Year]="TIMELINE_YEAR";d[e.TimelineGroupType.Month]="TIMELINE_MONTH";d[e.TimelineGroupType.Quarter]="TIMELINE_QUARTER";d[e.TimelineGroupType.Week]="TIMELINE_WEEK";d[e.TimelineGroupType.Day]="TIMELINE_DAY";var s=d[a];if(s&&C.hasText(s)){return C.getText(s)}return undefined};return p},true);
//# sourceMappingURL=TimelineItemRenderer.js.map