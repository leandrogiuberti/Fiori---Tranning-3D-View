sap.ui.define(["sap/ui/core/mvc/OverrideExecution","sap/suite/ui/generic/template/lib/TemplateAssembler","sap/suite/ui/generic/template/ListReport/controller/ControllerImplementation","sap/suite/ui/generic/template/ListReport/controllerFrameworkExtensions","sap/suite/ui/generic/template/genericUtilities/testableHelper","sap/suite/ui/generic/template/listTemplates/filterSettingsPreparationHelper","sap/suite/ui/generic/template/js/staticChecksHelper","sap/suite/ui/generic/template/js/preparationHelper","sap/base/util/deepExtend","sap/suite/ui/generic/template/genericUtilities/FeError","sap/suite/ui/generic/template/js/StableIdHelper","sap/ui/model/Context","sap/suite/ui/generic/template/js/AnnotationHelper","sap/base/util/isEmptyObject","sap/suite/ui/generic/template/ListReport/AnnotationHelper","sap/insights/CardHelper"],function(e,t,a,i,n,l,r,o,s,u,c,p,d,b,f,g){"use strict";var m="ListReport.Component";function y(e,t){var n={};return{oControllerSpecification:{getMethods:a.getMethods.bind(null,n),oControllerDefinition:i,oControllerExtensionDefinition:{onInitSmartFilterBar:function(e){},provideExtensionAppStateData:function(e){},restoreExtensionAppStateData:function(e){},ensureFieldsForSelect:function(e,t){},addFilters:function(e,t){}}},oComponentData:{templateName:"sap.suite.ui.generic.template.ListReport.view.ListReport",designtimePath:"sap/suite/ui/generic/template/designtime/floorplans/ListReport.designtime"},init:function(){var t=e.getModel("_templPriv");t.setProperty("/listReport",{})},adaptToChildContext:function(e){n.adaptToChildContext(e)},refreshBinding:function(e,t,a,i){n.refreshBinding(e,t,i)},setFocus:function(e,t){n.setFocus(e,t)},getItems:function(){return n.getItems()},displayNextObject:function(e){return n.displayNextObject(e)},getTemplateSpecificParameters:function(a,i,n,g,y,S,v){function V(e,t){var i=a.getODataEntitySet(e);var n=a.getODataEntityType(i.entityType);var l,r,o;r=t.annotationPath;o=!!r&&n[r];if(o&&o.PresentationVariant){if(o.PresentationVariant.Visualizations){l=o.PresentationVariant.Visualizations[0].AnnotationPath}else if(o.PresentationVariant.Path){var s=o.PresentationVariant.Path.split("@")[1];var u=s&&n[s];l=u.Visualizations[0].AnnotationPath}}else if(o&&o.Visualizations){l=o.Visualizations[0].AnnotationPath}return!!(l&&l.indexOf("com.sap.vocabularies.UI.v1.Chart")>-1)}function h(){var e="/"+g;var t=new p(S,e);var a=v.getODataDraftFunctionImportName(t,"NewAction");return!!a}function E(e,t,i,n){var l=e?e.tableSettings:t.tableSettings;var o=false;var s=l.mode;if(l.multiEdit.enabled!==false&&(t.isResponsiveTable||t.tableSettings.type==="GridTable")&&!t.isWorklist){o=true;var u=i["Org.OData.Capabilities.V1.UpdateRestrictions"];if(u&&u.Updatable&&u.Updatable.Bool==="false"){o=false}else if(s==="None"){s=l.multiSelect?"MultiSelect":"SingleSelectLeft"}var c=l.multiEdit.annotationPath;if(c){r.checkErrorforMultiEditDialog(n,c);var p=n[c].Data;var d=p.filter(function(e){var t=e.RecordType==="com.sap.vocabularies.UI.v1.DataField"&&a.getODataProperty(n,e.Value.Path);return t&&t["sap:updatable"]!=="false"&&(!e["com.sap.vocabularies.UI.v1.Hidden"]||e["com.sap.vocabularies.UI.v1.Hidden"].Bool==="false")&&(!t["Org.OData.Core.V1.Immutable"]||t["Org.OData.Core.V1.Immutable"].Bool==="false")})}}return{multiEditEnabled:o,selectionMode:s,fields:d}}function T(e,i){function n(e){return{Create:{action:"Create",callbackName:"._templateEventHandlers.addEntry",text:A.createWithFilters?"{i18n>CREATE_NEW_OBJECT}":"{i18n>CREATE_OBJECT}",id:c.getStableId({type:"ListReportAction",subType:"Create",sQuickVariantKey:e}),press:"cmd:Create",enabled:true,isStandardAction:true},CreateWithFilters:{action:"CreateWithFilters",callbackName:"._templateEventHandlers.addEntryWithFilters",text:"{i18n>ST_CREATE_WITH_FILTERS}",id:c.getStableId({type:"ListReportAction",subType:"CreateWithFilter",sQuickVariantKey:e}),press:"cmd:CreateWithFilters",enabled:"{_templPriv>/generic/bDataAreShownInTable}",isStandardAction:true},Delete:{action:"Delete",callbackName:"._templateEventHandlers.deleteEntries",text:"{i18n>DELETE}",id:c.getStableId({type:"ListReportAction",subType:"Delete",sQuickVariantKey:e}),press:"cmd:Delete",enabled:"{_templPriv>/listReport/deleteEnabled}",isStandardAction:true}}}function l(e,t){if(b(e)){throw new u(m,"Identified an invalid value of 'logicalAction' i.e., '"+t.logicalAction+"' for a custom action in the manifest.")}return s({},e,{callbackName:t.press,text:t.text,id:t.id&&d.getBreakoutActionButtonId(t,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined),enabled:d.getBreakoutActionEnabledKey(t,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined),press:"cmd:"+t.logicalAction,isStandardAction:false})}function r(){var e=a.getObject(R.$path+"/"+f.getRelevantPresentationVariantPath(R,A.annotationPath));if(e&&e.Visualizations){var t=e.Visualizations.find(function(e){var t="/"+e.AnnotationPath.slice(1);return t.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1});if(t){return t.AnnotationPath.split("#")[1]||""}}if(A.quickVariantSelectionX){var n=R[A.quickVariantSelectionX.variants[i].annotationPath];if(n&&n.Visualizations){var l=n.Visualizations[0].AnnotationPath;if(l){if(l.indexOf("com.sap.vocabularies.UI.v1.LineItem")>-1){return(R.$path+"/"+l.slice(1)).split("#")[1]||""}}}}return""}var o=n(e);var p=t.getControllerExtensions();var S=[],v=Object.create(null),V=Object.create(null),h=Object.create(null);Object.values(p&&p.Actions||{}).forEach(function(t){if(t.logicalAction){if(A.quickVariantSelectionX&&A.quickVariantSelectionX.variants[i].entitySet&&A.quickVariantSelectionX.variants[i].entitySet!==g){return}o[t.logicalAction]=l(s({},o[t.logicalAction]),t)}else if(!t.global){var a=t.global?{type:"Action",subType:"Global",sAction:t.id}:{type:"ListReportAction",subType:"TableExtension",sAction:t.id,sQuickVariantKey:e};var n=c.getStableId(a);if(t.command){v[t.id]={id:n,action:t.command,callbackName:t.press};t.press="cmd:"+t.command}t.enabled=d.getBreakoutActionEnabledKey(t,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined);t.id=n;S.push(t)}});var E=r();(R["com.sap.vocabularies.UI.v1.LineItem"+(E?"#"+E:"")]||[]).forEach(function(e){switch(e.RecordType){case"com.sap.vocabularies.UI.v1.DataFieldForAction":var a=t.getToolbarDataFieldForActionCommandDetails(e,A,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined);if(!b(a)){V[a.id]=a}break;case"com.sap.vocabularies.UI.v1.DataFieldForIntentBasedNavigation":var a=t.getToolbarDataFieldForIBNCommandDetails(e,A,y,A.quickVariantSelectionX?A.quickVariantSelectionX.variants[i]:undefined);if(!b(a)){h[a.id]=a}break;default:break}});return{commandExecution:s(o,v,V,h),extensionActions:S}}var A=s({},i);A.targetEntities={};function C(e){if(!A.targetEntities[e.entityType]){A.targetEntities[e.entityType]=o.getTargetEntityForQuickView(a,e)}}A.bNewAction=i.useNewActionForCreate&&h();var P=t.getControllerExtensions();var k=P&&P.Actions;var D=a.getODataEntitySet(g);var R=a.getODataEntityType(D.entityType);var I=o.getLineItemFromVariant(a,D.entityType);var F;function O(e){if(e.type==="ResponsiveTable"){e.selectAll=e.selectAll!==false}e.selectAll=e.selectAll!==undefined&&e.selectAll}if(A.quickVariantSelectionX){var x=o.getNormalizedTableSettings(a,A,n,g,k,I);var L=A.quickVariantSelectionX.variants||{};for(var j in L){var N=L[j];var q=N.entitySet||g;var w=a.getODataEntitySet(q);if(!w){delete L[j];continue}N.isSmartChart=V(q,N);if(!N.isSmartChart){var W=o.getLineItemFromVariant(a,a.getODataEntitySet(q).entityType,N.annotationPath&&N.annotationPath.split("#")[1]);N.tableSettings=N.tableSettings||x;N.tableSettings=o.getNormalizedTableSettings(a,N,n,q,k,W);if(A.isResponsiveTable===undefined){A.isResponsiveTable=N.tableSettings.type==="ResponsiveTable"}else if(A.isResponsiveTable!==(N.tableSettings.type==="ResponsiveTable")){throw new u(m,"Variant with key "+j+" resulted in invalid Table Type combination. Please check documentation and update manifest.json.")}O(N.tableSettings);var X=a.getODataEntityType(w.entityType);if(X&&X.property&&N.tableSettings&&N.tableSettings.createWithParameterDialog){r.checkErrorforCreateWithDialog(X,N.tableSettings);A.quickVariantSelectionX.variants[j].tableSettings.createWithParameterDialog.id=c.getStableId({type:"ListReportAction",subType:"CreateWithDialog",sQuickVariantKey:L[j].key})}if(N.tableSettings.multiEdit){F=E(N,A,w,R);N.tableSettings.multiEdit.enabled=F.multiEditEnabled;if(F.multiEditEnabled){N.tableSettings.multiEdit.fields=F.fields;N.tableSettings.mode=F.selectionMode}}C(w);N.tableSettings=s(N.tableSettings,T(N.key,j))}}delete A.tableSettings;A.isResponsiveTable=A.isResponsiveTable===undefined||A.isResponsiveTable}else{A.tableSettings=o.getNormalizedTableSettings(a,i,n,g,k,I);A.isResponsiveTable=A.tableSettings.type==="ResponsiveTable";O(A.tableSettings);if(A.tableSettings.multiEdit){F=E(undefined,A,D,R);A.tableSettings.multiEdit.enabled=F.multiEditEnabled;if(F.multiEditEnabled){A.tableSettings.multiEdit.fields=F.fields;A.tableSettings.mode=F.selectionMode}}C(D);A.tableSettings=s(A.tableSettings,T())}A.controlConfigurationSettings=l.getControlConfigurationSettings(A,R,D,S);var H=l.getDatePropertiesSettings(A,R,D,S);var B=e.getModel("_templPriv");B.setProperty("/listReport/datePropertiesSettings",H);if(!A.subPages||A.subPages.length===0){B.setProperty("/listReport/bSupressCardRowNavigation",true)}else if(A.subPages[0].navigation){B.setProperty("/listReport/bSupressCardRowNavigation",true)}else if(A.quickVariantSelectionX){B.setProperty("/listReport/bSupressCardRowNavigation",true)}if(R&&R.property&&i&&A&&A.tableSettings&&A.tableSettings.createWithParameterDialog){r.checkErrorforCreateWithDialog(R,A.tableSettings);A.tableSettings.createWithParameterDialog.id=c.getStableId({type:"ListReportAction",subType:"CreateWithDialog"})}var M=l.getNavigationPropSettings(A,t.isDraftEnabled());A.filterSettings=s(A.filterSettings,M);A.isSelflinkRequired=true;A.isIndicatorRequired=true;A.isSemanticallyConnected=false;var U=e.getModel("_templPrivGlobal");A.bInsightsEnabled=!!U.getProperty("/generic/insights/oInsightsInstance");return A},executeAfterInvokeActionFromExtensionAPI:function(e){e.oPresentationControlHandler.setEnabledToolbarButtons();e.oPresentationControlHandler.setEnabledFooterButtons()},getCurrentState:function(){return n.getCurrentState.apply(null,arguments)},getInitialState:function(){return{permanentState:{}}},applyState:function(){return n.applyState.apply(null,arguments)},getStatePreserverSettings:function(){return{callAlways:false}}}}n.testableStatic(y,"Component_getMethods");return t.getTemplateComponent(y,"sap.suite.ui.generic.template.ListReport",{metadata:{library:"sap.suite.ui.generic.template",properties:{hideChevronForUnauthorizedExtNav:{type:"boolean",defaultValue:false},treeTable:{type:"boolean",defaultValue:false},gridTable:{type:"boolean",defaultValue:false},tableType:{type:"string",defaultValue:undefined},multiSelect:{type:"boolean",defaultValue:false},tableSettings:{type:"object",properties:{type:{type:"string",defaultValue:undefined},multiSelect:{type:"boolean",defaultValue:false},inlineDelete:{type:"boolean",defaultValue:false},selectAll:{type:"boolean",defaultValue:true},addCardtoInsightsHidden:{type:"boolean",defaultValue:false},selectionLimit:{type:"int",defaultValue:200},multiEdit:{type:"object",properties:{enabled:{type:"boolean",defaultValue:true},annotationPath:{type:"string"},ignoredFields:{type:"string",defaultValue:""}}},threshold:{type:"int",defaultValue:100},scrollThreshold:{type:"int",defaultValue:300}}},createWithFilters:"object",condensedTableLayout:"boolean",smartVariantManagement:{type:"boolean",defaultValue:false},hideTableVariantManagement:{type:"boolean",defaultValue:false},variantManagementHidden:{type:"boolean",defaultValue:false},createWithParameterDialog:{type:"object",properties:{fields:{type:"object"}}},creationEntitySet:"string",enableTableFilterInPageVariant:{type:"boolean",defaultValue:false},useNewActionForCreate:{type:"boolean",defaultValue:false},multiContextActions:"object",isWorklist:{type:"boolean",defaultValue:false},filterSettings:l.getFilterSettingsMetadata(),dataLoadSettings:{type:"object",properties:{loadDataOnAppLaunch:{type:"string",defaultValue:"ifAnyFilterExist"}}},quickVariantSelectionX:{type:"object",properties:{showCounts:{type:"boolean",defaultValue:false},enableAutoBinding:{type:"boolean",defaultValue:false},variants:{type:"object",mapEntryProperties:{key:{type:"string",optional:true},annotationPath:{type:"string"},entitySet:{type:"string",optional:true},tableSettings:{type:"object",properties:{type:{type:"string",defaultValue:undefined},multiSelect:{type:"boolean",defaultValue:false},inlineDelete:{type:"boolean",defaultValue:false},selectAll:{type:"boolean",defaultValue:true},selectionLimit:{type:"int",defaultValue:200}}}}}}},quickVariantSelection:{type:"object",properties:{showCounts:{type:"boolean",defaultValue:false},variants:{type:"object",mapEntryProperties:{key:{type:"string",optional:true},annotationPath:{type:"string"}}}}},annotationPath:{type:"string",defaultValue:undefined},editFlow:{type:"string",defaultValue:"display"}},manifest:"json"}})});
//# sourceMappingURL=Component.js.map