sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageToast","sap/m/MessageBox","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/suite/ui/generic/template/support/lib/Documentation","sap/suite/ui/generic/template/genericUtilities/polyFill","sap/ui/VersionInfo"],function(e,t,o,r,a,i){"use strict";var n=new r("support.DiagnosticsTool.controller.DiagnosticsTool").getLogger();var s=window.diagnosticToolSpace;var l=null;function c(){this.getView().attachAfterRendering(function(){m()});i.load().then(function(e){l=e})}function u(){var e=this.getView().getModel("data");if(e.getProperty("/status")==="Loading"){t.show("Application is still loading");return}var o=(new Date).toLocaleTimeString([],{hour12:false,hour:"2-digit",minute:"2-digit",second:"2-digit"});e.setData({properties:null,retrieval:o,copyEnabled:false});e.updateBindings();this.getView().getViewData().plugin.onRefresh()}function p(){var e="\r\n";var r="- ";var i=this.getView().getModel("data").getProperty();if(!(i&&i.properties&&i.url)){o.error("Could not copy data to your clipboard! No data collected",{title:"Error"});return}var n=i.properties;var s="*************+Extracted by SAP Fiori Elements Diagnostics Plugin [FEDiagnostic]+*************"+e;s+=r+"Extracted on "+(new Date).toUTCString()+e;s+=r+"Host: "+i.origin+e;s+=r+"Application status: "+i.status+e;if(i.statusMessage){s+=r+"Notice: "+i.statusMessage+e}s+=r+"Documentation: "+a.getDocuURL(l)+e;s+=e;s+="APP DATA"+e;for(var c=0,u=n.length;c<u;c++){if(n[c].type==="string"){s+=r+n[c].name+": "+n[c].value+e}else if(n[c].type==="link"){s+=r+n[c].name+": "+n[c].target+e}else if(n[c].type==="group"){s+="Group: "+n[c].name+e}}s+=e;s+="**************************"+e;s+=e;s+=e;s+="PROVIDE"+e;s+=r+"User/Password: <user>/<password>"+e;s+=r+"Steps to recreate the issue: <maybe also provide master data, pictures or video…>"+e;var p=this.getView().byId("CopyDataTextArea").getId();var d=document.getElementById(p);d.style.display="block";d.value=s;d.select();try{var g=document.execCommand("copy");if(g){t.show("Ticket relevant information copied to clip board")}else{o.error("Could not copy data to your clipboard! You can copy it manually from here: "+e+e+s,{title:"Error"})}}catch(t){o.error("Could not copy data to your clipboard! You can copy it manually from here: "+e+e+s,{title:"Error"})}finally{d.style.display="none"}}function d(){var e="<br>",r="</span>"+e,i="<span>",n=i+"- ",s=this.getView().getModel("data").getProperty();if(!(s&&s.properties&&s.url)){o.error("Could not copy data to your clipboard! No data collected",{title:"Error"});return}var c=s.properties,u=document.getElementById(this.getView().byId("CopyDataHTML").getId());var d=i+"*************+Extracted by SAP Fiori Elements Diagnostics Plugin [FEDiagnostic]+*************"+r;d+=n+"Extracted on "+(new Date).toUTCString()+r;d+=n+'Host: <a href="'+s.url+'" rel="noopener noreferrer">'+s.origin+"</a>"+r;d+=n+"Application status: "+s.status+r;if(s.statusMessage){d+=n+"Notice: "+s.statusMessage+r}d+=n+"Documentation: "+'<a href="'+a.getDocuURL(l)+'" rel="noopener noreferrer">'+a.getDocuURL(l)+"</a>"+r;d+=e;d+=i+"APP DATA"+r;for(var g=0,f=c.length;g<f;g++){if(c[g].type==="string"){d+=n+c[g].name+": "+c[g].value+r}else if(c[g].type==="link"){d+=n+c[g].name+': <a href="'+c[g].target+'" rel="noopener noreferrer">'+c[g].value+"</a>"+r}else if(c[g].type==="group"){d+=i+"Group: "+c[g].name+r}}d+=i+"**************************"+r;d+=e;d+=i+"PROVIDE"+r;d+=i+"User/Password: &lt;user&gt;/&lt;password&gt;"+r;d+=i+"Steps to recreate the issue: &lt;maybe also provide master data, pictures or video…&gt;"+r;function m(){try{document.getSelection().removeAllRanges()}catch(e){Function.prototype()}}u.innerHTML="";u.insertAdjacentHTML("beforeend",d);try{var y=document.createRange();m();y.selectNode(u);document.getSelection().addRange(y);document.execCommand("copy");m();t.show("Ticket relevant information copied to clip board with HTML format")}catch(e){m();p()}finally{u.innerHTML=""}}function g(){a.openDocumentation(l)}function f(e){e.parentNode.removeChild(e)}function m(){var e=document.querySelectorAll(".diagnosticPropertiesGroupHeaderContent");if(e.length===0){n.debug("No headers found which should be customized");return}var t,o;for(var r=0;r<e.length;r++){t=e[r];o=t.closest("td");o.classList.add("diagnosticPropertiesGroupHeader");o.colSpan=2;f(o.nextElementSibling)}}function y(e,t){var o=this.getView().getModel("data");o.setData({timeLeft:e,status:t})}function h(){if(s.fioriElementsPluginID){var e=document.getElementById(s.fioriElementsPluginID);if(e&&e.parentElement&&!e.parentElement.classList.contains("sapUiSupportHidden")){t.show("Data refreshed")}}}return e.extend("sap.suite.ui.generic.template.support.DiagnosticsTool.controller.DiagnosticsTool",{onInit:c,onRefreshData:u,onCopyDataPlain:p,onCopyDataHTML:d,onShowDocumentation:g,updateStatus:y,showDataRefreshed:h})});
//# sourceMappingURL=DiagnosticsTool.controller.js.map