sap.ui.define(["sap/ui/base/Object","sap/ui/core/UIComponent","sap/ui/model/resource/ResourceModel","sap/ui/core/mvc/ViewType","sap/ui/model/json/JSONModel","sap/ui/generic/app/ApplicationController","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/base/util/extend","sap/base/util/deepExtend","sap/ui/core/mvc/View","sap/ui/core/Element"],function(e,t,i,n,a,o,r,s,l,p,u){"use strict";var c=new r("js.QuickTemplates.QuickTemplateComponentFactory").getLogger();var d=e.extend("sap.suite.ui.generic.template.js.QuickTemplates.QuickTemplateComponentFactory");function g(e){var t=new i({bundleName:"sap/suite/ui/generic/template/QuickCreate/i18n/i18n"});var n=new i({bundleName:"sap/suite/ui/generic/template/QuickView/i18n/i18n"});t.enhance(n.getResourceBundle());var a=e.getModel("i18n");if(a){t.enhance(a.getResourceBundle())}e.setModel(t,"i18n")}function y(e){return e.getMetadata().getComponentName()+"::"+e.getViewName()+"::"+e.getEntitySet()}function f(e,t){var i=e.getTransactionController().getDraftController().getDraftContext().isDraftEnabled(e.getEntitySet());var n=null;var o=e.oContainer.getSettings();n=s({},o);delete n.appComponent;delete n.entitySet;delete n.navigationProperty;return new a({entitySet:e.getEntitySet(),entityType:t,"sap-ui-debug":window["sap-ui-debug"],isDraftEnabled:i,settings:n,manifest:e.getManifest()})}function h(e){return new Promise(function(e,t){var i=null;var a=this.getModel().getMetaModel();a.loaded().then(function(){var o=a.getODataEntitySet(this.getEntitySet());if(!o||!o.entityType){c.error("The specified entity set "+this.getEntitySet()+" was not found in loaded metadata of service");if(t){t()}return}var r=y(this);i=u.getElementById(r);if(i){c.warning("View with ID: "+r+" already exists - old view is getting destroyed now!");try{i.destroy()}catch(e){c.warning("Error destroying view: "+e)}i=null}var s=this.getComponentData()?this.getComponentData().preprocessorsData:null;i=p.create({async:true,viewData:{component:this},preprocessors:{xml:{bindingContexts:{meta:a.createBindingContext(a.getODataEntityType(o.entityType,true)),entitySet:a.createBindingContext(a.getODataEntitySet(this.getEntitySet(),true))},models:{meta:a,entitySet:a,parameter:f(this,o.entityType)},preprocessorsData:s}},id:r,type:n.XML,viewName:this.getViewName(),height:"100%"});e(i)}.bind(this))}.bind(e))}function m(){t.prototype.init.apply(this,arguments);this._oApplicationController=new o(this.getModel())}function C(){if(this._oApplicationController){this._oApplicationController.destroy()}this._oApplicationController=null}d.createQuickTemplateComponent=function(e,i){var n={metadata:{library:"sap.suite.ui.generic.template",properties:{viewName:{type:"string",defaultValue:null},entitySet:{type:"string",defaultValue:null}}},getAppComponent:function(){return this},onBeforeRendering:function(){var e=this.oContainer;var t=!this.createViewStarted&&this.getModel();if(t){t.getMetaModel().loaded().then(function(){if(!this.createViewStarted){this.createViewStarted=true;h(this).then(function(t){this.setAggregation("rootControl",t);if(this.oQuickCreateAPI){this.oQuickCreateAPI.fireQuickCreateViewCreated()}g(this);var i=this.getModel("i18n");if(i){t.setModel(i,"i18n")}e.invalidate()}.bind(this))}}.bind(this))}},getTransactionController:function(){return this._oApplicationController.getTransactionController()},getApplicationController:function(){return this._oApplicationController}};var a=i.init;i.init=function(){m.apply(this,arguments);if(typeof a==="function"){a.apply(this,arguments)}};var o=i.exit;i.exit=function(){C.apply(this,arguments);if(typeof o==="function"){o.apply(this,arguments)}};l(n,i);return t.extend(e,n)};return d});
//# sourceMappingURL=QuickTemplateComponentFactory.js.map