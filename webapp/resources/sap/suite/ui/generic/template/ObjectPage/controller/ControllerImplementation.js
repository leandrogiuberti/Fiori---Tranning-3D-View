sap.ui.define(["sap/ui/core/mvc/ControllerExtension","sap/m/MessageBox","sap/ui/model/Filter","sap/ui/model/Sorter","sap/ui/model/base/ManagedObjectModel","sap/fe/navigation/SelectionVariant","sap/suite/ui/generic/template/genericUtilities/controlHelper","sap/suite/ui/generic/template/genericUtilities/testableHelper","sap/suite/ui/generic/template/detailTemplates/detailUtils","sap/suite/ui/generic/template/ObjectPage/controller/MessageSortingHandler","sap/suite/ui/generic/template/ObjectPage/controller/MessageStripHelper","sap/suite/ui/generic/template/ObjectPage/controller/SectionTitleHandler","sap/suite/ui/generic/template/ObjectPage/controller/SideContentHandler","sap/suite/ui/generic/template/ObjectPage/extensionAPI/ExtensionAPI","sap/m/Table","sap/suite/ui/generic/template/lib/ShareUtils","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/suite/ui/generic/template/ObjectPage/controller/MultipleViewsHandler","sap/suite/ui/generic/template/lib/MessageUtils","sap/ui/events/KeyCodes","sap/base/util/merge","sap/ui/model/FilterProcessor","sap/suite/ui/generic/template/js/StableIdHelper","sap/base/util/extend","sap/base/util/isEmptyObject","sap/suite/ui/generic/template/genericUtilities/FeError","sap/suite/ui/generic/template/lib/CreateWithDialogHandler","sap/ui/Device","sap/base/strings/whitespaceReplacer","sap/base/util/deepExtend","sap/suite/ui/generic/template/ObjectPage/controller/CtxMenuHandler","sap/suite/ui/generic/template/ObjectPage/controller/inlineCreationRows/InlineCreationRowsHelper","sap/suite/ui/generic/template/ObjectPage/controller/RelatedAppsHandler","sap/suite/ui/generic/template/ObjectPage/controller/PasteHandler","sap/suite/ui/generic/template/lib/insights/InsightsHandler","sap/suite/ui/generic/template/lib/cards/DTCardHelper","sap/suite/ui/generic/template/lib/ai/EasyFill/EasyFillHandler","sap/ui/core/Element"],function(e,t,n,o,i,a,r,l,s,c,u,d,g,f,v,m,p,C,b,S,h,E,y,P,T,I,A,D,O,U,x,F,H,w,j,M,B,R){"use strict";var L="ObjectPage.controller.ControllerImplementation";var N=new p(L);var _=N.getLogger();var V=N.Level;_.setLevel(V.ALL);var k=20;function W(e){e.setSelectedSection(null)}function G(e){return e.data("creationMode")}function q(e,t){if(e.getBindings){var n=e.getBindings();for(var o=0;o<n.length;o++){q(n[o],t)}}else{var i=e.getType();e.setType(i,t)}}var z={getMethods:function(p,N,V){var z={};var J=s.getControllerBase(p,N,V);p.oController=V;var K;var $;var Q=new g(V,N,N.oComponentUtils.stateChanged);var X=new H(V,N);var Y=new w(V,N);var Z=new x(V,N,z,{deleteEntries:function(e,t){var n=e.getTable();var o=n.getId();Re(e,t,o)}});N.oSideContentHandler=Q;var ee;var te;var ne=Object.create(null);var oe=Object.create(null);var ie=null;var ae=null;N.initialStateAppliedPromise=null;var re=null;var le=Object.create(null);var se;var ce;var ue=Object.create(null);var de=Object.create(null);function ge(e){var t=e.getParameter("bindingParams");t.parameters=t.parameters||{};t.parameters.usePreliminaryContext=true;t.parameters.bCanonicalRequest=N.oServices.oApplication.mustRequireRequestsCanonical();t.parameters.batchGroupId="facets";return t}function fe(e){_.info("Activate object");var t=N.oServices.oCRUDManager.activateDraftEntity();var n=K.getModel("ui");var o=n.getProperty("/createMode");t.then(function(t){b.showSuccessMessageIfRequired(N.oCommonUtils.getText(o?"OBJECT_CREATED":"OBJECT_SAVED"),N.oServices);var n=V.getOwnerComponent();N.oServices.oViewDependencyHelper.setAllPagesDirty([n.getId()]);N.oServices.oViewDependencyHelper.unbindChildren(n);var i=n.getNavToListOnSave();var a=N.oServices.oApplication.getEditFlowOfRoot();if(a==="direct"&&e){J.utils.switchToNextObject()}else if(a==="direct"&&i!==false){N.oServices.oApplication.invalidatePaginatorInfo();N.oServices.oApplication.navigateAfterActivation(false)}else{N.oServices.oApplication.invalidatePaginatorInfo();var r=!i&&t.context;if(r){N.oServices.oApplication.setNextFocus(Xe)}N.oServices.oApplication.navigateAfterActivation(r)}},Function.prototype);t.catch(function(){N.oInfoObjectHandler.executeForAllInformationObjects("smartTable",function(e){e.onSaveWithError()})});var i={activationPromise:t};N.oComponentUtils.fire(V,"AfterActivate",i)}function ve(){if(le){for(var e in le){N.oCommonUtils.setEnabledToolbarButtons(V.byId(e))}le=Object.create(null)}}function me(e){var t=e.getSource();N.oServices.oApplication.addSideEffectPromise(new Promise(function(n,o){var i=N.oServices.oApplicationController.executeSideEffects(e.getSource().getBindingContext(),null,null,V.getOwnerComponent().getAppComponent().getForceGlobalRefresh(),{draftRootContext:N.oComponentUtils.getMainComponentDetails().bindingContext,callPreparationOnDraftRoot:true});i.then(function(){n();setTimeout(function(){if(t){t.focus()}})},o)}))}function pe(e,t){var n=V.getView();var o=n.getModel();var i=N.oComponentUtils.isComponentDirty();var a=o.getPendingChanges();var r=Object.create(null);if(a){for(var l in a){if(a.hasOwnProperty(l)){var s=o.getContext("/"+l);r[l]={context:s,change:a[l]}}}}var c=N.oServices.oCRUDManager.saveEntity();var u=false;var d=new Promise(function(o,a){c.then(function(l){if(!e){var s=N.oComponentUtils.getTemplatePrivateModel();s.setProperty("/objectPage/displayMode",1);ve();p.setEditable(false)}Ce(l,n,i,r,e,t,o,a);u=true},function(){N.oInfoObjectHandler.executeForAllInformationObjects("smartTable",function(e){e.onSaveWithError()});a()})});var g=e?Function.prototype:function(){if(u){Xe()}};N.oServices.oApplication.setNextFocus(g);var f={saveEntityPromise:c,sideEffectsExecutedPromise:d};N.oComponentUtils.fire(V,"AfterSave",f)}function Ce(e,t,n,o,i,a,r,l){var s=K.getModel("ui");var c=s.getProperty("/createMode");var u=V.getOwnerComponent();N.oServices.oViewDependencyHelper.setParentToDirty(u,u.getEntitySet(),1);N.oServices.oViewDependencyHelper.unbindChildren(u);var d=u.getNavToListOnSave();var g=N.oServices.oApplication.getEditFlowOfRoot();var f;if(g==="direct"){f=d===false||i}else{f=!d||i}if(f){if(a){J.utils.switchToNextObject()}else if(c){N.oComponentUtils.adaptUrlAfterNonDraftCreateSaved(t.getBindingContext(),i)}}else{p.navigateUp()}var v;if(c){v="OBJECT_CREATED"}else{v=n?"OBJECT_SAVED":"OBJECT_NOT_MODIFIED"}b.showSuccessMessageIfRequired(N.oCommonUtils.getText(v),N.oServices);var m=[];for(var C in o){var S=o[C];var h=S.context;var E=S.change;var y=Object.keys(E)||[];var P=y.indexOf("__metadata");if(P>-1){y.splice(P,1)}var T=N.oServices.oApplicationController.executeSideEffects(h,y);m.push(T)}Promise.allSettled(m).then(function(){r()})}function be(e){var t=e.getSource().getId();he("SaveAndContEdit",t)}function Se(e){var t=e.getSource().getId();he("SaveAndEditNext",t)}function he(e,t){var n;var o;var i;if(N.oComponentUtils.isDraftEnabled()){n=1;if(e==="SaveAndEditNext"){o=fe.bind(null,true);i=t}else{o=fe.bind(null,false);var a=e.getSource();i=r.isMenuButton(a)?y.getStableId({type:"ObjectPageAction",subType:"ActivateMenu"}):y.getStableId({type:"ObjectPageAction",subType:"CommonAction",sAction:"activate"})}}else{n=3;if(e==="SaveAndContEdit"){o=pe.bind(null,true,false);i=t}else if(e==="SaveAndEditNext"){o=pe.bind(null,true,true);i=t}else{o=pe.bind(null,false,false);i="save"}}N.oCommonUtils.executeIfControlReady(function(){var e=Promise.resolve(V.beforeSaveExtension());e.then(function(){var e=N.oComponentUtils.getCRUDActionHandler();e.handleCRUDScenario(n,o)}).catch(function(e){_.info("Can't proceed with 'Save' as 'beforeSaveExtension' failed "+e)})},i)}function Ee(e){var t=e.getSource();if(G(t)==="inline"){var i=e.getParameter("bindingParams");if(i.filters&&i.filters.length){var a=E.groupFilters(i.filters);var r=N.oComponentUtils.getTemplatePrivateModel();var l=r.getProperty("/objectPage/displayMode");if(!e.getParameter("messageFilterActive")&&!(l===4)){i.filters=new n({filters:[new n({filters:[new n({path:"IsActiveEntity",operator:"EQ",value1:true}),a],and:true}),new n({filters:[new n({path:"IsActiveEntity",operator:"EQ",value1:false}),new n({filters:[a,new n({path:"HasActiveEntity",operator:"EQ",value1:false})],and:false})],and:true})],and:false})}else{i.filters=a}}var s=i.sorter[0]&&i.sorter[0].getGroupFunction();var c=s&&function(e){var t=e.getObject();if(t.IsActiveEntity||t.HasActiveEntity){var n=P({},s(e));n.key=n.key.charAt(0)==="ยง"?"ยง"+n.key:n.key;return n}return{key:"ยง",text:N.oCommonUtils.getText("NEW_ENTRY_GROUP")}};if(t.data("disableInlineCreateSort")==="false"){var u=N.oCommonUtils.getMetaModelEntityType(t.getEntitySet());var d="DraftEntityCreationDateTime";var g=u.property.some(function(e){return e.name===d});if(!g){d="HasActiveEntity"}i.sorter.unshift(new o(d,g,c))}}}function ye(){return K.getHeaderTitle()}function Pe(e){var t=N.oComponentUtils.getTemplatePrivateModel();var n={sharePageToPressed:function(e){var n=N.oComponentUtils.getTitle();var o=t.getProperty("/objectPage/headerInfo/objectTitle");if(o){n=n+" - "+o}var i=N.oServices.oApplication.getBusyHelper();if(i.isBusy()){return}var a=V.getView().getBindingContext();var r=a.getObject().IsActiveEntity;var l=m.getCurrentUrl().then(function(t){if(r||r===undefined){switch(e){case"Email":sap.m.URLHelper.triggerEmail(null,n,t);break;default:break}}else{var o=N.oServices.oApplication.getDraftSiblingPromise(a);var l=sap.ui.require("sap/ushell/Container");var s=l.getServiceAsync("URLParsing");var c=Promise.allSettled([o,s]);i.setBusy(c.then(function(o){var i=o[0].value,a=o[1].value;var r=a?t.split(a.getHash(t))[0]+a.getShellHash(t)+"&"+i.sDeepPath:t;switch(e){case"Email":sap.m.URLHelper.triggerEmail(null,n,r);break;default:break}}))}});i.setBusy(l)},shareJamPressed:function(){m.openJamShareDialog(N.oComponentUtils.getTitle()+" "+t.getProperty("/objectPage/headerInfo/objectTitle"))},shareTilePressed:function(){m.fireBookMarkPress()},getModelData:function(){var e=V.getView().getBindingContext();var n=e.getObject().IsActiveEntity;var o=V.getOwnerComponent();var i=o.getAppComponent();var a=i.getManifestEntry("sap.app");var r=N.oComponentUtils.getViewLevel();var l=r>1;if(n===false){var s=N.oServices.oApplication.getDraftSiblingPromise(e),c=m.getCurrentUrl(),u=sap.ui.require("sap/ushell/Container"),d=u.getServiceAsync("URLParsing"),g=Promise.allSettled([s,c,d]);return g.then(function(e){var n=e[0].value,o=e[1].value,i=e[2].value,r=i?o.split(i.getHash(o))[0]+i.getShellHash(o)+"&"+n.sDeepPath:o,l=i?"#"+i.getShellHash(document.URL)+"&"+n.sDeepPath:n.sDeepPath;return{serviceUrl:"",appTitle:a?a.title:"",shellTitle:N.oComponentUtils.getTitle(),pageTitle:t.getProperty("/objectPage/headerInfo/objectTitle"),pageSubtitle:t.getProperty("/objectPage/headerInfo/objectSubtitle"),customUrl:l,currentUrl:r,appId:a.id,bEnableCollaborationShareAsCard:false}})}else{var f=new Promise(function(e){if(N.oComponentUtils.getViewLevel()!==1){e(null);return}z.oDTCardHelper.getCardManifest(M.CardTypes.ADAPTIVE).then(function(t){e(t)}).catch(function(){_.info("Design time card is not available");e(null)})});return Promise.all([f,m.getCurrentUrl()]).then(function(e){var n=e[0];var i=e[1];return{serviceUrl:"",appTitle:a?a.title:"",shellTitle:N.oComponentUtils.getTitle(),pageTitle:t.getProperty("/objectPage/headerInfo/objectTitle"),pageSubtitle:t.getProperty("/objectPage/headerInfo/objectSubtitle"),customUrl:m.getCustomUrl(),currentUrl:i,appId:a.id,bEnableCollaborationShareAsCard:!!n||o.getAppComponent().getObjectPageHeaderType()==="Dynamic"&&t.getProperty("/objectPage/displayMode")<2&&o.getAppComponent().getCollaborationSettings().isShareAsCardEnabled!==false&&!l,oDtCardManifest:n}})}}};m.openSharePopup(N.oCommonUtils,e,n,V)}var Te;function Ie(){Te=function(e){var t=N.oServices.oApplication.getBusyHelper();if(t.isBusy()){return}var n=V.getOwnerComponent();var o=n.getModel("_templPrivGlobal");var i={objectPage:{currentEntitySet:n.getProperty("entitySet")}};o.setProperty("/generic/multipleViews",i);var a=N.oServices.oCRUDManager.deleteEntity();var r=n.getBindingContext().getPath();var l=Object.create(null);l[r]=a;var s={deleteEntityPromise:a};N.oComponentUtils.fire(V,"AfterDelete",s);e.close()};return N.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(e){var t=e.getSource().getParent();t.close()},onDelete:function(e){var t=e.getSource().getParent();(N.oComponentUtils.isDraftEnabled()?N.oServices.oApplicationController.synchronizeDraftAsync():Promise.resolve()).then(Te.bind(null,t))}},"delete",Function.prototype,true)}function Ae(){var e=N.oServices.oApplication.getBusyHelper();if(e.isBusy()){return}var t=N.oComponentUtils.getTemplatePrivateModel();var n=(t.getProperty("/objectPage/headerInfo/objectTitle")||"").trim();var o=t.getProperty("/objectPage/headerInfo/objectSubtitle");var i=N.oComponentUtils.getViewLevel();var a=i>1;var r={};r.title=N.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");r.text=N.oCommonEventHandlers.getDeleteText(n,o,!a,a);var l=Promise.resolve(V.beforeDeleteExtension());l.then(function(e){P(r,e);Ie().then(function(e){var t=e.getModel("delete");t.setData(r);e.open()})},Function.prototype)}function De(){N.oCommonUtils.executeIfControlReady(Ae,"delete")}function Oe(){var e=K.getSections()||[];var t=e.find(function(e){return e.getVisible()&&e._bInternalVisible!==false});return!!t&&t.getId()===K.getSelectedSection()}function Ue(e){var t,n;if(e){n=e.context||(e.targetSiblingKey?e.draftAdministrativeData:e);if(N.oServices.oDraftController.getDraftContext().hasDraft(n)){N.oServices.oViewDependencyHelper.setRootPageToDirty();t=n.context||n}}var o=!K.getUseIconTabBar()&&Oe();var i;if(t){N.oServices.oApplication.switchToDraft(t,e.targetSiblingKey)}else{var a=N.oComponentUtils.getTemplatePrivateModel();a.setProperty("/objectPage/displayMode",2);var l=V.getView().getModel("ui");i=l.getProperty("/editable")}p.setEditable(true);if(!t){var s=[];if(!i){r.searchInTree(K,function(e){if(r.isSmartField(e)){if(e.getMode()==="edit"&&e.getBindingContext()){var t=e._getNextModeRenderedPromise();s.push(t)}return false}})}var c=N.oServices.oApplication.getBusyHelper();c.setBusy(Promise.allSettled(s))}N.oServices.oApplication.setNextFocus(Ze.bind(null,o))}var xe;function Fe(e){e=!!e&&typeof e==="boolean";var t=N.oServices.oCRUDManager.editEntity(e);t.then(function(e){if(e.draftAdministrativeData){xe(e.draftAdministrativeData.CreatedByUserDescription||e.draftAdministrativeData.CreatedByUser).catch(Function.prototype)}else{Ue(e)}});return t}xe=function(e){return new Promise((t,n)=>{var o;N.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.UnsavedChangesDialog",{onEdit:async function(){o.close();try{const e=await Fe(true);t(e.context)}catch(e){n(e)}},onCancel:function(){o.close();n()}},"Dialog",undefined,true).then(function(t){o=t;var n=N.oComponentUtils.getMainComponentUtils();var i=N.oServices.oApplication.getBusyHelper();i.setBusy(n);n.then(function(t){var n=t.getText("DRAFT_LOCK_EXPIRED",[e]);var i=o.getModel("Dialog");i.setProperty("/unsavedChangesQuestion",n);o.open()})})})};function He(){var e='{"SelectionVariantID":""}';var t=V.getOwnerComponent();var n=t.getEntitySet();var o=t.getModel();var i=o.getMetaModel();var r=i.getODataEntitySet(n);var l=i.getODataEntityType(r.entityType);var s=l.property;var c=[];for(var u in s){var d=s[u];var g=d["com.sap.vocabularies.Common.v1.FieldControl"]&&d["com.sap.vocabularies.Common.v1.FieldControl"].Path;if(g&&c.indexOf(g)<0){c.push(g)}}var f=V.getView().getBindingContext();var v=f.getObject();var m=new a;for(var p in s){var C=s[p].type;var b=s[p].name;var S=v[s[p].name];if(c.indexOf(b)>-1){continue}if(b&&(S||C==="Edm.Boolean")){if(C==="Edm.Time"&&S.ms!==undefined){S=S.ms}if(S instanceof Date){S=S.toJSON()}if(typeof S!=="string"){try{S=S.toString()}catch(e){S=S+""}}m.addParameter(b,S)}}e=m.toJSONString();return e}function we(e,t){var n=true;var o=t.getModel();t=t instanceof v?t.getParent():t;var i=N.oCommonUtils.getDeleteRestrictions(t);var a=i&&i.Deletable&&i.Deletable.Path;if(a){n=o.getProperty(a,e)}return n}var je;function Me(e,n,o,i){je=function(a){var l=N.oServices.oApplication.getBusyHelper();var s=0;var c;var u=V.getView().getModel().getObject(n[0].getPath());var d=N.oServices.oCRUDManager.deleteEntities({pathes:o,suppressRefreshAllComponents:true,smartTable:e});l.setBusy(d);N.oServices.oApplicationController.executeSideEffects(e.getBindingContext(),[],[e.getTableBindingPath()]);d.then(function(n){if(u.IsActiveEntity===false){c=0}else{c=n.length}s=o.length-c;var i="";if(s>0){var a=e.getTable();if(r.isUiTable(a)){var l=r.getSelectionPluginForUITable(a);if(l){l.clearSelection()}}if(s>1){i=N.oCommonUtils.getContextText("DELETE_SUCCESS_PLURAL_WITH_COUNT",e.getId(),null,[s])}else if(c>0){i=N.oCommonUtils.getContextText("DELETE_SUCCESS_WITH_COUNT",e.getId(),null,[s])}else{i=N.oCommonUtils.getContextText("ITEM_DELETED",e.getId())}}if(c>0){if(c>1){i+=i&&i+"\n";i+=N.oCommonUtils.getContextText("DELETE_ERROR_PLURAL_WITH_COUNT",e.getId(),null,[c])}else if(s>0){i+="\n";i+=N.oCommonUtils.getContextText("DELETE_ERROR_WITH_COUNT",e.getId(),null,[c])}else{i+=N.oCommonUtils.getContextText("DELETE_ERROR",e.getId())}}if(i){if(c>0){var d=!N.oComponentUtils.isDraftEnabled()&&o.length!==1;if(d){N.oServices.oApplication.removeTransientMessages();t.error(i)}}else{b.showSuccessMessageIfRequired(i,N.oServices)}}});var g={deleteEntitiesPromise:d,sUiElementId:i,aContexts:n};N.oComponentUtils.fire(V,"AfterLineItemDelete",g);a.close()};return N.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.TableDeleteConfirmation",{onCancel:function(e){e.getSource().getParent().close()},onDelete:function(e){je(e.getSource().getParent())}},"delete",Function.prototype,true)}function Be(e){var t=N.oCommonUtils.getOwnerControl(e,true);var n=N.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(t).getSelectedContexts();var o=e.getParent().getParent().getId();Re(t,n,o)}function Re(e,n,o){if(n.length===0){t.error(N.oCommonUtils.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:N.oCommonUtils.getContentDensityClass()});return}(N.oComponentUtils.isDraftEnabled()?N.oServices.oApplicationController.synchronizeDraftAsync():Promise.resolve()).then(function(){var t,i=[],a=[];if("getMode"in e.getTable()){t=e.getTable().getMode()}n.forEach(function(t){if(we(t,e)){a.push(t.getPath())}else{i.push(t)}});var r={};r.undeletableCount=0;r.tableMode=t;if(n.length>1){r.title=N.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[n.length]);r.text=N.oCommonUtils.getContextText("DELETE_SELECTED_ITEMS",e.getId())}else{r.title=N.oCommonUtils.getText("ST_GENERIC_DELETE_TITLE");r.text=N.oCommonEventHandlers.getSelectedItemContextForDeleteMessage(e,n[0],true)}if(i.length>0){r.undeletableText=N.oCommonUtils.getContextText("DELETE_UNDELETABLE_ITEMS",e.getId(),null,[i.length,n.length]);if(t==="Delete"){r.undeletableCount=i.length;r.undeletableText=undefined;r.text=N.oCommonUtils.getText("DELETE_UNDELETABLE_ITEM")}}var l={sUiElementId:o,aContexts:n};var s=Promise.resolve(V.beforeLineItemDeleteExtension(l));s.then(function(t){P(r,t);Me(e,n,a,o).then(function(e){if(!i.length){r.undeletableText=undefined}var t=e.getModel("delete");t.setData(r);e.open()})},Function.prototype)})}function Le(){var e=N.oComponentUtils.getTemplatePrivateModel();e.setProperty("/objectPage/isHeaderExpanded",true);var t=V.byId("template::ObjectPage::ObjectPageHeader");t.attachStateChange(function(t){var n=t.getParameter("isExpanded");e.setProperty("/objectPage/isHeaderExpanded",n)})}function Ne(){var e;var t;var n=N.oComponentUtils.getTemplatePrivateModel();var o=function(o){return function(i){var a=i.getSource();var r=a.getExternalValue();r=O(r);n.setProperty("/objectPage/headerInfo/"+o,r);if(o==="objectTitle"){N.oComponentUtils.setText(r);if(!r){var l=N.oComponentUtils.getHeaderDataAvailablePromise();l.then(function(o){r=a.getExternalValue();if(r){return}var i=V.getView();var l=o.getObject();var s=i.getModel("ui");var c=s.getProperty("/createMode");if(c&&l&&(l.IsActiveEntity===undefined||l.IsActiveEntity===false||l.HasActiveEntity===false)){e=e||N.oCommonUtils.getText("NEW_OBJECT");n.setProperty("/objectPage/headerInfo/objectTitle",e);N.oComponentUtils.setText(e)}else{var u=V.getOwnerComponent();if(u){var d=u.getAppComponent().getModel("i18n|"+u.getMetadata().getComponentName()+"|"+u.getEntitySet());var g=u.getAppComponent().getModel("i18n");var f=(g?g.getResourceBundle().hasText("UNNAMED_OBJECT"):false)||(d?d.getResourceBundle().hasText("UNNAMED_OBJECT"):false);if(f){t=t||N.oCommonUtils.getText("UNNAMED_OBJECT")}if(t){n.setProperty("/objectPage/headerInfo/objectTitle",t);N.oComponentUtils.setText(t)}}}})}}}};K.getCustomData().forEach(function(e){var t=e.getKey();if(t==="objectTitle"||t==="objectSubtitle"){var i=e.getBinding("value");var a=!i&&e.getBindingInfo("value");if(!i&&!a){n.setProperty("/objectPage/headerInfo/"+t,e.getValue());return}var r=o(t);if(i){i.attachChange(r);q(i,"string")}else{a.events={change:r};for(var l=0;l<a.parts.length;l++){a.parts[l].targetType="string"}}}})}function _e(e){e.preventDefault();var t=e.getSource().getId();var n=N.oInfoObjectHandler.getControlInformation(t);if(n){if(N.oComponentUtils.isDraftEnabled()){n.navigate()}else{N.oCommonUtils.fnProcessDataLossOrDraftDiscardConfirmation(n.navigate,Function.prototype)}}}function Ve(e){var t=[];for(var n=0;n<e.length;n++){if(e[n].getVisible()){t.push(e[n])}}return t}function ke(e){var t=e?e.getSubSections():K.getSections();var n=Ve(t);return n.length===1&&!!(e||ke(n[0]))}function We(e,t){var n=e.getParent();var o="sapSmartTemplatesObjectPageSubSectionGridExpand",i="sapUxAPObjectPageSubSectionFitContainer",a=t?"addStyleClass":"removeStyleClass";while(n){if(r.isGrid(n)){n[a](o)}else if(r.isObjectPageSubSection(n)){n[a](i);e.setFitContainer(t);return null}else{_.warning("Unexpected parent "+n.toString()+" in fnHandleUiTableExpand method")}n=n.getParent()}}function Ge(e,t){var n="sapUiSizeCompact",o="sapUiSizeCondensed",i;i=document.body;if(!e.bCondensedTableLayout||!(e.bSetFitContainer||t.hasStyleClass("sapUiSizeCondensed"))){return null}else if(e.bSetFitContainer&&i.classList.contains(n)){t.addStyleClass(o)}else{t.removeStyleClass(o)}}function qe(e,t,n){if(t.isA("sap.m.Table")){t.setGrowingThreshold(n.growingThreshold);t.setGrowingScrollToLoad(n.bGrowingScrollOnLoad)}else if(t.isA("sap.ui.table.Table")){We(e,n.bSetFitContainer);Ge(n,t)}}function ze(e,t,n){var o={growingThreshold:oe[t.getId()],bSetFitContainer:false,bGrowingScrollOnLoad:false};var i=V.getOwnerComponent().mProperties;o.bCondensedTableLayout=i.condensedTableLayout;if(i&&i.sections){var a=i.sections[n];if(a&&a.hasOwnProperty("condensedTableLayout")){o.bCondensedTableLayout=a.condensedTableLayout}}var r;if(K.getUseIconTabBar()){r=t.getParent();while(r&&r.sParentAggregationName!=="sections"){r=r.getParent()}}if(ke(r)){o.growingThreshold=k;o.bGrowingScrollOnLoad=true;o.bSetFitContainer=true}qe(e,t,o)}function Je(e){var t=K.getSelectedSection();var n=K.getSections();var o=-1;var i=e?1:-1;n.some(function(e,n){if(e.getId()===t){o=n;return true}});var a=o+i;while(a!==o){if(a<0){a=n.length}else if(a>=n.length){a=-1}else{var l=n[a];if(l.getVisible()){var s=l.getSubSections();var c=s.find(function(e){return e.getVisible()});if(c){N.oServices.oApplication.setNextFocus(r.focusUI5Control.bind(null,c));K.setSelectedSection(l);l.setSelectedSubSection(c);$e(l.getId(),c.getId());return}}}a+=i}}function Ke(e){var t=e&&e.getParameter("section");var n=t?t.getId():K.getSelectedSection();var o=e&&e.getParameter("subSection");var i=o&&o.getId();if(n!==ie||i!==ae){_.info("Selected Section: "+n+" and SubSection: "+n)}return{sNewSectionId:n,sNewSubSectionId:i}}function $e(e,t){ie=e;ae=t;N.oComponentUtils.stateChanged()}function Qe(e){var t=Ke(e);$e(t.sNewSectionId,t.sNewSubSectionId)}function Xe(){setTimeout(function(){var e=K.getHeaderTitle();var t=e.getActions();var n=t.find(function(e){return e.getVisible()&&e.getEnabled&&e.getEnabled()});if(n){r.focusControl(n.getId())}},0)}function Ye(e){var t=!e&&K.getSelectedSection();var n=t&&R.getElementById(t);var o=n&&n.getVisible()&&n;var i,a;if(o){i=n.getSelectedSubSection();a=i&&R.getElementById(i);a=a&&a.getVisible()&&a;i=a&&i}else{t=null}var l=r.searchInTree(K,function(e){if(r.isObjectPageSection(e)){if(t===e.getId()){t=null}if(t){return false}n=e;return null}if(r.isObjectPageSubSection(e)){if(i===e.getId()){i=null}if(i){return false}yt(e);K.setSelectedSection(n);n.setSelectedSubSection(e);return null}if(r.isSmartField(e)){return r.getSmartFieldIsFocussableForInputPromise(e).then(function(t){return t&&e})}if(r.isSmartTable(e)){var o=N.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(e);var a=o.getFirstFocussableEditableCellPromise();return a.then(function(t){if(t){return t}if(N.oComponentUtils.isDraftEnabled()){var n=N.oCommonUtils.getCreateButtonForTable(e);if(n&&n.isFocusable()){return n}var o=e.getToolbar();var i=o?o.getContent():[];var a=i.find(function(e){return r.isButton(e)&&e.isFocusable()});return a||false}return false})}return null});return Promise.resolve(l).then(function(e){if(!e){if(o){K.setSelectedSection(o);if(a){o.setSelectedSubSection(a)}}else{W(K)}}return e})}function Ze(e){setTimeout(function(){var t=V.hasOwnProperty("focusOnEditExtension");var n;if(t){var o=K.getSelectedSection();n=V.focusOnEditExtension(o)}if(n&&n.focus&&n.getDomRef()){if(r.isSmartField(n)){r.getSmartFieldIsFocussableForInputPromise(n).then(function(t){if(t){r.focusUI5Control(n)}else{_.info("Provided control is not focusable or visible in the viewport, hence fall back to the standard focus handling");et(e)}})}else{r.focusUI5Control(n)}}else{if(t){_.info("Provided control is not focusable or visible in the viewport, hence fall back to the standard focus handling")}et(e)}},0)}function et(e){var t=Ye(e);t.then(function(e){r.focusUI5Control(e)})}function tt(e){var t=e.getSource().getId();N.oInfoObjectHandler.pushCategory(t,"searchField");var n=N.oInfoObjectHandler.getControlInformation(t);n.rebindTable()}function nt(e){e.getControlAsync().then(function(){var t=V.byId(e.getSearchFieldId());if(t){t.setValue("");e.rebindTable()}})}function ot(){N.oInfoObjectHandler.executeForAllInformationObjects("searchField",nt,true)}function it(e,t){N.oCommonEventHandlers.addEntry(e,true)}function at(e,t){var n=N.oServices.oCRUDManager.getDefaultValues(t,e);if(n instanceof Promise){var o=function(e){rt(e,t)};n.then(o,o)}else{rt(e,t)}}function rt(e,t){var n=N.oCommonUtils.getOwnerControl(t,true);if(!t.data("CrossNavigation")){var o=G(n)==="inline";if(o){it(t,n);return}else if(N.oComponentUtils.isDraftEnabled()){N.oCommonEventHandlers.addEntry(t,false);return}}N.oCommonUtils.fnProcessDataLossOrDraftDiscardConfirmation(function(){N.oCommonEventHandlers.addEntry(t,false,undefined,e)},Function.prototype,"LeaveApp")}function lt(e){var t=y.getStableId({type:"ObjectPageAction",subType:"Create",sFacet:e});N.oCommonUtils.executeIfControlReady(function(t){N.oServices.oApplicationController.synchronizeDraftAsync().then(function(){var n=y.getStableId({type:"ObjectPageAction",subType:"CreateWithDialog",sFacet:e});var o=n&&V.byId(n);var i=N.oCommonUtils.getOwnerControl(t,true);var a=G(i);var r=["creationRows","creationRowsHiddenInEditMode"].includes(a);if(o){te.createWithDialog(o,t)}else if(r){z.oInlineCreationRowsHelper.handleAddEntry(i)}else{at(null,t)}})},t)}function st(e,t){var n=z.oMessageStripHelper.dataStateFilter(e,t);_.info("Filtering message "+e.getMessage()+" (id: "+e.getId()+") for table "+t.getId()+" returns "+n);return n}function ct(e){z.oMessageStripHelper.onClose(e)}function ut(){var e=V.getOwnerComponent().getModel("ui");e.bindProperty("/editable").attachChange(function(){var e=ne;ne=Object.create(null);for(var t in e){var n=e[t];n.refresh()}})}function dt(e){vt(e)}function gt(e,t){N.oServices.oApplicationController.synchronizeDraftAsync().then(function(){N.oServices.oApplication.performAfterSideEffectExecution(function(){N.oServices.oApplication.setNextFocus(t);var n=N.oServices.oApplication.getBusyHelper();n.setBusy(N.oServices.oApplication.getSwitchToSiblingFunctionPromise(e).then(function(e){e()}))},true)})}function ft(e){var t;return N.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.SwitchDraftAndActiveObjectPopOver",{onEditAndActiveToggle:function(n,o){var i=n.getParameter("item").getProperty("key");if(i===(o?"SwitchToActive":"SwitchToDraft")){return}var a=function(){r.focusUI5Control(e);t.close()};gt(o,a)}},"SwitchDraftAndActiveObjectPopOver",Function.prototype,true).then(function(e){t=e;return e})}function vt(e){var t,n=e.getId();var o=ee.isSmartControlMulti(e);if(o){t="NOITEMS_SMARTTABLE_WITH_FILTER_FOR_SEGMENTEDBUTTON"}else{var i=e.fetchVariant();var a=i&&i.filter&&i.filter.filterItems.length>0;if(!a){var r=N.oInfoObjectHandler.getControlInformation(n);var l=r.getSearchFieldId();var s=l&&V.byId(l);a=s&&s.getValue().trim()}t=a?"NOITEMS_SMARTTABLE_WITH_FILTER":"NOITEMS_SMARTTABLE"}var c=N.oCommonUtils.getContextText(t,n);e.setNoData(c)}p.refreshFacets=function(e){var t=function(t){var n=N.oInfoObjectHandler.getControlInformation(t.getId());if(n){n.refresh(e,false)}};K.getSections().forEach(function(e){e.getSubSections().forEach(t)})};p.onComponentActivate=function(e,t){J.onComponentActivate(e,t);le=Object.create(null)};p.getCurrentState=function(){var t=Object.create(null);var n=N.oServices.oApplication.getStatePreservationMode()==="persistence";function o(e){return{data:e,lifecycle:{permanent:true,pagination:n,page:false,session:true}}}if(ie){t.section=o(ie)}if(ae){t.subSection=o(ae)}var i={};N.oInfoObjectHandler.executeForAllInformationObjects("smartControl",function(e){i[e.getId()]=e.getControlStateWrapper().getState()});if(!T(i)){t.smartControls=o(i)}var a=Q.getCurrentState();if(a){t.sideContent=o(a)}var r=ee.getCurrentState();if(r){t.multipleViews=o(r)}t.objectPageLayout=o($.getState());var l=Object.create(null);V.provideCustomStateExtension(l);for(var s in l){t["$custom$"+s]=l[s]}var c=true;var u=function(n,o){if(!(n instanceof e)){throw new I(L,"State must always be set with respect to a ControllerExtension")}if(!c){throw new I(L,"State must always be provided synchronously")}var i=n.getMetadata().getNamespace();if(o){for(var a in o){t["$extension$"+i+"$"+a]=o[a]}}};V.templateBaseExtension.provideExtensionStateData(u);c=false;return t};function mt(){se={bLayoutFinished:false,bStateApplied:false,bRebindCompleted:false};ce=true}function pt(e){se[e]=true;bt()}function Ct(e){var t=true;for(var n in e.waitFor){if(e.waitFor[n]&&!se[n]){t=false;break}}return t}function bt(){var e=ce?"subSectionNotWaitingForViewPort":"subSection";var t=V.getView();N.oInfoObjectHandler.executeForAllInformationObjects(e,function(e){var n=e.getId();var o=e.getLoadingStrategy();var i=(ce||r.isElementVisibleOnView(n,t))&&Ct(o);if(i){if(ce){e.getControlAsync().then(function(t){o.activeHandler(t,e)})}else{var a=V.byId(n);var l=a.getParent();l.connectToModelsAsync().then(function(){N.oInfoObjectHandler.setInformationWithControl(a);o.activeHandler(a,e)})}}});if(ce){K._triggerVisibleSubSectionsEvents()}}function St(){if(re){re();re=null;pt("bStateApplied")}}function ht(){pt("bLayoutFinished")}function Et(){W(K);ht()}function yt(e){if(se&&se.bRebindCompleted){var t=N.oInfoObjectHandler.setInformationWithControl(e);var n=e.getId();var o=e.getParent();var i=o&&o.getId();if(i&&!de[i]){de[i]={firstSubSectionId:o.getSubSections()[0]?.getId()}}if(!ue[n]){V.onSubSectionEnteredExtension(e);ue[n]=true;if(i&&de[i].firstSubSectionId===n){z.oSectionTitleHandler.adjustSubSectionTitle(e);z.oSectionTitleHandler.addAccessibleName(e);z.oSectionTitleHandler.setHeaderSmartFormAriaLabelBy(e)}}if(t){ee.subSectionEntered(t);var a=t.getLoadingStrategy();var r=Ct(a);if(r){a.activeHandler(e,t)}}}}function Pt(e){N.oCommonEventHandlers.handleSideEffectForField(e,true)}function Tt(e){N.oCommonEventHandlers.handleSideEffectForField(e,false)}function It(e){var t=e.getSource();e.getSource()._getComputedMetadata().then(function(n){if(n.property.property&&n.property.property["com.sap.vocabularies.Communication.v1.IsEmailAddress"]&&n.property.property["com.sap.vocabularies.Communication.v1.IsEmailAddress"].Bool){e.preventDefault();N.oCommonEventHandlers.onRenderTeamsContactCollabOptions.call(this,t,t.getValue())}})}p.applyState=function(t,n){var o=N.oComponentUtils.getHeaderDataAvailablePromise()||Promise.resolve();o.then(function(){var o=Object.create(null);var i=Object.create(null);for(var a in t){if(a.indexOf("$custom$")===0){o[a.substring(8)]=t[a]}else if(a.indexOf("$extension$")===0){var r=a.substring(11,a.indexOf("$",11));var l=i[r];if(!l){l=Object.create(null);i[r]=l}var s=a.substring(a.indexOf("$",11)+1,a.length);l[s]=t[a]}}V.applyCustomStateExtension(o,n);var c=true;var u=function(t){if(!(t instanceof e)){throw new I(L,"State must always be retrieved with respect to a ControllerExtension")}if(!c){throw new I(L,"State must always be restored synchronously")}var n=t.getMetadata().getNamespace();return i[n]};V.templateBaseExtension.restoreExtensionStateData(u,n);c=false});Q.applyState(t.sideContent,n);ee.applyState(t.multipleViews,n);$.setState(t.objectPageLayout);N.oInfoObjectHandler.executeForAllInformationObjects("smartControl",function(e){e.getControlStateWrapper().setState(t.smartControls&&t.smartControls[e.getId()])});if(n){if(ie!==(t.section||"")){N.oComponentUtils.stateChanged()}St();ht();return}ot();if(t.section){ie=t.section;_.info("Restoring Selected Section: "+ie);K.setSelectedSection(ie);if(t.subSection){var i;K.getSections().some(function(e){if(e.getId()===t.section){i=e;return true}return false});if(i){i.setSelectedSubSection(t.subSection)}ae=t.subSection;_.info("Restoring Selected Subsection: "+ae)}ht()}else{Promise.all([o,N.oComponentUtils.getNavigationFinishedPromise()]).then(Et);ie=""}St()};p.prepareForControlNavigation=function(e){var t=K.getUseIconTabBar();if(!t){return}var n;var o=r.isElementVisibleOnView(e,false,function(e){var t=r.isObjectPageSection(e);if(t){return e.getId()}n=e.getId()});var i=o&&K.getSelectedSection();if(o!==i){K.setSelectedSection(o);$e(o,n)}};function At(e,t,n,o){var i=e.some(function(e){var t=N.oCommonUtils.getPositionableControlId(e.controlIds,true);return!t||r.isTable(r.byId(t))});if(i){ce=false;bt()}if(t){var a=N.oServices.oApplication.getBusyHelper(),l=new c(V,N,K),s=l.getPrepareMessageDisplayPromise(t,e,n,o);a.setBusy(s);return s}return Promise.resolve()}p.prepareForMessageHandling=function(e,t,n){return At(e,t,n,K.getBindingContext().getDeepPath())};p.applyHeaderContextToSmartTablesDynamicColumnHide=function(e){var t=e.getModel();var n=function(o,i){if(!o&&!e.getObject(e.getPath())){return}var a=i.getHiddenColumnInfo();if(T(a.columnKeyToHiddenPath)){return}var r=a.staticHiddenColumns.slice();var l=o&&n.bind(null,false,i);for(var s in a.columnKeyToHiddenPath){var c=a.columnKeyToHiddenPath[s];if(e.getProperty(c)){r.push(s)}if(l){var u=t.bindProperty(c,e);u.attachChange(l)}}i.getControlAsync().then(function(e){e.deactivateColumns(r)})};N.oInfoObjectHandler.executeForAllInformationObjects("smartTableWithColumnHide",n.bind(null,true))};var Fe=l.testable(Fe,"editEntity");var we=l.testable(we,"isEntryDeletable");var fe=l.testable(fe,"onActivateImpl");var pe=l.testable(pe,"onSaveImpl");l.testable(function(){return N.initialStateAppliedPromise},"getStateAppliedPromise");function Dt(){var e=N.oComponentUtils.getParameterModelForTemplating().getObject("/templateSpecific/sections");e.forEach(function(e){if(e.sExtensionPointNamePrefix!=="ReplaceFacet"){e.subSections.forEach(N.oInfoObjectHandler.initializeSubSectionInfoObject)}});var t=N.oComponentUtils.getParameterModelForTemplating().getObject("/treeNode");if(t&&t.leadingComponents){for(var n in t.leadingComponents){var o=t.leadingComponents[n];o.followingComponents.forEach(c)}}if(t&&t.facetsWithEmbeddedComponents){for(var i in t.facetsWithEmbeddedComponents){var a=t.facetsWithEmbeddedComponents[i];for(var r=0;r<a.length;r++){var l=a[r];var s=t.embeddedComponents[l];c(s)}}}function c(e){var t={};t.additionalData={};t.additionalData.facetId=e.sectionId;t.id=e.subSectionId;t.loadingStrategy="reuseComponent";N.oInfoObjectHandler.initializeSubSectionInfoObject(t)}}function Ot(e){var t=e.getSource();N.oCommonUtils.setEnabledToolbarButtons(t);if(le){le[t.getId()]=true}}function Ut(e,t){Z.beforeOpenContextMenu(e,t)}function xt(e,t){Z.onContextMenu(e,t)}var Ft={onInit:function(){K=V.byId("objectPage");var e=K.getShowHeaderContent();var t=N.oComponentUtils.getTemplatePrivateModel();t.setProperty("/objectPage/headerContentVisible",e);$=N.oCommonUtils.getControlStateWrapper(K);$.attachStateChanged(N.oComponentUtils.stateChanged);ut();var n=V.getOwnerComponent();N.initialStateAppliedPromise=new Promise(function(e){re=e});mt();z.oInsightsHandler=new j(z,V,N);Dt();var o=ye();var i=n.getAppComponent();var a=i.getObjectPageHeaderType()==="Dynamic";p.aBreadCrumbs=o&&o.getBreadcrumbs()===null?[]:o.getBreadcrumbs().getLinks();(p.aBreadCrumbs||[]).forEach(function(e,t){N.oComponentUtils.registerAncestorTitleUpdater(e,"text",t+1)});if(a){Le()}var l={controller:V,getPrepareMessageDisplayPromise:At};J.onInit(null,l);Ne();N.oCommonUtils.executeGlobalSideEffect();p.beforeRebind=function(e){ue=Object.create(null);mt();e.then(function(){pt("bRebindCompleted");z.oInlineCreationRowsHelper.onBeforeRebindObjectPage()});if(!re){N.initialStateAppliedPromise=new Promise(function(e){re=e})}N.oInfoObjectHandler.executeForAllInformationObjects("subSection",function(e){var t=V.byId(e.getId());if(t){e.getLoadingStrategy().inActiveHandler(t,e);return}})};p.afterRebind=function(){_.info("Call of _triggerVisibleSubSectionsEvents (afterRebind)");K._triggerVisibleSubSectionsEvents()};p.setFocus=function(e,t){var n=e.activeComponents;if(n.length>0&&!(t&&(t.isCreate||t.ignorePersistence))){var o=n[n.length-1];if(o===V.getOwnerComponent().getId()||N.oComponentUtils.getHierarchicalDistance(o)>0){var i=N.oServices.oApplication.getStatePreservationMode()==="persistence"||N.oComponentUtils.getCurrentKeys().every(function(t,n){return t===e.currentKeys[n]});if(i){var a=N.oComponentUtils.getLastFocus();if(a){r.focusControl(a.getId())}return}}}var l=K.getModel("ui");var s=l.getProperty("/editable");if(s){Ze(true)}else{Xe()}};K.attachEvent("subSectionEnteredViewPort",function(e){var t=e.getParameter("subSection");_.info("Viewport entered ","Subsection: "+t.getId());yt(t)});te=new A(z,V,N);z.oCreateWithDialogHandler=te;ee=new C(V,N,N.oComponentUtils.stateChanged);z.oMultipleViewsHandler=ee;z.oMessageStripHelper=new u(ee,V,N,J.state.messageButtonHelper);z.oInlineCreationRowsHelper=new F(K,N,G,V,z.oMessageStripHelper);z.oSectionTitleHandler=new d(V,K,N);z.oEasyFillHandler=new B(z,V,N,K);var t=N.oComponentUtils.getTemplatePrivateModel();var s=N.oServices.oInsightsFECardProvider&&N.oServices.oInsightsFECardProvider.getCardProviderInsightsInstance();z.oDTCardHelper=new M(V);if(s){N.oServices.oInsightsFECardProvider.fnRegisterComponentForProvider(z.oInsightsHandler,V.getView().getId())}N.oComponentUtils.attach(V,"PageDataLoaded",function(e){var t=N.oComponentUtils.getParameterModelForTemplating().getObject("/templateSpecific/streamEnabledAssociatedEntites");if(t&&t.length>0){for(var n=0;n<t.length;n++){var o=N.oCommonUtils.getStreamData(t[n],e.context);N.oCommonUtils.setStreamData(o,t[n])}}var i=N.oCommonUtils.getStreamData(null,e.context);N.oCommonUtils.setStreamData(i);N.oComponentUtils.hidePlaceholder()});var c=V.byId(y.getStableId({type:"ObjectPageAction",subType:"Share"})+"-internalBtn");if(c){c.attachPress(function(){Pe(c)})}},handlers:{onEditAndActiveToggle:function(){var e=K.getModel("ui");var t=e.getProperty("/editable");var n=function(){var e=V.createId(y.getStableId({type:"ObjectPageAction",subType:t?"ContinueEditing":"DisplayActiveVersion"}));setTimeout(r.focusControl.bind(null,e),0)};gt(!t,n)},addEntry:lt,onCancelCreateWithPopUpDialog:function(){te.onCancelPopUpDialog()},onSaveCreateWithPopUpDialog:function(e){te.onSavePopUpDialog(e)},submitChangesForSmartMultiInput:function(e){if(N.oComponentUtils.isDraftEnabled()){N.oCommonEventHandlers.submitChangesForSmartMultiInput(e)}},onSmartFieldModeToggled:function(e,t){var n=e.getSource();N.oCommonEventHandlers.onSmartFieldModeToggled(n,t)},deleteEntry:function(e){var t=N.oCommonUtils.getOwnerControl(e.getSource(),true);var n=[e.getParameter("listItem").getBindingContext()];var o=e.getSource().getId();Re(t,n,o)},deleteEntries:function(e){var t=y.getStableId({type:"ObjectPageAction",subType:"Delete",sFacet:e});N.oCommonUtils.executeIfControlReady(Be,t)},onSelectionChange:Ot,checkUpdateFinished:function(e){N.oCommonUtils.setEnabledToolbarButtons(e.getSource())},onMultiSelectionChange:function(e){N.oCommonEventHandlers.onMultiSelectionChange(e)},onCancel:function(){if(document.activeElement){document.activeElement.blur()}var e=N.oComponentUtils.isDraftEnabled();var t=y.getStableId({type:"ObjectPageAction",subType:"CommonAction",sAction:e?"discard":"cancel"});var n=R.getElementById(V.createId(t));var o=N.oServices.oApplication.getEditFlowOfRoot()==="direct";var i=!o&&!K.getModel("ui").getProperty("/createMode");var a=J.state.onCancel(n,i&&Xe);a.then(function(){if(!e){ve()}if(o){p.navigateUp()}},Function.prototype)},onContactDetails:function(e,t){N.oCommonEventHandlers.onContactDetails(e,t)},onSmartFieldInitialise:function(e){var t=this.getView().getId();N.oCommonEventHandlers.onSmartFieldInitialise(e,t)},onPressDraftInfo:function(e){var t=V.getView().getBindingContext();var n=R.getElementById(e.getSource().getId()+(e.getId()==="markChangesPress"?"-changes":"-lock"));N.oCommonUtils.showDraftPopover(t,n)},onPressDraftInfoObjectPageDynamicHeaderTitle:function(e){var t=V.getView().getBindingContext();var n=V.byId("template::ObjectPage::ObjectMarkerObjectPageDynamicHeaderTitle");N.oCommonUtils.showDraftPopover(t,n)},onSwitchDraftAndActiveObjectPopOver:function(e){var t=e.getSource();ft(t).then(function(e){e.openBy(t)})},onShareObjectPageActionButtonPress:function(e){N.oCommonUtils.executeIfControlReady(Pe,y.getStableId({type:"ObjectPageAction",subType:"Share"})+"-internalBtn")},onRelatedApps:function(e){X.getRelatedApps(e)},onSummarize:function(){N.oServices.oFioriAIHandler.fioriaiLib.summarize.summarize({view:V.getView()})},onEasyFillEdit:function(e){z.oEasyFillHandler.onEasyFillButtonClick(e)},onEdit:function(e){var t=V.byId("edit");if(t.data("CrossNavigation")){N.oCommonEventHandlers.onEditNavigateIntent(t);return}N.oCommonUtils.executeIfControlReady(Fe,"edit")},onEditByEasyFill:function(){return new Promise((e,t)=>{try{N.oServices.oApplication.performAfterSideEffectExecution(async function(){try{const n=await N.oServices.oCRUDManager.editEntity(false);if(n.draftAdministrativeData){const o=n.draftAdministrativeData.CreatedByUserDescription||n.draftAdministrativeData.CreatedByUser;try{const t=await xe(o);e(t)}catch(e){t(e)}}else{Ue(n);e(n.context)}}catch(e){t(e)}})}catch(e){t(e)}})},onValidateDraft:me,onSave:he,onSaveAndContinueEdit:be,onSaveAndEditNext:Se,onBreadCrumbUrlPressed:_e,onDelete:De,onCallActionFromToolBar:function(e){N.oCommonEventHandlers.onCallActionFromToolBar(e,J.state)},onCallAction:function(e,t,n,o){N.oServices.oApplication.performAfterSideEffectExecution(function(){var i=V.getView().getBindingContext();if(i){N.oServices.oDataLossHandler.performIfNoDataLoss(function(){var a=V.getOwnerComponent();var r=a.getEntitySet();var l=o?{ResultIsActiveEntity:true}:{};var s={functionImportPath:e,contexts:[i],sourceControlHandler:"",label:V.byId(t).getText(),operationGrouping:n,skipProperties:l};N.oServices.oCRUDManager.callAction(s).then(function(e){var t=e&&e[0];if(t&&t.context&&(!t.actionContext||t.actionContext&&t.context.getPath()!==t.actionContext.getPath())){N.oServices.oViewDependencyHelper.setParentToDirty(a,r,1)}})},Function.prototype,"Proceed",true)}},true)},onDataFieldForIntentBasedNavigation:function(e){e=h({},e);N.oServices.oApplication.performAfterSideEffectExecution(function(){N.oCommonUtils.fnProcessDataLossOrDraftDiscardConfirmation(function(){N.oCommonEventHandlers.onDataFieldForIntentBasedNavigation(e,J.state)},Function.prototype,"LeaveApp")},true)},onDataFieldWithIntentBasedNavigation:function(e){N.oCommonEventHandlers.onDataFieldWithIntentBasedNavigation(e,J.state)},onDataFieldWithEmail:function(e){N.oCommonEventHandlers.onDataFieldWithEmail(e)},onDataFieldWithNavigationPath:function(e){N.oCommonEventHandlers.onDataFieldWithNavigationPath(e)},onChartInit:function(e){var t=e.getSource();N.oInfoObjectHandler.setInformationWithControl(t);z.oSectionTitleHandler.setAsTitleOwner(t,true);t.getChartAsync().then(function(e){if(D.browser.safari){t.setHeight("50vH")}e.attachSelectData(Ot).attachDeselectData(Ot);N.oCommonUtils.checkToolbarIntentsSupported(t)})},onBeforeRebindDetailTable:function(e){var t=e.getSource();if(!t.getModel()){return}e.mParameters.bindingParams.events["dataReceived"]=dt.bind(null,t);z.oInlineCreationRowsHelper.onBeforeRebindControl(e);t.setNoData(N.oCommonUtils.getText("WAITING_SMARTTABLE"));var n=ge(e);var o=N.oInfoObjectHandler.getControlInformation(t.getId());var i=o.getSearchFieldId();if(i){var a=V.byId(i);var l=a&&a.getValue()||"";if(l){n.parameters.custom={search:l}}}N.oCommonEventHandlers.onBeforeRebindTable(e,{ensureExtensionFields:V.templateBaseExtension.ensureFieldsForSelect,addExtensionFilters:V.templateBaseExtension.addFilters,isFieldControlRequired:true,isPopinWithoutHeader:true,isDataFieldForActionRequired:true,isFieldControlsPathRequired:true,isMandatoryFiltersRequired:true,numberOfExpandedLevels:0});V.onBeforeRebindTableExtension(e);var s=n.events.refresh||Function.prototype;n.events.refresh=function(e){var n=t.getId();_.info("Data requested (SmartTable: "+n+")");ee.onDataRequested(n);s.call(this,e)};var c=n.events.dataReceived||Function.prototype;n.events.dataReceived=function(e){var n=e.getParameter("reason")==="SIDE_EFFECT_TARGET";if(n&&r.isMTable(t.getTable())){if(t.getTable().getRememberSelections()===false){t.getTable().removeSelections()}}N.oCommonEventHandlers.onDataReceived(t);var i=o.getHiddenColumnInfo();N.oCommonEventHandlers.hideTableCells(t,i);c.call(this,e)};ee.onRebindContentControl(t.getId(),n);Ee(e);z.oMessageStripHelper.onBeforeRebindControl(e);if(r.isAnalyticalTable(t.getTable())){n.parameters.entitySet=t.getEntitySet()}},onListNavigate:function(e){var t=N.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(N.oCommonUtils.getOwnerControl(e.getSource(),true)).getPressedItemParameter();var n=!!e.getParameters()[t].getBindingContext().isTransient();var o=U({},e);(n?N.oServices.oApplicationController.synchronizeDraftAsync():Promise.resolve()).then(function(){N.oCommonEventHandlers.onListNavigate(o,J.state)})},onBeforeSemanticObjectLinkPopoverOpens:function(e){var t=He();N.oCommonUtils.semanticObjectLinkNavigation(e,t,V,z)},onBeforeSemanticObjectLinkNavigationCallback:function(e){return N.oCommonEventHandlers.onBeforeSemanticObjectLinkNavigationCallback(e)},onSemanticObjectLinkNavigationPressed:function(e){var t=e.getParameters();var n=e.getSource();N.oCommonEventHandlers.onSemanticObjectLinkNavigationPressed(n,t)},onSemanticObjectLinkNavigationTargetObtained:function(e){var t=e.getParameters();var n=e.getSource();N.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(n.getEntitySet(),n.getFieldSemanticObjectMap(),t,J.state)},onSemanticObjectLinkNavigationTargetObtainedSmartLink:function(e){var t,n;t=e.getParameters();n=e.getSource();while(n.getMetadata().getName()!=="sap.ui.comp.smarttable.SmartTable"&&n.getParent()){n=n.getParent()}N.oCommonEventHandlers.onSemanticObjectLinkNavigationTargetObtained(n.getEntitySet(),{},t,J.state)},sectionChange:Qe,onSwitchTabs:Je,uploadStream:function(e){N.oCommonEventHandlers.uploadStream(e)},handleUploadComplete:function(e){N.oCommonEventHandlers.handleUploadComplete(e)},handleTypeMismatch:function(e){N.oCommonEventHandlers.handleTypeMismatch(e)},removeStream:function(e){N.oCommonEventHandlers.removeStream(e)},onInlineDataFieldForAction:function(e){N.oCommonEventHandlers.onInlineDataFieldForAction(e)},onInlineDataFieldForIntentBasedNavigation:function(e){N.oCommonEventHandlers.onInlineDataFieldForIntentBasedNavigation(e.getSource(),J.state)},onDeterminingDataFieldForAction:function(e){N.oCommonEventHandlers.onDeterminingDataFieldForAction(e)},onBeforeRebindChart:function(e){var t=e.getSource();if(!t.getModel()){return}ge(e);t.getChartAsync().then(function(e){t.oModels=e.oPropagatedProperties.oModels});var n={ensureExtensionFields:Function.prototype,addExtensionFilters:V.templateBaseExtension.addFilters,isFieldControlRequired:true,isMandatoryFiltersRequired:true};N.oCommonUtils.onBeforeRebindTableOrChart(e,n)},onToggleDynamicSideContent:Q.onToggleDynamicSideContent,sideContentBreakpointChanged:Q.sideContentBreakpointChanged,onTableInit:function(e,t){var n=e.getSource();var o=n.getTable();var a=N.oInfoObjectHandler.setInformationWithControl(n);z.oSectionTitleHandler.setAsTitleOwner(n,true);var l=new i(n);n.setModel(l,"tableobserver");z.oMessageStripHelper.initSmartTable(n,t);var s=a.getHiddenColumnInfo();if(s&&s.staticHiddenColumns&&s.staticHiddenColumns.length>0){n.deactivateColumns(s.staticHiddenColumns)}N.oCommonUtils.checkToolbarIntentsSupported(n);var c=r.isMTable(o);if(c||r.isUiTable(o)){var u=o.getId();var d=function(){if(c&&!oe[u]){oe[u]=o.getGrowingThreshold&&o.getGrowingThreshold()}ze(n,o,t)};K.attachEvent("subSectionVisibilityChange",d);d()}if(G(n)==="inline"&&!n.data("CrossNavigation")){o.addEventDelegate({onkeyup:function(e){if(e.ctrlKey&&e.keyCode===S.ENTER&&n.getEditable()){it(n,n);e.preventDefault();e.setMarked()}}})}N.oServices.oPresentationControlHandlerFactory.getPresentationControlHandler(n).addCellSelector()},onBeforeExport:function(e){N.oCommonEventHandlers.onBeforeExport(e)},onBeforePaste:function(e,t){Y.handleBeforePaste(e,t)},onPaste:function(e,t){Y.handlePaste(e,t)},onSearchObjectPage:tt,onUITableExpand:We,onSingleSectionOrSubsectionVisible:ke,dataStateFilter:st,dataStateClose:ct,onSmartFieldModelValueChanged:Pt,onTableSmartFieldModelValueChanged:Tt,beforeOpenContextMenu:Ut,onContextMenu:xt,onSmartFieldPress:It},formatters:{sideContentActionButtonText:Q.formatSideContentActionButtonText,setNoDataTextForSmartTable:function(e){if(N.oCommonUtils&&e){var t=N.oCommonUtils.getContextText("WAITING_SMARTTABLE",e);if(t!=="WAITING_SMARTTABLE"){return t}return""}},setVMVisibilityForVendor:function(){var e=new URL(window.location.href).searchParams;var t=e.get("sap-ui-layer");return!!(t&&t.toUpperCase()==="VENDOR")},formatItemTextForMultipleView:function(e){return e&&ee?ee.formatItemTextForMultipleView(e):""}},extensionAPI:new f(N,V,J,z)};Ft.handlers=P(J.handlers,Ft.handlers);return Ft}};return z});
//# sourceMappingURL=ControllerImplementation.js.map