sap.ui.define(["sap/ui/base/Object","sap/base/util/extend","sap/suite/ui/generic/template/genericUtilities/controlHelper","sap/ui/core/library","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/ui/core/Element","sap/ui/core/InvisibleText"],function(e,t,i,r,n,a,l){"use strict";var o="sapUiTableOnObjectPageAdjustmentsForSection";var g="ObjectPage.controller.SectionTitleHandler";var s=new n(g).getLogger();function c(e,t,n){var g=e.getOwnerComponent().getModel("_templPrivView");var c=Object.create(null);var u=e.getOwnerComponent().getAppComponent();t.getSections().forEach(function(e){var t=e.getSubSections();if(t.length===1){var i=t[0];var r=i.getId();c[r]={isStaticallySingleChild:true}}});function f(e,t){if(!u.getMergeObjectPageSectionTitle()){s.warning('Title of the section will not be adjusted as the manifest setting "mergeObjectPageSectionTitle" is set.');return}var n;for(var a=e;a;a=i.getParent(a)){if(i.isObjectPageSubSection(a)){if(a===e){var l=c[e.getId()];if(l&&l.titleOwner){l.titleOwner.reset()}return}n=a;break}}if(t&&(!n||n.getBlocks().concat(n.getMoreBlocks()).length>1)){return}var f=n.getParent();var v=f.getSubSections();var d=n.getId();var T=c[d];if(T){if(T.titleOwner){T.titleOwner.reset()}}else{T={};c[d]=T}var b=g.bindProperty("/#"+n.getId()+"/title");var S=e.getMetadata();var h=S.hasProperty("header");var p=(h?e.setHeader:e.setText).bind(e);var m=h?e.getHeader():e.getText();var y=S.hasProperty("headerLevel");var L=(y?e.setHeaderLevel:e.setLevel).bind(e);var O=S.hasProperty("headerStyle");var w=(O?e.setHeaderStyle:e.setTitleStyle).bind(e);var C=y?e.getHeaderLevel():e.getLevel();var H=O?e.getHeaderStyle():e.getTitleStyle();var A=function(){p(b.getValue());n.setShowTitle(false);n.setTitleLevel(r.TitleLevel.Auto);f.addStyleClass(o)};b.attachChange(A);T.titleOwner={reset:function(){p(m);L(C);w(H);f.removeStyleClass(o);n.setShowTitle(true);n.setTitleLevel(r.TitleLevel.H4);if(T.isStaticallySingleChild){f.setShowTitle(true);f.setTitleLevel(r.TitleLevel.H3)}delete T.titleOwner;b.destroy()}};A();if(T.isStaticallySingleChild){f.setShowTitle(false);f.setTitleLevel(r.TitleLevel.Auto)}L(T.isStaticallySingleChild?r.TitleLevel.H3:r.TitleLevel.H4);if(v.length===1){w(r.TitleLevel.H4)}}function v(e){if(e&&(typeof e.getTitleVisible==="function"&&!e.getTitleVisible()||typeof e.getEffectiveTitleLevel==="function"&&e.getEffectiveTitleLevel()==="H3")){var t=e.getAggregation("blocks");if(t&&t.length>0){var i=t[0];if(i.isA("sap.ui.layout.Grid")){var r=i.getAggregation("content");if(r&&r.length>0){r.forEach(function(e){if(e.isA("sap.ui.comp.smartform.SmartForm")){var t=e.getAggregation("content");var i=t.getAggregation("formContainers");if(i&&i.length>0){i.forEach(function(e){var t=e.getAggregation("title");if(t&&t.setLevel){t.setLevel("H4")}})}}})}}}}}function d(e){var t=e.getParent();var r=t&&typeof t.getTitleVisible==="function"&&t.getTitleVisible();var n=e&&typeof e.getTitleVisible==="function"&&e.getTitleVisible();if(r||n){return}var a=i.searchInTree(e,function(e){return i.isSmartForm(e)?e:null});if(!a||a.getAriaLabelledBy().length!==0){return}var l=t.getParent().getId();var o=t.getId();var g=l+"-anchBar-"+o+"-anchor";a.addAriaLabelledBy(g)}function T(e){var t=n.oInfoObjectHandler.getControlInformation(e.getId());e.getBlocks().concat(e.getMoreBlocks()).reduce(function(e,t){if(!t.getContent||!t.getContent()||!t.getContent().length){return e}t.getContent().reduce(function(e,t){if(i.isSmartForm(t)){e.push(t)}return e},e);return e},[]).forEach(function(e){if(!t||e.getGroups().length===1&&e.getGroups()[0].getTitle&&!e.getGroups()[0].getTitle()){var i=`${e.getId()}-ariaLabelBy-InvisibleText`,r=a.getElementById(i);if(!r){var n=!e.getCustomData()?[]:e.getCustomData().filter(function(e){return e.getKey()==="smartFormAriaLabel"});if(n.length&&n[0].getValue()){r=new l({id:i,text:n[0].getValue()}).toStatic()}}if(r){e._suggestTitleId(r.getId())}return}})}return{setAsTitleOwner:f,adjustSubSectionTitle:v,addAccessibleName:d,setHeaderSmartFormAriaLabelBy:T}}return e.extend("sap.suite.ui.generic.template.ObjectPage.controller.SectionTitleHandler",{constructor:function(e,i,r){t(this,c(e,i,r))}})});
//# sourceMappingURL=SectionTitleHandler.js.map