sap.ui.define(["sap/ui/base/Object","sap/base/util/extend"],function(t,e){"use strict";function n(t,e){function n(){return e.oCommonUtils.getDialogFragmentAsync("sap.suite.ui.generic.template.ObjectPage.view.fragments.RelatedAppsSheet",{buttonPressed:function(n){var r=n.getSource();var a=r.getBindingContext("buttons");var i=a.getProperty("link");var o=a.getProperty("param");var s=i.intent;var c=s.split("#")[1].split("-")[0];var p=s.split("-")[1].split("?")[0].split("~")[0];var v={semanticObject:c,action:p,parameters:o};e.oCommonUtils.fnProcessDataLossOrDraftDiscardConfirmation(function(){var n=t.getView().getBindingContext();e.oCommonEventHandlers.onRelatedAppNavigation(v,n)},Function.prototype,"LeaveApp")}},"buttons")}function r(t){var e=t.intent;var n=e.split("-")[0].split("#")[1];var r=e.split("-")[1].split("?")[0];return{link:t,semanticObject:n,action:r}}function a(a){var i=a.getSource();e.oServices.oApplication.performAfterSideEffectExecution(function(){var a=e.oServices.oApplication.getBusyHelper();var o=new Promise(function(o,s){var c=e.oServices.oApplication.getIntentPromise();var p=n();var v=sap.ui.require("sap/ushell/Container");var u=v&&v.getServiceAsync("Navigation");Promise.allSettled([c,p,u]).then(function(n){var c=n.some(function(t){return t.status==="rejected"});if(c){s();return}var p=n.map(function(t){return t.value});var v=p[0];var u=v.semanticObject;var l=v.action;var m=p[1];var f=t.getView().getBindingContext();var g=p[2];var b=f.getModel().getMetaModel();var d=f.getObject();var y=d.__metadata.type;var O=b.getODataEntityType(y);var A=O["com.sap.vocabularies.Common.v1.SemanticKey"];var S={};if(A&&A.length>0){for(var j=0;j<A.length;j++){var h=A[j].PropertyPath;if(!S[h]){S[h]=d[h]}}}else{for(var C in O.key.propertyRef){var x=O.key.propertyRef[C].name;if(!S[x]){S[x]=d[x]}}}var P=t.getOwnerComponent().getAppComponent();var k=[u];var R=e.oComponentUtils.getSettings();var w=R.relatedAppsSettings;w=t.modifyRelatedAppsSettings(w,u);var E=w&&Object.keys(w).length>0;if(E){for(const t in w){if(t&&w.hasOwnProperty(t)){const e=w[t].semanticObject;k.push(e)}}}k=Array.from(new Set(k));var U=k.map(t=>({semanticObject:t,params:S,ui5Component:P}));g.getLinks(U).then(function(t){var n=t.flat(Infinity);var s=n.map(r);var c=function(t){return t.String};var p=O["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]||[];var v=p.map(c);O.property.forEach(function(t){var e=t["com.sap.vocabularies.Common.v1.SemanticObjectUnavailableActions"]||[];v=v.concat(e.map(c))});s=s.filter(function(t){return t.semanticObject!==u||t.action!==l});s=s.filter(function(t){var e=t.semanticObject===u?"":t.semanticObject;var n=E&&w[e]&&w[e].semanticObjectAction;if(n){for(var r in n){if(n[r].action===t.action){return true}}return false}else{return v.indexOf(t.action)===-1}});s.sort(function(t,e){if(t.link.text<e.link.text){return-1}if(t.link.text>e.link.text){return 1}return 0});var f=m.getModel("buttons");var g=s.map(function(t){return{enabled:true,text:t.link.text,link:t.link,param:S}});if(g.length===0){g.push({enabled:false,text:e.oCommonUtils.getText("NO_RELATED_APPS")})}f.setProperty("/buttons",g);o();a.getUnbusy().then(m.openBy.bind(m,i))}).catch(s)})});a.setBusy(o)},true)}return{getRelatedApps:a}}return t.extend("sap.suite.ui.generic.template.ObjectPage.controller.RelatedAppsHandler",{constructor:function(t,r){e(this,n(t,r))}})});
//# sourceMappingURL=RelatedAppsHandler.js.map