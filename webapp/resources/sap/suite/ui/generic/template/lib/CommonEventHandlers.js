sap.ui.define(["sap/ui/base/Object","sap/ui/base/Event","sap/m/MessageBox","sap/ui/model/Sorter","sap/suite/ui/generic/template/genericUtilities/controlHelper","sap/suite/ui/generic/template/genericUtilities/expressionHelper","sap/suite/ui/generic/template/genericUtilities/testableHelper","sap/suite/ui/generic/template/genericUtilities/oDataModelHelper","sap/ui/model/json/JSONModel","sap/suite/ui/generic/template/js/AnnotationHelper","sap/ui/core/mvc/Controller","sap/suite/ui/generic/template/genericUtilities/FeLogger","sap/suite/ui/generic/template/lib/MessageUtils","sap/suite/ui/generic/template/lib/SideEffectUtil","sap/base/util/extend","sap/base/util/isEmptyObject","sap/base/util/deepExtend","sap/suite/ui/generic/template/lib/CRUDHelper","sap/ui/core/mvc/XMLView","sap/ui/comp/util/FormatUtil","sap/ui/unified/FileUploaderParameter","sap/ui/core/IconPool","sap/suite/ui/commons/collaboration/ServiceContainer","sap/suite/ui/generic/template/lib/ContactCardDetailHelper","sap/m/library","sap/m/Button","sap/ui/performance/trace/FESRHelper","sap/ui/core/CustomData","sap/m/VBox","sap/suite/ui/generic/template/genericUtilities/utils","sap/ui/core/Element","sap/ui/generic/app/util/ModelUtil"],function(e,t,a,n,i,r,o,s,l,c,u,g,v,p,d,f,m,C,E,h,T,b,S,y,P,I,x,D,A,O,_,N){"use strict";var F=new g("lib.CommonEventHandlers").getLogger();function R(e,g,R,L){function M(e){return L.getOwnerControl(e.getSource(),true)}function B(e){var t={};for(var a in e){var n=e[a];if(typeof n==="string"){t[a]=n}else if(typeof n==="object"){if(n.value){t[a]=B(n).value}else{t[a]=n}}}return t}var w=Object.create(null);var H;function U(t,a,n){var i=H;if(i){H=null;return i}var r=L.getOwnerPresentationControl(t);var o=R.oPresentationControlHandlerFactory.getPresentationControlHandler(r);var s=o.getCurrentContexts();if(!s){return null}s=L.filterActiveContexts(s);var l=o.getBinding();var c;var u=a.getBindingContext().getPath();if(!s.some(function(e,t){if(e&&e.getPath()===u){c=t;return true}})){return null}var v=o.isMTable&&o.isMTable();var p=Object.create(null);if(v){var d=r.getTable().getSelectedItems();d.forEach(function(e){p[e.getBindingContext().getPath()]=e})}var f=o.getThreshold&&o.getThreshold();var m=L.getOwnerControl(a);var C=m.getId();var E=g.isDraftEnabled()&&!e.getView().getModel("ui").getProperty("/editable");var h=function(e,t,r){var o=function(e){var r=e.getPath();var o=p[r];if(!o){var s=w[C];if(!s){var l=a.getSelected&&a.getSelected();s=a.clone();s.setParent(m);if(l){a.setSelected(true)}w[C]=s}s.setBindingContext(e);o=s}H=i;me(o,n,e,true,t)};if(E&&r){R.oApplication.registerContext(e,g.getViewLevel()+1);var s=R.oApplication.getDraftSiblingPromise(e);s.then(o)}else{o(e)}};i={listBinding:l,growingThreshold:f,selectedRelativeIndex:c,objectPageNavigationContexts:s,paginate:h};return i}function V(e,t){var a=L.getOwnerControl(e);if(a.getTable){a=a.getTable()}var n=i.isAnalyticalTable(a);g.setPaginatorInfo(n?null:U(a,e,t))}function G(e){var t=e.getSource(),a=t.getParent();L.setEnabledToolbarButtons(a)}var k;function j(e){k=e;return L.getDialogFragmentAsync("sap.suite.ui.generic.template.ListReport.view.fragments.DeleteConfirmation",{onCancel:function(e){var t=e.getSource().getParent();t.close()},onDelete:function(e){var t=e.getSource().getParent();var n=t.getModel("delete");var i=n.getProperty("/items");var r=[];var o=[];var s=[];var l=[];for(var c=0;c<i.length;c++){if(!i[c].draftStatus.locked&&i[c].deletable){if(!i[c].draftStatus.draft){if(i[c].draftStatus.draftActive){s.push(i[c].context.sPath)}else if(i.length===n.getProperty("/unsavedChangesItemsCount")||!i[c].draftStatus.unsavedChanges||n.getProperty("/unsavedChangesCheckboxSelected")){r.push(i[c].context.sPath)}}else{o.push(i[c].context.sPath);l.push(i[c].context.sPath)}}}o=o.concat(r).concat(s);var u={smartTable:k,pathes:o,onlyOneDraftPlusActive:o.length===2&&l.length===1&&s.length===1,suppressRefreshAllComponents:!(W()||K()),withWarningDialog:true};var g=R.oCRUDManager.deleteEntities(u);g.then(function(e){var t=0;var n=[];var i=e.some(function(e){return e.isWarning});for(var r=0;r<e.length;r++){n.push("/"+e[r].sPath.split("/")[1]);if(s.indexOf(n[r])!==-1){t=t+1}}var l=o.length-s.length;var c=e.length-t;var g=l-c;if(c>0){var p=!u.onlyOneDraftPlusActive&&l!==1;if(p){var d="";if(g>0){d+=L.getText("ST_GENERIC_NOT_DELETED_RECORDS",[c,l])}else{d=c>1?L.getText("ST_GENERIC_DELETE_ERROR_PLURAL"):L.getText("ST_GENERIC_DELETE_ERROR")}if(i){d+="\n";if(c===1){d+=L.getText("ST_GENERIC_DELETE_WITH_WARNING_SUGGESTION_SINGULAR")}else{d+=L.getText("ST_GENERIC_DELETE_WITH_WARNING_SUGGESTION_PLURAL")}}R.oApplication.removeTransientMessages();a.error(d)}}else{var f="";f=g>1?L.getText("ST_GENERIC_DELETE_SUCCESS_PLURAL"):L.getText("ST_GENERIC_OBJECT_DELETED");v.showSuccessMessageIfRequired(f,R)}},Function.prototype);t.close()}},"delete")}function W(){return g.getFclProxy()&&g.getFclProxy().isNextObjectLoadedAfterDelete()}function K(){return!!(g&&g.getSettings()&&g.getSettings().quickVariantSelectionX)}function J(e,t){return new Promise(function(a,n){t.read(e+"/SiblingEntity",{success:function(e){var n="/"+t.getKey(e);a(n)},error:function(){var e="Error";a(e)}})})}function q(t,a){var n=e.getView().getModel();var i=n.getMetaModel();var r=i.getODataEntitySet(e.getOwnerComponent().getEntitySet());var o=r["Org.OData.Capabilities.V1.DeleteRestrictions"];var s=o&&o.Deletable&&o.Deletable.Path?o.Deletable.Path:"";var l={items:undefined,itemsCount:t.length,text:{title:undefined,text:undefined,unsavedChanges:undefined,longText:undefined,undeletableText:undefined},lockedItemsCount:0,unsavedChangesItemsCount:0,undeletableCount:0,unsavedChangesCheckboxSelected:true,unsavedChangesCheckboxVisible:true,undeletableLocked:0,tableMode:""};var c=[];var u=[];var g,v,p,d,f,m;var C=[];for(var E=0;E<t.length;E++){g=n.getObject(t[E].getPath());if(!g.IsActiveEntity){if(g.HasActiveEntity){C.push(J(t[E].getPath(),n))}}}var h=0;return new Promise(function(e,i){Promise.all(C).then(function(i){for(var r=0;r<t.length;r++){g=n.getObject(t[r].getPath());v={};p={};d=true;f={};m=false;if(s){if(n.getProperty(s,t[r])===false){d=false;l.undeletableCount++}}if(!g.IsActiveEntity){v.draft=true;if(g.HasActiveEntity){p.draft=false;p.draftActive=true;if(i[h]!="Error"){f["oModel"]=t[0].getModel();f["sPath"]=i[h++]}if(f.sPath&&d&&n.getProperty(s,n.getContext(f.sPath))===false){d=false;l.undeletableCount++}}}else if(g.HasDraftEntity){var o=n.getProperty("DraftAdministrativeData/CreatedByUserDescription",t[r])||n.getProperty("DraftAdministrativeData/CreatedByUser",t[r]);m=n.getProperty("DraftAdministrativeData/InProcessByUser",t[r]);if(m){if(d===false){l.undeletableLocked++}v.locked=true;v.user=o;l.lockedItemsCount++}else if(d){v.unsavedChanges=true;v.user=o;l.unsavedChangesItemsCount++}}c.push({context:t[r],draftStatus:v,deletable:d});if(!g.IsActiveEntity&&g.HasActiveEntity){u.push({context:f,draftStatus:p,deletable:d})}}if(u.length>0){c=c.concat(u)}l.items=c;l.text.unsavedChanges=L.getText("ST_GENERIC_UNSAVED_CHANGES_CHECKBOX");if(l.itemsCount>1){var C=0;if(l.lockedItemsCount===l.itemsCount){l.text.text=L.getText("ST_GENERIC_DELETE_LOCKED_PLURAL")}else if(l.unsavedChangesItemsCount===l.itemsCount&&l.undeletableCount===0){l.text.text=L.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES_PLURAL")}else if(l.lockedItemsCount>0){C=l.itemsCount-l.lockedItemsCount;l.text.text=Q(l.lockedItemsCount,"ST_GENERIC_CURRENTLY_LOCKED_PLURAL","ST_GENERIC_CURRENTLY_LOCKED",[l.lockedItemsCount,l.itemsCount]);l.text.text+="\n";l.undeletableCount=l.undeletableLocked>0?l.undeletableCount-l.undeletableLocked:l.undeletableCount;if(l.undeletableCount>0&&C>=l.undeletableCount){l.text.text+=L.getText("ST_GENERIC_DELETE_UNDELETABLE",[l.undeletableCount,l.itemsCount]);C=C-l.undeletableCount;l.text.text+="\n"}if(l.unsavedChangesItemsCount&&C===l.unsavedChangesItemsCount){l.text.text+=Q(C,"ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL","ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");C=0}}else if(l.undeletableCount>0){C=l.itemsCount-l.undeletableCount;l.text.text=L.getText("ST_GENERIC_DELETE_UNDELETABLE",[l.undeletableCount,l.itemsCount]);l.text.text+="\n";if(l.unsavedChangesItemsCount&&C===l.unsavedChangesItemsCount||l.itemsCount===l.unsavedChangesItemsCount){l.text.text+=Q(C,"ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES_PLURAL","ST_GENERIC_DELETE_REMAINING_UNSAVED_CHANGES");C=0}}else{l.text.text=L.getText("ST_GENERIC_DELETE_SELECTED_PLURAL")}if(C>0){l.text.text+=C>1?L.getText("ST_GENERIC_DELETE_REMAINING_PLURAL",[C]):L.getText("ST_GENERIC_DELETE_REMAINING")}}else{var E;if("getMode"in a.getTable()){E=a.getTable().getMode()}if(l.lockedItemsCount>0){l.text.text=L.getText("ST_GENERIC_DELETE_LOCKED",[" ",l.items[0].draftStatus.user])}else if(l.undeletableCount>0){if(E==="Delete"){l.tableMode=E}l.text.text=L.getText("ST_GENERIC_NOT_DELETABLE")}else if(l.unsavedChangesItemsCount>0){l.text.text=L.getText("ST_GENERIC_DELETE_UNSAVED_CHANGES",[" ",l.items[0].draftStatus.user])}else{l.text.text=Y(a,t[0])}}if(l.lockedItemsCount===l.itemsCount){l.text.title=L.getText("ST_GENERIC_ERROR_TITLE")}else if(l.itemsCount&&l.lockedItemsCount+l.undeletableCount===l.itemsCount){l.text.title=L.getText("WARNING")}else{l.text.title=l.text.title=l.itemsCount>1?L.getText("ST_GENERIC_DELETE_TITLE_WITH_COUNT",[l.itemsCount]):L.getText("ST_GENERIC_DELETE_TITLE")}if(l.unsavedChangesItemsCount>0){if(l.unsavedChangesItemsCount!==l.itemsCount){if(l.lockedItemsCount>0){if(l.undeletableCount>0){if(l.itemsCount-l.lockedItemsCount-l.undeletableCount===l.unsavedChangesItemsCount){l.unsavedChangesCheckboxVisible=false}}else if(l.itemsCount-l.lockedItemsCount===l.unsavedChangesItemsCount){l.unsavedChangesCheckboxVisible=false}}else if(l.undeletableCount>0&&l.itemsCount-l.undeletableCount===l.unsavedChangesItemsCount){l.unsavedChangesCheckboxVisible=false}}else{l.unsavedChangesCheckboxVisible=false}}else{l.unsavedChangesCheckboxVisible=false}e(l)})})}function Q(e,t,a,n){var i;if(!n){i=e>1?L.getText(t):L.getText(a)}else if(e>1&&n.length>1){i=L.getText(t,[n[0],n[1]])}else if(n){i=L.getText(a,[n[1]])}return i}function Y(e,t,a){var n=R.oPresentationControlHandlerFactory.getPresentationControlHandler(e);var i=n.getTitleInfoForItem(t);return tt(i.title,i.subTitle,a,false,e)}function z(e){var t=g.getParameterModelForTemplating().oData.templateSpecific.teamsCollabOptions;var a=e.getSource().data("type");var n=t.find(function(e){return e.key===a});n.callBackHandler.call(this,e)}function X(t){if(!t){return t}var a=e.getOwnerComponent().getModel().getMetaModel();var n=a.getMetaContext(t.getPath()).getObject();var i=Object.create(Object.prototype);var r=t.getObject();n.property.forEach(function(e){if(r&&r[e.name]!==undefined){if((!e["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"]||e["com.sap.vocabularies.UI.v1.ExcludeFromNavigationContext"].Bool==="false")&&(!e["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"]||e["com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive"].Bool==="false")){i[e.name]=r[e.name]}}});return i}function $(e,t,a,n){var i=R.oApplication.getNavigationHandler();var r={};var o={};t.parameters=B(t.parameters);for(var s in t.parameters){if(f(t.parameters[s])){r[s]=t.parameters[s]}else{o[s]=t.parameters[s]}}i.mixAttributesAndSelectionVariant(Object.create(Object.prototype),a).getSelectOptionsPropertyNames().forEach(function(e){delete r[e]});var l=X(e);return d({},r,l,n,o)}function Z(e,t,a,n){var i;switch(t.length){case 0:i=[$(a,e,n,Object.create(Object.prototype))];break;case 1:i=[$(a,e,n,X(t[0]))];break;default:i=t.map(X);break}var r=R.oApplication.getNavigationHandler();return r.mixAttributesAndSelectionVariant(i,n)}function ee(t,a,n,i){var r,o;if(n){r=n.getUiState().getSelectionVariant();if(typeof r!=="string"){r=JSON.stringify(r)}}o=Z(t,a,e.getView().getBindingContext(),r);var s={semanticObject:t.semanticObject,action:t.action};e.adaptNavigationParameterExtension(o,s);if(!i){L.setComponentRefreshBehaviour(t)}R.oApplication.navigateExternal(t.semanticObject,t.action,o.toJSONString(),null,L.handleError)}function te(t,a){var n=R.oApplication.getNavigationHandler();var i={semanticObject:t.semanticObject,action:t.action};var r=n.mixAttributesAndSelectionVariant(t.semanticAttributes);L.removePropertiesFromNavigationContext(r,a);e.adaptNavigationParameterExtension(r,i);L.setComponentRefreshBehaviour(t);R.oApplication.navigateExternal(t.semanticObject,t.action,r.toJSONString(),null,L.handleError)}function ae(e,t){var a=e.byId("icon");var n=a&&a.getSrc();if(n===""){n=undefined}var i=e.byId("title");var r=i&&i.getText();if(r===""){r=undefined}var o=e.byId("description");var s=o&&o.getText();if(s===""){s=undefined}for(var l=0;l<t.length;l++){var u=t[l];var g=c.getStableIdPartFromFacet(u)+"::contactTitleAreaIcon";var v=e.byId(g);var p=c.getStableIdPartFromFacet(u)+"::contactTitleAreaTitle";var d=e.byId(p);var f=c.getStableIdPartFromFacet(u)+"::contactTitleAreaDescription";var m=e.byId(f);var C=v&&v.getSrc();if(C===""){C=undefined}var E=d&&d.getText();if(E===""){E=undefined}var h=m&&m.getText();if(h===""){h=undefined}if(n&&C&&r&&E&&s&&h){if((n===C||!C)&&(r===E||!E)&&(s===h||!h)){var T=c.getStableIdPartFromFacet(u)+"::contactTitleArea";var b=e.byId(T);if(b&&b.setVisible){b.setVisible(false)}}}}}function ne(t,a,n,i){var r=e.getOwnerComponent().getAppComponent().getManifestEntry("sap.app");var o=r.crossNavigation.outbounds[t.data("CrossNavigation")];ee(o,a?[a]:[],n,i)}function ie(e,t){var a=m({},e);L.fnProcessDataLossOrDraftDiscardConfirmation(function(){var e=a.data("SemanticObject");var t=a.data("Action");var n=a.data("SemanticAttributes");if(e&&t){var i={semanticObject:e,action:t};if(n){n="{"+n+"}";i.semanticAttributes=JSON.parse(n)}te(i,a)}},Function.prototype,"LeaveApp")}function re(t,a,n,i,r){var o,s,v;var p=e.getOwnerComponent().getModel().getMetaModel();var d=p.getODataEntitySet(t);var f=function(){var t=function(){var t=n.originalId;var a=e.getView().byId(t);if(!a){var i=document.querySelector("#"+t.replace(/(:|\.|\[|\]|,|=)/g,"\\$1"));if(i){var r=i.closest("[data-sap-ui]");if(r){a=_.getElementById(r.id)}}}return a};var a=g.getParameterModelForTemplating().oData.templateSpecific.targetEntities[d.entityType].mTargetEntities;s=t();v=s.getBindingContext().getPath();if(s){if(s.isA("sap.ui.comp.navpopover.SmartLink")){o=s&&s.mProperties.fieldName}else if(s.isA("sap.m.ObjectIdentifier")){var i=s.getBinding("text");if(i&&i.oType){o=i.sPath}else{o=s.getBinding("title").sPath}}}if(a[o]){var r=a[o].entityType;var l=p.getODataEntityContainer().entitySet.find(function(e){return e.entityType==r}).name;var c={navigation:a[o].navName,entitySet:l,entityType:r};var u=p.getODataEntityType(r);if(u&&u["com.sap.vocabularies.UI.v1.HeaderInfo"]){var f=p.getODataEntityType(r,true)+"/com.sap.vocabularies.UI.v1.HeaderInfo";c.headerInfoPath=f}if(u&&u["com.sap.vocabularies.UI.v1.QuickViewFacets"]){var m=p.getODataEntityType(r,true)+"/com.sap.vocabularies.UI.v1.QuickViewFacets";c.quickViewFacetODataPath=m}if(c.headerInfoPath||c.quickViewFacetODataPath){return c}}};var m=f();var C=false;var T=false;var b=false;var S=[];if(m){if(m.quickViewFacetODataPath){var y=p.createBindingContext(m.quickViewFacetODataPath,true);var P=y&&y.getModel().getObject(y.getPath());if(P){C=true;for(var I=0;I<P.length;I++){var x=P[I];if(x&&x.Target&&x.Target.AnnotationPath){if(x.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>-1){T=true}else if(x.Target.AnnotationPath.indexOf("com.sap.vocabularies.Communication.v1.Contact")>-1){b=true;S.push(x)}}}}}}var D=n.mainNavigation;var A=function(d){if(C){var f,P;f=p.getODataEntitySet(t);P=p.getODataEntityType(f.entityType);var I=m.headerInfoPath&&p.createBindingContext(m.headerInfoPath,true);var x=n.semanticObject;var A,O;if(x&&D){var _=D.getTarget&&D.getTarget()||"";var F=D.getKey&&D.getKey();if(F){var R=F.split(x+"-");A=R&&R[1];if(x&&A){O={Target:_,SemanticObject:x,Action:A}}if(n.semanticAttributes){O.SemanticAttributes=n.semanticAttributes;for(var L in n.semanticAttributes){var M=n.semanticAttributes[L];if(M.indexOf('{"__deferred":')>-1){delete O.SemanticAttributes[L]}if(M.indexOf('{"__ref":')>-1){delete O.SemanticAttributes[L]}}if(O.SemanticAttributes){var B=JSON.stringify(O.SemanticAttributes);if(B&&B.length>1){O.SemanticAttributes=B.substring(1,B.length-1)}}}}}var w=p.getODataProperty(P,o);var H=new l({sourceClickedField:w,sourceEntityType:P,showFieldGroup:T,showContact:b,ignoredFields:a,navigationPath:m.navigation,mainNavigation:O});H.setDefaultBindingMode("OneWay");var U;var V=u.extend("",{oState:i,_templateEventHandlers:{onSemanticObjectLinkNavigationPressed:e._templateEventHandlers.onSemanticObjectLinkNavigationPressed.bind(e._templateEventHandlers),onDataFieldWithIntentBasedNavigation:e._templateEventHandlers.onDataFieldWithIntentBasedNavigation.bind(e._templateEventHandlers),onDataFieldWithEmail:e._templateEventHandlers.onDataFieldWithEmail.bind(e._templateEventHandlers),onTeamsCollabOptionPress:z.bind(this),onContactDetails:qe.bind(this),onSmartFieldModeToggled:Function.prototype,onSmartFieldModelValueChanged:Function.prototype,submitChangesForSmartMultiInput:Function.prototype,onDataFieldWithNavigationPath:e._templateEventHandlers.onDataFieldWithNavigationPath?.bind(e._templateEventHandlers)||Function.prototype,onSmartFieldPress:e._templateEventHandlers.onSmartFieldPress?.bind(e._templateEventHandlers)||Function.prototype},onInit:function(){},onExit:function(){},onAfterRendering:function(){var e=this.oView;var t=e.getParent().getParent().getParent();t.setBusy(false)}});U=new V;V.connectToView=e.connectToView.bind(U);var G=function(e){var t=e.getSource();if(t){var a=t.getParent().getParent().getParent();a.setBusy(true);a.setBusyIndicatorDelay(10)}};E.create({preprocessors:{xml:{bindingContexts:{sourceEntitySet:p.createBindingContext(p.getODataEntitySet(t,true)),entitySet:p.createBindingContext(p.getODataEntitySet(m.entitySet,true)),header:I,facetCollection:y},models:{sourceEntitySet:p,entitySet:p,header:p,facetCollection:p,quickView:H,parameter:g.getParameterModelForTemplating()}}},controller:U,viewName:"sap.suite.ui.generic.template.fragments.QuickViewSmartForm",height:"100%"}).then(function(e){n.show(undefined,undefined,undefined,e);e.attachBeforeRendering(G.bind(this));var t=function(e){var t=e.getSource();if(t){var a=t.byId("ownTitleArea");if(a){var n=t.getParent();if(n&&n.getItems){var i=n.getItems()&&n.getItems()[0];if(i&&i!=t){i.setVisible(false)}}}if(b&&S&&a){ae(t,S)}}};e.attachAfterRendering(t.bind(this))}.bind(this))}else{if(s.getFieldName){var k=N.getEntityTypeFromContext(s.getBindingContext());var j=k.property.find(function(e){return e.name===o});var W="descriptionAndId";if(j){W=c.getTextArrangement(k,j)}var K=s.getBinding("text").getValue();if(Array.isArray(K)){var J=h.getTextsFromDisplayBehaviour(W,K[0],K[1]);if(!j["sap:unit"]&&D){D.setDescription(J.secondText)}r=J.firstText;if(!!j["sap:unit"]&&J.secondText){r=J.firstText+" "+J.secondText}}}oe(k,n,d,s,v);n.show(r,D,undefined,undefined)}};Ke().then(function(e){A.call(this,e)}).catch(function(e){A.call(this)})}function oe(t,a,n,i,r){var o=a&&a.popoverForms;if(n&&n.length&&i.mProperties.contactAnnotationPath&&o&&o.length){var s=e.getOwnerComponent().getModel();var l=e.getOwnerComponent().getModel("i18n");var c=s.getMetaModel();var u=c.getODataAssociationEnd(t,i.mProperties.contactAnnotationPath);var g=c.getODataEntityType(u.type);var v=g["com.sap.vocabularies.Communication.v1.Contact"];var p=v&&v.email[0].address&&v.email[0].address.Path;var d=r+"/"+i.mProperties.contactAnnotationPath+"/"+p;var f=function(e,t){var a=s.getProperty(d);t.getSource().addCustomData(new D({key:"email",value:a}));e.call(this,t)};var m=[];var C=new sap.m.Title({text:l.getResourceBundle().getText("CONTACT_OPTION")}).addStyleClass("sapUiTinnyMarginTop");var E=new sap.m.ToolbarSpacer;m.push(C);m.push(E);for(var h in n){var T=n[h];var b=new I({icon:T.icon,type:"Transparent",press:f.bind(this,T.callBackHandler),tooltip:T.tooltip}).addStyleClass("sapUiTinyMarginEnd");b.addCustomData(new D({key:"type",value:T.key}));x.setSemanticStepname(b,"press",T.fesrStepName);m.push(b)}var S=new A({items:[new sap.m.Toolbar({height:"1px"}),new sap.m.Toolbar({content:m})]});o[0].insertContent(S,1)}}function se(e){return new Promise(function(t){L.fnProcessDataLossOrDraftDiscardConfirmation(function(){L.setComponentRefreshBehaviour({semanticObject:e.semanticObject,action:e.href.split("?")[0].split("-")[1]});t(true)},function(){t(false)},"LeaveApp")})}function le(e,t){var a=e.getView&&e.getView().getBindingContext();var n=a.getObject();var i=e.getOwnerComponent().getModel().getMetaModel();var r=i.getODataEntitySet(e.getOwnerComponent().getEntitySet());var o=i.getODataEntityType(r.entityType);var s=o["com.sap.vocabularies.Common.v1.SemanticKey"];var l={};if(s&&s.length>0){for(var c=0;c<s.length;c++){var u=s[c].PropertyPath;if(!l[u]){l[u]=[];l[u].push(n[u])}}}else{for(var g in o.key.propertyRef){var v=o.key.propertyRef[g].name;if(!l[v]){l[v]=[];l[v].push(n[v])}}}return l}function ce(e,t,a,n){if(e[t].entitySet==a&&n===e[t].navigationProperty&&e[t].navigation&&e[t].navigation["display"]&&(e[t].component&&e[t].component.settings&&e[t].component.settings.hideChevronForUnauthorizedExtNav===true)){return e[t].navigation.display.target}else if(e[t].entitySet==a&&e[t].navigation&&e[t].navigation["display"]&&(e[t].component&&e[t].component.settings&&e[t].component.settings.hideChevronForUnauthorizedExtNav===true)){return e[t].navigation.display.target}else if(e[t].pages){for(var i=0;i<e[t].pages.length;i++){var r=ce(e[t].pages,i,a,n);if(r!==undefined&&r!==null){return r}}}}function ue(t){var a=t.getTable();var n=t.getEntitySet();var r=t.getTableBindingPath();var o=sap.ui.require("sap/ushell/Container");var s=o&&o.getServiceAsync("Navigation");var l=e.getOwnerComponent().getAppComponent().getConfig().pages;var c=ce(l,0,n,r);if(c!==undefined&&c!==null&&s){var u=e.getOwnerComponent().getAppComponent().getManifestEntry("sap.app").crossNavigation.outbounds[c];if(u){var g=u.semanticObject;var v=u.action;var p=e.getView().getModel("_templPriv");var m=p.getProperty("/generic/supportedIntents/");var C=r===""?n:n+"::"+r;var E=p.getProperty("/generic/supportedIntents/"+g+"/"+v+"/"+C);if(!E){var h={},T;var b=e.getOwnerComponent().getAppComponent();for(var S in u.parameters){if(!f(u.parameters[S])){h[S]=u.parameters[S]}}if(e.getMetadata().getName()==="sap.suite.ui.generic.template.ObjectPage.view.Details"){T=le(e,b)}var y={semanticObject:g,action:v};var P=d({},T,h);var I={target:y,params:P};s.then(function(e){var t=e.isNavigationSupported([I],b);t.then(function(e){var t=p.getProperty("/generic/supportedIntents/"+g);if(!t){m[g]={};m[g][v]={};m[g][v][C]={supported:e[0].supported}}else if(!t[v]){t[v]={};t[v][C]={supported:e[0].supported}}else{t[v][C]={supported:e[0].supported}}p.updateBindings();if(e[0].supported&&i.isUiTable(a)){var n=a.getRowActionTemplate();n.getItems()[0].setVisible(true);a.setRowActionTemplate(n)}})})}}}}function ge(e){if(i.isSmartTable(e)){L.setEnabledToolbarButtons(e);ue(e)}}function ve(e,t){for(var a in t.columnKeyToCellHiddenPath){var n=t.columnKeyToCellHiddenPath[a];pe(e,a,n)}}function pe(e,t,a){var n=R.oPresentationControlHandlerFactory.getPresentationControlHandler(e);var i=e.getTable();var r=i.getRows?i.getRows():i.getItems();var o=n.getColumnByKey(t);if(o&&o.getVisible()){r.forEach(function(e){var t=e.getCells()[i.indexOfColumn(o)];t&&t.bindProperty("visible",{path:a,formatter:function(e){return!e}})})}}function de(t,a){var r=t.getSource();var o=r.getTable();var s=i.isMTable(o);var l=i.isTreeTable(o);var c=o.getColumns();if(!a||a&&a.isPopinWithoutHeader&&s){for(var u=0;u<c.length;u++){var g=c[u].data("p13nData")&&c[u].data("p13nData").columnKey;if(g&&(g.search("template::DataFieldForIntentBasedNavigation")>-1||g.search("template::DataFieldForAction")>-1)){c[u].setPopinDisplay("WithoutHeader")}}}var v=t.getParameter("bindingParams");v.parameters=v.parameters||{};var p=a.getSearchString&&a.getSearchString();if(p){v.parameters.custom={search:p}}if(l){v.parameters.rootLevel=v.parameters.rootLevel||0;v.parameters.numberOfExpandedLevels=v.parameters.numberOfExpandedLevels||a.numberOfExpandedLevels||0}var d=r.getCustomData();var f={};for(var m=0;m<d.length;m++){f[d[m].getKey()]=d[m].getValue()}var C=f.InitialExpansionLevel;if(C){v.parameters.numberOfExpandedLevels=parseInt(C,10)}var E=[];var h=[];function T(e,t,n,i,r){for(var o=0;o<e.length;o++){var s=e[o];if(s){var l=t.getODataProperty(n,s);if(l){var c=l["com.sap.vocabularies.Common.v1.FieldControl"];if(c&&c!==" "&&c.Path){if(a.isFieldControlRequired||h.indexOf(s)!==-1){E.push(c.Path)}}}}}var u=i["Org.OData.Capabilities.V1.DeleteRestrictions"];E.push(u&&u.Deletable&&u.Deletable.Path);var g=i["Org.OData.Capabilities.V1.UpdateRestrictions"];E.push(g&&g.Updatable&&g.Updatable.Path);var v=n[r+"@com.sap.vocabularies.UI.v1.Criticality"];E.push(v&&v.Path)}function b(e,t,a){var n,i=[];if(e.Value&&e.Value.Path){n=t.getODataProperty(a,e.Value.Path);if(n){if(n["com.sap.vocabularies.Common.v1.Text"]){i[0]=n["com.sap.vocabularies.Common.v1.Text"].Path}if(n["sap:text"]){i[0]=n["sap:text"]}}if(!i[0]){i[0]=e.Value.Path}}if(e.SemanticObject&&e.SemanticObject.Path){i.push(e.SemanticObject.Path)}if(e.Action&&e.Action.Path){i.push(e.Action.Path)}return i}function S(e,t){var a=t.getODataFunctionImport(e.Action.String,true);if(a){var n=t.getObject(a);if(n["sap:action-for"]!==" "&&n["sap:applicable-path"]!==" "){return n["sap:applicable-path"]}}return null}function y(e,t){var a=[];if(e.Target&&e.Target.AnnotationPath){var n=e.Target.AnnotationPath;var i=n.split("@")[1];var r=t[i];if(r&&r.MeasureAttributes){if(r.MeasureAttributes[0]&&r.MeasureAttributes[0].DataPoint&&r.MeasureAttributes[0].DataPoint.AnnotationPath){var o=r.MeasureAttributes[0].DataPoint.AnnotationPath.split("@")[1];var s=t[o];if(s){for(var l in s){a.push(s[l]&&s[l].Path);if(l==="CriticalityCalculation"&&s.CriticalityCalculation){for(var c in s.CriticalityCalculation){a.push(s.CriticalityCalculation[c].Path)}}}}}}a.push(r&&r.Measures&&r.Measures[0]&&r.Measures[0].PropertyPath)}return a}a=a||Object.create(null);a.setBindingPath=r.setTableBindingPath.bind(r);a.addNecessaryFields=function(e,t,i){var o=r.getModel().getMetaModel();var s=o.getODataEntitySet(i);var l=o.getODataEntityType(s.entityType);if(e.length>0){var c=r.data("lineItemQualifier");var u="com.sap.vocabularies.UI.v1.LineItem"+(c?"#"+c:"");var g=l[u]||[];for(var p=0;p<g.length;p++){switch(g[p].RecordType){case"com.sap.vocabularies.UI.v1.DataFieldWithIntentBasedNavigation":case"com.sap.vocabularies.UI.v1.DataFieldWithNavigationPath":var d=b(g[p],o,l);if(d){E=E.concat(d)}break;case"com.sap.vocabularies.UI.v1.DataFieldForAction":if(a.isDataFieldForActionRequired){var m=S(g[p],o);if(m){h.push(m);E.push(m)}}break;case"com.sap.vocabularies.UI.v1.DataFieldForAnnotation":var C=g[p];if(C.Target&&C.Target.AnnotationPath&&C.Target.AnnotationPath.indexOf("com.sap.vocabularies.UI.v1.FieldGroup")>=0){var P=C.Target.AnnotationPath;var I=l[P.split("@")[1]];g=g.concat(I&&I.Data);continue}var x=y(C,l);for(var D=0;D<x.length;D++){if(x[D]){E.push(x[D])}}break;default:break}}if(a.isFieldControlsPathRequired){T(e,o,l,s,u);var A=L.getBreakoutActions(r);for(var O in A){E.push(A[O].requiresSelection&&A[O].applicablePath)}var _=R.oDraftController.getDraftContext();if(_.isDraftEnabled(i)&&_.isDraftRoot(i)&&_.hasDraftAdministrativeData(i)){if(e.length>0){E.push("DraftAdministrativeData")}}}}var N=r.fetchVariant();if(!f.TemplateSortOrder&&a&&a.determineSortOrder){f.TemplateSortOrder=a.determineSortOrder()}if((!N||!N.sort)&&f.TemplateSortOrder){var F=f.TemplateSortOrder.split(", ");for(var M=0;M<F.length;M++){var B=F[M].split(" ");if(B.length>1){v.sorter.push(new n(B[0],B[1]==="true"))}else{v.sorter.push(new n(B[0]))}}}for(var w=0;w<E.length;w++){t(E[w])}};var P=e.byId(r.getSmartFilterId()||"listReportFilter");L.onBeforeRebindTableOrChart(t,a,P)}function fe(n,i,r,o,s,l){var c=new t("press",n,i);o=o||n.getBindingContext();if(e.onListNavigationExtension&&e.onListNavigationExtension(c,o,s)){return}var u=M(c);if(n.data("CrossNavigation")){var g=u.getEntitySet();L.setExternalChevronRefreshBehaviour(g);ne(n,o,r.oSmartFilterbar,true);return}V(n,r);var p=e.getOwnerComponent();var d=!!p.getEditFlow&&p.getEditFlow()==="direct";if(d){var f=u.getEntitySet();var m=C.directEdit(R.oTransactionController,f,o.sPath,o.getModel(),R.oApplication,L,R.oViewDependencyHelper,l,d);m.then(function(e){L.navigateFromListItem(e.context,s,true)},function(t){if(t.lockedByUser){var n=L.getText("ST_GENERIC_DRAFT_LOCKED_BY_USER",[" ",t.lockedByUser]);a.error(n)}else if(t.cancelled){if(l&&l.navigateUp){l.navigateUp()}}else{v.handleError(v.operations.editEntity,e,R,t);if(l&&l.navigateUp){l.navigateUp()}}})}else{L.navigateFromListItem(o,s)}}function me(e,t,a,n,r){var o,s={};if(e.getMetadata().getName()==="sap.ui.base.Event"){o=e.getSource();s=e.getParameters();if(i.isMTable(o)){o=e.getParameter("listItem");s.id=o.getId()}}else{o=e}if(n){fe(o,s,t,a,true,r)}else{var l=g.getViewLevel();var c=R.oApplication.getCurrentKeys(l+1);var u=c.length>l+1;if(o.data("CrossNavigation")||!g.isDraftEnabled()){L.fnProcessDataLossOrDraftDiscardConfirmation(fe.bind(null,o,s,t,a,u),Function.prototype,"LeaveApp")}else if(!R.oApplication.getBusyHelper().isBusy()){fe(o,s,t,a,u,r)}}}function Ce(e){R.oApplication.performAfterSideEffectExecution(function(){if(R.oApplication.getBusyHelper().isBusy()){F.info("Ignore incorrect selection, since app is busy anyway");return}var t=e?"ST_GENERIC_MULTIPLE_ITEMS_SELECTED":"ST_GENERIC_NO_ITEM_SELECTED";a.error(L.getText(t),{styleClass:L.getContentDensityClass()})})}function Ee(t){var n,i,r;var o=e.getOwnerComponent(),s=t.getSource().getCustomData(),l="10rem";if(s.length===0){return}for(i=0,r=s.length;i<r;i++){if(s[i].getProperty("key")==="Target"){n=s[i].getProperty("value");break}}if(!n){a.show(L.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:a.Icon.ERROR,title:L.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:l,details:L.getText("ST_GENERIC_ERROR_IN_NAVIGATION_PROPERTY_MISSING",["DataFieldWithNavigationPath"])});return}var c=o.getModel(),u=c.getMetaModel();var v=t.getSource().getBindingContext().getPath(),p=v.slice(1,v.indexOf("(")),d=u.getODataEntityType(u.getODataEntitySet(p).entityType),f,m=false,C=d.navigationProperty.length;for(f=0;f<C;f++){if(d.navigationProperty[f].name===n){m=true;break}}if(!m){a.show(L.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:a.Icon.ERROR,title:L.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:l,details:L.getText("ST_GENERIC_ERROR_NAVIGATION_PROPERTY_NOT_CORRECT",[n,"DataFieldWithNavigationPath"])});return}var E=u.getODataAssociationEnd(d,n),h=u.getODataEntityType(E.type),T,b;if(h){T=h.namespace+"."+h.name}var S=u.getODataEntityContainer().entitySet;for(i=0,r=S.length;i<r;i++){if(S[i].entityType===T){b=S[i].name;break}}if(!b){var y=T.split(".")[1];y=y.slice(0,y.length-4);a.show(L.getText("ST_GENERIC_ERROR_IN_NAVIGATION"),{icon:a.Icon.ERROR,title:L.getText("ST_ERROR"),actions:[sap.m.MessageBox.Action.CLOSE],horizontalScrolling:true,contentWidth:l,details:L.getText("ST_NAV_ERROR_TARGET_ENTITYSET_IS_MISSING",[y])});return}var P=L.getNavigationKeyProperties(b),I=R.oNavigationController,x={};var D=R.oDraftController.getDraftContext();if(D.isDraftEnabled(b)){x={$expand:"DraftAdministrativeData"}}var A=new Promise(function(e,t){c.read(v+"/"+n,{urlParameters:x,success:function(t){R.oApplicationController.synchronizeDraftAsync().then(function(){e(t);R.oApplication.invalidatePaginatorInfo();var a=L.mergeNavigationKeyPropertiesWithValues(P,t);R.oApplication.setStoredTargetLayoutToFullscreen(1);I.navigateToContext(a,null,false)})},error:function(e){t(e)}})});g.getBusyHelper().setBusy(A)}function he(e,t){var a=e.getSource();var n=R.oPresentationControlHandlerFactory.getPresentationControlHandler(L.getOwnerPresentationControl(a)).getSelectedContexts();n=n.filter(function(e){return e&&!e.isTransient()});var i=L.getCustomDataFromEvent(e);be(i,n,t.oSmartFilterbar)}function Te(e,t){var a=e.getSource();var n=a.getParent().getBindingContext();var i=a.data("SemanticObject");var r=a.data("Action");L.fnProcessDataLossOrDraftDiscardConfirmation(function(){var e={action:r,semanticObject:i};ee(e,[n],t.oSmartFilterbar||undefined)},Function.prototype,"LeaveApp")}function be(e,t,a){var n={action:e.Action,semanticObject:e.SemanticObject};ee(n,t,a||undefined)}function Se(e,t,a){var n=L.getElementCustomData(e);var i=!(n.RequiresContext&&n.RequiresContext==="false");if(i&&!t.length){Ce(t.length)}else{L.fnProcessDataLossOrDraftDiscardConfirmation(function(){be(n,t,a)},Function.prototype,"LeaveApp")}}function ye(e,t){L.fnProcessDataLossOrDraftDiscardConfirmation(function(){var a={semanticObject:e.data("SemanticObject"),action:e.data("Action")};var n=e.getParent().getBindingContext();ee(a,[n],t.oSmartFilterbar)},Function.prototype,"LeaveApp")}function Pe(e){var t=e.getSource();var a=L.getOwnerControl(t).getParent();var n=[t.getBindingContext()];var i=L.getElementCustomData(t);var r=a.getEntitySet();L.triggerAction(n,r,i,R.oPresentationControlHandlerFactory.getPresentationControlHandler(a))}var Ie;var xe;function De(e){Ie=new Promise(function(t){xe=t;var a=e.getSource();var n=a.getBindingContext().getPath();var i=a.getModel();var r=i.getProperty(n);var o=i.getETag(undefined,undefined,r);a.removeAllHeaderParameters();var s=a.getModel().getHeaders()["x-csrf-token"];if(s){var l=new T;l.setName("x-csrf-token");l.setValue(s);a.addHeaderParameter(l)}if(a.FUEl.files[0].name){var c=new T;var u=a.FUEl.files[0].name;if(!O.isASCII(u)){u=encodeURIComponent(u)}var g="filename="+u;c.setName("Content-Disposition");c.setValue(g);a.addHeaderParameter(c)}if(a.FUEl.files[0]){var v=new T;var p=a.FUEl.files[0].type||"application/octet-stream";v.setName("Content-Type");v.setValue(p);a.addHeaderParameter(v)}if(o){var d=new T;d.setName("If-Match");d.setValue(o);a.addHeaderParameter(d)}var f=new T;f.setName("Accept");f.setValue("application/json");a.addHeaderParameter(f);a.checkFileReadable().then(function(){a.upload()},function(e){var t=L.getText("ST_STREAM_FILE_UNREADABLE");R.oApplication.showMessageToast(t)}).then(function(){a.clear()})});var t=R.oApplication.getBusyHelper();t.setBusy(Ie)}function Ae(t){xe();var n=t.getParameter("status");if(n>=400){var i=t.getParameter("responseRaw")||t.getParameter("response"),r=i&&JSON.parse(i);if(r){a.error(r.error&&r.error.message)}}else{var o=t.getSource();var s=o.getParent().data("sNavigationProperty");var l=e.getView().getModel("_templPriv");var c=e.getOwnerComponent().getEntitySet();var u;var g=o.getUploadUrl();u={};if(s){l.setProperty("/generic/controlProperties/"+"fileUploader/"+s,u)}else{l.setProperty("/generic/controlProperties/"+"fileUploader/"+c,u)}u.fileName=decodeURIComponent(t.mParameters.fileName);var v=t.mParameters.requestHeaders.find(function(e){if(e.name==="Content-Type"){return e}return undefined});u.fileType=v.value;var p=b.getIconForMimeType(v.value);u.icon=p;u.url=g;if(s){l.setProperty("/generic/controlProperties/"+"fileUploader/"+s,u)}else{l.setProperty("/generic/controlProperties/"+"fileUploader/"+c,u)}var d=R.oApplication.getBusyHelper();var f=Ne(t.getSource());d.setBusy(f)}}function Oe(){var e=L.getText("ST_STREAM_TYPE_MISMATCH");R.oApplication.showMessageToast(e)}function _e(t){var a=t.getSource();var n=[e.getView().getBindingContext().sPath+"/$value"];var i=R.oTransactionController.deleteEntities(n);var r=R.oApplication.getBusyHelper();i.then(function(){var e=Ne(a);r.setBusy(e)});r.setBusy(i)}function Ne(e){return new Promise(function(t){e.getModel().refresh();t()})}function Fe(t,a){var n=L.getCustomDataFromEvent(t);var i=a?a.getSelectedContexts():[e.getView().getBindingContext()];if(n.ActionFor&&i.length===0){Ce(i.length)}else{var r=a?a.getEntitySet():e.getOwnerComponent().getEntitySet();L.triggerAction(i,r,n,a)}}function Re(e,t){var a,n="";var r=M(e);var o=R.oPresentationControlHandlerFactory.getPresentationControlHandler(r).getSelectedContexts();var s=i.isSmartTable(r);if(s){a=r.getTable();n=r.getEntitySet()}else if(i.isSmartChart(r)){r.getChartAsync().then(function(e){a=e});n=r.getEntitySet()}var l=L.getCustomDataFromEvent(e);Le(r,a,l,o,t,n,s)}function Le(e,t,a,n,i,r,o){var s=Be(n,a);var l=a.IsCopyAction==="true"?{ResultIsActiveEntity:true}:{};if(a.ActionFor&&s.inApplicableCount>0&&(o&&(t.getMode&&t.getMode()==="MultiSelect"||t.getSelectionMode&&t.getSelectionMode()==="MultiToggle"))){var c=L.getText("ST_GENERIC_WARNING_TEXT",[s.inApplicableCount]);s.warningText=c;var u={functionImportPath:a.Action,contexts:s.aApplicableContexts,sourceControl:t,label:a.Label,operationGrouping:a.InvocationGrouping,skipProperties:l,sEntitySet:r,oState:i};Me(e).then(function(e){var t=e.getModel("Action");t.setData(u);var a=new sap.ui.model.json.JSONModel(s);e.setModel(a,"list");var n=e.getModel("list");n.setData(s);e.open()})}else{we({functionImportPath:a.Action,contexts:n,sourceControl:t,label:a.Label,operationGrouping:a.InvocationGrouping,skipProperties:l,navigateToInstance:a.IsNavigateToInstance},i,r)}}function Me(e){return L.getDialogFragmentAsync("sap.suite.ui.generic.template.fragments.ActionConfirmation",{onCancel:function(e){var t=e.getSource().getParent();t.close()},onContinue:function(e){var t=e.getSource().getParent(),a=t.getModel("Action").getProperty("/");we({functionImportPath:a.functionImportPath,contexts:a.contexts,sourceControl:a.sourceControl,label:a.label,operationGrouping:a.operationGrouping},a.oState,a.sEntitySet);t.close()}},"Action")}function Be(t,a){var n,i,o,s,l;var c=e.getView().getModel();var u=c.getMetaModel();if(t&&t.length>0){o=t[0].sPath.substring(1,t[0].sPath.indexOf("("));s=u.getODataEntitySet(o)}if(s){var g=a.Action.split("/")[1];var v=[],p=[];var d={aInApplicableItems:undefined,inApplicableCount:0,dialogTitle:a.Label,warningText:undefined,aApplicableContexts:undefined};if(g){i=u.getODataFunctionImport(g)["sap:applicable-path"]}var f=e.getView().getModel("@i18n")&&e.getView().getModel("@i18n").getResourceBundle();var m=r.getAnnotationFormatter(c,o,"/com.sap.vocabularies.UI.v1.HeaderInfo/Title/Value",f);for(var C=0;C<t.length;C++){l=t[C];n=c.getObject(t[C].getPath());if(i&&n[i]===false||l.isTransient()){d.inApplicableCount++;v.push({sKey:m.format(l)})}else{p.push(l)}}m.done();d.aInApplicableItems=v;d.aApplicableContexts=p}return d}function we(t,a,n){var r=t.sourceControl;var o=function(){if(r&&r.isA("sap.ui.table.Table")){var e=i.getSelectionPluginForUITable(r);if(e){e.clearSelection()}else{r.clearSelection()}}};R.oDataLossHandler.performIfNoDataLoss(function(){R.oCRUDManager.callAction({functionImportPath:t.functionImportPath,contexts:t.contexts,sourceControlHandler:R.oPresentationControlHandlerFactory.getPresentationControlHandler(L.getOwnerPresentationControl(r)),label:t.label,operationGrouping:t.operationGrouping,skipProperties:t.skipProperties,navigateToInstance:t.navigateToInstance},a).then(function(a){if(a){a.some(function(a){var i=a.context&&a.context.getPath();if(a.response&&a.context&&(!a.actionContext||i!==a.actionContext.getPath())){R.oViewDependencyHelper.setMeToDirty(e.getOwnerComponent(),n,false,i==="/undefined"||t.contexts&&t.contexts.length>1,o);return true}})}},Function.prototype)},Function.prototype,"Proceed")}function He(e){R.oApplication.setNextFocus(function(e,t){t({isCreate:true})});return e}function Ue(e,t){R.oApplication.setNextFocus(function(){e.setFocusOnFirstEditableFieldInTableRow(t)})}function Ve(t,a,n,i,r,o){var s=L.getOwnerControl(t,true);var l=s.getEntitySet();var c=e.getOwnerComponent();var u=R.oApplication.getBusyHelper();if(t.data("CrossNavigation")){R.oViewDependencyHelper.setMeToDirty(c,l,true);ne(t,t.getBindingContext(),n,true);return Promise.resolve()}var v=g.getNonDraftCreatePromise(l,i);if(v){var p=v.then(He);u.setBusy(p);return p}var d=function(e){var t=R.oCRUDManager.addEntry(s,e).then(function(e){if(o){return e}else if(!a){He();R.oViewDependencyHelper.setMeToDirty(c,l);R.oApplication.navigateToSubContext(e,false,4)}else if(!r){var t=R.oPresentationControlHandlerFactory.getPresentationControlHandler(s);var n=t.refresh();u.setBusy(n.then(function(){Ue(t,e)}));R.oApplicationController.executeSideEffects(c.getBindingContext(),[],[s.getTableBindingPath()]);return e}});t.catch(Function.prototype);return t};if(i instanceof Promise){return i.then(d)}else{return d(i)}}function Ge(a){var n={batchGroupId:"Changes",changeSetId:"Changes",draftSave:true,noBlockUI:true,noShowResponse:true,onlyIfPending:true,pendingChanges:true,forceSubmit:true},i,r=true;if(a instanceof t){r=false;i=a.getSource()}if(g.isDraftEnabled()&&!r){var o=e.getView();var s=a.getSource().getBindingContext();var l=i.getDataProperty&&i.getDataProperty().typePath;var c=i.getInnerControls();var u=c&&c[0]&&c[0].getFieldGroupIds&&c[0].getFieldGroupIds()||[];for(var v=0;v<u.length;v++){var p=o.data(u[v]);var d=false;var f=R.oApplicationController._getSideEffect(p);var m=f&&f.SourceProperties||[];for(var C=0;C<m.length;C++){if(m[C].PropertyPath===l){d=true}}if(d){var E=R.oApplicationController._getSideEffectsQualifier(p.name);R.oApplicationController.registerGroupChange(E)}}a.getSource()._getComputedMetadata().then(function(e){R.oApplicationController.executeSideEffects(s,[],[e.navigationPath])})}R.oTransactionController.triggerSubmitChanges(n)}function ke(e){var t=M(e);var a=e.getParameter("listItem");var n=a.getBindingContext();We(t,[n])}function je(e){var t=M(e);var a=R.oPresentationControlHandlerFactory.getPresentationControlHandler(t).getSelectedContexts();We(t,a)}function We(t,n){if(n.length>0){var i=q(n,t);var r=Promise.resolve(e.beforeDeleteExtension({aContexts:n}));r.then(function(e){var a=R.oApplication.getBusyHelper();a.setBusy(i);i.then(function(a){d(a.text,e);j(t).then(function(e){var t=e.getModel("delete");t.setData(a);e.open()})},Function.prototype)})}else{a.error(L.getText("ST_GENERIC_NO_ITEM_SELECTED"),{styleClass:L.getContentDensityClass()})}}function Ke(){var e=g.getParameterModelForTemplating().oData.templateSpecific.teamsCollabOptions;if(!e){return S.getServiceAsync().then(function(t){if(typeof t.isContactsCollaborationSupported==="function"&&t.isContactsCollaborationSupported()){return t.getTeamsContactCollabOptions()}else{return Promise.resolve(e)}}).then(function(e){g.getParameterModelForTemplating().setProperty("/templateSpecific/teamsCollabOptions",e);return Promise.resolve(e)})}else{return Promise.resolve(e)}}function Je(e){return S.getServiceAsync().then(function(t){if(typeof t.isContactsCollaborationSupported==="function"&&t.isContactsCollaborationSupported()){return t.getTeamsContactStatus(e)}}).then(function(e){return Promise.resolve(e)})}function qe(t,a){var n=function(n,i){var r=t.getSource();var o=r.getModel();var l=r.getBindingContext();var c=l.getPath();var u=o.getContext(c);c=a?e.getView().getBindingContext().getPath()+"/"+a+"("+s.analyseContext(l).key+")":c;if(Object.keys(u.getProperty()).length>3){y.populateDataInContactQuickView(L,r,u,n,i)}else{var v=s.getData(o,c).then(function(){y.populateDataInContactQuickView(L,r,u,n,i)});g.getBusyHelper().setBusy(v)}};var i=t.getSource();var r=i.getModel();var o=i.getBindingContext();var l=o.getPath();var c=r.getContext(l);var u=JSON.parse(i.data("contactDetails"));var v=u?.email?.[0]?.address;var p=v?.Path?c.getProperty(v.Path):v?.String;Je(p).then(function(e){Ke().then(function(t){n.call(this,t,e)}).catch(function(e){n.call(this)})}).catch(function(e){Ke().then(function(e){n.call(this,e)}).catch(function(e){n.call(this)})})}function Qe(e,t){var t=e.getSource().data("email");Ye(e.getSource(),t)}function Ye(e,t){var a=e;S.getServiceAsync().then(function(e){if(typeof e.isContactsCollaborationSupported==="function"&&e.isContactsCollaborationSupported()){return e.enableContactsCollaboration(t)}else{return Promise.reject()}}).then(function(e){e.openBy(a)}).catch(function(){P.URLHelper.triggerEmail(t)})}function ze(t,a){var n=Z(t,[],a);e.adaptNavigationParameterExtension(n,t);L.setComponentRefreshBehaviour(t);R.oApplication.navigateExternal(t.semanticObject,t.action,n.toJSONString(),null,L.handleError)}function Xe(e,t){var a=e.getSource();$e(a,t)}function $e(e,t){var a=e.data("LabelId");var n=t+"--"+a;var i=_.getElementById(n);if(i){i.attachFieldVisibilityChange(e)}}function Ze(e,t){p.handleSideEffectForField(e,g,t)}function et(t,a){var n=e.getOwnerComponent();p.assignFieldGroupIds(t,n.getModel().getMetaModel(),a||n.getEntitySet())}function tt(t,a,n,i,r){var o=e.getOwnerComponent();var s=o.getAppComponent();var l;if(s.getFlexibleColumnLayout()){var c=o.getModel("_templPrivGlobal");l=c.getProperty("/generic/FCL/isVisuallyFullScreen")}else{l=true}var u=n?r:i;var g,v;if(t){if(a&&!l){v=[" ",t,a];g=u?"DELETE_SELECTED_ITEM_WITH_OBJECTINFO":"DELETE_WITH_OBJECTINFO"}else{v=[t];if(a){v.push(a)}g=u?"DELETE_SELECTED_ITEM_WITH_OBJECTTITLE":"DELETE_WITH_OBJECTTITLE"}}else{g=u?"DELETE_SELECTED_ITEM":"ST_GENERIC_DELETE_SELECTED"}return n&&r?L.getContextText(g,r.getId(),null,v):L.getText(g,v)}function at(t){var a=t.getParameter("userExportSettings"),n=!!(a&&a.includeFilterSettings),i=t.getParameter("filterSettings"),r=t.getSource();if(n){L.transformTechnicalPropsOnExportedFile(i);L.includeEntitySetParametersToExportedFile(r,i)}var o={filterSettings:n?i:[],includeFilterSettings:n};e.onBeforeExportTableExtension(o)}function nt(t,a,n,i){var r,o,s="explace";if(n){r=n.getUiState().getSelectionVariant();if(typeof r!=="string"){r=JSON.stringify(r)}}o=Z(t,[a],e.getView().getBindingContext(),r);var l={semanticObject:t.semanticObject,action:t.action};e.adaptNavigationParameterExtension(o,l);R.oApplication.getNavigationHandler().navigate(t.semanticObject,t.action,o.toJSONString(),null,i,null,s)}var Z=o.testable(Z,"fnBuildSelectionVariantForNavigation");var B=o.testable(B,"fnEvaluateParameters");var ee=o.testable(ee,"fnNavigateIntent");var ae=o.testable(ae,"fnHideTitleArea");var Y=o.testable(Y,"fnGetSelectedItemContextForDeleteMessage");var q=o.testable(q,"getDataForDeleteDialog");var te=o.testable(te,"CommonEventHandlers_fnNavigateIntentSmartLink");var U=o.testable(U,"getPaginatorInfo");return{onDataReceived:ge,onBeforeRebindTable:de,onListNavigate:me,onEditNavigateIntent:ne,onRelatedAppNavigation:ze,onDataFieldWithNavigationPath:Ee,onDataFieldForIntentBasedNavigation:he,onDeterminingDataFieldForIntentBasedNavigation:Se,onDeterminingDataFieldForAction:Fe,onInlineDataFieldForIntentBasedNavigation:ye,onDataFieldWithIntentBasedNavigation:Te,onDataFieldForIntentBasedNavigationSelectedContext:be,onDataFieldWithEmail:Qe,onInlineDataFieldForAction:Pe,onMultiSelectionChange:G,onCallActionFromToolBar:Re,onCallActionFromToolBarForContexts:Le,addEntry:Ve,deleteEntry:ke,deleteEntries:je,deleteContextsFromTable:We,onContactDetails:qe,onSmartFieldInitialise:Xe,onSmartLabelAttachFieldVisibility:$e,onSemanticObjectLinkNavigationTargetObtained:re,onSemanticObjectLinkNavigationPressed:ie,onBeforeSemanticObjectLinkNavigationCallback:se,submitChangesForSmartMultiInput:Ge,getSelectedItemContextForDeleteMessage:Y,getDeleteText:tt,uploadStream:De,removeStream:_e,handleUploadComplete:Ae,handleTypeMismatch:Oe,evaluateParameters:B,onBeforeExport:at,handleSideEffectForField:Ze,onSmartFieldModeToggled:et,onRenderTeamsContactCollabOptions:Ye,hideTableCells:ve,navigateIntentOnNewTab:nt}}return e.extend("sap.suite.ui.generic.template.lib.CommonEventHandlers",{constructor:function(e,t,a,n){d(this,R(e,t,a,n))}})});
//# sourceMappingURL=CommonEventHandlers.js.map