sap.ui.define(["sap/ui/base/Object","sap/base/util/extend"],function(e,t){"use strict";function n(e){var t=e.oAppComponent.suppressDataLossPopup();var n;var a;function r(e,t,r,o,s){var i,u;n=e;a=t;var l=s?"sap.suite.ui.generic.template.fragments.DataLossTechnicalError":"sap.suite.ui.generic.template.fragments.DataLoss";r.getDialogFragmentAsync(l,{onDataLossOK:function(){u.close();n()},onDataLossCancel:function(){u.close();a()}},"dataLoss").then(function(e){u=e;i=u.getModel("dataLoss");i.setProperty("/isLeaving",o);u.open()})}function o(t){var n=e.oNavigationControllerProxy.getActiveComponents();var a,r,o;n.forEach(function(n){var s=e.componentRegistry[n];if(t&&s.utils.isDraftEnabled()){return}o=o||s;var i=s.oComponent.getModel("ui");if(i.getProperty("/editable")){a=a||s}if(s.aUnsavedDataCheckFunctions&&s.aUnsavedDataCheckFunctions.some(function(e){return e()})){r=r||s}});return{relevantRegistryEntry:r||a||o,hasExternalChanges:!!r}}function s(n,a,s,i){var u=o(true);var l=u.relevantRegistryEntry&&(u.hasExternalChanges||e.oAppComponent.getModel().hasPendingChanges());var c=u.relevantRegistryEntry?function(){u.relevantRegistryEntry.utils.cancelEdit(null,l);if(s){e.oNavigationControllerProxy.userHasAcceptedDataLoss()}n()}:n;var f=!t&&l;if(f){r(c,a,u.relevantRegistryEntry.oControllerUtils.oCommonUtils,s,i)}else{c()}}function i(t,n,a,r,o){var i=a.startsWith("Leave");var u=new Promise(function(a,u){var l=function(){var e=t();a(e)};var c=function(){n();u()};if(r){s(l,c,i,o)}else{e.oApplicationProxy.performAfterSideEffectExecution(s.bind(null,l,c,i,o),true)}});return u}function u(n){var a=!t&&e.oNavigationControllerProxy.unwantedDataLossPossible(n);if(a){var r=o();var s=r.relevantRegistryEntry&&(r.hasExternalChanges||e.oAppComponent.getModel().hasPendingChanges());return!!s}return false}return{performIfNoDataLoss:i,getShellDataLossPopup:u}}return e.extend("sap.suite.ui.generic.template.lib.DataLossHandler",{constructor:function(e){t(this,n(e))}})});
//# sourceMappingURL=DataLossHandler.js.map