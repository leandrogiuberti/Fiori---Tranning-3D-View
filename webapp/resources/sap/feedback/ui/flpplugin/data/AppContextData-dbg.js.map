{"version":3,"file":"AppContextData-dbg.js","names":["ThemeData","_interopRequireDefault","__ThemeData","Constants","__Constants","UI5Util","__UI5Util","Util","__Util","AppContextData","_classCallCheck","_createClass","key","value","getData","_this","Promise","resolve","calculateAppContextData","e","reject","_this2","getCurrentApp","then","currentApp","isAppTypeSupported","applicationType","toLowerCase","getAppInfo","appInfo","getContextData","Log","warning","WARNING","UNSUPPORTED_APP_TYPE","undefined","COMPONENT","APP_CONTEXT_DATA","_appContextData","error","ERROR","CURRENT_APP_NOT_AVAILABLE","Error","appType","SUPPORTED_APP_TYPES","indexOf","getInfo","_currentApp$getInfo","metadata","AppConfiguration","getMetadata","title","appTitle","appId","LAUNCHPAD_VALUE","stringToTitleCase","_this3","contextData","previousTheme","getPreviousTheme","theme","getTheme","languageTag","getLanguage","appFrameworkId","convertAppFrameworkTypeToId","appFrameworkVersion","DEFAULT_VALUE_NA","technicalAppComponentId","appVersion","appSupportInfo","formatLanguageTag","_defineProperty"],"sourceRoot":".","sources":["AppContextData.ts"],"sourcesContent":["import * as PxApiTypes from '@sap-px/pxapi/dist/api/common/Types';\nimport Log from 'sap/base/Log';\nimport AppConfiguration from 'sap/ushell/services/AppConfiguration';\n\nimport { CurrentApplication } from 'sap/ushell/services/AppLifeCycle';\nimport ThemeData from './ThemeData';\nimport Constants from '../common/Constants';\nimport { AppInfo } from '../common/Types';\nimport UI5Util from '../common/UI5Util';\nimport Util from '../common/Util';\n\n/**\n * NOTE: Need to verify few un-identified UI5 Types which are currently missing in UI5 type definitions, marked them as TODO below.\n */\n\nexport default class AppContextData {\n\tprivate static readonly _appContextData: PxApiTypes.AppContextData = {\n\t\tappFrameworkId: Constants.DEFAULT_VALUE_NA,\n\t\tappFrameworkVersion: Constants.DEFAULT_VALUE_NA,\n\t\ttheme: Constants.DEFAULT_VALUE_NA,\n\t\tappId: Constants.DEFAULT_VALUE_NA,\n\t\tappTitle: Constants.DEFAULT_VALUE_NA,\n\t\tlanguageTag: Constants.DEFAULT_VALUE_NA,\n\t\ttechnicalAppComponentId: Constants.DEFAULT_VALUE_NA,\n\t\tappVersion: Constants.DEFAULT_VALUE_NA,\n\t\tappSupportInfo: Constants.DEFAULT_VALUE_NA\n\t};\n\n\tstatic async getData(): Promise<PxApiTypes.AppContextData> {\n\t\treturn await this.calculateAppContextData();\n\t}\n\n\tprivate static async calculateAppContextData(): Promise<PxApiTypes.AppContextData> {\n\t\tconst currentApp = await UI5Util.getCurrentApp();\n\t\tif (currentApp) {\n\t\t\tif (this.isAppTypeSupported(currentApp.applicationType.toLowerCase())) {\n\t\t\t\tconst appInfo = await this.getAppInfo(currentApp);\n\t\t\t\treturn this.getContextData(appInfo);\n\t\t\t} else {\n\t\t\t\tLog.warning(Constants.WARNING.UNSUPPORTED_APP_TYPE, undefined, Constants.COMPONENT.APP_CONTEXT_DATA);\n\t\t\t\treturn this._appContextData;\n\t\t\t}\n\t\t} else {\n\t\t\tLog.error(Constants.ERROR.CURRENT_APP_NOT_AVAILABLE, undefined, Constants.COMPONENT.APP_CONTEXT_DATA);\n\t\t\tthrow new Error(Constants.ERROR.CURRENT_APP_NOT_AVAILABLE);\n\t\t}\n\t}\n\n\tprivate static isAppTypeSupported(appType: string): boolean {\n\t\treturn Constants.SUPPORTED_APP_TYPES.indexOf(appType) > -1;\n\t}\n\n\tprivate static async getAppInfo(currentApp: CurrentApplication): Promise<AppInfo> {\n\t\tconst appInfo = (await currentApp.getInfo([\n\t\t\t'appId',\n\t\t\t'appVersion',\n\t\t\t'appSupportInfo',\n\t\t\t'technicalAppComponentId',\n\t\t\t'appFrameworkId',\n\t\t\t'appFrameworkVersion'\n\t\t])) as AppInfo;\n\t\tif (appInfo) {\n\t\t\tconst metadata = AppConfiguration.getMetadata(); // Open: no getMetadata function as per definition\n\t\t\tif (metadata?.title) {\n\t\t\t\tappInfo.appTitle = metadata.title;\n\t\t\t}\n\t\t\tif (appInfo?.appId === Constants.LAUNCHPAD_VALUE) {\n\t\t\t\tappInfo.appTitle = Util.stringToTitleCase(appInfo.appId);\n\t\t\t}\n\t\t}\n\t\treturn appInfo;\n\t}\n\n\tprivate static async getContextData(appInfo: AppInfo): Promise<PxApiTypes.AppContextData> {\n\t\tconst contextData = {} as PxApiTypes.AppContextData;\n\t\tcontextData.previousTheme = ThemeData.getPreviousTheme();\n\t\tcontextData.theme = UI5Util.getTheme();\n\n\t\tcontextData.languageTag = this.getLanguage();\n\t\tif (appInfo) {\n\t\t\tcontextData.appFrameworkId = Util.convertAppFrameworkTypeToId(appInfo['appFrameworkId']);\n\t\t\tcontextData.appFrameworkVersion = appInfo['appFrameworkVersion'] || Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.appId = appInfo['appId'] || Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.appTitle = appInfo['appTitle'] || Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.technicalAppComponentId = appInfo['technicalAppComponentId'] || Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.appVersion = appInfo['appVersion'] || Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.appSupportInfo = appInfo['appSupportInfo'] || Constants.DEFAULT_VALUE_NA;\n\t\t} else {\n\t\t\tcontextData.appFrameworkId = Util.convertAppFrameworkTypeToId(undefined);\n\t\t\tcontextData.appFrameworkVersion = Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.appId = Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.appTitle = Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.technicalAppComponentId = Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.appVersion = Constants.DEFAULT_VALUE_NA;\n\t\t\tcontextData.appSupportInfo = Constants.DEFAULT_VALUE_NA;\n\t\t}\n\t\treturn contextData;\n\t}\n\n\tprivate static getLanguage(): string {\n\t\treturn Util.formatLanguageTag(UI5Util.getLanguage());\n\t}\n}\n"],"mappings":"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","ignoreList":[]}