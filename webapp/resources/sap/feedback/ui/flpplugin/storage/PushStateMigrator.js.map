{"version":3,"file":"PushStateMigrator.js","names":["LocalStorageHandler","_interopRequireDefault","__LocalStorageHandler","Constants","__Constants","PushStateMigrator","_classCallCheck","this","_createClass","key","value","migrate","userState","getUserState","isOldPushStateAvailable","newUserState","getNewUserState","updateUserState","Log","debug","DEBUG","NO_OLD_PUSH_STATE","undefined","COMPONENT","PUSH_STATE_MIGRATOR","dynamicPushDate","inAppPushDate","featurePushStates","_this","keyValues","Object","keys","map","newKey","pushStateKeyMap","_defineProperty","assign","apply","concat","_toConsumableArray","get"],"sources":["./PushStateMigrator.ts"],"sourcesContent":["import Log from 'sap/base/Log';\nimport LocalStorageHandler from './LocalStorageHandler';\nimport Constants from '../common/Constants';\nimport { UserState } from '../common/Types';\n\nexport default class PushStateMigrator {\n\t// returns 'false' only in case of failure while migrating the push state (worst case) else 'true'\n\tstatic migrate(): boolean {\n\t\tconst userState = LocalStorageHandler.getUserState();\n\t\tif (userState) {\n\t\t\tif (this.isOldPushStateAvailable(userState)) {\n\t\t\t\tconst newUserState = this.getNewUserState(userState);\n\t\t\t\treturn LocalStorageHandler.updateUserState(newUserState);\n\t\t\t} else {\n\t\t\t\tLog.debug(Constants.DEBUG.NO_OLD_PUSH_STATE, undefined, Constants.COMPONENT.PUSH_STATE_MIGRATOR);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate static isOldPushStateAvailable(userState: UserState): boolean {\n\t\tif (userState.dynamicPushDate || userState.inAppPushDate || userState.featurePushStates) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate static getNewUserState(userState: UserState): UserState {\n\t\tconst keyValues = Object.keys(userState).map((key) => {\n\t\t\tconst newKey = this.pushStateKeyMap[key] || key;\n\t\t\treturn { [newKey]: userState[key as keyof UserState] };\n\t\t});\n\t\treturn Object.assign({}, ...keyValues);\n\t}\n\n\tprivate static get pushStateKeyMap(): {\n\t\t[x: string]: keyof UserState;\n\t} {\n\t\treturn { dynamicPushDate: 'timedPushDate', inAppPushDate: 'appPushDate', featurePushStates: 'appPushStates' };\n\t}\n}\n"],"mappings":"o+DACOA,EAAmBC,EAAAC,GAAA,IACnBC,EAASF,EAAAG,GAAA,IAGKC,EAAiB,oBAAAA,IAAAC,EAAAC,KAAAF,EAAA,QAAAG,EAAAH,EAAA,OAAAI,IAAA,UAAAC,MAErC,SAAOC,IACN,IAAMC,EAAYZ,EAAoBa,eACtC,GAAID,EAAW,CACd,GAAIL,KAAKO,wBAAwBF,GAAY,CAC5C,IAAMG,EAAeR,KAAKS,gBAAgBJ,GAC1C,OAAOZ,EAAoBiB,gBAAgBF,EAC5C,KAAO,CACNG,EAAIC,MAAMhB,EAAUiB,MAAMC,kBAAmBC,UAAWnB,EAAUoB,UAAUC,oBAC7E,CACD,CACA,OAAO,IACR,GAAC,CAAAf,IAAA,0BAAAC,MAED,SAAeI,EAAwBF,GACtC,GAAIA,EAAUa,iBAAmBb,EAAUc,eAAiBd,EAAUe,kBAAmB,CACxF,OAAO,IACR,CACA,OAAO,KACR,GAAC,CAAAlB,IAAA,kBAAAC,MAED,SAAeM,EAAgBJ,GAAiC,IAAAgB,EAAArB,KAC/D,IAAMsB,EAAYC,OAAOC,KAAKnB,GAAWoB,IAAI,SAACvB,GAC7C,IAAMwB,EAASL,EAAKM,gBAAgBzB,IAAQA,EAC5C,OAAA0B,EAAA,GAAUF,EAASrB,EAAUH,GAC9B,GACA,OAAOqB,OAAOM,OAAMC,MAAbP,OAAM,CAAQ,CAAC,GAACQ,OAAAC,EAAKV,IAC7B,GAAC,CAAApB,IAAA,kBAAA+B,IAED,SAAAA,IAGC,MAAO,CAAEf,gBAAiB,gBAAiBC,cAAe,cAAeC,kBAAmB,gBAC7F,IAAC,CAlCoC,GAkCpC,OAAAtB,CAAA","ignoreList":[]}