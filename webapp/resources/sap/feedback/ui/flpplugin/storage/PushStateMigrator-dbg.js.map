{"version":3,"file":"PushStateMigrator-dbg.js","names":["LocalStorageHandler","_interopRequireDefault","__LocalStorageHandler","Constants","__Constants","PushStateMigrator","_classCallCheck","_createClass","key","value","migrate","userState","getUserState","isOldPushStateAvailable","newUserState","getNewUserState","updateUserState","Log","debug","DEBUG","NO_OLD_PUSH_STATE","undefined","COMPONENT","PUSH_STATE_MIGRATOR","dynamicPushDate","inAppPushDate","featurePushStates","_this","keyValues","Object","keys","map","newKey","pushStateKeyMap","_defineProperty","assign","apply","concat","_toConsumableArray","get"],"sourceRoot":".","sources":["PushStateMigrator.ts"],"sourcesContent":["import Log from 'sap/base/Log';\nimport LocalStorageHandler from './LocalStorageHandler';\nimport Constants from '../common/Constants';\nimport { UserState } from '../common/Types';\n\nexport default class PushStateMigrator {\n\t// returns 'false' only in case of failure while migrating the push state (worst case) else 'true'\n\tstatic migrate(): boolean {\n\t\tconst userState = LocalStorageHandler.getUserState();\n\t\tif (userState) {\n\t\t\tif (this.isOldPushStateAvailable(userState)) {\n\t\t\t\tconst newUserState = this.getNewUserState(userState);\n\t\t\t\treturn LocalStorageHandler.updateUserState(newUserState);\n\t\t\t} else {\n\t\t\t\tLog.debug(Constants.DEBUG.NO_OLD_PUSH_STATE, undefined, Constants.COMPONENT.PUSH_STATE_MIGRATOR);\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tprivate static isOldPushStateAvailable(userState: UserState): boolean {\n\t\tif (userState.dynamicPushDate || userState.inAppPushDate || userState.featurePushStates) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprivate static getNewUserState(userState: UserState): UserState {\n\t\tconst keyValues = Object.keys(userState).map((key) => {\n\t\t\tconst newKey = this.pushStateKeyMap[key] || key;\n\t\t\treturn { [newKey]: userState[key as keyof UserState] };\n\t\t});\n\t\treturn Object.assign({}, ...keyValues);\n\t}\n\n\tprivate static get pushStateKeyMap(): {\n\t\t[x: string]: keyof UserState;\n\t} {\n\t\treturn { dynamicPushDate: 'timedPushDate', inAppPushDate: 'appPushDate', featurePushStates: 'appPushStates' };\n\t}\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;MACOA,mBAAmB,GAAAC,sBAAA,CAAAC,qBAAA;EAAA,IACnBC,SAAS,GAAAF,sBAAA,CAAAG,WAAA;EAAA,IAGKC,iBAAiB;IAAA,SAAAA,kBAAA;MAAAC,eAAA,OAAAD,iBAAA;IAAA;IAAA,OAAAE,YAAA,CAAAF,iBAAA;MAAAG,GAAA;MAAAC,KAAA;MACrC;MACA,SAAOC,OAAOA,CAAA,EAAY;QACzB,IAAMC,SAAS,GAAGX,mBAAmB,CAACY,YAAY,CAAC,CAAC;QACpD,IAAID,SAAS,EAAE;UACd,IAAI,IAAI,CAACE,uBAAuB,CAACF,SAAS,CAAC,EAAE;YAC5C,IAAMG,YAAY,GAAG,IAAI,CAACC,eAAe,CAACJ,SAAS,CAAC;YACpD,OAAOX,mBAAmB,CAACgB,eAAe,CAACF,YAAY,CAAC;UACzD,CAAC,MAAM;YACNG,GAAG,CAACC,KAAK,CAACf,SAAS,CAACgB,KAAK,CAACC,iBAAiB,EAAEC,SAAS,EAAElB,SAAS,CAACmB,SAAS,CAACC,mBAAmB,CAAC;UACjG;QACD;QACA,OAAO,IAAI;MACZ;IAAC;MAAAf,GAAA;MAAAC,KAAA,EAED,SAAeI,uBAAuBA,CAACF,SAAoB,EAAW;QACrE,IAAIA,SAAS,CAACa,eAAe,IAAIb,SAAS,CAACc,aAAa,IAAId,SAAS,CAACe,iBAAiB,EAAE;UACxF,OAAO,IAAI;QACZ;QACA,OAAO,KAAK;MACb;IAAC;MAAAlB,GAAA;MAAAC,KAAA,EAED,SAAeM,eAAeA,CAACJ,SAAoB,EAAa;QAAA,IAAAgB,KAAA;QAC/D,IAAMC,SAAS,GAAGC,MAAM,CAACC,IAAI,CAACnB,SAAS,CAAC,CAACoB,GAAG,CAAC,UAACvB,GAAG,EAAK;UACrD,IAAMwB,MAAM,GAAGL,KAAI,CAACM,eAAe,CAACzB,GAAG,CAAC,IAAIA,GAAG;UAC/C,OAAA0B,eAAA,KAAUF,MAAM,EAAGrB,SAAS,CAACH,GAAG,CAAoB;QACrD,CAAC,CAAC;QACF,OAAOqB,MAAM,CAACM,MAAM,CAAAC,KAAA,CAAbP,MAAM,GAAQ,CAAC,CAAC,EAAAQ,MAAA,CAAAC,kBAAA,CAAKV,SAAS,GAAC;MACvC;IAAC;MAAApB,GAAA;MAAA+B,GAAA,EAED,SAAAA,IAAA,EAEE;QACD,OAAO;UAAEf,eAAe,EAAE,eAAe;UAAEC,aAAa,EAAE,aAAa;UAAEC,iBAAiB,EAAE;QAAgB,CAAC;MAC9G;IAAC;EAAA;EAAA,OAAArB,iBAAA;AAAA","ignoreList":[]}