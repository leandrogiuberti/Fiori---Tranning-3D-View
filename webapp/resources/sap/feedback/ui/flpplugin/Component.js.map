{"version":3,"file":"Component.js","names":["ControllerFactory","_interopRequireDefault","__ControllerFactory","ControlFactory","__ControlFactory","MyComponent","Component","extend","metadata","manifest","properties","url","name","type","tenantId","tenantRole","isPushEnabled","pushChannelPath","productName","platformType","scopeSet","configIdentifier","configJson","constructor","_constructor","id","settings","Component.prototype.constructor.call","this","init","_init","_this","readFlpSettings","_temp","Promise","resolve","runInitProcess","then","e","reject","load","_load","_this2","readProperties","_temp2","_runInitProcess","parameters","_this3","pluginInfo","getManifestEntry","version","initController","createInitController","invitationDialog","createSurveyInvitationDialog","getResourceBundle","showCallback","surveyInvitationDialogShowCallback","bind","_initController$init","_pxApiWrapper","pxApiWrapper","initializePluginController","_initializePluginController","_this4","pluginController","createPluginController","initPlugin","_getResourceBundle","resourceModel","getModel","_readFlpSettings","componentData","readComponentData","qualtricsInternalUri","configUrl","unitId","environment","undefined","_readComponentData","getComponentData","config","_readProperties","getProperty"],"sources":["./Component.ts"],"sourcesContent":["import ResourceBundle from 'sap/base/i18n/ResourceBundle';\nimport Component from 'sap/ui/core/Component';\nimport ResourceModel from 'sap/ui/model/resource/ResourceModel';\nimport { PluginInfo, RawStartParameters } from './common/Types';\nimport ControllerFactory from './controller/ControllerFactory';\nimport PxApiWrapper from './pxapi/PxApiWrapper';\nimport ControlFactory from './ui/ControlFactory';\n\n/**\n *\n * @namespace sap.feedback.ui.flpplugin\n *\n * @class\n * Enables users to provide feedback in the Fiori Launchpad.\n *\n * @extends sap.ui.core.Component\n * @name sap.feedback.ui.flpplugin.Component\n * @author SAP SE\n * @since 1.90.0\n */\nexport default class MyComponent extends Component {\n\tstatic readonly metadata = {\n\t\tmanifest: 'json',\n\t\tproperties: {\n\t\t\t/**\n\t\t\t * @deprecated Deprecated with 1.114. Please use 'configIdentifier' property.\n\t\t\t * Specifies the url for the Web/App Feedback project which should be loaded. This property is mandatory when providing the configuration manually.\n\t\t\t */\n\t\t\turl: {\n\t\t\t\tname: 'url',\n\t\t\t\ttype: 'string'\n\t\t\t},\n\t\t\t/**\n\t\t\t * Specifies the unique tenant id to map feedback results to this tenant. This property is mandatory when providing the configuration manually.\n\t\t\t */\n\t\t\ttenantId: {\n\t\t\t\tname: 'tenantId',\n\t\t\t\ttype: 'string'\n\t\t\t},\n\t\t\t/**\n\t\t\t * @deprecated Deprecated with 1.114. Please use 'configIdentifier' property.\n\t\t\t * The tenant role provides an indicator of the tenant and its purpose (development, test, productive, etc.). Helpful to identify feedback from different source systems.\n\t\t\t */\n\t\t\ttenantRole: {\n\t\t\t\tname: 'tenantRole',\n\t\t\t\ttype: 'string'\n\t\t\t},\n\t\t\t/**\n\t\t\t * @deprecated Deprecated with 1.114. Please use 'configIdentifier' property.\n\t\t\t * Enables some new features and changes the data format for the context data collected with the survey to version 2.\n\t\t\t */\n\t\t\tisPushEnabled: {\n\t\t\t\tname: 'isPushEnabled',\n\t\t\t\ttype: 'boolean'\n\t\t\t},\n\t\t\t/**\n\t\t\t * @deprecated Deprecated with 1.114. Please use 'configIdentifier' property.\n\t\t\t * Internal usage only\n\t\t\t */\n\t\t\tpushChannelPath: {\n\t\t\t\tname: 'pushChannelPath',\n\t\t\t\ttype: 'string'\n\t\t\t},\n\t\t\t/**\n\t\t\t * Can be provided with the collected context data to the survey to allow filtering of survey results by product name.\n\t\t\t */\n\t\t\tproductName: {\n\t\t\t\tname: 'productName',\n\t\t\t\ttype: 'string'\n\t\t\t},\n\t\t\t/**\n\t\t\t * Can be provided with the collected context data to the survey to allow filtering of survey results by platform type.\n\t\t\t */\n\t\t\tplatformType: {\n\t\t\t\tname: 'platformType',\n\t\t\t\ttype: 'string'\n\t\t\t},\n\t\t\t/**\n\t\t\t * @deprecated Deprecated with 1.114. Please use 'configIdentifier' property.\n\t\t\t * Optional comma-separated string list of scope items to enable single features.\n\t\t\t */\n\t\t\tscopeSet: {\n\t\t\t\tname: 'scopeSet',\n\t\t\t\ttype: 'string'\n\t\t\t},\n\t\t\t/**\n\t\t\t * Identification data to select and load respective Central configuration.\n\t\t\t */\n\t\t\tconfigIdentifier: {\n\t\t\t\tname: 'configIdentifier',\n\t\t\t\ttype: 'object'\n\t\t\t},\n\t\t\t/**\n\t\t\t * Configuration providing all necessary information to start and run.\n\t\t\t */\n\t\t\tconfigJson: {\n\t\t\t\tname: 'configJson',\n\t\t\t\ttype: 'object'\n\t\t\t}\n\t\t}\n\t};\n\n\tprivate _pxApiWrapper: PxApiWrapper;\n\n\t// The following three lines were generated and should remain as-is to make TypeScript aware of the constructor signatures\n\tconstructor(idOrSettings?: string | $MyComponentSettings);\n\tconstructor(id?: string, settings?: $MyComponentSettings);\n\tconstructor(id?: string, settings?: $MyComponentSettings) {\n\t\tsuper(id, settings);\n\t}\n\n\tpublic init() {\n\t\t(async () => {\n\t\t\tconst settings = this.readFlpSettings();\n\t\t\tif (settings) {\n\t\t\t\tawait this.runInitProcess(settings);\n\t\t\t}\n\t\t})();\n\t}\n\n\tpublic async load(): Promise<void> {\n\t\tconst properties = this.readProperties();\n\t\tif (properties) {\n\t\t\tawait this.runInitProcess(properties);\n\t\t}\n\t}\n\n\tprivate async runInitProcess(parameters: RawStartParameters) {\n\t\tconst pluginInfo = {\n\t\t\tid: this.getManifestEntry('/sap.app/id'),\n\t\t\tversion: this.getManifestEntry('/sap.app/applicationVersion/version')\n\t\t} as PluginInfo;\n\t\tconst initController = ControllerFactory.createInitController(pluginInfo);\n\t\tconst invitationDialog = ControlFactory.createSurveyInvitationDialog(this.getResourceBundle());\n\t\tconst showCallback = invitationDialog.surveyInvitationDialogShowCallback.bind(invitationDialog);\n\t\tif (await initController.init(parameters, showCallback)) {\n\t\t\tthis._pxApiWrapper = initController.pxApiWrapper;\n\t\t\tif (this._pxApiWrapper) {\n\t\t\t\tthis._pxApiWrapper.invitationDialog = invitationDialog;\n\t\t\t\tthis.initializePluginController();\n\t\t\t}\n\t\t}\n\t}\n\n\tprivate async initializePluginController(): Promise<void> {\n\t\tconst pluginController = ControllerFactory.createPluginController(this._pxApiWrapper, this.getResourceBundle());\n\t\tawait pluginController.initPlugin();\n\t}\n\n\tprivate getResourceBundle(): ResourceBundle {\n\t\tconst resourceModel = this.getModel('i18n') as ResourceModel;\n\t\treturn resourceModel.getResourceBundle() as ResourceBundle;\n\t}\n\n\t// FLP Settings\n\tprivate readFlpSettings(): RawStartParameters | undefined {\n\t\tconst componentData = this.readComponentData();\n\t\tif (componentData) {\n\t\t\tif (\n\t\t\t\t(componentData.qualtricsInternalUri && componentData.tenantId && !componentData.configUrl) ||\n\t\t\t\t(!componentData.qualtricsInternalUri &&\n\t\t\t\t\tcomponentData.tenantId &&\n\t\t\t\t\tcomponentData.configUrl &&\n\t\t\t\t\tcomponentData.unitId &&\n\t\t\t\t\tcomponentData.environment)\n\t\t\t) {\n\t\t\t\treturn componentData as RawStartParameters;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprivate readComponentData(): any | undefined {\n\t\tconst componentData = this.getComponentData() as any;\n\t\tif (componentData && componentData.config) {\n\t\t\treturn componentData.config;\n\t\t}\n\t\treturn undefined;\n\t}\n\n\t// Component Properties\n\tprivate readProperties(): RawStartParameters | undefined {\n\t\tif ((this.getProperty('url') || this.getProperty('configIdentifier') || this.getProperty('configJson')) && this.getProperty('tenantId')) {\n\t\t\tconst properties = {\n\t\t\t\ttenantId: this.getProperty('tenantId'),\n\t\t\t\ttenantRole: this.getProperty('tenantRole'),\n\t\t\t\tqualtricsInternalUri: this.getProperty('url'),\n\t\t\t\tisPushEnabled: this.getProperty('isPushEnabled'),\n\t\t\t\tpushChannelPath: this.getProperty('pushChannelPath'),\n\t\t\t\tplatformType: this.getProperty('platformType'),\n\t\t\t\tproductName: this.getProperty('productName'),\n\t\t\t\tscopeSet: this.getProperty('scopeSet'),\n\t\t\t\tconfigJson: this.getProperty('configJson')\n\t\t\t} as RawStartParameters;\n\n\t\t\tif (this.getProperty('configIdentifier')) {\n\t\t\t\tconst configIdentifier = this.getProperty('configIdentifier');\n\t\t\t\tproperties.configUrl = configIdentifier.configUrl;\n\t\t\t\tproperties.unitId = configIdentifier.unitId;\n\t\t\t\tproperties.environment = configIdentifier.environment;\n\t\t\t}\n\t\t\treturn properties;\n\t\t}\n\t\treturn undefined;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}