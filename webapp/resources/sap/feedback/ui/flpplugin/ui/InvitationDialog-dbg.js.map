{"version":3,"file":"InvitationDialog-dbg.js","names":["PushType","___sap_px_pxapi","ButtonType","sap_m_library","DialogType","Ui5ControlFactory","_interopRequireDefault","__Ui5ControlFactory","Constants","__Constants","AppContextData","__AppContextData","InvitationDialog","resourceBundle","_classCallCheck","_resourceBundle","_createClass","key","value","surveyInvitationDialogShowCallback","eventData","_this","surveyInvitationDialogResponse","Promise","resolve","_resolveSurveyInvitation","_temp","showInvitation","showInvitationDialog","pushType","sendInvitationCallbackResponse","then","e","reject","_invitationDialog","createInvitationDialog","isOpen","setDismissButtonText","open","dismissButtonText","getText","timedPush","getEndButton","setText","onInvitationDialogClose","willProvideFeedback","_this2","close","_this3","getData","appContextData","surveyUser","textKey","_this$_resourceBundle","createFeedbackButton","_this4","createButton","type","Emphasized","text","press","createDismissButton","_this5","createDialog","Message","title","content","createFormattedText","htmlText","beginButton","endButton","escapeHandler","handleEscape","bind","SURVEY_INVITATION_DIALOG_ID","promise"],"sourceRoot":".","sources":["InvitationDialog.ts"],"sourcesContent":["import { PushType } from '@sap-px/pxapi';\nimport { SurveyInvitationDialogDecision, SurveyInvitationDialogEventData, SurveyInvitationResultData } from '@sap-px/pxapi/dist/api/common/Types';\nimport ResourceBundle from 'sap/base/i18n/ResourceBundle';\nimport Button from 'sap/m/Button';\nimport Dialog from 'sap/m/Dialog';\nimport { ButtonType, DialogType } from 'sap/m/library';\nimport Ui5ControlFactory from './Ui5ControlFactory';\nimport Constants from '../common/Constants';\nimport AppContextData from '../data/AppContextData';\n\nexport default class InvitationDialog {\n\tprivate _resourceBundle: ResourceBundle;\n\tprivate _invitationDialog: Dialog;\n\tprivate _resolveSurveyInvitation: SurveyInvitationDialogDecision;\n\n\tconstructor(resourceBundle: ResourceBundle) {\n\t\tthis._resourceBundle = resourceBundle;\n\t}\n\n\tpublic async surveyInvitationDialogShowCallback(eventData: SurveyInvitationDialogEventData): Promise<SurveyInvitationResultData> {\n\t\tconst surveyInvitationDialogResponse = new Promise<SurveyInvitationResultData>((resolve) => (this._resolveSurveyInvitation = resolve));\n\t\tif (eventData.showInvitation) {\n\t\t\tthis.showInvitationDialog(eventData.pushType);\n\t\t} else {\n\t\t\tawait this.sendInvitationCallbackResponse(true);\n\t\t}\n\t\treturn surveyInvitationDialogResponse;\n\t}\n\n\tprivate showInvitationDialog(pushType: PushType) {\n\t\tif (!this._invitationDialog) {\n\t\t\tthis._invitationDialog = this.createInvitationDialog();\n\t\t}\n\t\tif (!this._invitationDialog.isOpen()) {\n\t\t\tthis.setDismissButtonText(pushType);\n\t\t\tthis._invitationDialog.open();\n\t\t}\n\t}\n\n\tprivate setDismissButtonText(pushType: PushType) {\n\t\tlet dismissButtonText = this.getText('YOUR_OPINION_NOTNOW');\n\t\tif (pushType === PushType.timedPush) {\n\t\t\tdismissButtonText = this.getText('YOUR_OPINION_ASKLATERBUTTON');\n\t\t}\n\t\tthis._invitationDialog.getEndButton().setText(dismissButtonText);\n\t}\n\n\tprivate async onInvitationDialogClose(willProvideFeedback: boolean) {\n\t\tthis._invitationDialog.close();\n\t\tawait this.sendInvitationCallbackResponse(willProvideFeedback);\n\t}\n\n\tprivate async sendInvitationCallbackResponse(willProvideFeedback: boolean) {\n\t\tconst appContextData = await AppContextData.getData();\n\t\tthis._resolveSurveyInvitation({ appContextData: appContextData, surveyUser: willProvideFeedback });\n\t}\n\n\tprivate getText(textKey: string): string {\n\t\treturn this._resourceBundle.getText(textKey) ?? textKey;\n\t}\n\n\tprivate createFeedbackButton(): Button {\n\t\treturn Ui5ControlFactory.createButton({\n\t\t\ttype: ButtonType.Emphasized,\n\t\t\ttext: this.getText('YOUR_OPINION_PROVIDEBUTTON'),\n\t\t\tpress: () => {\n\t\t\t\tthis.onInvitationDialogClose(true);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate createDismissButton(): Button {\n\t\treturn Ui5ControlFactory.createButton({\n\t\t\ttext: this.getText('YOUR_OPINION_NOTNOW'),\n\t\t\tpress: () => {\n\t\t\t\tthis.onInvitationDialogClose(false);\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate createInvitationDialog(): Dialog {\n\t\treturn Ui5ControlFactory.createDialog(\n\t\t\t{\n\t\t\t\ttype: DialogType.Message,\n\t\t\t\ttitle: this.getText('YOUR_OPINION_TITLE'),\n\t\t\t\tcontent: Ui5ControlFactory.createFormattedText({ htmlText: this.getText('YOUR_OPINION_TEXT') }),\n\t\t\t\tbeginButton: this.createFeedbackButton(),\n\t\t\t\tendButton: this.createDismissButton(),\n\t\t\t\tescapeHandler: this.handleEscape.bind(this)\n\t\t\t},\n\t\t\tConstants.SURVEY_INVITATION_DIALOG_ID\n\t\t);\n\t}\n\n\tprivate handleEscape(promise: { resolve(): void; reject(): void }) {\n\t\tpromise.resolve();\n\t\tthis.onInvitationDialogClose(false);\n\t}\n}\n"],"mappings":"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","ignoreList":[]}