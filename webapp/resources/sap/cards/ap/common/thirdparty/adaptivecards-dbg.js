sap.ui.define(function(){"use strict";var e=typeof globalThis!=="undefined"?globalThis:typeof window!=="undefined"?window:typeof global!=="undefined"?global:typeof self!=="undefined"?self:{};var t={};var n={};var i={};var r={};(function(e){
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
Object.defineProperty(e,"__esModule",{value:true});e.LogLevel=e.RefreshMode=e.ContainerFitStatus=e.ValidationEvent=e.ValidationPhase=e.ContainerStyle=e.InputTextStyle=e.ActionIconPlacement=e.FillMode=e.Orientation=e.ShowCardActionMode=e.ImageStyle=e.ActionAlignment=e.VerticalAlignment=e.HorizontalAlignment=e.TextColor=e.Spacing=e.FontType=e.TextWeight=e.TextSize=e.SizeUnit=e.ImageSize=e.Size=e.ActionStyle=void 0;var t=function(){function e(){}e.Default="default";e.Positive="positive";e.Destructive="destructive";return e}();e.ActionStyle=t;(function(e){e[e["Auto"]=0]="Auto";e[e["Stretch"]=1]="Stretch";e[e["Small"]=2]="Small";e[e["Medium"]=3]="Medium";e[e["Large"]=4]="Large"})(e.Size||(e.Size={}));(function(e){e[e["Small"]=0]="Small";e[e["Medium"]=1]="Medium";e[e["Large"]=2]="Large"})(e.ImageSize||(e.ImageSize={}));(function(e){e[e["Weight"]=0]="Weight";e[e["Pixel"]=1]="Pixel"})(e.SizeUnit||(e.SizeUnit={}));(function(e){e[e["Small"]=0]="Small";e[e["Default"]=1]="Default";e[e["Medium"]=2]="Medium";e[e["Large"]=3]="Large";e[e["ExtraLarge"]=4]="ExtraLarge"})(e.TextSize||(e.TextSize={}));(function(e){e[e["Lighter"]=0]="Lighter";e[e["Default"]=1]="Default";e[e["Bolder"]=2]="Bolder"})(e.TextWeight||(e.TextWeight={}));(function(e){e[e["Default"]=0]="Default";e[e["Monospace"]=1]="Monospace"})(e.FontType||(e.FontType={}));(function(e){e[e["None"]=0]="None";e[e["Small"]=1]="Small";e[e["Default"]=2]="Default";e[e["Medium"]=3]="Medium";e[e["Large"]=4]="Large";e[e["ExtraLarge"]=5]="ExtraLarge";e[e["Padding"]=6]="Padding"})(e.Spacing||(e.Spacing={}));(function(e){e[e["Default"]=0]="Default";e[e["Dark"]=1]="Dark";e[e["Light"]=2]="Light";e[e["Accent"]=3]="Accent";e[e["Good"]=4]="Good";e[e["Warning"]=5]="Warning";e[e["Attention"]=6]="Attention"})(e.TextColor||(e.TextColor={}));(function(e){e[e["Left"]=0]="Left";e[e["Center"]=1]="Center";e[e["Right"]=2]="Right"})(e.HorizontalAlignment||(e.HorizontalAlignment={}));(function(e){e[e["Top"]=0]="Top";e[e["Center"]=1]="Center";e[e["Bottom"]=2]="Bottom"})(e.VerticalAlignment||(e.VerticalAlignment={}));(function(e){e[e["Left"]=0]="Left";e[e["Center"]=1]="Center";e[e["Right"]=2]="Right";e[e["Stretch"]=3]="Stretch"})(e.ActionAlignment||(e.ActionAlignment={}));(function(e){e[e["Default"]=0]="Default";e[e["Person"]=1]="Person"})(e.ImageStyle||(e.ImageStyle={}));(function(e){e[e["Inline"]=0]="Inline";e[e["Popup"]=1]="Popup"})(e.ShowCardActionMode||(e.ShowCardActionMode={}));(function(e){e[e["Horizontal"]=0]="Horizontal";e[e["Vertical"]=1]="Vertical"})(e.Orientation||(e.Orientation={}));(function(e){e[e["Cover"]=0]="Cover";e[e["RepeatHorizontally"]=1]="RepeatHorizontally";e[e["RepeatVertically"]=2]="RepeatVertically";e[e["Repeat"]=3]="Repeat"})(e.FillMode||(e.FillMode={}));(function(e){e[e["LeftOfTitle"]=0]="LeftOfTitle";e[e["AboveTitle"]=1]="AboveTitle"})(e.ActionIconPlacement||(e.ActionIconPlacement={}));(function(e){e[e["Text"]=0]="Text";e[e["Tel"]=1]="Tel";e[e["Url"]=2]="Url";e[e["Email"]=3]="Email"})(e.InputTextStyle||(e.InputTextStyle={}));var n=function(){function e(){}e.Default="default";e.Emphasis="emphasis";e.Accent="accent";e.Good="good";e.Attention="attention";e.Warning="warning";return e}();e.ContainerStyle=n;(function(e){e[e["Parse"]=0]="Parse";e[e["ToJSON"]=1]="ToJSON";e[e["Validation"]=2]="Validation"})(e.ValidationPhase||(e.ValidationPhase={}));(function(e){e[e["Hint"]=0]="Hint";e[e["ActionTypeNotAllowed"]=1]="ActionTypeNotAllowed";e[e["CollectionCantBeEmpty"]=2]="CollectionCantBeEmpty";e[e["Deprecated"]=3]="Deprecated";e[e["ElementTypeNotAllowed"]=4]="ElementTypeNotAllowed";e[e["InteractivityNotAllowed"]=5]="InteractivityNotAllowed";e[e["InvalidPropertyValue"]=6]="InvalidPropertyValue";e[e["MissingCardType"]=7]="MissingCardType";e[e["PropertyCantBeNull"]=8]="PropertyCantBeNull";e[e["TooManyActions"]=9]="TooManyActions";e[e["UnknownActionType"]=10]="UnknownActionType";e[e["UnknownElementType"]=11]="UnknownElementType";e[e["UnsupportedCardVersion"]=12]="UnsupportedCardVersion";e[e["DuplicateId"]=13]="DuplicateId";e[e["UnsupportedProperty"]=14]="UnsupportedProperty";e[e["RequiredInputsShouldHaveLabel"]=15]="RequiredInputsShouldHaveLabel";e[e["RequiredInputsShouldHaveErrorMessage"]=16]="RequiredInputsShouldHaveErrorMessage";e[e["Other"]=17]="Other"})(e.ValidationEvent||(e.ValidationEvent={}));(function(e){e[e["FullyInContainer"]=0]="FullyInContainer";e[e["Overflowing"]=1]="Overflowing";e[e["FullyOutOfContainer"]=2]="FullyOutOfContainer"})(e.ContainerFitStatus||(e.ContainerFitStatus={}));(function(e){e[e["Disabled"]=0]="Disabled";e[e["Manual"]=1]="Manual";e[e["Automatic"]=2]="Automatic"})(e.RefreshMode||(e.RefreshMode={}));(function(e){e[e["Info"]=0]="Info";e[e["Warning"]=1]="Warning";e[e["Error"]=2]="Error"})(e.LogLevel||(e.LogLevel={}))})(r);(function(e){Object.defineProperty(e,"__esModule",{value:true});e.UUID=e.SizeAndUnit=e.PaddingDefinition=e.SpacingDefinition=e.StringWithSubstitutions=e.ContentTypes=e.GlobalSettings=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var t=r;var n=function(){function e(){}e.useAdvancedTextBlockTruncation=true;e.useAdvancedCardBottomTruncation=false;e.useMarkdownInRadioButtonAndCheckbox=true;e.allowMarkForTextHighlighting=false;e.alwaysBleedSeparators=false;e.enableFullJsonRoundTrip=false;e.displayInputValidationErrors=true;e.allowPreProcessingPropertyValues=false;e.setTabIndexAtCardRoot=true;e.enableFallback=true;e.useWebkitLineClamp=true;e.applets={logEnabled:true,logLevel:t.LogLevel.Error,maximumRetryAttempts:3,defaultTimeBetweenRetryAttempts:3e3,authPromptWidth:400,authPromptHeight:600,refresh:{mode:t.RefreshMode.Manual,timeBetweenAutomaticRefreshes:3e3,maximumConsecutiveAutomaticRefreshes:3,allowManualRefreshesAfterAutomaticRefreshes:true}};return e}();e.GlobalSettings=n;e.ContentTypes={applicationJson:"application/json",applicationXWwwFormUrlencoded:"application/x-www-form-urlencoded"};var i=function(){function t(){this._isProcessed=false}t.prototype.getReferencedInputs=function(e,t){if(!t){throw new Error("The referencedInputs parameter cannot be null.")}for(var n=0,i=e;n<i.length;n++){var r=i[n];var o=new RegExp("\\{{2}("+r.id+").value\\}{2}","gi").exec(this._original);if(o!=null&&r.id){t[r.id]=r}}};t.prototype.substituteInputValues=function(t,n){this._processed=this._original;if(this._original){var i=/\{{2}([a-z0-9_$@]+).value\}{2}/gi;var r=void 0;while((r=i.exec(this._original))!==null){for(var o=0,a=Object.keys(t);o<a.length;o++){var s=a[o];if(s.toLowerCase()==r[1].toLowerCase()){var l=t[s];var u="";if(l.value){u=l.value}if(n===e.ContentTypes.applicationJson){u=JSON.stringify(u);u=u.slice(1,-1)}else if(n===e.ContentTypes.applicationXWwwFormUrlencoded){u=encodeURIComponent(u)}this._processed=this._processed.replace(r[0],u);break}}}}this._isProcessed=true};t.prototype.getOriginal=function(){return this._original};t.prototype.get=function(){if(!this._isProcessed){return this._original}else{return this._processed}};t.prototype.set=function(e){this._original=e;this._isProcessed=false};return t}();e.StringWithSubstitutions=i;var o=function(){function e(e,t,n,i){if(e===void 0){e=0}if(t===void 0){t=0}if(n===void 0){n=0}if(i===void 0){i=0}this.left=0;this.top=0;this.right=0;this.bottom=0;this.top=e;this.right=t;this.bottom=n;this.left=i}return e}();e.SpacingDefinition=o;var a=function(){function e(e,n,i,r){if(e===void 0){e=t.Spacing.None}if(n===void 0){n=t.Spacing.None}if(i===void 0){i=t.Spacing.None}if(r===void 0){r=t.Spacing.None}this.top=t.Spacing.None;this.right=t.Spacing.None;this.bottom=t.Spacing.None;this.left=t.Spacing.None;this.top=e;this.right=n;this.bottom=i;this.left=r}return e}();e.PaddingDefinition=a;var s=function(){function e(e,t){this.physicalSize=e;this.unit=t}e.parse=function(n,i){if(i===void 0){i=false}var r=new e(0,t.SizeUnit.Weight);if(typeof n==="number"){r.physicalSize=n;return r}else if(typeof n==="string"){var o=/^([0-9]+)(px|\*)?$/g;var a=o.exec(n);var s=i?3:2;if(a&&a.length>=s){r.physicalSize=parseInt(a[1]);if(a.length==3){if(a[2]=="px"){r.unit=t.SizeUnit.Pixel}}return r}}throw new Error("Invalid size: "+n)};return e}();e.SizeAndUnit=s;
/**
		 * Fast UUID generator, RFC4122 version 4 compliant.
		 * @author Jeff Ward (jcward.com).
		 * @license MIT license
		 * @link http://stackoverflow.com/questions/105034/how-to-create-a-guid-uuid-in-javascript/21963136#21963136
		 **/var l=function(){function e(){}e.generate=function(){var t=Math.random()*4294967295|0;var n=Math.random()*4294967295|0;var i=Math.random()*4294967295|0;var r=Math.random()*4294967295|0;return e.lut[t&255]+e.lut[t>>8&255]+e.lut[t>>16&255]+e.lut[t>>24&255]+"-"+e.lut[n&255]+e.lut[n>>8&255]+"-"+e.lut[n>>16&15|64]+e.lut[n>>24&255]+"-"+e.lut[i&63|128]+e.lut[i>>8&255]+"-"+e.lut[i>>16&255]+e.lut[i>>24&255]+e.lut[r&255]+e.lut[r>>8&255]+e.lut[r>>16&255]+e.lut[r>>24&255]};e.initialize=function(){for(var t=0;t<256;t++){e.lut[t]=(t<16?"0":"")+t.toString(16)}};e.lut=[];return e}();e.UUID=l;l.initialize()})(i);var o={};Object.defineProperty(o,"__esModule",{value:true});o.clearElementChildren=o.getFitStatus=o.truncate=o.stringToCssColor=o.renderSeparation=o.parseEnum=o.getEnumValueByName=o.parseBool=o.parseNumber=o.parseString=o.appendChild=o.generateUniqueId=o.isMobileOS=o.isInternetExplorer=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var a=r;var s=i;function l(){return window.document.documentMode!==undefined}o.isInternetExplorer=l;function u(){var e=window.navigator.userAgent;return!!e.match(/Android/i)||!!e.match(/iPad/i)||!!e.match(/iPhone/i)}o.isMobileOS=u;function p(){return"__ac-"+s.UUID.generate()}o.generateUniqueId=p;function c(e,t){if(t){e.appendChild(t)}}o.appendChild=c;function d(e,t){return typeof e==="string"?e:t}o.parseString=d;function f(e,t){return typeof e==="number"?e:t}o.parseNumber=f;function h(e,t){if(typeof e==="boolean"){return e}else if(typeof e==="string"){switch(e.toLowerCase()){case"true":return true;case"false":return false;default:return t}}return t}o.parseBool=h;function y(e,t){for(var n in e){var i=parseInt(n,10);if(i>=0){var r=e[n];if(r&&typeof r==="string"&&r.toLowerCase()===t.toLowerCase()){return i}}}return undefined}o.getEnumValueByName=y;function g(e,t,n){if(!t){return n}var i=y(e,t);return i!==undefined?i:n}o.parseEnum=g;function m(e,t,n){if(t.spacing>0||t.lineThickness&&t.lineThickness>0){var i=document.createElement("div");i.className=e.makeCssClassName("ac-"+(n==a.Orientation.Horizontal?"horizontal":"vertical")+"-separator");i.setAttribute("aria-hidden","true");var r=t.lineColor?v(t.lineColor):"";if(n==a.Orientation.Horizontal){if(t.lineThickness){i.style.paddingTop=t.spacing/2+"px";i.style.marginBottom=t.spacing/2+"px";i.style.borderBottom=t.lineThickness+"px solid "+r}else{i.style.height=t.spacing+"px"}}else{if(t.lineThickness){i.style.paddingLeft=t.spacing/2+"px";i.style.marginRight=t.spacing/2+"px";i.style.borderRight=t.lineThickness+"px solid "+r}else{i.style.width=t.spacing+"px"}}i.style.overflow="hidden";i.style.flex="0 0 auto";return i}else{return undefined}}o.renderSeparation=m;function v(e){if(e){var t=/#([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})([0-9A-F]{2})?/gi;var n=t.exec(e);if(n&&n[4]){var i=parseInt(n[1],16)/255;var r=parseInt(n[2],16);var o=parseInt(n[3],16);var a=parseInt(n[4],16);return"rgba("+r+","+o+","+a+","+i+")"}}return e}o.stringToCssColor=v;function b(e,t,n){var i=function(){return t-e.scrollHeight>=-1};if(i())return;var r=e.innerHTML;var o=function(t){e.innerHTML=r.substring(0,t)+"..."};var a=C(r);var s=0;var l=a.length;var u=0;while(s<l){var p=Math.floor((s+l)/2);o(a[p]);if(i()){u=a[p];s=p+1}else{l=p}}o(u);if(n&&t-e.scrollHeight>=n-1){var c=S(r,u);while(c<r.length){o(c);if(i()){u=c;c=S(r,c)}else{break}}o(u)}}o.truncate=b;function C(e){var t=[];var n=S(e,-1);while(n<e.length){if(e[n]==" "){t.push(n)}n=S(e,n)}return t}function S(e,t){t+=1;while(t<e.length&&e[t]=="<"){while(t<e.length&&e[t++]!=">");}return t}function P(e,t){var n=e.offsetTop;var i=n+e.clientHeight;if(i<=t){return a.ContainerFitStatus.FullyInContainer}else if(n<t){return a.ContainerFitStatus.Overflowing}else{return a.ContainerFitStatus.FullyOutOfContainer}}o.getFitStatus=P;function _(e){while(e.firstChild){e.removeChild(e.firstChild)}}o.clearElementChildren=_;var A={};Object.defineProperty(A,"__esModule",{value:true});A.Strings=void 0;var w=function(){function e(){}e.errors={unknownElementType:function(e){return'Unknown element type "'+e+'". Fallback will be used if present.'},unknownActionType:function(e){return'Unknown action type "'+e+'". Fallback will be used if present.'},elementTypeNotAllowed:function(e){return'Element type "'+e+'" is not allowed in this context.'},actionTypeNotAllowed:function(e){return'Action type "'+e+'" is not allowed in this context.'},invalidPropertyValue:function(e,t){return'Invalid value "'+e+'" for property "'+t+'".'},showCardMustHaveCard:function(){return'"An Action.ShowCard must have its "card" property set to a valid AdaptiveCard object.'},invalidColumnWidth:function(e){return'Invalid column width "'+e+'" - defaulting to "auto".'},invalidCardVersion:function(e){return'Invalid card version. Defaulting to "'+e+'".'},invalidVersionString:function(e){return'Invalid version string "'+e+'".'},propertyValueNotSupported:function(e,t,n,i){return'Value "'+e+'" for property "'+t+'" is supported in version '+n+", but you are using version "+i+"."},propertyNotSupported:function(e,t,n){return'Property "'+e+'" is supported in version '+t+", but you are using version "+n+"."},indexOutOfRange:function(e){return"Index out of range ("+e+")."},elementCannotBeUsedAsInline:function(){return"RichTextBlock.addInline: the specified card element cannot be used as a RichTextBlock inline."},inlineAlreadyParented:function(){return"RichTextBlock.addInline: the specified inline already belongs to another RichTextBlock."},interactivityNotAllowed:function(){return"Interactivity is not allowed."},inputsMustHaveUniqueId:function(){return"All inputs must have a unique Id."},choiceSetMustHaveAtLeastOneChoice:function(){return"An Input.ChoiceSet must have at least one choice defined."},choiceSetChoicesMustHaveTitleAndValue:function(){return"All choices in an Input.ChoiceSet must have their title and value properties set."},propertyMustBeSet:function(e){return'Property "'+e+'" must be set.'},actionHttpHeadersMustHaveNameAndValue:function(){return"All headers of an Action.Http must have their name and value properties set."},tooManyActions:function(e){return"Maximum number of actions exceeded ("+e+")."},columnAlreadyBelongsToAnotherSet:function(){return"This column already belongs to another ColumnSet."},invalidCardType:function(){return'Invalid or missing card type. Make sure the card\'s type property is set to "AdaptiveCard".'},unsupportedCardVersion:function(e,t){return"The specified card version ("+e+") is not supported. The maximum supported card version is "+t+"."},duplicateId:function(e){return'Duplicate Id "'+e+'".'},markdownProcessingNotEnabled:function(){return"Markdown processing isn't enabled. Please see https://www.npmjs.com/package/adaptivecards#supporting-markdown"},processMarkdownEventRemoved:function(){return"The processMarkdown event has been removed. Please update your code and set onProcessMarkdown instead."},elementAlreadyParented:function(){return"The element already belongs to another container."},actionAlreadyParented:function(){return"The action already belongs to another element."},elementTypeNotStandalone:function(e){return"Elements of type "+e+" cannot be used as standalone elements."}};e.magicCodeInputCard={tryAgain:function(){return"That didn't work... let's try again."},pleaseLogin:function(){return'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"'},enterMagicCode:function(){return"Enter magic code"},pleaseEnterMagicCodeYouReceived:function(){return"Please enter the magic code you received."},submit:function(){return"Submit"},cancel:function(){return"Cancel"},somethingWentWrong:function(){return"Something went wrong. This action can't be handled."},authenticationFailed:function(){return"Authentication failed."}};e.runtime={automaticRefreshPaused:function(){return"Automatic refresh paused."},clckToRestartAutomaticRefresh:function(){return"Click to restart."},refreshThisCard:function(){return"Refresh this card"}};e.hints={dontUseWeightedAndStrecthedColumnsInSameSet:function(){return"It is not recommended to use weighted and stretched columns in the same ColumnSet, because in such a situation stretched columns will always get the minimum amount of space."}};e.defaults={inlineActionTitle:function(){return"Inline Action"},mediaPlayerAriaLabel:function(){return"Media content"},mediaPlayerPlayMedia:function(){return"Play media"}};return e}();A.Strings=w;var E=e&&e.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(n,"__esModule",{value:true});n.SerializableObject=n.property=n.SerializableObjectSchema=n.CustomProperty=n.SerializableObjectCollectionProperty=n.SerializableObjectProperty=n.EnumProperty=n.ValueSetProperty=n.StringArrayProperty=n.PixelSizeProperty=n.NumProperty=n.BoolProperty=n.StringProperty=n.PropertyDefinition=n.BaseSerializationContext=n.isVersionLessOrEqual=n.Versions=n.Version=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var x=i;var I=o;var T=r;var V=A;var O=function(){function e(e,t,n){if(e===void 0){e=1}if(t===void 0){t=1}this._isValid=true;this._major=e;this._minor=t;this._label=n}e.parse=function(t,n){if(!t){return undefined}var i=new e;i._versionString=t;var r=/(\d+).(\d+)/gi;var o=r.exec(t);if(o!=null&&o.length==3){i._major=parseInt(o[1]);i._minor=parseInt(o[2])}else{i._isValid=false}if(!i._isValid){n.logParseEvent(undefined,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.invalidVersionString(i._versionString))}return i};e.prototype.toString=function(){return!this._isValid?this._versionString:this._major+"."+this._minor};e.prototype.toJSON=function(){return this.toString()};e.prototype.compareTo=function(e){if(!this.isValid||!e.isValid){throw new Error("Cannot compare invalid version.")}if(this.major>e.major){return 1}else if(this.major<e.major){return-1}else if(this.minor>e.minor){return 1}else if(this.minor<e.minor){return-1}return 0};Object.defineProperty(e.prototype,"label",{get:function(){return this._label?this._label:this.toString()},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"major",{get:function(){return this._major},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"minor",{get:function(){return this._minor},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"isValid",{get:function(){return this._isValid},enumerable:false,configurable:true});return e}();n.Version=O;var k=function(){function e(){}e.v1_0=new O(1,0);e.v1_1=new O(1,1);e.v1_2=new O(1,2);e.v1_3=new O(1,3);e.v1_4=new O(1,4);e.latest=e.v1_4;return e}();n.Versions=k;function N(e,t){if(e instanceof O){if(t instanceof O){return t.compareTo(e)>=0}else{return true}}else{return true}}n.isVersionLessOrEqual=N;var z=function(){function e(e){if(e===void 0){e=k.latest}this.targetVersion=e;this._validationEvents=[]}e.prototype.serializeValue=function(e,t,n,i,r){if(i===void 0){i=undefined}if(r===void 0){r=false}if(n===null||n===undefined||n===i){if(!x.GlobalSettings.enableFullJsonRoundTrip||r){delete e[t]}}else{e[t]=n}};e.prototype.serializeString=function(e,t,n,i){if(n===null||n===undefined||n===i){delete e[t]}else{e[t]=n}};e.prototype.serializeBool=function(e,t,n,i){if(n===null||n===undefined||n===i){delete e[t]}else{e[t]=n}};e.prototype.serializeNumber=function(e,t,n,i){if(n===null||n===undefined||n===i||isNaN(n)){delete e[t]}else{e[t]=n}};e.prototype.serializeEnum=function(e,t,n,i,r){if(r===void 0){r=undefined}var o=t[n];var a=o==undefined?true:e[o]!==undefined;if(i==r){if(a){delete t[n]}}else{if(i==undefined){if(a){delete t[n]}}else{t[n]=e[i]}}};e.prototype.serializeArray=function(e,t,n){var i=[];if(n){for(var r=0,o=n;r<o.length;r++){var a=o[r];var s=undefined;if(a instanceof X){s=a.toJSON(this)}else if(a.toJSON){s=a.toJSON()}else{s=a}if(s!==undefined){i.push(s)}}}if(i.length==0){if(e.hasOwnProperty(t)&&Array.isArray(e[t])){delete e[t]}}else{this.serializeValue(e,t,i)}};e.prototype.clearEvents=function(){this._validationEvents=[]};e.prototype.logEvent=function(e,t,n,i){this._validationEvents.push({source:e,phase:t,event:n,message:i})};e.prototype.logParseEvent=function(e,t,n){this.logEvent(e,T.ValidationPhase.Parse,t,n)};e.prototype.getEventAt=function(e){return this._validationEvents[e]};Object.defineProperty(e.prototype,"eventCount",{get:function(){return this._validationEvents.length},enumerable:false,configurable:true});return e}();n.BaseSerializationContext=z;var R=function(e){E(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(z);var L=function(){function e(t,n,i,r){this.targetVersion=t;this.name=n;this.defaultValue=i;this.onGetInitialValue=r;this.isSerializationEnabled=true;this.sequentialNumber=e._sequentialNumber;e._sequentialNumber++}e.prototype.getInternalName=function(){return this.name};e.prototype.parse=function(e,t,n){return t[this.name]};e.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n,this.defaultValue)};e._sequentialNumber=0;return e}();n.PropertyDefinition=L;var B=function(e){E(t,e);function t(t,n,i,r,o,a){if(i===void 0){i=true}var s=e.call(this,t,n,o,a)||this;s.targetVersion=t;s.name=n;s.treatEmptyAsUndefined=i;s.regEx=r;s.defaultValue=o;s.onGetInitialValue=a;return s}t.prototype.parse=function(e,t,n){var i=I.parseString(t[this.name],this.defaultValue);var r=i===undefined||i===""&&this.treatEmptyAsUndefined;if(!r&&this.regEx!==undefined){var o=this.regEx.exec(i);if(!o){n.logParseEvent(e,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.invalidPropertyValue(i,this.name));return undefined}}return i};t.prototype.toJSON=function(e,t,n,i){i.serializeString(t,this.name,n===""&&this.treatEmptyAsUndefined?undefined:n,this.defaultValue)};return t}(L);n.StringProperty=B;var D=function(e){E(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.parse=function(e,t,n){return I.parseBool(t[this.name],this.defaultValue)};t.prototype.toJSON=function(e,t,n,i){i.serializeBool(t,this.name,n,this.defaultValue)};return t}(L);n.BoolProperty=D;var M=function(e){E(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.parse=function(e,t,n){return I.parseNumber(t[this.name],this.defaultValue)};t.prototype.toJSON=function(e,t,n,i){i.serializeNumber(t,this.name,n,this.defaultValue)};return t}(L);n.NumProperty=M;var j=function(e){E(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.parse=function(e,t,n){var i=undefined;var r=t[this.name];if(typeof r==="string"){var o=false;try{var a=x.SizeAndUnit.parse(r,true);if(a.unit==T.SizeUnit.Pixel){i=a.physicalSize;o=true}}catch(e){}if(!o){n.logParseEvent(e,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.invalidPropertyValue(t[this.name],"minHeight"))}}return i};t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,typeof n==="number"&&!isNaN(n)?n+"px":undefined)};return t}(L);n.PixelSizeProperty=j;var F=function(e){E(t,e);function t(t,n,i,r){var o=e.call(this,t,n,i,r)||this;o.targetVersion=t;o.name=n;o.defaultValue=i;o.onGetInitialValue=r;return o}t.prototype.parse=function(e,t,n){var i=t[this.name];if(i===undefined||!Array.isArray(i)){return this.defaultValue}var r=[];for(var o=0,a=i;o<a.length;o++){var s=a[o];if(typeof s==="string"){r.push(s)}else{n.logParseEvent(e,T.ValidationEvent.InvalidPropertyValue,'Invalid array value "'+s+'" of type "'+typeof s+'" ignored for "'+this.name+'".')}}return r};t.prototype.toJSON=function(e,t,n,i){i.serializeArray(t,this.name,n)};return t}(L);n.StringArrayProperty=F;var H=function(e){E(t,e);function t(t,n,i,r,o){var a=e.call(this,t,n,r,o)||this;a.targetVersion=t;a.name=n;a.values=i;a.defaultValue=r;a.onGetInitialValue=o;return a}t.prototype.isValidValue=function(e,t){for(var n=0,i=this.values;n<i.length;n++){var r=i[n];if(e.toLowerCase()===r.value.toLowerCase()){var o=r.targetVersion?r.targetVersion:this.targetVersion;return o.compareTo(t.targetVersion)<=0}}return false};t.prototype.parse=function(e,t,n){var i=t[this.name];if(i===undefined){return this.defaultValue}if(typeof i==="string"){for(var r=0,o=this.values;r<o.length;r++){var a=o[r];if(i.toLowerCase()===a.value.toLowerCase()){var s=a.targetVersion?a.targetVersion:this.targetVersion;if(s.compareTo(n.targetVersion)<=0){return a.value}else{n.logParseEvent(e,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.propertyValueNotSupported(i,this.name,s.toString(),n.targetVersion.toString()));return this.defaultValue}}}}n.logParseEvent(e,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.invalidPropertyValue(i,this.name));return this.defaultValue};t.prototype.toJSON=function(e,t,n,i){var r=false;for(var o=0,a=this.values;o<a.length;o++){var s=a[o];if(s.value===n){var l=s.targetVersion?s.targetVersion:this.targetVersion;if(l.compareTo(i.targetVersion)<=0){r=true;break}else{i.logEvent(e,T.ValidationPhase.ToJSON,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.propertyValueNotSupported(n,this.name,l.toString(),i.targetVersion.toString()))}}}if(r){i.serializeValue(t,this.name,n,this.defaultValue)}};return t}(L);n.ValueSetProperty=H;var W=function(e){E(t,e);function t(t,n,i,r,o,a){var s=e.call(this,t,n,r,a)||this;s.targetVersion=t;s.name=n;s.enumType=i;s.defaultValue=r;s.onGetInitialValue=a;s._values=[];if(!o){for(var l in i){var u=parseInt(l,10);if(u>=0){s._values.push({value:u})}}}else{s._values=o}return s}t.prototype.parse=function(e,t,n){var i=t[this.name];if(typeof i!=="string"){return this.defaultValue}var r=I.getEnumValueByName(this.enumType,i);if(r!==undefined){for(var o=0,a=this.values;o<a.length;o++){var s=a[o];if(s.value===r){var l=s.targetVersion?s.targetVersion:this.targetVersion;if(l.compareTo(n.targetVersion)<=0){return r}else{n.logParseEvent(e,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.propertyValueNotSupported(i,this.name,l.toString(),n.targetVersion.toString()));return this.defaultValue}}}}n.logParseEvent(e,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.invalidPropertyValue(i,this.name));return this.defaultValue};t.prototype.toJSON=function(e,t,n,i){if(n!==undefined){var r=false;for(var o=0,a=this.values;o<a.length;o++){var s=a[o];if(s.value===n){var l=s.targetVersion?s.targetVersion:this.targetVersion;if(l.compareTo(i.targetVersion)<=0){r=true;break}else{i.logEvent(e,T.ValidationPhase.ToJSON,T.ValidationEvent.InvalidPropertyValue,V.Strings.errors.invalidPropertyValue(n,this.name))}}}if(r){i.serializeEnum(this.enumType,t,this.name,n,this.defaultValue)}}};Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:false,configurable:true});return t}(L);n.EnumProperty=W;var J=function(e){E(t,e);function t(t,n,i,r,o){if(r===void 0){r=false}var a=e.call(this,t,n,o,function(e){return a.nullable?undefined:new a.objectType})||this;a.targetVersion=t;a.name=n;a.objectType=i;a.nullable=r;return a}t.prototype.parse=function(e,t,n){var i=t[this.name];if(i===undefined){return this.onGetInitialValue?this.onGetInitialValue(e):this.defaultValue}var r=new this.objectType;r.parse(i,n);return r};t.prototype.toJSON=function(e,t,n,i){var r=undefined;if(n!==undefined&&!n.hasAllDefaultValues()){r=n.toJSON(i)}if(typeof r==="object"&&Object.keys(r).length===0){r=undefined}i.serializeValue(t,this.name,r,this.defaultValue,true)};return t}(L);n.SerializableObjectProperty=J;var q=function(e){E(t,e);function t(t,n,i,r){var o=e.call(this,t,n,undefined,function(e){return[]})||this;o.targetVersion=t;o.name=n;o.objectType=i;o.onItemAdded=r;return o}t.prototype.parse=function(e,t,n){var i=[];var r=t[this.name];if(Array.isArray(r)){for(var o=0,a=r;o<a.length;o++){var s=a[o];var l=new this.objectType;l.parse(s,n);i.push(l);if(this.onItemAdded){this.onItemAdded(e,l)}}}return i.length>0?i:this.onGetInitialValue?this.onGetInitialValue(e):undefined};t.prototype.toJSON=function(e,t,n,i){i.serializeArray(t,this.name,n)};return t}(L);n.SerializableObjectCollectionProperty=q;var U=function(e){E(t,e);function t(t,n,i,r,o,a){var s=e.call(this,t,n,o,a)||this;s.targetVersion=t;s.name=n;s.onParse=i;s.onToJSON=r;s.defaultValue=o;s.onGetInitialValue=a;if(!s.onParse){throw new Error("CustomPropertyDefinition instances must have an onParse handler.")}if(!s.onToJSON){throw new Error("CustomPropertyDefinition instances must have an onToJSON handler.")}return s}t.prototype.parse=function(e,t,n){return this.onParse(e,this,t,n)};t.prototype.toJSON=function(e,t,n,i){this.onToJSON(e,this,t,n,i)};return t}(L);n.CustomProperty=U;var G=function(){function e(){this._properties=[]}e.prototype.indexOf=function(e){for(var t=0;t<this._properties.length;t++){if(this._properties[t]===e){return t}}return-1};e.prototype.add=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}for(var n=0;n<e.length;n++){if(this.indexOf(e[n])===-1){this._properties.push(e[n])}}};e.prototype.remove=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}for(var n=0,i=e;n<i.length;n++){var r=i[n];while(true){var o=this.indexOf(r);if(o>=0){this._properties.splice(o,1)}else{break}}}};e.prototype.getItemAt=function(e){return this._properties[e]};e.prototype.getCount=function(){return this._properties.length};return e}();n.SerializableObjectSchema=G;function K(e){return function(t,n){var i=Object.getOwnPropertyDescriptor(t,n)||{};if(!i.get&&!i.set){i.get=function(){return this.getValue(e)};i.set=function(t){this.setValue(e,t)};Object.defineProperty(t,n,i)}}}n.property=K;var X=function(){function e(){this._propertyBag={};this._rawProperties={};this.maxVersion=e.defaultMaxVersion;var t=this.getSchema();for(var n=0;n<t.getCount();n++){var i=t.getItemAt(n);if(i.onGetInitialValue){this.setValue(i,i.onGetInitialValue(this))}}}e.prototype.getDefaultSerializationContext=function(){return new R};e.prototype.populateSchema=function(t){var n=this.constructor;var i=[];for(var r in n){try{var o=n[r];if(o instanceof L){i.push(o)}}catch(e){}}if(i.length>0){var a=i.sort(function(e,t){if(e.sequentialNumber>t.sequentialNumber){return 1}else if(e.sequentialNumber<t.sequentialNumber){return-1}return 0});t.add.apply(t,a)}if(e.onRegisterCustomProperties){e.onRegisterCustomProperties(this,t)}};e.prototype.getValue=function(e){return this._propertyBag.hasOwnProperty(e.getInternalName())?this._propertyBag[e.getInternalName()]:e.defaultValue};e.prototype.setValue=function(e,t){if(t===undefined||t===null){delete this._propertyBag[e.getInternalName()]}else{this._propertyBag[e.getInternalName()]=t}};e.prototype.internalParse=function(e,t){this._propertyBag={};this._rawProperties=x.GlobalSettings.enableFullJsonRoundTrip?e?e:{}:{};if(e){var n=this.getSchema();for(var i=0;i<n.getCount();i++){var r=n.getItemAt(i);if(r.isSerializationEnabled){var o=r.onGetInitialValue?r.onGetInitialValue(this):undefined;if(e.hasOwnProperty(r.name)){if(r.targetVersion.compareTo(t.targetVersion)<=0){o=r.parse(this,e,t)}else{t.logParseEvent(this,T.ValidationEvent.UnsupportedProperty,V.Strings.errors.propertyNotSupported(r.name,r.targetVersion.toString(),t.targetVersion.toString()))}}this.setValue(r,o)}}}else{this.resetDefaultValues()}};e.prototype.internalToJSON=function(e,t){var n=this.getSchema();var i=[];for(var r=0;r<n.getCount();r++){var o=n.getItemAt(r);if(o.isSerializationEnabled&&o.targetVersion.compareTo(t.targetVersion)<=0&&i.indexOf(o.name)===-1){o.toJSON(this,e,this.getValue(o),t);i.push(o.name)}}};e.prototype.shouldSerialize=function(e){return true};e.prototype.parse=function(e,t){this.internalParse(e,t?t:new R)};e.prototype.toJSON=function(e){var t;if(e&&e instanceof z){t=e}else{t=this.getDefaultSerializationContext();t.toJSONOriginalParam=e}if(this.shouldSerialize(t)){var n=void 0;if(x.GlobalSettings.enableFullJsonRoundTrip&&this._rawProperties&&typeof this._rawProperties==="object"){n=this._rawProperties}else{n={}}this.internalToJSON(n,t);return n}else{return undefined}};e.prototype.hasDefaultValue=function(e){return this.getValue(e)===e.defaultValue};e.prototype.hasAllDefaultValues=function(){var e=this.getSchema();for(var t=0;t<e.getCount();t++){var n=e.getItemAt(t);if(!this.hasDefaultValue(n)){return false}}return true};e.prototype.resetDefaultValues=function(){var e=this.getSchema();for(var t=0;t<e.getCount();t++){var n=e.getItemAt(t);this.setValue(n,n.defaultValue)}};e.prototype.setCustomProperty=function(e,t){var n=typeof t==="string"&&!t||t===undefined||t===null;if(n){delete this._rawProperties[e]}else{this._rawProperties[e]=t}};e.prototype.getCustomProperty=function(e){return this._rawProperties[e]};e.prototype.getSchema=function(){var t=e._schemaCache[this.getSchemaKey()];if(!t){t=new G;this.populateSchema(t);e._schemaCache[this.getSchemaKey()]=t}return t};e.defaultMaxVersion=k.v1_3;e._schemaCache={};return e}();n.SerializableObject=X;var Y={};Object.defineProperty(Y,"__esModule",{value:true});Y.CardObjectRegistry=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var $=n;var Z=function(){function e(){this._items={}}e.prototype.findByName=function(e){return this._items.hasOwnProperty(e)?this._items[e]:undefined};e.prototype.clear=function(){this._items={}};e.prototype.register=function(e,t,n){if(n===void 0){n=$.Versions.v1_0}var i=this.findByName(e);if(i!==undefined){i.objectType=t}else{i={typeName:e,objectType:t,schemaVersion:n}}this._items[e]=i};e.prototype.unregister=function(e){delete this._items[e]};e.prototype.createInstance=function(e,t){var n=this.findByName(e);return n&&n.schemaVersion.compareTo(t)<=0?new n.objectType:undefined};e.prototype.getItemCount=function(){return Object.keys(this._items).length};e.prototype.getItemAt=function(e){var t=this;return Object.keys(this._items).map(function(e){return t._items[e]})[e]};return e}();Y.CardObjectRegistry=Z;var Q={};var ee={};var te=e&&e.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(ee,"__esModule",{value:true});ee.HostCapabilities=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var ne=n;var ie=function(e){te(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._capabilities={};return t}t.prototype.getSchemaKey=function(){return"HostCapabilities"};t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);if(t){for(var i in t){var r=t[i];if(typeof r==="string"){if(r=="*"){this.addCapability(i,"*")}else{var o=ne.Version.parse(r,n);if(o&&o.isValid){this.addCapability(i,o)}}}}}};t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);for(var i in this._capabilities){t[i]=this._capabilities[i]}};t.prototype.addCapability=function(e,t){this._capabilities[e]=t};t.prototype.removeCapability=function(e){delete this._capabilities[e]};t.prototype.clear=function(){this._capabilities={}};t.prototype.hasCapability=function(e,t){if(this._capabilities.hasOwnProperty(e)){if(t=="*"||this._capabilities[e]=="*"){return true}return t.compareTo(this._capabilities[e])<=0}return false};t.prototype.areAllMet=function(e){for(var t in this._capabilities){if(!e.hasCapability(t,this._capabilities[t])){return false}}return true};return t}(ne.SerializableObject);ee.HostCapabilities=ie;var re=e&&e.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();var oe=e&&e.__decorate||function(e,t,n,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)if(a=e[s])o=(r<3?a(o):r>3?a(t,n,o):a(t,n))||o;return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(Q,"__esModule",{value:true});Q.CardObject=Q.ValidationResults=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var ae=r;var se=A;var le=i;var ue=ee;var pe=n;var ce=function(){function e(){this.allIds={};this.validationEvents=[]}e.prototype.addFailure=function(e,t,n){this.validationEvents.push({phase:ae.ValidationPhase.Validation,source:e,event:t,message:n})};return e}();Q.ValidationResults=ce;var de=function(e){re(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._shouldFallback=false;return t}t.prototype.getSchemaKey=function(){return this.getJsonTypeName()};Object.defineProperty(t.prototype,"requires",{get:function(){return this.getValue(t.requiresProperty)},enumerable:false,configurable:true});t.prototype.contains=function(e){if(this._renderedElement){return this._renderedElement.contains(e)}return false};t.prototype.preProcessPropertyValue=function(e,t){var n=t===undefined?this.getValue(e):t;if(le.GlobalSettings.allowPreProcessingPropertyValues){var i=this;while(i&&!i.onPreProcessPropertyValue){i=i.parent}if(i&&i.onPreProcessPropertyValue){return i.onPreProcessPropertyValue(this,e,n)}}return n};t.prototype.setParent=function(e){this._parent=e};t.prototype.setShouldFallback=function(e){this._shouldFallback=e};t.prototype.shouldFallback=function(){return this._shouldFallback||!this.requires.areAllMet(this.hostConfig.hostCapabilities)};t.prototype.getRootObject=function(){var e=this;while(e.parent){e=e.parent}return e};t.prototype.internalValidateProperties=function(e){if(this.id){if(e.allIds.hasOwnProperty(this.id)){if(e.allIds[this.id]==1){e.addFailure(this,ae.ValidationEvent.DuplicateId,se.Strings.errors.duplicateId(this.id))}e.allIds[this.id]+=1}else{e.allIds[this.id]=1}}};t.prototype.validateProperties=function(){var e=new ce;this.internalValidateProperties(e);return e};t.prototype.findDOMNodeOwner=function(e){return this.contains(e)?this:undefined};Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"renderedElement",{get:function(){return this._renderedElement},enumerable:false,configurable:true});t.typeNameProperty=new pe.StringProperty(pe.Versions.v1_0,"type",undefined,undefined,undefined,function(e){return e.getJsonTypeName()});t.idProperty=new pe.StringProperty(pe.Versions.v1_0,"id");t.requiresProperty=new pe.SerializableObjectProperty(pe.Versions.v1_2,"requires",ue.HostCapabilities,false,new ue.HostCapabilities);oe([pe.property(t.idProperty)],t.prototype,"id",void 0);oe([pe.property(t.requiresProperty)],t.prototype,"requires",null);return t}(pe.SerializableObject);Q.CardObject=de;var fe={};var he={};var ye=e&&e.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(he,"__esModule",{value:true});he.defaultHostConfig=he.HostConfig=he.FontTypeSet=he.FontTypeDefinition=he.ContainerStyleSet=he.ContainerStyleDefinition=he.ColorSetDefinition=he.ActionsConfig=he.ShowCardActionConfig=he.FactSetConfig=he.FactTitleDefinition=he.FactTextDefinition=he.InputConfig=he.InputLabelConfig=he.RequiredInputLabelTextDefinition=he.BaseTextDefinition=he.MediaConfig=he.ImageSetConfig=he.AdaptiveCardConfig=he.TextColorDefinition=he.ColorDefinition=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var ge=r;var me=o;var ve=i;var be=ee;function Ce(e,t,n){if(typeof t==="string"){var i=me.parseEnum(e,t,n);return i!==undefined?i:n}else if(typeof t==="number"){return t}else{return n}}var Se=function(){function e(e,t){this.default="#000000";this.subtle="#666666";if(e){this.default=e}if(t){this.subtle=t}}e.prototype.parse=function(e){if(e){this.default=e["default"]||this.default;this.subtle=e["subtle"]||this.subtle}};return e}();he.ColorDefinition=Se;var Pe=function(e){ye(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.highlightColors=new Se("#22000000","#11000000");return t}t.prototype.parse=function(t){e.prototype.parse.call(this,t);if(t){this.highlightColors.parse(t["highlightColors"])}};return t}(Se);he.TextColorDefinition=Pe;var _e=function(){function e(e){this.allowCustomStyle=false;if(e){this.allowCustomStyle=e["allowCustomStyle"]||this.allowCustomStyle}}return e}();he.AdaptiveCardConfig=_e;var Ae=function(){function e(e){this.imageSize=ge.Size.Medium;this.maxImageHeight=100;if(e){this.imageSize=e["imageSize"]!=null?e["imageSize"]:this.imageSize;this.maxImageHeight=me.parseNumber(e["maxImageHeight"],100)}}e.prototype.toJSON=function(){return{imageSize:ge.Size[this.imageSize],maxImageHeight:this.maxImageHeight}};return e}();he.ImageSetConfig=Ae;var we=function(){function e(e){this.allowInlinePlayback=true;if(e){this.defaultPoster=e["defaultPoster"];this.allowInlinePlayback=e["allowInlinePlayback"]||this.allowInlinePlayback}}e.prototype.toJSON=function(){return{defaultPoster:this.defaultPoster,allowInlinePlayback:this.allowInlinePlayback}};return e}();he.MediaConfig=we;var Ee=function(){function e(e){this.size=ge.TextSize.Default;this.color=ge.TextColor.Default;this.isSubtle=false;this.weight=ge.TextWeight.Default;if(e){this.size=Ce(ge.TextSize,e["size"],this.size);this.color=Ce(ge.TextColor,e["color"],this.color);this.isSubtle=e["isSubtle"]||this.isSubtle;this.weight=Ce(ge.TextWeight,e["weight"],this.getDefaultWeight())}}e.prototype.getDefaultWeight=function(){return ge.TextWeight.Default};e.prototype.toJSON=function(){return{size:ge.TextSize[this.size],color:ge.TextColor[this.color],isSubtle:this.isSubtle,weight:ge.TextWeight[this.weight]}};return e}();he.BaseTextDefinition=Ee;var xe=function(e){ye(t,e);function t(t){var n=e.call(this,t)||this;n.suffix=" *";n.suffixColor=ge.TextColor.Attention;if(t){n.suffix=t["suffix"]||n.suffix;n.suffixColor=Ce(ge.TextColor,t["suffixColor"],n.suffixColor)}return n}t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);t["suffix"]=this.suffix;t["suffixColor"]=ge.TextColor[this.suffixColor];return t};return t}(Ee);he.RequiredInputLabelTextDefinition=xe;var Ie=function(){function e(e){this.inputSpacing=ge.Spacing.Small;this.requiredInputs=new xe;this.optionalInputs=new Ee;if(e){this.inputSpacing=Ce(ge.Spacing,e["inputSpacing"],this.inputSpacing);this.requiredInputs=new xe(e["requiredInputs"]);this.optionalInputs=new Ee(e["optionalInputs"])}}return e}();he.InputLabelConfig=Ie;var Te=function(){function e(e){this.label=new Ie;this.errorMessage=new Ee({color:ge.TextColor.Attention});if(e){this.label=new Ie(e["label"]);this.errorMessage=new Ee(e["errorMessage"])}}return e}();he.InputConfig=Te;var Ve=function(e){ye(t,e);function t(t){var n=e.call(this,t)||this;n.wrap=true;if(t){n.wrap=t["wrap"]!=null?t["wrap"]:n.wrap}return n}t.prototype.toJSON=function(){var t=e.prototype.toJSON.call(this);t["wrap"]=this.wrap;return t};return t}(Ee);he.FactTextDefinition=Ve;var Oe=function(e){ye(t,e);function t(t){var n=e.call(this,t)||this;n.maxWidth=150;n.weight=ge.TextWeight.Bolder;if(t){n.maxWidth=t["maxWidth"]!=null?t["maxWidth"]:n.maxWidth;n.weight=Ce(ge.TextWeight,t["weight"],ge.TextWeight.Bolder)}return n}t.prototype.getDefaultWeight=function(){return ge.TextWeight.Bolder};return t}(Ve);he.FactTitleDefinition=Oe;var ke=function(){function e(e){this.title=new Oe;this.value=new Ve;this.spacing=10;if(e){this.title=new Oe(e["title"]);this.value=new Ve(e["value"]);this.spacing=e.spacing&&e.spacing!=null?e.spacing&&e.spacing:this.spacing}}return e}();he.FactSetConfig=ke;var Ne=function(){function e(e){this.actionMode=ge.ShowCardActionMode.Inline;this.inlineTopMargin=16;this.style=ge.ContainerStyle.Emphasis;if(e){this.actionMode=Ce(ge.ShowCardActionMode,e["actionMode"],ge.ShowCardActionMode.Inline);this.inlineTopMargin=e["inlineTopMargin"]!=null?e["inlineTopMargin"]:this.inlineTopMargin;this.style=e["style"]&&typeof e["style"]==="string"?e["style"]:ge.ContainerStyle.Emphasis}}e.prototype.toJSON=function(){return{actionMode:ge.ShowCardActionMode[this.actionMode],inlineTopMargin:this.inlineTopMargin,style:this.style}};return e}();he.ShowCardActionConfig=Ne;var ze=function(){function e(e){this.maxActions=5;this.spacing=ge.Spacing.Default;this.buttonSpacing=20;this.showCard=new Ne;this.preExpandSingleShowCardAction=false;this.actionsOrientation=ge.Orientation.Horizontal;this.actionAlignment=ge.ActionAlignment.Left;this.iconPlacement=ge.ActionIconPlacement.LeftOfTitle;this.allowTitleToWrap=false;this.iconSize=16;if(e){this.maxActions=e["maxActions"]!=null?e["maxActions"]:this.maxActions;this.spacing=Ce(ge.Spacing,e.spacing&&e.spacing,ge.Spacing.Default);this.buttonSpacing=e["buttonSpacing"]!=null?e["buttonSpacing"]:this.buttonSpacing;this.showCard=new Ne(e["showCard"]);this.preExpandSingleShowCardAction=me.parseBool(e["preExpandSingleShowCardAction"],false);this.actionsOrientation=Ce(ge.Orientation,e["actionsOrientation"],ge.Orientation.Horizontal);this.actionAlignment=Ce(ge.ActionAlignment,e["actionAlignment"],ge.ActionAlignment.Left);this.iconPlacement=Ce(ge.ActionIconPlacement,e["iconPlacement"],ge.ActionIconPlacement.LeftOfTitle);this.allowTitleToWrap=e["allowTitleToWrap"]!=null?e["allowTitleToWrap"]:this.allowTitleToWrap;try{var t=ve.SizeAndUnit.parse(e["iconSize"]);if(t.unit==ge.SizeUnit.Pixel){this.iconSize=t.physicalSize}}catch(e){}}}e.prototype.toJSON=function(){return{maxActions:this.maxActions,spacing:ge.Spacing[this.spacing],buttonSpacing:this.buttonSpacing,showCard:this.showCard,preExpandSingleShowCardAction:this.preExpandSingleShowCardAction,actionsOrientation:ge.Orientation[this.actionsOrientation],actionAlignment:ge.ActionAlignment[this.actionAlignment]}};return e}();he.ActionsConfig=ze;var Re=function(){function e(e){this.default=new Pe;this.dark=new Pe;this.light=new Pe;this.accent=new Pe;this.good=new Pe;this.warning=new Pe;this.attention=new Pe;this.parse(e)}e.prototype.parseSingleColor=function(e,t){if(e){this[t].parse(e[t])}};e.prototype.parse=function(e){if(e){this.parseSingleColor(e,"default");this.parseSingleColor(e,"dark");this.parseSingleColor(e,"light");this.parseSingleColor(e,"accent");this.parseSingleColor(e,"good");this.parseSingleColor(e,"warning");this.parseSingleColor(e,"attention")}};return e}();he.ColorSetDefinition=Re;var Le=function(){function e(e){this.foregroundColors=new Re({default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#E69500",subtle:"#DDE69500"},attention:{default:"#CC3300",subtle:"#DDCC3300"}});this.parse(e)}e.prototype.parse=function(e){if(e){this.backgroundColor=e["backgroundColor"];this.foregroundColors.parse(e["foregroundColors"]);this.highlightBackgroundColor=e["highlightBackgroundColor"];this.highlightForegroundColor=e["highlightForegroundColor"]}};Object.defineProperty(e.prototype,"isBuiltIn",{get:function(){return false},enumerable:false,configurable:true});return e}();he.ContainerStyleDefinition=Le;var Be=function(e){ye(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"isBuiltIn",{get:function(){return true},enumerable:false,configurable:true});return t}(Le);var De=function(){function e(e){this._allStyles={};this._allStyles[ge.ContainerStyle.Default]=new Be;this._allStyles[ge.ContainerStyle.Emphasis]=new Be;this._allStyles[ge.ContainerStyle.Accent]=new Be;this._allStyles[ge.ContainerStyle.Good]=new Be;this._allStyles[ge.ContainerStyle.Attention]=new Be;this._allStyles[ge.ContainerStyle.Warning]=new Be;if(e){this._allStyles[ge.ContainerStyle.Default].parse(e[ge.ContainerStyle.Default]);this._allStyles[ge.ContainerStyle.Emphasis].parse(e[ge.ContainerStyle.Emphasis]);this._allStyles[ge.ContainerStyle.Accent].parse(e[ge.ContainerStyle.Accent]);this._allStyles[ge.ContainerStyle.Good].parse(e[ge.ContainerStyle.Good]);this._allStyles[ge.ContainerStyle.Attention].parse(e[ge.ContainerStyle.Attention]);this._allStyles[ge.ContainerStyle.Warning].parse(e[ge.ContainerStyle.Warning]);var t=e["customStyles"];if(t&&Array.isArray(t)){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(r){var o=r["name"];if(o&&typeof o==="string"){if(this._allStyles.hasOwnProperty(o)){this._allStyles[o].parse(r["style"])}else{this._allStyles[o]=new Le(r["style"])}}}}}}}e.prototype.toJSON=function(){var e=this;var t=[];Object.keys(this._allStyles).forEach(function(n){if(!e._allStyles[n].isBuiltIn){t.push({name:n,style:e._allStyles[n]})}});var n={default:this.default,emphasis:this.emphasis};if(t.length>0){n.customStyles=t}return n};e.prototype.getStyleByName=function(e,t){if(e&&this._allStyles.hasOwnProperty(e)){return this._allStyles[e]}else{return t?t:this._allStyles[ge.ContainerStyle.Default]}};Object.defineProperty(e.prototype,"default",{get:function(){return this._allStyles[ge.ContainerStyle.Default]},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"emphasis",{get:function(){return this._allStyles[ge.ContainerStyle.Emphasis]},enumerable:false,configurable:true});return e}();he.ContainerStyleSet=De;var Me=function(){function e(e){this.fontFamily="Segoe UI,Segoe,Segoe WP,Helvetica Neue,Helvetica,sans-serif";this.fontSizes={small:12,default:14,medium:17,large:21,extraLarge:26};this.fontWeights={lighter:200,default:400,bolder:600};if(e){this.fontFamily=e}}e.prototype.parse=function(e){this.fontFamily=e["fontFamily"]||this.fontFamily;this.fontSizes={small:e.fontSizes&&e.fontSizes["small"]||this.fontSizes.small,default:e.fontSizes&&e.fontSizes["default"]||this.fontSizes.default,medium:e.fontSizes&&e.fontSizes["medium"]||this.fontSizes.medium,large:e.fontSizes&&e.fontSizes["large"]||this.fontSizes.large,extraLarge:e.fontSizes&&e.fontSizes["extraLarge"]||this.fontSizes.extraLarge};this.fontWeights={lighter:e.fontWeights&&e.fontWeights["lighter"]||this.fontWeights.lighter,default:e.fontWeights&&e.fontWeights["default"]||this.fontWeights.default,bolder:e.fontWeights&&e.fontWeights["bolder"]||this.fontWeights.bolder}};e.monospace=new e("'Courier New', Courier, monospace");return e}();he.FontTypeDefinition=Me;var je=function(){function e(e){this.default=new Me;this.monospace=new Me("'Courier New', Courier, monospace");if(e){this.default.parse(e["default"]);this.monospace.parse(e["monospace"])}}e.prototype.getStyleDefinition=function(e){switch(e){case ge.FontType.Monospace:return this.monospace;case ge.FontType.Default:default:return this.default}};return e}();he.FontTypeSet=je;var Fe=function(){function e(e){this.hostCapabilities=new be.HostCapabilities;this.choiceSetInputValueSeparator=",";this.supportsInteractivity=true;this.spacing={small:3,default:8,medium:20,large:30,extraLarge:40,padding:15};this.separator={lineThickness:1,lineColor:"#EEEEEE"};this.imageSizes={small:40,medium:80,large:160};this.containerStyles=new De;this.inputs=new Te;this.actions=new ze;this.adaptiveCard=new _e;this.imageSet=new Ae;this.media=new we;this.factSet=new ke;this.alwaysAllowBleed=false;if(e){if(typeof e==="string"||e instanceof String){e=JSON.parse(e)}this.choiceSetInputValueSeparator=e&&typeof e["choiceSetInputValueSeparator"]==="string"?e["choiceSetInputValueSeparator"]:this.choiceSetInputValueSeparator;this.supportsInteractivity=e&&typeof e["supportsInteractivity"]==="boolean"?e["supportsInteractivity"]:this.supportsInteractivity;this._legacyFontType=new Me;this._legacyFontType.parse(e);if(e.fontTypes){this.fontTypes=new je(e.fontTypes)}if(e.lineHeights){this.lineHeights={small:e.lineHeights["small"],default:e.lineHeights["default"],medium:e.lineHeights["medium"],large:e.lineHeights["large"],extraLarge:e.lineHeights["extraLarge"]}}this.imageSizes={small:e.imageSizes&&e.imageSizes["small"]||this.imageSizes.small,medium:e.imageSizes&&e.imageSizes["medium"]||this.imageSizes.medium,large:e.imageSizes&&e.imageSizes["large"]||this.imageSizes.large};this.containerStyles=new De(e["containerStyles"]);this.spacing={small:e.spacing&&e.spacing["small"]||this.spacing.small,default:e.spacing&&e.spacing["default"]||this.spacing.default,medium:e.spacing&&e.spacing["medium"]||this.spacing.medium,large:e.spacing&&e.spacing["large"]||this.spacing.large,extraLarge:e.spacing&&e.spacing["extraLarge"]||this.spacing.extraLarge,padding:e.spacing&&e.spacing["padding"]||this.spacing.padding};this.separator={lineThickness:e.separator&&e.separator["lineThickness"]||this.separator.lineThickness,lineColor:e.separator&&e.separator["lineColor"]||this.separator.lineColor};this.inputs=new Te(e.inputs||this.inputs);this.actions=new ze(e.actions||this.actions);this.adaptiveCard=new _e(e.adaptiveCard||this.adaptiveCard);this.imageSet=new Ae(e["imageSet"]);this.factSet=new ke(e["factSet"])}}e.prototype.getFontTypeDefinition=function(e){if(this.fontTypes){return this.fontTypes.getStyleDefinition(e)}else{return e==ge.FontType.Monospace?Me.monospace:this._legacyFontType}};e.prototype.getEffectiveSpacing=function(e){switch(e){case ge.Spacing.Small:return this.spacing.small;case ge.Spacing.Default:return this.spacing.default;case ge.Spacing.Medium:return this.spacing.medium;case ge.Spacing.Large:return this.spacing.large;case ge.Spacing.ExtraLarge:return this.spacing.extraLarge;case ge.Spacing.Padding:return this.spacing.padding;default:return 0}};e.prototype.paddingDefinitionToSpacingDefinition=function(e){return new ve.SpacingDefinition(this.getEffectiveSpacing(e.top),this.getEffectiveSpacing(e.right),this.getEffectiveSpacing(e.bottom),this.getEffectiveSpacing(e.left))};e.prototype.makeCssClassNames=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var n=[];for(var i=0,r=e;i<r.length;i++){var o=r[i];n.push((this.cssClassNamePrefix?this.cssClassNamePrefix+"-":"")+o)}return n};e.prototype.makeCssClassName=function(){var e=[];for(var t=0;t<arguments.length;t++){e[t]=arguments[t]}var n=this.makeCssClassNames.apply(this,e).join(" ");return n?n:""};Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._legacyFontType.fontFamily},set:function(e){this._legacyFontType.fontFamily=e},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"fontSizes",{get:function(){return this._legacyFontType.fontSizes},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"fontWeights",{get:function(){return this._legacyFontType.fontWeights},enumerable:false,configurable:true});return e}();he.HostConfig=Fe;he.defaultHostConfig=new Fe({supportsInteractivity:true,spacing:{small:10,default:20,medium:30,large:40,extraLarge:50,padding:20},separator:{lineThickness:1,lineColor:"#EEEEEE"},fontTypes:{default:{fontFamily:"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}},monospace:{fontFamily:"'Courier New', Courier, monospace",fontSizes:{small:12,default:14,medium:17,large:21,extraLarge:26},fontWeights:{lighter:200,default:400,bolder:600}}},imageSizes:{small:40,medium:80,large:160},containerStyles:{default:{backgroundColor:"#FFFFFF",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},emphasis:{backgroundColor:"#08000000",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},accent:{backgroundColor:"#C7DEF9",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},good:{backgroundColor:"#CCFFCC",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},attention:{backgroundColor:"#FFC5B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}},warning:{backgroundColor:"#FFE2B2",foregroundColors:{default:{default:"#333333",subtle:"#EE333333"},dark:{default:"#000000",subtle:"#66000000"},light:{default:"#FFFFFF",subtle:"#33000000"},accent:{default:"#2E89FC",subtle:"#882E89FC"},attention:{default:"#cc3300",subtle:"#DDcc3300"},good:{default:"#028A02",subtle:"#DD027502"},warning:{default:"#e69500",subtle:"#DDe69500"}}}},inputs:{label:{requiredInputs:{color:ge.TextColor.Accent,size:ge.TextSize.ExtraLarge,weight:ge.TextWeight.Bolder,isSubtle:true,suffix:" (required)",suffixColor:ge.TextColor.Good},optionalInputs:{color:ge.TextColor.Warning,size:ge.TextSize.Medium,weight:ge.TextWeight.Lighter,isSubtle:false}},errorMessage:{color:ge.TextColor.Accent,size:ge.TextSize.Small,weight:ge.TextWeight.Bolder}},actions:{maxActions:5,spacing:ge.Spacing.Default,buttonSpacing:10,showCard:{actionMode:ge.ShowCardActionMode.Inline,inlineTopMargin:16},actionsOrientation:ge.Orientation.Horizontal,actionAlignment:ge.ActionAlignment.Left},adaptiveCard:{allowCustomStyle:false},imageSet:{imageSize:ge.Size.Medium,maxImageHeight:100},factSet:{title:{color:ge.TextColor.Default,size:ge.TextSize.Default,isSubtle:false,weight:ge.TextWeight.Bolder,wrap:true,maxWidth:150},value:{color:ge.TextColor.Default,size:ge.TextSize.Default,isSubtle:false,weight:ge.TextWeight.Default,wrap:true},spacing:10}});var He={};var We=e&&e.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(He,"__esModule",{value:true});He.formatText=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var Je=function(){function e(e){this._regularExpression=e}e.prototype.format=function(e,t){var n;if(t){var i=t;while((n=this._regularExpression.exec(t))!=null){i=i.replace(n[0],this.internalFormat(e,n))}return i}else{return t}};return e}();var qe=function(e){We(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1]));var i=t[2]!=undefined?t[2].toLowerCase():"compact";if(i!="compact"){return n.toLocaleDateString(e,{day:"numeric",weekday:i,month:i,year:"numeric"})}else{return n.toLocaleDateString()}};return t}(Je);var Ue=function(e){We(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalFormat=function(e,t){var n=new Date(Date.parse(t[1]));return n.toLocaleTimeString(e,{hour:"numeric",minute:"2-digit"})};return t}(Je);function Ge(e,t){var n=[new qe(/\{{2}DATE\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))(?:, ?(COMPACT|LONG|SHORT))?\)\}{2}/g),new Ue(/\{{2}TIME\((\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(?:Z|(?:(?:-|\+)\d{2}:\d{2})))\)\}{2}/g)];var i=t;for(var r=0,o=n;r<o.length;r++){var a=o[r];i=a.format(e,i)}return i}He.formatText=Ge;var Ke=e&&e.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();var Xe=e&&e.__decorate||function(e,t,n,i){var r=arguments.length,o=r<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,a;if(typeof Reflect==="object"&&typeof Reflect.decorate==="function")o=Reflect.decorate(e,t,n,i);else for(var s=e.length-1;s>=0;s--)if(a=e[s])o=(r<3?a(o):r>3?a(t,n,o):a(t,n))||o;return r>3&&o&&Object.defineProperty(t,n,o),o};Object.defineProperty(fe,"__esModule",{value:true});fe.SerializationContext=fe.GlobalRegistry=fe.AdaptiveCard=fe.Authentication=fe.TokenExchangeResource=fe.AuthCardButton=fe.RefreshDefinition=fe.RefreshActionProperty=fe.ContainerWithActions=fe.ColumnSet=fe.Column=fe.Container=fe.BackgroundImage=fe.StylableCardElementContainer=fe.ActionSet=fe.ShowCardAction=fe.HttpAction=fe.HttpHeader=fe.ToggleVisibilityAction=fe.OpenUrlAction=fe.ExecuteAction=fe.SubmitAction=fe.SubmitActionBase=fe.Action=fe.TimeInput=fe.TimeProperty=fe.DateInput=fe.NumberInput=fe.ChoiceSetInput=fe.Choice=fe.ToggleInput=fe.TextInput=fe.Input=fe.Media=fe.MediaSource=fe.ImageSet=fe.CardElementContainer=fe.Image=fe.FactSet=fe.Fact=fe.RichTextBlock=fe.TextRun=fe.TextBlock=fe.BaseTextBlock=fe.ActionProperty=fe.CardElement=void 0;
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
var Ye=r;var $e=i;var Ze=o;var Qe=he;var et=He;var tt=Q;var nt=n;var it=Y;var rt=A;var ot=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._truncatedDueToOverflow=false;return t}Object.defineProperty(t.prototype,"lang",{get:function(){var e=this.getValue(t.langProperty);if(e){return e}else{if(this.parent){return this.parent.lang}else{return undefined}}},set:function(e){this.setValue(t.langProperty,e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isVisible",{get:function(){return this.getValue(t.isVisibleProperty)},set:function(e){if($e.GlobalSettings.useAdvancedCardBottomTruncation&&!e){this.undoOverflowTruncation()}if(this.isVisible!==e){this.setValue(t.isVisibleProperty,e);this.updateRenderedElementVisibility();if(this._renderedElement){$t(this)}}if(this._renderedElement){this._renderedElement.setAttribute("aria-expanded",e.toString())}},enumerable:false,configurable:true});t.prototype.internalRenderSeparator=function(){var e=Ze.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.spacing),lineThickness:this.separator?this.hostConfig.separator.lineThickness:undefined,lineColor:this.separator?this.hostConfig.separator.lineColor:undefined},this.separatorOrientation);if($e.GlobalSettings.alwaysBleedSeparators&&e&&this.separatorOrientation==Ye.Orientation.Horizontal){var t=this.getParentContainer();if(t&&t.getEffectivePadding()){var n=this.hostConfig.paddingDefinitionToSpacingDefinition(t.getEffectivePadding());e.style.marginLeft="-"+n.left+"px";e.style.marginRight="-"+n.right+"px"}}return e};t.prototype.updateRenderedElementVisibility=function(){var e=this.isDesignMode()||this.isVisible?this._defaultRenderedElementDisplayMode:"none";if(this._renderedElement){if(e){this._renderedElement.style.display=e}else{this._renderedElement.style.removeProperty("display")}}if(this._separatorElement){if(this.parent&&this.parent.isFirstElement(this)){this._separatorElement.style.display="none"}else{if(e){this._separatorElement.style.display=e}else{this._separatorElement.style.removeProperty("display")}}}};t.prototype.hideElementDueToOverflow=function(){if(this._renderedElement&&this.isVisible){this._renderedElement.style.visibility="hidden";this.isVisible=false;$t(this,false)}};t.prototype.showElementHiddenDueToOverflow=function(){if(this._renderedElement&&!this.isVisible){this._renderedElement.style.removeProperty("visibility");this.isVisible=true;$t(this,false)}};t.prototype.handleOverflow=function(e){if(this.isVisible||this.isHiddenDueToOverflow()){var t=this.truncateOverflow(e);this._truncatedDueToOverflow=t||this._truncatedDueToOverflow;if(!t){this.hideElementDueToOverflow()}else if(t&&!this.isVisible){this.showElementHiddenDueToOverflow()}}};t.prototype.resetOverflow=function(){var e=false;if(this._truncatedDueToOverflow){this.undoOverflowTruncation();this._truncatedDueToOverflow=false;e=true}if(this.isHiddenDueToOverflow()){this.showElementHiddenDueToOverflow()}return e};t.prototype.getDefaultSerializationContext=function(){return new ln};t.prototype.createPlaceholderElement=function(){var e=this.getEffectiveStyleDefinition();var t=Ze.stringToCssColor(e.foregroundColors.default.subtle);var n=document.createElement("div");n.style.border="1px dashed "+t;n.style.padding="4px";n.style.minHeight="32px";n.style.fontSize="10px";n.style.color=t;n.innerText="Empty "+this.getJsonTypeName();return n};t.prototype.adjustRenderedElementSize=function(e){if(this.height==="auto"){e.style.flex="0 0 auto"}else{e.style.flex="1 1 auto"}};t.prototype.isDisplayed=function(){return this._renderedElement!==undefined&&this.isVisible&&this._renderedElement.offsetHeight>0};t.prototype.overrideInternalRender=function(){return this.internalRender()};t.prototype.applyPadding=function(){if(this.separatorElement&&this.separatorOrientation===Ye.Orientation.Horizontal){if($e.GlobalSettings.alwaysBleedSeparators&&!this.isBleeding()){var e=new $e.PaddingDefinition;this.getImmediateSurroundingPadding(e);var t=this.hostConfig.paddingDefinitionToSpacingDefinition(e);this.separatorElement.style.marginLeft="-"+t.left+"px";this.separatorElement.style.marginRight="-"+t.right+"px"}else{this.separatorElement.style.marginRight="0";this.separatorElement.style.marginLeft="0"}}};t.prototype.truncateOverflow=function(e){return false};t.prototype.undoOverflowTruncation=function(){};t.prototype.getDefaultPadding=function(){return new $e.PaddingDefinition};t.prototype.getHasBackground=function(){return false};t.prototype.getPadding=function(){return this._padding};t.prototype.setPadding=function(e){this._padding=e};t.prototype.shouldSerialize=function(e){return e.elementRegistry.findByName(this.getJsonTypeName())!==undefined};Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"allowCustomPadding",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return Ye.Orientation.Horizontal},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"defaultStyle",{get:function(){return Ye.ContainerStyle.Default},enumerable:false,configurable:true});t.prototype.parse=function(t,n){e.prototype.parse.call(this,t,n?n:new ln)};t.prototype.asString=function(){return""};t.prototype.isBleeding=function(){return false};t.prototype.getEffectiveStyle=function(){if(this.parent){return this.parent.getEffectiveStyle()}return this.defaultStyle};t.prototype.getEffectiveStyleDefinition=function(){return this.hostConfig.containerStyles.getStyleByName(this.getEffectiveStyle())};t.prototype.getForbiddenActionTypes=function(){return[]};t.prototype.getImmediateSurroundingPadding=function(e,t,n,i,r){if(t===void 0){t=true}if(n===void 0){n=true}if(i===void 0){i=true}if(r===void 0){r=true}if(this.parent){var o=t&&this.parent.isTopElement(this);var a=n&&this.parent.isRightMostElement(this);var s=i&&this.parent.isBottomElement(this);var l=r&&this.parent.isLeftMostElement(this);var u=this.parent.getEffectivePadding();if(u){if(o&&u.top!=Ye.Spacing.None){e.top=u.top;o=false}if(a&&u.right!=Ye.Spacing.None){e.right=u.right;a=false}if(s&&u.bottom!=Ye.Spacing.None){e.bottom=u.bottom;s=false}if(l&&u.left!=Ye.Spacing.None){e.left=u.left;l=false}}if(o||a||s||l){this.parent.getImmediateSurroundingPadding(e,o,a,s,l)}}};t.prototype.getActionCount=function(){return 0};t.prototype.getActionAt=function(e){throw new Error(rt.Strings.errors.indexOutOfRange(e))};t.prototype.remove=function(){if(this.parent&&this.parent instanceof yt){return this.parent.removeItem(this)}return false};t.prototype.render=function(){this._renderedElement=this.overrideInternalRender();this._separatorElement=this.internalRenderSeparator();if(this._renderedElement){if(this.id){this._renderedElement.id=this.id}if(this.customCssSelector){this._renderedElement.classList.add(this.customCssSelector)}this._renderedElement.style.boxSizing="border-box";this._defaultRenderedElementDisplayMode=this._renderedElement.style.display?this._renderedElement.style.display:undefined;this.adjustRenderedElementSize(this._renderedElement);this.updateLayout(false)}else if(this.isDesignMode()){this._renderedElement=this.createPlaceholderElement()}return this._renderedElement};t.prototype.updateLayout=function(e){this.updateRenderedElementVisibility();this.applyPadding()};t.prototype.indexOf=function(e){return-1};t.prototype.isDesignMode=function(){var e=this.getRootElement();return e instanceof on&&e.designMode};t.prototype.isFirstElement=function(e){return true};t.prototype.isLastElement=function(e){return true};t.prototype.isAtTheVeryLeft=function(){return this.parent?this.parent.isLeftMostElement(this)&&this.parent.isAtTheVeryLeft():true};t.prototype.isAtTheVeryRight=function(){return this.parent?this.parent.isRightMostElement(this)&&this.parent.isAtTheVeryRight():true};t.prototype.isAtTheVeryTop=function(){return this.parent?this.parent.isFirstElement(this)&&this.parent.isAtTheVeryTop():true};t.prototype.isAtTheVeryBottom=function(){return this.parent?this.parent.isLastElement(this)&&this.parent.isAtTheVeryBottom():true};t.prototype.isBleedingAtTop=function(){return false};t.prototype.isBleedingAtBottom=function(){return false};t.prototype.isLeftMostElement=function(e){return true};t.prototype.isRightMostElement=function(e){return true};t.prototype.isTopElement=function(e){return this.isFirstElement(e)};t.prototype.isBottomElement=function(e){return this.isLastElement(e)};t.prototype.isHiddenDueToOverflow=function(){return this._renderedElement!==undefined&&this._renderedElement.style.visibility=="hidden"};t.prototype.getRootElement=function(){return this.getRootObject()};t.prototype.getParentContainer=function(){var e=this.parent;while(e){if(e instanceof Wt){return e}e=e.parent}return undefined};t.prototype.getAllInputs=function(e){return[]};t.prototype.getResourceInformation=function(){return[]};t.prototype.getElementById=function(e){return this.id===e?this:undefined};t.prototype.getActionById=function(e){return undefined};t.prototype.getEffectivePadding=function(){var e=this.getPadding();return e&&this.allowCustomPadding?e:this.getDefaultPadding()};Object.defineProperty(t.prototype,"hostConfig",{get:function(){if(this._hostConfig){return this._hostConfig}else{if(this.parent){return this.parent.hostConfig}else{return Qe.defaultHostConfig}}},set:function(e){this._hostConfig=e},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"index",{get:function(){if(this.parent){return this.parent.indexOf(this)}else{return 0}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isInteractive",{get:function(){return false},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isStandalone",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isInline",{get:function(){return false},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){if(this.parent&&this.separatorElement){return!this.parent.isFirstElement(this)&&(this.isVisible||this.isDesignMode())}else{return false}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"separatorElement",{get:function(){return this._separatorElement},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:false,configurable:true});t.langProperty=new nt.StringProperty(nt.Versions.v1_1,"lang",true,/^[a-z]{2,3}$/gi);t.isVisibleProperty=new nt.BoolProperty(nt.Versions.v1_2,"isVisible",true);t.separatorProperty=new nt.BoolProperty(nt.Versions.v1_0,"separator",false);t.heightProperty=new nt.ValueSetProperty(nt.Versions.v1_1,"height",[{value:"auto"},{value:"stretch"}],"auto");t.horizontalAlignmentProperty=new nt.EnumProperty(nt.Versions.v1_0,"horizontalAlignment",Ye.HorizontalAlignment,Ye.HorizontalAlignment.Left);t.spacingProperty=new nt.EnumProperty(nt.Versions.v1_0,"spacing",Ye.Spacing,Ye.Spacing.Default);Xe([nt.property(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0);Xe([nt.property(t.spacingProperty)],t.prototype,"spacing",void 0);Xe([nt.property(t.separatorProperty)],t.prototype,"separator",void 0);Xe([nt.property(t.heightProperty)],t.prototype,"height",void 0);Xe([nt.property(t.langProperty)],t.prototype,"lang",null);Xe([nt.property(t.isVisibleProperty)],t.prototype,"isVisible",null);return t}(tt.CardObject);fe.CardElement=ot;var at=function(e){Ke(t,e);function t(t,n,i){if(i===void 0){i=[]}var r=e.call(this,t,n,undefined)||this;r.targetVersion=t;r.name=n;r.forbiddenActionTypes=i;return r}t.prototype.parse=function(e,t,n){var i=e;return n.parseAction(i,t[this.name],this.forbiddenActionTypes,i.isDesignMode())};t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n?n.toJSON(i):undefined,undefined,true)};return t}(nt.PropertyDefinition);fe.ActionProperty=at;var st=function(e){Ke(t,e);function t(t){var n=e.call(this)||this;n.size=Ye.TextSize.Default;n.weight=Ye.TextWeight.Default;n.color=Ye.TextColor.Default;n.isSubtle=false;n.ariaHidden=false;if(t){n.text=t}return n}t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n);n.remove(t.selectActionProperty)};Object.defineProperty(t.prototype,"text",{get:function(){return this.getValue(t.textProperty)},set:function(e){this.setText(e)},enumerable:false,configurable:true});t.prototype.getFontSize=function(e){switch(this.size){case Ye.TextSize.Small:return e.fontSizes.small;case Ye.TextSize.Medium:return e.fontSizes.medium;case Ye.TextSize.Large:return e.fontSizes.large;case Ye.TextSize.ExtraLarge:return e.fontSizes.extraLarge;default:return e.fontSizes.default}};t.prototype.getColorDefinition=function(e,t){switch(t){case Ye.TextColor.Accent:return e.accent;case Ye.TextColor.Dark:return e.dark;case Ye.TextColor.Light:return e.light;case Ye.TextColor.Good:return e.good;case Ye.TextColor.Warning:return e.warning;case Ye.TextColor.Attention:return e.attention;default:return e.default}};t.prototype.setText=function(e){this.setValue(t.textProperty,e)};t.prototype.init=function(e){this.size=e.size;this.weight=e.weight;this.color=e.color;this.isSubtle=e.isSubtle};t.prototype.asString=function(){return this.text};t.prototype.applyStylesTo=function(e){var t=this.hostConfig.getFontTypeDefinition(this.fontType);if(t.fontFamily){e.style.fontFamily=t.fontFamily}var n;switch(this.size){case Ye.TextSize.Small:n=t.fontSizes.small;break;case Ye.TextSize.Medium:n=t.fontSizes.medium;break;case Ye.TextSize.Large:n=t.fontSizes.large;break;case Ye.TextSize.ExtraLarge:n=t.fontSizes.extraLarge;break;default:n=t.fontSizes.default;break}e.style.fontSize=n+"px";var i=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);e.style.color=Ze.stringToCssColor(this.isSubtle?i.subtle:i.default);var r;switch(this.weight){case Ye.TextWeight.Lighter:r=t.fontWeights.lighter;break;case Ye.TextWeight.Bolder:r=t.fontWeights.bolder;break;default:r=t.fontWeights.default;break}e.style.fontWeight=r.toString();if(this.ariaHidden){e.setAttribute("aria-hidden","true")}};Object.defineProperty(t.prototype,"effectiveColor",{get:function(){return this.color?this.color:Ye.TextColor.Default},enumerable:false,configurable:true});t.textProperty=new nt.StringProperty(nt.Versions.v1_0,"text",true);t.sizeProperty=new nt.EnumProperty(nt.Versions.v1_0,"size",Ye.TextSize,Ye.TextSize.Default);t.weightProperty=new nt.EnumProperty(nt.Versions.v1_0,"weight",Ye.TextWeight,Ye.TextWeight.Default);t.colorProperty=new nt.EnumProperty(nt.Versions.v1_0,"color",Ye.TextColor,Ye.TextColor.Default);t.isSubtleProperty=new nt.BoolProperty(nt.Versions.v1_0,"isSubtle",false);t.fontTypeProperty=new nt.EnumProperty(nt.Versions.v1_2,"fontType",Ye.FontType);t.selectActionProperty=new at(nt.Versions.v1_1,"selectAction",["Action.ShowCard"]);Xe([nt.property(t.sizeProperty)],t.prototype,"size",void 0);Xe([nt.property(t.weightProperty)],t.prototype,"weight",void 0);Xe([nt.property(t.colorProperty)],t.prototype,"color",void 0);Xe([nt.property(t.fontTypeProperty)],t.prototype,"fontType",void 0);Xe([nt.property(t.isSubtleProperty)],t.prototype,"isSubtle",void 0);Xe([nt.property(t.textProperty)],t.prototype,"text",null);Xe([nt.property(t.selectActionProperty)],t.prototype,"selectAction",void 0);return t}(ot);fe.BaseTextBlock=st;var lt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.wrap=false;t._treatAsPlainText=true;t.useMarkdown=true;return t}t.prototype.restoreOriginalContent=function(){if(this.renderedElement!==undefined){if(this.maxLines&&this.maxLines>0){this.renderedElement.style.maxHeight=this._computedLineHeight*this.maxLines+"px"}this.renderedElement.innerHTML=this._originalInnerHtml}};t.prototype.truncateIfSupported=function(e){if(this.renderedElement!==undefined){var t=this.renderedElement.children;var n=!t.length;var i=n||t.length==1&&t[0].tagName.toLowerCase()=="p";if(i){var r=n?this.renderedElement:t[0];Ze.truncate(r,e,this._computedLineHeight);return true}}return false};t.prototype.setText=function(t){e.prototype.setText.call(this,t);this._processedText=undefined};t.prototype.internalRender=function(){var e=this;this._processedText=undefined;if(this.text){var t=this.preProcessPropertyValue(st.textProperty);var n=this.hostConfig;var i=void 0;if(this.forElementId){var r=document.createElement("label");r.htmlFor=this.forElementId;i=r}else{i=document.createElement("div")}i.classList.add(n.makeCssClassName("ac-textBlock"));i.style.overflow="hidden";this.applyStylesTo(i);if(this.selectAction){i.onclick=function(t){t.preventDefault();t.cancelBubble=true;if(e.selectAction){e.selectAction.execute()}};if(n.supportsInteractivity){i.tabIndex=0;i.setAttribute("role",this.selectAction.getAriaRole());if(this.selectAction.title){i.setAttribute("aria-label",this.selectAction.title);i.title=this.selectAction.title}i.classList.add(n.makeCssClassName("ac-selectable"))}}if(!this._processedText){this._treatAsPlainText=true;var o=et.formatText(this.lang,t);if(this.useMarkdown&&o){if($e.GlobalSettings.allowMarkForTextHighlighting){o=o.replace(/<mark>/g,"===").replace(/<\/mark>/g,"/==/")}var a=on.applyMarkdown(o);if(a.didProcess&&a.outputHtml){this._processedText=a.outputHtml;this._treatAsPlainText=false;if($e.GlobalSettings.allowMarkForTextHighlighting&&this._processedText){var s="";var l=this.getEffectiveStyleDefinition();if(l.highlightBackgroundColor){s+="background-color: "+l.highlightBackgroundColor+";"}if(l.highlightForegroundColor){s+="color: "+l.highlightForegroundColor+";"}if(s){s='style="'+s+'"'}this._processedText=this._processedText.replace(/===/g,"<mark "+s+">").replace(/\/==\//g,"</mark>")}}else{this._processedText=o;this._treatAsPlainText=true}}else{this._processedText=o;this._treatAsPlainText=true}}if(!this._processedText){this._processedText=""}if(this._treatAsPlainText){i.innerText=this._processedText}else{i.innerHTML=this._processedText}if(i.firstElementChild instanceof HTMLElement){var u=i.firstElementChild;u.style.marginTop="0px";u.style.width="100%";if(!this.wrap){u.style.overflow="hidden";u.style.textOverflow="ellipsis"}}if(i.lastElementChild instanceof HTMLElement){i.lastElementChild.style.marginBottom="0px"}var p=i.getElementsByTagName("a");for(var c=0;c<p.length;c++){var d=p[c];d.classList.add(n.makeCssClassName("ac-anchor"));d.target="_blank";d.onclick=function(t){if(Gt(e,t.target,t)){t.preventDefault();t.cancelBubble=true}};d.oncontextmenu=function(t){if(Gt(e,t.target,t)){t.preventDefault();t.cancelBubble=true;return false}return true}}if(this.wrap){i.style.wordWrap="break-word";if(this.maxLines&&this.maxLines>0){i.style.overflow="hidden";if(Ze.isInternetExplorer()||!$e.GlobalSettings.useWebkitLineClamp){i.style.maxHeight=this._computedLineHeight*this.maxLines+"px"}else{i.style.removeProperty("line-height");i.style.display="-webkit-box";i.style.webkitBoxOrient="vertical";i.style.webkitLineClamp=this.maxLines.toString()}}}else{i.style.whiteSpace="nowrap";i.style.textOverflow="ellipsis"}if($e.GlobalSettings.useAdvancedTextBlockTruncation||$e.GlobalSettings.useAdvancedCardBottomTruncation){this._originalInnerHtml=i.innerHTML}return i}else{return undefined}};t.prototype.truncateOverflow=function(e){if(e>=this._computedLineHeight){return this.truncateIfSupported(e)}return false};t.prototype.undoOverflowTruncation=function(){this.restoreOriginalContent();if($e.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines){var e=this._computedLineHeight*this.maxLines;this.truncateIfSupported(e)}};t.prototype.applyStylesTo=function(t){e.prototype.applyStylesTo.call(this,t);var n=this.getParentContainer();var i=n?n.isRtl():false;switch(this.horizontalAlignment){case Ye.HorizontalAlignment.Center:t.style.textAlign="center";break;case Ye.HorizontalAlignment.Right:t.style.textAlign=i?"left":"right";break;default:t.style.textAlign=i?"right":"left";break}var r=this.hostConfig.lineHeights;if(r){switch(this.size){case Ye.TextSize.Small:this._computedLineHeight=r.small;break;case Ye.TextSize.Medium:this._computedLineHeight=r.medium;break;case Ye.TextSize.Large:this._computedLineHeight=r.large;break;case Ye.TextSize.ExtraLarge:this._computedLineHeight=r.extraLarge;break;default:this._computedLineHeight=r.default;break}}else{this._computedLineHeight=this.getFontSize(this.hostConfig.getFontTypeDefinition(this.fontType))*1.33}t.style.lineHeight=this._computedLineHeight+"px"};t.prototype.getJsonTypeName=function(){return"TextBlock"};t.prototype.updateLayout=function(t){if(t===void 0){t=false}e.prototype.updateLayout.call(this,t);if($e.GlobalSettings.useAdvancedTextBlockTruncation&&this.maxLines&&this.isDisplayed()){this.restoreOriginalContent();this.truncateIfSupported(this._computedLineHeight*this.maxLines)}};t.wrapProperty=new nt.BoolProperty(nt.Versions.v1_0,"wrap",false);t.maxLinesProperty=new nt.NumProperty(nt.Versions.v1_0,"maxLines");Xe([nt.property(t.wrapProperty)],t.prototype,"wrap",void 0);Xe([nt.property(t.maxLinesProperty)],t.prototype,"maxLines",void 0);return t}(st);fe.TextBlock=lt;var ut=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.italic=false;t.strikethrough=false;t.highlight=false;t.underline=false;return t}t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t);t.add(st.selectActionProperty)};t.prototype.internalRender=function(){var e=this;if(this.text){var t=this.preProcessPropertyValue(st.textProperty);var n=this.hostConfig;var i=et.formatText(this.lang,t);if(!i){i=""}var r=document.createElement("span");r.classList.add(n.makeCssClassName("ac-textRun"));this.applyStylesTo(r);if(this.selectAction&&n.supportsInteractivity){var o=document.createElement("a");o.classList.add(n.makeCssClassName("ac-anchor"));var a=this.selectAction.getHref();o.href=a?a:"";o.target="_blank";o.onclick=function(t){t.preventDefault();t.cancelBubble=true;if(e.selectAction){e.selectAction.execute()}};if(this.selectAction.title){o.setAttribute("aria-label",this.selectAction.title);o.title=this.selectAction.title}o.innerText=i;r.appendChild(o)}else{r.innerText=i}return r}else{return undefined}};t.prototype.applyStylesTo=function(t){e.prototype.applyStylesTo.call(this,t);if(this.italic){t.style.fontStyle="italic"}if(this.strikethrough){t.style.textDecoration="line-through"}if(this.highlight){var n=this.getColorDefinition(this.getEffectiveStyleDefinition().foregroundColors,this.effectiveColor);t.style.backgroundColor=Ze.stringToCssColor(this.isSubtle?n.highlightColors.subtle:n.highlightColors.default)}if(this.underline){t.style.textDecoration="underline"}};t.prototype.getJsonTypeName=function(){return"TextRun"};Object.defineProperty(t.prototype,"isStandalone",{get:function(){return false},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isInline",{get:function(){return true},enumerable:false,configurable:true});t.italicProperty=new nt.BoolProperty(nt.Versions.v1_2,"italic",false);t.strikethroughProperty=new nt.BoolProperty(nt.Versions.v1_2,"strikethrough",false);t.highlightProperty=new nt.BoolProperty(nt.Versions.v1_2,"highlight",false);t.underlineProperty=new nt.BoolProperty(nt.Versions.v1_3,"underline",false);Xe([nt.property(t.italicProperty)],t.prototype,"italic",void 0);Xe([nt.property(t.strikethroughProperty)],t.prototype,"strikethrough",void 0);Xe([nt.property(t.highlightProperty)],t.prototype,"highlight",void 0);Xe([nt.property(t.underlineProperty)],t.prototype,"underline",void 0);return t}(st);fe.TextRun=ut;var pt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._inlines=[];return t}t.prototype.internalAddInline=function(e,t){if(t===void 0){t=false}if(!e.isInline){throw new Error(rt.Strings.errors.elementCannotBeUsedAsInline())}var n=e.parent===undefined||t;if(!n&&e.parent!=this){throw new Error(rt.Strings.errors.inlineAlreadyParented())}else{e.setParent(this);this._inlines.push(e)}};t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);this._inlines=[];if(Array.isArray(t["inlines"])){for(var i=0,r=t["inlines"];i<r.length;i++){var o=r[i];var a=void 0;if(typeof o==="string"){var s=new ut;s.text=o;a=s}else{a=n.parseElement(this,o,false)}if(a){this.internalAddInline(a,true)}}}};t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);if(this._inlines.length>0){var i=[];for(var r=0,o=this._inlines;r<o.length;r++){var a=o[r];i.push(a.toJSON(n))}n.serializeValue(t,"inlines",i)}};t.prototype.internalRender=function(){if(this._inlines.length>0){var e=void 0;if(this.forElementId){var t=document.createElement("label");t.htmlFor=this.forElementId;e=t}else{e=document.createElement("div")}e.className=this.hostConfig.makeCssClassName("ac-richTextBlock");var n=this.getParentContainer();var i=n?n.isRtl():false;switch(this.horizontalAlignment){case Ye.HorizontalAlignment.Center:e.style.textAlign="center";break;case Ye.HorizontalAlignment.Right:e.style.textAlign=i?"left":"right";break;default:e.style.textAlign=i?"right":"left";break}var r=0;for(var o=0,a=this._inlines;o<a.length;o++){var s=a[o];var l=s.render();if(l){e.appendChild(l);r++}}if(r>0){return e}}return undefined};t.prototype.asString=function(){var e="";for(var t=0,n=this._inlines;t<n.length;t++){var i=n[t];e+=i.asString()}return e};t.prototype.getJsonTypeName=function(){return"RichTextBlock"};t.prototype.getInlineCount=function(){return this._inlines.length};t.prototype.getInlineAt=function(e){if(e>=0&&e<this._inlines.length){return this._inlines[e]}else{throw new Error(rt.Strings.errors.indexOutOfRange(e))}};t.prototype.addInline=function(e){if(typeof e==="string"){this.internalAddInline(new ut(e))}else{this.internalAddInline(e)}};t.prototype.removeInline=function(e){var t=this._inlines.indexOf(e);if(t>=0){this._inlines[t].setParent(undefined);this._inlines.splice(t,1);return true}return false};return t}(ot);fe.RichTextBlock=pt;var ct=function(e){Ke(t,e);function t(t,n){var i=e.call(this)||this;i.name=t;i.value=n;return i}t.prototype.getSchemaKey=function(){return"Fact"};t.titleProperty=new nt.StringProperty(nt.Versions.v1_0,"title");t.valueProperty=new nt.StringProperty(nt.Versions.v1_0,"value");Xe([nt.property(t.titleProperty)],t.prototype,"name",void 0);Xe([nt.property(t.valueProperty)],t.prototype,"value",void 0);return t}(nt.SerializableObject);fe.Fact=ct;var dt=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return false},enumerable:false,configurable:true});t.prototype.internalRender=function(){var e=undefined;var t=this.hostConfig;if(this.facts.length>0){e=document.createElement("table");e.style.borderWidth="0px";e.style.borderSpacing="0px";e.style.borderStyle="none";e.style.borderCollapse="collapse";e.style.display="block";e.style.overflow="hidden";e.classList.add(t.makeCssClassName("ac-factset"));e.setAttribute("role","presentation");for(var n=0;n<this.facts.length;n++){var i=document.createElement("tr");if(n>0){i.style.marginTop=t.factSet.spacing+"px"}var r=document.createElement("td");r.style.padding="0";r.classList.add(t.makeCssClassName("ac-fact-title"));if(t.factSet.title.maxWidth){r.style.maxWidth=t.factSet.title.maxWidth+"px"}r.style.verticalAlign="top";var o=new lt;o.setParent(this);o.text=!this.facts[n].name&&this.isDesignMode()?"Title":this.facts[n].name;o.size=t.factSet.title.size;o.color=t.factSet.title.color;o.isSubtle=t.factSet.title.isSubtle;o.weight=t.factSet.title.weight;o.wrap=t.factSet.title.wrap;o.spacing=Ye.Spacing.None;Ze.appendChild(r,o.render());Ze.appendChild(i,r);r=document.createElement("td");r.style.width="10px";Ze.appendChild(i,r);r=document.createElement("td");r.style.padding="0";r.style.verticalAlign="top";r.classList.add(t.makeCssClassName("ac-fact-value"));o=new lt;o.setParent(this);o.text=this.facts[n].value;o.size=t.factSet.value.size;o.color=t.factSet.value.color;o.isSubtle=t.factSet.value.isSubtle;o.weight=t.factSet.value.weight;o.wrap=t.factSet.value.wrap;o.spacing=Ye.Spacing.None;Ze.appendChild(r,o.render());Ze.appendChild(i,r);Ze.appendChild(e,i)}}return e};t.prototype.getJsonTypeName=function(){return"FactSet"};t.factsProperty=new nt.SerializableObjectCollectionProperty(nt.Versions.v1_0,"facts",ct);Xe([nt.property(t.factsProperty)],t.prototype,"facts",void 0);return t}(ot);fe.FactSet=dt;var ft=function(e){Ke(t,e);function t(t,n,i,r){var o=e.call(this,t,n)||this;o.targetVersion=t;o.name=n;o.internalName=i;o.fallbackProperty=r;return o}t.prototype.getInternalName=function(){return this.internalName};t.prototype.parse=function(e,t,n){var i=undefined;var r=t[this.name];if(r===undefined){return this.defaultValue}var o=false;if(typeof r==="string"){try{var a=$e.SizeAndUnit.parse(r,true);if(a.unit==Ye.SizeUnit.Pixel){i=a.physicalSize;o=true}}catch(e){}if(!o&&this.fallbackProperty){o=this.fallbackProperty.isValidValue(r,n)}}if(!o){n.logParseEvent(e,Ye.ValidationEvent.InvalidPropertyValue,rt.Strings.errors.invalidPropertyValue(r,this.name))}return i};t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,typeof n==="number"&&!isNaN(n)?n+"px":undefined)};return t}(nt.PropertyDefinition);var ht=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.size=Ye.Size.Auto;t.style=Ye.ImageStyle.Default;return t}t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t);t.remove(ot.heightProperty)};t.prototype.applySize=function(e){if(this.pixelWidth||this.pixelHeight){if(this.pixelWidth){e.style.width=this.pixelWidth+"px"}if(this.pixelHeight){e.style.height=this.pixelHeight+"px"}}else{if(this.maxHeight){switch(this.size){case Ye.Size.Small:e.style.height=this.hostConfig.imageSizes.small+"px";break;case Ye.Size.Large:e.style.height=this.hostConfig.imageSizes.large+"px";break;default:e.style.height=this.hostConfig.imageSizes.medium+"px";break}e.style.maxHeight=this.maxHeight+"px"}else{switch(this.size){case Ye.Size.Stretch:e.style.width="100%";break;case Ye.Size.Auto:e.style.maxWidth="100%";break;case Ye.Size.Small:e.style.width=this.hostConfig.imageSizes.small+"px";break;case Ye.Size.Large:e.style.width=this.hostConfig.imageSizes.large+"px";break;case Ye.Size.Medium:e.style.width=this.hostConfig.imageSizes.medium+"px";break}e.style.maxHeight="100%"}}};Object.defineProperty(t.prototype,"useDefaultSizing",{get:function(){return false},enumerable:false,configurable:true});t.prototype.internalRender=function(){var e=this;var n=undefined;if(this.url){n=document.createElement("div");n.style.display="flex";n.style.alignItems="flex-start";n.onkeypress=function(t){if(e.selectAction&&(t.keyCode==13||t.keyCode==32)){t.preventDefault();t.cancelBubble=true;e.selectAction.execute()}};n.onclick=function(t){if(e.selectAction){t.preventDefault();t.cancelBubble=true;e.selectAction.execute()}};switch(this.horizontalAlignment){case Ye.HorizontalAlignment.Center:n.style.justifyContent="center";break;case Ye.HorizontalAlignment.Right:n.style.justifyContent="flex-end";break;default:n.style.justifyContent="flex-start";break}var i=this.hostConfig;var r=document.createElement("img");r.onload=function(t){Ut(e)};r.onerror=function(t){if(e.renderedElement){var n=e.getRootElement();e.renderedElement.innerHTML="";if(n&&n.designMode){var i=document.createElement("div");i.style.display="flex";i.style.alignItems="center";i.style.justifyContent="center";i.style.backgroundColor="#EEEEEE";i.style.color="black";i.innerText=":-(";i.style.padding="10px";e.applySize(i);e.renderedElement.appendChild(i)}}Ut(e)};r.style.minWidth="0";r.classList.add(i.makeCssClassName("ac-image"));if(this.selectAction!==undefined&&i.supportsInteractivity){r.tabIndex=0;r.setAttribute("role",this.selectAction.getAriaRole());if(this.selectAction.title){r.setAttribute("aria-label",this.selectAction.title);r.title=this.selectAction.title}r.classList.add(i.makeCssClassName("ac-selectable"))}this.applySize(r);if(this.style===Ye.ImageStyle.Person){r.style.borderRadius="50%";r.style.backgroundPosition="50% 50%";r.style.backgroundRepeat="no-repeat"}r.style.backgroundColor=Ze.stringToCssColor(this.backgroundColor);r.src=this.preProcessPropertyValue(t.urlProperty);var o=this.preProcessPropertyValue(t.altTextProperty);if(o){r.alt=o}n.appendChild(r)}return n};t.prototype.getJsonTypeName=function(){return"Image"};t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n&&this.selectAction){n=this.selectAction.getActionById(t)}return n};t.prototype.getResourceInformation=function(){return this.url?[{url:this.url,mimeType:"image"}]:[]};t.urlProperty=new nt.StringProperty(nt.Versions.v1_0,"url");t.altTextProperty=new nt.StringProperty(nt.Versions.v1_0,"altText");t.backgroundColorProperty=new nt.StringProperty(nt.Versions.v1_1,"backgroundColor");t.styleProperty=new nt.EnumProperty(nt.Versions.v1_0,"style",Ye.ImageStyle,Ye.ImageStyle.Default);t.sizeProperty=new nt.EnumProperty(nt.Versions.v1_0,"size",Ye.Size,Ye.Size.Auto);t.pixelWidthProperty=new ft(nt.Versions.v1_1,"width","pixelWidth");t.pixelHeightProperty=new ft(nt.Versions.v1_1,"height","pixelHeight",ot.heightProperty);t.selectActionProperty=new at(nt.Versions.v1_1,"selectAction",["Action.ShowCard"]);Xe([nt.property(t.urlProperty)],t.prototype,"url",void 0);Xe([nt.property(t.altTextProperty)],t.prototype,"altText",void 0);Xe([nt.property(t.backgroundColorProperty)],t.prototype,"backgroundColor",void 0);Xe([nt.property(t.sizeProperty)],t.prototype,"size",void 0);Xe([nt.property(t.styleProperty)],t.prototype,"style",void 0);Xe([nt.property(t.pixelWidthProperty)],t.prototype,"pixelWidth",void 0);Xe([nt.property(t.pixelHeightProperty)],t.prototype,"pixelHeight",void 0);Xe([nt.property(t.selectActionProperty)],t.prototype,"selectAction",void 0);return t}(ot);fe.Image=ht;var yt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.allowVerticalOverflow=false;return t}t.prototype.populateSchema=function(n){e.prototype.populateSchema.call(this,n);if(!this.isSelectable){n.remove(t.selectActionProperty)}};t.prototype.isElementAllowed=function(e){return this.hostConfig.supportsInteractivity||!e.isInteractive};t.prototype.applyPadding=function(){e.prototype.applyPadding.call(this);if(!this.renderedElement){return}var t=new $e.SpacingDefinition;if(this.getEffectivePadding()){t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())}this.renderedElement.style.paddingTop=t.top+"px";this.renderedElement.style.paddingRight=t.right+"px";this.renderedElement.style.paddingBottom=t.bottom+"px";this.renderedElement.style.paddingLeft=t.left+"px";this.renderedElement.style.marginRight="0";this.renderedElement.style.marginLeft="0"};Object.defineProperty(t.prototype,"isSelectable",{get:function(){return false},enumerable:false,configurable:true});t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);for(var n=0;n<this.getItemCount();n++){var i=this.getItemAt(n);if(!this.hostConfig.supportsInteractivity&&i.isInteractive){t.addFailure(this,Ye.ValidationEvent.InteractivityNotAllowed,rt.Strings.errors.interactivityNotAllowed())}if(!this.isElementAllowed(i)){t.addFailure(this,Ye.ValidationEvent.InteractivityNotAllowed,rt.Strings.errors.elementTypeNotAllowed(i.getJsonTypeName()))}i.internalValidateProperties(t)}if(this._selectAction){this._selectAction.internalValidateProperties(t)}};t.prototype.render=function(){var t=this;var n=e.prototype.render.call(this);if(n){var i=this.hostConfig;if(this.allowVerticalOverflow){n.style.overflowX="hidden";n.style.overflowY="auto"}if(n&&this.isSelectable&&this._selectAction&&i.supportsInteractivity){n.classList.add(i.makeCssClassName("ac-selectable"));n.tabIndex=0;n.setAttribute("role",this._selectAction.getAriaRole());if(this._selectAction.title){n.setAttribute("aria-label",this._selectAction.title);n.title=this._selectAction.title}n.onclick=function(e){if(t._selectAction!==undefined){e.preventDefault();e.cancelBubble=true;t._selectAction.execute()}};n.onkeypress=function(e){if(t._selectAction!==undefined&&(e.keyCode==13||e.keyCode==32)){e.preventDefault();e.cancelBubble=true;t._selectAction.execute()}}}}return n};t.prototype.updateLayout=function(t){if(t===void 0){t=true}e.prototype.updateLayout.call(this,t);if(t){for(var n=0;n<this.getItemCount();n++){this.getItemAt(n).updateLayout()}}};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}var t=[];for(var n=0;n<this.getItemCount();n++){t=t.concat(this.getItemAt(n).getAllInputs(e))}return t};t.prototype.getResourceInformation=function(){var e=[];for(var t=0;t<this.getItemCount();t++){e=e.concat(this.getItemAt(t).getResourceInformation())}return e};t.prototype.getElementById=function(t){var n=e.prototype.getElementById.call(this,t);if(!n){for(var i=0;i<this.getItemCount();i++){n=this.getItemAt(i).getElementById(t);if(n){break}}}return n};t.prototype.findDOMNodeOwner=function(t){var n=undefined;for(var i=0;i<this.getItemCount();i++){n=this.getItemAt(i).findDOMNodeOwner(t);if(n){return n}}return e.prototype.findDOMNodeOwner.call(this,t)};t.selectActionProperty=new at(nt.Versions.v1_1,"selectAction",["Action.ShowCard"]);Xe([nt.property(t.selectActionProperty)],t.prototype,"_selectAction",void 0);return t}(ot);fe.CardElementContainer=yt;var gt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._images=[];t.imageSize=Ye.ImageSize.Medium;return t}t.prototype.internalRender=function(){var e=undefined;if(this._images.length>0){e=document.createElement("div");e.style.display="flex";e.style.flexWrap="wrap";for(var t=0,n=this._images;t<n.length;t++){var i=n[t];switch(this.imageSize){case Ye.ImageSize.Small:i.size=Ye.Size.Small;break;case Ye.ImageSize.Large:i.size=Ye.Size.Large;break;default:i.size=Ye.Size.Medium;break}i.maxHeight=this.hostConfig.imageSet.maxImageHeight;var r=i.render();if(r){r.style.display="inline-flex";r.style.margin="0px";r.style.marginRight="10px";Ze.appendChild(e,r)}}}return e};t.prototype.getItemCount=function(){return this._images.length};t.prototype.getItemAt=function(e){return this._images[e]};t.prototype.getFirstVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[0]:undefined};t.prototype.getLastVisibleRenderedItem=function(){return this._images&&this._images.length>0?this._images[this._images.length-1]:undefined};t.prototype.removeItem=function(e){if(e instanceof ht){var t=this._images.indexOf(e);if(t>=0){this._images.splice(t,1);e.setParent(undefined);this.updateLayout();return true}}return false};t.prototype.getJsonTypeName=function(){return"ImageSet"};t.prototype.addImage=function(e){if(!e.parent){this._images.push(e);e.setParent(this)}else{throw new Error("This image already belongs to another ImageSet")}};t.prototype.indexOf=function(e){return e instanceof ht?this._images.indexOf(e):-1};t.imagesProperty=new nt.SerializableObjectCollectionProperty(nt.Versions.v1_0,"images",ht,function(e,t){t.setParent(e)});t.imageSizeProperty=new nt.EnumProperty(nt.Versions.v1_0,"imageSize",Ye.ImageSize,Ye.ImageSize.Medium);Xe([nt.property(t.imagesProperty)],t.prototype,"_images",void 0);Xe([nt.property(t.imageSizeProperty)],t.prototype,"imageSize",void 0);return t}(yt);fe.ImageSet=gt;var mt=function(e){Ke(t,e);function t(t,n){var i=e.call(this)||this;i.url=t;i.mimeType=n;return i}t.prototype.getSchemaKey=function(){return"MediaSource"};t.prototype.isValid=function(){return this.mimeType&&this.url?true:false};t.prototype.render=function(){var e=undefined;if(this.isValid()){e=document.createElement("source");e.src=this.url;e.type=this.mimeType}return e};t.mimeTypeProperty=new nt.StringProperty(nt.Versions.v1_1,"mimeType");t.urlProperty=new nt.StringProperty(nt.Versions.v1_1,"url");Xe([nt.property(t.mimeTypeProperty)],t.prototype,"mimeType",void 0);Xe([nt.property(t.urlProperty)],t.prototype,"url",void 0);return t}(nt.SerializableObject);fe.MediaSource=mt;var vt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.sources=[];return t}t.prototype.getPosterUrl=function(){return this.poster?this.poster:this.hostConfig.media.defaultPoster};t.prototype.processSources=function(){this._selectedSources=[];this._selectedMediaType=undefined;for(var e=0,n=this.sources;e<n.length;e++){var i=n[e];var r=i.mimeType?i.mimeType.split("/"):[];if(r.length==2){if(!this._selectedMediaType){var o=t.supportedMediaTypes.indexOf(r[0]);if(o>=0){this._selectedMediaType=t.supportedMediaTypes[o]}}if(r[0]==this._selectedMediaType){this._selectedSources.push(i)}}}};t.prototype.handlePlayButtonInvoke=function(e){if(this.hostConfig.media.allowInlinePlayback){e.preventDefault();e.cancelBubble=true;if(this.renderedElement){var n=this.renderMediaPlayer();this.renderedElement.innerHTML="";this.renderedElement.appendChild(n);n.play();n.focus()}}else{if(t.onPlay){e.preventDefault();e.cancelBubble=true;t.onPlay(this)}}};t.prototype.renderPoster=function(){var e=this;var t=12;var n=15;var i=document.createElement("div");i.className=this.hostConfig.makeCssClassName("ac-media-poster");i.setAttribute("role","contentinfo");i.setAttribute("aria-label",this.altText?this.altText:rt.Strings.defaults.mediaPlayerAriaLabel());i.style.position="relative";i.style.display="flex";var r=this.getPosterUrl();if(r){var o=document.createElement("img");o.style.width="100%";o.style.height="100%";o.setAttribute("role","presentation");o.onerror=function(e){if(o.parentNode){o.parentNode.removeChild(o)}i.classList.add("empty");i.style.minHeight="150px"};o.src=r;i.appendChild(o)}else{i.classList.add("empty");i.style.minHeight="150px"}if(this.hostConfig.supportsInteractivity&&this._selectedSources.length>0){var a=document.createElement("div");a.tabIndex=0;a.setAttribute("role","button");a.setAttribute("aria-label",rt.Strings.defaults.mediaPlayerPlayMedia());a.className=this.hostConfig.makeCssClassName("ac-media-playButton");a.style.display="flex";a.style.alignItems="center";a.style.justifyContent="center";a.onclick=function(t){e.handlePlayButtonInvoke(t)};a.onkeypress=function(t){if(t.keyCode==13||t.keyCode==32){e.handlePlayButtonInvoke(t)}};var s=document.createElement("div");s.className=this.hostConfig.makeCssClassName("ac-media-playButton-arrow");s.style.width=t+"px";s.style.height=n+"px";s.style.borderTopWidth=n/2+"px";s.style.borderBottomWidth=n/2+"px";s.style.borderLeftWidth=t+"px";s.style.borderRightWidth="0";s.style.borderStyle="solid";s.style.borderTopColor="transparent";s.style.borderRightColor="transparent";s.style.borderBottomColor="transparent";s.style.transform="translate("+t/10+"px,0px)";a.appendChild(s);var l=document.createElement("div");l.style.position="absolute";l.style.left="0";l.style.top="0";l.style.width="100%";l.style.height="100%";l.style.display="flex";l.style.justifyContent="center";l.style.alignItems="center";l.appendChild(a);i.appendChild(l)}return i};t.prototype.renderMediaPlayer=function(){var e;if(this._selectedMediaType=="video"){var t=document.createElement("video");var n=this.getPosterUrl();if(n){t.poster=n}e=t}else{e=document.createElement("audio")}e.setAttribute("aria-label",this.altText?this.altText:rt.Strings.defaults.mediaPlayerAriaLabel());e.setAttribute("webkit-playsinline","");e.setAttribute("playsinline","");e.autoplay=true;e.controls=true;if(Ze.isMobileOS()){e.muted=true}e.preload="none";e.style.width="100%";for(var i=0,r=this.sources;i<r.length;i++){var o=r[i];var a=o.render();Ze.appendChild(e,a)}return e};t.prototype.internalRender=function(){var e=document.createElement("div");e.className=this.hostConfig.makeCssClassName("ac-media");this.processSources();e.appendChild(this.renderPoster());return e};t.prototype.getJsonTypeName=function(){return"Media"};t.prototype.getResourceInformation=function(){var e=[];var t=this.getPosterUrl();if(t){e.push({url:t,mimeType:"image"})}for(var n=0,i=this.sources;n<i.length;n++){var r=i[n];if(r.isValid()){e.push({url:r.url,mimeType:r.mimeType})}}return e};Object.defineProperty(t.prototype,"selectedMediaType",{get:function(){return this._selectedMediaType},enumerable:false,configurable:true});t.sourcesProperty=new nt.SerializableObjectCollectionProperty(nt.Versions.v1_1,"sources",mt);t.posterProperty=new nt.StringProperty(nt.Versions.v1_1,"poster");t.altTextProperty=new nt.StringProperty(nt.Versions.v1_1,"altText");t.supportedMediaTypes=["audio","video"];Xe([nt.property(t.sourcesProperty)],t.prototype,"sources",void 0);Xe([nt.property(t.posterProperty)],t.prototype,"poster",void 0);Xe([nt.property(t.altTextProperty)],t.prototype,"altText",void 0);return t}(ot);fe.Media=vt;var bt=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getAllLabelIds=function(){var e=[];if(this._renderedLabelElement){e.push(this._renderedLabelElement.id)}if(this._renderedErrorMessageElement){e.push(this._renderedErrorMessageElement.id)}return e};t.prototype.updateInputControlAriaLabelledBy=function(){if(this._renderedInputControlElement){var e=this.getAllLabelIds();if(this.labelledBy){e.push(this.labelledBy)}if(this._renderedLabelElement){e.push(this._renderedLabelElement.id)}if(this._renderedErrorMessageElement){e.push(this._renderedErrorMessageElement.id)}if(e.length>0){this._renderedInputControlElement.setAttribute("aria-labelledby",e.join(" "))}else{this._renderedInputControlElement.removeAttribute("aria-labelledby")}}};Object.defineProperty(t.prototype,"isNullable",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"renderedInputControlElement",{get:function(){return this._renderedInputControlElement},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"inputControlContainerElement",{get:function(){return this._inputControlContainerElement},enumerable:false,configurable:true});t.prototype.overrideInternalRender=function(){var e=this.hostConfig;this._outerContainerElement=document.createElement("div");this._outerContainerElement.style.display="flex";this._outerContainerElement.style.flexDirection="column";var t=Ze.generateUniqueId();if(this.label){var n=new pt;n.setParent(this);n.forElementId=t;var i=new ut(this.label);n.addInline(i);if(this.isRequired){i.init(e.inputs.label.requiredInputs);var r=new ut(e.inputs.label.requiredInputs.suffix);r.color=e.inputs.label.requiredInputs.suffixColor;r.ariaHidden=true;n.addInline(r)}else{i.init(e.inputs.label.optionalInputs)}this._renderedLabelElement=n.render();if(this._renderedLabelElement){this._renderedLabelElement.id=Ze.generateUniqueId();this._renderedLabelElement.style.marginBottom=e.getEffectiveSpacing(e.inputs.label.inputSpacing)+"px";this._outerContainerElement.appendChild(this._renderedLabelElement)}}this._inputControlContainerElement=document.createElement("div");this._inputControlContainerElement.className=e.makeCssClassName("ac-input-container");this._inputControlContainerElement.style.display="flex";if(this.height==="stretch"){this._inputControlContainerElement.style.alignItems="stretch";this._inputControlContainerElement.style.flex="1 1 auto"}this._renderedInputControlElement=this.internalRender();if(this._renderedInputControlElement){this._renderedInputControlElement.id=t;this._renderedInputControlElement.style.minWidth="0px";if(this.isNullable&&this.isRequired){this._renderedInputControlElement.setAttribute("aria-required","true");this._renderedInputControlElement.classList.add(e.makeCssClassName("ac-input-required"))}this._inputControlContainerElement.appendChild(this._renderedInputControlElement);this._outerContainerElement.appendChild(this._inputControlContainerElement);this.updateInputControlAriaLabelledBy();return this._outerContainerElement}return undefined};t.prototype.valueChanged=function(){if(this.isValid()){this.resetValidationFailureCue()}if(this.onValueChanged){this.onValueChanged(this)}Yt(this)};t.prototype.resetValidationFailureCue=function(){if(this.renderedInputControlElement){this.renderedInputControlElement.classList.remove(this.hostConfig.makeCssClassName("ac-input-validation-failed"));this.updateInputControlAriaLabelledBy();if(this._renderedErrorMessageElement){this._outerContainerElement.removeChild(this._renderedErrorMessageElement);this._renderedErrorMessageElement=undefined}}};t.prototype.showValidationErrorMessage=function(){if(this.renderedElement&&this.errorMessage&&$e.GlobalSettings.displayInputValidationErrors){var e=new lt;e.setParent(this);e.text=this.errorMessage;e.wrap=true;e.init(this.hostConfig.inputs.errorMessage);this._renderedErrorMessageElement=e.render();if(this._renderedErrorMessageElement){this._renderedErrorMessageElement.id=Ze.generateUniqueId();this._outerContainerElement.appendChild(this._renderedErrorMessageElement);this.updateInputControlAriaLabelledBy()}}};t.prototype.focus=function(){if(this._renderedInputControlElement){this._renderedInputControlElement.focus()}};t.prototype.isValid=function(){return true};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(!this.id){t.addFailure(this,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.inputsMustHaveUniqueId())}if(this.isRequired){if(!this.label){t.addFailure(this,Ye.ValidationEvent.RequiredInputsShouldHaveLabel,"Required inputs should have a label")}if(!this.errorMessage){t.addFailure(this,Ye.ValidationEvent.RequiredInputsShouldHaveErrorMessage,"Required inputs should have an error message")}}};t.prototype.validateValue=function(){this.resetValidationFailureCue();var e=this.isRequired?this.isSet()&&this.isValid():this.isValid();if(!e&&this.renderedInputControlElement){this.renderedInputControlElement.classList.add(this.hostConfig.makeCssClassName("ac-input-validation-failed"));this.showValidationErrorMessage()}return e};t.prototype.getAllInputs=function(e){return[this]};Object.defineProperty(t.prototype,"isInteractive",{get:function(){return true},enumerable:false,configurable:true});t.labelProperty=new nt.StringProperty(nt.Versions.v1_3,"label",true);t.isRequiredProperty=new nt.BoolProperty(nt.Versions.v1_3,"isRequired",false);t.errorMessageProperty=new nt.StringProperty(nt.Versions.v1_3,"errorMessage",true);Xe([nt.property(t.labelProperty)],t.prototype,"label",void 0);Xe([nt.property(t.isRequiredProperty)],t.prototype,"isRequired",void 0);Xe([nt.property(t.errorMessageProperty)],t.prototype,"errorMessage",void 0);return t}(ot);fe.Input=bt;var Ct=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.isMultiline=false;t.style=Ye.InputTextStyle.Text;return t}t.prototype.setupInput=function(e){var t=this;e.style.flex="1 1 auto";e.tabIndex=0;if(this.placeholder){e.placeholder=this.placeholder;e.setAttribute("aria-label",this.placeholder)}if(this.defaultValue){e.value=this.defaultValue}if(this.maxLength&&this.maxLength>0){e.maxLength=this.maxLength}e.oninput=function(){t.valueChanged()};e.onkeypress=function(e){if(e.ctrlKey&&e.code==="Enter"&&t.inlineAction){t.inlineAction.execute()}}};t.prototype.internalRender=function(){var e;if(this.isMultiline){e=document.createElement("textarea");e.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput","ac-multiline");if(this.height==="stretch"){e.style.height="initial"}}else{e=document.createElement("input");e.className=this.hostConfig.makeCssClassName("ac-input","ac-textInput");e.type=Ye.InputTextStyle[this.style].toLowerCase()}this.setupInput(e);return e};t.prototype.overrideInternalRender=function(){var t=this;var n=e.prototype.overrideInternalRender.call(this);if(this.inlineAction){var i=document.createElement("button");i.className=this.hostConfig.makeCssClassName("ac-inlineActionButton");i.onclick=function(e){e.preventDefault();e.cancelBubble=true;if(t.inlineAction){t.inlineAction.execute()}};if(this.inlineAction.iconUrl){i.classList.add("iconOnly");var r=document.createElement("img");r.style.height="100%";r.setAttribute("role","presentation");r.style.display="none";r.onload=function(){r.style.removeProperty("display")};r.onerror=function(){i.removeChild(r);i.classList.remove("iconOnly");i.classList.add("textOnly");i.textContent=t.inlineAction&&t.inlineAction.title?t.inlineAction.title:rt.Strings.defaults.inlineActionTitle()};r.src=this.inlineAction.iconUrl;i.appendChild(r);i.title=this.inlineAction.title?this.inlineAction.title:rt.Strings.defaults.inlineActionTitle()}else{i.classList.add("textOnly");i.textContent=this.inlineAction.title?this.inlineAction.title:rt.Strings.defaults.inlineActionTitle()}i.style.marginLeft="8px";this.inputControlContainerElement.appendChild(i)}return n};t.prototype.getJsonTypeName=function(){return"Input.Text"};t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n&&this.inlineAction){n=this.inlineAction.getActionById(t)}return n};t.prototype.isSet=function(){return this.value?true:false};t.prototype.isValid=function(){if(!this.value){return true}if(this.regex){return new RegExp(this.regex,"g").test(this.value)}return true};Object.defineProperty(t.prototype,"value",{get:function(){if(this.renderedInputControlElement){if(this.isMultiline){return this.renderedInputControlElement.value}else{return this.renderedInputControlElement.value}}else{return undefined}},enumerable:false,configurable:true});t.valueProperty=new nt.StringProperty(nt.Versions.v1_0,"value");t.maxLengthProperty=new nt.NumProperty(nt.Versions.v1_0,"maxLength");t.isMultilineProperty=new nt.BoolProperty(nt.Versions.v1_0,"isMultiline",false);t.placeholderProperty=new nt.StringProperty(nt.Versions.v1_0,"placeholder");t.styleProperty=new nt.EnumProperty(nt.Versions.v1_0,"style",Ye.InputTextStyle,Ye.InputTextStyle.Text);t.inlineActionProperty=new at(nt.Versions.v1_0,"inlineAction",["Action.ShowCard"]);t.regexProperty=new nt.StringProperty(nt.Versions.v1_3,"regex",true);Xe([nt.property(t.valueProperty)],t.prototype,"defaultValue",void 0);Xe([nt.property(t.maxLengthProperty)],t.prototype,"maxLength",void 0);Xe([nt.property(t.isMultilineProperty)],t.prototype,"isMultiline",void 0);Xe([nt.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);Xe([nt.property(t.styleProperty)],t.prototype,"style",void 0);Xe([nt.property(t.inlineActionProperty)],t.prototype,"inlineAction",void 0);Xe([nt.property(t.regexProperty)],t.prototype,"regex",void 0);return t}(bt);fe.TextInput=Ct;var St=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.valueOn="true";t.valueOff="false";t.wrap=false;return t}t.prototype.updateInputControlAriaLabelledBy=function(){if(this._checkboxInputElement){var e=this.getAllLabelIds().join(" ");if(this._checkboxInputLabelElement&&this._checkboxInputLabelElement.id){e+=" "+this._checkboxInputLabelElement.id}if(e){this._checkboxInputElement.setAttribute("aria-labelledby",e)}else{this._checkboxInputElement.removeAttribute("aria-labelledby")}}};t.prototype.internalRender=function(){var e=this;var t=document.createElement("div");t.className=this.hostConfig.makeCssClassName("ac-input","ac-toggleInput");t.style.width="100%";t.style.display="flex";t.style.alignItems="center";this._checkboxInputElement=document.createElement("input");this._checkboxInputElement.id=Ze.generateUniqueId();this._checkboxInputElement.type="checkbox";this._checkboxInputElement.style.display="inline-block";this._checkboxInputElement.style.verticalAlign="middle";this._checkboxInputElement.style.margin="0";this._checkboxInputElement.style.flex="0 0 auto";if(this.title){this._checkboxInputElement.setAttribute("aria-label",this.title)}if(this.isRequired){this._checkboxInputElement.setAttribute("aria-required","true")}this._checkboxInputElement.tabIndex=0;if(this.defaultValue==this.valueOn){this._checkboxInputElement.checked=true}this._checkboxInputElement.onchange=function(){e.valueChanged()};Ze.appendChild(t,this._checkboxInputElement);if(this.title||this.isDesignMode()){var n=new lt;n.setParent(this);n.forElementId=this._checkboxInputElement.id;n.hostConfig=this.hostConfig;n.text=!this.title?this.getJsonTypeName():this.title;n.useMarkdown=$e.GlobalSettings.useMarkdownInRadioButtonAndCheckbox;n.wrap=this.wrap;this._checkboxInputLabelElement=n.render();if(this._checkboxInputLabelElement){this._checkboxInputLabelElement.id=Ze.generateUniqueId();this._checkboxInputLabelElement.style.display="inline-block";this._checkboxInputLabelElement.style.flex="1 1 auto";this._checkboxInputLabelElement.style.marginLeft="6px";this._checkboxInputLabelElement.style.verticalAlign="middle";var i=document.createElement("div");i.style.width="6px";Ze.appendChild(t,i);Ze.appendChild(t,this._checkboxInputLabelElement)}}return t};Object.defineProperty(t.prototype,"isNullable",{get:function(){return false},enumerable:false,configurable:true});t.prototype.getJsonTypeName=function(){return"Input.Toggle"};t.prototype.focus=function(){if(this._checkboxInputElement){this._checkboxInputElement.focus()}};t.prototype.isSet=function(){if(this.isRequired){return this.value===this.valueOn}return this.value?true:false};Object.defineProperty(t.prototype,"value",{get:function(){if(this._checkboxInputElement){return this._checkboxInputElement.checked?this.valueOn:this.valueOff}else{return undefined}},enumerable:false,configurable:true});t.valueProperty=new nt.StringProperty(nt.Versions.v1_0,"value");t.titleProperty=new nt.StringProperty(nt.Versions.v1_0,"title");t.valueOnProperty=new nt.StringProperty(nt.Versions.v1_0,"valueOn",true,undefined,"true",function(e){return"true"});t.valueOffProperty=new nt.StringProperty(nt.Versions.v1_0,"valueOff",true,undefined,"false",function(e){return"false"});t.wrapProperty=new nt.BoolProperty(nt.Versions.v1_2,"wrap",false);Xe([nt.property(t.valueProperty)],t.prototype,"defaultValue",void 0);Xe([nt.property(t.titleProperty)],t.prototype,"title",void 0);Xe([nt.property(t.valueOnProperty)],t.prototype,"valueOn",void 0);Xe([nt.property(t.valueOffProperty)],t.prototype,"valueOff",void 0);Xe([nt.property(t.wrapProperty)],t.prototype,"wrap",void 0);return t}(bt);fe.ToggleInput=St;var Pt=function(e){Ke(t,e);function t(t,n){var i=e.call(this)||this;i.title=t;i.value=n;return i}t.prototype.getSchemaKey=function(){return"Choice"};t.titleProperty=new nt.StringProperty(nt.Versions.v1_0,"title");t.valueProperty=new nt.StringProperty(nt.Versions.v1_0,"value");Xe([nt.property(t.titleProperty)],t.prototype,"title",void 0);Xe([nt.property(t.valueProperty)],t.prototype,"value",void 0);return t}(nt.SerializableObject);fe.Choice=Pt;var _t=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.isMultiSelect=false;t.wrap=false;t.choices=[];return t}Object.defineProperty(t.prototype,"isCompact",{get:function(){return this.style!=="expanded"},set:function(e){this.style=e?undefined:"expanded"},enumerable:false,configurable:true});t.getUniqueCategoryName=function(){var e="__ac-category"+t.uniqueCategoryCounter;t.uniqueCategoryCounter++;return e};t.prototype.internalApplyAriaCurrent=function(){var e=this._selectElement.options;if(e){for(var t=0;t<e.length;t++){if(e[t].selected){e[t].setAttribute("aria-current","true")}else{e[t].removeAttribute("aria-current")}}}};t.prototype.renderCompoundInput=function(e,t,n){var i=this;var r=document.createElement("div");r.className=this.hostConfig.makeCssClassName("ac-input",e);r.style.width="100%";this._toggleInputs=[];this._labels=[];for(var o=0,a=this.choices;o<a.length;o++){var s=a[o];var l=document.createElement("input");l.id=Ze.generateUniqueId();l.type=t;l.style.margin="0";l.style.display="inline-block";l.style.verticalAlign="middle";l.style.flex="0 0 auto";l.name=this.id?this.id:this._uniqueCategoryName;if(this.isRequired){l.setAttribute("aria-required","true")}if(s.value){l.value=s.value}if(s.title){l.setAttribute("aria-label",s.title)}if(n&&s.value){if(n.indexOf(s.value)>=0){l.checked=true}}l.onchange=function(){i.valueChanged()};this._toggleInputs.push(l);var u=document.createElement("div");u.style.display="flex";u.style.alignItems="center";Ze.appendChild(u,l);var p=new lt;p.setParent(this);p.forElementId=l.id;p.hostConfig=this.hostConfig;p.text=s.title?s.title:"Choice "+this._toggleInputs.length;p.useMarkdown=$e.GlobalSettings.useMarkdownInRadioButtonAndCheckbox;p.wrap=this.wrap;var c=p.render();this._labels.push(c);if(c){c.id=Ze.generateUniqueId();c.style.display="inline-block";c.style.flex="1 1 auto";c.style.marginLeft="6px";c.style.verticalAlign="middle";var d=document.createElement("div");d.style.width="6px";Ze.appendChild(u,d);Ze.appendChild(u,c)}Ze.appendChild(r,u)}return r};t.prototype.updateInputControlAriaLabelledBy=function(){if((this.isMultiSelect||this.style==="expanded")&&this._toggleInputs&&this._labels){var t=this.getAllLabelIds();for(var n=0;n<this._toggleInputs.length;n++){var i=t.join(" ");var r=this._labels[n];if(r&&r.id){i+=" "+r.id}if(i){this._toggleInputs[n].setAttribute("aria-labelledby",i)}else{this._toggleInputs[n].removeAttribute("aria-labelledby")}}}else{e.prototype.updateInputControlAriaLabelledBy.call(this)}};t.prototype.internalRender=function(){var e=this;this._uniqueCategoryName=t.getUniqueCategoryName();if(this.isMultiSelect){return this.renderCompoundInput("ac-choiceSetInput-multiSelect","checkbox",this.defaultValue?this.defaultValue.split(this.hostConfig.choiceSetInputValueSeparator):undefined)}else{if(this.style==="expanded"){return this.renderCompoundInput("ac-choiceSetInput-expanded","radio",this.defaultValue?[this.defaultValue]:undefined)}else{this._selectElement=document.createElement("select");this._selectElement.className=this.hostConfig.makeCssClassName("ac-input","ac-multichoiceInput","ac-choiceSetInput-compact");this._selectElement.style.width="100%";var n=document.createElement("option");n.selected=true;n.disabled=true;n.hidden=true;n.value="";if(this.placeholder){n.text=this.placeholder}Ze.appendChild(this._selectElement,n);for(var i=0,r=this.choices;i<r.length;i++){var o=r[i];var a=document.createElement("option");a.value=o.value;a.text=o.title;a.setAttribute("aria-label",o.title);if(o.value==this.defaultValue){a.selected=true}Ze.appendChild(this._selectElement,a)}this._selectElement.onchange=function(){e.internalApplyAriaCurrent();e.valueChanged()};this.internalApplyAriaCurrent();return this._selectElement}}};t.prototype.getJsonTypeName=function(){return"Input.ChoiceSet"};t.prototype.focus=function(){if(this._toggleInputs&&(this.isMultiSelect||this.style==="expanded")){if(this._toggleInputs.length>0){this._toggleInputs[0].focus()}}else{e.prototype.focus.call(this)}};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(this.choices.length==0){t.addFailure(this,Ye.ValidationEvent.CollectionCantBeEmpty,rt.Strings.errors.choiceSetMustHaveAtLeastOneChoice())}for(var n=0,i=this.choices;n<i.length;n++){var r=i[n];if(!r.title||!r.value){t.addFailure(this,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.choiceSetChoicesMustHaveTitleAndValue())}}};t.prototype.isSet=function(){return this.value?true:false};Object.defineProperty(t.prototype,"value",{get:function(){if(!this.isMultiSelect){if(this.isCompact){if(this._selectElement){return this._selectElement.selectedIndex>0?this._selectElement.value:undefined}return undefined}else{if(!this._toggleInputs||this._toggleInputs.length==0){return undefined}for(var e=0,t=this._toggleInputs;e<t.length;e++){var n=t[e];if(n.checked){return n.value}}return undefined}}else{if(!this._toggleInputs||this._toggleInputs.length==0){return undefined}var i="";for(var r=0,o=this._toggleInputs;r<o.length;r++){var n=o[r];if(n.checked){if(i!=""){i+=this.hostConfig.choiceSetInputValueSeparator}i+=n.value}}return i?i:undefined}},enumerable:false,configurable:true});t.valueProperty=new nt.StringProperty(nt.Versions.v1_0,"value");t.choicesProperty=new nt.SerializableObjectCollectionProperty(nt.Versions.v1_0,"choices",Pt);t.styleProperty=new nt.ValueSetProperty(nt.Versions.v1_0,"style",[{value:"compact"},{value:"expanded"}],"compact");t.isMultiSelectProperty=new nt.BoolProperty(nt.Versions.v1_0,"isMultiSelect",false);t.placeholderProperty=new nt.StringProperty(nt.Versions.v1_0,"placeholder");t.wrapProperty=new nt.BoolProperty(nt.Versions.v1_2,"wrap",false);t.uniqueCategoryCounter=0;Xe([nt.property(t.valueProperty)],t.prototype,"defaultValue",void 0);Xe([nt.property(t.styleProperty)],t.prototype,"style",void 0);Xe([nt.property(t.isMultiSelectProperty)],t.prototype,"isMultiSelect",void 0);Xe([nt.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);Xe([nt.property(t.wrapProperty)],t.prototype,"wrap",void 0);Xe([nt.property(t.choicesProperty)],t.prototype,"choices",void 0);return t}(bt);fe.ChoiceSetInput=_t;var At=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalRender=function(){var e=this;this._numberInputElement=document.createElement("input");this._numberInputElement.setAttribute("type","number");if(this.min!==undefined){this._numberInputElement.setAttribute("min",this.min.toString())}if(this.max!==undefined){this._numberInputElement.setAttribute("max",this.max.toString())}this._numberInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-numberInput");this._numberInputElement.style.width="100%";this._numberInputElement.tabIndex=0;if(this.defaultValue!==undefined){this._numberInputElement.valueAsNumber=this.defaultValue}if(this.placeholder){this._numberInputElement.placeholder=this.placeholder;this._numberInputElement.setAttribute("aria-label",this.placeholder)}this._numberInputElement.oninput=function(){e.valueChanged()};return this._numberInputElement};t.prototype.getJsonTypeName=function(){return"Input.Number"};t.prototype.isSet=function(){return this.value!==undefined&&!isNaN(this.value)};t.prototype.isValid=function(){if(this.value===undefined){return!this.isRequired}var e=true;if(this.min!==undefined){e=e&&this.value>=this.min}if(this.max!==undefined){e=e&&this.value<=this.max}return e};Object.defineProperty(t.prototype,"value",{get:function(){return this._numberInputElement?this._numberInputElement.valueAsNumber:undefined},enumerable:false,configurable:true});t.valueProperty=new nt.NumProperty(nt.Versions.v1_0,"value");t.placeholderProperty=new nt.StringProperty(nt.Versions.v1_0,"placeholder");t.minProperty=new nt.NumProperty(nt.Versions.v1_0,"min");t.maxProperty=new nt.NumProperty(nt.Versions.v1_0,"max");Xe([nt.property(t.valueProperty)],t.prototype,"defaultValue",void 0);Xe([nt.property(t.minProperty)],t.prototype,"min",void 0);Xe([nt.property(t.maxProperty)],t.prototype,"max",void 0);Xe([nt.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);return t}(bt);fe.NumberInput=At;var wt=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalRender=function(){var e=this;this._dateInputElement=document.createElement("input");this._dateInputElement.setAttribute("type","date");if(this.min){this._dateInputElement.setAttribute("min",this.min)}if(this.max){this._dateInputElement.setAttribute("max",this.max)}if(this.placeholder){this._dateInputElement.placeholder=this.placeholder;this._dateInputElement.setAttribute("aria-label",this.placeholder)}this._dateInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-dateInput");this._dateInputElement.style.width="100%";this._dateInputElement.oninput=function(){e.valueChanged()};if(this.defaultValue){this._dateInputElement.value=this.defaultValue}return this._dateInputElement};t.prototype.getJsonTypeName=function(){return"Input.Date"};t.prototype.isSet=function(){return this.value?true:false};t.prototype.isValid=function(){if(!this.value){return!this.isRequired}var e=new Date(this.value);var t=true;if(this.min){var n=new Date(this.min);t=t&&e>=n}if(this.max){var i=new Date(this.max);t=t&&e<=i}return t};Object.defineProperty(t.prototype,"value",{get:function(){return this._dateInputElement?this._dateInputElement.value:undefined},enumerable:false,configurable:true});t.valueProperty=new nt.StringProperty(nt.Versions.v1_0,"value");t.placeholderProperty=new nt.StringProperty(nt.Versions.v1_0,"placeholder");t.minProperty=new nt.StringProperty(nt.Versions.v1_0,"min");t.maxProperty=new nt.StringProperty(nt.Versions.v1_0,"max");Xe([nt.property(t.valueProperty)],t.prototype,"defaultValue",void 0);Xe([nt.property(t.minProperty)],t.prototype,"min",void 0);Xe([nt.property(t.maxProperty)],t.prototype,"max",void 0);Xe([nt.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);return t}(bt);fe.DateInput=wt;var Et=function(e){Ke(t,e);function t(t,n){var i=e.call(this,t,n,function(e,t,n,i){var r=n[t.name];if(typeof r==="string"&&r&&/^[0-9]{2}:[0-9]{2}$/.test(r)){return r}return undefined},function(e,t,n,i,r){r.serializeValue(n,t.name,i)})||this;i.targetVersion=t;i.name=n;return i}return t}(nt.CustomProperty);fe.TimeProperty=Et;var xt=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.convertTimeStringToDate=function(e){return new Date("1973-09-04T"+e+":00Z")};t.prototype.internalRender=function(){var e=this;this._timeInputElement=document.createElement("input");this._timeInputElement.setAttribute("type","time");this._timeInputElement.setAttribute("min",this.min);this._timeInputElement.setAttribute("max",this.max);this._timeInputElement.className=this.hostConfig.makeCssClassName("ac-input","ac-timeInput");this._timeInputElement.style.width="100%";this._timeInputElement.oninput=function(){e.valueChanged()};if(this.placeholder){this._timeInputElement.placeholder=this.placeholder;this._timeInputElement.setAttribute("aria-label",this.placeholder)}if(this.defaultValue){this._timeInputElement.value=this.defaultValue}return this._timeInputElement};t.prototype.getJsonTypeName=function(){return"Input.Time"};t.prototype.isSet=function(){return this.value?true:false};t.prototype.isValid=function(){if(!this.value){return!this.isRequired}var e=t.convertTimeStringToDate(this.value);var n=true;if(this.min){var i=t.convertTimeStringToDate(this.min);n=n&&e>=i}if(this.max){var r=t.convertTimeStringToDate(this.max);n=n&&e<=r}return n};Object.defineProperty(t.prototype,"value",{get:function(){return this._timeInputElement?this._timeInputElement.value:undefined},enumerable:false,configurable:true});t.valueProperty=new Et(nt.Versions.v1_0,"value");t.placeholderProperty=new nt.StringProperty(nt.Versions.v1_0,"placeholder");t.minProperty=new Et(nt.Versions.v1_0,"min");t.maxProperty=new Et(nt.Versions.v1_0,"max");Xe([nt.property(t.valueProperty)],t.prototype,"defaultValue",void 0);Xe([nt.property(t.minProperty)],t.prototype,"min",void 0);Xe([nt.property(t.maxProperty)],t.prototype,"max",void 0);Xe([nt.property(t.placeholderProperty)],t.prototype,"placeholder",void 0);return t}(bt);fe.TimeInput=xt;var It=function(){function e(e,t){this._state=0;this.action=e;this._parentContainerStyle=t}e.prototype.updateCssStyle=function(){var e,t;if(this.action.parent&&this.action.renderedElement){var n=this.action.parent.hostConfig;this.action.renderedElement.className=n.makeCssClassName("ac-pushButton");if(this._parentContainerStyle){this.action.renderedElement.classList.add("style-"+this._parentContainerStyle)}this.action.updateActionButtonCssStyle(this.action.renderedElement,this._state);this.action.renderedElement.classList.remove(n.makeCssClassName("expanded"));this.action.renderedElement.classList.remove(n.makeCssClassName("subdued"));switch(this._state){case 1:this.action.renderedElement.classList.add(n.makeCssClassName("expanded"));break;case 2:this.action.renderedElement.classList.add(n.makeCssClassName("subdued"));break}if(this.action.style){if(this.action.style===Ye.ActionStyle.Positive){(e=this.action.renderedElement.classList).add.apply(e,n.makeCssClassNames("primary","style-positive"))}else{(t=this.action.renderedElement.classList).add.apply(t,n.makeCssClassNames("style-"+this.action.style.toLowerCase()))}}}};e.prototype.render=function(){var e=this;this.action.render();if(this.action.renderedElement){this.action.renderedElement.onclick=function(t){t.preventDefault();t.cancelBubble=true;e.click()};this.updateCssStyle()}};e.prototype.click=function(){if(this.onClick!==undefined){this.onClick(this)}};Object.defineProperty(e.prototype,"state",{get:function(){return this._state},set:function(e){this._state=e;this.updateCssStyle()},enumerable:false,configurable:true});return e}();var Tt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.style=Ye.ActionStyle.Default;return t}t.prototype.getDefaultSerializationContext=function(){return new ln};t.prototype.addCssClasses=function(e){};t.prototype.internalGetReferencedInputs=function(){return{}};t.prototype.internalPrepareForExecution=function(e){};t.prototype.internalValidateInputs=function(e){var t=[];if(e){for(var n=0,i=Object.keys(e);n<i.length;n++){var r=i[n];var o=e[r];if(!o.validateValue()){t.push(o)}}}return t};t.prototype.shouldSerialize=function(e){return e.actionRegistry.findByName(this.getJsonTypeName())!==undefined};t.prototype.raiseExecuteActionEvent=function(){if(this.onExecute){this.onExecute(this)}Kt(this)};t.prototype.getHref=function(){return""};t.prototype.getAriaRole=function(){return"button"};t.prototype.updateActionButtonCssStyle=function(e,t){};t.prototype.parse=function(t,n){return e.prototype.parse.call(this,t,n?n:new ln)};t.prototype.render=function(e){var t=this.hostConfig;var n=document.createElement("button");this.addCssClasses(n);if(this.accessibleTitle){n.setAttribute("aria-label",this.accessibleTitle)}else if(this.title){n.setAttribute("aria-label",this.title)}if(this.expanded!=undefined){n.setAttribute("aria-expanded",this.expanded.toString())}n.type="button";n.style.display="flex";n.style.alignItems="center";n.style.justifyContent="center";n.setAttribute("role",this.getAriaRole());var i=document.createElement("div");i.style.overflow="hidden";i.style.textOverflow="ellipsis";if(!(t.actions.iconPlacement==Ye.ActionIconPlacement.AboveTitle||t.actions.allowTitleToWrap)){i.style.whiteSpace="nowrap"}if(this.title){i.innerText=this.title}if(!this.iconUrl){n.classList.add("noIcon");n.appendChild(i)}else{var r=document.createElement("img");r.src=this.iconUrl;r.style.width=t.actions.iconSize+"px";r.style.height=t.actions.iconSize+"px";r.style.flex="0 0 auto";if(t.actions.iconPlacement==Ye.ActionIconPlacement.AboveTitle){n.classList.add("iconAbove");n.style.flexDirection="column";if(this.title){r.style.marginBottom="6px"}}else{n.classList.add("iconLeft");r.style.maxHeight="100%";if(this.title){r.style.marginRight="6px"}}n.appendChild(r);n.appendChild(i)}this._renderedElement=n};t.prototype.execute=function(){if(this._actionCollection){this._actionCollection.actionExecuted(this)}this.raiseExecuteActionEvent()};t.prototype.prepareForExecution=function(){var e=this.getReferencedInputs();var t=this.internalValidateInputs(e);if(t.length>0){t[0].focus();return false}this.internalPrepareForExecution(e);return true};t.prototype.remove=function(){if(this._actionCollection){return this._actionCollection.removeAction(this)}return false};t.prototype.getAllInputs=function(e){return[]};t.prototype.getResourceInformation=function(){return this.iconUrl?[{url:this.iconUrl,mimeType:"image"}]:[]};t.prototype.getActionById=function(e){return this.id===e?this:undefined};t.prototype.getReferencedInputs=function(){return this.internalGetReferencedInputs()};t.prototype.validateInputs=function(){return this.internalValidateInputs(this.getReferencedInputs())};Object.defineProperty(t.prototype,"isPrimary",{get:function(){return this.style==Ye.ActionStyle.Positive},set:function(e){if(e){this.style=Ye.ActionStyle.Positive}else{if(this.style==Ye.ActionStyle.Positive){this.style=Ye.ActionStyle.Default}}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hostConfig",{get:function(){return this.parent?this.parent.hostConfig:Qe.defaultHostConfig},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:false,configurable:true});t.titleProperty=new nt.StringProperty(nt.Versions.v1_0,"title");t.iconUrlProperty=new nt.StringProperty(nt.Versions.v1_1,"iconUrl");t.styleProperty=new nt.ValueSetProperty(nt.Versions.v1_2,"style",[{value:Ye.ActionStyle.Default},{value:Ye.ActionStyle.Positive},{value:Ye.ActionStyle.Destructive}],Ye.ActionStyle.Default);Xe([nt.property(t.titleProperty)],t.prototype,"title",void 0);Xe([nt.property(t.iconUrlProperty)],t.prototype,"iconUrl",void 0);Xe([nt.property(t.styleProperty)],t.prototype,"style",void 0);return t}(tt.CardObject);fe.Action=Tt;var Vt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._isPrepared=false;return t}t.prototype.internalGetReferencedInputs=function(){var e={};if(this.associatedInputs!=="none"){var t=this.parent;var n=[];while(t){n=n.concat(t.getAllInputs(false));t=t.parent}for(var i=0,r=n;i<r.length;i++){var o=r[i];if(o.id){e[o.id]=o}}}return e};t.prototype.internalPrepareForExecution=function(e){if(this._originalData){this._processedData=JSON.parse(JSON.stringify(this._originalData))}else{this._processedData={}}if(this._processedData&&e){for(var t=0,n=Object.keys(e);t<n.length;t++){var i=n[t];var r=e[i];if(r.id&&r.isSet()){this._processedData[r.id]=typeof r.value==="string"?r.value:r.value.toString()}}}this._isPrepared=true};Object.defineProperty(t.prototype,"data",{get:function(){return this._isPrepared?this._processedData:this._originalData},set:function(e){this._originalData=e;this._isPrepared=false},enumerable:false,configurable:true});t.dataProperty=new nt.PropertyDefinition(nt.Versions.v1_0,"data");t.associatedInputsProperty=new nt.CustomProperty(nt.Versions.v1_3,"associatedInputs",function(e,t,n,i){var r=n[t.name];if(r!==undefined&&typeof r==="string"){return r.toLowerCase()==="none"?"none":"auto"}return undefined},function(e,t,n,i,r){r.serializeValue(n,t.name,i)});Xe([nt.property(t.dataProperty)],t.prototype,"_originalData",void 0);Xe([nt.property(t.associatedInputsProperty)],t.prototype,"associatedInputs",void 0);return t}(Tt);fe.SubmitActionBase=Vt;var Ot=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.JsonTypeName="Action.Submit";return t}(Vt);fe.SubmitAction=Ot;var kt=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.JsonTypeName="Action.Execute";t.verbProperty=new nt.StringProperty(nt.Versions.v1_4,"verb");Xe([nt.property(t.verbProperty)],t.prototype,"verb",void 0);return t}(Vt);fe.ExecuteAction=kt;var Nt=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.prototype.getAriaRole=function(){return"link"};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(!this.url){t.addFailure(this,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.propertyMustBeSet("url"))}};t.prototype.getHref=function(){return this.url};t.urlProperty=new nt.StringProperty(nt.Versions.v1_0,"url");t.JsonTypeName="Action.OpenUrl";Xe([nt.property(t.urlProperty)],t.prototype,"url",void 0);return t}(Tt);fe.OpenUrlAction=Nt;var zt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.targetElements={};return t}t.prototype.updateAriaControlsAttribute=function(){if(this.targetElements){var e=Object.keys(this.targetElements);if(this._renderedElement){if(e.length>0){this._renderedElement.setAttribute("aria-controls",e.join(" "))}else{this._renderedElement.removeAttribute("aria-controls")}}}};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(!this.targetElements){t.addFailure(this,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.propertyMustBeSet("targetElements"))}};t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.prototype.render=function(t){if(t===void 0){t="ac-pushButton"}e.prototype.render.call(this,t);this.updateAriaControlsAttribute()};t.prototype.execute=function(){if(this.parent){for(var e=0,t=Object.keys(this.targetElements);e<t.length;e++){var n=t[e];var i=this.parent.getRootElement().getElementById(n);if(i){if(typeof this.targetElements[n]==="boolean"){i.isVisible=this.targetElements[n]}else{i.isVisible=!i.isVisible}}}}};t.prototype.addTargetElement=function(e,t){if(t===void 0){t=undefined}this.targetElements[e]=t;this.updateAriaControlsAttribute()};t.prototype.removeTargetElement=function(e){delete this.targetElements[e];this.updateAriaControlsAttribute()};t.targetElementsProperty=new nt.CustomProperty(nt.Versions.v1_2,"targetElements",function(e,t,n,i){var r={};if(Array.isArray(n[t.name])){for(var o=0,a=n[t.name];o<a.length;o++){var s=a[o];if(typeof s==="string"){r[s]=undefined}else if(typeof s==="object"){var l=s["elementId"];if(typeof l==="string"){r[l]=Ze.parseBool(s["isVisible"])}}}}return r},function(e,t,n,i,r){var o=[];for(var a=0,s=Object.keys(i);a<s.length;a++){var l=s[a];if(typeof i[l]==="boolean"){o.push({elementId:l,isVisible:i[l]})}else{o.push(l)}}r.serializeArray(n,t.name,o)},{},function(e){return{}});t.JsonTypeName="Action.ToggleVisibility";Xe([nt.property(t.targetElementsProperty)],t.prototype,"targetElements",void 0);return t}(Tt);fe.ToggleVisibilityAction=zt;var Rt=function(e){Ke(t,e);function t(t,n){var i=e.call(this,t,n,undefined,function(){return new $e.StringWithSubstitutions})||this;i.targetVersion=t;i.name=n;return i}t.prototype.parse=function(e,t,n){var i=new $e.StringWithSubstitutions;i.set(Ze.parseString(t[this.name]));return i};t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n.getOriginal())};return t}(nt.PropertyDefinition);var Lt=function(e){Ke(t,e);function t(t,n){if(t===void 0){t=""}if(n===void 0){n=""}var i=e.call(this)||this;i.name=t;i.value=n;return i}t.prototype.getSchemaKey=function(){return"HttpHeader"};t.prototype.getReferencedInputs=function(e,t){this._value.getReferencedInputs(e,t)};t.prototype.prepareForExecution=function(e){this._value.substituteInputValues(e,$e.ContentTypes.applicationXWwwFormUrlencoded)};Object.defineProperty(t.prototype,"value",{get:function(){return this._value.get()},set:function(e){this._value.set(e)},enumerable:false,configurable:true});t.nameProperty=new nt.StringProperty(nt.Versions.v1_0,"name");t.valueProperty=new Rt(nt.Versions.v1_0,"value");Xe([nt.property(t.nameProperty)],t.prototype,"name",void 0);Xe([nt.property(t.valueProperty)],t.prototype,"_value",void 0);return t}(nt.SerializableObject);fe.HttpHeader=Lt;var Bt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._ignoreInputValidation=false;return t}t.prototype.internalGetReferencedInputs=function(){var e=this.parent?this.parent.getRootElement().getAllInputs():[];var t={};this._url.getReferencedInputs(e,t);for(var n=0,i=this.headers;n<i.length;n++){var r=i[n];r.getReferencedInputs(e,t)}this._body.getReferencedInputs(e,t);return t};t.prototype.internalPrepareForExecution=function(e){if(e){this._url.substituteInputValues(e,$e.ContentTypes.applicationXWwwFormUrlencoded);var t=$e.ContentTypes.applicationJson;for(var n=0,i=this.headers;n<i.length;n++){var r=i[n];r.prepareForExecution(e);if(r.name&&r.name.toLowerCase()=="content-type"){t=r.value}}this._body.substituteInputValues(e,t)}};t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(!this.url){t.addFailure(this,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.propertyMustBeSet("url"))}if(this.headers.length>0){for(var n=0,i=this.headers;n<i.length;n++){var r=i[n];if(!r.name){t.addFailure(this,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.actionHttpHeadersMustHaveNameAndValue())}}}};Object.defineProperty(t.prototype,"ignoreInputValidation",{get:function(){return this._ignoreInputValidation},set:function(e){this._ignoreInputValidation=e},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"url",{get:function(){return this._url.get()},set:function(e){this._url.set(e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"body",{get:function(){return this._body.get()},set:function(e){this._body.set(e)},enumerable:false,configurable:true});t.urlProperty=new Rt(nt.Versions.v1_0,"url");t.bodyProperty=new Rt(nt.Versions.v1_0,"body");t.methodProperty=new nt.StringProperty(nt.Versions.v1_0,"method");t.headersProperty=new nt.SerializableObjectCollectionProperty(nt.Versions.v1_0,"headers",Lt);t.ignoreInputValidationProperty=new nt.BoolProperty(nt.Versions.v1_3,"ignoreInputValidation",false);t.JsonTypeName="Action.Http";Xe([nt.property(t.urlProperty)],t.prototype,"_url",void 0);Xe([nt.property(t.bodyProperty)],t.prototype,"_body",void 0);Xe([nt.property(t.methodProperty)],t.prototype,"method",void 0);Xe([nt.property(t.headersProperty)],t.prototype,"headers",void 0);Xe([nt.property(t.ignoreInputValidationProperty)],t.prototype,"_ignoreInputValidation",void 0);return t}(Tt);fe.HttpAction=Bt;var Dt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.card=new an;return t}t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);var i=t["card"];if(i){this.card.parse(i,n)}else{n.logParseEvent(this,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.showCardMustHaveCard())}};t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);if(this.card){n.serializeValue(t,"card",this.card.toJSON(n))}};t.prototype.addCssClasses=function(t){e.prototype.addCssClasses.call(this,t);if(this.parent){t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"))}};t.prototype.raiseExecuteActionEvent=function(){if(this.hostConfig.actions.showCard.actionMode===Ye.ShowCardActionMode.Popup){e.prototype.raiseExecuteActionEvent.call(this)}};t.prototype.getJsonTypeName=function(){return t.JsonTypeName};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);this.card.internalValidateProperties(t)};t.prototype.updateActionButtonCssStyle=function(t,n){if(n===void 0){n=0}e.prototype.updateActionButtonCssStyle.call(this,t);if(this.parent){t.classList.add(this.parent.hostConfig.makeCssClassName("expandable"));t.setAttribute("aria-expanded",(n===1).toString())}};t.prototype.setParent=function(t){e.prototype.setParent.call(this,t);this.card.setParent(t)};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}return this.card.getAllInputs(e)};t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this.card.getResourceInformation())};t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n){n=this.card.getActionById(t)}return n};t.JsonTypeName="Action.ShowCard";return t}(Tt);fe.ShowCardAction=Dt;var Mt=function(){function e(e){this._renderedActionCount=0;this.items=[];this.buttons=[];this._owner=e}e.prototype.isActionAllowed=function(e){var t=this._owner.getForbiddenActionTypes();if(t){for(var n=0,i=t;n<i.length;n++){var r=i[n];if(e.constructor===r){return false}}}return true};e.prototype.refreshContainer=function(){this._actionCardContainer.innerHTML="";if(!this._actionCard){this._actionCardContainer.style.marginTop="0px";return}this._actionCardContainer.style.marginTop=this._renderedActionCount>0?this._owner.hostConfig.actions.showCard.inlineTopMargin+"px":"0px";var e=this._owner.getEffectivePadding();this._owner.getImmediateSurroundingPadding(e);var t=this._owner.hostConfig.paddingDefinitionToSpacingDefinition(e);if(this._actionCard){this._actionCard.style.paddingLeft=t.left+"px";this._actionCard.style.paddingRight=t.right+"px";this._actionCard.style.marginLeft="-"+t.left+"px";this._actionCard.style.marginRight="-"+t.right+"px";if(t.bottom!=0&&!this._owner.isDesignMode()){this._actionCard.style.paddingBottom=t.bottom+"px";this._actionCard.style.marginBottom="-"+t.bottom+"px"}Ze.appendChild(this._actionCardContainer,this._actionCard)}};e.prototype.layoutChanged=function(){this._owner.getRootElement().updateLayout()};e.prototype.showActionCard=function(e,t,n){if(t===void 0){t=false}if(n===void 0){n=true}e.card.suppressStyle=t;var i=e.card.renderedElement&&!this._owner.isDesignMode()?e.card.renderedElement:e.card.render();this._actionCard=i;this._expandedAction=e;this.refreshContainer();if(n){this.layoutChanged();Xt(e,true)}};e.prototype.collapseExpandedAction=function(){for(var e=0,t=this.buttons;e<t.length;e++){var n=t[e];n.state=0}var i=this._expandedAction;this._expandedAction=undefined;this._actionCard=undefined;this.refreshContainer();if(i){this.layoutChanged();Xt(i,false)}};e.prototype.expandShowCardAction=function(e,t){for(var n=0,i=this.buttons;n<i.length;n++){var r=i[n];if(r.action!==e){r.state=2}else{r.state=1}}this.showActionCard(e,!(this._owner.isAtTheVeryLeft()&&this._owner.isAtTheVeryRight()),t)};e.prototype.getParentContainer=function(){if(this._owner instanceof Wt){return this._owner}else{return this._owner.getParentContainer()}};e.prototype.findActionButton=function(e){for(var t=0,n=this.buttons;t<n.length;t++){var i=n[t];if(i.action==e){return i}}return undefined};e.prototype.actionExecuted=function(e){if(!(e instanceof Dt)){this.collapseExpandedAction()}else{if(e===this._expandedAction){this.collapseExpandedAction()}else{this.expandShowCardAction(e,true)}}};e.prototype.parse=function(e,t){this.clear();if(Array.isArray(e)){for(var n=0,i=e;n<i.length;n++){var r=i[n];var o=t.parseAction(this._owner,r,[],!this._owner.isDesignMode());if(o){this.addAction(o)}}}};e.prototype.toJSON=function(e,t,n){n.serializeArray(e,t,this.items)};e.prototype.getActionById=function(e){var t=undefined;for(var n=0,i=this.items;n<i.length;n++){var r=i[n];t=r.getActionById(e);if(t){break}}return t};e.prototype.validateProperties=function(e){if(this._owner.hostConfig.actions.maxActions&&this.items.length>this._owner.hostConfig.actions.maxActions){e.addFailure(this._owner,Ye.ValidationEvent.TooManyActions,rt.Strings.errors.tooManyActions(this._owner.hostConfig.actions.maxActions))}if(this.items.length>0&&!this._owner.hostConfig.supportsInteractivity){e.addFailure(this._owner,Ye.ValidationEvent.InteractivityNotAllowed,rt.Strings.errors.interactivityNotAllowed())}for(var t=0,n=this.items;t<n.length;t++){var i=n[t];if(!this.isActionAllowed(i)){e.addFailure(this._owner,Ye.ValidationEvent.ActionTypeNotAllowed,rt.Strings.errors.actionTypeNotAllowed(i.getJsonTypeName()))}i.internalValidateProperties(e)}};e.prototype.render=function(e,t){var n=this._owner.hostConfig;if(!n.supportsInteractivity){return undefined}var i=document.createElement("div");var r=n.actions.maxActions?Math.min(n.actions.maxActions,this.items.length):this.items.length;this._actionCardContainer=document.createElement("div");this._renderedActionCount=0;if(n.actions.preExpandSingleShowCardAction&&r==1&&this.items[0]instanceof Dt&&this.isActionAllowed(this.items[0])){this.showActionCard(this.items[0],true);this._renderedActionCount=1}else{var o=document.createElement("div");o.className=n.makeCssClassName("ac-actionSet");o.style.display="flex";o.setAttribute("role","menubar");if(e==Ye.Orientation.Horizontal){o.style.flexDirection="row";if(this._owner.horizontalAlignment&&n.actions.actionAlignment!=Ye.ActionAlignment.Stretch){switch(this._owner.horizontalAlignment){case Ye.HorizontalAlignment.Center:o.style.justifyContent="center";break;case Ye.HorizontalAlignment.Right:o.style.justifyContent="flex-end";break;default:o.style.justifyContent="flex-start";break}}else{switch(n.actions.actionAlignment){case Ye.ActionAlignment.Center:o.style.justifyContent="center";break;case Ye.ActionAlignment.Right:o.style.justifyContent="flex-end";break;default:o.style.justifyContent="flex-start";break}}}else{o.style.flexDirection="column";if(this._owner.horizontalAlignment&&n.actions.actionAlignment!=Ye.ActionAlignment.Stretch){switch(this._owner.horizontalAlignment){case Ye.HorizontalAlignment.Center:o.style.alignItems="center";break;case Ye.HorizontalAlignment.Right:o.style.alignItems="flex-end";break;default:o.style.alignItems="flex-start";break}}else{switch(n.actions.actionAlignment){case Ye.ActionAlignment.Center:o.style.alignItems="center";break;case Ye.ActionAlignment.Right:o.style.alignItems="flex-end";break;case Ye.ActionAlignment.Stretch:o.style.alignItems="stretch";break;default:o.style.alignItems="flex-start";break}}}var a=this.getParentContainer();if(a){var s=a.getEffectiveStyle();var l=this.items.filter(this.isActionAllowed.bind(this));for(var u=0;u<l.length;u++){var p=this.findActionButton(l[u]);if(!p){p=new It(l[u],s);p.onClick=function(e){e.action.execute()};this.buttons.push(p)}p.render();if(p.action.renderedElement){if(l.length>1){p.action.renderedElement.setAttribute("aria-posinset",(u+1).toString());p.action.renderedElement.setAttribute("aria-setsize",l.length.toString());p.action.renderedElement.setAttribute("role","menuitem")}if(n.actions.actionsOrientation==Ye.Orientation.Horizontal&&n.actions.actionAlignment==Ye.ActionAlignment.Stretch){p.action.renderedElement.style.flex="0 1 100%"}else{p.action.renderedElement.style.flex="0 1 auto"}o.appendChild(p.action.renderedElement);this._renderedActionCount++;if(this._renderedActionCount>=n.actions.maxActions||u==this.items.length-1){break}else if(n.actions.buttonSpacing>0){var c=document.createElement("div");if(e===Ye.Orientation.Horizontal){c.style.flex="0 0 auto";c.style.width=n.actions.buttonSpacing+"px"}else{c.style.height=n.actions.buttonSpacing+"px"}Ze.appendChild(o,c)}}}}var d=document.createElement("div");d.style.overflow="hidden";d.appendChild(o);Ze.appendChild(i,d)}Ze.appendChild(i,this._actionCardContainer);for(var f=0,h=this.buttons;f<h.length;f++){var y=h[f];if(y.state==1){this.expandShowCardAction(y.action,false);break}}return this._renderedActionCount>0?i:undefined};e.prototype.addAction=function(e){if(!e){throw new Error("The action parameter cannot be null.")}if((!e.parent||e.parent===this._owner)&&this.items.indexOf(e)<0){this.items.push(e);if(!e.parent){e.setParent(this._owner)}e["_actionCollection"]=this}else{throw new Error(rt.Strings.errors.actionAlreadyParented())}};e.prototype.removeAction=function(e){if(this.expandedAction&&this._expandedAction==e){this.collapseExpandedAction()}var t=this.items.indexOf(e);if(t>=0){this.items.splice(t,1);e.setParent(undefined);e["_actionCollection"]=undefined;for(var n=0;n<this.buttons.length;n++){if(this.buttons[n].action==e){this.buttons.splice(n,1);break}}return true}return false};e.prototype.clear=function(){this.items=[];this.buttons=[];this._expandedAction=undefined;this._renderedActionCount=0};e.prototype.getAllInputs=function(e){if(e===void 0){e=true}var t=[];if(e){for(var n=0,i=this.items;n<i.length;n++){var r=i[n];t=t.concat(r.getAllInputs())}}return t};e.prototype.getResourceInformation=function(){var e=[];for(var t=0,n=this.items;t<n.length;t++){var i=n[t];e=e.concat(i.getResourceInformation())}return e};Object.defineProperty(e.prototype,"renderedActionCount",{get:function(){return this._renderedActionCount},enumerable:false,configurable:true});Object.defineProperty(e.prototype,"expandedAction",{get:function(){return this._expandedAction},enumerable:false,configurable:true});return e}();var jt=function(e){Ke(t,e);function t(){var t=e.call(this)||this;t._actionCollection=new Mt(t);return t}t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);this._actionCollection.parse(t["actions"],n)};t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);this._actionCollection.toJSON(t,"actions",n)};t.prototype.internalRender=function(){return this._actionCollection.render(this.orientation!==undefined?this.orientation:this.hostConfig.actions.actionsOrientation,this.isDesignMode())};t.prototype.isBleedingAtBottom=function(){if(this._actionCollection.renderedActionCount==0){return e.prototype.isBleedingAtBottom.call(this)}else{if(this._actionCollection.items.length==1){return this._actionCollection.expandedAction!==undefined&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!==undefined}}};t.prototype.getJsonTypeName=function(){return"ActionSet"};t.prototype.getActionCount=function(){return this._actionCollection.items.length};t.prototype.getActionAt=function(t){if(t>=0&&t<this.getActionCount()){return this._actionCollection.items[t]}else{return e.prototype.getActionAt.call(this,t)}};t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n?n:e.prototype.getActionById.call(this,t)};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);this._actionCollection.validateProperties(t)};t.prototype.addAction=function(e){this._actionCollection.addAction(e)};t.prototype.getAllInputs=function(e){if(e===void 0){e=true}return e?this._actionCollection.getAllInputs():[]};t.prototype.getResourceInformation=function(){return this._actionCollection.getResourceInformation()};t.prototype.findDOMNodeOwner=function(t){var n=undefined;for(var i=0,r=this._actionCollection.items;i<r.length;i++){var o=r[i];n=o.findDOMNodeOwner(t);if(n){return n}}return e.prototype.findDOMNodeOwner.call(this,t)};Object.defineProperty(t.prototype,"isInteractive",{get:function(){return true},enumerable:false,configurable:true});t.orientationProperty=new nt.EnumProperty(nt.Versions.v1_1,"orientation",Ye.Orientation);Xe([nt.property(t.orientationProperty)],t.prototype,"orientation",void 0);return t}(ot);fe.ActionSet=jt;var Ft=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._bleed=false;return t}Object.defineProperty(t.prototype,"style",{get:function(){if(this.allowCustomStyle){var e=this.getValue(t.styleProperty);if(e&&this.hostConfig.containerStyles.getStyleByName(e)){return e}}return undefined},set:function(e){this.setValue(t.styleProperty,e)},enumerable:false,configurable:true});t.prototype.adjustRenderedElementSize=function(t){e.prototype.adjustRenderedElementSize.call(this,t);if(this.minPixelHeight){t.style.minHeight=this.minPixelHeight+"px"}};t.prototype.applyBackground=function(){if(this.renderedElement){var e=this.hostConfig.containerStyles.getStyleByName(this.style,this.hostConfig.containerStyles.getStyleByName(this.defaultStyle));if(e.backgroundColor){var t=Ze.stringToCssColor(e.backgroundColor);this.renderedElement.style.backgroundColor=t;this.renderedElement.style.border="1px solid "+t}}};t.prototype.applyPadding=function(){e.prototype.applyPadding.call(this);if(!this.renderedElement){return}var t=new $e.SpacingDefinition;if(this.getEffectivePadding()){t=this.hostConfig.paddingDefinitionToSpacingDefinition(this.getEffectivePadding())}this.renderedElement.style.paddingTop=t.top+"px";this.renderedElement.style.paddingRight=t.right+"px";this.renderedElement.style.paddingBottom=t.bottom+"px";this.renderedElement.style.paddingLeft=t.left+"px";if(this.isBleeding()){var n=new $e.PaddingDefinition;this.getImmediateSurroundingPadding(n);var i=this.hostConfig.paddingDefinitionToSpacingDefinition(n);this.renderedElement.style.marginRight="-"+i.right+"px";this.renderedElement.style.marginLeft="-"+i.left+"px";if(!this.isDesignMode()){this.renderedElement.style.marginTop="-"+i.top+"px";this.renderedElement.style.marginBottom="-"+i.bottom+"px"}if(this.separatorElement&&this.separatorOrientation==Ye.Orientation.Horizontal){this.separatorElement.style.marginLeft="-"+i.left+"px";this.separatorElement.style.marginRight="-"+i.right+"px"}}else{this.renderedElement.style.marginRight="0";this.renderedElement.style.marginLeft="0";this.renderedElement.style.marginTop="0";this.renderedElement.style.marginBottom="0";if(this.separatorElement&&this.separatorOrientation===Ye.Orientation.Horizontal){this.separatorElement.style.marginRight="0";this.separatorElement.style.marginLeft="0"}}};t.prototype.getHasBackground=function(){var e=this.parent;while(e){var n=e instanceof Wt?e.backgroundImage.isValid():false;if(e instanceof t){if(this.hasExplicitStyle&&(e.getEffectiveStyle()!=this.getEffectiveStyle()||n)){return true}}e=e.parent}return false};t.prototype.getDefaultPadding=function(){return this.getHasBackground()?new $e.PaddingDefinition(Ye.Spacing.Padding,Ye.Spacing.Padding,Ye.Spacing.Padding,Ye.Spacing.Padding):e.prototype.getDefaultPadding.call(this)};t.prototype.getHasExpandedAction=function(){return false};t.prototype.getBleed=function(){return this._bleed};t.prototype.setBleed=function(e){this._bleed=e};Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return 0},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hasExplicitStyle",{get:function(){return this.getValue(t.styleProperty)!==undefined},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return true},enumerable:false,configurable:true});t.prototype.isBleeding=function(){return(this.getHasBackground()||this.hostConfig.alwaysAllowBleed)&&this.getBleed()};t.prototype.internalValidateProperties=function(n){e.prototype.internalValidateProperties.call(this,n);var i=this.getValue(t.styleProperty);if(i!==undefined){var r=this.hostConfig.containerStyles.getStyleByName(i);if(!r){n.addFailure(this,Ye.ValidationEvent.InvalidPropertyValue,rt.Strings.errors.invalidPropertyValue(i,"style"))}}};t.prototype.render=function(){var t=e.prototype.render.call(this);if(t&&this.getHasBackground()){this.applyBackground()}return t};t.prototype.getEffectiveStyle=function(){var t=this.style;return t?t:e.prototype.getEffectiveStyle.call(this)};t.styleProperty=new nt.ValueSetProperty(nt.Versions.v1_0,"style",[{value:Ye.ContainerStyle.Default},{value:Ye.ContainerStyle.Emphasis},{targetVersion:nt.Versions.v1_2,value:Ye.ContainerStyle.Accent},{targetVersion:nt.Versions.v1_2,value:Ye.ContainerStyle.Good},{targetVersion:nt.Versions.v1_2,value:Ye.ContainerStyle.Attention},{targetVersion:nt.Versions.v1_2,value:Ye.ContainerStyle.Warning}]);t.bleedProperty=new nt.BoolProperty(nt.Versions.v1_2,"bleed",false);t.minHeightProperty=new nt.PixelSizeProperty(nt.Versions.v1_2,"minHeight");Xe([nt.property(t.styleProperty)],t.prototype,"style",null);Xe([nt.property(t.bleedProperty)],t.prototype,"_bleed",void 0);Xe([nt.property(t.minHeightProperty)],t.prototype,"minPixelHeight",void 0);return t}(yt);fe.StylableCardElementContainer=Ft;var Ht=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getSchemaKey=function(){return"BackgroundImage"};t.prototype.internalParse=function(t,n){if(typeof t==="string"){this.resetDefaultValues();this.url=t}else{return e.prototype.internalParse.call(this,t,n)}};t.prototype.apply=function(e){if(this.url&&e.renderedElement){e.renderedElement.style.backgroundImage="url('"+e.preProcessPropertyValue(t.urlProperty,this.url)+"')";switch(this.fillMode){case Ye.FillMode.Repeat:e.renderedElement.style.backgroundRepeat="repeat";break;case Ye.FillMode.RepeatHorizontally:e.renderedElement.style.backgroundRepeat="repeat-x";break;case Ye.FillMode.RepeatVertically:e.renderedElement.style.backgroundRepeat="repeat-y";break;case Ye.FillMode.Cover:default:e.renderedElement.style.backgroundRepeat="no-repeat";e.renderedElement.style.backgroundSize="cover";break}switch(this.horizontalAlignment){case Ye.HorizontalAlignment.Center:e.renderedElement.style.backgroundPositionX="center";break;case Ye.HorizontalAlignment.Right:e.renderedElement.style.backgroundPositionX="right";break}switch(this.verticalAlignment){case Ye.VerticalAlignment.Center:e.renderedElement.style.backgroundPositionY="center";break;case Ye.VerticalAlignment.Bottom:e.renderedElement.style.backgroundPositionY="bottom";break}}};t.prototype.isValid=function(){return this.url?true:false};t.urlProperty=new nt.StringProperty(nt.Versions.v1_0,"url");t.fillModeProperty=new nt.EnumProperty(nt.Versions.v1_2,"fillMode",Ye.FillMode,Ye.FillMode.Cover);t.horizontalAlignmentProperty=new nt.EnumProperty(nt.Versions.v1_2,"horizontalAlignment",Ye.HorizontalAlignment,Ye.HorizontalAlignment.Left);t.verticalAlignmentProperty=new nt.EnumProperty(nt.Versions.v1_2,"verticalAlignment",Ye.VerticalAlignment,Ye.VerticalAlignment.Top);Xe([nt.property(t.urlProperty)],t.prototype,"url",void 0);Xe([nt.property(t.fillModeProperty)],t.prototype,"fillMode",void 0);Xe([nt.property(t.horizontalAlignmentProperty)],t.prototype,"horizontalAlignment",void 0);Xe([nt.property(t.verticalAlignmentProperty)],t.prototype,"verticalAlignment",void 0);return t}(nt.SerializableObject);fe.BackgroundImage=Ht;var Wt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.verticalContentAlignment=Ye.VerticalAlignment.Top;t._items=[];t._renderedItems=[];return t}Object.defineProperty(t.prototype,"backgroundImage",{get:function(){return this.getValue(t.backgroundImageProperty)},enumerable:false,configurable:true});t.prototype.insertItemAt=function(e,t,n){if(!e.parent||n){if(e.isStandalone){if(t<0||t>=this._items.length){this._items.push(e)}else{this._items.splice(t,0,e)}e.setParent(this)}else{throw new Error(rt.Strings.errors.elementTypeNotStandalone(e.getJsonTypeName()))}}else{throw new Error(rt.Strings.errors.elementAlreadyParented())}};t.prototype.supportsExcplitiHeight=function(){return true};t.prototype.getItemsCollectionPropertyName=function(){return"items"};t.prototype.applyBackground=function(){if(this.backgroundImage.isValid()&&this.renderedElement){this.backgroundImage.apply(this)}e.prototype.applyBackground.call(this)};t.prototype.internalRender=function(){this._renderedItems=[];var e=this.hostConfig;var t=document.createElement("div");if(this.rtl!==undefined&&this.rtl){t.dir="rtl"}t.classList.add(e.makeCssClassName("ac-container"));t.style.display="flex";t.style.flexDirection="column";if($e.GlobalSettings.useAdvancedCardBottomTruncation){t.style.minHeight="-webkit-min-content"}switch(this.verticalContentAlignment){case Ye.VerticalAlignment.Center:t.style.justifyContent="center";break;case Ye.VerticalAlignment.Bottom:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start";break}if(this._items.length>0){for(var n=0,i=this._items;n<i.length;n++){var r=i[n];var o=this.isElementAllowed(r)?r.render():undefined;if(o){if(this._renderedItems.length>0&&r.separatorElement){r.separatorElement.style.flex="0 0 auto";Ze.appendChild(t,r.separatorElement)}Ze.appendChild(t,o);this._renderedItems.push(r)}}}else{if(this.isDesignMode()){var a=this.createPlaceholderElement();a.style.width="100%";a.style.height="100%";t.appendChild(a)}}return t};t.prototype.truncateOverflow=function(e){if(this.renderedElement){var t=this.renderedElement.offsetTop+e+1;var n=function(e){var i=e.renderedElement;if(i){switch(Ze.getFitStatus(i,t)){case Ye.ContainerFitStatus.FullyInContainer:var r=e["resetOverflow"]();if(r){n(e)}break;case Ye.ContainerFitStatus.Overflowing:var o=t-i.offsetTop;e["handleOverflow"](o);break;case Ye.ContainerFitStatus.FullyOutOfContainer:e["handleOverflow"](0);break}}};for(var i=0,r=this._items;i<r.length;i++){var o=r[i];n(o)}return true}return false};t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._items;e<t.length;e++){var n=t[e];n["resetOverflow"]()}};t.prototype.getHasBackground=function(){return this.backgroundImage.isValid()||e.prototype.getHasBackground.call(this)};t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);this.clear();this.setShouldFallback(false);var i=t[this.getItemsCollectionPropertyName()];if(Array.isArray(i)){for(var r=0,o=i;r<o.length;r++){var a=o[r];var s=n.parseElement(this,a,!this.isDesignMode());if(s){this.insertItemAt(s,-1,true)}}}};t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);n.serializeArray(t,this.getItemsCollectionPropertyName(),this._items)};Object.defineProperty(t.prototype,"isSelectable",{get:function(){return true},enumerable:false,configurable:true});t.prototype.getItemCount=function(){return this._items.length};t.prototype.getItemAt=function(e){return this._items[e]};t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0){for(var e=0,t=this._renderedItems;e<t.length;e++){var n=t[e];if(n.isVisible){return n}}}return undefined};t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedItems&&this._renderedItems.length>0){for(var e=this._renderedItems.length-1;e>=0;e--){if(this._renderedItems[e].isVisible){return this._renderedItems[e]}}}return undefined};t.prototype.getJsonTypeName=function(){return"Container"};t.prototype.isFirstElement=function(e){var t=this.isDesignMode();for(var n=0,i=this._items;n<i.length;n++){var r=i[n];if(r.isVisible||t){return r==e}}return false};t.prototype.isLastElement=function(e){var t=this.isDesignMode();for(var n=this._items.length-1;n>=0;n--){if(this._items[n].isVisible||t){return this._items[n]==e}}return false};t.prototype.isRtl=function(){if(this.rtl!==undefined){return this.rtl}else{var e=this.getParentContainer();return e?e.isRtl():false}};t.prototype.isBleedingAtTop=function(){var e=this.getFirstVisibleRenderedItem();return this.isBleeding()||(e?e.isBleedingAtTop():false)};t.prototype.isBleedingAtBottom=function(){var e=this.getLastVisibleRenderedItem();return this.isBleeding()||(e?e.isBleedingAtBottom()&&e.getEffectiveStyle()==this.getEffectiveStyle():false)};t.prototype.indexOf=function(e){return this._items.indexOf(e)};t.prototype.addItem=function(e){this.insertItemAt(e,-1,false)};t.prototype.insertItemBefore=function(e,t){this.insertItemAt(e,this._items.indexOf(t),false)};t.prototype.insertItemAfter=function(e,t){this.insertItemAt(e,this._items.indexOf(t)+1,false)};t.prototype.removeItem=function(e){var t=this._items.indexOf(e);if(t>=0){this._items.splice(t,1);e.setParent(undefined);this.updateLayout();return true}return false};t.prototype.clear=function(){this._items=[];this._renderedItems=[]};t.prototype.getResourceInformation=function(){var t=e.prototype.getResourceInformation.call(this);if(this.backgroundImage.isValid()){t.push({url:this.backgroundImage.url,mimeType:"image"})}return t};t.prototype.getActionById=function(t){var n=e.prototype.getActionById.call(this,t);if(!n){if(this.selectAction){n=this.selectAction.getActionById(t)}if(!n){for(var i=0,r=this._items;i<r.length;i++){var o=r[i];n=o.getActionById(t);if(n){break}}}}return n};Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:false,configurable:true});t.backgroundImageProperty=new nt.SerializableObjectProperty(nt.Versions.v1_0,"backgroundImage",Ht);t.verticalContentAlignmentProperty=new nt.EnumProperty(nt.Versions.v1_1,"verticalContentAlignment",Ye.VerticalAlignment,Ye.VerticalAlignment.Top);t.rtlProperty=new nt.BoolProperty(nt.Versions.v1_0,"rtl");Xe([nt.property(t.backgroundImageProperty)],t.prototype,"backgroundImage",null);Xe([nt.property(t.verticalContentAlignmentProperty)],t.prototype,"verticalContentAlignment",void 0);Xe([nt.property(t.rtlProperty)],t.prototype,"rtl",void 0);return t}(Ft);fe.Container=Wt;var Jt=function(e){Ke(t,e);function t(t){if(t===void 0){t="stretch"}var n=e.call(this)||this;n.width="stretch";n._computedWeight=0;n.width=t;return n}t.prototype.adjustRenderedElementSize=function(e){var t=20;if(this.isDesignMode()){e.style.minWidth="20px";e.style.minHeight=(!this.minPixelHeight?t:Math.max(this.minPixelHeight,t))+"px"}else{e.style.minWidth="0";if(this.minPixelHeight){e.style.minHeight=this.minPixelHeight+"px"}}if(this.width==="auto"){e.style.flex="0 1 auto"}else if(this.width==="stretch"){e.style.flex="1 1 50px"}else if(this.width instanceof $e.SizeAndUnit){if(this.width.unit==Ye.SizeUnit.Pixel){e.style.flex="0 0 auto";e.style.width=this.width.physicalSize+"px"}else{e.style.flex="1 1 "+(this._computedWeight>0?this._computedWeight:this.width.physicalSize)+"%"}}};t.prototype.shouldSerialize=function(e){return true};Object.defineProperty(t.prototype,"separatorOrientation",{get:function(){return Ye.Orientation.Vertical},enumerable:false,configurable:true});t.prototype.getJsonTypeName=function(){return"Column"};Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){if(this.parent&&this.parent instanceof qt){return this.separatorElement!==undefined&&!this.parent.isLeftMostElement(this)}else{return false}},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"isStandalone",{get:function(){return false},enumerable:false,configurable:true});t.widthProperty=new nt.CustomProperty(nt.Versions.v1_0,"width",function(e,t,n,i){var r=t.defaultValue;var o=n[t.name];var a=false;if(typeof o==="number"&&!isNaN(o)){r=new $e.SizeAndUnit(o,Ye.SizeUnit.Weight)}else if(o==="auto"||o==="stretch"){r=o}else if(typeof o==="string"){try{r=$e.SizeAndUnit.parse(o);if(r.unit===Ye.SizeUnit.Pixel&&t.targetVersion.compareTo(i.targetVersion)>0){a=true}}catch(e){a=true}}else{a=true}if(a){i.logParseEvent(e,Ye.ValidationEvent.InvalidPropertyValue,rt.Strings.errors.invalidColumnWidth(o));r="auto"}return r},function(e,t,n,i,r){if(i instanceof $e.SizeAndUnit){if(i.unit===Ye.SizeUnit.Pixel){r.serializeValue(n,"width",i.physicalSize+"px")}else{r.serializeNumber(n,"width",i.physicalSize)}}else{r.serializeValue(n,"width",i)}},"stretch");Xe([nt.property(t.widthProperty)],t.prototype,"width",void 0);return t}(Wt);fe.Column=Jt;var qt=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t._columns=[];return t}t.prototype.createColumnInstance=function(e,t){return t.parseCardObject(this,e,[],!this.isDesignMode(),function(e){return!e||e==="Column"?new Jt:undefined},function(e,n){t.logParseEvent(undefined,Ye.ValidationEvent.ElementTypeNotAllowed,rt.Strings.errors.elementTypeNotAllowed(e))})};t.prototype.internalRender=function(){this._renderedColumns=[];if(this._columns.length>0){var e=this.hostConfig;var t=document.createElement("div");t.className=e.makeCssClassName("ac-columnSet");t.style.display="flex";if($e.GlobalSettings.useAdvancedCardBottomTruncation){t.style.minHeight="-webkit-min-content"}switch(this.horizontalAlignment){case Ye.HorizontalAlignment.Center:t.style.justifyContent="center";break;case Ye.HorizontalAlignment.Right:t.style.justifyContent="flex-end";break;default:t.style.justifyContent="flex-start";break}var n=0;for(var i=0,r=this._columns;i<r.length;i++){var o=r[i];if(o.width instanceof $e.SizeAndUnit&&o.width.unit==Ye.SizeUnit.Weight){n+=o.width.physicalSize}}for(var a=0,s=this._columns;a<s.length;a++){var o=s[a];if(o.width instanceof $e.SizeAndUnit&&o.width.unit==Ye.SizeUnit.Weight&&n>0){var l=100/n*o.width.physicalSize;o["_computedWeight"]=l}var u=o.render();if(u){if(this._renderedColumns.length>0&&o.separatorElement){o.separatorElement.style.flex="0 0 auto";Ze.appendChild(t,o.separatorElement)}Ze.appendChild(t,u);this._renderedColumns.push(o)}}return this._renderedColumns.length>0?t:undefined}else{return undefined}};t.prototype.truncateOverflow=function(e){for(var t=0,n=this._columns;t<n.length;t++){var i=n[t];i["handleOverflow"](e)}return true};t.prototype.undoOverflowTruncation=function(){for(var e=0,t=this._columns;e<t.length;e++){var n=t[e];n["resetOverflow"]()}};Object.defineProperty(t.prototype,"isSelectable",{get:function(){return true},enumerable:false,configurable:true});t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);this._columns=[];this._renderedColumns=[];var i=t["columns"];if(Array.isArray(i)){for(var r=0,o=i;r<o.length;r++){var a=o[r];var s=this.createColumnInstance(a,n);if(s){this._columns.push(s)}}}};t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);n.serializeArray(t,"columns",this._columns)};t.prototype.isFirstElement=function(e){for(var t=0,n=this._columns;t<n.length;t++){var i=n[t];if(i.isVisible){return i==e}}return false};t.prototype.isBleedingAtTop=function(){if(this.isBleeding()){return true}if(this._renderedColumns&&this._renderedColumns.length>0){for(var e=0,t=this._columns;e<t.length;e++){var n=t[e];if(n.isBleedingAtTop()){return true}}}return false};t.prototype.isBleedingAtBottom=function(){if(this.isBleeding()){return true}if(this._renderedColumns&&this._renderedColumns.length>0){for(var e=0,t=this._columns;e<t.length;e++){var n=t[e];if(n.isBleedingAtBottom()){return true}}}return false};t.prototype.getItemCount=function(){return this._columns.length};t.prototype.getFirstVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0){return this._renderedColumns[0]}else{return undefined}};t.prototype.getLastVisibleRenderedItem=function(){if(this.renderedElement&&this._renderedColumns&&this._renderedColumns.length>0){return this._renderedColumns[this._renderedColumns.length-1]}else{return undefined}};t.prototype.getColumnAt=function(e){return this._columns[e]};t.prototype.getItemAt=function(e){return this.getColumnAt(e)};t.prototype.getJsonTypeName=function(){return"ColumnSet"};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);var n=0;var i=0;for(var r=0,o=this._columns;r<o.length;r++){var a=o[r];if(typeof a.width==="number"){n++}else if(a.width==="stretch"){i++}}if(n>0&&i>0){t.addFailure(this,Ye.ValidationEvent.Hint,rt.Strings.hints.dontUseWeightedAndStrecthedColumnsInSameSet())}};t.prototype.addColumn=function(e){if(!e.parent){this._columns.push(e);e.setParent(this)}else{throw new Error(rt.Strings.errors.columnAlreadyBelongsToAnotherSet())}};t.prototype.removeItem=function(e){if(e instanceof Jt){var t=this._columns.indexOf(e);if(t>=0){this._columns.splice(t,1);e.setParent(undefined);this.updateLayout();return true}}return false};t.prototype.indexOf=function(e){return e instanceof Jt?this._columns.indexOf(e):-1};t.prototype.isLeftMostElement=function(e){return this._columns.indexOf(e)==0};t.prototype.isRightMostElement=function(e){return this._columns.indexOf(e)==this._columns.length-1};t.prototype.isTopElement=function(e){return this._columns.indexOf(e)>=0};t.prototype.isBottomElement=function(e){return this._columns.indexOf(e)>=0};t.prototype.getActionById=function(e){var t=undefined;for(var n=0,i=this._columns;n<i.length;n++){var r=i[n];t=r.getActionById(e);if(t){break}}return t};Object.defineProperty(t.prototype,"bleed",{get:function(){return this.getBleed()},set:function(e){this.setBleed(e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"padding",{get:function(){return this.getPadding()},set:function(e){this.setPadding(e)},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"selectAction",{get:function(){return this._selectAction},set:function(e){this._selectAction=e},enumerable:false,configurable:true});return t}(Ft);fe.ColumnSet=qt;function Ut(e){var t=e.getRootElement();var n=t&&t.onImageLoaded?t.onImageLoaded:on.onImageLoaded;if(n){n(e)}}function Gt(e,t,n){var i=e.getRootElement();var r=i&&i.onAnchorClicked?i.onAnchorClicked:on.onAnchorClicked;return r!==undefined?r(e,t,n):false}function Kt(e){var t=e.parent?e.parent.getRootElement():undefined;var n=t&&t.onExecuteAction?t.onExecuteAction:on.onExecuteAction;if(e.prepareForExecution()&&n){n(e)}}function Xt(e,t){var n=e.parent?e.parent.getRootElement():undefined;var i=n&&n.onInlineCardExpanded?n.onInlineCardExpanded:on.onInlineCardExpanded;if(i){i(e,t)}}function Yt(e){var t=e.getRootElement();var n=t&&t.onInputValueChanged?t.onInputValueChanged:on.onInputValueChanged;if(n){n(e)}}function $t(e,t){if(t===void 0){t=true}var n=e.getRootElement();if(t){n.updateLayout()}var i=n;var r=i&&i.onElementVisibilityChanged?i.onElementVisibilityChanged:on.onElementVisibilityChanged;if(r!==undefined){r(e)}}var Zt=function(e){Ke(t,e);function t(){var t=e.call(this)||this;t._actionCollection=new Mt(t);return t}t.prototype.internalParse=function(t,n){e.prototype.internalParse.call(this,t,n);this._actionCollection.parse(t["actions"],n)};t.prototype.internalToJSON=function(t,n){e.prototype.internalToJSON.call(this,t,n);this._actionCollection.toJSON(t,"actions",n)};t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);if(t){var n=this._actionCollection.render(this.hostConfig.actions.actionsOrientation,false);if(n){Ze.appendChild(t,Ze.renderSeparation(this.hostConfig,{spacing:this.hostConfig.getEffectiveSpacing(this.hostConfig.actions.spacing)},Ye.Orientation.Horizontal));Ze.appendChild(t,n)}if(this.renderIfEmpty){return t}else{return t.children.length>0?t:undefined}}else{return undefined}};t.prototype.getHasExpandedAction=function(){if(this.renderedActionCount==0){return false}else if(this.renderedActionCount==1){return this._actionCollection.expandedAction!==undefined&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!==undefined}};Object.defineProperty(t.prototype,"renderedActionCount",{get:function(){return this._actionCollection.renderedActionCount},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return false},enumerable:false,configurable:true});t.prototype.getActionCount=function(){return this._actionCollection.items.length};t.prototype.getActionAt=function(t){if(t>=0&&t<this.getActionCount()){return this._actionCollection.items[t]}else{return e.prototype.getActionAt.call(this,t)}};t.prototype.getActionById=function(t){var n=this._actionCollection.getActionById(t);return n?n:e.prototype.getActionById.call(this,t)};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(this._actionCollection){this._actionCollection.validateProperties(t)}};t.prototype.isLastElement=function(t){return e.prototype.isLastElement.call(this,t)&&this._actionCollection.items.length==0};t.prototype.addAction=function(e){this._actionCollection.addAction(e)};t.prototype.clear=function(){e.prototype.clear.call(this);this._actionCollection.clear()};t.prototype.getAllInputs=function(t){if(t===void 0){t=true}var n=e.prototype.getAllInputs.call(this,t);if(t){n=n.concat(this._actionCollection.getAllInputs(t))}return n};t.prototype.getResourceInformation=function(){return e.prototype.getResourceInformation.call(this).concat(this._actionCollection.getResourceInformation())};t.prototype.isBleedingAtBottom=function(){if(this._actionCollection.renderedActionCount==0){return e.prototype.isBleedingAtBottom.call(this)}else{if(this._actionCollection.items.length==1){return this._actionCollection.expandedAction!==undefined&&!this.hostConfig.actions.preExpandSingleShowCardAction}else{return this._actionCollection.expandedAction!==undefined}}};Object.defineProperty(t.prototype,"isStandalone",{get:function(){return false},enumerable:false,configurable:true});return t}(Wt);fe.ContainerWithActions=Zt;var Qt=function(e){Ke(t,e);function t(t,n){var i=e.call(this,t,n,undefined)||this;i.targetVersion=t;i.name=n;return i}t.prototype.parse=function(e,t,n){var i=n.parseAction(e.parent,t[this.name],[],false);if(i!==undefined){if(i instanceof kt){return i}n.logParseEvent(e,Ye.ValidationEvent.ActionTypeNotAllowed,rt.Strings.errors.actionTypeNotAllowed(i.getJsonTypeName()))}n.logParseEvent(e,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.propertyMustBeSet("action"));return undefined};t.prototype.toJSON=function(e,t,n,i){i.serializeValue(t,this.name,n?n.toJSON(i):undefined,undefined,true)};return t}(nt.PropertyDefinition);fe.RefreshActionProperty=Qt;var en=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}Object.defineProperty(t.prototype,"action",{get:function(){return this.getValue(t.actionProperty)},set:function(e){this.setValue(t.actionProperty,e);if(e){e.setParent(this.parent)}},enumerable:false,configurable:true});t.prototype.getSchemaKey=function(){return"RefreshDefinition"};t.actionProperty=new Qt(nt.Versions.v1_4,"action");t.userIdsProperty=new nt.StringArrayProperty(nt.Versions.v1_4,"userIds");Xe([nt.property(t.actionProperty)],t.prototype,"action",null);Xe([nt.property(t.userIdsProperty)],t.prototype,"userIds",void 0);return t}(nt.SerializableObject);fe.RefreshDefinition=en;var tn=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getSchemaKey=function(){return"AuthCardButton"};t.typeProperty=new nt.StringProperty(nt.Versions.v1_4,"type");t.titleProperty=new nt.StringProperty(nt.Versions.v1_4,"title");t.imageProperty=new nt.StringProperty(nt.Versions.v1_4,"image");t.valueProperty=new nt.StringProperty(nt.Versions.v1_4,"value");Xe([nt.property(t.typeProperty)],t.prototype,"type",void 0);Xe([nt.property(t.titleProperty)],t.prototype,"title",void 0);Xe([nt.property(t.imageProperty)],t.prototype,"image",void 0);Xe([nt.property(t.valueProperty)],t.prototype,"value",void 0);return t}(nt.SerializableObject);fe.AuthCardButton=tn;var nn=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getSchemaKey=function(){return"TokenExchangeResource"};t.idProperty=new nt.StringProperty(nt.Versions.v1_4,"id");t.uriProperty=new nt.StringProperty(nt.Versions.v1_4,"uri");t.providerIdProperty=new nt.StringProperty(nt.Versions.v1_4,"providerId");Xe([nt.property(t.idProperty)],t.prototype,"id",void 0);Xe([nt.property(t.uriProperty)],t.prototype,"uri",void 0);Xe([nt.property(t.providerIdProperty)],t.prototype,"providerId",void 0);return t}(nt.SerializableObject);fe.TokenExchangeResource=nn;var rn=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.getSchemaKey=function(){return"Authentication"};t.textProperty=new nt.StringProperty(nt.Versions.v1_4,"text");t.connectionNameProperty=new nt.StringProperty(nt.Versions.v1_4,"connectionName");t.buttonsProperty=new nt.SerializableObjectCollectionProperty(nt.Versions.v1_4,"buttons",tn);t.tokenExchangeResourceProperty=new nt.SerializableObjectProperty(nt.Versions.v1_4,"tokenExchangeResource",nn,true);Xe([nt.property(t.textProperty)],t.prototype,"text",void 0);Xe([nt.property(t.connectionNameProperty)],t.prototype,"connectionName",void 0);Xe([nt.property(t.buttonsProperty)],t.prototype,"buttons",void 0);Xe([nt.property(t.tokenExchangeResourceProperty)],t.prototype,"tokenExchangeResource",void 0);return t}(nt.SerializableObject);fe.Authentication=rn;var on=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.designMode=false;return t}Object.defineProperty(t.prototype,"refresh",{get:function(){return this.getValue(t.refreshProperty)},set:function(e){this.setValue(t.refreshProperty,e);if(e){e.parent=this}},enumerable:false,configurable:true});Object.defineProperty(t,"processMarkdown",{get:function(){throw new Error(rt.Strings.errors.processMarkdownEventRemoved())},set:function(e){throw new Error(rt.Strings.errors.processMarkdownEventRemoved())},enumerable:false,configurable:true});t.applyMarkdown=function(e){var n={didProcess:false};if(t.onProcessMarkdown){t.onProcessMarkdown(e,n)}else if(window.markdownit){var i=window.markdownit;n.outputHtml=i().render(e);n.didProcess=true}else{console.warn(rt.Strings.errors.markdownProcessingNotEnabled)}return n};t.prototype.isVersionSupported=function(){if(this.bypassVersionCheck){return true}else{var e=!this.version||!this.version.isValid||this.maxVersion.major<this.version.major||this.maxVersion.major==this.version.major&&this.maxVersion.minor<this.version.minor;return!e}};t.prototype.getDefaultSerializationContext=function(){return new ln(this.version)};t.prototype.getItemsCollectionPropertyName=function(){return"body"};t.prototype.internalParse=function(n,i){this._fallbackCard=undefined;var r=i.parseElement(undefined,n["fallback"],!this.isDesignMode());if(r){this._fallbackCard=new t;this._fallbackCard.addItem(r)}e.prototype.internalParse.call(this,n,i)};t.prototype.internalToJSON=function(n,i){this.setValue(t.versionProperty,i.targetVersion);e.prototype.internalToJSON.call(this,n,i)};t.prototype.internalRender=function(){var t=e.prototype.internalRender.call(this);if($e.GlobalSettings.useAdvancedCardBottomTruncation&&t){t.style.removeProperty("minHeight")}return t};t.prototype.getHasBackground=function(){return true};t.prototype.getDefaultPadding=function(){return new $e.PaddingDefinition(Ye.Spacing.Padding,Ye.Spacing.Padding,Ye.Spacing.Padding,Ye.Spacing.Padding)};t.prototype.shouldSerialize=function(e){return true};Object.defineProperty(t.prototype,"renderIfEmpty",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return false},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"allowCustomStyle",{get:function(){return this.hostConfig.adaptiveCard&&this.hostConfig.adaptiveCard.allowCustomStyle},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"hasBackground",{get:function(){return true},enumerable:false,configurable:true});t.prototype.getJsonTypeName=function(){return"AdaptiveCard"};t.prototype.internalValidateProperties=function(t){e.prototype.internalValidateProperties.call(this,t);if(this.getValue(ot.typeNameProperty)!=="AdaptiveCard"){t.addFailure(this,Ye.ValidationEvent.MissingCardType,rt.Strings.errors.invalidCardType())}if(!this.bypassVersionCheck&&!this.version){t.addFailure(this,Ye.ValidationEvent.PropertyCantBeNull,rt.Strings.errors.propertyMustBeSet("version"))}else if(!this.isVersionSupported()){t.addFailure(this,Ye.ValidationEvent.UnsupportedCardVersion,rt.Strings.errors.unsupportedCardVersion(this.version.toString(),this.maxVersion.toString()))}};t.prototype.render=function(t){var n;if(this.shouldFallback()&&this._fallbackCard){this._fallbackCard.hostConfig=this.hostConfig;n=this._fallbackCard.render()}else{n=e.prototype.render.call(this);if(n){n.classList.add(this.hostConfig.makeCssClassName("ac-adaptiveCard"));if($e.GlobalSettings.setTabIndexAtCardRoot){n.tabIndex=0}if(this.speak){n.setAttribute("aria-label",this.speak)}}}if(t){Ze.appendChild(t,n);this.updateLayout()}return n};t.prototype.updateLayout=function(t){if(t===void 0){t=true}e.prototype.updateLayout.call(this,t);if($e.GlobalSettings.useAdvancedCardBottomTruncation&&this.isDisplayed()){var n=this.hostConfig.getEffectiveSpacing(Ye.Spacing.Default);this["handleOverflow"](this.renderedElement.offsetHeight-n)}};t.prototype.shouldFallback=function(){return e.prototype.shouldFallback.call(this)||!this.isVersionSupported()};Object.defineProperty(t.prototype,"hasVisibleSeparator",{get:function(){return false},enumerable:false,configurable:true});t.schemaUrl="http://adaptivecards.io/schemas/adaptive-card.json";t.$schemaProperty=new nt.CustomProperty(nt.Versions.v1_0,"$schema",function(e,n,i,r){return t.schemaUrl},function(e,n,i,r,o){o.serializeValue(i,n.name,t.schemaUrl)});t.versionProperty=new nt.CustomProperty(nt.Versions.v1_0,"version",function(e,t,n,i){var r=nt.Version.parse(n[t.name],i);if(r===undefined){r=nt.Versions.latest;i.logParseEvent(e,Ye.ValidationEvent.InvalidPropertyValue,rt.Strings.errors.invalidCardVersion(r.toString()))}return r},function(e,t,n,i,r){if(i!==undefined){r.serializeValue(n,t.name,i.toString())}},nt.Versions.v1_0);t.fallbackTextProperty=new nt.StringProperty(nt.Versions.v1_0,"fallbackText");t.speakProperty=new nt.StringProperty(nt.Versions.v1_0,"speak");t.refreshProperty=new nt.SerializableObjectProperty(nt.Versions.v1_4,"refresh",en,true);t.authenticationProperty=new nt.SerializableObjectProperty(nt.Versions.v1_4,"authentication",rn,true);Xe([nt.property(t.versionProperty)],t.prototype,"version",void 0);Xe([nt.property(t.fallbackTextProperty)],t.prototype,"fallbackText",void 0);Xe([nt.property(t.speakProperty)],t.prototype,"speak",void 0);Xe([nt.property(t.refreshProperty)],t.prototype,"refresh",null);Xe([nt.property(t.authenticationProperty)],t.prototype,"authentication",void 0);return t}(Zt);fe.AdaptiveCard=on;var an=function(e){Ke(t,e);function t(){var t=e!==null&&e.apply(this,arguments)||this;t.suppressStyle=false;return t}t.prototype.getSchemaKey=function(){return"InlineAdaptiveCard"};t.prototype.populateSchema=function(t){e.prototype.populateSchema.call(this,t);t.remove(on.$schemaProperty,on.versionProperty)};t.prototype.getDefaultPadding=function(){return new $e.PaddingDefinition(this.suppressStyle?Ye.Spacing.None:Ye.Spacing.Padding,Ye.Spacing.Padding,this.suppressStyle?Ye.Spacing.None:Ye.Spacing.Padding,Ye.Spacing.Padding)};Object.defineProperty(t.prototype,"bypassVersionCheck",{get:function(){return true},enumerable:false,configurable:true});Object.defineProperty(t.prototype,"defaultStyle",{get:function(){if(this.suppressStyle){return Ye.ContainerStyle.Default}else{return this.hostConfig.actions.showCard.style?this.hostConfig.actions.showCard.style:Ye.ContainerStyle.Emphasis}},enumerable:false,configurable:true});t.prototype.render=function(t){var n=e.prototype.render.call(this,t);if(n){n.setAttribute("aria-live","polite");n.removeAttribute("tabindex")}return n};return t}(on);var sn=function(){function e(){}e.populateWithDefaultElements=function(e){e.clear();e.register("Container",Wt);e.register("TextBlock",lt);e.register("RichTextBlock",pt,nt.Versions.v1_2);e.register("TextRun",ut,nt.Versions.v1_2);e.register("Image",ht);e.register("ImageSet",gt);e.register("Media",vt,nt.Versions.v1_1);e.register("FactSet",dt);e.register("ColumnSet",qt);e.register("ActionSet",jt,nt.Versions.v1_2);e.register("Input.Text",Ct);e.register("Input.Date",wt);e.register("Input.Time",xt);e.register("Input.Number",At);e.register("Input.ChoiceSet",_t);e.register("Input.Toggle",St)};e.populateWithDefaultActions=function(e){e.clear();e.register(Nt.JsonTypeName,Nt);e.register(Ot.JsonTypeName,Ot);e.register(Dt.JsonTypeName,Dt);e.register(zt.JsonTypeName,zt,nt.Versions.v1_2);e.register(kt.JsonTypeName,kt,nt.Versions.v1_4)};e.reset=function(){e.populateWithDefaultElements(e.elements);e.populateWithDefaultActions(e.actions)};e.elements=new it.CardObjectRegistry;e.actions=new it.CardObjectRegistry;return e}();fe.GlobalRegistry=sn;sn.reset();var ln=function(e){Ke(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}t.prototype.internalParseCardObject=function(e,t,n,i,r,o){var a=undefined;if(t&&typeof t==="object"){var s=Ze.parseString(t["type"]);if(s){if(n.indexOf(s)>=0){o(s,1)}else{var l=false;a=r(s);if(!a){l=$e.GlobalSettings.enableFallback&&i;o(s,0)}else{a.setParent(e);a.parse(t,this);l=$e.GlobalSettings.enableFallback&&i&&a.shouldFallback()}if(l){var u=t["fallback"];if(!u&&e){e.setShouldFallback(true)}if(typeof u==="string"&&u.toLowerCase()==="drop"){a=undefined}else if(typeof u==="object"){a=this.internalParseCardObject(e,u,n,true,r,o)}}}}}return a};t.prototype.cardObjectParsed=function(e,t){if(e instanceof Tt&&this.onParseAction){this.onParseAction(e,t,this)}else if(e instanceof ot&&this.onParseElement){this.onParseElement(e,t,this)}};t.prototype.shouldSerialize=function(e){if(e instanceof Tt){return this.actionRegistry.findByName(e.getJsonTypeName())!==undefined}else if(e instanceof ot){return this.elementRegistry.findByName(e.getJsonTypeName())!==undefined}else{return true}};t.prototype.parseCardObject=function(e,t,n,i,r,o){var a=this.internalParseCardObject(e,t,n,i,r,o);if(a!==undefined){this.cardObjectParsed(a,t)}return a};t.prototype.parseElement=function(e,t,n){var i=this;return this.parseCardObject(e,t,[],n,function(e){return i.elementRegistry.createInstance(e,i.targetVersion)},function(e,t){if(t===0){i.logParseEvent(undefined,Ye.ValidationEvent.UnknownElementType,rt.Strings.errors.unknownElementType(e))}else{i.logParseEvent(undefined,Ye.ValidationEvent.ElementTypeNotAllowed,rt.Strings.errors.elementTypeNotAllowed(e))}})};t.prototype.parseAction=function(e,t,n,i){var r=this;return this.parseCardObject(e,t,n,i,function(e){return r.actionRegistry.createInstance(e,r.targetVersion)},function(e,t){if(t==0){r.logParseEvent(undefined,Ye.ValidationEvent.UnknownActionType,rt.Strings.errors.unknownActionType(e))}else{r.logParseEvent(undefined,Ye.ValidationEvent.ActionTypeNotAllowed,rt.Strings.errors.actionTypeNotAllowed(e))}})};Object.defineProperty(t.prototype,"elementRegistry",{get:function(){return this._elementRegistry?this._elementRegistry:sn.elements},enumerable:false,configurable:true});t.prototype.setElementRegistry=function(e){this._elementRegistry=e};Object.defineProperty(t.prototype,"actionRegistry",{get:function(){return this._actionRegistry?this._actionRegistry:sn.actions},enumerable:false,configurable:true});t.prototype.setActionRegistry=function(e){this._actionRegistry=e};return t}(nt.BaseSerializationContext);fe.SerializationContext=ln;var un={};Object.defineProperty(un,"__esModule",{value:true});un.ChannelAdapter=void 0;var pn=function(){function e(){}return e}();un.ChannelAdapter=pn;var cn={};(function(t){var n=e&&e.__extends||function(){var e=function(t,n){e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)if(t.hasOwnProperty(n))e[n]=t[n]};return e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}();Object.defineProperty(t,"__esModule",{value:true});t.LoginRequestResponse=t.ErrorResponse=t.SuccessResponse=t.ActivityResponse=t.ActivityRequestError=t.ActivityRequestTrigger=void 0;(function(e){e["Automatic"]="automatic";e["Manual"]="manual"})(t.ActivityRequestTrigger||(t.ActivityRequestTrigger={}));var i=function(){function e(e,t){this.code=e;this.message=t}return e}();t.ActivityRequestError=i;var r=function(){function e(e){this.request=e}return e}();t.ActivityResponse=r;var o=function(e){n(t,e);function t(t,n){var i=e.call(this,t)||this;i.request=t;i.rawContent=n;return i}return t}(r);t.SuccessResponse=o;var a=function(e){n(t,e);function t(t,n){var i=e.call(this,t)||this;i.request=t;i.error=n;return i}return t}(r);t.ErrorResponse=a;var s=function(e){n(t,e);function t(t,n){var i=e.call(this,t)||this;i.request=t;i._auth=n;for(var r=0,o=i._auth.buttons;r<o.length;r++){var a=o[r];if(a.type==="signin"&&a.value!==undefined){try{new URL(a.value);i.signinButton=a;break}catch(e){}}}return i}Object.defineProperty(t.prototype,"tokenExchangeResource",{get:function(){return this._auth.tokenExchangeResource},enumerable:false,configurable:true});return t}(r);t.LoginRequestResponse=s})(cn);var dn={};var fn=e&&e.__awaiter||function(e,t,n,i){function r(e){return e instanceof n?e:new n(function(t){t(e)})}return new(n||(n=Promise))(function(n,o){function a(e){try{l(i.next(e))}catch(e){o(e)}}function s(e){try{l(i["throw"](e))}catch(e){o(e)}}function l(e){e.done?n(e.value):r(e.value).then(a,s)}l((i=i.apply(e,t||[])).next())})};var hn=e&&e.__generator||function(e,t){var n={label:0,sent:function(){if(o[0]&1)throw o[1];return o[1]},trys:[],ops:[]},i,r,o,a;return a={next:s(0),throw:s(1),return:s(2)},typeof Symbol==="function"&&(a[Symbol.iterator]=function(){return this}),a;function s(e){return function(t){return l([e,t])}}function l(a){if(i)throw new TypeError("Generator is already executing.");while(n)try{if(i=1,r&&(o=a[0]&2?r["return"]:a[0]?r["throw"]||((o=r["return"])&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;if(r=0,o)a=[a[0]&2,o.value];switch(a[0]){case 0:case 1:o=a;break;case 4:n.label++;return{value:a[1],done:false};case 5:n.label++;r=a[1];a=[0];continue;case 7:a=n.ops.pop();n.trys.pop();continue;default:if(!(o=n.trys,o=o.length>0&&o[o.length-1])&&(a[0]===6||a[0]===2)){n=0;continue}if(a[0]===3&&(!o||a[1]>o[0]&&a[1]<o[3])){n.label=a[1];break}if(a[0]===6&&n.label<o[1]){n.label=o[1];o=a;break}if(o&&n.label<o[2]){n.label=o[2];n.ops.push(a);break}if(o[2])n.ops.pop();n.trys.pop();continue}a=t.call(e,n)}catch(e){a=[6,e];r=0}finally{i=o=0}if(a[0]&5)throw a[1];return{value:a[0]?a[1]:void 0,done:true}}};Object.defineProperty(dn,"__esModule",{value:true});dn.AdaptiveApplet=void 0;var yn=r;var gn=o;var mn=i;var vn=cn;var bn=A;var Cn=fe;var Sn=n;function Pn(e,t){var n=[];for(var i=2;i<arguments.length;i++){n[i-2]=arguments[i]}if(mn.GlobalSettings.applets.logEnabled){if(mn.GlobalSettings.applets.onLogEvent){mn.GlobalSettings.applets.onLogEvent(e,t,n)}else{switch(e){case yn.LogLevel.Warning:console.warn(t,n);break;case yn.LogLevel.Error:console.error(t,n);break;default:console.log(t,n);break}}}}var _n=function(){function e(e,t,n){this.action=e;this.trigger=t;this.consecutiveRefreshes=n;this.attemptNumber=0}e.prototype.retryAsync=function(){return fn(this,void 0,void 0,function(){return hn(this,function(e){if(this.onSend){this.onSend(this)}return[2]})})};return e}();var An=function(){function e(){this._allowAutomaticCardUpdate=false;this.renderedElement=document.createElement("div");this.renderedElement.className="aaf-cardHost";this.renderedElement.style.position="relative";this.renderedElement.style.display="flex";this.renderedElement.style.flexDirection="column";this._cardHostElement=document.createElement("div");this._refreshButtonHostElement=document.createElement("div");this._refreshButtonHostElement.className="aaf-refreshButtonHost";this._refreshButtonHostElement.style.display="none";this.renderedElement.appendChild(this._cardHostElement);this.renderedElement.appendChild(this._refreshButtonHostElement)}e.prototype.displayCard=function(e){if(e.renderedElement){gn.clearElementChildren(this._cardHostElement);this._refreshButtonHostElement.style.display="none";this._cardHostElement.appendChild(e.renderedElement)}else{throw new Error("displayCard: undefined card.")}};e.prototype.showManualRefreshButton=function(e){var t=this;var n=this.onShowManualRefreshButton?this.onShowManualRefreshButton(this):true;if(n){this._refreshButtonHostElement.style.display="none";var i=undefined;if(this.onRenderManualRefreshButton){i=this.onRenderManualRefreshButton(this)}else{var r=bn.Strings.runtime.refreshThisCard();if(mn.GlobalSettings.applets.refresh.mode===yn.RefreshMode.Automatic){var o=bn.Strings.runtime.automaticRefreshPaused();if(o[o.length-1]!==" "){o+=" "}r=bn.Strings.runtime.clckToRestartAutomaticRefresh()}var a={type:"AdaptiveCard",version:"1.2",body:[{type:"RichTextBlock",horizontalAlignment:"right",inlines:[{type:"TextRun",text:r,selectAction:{type:"Action.Submit",id:"refreshCard"}}]}]};var s=new Cn.AdaptiveCard;s.parse(a,new Cn.SerializationContext(Sn.Versions.v1_2));s.onExecuteAction=function(n){if(n.id==="refreshCard"){gn.clearElementChildren(t._refreshButtonHostElement);t.internalExecuteAction(e,vn.ActivityRequestTrigger.Automatic,0)}};i=s.render()}if(i){gn.clearElementChildren(this._refreshButtonHostElement);this._refreshButtonHostElement.appendChild(i);this._refreshButtonHostElement.style.removeProperty("display")}}};e.prototype.createActivityRequest=function(e,t,n){var i=this;if(this.card){var r=new _n(e,t,n);r.onSend=function(e){e.attemptNumber++;i.internalSendActivityRequestAsync(r)};var o=this.onPrepareActivityRequest?!this.onPrepareActivityRequest(this,r,e):false;return o?undefined:r}else{throw new Error("createActivityRequest: no card has been set.")}};e.prototype.createMagicCodeInputCard=function(t){var n={type:"AdaptiveCard",version:"1.0",body:[{type:"TextBlock",color:"attention",text:t===1?undefined:"That didn't work... let's try again.",wrap:true,horizontalAlignment:"center"},{type:"TextBlock",text:'Please login in the popup. You will obtain a magic code. Paste that code below and select "Submit"',wrap:true,horizontalAlignment:"center"},{type:"Input.Text",id:"magicCode",placeholder:"Enter magic code"},{type:"ActionSet",horizontalAlignment:"center",actions:[{type:"Action.Submit",id:e.submitMagicCodeActionId,title:"Submit"},{type:"Action.Submit",id:e.cancelMagicCodeAuthActionId,title:"Cancel"}]}]};var i=new Cn.AdaptiveCard;i.parse(n);return i};e.prototype.cancelAutomaticRefresh=function(){if(this._allowAutomaticCardUpdate){Pn(yn.LogLevel.Warning,"Automatic card refresh has been cancelled as a result of the user interacting with the card.")}this._allowAutomaticCardUpdate=false};e.prototype.createSerializationContext=function(){return this.onCreateSerializationContext?this.onCreateSerializationContext(this):new Cn.SerializationContext};e.prototype.internalSetCard=function(e,t){var n=this;if(typeof e==="object"&&e["type"]==="AdaptiveCard"){this._cardPayload=e}if(this._cardPayload){try{var i=new Cn.AdaptiveCard;if(this.hostConfig){i.hostConfig=this.hostConfig}var r=this.createSerializationContext();i.parse(this._cardPayload,r);var o=this.onCardChanging?this.onCardChanging(this,this._cardPayload):true;if(o){this._card=i;if(this._card.authentication&&this._card.authentication.tokenExchangeResource&&this.onPrefetchSSOToken){this.onPrefetchSSOToken(this,this._card.authentication.tokenExchangeResource)}this._card.onExecuteAction=function(e){n.cancelAutomaticRefresh();n.internalExecuteAction(e,vn.ActivityRequestTrigger.Manual,0)};this._card.onInputValueChanged=function(e){n.cancelAutomaticRefresh()};this._card.render();if(this._card.renderedElement){this.displayCard(this._card);if(this.onCardChanged){this.onCardChanged(this)}if(this._card.refresh){if(mn.GlobalSettings.applets.refresh.mode===yn.RefreshMode.Automatic&&t<mn.GlobalSettings.applets.refresh.maximumConsecutiveAutomaticRefreshes){if(mn.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes<=0){Pn(yn.LogLevel.Info,"Triggering automatic card refresh number "+(t+1));this.internalExecuteAction(this._card.refresh.action,vn.ActivityRequestTrigger.Automatic,t+1)}else{Pn(yn.LogLevel.Info,"Scheduling automatic card refresh number "+(t+1)+" in "+mn.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes+"ms");var a=this._card.refresh.action;this._allowAutomaticCardUpdate=true;window.setTimeout(function(){if(n._allowAutomaticCardUpdate){n.internalExecuteAction(a,vn.ActivityRequestTrigger.Automatic,t+1)}},mn.GlobalSettings.applets.refresh.timeBetweenAutomaticRefreshes)}}else if(mn.GlobalSettings.applets.refresh.mode!==yn.RefreshMode.Disabled){if(t>0){Pn(yn.LogLevel.Warning,"Stopping automatic refreshes after "+t+" consecutive refreshes.")}else{Pn(yn.LogLevel.Warning,"The card has a refresh section, but automatic refreshes are disabled.")}if(mn.GlobalSettings.applets.refresh.allowManualRefreshesAfterAutomaticRefreshes||mn.GlobalSettings.applets.refresh.mode===yn.RefreshMode.Manual){Pn(yn.LogLevel.Info,"Showing manual refresh button.");this.showManualRefreshButton(this._card.refresh.action)}}}}}}catch(e){Pn(yn.LogLevel.Error,"setCard: "+e)}}};e.prototype.internalExecuteAction=function(e,t,n){if(e instanceof Cn.ExecuteAction){if(this.channelAdapter){var i=this.createActivityRequest(e,t,n);if(i){i.retryAsync()}}else{throw new Error("internalExecuteAction: No channel adapter set.")}}if(this.onAction){this.onAction(this,e)}};e.prototype.createProgressOverlay=function(e){if(!this._progressOverlay){if(this.onCreateProgressOverlay){this._progressOverlay=this.onCreateProgressOverlay(this,e)}else{this._progressOverlay=document.createElement("div");this._progressOverlay.className="aaf-progress-overlay";var t=document.createElement("div");t.className="aaf-spinner";t.style.width="28px";t.style.height="28px";this._progressOverlay.appendChild(t)}}return this._progressOverlay};e.prototype.removeProgressOverlay=function(e){if(this.onRemoveProgressOverlay){this.onRemoveProgressOverlay(this,e)}if(this._progressOverlay!==undefined){this.renderedElement.removeChild(this._progressOverlay);this._progressOverlay=undefined}};e.prototype.activityRequestSucceeded=function(e,t){if(this.onActivityRequestSucceeded){this.onActivityRequestSucceeded(this,e,t)}};e.prototype.activityRequestFailed=function(e){return this.onActivityRequestFailed?this.onActivityRequestFailed(this,e):mn.GlobalSettings.applets.defaultTimeBetweenRetryAttempts};e.prototype.showAuthCodeInputDialog=function(t){var n=this;var i=this.onShowAuthCodeInputDialog?this.onShowAuthCodeInputDialog(this,t):true;if(i){var r=this.createMagicCodeInputCard(t.attemptNumber);r.render();r.onExecuteAction=function(i){if(n.card&&i instanceof Cn.SubmitAction){switch(i.id){case e.submitMagicCodeActionId:var r=undefined;if(i.data&&typeof i.data["magicCode"]==="string"){r=i.data["magicCode"]}if(r){n.displayCard(n.card);t.authCode=r;t.retryAsync()}else{alert("Please enter the magic code you received.")}break;case e.cancelMagicCodeAuthActionId:Pn(yn.LogLevel.Warning,"Authentication cancelled by user.");n.displayCard(n.card);break;default:Pn(yn.LogLevel.Error,"Unespected action taken from magic code input card (id = "+i.id+")");alert(bn.Strings.magicCodeInputCard.somethingWentWrong());break}}};this.displayCard(r)}};e.prototype.internalSendActivityRequestAsync=function(e){return fn(this,void 0,void 0,function(){var t,n,i,r,o;return hn(this,function(a){switch(a.label){case 0:if(!this.channelAdapter){throw new Error("internalSendActivityRequestAsync: channelAdapter is not set.")}t=this.createProgressOverlay(e);if(t!==undefined){this.renderedElement.appendChild(t)}n=false;i=function(){var t,i,o,a,s,l,u;return hn(this,function(p){switch(p.label){case 0:t=undefined;if(e.attemptNumber===1){Pn(yn.LogLevel.Info,"Sending activity request to channel (attempt "+e.attemptNumber+")")}else{Pn(yn.LogLevel.Info,"Re-sending activity request to channel (attempt "+e.attemptNumber+")")}p.label=1;case 1:p.trys.push([1,3,,4]);return[4,r.channelAdapter.sendRequestAsync(e)];case 2:t=p.sent();return[3,4];case 3:i=p.sent();Pn(yn.LogLevel.Error,"Activity request failed: "+i);r.removeProgressOverlay(e);n=true;return[3,4];case 4:if(!t)return[3,10];if(!(t instanceof vn.SuccessResponse))return[3,5];r.removeProgressOverlay(e);if(t.rawContent===undefined){throw new Error("internalSendActivityRequestAsync: Action.Execute result is undefined")}o=t.rawContent;try{o=JSON.parse(t.rawContent)}catch(e){}if(typeof o==="string"){Pn(yn.LogLevel.Info,"The activity request returned a string after "+e.attemptNumber+" attempt(s).");r.activityRequestSucceeded(t,o)}else if(typeof o==="object"&&o["type"]==="AdaptiveCard"){Pn(yn.LogLevel.Info,"The activity request returned an Adaptive Card after "+e.attemptNumber+" attempt(s).");r.internalSetCard(o,e.consecutiveRefreshes);r.activityRequestSucceeded(t,r.card)}else{throw new Error("internalSendActivityRequestAsync: Action.Execute result is of unsupported type ("+typeof t.rawContent+")")}n=true;return[3,10];case 5:if(!(t instanceof vn.ErrorResponse))return[3,9];a=r.activityRequestFailed(t);if(!(a>=0&&e.attemptNumber<mn.GlobalSettings.applets.maximumRetryAttempts))return[3,7];Pn(yn.LogLevel.Warning,"Activity request failed: "+t.error.message+". Retrying in "+a+"ms");e.attemptNumber++;return[4,new Promise(function(e,t){window.setTimeout(function(){e()},a)})];case 6:p.sent();return[3,8];case 7:Pn(yn.LogLevel.Error,"Activity request failed: "+t.error.message+". Giving up after "+e.attemptNumber+" attempt(s)");r.removeProgressOverlay(e);n=true;p.label=8;case 8:return[3,10];case 9:if(t instanceof vn.LoginRequestResponse){Pn(yn.LogLevel.Info,"The activity request returned a LoginRequestResponse after "+e.attemptNumber+" attempt(s).");if(e.attemptNumber<=mn.GlobalSettings.applets.maximumRetryAttempts){s=true;if(t.tokenExchangeResource&&r.onSSOTokenNeeded){s=!r.onSSOTokenNeeded(r,e,t.tokenExchangeResource)}if(s){r.removeProgressOverlay(e);if(t.signinButton===undefined){throw new Error("internalSendActivityRequestAsync: the login request doesn't contain a valid signin URL.")}Pn(yn.LogLevel.Info,"Login required at "+t.signinButton.value);if(r.onShowSigninPrompt){r.onShowSigninPrompt(r,e,t.signinButton)}else{r.showAuthCodeInputDialog(e);l=window.screenX+(window.outerWidth-mn.GlobalSettings.applets.authPromptWidth)/2;u=window.screenY+(window.outerHeight-mn.GlobalSettings.applets.authPromptHeight)/2;window.open(t.signinButton.value,t.signinButton.title?t.signinButton.title:"Sign in","width="+mn.GlobalSettings.applets.authPromptWidth+",height="+mn.GlobalSettings.applets.authPromptHeight+",left="+l+",top="+u)}}}else{Pn(yn.LogLevel.Error,"Authentication failed. Giving up after "+e.attemptNumber+" attempt(s)");alert(bn.Strings.magicCodeInputCard.authenticationFailed())}return[2,"break"]}else{throw new Error("Unhandled response type: "+t.toString())}case 10:return[2]}})};r=this;a.label=1;case 1:if(!!n)return[3,3];return[5,i()];case 2:o=a.sent();if(o==="break")return[3,3];return[3,1];case 3:return[2]}})})};e.prototype.refreshCard=function(){if(this._card&&this._card.refresh){this.internalExecuteAction(this._card.refresh.action,vn.ActivityRequestTrigger.Manual,0)}};e.prototype.setCard=function(e){this.internalSetCard(e,0)};Object.defineProperty(e.prototype,"card",{get:function(){return this._card},enumerable:false,configurable:true});e.submitMagicCodeActionId="submitMagicCode";e.cancelMagicCodeAuthActionId="cancelMagicCodeAuth";return e}();dn.AdaptiveApplet=An;(function(t){var a=e&&e.__createBinding||(Object.create?function(e,t,n,i){if(i===undefined)i=n;Object.defineProperty(e,i,{enumerable:true,get:function(){return t[n]}})}:function(e,t,n,i){if(i===undefined)i=n;e[i]=t[n]});var s=e&&e.__exportStar||function(e,t){for(var n in e)if(n!=="default"&&!t.hasOwnProperty(n))a(t,e,n)};Object.defineProperty(t,"__esModule",{value:true});
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
s(n,t);s(Y,t);s(Q,t);s(fe,t);s(r,t);s(he,t);s(i,t);s(o,t);s(A,t);s(un,t);s(cn,t);s(dn,t)})(t);Object.defineProperty(t,"__"+"esModule",{value:true});return t});
//# sourceMappingURL=adaptivecards-dbg.js.map