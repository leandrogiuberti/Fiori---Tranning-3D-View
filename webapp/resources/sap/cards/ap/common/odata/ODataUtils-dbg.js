/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/base/security/encodeURLParameters","sap/ui/model/Filter","sap/ui/model/FilterOperator","sap/ui/model/odata/ODataUtils","sap/ui/model/odata/v2/ODataModel","sap/ui/model/odata/v4/ODataUtils","./v2/MetadataAnalyzer","./v4/MetadataAnalyzer"],function(e,t,n,r,o,s,c,i){"use strict";function u(e,t){try{var n=e()}catch(e){return t(e)}if(n&&n.then){return n.then(void 0,t)}return n}const a=function(e,t,n={},r){try{const o={};Object.keys(n).forEach(e=>{if(n[e].length){o[e]=n[e]}});if(r){return j(e,t,o)}else{return E(e,t,o)}}catch(e){return Promise.reject(e)}};const l=function(e,t,n,r){try{const o=r.getMetaModel();if(!e||e.length===0){return Promise.resolve(null)}const s=v(t,e);if(s===null){return Promise.resolve(null)}const c=t.startsWith("/")?t:`/${t}`;const i=o.getMetaContext(c);const u=r.bindList(i?.getPath()??"",undefined,undefined,s,{$select:n.join(",")});return Promise.resolve(u.requestContexts(0,2)).then(function(e){return e.length>0?e[0]:null})}catch(e){return Promise.reject(e)}};const f=c["getPropertyReference"];const m=i["getPropertyReferenceKey"];const h=i["getSemanticKeys"];const d=e=>e.length===1&&!e[0].includes("=");const p=function(e,t){const n=e.find(e=>e.type==="Edm.Guid")?.name;const r=t[0];t[0]=n?`${n}=${s.formatLiteral(r,"Edm.Guid")}`:e.map(e=>`${e.name}=${r}`).join(",");return t};const P=function(e,t){const n=e.map(e=>e.split("=")[0]);t.forEach(t=>{if(!n.includes(t.name)&&t.name==="IsActiveEntity"){e.push("IsActiveEntity=true")}});return e};function g(e){if(e.startsWith("'")&&e.endsWith("'")){e=decodeURIComponent(e.substring(1,e.length-1))}return e}function v(e,r){const o=e.substring(e.indexOf("(")+1,e.length-1).split(",");if(r.length!=o.length){return null}const s=new Map;let c=0;o.forEach(function(e){if(e.indexOf("=")>-1){const[t,n]=e.split("=");s.set(t,g(n))}else{s.set(r[c],g(e))}c++});const i=[];r.forEach(e=>{const r=s.get(e);if(r!==undefined){i.push(new t({path:e,operator:n.EQ,value1:r}))}});return i.length?new t(i,true):null}const y=function(e,t){try{let n=false;function r(e){return n?e:f.length===1&&f[0].indexOf("=")===-1?p(a,f):P(f,a)}const o=t.indexOf("(");const c=t.substring(0,o);const i=t.indexOf(")");const u=t.substring(o+1,i);const a=m(e,c);const f=u.split(",");const d=h(e.getMetaModel(),c).map(e=>e.$PropertyPath);const g=a.map(e=>e.name);const v=function(){if(d.length){return Promise.resolve(l(d,t,g,e)).then(function(e){const t=e?.getPath();if(t){const t=a.map(t=>{const n=e?.getProperty(t.name);return`${t.name}=${s.formatLiteral(n,t.type)}`});n=true;return t}})}}();return Promise.resolve(v&&v.then?v.then(r):r(v))}catch(y){return Promise.reject(y)}};const $=function(e,t,n){try{let r=false;function o(n){if(r)return n;const o=e.indexOf("(");const s=e.indexOf(")");const c=e.substring(o+1,s);const i=c.split(",");if(d(i)){const n=e.substring(0,o);const r=f(t,n);return p(r,i).join(",")}return c}const s=function(){if(n){return Promise.resolve(y(t,e)).then(function(e){const t=e.join(",");r=true;return t})}}();return Promise.resolve(s&&s.then?s.then(o):o(s))}catch(c){return Promise.reject(c)}};const j=function(t,n,r){try{const o=t.endsWith("/")?t:`${t}/`;r.format="json";const s=e(r);const c=`${o}${n}?${s}`;return Promise.resolve(D(c,"json").then(e=>e).catch(e=>{throw new Error(e)}))}catch(e){return Promise.reject(e)}};const E=function(e,t,n){try{const r=new o(e);return Promise.resolve(new Promise(function(e,o){const s=function(t){e(t)};const c=function(e){o(e)};r.read("/"+t,{success:s,error:c,urlParameters:n})}))}catch(e){return Promise.reject(e)}};function O(e){return e&&e.isA("sap.ui.model.odata.v4.ODataModel")||false}function b(e,t,n,r){const o=O(r);const s=o?m(r,n).map(e=>e.name):f(r,n).map(e=>e.name);const c=e.filter(e=>s.every(t=>e[t]!==undefined&&e[t]!==""));return c.map(e=>{let r=t;Object.entries(e).forEach(([e,t])=>{const n=`{{parameters.${e}}}`;if(r.includes(n)){r=r.replace(n,t)}});return n&&r?`${n}(${r})`:""})}const M=function(e,t,n){try{const r=O(n);const o=r?m(n,t).map(e=>e.name):f(n,t).map(e=>e.name);const s={$select:o.join(",")};return Promise.resolve(u(function(){return Promise.resolve(a(e,t,s,r)).then(function(e){const o=r?e.value:e.results;if(o.length>0){const e=A(n,t);const r=b(o,e,t,n);return r.map(e=>({name:e,labelWithValue:e}))}return[]})},function(){return[]}))}catch(e){return Promise.reject(e)}};const x=function(){return Promise.resolve(u(function(){return Promise.resolve(D("/manifest.json","json")).then(function(e){return e["sap.cards.ap"]?.embeds?.ObjectPage?.default||""})},function(){return""}))};const w=function(e,t){try{function n(e){let n=false;const s=O(r);const c=s?r.getServiceUrl():r.sServiceUrl;if(e&&t.keyParameters&&!o){let n=A(r,e);const o=t.keyParameters;Object.entries(o).forEach(([e,t])=>{const r=`{{parameters.${e}}}`;if(n.includes(r)){n=n.replace(r,t)}});return n?`${e}(${n})`:""}const i=function(){if(c&&e&&r&&o){return Promise.resolve(M(c,e,r)).then(function(e){const t=e?.length?e[0].name:"";n=true;return t})}}();return i&&i.then?i.then(function(t){return n?t:e}):n?i:e}const r=e.getModel();const o=t.isDesignMode||false;return Promise.resolve(o?Promise.resolve(x()).then(n):n(t.entitySet))}catch(s){return Promise.reject(s)}};function A(e,t){const n=[];const o=e&&e.isA("sap.ui.model.odata.v4.ODataModel");if(o){const r=m(e,t);r.forEach(e=>{const t=s.formatLiteral(`{{parameters.${e.name}}}`,e.type);n.push(`${e.name}=${t}`)})}else{const o=f(e,t);o.forEach(e=>{const t=r.formatValue(`{{parameters.${e.name}}}`,e.type,true);n.push(`${e.name}=${t}`)})}return n.join(",")}const D=function(e,t){try{return Promise.resolve(u(function(){return Promise.resolve(fetch(e)).then(function(n){if(!n.ok){throw new Error(`Failed to fetch file from ${e}: ${n.status} ${n.statusText}`)}return Promise.resolve(t==="json"?n.json():n.text())})},function(t){const n=t instanceof Error?t.message:"Unknown error";throw new Error(`Error fetching file from ${e}: ${n}`)}))}catch(e){return Promise.reject(e)}};var S={__esModule:true};S.isSingleKeyWithoutAssignment=d;S.handleSingleProperty=p;S.unquoteAndDecode=g;S.createContextParameter=$;S.fetchDataAsync=a;S.isODataV4Model=O;S.getEntitySetWithContextURLs=M;S.getEntitySetWithObjectContext=w;S.fetchFileContent=D;return S});
//# sourceMappingURL=ODataUtils-dbg.js.map