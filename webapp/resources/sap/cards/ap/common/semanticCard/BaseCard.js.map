{"version":3,"file":"BaseCard.js","names":["sap","ui","define","___odata_ODataUtils","_catch","body","recover","result","e","then","fetchFileContent","_iteratorSymbol","Symbol","iterator","_settle","pact","state","value","s","_Pact","v","o","bind","observer","prototype","onFulfilled","onRejected","this","callback","_this","_isSettledPact","thenable","_forTo","array","check","i","reject","_cycle","length","isODataV4Model","_forOf","target","step","next","done","return","_fixup","TypeError","values","push","BaseCard","constructor","appComponent","getApplicationManifest","getManifest","getMetadata","appModel","getModel","Error","bODataV4","serviceUrl","getServiceUrl","sServiceUrl","Promise","resolve","metadataUrl","endsWith","error","errorMessage","message","getAnnotations","_exit","_this2","annotations","annotationURIs","getMetaModel","aAnnotationUris","aAnnotationURIs","_temp","uri","trim","annotation","_result2","__exports","__esModule"],"sources":["BaseCard.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport type Component from \"sap/ui/core/Component\";\nimport type V4ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport type { AppManifest } from \"../helpers/ApplicationInfo\";\nimport { fetchFileContent, isODataV4Model, type ODataModel } from \"../odata/ODataUtils\";\n\ntype AnnotatedODataModel = {\n\taAnnotationURIs?: string[];\n\taAnnotationUris?: string[];\n};\n\n/**\n * Base class for semantic card generation providing common functionality\n * for accessing application metadata, annotations, and OData service information.\n */\nexport abstract class BaseCard {\n\tprotected readonly appComponent: Component;\n\n\tconstructor(appComponent: Component) {\n\t\tthis.appComponent = appComponent;\n\t}\n\n\t/**\n\t * Abstract method to generate the semantic card object.\n\t * Must be implemented by concrete card types.\n\t */\n\tabstract generateObjectCard(): Promise<any>;\n\n\t/**\n\t * Retrieves the application manifest with validation.\n\t * @returns The application manifest\n\t * @throws Error if manifest is not available\n\t */\n\tprotected getApplicationManifest(): AppManifest {\n\t\treturn this.appComponent.getManifest() as AppManifest;\n\t}\n\n\t/**\n\t * Retrieves OData service metadata as XML string.\n\t * @returns Promise resolving to metadata XML string\n\t * @throws Error if model is not available or metadata fetch fails\n\t */\n\tprotected async getMetadata(): Promise<string> {\n\t\tconst appModel = this.appComponent.getModel();\n\t\tif (!appModel) {\n\t\t\tthrow new Error(\"OData model is not available.\");\n\t\t}\n\n\t\tconst bODataV4 = isODataV4Model(appModel as ODataModel);\n\t\tconst serviceUrl = bODataV4\n\t\t\t? (appModel as V4ODataModel).getServiceUrl()\n\t\t\t: (appModel as unknown as { sServiceUrl?: string }).sServiceUrl;\n\n\t\tif (!serviceUrl) {\n\t\t\tthrow new Error(\"Service URL is not available from the model.\");\n\t\t}\n\n\t\ttry {\n\t\t\tconst metadataUrl = serviceUrl?.endsWith(\"/\") ? `${serviceUrl}$metadata` : `${serviceUrl}/$metadata`;\n\t\t\tconst metadataFileContent = await fetchFileContent(metadataUrl);\n\t\t\treturn metadataFileContent;\n\t\t} catch (error) {\n\t\t\tconst errorMessage = error instanceof Error ? error.message : \"Unknown error\";\n\t\t\tthrow new Error(`Failed to fetch OData metadata: ${errorMessage}`);\n\t\t}\n\t}\n\n\t/**\n\t * Retrieves annotation files from the OData model.\n\t * @returns Promise resolving to array of annotation XML strings\n\t * @throws Error if model is not available or annotation fetch fails\n\t */\n\tprotected async getAnnotations(): Promise<string[]> {\n\t\tconst appModel = this.appComponent.getModel();\n\t\tif (!appModel) {\n\t\t\tthrow new Error(\"OData model is not available.\");\n\t\t}\n\n\t\tconst bODataV4 = isODataV4Model(appModel as ODataModel);\n\t\tconst annotations = [];\n\t\tconst annotationURIs =\n\t\t\t(bODataV4\n\t\t\t\t? (appModel.getMetaModel() as unknown as AnnotatedODataModel)?.aAnnotationUris\n\t\t\t\t: (appModel as unknown as AnnotatedODataModel)?.aAnnotationURIs) ?? [];\n\n\t\tfor (const uri of annotationURIs) {\n\t\t\tif (!uri || uri.trim().length === 0) {\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst annotation = await fetchFileContent(uri);\n\t\t\t\tannotations.push(annotation);\n\t\t\t} catch (error) {\n\t\t\t\tconst errorMessage = error instanceof Error ? error.message : \"Unknown error\";\n\t\t\t\tthrow new Error(`Failed to fetch annotation from ${uri}: ${errorMessage}`);\n\t\t\t}\n\t\t}\n\n\t\treturn annotations;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}