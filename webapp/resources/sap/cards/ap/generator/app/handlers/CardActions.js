/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/ui/core/library","sap/ui/model/Filter","../../helpers/FooterActions","../../helpers/IntegrationCardHelper","../../helpers/Transpiler","../../utils/CommonUtils"],function(t,e,n,o,i,r){"use strict";const s=typeof Symbol!=="undefined"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function c(t,e,n){if(!t.s){if(n instanceof a){if(n.s){if(e&1){e=n.s}n=n.v}else{n.o=c.bind(null,t,e);return}}if(n&&n.then){n.then(c.bind(null,t,e),c.bind(null,t,2));return}t.s=e;t.v=n;const o=t.o;if(o){o(t)}}}const a=function(){function t(){}t.prototype.then=function(e,n){const o=new t;const i=this.s;if(i){const t=i&1?e:n;if(t){try{c(o,1,t(this.v))}catch(t){c(o,2,t)}return o}else{return this}}this.o=function(t){try{const i=t.v;if(t.s&1){c(o,1,e?e(i):i)}else if(n){c(o,1,n(i))}else{c(o,2,i)}}catch(t){c(o,2,t)}};return o};return t}();function u(t){return t instanceof a&&t.s&1}function l(t,e,n){var o=-1,i,r;function s(l){try{while(++o<t.length&&(!n||!n())){l=e(o);if(l&&l.then){if(u(l)){l=l.v}else{l.then(s,r||(r=c.bind(null,i=new a,2)));return}}}if(i){c(i,1,l)}else{i=l}}catch(t){c(i||(i=new a),2,t)}}s();return i}const f=function(t){try{function e(){b(r,n);C(n)}const n=m();const o=t.getSource();const i=o?.getBindingContext()?.getPath();const r=P();if(E(o)){const a=n.getProperty(i);a.titleKey=o.getSelectedKey();a.title=o.getValue();a.isStyleControlEnabled=true;K(a,i||"");o.setValueState(g.None)}else{if(o.getValue()===""&&o.getSelectedKey()===""){o.setValueState(g.None)}else{o.setValueState(g.Error);o.setValueStateText(V("GENERATOR_ACTION_ERROR_TEXT"));const u=n.getProperty("/configuration/errorControls");if(u&&!u.includes(o)){u.push(o)}}o.focus()}p(r);const s=n.getProperty("/configuration/actions/addedActions");const c=d(s,function(t){const e=function(){if(t.titleKey){return Promise.resolve(y(r,t)).then(function(){})}}();if(e&&e.then)return e.then(function(){})});return Promise.resolve(c&&c.then?c.then(e):e(c))}catch(l){return Promise.reject(l)}};function d(t,e,n){if(typeof t[s]==="function"){var o=t[s](),i,r,f;function h(t){try{while(!(i=o.next()).done&&(!n||!n())){t=e(i.value);if(t&&t.then){if(u(t)){t=t.v}else{t.then(h,f||(f=c.bind(null,r=new a,2)));return}}}if(r){c(r,1,t)}else{r=t}}catch(t){c(r||(r=new a),2,t)}}h();if(o.return){var d=function(t){try{if(!i.done){o.return()}}catch(t){}return t};if(r&&r.then){return r.then(d,function(t){throw d(t)})}d()}return r}if(!("length"in t)){throw new TypeError("Object is not iterable")}var g=[];for(var y=0;y<t.length;y++){g.push(t[y])}return l(g,function(t){return e(g[t])},n)}const g=t["ValueState"];const y=n["addActionToCardManifest"];const h=n["removeActionFromManifest"];const p=n["resetCardActions"];const A=n["updateCardManifestAction"];const P=o["getCurrentCardManifest"];const b=o["renderCardPreview"];const C=i["transpileIntegrationCardToAdaptive"];const m=r["getDialogModel"];function S(){const t=m();const e=t.getProperty("/configuration/actions/addedActions");if(e.length<2){e.push({title:"",titleKey:"",style:"Default",enablePathKey:"",isStyleControlEnabled:false,isConfirmationRequired:false});t.setProperty("/configuration/actions/addedActions",e);t.setProperty("/configuration/isEdited",true)}t.setProperty("/configuration/actions/isAddActionEnabled",e.length<2)}function v(t){const e=m();const n=t?.getSource();const o=n?.getBindingContext()?.getPath();const i=n.getParent()?.getParent();const r=i?.findAggregatedObjects(true);const s=r?.find(t=>t.getMetadata().getName()==="sap.m.ComboBox");s?.setValueState(g.None);if(s){const t=e.getProperty("/configuration/errorControls")??[];const n=t.filter(t=>t!==s);e.setProperty("/configuration/errorControls",n)}const c=Number(o?.split("/configuration/actions/addedActions/")[1]);const a=e.getProperty("/configuration/actions/addedActions");const u=c!==undefined?a.splice(c,1):[];e.setProperty("/configuration/actions/addedActions",a);e.setProperty("/configuration/actions/isAddActionEnabled",a.length<2);e.setProperty("/configuration/isEdited",true);const l=P();h(l,u[0]);b(l,e);C(e)}function E(t){const e=m();const n=e.getProperty("/configuration/actions/annotationActions");return n.some(e=>e.label===t.getValue()&&e.action===t.getSelectedKey())}function K(t,e){const n=m();const o=n.getProperty("/configuration/actions/annotationActions");const i=o.filter(e=>e.label===t.title&&e.action===t.titleKey);if(i.length){let e=i[0].enablePath;e=e?.indexOf("_it/")>-1?e?.replace("_it/",""):e;const n=i[0].isConfirmationRequired;if(e){t.enablePathKey=e}if(n){t.isConfirmationRequired=n}}if(e){n.setProperty(e,t)}}function w(t){const n=m();const o=n.getProperty("/configuration/actions/addedActions");const i=t.getBinding("items");const r=t.getSelectedKey();const s=o.filter(t=>t.titleKey!==r);const c=s.length?new e("action","NE",s[0].titleKey):[];i.filter(c)}function T(t){const e=t.getSource();const n=e.getBinding("items");if(n?.isSuspended()){n.refresh(true);n.resume()}e.addEventDelegate({onBeforeRendering:w.bind(null,e)})}function R(t){const e=m();const n=t.getSource();const o=n?.getBindingContext()?.getPath();const i=e.getProperty(o);i.style=n.getSelectedKey();e.setProperty(o,i);const r=P();A(r,i);b(r,e);C(e)}function V(t){return m("i18n").getObject(t)}var N={__esModule:true};N.filterCardActions=w;N.loadActions=T;N.onActionAddClick=S;N.onAddedActionDelete=v;N.onAddedActionStyleChange=R;N.onAddedActionTitleChange=f;return N});
//# sourceMappingURL=CardActions.js.map