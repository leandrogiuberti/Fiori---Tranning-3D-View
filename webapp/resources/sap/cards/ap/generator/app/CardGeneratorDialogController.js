/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/base/Log","sap/base/util/merge","sap/cards/ap/generator/odata/ODataUtils","sap/m/MessageBox","sap/m/MessageToast","sap/ui/base/Event","sap/ui/core/Element","sap/ui/core/Fragment","sap/ui/core/Popup","sap/ui/core/library","sap/ui/model/json/JSONModel","sap/ui/thirdparty/jquery","../helpers/Batch","../helpers/Formatter","../helpers/I18nHelper","../helpers/IntegrationCardHelper","../helpers/PropertyExpression","../helpers/Transpiler","../odata/ODataTypes","../pages/Application","../utils/CommonUtils","./handlers/CardActions","./handlers/FreeStyle"],function(t,e,n,o,r,i,a,s,c,g,u,jQuery,p,d,l,f,y,m,P,v,h,O,E){"use strict";const S=function(t){try{const e=t.getSource();e.setEnabled(false);const n=a.getElementById("cardGeneratorDialog--contentSplitter");const o={onCriticalityChange:function(t){return Promise.resolve(F(t,false)).then(function(){Qt(t.getParameter("isCalcuationType")||false)})},onArrangementsChange:function(t){return Promise.resolve(F(t,true)).then(function(){qt();const t=X();const e=t.getProperty("/configuration/groups");t.setProperty("/configuration/isEdited",true);for(let n=0;n<e?.[0].items.length;n++){const o=e[0].items[n];const r=o.value.split(" ")[1]&&o.value.split(" ")[1].slice(1,-1);if(r!=="undefined"&&r!==undefined){t.setProperty("/configuration/advancedFormattingOptions/targetProperty",r)}else if(r===undefined){t.setProperty("/configuration/advancedFormattingOptions/targetProperty","")}if(r!=="undefined"&&r!==undefined&&Q?.indexOf(o?.name)===-1){Q.push(o?.name)}}})},onPropertyFormatterChangeFromAdvancedSettings:function(){Yt()}};return Promise.resolve(s.load({name:"sap.cards.ap.generator.app.fragments.AdvancedSettings",controller:o}).then(function(t){if(!e.getPressed()){const t=n.getContentAreas()[1];n.removeContentArea(t)}else{n.insertContentArea(t,1)}e.setEnabled(true);setTimeout(()=>{L(X())},0)})).then(function(){})}catch(t){return Promise.reject(t)}};const F=function(t,e){try{const n=t.getParameters();const o=n.selectedItem;if(!o)return Promise.resolve();const r=X();const i=r.getProperty("/configuration/navigationProperty")||[];const a=r.getProperty("/configuration/selectedNavigationalProperties")||[];const s=a.findIndex(t=>t.name===(o.value||o.name));const c=i.find(t=>t.name===(o.value||o.name));const{name:g="",properties:u=[]}=c||{};const p={name:g,value:u};if(s===-1&&c){a.push(p)}r.setProperty("/configuration/selectedNavigationalProperties",a);const d=function(){if(c){return Promise.resolve(T(c.name,p)).then(function(){if(n.textArrangementChanged){o.navigationalPropertiesForId=p.value;o.isNavigationForId=p.value.length>0;o.navigationKeyForId=""}else{o.navigationalPropertiesForDescription=p.value;if(e){o.isNavigationForDescription=p.value.length>0;o.navigationKeyForDescription=""}}if(e){o.value=""}})}else{if(n.textArrangementChanged){o.isNavigationForId=false;o.navigationKeyForId=""}else{o.isNavigationForDescription=false;o.navigationKeyForDescription=""}}}();return Promise.resolve(d&&d.then?d.then(function(){}):void 0)}catch(t){return Promise.reject(t)}};const I=function(t){try{const{rootComponent:e,entitySet:o}=H.getInstance().fetchDetails();const r=t.getSource();const i=r.getSelectedKey()||"";const a=t.getParameter("newValue");const s=i!==""?`{${i}}`:a;const c=X();st(t);return Promise.resolve(V(i,false)).then(function(){const t=c.getProperty("/configuration/selectedNavigationPropertiesContent");c.setProperty("/configuration/advancedFormattingOptions/sourceProperty",i);const a=r?.getBindingContext()?.getPath();const g=c.getProperty(a);if(!t?.value?.length){g.value=i&&K(s,{unitOfMeasures:c.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures"),textArrangements:c.getProperty("/configuration/advancedFormattingOptions/textArrangements"),propertyValueFormatters:c.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters")})}else{g.value="";g.navigationProperty="";g.navigationalProperties=t?.value}xt(i);const u=n.getPropertyLabel(e.getModel(),o,i,k.Property);g.label=t?.value?.length?"":u;g.isNavigationEnabled=t?.value?.length>0;g.isEnabled=true;c.refresh();w(c);L(X())})}catch(t){return Promise.reject(t)}};const C=function(){try{const{rootComponent:e,entitySet:n}=H.getInstance().fetchDetails();const i=vt();if(i){return Promise.resolve()}const s=a.getElementById("cardGeneratorDialog--cardPreview");const c=s.getManifest();return Promise.resolve(B(c,e)).then(function(){M(c,X());_(c);N(c);delete c["sap.card"].configuration?.parameters?.contextParameters;const e={floorplan:"ObjectPage",localPath:`cards/op/${n}`,fileName:"manifest.json",manifests:[{type:"integration",manifest:c,default:true,entitySet:n}]};jQuery.ajax({type:"POST",url:"/cards/store",headers:{"Content-Type":"application/json"},data:JSON.stringify(e),success:function(){r.show(mt("CARD_SAVE_SUCCESS_MESSAGE"))},error:function(e,n,r){const i=`Unable to save the card: ${n} - ${r} (Status: ${e.status} - ${e.statusText})`;t.error(i);o.error(mt("CARD_SAVE_ERROR_MESSAGE"))}});X().setProperty("/configuration/isEdited",false);J()?.close();Zt()})}catch(t){return Promise.reject(t)}};const V=function(t,e){try{const n=X();const o=n.getProperty("/configuration/navigationProperty")||[];const r=n.getProperty("/configuration/selectedNavigationalProperties")||[];const i=r.findIndex(e=>e.name===t);const a=o.find(e=>e.name===t);const s=a?.name||"";const c=a?.properties||[];const g={name:s,value:c};if(i===-1&&a){r.push(g)}n.setProperty("/configuration/selectedNavigationalProperties",r);if(e){n.setProperty("/configuration/selectedNavigationPropertyHeader",g)}else{n.setProperty("/configuration/selectedNavigationPropertiesContent",g)}const u=function(){if(a){return Promise.resolve(T(a.name,g)).then(function(){})}}();return Promise.resolve(u&&u.then?u.then(function(){}):void 0)}catch(t){return Promise.reject(t)}};const A=function(t){try{const e=t=>{const e=X();return{"sap.card":{header:{mainIndicator:{state:nt(t),number:K(t,{unitOfMeasures:e.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures"),textArrangements:e.getProperty("/configuration/advancedFormattingOptions/textArrangements"),propertyValueFormatters:e.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters")})}}}}};const n=X();const o=t.getSource();const r=o.getSelectedKey();return Promise.resolve(V(r,true)).then(function(){const o=n.getProperty("/configuration/selectedNavigationPropertyHeader");const i=t.getParameter("newValue");st(t,"stateIndicator");const a=r!==""?`{${r}}`:i;n.setProperty("/configuration/mainIndicatorNavigationSelectedValue","");n.setProperty("/configuration/mainIndicatorStatusKeyInitial",i);n.setProperty("/configuration/mainIndicatorNavigationSelectedKey","");const s=n.getProperty("/configuration/properties");const c=s.find(t=>t.name===r)?.type||"";const g=W(c);const u=["Edm.Decimal","Edm.Int16","Edm.Int32","Edm.Double"].indexOf(c)>-1;n.setProperty("/configuration/mainIndicatorStatusKey",r);n.setProperty("/configuration/advancedFormattingOptions/isFormatterEnabled",g||u);n.setProperty("/configuration/advancedFormattingOptions/textArrangementSourceProperty",a);n.setProperty("/configuration/advancedFormattingOptions/textArrangementSelectedKey",r);if(n.getProperty("/configuration/trendOptions/sourceProperty")!==r){n.setProperty("/configuration/trendOptions",{});n.setProperty("/configuration/indicatorsValue",{})}n.setProperty("/configuration/trendOptions/sourceProperty",r);n.setProperty("/configuration/indicatorsValue/sourceProperty",r);xt(r);At();Tt();n.setProperty("/configuration/navigationValue","");if(!o?.value.length){it(t,e,"mainIndicator")}else{it(t,e,"navSelection")}})}catch(t){return Promise.reject(t)}};const T=function(t,e){try{const{entitySetWithObjectContext:o}=H.getInstance().fetchDetails();const r=X();const{serviceUrl:i,oDataV4:a,$data:s}=r.getProperty("/configuration");const c={properties:[],navigationProperties:[{name:t,properties:e.value.map(t=>t.name)||[]}]};return Promise.resolve(n.fetchDataAsync(i,o,a,x(c))).then(function(n){ut(e,n);s[t]=n[t];r.setProperty("/configuration/$data",s)})}catch(t){return Promise.reject(t)}};const D=g["ValueState"];const x=p["createUrlParameters"];const N=p["updateManifestWithSelectQueryParams"];const b=d["formatPropertyDropdownValues"];const _=l["createAndStoreGeneratedi18nKeys"];const M=f["enhanceManifestWithConfigurationParameters"];const B=f["enhanceManifestWithInsights"];const R=f["getCurrentCardManifest"];const $=f["getPreviewItems"];const G=f["renderCardPreview"];const w=f["updateCardGroups"];const K=y["getArrangements"];const U=y["resolvePropertyPathFromExpression"];const L=m["transpileIntegrationCardToAdaptive"];const k=P["PropertyInfoType"];const H=v["Application"];const W=h["checkForDateType"];const j=h["extractValueWithoutBooleanExprBinding"];const J=h["getCardGeneratorDialog"];const X=h["getDialogModel"];const z=h["hasBooleanBindingExpression"];const Y=h["isBinding"];const q={};const Q=[];const Z=5;const tt=5;const et={initialize:function(){te()},okPressed:C,cancelPressed:Rt,onAddClick:Pt,onGroupAddClick:St,onGroupDeleteClick:It,deleteGroup:Ft,onDeleteClick:Vt,onPropertySelection:I,updateContentNavigationSelection:ft,onPropertyLabelChange:Nt,onTitleSelection:at,onSubTitleSelection:ct,onGroupTitleChange:Ct,validateControl:st,onDrop:bt,onHeaderUOMSelection:gt,onStateIndicatorSelection:A,updateHeaderNavigationSelection:pt,onHeightChange:Mt,onWidthChange:Bt,onResetPressed:_t,onItemsActionsButtonPressed:jt,onPreviewTypeChange:zt,toggleAdvancedSetting:S,getTranslatedText:mt,onPropertyFormatting:wt,onFormatTypeSelection:Gt,onActionAddClick:O.onActionAddClick,onAddedActionDelete:O.onAddedActionDelete,onAddedActionStyleChange:O.onAddedActionStyleChange,onAddedActionTitleChange:O.onAddedActionTitleChange,loadActions:O.loadActions,_setDefaultCardPreview:te,_updateTrendForCardHeader:At,_updateSideIndicatorsForHeader:Tt,_setAdvancedFormattingOptionsEnablement:ot,_updateHeaderArrangements:Yt,_updateArrangements:qt,_updateCriticality:Qt,_validateHeader:vt,applyCriticality:Ut,applyUoMFormatting:Lt,onTrendDelete:Ht,loadAdvancedFormattingConfigurationFragment:Wt,addLabelsForProperties:ut,checkForNavigationProperty:F,disableOrEnableUOMAndTrend:lt,handleCriticalityAction:Xt,onEntitySetPathChange:E.onEntitySetPathChange,applyServiceDetails:E.applyServiceDetails,onServiceChange:E.onServiceChange,onContextPathChange:E.onContextPathChange,onBackButtonPress:E.onBackButtonPress,handleFormatterUomAction:Jt,onBeforeDialogClosed:ee,setCriticalitySourceProperty:$t};function nt(t,e){const n=X();const o=n?.getProperty("/configuration/mainIndicatorOptions/criticality");if(z(t)){t=j(t)}const r=o?.find(e=>{const{name:n,propertyKeyForId:o}=e;return n===t||t===`{${n}}`||t===`{${n}/${o}}`});if(r){if(Y(r?.criticality)){return"{= extension.formatters.formatCriticality($"+r?.criticality+", 'color') }"}if(r?.activeCalculation||e){const t={deviationLow:r?.deviationRangeLowValue,deviationHigh:r?.deviationRangeHighValue,toleranceLow:r?.toleranceRangeLowValue,toleranceHigh:r?.toleranceRangeHighValue,sImprovementDirection:r?.improvementDirection,oCriticalityConfigValues:{None:"Neutral",Negative:"Error",Critical:"Critical",Positive:"Good"}};return"{= extension.formatters.formatValueColor(${"+r?.name+"},"+JSON.stringify(t)+") }"}return r?.criticality}return"None"}function ot(t){const e=X();const n=e.getProperty("/configuration/mainIndicatorStatusKey");e.setProperty("/configuration/trendOptions/sourceProperty",n);e.setProperty("/configuration/indicatorsValue/sourceProperty",n);const o=e.getProperty("/configuration/properties");const r=e.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures")||[];const i=e.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters")||[];const a=e.getProperty("/configuration/mainIndicatorOptions/criticality")||[];const s=e.getProperty("/configuration/selectedTrendOptions")||[];const c=e.getProperty("/configuration/selectedIndicatorOptions")||[];const g=rt(t,o,e);const u=W(g);const p=["Edm.Decimal","Edm.Int16","Edm.Int32","Edm.Double"].indexOf(g)>-1;let d=i.some(function(e){return e.property===t||"{"+e.property+"}"===t});const l=i.filter(function(e){return e.property===t||"{"+e.property+"}"===t})[0];if(l?.formatterName==="format.unit"&&typeof l?.parameters[1].properties[0].value!=="number"){d=false}const f=r.some(function(e){return e.name===t});const y=a.some(e=>{const{name:n,propertyKeyForId:o}=e;return n===t||`${n}/${o}`===t});const m=s.some(function(e){return e.sourceProperty===t&&e.downDifference});const P=c.some(function(e){return e.sourceProperty===t&&e.targetUnit});e.setProperty("/configuration/advancedFormattingOptions/isFormatterApplied",d);e.setProperty("/configuration/advancedFormattingOptions/isFormatterEnabled",u||p);e.setProperty("/configuration/advancedFormattingOptions/isUOMApplied",f);e.setProperty("/configuration/advancedFormattingOptions/isCriticalityApplied",y);e.setProperty("/configuration/advancedFormattingOptions/isTrendApplied",m);e.setProperty("/configuration/advancedFormattingOptions/isIndicatorsApplied",P);const v=e.getProperty("/configuration/trendOptions");const h=e.getProperty("/configuration/indicatorsValue");if(v){const{referenceValue:t,downDifference:n,upDifference:o}=v;if(t&&n&&o){e.setProperty("/configuration/trendOptions/upDown",true)}}if(h){const{targetValue:t,deviationValue:n,targetUnit:o,deviationUnit:r}=h;if(t&&n&&o&&r){e.setProperty("/configuration/indicatorsValue/targetDeviation",true)}}}function rt(t,e,n){const o=n.getProperty("/configuration/navigationProperty");if(t.includes("/")&&o){const[e,n]=t.split("/");const r=o.find(t=>t.name===e);const i=r?.properties.find(t=>t.name===n);return i?.type}return e.find(e=>e.name===t)?.type||""}function it(t,n,o){const r=t.getSource();let i=r.getSelectedKey()||"";const a=t.getParameter("newValue");let s=i!==""?`{${i}}`:a;const c=X();if(o==="navSelection"){const t=c.getProperty("/configuration/navigationValue");s=t?`{${t}}`:""}if(!i&&o==="mainIndicator"){s=""}if(i!==""||s!==""){r.setValueState(D.None)}const g=n(s);const u=R();const p=e(u,g);if(s===""&&o==="mainIndicator"){delete p["sap.card"].header.mainIndicator;delete p["sap.card"].header.sideIndicators}c.setProperty("/configuration/advancedFormattingOptions/sourceProperty",i);if(o==="navSelection"){i=c.getProperty("/configuration/mainIndicatorStatusKey")}xt(i);G(p,X());L(X())}function at(t){const e=t=>({"sap.card":{header:{title:t}}});st(t,"title");it(t,e)}function st(t,e){const n=t.getSource();const o=n.getSelectedKey();const r=t.getParameter("newValue");const i=X();const a=i.getProperty("/configuration/errorControls");const s=X("i18n")?.getResourceBundle();const c=t=>{switch(t){case"title":return s?.getText("GENERATOR_CARD_TITLE");case"stateIndicator":return s?.getText("GENERATOR_MAIN_INDICATOR");default:return s?.getText("GENERATOR_GROUP_PROPERTY")}};const g=s?.getText("GENERIC_ERR_MSG",[c(e??"")]);if(!o&&!r&&e==="title"){a?.push(n);n.setValueStateText(g)}else if(!o&&r){a?.push(n);n.setValueState(D.Error);n.setValueStateText(g)}else{a?.forEach((t,e)=>{if(n.getId()===t.getId()){a.splice(e,1)}});n.setValueState(D.None)}}function ct(t){const e=t=>{const e=X();return{"sap.card":{header:{subTitle:K(t,{unitOfMeasures:e.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures"),textArrangements:e.getProperty("/configuration/advancedFormattingOptions/textArrangements"),propertyValueFormatters:e.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters")})}}}};it(t,e)}function gt(t){const e=t=>{const e=X();return{"sap.card":{header:{unitOfMeasurement:K(t,{unitOfMeasures:e.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures"),textArrangements:e.getProperty("/configuration/advancedFormattingOptions/textArrangements"),propertyValueFormatters:e.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters")})}}}};it(t,e)}function ut(t,e){if(t.name&&e[t.name]!==undefined&&e[t.name]!==null){const n=t?.value;n?.forEach(n=>{const o=e[t.name];if(o[n.name]!==undefined&&o[n.name]!==null){const t=o[n.name];const e=b(n,t);n.labelWithValue=e}else{n.labelWithValue=`${n.label} (<empty>)`}})}else{t.value=[]}}function pt(t){const e=X();const n=t=>({"sap.card":{header:{mainIndicator:{state:nt(t),number:K(t,{unitOfMeasures:e.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures"),textArrangements:e.getProperty("/configuration/advancedFormattingOptions/textArrangements"),propertyValueFormatters:e.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters")})}}}});const o=t.getSource();const r=o.getSelectedKey();const i=e.getProperty("/configuration/mainIndicatorStatusKeyInitial");const a=e.getProperty("/configuration/mainIndicatorStatusKey");const s=i??a;if(!i){e.setProperty("/configuration/mainIndicatorStatusKeyInitial",s)}else{e.setProperty("/configuration/mainIndicatorStatusKey",s)}const c=e.getProperty("/configuration/mainIndicatorStatusKey");yt(r,c,e,"header");e.setProperty("/configuration/navigationValue",`${s}/${r}`);e.setProperty("/configuration/mainIndicatorNavigationSelectedKey",r);e.setProperty("/configuration/mainIndicatorStatusKey",`${c}/${r}`);it(t,n,"navSelection")}function dt(t,e){let n;let o;const r=t.getProperty("/configuration/navigationProperty");const[i,a]=e.split("/");if(a&&r){const e=r.find(t=>t.name===i);const s=e?.properties.find(t=>t.name===a);n=s?.type;o=t.getProperty("/configuration/$data")[i][a]}else{n=t.getProperty("/configuration/properties").find(t=>t.name===e)?.type;o=t.getProperty("/configuration/$data")[e]}return{propertyType:n,selectedValue:o}}function lt(t,e){let n=true;const{propertyType:o,selectedValue:r}=dt(t,e);if(o==="Edm.String"){n=!isNaN(Number(r))}const i=W(o);const a=!(o==="Edm.Boolean"||o==="Edm.Guid"||i)&&n;const s=["Edm.Decimal","Edm.Int16","Edm.Int32","Edm.Double"].indexOf(o)>-1;t.setProperty("/configuration/advancedFormattingOptions/isUoMEnabled",a);t.setProperty("/configuration/advancedFormattingOptions/isTrendEnabled",s)}function ft(t){const{rootComponent:e,entitySet:o}=H.getInstance().fetchDetails();const r=t.getSource();let i=r.getSelectedKey()||"";const a=X();const s=r?.getBindingContext()?.getPath();const c=a.getProperty(s);const g=`{${c.name}/${i}}`;c.value=i&&K(g,{unitOfMeasures:a.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures"),textArrangements:a.getProperty("/configuration/advancedFormattingOptions/textArrangements"),propertyValueFormatters:a.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters")});yt(i,c.name,a,"content");const u=n.getPropertyLabel(e.getModel(),o,c.name,k.NavigationProperty);const p=u?.properties?.find(t=>t.name===i);const d=p?p.label:"";c.label=d?d:"";a.refresh();w(a);i=`${c.name}/${i}`;xt(i);L(X())}function yt(t,e,n,o){const r=o==="header"?n.getProperty("/configuration/selectedHeaderNavigation"):n.getProperty("/configuration/selectedContentNavigation");const i=r.findIndex(t=>t.name===e);if(i!==-1){const e=r[i];const n=e?.value?.includes(t)?e.value:[...e.value,t];r[i]={...e,value:n}}else{const n=e;r.push({name:n,value:[t]})}const a=o==="header"?"/configuration/selectedHeaderNavigation":"/configuration/selectedContentNavigation";n.setProperty(a,r)}function mt(t){return X("i18n").getObject(t)}function Pt(t){const e=X();const n=t.getSource();const o=n.getBindingContext()?.getPath();if(o){const t=e.getProperty(o);if(!t.items){t.items=[]}const n=e.getProperty(o).items.length;const r={label:null,value:`{/items/${n}}`,isEnabled:false,isNavigationEnabled:false,navigationalProperties:[]};e.getProperty(o).items.push(r);const i=e.getProperty(o).items.length;e.setProperty(o+"/enableAddMoreGroupItems",true);if(i===tt){e.setProperty(o+"/enableAddMoreGroupItems",false)}e.setProperty("/configuration/isEdited",true);e.refresh()}}function vt(){let t=false;const e=X();const n=e.getProperty("/configuration/errorControls");n?.forEach(e=>{if(!e.getValue()||e.getValueState()=="Error"){e.setValueState(D.Error);t=true}});return t}function ht(t){const e=X();const n=e.getProperty("/configuration/indicatorsValue");let o=false;const{targetValue:r,deviationValue:i,targetUnit:a,deviationUnit:s}=n;if(!r){e.setProperty("/configuration/indicatorsValue/targetValueState","Error");const n=t+"--targetInputValue";Et(n,mt("TARGET_VALUE_ERR_MSG"))}if(!i){e.setProperty("/configuration/indicatorsValue/deviationValueState","Error");const n=t+"--deviationInputValue";Et(n,mt("DEVIATION_VALUE_ERR_MSG"))}if(!a){e.setProperty("/configuration/indicatorsValue/targetUnitValueState","Error");const n=t+"--targetUnitInput";Et(n,mt("TARGET_UNIT_ERR_MSG"),true)}if(!s){e.setProperty("/configuration/indicatorsValue/deviationUnitValueState","Error");const n=t+"--deviationUnitInput";Et(n,mt("DEVIATION_UNIT_ERR_MSG"),true)}if(!r||!i||!a||!s){o=true}return o}function Ot(t){const e=X();const n=e.getProperty("/configuration/trendOptions");let o=false;const{referenceValue:r,downDifference:i,upDifference:a}=n;if(!r){e.setProperty("/configuration/trendOptions/referenceValueState","Error");const n=t+"--trendReferenceValueInput";Et(n,mt("REF_ERR_MSG"))}if(!i){e.setProperty("/configuration/trendOptions/downDifferenceValueState","Error");const n=t+"--trendDownDifferenceInput";Et(n,mt("LOW_RANGE_ERR_MSG"))}if(!a){e.setProperty("/configuration/trendOptions/upDifferenceValueState","Error");const n=t+"--trendUpDifferenceInput";Et(n,mt("HIGH_RANGE_ERR_MSG"))}if(!r||!i||!a){o=true}return o}function Et(t,e,n){const o=a?.getElementById(t);o.key=e;const r=n?!o?.getSelectedKey()||o.getValueState()=="Error":!o?.getValue()||o.getValueState()=="Error";if(r){const t=X("i18n")?.getResourceBundle();const e=t?.getText("GENERIC_ERR_MSG",[o?.key]);o?.setValueStateText(e)}}function St(t){const e=X();const n=e.getProperty("/configuration/groups").length;const o=X("i18n")?.getResourceBundle()?.getText("GENERATOR_DEFAULT_GROUP_NAME",[n+1]);e.getProperty("/configuration/groups").push({title:o,items:[{label:null,value:"{/items/0}",isEnabled:false,isNavigationEnabled:false,navigationalProperties:[]}],newItem:{label:null,value:null,isEnabled:false,isNavigationEnabled:false,navigationalProperties:[]}});const r=e.getProperty("/configuration/groups").length;if(r===Z){e.setProperty("/configuration/groupLimitReached",true)}e.setProperty("/configuration/isEdited",true);e.refresh();w(e);L(X())}function Ft(t){const e=X();const n=t.getSource().getBindingContext().getPath();const o=n.split("/configuration/groups/")[1];e.getProperty("/configuration/groups").splice(o,1);const r=e.getProperty("/configuration/groups").length;if(r<Z){e.setProperty("/configuration/groupLimitReached",false)}delete q._itemActionsMenu;e.setProperty("/configuration/isEdited",true);e.refresh();w(e);xt();L(X())}function It(t){const e=X("i18n")?.getResourceBundle();const n=e?.getText("GENERATOR_DELETE_GROUP_WARNING")||"";o.warning(n,{actions:[o.Action.DELETE,o.Action.CANCEL],emphasizedAction:o.Action.DELETE,onClose:function(e){if(e==="DELETE"){Ft(t)}}})}function Ct(t){const e=t.getParameters().newValue;const n=X();const o=t.getSource().getBindingContext().getPath();const r=n.getProperty(o);r.title=e;n.refresh();w(n);L(X())}function Vt(t){const e=X();const n=t.getSource().getBindingContext().getPath();const[o,r]=n.match(/(\d+)/g).map(function(t){return Number(t)});e.getProperty("/configuration/groups/"+o).items.splice(r,1);const i=e.getProperty("/configuration/groups/"+o).items.length;if(i<tt){e.setProperty("/configuration/groups/"+o+"/enableAddMoreGroupItems",true)}q._itemActionsMenu?.destroy();delete q._itemActionsMenu;e.setProperty("/configuration/isEdited",true);e.refresh();w(e);xt();L(X())}function At(){const t=X();let n=t.getProperty("/configuration/trendOptions");const o=t.getProperty("/configuration/selectedTrendOptions");const r={"sap.card":{header:{mainIndicator:{trend:"None"}}}};let i=-1;o?.forEach((e,o)=>{if(e.sourceProperty===n.sourceProperty){i=o;n={...e,...n};t.setProperty("/configuration/trendOptions",n)}});const{referenceValue:a,downDifference:s,upDifference:c,sourceProperty:g}=n;if(a&&s&&c&&g){const t={referenceValue:a,downDifference:s,upDifference:c,sourceProperty:g};if(i!==-1){o[i]=t}else{o.push(t)}const e={referenceValue:Number(a),downDifference:Number(s),upDifference:Number(c)};r["sap.card"]["header"]["mainIndicator"]["trend"]=Dt(e)}const u=R();const p=e(u,r);G(p,X());L(X())}function Tt(){const t=X();let n=t.getProperty("/configuration/indicatorsValue");const o=t.getProperty("/configuration/selectedIndicatorOptions");let r=-1;o?.forEach((e,o)=>{if(e.sourceProperty===n.sourceProperty){r=o;n={...e,...n};t.setProperty("/configuration/indicatorsValue",n)}});let i={"sap.card":{header:{sideIndicators:[{title:"",number:"",unit:""},{title:"",number:"",unit:""}]}}};const{targetValue:a,deviationValue:s,targetUnit:c,deviationUnit:g,sourceProperty:u}=n;if(a&&s&&c&&g&&u){const e={targetValue:a,deviationValue:s,targetUnit:c,deviationUnit:g,sourceProperty:u};if(r!==-1){o[r]=e}else{o.push(e)}t.setProperty("/configuration/indicatorsValue/targetDeviation",a);i={"sap.card":{header:{sideIndicators:[{title:"Target",number:a,unit:c},{title:"Deviation",number:s,unit:g}]}}}}const p=R();const d=e(p,i);G(d,X());t.refresh();L(X())}function Dt(t){const e=X();const n=e.getProperty("/configuration/mainIndicatorStatusKey");const o=e.getProperty("/configuration/trendOptions");const{referenceValue:r}=o;if(n&&t){e.setProperty("/configuration/trendOptions/upDown",r);return"{= extension.formatters.formatTrendIcon(${"+n+"},"+JSON.stringify(t)+") }"}return"None"}function xt(t){const e=X();const n=X("i18n")?.getResourceBundle();const o=n?.getText("UNSELECTED_ITEM");const r=$(e);const i={unitOfMeasures:"/configuration/advancedFormattingOptions/unitOfMeasures",textArrangements:"/configuration/advancedFormattingOptions/textArrangements",criticality:"/configuration/mainIndicatorOptions/criticality"};["unitOfMeasures","textArrangements","criticality"].forEach(n=>{const a=i[n];const s=e.getProperty(a)??[];s.forEach((n,s)=>{let c=n.name;let g=false;if(a===i.criticality&&n.isNavigationForId&&n.navigationKeyForId!==""){c=`${n.name}/${n.navigationKeyForId}`}if(n.isNavigationForId&&n.navigationKeyForId!==""){g=true}const u=r.includes(c);if(!u&&n.valueState!==D.Information){e.setProperty(`${a}/${s}/valueState`,D.Information);e.setProperty(`${a}/${s}/valueStateText`,o);if(g){e.setProperty(`${a}/${s}/navigationValueState`,D.Information);e.setProperty(`${a}/${s}/navigationValueStateText`,o)}}else if(u&&t&&t===c&&n.valueState===D.Information){e.setProperty(`${a}/${s}/valueState`,D.None);e.setProperty(`${a}/${s}/valueStateText`,"");if(g){e.setProperty(`${a}/${s}/navigationValueState`,D.None);e.setProperty(`${a}/${s}/navigationValueStateText`,"")}}})})}function Nt(t){const e=t.getParameters().newValue;const n=X();const o=t.getSource().getBindingContext().getPath();const r=n.getProperty(o);r.label=e;n.refresh();w(n);L(X())}function bt(t){const e=t.getParameter("draggedControl"),n=t.getParameter("droppedControl"),o=t.getParameter("dropPosition"),r=X(),i=e.getParent(),a=n.getParent(),s=i.getBindingContext().getPath(),c=a.getBindingContext().getPath(),g=r.getProperty(s).items,u=r.getProperty(c).items,p=i.indexOfItem(e),d=a.indexOfItem(n);const l=g[p];if(o==="Before"&&u.length<tt){g.splice(p,1);u.splice(d,0,l)}else if(o&&u.length<tt){g.splice(p,1);u.splice(d+1,0,l)}if(g.length<tt){r.setProperty(s+"/enableAddMoreGroupItems",true)}if(u.length===tt){r.setProperty(c+"/enableAddMoreGroupItems",false)}r.refresh();w(r);L(X())}function _t(){const t=a.getElementById("cardGeneratorDialog--cardPreview");t.setWidth();t.setHeight();a.getElementById("cardGeneratorDialog--widthInput")?.setValue("");a.getElementById("cardGeneratorDialog--heightInput")?.setValue("");t.refresh()}function Mt(t){const e=a.getElementById("cardGeneratorDialog--cardPreview");const n=Number(t.getParameters().newValue);n>200?e.setHeight(n+"px"):e.setHeight("232px");e.refresh()}function Bt(t){const e=a.getElementById("cardGeneratorDialog--cardPreview");const n=Number(t.getParameters().newValue);n>200?e.setWidth(n+"px"):e.setWidth("582px");e.refresh()}function Rt(){const t=X();if(t){if(!t.getProperty("/configuration/isEdited")){Zt()}const e=t.getProperty("/configuration/errorControls");e?.forEach(t=>{t.setValueState(D.None)})}J().close()}function $t(t){const e=X();const n=e?.getProperty("/configuration/mainIndicatorOptions/criticality");let o;const r=n?.filter(e=>{const{name:n,propertyKeyForId:o}=e;return n===t||`${n}/${o}`===t});if(r){o=JSON.parse(JSON.stringify(r))}if(r?.length===1){o[0].hostCriticality=r[0].criticality;delete o.criticality;e?.setProperty("/configuration/advancedFormattingOptions/sourceCriticalityProperty",o)}else{e?.setProperty("/configuration/advancedFormattingOptions/sourceCriticalityProperty",[{name:t}])}}function Gt(t,e){const n=X();const o=t.getParameter("item");const r=o.getKey();n.setProperty("/configuration/popoverContentType",r);const i=n.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures");const a=n.getProperty("/configuration/advancedFormattingOptions/sourceUoMProperty");if(i.length>0){const t=i.filter(t=>t.name===a)[0];if(t){n.setProperty("/configuration/advancedFormattingOptions/targetProperty",t.value)}}if(Q.indexOf(a)===-1){n.setProperty("/configuration/advancedFormattingOptions/targetProperty","")}Kt(t,e)}function wt(t){const e=t.getSource();const n=X();let o=n.getProperty("/configuration/mainIndicatorStatusKey");const r=n.getProperty("/configuration/mainIndicatorNavigationSelectedKey");if(r&&!o.includes("/")){o=`${o}/${r}`}n.setProperty("/configuration/advancedFormattingOptions/targetFormatterProperty",o);n.setProperty("/configuration/advancedFormattingOptions/sourceUoMProperty",o);lt(n,o);$t(o);ot(o);if(!q._advancedFormattingOptionsPopover){s.load({id:"advancedFormattingOptions",name:"sap.cards.ap.generator.app.fragments.configuration.AdvancedFormattingOptions",controller:{onFormatTypeSelection:function(t){et.onFormatTypeSelection(t,e)}}}).then(function(t){q._advancedFormattingOptionsPopover=t;e.addDependent(t);return t}).then(function(t){const n=e.getBindingContext();t.setBindingContext(n);t.openBy(e)})}else{const t=e.getBindingContext();q._advancedFormattingOptionsPopover.setBindingContext(t);q._advancedFormattingOptionsPopover.openBy(e)}}function Kt(t,e){const n=X();const o={onPopoverClose:t=>{const e=t.getSource();e?.destroy()},onPropertyFormatterChange:()=>{qt();const t=e?.getId();const n=a.getElementById(t+"--advanceFormattingPopover");n?.close()},applyCriticality:()=>Ut(t),applyUoMFormatting:()=>Lt(),applyFormatting:()=>{const t=e?.getId();a.getElementById(t+"--headerFormatterEditor").applyFormatter();L(X())},resetValueState(t,e){const n=t.getSource();const o=!e?t.getParameters().newValue:n.getSelectedKey();if(o!==""){n.setValueState(D.None)}},onDownDifferenceChange(t){n.setProperty("/configuration/trendOptions/downDifferenceValueState","None");this.resetValueState(t)},onUpDifferenceChange(t){n.setProperty("/configuration/trendOptions/upDifferenceValueState","None");this.resetValueState(t)},onReferenceValInputChange(t){n.setProperty("/configuration/trendOptions/referenceValueState","None");this.resetValueState(t)},onTargetValueChange(t){n.setProperty("/configuration/indicatorsValue/targetValueState","None");this.resetValueState(t)},onDeviationValueChange(t){n.setProperty("/configuration/indicatorsValue/deviationValueState","None");this.resetValueState(t)},onTargetUnitChange(t){n.setProperty("/configuration/indicatorsValue/targetUnitValueState","None");this.resetValueState(t,true)},onDeviationUnitChange(t){n.setProperty("/configuration/indicatorsValue/deviationUnitValueState","None");this.resetValueState(t,true)},applyIndicators:()=>{const t=e?.getId();const n=ht(t);if(!n){Tt();q?._advancedFormattingConfigurationPopover?.close()}},applyTrendCalculation:()=>{const t=e?.getId();const n=Ot(t);if(!n){At();q?._advancedFormattingConfigurationPopover?.close()}},onDelete:()=>{const t=X();const e=t?.getProperty("/configuration/advancedFormattingOptions/sourceUoMProperty");const n=Q?.indexOf(e);Q?.splice(n,1);t?.setProperty("/configuration/advancedFormattingOptions/targetProperty","");const o="/configuration/advancedFormattingOptions/unitOfMeasures",r=t?.getProperty(o);let i=-1;const a=t.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters");const s=a.filter(t=>t.property!==e);t.setProperty("/configuration/advancedFormattingOptions/propertyValueFormatters",s);t.setProperty("/configuration/isEdited",true);for(let t=0;t<r.length;t++){if(r[t]?.name===e){i=t}}if(i>=0&&o){const e=o+"/"+i;r?.splice(e.slice(e.length-1),1);qt();t?.refresh()}q?._advancedFormattingConfigurationPopover?.close()},onTrendDelete:()=>Ht(),onIndicatorsDelete:()=>{const t=X();const e=t.getProperty("/configuration/indicatorsValue");const n=t.getProperty("/configuration/selectedIndicatorOptions");let o=-1;n?.forEach((t,n)=>{if(t.sourceProperty===e.sourceProperty){o=n}});if(o!==-1){n.splice(o,1)}t.setProperty("/configuration/indicatorsValue",{});t.setProperty("/configuration/isEdited",true);Tt();q?._advancedFormattingConfigurationPopover?.close()},onDeleteFormatter:()=>{const t=e?.getId();const n=X();n.setProperty("/configuration/isEdited",true);a.getElementById(t+"--headerFormatterEditor").deleteFormatter();L(X())},onDeleteCriticality:t=>{const n=X();const o=e?.getId();a.getElementById(o+"--headerCriticalityEditor").onDeleteButtonClicked(t);n.setProperty("/configuration/advancedFormattingOptions/selectedKeyCriticality","");n.setProperty("/configuration/isEdited",true);Qt(false);q?._advancedFormattingConfigurationPopover?.close()}};if(t?.getParameter("item")?.getKey?.()==="uom"){o.applyUoMFormatting()}if(t.getSource()?.getParent()?.close){t.getSource().getParent().close()}Wt(e,o)}function Ut(t){const e=X();const n=e?.getProperty("/configuration/mainIndicatorOptions/criticality");let o=e?.getProperty("/configuration/advancedFormattingOptions/sourceCriticalityProperty");o=o?.[0];const r=e?.getProperty("/configuration/navigationProperty");const i=o?.name?.includes("/");if(i){o.propertyKeyForId=o.name.split("/")[1];o.navigationKeyForId=o.name.split("/")[1];o.name=o.name.split("/")[0];o.isNavigationForId=true;const t=r?.filter(t=>t?.name===o?.name.split("/")[0]);o.navigationalPropertiesForId=t[0]?.properties}if(o?.hostCriticality!==o?.criticality){o.criticality=o.hostCriticality}const a=n?.some(t=>{const{name:e,propertyKeyForId:n}=t;if(i){return e===o?.name&&n===o?.propertyKeyForId}else{return e===o?.name}});if(!a&&o){delete o.hostCriticality;n?.push(o)}else{for(let t=0;t<n.length;t++){if(n[t]?.name===o?.name){delete n[t];delete o.hostCriticality;n[t]=o}}}e?.setProperty("/configuration/mainIndicatorOptions/criticality",n);Qt(t.getParameter("isCalcuationType")||false);q?._advancedFormattingConfigurationPopover?.close()}function Lt(){const t=X();const e=t?.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures"),n=t?.getProperty("/configuration/advancedFormattingOptions/sourceUoMProperty");let o=e?.filter(t=>t?.name===n),r=t?.getProperty("/configuration/advancedFormattingOptions/targetProperty");o=o?.[0];if(!r&&o){t.setProperty("/configuration/advancedFormattingOptions/targetProperty",o?.propertyKeyForDescription)}r=t?.getProperty("/configuration/advancedFormattingOptions/targetProperty");const i=n.includes("/")?n.split("/")[0]:n;const a=t.getProperty("/configuration/navigationProperty");let s=[];if(n.includes("/")&&a){s=kt(a,i)}const c={propertyKeyForId:i,name:n,value:r,navigationalPropertiesForId:s.length===0?"":s,isNavigationForId:n.includes("/")?true:false,navigationKeyForId:n.includes("/")?n.split("/")[1]:"",propertyKeyForDescription:r,isNavigationForDescription:false,navigationKeyForDescription:""};let g=false;e.forEach(t=>{if(t.name===c.name){g=true;t.propertyKeyForDescription=c.value;t.value=c.value}});if(!g&&n&&r){e.push(c)}t.setProperty("/configuration/advancedFormattingOptions/unitOfMeasures",e);qt();for(let t=0;t<e.length;t++){if(e[t].value!==""&&Q?.indexOf(e[t]?.name)===-1){Q?.push(e[t]?.name)}}q?._advancedFormattingConfigurationPopover?.close()}function kt(t,e){for(const n of t){if(e===n?.name){return n.properties}}return[]}function Ht(){const t=X();const e=t.getProperty("/configuration/trendOptions");const n=t.getProperty("/configuration/selectedTrendOptions");let o=-1;n?.forEach((t,n)=>{if(t.sourceProperty===e.sourceProperty){o=n}});if(o!==-1){n.splice(o,1)}t.setProperty("/configuration/trendOptions",{});t.setProperty("/configuration/isEdited",true);At();q?._advancedFormattingConfigurationPopover?.close()}function Wt(t,e){s.load({id:t.getId(),name:"sap.cards.ap.generator.app.fragments.configuration.AdvancedFormattingConfiguration",controller:e}).then(function(e){q._advancedFormattingConfigurationPopover=e;const n=X("i18n")?.getResourceBundle();const o={uomText:n?.getText("SELECT_UOM_TEXT"),criticalityText:n?.getText("SELECT_CRITICALITY_TEXT"),formatterText:n?.getText("SELECT_FORMATTER_TEXT"),indicatorsText:n?.getText("SELECT_INDICATORS_TEXT"),trendCalculatorText:n?.getText("TREND_CALCULATION_TEXT")};e.setModel(new u(o),"i18nLabelText");t.addDependent(e);return e}).then(function(e){const n=t.getBindingContext();e.setBindingContext(n);e.openBy(t);return e})}function jt(t){const e=X();const n=t?.getSource().getBindingContext().getPath();const o=e?.getProperty(n)?.name;const r=e?.getProperty(n)?.navigationProperty;const i=r?o+"/"+r:o;const a=t.getSource();lt(e,i);ot(i);const g={onNavigationActionSelect:t=>{const e=t.getParameter("item").getId();const n=X();if(e==="formatter"||e==="uom"){Jt(e,t,n);Kt(t,t.getSource().getParent())}else if(e==="criticality"){const o=Xt(e,t,n);$t(o);Kt(t,t.getSource().getParent())}else if(e==="actions"){}else{const e=t.getParameter("item");const o=e.getCustomData();const r=o.filter(t=>t.getKey()==="action")[0];const i=r.getValue();const a=t.getSource();const s=a.getBindingContext().getPath();const[c,g]=s.match(/(\d+)/g).map(t=>Number(t));const u=n.getProperty("/configuration/groups/"+c);const p=u.items[g];if(i==="add"){let t="";const n=e.getId();switch(n){case"url":t=`${p.value}`;break;case"email":t=`mailto: ${p.value}`;break;case"tel":t=`tel: ${p.value}`;break;default:break}if(t===""){return}const o=[{type:"Navigation",parameters:{url:t}}];p["hasActions"]=true;p["actionType"]=n;p["actions"]=o}if(i==="remove"&&p.hasActions){delete p.hasActions;delete p.actionType;delete p.actions}}n.refresh();w(n);L(X())}};if(!q._itemActionsMenu||q?._itemActionsMenu?.isDestroyed()){s.load({name:"sap.cards.ap.generator.app.fragments.configuration.ItemActions",controller:g}).then(function(t){q._itemActionsMenu=t;const e=a.getBindingContext();t.setBindingContext(e);a.addDependent(t);q._itemActionsMenu.open(false,a,c.Dock.BeginTop,c.Dock.BeginBottom,a)}.bind(g))}else{const t=a.getBindingContext();q._itemActionsMenu.setBindingContext(t);a.addDependent(q._itemActionsMenu);q._itemActionsMenu.open(false,a,c.Dock.BeginTop,c.Dock.BeginBottom,a)}}function Jt(t,e,n){n?.setProperty("/configuration/popoverContentType",t);const o=e.getSource().getBindingContext().getPath();const r=n.getProperty(o)?.navigationProperty;const i=n.getProperty(o)?.name+(r?"/"+r:"");n?.setProperty("/configuration/advancedFormattingOptions/targetFormatterProperty",i);n?.setProperty("/configuration/advancedFormattingOptions/sourceUoMProperty",i);const a=n?.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures");const s=n?.getProperty("/configuration/advancedFormattingOptions/sourceUoMProperty");if(a.length>0){const t=a.filter(t=>t.name===s)[0];if(t){n?.setProperty("/configuration/advancedFormattingOptions/targetProperty",t.value)}}if(Q.length&&Q.indexOf(s)===-1){n?.setProperty("/configuration/advancedFormattingOptions/targetProperty","")}}function Xt(t,e,n){n?.setProperty("/configuration/popoverContentType",t);const o=e.getSource().getBindingContext().getPath();const r=n?.getProperty(o)?.navigationProperty;let i=n?.getProperty(o)?.name;if(r){i=`${i}/${r}`}return i}function zt(t){const e=t.getSource().getSelectedItem().getBindingContext("previewOptions").getProperty("type");const n=a.getElementById("cardGeneratorDialog--cardPreview");const o=a.getElementById("cardGeneratorDialog--adaptiveCardPreviewContainer");const r=a.getElementById("cardGeneratorDialog--custom-entry");n.setVisible(false);o.setVisible(false);r.setVisible(false);switch(e){case"adaptive":o.setVisible(true);setTimeout(()=>{L(X())},0);break;case"custom":n.setVisible(true);r.setVisible(true);break;case"integration":n.setVisible(true);n.setWidth(t.getSource().getSelectedItem().getBindingContext("previewOptions").getProperty("width"));n.setHeight(t.getSource().getSelectedItem().getBindingContext("previewOptions").getProperty("height"));break;default:n.setVisible(true);n.setWidth(t.getSource().getSelectedItem().getBindingContext("previewOptions").getProperty("width"));n.setHeight(t.getSource().getSelectedItem().getBindingContext("previewOptions").getProperty("height"));break}}function Yt(){const t=X();const n=R();const o=n["sap.card"].header;const r=U(o.subTitle,n);const i=U(o.unitOfMeasurement,n);const a=t.getProperty("/configuration/navigationValue")||t.getProperty("/configuration/mainIndicatorStatusKey");const s=t.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures");const c=t.getProperty("/configuration/advancedFormattingOptions/textArrangements");const g=t.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters");const u={"sap.card":{header:{mainIndicator:{number:a&&K(`{${a}}`,{unitOfMeasures:s,textArrangements:c,propertyValueFormatters:g})},subTitle:K(r,{unitOfMeasures:s,textArrangements:c,propertyValueFormatters:g}),unitOfMeasurement:K(i,{unitOfMeasures:s,textArrangements:c,propertyValueFormatters:g})}}};t.setProperty("/configuration/isEdited",true);const p=e(n,u);G(p,X())}function qt(){const t=X();Yt();const e=t.getProperty("/configuration/groups");e?.forEach(function(e){e?.items?.forEach(e=>{if(e.name&&e.name!==""){const n=e.isNavigationEnabled?`${e.name}/${e.navigationProperty}`:e.name;e.value=K(`{${n}}`,{unitOfMeasures:t.getProperty("/configuration/advancedFormattingOptions/unitOfMeasures"),textArrangements:t.getProperty("/configuration/advancedFormattingOptions/textArrangements"),propertyValueFormatters:t.getProperty("/configuration/advancedFormattingOptions/propertyValueFormatters")})}})});t.refresh();w(t);L(X())}function Qt(t){const n=R();const o=X();const r=n["sap.card"].header.mainIndicator;const i=n["sap.card"].content.groups;if(!r&&i.length<1){return}let a;if(r){const o=U(r.number,n);const i={"sap.card":{header:{mainIndicator:{state:nt(o||r.number,t)}}}};a=e(n,i)}else{a=n}o.setProperty("/configuration/isEdited",true);G(a,X());w(o);L(X())}function Zt(){const t=a.getElementById("cardGeneratorDialog--cardGeneratorDialog");const e=t.getCustomHeader().getContentMiddle()[4];if(e.getPressed()){e.setPressed(false);const t=new i("toggle",e,{});S(t)}}function te(){const t=a.getElementById("cardGeneratorDialog--preview-select");if(t){const e=t.getSelectedKey();if(e!=="int-default"){t.setSelectedKey("int-default");const e=a.getElementById("cardGeneratorDialog--cardPreview");const n=a.getElementById("cardGeneratorDialog--adaptiveCardPreviewContainer");const o=a.getElementById("cardGeneratorDialog--custom-entry");n.setVisible(false);o.setVisible(false);e.setVisible(true);const r=X("previewOptions").getProperty("/hosts");const i=r.find(t=>t.key==="int-default");e.setWidth(i.width);e.setHeight(i.height)}}}function ee(t){const e=X();const n=e?.getProperty("/configuration/isEdited");const r=X("i18n")?.getResourceBundle();const i=r?.getText("GENERATOR_UNSAVED_CHANGE_WARNING")||"";if(n){o.warning(i,{actions:[o.Action.OK,o.Action.CANCEL],emphasizedAction:o.Action.OK,onClose:function(t){if(t==="OK"){e.setProperty("/configuration/isEdited",false);Zt();Rt()}}});t.preventDefault()}}var ne={__esModule:true};ne.CardGeneratorDialogController=et;ne.getCriticality=nt;ne.setValueStateForAdvancedPanel=xt;ne.toggleOffAdvancedPanel=Zt;return ne});
//# sourceMappingURL=CardGeneratorDialogController.js.map