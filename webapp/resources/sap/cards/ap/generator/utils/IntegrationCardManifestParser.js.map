{"version":3,"file":"IntegrationCardManifestParser.js","names":["sap","ui","define","___odata_ODataUtils","___pages_Application","getMetaModelObjectForEntitySet","Application","ODataModelVersion","getAllValues","subManifest","values","key","value","push","getQueryParameters","applicationInstance","getInstance","rootComponent","getRootComponent","model","getModel","entitySet","odataModel","fetchDetails","isODataV4Model","V4","properties","navigationProperties","complexProperties","getMetaModel","queryParameters","filter","property","some","includes","name","map","forEach","navigationProperty","navigationPropertyName","selectedProperties","length","complexProperty","complexPropertyName","selectedComplexProperties","concat","getHeaderProperties","cardManifest","header","getContentProperties","content","contentQueryParams","footerQueryParams","getFooterProperties","selectedNavigationProperties","actionsStrips","footer","actionsStrip","actions","enabled","__exports","__esModule"],"sources":["IntegrationCardManifestParser.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport type { CardManifest } from \"sap/ui/integration/widgets/Card\";\nimport V2ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\nimport V4ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport { QueryParameters } from \"../helpers/Batch\";\nimport { getMetaModelObjectForEntitySet } from \"../odata/ODataUtils\";\nimport { Application, ODataModelVersion } from \"../pages/Application\";\n\ntype Model = V2ODataModel | V4ODataModel;\n\nconst getAllValues = (subManifest: Record<string, string>): string[] => {\n\tconst values: string[] = [];\n\n\tfor (const key in subManifest) {\n\t\tconst value = subManifest[key];\n\t\tif (typeof value === \"string\") {\n\t\t\tvalues.push(subManifest[key]);\n\t\t} else {\n\t\t\tvalues.push(...getAllValues(value));\n\t\t}\n\t}\n\n\treturn values;\n};\n\nconst getQueryParameters = (values: string[]) => {\n\tconst applicationInstance = Application.getInstance();\n\tconst rootComponent = applicationInstance.getRootComponent();\n\tconst model = rootComponent.getModel() as Model;\n\tconst { entitySet, odataModel } = applicationInstance.fetchDetails();\n\tconst isODataV4Model = odataModel === ODataModelVersion.V4;\n\tconst { properties, navigationProperties, complexProperties } = getMetaModelObjectForEntitySet(\n\t\tmodel.getMetaModel(),\n\t\tentitySet,\n\t\tisODataV4Model\n\t);\n\n\tconst queryParameters: QueryParameters = {\n\t\tproperties: [],\n\t\tnavigationProperties: []\n\t};\n\n\tqueryParameters.properties = properties\n\t\t.filter((property) => {\n\t\t\treturn values.some((value) => {\n\t\t\t\treturn value && value.includes(`{${property.name}}`);\n\t\t\t});\n\t\t})\n\t\t.map((property) => property.name);\n\n\tnavigationProperties.forEach((navigationProperty) => {\n\t\tconst navigationPropertyName = navigationProperty.name;\n\t\tconst properties = navigationProperty.properties;\n\t\tconst selectedProperties = properties\n\t\t\t.filter((property) => {\n\t\t\t\treturn values.some((value) => {\n\t\t\t\t\treturn value && value.includes(`{${navigationPropertyName}/${property.name}}`);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.map((property) => property.name);\n\n\t\tif (selectedProperties.length) {\n\t\t\tqueryParameters.navigationProperties.push({\n\t\t\t\tname: navigationPropertyName,\n\t\t\t\tproperties: selectedProperties\n\t\t\t});\n\t\t}\n\t});\n\n\tcomplexProperties.forEach((complexProperty) => {\n\t\tconst complexPropertyName = complexProperty.name;\n\t\tconst properties = complexProperty.properties;\n\t\tconst selectedProperties = properties\n\t\t\t.filter((property) => {\n\t\t\t\treturn values.some((value) => {\n\t\t\t\t\treturn value && value.includes(`{${complexPropertyName}/${property.name}}`);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.map((property) => property.name);\n\n\t\tconst selectedComplexProperties = selectedProperties.map((property) => {\n\t\t\treturn `${complexPropertyName}/${property}`;\n\t\t});\n\t\tif (selectedProperties.length) {\n\t\t\tqueryParameters.properties = queryParameters.properties.concat(selectedComplexProperties);\n\t\t}\n\t});\n\n\treturn queryParameters;\n};\n\nexport const getHeaderProperties = (cardManifest: CardManifest): QueryParameters => {\n\tconst values = getAllValues(cardManifest[\"sap.card\"].header as Record<string, string>);\n\treturn getQueryParameters(values);\n};\n\nexport const getContentProperties = (cardManifest: CardManifest): QueryParameters => {\n\tconst values = getAllValues(cardManifest[\"sap.card\"].content as unknown as Record<string, string>);\n\tconst contentQueryParams = getQueryParameters(values);\n\tconst footerQueryParams = getFooterProperties(cardManifest);\n\tconst selectedProperties = contentQueryParams.properties.concat(footerQueryParams.properties);\n\tconst selectedNavigationProperties = contentQueryParams.navigationProperties.concat(footerQueryParams.navigationProperties);\n\n\treturn {\n\t\tproperties: selectedProperties,\n\t\tnavigationProperties: selectedNavigationProperties\n\t};\n};\n\nconst getFooterProperties = (cardManifest: CardManifest): QueryParameters => {\n\tconst actionsStrips = cardManifest[\"sap.card\"].footer?.actionsStrip;\n\n\tconst values =\n\t\tactionsStrips?.map((actionsStrip) => {\n\t\t\treturn actionsStrip.actions[0].enabled as string;\n\t\t}) || [];\n\n\treturn getQueryParameters(values);\n};\n"],"mappings":";;;;AAAA,aAAAA,IAAAC,GAAAC,OAAA,wDAAAC,EAAAC,GAAA,mBAQSC,EAA8BF,EAAA,wCAC9BG,EAAWF,EAAA,qBAAEG,EAAiBH,EAAA,qBAIvC,MAAMI,EAAgBC,IACrB,MAAMC,EAAmB,GAEzB,IAAK,MAAMC,KAAOF,EAAa,CAC9B,MAAMG,EAAQH,EAAYE,GAC1B,UAAWC,IAAU,SAAU,CAC9BF,EAAOG,KAAKJ,EAAYE,GACzB,KAAO,CACND,EAAOG,QAAQL,EAAaI,GAC7B,CACD,CAEA,OAAOF,GAGR,MAAMI,EAAsBJ,IAC3B,MAAMK,EAAsBT,EAAYU,cACxC,MAAMC,EAAgBF,EAAoBG,mBAC1C,MAAMC,EAAQF,EAAcG,WAC5B,MAAMC,UAAEA,EAASC,WAAEA,GAAeP,EAAoBQ,eACtD,MAAMC,EAAiBF,IAAef,EAAkBkB,GACxD,MAAMC,WAAEA,EAAUC,qBAAEA,EAAoBC,kBAAEA,GAAsBvB,EAC/Dc,EAAMU,eACNR,EACAG,GAGD,MAAMM,EAAmC,CACxCJ,WAAY,GACZC,qBAAsB,IAGvBG,EAAgBJ,WAAaA,EAC3BK,OAAQC,GACDtB,EAAOuB,KAAMrB,GACZA,GAASA,EAAMsB,SAAS,IAAIF,EAASG,WAG7CC,IAAKJ,GAAaA,EAASG,MAE7BR,EAAqBU,QAASC,IAC7B,MAAMC,EAAyBD,EAAmBH,KAClD,MAAMT,EAAaY,EAAmBZ,WACtC,MAAMc,EAAqBd,EACzBK,OAAQC,GACDtB,EAAOuB,KAAMrB,GACZA,GAASA,EAAMsB,SAAS,IAAIK,KAA0BP,EAASG,WAGvEC,IAAKJ,GAAaA,EAASG,MAE7B,GAAIK,EAAmBC,OAAQ,CAC9BX,EAAgBH,qBAAqBd,KAAK,CACzCsB,KAAMI,EACNb,WAAYc,GAEd,IAGDZ,EAAkBS,QAASK,IAC1B,MAAMC,EAAsBD,EAAgBP,KAC5C,MAAMT,EAAagB,EAAgBhB,WACnC,MAAMc,EAAqBd,EACzBK,OAAQC,GACDtB,EAAOuB,KAAMrB,GACZA,GAASA,EAAMsB,SAAS,IAAIS,KAAuBX,EAASG,WAGpEC,IAAKJ,GAAaA,EAASG,MAE7B,MAAMS,EAA4BJ,EAAmBJ,IAAKJ,GAClD,GAAGW,KAAuBX,KAElC,GAAIQ,EAAmBC,OAAQ,CAC9BX,EAAgBJ,WAAaI,EAAgBJ,WAAWmB,OAAOD,EAChE,IAGD,OAAOd,GAGD,MAAMgB,EAAuBC,IACnC,MAAMrC,EAASF,EAAauC,EAAa,YAAYC,QACrD,OAAOlC,EAAmBJ,IAGpB,MAAMuC,EAAwBF,IACpC,MAAMrC,EAASF,EAAauC,EAAa,YAAYG,SACrD,MAAMC,EAAqBrC,EAAmBJ,GAC9C,MAAM0C,EAAoBC,EAAoBN,GAC9C,MAAMP,EAAqBW,EAAmBzB,WAAWmB,OAAOO,EAAkB1B,YAClF,MAAM4B,EAA+BH,EAAmBxB,qBAAqBkB,OAAOO,EAAkBzB,sBAEtG,MAAO,CACND,WAAYc,EACZb,qBAAsB2B,IAIxB,MAAMD,EAAuBN,IAC5B,MAAMQ,EAAgBR,EAAa,YAAYS,QAAQC,aAEvD,MAAM/C,EACL6C,GAAenB,IAAKqB,GACZA,EAAaC,QAAQ,GAAGC,UAC1B,GAEP,OAAO7C,EAAmBJ,IACzB,IAAAkD,EAAA,CAAAC,WAAA,MAAAD,EAAAd,sBAAAc,EAAAX,uBAAA,OAAAW,CAAA","ignoreList":[]}