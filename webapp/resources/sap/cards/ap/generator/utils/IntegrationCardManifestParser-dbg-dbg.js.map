{"version":3,"file":"IntegrationCardManifestParser-dbg-dbg.js","names":["sap","ui","define","___odata_ODataUtils","___pages_Application","getMetaModelObjectForEntitySet","Application","ODataModelVersion","getAllValues","subManifest","values","key","value","push","getQueryParameters","applicationInstance","getInstance","rootComponent","getRootComponent","model","getModel","entitySet","odataModel","fetchDetails","isODataV4Model","V4","properties","navigationProperties","complexProperties","getMetaModel","queryParameters","filter","property","some","includes","name","map","forEach","navigationProperty","navigationPropertyName","selectedProperties","length","complexProperty","complexPropertyName","selectedComplexProperties","concat","getHeaderProperties","cardManifest","header","getContentProperties","content","contentQueryParams","footerQueryParams","getFooterProperties","selectedNavigationProperties","actionsStrips","footer","actionsStrip","actions","enabled","__exports","__esModule"],"sources":["IntegrationCardManifestParser.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport type { CardManifest } from \"sap/ui/integration/widgets/Card\";\nimport V2ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\nimport V4ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport { QueryParameters } from \"../helpers/Batch\";\nimport { getMetaModelObjectForEntitySet } from \"../odata/ODataUtils\";\nimport { Application, ODataModelVersion } from \"../pages/Application\";\n\ntype Model = V2ODataModel | V4ODataModel;\n\nconst getAllValues = (subManifest: Record<string, string>): string[] => {\n\tconst values: string[] = [];\n\n\tfor (const key in subManifest) {\n\t\tconst value = subManifest[key];\n\t\tif (typeof value === \"string\") {\n\t\t\tvalues.push(subManifest[key]);\n\t\t} else {\n\t\t\tvalues.push(...getAllValues(value));\n\t\t}\n\t}\n\n\treturn values;\n};\n\nconst getQueryParameters = (values: string[]) => {\n\tconst applicationInstance = Application.getInstance();\n\tconst rootComponent = applicationInstance.getRootComponent();\n\tconst model = rootComponent.getModel() as Model;\n\tconst { entitySet, odataModel } = applicationInstance.fetchDetails();\n\tconst isODataV4Model = odataModel === ODataModelVersion.V4;\n\tconst { properties, navigationProperties, complexProperties } = getMetaModelObjectForEntitySet(\n\t\tmodel.getMetaModel(),\n\t\tentitySet,\n\t\tisODataV4Model\n\t);\n\n\tconst queryParameters: QueryParameters = {\n\t\tproperties: [],\n\t\tnavigationProperties: []\n\t};\n\n\tqueryParameters.properties = properties\n\t\t.filter((property) => {\n\t\t\treturn values.some((value) => {\n\t\t\t\treturn value && value.includes(`{${property.name}}`);\n\t\t\t});\n\t\t})\n\t\t.map((property) => property.name);\n\n\tnavigationProperties.forEach((navigationProperty) => {\n\t\tconst navigationPropertyName = navigationProperty.name;\n\t\tconst properties = navigationProperty.properties;\n\t\tconst selectedProperties = properties\n\t\t\t.filter((property) => {\n\t\t\t\treturn values.some((value) => {\n\t\t\t\t\treturn value && value.includes(`{${navigationPropertyName}/${property.name}}`);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.map((property) => property.name);\n\n\t\tif (selectedProperties.length) {\n\t\t\tqueryParameters.navigationProperties.push({\n\t\t\t\tname: navigationPropertyName,\n\t\t\t\tproperties: selectedProperties\n\t\t\t});\n\t\t}\n\t});\n\n\tcomplexProperties.forEach((complexProperty) => {\n\t\tconst complexPropertyName = complexProperty.name;\n\t\tconst properties = complexProperty.properties;\n\t\tconst selectedProperties = properties\n\t\t\t.filter((property) => {\n\t\t\t\treturn values.some((value) => {\n\t\t\t\t\treturn value && value.includes(`{${complexPropertyName}/${property.name}}`);\n\t\t\t\t});\n\t\t\t})\n\t\t\t.map((property) => property.name);\n\n\t\tconst selectedComplexProperties = selectedProperties.map((property) => {\n\t\t\treturn `${complexPropertyName}/${property}`;\n\t\t});\n\t\tif (selectedProperties.length) {\n\t\t\tqueryParameters.properties = queryParameters.properties.concat(selectedComplexProperties);\n\t\t}\n\t});\n\n\treturn queryParameters;\n};\n\nexport const getHeaderProperties = (cardManifest: CardManifest): QueryParameters => {\n\tconst values = getAllValues(cardManifest[\"sap.card\"].header as Record<string, string>);\n\treturn getQueryParameters(values);\n};\n\nexport const getContentProperties = (cardManifest: CardManifest): QueryParameters => {\n\tconst values = getAllValues(cardManifest[\"sap.card\"].content as unknown as Record<string, string>);\n\tconst contentQueryParams = getQueryParameters(values);\n\tconst footerQueryParams = getFooterProperties(cardManifest);\n\tconst selectedProperties = contentQueryParams.properties.concat(footerQueryParams.properties);\n\tconst selectedNavigationProperties = contentQueryParams.navigationProperties.concat(footerQueryParams.navigationProperties);\n\n\treturn {\n\t\tproperties: selectedProperties,\n\t\tnavigationProperties: selectedNavigationProperties\n\t};\n};\n\nconst getFooterProperties = (cardManifest: CardManifest): QueryParameters => {\n\tconst actionsStrips = cardManifest[\"sap.card\"].footer?.actionsStrip;\n\n\tconst values =\n\t\tactionsStrips?.map((actionsStrip) => {\n\t\t\treturn actionsStrip.actions[0].enabled as string;\n\t\t}) || [];\n\n\treturn getQueryParameters(values);\n};\n"],"mappings":"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","ignoreList":[]}