{"version":3,"file":"FreeStyle-dbg-dbg.js","names":["sap","ui","define","Log","sap_cards_ap_common_helpers_ApplicationInfo","sap_cards_ap_common_odata_ODataUtils","sap_cards_ap_generator_odata_ODataUtils","JSONModel","V2ODataModel","V4ODataModel","___Application","_catch","body","recover","result","e","then","AppType","getApplicationFloorplan","getEntitySetWithContextURLs","getEntityNames","getPropertyReference","Application","FreeStyle","constructor","rootComponent","floorplan","appComponent","_rootComponent","entitySetFromManifest","getManifestEntry","serviceDetails","getServiceDetails","entityDetails","getEntityDetails","serviceURL","length","name","freeStyleDialogModel","isServiceDetailsView","currentService","entitySet","entities","entitySetWithObjectContext","entitySetWithObjectContextList","isApplyServiceDetailsEnabled","isContextPathChanged","isEntityPathChanged","validateCardGeneration","serviceUrl","fetchDetails","getEntityRelatedInfo","getProperty","createInstance","instance","dataSources","ui5Models","Object","values","map","dataSource","uri","filter","undefined","labelWithValue","model","getModel","entityNames","entityName","propertyRef","entity","fetchDataForObjectContext","_this","sFormattedUrl","_temp3","Promise","resolve","reject","read","success","oData","error","oError","_temp2","_temp","context","bindContext","requestObject","updateObjectContextFreeStyleModel","_this2","_temp5","_temp4","setProperty","getFreeStyleModelForDialog","__exports","__esModule"],"sources":["FreeStyle.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport Log from \"sap/base/Log\";\nimport { AppType, getApplicationFloorplan } from \"sap/cards/ap/common/helpers/ApplicationInfo\";\nimport { getEntitySetWithContextURLs } from \"sap/cards/ap/common/odata/ODataUtils\";\nimport type { Model } from \"sap/cards/ap/generator/odata/ODataTypes\";\nimport { getEntityNames, getPropertyReference } from \"sap/cards/ap/generator/odata/ODataUtils\";\nimport type Component from \"sap/ui/core/Component\";\nimport JSONModel from \"sap/ui/model/json/JSONModel\";\nimport V2ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\nimport V4ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport { Application } from \"./Application\";\n\nexport type ServiceDetails = {\n\tname: string;\n\tlabelWithValue: string;\n};\n\nexport type EntityDetails = {\n\tname: string;\n\tlabelWithValue: string;\n};\n\nexport type EntitySetWithContext = {\n\tname: string;\n\tlabelWithValue: string;\n};\n\n/**\n * Class for Object Page Application Info\n * Extends Application\n * implements the abstract function of the parent class validateCardGeneration, getEntityRelatedInfo, createInstance\n */\nexport class FreeStyle extends Application {\n\tfreeStyleDialogModel: JSONModel;\n\n\t/**\n\t * Constructor for ObjectPage class\n\t *\n\t * @param rootComponent The root component of the application.\n\t */\n\tconstructor(rootComponent: Component) {\n\t\tsuper(rootComponent);\n\t\tApplication.floorplan = \"FreeStyle\";\n\t\tconst appComponent = this._rootComponent;\n\t\tconst entitySetFromManifest = appComponent.getManifestEntry(\"/sap.cards.ap/embeds/ObjectPage/default\");\n\t\tconst serviceDetails = this.getServiceDetails();\n\t\tconst entityDetails = this.getEntityDetails();\n\t\tconst serviceURL = serviceDetails.length ? serviceDetails[0].name : \"\";\n\n\t\tthis.freeStyleDialogModel = new JSONModel({\n\t\t\tisServiceDetailsView: true,\n\t\t\tserviceDetails: serviceDetails,\n\t\t\tcurrentService: serviceURL,\n\t\t\tentitySet: entitySetFromManifest ? entitySetFromManifest : \"\",\n\t\t\tentities: entityDetails,\n\t\t\tentitySetWithObjectContext: \"\",\n\t\t\tentitySetWithObjectContextList: [],\n\t\t\tisApplyServiceDetailsEnabled: false,\n\t\t\tisContextPathChanged: false,\n\t\t\tisEntityPathChanged: false\n\t\t});\n\t}\n\n\t/**\n\t * Function to validate the card generation\n\t *\n\t * @returns boolean\n\t */\n\tpublic validateCardGeneration(): boolean {\n\t\tconst { serviceUrl } = this.fetchDetails();\n\t\tif (!serviceUrl) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn getApplicationFloorplan(this._rootComponent) === AppType.FreeStyle;\n\t}\n\n\t/**\n\t * Function to get the entity related information i.e. eentitySet and entitySetWithObjectContext\n\t *\n\t * @returns object\n\t */\n\tpublic getEntityRelatedInfo() {\n\t\treturn {\n\t\t\tentitySet: this.freeStyleDialogModel.getProperty(\"/entitySet\"),\n\t\t\tentitySetWithObjectContext: this.freeStyleDialogModel.getProperty(\"/entitySetWithObjectContext\")\n\t\t};\n\t}\n\n\t/**\n\t * Function to create instance of Application\n\t *\n\t * @param rootComponent The root component of the application\n\t * @returns Application\n\t */\n\tpublic static createInstance(rootComponent: Component): Application {\n\t\tif (!Application.instance) {\n\t\t\tApplication.instance = new FreeStyle(rootComponent);\n\t\t}\n\t\treturn Application.instance;\n\t}\n\n\t/**\n\t * Retrieves service details from the application's manifest.\n\t *\n\t * This function iterates over the UI5 models and matches them with the data sources to extract the service URLs.\n\t * It returns an array of service details, each containing the name and labelWithValue properties.\n\t *\n\t * @returns {ServiceDetails[]} An array of service details, each containing the name and labelWithValue properties.\n\t */\n\tprivate getServiceDetails(): ServiceDetails[] {\n\t\tconst appComponent = this._rootComponent;\n\t\tconst dataSources = appComponent.getManifestEntry(\"/sap.app/dataSources\");\n\t\tconst ui5Models: Record<string, any>[] = appComponent.getManifestEntry(\"/sap.ui5/models\");\n\n\t\treturn Object.values(ui5Models)\n\t\t\t.map(({ dataSource }) => dataSources[dataSource]?.uri)\n\t\t\t.filter((uri): uri is string => uri !== undefined)\n\t\t\t.map((uri) => ({\n\t\t\t\tname: uri,\n\t\t\t\tlabelWithValue: uri\n\t\t\t}));\n\t}\n\n\t/**\n\t * Retrieves the entity details from the model.\n\t *\n\t * @returns {EntityDetails[]} An array of entity details, each containing the name and labelWithValue properties.\n\t * @private\n\t */\n\tprivate getEntityDetails(): EntityDetails[] {\n\t\tconst model = this._rootComponent.getModel() as Model;\n\t\tconst entityNames = getEntityNames(model);\n\n\t\treturn entityNames\n\t\t\t.map((entityName) => {\n\t\t\t\tconst propertyRef = getPropertyReference(model, entityName);\n\t\t\t\treturn propertyRef.length > 0 ? { name: entityName, labelWithValue: entityName } : null;\n\t\t\t})\n\t\t\t.filter((entity): entity is EntityDetails => entity !== null);\n\t}\n\n\t/**\n\t * Fetches data for a given entity set with context.\n\t *\n\t * @param {string} entitySetWithObjectContext - The entity set with context to fetch data for.\n\t * @returns {Promise<void>} A promise that resolves when the data fetching is complete.\n\t */\n\tasync fetchDataForObjectContext(entitySetWithObjectContext: string): Promise<void> {\n\t\tconst model = this._rootComponent.getModel() as Model;\n\t\tconst sFormattedUrl = `/${entitySetWithObjectContext}`;\n\n\t\tif (model instanceof V2ODataModel) {\n\t\t\tawait new Promise((resolve, reject) => {\n\t\t\t\tmodel.read(sFormattedUrl, {\n\t\t\t\t\tsuccess: (oData: Record<string, any>[]) => {\n\t\t\t\t\t\tresolve(oData);\n\t\t\t\t\t},\n\t\t\t\t\terror: (oError: any) => {\n\t\t\t\t\t\tLog.error(\"Error fetching data for object context for OData V2 model\");\n\t\t\t\t\t\treject(oError);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t} else if (model instanceof V4ODataModel) {\n\t\t\ttry {\n\t\t\t\tconst context = model.bindContext(sFormattedUrl);\n\t\t\t\tawait context.requestObject();\n\t\t\t} catch (err) {\n\t\t\t\tLog.error(\"Error fetching data for object context for OData V4 model\");\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Updates the FreeStyle model with context information for the selected service and entity set.\n\t *\n\t * @returns {Promise<void>} A promise that resolves when the model update is complete.\n\t */\n\tasync updateObjectContextFreeStyleModel(): Promise<void> {\n\t\tconst serviceUrl = this.freeStyleDialogModel.getProperty(\"/currentService\");\n\t\tconst entitySet = this.freeStyleDialogModel.getProperty(\"/entitySet\");\n\t\tconst model = this._rootComponent.getModel() as Model;\n\n\t\tif (serviceUrl && entitySet) {\n\t\t\tconst entitySetWithObjectContextList = await getEntitySetWithContextURLs(serviceUrl, entitySet, model);\n\t\t\tconst entitySetWithObjectContext = entitySetWithObjectContextList?.length ? entitySetWithObjectContextList[0].name : \"\";\n\n\t\t\tif (entitySetWithObjectContext) {\n\t\t\t\tawait this.fetchDataForObjectContext(entitySetWithObjectContext);\n\t\t\t\tthis.freeStyleDialogModel.setProperty(\"/entitySetWithObjectContext\", entitySetWithObjectContext);\n\t\t\t\tthis.freeStyleDialogModel.setProperty(\"/entitySetWithObjectContextList\", entitySetWithObjectContextList);\n\t\t\t\tthis.freeStyleDialogModel.setProperty(\"/isApplyServiceDetailsEnabled\", true);\n\t\t\t}\n\t\t}\n\t}\n\n\tpublic getFreeStyleModelForDialog() {\n\t\treturn this.freeStyleDialogModel;\n\t}\n}\n"],"mappings":"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","ignoreList":[]}