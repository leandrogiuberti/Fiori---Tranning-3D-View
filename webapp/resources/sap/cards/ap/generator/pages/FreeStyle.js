/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/base/Log","sap/cards/ap/common/helpers/ApplicationInfo","sap/cards/ap/common/odata/ODataUtils","sap/cards/ap/generator/odata/ODataUtils","sap/ui/model/json/JSONModel","sap/ui/model/odata/v2/ODataModel","sap/ui/model/odata/v4/ODataModel","./Application"],function(t,e,n,o,r,i,s,a){"use strict";function c(t,e){try{var n=t()}catch(t){return e(t)}if(n&&n.then){return n.then(void 0,e)}return n}const l=e["AppType"];const u=e["getApplicationFloorplan"];const f=n["getEntitySetWithContextURLs"];const d=o["getEntityNames"];const h=o["getPropertyReference"];const p=a["Application"];class y extends p{constructor(t){super(t);p.floorplan="FreeStyle";const e=this._rootComponent;const n=e.getManifestEntry("/sap.cards.ap/embeds/ObjectPage/default");const o=this.getServiceDetails();const i=this.getEntityDetails();const s=o.length?o[0].name:"";this.freeStyleDialogModel=new r({isServiceDetailsView:true,serviceDetails:o,currentService:s,entitySet:n?n:"",entities:i,entitySetWithObjectContext:"",entitySetWithObjectContextList:[],isApplyServiceDetailsEnabled:false,isContextPathChanged:false,isEntityPathChanged:false})}validateCardGeneration(){const{serviceUrl:t}=this.fetchDetails();if(!t){return false}return u(this._rootComponent)===l.FreeStyle}getEntityRelatedInfo(){return{entitySet:this.freeStyleDialogModel.getProperty("/entitySet"),entitySetWithObjectContext:this.freeStyleDialogModel.getProperty("/entitySetWithObjectContext")}}static createInstance(t){if(!p.instance){p.instance=new y(t)}return p.instance}getServiceDetails(){const t=this._rootComponent;const e=t.getManifestEntry("/sap.app/dataSources");const n=t.getManifestEntry("/sap.ui5/models");return Object.values(n).map(({dataSource:t})=>e[t]?.uri).filter(t=>t!==undefined).map(t=>({name:t,labelWithValue:t}))}getEntityDetails(){const t=this._rootComponent.getModel();const e=d(t);return e.map(e=>{const n=h(t,e);return n.length>0?{name:e,labelWithValue:e}:null}).filter(t=>t!==null)}fetchDataForObjectContext(e){try{const n=this;const o=n._rootComponent.getModel();const r=`/${e}`;const a=function(){if(o instanceof i){return Promise.resolve(new Promise((e,n)=>{o.read(r,{success:t=>{e(t)},error:e=>{t.error("Error fetching data for object context for OData V2 model");n(e)}})})).then(function(){})}else{const e=function(){if(o instanceof s){const e=c(function(){const t=o.bindContext(r);return Promise.resolve(t.requestObject()).then(function(){})},function(){t.error("Error fetching data for object context for OData V4 model")});if(e&&e.then)return e.then(function(){})}}();if(e&&e.then)return e.then(function(){})}}();return Promise.resolve(a&&a.then?a.then(function(){}):void 0)}catch(t){return Promise.reject(t)}}updateObjectContextFreeStyleModel(){try{const t=this;const e=t.freeStyleDialogModel.getProperty("/currentService");const n=t.freeStyleDialogModel.getProperty("/entitySet");const o=t._rootComponent.getModel();const r=function(){if(e&&n){return Promise.resolve(f(e,n,o)).then(function(e){const n=e?.length?e[0].name:"";const o=function(){if(n){return Promise.resolve(t.fetchDataForObjectContext(n)).then(function(){t.freeStyleDialogModel.setProperty("/entitySetWithObjectContext",n);t.freeStyleDialogModel.setProperty("/entitySetWithObjectContextList",e);t.freeStyleDialogModel.setProperty("/isApplyServiceDetailsEnabled",true)})}}();if(o&&o.then)return o.then(function(){})})}}();return Promise.resolve(r&&r.then?r.then(function(){}):void 0)}catch(t){return Promise.reject(t)}}getFreeStyleModelForDialog(){return this.freeStyleDialogModel}}var g={__esModule:true};g.FreeStyle=y;return g});
//# sourceMappingURL=FreeStyle.js.map