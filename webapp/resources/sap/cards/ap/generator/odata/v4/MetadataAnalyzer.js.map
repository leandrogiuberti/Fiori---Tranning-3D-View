{"version":3,"file":"MetadataAnalyzer.js","names":["sap","ui","define","____utils_CommonUtils","checkForDateType","Annotations","label","isPotentiallySensitive","isoCurrency","unit","getNavigationPropertyInfoFromEntity","model","entitySetName","metaModel","getMetaModel","entitySet","getObject","entityTypeName","$Type","entityType","navigationalData","parameters","Object","keys","filter","property","propertyDef","$kind","$isCollection","forEach","navigationProp","navigationBinding","$NavigationPropertyBinding","navEntitySetName","navEntitySet","navEntityTypeName","navEntityType","data","createNavigationObject","navigationVal","name","properties","push","annotations","map","type","getPropertyInfoFromEntity","oModel","sEntitySet","withNavigation","resourceModel","oMetaModel","oEntitySet","sEntityType","oEntityType","metaModelPropertiesAsObject","getMetaModelObjectForEntitySet","info","propertyCategory","getText","isDate","ISOCurrency","unitOfMeasure","UOM","$Path","category","kind","navigationProperties","navigationProperty","concat","getLabelForEntitySet","getPropertyReferenceKey","oAppModel","entityContainer","entitySetType","propertyRefKey","$Key","includes","getPropertiesFromEntityType","navigationPropertyNames","propertyName","navigationEntitySet","navigationEntityTypeName","complexProperties","complexPropertyNames","startsWith","complexPropertyType","complexType","getEntityNames","entitySets","key","__exports","__esModule"],"sources":["MetadataAnalyzer.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport type ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport type ODataMetaModel from \"sap/ui/model/odata/v4/ODataMetaModel\";\nimport type ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport type { RequestQueryComplexProperties, RequestQueryNavigationProperties, RequestQueryParametersV4 } from \"../../helpers/Batch\";\nimport type { EntityType } from \"../../helpers/CardGeneratorModel\";\nimport { NavigationParameter, NavigationParameters } from \"../../types/PropertyTypes\";\nimport { checkForDateType } from \"../../utils/CommonUtils\";\nimport { PropertyInfo } from \"../ODataTypes\";\n\nconst Annotations = {\n\tlabel: \"@com.sap.vocabularies.Common.v1.Label\",\n\tisPotentiallySensitive: \"@com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive\",\n\tisoCurrency: \"@Org.OData.Measures.V1.ISOCurrency\",\n\tunit: \"@Org.OData.Measures.V1.Unit\"\n};\n\nexport function getNavigationPropertyInfoFromEntity(model: ODataModel, entitySetName: string): NavigationParameter[] {\n\tconst metaModel: ODataMetaModel = model.getMetaModel();\n\tconst entitySet = metaModel.getObject(\"/\" + entitySetName);\n\tconst entityTypeName = entitySet.$Type;\n\tconst entityType = metaModel.getObject(\"/\" + entityTypeName);\n\tconst navigationalData: NavigationParameters = { parameters: [] };\n\tObject.keys(entityType)\n\t\t.filter((property) => {\n\t\t\tconst propertyDef = entityType[property];\n\t\t\treturn typeof propertyDef === \"object\" && propertyDef.$kind === \"NavigationProperty\" && !propertyDef.$isCollection;\n\t\t})\n\t\t.forEach((navigationProp) => {\n\t\t\tconst navigationBinding = entitySet.$NavigationPropertyBinding;\n\t\t\tif (navigationBinding && navigationProp in navigationBinding) {\n\t\t\t\tconst navEntitySetName = navigationBinding[navigationProp];\n\t\t\t\tif (navEntitySetName !== entitySetName) {\n\t\t\t\t\tconst navEntitySet = metaModel.getObject(\"/\" + navEntitySetName);\n\t\t\t\t\tconst navEntityTypeName = navEntitySet?.$Type;\n\t\t\t\t\tconst navEntityType = metaModel.getObject(\"/\" + navEntityTypeName);\n\t\t\t\t\tconst data = createNavigationObject(navEntityType, navEntityTypeName, metaModel);\n\t\t\t\t\tconst navigationVal: NavigationParameter = {\n\t\t\t\t\t\tname: navigationProp,\n\t\t\t\t\t\tproperties: data\n\t\t\t\t\t};\n\t\t\t\t\tnavigationalData.parameters.push(navigationVal);\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\treturn navigationalData.parameters;\n}\n\nfunction createNavigationObject(entityType: EntityType, entityTypeName: string, metaModel: ODataMetaModel): PropertyInfo[] {\n\treturn Object.keys(entityType)\n\t\t.filter((property) => {\n\t\t\tconst propertyDef = entityType[property];\n\t\t\tconst annotations = metaModel.getObject(`/${entityTypeName}/${property}@`);\n\t\t\treturn (\n\t\t\t\tproperty !== \"SAP__Messages\" &&\n\t\t\t\ttypeof propertyDef === \"object\" &&\n\t\t\t\t(propertyDef.$kind === \"Property\" || propertyDef.$kind === \"NavigationProperty\") &&\n\t\t\t\t!annotations?.[Annotations.isPotentiallySensitive]\n\t\t\t);\n\t\t})\n\t\t.map((property) => {\n\t\t\tconst propertyDef = entityType[property];\n\t\t\tconst annotations = metaModel.getObject(`/${entityTypeName}/${property}@`);\n\t\t\treturn {\n\t\t\t\tlabel: annotations?.[Annotations.label] || property,\n\t\t\t\ttype: propertyDef.$Type,\n\t\t\t\tname: property\n\t\t\t};\n\t\t});\n}\n\nexport function getPropertyInfoFromEntity(\n\toModel: ODataModel,\n\tsEntitySet: string,\n\twithNavigation = false,\n\tresourceModel?: ResourceBundle\n): PropertyInfo[] {\n\tconst oMetaModel = oModel.getMetaModel();\n\tconst oEntitySet = oMetaModel.getObject(\"/\" + sEntitySet);\n\tconst sEntityType = oEntitySet.$Type;\n\tconst oEntityType = oMetaModel.getObject(\"/\" + sEntityType);\n\tconst metaModelPropertiesAsObject = getMetaModelObjectForEntitySet(oMetaModel, sEntitySet);\n\tlet info: PropertyInfo[] = [];\n\n\tconst properties = metaModelPropertiesAsObject.properties.map((propertyDef) => {\n\t\tconst propertyCategory = resourceModel?.getText(\"CRITICALITY_CONTROL_SELECT_PROP\");\n\t\tconst annotations = oMetaModel.getObject(`/${sEntityType}/${propertyDef.name}@`);\n\t\tconst isDate = checkForDateType(propertyDef[\"$Type\"]);\n\t\tconst ISOCurrency = annotations?.[Annotations.isoCurrency];\n\t\tconst unitOfMeasure = annotations?.[Annotations.unit];\n\t\tlet UOM = \"\";\n\n\t\tif (ISOCurrency) {\n\t\t\tUOM = ISOCurrency?.$Path || ISOCurrency;\n\t\t} else if (unitOfMeasure) {\n\t\t\tUOM = unitOfMeasure?.$Path || unitOfMeasure;\n\t\t}\n\n\t\treturn {\n\t\t\tlabel: annotations?.[Annotations.label] || propertyDef.name,\n\t\t\ttype: propertyDef.$Type,\n\t\t\tname: propertyDef.name,\n\t\t\t...(withNavigation && { category: propertyCategory }),\n\t\t\tkind: propertyDef.$kind,\n\t\t\tUOM,\n\t\t\tisDate\n\t\t};\n\t}) as PropertyInfo[];\n\n\tif (withNavigation) {\n\t\tconst navigationProperties = metaModelPropertiesAsObject.navigationProperties.map((navigationProperty) => {\n\t\t\tconst propertyDef = oEntityType[navigationProperty.name];\n\t\t\tconst propertyCategory = resourceModel?.getText(\"GENERATOR_CARD_SELECT_NAV_PROP\");\n\t\t\treturn {\n\t\t\t\tlabel: navigationProperty.name,\n\t\t\t\ttype: propertyDef.$Type,\n\t\t\t\tname: navigationProperty.name,\n\t\t\t\tcategory: propertyCategory,\n\t\t\t\tkind: propertyDef.$kind,\n\t\t\t\tUOM: \"\",\n\t\t\t\tisDate: false\n\t\t\t};\n\t\t});\n\t\tinfo = info.concat(navigationProperties);\n\t}\n\treturn info.concat(properties);\n}\n\nexport function getLabelForEntitySet(oModel: ODataModel, sEntitySet: string) {\n\tconst oMetaModel = oModel.getMetaModel();\n\tconst entitySet = oMetaModel.getObject(\"/\" + sEntitySet);\n\tconst sEntityType = entitySet.$Type;\n\tconst annotations = oMetaModel.getObject(\"/\" + sEntityType + \"@\");\n\treturn annotations[Annotations.label] || sEntitySet;\n}\n\nexport function getPropertyReferenceKey(oAppModel: ODataModel, entitySetName: string) {\n\tconst entityContainer = oAppModel.getMetaModel().getObject(\"/\");\n\tconst entitySet = entityContainer[entitySetName];\n\tconst entitySetType = entitySet?.$Type;\n\tconst propertyRefKey = oAppModel.getMetaModel().getObject(\"/\" + entitySetType)?.$Key;\n\tconst properties = getPropertyInfoFromEntity(oAppModel, entitySetName, false);\n\treturn properties.filter((property) => propertyRefKey.includes(property.name));\n}\n\nfunction getPropertiesFromEntityType(metaModel: ODataMetaModel, entityType: EntityType, entityTypeName: string): PropertyInfo[] {\n\tconst properties: PropertyInfo[] = [];\n\n\tObject.keys(entityType).forEach((property) => {\n\t\tconst propertyDef = entityType[property];\n\t\tconst isPotentiallySensitive = metaModel.getObject(`/${entityTypeName}/${property}@`)?.[Annotations.isPotentiallySensitive];\n\t\tif (\n\t\t\tproperty !== \"SAP__Messages\" &&\n\t\t\ttypeof propertyDef === \"object\" &&\n\t\t\tpropertyDef.$kind === \"Property\" &&\n\t\t\t!isPotentiallySensitive\n\t\t) {\n\t\t\tproperties.push({\n\t\t\t\t...propertyDef,\n\t\t\t\t...{ name: property }\n\t\t\t});\n\t\t}\n\t});\n\n\treturn properties;\n}\n\nexport function getMetaModelObjectForEntitySet(metaModel: ODataMetaModel, entitySetName: string): RequestQueryParametersV4 {\n\tconst entitySet = metaModel.getObject(`/${entitySetName}`);\n\tconst entityTypeName = entitySet.$Type;\n\tconst entityType = metaModel.getObject(`/${entityTypeName}`);\n\tconst properties = getPropertiesFromEntityType(metaModel, entityType, entityTypeName);\n\n\tconst navigationPropertyNames = Object.keys(entityType).filter((property) => {\n\t\tconst propertyDef = entityType[property];\n\t\treturn typeof propertyDef === \"object\" && propertyDef.$kind === \"NavigationProperty\" && !propertyDef.$isCollection;\n\t});\n\n\tconst navigationProperties: RequestQueryNavigationProperties[] = [];\n\tnavigationPropertyNames.forEach((propertyName) => {\n\t\tconst navigationEntitySet = metaModel.getObject(`/${entitySetName}/${propertyName}`);\n\t\tconst navigationEntityTypeName = navigationEntitySet.$Type;\n\t\tconst entityType = metaModel.getObject(`/${entitySetName}/${navigationEntityTypeName}`);\n\t\tconst properties = getPropertiesFromEntityType(metaModel, entityType, navigationEntityTypeName);\n\t\tnavigationProperties.push({\n\t\t\tname: propertyName,\n\t\t\tproperties: properties\n\t\t});\n\t});\n\n\tconst complexProperties: RequestQueryComplexProperties[] = [];\n\tconst complexPropertyNames = Object.keys(entityType).filter((property) => {\n\t\tconst propertyDef = entityType[property];\n\t\treturn typeof propertyDef === \"object\" && propertyDef.$kind === \"Property\" && !propertyDef.$Type?.startsWith(\"Edm.\");\n\t});\n\n\tcomplexPropertyNames.forEach((propertyName) => {\n\t\tconst property = metaModel.getObject(`/${entitySetName}/${propertyName}`);\n\t\tconst complexPropertyType = property.$Type;\n\t\tconst complexType = metaModel.getObject(`/${entitySetName}/${complexPropertyType}`);\n\t\tconst properties = getPropertiesFromEntityType(metaModel, complexType, complexPropertyType);\n\t\tcomplexProperties.push({\n\t\t\tname: propertyName,\n\t\t\tproperties: properties\n\t\t});\n\t});\n\n\treturn {\n\t\tproperties,\n\t\tnavigationProperties,\n\t\tcomplexProperties\n\t};\n}\n\nexport function getEntityNames(model: ODataModel) {\n\tconst metaModel = model.getMetaModel();\n\tconst entityContainer = metaModel.getObject(\"/\");\n\tconst entitySets = Object.keys(entityContainer).filter((key) => {\n\t\tconst entitySet = entityContainer[key];\n\t\treturn entitySet.$kind === \"EntitySet\";\n\t});\n\treturn entitySets;\n}\n"],"mappings":"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","ignoreList":[]}