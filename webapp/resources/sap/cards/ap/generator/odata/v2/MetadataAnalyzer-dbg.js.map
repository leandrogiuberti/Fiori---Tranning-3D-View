{"version":3,"file":"MetadataAnalyzer-dbg.js","names":["sap","ui","define","____utils_CommonUtils","checkForDateType","Annotatations","label","isPotentiallySensitive","isoCurrency","unit","getNavigationPropertyInfoFromEntity","oModel","entitySet","oMetaModel","getMetaModel","oResult","parameters","oEntityType","getEntityTypeFromEntitySet","aNavigationProperties","navigationProperty","forEach","oNavProperty","navigationEntitySet","getODataAssociationEnd","name","navigationEntityType","type","getODataEntityType","key","entityProperties","property","filter","length","properties","mapProperties","navigationParameter","push","getPropertyInfoFromEntity","model","withNavigation","resourceModel","metaModel","entityType","propertiesWithoutNav","map","obj","category","getText","kind","propertiesWithNav","isPropertySensitive","mapPropertyInfo","entitySetInfo","getODataEntitySet","oProperty","Bool","multiplicity","isDate","ISOCurrency","unitOfMeasure","UOM","Path","String","getLabelForEntitySet","getPropertyReference","entitySetName","entityDefinition","propertyRef","includes","getMetaModelObjectForEntitySet","navigationProperties","propertyName","complexProperties","getEntityNames","entityContainer","getODataEntityContainer","entity","__exports","__esModule"],"sources":["MetadataAnalyzer.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport type ResourceBundle from \"sap/base/i18n/ResourceBundle\";\nimport type ODataMetaModel from \"sap/ui/model/odata/ODataMetaModel\";\nimport type { EntityContainer, EntitySet, EntityType } from \"sap/ui/model/odata/ODataMetaModel\";\nimport type ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\nimport type { RequestQueryNavigationProperties, RequestQueryParametersV2 } from \"../../helpers/Batch\";\nimport type { NavigationParameter, NavigationParameters, Property } from \"../../types/PropertyTypes\";\nimport { checkForDateType } from \"../../utils/CommonUtils\";\nimport { PropertyInfo, PropertyInfoMap } from \"../ODataTypes\";\n\nconst Annotatations = {\n\tlabel: \"com.sap.vocabularies.Common.v1.Label\",\n\tisPotentiallySensitive: \"com.sap.vocabularies.PersonalData.v1.IsPotentiallySensitive\",\n\tisoCurrency: \"Org.OData.Measures.V1.ISOCurrency\",\n\tunit: \"Org.OData.Measures.V1.Unit\"\n};\n\ntype EntityTypeLabelAnnotation = {\n\tString?: string;\n};\n\ninterface EntityTypeWithAnnotations extends EntityType {\n\t\"com.sap.vocabularies.Common.v1.Label\"?: EntityTypeLabelAnnotation;\n}\n\nexport function getNavigationPropertyInfoFromEntity(oModel: ODataModel, entitySet: string): NavigationParameter[] {\n\tconst oMetaModel: ODataMetaModel = oModel.getMetaModel();\n\tconst oResult: NavigationParameters = { parameters: [] };\n\n\tconst oEntityType = getEntityTypeFromEntitySet(oMetaModel, entitySet);\n\tconst aNavigationProperties = oEntityType?.navigationProperty || [];\n\n\taNavigationProperties.forEach((oNavProperty: any) => {\n\t\tconst navigationEntitySet = oMetaModel.getODataAssociationEnd(oEntityType as EntityType, oNavProperty.name);\n\t\tconst navigationEntityType = navigationEntitySet?.type ? oMetaModel.getODataEntityType(navigationEntitySet?.type) : null;\n\n\t\tif ((navigationEntityType as EntityType)?.key) {\n\t\t\tconst entityProperties = (navigationEntityType as EntityType)?.property?.filter(\n\t\t\t\t(property: any) => property.type !== \"Edm.Time\"\n\t\t\t);\n\t\t\tif ((entityProperties ?? []).length > 0) {\n\t\t\t\tconst properties = mapProperties(entityProperties);\n\t\t\t\tconst navigationParameter = {\n\t\t\t\t\tname: oNavProperty.name,\n\t\t\t\t\tproperties: properties\n\t\t\t\t} as NavigationParameter;\n\t\t\t\toResult.parameters.push(navigationParameter);\n\t\t\t}\n\t\t}\n\t});\n\treturn oResult.parameters;\n}\n\nexport function getPropertyInfoFromEntity(\n\tmodel: ODataModel,\n\tentitySet: string,\n\twithNavigation: boolean,\n\tresourceModel?: ResourceBundle\n): PropertyInfoMap {\n\tconst metaModel = model.getMetaModel();\n\tconst entityType = getEntityTypeFromEntitySet(metaModel, entitySet) as EntityType;\n\tlet properties = [];\n\tif (withNavigation) {\n\t\tconst propertiesWithoutNav = (entityType?.property || [])\n\t\t\t.filter((property) => property.type !== \"Edm.Time\")\n\t\t\t.map((obj) => ({\n\t\t\t\t...obj,\n\t\t\t\tcategory: resourceModel?.getText(\"CRITICALITY_CONTROL_SELECT_PROP\"),\n\t\t\t\tkind: \"Property\"\n\t\t\t}));\n\t\tconst propertiesWithNav = (entityType?.navigationProperty || []).map((obj) => ({\n\t\t\t...obj,\n\t\t\tcategory: resourceModel?.getText(\"GENERATOR_CARD_SELECT_NAV_PROP\"),\n\t\t\tkind: \"NavigationProperty\"\n\t\t}));\n\t\tproperties = [...propertiesWithoutNav, ...propertiesWithNav];\n\t} else {\n\t\tproperties = entityType?.property || [];\n\t\tproperties = properties.filter((property) => property.type !== \"Edm.Time\");\n\t\tproperties.forEach((property) => ((property as unknown as { kind: string }).kind = \"Property\"));\n\t}\n\n\treturn properties\n\t\t.filter((property) => !isPropertySensitive(metaModel, entityType, property))\n\t\t.map((property) => mapPropertyInfo(property, withNavigation));\n}\n\nfunction getEntityTypeFromEntitySet(oMetaModel: ODataMetaModel, entitySet: string): EntityType | undefined {\n\tconst entitySetInfo = oMetaModel.getODataEntitySet(entitySet) as EntitySet;\n\treturn oMetaModel.getODataEntityType(entitySetInfo?.entityType) as EntityType | undefined;\n}\n\nfunction mapProperties(properties?: Property[]): Property[] | undefined {\n\treturn properties?.map((property) => ({\n\t\tlabel: property?.[\"sap:label\"] || property?.name,\n\t\ttype: property.type,\n\t\tname: property?.name\n\t}));\n}\n\nfunction isPropertySensitive(oMetaModel: ODataMetaModel, oEntityType: EntityType, oProperty: any): boolean {\n\tconst navigationEntitySet = oMetaModel.getODataAssociationEnd(oEntityType, oProperty.name);\n\treturn oProperty[Annotatations.isPotentiallySensitive]?.Bool || navigationEntitySet?.multiplicity === \"*\";\n}\n\nfunction mapPropertyInfo(oProperty: any, withNavigation: boolean): PropertyInfo {\n\tconst isDate: boolean = checkForDateType(oProperty.type);\n\tconst ISOCurrency = oProperty && oProperty[Annotatations.isoCurrency];\n\tconst unitOfMeasure = oProperty && oProperty[Annotatations.unit];\n\tlet UOM: string = \"\";\n\n\tif (ISOCurrency) {\n\t\tUOM = ISOCurrency?.Path ? ISOCurrency?.Path : ISOCurrency?.String;\n\t} else if (unitOfMeasure) {\n\t\tUOM = unitOfMeasure?.Path ? unitOfMeasure?.Path : unitOfMeasure?.String;\n\t} else if (oProperty && oProperty[\"sap:unit\"]) {\n\t\tUOM = oProperty && oProperty[\"sap:unit\"];\n\t}\n\n\treturn {\n\t\tlabel: oProperty[\"sap:label\"] || oProperty?.name,\n\t\ttype: oProperty.type,\n\t\tname: oProperty.name,\n\t\t...(withNavigation && { category: oProperty.category }),\n\t\tUOM,\n\t\tisDate,\n\t\tkind: oProperty.kind\n\t};\n}\n\nexport function getLabelForEntitySet(oModel: ODataModel, entitySet: string) {\n\tconst oMetaModel = oModel.getMetaModel();\n\tconst entitySetInfo = oMetaModel.getODataEntitySet(entitySet) as EntitySet;\n\tconst entityType = oMetaModel.getODataEntityType(entitySetInfo?.entityType) as EntityTypeWithAnnotations;\n\tconst label = (entityType[Annotatations.label as keyof EntityTypeWithAnnotations] as EntityTypeLabelAnnotation)?.String;\n\treturn label || entitySet;\n}\n\nexport function getPropertyReference(oModel: ODataModel, entitySetName: string) {\n\tconst metaModel = oModel.getMetaModel();\n\tconst entitySet = metaModel.getODataEntitySet(entitySetName) as EntitySet;\n\tconst entityDefinition = metaModel.getODataEntityType(entitySet.entityType) as EntityType;\n\tconst propertyRef = entityDefinition.key.propertyRef.map((property) => property.name);\n\tconst properties = getPropertyInfoFromEntity(oModel, entitySetName, false);\n\n\treturn properties.filter((property) => propertyRef.includes(property?.name));\n}\n\nexport function getMetaModelObjectForEntitySet(metaModel: ODataMetaModel, entitySetName: string): RequestQueryParametersV2 {\n\tconst entitySet = metaModel.getODataEntitySet(entitySetName) as EntitySet;\n\tconst entityType = metaModel.getODataEntityType(entitySet.entityType) as EntityType;\n\tconst properties = entityType.property || [];\n\tconst navigationProperties: RequestQueryNavigationProperties[] = [];\n\n\tentityType.navigationProperty?.forEach((navigationProperty) => {\n\t\tconst propertyName = navigationProperty.name;\n\t\tconst navigationEntitySet = metaModel.getODataAssociationEnd(entityType, propertyName);\n\t\tif (navigationEntitySet !== null) {\n\t\t\tconst navigationEntityType = metaModel.getODataEntityType(navigationEntitySet.type) as EntityType;\n\t\t\tconst navigationProperty = navigationEntityType.property || [];\n\t\t\tnavigationProperties.push({\n\t\t\t\tname: propertyName,\n\t\t\t\tproperties: navigationProperty\n\t\t\t});\n\t\t}\n\t});\n\n\treturn {\n\t\tproperties,\n\t\tnavigationProperties,\n\t\tcomplexProperties: []\n\t};\n}\n\nexport const getEntityNames = function (model: ODataModel) {\n\tconst metaModel = model.getMetaModel();\n\tconst entityContainer = metaModel.getODataEntityContainer();\n\tconst entitySet = (entityContainer as EntityContainer)?.entitySet || [];\n\treturn entitySet.map((entity) => entity.name);\n};\n"],"mappings":"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","ignoreList":[]}