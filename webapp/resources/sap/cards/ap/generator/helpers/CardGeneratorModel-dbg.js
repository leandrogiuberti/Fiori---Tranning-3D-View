/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/cards/ap/common/services/RetrieveCard","sap/ui/core/Lib","sap/ui/core/library","sap/ui/model/json/JSONModel","../helpers/Batch","../odata/ODataUtils","../pages/Application","./FooterActions","./Formatter","./IntegrationCardHelper","./NavigationProperty"],function(t,e,n,r,o,i,a,s,c,u,l){"use strict";const f=typeof Symbol!=="undefined"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function p(t,e,n){if(!t.s){if(n instanceof d){if(n.s){if(e&1){e=n.s}n=n.v}else{n.o=p.bind(null,t,e);return}}if(n&&n.then){n.then(p.bind(null,t,e),p.bind(null,t,2));return}t.s=e;t.v=n;const r=t.o;if(r){r(t)}}}const d=function(){function t(){}t.prototype.then=function(e,n){const r=new t;const o=this.s;if(o){const t=o&1?e:n;if(t){try{p(r,1,t(this.v))}catch(t){p(r,2,t)}return r}else{return this}}this.o=function(t){try{const o=t.v;if(t.s&1){p(r,1,e?e(o):o)}else if(n){p(r,1,n(o))}else{p(r,2,o)}}catch(t){p(r,2,t)}};return r};return t}();function m(t){return t instanceof d&&t.s&1}function h(t,e,n){var r=-1,o,i;function a(s){try{while(++r<t.length&&(!n||!n())){s=e(r);if(s&&s.then){if(m(s)){s=s.v}else{s.then(a,i||(i=p.bind(null,o=new d,2)));return}}}if(o){p(o,1,s)}else{o=s}}catch(t){p(o||(o=new d),2,t)}}a();return o}const y=function(t,e,n,r=""){try{const o=n?.formatterConfigurationFromCardManifest.filter(t=>t.formatterName==="format.unit")||[];const i=n?.mainIndicatorOptions;let a=i?.criticalityOptions||[];return Promise.resolve(W(a,r)).then(function(s){function c(t){return{unitOfMeasures:t,textArrangements:n?.textArrangementsFromCardManifest||[],propertyValueFormatters:e,sourceCriticalityProperty:[],targetFormatterProperty:"",sourceUoMProperty:l,selectedKeyCriticality:u,textArrangementSourceProperty:l}}a=s;const u=a.length?a[0]?.criticality:"";const l=i?.mainIndicatorStatusKey||"";const f=o.length>0;return f?Promise.resolve(A(t,o,r)).then(c):c(t)})}catch(t){return Promise.reject(t)}};function g(t,e,n){if(typeof t[f]==="function"){var r=t[f](),o,i,a;function l(t){try{while(!(o=r.next()).done&&(!n||!n())){t=e(o.value);if(t&&t.then){if(m(t)){t=t.v}else{t.then(l,a||(a=p.bind(null,i=new d,2)));return}}}if(i){p(i,1,t)}else{i=t}}catch(t){p(i||(i=new d),2,t)}}l();if(r.return){var s=function(t){try{if(!o.done){r.return()}}catch(t){}return t};if(i&&i.then){return i.then(s,function(t){throw s(t)})}s()}return i}if(!("length"in t)){throw new TypeError("Object is not iterable")}var c=[];for(var u=0;u<t.length;u++){c.push(t[u])}return h(c,function(t){return e(c[t])},n)}const v=function(t,e,n,r,o){try{function i(){return g(t.groups,function(t){const i=g(t.items,function(t){return Promise.resolve(j(t,e,n,o)).then(function(t){if(t){const{navigationEntitySet:e,navigationPropertyData:n}=t;if(r[e]===null||r[e]===undefined){r[e]=n[e]}}})});if(i&&i.then)return i.then(function(){})})}const a=g(t.textArrangementsFromCardManifest,function(t){return Promise.resolve(L(t,e,n)).then(function(t){if(t){for(const e of t){const{navigationEntitySet:t,navigationPropertyData:n}=e;if(r[t]===null||r[t]===undefined){r[t]=n[t]}}}})});return Promise.resolve(a&&a.then?a.then(i):i(a))}catch(s){return Promise.reject(s)}};const P=t["getKeyParameters"];const b=n["ValueState"];const N=o["createURLParams"];const O=i["createPathWithEntityContext"];const S=i["fetchDataAsync"];const F=i["getLabelForEntitySet"];const C=i["getNavigationPropertyInfoFromEntity"];const I=i["getPropertyInfoFromEntity"];const M=a["Application"];const E=a["ODataModelVersion"];const V=s["getCardActionInfo"];const U=c["formatPropertyDropdownValues"];const D=c["getDefaultPropertyFormatterConfig"];const w=c["getDefaultPropertyFormatterConfigForNavProperties"];const A=u["getUpdatedUnitOfMeasures"];const K=u["parseCard"];const W=u["updateCriticalityForNavProperty"];const x=l["getNavigationPropertiesWithLabel"];const L=l["getNavigationPropertyInfo"];const j=l["getNavigationPropertyInfoGroups"];const R=l["updateNavigationPropertiesWithLabel"];const T=[{Name:"K",Value:"K"},{Name:"%",Value:"%"}];function $(t=[],e=[]){const n=[...e];for(const e of t){if(!n.find(t=>t.property===e.property)){n.push({...e})}}return n}const _=function(t,n){try{const o=M.getInstance();const i=o.fetchDetails();const a=e.getResourceBundleFor("sap.cards.ap.generator.i18n");const s=t.getManifestEntry("sap.app");const c=t.getModel();const u=s.title;const l=s.description;const{entitySetWithObjectContext:f,serviceUrl:p,semanticObject:d,action:m,odataModel:h}=i;const g=i.entitySet;const b=h===E.V4;const U=F(b?c:c,g);const D=I(b?c:c,g,false);const w=I(b?c:c,g,true,a);const A=C(b?c:c,g);const W=N(D);return Promise.resolve(O(f,b?c:c,b)).then(function(e){return Promise.resolve(S(p,e,b,W)).then(function(o){function i(){f=$(f,h?.formatterConfigurationFromCardManifest);G(w,o,c,s);const i=h?.mainIndicatorOptions;const v=i?.mainIndicatorStatusKey||"";const N=i?.trendOptions;const O=h?.sideIndicatorOptions;const S=i?.mainIndicatorNavigationSelectedKey||"";const F=[];return Promise.resolve(x(t,v,e)).then(function({propertiesWithLabel:o,navigationPropertyData:C}){const I={name:v,value:o};if(I?.value){R(A,v,I.value)}if(v.length>0&&(c[v]===null||c[v]===undefined)){c[v]=C[v]}if(I.name){F.push(I)}const M=B(I,S);return Promise.resolve(y(s,f,h,e)).then(function(e){const o=k(v,w);const s=`${U}`,f=h?.groups||[{title:a?.getText("GENERATOR_DEFAULT_GROUP_NAME",[1]),items:[{label:"",value:"",isEnabled:false,name:"",navigationProperty:"",isNavigationEnabled:false}]}],y=i?.navigationValue||"",C=N,E={criticality:i?.criticalityOptions||[]},K=h?.headerUOM||"",W=h?.subtitle||l,x=h?.title||u;return Promise.resolve(V(c,t.getModel("i18n"),n)).then(function(n){return Promise.resolve(P(t)).then(function(t){const i={title:s,configuration:{title:x,subtitle:W,headerUOM:K,mainIndicatorOptions:E,advancedFormattingOptions:e,trendOptions:C,indicatorsValue:O,selectedTrendOptions:N?[N]:[],selectedIndicatorOptions:O?[O]:[],selectedNavigationPropertyHeader:I,selectedContentNavigation:[],selectedHeaderNavigation:[],navigationProperty:A,mainIndicatorNavigationSelectedValue:M,mainIndicatorStatusKey:v,navigationValue:y,mainIndicatorNavigationSelectedKey:S,mainIndicatorStatusUnit:o,selectedNavigationalProperties:F,entitySet:g,oDataV4:b,serviceUrl:p,properties:D,propertiesWithNavigation:w,groups:f,$data:c,targetUnit:T,deviationUnit:T,errorControls:[],actions:n,groupLimitReached:false,keyParameters:t,appIntent:`${d}-${m}`,isEdited:false}};return new r(i).attachPropertyChange(function(){i.configuration.isEdited=true})})})})})}const s=[];const c={};G(D,o,c,s);let f=H(a,D,A);let h;const N=function(){if(n){h=K(n,t.getModel("i18n"),D);return Promise.resolve(v(h,A,e,c,n)).then(function(){})}}();return N&&N.then?N.then(i):i(N)})})}catch(t){return Promise.reject(t)}};function G(t,e,n,r){const o=new Map(r.map(t=>[t.name,t]));t.forEach(t=>{const i=t.name;const a=e[i];const s=t.UOM;if(i&&a!==undefined&&a!==null){const e=U(t,a);t.value=a;t.labelWithValue=e;if(s&&!o.has(i)){r.push({propertyKeyForDescription:s,name:i,propertyKeyForId:i,value:s,valueState:b.None,valueStateText:""})}n[i]=a}else{t.labelWithValue=t.category?`${t.label}`:`${t.label} (<empty>)`}})}function H(t,e,n){const r=D(t,e);const o=w(t,n);return $(r,o)}function B(t,e){return t.value.find(t=>t.name===e)?.labelWithValue||""}function k(t,e){return t&&e.find(e=>e.name===t)?.labelWithValue||""}var J={__esModule:true};J._mergePropertyFormatters=$;J.getCardGeneratorDialogModel=_;J.addLabelsForProperties=G;return J});
//# sourceMappingURL=CardGeneratorModel-dbg.js.map