{"version":3,"file":"NavigationProperty-dbg-dbg.js","names":["sap","ui","define","___odata_ODataUtils","___pages_Application","___Batch","___Formatter","___PropertyExpression","getNavigationPropertiesWithLabel","rootComponent","navigationProperty","path","model","getModel","entitySet","serviceUrl","odataModel","Application","getInstance","fetchDetails","bODataV4","ODataModelVersion","V4","navigationPropertyInfo","getNavigationPropertyInfoFromEntity","selectedNavigationProperty","find","property","name","Promise","resolve","propertiesWithLabel","navigationPropertyData","properties","queryParams","navigationProperties","fetchDataAsync","createUrlParameters","then","data","undefined","forEach","propertyValue","labelWithValue","formatPropertyDropdownValues","label","e","reject","resolvePropertyPathFromExpression","updateNavigationPropertiesWithLabel","navigationEntityName","getNavigationPropertyInfo","textArrangement","_temp3","_temp","isNavigationForId","navigationEntitySet","propertyKeyForId","navigationalPropertiesForId","navigationPropertyInfoForId","push","_temp2","isNavigationForDescription","propertyKeyForDescription","navigationalPropertiesForDescription","navigationPropertyInfoForDesc","getNavigationPropertyInfoGroups","item","cardManifest","propertyPath","value","includes","replace","split","navigationalProperties","isNavigationEnabled","isEnabled","__exports","__esModule"],"sources":["NavigationProperty.ts"],"sourcesContent":["/*!\n * SAP UI development toolkit for HTML5 (SAPUI5)\n *  * (c) Copyright 2009-2025 SAP SE. All rights reserved\n */\nimport Component from \"sap/ui/core/Component\";\nimport { CardManifest } from \"sap/ui/integration/widgets/Card\";\nimport V2ODataModel from \"sap/ui/model/odata/v2/ODataModel\";\nimport V4ODataModel from \"sap/ui/model/odata/v4/ODataModel\";\nimport type { ArrangementOptions } from \"../app/controls/ArrangementsEditor\";\nimport type { PropertyInfo } from \"../odata/ODataTypes\";\nimport { fetchDataAsync, getNavigationPropertyInfoFromEntity } from \"../odata/ODataUtils\";\nimport { Application, ODataModelVersion } from \"../pages/Application\";\nimport type { GroupItem, NavigationParameter, Property } from \"../types/PropertyTypes\";\nimport { QueryParameters, createUrlParameters } from \"./Batch\";\nimport { formatPropertyDropdownValues } from \"./Formatter\";\nimport { resolvePropertyPathFromExpression } from \"./PropertyExpression\";\n\ntype Model = V2ODataModel | V4ODataModel;\n\n/**\n * Fetches the navigation properties with label for a single Navigation property\n * @param rootComponent\n * @param navigationProperty - Name of the navigation property\n * @param path\n */\nexport async function getNavigationPropertiesWithLabel(rootComponent: Component, navigationProperty: string, path: string) {\n\tconst model = rootComponent.getModel() as Model;\n\tconst { entitySet, serviceUrl, odataModel } = Application.getInstance().fetchDetails();\n\tconst bODataV4 = odataModel === ODataModelVersion.V4;\n\tconst navigationPropertyInfo = getNavigationPropertyInfoFromEntity(model, entitySet);\n\tconst selectedNavigationProperty = navigationPropertyInfo.find((property) => property.name === navigationProperty);\n\n\tif (!selectedNavigationProperty) {\n\t\treturn {\n\t\t\tpropertiesWithLabel: [],\n\t\t\tnavigationPropertyData: {}\n\t\t};\n\t}\n\n\tconst properties = selectedNavigationProperty.properties || [];\n\tconst queryParams: QueryParameters = {\n\t\tproperties: [],\n\t\tnavigationProperties: [\n\t\t\t{\n\t\t\t\tname: selectedNavigationProperty.name,\n\t\t\t\tproperties: []\n\t\t\t}\n\t\t]\n\t};\n\n\tconst data = await fetchDataAsync(serviceUrl, path, bODataV4, createUrlParameters(queryParams));\n\n\tif (data[selectedNavigationProperty.name] !== undefined && data[selectedNavigationProperty.name] !== null) {\n\t\tproperties.forEach((property) => {\n\t\t\tconst name = data[selectedNavigationProperty.name] as Record<string, unknown>;\n\t\t\tif (name[property.name] !== undefined && name[property.name] !== null) {\n\t\t\t\tconst propertyValue = name[property.name] as string;\n\t\t\t\tproperty.labelWithValue = formatPropertyDropdownValues(property as PropertyInfo, propertyValue);\n\t\t\t} else {\n\t\t\t\tproperty.labelWithValue = `${property.label} (<empty>)`;\n\t\t\t}\n\t\t});\n\t}\n\n\treturn {\n\t\tpropertiesWithLabel: properties,\n\t\tnavigationPropertyData: data\n\t};\n}\n\n/**\n * Updates the navigation properties with the provided labels.\n *\n * @param {NavigationParameter[]} navigationProperties - The array of navigation parameters to be updated.\n * @param {string} navigationEntityName - The name of the navigation entity to be updated.\n * @param {Property[]} propertiesWithLabel - The array of properties with labels to update the navigation entity with.\n */\nexport function updateNavigationPropertiesWithLabel(\n\tnavigationProperties: NavigationParameter[],\n\tnavigationEntityName: string,\n\tpropertiesWithLabel: Property[]\n) {\n\tconst navigationProperty = navigationProperties.find((property) => property.name === navigationEntityName);\n\tif (!navigationProperty) {\n\t\treturn;\n\t}\n\n\tnavigationProperty.properties = [...propertiesWithLabel];\n}\n\nexport const getNavigationPropertyInfo = async function (\n\ttextArrangement: ArrangementOptions,\n\tnavigationProperty: NavigationParameter[],\n\tpath: string\n) {\n\tconst { rootComponent } = Application.getInstance().fetchDetails();\n\tconst navigationPropertyInfo = [];\n\tif (textArrangement.isNavigationForDescription) {\n\t\tconst navigationEntitySet = textArrangement.propertyKeyForDescription;\n\t\tconst { propertiesWithLabel, navigationPropertyData } = await getNavigationPropertiesWithLabel(\n\t\t\trootComponent,\n\t\t\tnavigationEntitySet,\n\t\t\tpath\n\t\t);\n\t\ttextArrangement.navigationalPropertiesForDescription = propertiesWithLabel;\n\t\tupdateNavigationPropertiesWithLabel(navigationProperty, navigationEntitySet, textArrangement.navigationalPropertiesForDescription);\n\t\tconst navigationPropertyInfoForDesc = {\n\t\t\tnavigationEntitySet,\n\t\t\tnavigationPropertyData\n\t\t};\n\t\tnavigationPropertyInfo.push(navigationPropertyInfoForDesc);\n\t}\n\tif (textArrangement.isNavigationForId) {\n\t\tconst navigationEntitySet = textArrangement.propertyKeyForId as string;\n\t\tconst { propertiesWithLabel, navigationPropertyData } = await getNavigationPropertiesWithLabel(\n\t\t\trootComponent,\n\t\t\tnavigationEntitySet,\n\t\t\tpath\n\t\t);\n\t\ttextArrangement.navigationalPropertiesForId = propertiesWithLabel;\n\t\tupdateNavigationPropertiesWithLabel(navigationProperty, navigationEntitySet, textArrangement.navigationalPropertiesForId);\n\t\tconst navigationPropertyInfoForId = {\n\t\t\tnavigationEntitySet,\n\t\t\tnavigationPropertyData\n\t\t};\n\t\tnavigationPropertyInfo.push(navigationPropertyInfoForId);\n\t}\n\treturn navigationPropertyInfo;\n};\n\nexport const getNavigationPropertyInfoGroups = async function (\n\titem: GroupItem,\n\tnavigationProperty: NavigationParameter[],\n\tpath: string,\n\tcardManifest: Record<string, unknown>\n) {\n\tconst { rootComponent } = Application.getInstance().fetchDetails();\n\n\tconst propertyPath = resolvePropertyPathFromExpression(item.value, cardManifest as CardManifest);\n\tif (propertyPath?.includes(\"/\")) {\n\t\tconst [navigationEntitySet, property] = propertyPath.replace(/[{}]/g, \"\").split(\"/\");\n\t\tconst { propertiesWithLabel, navigationPropertyData } = await getNavigationPropertiesWithLabel(\n\t\t\trootComponent,\n\t\t\tnavigationEntitySet,\n\t\t\tpath\n\t\t);\n\t\titem.navigationalProperties = propertiesWithLabel;\n\t\titem.isNavigationEnabled = true;\n\t\titem.isEnabled = true;\n\t\titem.navigationProperty = property;\n\n\t\tif (item.navigationalProperties) {\n\t\t\tupdateNavigationPropertiesWithLabel(navigationProperty, navigationEntitySet, item.navigationalProperties);\n\t\t}\n\n\t\treturn {\n\t\t\tnavigationEntitySet,\n\t\t\tnavigationPropertyData\n\t\t};\n\t}\n};\n"],"mappings":"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","ignoreList":[]}