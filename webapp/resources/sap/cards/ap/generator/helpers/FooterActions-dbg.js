/*!
 * SAP UI development toolkit for HTML5 (SAPUI5)
 *  * (c) Copyright 2009-2025 SAP SE. All rights reserved
 */
"use strict";sap.ui.define(["sap/base/Log","sap/m/library","sap/ui/core/Lib","../helpers/I18nHelper","../pages/Application","../utils/CommonUtils"],function(t,e,n,o,r,a){"use strict";const i=typeof Symbol!=="undefined"?Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator")):"@@iterator";function s(t,e,n){if(!t.s){if(n instanceof c){if(n.s){if(e&1){e=n.s}n=n.v}else{n.o=s.bind(null,t,e);return}}if(n&&n.then){n.then(s.bind(null,t,e),s.bind(null,t,2));return}t.s=e;t.v=n;const o=t.o;if(o){o(t)}}}const c=function(){function t(){}t.prototype.then=function(e,n){const o=new t;const r=this.s;if(r){const t=r&1?e:n;if(t){try{s(o,1,t(this.v))}catch(t){s(o,2,t)}return o}else{return this}}this.o=function(t){try{const r=t.v;if(t.s&1){s(o,1,e?e(r):r)}else if(n){s(o,1,n(r))}else{s(o,2,r)}}catch(t){s(o,2,t)}};return o};return t}();function l(t){return t instanceof c&&t.s&1}function u(t,e,n){var o=-1,r,a;function i(u){try{while(++o<t.length&&(!n||!n())){u=e(o);if(u&&u.then){if(l(u)){u=u.v}else{u.then(i,a||(a=s.bind(null,r=new c,2)));return}}}if(r){s(r,1,u)}else{r=u}}catch(t){s(r||(r=new c),2,t)}}i();return r}const f=function(t,e){try{const{rootComponent:n}=v.getInstance().fetchDetails();const o=h().getProperty("/configuration/actions/bODataV4");const r=n.getModel()?.getMetaModel();return Promise.resolve(F(e,o,r)).then(function(n){C(t,n,e)})}catch(t){return Promise.reject(t)}};function m(t,e,n){if(typeof t[i]==="function"){var o=t[i](),r,a,f;function v(t){try{while(!(r=o.next()).done&&(!n||!n())){t=e(r.value);if(t&&t.then){if(l(t)){t=t.v}else{t.then(v,f||(f=s.bind(null,a=new c,2)));return}}}if(a){s(a,1,t)}else{a=t}}catch(t){s(a||(a=new c),2,t)}}v();if(o.return){var m=function(t){try{if(!r.done){o.return()}}catch(t){}return t};if(a&&a.then){return a.then(m,function(t){throw m(t)})}m()}return a}if(!("length"in t)){throw new TypeError("Object is not iterable")}var p=[];for(var d=0;d<t.length;d++){p.push(t[d])}return u(p,function(t){return e(p[t])},n)}const p=e["ButtonType"];const d=o["resolveI18nTextFromResourceModel"];const v=r["Application"];const P=r["ODataModelVersion"];const h=a["getDialogModel"];function y(t,e,n,o){let r={isConfirmationRequired:false,enablePath:""};if(e){r=z(t,n,o)}else{r=J(t,n)}return{label:e?t?.Label:t?.Label?.String,action:e?t.Action:t.Action.String.split("/")[1],isConfirmationRequired:r.isConfirmationRequired||false,enablePath:r.enablePath}}function g(t){if(t==="Positive"){return p.Accept}if(t==="Negative"){return p.Reject}return p.Default}function b(t,e,n){if(!t["sap.card"].configuration){t["sap.card"].configuration={parameters:{footerActionParameters:{},_adaptiveFooterActionParameters:{}}}}else if(t["sap.card"].configuration&&!t["sap.card"].configuration.parameters){t["sap.card"].configuration.parameters={footerActionParameters:{},_adaptiveFooterActionParameters:{}}}const o=t["sap.card"].configuration;const r=o.parameters;if(r&&!r._adaptiveFooterActionParameters){r._adaptiveFooterActionParameters={}}if(r&&!r.footerActionParameters){r.footerActionParameters={}}if(r?._adaptiveFooterActionParameters&&r?.footerActionParameters){r.footerActionParameters[n.titleKey]=e.parameters||{};r._adaptiveFooterActionParameters[n.titleKey]=e||{}}}function A(t,e){const n=t["sap.card"].configuration;const o=n?.parameters;if(o?._adaptiveFooterActionParameters&&o?.footerActionParameters){delete o.footerActionParameters[e.titleKey];delete o._adaptiveFooterActionParameters[e.titleKey]}}function $(t,e,n,o){const r=t["sap.card"].configuration;const a=r?.parameters;if(a?._adaptiveFooterActionParameters&&a?.footerActionParameters){const t=a._adaptiveFooterActionParameters[e.titleKey];t.style=n;t.enablePath=o}}function C(t,e,n){let o=t["sap.card"].footer;if(!o){t["sap.card"].footer={actionsStrip:[]};o=t["sap.card"].footer}const r=o.actionsStrip.length;if(r<2){o.actionsStrip.push({type:"Button",visible:false,text:e.label,buttonType:g(e.style),actions:[{type:"custom",enabled:e.enablePath?"${"+e.enablePath+"}":"true",parameters:"{{parameters.footerActionParameters."+n.titleKey+"}}"}]});b(t,e,n)}}function T(){const t=[{name:"Default",label:"Default",labelWithValue:"Default"},{name:"Positive",label:"Positive",labelWithValue:"Positive"},{name:"Negative",label:"Negative",labelWithValue:"Negative"}];return t}function O(t,e,n,o){const r=[];const a="com.sap.vocabularies.UI.v1.DataFieldForAction";t?.filter(function(t){const n=e?t?.$Type:t?.RecordType;return n===a}).map(function(t){const a=y(t,e,n,o);r.push(a)});return r}const E=function(t,e,n){try{return Promise.resolve(m(t,function(t){if(n){t.label=d(t.label,n);t.errorMessage=d(t?.errorMessage||"",n);t.placeholder=d(t?.placeholder||"",n)}const o=t.configuration;const r=o?.entitySet;const a=function(){if(r){return Promise.resolve(q(e,o?.serviceUrl,r)).then(function(){})}}();if(a&&a.then)return a.then(function(){})}))}catch(t){return Promise.reject(t)}};const S=function(t,e,n){try{let o=false;function r(t){return o?t:[{title:"",titleKey:"",style:"Default",enablePathKey:"",isStyleControlEnabled:false}]}const a=t["sap.card"].configuration;const i=a?.parameters;const s=[];const c=function(){if(i?._adaptiveFooterActionParameters){function t(){o=true;return s}const r=i._adaptiveFooterActionParameters;const a=Object.keys(r);const c=m(a,function(t){function o(){let e="Default";if(a.style==="positive"){e="Positive"}else if(a.style==="destructive"){e="Negative"}const n={title:a.label,titleKey:t,style:e,enablePathKey:a.enablePath,isStyleControlEnabled:true,isConfirmationRequired:a.data?.isConfirmationRequired||false,triggerActionText:a.triggerActionText};s.push(n)}const a=r[t];if(n){a.label=d(a.label,n);a.triggerActionText=d(a.triggerActionText,n)}const i=function(){if(a.actionParameters?.length){return Promise.resolve(E(a.actionParameters,e,n)).then(function(){})}}();return i&&i.then?i.then(o):o(i)});return c&&c.then?c.then(t):t(c)}}();return Promise.resolve(c&&c.then?c.then(r):r(c))}catch(l){return Promise.reject(l)}};const R=function(t,e,n){try{let o=false;function r(t){return o?t:[{title:"",titleKey:"",style:"Default",enablePathKey:"",isStyleControlEnabled:false}]}const a=function(){if(n&&e){return Promise.resolve(S(n,e,t)).then(function(t){o=true;return t})}}();return Promise.resolve(a&&a.then?a.then(r):r(a))}catch(i){return Promise.reject(i)}};const D=function(t,e,n){try{function o(t){return{annotationActions:c,addedActions:t,bODataV4:s,styles:T(),isAddActionEnabled:true,actionExists:c.length>0}}const{odataModel:r,entitySet:a,rootComponent:i}=v.getInstance().fetchDetails();const s=r===P.V4;const c=M(i,a,s);const l=c.length>0;return Promise.resolve(l?Promise.resolve(R(e,t,n)).then(o):o([]))}catch(u){return Promise.reject(u)}};function M(t,e,n){const o=n?t.getModel():t.getModel(),r=o.getMetaModel(),a=n?r.getObject("/"+e):r.getODataEntitySet(e),i=n?a?.$Type:a?.entityType,s=n?r.getObject("/"+i):r.getODataEntityType(i),c=n?"@com.sap.vocabularies.UI.v1.Identification":"com.sap.vocabularies.UI.v1.Identification";let l={};if(n){l=r.getObject("/"+i+"@")}const u=n?Object.keys(l):Object.keys(s);const f=u?.filter(t=>t===c);let m=[];if(f?.length){m=n?l[c]:s[c]}return O(m,n,r,e)}function _(t,e){const n=t["sap.card"]?.footer;const o=n?.actionsStrip.length;if(o&&n){const o=n.actionsStrip.filter(t=>{const n=t.actions[0].parameters;return n!=="{{parameters.footerActionParameters."+e.titleKey+"}}"});if(o.length){n.actionsStrip=o}else{delete t["sap.card"]?.footer}A(t,e)}}function I(t){t["sap.card"].footer={actionsStrip:[]};const e=t["sap.card"].configuration;const n=e?.parameters;if(n){n._adaptiveFooterActionParameters={};n.footerActionParameters={}}}function j(t,e){const n=t["sap.card"].footer;const o=n?.actionsStrip.length;if(o&&n){n.actionsStrip.forEach(n=>{const o=n.actions[0];const r=o.parameters;if(r==="{{parameters.footerActionParameters."+e.titleKey+"}}"){const r=e.enablePathKey?"${"+e.enablePathKey+"}":"true";const a=x(e);n.buttonType=g(e.style);o.enabled=r;$(t,e,a,e.enablePathKey||"")}})}}function x(t){let e="default";if(t.style==="Positive"){e="positive"}else if(t.style==="Negative"){e="destructive"}return e}const L=function(t){try{const e=[];const o=n.getResourceBundleFor("sap.cards.ap.generator.i18n");const r=m(t,function(t){function n(){e.push(i)}const r=t?.["com.sap.vocabularies.Common.v1.FieldControl"]?.EnumMember;const a=r==="com.sap.vocabularies.Common.v1.FieldControlType/Mandatory"||t?.nullable==="false";const i={label:t?.["sap:label"]||t?.name||"",id:t?.name||"",isRequired:a,errorMessage:a?o.getText("GENERATOR_ADAPTIVE_CARD_ACTION_PARAMETERS_ERROR_MESSAGE"):"",placeholder:""};const s=function(){if(t?.["sap:value-list"]==="fixed-values"){return Promise.resolve(nt(t)).then(function(t){if(t?.entitySet){i.configuration=t;i.placeholder=o.getText("GENERATOR_ADAPTIVE_CARD_ACTION_PARAMETERS_PLACEHOLDER")}})}}();return s&&s.then?s.then(n):n(s)});return Promise.resolve(r&&r.then?r.then(function(){return e}):e)}catch(t){return Promise.reject(t)}};const F=function(t,e,o){try{const r=n.getResourceBundleFor("sap.cards.ap.generator.i18n");const a=x(t);let i=[];let s;const c={isConfirmationRequired:t.isConfirmationRequired||false};const l=t.enablePathKey;const u={style:a,verb:"",label:t.title,actionParameters:[],data:c,enablePath:l||"",triggerActionText:r.getText("GENERATOR_ADAPTIVE_CARD_SUBMIT_ACTION_OK_BUTTON")};if(e){return Promise.resolve(Q(t,o)).then(function(e){i=e;u.verb=X(t,o);u.actionParameters=i||[];return u})}else{s=Y(t,o);u.verb=t.titleKey;u.parameters=s?.mActionParams?.parameterData;return Promise.resolve(L(s?.mActionParams?.additionalParameters)).then(function(t){u.actionParameters=t;c.actionParams={keys:Object.keys(s?.mActionParams?.parameterData)};u.data=c;return u})}}catch(t){return Promise.reject(t)}};function V(t,e){return t?.filter(t=>{const n=t?.$IsBound;if(n){return t?.$Parameter?.some(t=>e===t?.$Type)}})}function K(t){return t?.filter(t=>!t?.$IsBound)}const N=function(t,e,n){try{return Promise.resolve(t.requestValueListInfo(e,true)).then(function(t){const e=t?.[""];const o=e?.$model;const r=w(e,n||"");const a=e?.["CollectionPath"];const i=o?.getMetaModel()?.getObject(`/${a}/${r}@`);return{valueHelpAnnotation:i,valueListPropertyName:r,valueHelpEntitySet:a,valueListModelServiceUrl:o?.getServiceUrl()}})}catch(t){return Promise.reject(t)}};const U=function(t,e){try{let n=false;const{rootComponent:o,entitySet:r}=v.getInstance().fetchDetails();return Promise.resolve(function(){if(e){function a(t){return n?t:l?.["@com.sap.vocabularies.Common.v1.Label"]||e}const i=o.getModel()?.getMetaModel();const s=`/${r}/${t}/${e}`;const c=i.getObject(`/${r}`);const l=i.getObject(`/${c?.$Type}/${e}@`);const u=function(){if(i.getObject(`${s}@`)?.["@com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]){return Promise.resolve(N(i,s,e)).then(function({valueHelpAnnotation:t}){const e=l?.["@com.sap.vocabularies.Common.v1.Label"]||t?.["@com.sap.vocabularies.Common.v1.Label"];n=true;return e})}}();return u&&u.then?u.then(a):a(u)}}())}catch(t){return Promise.reject(t)}};function w(t,e){const n=t?.Parameters.find(function(t){return t?.LocalDataProperty?.$PropertyPath===e});return n?.ValueListProperty}function B(t,e,n){if(n==="TextOnly"){return"${"+e+"}"}else if(n==="TextLast"){return"${"+t+"}"+" ("+"${"+e+"}"+")"}else if(n==="TextSeparate"){return"${"+t+"}"}return"${"+e+"}"+" (${"+t+"})"}const q=function(t,e,n){try{return Promise.resolve(fetch(e)).then(function(e){const{odataModel:o}=v.getInstance().fetchDetails();const r=o===P.V4;const a=function(){if(e&&typeof e.json==="function"){return Promise.resolve(e.json()).then(function(e){const o=r?e?.value:e?.d?.results;if(o?.length){t[n]=o}})}}();if(a&&a.then)return a.then(function(){})})}catch(t){return Promise.reject(t)}};const k=function(t,e){try{const n={serviceUrl:"",value:"",entitySet:"",title:""};if(!e){return Promise.resolve(n)}const{entitySet:o,rootComponent:r}=v.getInstance().fetchDetails();const a=o;const i=h();const s=r.getModel()?.getMetaModel();const c=`/${a}/${t}/${e}`;const l=s.getObject(`${c}@`);if(!l?.["@com.sap.vocabularies.Common.v1.ValueListWithFixedValues"]){return Promise.resolve(n)}return Promise.resolve(N(s,c,e)).then(function({valueHelpAnnotation:t,valueListPropertyName:e,valueHelpEntitySet:n,valueListModelServiceUrl:o}){const r=t?.["@com.sap.vocabularies.Common.v1.Text"]?.$Path;const a=t?.["@com.sap.vocabularies.Common.v1.Text@com.sap.vocabularies.UI.v1.TextArrangement"];const s=a?.$EnumMember&&e&&r||e&&r?B(e,r,a?.$EnumMember?.split("/")[1]):"${"+e+"}";let c=o;c=e&&r?`${c}${n}?$select=${e},${r}`:`${c}${n}?$select=${e}`;c=`${c}&skip=0&$top=20`;const l=i.getProperty("/configuration/$data");return Promise.resolve(q(l,c,n)).then(function(){i.setProperty("/configuration/$data",l);return{entitySet:n,serviceUrl:c,value:s,title:"${"+e+"}"}})})}catch(t){return Promise.reject(t)}};const H=function(t,e,o){try{let r=false;const a=[];let i=0;return Promise.resolve(function(){if(t&&t.$Parameter){const s=n.getResourceBundleFor("sap.cards.ap.generator.i18n");return m(t.$Parameter,function(n){function c(){i++;if(i===t.$Parameter.length){r=true;return a}}const l=!o||o&&i>0;const u=function(){if(l){const t=n.$Nullable===false;const o=n.$Name;return Promise.resolve(U(e,n.$Name)).then(function(r){const i={isRequired:t,id:o,label:r,errorMessage:t?s.getText("GENERATOR_ADAPTIVE_CARD_ACTION_PARAMETERS_ERROR_MESSAGE"):"",placeholder:""};return Promise.resolve(k(e,n.$Name)).then(function(t){const e=t;if(e?.entitySet){i["configuration"]=e;i.placeholder=s.getText("GENERATOR_ADAPTIVE_CARD_ACTION_PARAMETERS_PLACEHOLDER")}a.push(i)})})}}();return u&&u.then?u.then(c):c(u)},function(){return r})}}())}catch(t){return Promise.reject(t)}};function G(t){if(t){const e=t["@Org.OData.Core.V1.OperationAvailable"];if(e?.$Path){return e.$Path}else if(e?.Bool){return e.Bool}}return""}function W(t){if(!t){return false}if(t.Bool===undefined){return true}const e=t.Bool;if(typeof e==="string"){const t=e.toLowerCase();return!(t=="false"||t==""||t==" ")}return!!e}function z(t,e,n){const o=t.Action;const r=o.indexOf("(")>-1?o.split("(")[0]:o;const a=e.getObject("/"+n+"/"+r+"@");const i=G(a);const s=W(a?.["@com.sap.vocabularies.UI.v1.Critical"]);return{enablePath:i,isConfirmationRequired:s}}function J(t,e){const n=t.Action.String.split("/")[1];const o=e.getODataFunctionImport(n);return{enablePath:o?.["sap:applicable-path"]||"",isConfirmationRequired:W(o?.["com.sap.vocabularies.Common.v1.IsActionCritical"])}}const Q=function(t,e){try{const{entitySet:n}=v.getInstance().fetchDetails();const o=t.titleKey||"";const r=o.indexOf("(")>-1?o.split("(")[0]:o;const a=e.getObject(`/${n}/${r}`);let i=o.indexOf("(")>-1?o?.split("(")[1]:"";i=i.indexOf(")")>-1?i.replace(")",""):i;if(a?.$kind==="ActionImport"&&a?.$Action){const t=e.getObject("/"+a?.$Action);const n=K(t);return H(n[0],r)}const s=V(a,i);return Promise.resolve(function(){if(s?.length&&s[0]?.$Parameter!=null&&s[0]?.$Parameter.length>1){return Promise.resolve(H(s[0],r,true))}}())}catch(t){return Promise.reject(t)}};function X(t,e){const n=t.titleKey||"";const o=n.indexOf("(")>-1?n.split("(")[0]:n;const r=e.getObject("/"+o)||[];let a=n.indexOf("(")>-1?n.split("(")[1]:"";a=a.indexOf(")")>-1?a.replace(")",""):a;if(r?.$kind==="ActionImport"&&r?.$Action){return n?.split("/")[1]}const i=V(r,a);if(i?.length){return o}return o}function Y(e,n){const{entitySet:o}=v.getInstance().fetchDetails();const r=e.titleKey;const a=n.getODataFunctionImport(r);const i=h().getProperty("/configuration/$data");const s=n.getODataEntitySet(o);const c=n.getODataEntityType(s?.entityType);const l=Z(c);const u={};const f={parameterData:{},additionalParameters:[]};a?.parameter?.forEach(function(e){tt(e,c,n);const o=e?.name||"";const r=!!l[o];let s;if(i?.hasOwnProperty(o)){s=i[o]}else if(r&&i&&a["sap:action-for"]){t.error("Key parameter of action not found in current context: "+o);throw new Error("Key parameter of action not found in current context: "+o)}f.parameterData[o]=s;const m=!!u[o];if(!m&&(!r||!a["sap:action-for"])&&e.mode.toUpperCase()=="IN"){f.additionalParameters.push(e)}});return{mActionParams:f,functionImport:a}}const Z=function(t){const e={};t.key.propertyRef.forEach(t=>{if(t.name){e[t.name]=true}});return e};const tt=function(t,e,n){if(e&&t&&!t["com.sap.vocabularies.Common.v1.Label"]){const o=n.getODataProperty(e,t.name,false);if(o&&o["com.sap.vocabularies.Common.v1.Label"]){t["com.sap.vocabularies.Common.v1.Label"]=o["com.sap.vocabularies.Common.v1.Label"]}}};function et(t,e){const n=[];let o="",r="";e.forEach(t=>{const e=t?.ValueListProperty?.String;if(e){n.push(e);r=t?.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterDisplayOnly"?e:r;o=t?.RecordType==="com.sap.vocabularies.Common.v1.ValueListParameterInOut"?e:o}});const a=`${t}?$select=${n.join(",")}`;return{serviceUrl:a,valueListPropertyPath:o,descriptionPath:r}}const nt=function(t){try{const e={serviceUrl:"",value:"",entitySet:"",title:""};if(!t){return Promise.resolve(e)}const n=t?.["com.sap.vocabularies.Common.v1.ValueList"];const o=n?.Parameters;const r=n?.CollectionPath?.String;return Promise.resolve(function(){if(r){const{rootComponent:e}=v.getInstance().fetchDetails();const{serviceUrl:n,valueListPropertyPath:a,descriptionPath:i}=et(`${e.getModel()?.sServiceUrl}/${r}`,o);let s="TextOnly";if(t?.["com.sap.vocabularies.UI.v1.TextArrangement"]){s=t["com.sap.vocabularies.UI.v1.TextArrangement"]?.EnumMember?.split("/")[1]}const c=a&&i?B(a,i,s):"${"+a+"}";const l=h();const u=l.getProperty("/configuration/$data");return Promise.resolve(q(u,n,r)).then(function(){l.setProperty("/configuration/$data",u);return{entitySet:r,serviceUrl:n,value:c,title:"${"+a+"}"}})}}())}catch(t){return Promise.reject(t)}};var ot={__esModule:true};ot.getActionStyles=T;ot.getDefaultAction=R;ot.getCardActionInfo=D;ot.getCardActions=M;ot.addActionToCardManifest=f;ot.removeActionFromManifest=_;ot.resetCardActions=I;ot.updateCardManifestAction=j;ot.getActionParameterValue=B;ot.updateModelData=q;ot.getActionParameterConfigurationV2=nt;return ot});
//# sourceMappingURL=FooterActions-dbg.js.map