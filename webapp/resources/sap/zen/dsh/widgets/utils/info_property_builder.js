/*
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/sac/df/thirdparty/lodash","sap/zen/dsh/utils/BaseHandler"],function(jQuery,e){"use strict";function t(e,t){this._properties=jQuery.extend(true,{},e);this._chartType=t}t.prototype.getPropertyValue=function(t){var r=t.split(".");return e.reduce(r,function(e,t){return e&&e[t]},this._properties)};t.prototype.getPropertyDefaultValue=function(t){var r=t.split(".");var a;try{var o=sap.viz.api.metadata.Viz.get(this._chartType).properties;var i=r.shift();a=e.reduce(r,function(e,t){return e.children[t]},o[i]).defaultValue}catch(e){}return a};t.prototype.setPropertyValue=function(t,r){var a=t.split(".");var o=a.pop();var i=e.reduce(a,function(e,t){e[t]=e[t]||{};return e[t]||{}},this._properties);i[o]=r};t.prototype._handleNoneAndDefaultFormatStringProperties=function(t){t=t||this._properties;for(var r in t){if(!Object.prototype.hasOwnProperty.call(t,r)){continue}if(r==="formatString"){if(t[r]==="Default"){delete t[r]}else if(t[r]==="None"){t[r]=""}}else if(e.isObject(t[r])){this._handleNoneAndDefaultFormatStringProperties(t[r])}}};t.prototype.mapFormatStrings=function(t){t=p(t);t=l(t);this._handleNoneAndDefaultFormatStringProperties();var r=this.getPropertyValue("tooltip.formatString");if(e.isUndefined(r)&&t){var a=this.getPropertyDefaultValue("tooltip.formatString");if(!(a&&a.charAt(a.length-1)==="%")){this.setPropertyValue("tooltip.formatString",t)}}var o=this.getPropertyValue("plotArea.dataLabel.formatString");if(e.isUndefined(o)){var i=this.getPropertyValue("plotArea.dataLabel.type")||this.getPropertyDefaultValue("plotArea.dataLabel.type");if(i&&i.indexOf("value")!==-1){var n=s(e.clone(t));this.setPropertyValue("plotArea.dataLabel.formatString",n)}}function p(t){if(e.isString(t)){var r,a;r="#(?![#|"+sap.common.globalization.NumericFormatManager.getThousandSeparator()+"]).(?=#)";a=new RegExp(r,"g");t=t.replace(a,"#"+sap.common.globalization.NumericFormatManager.getThousandSeparator());r="0(?![0|"+sap.common.globalization.NumericFormatManager.getDecimalSeparator()+"]).(?=0)";a=new RegExp(r,"g");t=t.replace(a,"0"+sap.common.globalization.NumericFormatManager.getDecimalSeparator());r="\\ ";a=new RegExp(r,"g");t=t.replace(a,"\\ ")}else if(e.isObject(t)){e.each(e.keys(t),function(e){t[e]=p(t[e])})}return t}function l(t){if(e.isString(t)){t=t.replace("'-'","-")}else if(e.isObject(t)){e.each(e.keys(t),function(e){t[e]=l(t[e])})}return t}function s(t){var r="[^#\\"+sap.common.globalization.NumericFormatManager.getThousandSeparator()+"0\\"+sap.common.globalization.NumericFormatManager.getDecimalSeparator()+";-]";var a=new RegExp(r,"g");if(e.isString(t)){t=t.replace(a,"")}else if(e.isObject(t)){e.each(e.keys(t),function(e){t[e]=s(t[e])})}return t}return this};t.prototype.setDefaultColorPalette=function(){var e=this.getPropertyDefaultValue("plotArea.colorPalette");if(e&&e.length){this._properties.plotArea=this._properties.plotArea||{};this._properties.plotArea.colorPalette=this._properties.plotArea.colorPalette||t.DEFAULT_COLOR_PALETTE}return this};t.prototype.getProperties=function(){return this._properties};t.prototype.applyScalingFactor=function(e,t){var r=e._measureMembers;var a=t.metadata.fields;for(var o=0;o<r.length;o++){if(r[o].scalingFactor>0){var i=this.getScalingDisplayString(r[o].scalingFactor);for(var n=0;n<a.length;n++){if(a[n].id===r[o].key){a[n].name=a[n].name+i}}}}};t.prototype.getScalingDisplayString=function(e){var t="1";for(var r=0;r<e;r++){t+="0"}var a="$1"+sap.common.globalization.NumericFormatManager.getThousandSeparator()+"";var o=t.replace(/(\d)(?=(\d\d\d)+(?!\d))/g,a);o=" (â€‹*"+o+")";return o};t.DEFAULT_COLOR_PALETTE=["#748CB2","#9CC677","#EACF5E","#F9AD79","#D16A7C","#8873A2","#3A95B3","#B6D949","#FDD36C","#F47958","#A65084","#0063B1","#0DA841","#FCB71D","#F05620"];return t});
//# sourceMappingURL=info_property_builder.js.map