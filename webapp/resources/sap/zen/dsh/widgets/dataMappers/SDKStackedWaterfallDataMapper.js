/*!
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/sac/df/thirdparty/lodash","sap/zen/dsh/utils/BaseHandler","sap/zen/dsh/widgets/dataMappers/SDKChartDataMapper","sap/zen/dsh/widgets/charts/ChartException"],function(jQuery,e,s,i,t){"use strict";function a(){i.apply(this,arguments);var e=true;var s=0;var a=false;this.getAnalysisAxisValue=function(){return this.analysisAxisValue};this.createAnalysisAxis=function(i,t,n,r,u){var o=[];var l=this.getDataMapperHelper();if(this.getMeasureAxis()=="COLUMNS")u++;r++;if(this.isMeasuresOnlyCheck(i)){if(this.getMeasureAxis()=="ROWS"){l.setMeasuresOnAxis(2,i,o,true);l.setMeasuresOnAxis(1,i,o,false);s=1}else{l.setMeasuresOnAxis(1,i,o,false);l.setMeasuresOnAxis(2,i,o,true);s=1}}else if(this.getMeasureAxis()=="ROWS"&&r>0&&u>0){this.setDimensionsOnAxis(2,i,o,"ROWS",r,i.axis_rows,true);this.setDimensionsOnAxis(1,i,o,"COLUMNS",u,i.axis_columns,true);s=this.getIDimensionOnCols(i,o,1);a=true}else if(this.getMeasureAxis()=="COLUMNS"&&r>0&&u>0){this.setDimensionsOnAxis(1,i,o,"ROWS",r,i.axis_rows,true);this.setDimensionsOnAxis(2,i,o,"COLUMNS",u,i.axis_columns,true);s=this.getIDimensionOnCols(i,o,0);a=true}else{if(this.getMeasureAxis()=="ROWS"){this.setDimensionsOnAxis(2,i,o,"ROWS",r,i.axis_rows,false);this.setDimensionsOnAxis(1,i,o,"COLUMNS",u,i.axis_columns,true)}else{this.setDimensionsOnAxis(1,i,o,"ROWS",r,i.axis_rows,true);this.setDimensionsOnAxis(2,i,o,"COLUMNS",u,i.axis_columns,false)}}if(this.getMeasureAxis()=="COLUMNS"&&i.dimensions[0].containsMeasures){e=false;if(o[0].data[0]!=undefined)s=o[0].data[0].values.length;else s=1}return o};this.getIDimensionOnCols=function(e,s,i){var t=0;for(var a=0;a<e.dimensions.length;a++){var n=e.dimensions[a];if(n.containsMeasures==true){t=s[i].data[0].values.length}}return t};this.setDimensionsOnAxis=function(e,s,i,t,a,n,r){var u={};var o=[];u.index=e;u.data=[];var l=-1;var h=0;var f=-1;jQuery.each(n,function(e,i){if(f==-1||i[h]==f){jQuery.each(i,function(e,i){if(i!=-1&&(!s.dimensions[e].containsMeasures&&r)){if(f!=-1&&f)if(l==-1)l=e;if(o[e-l]==undefined)o[e-l]=[];o[e-l].push(s.dimensions[e].members[i].text)}else if(s.dimensions[e].containsMeasures&&f==-1){h=e;f=i}})}});for(var g=0;g<s.dimensions.length;g++){var p=s.dimensions[g];if(p.containsMeasures&&!r||p.axis!=t){continue}if(!p.containsMeasures){var v={};v.name=p.text;v.type="Dimension";v.values=o[g-l];u.data.push(v)}}this.setEmptyDimension(e,t,u);i.push(u)};this.isMeasuresOnlyCheck=function(e){if(e.dimensions.length==1){if(e.dimensions[0].containsMeasures==true){return true}}return false};this.createMeasureValues=function(i,t,n,r){var u=[];var o={};o.index=1;o.data=[];var l={};var h=0;var f=[];f=this.getValues(i.data,n,h,false,s,e,a,r);l.type="Measure";for(var g=0;g<i.dimensions.length;g++){var p=i.dimensions[g];if(p.containsMeasures){if(i.dimensions.length===1&&i.dimensions[0].containsMeasures){l.name=""}else{l.name=i.dimensions[g].members[0].text}}}l.values=f;o.data.push(l);u.push(o);return u};this.setEmptyDimension=function(e,s,i){if(s=="COLUMNS"&&this._getColDimensionCounter()==0){var t={};t.name="";t.type="Dimension";t.values=[""];i.data.push(t)}else if(s=="ROWS"&&this._getRowDimensionCounter()==0){t={};t.name="";t.type="Dimension";t.values=[""];i.data.push(t)}};this.getValues=function(e,s,i,t,a,n,r,u){var o=[];if(s=="ROWS"){if(r){o=this.getAllRowValuesInArray(e,i,a,t,n,u)}else{o.push(e)}}else if(s=="COLUMNS"){if(t)o=this.getFirstMeasureColValuesInArray(e,i,a);else if(r){o=this.getAllColValuesInArray(e,i,a,t,n,u)}else{o.push(e)}}return o};this.getAllRowValuesInArray=function(e,s,i,t,a,n){var r=[];var u=[];var o=e.length/this.getMeasureCounter()*s;var l=i;var h=i*s;if(!t)l=e.length;var f=0;if(!a){for(var g=o;g<l;++g){f++;var p=e[g]+"";u.push(parseFloat(p.replace(/,/g,"")));if(i==0||f==i){r.push(u);f=0;u=[]}}}else{var v=n>1?this.getMeasureCounter():1;var m=0;for(g=o;g<l/this.getMeasureCounter();++g){f++;p=e[h+v*i*m]+"";u.push(parseFloat(p.replace(/,/g,"")));if(i==0||f==i){r.push(u);f=0;u=[];m++;h=0}else{h++}}}return r};this.getFirstMeasureColValuesInArray=function(e,s,i){var t=[];var a=[];var n=0;for(var r=0;r<i;++r){n++;var u=e[s]+"";a.push(parseFloat(u.replace(/,/g,"")));s+=e.length/i;if(i==0||n==i){t.push(a);n=0;a=[]}}return t};this.getAllColValuesInArray=function(e,s,i,t,a){var n=[];var r=[];var u=0;var o=this.getMeasureCounter();if(t){for(var l=0;l<e.length/this.getMeasureCounter();++l){u++;var h=e[s]+"";r.push(parseFloat(h.replace(/,/g,"")));s+=this.getMeasureCounter();if(i==0||u==i){n.push(r);u=0;r=[]}}}else{o=a==1?this.getMeasureCounter():1;var f=i*s;var g=0;for(l=0;l<e.length/this.getMeasureCounter();++l){u++;h=e[f+g*o]+"";r.push(parseFloat(h.replace(/,/g,"")));if(i==0||u==i){n.push(r);u=0;r=[];g++;f=0}else{f=f+Math.round(e.length/i)}}}return n};this.validateData=function(){var e=this._getColDimensionCounter();var s=this._getRowDimensionCounter();var i=this.getMeasureCounter();var a=this.getMeasureAxis();var n=this.getMessages().chart_mapping_error;var r=null;if(i>0&&s>=1&&e==0&&a=="ROWS"){r=this.getMessages().waterfall_datamapping_rmd}else if(i>0&&s==0&&e>=1&&a=="COLUMNS"){r=this.getMessages().waterfall_datamapping_cmd}else if(s>1&&a=="COLUMNS"){r=this.getMessages().waterfall_datamapping_rnd_cm}else if(e>1&&a=="ROWS"){r=this.getMessages().waterfall_datamapping_rm_cnd}else return;throw new t(n,r)}}return a});
//# sourceMappingURL=SDKStackedWaterfallDataMapper.js.map