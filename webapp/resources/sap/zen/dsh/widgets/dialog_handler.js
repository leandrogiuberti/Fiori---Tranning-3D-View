/*
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/zen/dsh/utils/BaseHandler","sap/m/Dialog"],function(jQuery,BaseHandler,MDialog){"use strict";var DialogHandler=function(){BaseHandler.apply(this,arguments);var dispatcher=BaseHandler.dispatcher;this.createAndAdd=function(t,e,o,i,n){if(sap.zen.designmode){if(o.width){this._componentWidth=o.width}if(o.height){this._componentHeight=o.height}o.leftmargin=e.fullscreen?0:Math.floor(jQuery(document).width()/2-o.width/2);o.topmargin=e.fullscreen?0:Math.floor(jQuery(document).height()/2-o.height/2);if(e.fullscreen){o.width=jQuery(document).width();o.height=jQuery(document).height()}var r=this.createAbsoluteLayout();r.addStyleClass("uidialogzenroot");r.oDialogProperties={isAbsLayout:true};r.titleArea=this.createTitleAreaForDesignMode(this.oAbsLayout,e);r.contentArea=this.createContentAreaForDesignMode(this.oAbsLayout,e);r.footerArea=this.createFooterAreForDesignModea(this.oAbsLayout,e);i(r,n);BaseHandler.dispatcher.updateComponentProperties(r,o);this.init(r,e,o);r.fnOrigAfterRendering=r.onAfterRendering;r.onAfterRendering=function(){if(this.fnOrigAfterRendering){this.fnOrigAfterRendering()}var t=this;setTimeout(function(){if(t.footerArea){var e=t.footerArea.getPositions();var o=0;for(var i=e.length-1;i>=0;i--){var n=e[i];n.updatePosition({right:o+"px",top:"0px"});o+=n.$().width()}}},50)};r.onAfterRendering();return r}else{var a=this.createDefaultProxy(e["id"]);a.oDialogProperties={isAbsLayout:false,oComponentProperties:null,oProperties:null,tDialogContent:[],oMsgComponent:null,oMsgControl:null};i(a,n);this.init(a,e,o);return a}};this.update=function(t,e,o){e=e||{};if(o.width){this._componentWidth=o.width}if(o.height){this._componentHeight=o.height}var i=o.width?o.width:this._componentWidth;var n=o.height?o.height:this._componentHeight;var r=Math.floor(jQuery(document).width()/2-i/2);var a=Math.floor(jQuery(document).height()/2-n/2);o.leftmargin=e.fullscreen?1:r;o.topmargin=e.fullscreen?1:a;if(e.fullscreen){o.width=jQuery(document).width();o.height=jQuery(document).height()}this.init(t,e,o);if(sap.zen.designmode||!Object.prototype.hasOwnProperty.call(e,"show")){var s=t.oDialogProperties.isAbsLayout?t:t.oDialogProperties.oAbsLayout;if(s){s.onAfterRendering()}}return t};this.init=function(t,e,o){if(sap.zen.designmode){var i,n;if(t.footerArea&&e.Buttons){t.footerArea.removeAllContent();for(var r in e.Buttons){i=e.Buttons[r].Button;n=new sap.m.Button({text:i.text,enabled:i.buttonenabled==="X",visible:i.buttonvisible==="X"});t.footerArea.addContent(n,{top:"-1000px"})}}if(t.titleArea&&e.title){t.titleArea.removeAllContent();var a=this.createTextView({text:e.title});a&&t.titleArea.addContent(a)}if(e.content){var s=t.contentArea;var l=e.content;this.updateChildren(l,s,function(t,e){dispatcher.insertIntoAbsoluteLayoutContainer(s,t,e)},function(t){s.removeContent(t)})}}else{this.extractDialogProperties(t,e,o);this.initDialog(t)}};if(sap.zen.designmode){sap.zen.designmode.DialogContainerDecorator=function(t,e,o){"use strict";sap.zen.designmode.AbsLayoutDecorator.apply(this,arguments);this._debugInfo="DialogContainerDecorator";var i=this;function n(i){var n=o.getAllChildren(e,true);for(var r in n){var a=t.getDecorator(n[r].o);if(a){i(a)}}}function r(t,e){var o={};var i=t.position();var n=e.position();if(this.origPos){var r=this.origPos.left-i.left;var a=r+n.left;o["left"]=a+"px";var s=this.origPos.top-i.top;var l=s+n.top;o["top"]=l+"px"}return o}var a=this.create;var s=this.update;this.create=function(){a.apply(this,arguments)};this.moveBegin=function(){sap.zen.designmode.DecoratorManager.instance.abortMove();this.origPos=this.jqDecorator.position()};this.moveEnd=function(){n(function(t){if(t){var e=r.bind(i,t.$(),i.jqDecorator)();t.$().css(e)}})};this.update=function(){s.apply(this,arguments)};this.getDockingVisualizers=function(){return{}}}}this.createTitleAreaForDesignMode=function(t){var e=this.createAbsoluteLayout();e.addStyleClass("uidialogzentitle");t.insertContent(e,0);return e};this.createFooterAreaForDesignMode=function(t){var e=this.createAbsoluteLayout();e.addStyleClass("uidialogzenfooter sapMFooter-CTX");t.insertContent(e,2,{bottom:"0px",left:"0px"});return e};this.createContentAreaForDesignMode=function(t){var e=this.createAbsoluteLayout();e.addStyleClass("uidialogzencontent");t.insertContent(e,1,{top:"2.5rem"});return e};this.extractDialogProperties=function(t,e,o){t.oDialogProperties.oComponentProperties=o;t.oDialogProperties.oProperties=e;t.oDialogProperties.oMsgComponent=null;t.oDialogProperties.tDialogContent=[];if(e.content&&e.content.length>0){for(var i=0;i<e.content.length;i++){var n=e.content[i];if(n&&n.component){if(n.component.type==="MESSAGEVIEW_COMPONENT"&&!t.oDialogProperties.oMsgComponent){t.oDialogProperties.oMsgComponent=n.component}else{t.oDialogProperties.tDialogContent.push(n)}}}}};this.initDialog=function(t){if(!t||!t.oDialogProperties||!t.oDialogProperties.oProperties){return}var e=t.oDialogProperties.oProperties;var o=Object.prototype.hasOwnProperty.call(e,"show")&&e.show;if(!t.oDialog){if(o){t.oDialog=new MDialog(t.getId()+"_dlg",{stretch:e.fullscreen,resizable:e.resizable,draggable:e.draggable});t.oDialog.attachAfterClose(this.dialogCallbackOnAfterClose(t))}}if(t.oDialog){if(e.title){t.oDialog.setTitle(e.title)}this.initDialogMessage(t);this.initDialogContent(t);this.initDialogButtons(t);if(o){this.showDialog(t)}else{this.hideDialog(t)}}};this.initDialogMessage=function(t){if(!t||!t.oDialogProperties){return}if(t.oDialogProperties.oMsgComponent){var e=dispatcher.getComponentIdForControlId(t.oDialogProperties.oMsgComponent.content.control.id)==null;if(e){t.oDialogProperties.oMsgControl=dispatcher.dispatchCreateControl(t.oDialogProperties.oMsgComponent)}else{dispatcher.dispatchUpdateControl(t.oDialogProperties.oMsgComponent);dispatcher.updateComponentProperties(t.oDialogProperties.oMsgControl,t.oDialogProperties.oMsgComponent)}}};this.initDialogContent=function(t){if(!t||!t.oDialog||!t.oDialogProperties){return}var e=null;e=sap.ui.getCore().byId(t.getId()+"_abslayout");if(!e){e=this.createAbsoluteLayout(t.getId()+"_abslayout");e.zenControlType="absolutelayout";e.setVisible(false);e.onAfterRendering=this.dialogCallbackOnAfterRendering(e,t)}dispatcher.updateComponentProperties(e,t.oDialogProperties.oComponentProperties);this.updateChildren(t.oDialogProperties.tDialogContent,e,function(t,o){dispatcher.insertIntoAbsoluteLayoutContainer(e,t,o)},function(t){e.removeContent(t)});e.setVisible(true);if(t.oDialogProperties.oProperties.fullscreen){e.setWidth("100%")}t.oDialog.removeAllContent();t.oDialog.insertContent(e,0)};this.initDialogButtons=function(t){if(!t||!t.oDialog||!t.oDialogProperties||!t.oDialogProperties.oProperties){return}var e=t.oDialogProperties.oProperties;if(e.Buttons&&e.Buttons.length){t.oDialog.removeAllButtons();for(var o in e.Buttons){var i=e.Buttons[o].Button;var n=this.createButton(i.name);n.setText(i.text);n.setEnabled(i.buttonenabled==="X");n.setVisible(i.buttonvisible==="X");if(i.onclick){(function(t){n.attachPress(function(){var e=new Function(t);e()})})(i.onclick)}else{n.setEnabled(false)}t.oDialog.addButton(n)}}};this.initDialogFooter=function(t){if(!t||!t.oDialog||!t.oDialogProperties.oMsgControl){return}var e=sap.ui.getCore().byId(t.oDialog.getId()+"-footer");if(!e){return}var o=t.oDialogProperties.oMsgControl;var i=[];i.push(o);var n=e.getContent();if(n){for(var r=0;r<n.length;r++){var a=n[r];if(a&&a!==o){i.push(a)}}}e.removeAllContent();for(r=0;r<i.length;r++){a=i[r];if(a){e.addContent(a)}}};this.showDialog=function(t){if(!t||!t.oDialog){return}if(!t.oDialog.isOpen()){t.oDialog.open()}};this.hideDialog=function(t){if(!t||!t.oDialog){return}if(t.oDialog.isOpen()){t.oDialog.close()}};this.dialogCallbackOnAfterClose=function(oControl){return function(){oControl.oDialog=null;this.removeAllButtons();this.removeAllContent();this.destroy();var loMsgControl=sap.ui.getCore().byId(oControl.oDialogProperties.oMsgControl.getId());if(!loMsgControl){dispatcher.dispatchRemove(oControl.oDialogProperties.oMsgControl)}if(oControl.oDialogProperties.oProperties.command){eval(oControl.oDialogProperties.oProperties.command)}}};this.dialogCallbackOnAfterRendering=function(t,e){t.fOrigOnAfterRendering=t.onAfterRendering;var o=this;return function(){if(this.fOrigOnAfterRendering){this.fOrigOnAfterRendering()}o.initDialogFooter(e)}};this.fnOrigRemove=this.remove;this.remove=function(t){if(this.fnOrigRemove&&sap.zen.designmode.DecoratorManager.instance.getDecorator(t)){this.fnOrigRemove.apply(this,t)}};this.applyForChildren=function(t,e){if(!t.getPositions){return null}var o=t.getPositions();for(var i=0;i<o.length;i++){var n=o[i].getControl();if(n){var r=e(n);if(r)return r}}return null};this.getDefaultProxyClass=function(){return["sap.m.Text"]};this.getType=function(){return"dialog"};this.getDecorator=function(){return"DialogContainerDecorator"};this.fnOrigGetAllChildren=this.getAllChildren;this.getAllChildren=function(t,e){if(e){var o={},i=0;for(var n in t.getPositions()){var r=t.getPositions()[n].getControl().getPositions();r.map(function(t){var e=t.getControl();if(e){var n=dispatcher.getComponentIdForControl(e);if(n){o[n]={i:i,o:e};i++}}})}return o}else{if(this.fnOrigGetAllChildren){return this.fnOrigGetAllChildren.apply(this,arguments)}}return null}};var instance=new DialogHandler;BaseHandler.dispatcher.addHandlers(instance.getType(),instance);return instance});
//# sourceMappingURL=dialog_handler.js.map