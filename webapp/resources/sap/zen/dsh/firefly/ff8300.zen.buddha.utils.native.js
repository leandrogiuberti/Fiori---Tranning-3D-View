/*
 * SAPUI5
  (c) Copyright 2009-2021 SAP SE. All rights reserved
 */
sap.ui.define(["jquery.sap.global","sap/base/Log","sap/zen/commons/thirdparty/xlsx-protobi","sap/base/i18n/ResourceBundle","sap/ui/thirdparty/URI","sap/zen/dsh/utils/dispatcher","sap/sac/df/firefly/library","sap/ui/thirdparty/jszip"],function(jQuery,Log,XLSX,ResourceBundle,URI,Dispatcher,FF){jQuery.sap.declare("sap.zen.dsh");sap.firefly=FF;var $Firefly={createByPrototype:function(e){var t=function(){};t.prototype=e;return new t},createClass:function(e,t,r){var n;if(Object.prototype.toString.call(e)==="[object Array]"){n=e}else{n=e.split(".")}var a=window;var i;var o;var s;var u;var l=n.length-1;for(s=0;s<l;s++){i=n[s];o=a[i];if(o===undefined){a[i]={};o=a[i]}a=o}i=n[l];var c=function(){};c.prototype={};if(t!==null){if(t===undefined){u="$Firefly.createClass "+i+" failed due to missing superClass";Log.error(u);return}c=function(){t.call(this)};var f=t;c.prototype=new f;c.$superclass=t.prototype}var h=c.prototype;var d;var g;var p;for(d in r){if(r.hasOwnProperty(d)){if(d==="$statics"){p=r[d];for(g in p){if(p.hasOwnProperty(g)){c[g]=p[g]}}}else{h[d]=r[d]}}}c.clazzName=i;a[i]=c}};$Firefly.createClass("sap.buddha.XWindow",sap.firefly.XObject,{$statics:{create:function(){var e=new sap.buddha.XWindow;e.initBase();return e}},oPage:null,bSFinMode:false,globalVarMap:null,toString:function(){return"[???]"},m_booleanValue:false,initBase:function(){if(!sap.zen.dsh.wnd){sap.zen.dsh.wnd={}}this.context={};this.globalVarMap=sap.firefly.XHashMapByString.create();var that=this;sap.zen.dsh.buddhaHasSendLock=0;sap.zen.dsh.buddhaDispatchQueue=sap.zen.dsh.buddhaDispatchQueue?sap.zen.dsh.buddhaDispatchQueue:[];var bDebugMode=jQuery.sap.debug();if(bDebugMode){var myFunction=function(e){if(e.ctrlKey&&e.altKey&&e.which===90){that.oPage.getSupportZip()}};jQuery(document).unbind("keydown.dssupportzip").bind("keydown.dssupportzip",myFunction)}this.context.exec=function(s){try{with(this){eval(s)}}catch(e){Log.error(e);Log.error(e.stack);if(that.oPage){var s1="Error during script execution of ("+s+")";if(e.message){s1+=": "+e.message;that.oPage.createErrorMessage(e.message)}else{that.oPage.createErrorMessage("Error during script execution")}var logging=that.oPage.getLogging();if(logging!=null&&logging.isLoggable(sap.buddha.XLogging.XDEBUG,null)){Log.error("XWindow: exception during script execution",s1,null)}else{Log.error("XWindow: exception during script execution",s1)}}return false}return true};this.context.putScript=function(name,script){try{with(this){that.context[name]=eval(script)}}catch(e){Log.error(e);Log.error(e.stack);if(that.oPage){var s="Error during script execution of ("+s+")";if(e.message){s+=": "+e.message}that.oPage.createErrorMessage(s)}return false}return true}},putInContext:function(e,t){this.context[e]=t},setEnumContext:function(e,t){var r=t.getNativeElement();this.context[e]=r},getContext:function(e){return this.context[e]},execute:function(e){if(e){try{this.context.exec(e)}catch(e){if(this.oPage){this.oPage.createErrorMessage(e.message)}return false}}this.captureGlobalVariables();return true},setPage:function(e){this.oPage=e},setSFinMode:function(e){this.bSFinMode=e;sap.zen.dsh.getLoadingIndicator(this.bSFinMode)},dispatchJsonString:function(e,t){e=unescape(e);var r=jQuery.parseJSON(e);if(t==false){r=r.delta;if(!(r instanceof Array)){var n=[];n.push(r);r=n}if(r.length>0){setTimeout(function(){Dispatcher.dispatchDelta(r)},1)}}else{sap.zen.dsh.sapbi_phxObj=Dispatcher.dispatchCreateControl(r.component,function(e){e.placeAt("sapbi_snippet_ROOT","only")})}},showLoadingIndicator:function(){var e=sap.zen.dsh.getLoadingIndicator();if(e){e.show()}},showImmediatelyLoadingIndicator:function(){var e=sap.zen.dsh.getLoadingIndicator();if(e){e.showImmediately()}},hideLoadingIndicator:function(){var e=sap.zen.dsh.getLoadingIndicator();if(e){e.hideAsync()}},setExecuteShowHideLoadingIndicator:function(e){var t=sap.zen.dsh.getLoadingIndicator();if(t){t.setExecuteShowHide(e)}},dispatchJsonObject:function(e,t,r){var n=this;var a=setInterval(function(){if(n.oPage.hasRootControlBeenRendered()&&(sap.zen.dsh.buddhaDispatchQueue[0]&&sap.zen.dsh.buddhaDispatchQueue[0].oInterval===a)){clearInterval(a);n._dispatchJsonObject(e,t,r,sap.zen.dsh.buddhaDispatchQueue[0])}},1);var i={initialRequest:t,pageId:r,queueId:a.toString(),inProcess:false,oInterval:a};sap.zen.dsh.buddhaDispatchQueue.push(i)},_dispatchJsonObject:function(e,t,r,n){n.inProcess=true;var a=Dispatcher;if(e.content.bInterComponentDragDropEnabled){a.setInterComponentDragDropEnabled(true)}else{a.setInterComponentDragDropEnabled(false)}a.dshPrefix=this.oPage.getDshControlId();var i=e.content.pageContent;if(t===false){i=i.delta;if(!(i instanceof Array)){var o=[];o.push(i);i=o}i={delta:i}}if(e.content.requiredModules&&e.content.requiredModules.length){Log.info("Load required Modules: \n"+e.content.requiredModules.join("\n"))}sap.zen.dsh.buddhaDispatchQueue.shift();sap.zen.dsh.sapbi_registerHandlers(arguments);sap.zen.dsh.sapbi_phx(r+"sapbi_snippet_ROOT",i)},getPageObject:function(e){if(e&&e.getPageObject){return e.getPageObject()}return null},getLocale:function(){var e="en-GB";if(navigator.userLanguage){e=navigator.browserLanguage}else if(navigator.language){e=navigator.language}return e},setLocale:function(){},unwrapXObject:function(e){if(e){if(e.getString){return e.getString()}if(e.getBoolean){return e.getBoolean()}if(e.getDouble){return e.getDouble()}if(e.getInteger){return e.getInteger()}if(e.size){var t=[];for(var r=0;r<e.size();r++){t.push(this.unwrapXObject(e.get(r)))}return t}}return undefined},setContextForGlobalVariable:function(e,t){this.putInContext(e,this.unwrapXObject(t))},addUrlParam:function(){},createJSArray:function(e){var t=[];var r=0;for(r=0;r<e.size();r++){t.push(e.get(r))}return t},createJSArrayOfStrings:function(e){var t=[];var r=0;for(r=0;r<e.size();r++){t.push(e.get(r))}return t},wrapAndPutInContext:function(e,t){var r=t.getJavaScriptWrapperName();this.putInContext(e,t);this.execute('sap.zen.dsh.utils.Wrapper.origObjects["'+e+'"] = '+e+";");this.execute(e+'= sap.zen.dsh.utils.Wrapper.wrap("'+r+'",'+e+");")},getGlobalVariables:function(e){if(e){this.captureGlobalVariables()}return this.globalVarMap},captureGlobalVariables:function(){if(this.context.APPLICATION_PROPERTIES!=null){var e=this.context.APPLICATION_PROPERTIES.getGlobalVariableNames();this.globalVarMap.clear();for(var t=0;t<e.size();t++){var r=e.get(t);var n=this.getContext(r);this.globalVarMap.put(r,n)}}},putGlobalScriptInContext:function(e,t){this.context.putScript(e,t)},resetLock:function(){sap.zen.dsh.buddhaHasSendLock=0;Log.info("xwindow resetLock: "+sap.zen.dsh.buddhaHasSendLock)},increaseLock:function(){sap.zen.dsh.buddhaHasSendLock++;Log.info("xwindow increaseLock: "+sap.zen.dsh.buddhaHasSendLock)},decreaseLock:function(){sap.zen.dsh.buddhaHasSendLock--;if(sap.zen.dsh.buddhaHasSendLock<0){sap.zen.dsh.buddhaHasSendLock=0}Log.info("xwindow decreaseLock: "+sap.zen.dsh.buddhaHasSendLock)},log:function(e){Log.info(e)},setMainMode:function(e){Dispatcher.setMainMode(e)},setCompactMode:function(e){if(Dispatcher.isMainMode()){Dispatcher.setCompactMode(e)}},parseJSON:function(e){return JSON.parse(e)},stringifyJSON:function(e){return JSON.stringify(e)}});$Firefly.createClass("sap.buddha.XJSAndCSSLoader",sap.firefly.XObject,{$statics:{create:function(){var e=new sap.buddha.XJSAndCssLoader;return e}},loadJS:function(){return null},loadBuildInJS:function(e){return window[e]},loadCSS:function(e,t,r){jQuery("head").append('<link rel="stylesheet" href="'+r+e+"/"+t+'" type="text/css" />')}});$Firefly.createClass("sap.buddha.XXmlNode",sap.firefly.XObject,{$statics:{create:function(e){var t=new sap.buddha.XXmlNode;t.setObject(e);return t},toStringInternal:function(e){var t=(new window.XMLSerializer).serializeToString(e);return t}},toString:function(){var e=(new window.XMLSerializer).serializeToString(this.root);return e},root:null,setObject:function(e){this.root=e},getAttribute:function(e){var t=this.root.attributes;var r=t[e];if(r==null){return null}var n=r.value;return n},getText:function(){return this.root.textContent},getChildren:function(e){var t=sap.firefly.XList.create();var r=this.root.childNodes;var n="bi:"+e;for(var a=0,i=r.length;a<i;a++){var o=r[a];if(o.nodeName.toLowerCase()===n){var s=sap.buddha.XXmlNode.create(o);t.add(s)}}return t},getChildrenWoBiNameSpace:function(e){var t=sap.firefly.XList.create();var r=this.root.childNodes;for(var n=0,a=r.length;n<a;n++){var i=r[n];if(i.nodeName===e){var o=sap.buddha.XXmlNode.create(i);t.add(o)}}return t},getFirstChild:function(e){return this.getFirstChildWithAttributeValue("bi:"+e,null,null,false)},getFirstChildWoBiNameSpace:function(e){return this.getFirstChildWithAttributeValue(e,null,null,false)},getFirstChildWithNameTag:function(e){return this.getFirstChildWithAttributeValue(null,"name",e,false)},getFirstChildWithAttributeValue:function(e,t,r,n){var a=this.root.childNodes;var i=null;for(var o=0,s=a.length;o<s;o++){var u=a[o];if(n){i=sap.buddha.XXmlNode.create(u).getFirstChildWithAttributeValue(e,t,r,n);if(i!==null){return i}}if(e==null||e===u.nodeName){var l=u.attributes;if(l!=null){if(r==null){i=sap.buddha.XXmlNode.create(u);return i}var c=l[t];if(c!=null&&c.value===r){i=sap.buddha.XXmlNode.create(u);return i}}}}return null},setAttribute:function(e,t){if(t!=null){this.root.setAttribute(e,t)}else{if(this.root.hasOwnProperty(e)){this.root.removeAttribute(t)}}},setCData:function(e){var t=this.root.firstChild;if(t!=null){this.root.removeChild(t)}var r=this.root.ownerDocument.createCDATASection(e);this.root.appendChild(r)},createChild:function(e){var t=document.createElement("bi:"+e);this.root.appendChild(t);var r=sap.buddha.XXmlNode.create(t);return r},createChildWithNameTag:function(e){var t=document.createElement("bi:property");this.root.appendChild(t);t.setAttribute("name",e);var r=sap.buddha.XXmlNode.create(t);return r},setProperty:function(e,t,r){var n=this.getFirstChildWithNameTag(e);if(n==null){n=this.createChildWithNameTag(e)}if(r){var a=n.getFirstChild("value");if(a==null){a=n.createChild("value")}a.setCData(t)}else{n.setAttribute("value",t)}},asBookmarkString:function(){var e=this.root.cloneNode(false);var t=this.root.childNodes;for(var r=0,n=t.length;r<n;r++){var a=t[r];var i=a.nodeName;var o=!(i==="bi:component");var s=a.attributes;if(s!=null){o=false;var u=s["name"];if(u!=null){var l=u.value.toUpperCase();if(l==="DATA_SOURCE_DEFINITION"||l==="GLOBALVARIABLES"){o=true}}}if(o){var c=a.cloneNode(true);e.appendChild(c)}}var f=sap.buddha.XXmlNode.toStringInternal(e);return f},asDeltaBookmarkString:function(e){var t;var r;if(e==null){t=this.root.cloneNode(false);r=this.root.childNodes}else{t=e;t=t.cloneNode(false);r=e.childNodes}var n="";for(var a=0,i=r.length;a<i;a++){var o=r[a];var s=o.nodeName;var u=!(s==="bi:component");if(u){var l=o.cloneNode(true);t.appendChild(l)}else{var c=o.cloneNode(true);var f=this.asDeltaBookmarkString(c);n=sap.firefly.XString.concatenate2(n,f)}}var h=sap.buddha.XXmlNode.toStringInternal(t);h=sap.firefly.XString.concatenate2(h,n);return h},getAllChildren:function(){var e=sap.firefly.XList.create();var t=this.root.childNodes;for(var r=0,n=t.length;r<n;r++){var a=sap.buddha.XXmlNode.create(t[r]);e.add(a)}return e},getNode:function(){return this.root},removeChild:function(e){this.root.removeChild(e.getNode())},getNodeName:function(){return this.root.nodeName},appendChild:function(e){this.root.appendChild(e.getNode())},cloneNode:function(e){return sap.buddha.XXmlNode.create(this.root.cloneNode(e))}});var JXG;$Firefly.createClass("sap.buddha.XXmlUtils",null,{$statics:{decompress:function(e){var t=JXG.decompress(e);return t},decodeBase64ToByteArray:function(e){return atob(e)},getRootNode:function(e){if(!e){return null}var t=$.parseXML(e);var r=sap.buddha.XXmlNode.create();var n=t.childNodes;for(var a=0,i=n.length;a<i;a++){var o=n[a];if(o.nodeType===1){r.setObject(o);break}}return r}},toString:function(){return"[???]"}});JXG={exists:function(e){return function(t){return!(t===e||t===null)}}()};JXG.decompress=function(e){var t=new JXG.Util.Unzip(JXG.Util.Base64.decodeAsArray(e));var r=t.unzip();return unescape(r[0][0])};
/*
 * Copyright 2008-2012 Matthias Ehmann, Michael Gerhaeuser, Carsten Miller,
 * Bianca Valentin, Alfred Wassermann, Peter Wilfahrt
 * 
 * This file is part of JSXGraph.
 * 
 * Dual licensed under the Apache License Version 2.0, or LGPL Version 3
 * licenses.
 * 
 * You should have received a copy of the GNU Lesser General Public License
 * along with JSXCompressor. If not, see <http://www.gnu.org/licenses/>.
 * 
 * You should have received a copy of the Apache License along with
 * JSXCompressor. If not, see <http://www.apache.org/licenses/>.
 * 
 */JXG.Util={};JXG.Util.Unzip=function(e){var t=[],r=false,n,a=0,i=[];var o=new Array(32768),s=0,u=false;var l=[0,128,64,192,32,160,96,224,16,144,80,208,48,176,112,240,8,136,72,200,40,168,104,232,24,152,88,216,56,184,120,248,4,132,68,196,36,164,100,228,20,148,84,212,52,180,116,244,12,140,76,204,44,172,108,236,28,156,92,220,60,188,124,252,2,130,66,194,34,162,98,226,18,146,82,210,50,178,114,242,10,138,74,202,42,170,106,234,26,154,90,218,58,186,122,250,6,134,70,198,38,166,102,230,22,150,86,214,54,182,118,246,14,142,78,206,46,174,110,238,30,158,94,222,62,190,126,254,1,129,65,193,33,161,97,225,17,145,81,209,49,177,113,241,9,137,73,201,41,169,105,233,25,153,89,217,57,185,121,249,5,133,69,197,37,165,101,229,21,149,85,213,53,181,117,245,13,141,77,205,45,173,109,237,29,157,93,221,61,189,125,253,3,131,67,195,35,163,99,227,19,147,83,211,51,179,115,243,11,139,75,203,43,171,107,235,27,155,91,219,59,187,123,251,7,135,71,199,39,167,103,231,23,151,87,215,55,183,119,247,15,143,79,207,47,175,111,239,31,159,95,223,63,191,127,255];var c=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0];var f=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99];var h=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];var d=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13];var g=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];var p=e;var b=0,v=1,m=0;var y=256;var S=[];var w;function C(){m+=8;if(b<p.length){return p[b++]}else return-1}function j(){v=1}function O(){var e;m++;e=v&1;v>>=1;if(v==0){v=C();e=v&1;v=v>>1|128}return e}function k(e){var t=0,r=e;while(r--){t=t<<1|O()}if(e){t=l[t]>>8-e}return t}function X(){s=0}function A(e){o[s++]=e;t.push(String.fromCharCode(e));if(s==32768){s=0}}function L(){this.b0=0;this.b1=0;this.jump=null;this.jumppos=-1}var T=288;var x=new Array(T);var I=new Array(32);var F=0;var N=null;var z=0;var D=new Array(17);D[0]=0;var E;var M;function U(){for(;;){if(D[z]>=M)return-1;if(E[D[z]]==z)return D[z]++;D[z]++}}function J(){var e=N[F];var t;if(r)document.write("<br>len:"+z+" treepos:"+F);if(z==17){return-1}F++;z++;t=U();if(r)document.write("<br>IsPat "+t);if(t>=0){e.b0=t;if(r)document.write("<br>b0 "+e.b0)}else{e.b0=32768;if(r)document.write("<br>b0 "+e.b0);if(J())return-1}t=U();if(t>=0){e.b1=t;if(r)document.write("<br>b1 "+e.b1);e.jump=null}else{e.b1=32768;if(r)document.write("<br>b1 "+e.b1);e.jump=N[F];e.jumppos=F;if(J())return-1}z--;return 0}function R(e,t,n,a){var i;if(r)document.write("currentTree "+e+" numval "+t+" lengths "+n+" show "+a);N=e;F=0;E=n;M=t;for(i=0;i<17;i++)D[i]=0;z=0;if(J()){if(r)alert("invalid huffman tree\n");return-1}if(r){document.write("<br>Tree: "+N.length);for(var o=0;o<32;o++){document.write("Places["+o+"].b0="+N[o].b0+"<br>");document.write("Places["+o+"].b1="+N[o].b1+"<br>")}}return 0}function B(e){var t,n,a=0,i=e[a],o;for(;;){o=O();if(r)document.write("b="+o);if(o){if(!(i.b1&32768)){if(r)document.write("ret1");return i.b1}i=i.jump;t=e.length;for(n=0;n<t;n++){if(e[n]===i){a=n;break}}}else{if(!(i.b0&32768)){if(r)document.write("ret2");return i.b0}a++;i=e[a]}}if(r)document.write("ret3");return-1}function P(){var e,t,n,a,i;do{e=O();n=k(2);switch(n){case 0:if(r)alert("Stored\n");break;case 1:if(r)alert("Fixed Huffman codes\n");break;case 2:if(r)alert("Dynamic Huffman codes\n");break;case 3:if(r)alert("Reserved block type!!\n");break;default:if(r)alert("Unexpected value %d!\n",n);break}if(n==0){var u,p;j();u=C();u|=C()<<8;p=C();p|=C()<<8;if((u^~p)&65535){document.write("BlockLen checksum mismatch\n")}while(u--){t=C();A(t)}}else if(n==1){var b;for(;;){b=l[k(7)]>>1;if(b>23){b=b<<1|O();if(b>199){b-=128;b=b<<1|O()}else{b-=48;if(b>143){b=b+136}}}else{b+=256}if(b<256){A(b)}else if(b==256){break}else{var v;b-=256+1;i=k(f[b])+c[b];b=l[k(5)]>>3;if(d[b]>8){v=k(8);v|=k(d[b]-8)<<8}else{v=k(d[b])}v+=h[b];for(b=0;b<i;b++){t=o[s-v&32767];A(t)}}}}else if(n==2){var y,S,w,T;var F=new Array(288+32);S=257+k(5);w=1+k(5);T=4+k(4);for(b=0;b<19;b++){F[b]=0}for(b=0;b<T;b++){F[g[b]]=k(3)}i=I.length;for(a=0;a<i;a++)I[a]=new L;if(R(I,19,F,0)){X();return 1}if(r){document.write("<br>distanceTree");for(var N=0;N<I.length;N++){document.write("<br>"+I[N].b0+" "+I[N].b1+" "+I[N].jump+" "+I[N].jumppos)}}y=S+w;a=0;var z=-1;if(r)document.write("<br>n="+y+" bits: "+m+"<br>");while(a<y){z++;b=B(I);if(r)document.write("<br>"+z+" i:"+a+" decode: "+b+"    bits "+m+"<br>");if(b<16){F[a++]=b}else if(b==16){var D;b=3+k(2);if(a+b>y){X();return 1}D=a?F[a-1]:0;while(b--){F[a++]=D}}else{if(b==17){b=3+k(3)}else{b=11+k(7)}if(a+b>y){X();return 1}while(b--){F[a++]=0}}}i=x.length;for(a=0;a<i;a++)x[a]=new L;if(R(x,S,F,0)){X();return 1}i=x.length;for(a=0;a<i;a++)I[a]=new L;var E=new Array;for(a=S;a<F.length;a++){E[a-S]=F[a]}if(R(I,w,E,0)){X();return 1}if(r)document.write("<br>literalTree");for(;;){b=B(x);if(b>=256){b-=256;if(b==0){break}b--;i=k(f[b])+c[b];b=B(I);if(d[b]>8){v=k(8);v|=k(d[b]-8)<<8}else{v=k(d[b])}v+=h[b];while(i--){t=o[s-v&32767];A(t)}}else{A(b)}}}}while(!e);X();j();return 0}JXG.Util.Unzip.prototype.unzipFile=function(e){var t;this.unzip();for(t=0;t<i.length;t++){if(i[t][1]==e){return i[t][0]}}return null};JXG.Util.Unzip.prototype.unzip=function(){if(r)alert(p);_();return i};function _(){if(r)alert("NEXTFILE");t=[];var e=[];u=false;e[0]=C();e[1]=C();if(r)alert("type: "+e[0]+" "+e[1]);if(e[0]==parseInt("78",16)&&e[1]==parseInt("da",16)){if(r)alert("GEONExT-GZIP");P();if(r)alert(t.join(""));i[a]=new Array(2);i[a][0]=t.join("");i[a][1]="geonext.gxt";a++}if(e[0]==parseInt("1f",16)&&e[1]==parseInt("8b",16)){if(r)alert("GZIP");$();if(r)alert(t.join(""));i[a]=new Array(2);i[a][0]=t.join("");i[a][1]="file";a++}if(e[0]==parseInt("50",16)&&e[1]==parseInt("4b",16)){u=true;e[2]=C();e[3]=C();if(e[2]==parseInt("3",16)&&e[3]==parseInt("4",16)){e[0]=C();e[1]=C();if(r)alert("ZIP-Version: "+e[1]+" "+e[0]/10+"."+e[0]%10);n=C();n|=C()<<8;if(r)alert("gpflags: "+n);var o=C();o|=C()<<8;if(r)alert("method: "+o);C();C();C();C();var s=C();s|=C()<<8;s|=C()<<16;s|=C()<<24;var l=C();l|=C()<<8;l|=C()<<16;l|=C()<<24;var c=C();c|=C()<<8;c|=C()<<16;c|=C()<<24;if(r)alert("local CRC: "+s+"\nlocal Size: "+c+"\nlocal CompSize: "+l);var f=C();f|=C()<<8;var h=C();h|=C()<<8;if(r)alert("filelen "+f);g=0;S=[];while(f--){var d=C();if(d=="/"|d==":"){g=0}else if(g<y-1)S[g++]=String.fromCharCode(d)}if(r)alert("nameBuf: "+S);if(!w)w=S;var g=0;while(g<h){d=C();g++}if(c==0&&w.charAt(w.length-1)=="/"){if(r)alert("skipdir")}if(o==8){P();if(r)alert(t.join(""));i[a]=new Array(2);i[a][0]=t.join("");i[a][1]=S.join("");a++}$()}}}function $(){var e=[],t,a;if(n&8){e[0]=C();e[1]=C();e[2]=C();e[3]=C();if(e[0]==parseInt("50",16)&&e[1]==parseInt("4b",16)&&e[2]==parseInt("07",16)&&e[3]==parseInt("08",16)){C();C();C();C()}C();C();C();C();C();C();C();C();if(r)alert("CRC:")}if(u)_();e[0]=C();if(e[0]!=8){if(r)alert("Unknown compression method!");return 0}n=C();if(r){if(n&~parseInt("1f",16))alert("Unknown flags set!")}C();C();C();C();C();C();if(n&4){e[0]=C();e[2]=C();z=e[0]+256*e[1];if(r)alert("Extra field size: "+z);for(t=0;t<z;t++)C()}if(n&8){t=0;S=[];while(a=C()){if(a=="7"||a==":")t=0;if(t<y-1)S[t++]=a}if(r)alert("original file name: "+S)}if(n&16){while(a=C()){}}if(n&2){C();C()}P();C();C();C();C();C();C();C();C();if(u)_();return null}};JXG.Util.Base64={_keyStr:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encode:function(e){var t=[],r,n,a,i,o,s,u,l=0;e=JXG.Util.Base64._utf8_encode(e);while(l<e.length){r=e.charCodeAt(l++);n=e.charCodeAt(l++);a=e.charCodeAt(l++);i=r>>2;o=(r&3)<<4|n>>4;s=(n&15)<<2|a>>6;u=a&63;if(isNaN(n)){s=u=64}else if(isNaN(a)){u=64}t.push([this._keyStr.charAt(i),this._keyStr.charAt(o),this._keyStr.charAt(s),this._keyStr.charAt(u)].join(""))}return t.join("")},decode:function(e,t){var r=[],n,a,i,o,s,u,l,c=0;e=e.replace(new RegExp("[^A-Za-z0-9+/=]","g"),"");while(c<e.length){o=this._keyStr.indexOf(e.charAt(c++));s=this._keyStr.indexOf(e.charAt(c++));u=this._keyStr.indexOf(e.charAt(c++));l=this._keyStr.indexOf(e.charAt(c++));n=o<<2|s>>4;a=(s&15)<<4|u>>2;i=(u&3)<<6|l;r.push(String.fromCharCode(n));if(u!=64){r.push(String.fromCharCode(a))}if(l!=64){r.push(String.fromCharCode(i))}}r=r.join("");if(t){r=JXG.Util.Base64._utf8_decode(r)}return r},_utf8_encode:function(e){e=e.replace(new RegExp("\r\n","g"),"\n");var t="";for(var r=0;r<e.length;r++){var n=e.charCodeAt(r);if(n<128){t+=String.fromCharCode(n)}else if(n>127&&n<2048){t+=String.fromCharCode(n>>6|192);t+=String.fromCharCode(n&63|128)}else{t+=String.fromCharCode(n>>12|224);t+=String.fromCharCode(n>>6&63|128);t+=String.fromCharCode(n&63|128)}}return t},_utf8_decode:function(e){var t=[],r=0,n=0,a=0,i=0;while(r<e.length){n=e.charCodeAt(r);if(n<128){t.push(String.fromCharCode(n));r++}else if(n>191&&n<224){a=e.charCodeAt(r+1);t.push(String.fromCharCode((n&31)<<6|a&63));r+=2}else{a=e.charCodeAt(r+1);i=e.charCodeAt(r+2);t.push(String.fromCharCode((n&15)<<12|(a&63)<<6|i&63));r+=3}}return t.join("")},_destrip:function(e,t){var r=[],n,a;if(t==null)t=76;e.replace(new RegExp(" ","g"),"");n=e.length/t;for(a=0;a<n;a++)r[a]=e.substr(a*t,t);if(n!=e.length/t)r[r.length]=e.substr(n*t,e.length-n*t);var i=[];for(a=0;a<r.length;a++)i.push(r[a]);return i.join("\n")},decodeAsArray:function(e){var t=this.decode(e),r=[],n;for(n=0;n<t.length;n++){r[n]=t.charCodeAt(n)}return r},decodeGEONExT:function(e){return JXG.Util.Base64.decodeAsArray(JXG.Util.Base64._destrip(e),false)}};JXG.Util.asciiCharCodeAt=function(e,t){var r=e.charCodeAt(t);if(r>255){switch(r){case 8364:r=128;break;case 8218:r=130;break;case 402:r=131;break;case 8222:r=132;break;case 8230:r=133;break;case 8224:r=134;break;case 8225:r=135;break;case 710:r=136;break;case 8240:r=137;break;case 352:r=138;break;case 8249:r=139;break;case 338:r=140;break;case 381:r=142;break;case 8216:r=145;break;case 8217:r=146;break;case 8220:r=147;break;case 8221:r=148;break;case 8226:r=149;break;case 8211:r=150;break;case 8212:r=151;break;case 732:r=152;break;case 8482:r=153;break;case 353:r=154;break;case 8250:r=155;break;case 339:r=156;break;case 382:r=158;break;case 376:r=159;break;default:break}}return r};JXG.Util.utf8Decode=function(e){var t=[];var r=0;var n=0,a=0,i;if(!JXG.exists(e))return"";while(r<e.length){n=e.charCodeAt(r);if(n<128){t.push(String.fromCharCode(n));r++}else if(n>191&&n<224){a=e.charCodeAt(r+1);t.push(String.fromCharCode((n&31)<<6|a&63));r+=2}else{a=e.charCodeAt(r+1);i=e.charCodeAt(r+2);t.push(String.fromCharCode((n&15)<<12|(a&63)<<6|i&63));r+=3}}return t.join("")};
/**
 * Generate a random uuid. http://www.broofa.com mailto:robert@broofa.com
 *
 * Copyright (c) 2010 Robert Kieffer Dual licensed under the MIT and GPL
 * licenses.
 *
 * EXAMPLES: >>> Math.uuid() "92329D39-6F5C-4520-ABFC-AAB64544E172"
 */JXG.Util.genUUID=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),t=new Array(36),r=0,n;for(var a=0;a<36;a++){if(a==8||a==13||a==18||a==23){t[a]="-"}else if(a==14){t[a]="4"}else{if(r<=2)r=33554432+Math.random()*16777216|0;n=r&15;r=r>>4;t[a]=e[a==19?n&3|8:n]}}return t.join("")};$Firefly.createClass("sap.buddha.XJsonObject",sap.firefly.XObject,{$statics:{xWindow:null,create:function(e){var t=new sap.buddha.XJsonObject;t.setObject(e);return t},createFromString:function(e){var t=new sap.buddha.XJsonObject;t.setObject(e);return t},createFromJSonString:function(e){var t=new sap.buddha.XJsonObject;t.setObject(JSON.parse(e));return t},setXWindow:function(e){sap.buddha.XJsonObject.xWindow=e}},toString:function(){return"[???]"},obj:null,setObject:function(e){this.obj=e},isString:function(){return typeof this.obj==="string"},getString:function(){if(this.isString()){return this.obj}else if(this.isScriptableMember()){return this.obj.getKey()}return this.getAsJsonString()},getAsJsonString:function(){return JSON.stringify(this.obj)},isArray:function(){return typeof this.obj==="object"&&this.obj instanceof Array},isDefined:function(){if(typeof this.obj==="undefined"){return false}return true},getArray:function(){return sap.buddha.XJsonArray.create(this.obj)},isJSON:function(){return typeof this.obj==="object"&&!this.isArray()&&!this.isPageObject()&&!this.isScriptableMember()},getJSON:function(){var e=sap.firefly.XHashMapByString.create();if(!this.isJSON()){return e}for(var t in this.obj){if(this.obj.hasOwnProperty(t)){var r=this.obj[t];if(typeof r==="object"){r=JSON.stringify(r)}e.put(t,r)}}return e},replace:function(e,t){return this.getString().replace(new RegExp(e,"g"),t)},isScriptableMember:function(){return typeof this.obj.clazzName!=="undefined"&&this.obj.clazzName==="ScriptableMember"},isPageObject:function(){var e=this.obj.getPageObject;return e!=null},getPageObject:function(){if(!this.isPageObject()){return null}var e=this.obj.getPageObject();return e}});$Firefly.createClass("sap.buddha.XJsonArray",sap.firefly.XObject,{$statics:{create:function(e){var t=new sap.buddha.XJsonArray;t.setObject(e);return t}},toString:function(){return"[???]"},obj:null,setObject:function(e){this.obj=e},size:function(){return this.obj.length},get:function(e){return sap.buddha.XJsonObject.create(this.obj[e])}});$Firefly.createClass("sap.buddha.XJSonRenderSerializer",sap.firefly.XObject,{$statics:{create:function(){var e=new sap.buddha.XJSonRenderSerializer;e.level=0;e.obj={};e.currentObjStack=[];e.currentObjStack.push(e.obj);e.inArrayStack=[];e.inArrayStack.push(false);return e}},writeOpenObject:function(){var e={};this.currentObjStack.push(e);this.inArrayStack.push(false);this.level++},setWriter:function(e){this.writer=e},openTag:function(e){var t={};if(this.inArrayStack[this.inArrayStack.length-1]===true){var r={};this.currentObjStack[this.currentObjStack.length-1].push(r);r[e]=t}else{this.currentObjStack[this.currentObjStack.length-1][e]=t}this.currentObjStack.push(t);this.inArrayStack.push(false);this.level++},addText:function(e){this.addAttribute("_v",e)},closeTag:function(){this.currentObjStack.pop();this.inArrayStack.pop();this.level--;this.checkAndWrite()},addNullAttribute:function(e){this.currentObjStack[this.currentObjStack.length-1][e]=null},addAttribute:function(e,t){if(t===null){t=""}this.currentObjStack[this.currentObjStack.length-1][e]=t},addAttributeAsNotString:function(name,value){if(value===null){value=""}Object.defineProperty(this.currentObjStack[this.currentObjStack.length-1],name,{get:function(){return eval(value)}})},addAttribute2:function(e,t){if(t===null){t=""}this.currentObjStack[this.currentObjStack.length-1][e]=t},addIntegerAttribute:function(e,t){this.currentObjStack[this.currentObjStack.length-1][e]=t},addDoubleAttribute:function(e,t){this.currentObjStack[this.currentObjStack.length-1][e]=t},addBooleanAttribute:function(e,t){this.currentObjStack[this.currentObjStack.length-1][e]=t},openArray:function(e){var t=[];if(this.inArrayStack[this.inArrayStack.length-1]===true){var r={};this.currentObjStack[this.currentObjStack.length-1].push(r);r[e]=t}else{this.currentObjStack[this.currentObjStack.length-1][e]=t}this.currentObjStack.push(t);this.inArrayStack.push(true);this.level++},closeArray:function(){this.currentObjStack.pop();this.inArrayStack.pop();this.level--;this.checkAndWrite()},isCurrentWriter:function(e){return true},openJsonArray:function(){var e=[];if(this.inArrayStack[this.inArrayStack.length-1]===true){this.currentObjStack[this.currentObjStack.length-1].push(e)}else{throw"invalid state"}this.currentObjStack.push(e);this.inArrayStack.push(true);this.level++},closeJsonArray:function(){this.currentObjStack.pop();this.inArrayStack.pop();this.level--;this.checkAndWrite()},openJsonTag:function(){var e={};if(this.inArrayStack[this.inArrayStack.length-1]===true){this.currentObjStack[this.currentObjStack.length-1].push(e)}else{throw"invalid state"}this.currentObjStack.push(e);this.inArrayStack.push(false);this.level++},closeJsonTag:function(){this.currentObjStack.pop();this.inArrayStack.pop();this.level--;this.checkAndWrite()},addDoubleToArray:function(e){this.currentObjStack[this.currentObjStack.length-1].push(e.getDouble())},addIntegerToArray:function(e){this.currentObjStack[this.currentObjStack.length-1].push(e.getInteger())},addSimpleValueToArray:function(e){this.currentObjStack[this.currentObjStack.length-1].push(e)},addNullToArray:function(){this.currentObjStack[this.currentObjStack.length-1].push(null)},checkAndWrite:function(){if(this.writer!=null){if(this.level===0){var e=JSON.stringify(this.obj);this.writer.append(e)}}},getRenderedObject:function(){return this.obj}});$Firefly.createClass("sap.buddha.XObjectConverter",sap.firefly.XObject,{$statics:{getStringArrayFromIXListForSelection:function(e){var t=[];var r=e.getIterator();while(r.hasNext()){var n=r.next();t.push(n)}return t},getIXListOfStringForSelectionFromStringArray:function(e){var t=sap.firefly.XList.create();for(var r=0;r<e.length;r++){t.add(e[r])}return t},isString:function(e){if(e==null){return true}return typeof e==="string"},isObjectString:function(e){return sap.buddha.XObjectConverter.isString(e)},convertObjectToString:function(e){return e},convertObjectToInt:function(e){return e},isBoolean:function(e){if(e==null){return true}return typeof e==="boolean"},isInteger:function(e){if(e==null){return true}return typeof e==="number"},isDouble:function(e){if(e==null){return true}return typeof e==="number"}}});$Firefly.createClass("sap.buddha.XSSEncoder",sap.firefly.XObject,{$statics:{encodeJavaScript:function(e){var t=new RegExp("'","g");e=e.replace(t,"\\x27");return e},encodeHtml:function(e){return e},encodeXml:function(e){var t=new RegExp("[<>&'\"]","g");return e.replace(t,function(e){if(e=="<"){return"&lt;"}else if(e==">"){return"&gt;"}else if(e=="&"){return"&amp;"}else if(e=="'"){return"&apos;"}else if(e=='"'){return"&quot;"}})}}});$Firefly.createClass("sap.buddha.XMathZen",sap.firefly.XObject,{$statics:{create:function(e){var t=new sap.buddha.XMathZen;t.setObject(e);return t},roundDouble:function(e){return e.toLocaleString(undefined,{maximumFractionDigits:2,minimumFractionDigits:2})},getDigitsOfNumber:function(e){return Math.max(Math.floor(Math.log10(Math.abs(e))),0)+1},getDigitsOfNumberAsString:function(e){return sap.buddha.XMathZen.getDigitsOfNumber(parseFloat(e))}},obj:null,toString:function(){return"[???]"},setObject:function(e){this.obj=e},size:function(){return this.obj.length},get:function(e){return sap.buddha.XJsonObject.create(this.obj[e])}});$Firefly.createClass("sap.buddha.XJsonMap",sap.firefly.XObject,{getJsonFromMapObject:function(e){return JSON.stringify(e)}});$Firefly.createClass("sap.buddha.XJsUI5Utils",null,{$statics:{formatDateTimeValue:function(e,t,r,n){var a=e;var i=sap.buddha.XJsUI5Utils.getDateTimeValueObject(e,t,r);var o={style:n};t=sap.buddha.XJsUI5Utils.translateDataType(t);var s=null;if(t==="DATE"){loDataTypeFormatter=sap.ui.core.format.DateFormat.getDateInstance(o,sap.ui.getCore().getConfiguration().getLocale())}else if(t==="TIME"){loDataTypeFormatter=sap.ui.core.format.DateFormat.getTimeInstance(o,sap.ui.getCore().getConfiguration().getLocale())}else if(t==="DATETIME"){loDataTypeFormatter=sap.ui.core.format.DateFormat.getDateTimeInstance(o,sap.ui.getCore().getConfiguration().getLocale())}if(i&&loDataTypeFormatter){a=loDataTypeFormatter.format(i)}return a},getDateTimeValue:function(e,t,r){var n=e;var a=sap.buddha.XJsUI5Utils.getDateTimeValueObject(e,t,r);var i=sap.buddha.XJsUI5Utils.getDateTimeValueFormatter(e,t);if(a&&i){n=i.format(a)}return n},getDateTimeValueObject:function(e,t,r){var n=null;var a=sap.buddha.XJsUI5Utils.getDateTimeValueFormatter(e,t);if(a){n=a.parse(e)}if(r&&n){n.setUTCDate(n.getDate());n.setUTCFullYear(n.getFullYear());n.setUTCMonth(n.getMonth());n.setUTCHours(n.getHours());n.setUTCMinutes(n.getMinutes());n.setUTCSeconds(n.getSeconds());n.setUTCMilliseconds(n.getMilliseconds())}return n},getDateTimeValueFormatter:function(e,t){var r=null;t=sap.buddha.XJsUI5Utils.translateDataType(t);if(t==="DATE"){r=sap.buddha.XJsUI5Utils.getDateFormatter(e)}else if(t==="TIME"){r=sap.buddha.XJsUI5Utils.getTimeFormatter(e)}else if(t==="DATETIME"){r=sap.buddha.XJsUI5Utils.getDateTimeFormatter(e)}return r},getDateFormatter:function(e){var t=null;var r;var n=-1;n=e.search("([0-9]{8})");if(n===0){r="yyyyMMdd"}if(!r){n=e.search("([0-9]{4}-[0-9]{2}-[0-9]{2})");if(n===0){r="yyyy-MM-dd"}}var a;if(r){t=sap.ui.core.format.DateFormat.getInstance({pattern:r})}return t},getTimeFormatter:function(e){var t=null;var r;var n=-1;n=e.search("([0-9]{6})");if(n===0){r="HHmmss"}if(!r){n=e.search("([0-9]{2}:[0-9]{2}:[0-9]{2})");if(n===0){r="HH:mm:ss"}}var a;if(r){t=sap.ui.core.format.DateFormat.getInstance({pattern:r})}return t},getDateTimeFormatter:function(e){var t=null;var r;var n=-1;n=e.search("^([0-9]{8})");if(n===0){r="yyyyMMdd";n=e.substr(8).search("^([0-9]{6})");if(n===0){r="yyyyMMddHHmmss"}}if(!r){n=e.search("^([0-9]{4}-[0-9]{2}-[0-9]{2})");if(n===0){r="yyyy-MM-dd";n=e.substr(10).search("^T([0-9]{2}:[0-9]{2}:[0-9]{2})");if(n===0){r="yyyy-MM-ddTHH:mm:ss"}}}if(r){t=sap.ui.core.format.DateFormat.getInstance({pattern:r})}return t},translateDataType:function(e){var t=e.toUpperCase();if(t==="DATE"){t="DATE"}else if(t==="TIME"){t="TIME"}else if(t==="DATETIME"||t==="DATE_TIME"){t="DATETIME"}return t}},toString:function(){return"[???]"}});$Firefly.createClass("sap.buddha.XJsUtils",null,{$statics:{createProperty:function(instance,name,createGetter,createSetter){var funcName=name.substring(0,1).toUpperCase()+name.substring(1);if(createGetter===true){Object.defineProperty(instance,name,{get:function(){return eval("instance.get"+funcName+"()")}})}if(createSetter===true){Object.defineProperty(instance,name,{set:function(value){return eval("instance.set"+funcName+"("+value+")")}})}},createJsIdentifier:function(e){return e.replace(/\W/g,"_").replace(/^(\d)/g,"_$1")}},toString:function(){return"[???]"}});$Firefly.createClass("sap.buddha.XlsWorkbook",sap.firefly.XObject,{$statics:{create:function(e,t){function r(){if(!(this instanceof r)){return new r}this.SheetNames=[];this.Sheets={};return this}var n=new sap.buddha.XlsWorkbook;n.allowStyles=t;n.wb=new r;return n}},allowStyles:true,formatIndexMap:{},formatIndex:164,addWorksheet:function(e){var t={};this.wb.SheetNames.push(e);this.wb.Sheets[e]=t;t.curRow=-1;t.maxRow=-1;t.maxCol=-1;t["!merges"]=[];return t},closeWorkSheet:function(e){var t=this.getRange(0,0,e.maxRow+1,e.maxCol+1);e["!ref"]=XLSX.utils.encode_range(t)},getRow:function(e,t){var r={};r.ws=e;r.row=t;r.curCol=-1;return r},createRow:function(e){e.curRow++;var t=this.getRow(e,e.curRow);if(e.curRow>e.maxRow){e.maxRow=e.curRow}return t},getCell:function(e,t){var r={};r.ws=e.ws;r.row=e.row;r.column=t;var n=this.getCellRef(r.row,r.column);e.ws[n]=r;return r},getCellRef:function(e,t){var r=XLSX.utils.encode_cell({r:e,c:t});return r.toString()},addCell:function(e){e.curCol++;var t=this.getCell(e,e.curCol);if(e.curCol>e.ws.maxCol){e.ws.maxCol=e.curCol}return t},copyCell:function(e,t){if(e.s){t.s=e.s}if(e.v){t.v=e.v}if(e.t){t.t=e.t}if(e.f){t.f=e.f}if(e.z){t.z=e.z}if(e.w){t.w=e.w}},mergeCell:function(e,t,r){var n=t,a=r;if(n<1){n=1}if(a<1){a=1}var i=this.getRange(e.row,e.column,e.row+n-1,e.column+a-1);if(n>1||a>1){e.ws["!merges"].push(i)}var o=null,s=null,u=0;for(u=1;u<n;u++){o=this.getRow(e.ws,e.row+u);s=this.getCell(o,e.column);this.copyCell(e,s)}for(u=1;u<a;u++){o=this.getRow(e.ws,e.row);s=this.getCell(o,e.column+u);this.copyCell(e,s)}},getRange:function(e,t,r,n){var a={s:{r:e,c:t},e:{r:r,c:n}};return a},setCell:function(e,t){if(e.row>e.ws.maxRow){e.ws.maxRow=e.row}if(e.column>e.ws.maxCol){e.ws.maxCol=e.column}var r="FFDCE6F0";var n="FFCCCCCC";var a="FFE5E5E5";var i="FFFFFF00";var o="Calibri";var s=11;var u="top";var l="left";var c={style:"medium",color:{rgb:n}};var f={top:c,bottom:c,left:c,right:c};var h={font:{name:o,sz:s,bold:false},alignment:{vertical:u,horizontal:l,wrapText:false,indent:0}};var d={font:{name:o,sz:s,bold:false},alignment:{vertical:u,horizontal:l,wrapText:false,indent:0},border:f};var g={font:{name:o,sz:s,bold:false},fill:{fgColor:{rgb:r}},alignment:{vertical:u,horizontal:l,wrapText:false,indent:0},border:f};var p={font:{name:o,sz:s,bold:false},fill:{fgColor:{rgb:a}},alignment:{vertical:u,horizontal:l,wrapText:false,indent:0},border:f};var b={font:{name:o,sz:s,bold:false},fill:{fgColor:{rgb:i}},alignment:{vertical:u,horizontal:l,wrapText:false,indent:0},border:f};if(t.getStyle().toString()!=="NONE"&&this.allowStyles===true){if(t.getStyle().toString()==="GROUP"){e.s=g}else if(t.getStyle().toString()==="HEADER"){e.s=p}else if(t.getStyle().toString()==="TOTAL"){e.s=b}else{e.s=d}}else{e.s=h}e.v=t.getFormattedValue();e.t="s";e.s.alignment.horizontal="left";if(t.getValueType().toString()==="NUMBER"||t.getValueType().toString()==="NUMBER_AS_STRING"){e.s.alignment.horizontal="right";if(t.getValueType().toString()==="NUMBER"){e.v=t.getValue();e.t="n"}}else if(t.getValueType().toString()==="DATE"){e.v=t.getValue();e.t="d"}if(t.getFormula()){e.f=t.getFormula()}if(t.getValueType().toString()==="NUMBER_AS_STRING"){t.setFormatString(null)}if(t.getValueType().toString()==="NUMBER"){e.s.numFmt=t.getFormatString()}if(t.getFormatString()!=null&&t.getFormatString().length>0){e.z=t.getFormatString();var v=this.formatIndexMap[t.getFormatString()];if(!v){while(XLSX.SSF.get_table()[this.formatIndex]){this.formatIndex++}v=this.formatIndex;this.formatIndexMap[t.getFormatString()]=v;this.formatIndex++;XLSX.SSF.load(t.getFormatString(),v)}e.z=XLSX.SSF.get_table()[v];XLSX.utils.format_cell(e)}else{e.w=t.getFormattedValue()}this.mergeCell(e,t.getRowSpan(),t.getColSpan())},save:function(e){var t=this.getAsBinary();var r=new Blob([t],{type:"application/octet-stream"});var n=URL.createObjectURL(r);var a=function(){var e=document.createElement("a");document.body.appendChild(e);e.style="display: none";return function(t,r){e.href=t;e.download=r;e.click()}}();if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(r,e)}else{a(n,e)}var i=function(){window.URL.revokeObjectURL(n)};setTimeout(i,1)},getAsBinary:function(){var e=XLSX.write(this.wb,{bookType:"xlsx",bookSST:true,compression:"DEFLATE",type:"binary",cellDates:true});function t(e){var t=new ArrayBuffer(e.length);var r=new Uint8Array(t);for(var n=0;n!=e.length;++n){r[n]=e.charCodeAt(n)&255}return t}var r=t(e);return r}});$Firefly.createClass("sap.buddha.LogEntry",sap.firefly.XObject,{$statics:{create:function(e){var t=new sap.buddha.LogEntry;t.le=e;return t}},getTime:function(){return this.le.time},getDate:function(){return this.le.date},getTimeStamp:function(){return this.le.timestamp},getLevel:function(){return this.le.level},getMessage:function(){return this.le.message},getDetails:function(){return this.le.details},getComponent:function(){return this.le.component}});$Firefly.createClass("sap.buddha.LogEntryIterator",sap.firefly.XObject,{$statics:{create:function(e){var t=new sap.buddha.LogEntryIterator;t.logEntries=e;t.ix=0;return t}},logEntries:null,hasNext:function(){if(this.logEntries==null){return false}return this.ix<this.logEntries.length},next:function(){if(!this.hasNext()){return null}var e=sap.buddha.LogEntry.create(this.logEntries[this.ix]);this.ix++;return e}});$Firefly.createClass("sap.buddha.XLogging",null,{$statics:{create:function(){var e=new sap.buddha.XLogging;var t=jQuery.sap.debug();e.jQueryLogger=new jQuery.sap.log.getLogger("DSH",t?4:-1);e.entries=[];jQuery.sap.log.addLogListener(e);e.components={},e.components["DSH"]=true;return e},XALL:6,XDEBUG:4,XERROR:1,XFATAL:0,XINFO:3,XNONE:-1,XTRACE:5,XWARNING:2},onLogEntry:function(e){if(this.components[e.component]){this.entries.push(e)}},setLogLevelInternal:function(e){if(e){this.components[e]=true;this.jQueryLogger.setLevel(4,e)}},debug:function(e,t,r){this.setLogLevelInternal(r);this.jQueryLogger.debug(e,t,r)},error:function(e,t,r){this.setLogLevelInternal(r);this.jQueryLogger.error(e,t,r)},fatal:function(e,t,r){this.setLogLevelInternal(r);this.jQueryLogger.fatal(e,t,r)},info:function(e,t,r){this.setLogLevelInternal(r);this.jQueryLogger.info(e,t,r)},isLoggable:function(e){return this.jQueryLogger.isLoggable(e,"DSH")},trace:function(e,t,r){this.setLogLevelInternal(r);this.jQueryLogger.trace(e,t,r)},warning:function(e,t,r){this.setLogLevelInternal(r);this.jQueryLogger.warning(e,t,r)},toString:function(){return"[???]"},getLogs:function(){return sap.buddha.LogEntryIterator.create(this.entries)}});$Firefly.createClass("sap.buddha.XZip",sap.firefly.XObject,{$statics:{create:function(){var e=new sap.buddha.XZip;e.zip=new window.jszip;return e}},saveToFile:function(e,t){this.zip.file(e,t,{binary:true})},saveStringToFile:function(e,t){this.zip.file(e,t)},getZipAsBinary:function(){var e=this.zip.generate({type:"uint8array"});return e},saveZip:function(e){var t=this.zip.generate({type:"uint8array"});var r=new Blob([t],{type:"application/zip"});var n=window.URL.createObjectURL(r);var a=function(){var e=document.createElement("a");document.body.appendChild(e);e.style="display: none";return function(t,r){e.href=t;e.download=r;e.click()}}();if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(r,e)}else{a(n,e)}var i=function(){window.URL.revokeObjectURL(n)};setTimeout(i,1)}});$Firefly.createClass("sap.buddha.XLocalization",null,{$statics:{createForUrl:function(e){var t=new sap.buddha.XLocalization;t.resourceBundle=ResourceBundle.create({url:e,async:false});return t},create:function(){if(sap.ui.getCore().getLoadedLibraries().hasOwnProperty("sap.zen.dsh")){return sap.buddha.XLocalization.createForUrl(URI(sap.ui.resource("sap.zen.dsh","i18n/localization/localization.properties")).absoluteTo(window.location.pathname).toString())}else{return sap.buddha.XLocalization.createForUrl("/aad/buddha/localization/localization.properties")}}},propertyMap:null,hasText:function(e){return this.resourceBundle.hasText(e)},getText:function(e){return this.resourceBundle.getText(e)},getText1:function(e,t){return this.resourceBundle.getText(e,[t])},getText2:function(e,t,r){return this.resourceBundle.getText(e,[t,r])},getText3:function(e,t,r,n){return this.resourceBundle.getText(e,[t,r,n])},getText4:function(e,t,r,n,a){return this.resourceBundle.getText(e,[t,r,n,a])},getText5:function(e,t,r,n,a,i){return this.resourceBundle.getText(e,[t,r,n,a,i])},getText6:function(e,t,r,n,a,i,o){return this.resourceBundle.getText(e,[t,r,n,a,i,o])},getTranslationMap:function(){if(this.propertyMap===null){var e=this.resourceBundle.aPropertyFiles&&this.resourceBundle.aPropertyFiles.length>0&&this.resourceBundle.aPropertyFiles[0]&&this.resourceBundle.aPropertyFiles[0].mProperties;this.propertyMap=sap.firefly.XHashMapByString.create();if(typeof e==="object"){for(var t in e){if(e.hasOwnProperty(t)){this.propertyMap.put(t,e[t])}}}}return this.propertyMap},toString:function(){return"[???]"}})});
//# sourceMappingURL=ff8300.zen.buddha.utils.native.js.map