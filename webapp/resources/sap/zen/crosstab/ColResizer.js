/*!
 * (c) Copyright 2010-2019 SAP SE or an SAP affiliate company.
 */
sap.ui.define(["jquery.sap.global","sap/zen/crosstab/utils/Utils"],function(jQuery,e){"use strict";jQuery.sap.declare("sap.zen.crosstab.ColResizer");sap.zen.crosstab.ColResizer=function(t){var i=this;var n=t.getDataArea();var o=t.getRowHeaderArea();var s=null;var l=null;var a=null;var r=null;var u=null;var c=null;var d=0;var v=0;var h=false;var C;var f=false;this.initialize=function(){C=t.getUtils();f=t.getPropertyBag().isRtl();u=t.getTableDiv();c=t.getRenderSizeDiv();a=C.getRtlAwareBoundingClientRect(c[0]);r=jQuery(document.getElementById(t.getId()+"_colResizeRuler"));this.attachEvents()};this.attachEvents=function(){u.unbind("dblclick");u.bind("dblclick",this.onDoubleClick);r.unbind("mousemove",this.onMouseMove);r.bind("mousemove",this.onMouseMove);var e=u.find(".sapzencrosstab-columnResizeHandleWithSort, .sapzencrosstab-columnResizeHandle");jQuery.each(e,function(e,t){var n=jQuery(t);n.unbind("mousedown",i.onMouseDown);n.bind("mousedown",i.onMouseDown);n.unbind("mouseup",i.executeonMouseUp);n.bind("mouseup",i.executeonMouseUp);n.unbind("mousemove",i.onMouseMove);n.bind("mousemove",i.onMouseMove)})};this.onDoubleClick=function(t){i.determineResizeCell(t,true);if(s){i.resizeCol(s,-1);s=null;e.cancelEvent(t)}};this.onMouseUp=function(t){var n;if(s&&l){n=i.calculateNewColWidth(t);if(n>0){i.resizeCol(s,n)}s=null;l=null;r.css("visibility","hidden");h=false;jQuery(document).off("mouseup",i.onMouseUp);e.cancelEvent(t)}};this.onMouseDown=function(t){if(!s){i.determineResizeCell(t);if(s){l=C.getRtlAwareBoundingClientRect(document.getElementById(s.getId()));d=t.clientX;r.outerHeight(c.outerHeight());v=l.end-r.outerWidth()-a.begin;r.css(f?"right":"left",v+"px");jQuery(document).on("mouseup",i.onMouseUp);e.cancelEvent(t)}}};this.onMouseMove=function(t){var n;if(s&&l){n=v+i.getDelta(t);if(n!==v){n=Math.max(n,l.begin-a.begin);if(!h){r.css("visibility","visible");h=true}r.css(f?"right":"left",n+"px")}e.cancelEvent(t)}};this.isResizeAction=function(){if(s&&l){return true}return false};this.determineResizeCell=function(e,t){var i;var n;s=sap.ui.getCore().byId(e.target.id.slice(5));if(!t&&s.getColSpan()>1){i=s.getCol()+s.getColSpan()-1;n=s.getArea();s=n.getCellWithColSpan(n.getRowCnt()-1,i);if(!s){s=n.getCellWithRowSpan(n.getRowCnt()-1,i)}}};this.calculateNewColWidth=function(e){var t;var n=-1;if(s&&l){t=i.getDelta(e);if(t!==0){n=l.width+t;n=Math.max(1,n)}}return n};this.getDelta=function(e){if(f){return d-e.clientX}else{return e.clientX-d}};this.resizeCol=function(e,i){var s=e.getArea();if(s.isColHeaderArea()){this.setColWidths(e,s,n,i)}else if(s.isDimHeaderArea()){this.setColWidths(e,s,o,i)}this.sendUpdateColWidthCommand(e,i);t.invalidate()};this.setColWidths=function(e,t,i,n){var o;var s;var l;o=e.getCol()+e.getColSpan()-1;if(n>0){t.setColWidth(o,n);t.setUserResizedCol(o);i.setColWidth(o,n);i.setUserResizedCol(o)}else{s=0;l=e.getCol()+e.getColSpan()-e.getEffectiveColSpan();for(s=o;s>=l;s--){t.resetColWidth(s);i.resetColWidth(s);t.setUserResizedCol(s);i.setUserResizedCol(s)}}};this.sendUpdateColWidthCommand=function(e,i){var n=t.getUpdateColWidthCommand();if(n!=null&&n.length>0){var o=e.getTableCol();n=n.replace("__COL__",o);n=n.replace("__WIDTH__",Math.round(i));var s=new Function(n);s()}}};return sap.zen.crosstab.ColResizer});
//# sourceMappingURL=ColResizer.js.map