/*!
 * (c) Copyright 2010-2019 SAP SE or an SAP affiliate company.
 */
sap.ui.define("sap/zen/crosstab/paging/Page",["jquery.sap.global","sap/zen/crosstab/paging/PagingConstants","sap/zen/crosstab/rendering/RenderingConstants","sap/zen/crosstab/DataCell","sap/zen/crosstab/HeaderCell"],function(jQuery,e,t,a,i){"use strict";jQuery.sap.declare("sap.zen.crosstab.paging.Page");sap.zen.crosstab.paging.Page=function(o,r,n){var s=e.PAGE_STATUS_UNKNOWN;var l=0;var A=0;var g=n.getTileRowCnt();var f=n.getTileColCnt();var C=n.getCellMerger();var S=n.getDataHandler();var T=n.getCrosstab();var u=T.getDimensionHeaderArea();var d=T.getColumnHeaderArea();var R=T.getRowHeaderArea();var c=T.getDataArea();var w={};var E=[];_();function _(){E.push(u.getAreaType());E.push(d.getAreaType());E.push(R.getAreaType());E.push(c.getAreaType())}this.getPageKey=function(){return r};this.getRow=function(){};this.getCol=function(){};this.getPosition=function(){return o};this.getStatus=function(){return s};this.setStatus=function(e){s=e};this.getPageDataRowCnt=function(){return l};this.getPageDataColCnt=function(){return A};this.receiveData=function(e,t){l=e.sentdatarows;A=e.sentdatacols;g=e.tilerows;f=e.tilecols;S.determineBasicAreaData(e,t);h();var a={};a.iRowOffset=o.iRow*g;a.iColOffset=o.iCol*f;a.bIsFirstPage=t;a.oCrosstabAreasToBeFilled=w;a.oCrosstabData=e;S.jsonToDataModel(a);I();N()};this.removeData=function(){s=e.PAGE_STATUS_UNKNOWN;w={};U(c);p();v()};function v(){var e=0;var t=null;for(e=0;e<E.length;e++){t=w[E[e]];if(t){m(t,false);t.oArea.decreaseLoadingPageCnt()}}}function D(t,a){var i=L(t,a);if(i.iRefCnt===0){i.iStatus=e.PAGE_STATUS_UNKNOWN;n.setHeaderTileInfo(t,a,i);U(t)}}function p(){D(u,0);D(R,o.iRow);D(d,o.iCol)}function P(){H(u,0);H(R,o.iRow);H(d,o.iCol)}function G(e,t,a){var i=n.getHeaderTileInfo(e,t);i.iStatus=a;n.setHeaderTileInfo(e,t,i)}function H(e,t){var a=n.getHeaderTileInfo(e,t);a.iRefCnt++;n.setHeaderTileInfo(e,t,a)}function L(e,t){var a=n.getHeaderTileInfo(e,t);a.iRefCnt--;n.setHeaderTileInfo(e,t,a);return a}function h(){w={};U(c,0);if(n.getHeaderTileInfo(R,o.iRow).iStatus!==e.PAGE_STATUS_LOADED){U(R,o.iRow)}if(n.getHeaderTileInfo(d,o.iCol).iStatus!==e.PAGE_STATUS_LOADED){U(d,o.iCol)}if(n.getHeaderTileInfo(u,0).iStatus!==e.PAGE_STATUS_LOADED){U(u,0)}}function N(){var e=0;var t=null;for(e=0;e<E.length;e++){t=w[E[e]];if(t){b(t,false);z(t,false);t.oArea.decreaseLoadingPageCnt()}}}function U(e,t){var a=e.getAreaType();var i={};i.oArea=e;i.oAreaRegion=K(e);i.iTileIndex=t;w[a]=i}this.provideLoadingCells=function(t){s=e.PAGE_STATUS_LOADING;O(t);P();y()};function I(){s=e.PAGE_STATUS_LOADED;var t=null;t=w[d.getAreaType()];if(t){C.mergeColHeaderCells(o.iCol);G(t.oArea,o.iCol,e.PAGE_STATUS_LOADED)}t=w[R.getAreaType()];if(t){C.mergeRowHeaderCells(o.iRow);G(t.oArea,o.iRow,e.PAGE_STATUS_LOADED)}t=w[u.getAreaType()];if(t){G(t.oArea,0,e.PAGE_STATUS_LOADED)}}function O(t){w={};U(c,0);if(t.isDataArea()){if(n.getHeaderTileInfo(R,o.iRow).iStatus===e.PAGE_STATUS_UNKNOWN){U(R,o.iRow);G(R,o.iRow,e.PAGE_STATUS_LOADING)}if(n.getHeaderTileInfo(d,o.iCol).iStatus===e.PAGE_STATUS_UNKNOWN){U(d,o.iCol);G(d,o.iCol,e.PAGE_STATUS_LOADING)}if(n.getHeaderTileInfo(u,0).iStatus===e.PAGE_STATUS_UNKNOWN){U(u,0);G(u,0,e.PAGE_STATUS_LOADING)}}else{if(t.isColHeaderArea()){U(t,o.iCol);G(t,o.iCol,e.PAGE_STATUS_LOADING)}else if(t.isRowHeaderArea()){U(t,o.iRow);G(t,o.iRow,e.PAGE_STATUS_LOADING)}else if(t.isDimensionHeaderArea()){U(t,0);G(t,0,e.PAGE_STATUS_LOADING)}}}function y(){var e=0;var t=null;for(e=0;e<E.length;e++){t=w[E[e]];if(t){m(t,true);b(t,true);z(t,true);t.oArea.increaseLoadingPageCnt()}}}function m(e,t){var a=0;var i=0;var o=null;var r=e.oAreaRegion;var n=e.oArea;for(a=r.iStartRow;a<=r.iEndRow;a++){for(i=r.iStartCol;i<=r.iEndCol;i++){if(t){o=W(n,a,i)}n.insertCell(o,a,i)}}}function b(e,t){var a=e.oAreaRegion;var i=e.oArea;var o=0;for(o=a.iStartCol;o<=a.iEndCol;o++){i.changeColWidthTemporaryFlag(o,r,t)}}function z(e,t){var a=e.oAreaRegion;var i=e.oArea;var o=0;for(o=a.iStartRow;o<=a.iEndRow;o++){i.changeRowHeightTemporaryFlag(o,r,t)}}function K(e){var t={};if(e.isDimHeaderArea()){t.iStartRow=0;t.iEndRow=e.getRowCnt()-1;t.iStartCol=0;t.iEndCol=e.getColCnt()-1}else if(e.isRowHeaderArea()){t.iStartRow=o.iRow*g;t.iEndRow=Math.min(t.iStartRow+g-1,e.getRowCnt()-1);t.iStartCol=0;t.iEndCol=e.getColCnt()-1}else if(e.isColHeaderArea()){t.iStartRow=0;t.iEndRow=e.getRowCnt()-1;t.iStartCol=o.iCol*f;t.iEndCol=Math.min(t.iStartCol+f-1,e.getColCnt()-1)}else if(e.isDataArea()){t.iStartRow=o.iRow*g;t.iEndRow=Math.min(t.iStartRow+g-1,e.getRowCnt()-1);t.iStartCol=o.iCol*f;t.iEndCol=Math.min(t.iStartCol+f-1,e.getColCnt()-1)}return t}function W(e,o,r){var n=null;if(e.isDataArea()){n=new a;n.addStyle(t.STYLE_DATA_CELL)}else{n=new i;n.addStyle(t.STYLE_HEADER_CELL);n.setRowSpan(1);n.setColSpan(1)}n.setArea(e);n.setRow(o);n.setCol(r);n.setLoading(true);n.addStyle(t.STYLE_LOADING);return n}};return sap.zen.crosstab.paging.Page});
//# sourceMappingURL=Page.js.map