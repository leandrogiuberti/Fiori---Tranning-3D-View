/*!
 * (c) Copyright 2010-2019 SAP SE or an SAP affiliate company.
 */
sap.ui.define(["jquery.sap.global","sap/zen/crosstab/rendering/ScrollManager","sap/zen/crosstab/rendering/PixelScrollManager","sap/zen/crosstab/rendering/HeaderScrollManager","sap/zen/crosstab/utils/Utils"],function(jQuery,e,r,l){"use strict";jQuery.sap.declare("sap.zen.crosstab.rendering.CrossRequestManager");sap.zen.crosstab.rendering.CrossRequestManager=function(t,a){var i=null;var n=null;var o=0;var s="";var f=0;var d="";var u=false;var c=null;var g=null;var v=null;var S=null;var h=false;var P="";var H="";var p=0;var C=0;var A=0;var b=0;var y=false;var D=false;var I=false;var R=undefined;var T=undefined;var V=null;var m=t.getDataArea();var E=t.getRowHeaderArea();var x=t.getColumnHeaderArea();var W=false;var w=false;this.reset=function(){if(i){i.destroy()}i=null;if(n){n.destroy()}n=null};this.clearSavedColWidths=function(){c=null;g=null;v=null;S=null};this.clearSavedData=function(){i=null;n=null;o=0;s="";f=0;d="";u=false;this.clearSavedColWidths();h=false;P="";H="";p=0;C=0;V=null;W=false;w=false};this.saveTableDimensions=function(){if(t.getPropertyBag().isPixelScrolling()){var e=jQuery(document.getElementById(t.getId()+"_dataArea"));A=e.outerHeight();b=e.outerWidth()}p=t.getTotalRows();C=t.getTotalCols()};function B(e){if(H==="expanded"){return e<0}else if(H==="collapsed"){return e>0}else{return false}}this.handleRootCause=function(){var e=f;var r=o;var l=R;var a=T;if(P==="plan"){if(s!=="plan"&&d!=="plan"){this.clearSavedData()}}else if(P==="sorting"){if(s!=="sort"){this.clearSavedData()}else{f=0;T=false}}else if(P==="hierarchy"){if(s==="hier"&&d==="hier"){var i=p-t.getTotalRows();var n=C-t.getTotalCols();if(i!==0){if(B(i)){if(!h){if(t.getPropertyBag().isPixelScrolling()){D=true}else{f=Math.max(0,f-i)}}}else{this.clearSavedData()}}else if(n!==0){if(B(n)){if(!h){if(t.getPropertyBag().isPixelScrolling()){y=true}else{o=Math.max(0,o-n)}}}else{this.clearSavedData()}}}else{this.clearSavedData()}}h=false;P="";H="";p=0;C=0;if(r!==o||e!==f||l!==R||a!==T){t.getUtils().sendScrollPosUpdate(o,R,f,T)}I=true};this.getHPixelScrollPosAfterRendering=function(){var e=-1;if(t.getPropertyBag().isPixelScrolling()){var r=jQuery(document.getElementById(t.getId()+"_dataArea"));if(y){var l=r.outerWidth()-b;e=o+l;y=false}}return e};this.getVPixelScrollPosAfterRendering=function(){var e=-1;if(t.getPropertyBag().isPixelScrolling()){var r=jQuery(document.getElementById(t.getId()+"_dataArea"));if(D){var l=r.outerHeight()-A;e=f+l;D=false}}return e};this.setRootCause=function(e){P=e};this.setHierarchyAction=function(e){H=e};this.setIsHierarchyDirectionDown=function(e){h=e};this.getScrollManager=function(){if(!i){if(t.getPropertyBag().isPixelScrolling()){i=new r(t,a)}else{i=new e(t,a)}if(u){i.setHScrollPos(o);i.setVScrollPos(f)}}return i};this.getHeaderScrollManager=function(){if(!n){n=new l(t,a);if(u){n.setHScrollData(V)}}return n};this.saveHScrollInfo=function(e,r){if(t.getPropertyBag().isPixelScrolling()){var l=t.getRenderEngine().getScrollManager();o=0;if(l){o=l.getCurrentHScrollPos()}}else{o=t.getColumnHeaderArea().getRenderStartCol();if(l&&l.isHScrolledToEnd()){o++;R=true}}if(r){f=0}s=e;u=true;W=true};this.saveVScrollInfo=function(e,r){if(t.getPropertyBag().isPixelScrolling()){var l=jQuery(document.getElementById(t.getId()+"_lowerRight_scrollDiv"));f=0;if(l&&l.length>0){f=l.scrollTop()}}else{f=t.getRowHeaderArea().getRenderStartRow();if(i&&i.isVScrolledToEnd()){f++;T=true}}if(r){o=0}d=e;u=true;w=true};this.savedInfoHandled=function(){if(I===true){o=0;s="";f=0;d="";u=false;c=null;g=null;v=null;S=null;I=false;R=undefined;T=undefined;V=null;W=false;w=false}};this.hasSavedInfo=function(){return u};this.getSavedHScrollInfo=function(){var e={};e.iPos=o;e.sAction=s;e.bScrolledToEnd=R;return e};this.getSavedVScrollInfo=function(){var e={};e.iPos=f;e.sAction=d;e.bScrolledToEnd=T;return e};this.saveColWidths=function(){var e=t.getColumnHeaderArea();var r=t.getDimensionHeaderArea();var l=t.getRowHeaderArea();var a=t.getDataArea();if(!e.hasLoadingPages()){c=e.getColWidths();u=true}if(!a.hasLoadingPages()){v=a.getColWidths();u=true}if(!r.hasLoadingPages()){g=r.getColWidths();u=true}if(!l.hasLoadingPages()){S=l.getColWidths();u=true}};this.restoreColWidths=function(){var e=t.getColumnHeaderArea();var r=t.getDimensionHeaderArea();var l=t.getRowHeaderArea();var a=t.getDataArea();if(c){e.setColWidths(c);c=null}if(v){a.setColWidths(v);v=null}if(g){r.setColWidths(g);g=null}if(S){l.setColWidths(S);S=null}};function M(e,r,l,a){var i={iHScrollPos:e,bHScrolledToEnd:r,iVScrollPos:l,bVScrolledToEnd:a};if(i.iHScrollPos<0){i.iHScrollPos=0;i.bHScrolledToEnd=false}if(i.iVScrollPos<0){i.iVScrollPos=0;i.bVScrolledToEnd=false}if(!t.getPropertyBag().isPixelScrolling()){var n=m?m:x;var o=n.getColCnt()-1;if(i.iHScrollPos>o){i.iHScrollPos=0;i.bHScrolledToEnd=false}n=m?m:E;var s=n.getRowCnt()-1;if(i.iVScrollPos>s){i.iVScrollPos=0;i.bVScrolledToEnd=false}}if(i.iHScrollPos!==e||i.iVScrollPos!==l){t.getUtils().sendScrollPosUpdate(0,false,0,false)}return i}this.setHScrollInfo=function(e,r){o=e;R=r;u=true;W=true};this.setVScrollInfo=function(e,r){f=e;T=r;u=true;w=true};this.setScrollData=function(e,r,l,t){var a=M(e,r,l,t);o=a.iHScrollPos;f=a.iVScrollPos;R=a.bHScrolledToEnd;T=a.bVScrolledToEnd;u=true;W=true;w=true};function z(e){var r=e;if(r.iHPos<0){r.iHPos=0}if(r.iHPos!==e.iHPos){t.getUtils().sendScrollPosUpdate(r.iHPos,undefined,undefined,undefined,true)}return r}this.setHeaderScrollData=function(e){var r=z(e);u=true;V=r};this.getHeaderScrollData=function(){return V};this.hasSavedHScrollInfo=function(){return W};this.hasSavedVScrollInfo=function(){return w}};return sap.zen.crosstab.rendering.CrossRequestManager});
//# sourceMappingURL=CrossRequestManager.js.map