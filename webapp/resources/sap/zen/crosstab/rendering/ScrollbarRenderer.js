/*!
 * (c) Copyright 2010-2019 SAP SE or an SAP affiliate company.
 */
sap.ui.define(["jquery.sap.global","sap/zen/crosstab/utils/Measuring","sap/zen/crosstab/utils/Utils"],function(jQuery,e,t){"use strict";jQuery.sap.declare("sap.zen.crosstab.rendering.ScrollbarRenderer");sap.zen.crosstab.rendering.ScrollbarRenderer=function(e,r,l,a){var i=0;var o=false;var n=false;var s=false;var d=null;var c=null;var g=null;var S=e.getPropertyBag().isPixelScrolling();function h(t){r.write("<div");r.writeAttributeEscaped("id",e.getId()+"_upperRightPad");r.writeAttribute("class","sapzencrosstab-UpperRightScrollPad");r.addStyle("width",i+"px");r.addStyle("height",t+"px");r.writeStyles();r.write(">");r.write("</div>")}function u(t,l){var a=null;var n=0;var d=0;if(!e.getVScrollbar()){a=new sap.ui.core.ScrollBar;e.setVScrollbar(a)}a=e.getVScrollbar();a.setVertical(true);if(s===true&&!o){n=jQuery(document.getElementById(e.getId()+"_renderSizeDiv")).outerHeight()-i}else{n=t}d=n-l;a.setSize(d+"px");r.renderControl(a)}function v(){r.write("<td");r.writeAttribute("class","sapzencrosstab-VScrollCell");r.write(">")}function w(t){var a=l.getUpperScrollDivHeight();r.write("<table");r.writeAttributeEscaped("id",e.getId()+"_vScrollTab");r.writeAttribute("class","sapzencrosstab-VScrollTable");r.write(">");r.write("<tr>");v();h(a);r.write("</td>");r.write("</tr>");r.write("<tr>");v();u(t,a);r.write("</td>");r.write("</tr>");r.write("</table>")}function b(){r.write("<div");r.writeAttributeEscaped("id",e.getId()+"_vScrollDiv");r.addStyle("position","absolute");r.addStyle("top","0px");r.addStyle(e.getPropertyBag().isRtl()?"left":"right","0px");r.addStyle("width",i+"px");var t=l.getRenderSizeDivSize().iHeight;if(o){t=Math.min(e.getContentHeight()-i,t)}r.addStyle("height",t+"px");r.writeStyles();r.write(">");w(t);r.write("</div>")}function f(){var t=0;var r=jQuery(document.getElementById(e.getId()+"_upperLeft_scrollDiv"));var l=e.getUtils();var a=e.getPropertyBag();if(r.length>0){t=l.isMsIE()||a.isRtl()&&l.isMozilla()?r.width():r.outerWidth()}if(t===0){r=jQuery(document.getElementById(e.getId()+"_lowerLeft_scrollDiv"));t=l.isMsIE()||a.isRtl()&&l.isMozilla()?r.width():r.outerWidth()}return t}function p(t){if(!s){r.write("<div");r.writeAttributeEscaped("id",e.getId()+"_lowerLeftPad");r.writeAttribute("class","sapzencrosstab-LowerLeftScrollPad");r.addStyle("width",t+"px");r.addStyle("height",i+"px");r.writeStyles();r.write(">");r.write("</div>")}else{var l=null;if(!e.getHorizontalHeaderScrollbar()){l=new sap.ui.core.ScrollBar;e.setHorizontalHeaderScrollbar(l)}l=e.getHorizontalHeaderScrollbar();l.setVertical(false);var a=f();l.setSize(a+"px");r.renderControl(l)}}function H(t){if(t===true){r.write("<td");r.writeAttributeEscaped("id",e.getId()+"_hScrollTableCell");r.writeAttribute("class","sapzencrosstab-HScrollCell sapzencrosstab-HScrollCellWithHeaderScrollRightBorder")}else{r.write("<td");r.writeAttribute("class","sapzencrosstab-HScrollCell")}r.write(">")}function z(){r.write("<div");r.writeAttributeEscaped("id",e.getId()+"_lowerRightPad");r.writeAttribute("class","sapzencrosstab-LowerRightScrollPad");r.addStyle("width",i+"px");r.addStyle("height",i+"px");r.writeStyles();r.write(">");r.write("</div>")}function I(t,l){if(o===true){var a=null;if(!e.getHScrollbar()){a=new sap.ui.core.ScrollBar;e.setHScrollbar(a)}a=e.getHScrollbar();a.setVertical(false);a.setSize(t-l-(n?i:0)+"px");r.renderControl(a)}else{r.write("<div");r.writeAttributeEscaped("id",e.getId()+"_lowerMiddlePad");r.writeAttribute("class","sapzencrosstab-LowerMiddleScrollPad");r.addStyle("width",t-l-(n?i:0)+"px");r.addStyle("height",i+"px");r.writeStyles();r.write(">");r.write("</div>")}}function m(){var t=jQuery(document.getElementById(e.getId()+"_lowerLeft"));var l=t.outerWidth();r.write("<table");r.writeAttributeEscaped("id",e.getId()+"_hScrollTab");r.writeAttribute("class","sapzencrosstab-HScrollTable");r.write(">");r.write("<tr>");H(s);p(l);r.write("</td>");var a=e.getContentWidth();H();I(a,l);r.write("</td>");if(n){H();z();r.write("</td>")}r.write("</tr>");r.write("</table>")}function y(){r.write("<div");r.writeAttributeEscaped("id",e.getId()+"_hScrollDiv");r.addStyle("position","absolute");var t=e.getPropertyBag().getToolbarHeight();r.addStyle("bottom",t+"px");r.addStyle("height",i+"px");var l=e.getContentWidth();r.addStyle("width",l+"px");r.addStyle("height",i+"px");r.writeStyles();r.write(">");m(l);r.write("</div>")}this.renderScrollbars=function(t){o=t.bHasHScrollbar;n=t.bHasVScrollbar;s=t.bHasHHeaderScrollbar;if(o||n||s){i=l.getBrowserScrollbarWidth();if(i===0){if(n){var d=new sap.ui.core.ScrollBar;e.setVScrollbar(d)}if(o){var c=new sap.ui.core.ScrollBar;e.setHScrollbar(c)}if(s){var g=new sap.ui.core.ScrollBar;e.setHorizontalHeaderScrollbar(g)}}else{var S=a.getElement(e.getId());var h=S.html();if(n){b()}if(o||s){y()}r.write(h);r.flush(S[0])}}};this.attachHandlers=function(r,l,a){this.detachHandlers();d=r;c=l;g=a;if(d&&e.getHScrollbar()){e.getHScrollbar().attachScroll(d);e.getHScrollbar().attachBrowserEvent("mousedown touchstart",t.cancelEvent)}if(c&&e.getVScrollbar()){e.getVScrollbar().attachScroll(c);e.getVScrollbar().attachBrowserEvent("mousedown touchstart",t.cancelEvent);this.attachMouseWheelHandler()}if(g&&e.getHorizontalHeaderScrollbar()){e.getHorizontalHeaderScrollbar().attachScroll(g);e.getHorizontalHeaderScrollbar().attachBrowserEvent("mousedown touchstart",t.cancelEvent)}};this.attachMouseWheelHandler=function(){if(!e.getPropertyBag().isMobileMode()){var t=e.getTableDiv();if(/Firefox/i.test(window.navigator.userAgent)){t[0].addEventListener("DOMMouseScroll",this.vScrollMouseWheelFireFox)}else{t.on("mousewheel",this.vScrollMouseWheel)}}};this.detachMouseWheelHandler=function(){if(!e.getPropertyBag().isMobileMode()){var t=e.getTableDiv();if(/Firefox/i.test(window.navigator.userAgent)){t[0].removeEventListener("DOMMouseScroll",this.vScrollMouseWheelFireFox)}else{t.off("mousewheel",this.vScrollMouseWheel)}}};function E(e){return e&&e/Math.abs(e)}this.vScrollMouseWheelFireFox=function(e){var t=E(e.detail);x(e,t)};this.vScrollMouseWheel=function(e){var t=-E(e.originalEvent.wheelDelta);x(e,t)};function x(r,l){if(e.hasLoadingPages()===false){var a=0;var i=0;if(S===true){a=120;i=parseInt(e.getVScrollbar().getContentSize(),10)}else{a=3;i=e.getVScrollbar().getSteps()}var o=e.getVScrollPos()+l*a;o=Math.max(0,o);o=Math.min(o,i);e.getRenderEngine().scrollVertical(o,true)}t.cancelEvent(r)}this.detachHandlers=function(){if(d&&e.getHScrollbar()){e.getHScrollbar().detachScroll(d);e.getHScrollbar().detachBrowserEvent("mousedown touchstart",t.cancelEvent)}if(c&&e.getVScrollbar()){e.getVScrollbar().detachScroll(c);e.getVScrollbar().detachBrowserEvent("mousedown touchstart",t.cancelEvent);this.detachMouseWheelHandler()}if(g&&e.getHorizontalHeaderScrollbar()){e.getHorizontalHeaderScrollbar().detachScroll(g);e.getHorizontalHeaderScrollbar().detachBrowserEvent("mousedown touchstart",t.cancelEvent)}d=null;c=null;g=null};this.destroy=function(){this.detachHandlers();i=0;o=false;n=false;d=null;c=null};this.setScrollbarSteps=function(){if(e.getPropertyBag().isPixelScrolling()){this.setScrollbarStepsInPixelMode()}else{this.setScrollbarStepsInStepMode()}if(s){this.setHorizontalHeaderScrollbarSteps()}};this.setHorizontalHeaderScrollbarSteps=function(){var t=e.getHorizontalHeaderScrollbar();if(t){var r=null;if(e.hasDimensionHeaderArea()){r=e.getId()+"_dimHeaderArea_container"}else if(e.hasRowHeaderArea()){r=e.getId()+"_rowHeaderArea_container"}if(r){var l=jQuery(document.getElementById(r));t.setContentSize(l.outerWidth()+"px");t.rerender()}}};this.adjustHorizontalHeaderScrollbarContainerSize=function(){var t=e.getHorizontalHeaderScrollbar();if(t){var r=jQuery(document.getElementById(e.getId()+"_hScrollTableCell"));if(r.length>0){var l=parseInt(r.css("border-right-width"),10)+parseInt(r.css("border-left-width"),10);t.setSize(parseInt(t.getSize(),10)-l+"px");t.rerender()}}};this.setScrollbarStepsInPixelMode=function(){var t=e.getVScrollbar();var r=e.getHScrollbar();var l=jQuery(document.getElementById(e.getId()+"_dataArea_container"));if(t){var a=0;if(!e.hasDataArea()){var i=jQuery(document.getElementById(e.getId()+"_rowHeaderArea_container"));a=i.outerHeight()}else{a=l.outerHeight()}t.setContentSize(a+"px");t.rerender()}if(r){var o=0;if(!e.hasDataArea()){var n=jQuery(document.getElementById(e.getId()+"_colHeaderArea_container"));o=n.outerWidth()}else{o=l.outerWidth()}r.setContentSize(o+"px");r.rerender()}};this.setScrollbarStepsInStepMode=function(){var t=l.getRenderSizeDivSize();var r=e.getDataArea();var a=e.getVScrollbar();var i=e.getHScrollbar();if(a){var o=l.getAreaHeight(e.getColumnHeaderArea());var n=t.iHeight-o;var s=r.getRenderStartRow();var d=s+r.getRenderRowCnt();var c=1;for(var g=s;g<d;g++){n-=r.getRowHeight(g);if(n<0){break}c++}a.setSteps(Math.max(1,r.getRowCnt()-c));a.rerender()}if(i){var S=l.getAreaWidth(e.getRowHeaderArea());var h=t.iWidth-S;var u=r.getRenderStartCol();var v=u+r.getRenderColCnt();var w=1;for(var b=u;b<v;b++){h-=r.getColWidth(b);if(h<0){break}w++}i.setSteps(Math.max(1,r.getColCnt()-w));i.rerender()}};this.adjustHScrollbarWidth=function(t){var r=jQuery(document.getElementById(e.getId()+"_lowerLeftPad"));var l=jQuery(document.getElementById(e.getId()+"_lowerRight_scrollDiv"));r.width(t);var a=e.getHScrollbar();a.setSize(l.outerWidth()+"px");a.rerender()};this.adjustVScrollbarHeight=function(t){var r=jQuery(document.getElementById(e.getId()+"_upperRightPad"));var l=jQuery(document.getElementById(e.getId()+"_lowerRight_scrollDiv"));r.height(t);var a=e.getVScrollbar();a.setSize(l.outerHeight()+"px");a.rerender()}};return sap.zen.crosstab.rendering.ScrollbarRenderer});
//# sourceMappingURL=ScrollbarRenderer.js.map