/*!
 * SAPUI5
    (c) Copyright 2009-2020 SAP SE. All rights reserved
  
 */
sap.ui.define("sap/zen/commons/SpreadSheet/Workbook",["sap/zen/commons/thirdparty/xlsx-protobi"],function(e){function t(){var t=this;t.SheetNames=[];t.Sheets={};t.allowStyles=true;t.formatIndexMap={};t.formatIndex=164;t.addWorksheet=function(e){var r={};t.SheetNames.push(e);t.Sheets[e]=r;r.curRow=-1;r.maxRow=-1;r.maxCol=-1;r["!merges"]=[];return r};t.closeWorkSheet=function(r){var o=t.getRange(0,0,r.maxRow+1,r.maxCol+1);r["!ref"]=e.utils.encode_range(o)};t.getRow=function(e,t){var r={};r.ws=e;r.row=t;r.curCol=-1;return r};t.createRow=function(e){e.curRow++;var r=t.getRow(e,e.curRow);if(e.curRow>e.maxRow){e.maxRow=e.curRow}return r};t.getCell=function(e,r){var o={};o.ws=e.ws;o.row=e.row;o.column=r;var a=t.getCellRef(o.row,o.column);e.ws[a]=o;return o};t.getCellRef=function(t,r){var o=e.utils.encode_cell({r:t,c:r});return o.toString()};t.addCell=function(e){e.curCol++;var r=t.getCell(e,e.curCol);if(e.curCol>e.ws.maxCol){e.ws.maxCol=e.curCol}return r};t.copyCell=function(e,t){if(e.s){t.s=e.s}if(e.v){t.v=e.v}if(e.t){t.t=e.t}if(e.f){t.f=e.f}if(e.z){t.z=e.z}if(e.w){t.w=e.w}};t.mergeCell=function(e,r,o){var a=r,n=o;if(a<1){a=1}if(n<1){n=1}var l=t.getRange(e.row,e.column,e.row+a-1,e.column+n-1);if(a>1||n>1){e.ws["!merges"].push(l)}var i=null,f=null,g=0;for(g=1;g<a;g++){i=t.getRow(e.ws,e.row+g);f=t.getCell(i,e.column);t.copyCell(e,f)}for(g=1;g<n;g++){i=t.getRow(e.ws,e.row);f=t.getCell(i,e.column+g);t.copyCell(e,f)}};t.getRange=function(e,t,r,o){return{s:{r:e,c:t},e:{r:r,c:o}}};t.setCell=function(r,o){if(r.row>r.ws.maxRow){r.ws.maxRow=r.row}if(r.column>r.ws.maxCol){r.ws.maxCol=r.column}var a="FFDCE6F0";var n="FFCCCCCC";var l="FFE5E5E5";var i="FFFFFF00";var f="Calibri";var g=11;var s="top";var u="left";var m={style:"medium",color:{rgb:n}};var c={top:m,bottom:m,left:m,right:m};var w={font:{name:f,sz:g,bold:false},alignment:{vertical:s,horizontal:u,wrapText:false,indent:0}};var v={font:{name:f,sz:g,bold:false},alignment:{vertical:s,horizontal:u,wrapText:false,indent:0},border:c};var d={font:{name:f,sz:g,bold:false},fill:{fgColor:{rgb:a}},alignment:{vertical:s,horizontal:u,wrapText:false,indent:0},border:c};var S={font:{name:f,sz:g,bold:false},fill:{fgColor:{rgb:l}},alignment:{vertical:s,horizontal:u,wrapText:false,indent:0},border:c};var p={font:{name:f,sz:g,bold:false},fill:{fgColor:{rgb:i}},alignment:{vertical:s,horizontal:u,wrapText:false,indent:0},border:c};if(o.getStyle().toString()!=="NONE"&&t.allowStyles===true){if(o.getStyle().toString()==="GROUP"){r.s=d}else if(o.getStyle().toString()==="HEADER"){r.s=S}else if(o.getStyle().toString()==="TOTAL"){r.s=p}else{r.s=v}}else{r.s=w}r.v=o.getFormattedValue();r.t="s";r.s.alignment.horizontal="left";if(o.getValueType().toString()==="NUMBER"||o.getValueType().toString()==="NUMBER_AS_STRING"){r.s.alignment.horizontal="right";if(o.getValueType().toString()==="NUMBER"){r.v=o.getValue();r.t="n"}}else if(o.getValueType().toString()==="DATE"){r.v=o.getValue();r.t="d"}if(o.getFormula()){r.f=o.getFormula()}if(o.getValueType().toString()==="NUMBER_AS_STRING"){o.setFormatString(null)}if(o.getValueType().toString()==="NUMBER"){r.s.numFmt=o.getFormatString()}if(o.getFormatString()!=null&&o.getFormatString().length>0){r.z=o.getFormatString();var C=t.formatIndexMap[o.getFormatString()];if(!C){while(e.SSF.get_table()[t.formatIndex]){t.formatIndex++}C=t.formatIndex;t.formatIndexMap[o.getFormatString()]=C;t.formatIndex++;e.SSF.load(o.getFormatString(),C)}r.z=e.SSF.get_table()[C];e.utils.format_cell(r)}else{r.w=o.getFormattedValue()}t.mergeCell(r,o.getRowSpan(),o.getColSpan())};t.save=function(e){var r=t.getAsBinary();var o=new Blob([r],{type:"application/octet-stream"});var a=URL.createObjectURL(o);var n=function(){var e=document.createElement("a");document.body.appendChild(e);e.style="display: none";return function(t,r){e.href=t;e.download=r;e.click()}}();if(window.navigator&&window.navigator.msSaveOrOpenBlob){window.navigator.msSaveOrOpenBlob(o,e)}else{n(a,e)}var l=function(){window.URL.revokeObjectURL(a)};setTimeout(l,1)};t.getAsBinary=function(){var r=e.write(t,{bookType:"xlsx",bookSST:true,type:"binary",cellDates:true});function o(e){var t=new ArrayBuffer(e.length);var r=new Uint8Array(t);for(var o=0;o!=e.length;++o){r[o]=e.charCodeAt(o)&255}return t}var a=o(r);return a}}return t});
//# sourceMappingURL=Workbook.js.map